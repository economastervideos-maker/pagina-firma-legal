;!function(){try { var e="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof global?global:"undefined"!=typeof window?window:"undefined"!=typeof self?self:{},n=(new e.Error).stack;n&&((e._debugIds|| (e._debugIds={}))[n]="5e3c085d-1532-e9bf-752a-ba86bedec92d")}catch(e){}}();
(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,911185,e=>{"use strict";var t,n,r,i,o,a,s,l,u,c,d,f,p,h,g,m,x=e.i(276385),y=e.i(389959),b=e.i(7433),w=e.i(167626),k=e.i(231693),_=e.i(883153).DiagAPI.instance(),S=e.i(893299),C=function(){function e(){var e=this;this._promise=new Promise(function(t,n){e._resolve=t,e._reject=n})}return Object.defineProperty(e.prototype,"promise",{get:function(){return this._promise},enumerable:!1,configurable:!0}),e.prototype.resolve=function(e){this._resolve(e)},e.prototype.reject=function(e){this._reject(e)},e}(),j=function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,i,o=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(e){i={error:e}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a},T=function(e,t,n){if(n||2==arguments.length)for(var r,i=0,o=t.length;i<o;i++)!r&&i in t||(r||(r=Array.prototype.slice.call(t,0,i)),r[i]=t[i]);return e.concat(r||Array.prototype.slice.call(t))},E=function(){function e(e,t){this._callback=e,this._that=t,this._isCalled=!1,this._deferred=new C}return Object.defineProperty(e.prototype,"isCalled",{get:function(){return this._isCalled},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"promise",{get:function(){return this._deferred.promise},enumerable:!1,configurable:!0}),e.prototype.call=function(){for(var e,t=this,n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];if(!this._isCalled){this._isCalled=!0;try{Promise.resolve((e=this._callback).call.apply(e,T([this._that],j(n),!1))).then(function(e){return t._deferred.resolve(e)},function(e){return t._deferred.reject(e)})}catch(e){this._deferred.reject(e)}}return this._deferred.promise},e}();(r=c||(c={}))[r.SUCCESS=0]="SUCCESS",r[r.FAILED=1]="FAILED";var R=e.i(568126);(i=d||(d={})).AlwaysOff="always_off",i.AlwaysOn="always_on",i.ParentBasedAlwaysOff="parentbased_always_off",i.ParentBasedAlwaysOn="parentbased_always_on",i.ParentBasedTraceIdRatio="parentbased_traceidratio",i.TraceIdRatio="traceidratio";var I=["OTEL_SDK_DISABLED"],A=["OTEL_BSP_EXPORT_TIMEOUT","OTEL_BSP_MAX_EXPORT_BATCH_SIZE","OTEL_BSP_MAX_QUEUE_SIZE","OTEL_BSP_SCHEDULE_DELAY","OTEL_BLRP_EXPORT_TIMEOUT","OTEL_BLRP_MAX_EXPORT_BATCH_SIZE","OTEL_BLRP_MAX_QUEUE_SIZE","OTEL_BLRP_SCHEDULE_DELAY","OTEL_ATTRIBUTE_VALUE_LENGTH_LIMIT","OTEL_ATTRIBUTE_COUNT_LIMIT","OTEL_SPAN_ATTRIBUTE_VALUE_LENGTH_LIMIT","OTEL_SPAN_ATTRIBUTE_COUNT_LIMIT","OTEL_LOGRECORD_ATTRIBUTE_VALUE_LENGTH_LIMIT","OTEL_LOGRECORD_ATTRIBUTE_COUNT_LIMIT","OTEL_SPAN_EVENT_COUNT_LIMIT","OTEL_SPAN_LINK_COUNT_LIMIT","OTEL_SPAN_ATTRIBUTE_PER_EVENT_COUNT_LIMIT","OTEL_SPAN_ATTRIBUTE_PER_LINK_COUNT_LIMIT","OTEL_EXPORTER_OTLP_TIMEOUT","OTEL_EXPORTER_OTLP_TRACES_TIMEOUT","OTEL_EXPORTER_OTLP_METRICS_TIMEOUT","OTEL_EXPORTER_OTLP_LOGS_TIMEOUT","OTEL_EXPORTER_JAEGER_AGENT_PORT"],P=["OTEL_NO_PATCH_MODULES","OTEL_PROPAGATORS","OTEL_SEMCONV_STABILITY_OPT_IN"],D=1/0,O={OTEL_SDK_DISABLED:!1,CONTAINER_NAME:"",ECS_CONTAINER_METADATA_URI_V4:"",ECS_CONTAINER_METADATA_URI:"",HOSTNAME:"",KUBERNETES_SERVICE_HOST:"",NAMESPACE:"",OTEL_BSP_EXPORT_TIMEOUT:3e4,OTEL_BSP_MAX_EXPORT_BATCH_SIZE:512,OTEL_BSP_MAX_QUEUE_SIZE:2048,OTEL_BSP_SCHEDULE_DELAY:5e3,OTEL_BLRP_EXPORT_TIMEOUT:3e4,OTEL_BLRP_MAX_EXPORT_BATCH_SIZE:512,OTEL_BLRP_MAX_QUEUE_SIZE:2048,OTEL_BLRP_SCHEDULE_DELAY:5e3,OTEL_EXPORTER_JAEGER_AGENT_HOST:"",OTEL_EXPORTER_JAEGER_AGENT_PORT:6832,OTEL_EXPORTER_JAEGER_ENDPOINT:"",OTEL_EXPORTER_JAEGER_PASSWORD:"",OTEL_EXPORTER_JAEGER_USER:"",OTEL_EXPORTER_OTLP_ENDPOINT:"",OTEL_EXPORTER_OTLP_TRACES_ENDPOINT:"",OTEL_EXPORTER_OTLP_METRICS_ENDPOINT:"",OTEL_EXPORTER_OTLP_LOGS_ENDPOINT:"",OTEL_EXPORTER_OTLP_HEADERS:"",OTEL_EXPORTER_OTLP_TRACES_HEADERS:"",OTEL_EXPORTER_OTLP_METRICS_HEADERS:"",OTEL_EXPORTER_OTLP_LOGS_HEADERS:"",OTEL_EXPORTER_OTLP_TIMEOUT:1e4,OTEL_EXPORTER_OTLP_TRACES_TIMEOUT:1e4,OTEL_EXPORTER_OTLP_METRICS_TIMEOUT:1e4,OTEL_EXPORTER_OTLP_LOGS_TIMEOUT:1e4,OTEL_EXPORTER_ZIPKIN_ENDPOINT:"http://localhost:9411/api/v2/spans",OTEL_LOG_LEVEL:R.DiagLogLevel.INFO,OTEL_NO_PATCH_MODULES:[],OTEL_PROPAGATORS:["tracecontext","baggage"],OTEL_RESOURCE_ATTRIBUTES:"",OTEL_SERVICE_NAME:"",OTEL_ATTRIBUTE_VALUE_LENGTH_LIMIT:D,OTEL_ATTRIBUTE_COUNT_LIMIT:128,OTEL_SPAN_ATTRIBUTE_VALUE_LENGTH_LIMIT:D,OTEL_SPAN_ATTRIBUTE_COUNT_LIMIT:128,OTEL_LOGRECORD_ATTRIBUTE_VALUE_LENGTH_LIMIT:D,OTEL_LOGRECORD_ATTRIBUTE_COUNT_LIMIT:128,OTEL_SPAN_EVENT_COUNT_LIMIT:128,OTEL_SPAN_LINK_COUNT_LIMIT:128,OTEL_SPAN_ATTRIBUTE_PER_EVENT_COUNT_LIMIT:128,OTEL_SPAN_ATTRIBUTE_PER_LINK_COUNT_LIMIT:128,OTEL_TRACES_EXPORTER:"",OTEL_TRACES_SAMPLER:d.ParentBasedAlwaysOn,OTEL_TRACES_SAMPLER_ARG:"",OTEL_LOGS_EXPORTER:"",OTEL_EXPORTER_OTLP_INSECURE:"",OTEL_EXPORTER_OTLP_TRACES_INSECURE:"",OTEL_EXPORTER_OTLP_METRICS_INSECURE:"",OTEL_EXPORTER_OTLP_LOGS_INSECURE:"",OTEL_EXPORTER_OTLP_CERTIFICATE:"",OTEL_EXPORTER_OTLP_TRACES_CERTIFICATE:"",OTEL_EXPORTER_OTLP_METRICS_CERTIFICATE:"",OTEL_EXPORTER_OTLP_LOGS_CERTIFICATE:"",OTEL_EXPORTER_OTLP_COMPRESSION:"",OTEL_EXPORTER_OTLP_TRACES_COMPRESSION:"",OTEL_EXPORTER_OTLP_METRICS_COMPRESSION:"",OTEL_EXPORTER_OTLP_LOGS_COMPRESSION:"",OTEL_EXPORTER_OTLP_CLIENT_KEY:"",OTEL_EXPORTER_OTLP_TRACES_CLIENT_KEY:"",OTEL_EXPORTER_OTLP_METRICS_CLIENT_KEY:"",OTEL_EXPORTER_OTLP_LOGS_CLIENT_KEY:"",OTEL_EXPORTER_OTLP_CLIENT_CERTIFICATE:"",OTEL_EXPORTER_OTLP_TRACES_CLIENT_CERTIFICATE:"",OTEL_EXPORTER_OTLP_METRICS_CLIENT_CERTIFICATE:"",OTEL_EXPORTER_OTLP_LOGS_CLIENT_CERTIFICATE:"",OTEL_EXPORTER_OTLP_PROTOCOL:"http/protobuf",OTEL_EXPORTER_OTLP_TRACES_PROTOCOL:"http/protobuf",OTEL_EXPORTER_OTLP_METRICS_PROTOCOL:"http/protobuf",OTEL_EXPORTER_OTLP_LOGS_PROTOCOL:"http/protobuf",OTEL_EXPORTER_OTLP_METRICS_TEMPORALITY_PREFERENCE:"cumulative",OTEL_SEMCONV_STABILITY_OPT_IN:[]},N={ALL:R.DiagLogLevel.ALL,VERBOSE:R.DiagLogLevel.VERBOSE,DEBUG:R.DiagLogLevel.DEBUG,INFO:R.DiagLogLevel.INFO,WARN:R.DiagLogLevel.WARN,ERROR:R.DiagLogLevel.ERROR,NONE:R.DiagLogLevel.NONE};function M(e){var t={};for(var n in O)if("OTEL_LOG_LEVEL"===n)!function(e,t,n){var r=n[e];if("string"==typeof r){var i=N[r.toUpperCase()];null!=i&&(t[e]=i)}}(n,t,e);else if(I.indexOf(n)>-1)!function(e,t,n){if(void 0!==n[e]){var r=String(n[e]);t[e]="true"===r.toLowerCase()}}(n,t,e);else if(A.indexOf(n)>-1)!function(e,t,n,r,i){if(void 0===r&&(r=-1/0),void 0===i&&(i=1/0),void 0!==n[e]){var o=Number(n[e]);isNaN(o)||(o<r?t[e]=r:o>i?t[e]=i:t[e]=o)}}(n,t,e);else if(P.indexOf(n)>-1)!function(e,t,n,r){void 0===r&&(r=",");var i=n[e];"string"==typeof i&&(t[e]=i.split(r).map(function(e){return e.trim()}))}(n,t,e);else{var r=e[n];null!=r&&(t[n]=String(r))}return t}var L=e.i(119468),B=("undefined"==typeof globalThis?"undefined":(0,L._)(globalThis))==="object"?globalThis:("undefined"==typeof self?"undefined":(0,L._)(self))==="object"?self:("undefined"==typeof window?"undefined":(0,L._)(window))==="object"?window:"object"===(0,L._)(e.g)?e.g:{};function V(){return Object.assign({},O,M(B))}var F=function(e){var t;_.error("string"==typeof(t=e)?t:JSON.stringify(function(e){for(var t={},n=e;null!==n;)Object.getOwnPropertyNames(n).forEach(function(e){if(!t[e]){var r=n[e];r&&(t[e]=String(r))}}),n=Object.getPrototypeOf(n);return t}(t)))};function U(e){try{F(e)}catch(e){}}var G=e.i(105823),$=function(){function e(e,t){this._exporter=e,this._isExporting=!1,this._finishedSpans=[],this._droppedSpansCount=0;var n=V();this._maxExportBatchSize="number"==typeof(null==t?void 0:t.maxExportBatchSize)?t.maxExportBatchSize:n.OTEL_BSP_MAX_EXPORT_BATCH_SIZE,this._maxQueueSize="number"==typeof(null==t?void 0:t.maxQueueSize)?t.maxQueueSize:n.OTEL_BSP_MAX_QUEUE_SIZE,this._scheduledDelayMillis="number"==typeof(null==t?void 0:t.scheduledDelayMillis)?t.scheduledDelayMillis:n.OTEL_BSP_SCHEDULE_DELAY,this._exportTimeoutMillis="number"==typeof(null==t?void 0:t.exportTimeoutMillis)?t.exportTimeoutMillis:n.OTEL_BSP_EXPORT_TIMEOUT,this._shutdownOnce=new E(this._shutdown,this),this._maxExportBatchSize>this._maxQueueSize&&(_.warn("BatchSpanProcessor: maxExportBatchSize must be smaller or equal to maxQueueSize, setting maxExportBatchSize to match maxQueueSize"),this._maxExportBatchSize=this._maxQueueSize)}return e.prototype.forceFlush=function(){return this._shutdownOnce.isCalled?this._shutdownOnce.promise:this._flushAll()},e.prototype.onStart=function(e,t){},e.prototype.onEnd=function(e){this._shutdownOnce.isCalled||(e.spanContext().traceFlags&S.TraceFlags.SAMPLED)!=0&&this._addToBuffer(e)},e.prototype.shutdown=function(){return this._shutdownOnce.call()},e.prototype._shutdown=function(){var e=this;return Promise.resolve().then(function(){return e.onShutdown()}).then(function(){return e._flushAll()}).then(function(){return e._exporter.shutdown()})},e.prototype._addToBuffer=function(e){if(this._finishedSpans.length>=this._maxQueueSize){0===this._droppedSpansCount&&_.debug("maxQueueSize reached, dropping spans"),this._droppedSpansCount++;return}this._droppedSpansCount>0&&(_.warn("Dropped "+this._droppedSpansCount+" spans because maxQueueSize reached"),this._droppedSpansCount=0),this._finishedSpans.push(e),this._maybeStartTimer()},e.prototype._flushAll=function(){var e=this;return new Promise(function(t,n){for(var r=[],i=Math.ceil(e._finishedSpans.length/e._maxExportBatchSize),o=0;o<i;o++)r.push(e._flushOneBatch());Promise.all(r).then(function(){t()}).catch(n)})},e.prototype._flushOneBatch=function(){var e=this;return(this._clearTimer(),0===this._finishedSpans.length)?Promise.resolve():new Promise(function(t,n){var r=setTimeout(function(){n(Error("Timeout"))},e._exportTimeoutMillis);k.context.with((0,G.suppressTracing)(k.context.active()),function(){e._finishedSpans.length<=e._maxExportBatchSize?(i=e._finishedSpans,e._finishedSpans=[]):i=e._finishedSpans.splice(0,e._maxExportBatchSize);for(var i,o=function(){return e._exporter.export(i,function(e){var i;clearTimeout(r),e.code===c.SUCCESS?t():n(null!=(i=e.error)?i:Error("BatchSpanProcessor: span export failed"))})},a=null,s=0,l=i.length;s<l;s++){var u=i[s];u.resource.asyncAttributesPending&&u.resource.waitForAsyncAttributes&&(null!=a||(a=[]),a.push(u.resource.waitForAsyncAttributes()))}null===a?o():Promise.all(a).then(o,function(e){U(e),n(e)})})})},e.prototype._maybeStartTimer=function(){var e=this;if(!this._isExporting){var t=function(){e._isExporting=!0,e._flushOneBatch().finally(function(){e._isExporting=!1,e._finishedSpans.length>0&&(e._clearTimer(),e._maybeStartTimer())}).catch(function(t){e._isExporting=!1,U(t)})};if(this._finishedSpans.length>=this._maxExportBatchSize)return t();void 0===this._timer&&(this._timer=setTimeout(function(){return t()},this._scheduledDelayMillis),this._timer)}},e.prototype._clearTimer=function(){void 0!==this._timer&&(clearTimeout(this._timer),this._timer=void 0)},e}(),z=(o=function(e,t){return(o=Object.setPrototypeOf||(0,w._)({__proto__:[]},Array)&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),H=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.onInit(n),r}return z(t,e),t.prototype.onInit=function(e){var t=this;(null==e?void 0:e.disableAutoFlushOnDocumentHide)!==!0&&"undefined"!=typeof document&&(this._visibilityChangeListener=function(){"hidden"===document.visibilityState&&t.forceFlush().catch(function(e){U(e)})},this._pageHideListener=function(){t.forceFlush().catch(function(e){U(e)})},document.addEventListener("visibilitychange",this._visibilityChangeListener),document.addEventListener("pagehide",this._pageHideListener))},t.prototype.onShutdown=function(){"undefined"!=typeof document&&(this._visibilityChangeListener&&document.removeEventListener("visibilitychange",this._visibilityChangeListener),this._pageHideListener&&document.removeEventListener("pagehide",this._pageHideListener))},t}($),W=e.i(993796),q=e.i(297083),K=e.i(904851),Y=e.i(90659),Q=e.i(817556),X=e.i(664152),J=new(function(){function e(){(0,K._)(this,e)}return(0,Y._)(e,[{key:"export",value:function(e,t){var n=new Map,r=!0,i=!1,o=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done);r=!0){var l,u=a.value,d=u.spanContext(),f={name:u.name,service:"repl.it-web",trace_id:d.traceId,span_id:d.spanId,start:u.startTime,end:u.endTime,parent_id:u.parentSpanId,attributes:u.attributes};n.has(d.traceId)||n.set(d.traceId,[]),null==(l=n.get(d.traceId))||l.push(f)}}catch(e){i=!0,o=e}finally{try{r||null==s.return||s.return()}finally{if(i)throw o}}var p=Array.from(n.values());if(0===p.length)return void t({code:c.SUCCESS});var h=(0,X.getReplContext)();fetch("/datadog/traces",{method:"POST",credentials:"include",headers:{"Content-Type":"application/json","X-Requested-With":"fetch"},body:JSON.stringify({repl:{id:null==h?void 0:h.id,rootOriginReplUrl:null==h?void 0:h.rootOriginReplUrl},traces:p})}).then(function(){t({code:c.SUCCESS})}).catch(function(e){X.logger.error("Failed to send traces to Datadog: ".concat(e.message)),t({code:c.FAILED,error:e.message})})}},{key:"shutdown",value:function(){return(0,q._)(function(){return(0,Q._)(this,function(e){return[2]})})()}},{key:"forceFlush",value:function(){return(0,q._)(function(){return(0,Q._)(this,function(e){return[2]})})()}}]),e}()),Z=e.i(399119),ee=e.i(721281),et=e.i(663355),en=e.i(862470),er=e.i(445789),ei=e.i(468930),eo=e.i(164760);(a=f||(f={}))[a.NOT_RECORD=0]="NOT_RECORD",a[a.RECORD=1]="RECORD",a[a.RECORD_AND_SAMPLED=2]="RECORD_AND_SAMPLED";var ea=e.i(846806),es=function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},el=function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,i,o=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(e){i={error:e}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a};function eu(e){var t,n,r={};if((void 0===e?"undefined":(0,L._)(e))!=="object"||null==e)return r;try{for(var i=es(Object.entries(e)),o=i.next();!o.done;o=i.next()){var a,s=el(o.value,2),l=s[0],u=s[1];if(a=l,"string"!=typeof a||!(a.length>0)){_.warn("Invalid attribute key: "+l);continue}if(!ec(u)){_.warn("Invalid attribute value set for key: "+l);continue}Array.isArray(u)?r[l]=u.slice():r[l]=u}}catch(e){t={error:e}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(t)throw t.error}}return r}function ec(e){return null==e||(Array.isArray(e)?function(e){try{for(var t,n,r,i=es(e),o=i.next();!o.done;o=i.next()){var a=o.value;if(null!=a){if(!r){if(ed(a)){r=void 0===a?"undefined":(0,L._)(a);continue}return!1}if((void 0===a?"undefined":(0,L._)(a))!==r)return!1}}}catch(e){t={error:e}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(t)throw t.error}}return!0}(e):ed(e))}function ed(e){switch(void 0===e?"undefined":(0,L._)(e)){case"number":case"boolean":case"string":return!0}return!1}var ef=e.i(619379),ep=performance;function eh(e){return[Math.trunc(e/1e3),Math.round(e%1e3*1e6)]}function eg(){var e=ep.timeOrigin;return"number"!=typeof e&&(e=ep.timing&&ep.timing.fetchStart),e}function em(e){return Array.isArray(e)&&2===e.length&&"number"==typeof e[0]&&"number"==typeof e[1]}function ev(e){return em(e)||"number"==typeof e||(0,w._)(e,Date)}function ex(e,t){var n=[e[0]+t[0],e[1]+t[1]];return n[1]>=1e9&&(n[1]-=1e9,n[0]+=1),n}var ey="exception.type",eb="exception.message",ew=function(){return(ew=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},ek=function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},e_=function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,i,o=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(e){i={error:e}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a},eS=function(e,t,n){if(n||2==arguments.length)for(var r,i=0,o=t.length;i<o;i++)!r&&i in t||(r||(r=Array.prototype.slice.call(t,0,i)),r[i]=t[i]);return e.concat(r||Array.prototype.slice.call(t))},eC=function(){function e(e,t,n,r,i,o,a,s,l,u){void 0===a&&(a=[]),this.attributes={},this.links=[],this.events=[],this._droppedAttributesCount=0,this._droppedEventsCount=0,this._droppedLinksCount=0,this.status={code:ef.SpanStatusCode.UNSET},this.endTime=[0,0],this._ended=!1,this._duration=[-1,-1],this.name=n,this._spanContext=r,this.parentSpanId=o,this.kind=i,this.links=a;var c=Date.now();this._performanceStartTime=ep.now(),this._performanceOffset=c-(this._performanceStartTime+eg()),this._startTimeProvided=null!=s,this.startTime=this._getTime(null!=s?s:c),this.resource=e.resource,this.instrumentationLibrary=e.instrumentationLibrary,this._spanLimits=e.getSpanLimits(),this._attributeValueLengthLimit=this._spanLimits.attributeValueLengthLimit||0,null!=u&&this.setAttributes(u),this._spanProcessor=e.getActiveSpanProcessor(),this._spanProcessor.onStart(this,t)}return e.prototype.spanContext=function(){return this._spanContext},e.prototype.setAttribute=function(e,t){return null==t||this._isSpanEnded()||(0===e.length?_.warn("Invalid attribute key: "+e):ec(t)?Object.keys(this.attributes).length>=this._spanLimits.attributeCountLimit&&!Object.prototype.hasOwnProperty.call(this.attributes,e)?this._droppedAttributesCount++:this.attributes[e]=this._truncateToSize(t):_.warn("Invalid attribute value set for key: "+e)),this},e.prototype.setAttributes=function(e){var t,n;try{for(var r=ek(Object.entries(e)),i=r.next();!i.done;i=r.next()){var o=e_(i.value,2),a=o[0],s=o[1];this.setAttribute(a,s)}}catch(e){t={error:e}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(t)throw t.error}}return this},e.prototype.addEvent=function(e,t,n){if(this._isSpanEnded())return this;if(0===this._spanLimits.eventCountLimit)return _.warn("No events allowed."),this._droppedEventsCount++,this;this.events.length>=this._spanLimits.eventCountLimit&&(0===this._droppedEventsCount&&_.debug("Dropping extra events."),this.events.shift(),this._droppedEventsCount++),ev(t)&&(ev(n)||(n=t),t=void 0);var r=eu(t);return this.events.push({name:e,attributes:r,time:this._getTime(n),droppedAttributesCount:0}),this},e.prototype.addLink=function(e){return this.links.push(e),this},e.prototype.addLinks=function(e){var t;return(t=this.links).push.apply(t,eS([],e_(e),!1)),this},e.prototype.setStatus=function(e){return this._isSpanEnded()||(this.status=ew({},e),null!=this.status.message&&"string"!=typeof e.message&&(_.warn("Dropping invalid status.message of type '"+(0,L._)(e.message)+"', expected 'string'"),delete this.status.message)),this},e.prototype.updateName=function(e){return this._isSpanEnded()||(this.name=e),this},e.prototype.end=function(e){var t,n,r,i;this._isSpanEnded()?_.error(this.name+" "+this._spanContext.traceId+"-"+this._spanContext.spanId+" - You can only call end() on a span once."):(this._ended=!0,this.endTime=this._getTime(e),this._duration=(t=this.startTime,r=(n=this.endTime)[0]-t[0],(i=n[1]-t[1])<0&&(r-=1,i+=1e9),[r,i]),this._duration[0]<0&&(_.warn("Inconsistent start and end time, startTime > endTime. Setting span duration to 0ms.",this.startTime,this.endTime),this.endTime=this.startTime.slice(),this._duration=[0,0]),this._droppedEventsCount>0&&_.warn("Dropped "+this._droppedEventsCount+" events because eventCountLimit reached"),this._spanProcessor.onEnd(this))},e.prototype._getTime=function(e){if("number"==typeof e&&e<=ep.now()){var t;return t=e+this._performanceOffset,ex(eh(eg()),eh("number"==typeof t?t:ep.now()))}if("number"==typeof e)return eh(e);if((0,w._)(e,Date))return eh(e.getTime());if(em(e))return e;if(this._startTimeProvided)return eh(Date.now());var n=ep.now()-this._performanceStartTime;return ex(this.startTime,eh(n))},e.prototype.isRecording=function(){return!1===this._ended},e.prototype.recordException=function(e,t){var n={};"string"==typeof e?n[eb]=e:e&&(e.code?n[ey]=e.code.toString():e.name&&(n[ey]=e.name),e.message&&(n[eb]=e.message),e.stack&&(n["exception.stacktrace"]=e.stack)),n[ey]||n[eb]?this.addEvent("exception",n,t):_.warn("Failed to record an exception "+e)},Object.defineProperty(e.prototype,"duration",{get:function(){return this._duration},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"ended",{get:function(){return this._ended},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"droppedAttributesCount",{get:function(){return this._droppedAttributesCount},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"droppedEventsCount",{get:function(){return this._droppedEventsCount},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"droppedLinksCount",{get:function(){return this._droppedLinksCount},enumerable:!1,configurable:!0}),e.prototype._isSpanEnded=function(){return this._ended&&_.warn("Can not execute the operation on ended Span {traceId: "+this._spanContext.traceId+", spanId: "+this._spanContext.spanId+"}"),this._ended},e.prototype._truncateToLimitUtil=function(e,t){return e.length<=t?e:e.substring(0,t)},e.prototype._truncateToSize=function(e){var t=this,n=this._attributeValueLengthLimit;return n<=0?(_.warn("Attribute value limit must be positive, got "+n),e):"string"==typeof e?this._truncateToLimitUtil(e,n):Array.isArray(e)?e.map(function(e){return"string"==typeof e?t._truncateToLimitUtil(e,n):e}):e},e}();(s=p||(p={}))[s.NOT_RECORD=0]="NOT_RECORD",s[s.RECORD=1]="RECORD",s[s.RECORD_AND_SAMPLED=2]="RECORD_AND_SAMPLED";var ej=function(){function e(){}return e.prototype.shouldSample=function(){return{decision:p.NOT_RECORD}},e.prototype.toString=function(){return"AlwaysOffSampler"},e}(),eT=function(){function e(){}return e.prototype.shouldSample=function(){return{decision:p.RECORD_AND_SAMPLED}},e.prototype.toString=function(){return"AlwaysOnSampler"},e}(),eE=e.i(548452),eR=function(){function e(e){var t,n,r,i;this._root=e.root,this._root||(U(Error("ParentBasedSampler must have a root sampler configured")),this._root=new eT),this._remoteParentSampled=null!=(t=e.remoteParentSampled)?t:new eT,this._remoteParentNotSampled=null!=(n=e.remoteParentNotSampled)?n:new ej,this._localParentSampled=null!=(r=e.localParentSampled)?r:new eT,this._localParentNotSampled=null!=(i=e.localParentNotSampled)?i:new ej}return e.prototype.shouldSample=function(e,t,n,r,i,o){var a=ei.trace.getSpanContext(e);return a&&(0,eE.isSpanContextValid)(a)?a.isRemote?a.traceFlags&S.TraceFlags.SAMPLED?this._remoteParentSampled.shouldSample(e,t,n,r,i,o):this._remoteParentNotSampled.shouldSample(e,t,n,r,i,o):a.traceFlags&S.TraceFlags.SAMPLED?this._localParentSampled.shouldSample(e,t,n,r,i,o):this._localParentNotSampled.shouldSample(e,t,n,r,i,o):this._root.shouldSample(e,t,n,r,i,o)},e.prototype.toString=function(){return"ParentBased{root="+this._root.toString()+", remoteParentSampled="+this._remoteParentSampled.toString()+", remoteParentNotSampled="+this._remoteParentNotSampled.toString()+", localParentSampled="+this._localParentSampled.toString()+", localParentNotSampled="+this._localParentNotSampled.toString()+"}"},e}(),eI=function(){function e(e){void 0===e&&(e=0),this._ratio=e,this._ratio=this._normalize(e),this._upperBound=Math.floor(0xffffffff*this._ratio)}return e.prototype.shouldSample=function(e,t){return{decision:(0,eE.isValidTraceId)(t)&&this._accumulate(t)<this._upperBound?p.RECORD_AND_SAMPLED:p.NOT_RECORD}},e.prototype.toString=function(){return"TraceIdRatioBased{"+this._ratio+"}"},e.prototype._normalize=function(e){return"number"!=typeof e||isNaN(e)?0:e>=1?1:e<=0?0:e},e.prototype._accumulate=function(e){for(var t=0,n=0;n<e.length/8;n++){var r=8*n;t=(t^parseInt(e.slice(r,r+8),16))>>>0}return t},e}(),eA=d.AlwaysOn;function eP(){var e=V();return{sampler:eD(e),forceFlushTimeoutMillis:3e4,generalLimits:{attributeValueLengthLimit:e.OTEL_ATTRIBUTE_VALUE_LENGTH_LIMIT,attributeCountLimit:e.OTEL_ATTRIBUTE_COUNT_LIMIT},spanLimits:{attributeValueLengthLimit:e.OTEL_SPAN_ATTRIBUTE_VALUE_LENGTH_LIMIT,attributeCountLimit:e.OTEL_SPAN_ATTRIBUTE_COUNT_LIMIT,linkCountLimit:e.OTEL_SPAN_LINK_COUNT_LIMIT,eventCountLimit:e.OTEL_SPAN_EVENT_COUNT_LIMIT,attributePerEventCountLimit:e.OTEL_SPAN_ATTRIBUTE_PER_EVENT_COUNT_LIMIT,attributePerLinkCountLimit:e.OTEL_SPAN_ATTRIBUTE_PER_LINK_COUNT_LIMIT},mergeResourceWithDefaults:!0}}function eD(e){switch(void 0===e&&(e=V()),e.OTEL_TRACES_SAMPLER){case d.AlwaysOn:return new eT;case d.AlwaysOff:return new ej;case d.ParentBasedAlwaysOn:return new eR({root:new eT});case d.ParentBasedAlwaysOff:return new eR({root:new ej});case d.TraceIdRatio:return new eI(eO(e));case d.ParentBasedTraceIdRatio:return new eR({root:new eI(eO(e))});default:return _.error('OTEL_TRACES_SAMPLER value "'+e.OTEL_TRACES_SAMPLER+" invalid, defaulting to "+eA+'".'),new eT}}function eO(e){if(void 0===e.OTEL_TRACES_SAMPLER_ARG||""===e.OTEL_TRACES_SAMPLER_ARG)return _.error("OTEL_TRACES_SAMPLER_ARG is blank, defaulting to 1."),1;var t=Number(e.OTEL_TRACES_SAMPLER_ARG);return isNaN(t)?(_.error("OTEL_TRACES_SAMPLER_ARG="+e.OTEL_TRACES_SAMPLER_ARG+" was given, but it is invalid, defaulting to 1."),1):t<0||t>1?(_.error("OTEL_TRACES_SAMPLER_ARG="+e.OTEL_TRACES_SAMPLER_ARG+" was given, but it is out of range ([0..1]), defaulting to 1."),1):t}var eN=function(){this.generateTraceId=eL(16),this.generateSpanId=eL(8)},eM=Array(32);function eL(e){return function(){for(var t=0;t<2*e;t++)eM[t]=Math.floor(16*Math.random())+48,eM[t]>=58&&(eM[t]+=39);return String.fromCharCode.apply(null,eM.slice(0,2*e))}}var eB=function(){function e(e,t,n){this._tracerProvider=n;var r,i,o,a=(r={sampler:eD()},(o=Object.assign({},i=eP(),r,t)).generalLimits=Object.assign({},i.generalLimits,t.generalLimits||{}),o.spanLimits=Object.assign({},i.spanLimits,t.spanLimits||{}),o);this._sampler=a.sampler,this._generalLimits=a.generalLimits,this._spanLimits=a.spanLimits,this._idGenerator=t.idGenerator||new eN,this.resource=n.resource,this.instrumentationLibrary=e}return e.prototype.startSpan=function(e,t,n){void 0===t&&(t={}),void 0===n&&(n=k.context.active()),t.root&&(n=ei.trace.deleteSpan(n));var r,i,o,a,s,l,u=ei.trace.getSpan(n);if((0,G.isTracingSuppressed)(n)){_.debug("Instrumentation suppressed, returning Noop Span");var c=ei.trace.wrapSpanContext(ea.INVALID_SPAN_CONTEXT);return c}var d=null==u?void 0:u.spanContext(),p=this._idGenerator.generateSpanId();d&&ei.trace.isSpanContextValid(d)?(a=d.traceId,s=d.traceState,l=d.spanId):a=this._idGenerator.generateTraceId();var h=null!=(r=t.kind)?r:eo.SpanKind.INTERNAL,g=(null!=(i=t.links)?i:[]).map(function(e){return{context:e.context,attributes:eu(e.attributes)}}),m=eu(t.attributes),x=this._sampler.shouldSample(n,a,e,h,m,g);s=null!=(o=x.traceState)?o:s;var y={traceId:a,spanId:p,traceFlags:x.decision===f.RECORD_AND_SAMPLED?S.TraceFlags.SAMPLED:S.TraceFlags.NONE,traceState:s};if(x.decision===f.NOT_RECORD){_.debug("Recording is off, propagating context in a non-recording span");var c=ei.trace.wrapSpanContext(y);return c}var b=eu(Object.assign(m,x.attributes));return new eC(this,n,e,y,h,l,g,t.startTime,void 0,b)},e.prototype.startActiveSpan=function(e,t,n,r){if(!(arguments.length<2)){2==arguments.length?a=t:3==arguments.length?(i=t,a=n):(i=t,o=n,a=r);var i,o,a,s=null!=o?o:k.context.active(),l=this.startSpan(e,i,s),u=ei.trace.setSpan(s,l);return k.context.with(u,a,void 0,l)}},e.prototype.getGeneralLimits=function(){return this._generalLimits},e.prototype.getSpanLimits=function(){return this._spanLimits},e.prototype.getActiveSpanProcessor=function(){return this._tracerProvider.getActiveSpanProcessor()},e}(),eV=e.i(364520),eF=function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},eU=function(){function e(e){var t;void 0===e&&(e={}),this._propagators=null!=(t=e.propagators)?t:[],this._fields=Array.from(new Set(this._propagators.map(function(e){return"function"==typeof e.fields?e.fields():[]}).reduce(function(e,t){return e.concat(t)},[])))}return e.prototype.inject=function(e,t,n){var r,i;try{for(var o=eF(this._propagators),a=o.next();!a.done;a=o.next()){var s=a.value;try{s.inject(e,t,n)}catch(e){_.warn("Failed to inject with "+s.constructor.name+". Err: "+e.message)}}}catch(e){r={error:e}}finally{try{a&&!a.done&&(i=o.return)&&i.call(o)}finally{if(r)throw r.error}}},e.prototype.extract=function(e,t,n){return this._propagators.reduce(function(e,r){try{return r.extract(e,t,n)}catch(e){_.warn("Failed to extract with "+r.constructor.name+". Err: "+e.message)}return e},e)},e.prototype.fields=function(){return this._fields.slice()},e}(),eG="baggage",e$=e.i(472278),ez=function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,i,o=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(e){i={error:e}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a},eH=function(){function e(){}return e.prototype.inject=function(e,t,n){var r=eV.propagation.getBaggage(e);if(!(!r||(0,G.isTracingSuppressed)(e))){var i=r.getAllEntries().map(function(e){var t=ez(e,2),n=t[0],r=t[1],i=encodeURIComponent(n)+"="+encodeURIComponent(r.value);return void 0!==r.metadata&&(i+=";"+r.metadata.toString()),i}).filter(function(e){return e.length<=4096}).slice(0,180).reduce(function(e,t){var n=""+e+(""!==e?",":"")+t;return n.length>8192?e:n},"");i.length>0&&n.set(t,eG,i)}},e.prototype.extract=function(e,t,n){var r=n.get(t,eG),i=Array.isArray(r)?r.join(","):r;if(!i)return e;var o={};return 0===i.length||(i.split(",").forEach(function(e){var t=function(e){var t,n=e.split(";");if(!(n.length<=0)){var r=n.shift();if(r){var i=r.indexOf("=");if(!(i<=0)){var o=decodeURIComponent(r.substring(0,i).trim()),a=decodeURIComponent(r.substring(i+1).trim());return n.length>0&&(t=(0,e$.baggageEntryMetadataFromString)(n.join(";"))),{key:o,value:a,metadata:t}}}}}(e);if(t){var n={value:t.value};t.metadata&&(n.metadata=t.metadata),o[t.key]=n}}),0===Object.entries(o).length)?e:eV.propagation.setBaggage(e,eV.propagation.createBaggage(o))},e.prototype.fields=function(){return[eG]},e}(),eW=Function.prototype.toString,eq=eW.call(Object),eK=(t=Object.getPrototypeOf,n=Object,function(e){return t(n(e))}),eY=Object.prototype,eQ=eY.hasOwnProperty,eX=Symbol?Symbol.toStringTag:void 0,eJ=eY.toString;function eZ(e){if(null==(t=e)||(void 0===t?"undefined":(0,L._)(t))!="object"||"[object Object]"!==(null==(n=e)?void 0===n?"[object Undefined]":"[object Null]":eX&&eX in Object(n)?function(e){var t=eQ.call(e,eX),n=e[eX],r=!1;try{e[eX]=void 0,r=!0}catch(e){}var i=eJ.call(e);return r&&(t?e[eX]=n:delete e[eX]),i}(n):(r=n,eJ.call(r))))return!1;var t,n,r,i=eK(e);if(null===i)return!0;var o=eQ.call(i,"constructor")&&i.constructor;return"function"==typeof o&&(0,w._)(o,o)&&eW.call(o)===eq}function e0(e){return e2(e)?e.slice():e}function e1(e,t,n){for(var r=n.get(e[t])||[],i=0,o=r.length;i<o;i++){var a=r[i];if(a.key===t&&a.obj===e)return!0}return!1}function e2(e){return Array.isArray(e)}function e3(e){return"function"==typeof e}function e4(e){return!e8(e)&&!e2(e)&&!e3(e)&&(void 0===e?"undefined":(0,L._)(e))==="object"}function e8(e){return"string"==typeof e||"number"==typeof e||"boolean"==typeof e||void 0===e||(0,w._)(e,Date)||(0,w._)(e,RegExp)||null===e}var e5="telemetry.sdk.name",e6="telemetry.sdk.language",e9="telemetry.sdk.version",e7=((h={})[e5]="opentelemetry",h["process.runtime.name"]="browser",h[e6]="webjs",h[e9]="1.30.1",h),te=function(){return(te=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},tt=function(e,t){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){var l=[o,s];if(n)throw TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&l[0]?r.return:l[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,l[1])).done)return i;switch(r=0,i&&(l=[2&l[0],i.value]),l[0]){case 0:case 1:i=l;break;case 4:return a.label++,{value:l[1],done:!1};case 5:a.label++,r=l[1],l=[0];continue;case 7:l=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===l[0]||2===l[0])){a=0;continue}if(3===l[0]&&(!i||l[1]>i[0]&&l[1]<i[3])){a.label=l[1];break}if(6===l[0]&&a.label<i[1]){a.label=i[1],i=l;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(l);break}i[2]&&a.ops.pop(),a.trys.pop();continue}l=t.call(e,a)}catch(e){l=[6,e],r=0}finally{n=i=0}if(5&l[0])throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}}},tn=function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,i,o=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(e){i={error:e}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a},tr=function(){function e(e,t){var n,r=this;this._attributes=e,this.asyncAttributesPending=null!=t,this._syncAttributes=null!=(n=this._attributes)?n:{},this._asyncAttributesPromise=null==t?void 0:t.then(function(e){return r._attributes=Object.assign({},r._attributes,e),r.asyncAttributesPending=!1,e},function(e){return _.debug("a resource's async attributes promise rejected: %s",e),r.asyncAttributesPending=!1,{}})}return e.empty=function(){return e.EMPTY},e.default=function(){var t;return new e(((t={})["service.name"]="unknown_service",t[e6]=e7[e6],t[e5]=e7[e5],t[e9]=e7[e9],t))},Object.defineProperty(e.prototype,"attributes",{get:function(){var e;return this.asyncAttributesPending&&_.error("Accessing resource attributes before async attributes settled"),null!=(e=this._attributes)?e:{}},enumerable:!1,configurable:!0}),e.prototype.waitForAsyncAttributes=function(){var e,t,n,r;return e=this,t=void 0,n=void 0,r=function(){return tt(this,function(e){switch(e.label){case 0:if(!this.asyncAttributesPending)return[3,2];return[4,this._asyncAttributesPromise];case 1:e.sent(),e.label=2;case 2:return[2]}})},new(n||(n=Promise))(function(i,o){function a(e){try{l(r.next(e))}catch(e){o(e)}}function s(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,(0,w._)(t,n)?t:new n(function(e){e(t)})).then(a,s)}l((r=r.apply(e,t||[])).next())})},e.prototype.merge=function(t){var n,r=this;if(!t)return this;var i=te(te({},this._syncAttributes),null!=(n=t._syncAttributes)?n:t.attributes);return this._asyncAttributesPromise||t._asyncAttributesPromise?new e(i,Promise.all([this._asyncAttributesPromise,t._asyncAttributesPromise]).then(function(e){var n,i=tn(e,2),o=i[0],a=i[1];return te(te(te(te({},r._syncAttributes),o),null!=(n=t._syncAttributes)?n:t.attributes),a)})):new e(i)},e.EMPTY=new e({}),e}(),ti=function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},to=function(){function e(e){this._spanProcessors=e}return e.prototype.forceFlush=function(){var e,t,n=[];try{for(var r=ti(this._spanProcessors),i=r.next();!i.done;i=r.next()){var o=i.value;n.push(o.forceFlush())}}catch(t){e={error:t}}finally{try{i&&!i.done&&(t=r.return)&&t.call(r)}finally{if(e)throw e.error}}return new Promise(function(e){Promise.all(n).then(function(){e()}).catch(function(t){U(t||Error("MultiSpanProcessor: forceFlush failed")),e()})})},e.prototype.onStart=function(e,t){var n,r;try{for(var i=ti(this._spanProcessors),o=i.next();!o.done;o=i.next())o.value.onStart(e,t)}catch(e){n={error:e}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}},e.prototype.onEnd=function(e){var t,n;try{for(var r=ti(this._spanProcessors),i=r.next();!i.done;i=r.next())i.value.onEnd(e)}catch(e){t={error:e}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(t)throw t.error}}},e.prototype.shutdown=function(){var e,t,n=[];try{for(var r=ti(this._spanProcessors),i=r.next();!i.done;i=r.next()){var o=i.value;n.push(o.shutdown())}}catch(t){e={error:t}}finally{try{i&&!i.done&&(t=r.return)&&t.call(r)}finally{if(e)throw e.error}}return new Promise(function(e,t){Promise.all(n).then(function(){e()},t)})},e}(),ta=function(){function e(){}return e.prototype.onStart=function(e,t){},e.prototype.onEnd=function(e){},e.prototype.shutdown=function(){return Promise.resolve()},e.prototype.forceFlush=function(){return Promise.resolve()},e}(),ts=function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,i,o=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(e){i={error:e}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a},tl=function(e,t,n){if(n||2==arguments.length)for(var r,i=0,o=t.length;i<o;i++)!r&&i in t||(r||(r=Array.prototype.slice.call(t,0,i)),r[i]=t[i]);return e.concat(r||Array.prototype.slice.call(t))};(l=g||(g={}))[l.resolved=0]="resolved",l[l.timeout=1]="timeout",l[l.error=2]="error",l[l.unresolved=3]="unresolved";var tu=function(){function e(e){void 0===e&&(e={}),this._registeredSpanProcessors=[],this._tracers=new Map;var t,n,r,i,o,a,s,l,u,c,d,f,p,h,g,m,x,y=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];for(var n=e.shift(),r=new WeakMap;e.length>0;)n=function e(t,n,r,i){if(void 0===r&&(r=0),!(r>20)){if(r++,e8(t)||e8(n)||e3(n))s=e0(n);else if(e2(t)){if(s=t.slice(),e2(n))for(var o,a,s,l=0,u=n.length;l<u;l++)s.push(e0(n[l]));else if(e4(n))for(var c=Object.keys(n),l=0,u=c.length;l<u;l++){var d=c[l];s[d]=e0(n[d])}}else if(e4(t))if(e4(n)){if(o=t,a=n,!(eZ(o)&&eZ(a)))return n;s=Object.assign({},t);for(var c=Object.keys(n),l=0,u=c.length;l<u;l++){var d=c[l],f=n[d];if(e8(f))void 0===f?delete s[d]:s[d]=f;else{var p=s[d];if(e1(t,d,i)||e1(n,d,i))delete s[d];else{if(e4(p)&&e4(f)){var h=i.get(p)||[],g=i.get(f)||[];h.push({obj:t,key:d}),g.push({obj:n,key:d}),i.set(p,h),i.set(f,g)}s[d]=e(s[d],f,r,i)}}}}else s=n;return s}}(n,e.shift(),0,r);return n}({},eP(),(h=Object.assign({},(t=e).spanLimits),g=M(B),h.attributeCountLimit=null!=(s=null!=(a=null!=(o=null!=(r=null==(n=t.spanLimits)?void 0:n.attributeCountLimit)?r:null==(i=t.generalLimits)?void 0:i.attributeCountLimit)?o:g.OTEL_SPAN_ATTRIBUTE_COUNT_LIMIT)?a:g.OTEL_ATTRIBUTE_COUNT_LIMIT)?s:128,h.attributeValueLengthLimit=null!=(p=null!=(f=null!=(d=null!=(u=null==(l=t.spanLimits)?void 0:l.attributeValueLengthLimit)?u:null==(c=t.generalLimits)?void 0:c.attributeValueLengthLimit)?d:g.OTEL_SPAN_ATTRIBUTE_VALUE_LENGTH_LIMIT)?f:g.OTEL_ATTRIBUTE_VALUE_LENGTH_LIMIT)?p:D,Object.assign({},t,{spanLimits:h})));if(this.resource=null!=(m=y.resource)?m:tr.empty(),y.mergeResourceWithDefaults&&(this.resource=tr.default().merge(this.resource)),this._config=Object.assign({},y,{resource:this.resource}),null==(x=e.spanProcessors)?void 0:x.length)this._registeredSpanProcessors=tl([],ts(e.spanProcessors),!1),this.activeSpanProcessor=new to(this._registeredSpanProcessors);else{var b=this._buildExporterFromEnv();if(void 0!==b){var w=new H(b);this.activeSpanProcessor=w}else this.activeSpanProcessor=new ta}}return e.prototype.getTracer=function(e,t,n){var r=e+"@"+(t||"")+":"+((null==n?void 0:n.schemaUrl)||"");return this._tracers.has(r)||this._tracers.set(r,new eB({name:e,version:t,schemaUrl:null==n?void 0:n.schemaUrl},this._config,this)),this._tracers.get(r)},e.prototype.addSpanProcessor=function(e){0===this._registeredSpanProcessors.length&&this.activeSpanProcessor.shutdown().catch(function(e){return _.error("Error while trying to shutdown current span processor",e)}),this._registeredSpanProcessors.push(e),this.activeSpanProcessor=new to(this._registeredSpanProcessors)},e.prototype.getActiveSpanProcessor=function(){return this.activeSpanProcessor},e.prototype.register=function(e){void 0===e&&(e={}),ei.trace.setGlobalTracerProvider(this),void 0===e.propagator&&(e.propagator=this._buildPropagatorFromEnv()),e.contextManager&&k.context.setGlobalContextManager(e.contextManager),e.propagator&&eV.propagation.setGlobalPropagator(e.propagator)},e.prototype.forceFlush=function(){var e=this._config.forceFlushTimeoutMillis,t=this._registeredSpanProcessors.map(function(t){return new Promise(function(n){var r,i=setTimeout(function(){n(Error("Span processor did not completed within timeout period of "+e+" ms")),r=g.timeout},e);t.forceFlush().then(function(){clearTimeout(i),r!==g.timeout&&n(r=g.resolved)}).catch(function(e){clearTimeout(i),r=g.error,n(e)})})});return new Promise(function(e,n){Promise.all(t).then(function(t){var r=t.filter(function(e){return e!==g.resolved});r.length>0?n(r):e()}).catch(function(e){return n([e])})})},e.prototype.shutdown=function(){return this.activeSpanProcessor.shutdown()},e.prototype._getPropagator=function(e){var t;return null==(t=this.constructor._registeredPropagators.get(e))?void 0:t()},e.prototype._getSpanExporter=function(e){var t;return null==(t=this.constructor._registeredExporters.get(e))?void 0:t()},e.prototype._buildPropagatorFromEnv=function(){var e=this,t=Array.from(new Set(V().OTEL_PROPAGATORS)),n=t.map(function(t){var n=e._getPropagator(t);return n||_.warn('Propagator "'+t+'" requested through environment variable is unavailable.'),n}).reduce(function(e,t){return t&&e.push(t),e},[]);return 0===n.length?void 0:1===t.length?n[0]:new eU({propagators:n})},e.prototype._buildExporterFromEnv=function(){var e=V().OTEL_TRACES_EXPORTER;if("none"!==e&&""!==e){var t=this._getSpanExporter(e);return t||_.error('Exporter "'+e+'" requested through environment variable is unavailable.'),t}},e._registeredPropagators=new Map([["tracecontext",function(){return new b.W3CTraceContextPropagator}],["baggage",function(){return new eH}]]),e._registeredExporters=new Map,e}(),tc=e.i(908564),td=function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,i,o=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(e){i={error:e}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a},tf=function(e,t,n){if(n||2==arguments.length)for(var r,i=0,o=t.length;i<o;i++)!r&&i in t||(r||(r=Array.prototype.slice.call(t,0,i)),r[i]=t[i]);return e.concat(r||Array.prototype.slice.call(t))},tp=function(){function e(){this._enabled=!1,this._currentContext=tc.ROOT_CONTEXT}return e.prototype._bindFunction=function(e,t){void 0===e&&(e=tc.ROOT_CONTEXT);var n=this,r=function(){for(var r=this,i=[],o=0;o<arguments.length;o++)i[o]=arguments[o];return n.with(e,function(){return t.apply(r,i)})};return Object.defineProperty(r,"length",{enumerable:!1,configurable:!0,writable:!1,value:t.length}),r},e.prototype.active=function(){return this._currentContext},e.prototype.bind=function(e,t){return(void 0===e&&(e=this.active()),"function"==typeof t)?this._bindFunction(e,t):t},e.prototype.disable=function(){return this._currentContext=tc.ROOT_CONTEXT,this._enabled=!1,this},e.prototype.enable=function(){return this._enabled||(this._enabled=!0,this._currentContext=tc.ROOT_CONTEXT),this},e.prototype.with=function(e,t,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];var o=this._currentContext;this._currentContext=e||tc.ROOT_CONTEXT;try{return t.call.apply(t,tf([n],td(r),!1))}finally{this._currentContext=o}},e}(),th=(u=function(e,t){return(u=Object.setPrototypeOf||(0,w._)({__proto__:[]},Array)&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}u(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),tg=function(e){function t(t){void 0===t&&(t={});var n=e.call(this,t)||this;if(t.contextManager)throw"contextManager should be defined in register method not in constructor";if(t.propagator)throw"propagator should be defined in register method not in constructor";return n}return th(t,e),t.prototype.register=function(t){void 0===t&&(t={}),void 0===t.contextManager&&(t.contextManager=new tp),t.contextManager&&t.contextManager.enable(),e.prototype.register.call(this,t)},t}(tu),tm=function(e){function t(){var e;return(0,K._)(this,t),e=(0,Z._)(this,t,arguments),(0,ee._)(e,"spanSet",new Map),e}return(0,er._)(t,e),(0,Y._)(t,[{key:"startSpan",value:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:k.context.active(),i=(0,et._)((0,en._)(t.prototype),"startSpan",this).call(this,e,n,r);return this.spanSet.set(i.spanContext().spanId,i),i}},{key:"pruneSpans",value:function(){this.spanSet.forEach(function(e){e.isRecording()&&e.setAttribute("pruned",!0)}),this.spanSet=new Map}}]),t}(eB),tv=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,K._)(this,t),e=(0,Z._)(this,t,[n]),(0,ee._)(e,"_wsConfig",void 0),(0,ee._)(e,"_wsTracers",new Map),e._wsConfig=n,e}return(0,er._)(t,e),(0,Y._)(t,[{key:"getTracer",value:function(e,t,n){var r="".concat(e,"@").concat(t||"",":").concat((null==n?void 0:n.schemaUrl)||"");return this._wsTracers.has(r)||this._wsTracers.set(r,new tm({name:e,version:t,schemaUrl:null==n?void 0:n.schemaUrl},this._wsConfig,this)),this._wsTracers.get(r)}},{key:"pruneSpansForTracer",value:function(e,t,n){var r,i="".concat(e,"@").concat(t||"",":").concat((null==n?void 0:n.schemaUrl)||"");this._wsTracers.has(i)&&(null==(r=this._wsTracers.get(i))||r.pruneSpans())}}]),t}(tg);function tx(){var e=(0,W.useFlag)({controlName:"flag-open-telemetry-tracing"});return(0,y.useEffect)(function(){e&&((m=new tv).addSpanProcessor(new H(J)),m.register({propagator:new b.W3CTraceContextPropagator}))},[e]),(0,x.jsx)(x.Fragment,{})}function ty(e){m.pruneSpansForTracer(e)}e.s(["OpenTelemetryTracer",()=>tx,"pruneSpans",()=>ty],911185)},42783,e=>{"use strict";var t=e.i(394212),n=e.i(297083),r=e.i(817556),i=e.i(299798);function o(){return(0,i.usePid2)(function(e,i){return i.signal,(0,n._)(function(){var e,n,i,o,a,s,l,u;return(0,r._)(this,function(r){switch(r.label){case 0:return[3,12];case 1:r.trys.push([1,6,7,12]),a=(0,t._)(e),r.label=2;case 2:return[4,a.next()];case 3:if(!(n=!(s=r.sent()).done))return[3,5];(l=s.value).ok&&(l.payload.extras?console.log("[pid2]: ".concat(l.payload.message),l.payload.extras):console.log("[pid2]: ".concat(l.payload.message))),r.label=4;case 4:return n=!1,[3,2];case 5:return[3,12];case 6:return u=r.sent(),i=!0,o=u,[3,12];case 7:if(r.trys.push([7,,10,11]),!(n&&null!=a.return))return[3,9];return[4,a.return()];case 8:r.sent(),r.label=9;case 9:return[3,11];case 10:if(i)throw o;return[7];case 11:return[7];case 12:return[2]}})})()},[]),null}e.s(["default",()=>o])},568817,e=>{"use strict";function t(e,t){var n=t.existing,r=t.getKey,i=new Map,o=!0,a=!1,s=void 0;try{for(var l,u=e[Symbol.iterator]();!(o=(l=u.next()).done);o=!0){var c=l.value;i.set(r(c),c)}}catch(e){a=!0,s=e}finally{try{o||null==u.return||u.return()}finally{if(a)throw s}}var d=new Set,f=[],p=!0,h=!1,g=void 0;try{for(var m,x=n[Symbol.iterator]();!(p=(m=x.next()).done);p=!0){var y=m.value,b=r(y),w=i.get(b);w&&(f.push(w),d.add(b))}}catch(e){h=!0,g=e}finally{try{p||null==x.return||x.return()}finally{if(h)throw g}}var k=!0,_=!1,S=void 0;try{for(var C,j=e[Symbol.iterator]();!(k=(C=j.next()).done);k=!0){var T=C.value;d.has(r(T))||f.push(T)}}catch(e){_=!0,S=e}finally{try{k||null==j.return||j.return()}finally{if(_)throw S}}return f}e.s(["default",()=>t])},151386,e=>{"use strict";var t=e.i(993796);function n(){return(0,t.useFlag)({controlName:"flag-enraged-tremendous-squares"})}e.s(["useFilePaneFlag",()=>n])},323049,e=>{"use strict";var t=e.i(219577),n={overlay:t.SIDEBAR_Z_INDEX+20,gutterActive:t.SIDEBAR_Z_INDEX+19,maximizedTooltip:t.SIDEBAR_Z_INDEX+18,maximizedPane:t.SIDEBAR_Z_INDEX+17,maximizedHeader:t.SIDEBAR_Z_INDEX+16,filetreeDragLayer:17,detachPreview:16,draggingPane:15,draggingHeader:14,floatingPaneActive:11,floatingHeaderActive:10,floatingPane:9,floatingHeader:8,dropPreview:7,gutterHovered:6,tiledPaneActive:5,tiledHeaderActive:4,tiledPane:3,tiledHeader:2,gutter:1,hiddenPane:0};e.s(["zIndexLevels",()=>n])},292849,989481,e=>{"use strict";var t=e.i(297083),n=e.i(817556),r=e.i(276385),i=e.i(415756),o=e.i(205104),a=e.i(890963),s=e.i(480028),l=e.i(446530),u=e.i(613355),c=e.i(630818),d=e.i(960178),f=e.i(625484),p={findOrCreateFile:1,searchFileContents:2,fork:.5,createNewRepl:.5,askAssistant:.5,codeSearch:.5,myRepls:.5,settings:.5},h={files:.98,settings:.9,toolDescription:.8,askAssistant:.5,codeSearch:.7,fileContentsSearch:.4};e.s(["commandDefaultScores",()=>p,"commandMatchScoreMultipliers",()=>h],989481);var g=e.i(290446),m=(0,l.cssRecord)({root:[{userSelect:"none"}],header:[{fontSize:s.tokens.fontSizeSmall,opacity:.6},u.rcss.color.foregroundDimmest,u.rcss.truncate],fileName:[u.rcss.truncate,u.rcss.flex.row]});function x(e){var t=e.height,n=e.active,i=e.match,o=i.directory,a=i.filename,s=e.description;return(0,r.jsxs)(f.View,{css:m.root,grow:!0,shrink:!0,px:8,row:!0,gap:8,align:"center",style:{height:t},children:[(0,r.jsx)(c.default,{path:a.text,size:16}),(0,r.jsxs)(f.View,{gap:0,children:[o?(0,r.jsx)(f.View,{css:m.header,children:(0,r.jsx)(g.HighlightMatches,{text:o.text+"/",highlight:o.ranges,dimmed:!n})}):null,(0,r.jsxs)(f.View,{row:!0,gap:8,align:"center",children:[(0,r.jsx)(f.View,{css:m.fileName,children:(0,r.jsx)(g.HighlightMatches,{text:a.text,highlight:a.ranges,dimmed:!n})}),(0,r.jsx)(d.Text,{variant:"small",color:"dimmest",children:s})]})]})]})}var y={match:i.asyncExtendedMatch,forward:!1,tiebreakers:[function(e,t,n){var r=n(e.item),i=n(t.item),o=r.lastIndexOf("/"),a=i.lastIndexOf("/"),s=Array.from(e.positions).filter(function(e){return e>o}).length;return Array.from(t.positions).filter(function(e){return e>a}).length-s},function(e,t,n){return n(e.item).trim().length-n(t.item).trim().length}]};function b(e,r){return(0,t._)(function(){var t,o;return(0,n._)(this,function(n){switch(n.label){case 0:return[4,new i.AsyncFzf(r,y).find(e)];case 1:return t=n.sent().map(function(e){return{path:e.item,score:Math.floor(e.score*h.files),ranges:(0,a.indiciesToRanges)(e.positions)}}),[2,(o=(0,a.getMinMatchScoreForQuery)({queryLength:e.length}))?t.filter(function(e){return e.score>=o}):t]}})})()}function w(e){var t=e.ranges,n=e.path,r=(0,o.getFileName)(n),i=(0,o.getParentPath)(n);if(!i)return{filename:{text:r,ranges:t.length?t:void 0}};var a=i.length,s=a+1,l=[],u=[],c=!0,d=!1,f=void 0;try{for(var p,h=t[Symbol.iterator]();!(c=(p=h.next()).done);c=!0){var g=p.value;if(g.from<a){l.push({from:g.from,to:Math.min(g.to,a)});var m=g.to-s;if(m<=0)continue;u.push({from:0,to:m});continue}g.from<s||u.push({from:g.from-s,to:g.to-s})}}catch(e){d=!0,f=e}finally{try{c||null==h.return||h.return()}finally{if(d)throw f}}return{filename:{text:r,ranges:u.length?u:void 0},directory:{text:i,ranges:l.length?l:void 0}}}function k(e){var t=e.path,n=e.ranges,i=e.description,o=w({path:t,ranges:null!=n?n:[]}),a=o.directory?44:32;return{height:a,content:(0,r.jsx)(x,{match:o,height:a,description:i})}}e.s(["createFileMatchRender",()=>k,"filterFiles",()=>b,"matchFilepath",()=>w],292849)},333980,927989,198822,e=>{"use strict";var t=e.i(721281),n=e.i(878420),r=e.i(276385),i=e.i(890963),o=e.i(64386),a=e.i(886513),s=e.i(332441);e.i(32109);var l=e.i(926118),u=e.i(384401),c=e.i(967629),d=e.i(613355),f=e.i(624782),p=e.i(960178),h=(0,c.css)([d.rcss.fontSize(13)]);function g(e){var t=e.name,i=(0,a._)(e,["name"]),c=(0,u.useKeyCombo)(t.id),d=(0,s.useIsMac)();if(!c)return null;var g=(0,l.keyComboText)(c,d);return""===g.trim()?null:(0,r.jsx)(f.Pill,(0,o._)((0,n._)({},i),{text:(0,r.jsx)(p.Text,{css:h,color:"dimmest",children:g})}))}var m=e.i(480028),x=e.i(625484),y=(0,c.css)([d.rcss.borderRadius("full"),d.rcss.position.absolute,d.rcss.top(-3),d.rcss.right(-3)]);function b(e){var t=e.color,n=void 0===t?m.tokens.redStronger:t,i=e.small,o=e.className,a=i?6:8;return(0,r.jsx)(x.View,{className:o,style:{backgroundColor:n,width:a,height:a,zIndex:2,boxShadow:"0 0 0 2px ".concat(m.tokens.backgroundDefault)},css:y})}e.i(282890);var w=e.i(466497),k=e.i(827456);e.i(545082);var _=e.i(803542),S=e.i(446530),C=e.i(447724),j=e.i(581972),T=e.i(989481),E=e.i(290446),R=(0,S.cssRecord)({root:[{paddingInline:j.styleTokens.inputBarPadding,"&:hover .icon":{backgroundColor:"var(".concat(m.properties.interactiveBackground,")")}}],iconAndIndicator:[d.rcss.position.relative],iconContainer:[d.rcss.position.relative,j.iconSizeCss,{width:j.styleTokens.iconSize,height:j.styleTokens.iconSize}],textContent:[d.rcss.flex.growAndShrink(1)],aliasContainer:[d.rcss.color.foregroundDimmest,d.rcss.align.center,d.rcss.flex.growAndShrink(1)],descriptionText:[{fontSize:"0.9em"}]});function I(e){var i=e.pane,o=e.active,a=e.labelHighlights,s=(0,k.usePaneUIContext)(),l=s.Icon({pane:i,size:e.iconSize}),u=s.getTitle(i),c=(0,w.usePaneDescription)(i,{short:!0}),d=s.getTitlePill(i),h=(0,_.usePaneIndicator)({paneType:i.type}),m=(0,C.useShowToolDescriptions)();return(0,r.jsxs)(x.View,{css:R.root,grow:!0,shrink:!0,row:!0,align:"center",gap:j.styleTokens.inputBarPadding,style:m?(0,t._)({paddingTop:j.styleTokens.inputBarPadding,paddingBottom:j.styleTokens.inputBarPadding},j.cssVars.iconSize,e.iconSize+"px"):void 0,children:[(0,r.jsxs)(x.View,{css:R.iconAndIndicator,children:[(0,r.jsx)(x.View,{css:R.iconContainer,style:{opacity:e.active?1:.7},children:l}),h?(0,r.jsx)(b,{color:h}):null]}),(0,r.jsxs)(x.View,{css:R.textContent,gap:2,"data-cy":"command-bar-tool-".concat(u.toLowerCase()),children:[(0,r.jsxs)(x.View,{row:!0,gap:4,justify:"space-between",children:[e.alias?(0,r.jsxs)(x.View,{row:!0,gap:8,css:R.textContent,children:[(0,r.jsx)(p.Text,{children:u}),(0,r.jsxs)(x.View,{css:R.aliasContainer,row:!0,gap:4,children:["(",e.aliasPrefix?(0,r.jsxs)(p.Text,{color:"dimmest",children:[e.aliasPrefix," "]}):null,(0,r.jsx)(E.HighlightMatches,{dimmed:!0,text:e.alias,highlight:a}),")"]})]}):(0,r.jsx)(E.HighlightMatches,{dimmed:!o,text:u,highlight:a}),m&&null!=d?(0,r.jsx)(f.Pill,(0,n._)({},d)):null]}),m&&null!=c?(0,r.jsx)(E.HighlightMatches,{dimmed:!o,text:c,highlight:e.descriptionHighlights,multiline:!0,css:R.descriptionText}):null]}),e.shortcutCommand?(0,r.jsx)(g,{name:e.shortcutCommand}):null]})}function A(e){var t=e.pane,n=e.aliases,o=void 0===n?[]:n,a=e.iconSize;return function(e){var n=e.searchQuery,s=e.data,l=e.active;if("group"===s.type)return null;if(!n)return{score:1,render:{content:(0,r.jsx)(I,{iconSize:a,pane:t})}};var u=(0,i.fzfMatch)(n,s.label,{casing:"case-insensitive"}),c=null;if(null!=s.description&&(c=(0,i.fzfMatch)(n,s.description,{filterLowMatchScores:!0,fuzzy:!1,casing:"case-insensitive"}))&&(c.score*=T.commandMatchScoreMultipliers.toolDescription),null!=u||null!=c)return{score:null!=(g=null!=(h=null==u?void 0:u.score)?h:null==c?void 0:c.score)?g:0,render:{content:(0,r.jsx)(I,{iconSize:a,pane:t,labelHighlights:null!=(m=null==u?void 0:u.ranges)?m:[],descriptionHighlights:null!=(x=null==c?void 0:c.ranges)?x:[],active:l})}};var d=!0,f=!1,p=void 0;try{for(var h,g,m,x,y,b=o[Symbol.iterator]();!(d=(y=b.next()).done);d=!0){var w=y.value,k="string"==typeof w?{alias:w,prefix:void 0}:w,_=k.alias,S=k.prefix,C=(0,i.fzfMatch)(n,_,{casing:"case-insensitive"});if(C)return{score:C.score,render:{content:(0,r.jsx)(I,{iconSize:a,pane:t,active:l,alias:_,aliasPrefix:S,labelHighlights:C.ranges})}}}}catch(e){f=!0,p=e}finally{try{d||null==b.return||b.return()}finally{if(f)throw p}}return null}}e.s(["matchToolPane",()=>A],333980);var P=new Map([["envEditor",["Environment variables"]],["ghostwriterChat",["Chat",{alias:"Ghostwriter",prefix:"previously"}]],["shell",["Terminal"]],["objectStorage",[{alias:"Object Storage",prefix:"previously"},"Blobject Storage","Blob Cloud"]],["integrations",["Cloud Services","OpenAI","Slack"]],["agentProgress",["Agent Progress","AI Agent","Preview","Output","Webview"]],["neon",[{alias:"Supabase",prefix:"similar to"}]],["webview",["Preview","Output",{alias:"Webview",prefix:"previously"}]],["deployments",[{alias:"Deployments",prefix:"previously"}]],["preferences",["Sound","Chime","Notifications","Audio","Settings"]]]);e.s(["paneAliases",()=>P],927989);var D=e.i(569384),O=e.i(973245),N=e.i(304277);function M(){var e=(0,D._)(["\n  fragment WorkspaceToolPanesRepl on Repl {\n    workspaceCta\n    authorizations {\n      editFileContents {\n        isAuthorized\n      }\n      editPermissions {\n        isAuthorized\n      }\n    }\n    authorizations {\n      viewDeploymentConfig {\n        isAuthorized\n      }\n    }\n    config {\n      isServer\n      isVnc\n    }\n  }\n"]);return M=function(){return e},e}function L(){var e=(0,D._)(["\n  query WorkspaceToolPanes($replId: String!) {\n    getRepl(id: $replId) {\n      ... on Repl {\n        id\n        ...WorkspaceToolPanesRepl\n      }\n    }\n    currentUser {\n      id\n      isAdmin: hasRole(role: ADMIN)\n    }\n  }\n  ","\n"]);return L=function(){return e},e}e.i(566901);var B={},V=(0,O.gql)(M()),F=(0,O.gql)(L(),V);function U(e){var t=(0,n._)({},B,e);return N.useQuery(F,t)}e.s(["useWorkspaceToolPanesQuery",()=>U],198822)},545453,570271,e=>{"use strict";var t=e.i(878420),n=e.i(64386),r=e.i(389959),i=e.i(761732),o=e.i(529810);function a(){var e=(0,o.default)().toolchain;return(0,i.default)(e.configs)}e.s(["useToolchainConfigs",()=>a],570271);var s={nodejs:["package.json","package-lock.json","yarn.lock","node_modules/"],python2:["poetry.lock","pyproject.toml","requirements.txt",".venv/",".local"],python3:["poetry.lock","pyproject.toml","requirements.txt",".venv/",".local"],ruby:["Gemfile","Gemfile.lock"],java:["pom.xml","target"]};function l(){var e=a();return{configs:(0,r.useMemo)(function(){var r=(null==e?void 0:e.packagers)||[],i=(null==r?void 0:r.map(function(e){var r,i;return(0,n._)((0,t._)({},e),{title:e.language,packagerFiles:(null==(r=e.packagerFiles)?void 0:r.length)?e.packagerFiles:null!=(i=s[e.language])?i:[]})}))||[];return i.push({id:"nix",title:"system",name:"System Dependencies",language:"nix",packageSearch:!0,guessImports:!1,packagerFiles:["replit.nix"]}),i},[e]),loading:!e}}e.s(["usePackagerConfigs",()=>l],545453)},794633,273042,257042,838124,49416,e=>{"use strict";e.i(33699);var t=e.i(530658),n=e.i(346715),r=e.i(399528),i=e.i(389959),o=e.i(992785),a=e.i(541793),s=e.i(814563),l=e.i(198822),u=e.i(993796),c=e.i(207237),d=e.i(441329),f=e.i(545453),p=e.i(878420),h=e.i(64386),g=e.i(368964),m=e.i(569384),x=e.i(973245),y=e.i(304277);function b(){var e=(0,m._)(["\n  query CheckForProjectByRepl($id: String!) {\n    getRepl(id: $id) {\n      __typename\n      ... on Repl {\n        id\n        org {\n          id\n          type\n          name\n          authorizations {\n            createPublicRepl: createRepl(private: false) {\n              isAuthorized\n              message\n            }\n            createPrivateRepl: createRepl(private: true) {\n              isAuthorized\n              message\n            }\n            createProject {\n              isAuthorized\n              message\n            }\n          }\n        }\n        project {\n          id\n        }\n      }\n    }\n  }\n"]);return b=function(){return e},e}e.i(566901);var w={},k=(0,x.gql)(b());function _(){var e,t,n,r,i,o,a=(i={variables:{id:(0,c.default)()}},o=(0,p._)({},w,i),y.useQuery(k,o)),s=(null==(t=a.data)||null==(e=t.getRepl)?void 0:e.__typename)==="Repl"?a.data.getRepl.org:void 0,l=!!s&&s.type===g.OrgstypeEnumType.Team&&(s.authorizations.createPrivateRepl.isAuthorized||s.authorizations.createPublicRepl.isAuthorized)&&s.authorizations.createProject.isAuthorized;return(0,h._)((0,p._)({},a),{hasProject:(null==(n=a.data)?void 0:n.getRepl.__typename)==="Repl"&&!!(null==(r=a.data.getRepl.project)?void 0:r.id),isEligibleForProject:l})}e.s(["useCheckForProject",()=>_],273042);var S=e.i(297083),C=e.i(817556),j=e.i(276385);function T(){var e=(0,m._)(["\n  query ReplAuth($replID: String!) {\n    getRepl(id: $replID) {\n      ... on Repl {\n        id\n        config {\n          isServer\n        }\n      }\n    }\n    currentUser {\n      id\n      isLoggedIn\n    }\n  }\n"]);return T=function(){return e},e}var E={},R=(0,x.gql)(T()),I=e.i(761201),A=e.i(205104),P=e.i(19004),D=e.i(255444),O=e.i(641326),N=e.i(858248),M=e.i(709485),L=e.i(529810),B=e.i(712516),V="Import HTML package",F=[{title:"Get user info",content:[{type:"code",value:'<script type="module">const user = await getUserInfo() </script>'}]}],U=[{title:V,content:[{type:"code",value:'<script src="https://replit.com/public/js/repl-auth-v2.js"></script>'}]}],G=[{title:"Insert custom button",content:[{type:"code",value:'<button onclick="LoginWithReplit()"> Login </button>'}]}],$=e.i(569910),z=e.i(995683),H=e.i(610357),W="Import Node package",q=[{title:"Get user info",content:[{type:"code",value:"const user = getUserInfo("},{type:"input",placeholder:"req"},{type:"code",value:")"}]}],K=[{title:W,content:[{type:"code",value:'const { getUserInfo } = require("@replit/repl-auth")'}]}],Y=e.i(952685);e.i(545082);var Q=e.i(91442),X=e.i(446530),J=e.i(613355),Z=e.i(140487),ee=e.i(136540),et=e.i(607278),en=e.i(929872),er=e.i(960178),ei=e.i(625484),eo=e.i(369948),ea=e.i(51606),es=e.i(363201),el=(0,X.cssRecord)({templateContainer:[J.rcss.backgroundColor.backgroundRoot,J.rcss.borderRadius(4),J.rcss.p(4),J.rcss.align.center],input:[J.rcss.minWidth(64),J.rcss.flex.growAndShrink(1)],codeExampleContainer:[J.rcss.borderRadius(4),J.rcss.flex.shrink(1)],codeExampleText:[J.rcss.font.code,J.rcss.color.foregroundDimmer,J.rcss.py(4),J.rcss.flex.growAndShrink(1)]}),eu=function(e){var r=e.title,o=e.content,a=(0,t._)((0,i.useState)(o),2),s=a[0],l=a[1];return(0,j.jsxs)(ei.View,{gap:4,children:[(0,j.jsxs)(ei.View,{row:!0,gap:4,align:"center",children:[(0,j.jsx)(er.Text,{variant:"subheadDefault",children:r}),"Get user info"===r?(0,j.jsx)(ee.IconButton,{disabled:!0,tooltipPlacement:"top",alt:"User object contains 'id', 'name', 'roles', and 'teams'",children:(0,j.jsx)(es.default,{})}):null]}),(0,j.jsxs)(ei.View,{gap:4,children:[(0,j.jsx)(ei.View,{css:el.templateContainer,row:!0,gap:4,justify:"center",children:o.map(function(e,t){var i=e.type;switch(i){case"input":return(0,j.jsx)(et.Input,{onChange:function(e){var r=(0,n._)(s);r[t].value=e.target.value,l(r)},placeholder:e.placeholder,value:e.value||"",css:el.input},"".concat(r,"-").concat(t));case"code":return(0,j.jsx)(ei.View,{css:el.codeExampleContainer,children:(0,j.jsx)(er.Text,{multiline:!1,css:el.codeExampleText,children:e.value})},"".concat(r,"-").concat(t));default:(0,$.default)(i)}})}),(0,j.jsx)(ec,{code:s.reduce(function(e,t){return"input"===t.type?e+(t.value||t.placeholder):e+t.value},""),packageImport:r===W||r===V})]})]})},ec=function(e){var t=e.code,n=e.packageImport,r=(0,Q.useCursorFilepath)(),i=(0,Y.default)(r),o=(0,L.default)().fs,a=(0,Q.useGetCursorState)();return i?(0,j.jsx)(en.Surface,{children:(0,j.jsx)(Z.Button,{size:"small",variant:"outlined",onClick:function(){var e,s;n&&r&&o?"html"!==(0,A.getExt)(r)?i({code:t,insertAt:0}):o.readFile(r).then(function(e){if(e.error)throw e.error;var n=z.default.from(e.content).toString(),r=n.indexOf("</head>")-1;-1===r&&(r=n.indexOf("<script")),-1===r&&(r=n.indexOf("</body>")),-1===r&&(r=n.length),i({code:t,insertAt:r})}):i({code:t,insertAt:null!=(s=null==(e=a())?void 0:e.position.offset)?s:0})},text:n?"Auto add":"Insert",iconRight:(0,j.jsx)(eo.default,{}),css:{width:"fit-content"}})}):(0,j.jsx)(en.Surface,{children:(0,j.jsx)(Z.Button,{size:"small",variant:"outlined",onClick:function(){return(0,H.default)(t)},text:"Copy",iconLeft:(0,j.jsx)(ea.default,{}),css:{width:"fit-content"}})})},ed=function(e){var t=e.examples;return(0,j.jsx)(ei.View,{gap:16,children:t.map(function(e,t){return(0,j.jsx)(eu,{title:e.title,content:e.content},t)})})};let ef=function(e){var t=e.langKey;return(0,j.jsxs)(ei.View,{gap:8,children:[" ","html"!==t&&(0,j.jsx)(ed,{examples:U}),(0,j.jsx)(ed,{examples:G})]})};var ep=[{title:"Fetch from client",content:[{type:"code",value:"CURL /__replauthuser"}]},{title:"Or access server request headers",content:[{type:"code",value:"X-Replit-User-Id"}]},{title:"",content:[{type:"code",value:"X-Replit-User-Name"}]},{title:"",content:[{type:"code",value:"X-Replit-User-Teams"}]},{title:"",content:[{type:"code",value:"X-Replit-User-Roles"}]}],eh=e.i(967629),eg=(0,eh.css)([J.rcss.colWithGap(16)]);let em=function(){return(0,j.jsx)(ei.View,{css:eg,children:ep.map(function(e,t){return(0,j.jsx)(eu,{title:e.title,content:e.content},t)})})};var ev=(0,eh.css)([J.rcss.colWithGap(8)]);let ex=function(e){var t=e.langKey,n=(0,j.jsx)(em,{});switch(t){case"html":n=(0,j.jsx)(ed,{examples:F});break;case"nodejs":n=(0,j.jsx)(ed,{examples:q})}return(0,j.jsx)(ei.View,{css:ev,children:n})},ey=function(e){var t=e.langKey,n=null;switch(t){case"html":n=U;break;case"nodejs":n=K}return n?(0,j.jsx)(ei.View,{gap:8,children:(0,j.jsx)(ed,{examples:n})}):null};e.i(282890);var eb=e.i(827456),ew=e.i(480028),ek=e.i(91720),e_=e.i(988676),eS=e.i(396776),eC=e.i(934565),ej=e.i(781478),eT=e.i(353384),eE=e.i(42458),eR=(0,X.cssRecord)({link:[J.rcss.color.accentPrimaryStronger,J.rcss.cursor.pointer],errorContainer:[J.rcss.textAlign.center,J.rcss.colWithGap(4)],usageSectionTitleText:[{color:ew.tokens.foregroundDimmest,textTransform:"uppercase",fontWeight:ew.tokens.fontWeightMedium}],divider:[J.rcss.backgroundColor.outlineDimmer]}),eI=function(){var e=(0,L.default)(),n=e.dotReplit,r=e.fs,o=(0,t._)((0,i.useState)(),2),a=o[0],s=o[1],l=(0,t._)((0,i.useState)(!1),2),u=l[0],c=l[1],d=(0,t._)((0,i.useState)(!1),2),f=d[0],p=d[1],h=(0,t._)((0,i.useState)(!0),2),g=h[0],m=h[1],x=(0,t._)((0,i.useState)(!0),2),y=x[0],b=x[1],w=(0,i.useCallback)(function(){return(0,S._)(function(){var e,t,r,i,o;return(0,C._)(this,function(a){switch(a.label){case 0:s(void 0),m(!0),a.label=1;case 1:return a.trys.push([1,3,4,5]),[4,n.getConfig({bypassCache:!0})];case 2:switch((o=a.sent()).error){case O.DotReplitErrors.ParseError:throw Error("An error occurred parsing the .replit file, please ensure the syntax is valid");case O.DotReplitErrors.Disconnected:throw Error("Disconnected, cannot read .replit file.");case O.DotReplitErrors.NotFound:return b(!1),[2]}return c(!!(null==o||null==(t=o.config)||null==(e=t.auth)?void 0:e.buttonEnabled)),p(!!(null==o||null==(i=o.config)||null==(r=i.auth)?void 0:r.pageEnabled)),[3,5];case 3:return s(a.sent().message),[3,5];case 4:return m(!1),[7];case 5:return[2]}})})()},[n,s,m,b,c,p]);return(0,i.useEffect)(function(){(0,S._)(function(){return(0,C._)(this,function(e){switch(e.label){case 0:if(!r)return[2];return[4,w()];case 1:return e.sent(),[2]}})})()},[r,w]),(0,i.useEffect)(function(){if(r){var e=r.watchTextFile(P.dotReplitPath,{onChange:function(){return(0,S._)(function(){return(0,C._)(this,function(e){switch(e.label){case 0:return[4,w()];case 1:return e.sent(),[2]}})})()}});return function(){e(),p(!1),c(!1),m(!1)}}},[r,p,w]),{error:a,isDotReplitAuthButtonEnabled:u,isDotReplitAuthPageEnabled:f,isDotReplitAuthLoading:g,hasDotReplit:y,setError:s,setIsDotReplitAuthLoading:m,isDotReplitAuthEnabled:u||f}};function eA(){var e,n,r,o,a,s,l=(0,c.default)(),u=(0,L.default)().dotReplit,d=(0,Q.useCursorFilepath)(),h=d?(0,A.getExt)(d):null,g=(0,f.usePackagerConfigs)().configs,m=(0,t._)((0,i.useState)(""),2),x=m[0],b=m[1],w=(e={variables:{replID:l}},n=(0,p._)({},E,e),y.useQuery(R,n)),k=w.data,_=w.error,T=w.loading,P=(null==k?void 0:k.getRepl.__typename)==="Repl"&&(null==k||null==(o=k.getRepl)||null==(r=o.config)?void 0:r.isServer),O=null!=(s=null==k||null==(a=k.currentUser)?void 0:a.isLoggedIn)&&s,V=eI(),F=V.error,U=V.isDotReplitAuthButtonEnabled,G=V.isDotReplitAuthPageEnabled,$=V.isDotReplitAuthLoading,z=V.hasDotReplit,H=V.setError,W=V.setIsDotReplitAuthLoading,q=V.isDotReplitAuthEnabled;(0,i.useEffect)(function(){g.find(function(e){return"react"===e.language})||"jsx"===h||"tsx"===h?b("react"):g.length>0&&b(g[0].language)},[h,x,b,g]);var K=(0,i.useCallback)(function(){return(0,S._)(function(){return(0,C._)(this,function(e){switch(e.label){case 0:return W(!0),(0,N.track)(M.events.AUTH_SIDEBAR_USED,{action:"Login Page Enabled"}),[4,u.updateDotReplit([(0,D.enableAuthPageOp)(!0),(0,D.enableAuthButtonOp)(!1)])];case 1:return e.sent().error&&(H("Couldn't enable login page, please try again"),W(!1)),[2]}})})()},[W,u,H]),Y=(0,i.useCallback)(function(){return(0,S._)(function(){return(0,C._)(this,function(e){switch(e.label){case 0:return W(!0),(0,N.track)(M.events.AUTH_SIDEBAR_USED,{action:"Login Button Enabled"}),[4,u.updateDotReplit([(0,D.enableAuthPageOp)(!1),(0,D.enableAuthButtonOp)(!0)])];case 1:return e.sent().error&&(H("Couldn't enable login button, please try again"),W(!1)),[2]}})})()},[W,u,H]),X=(0,i.useCallback)(function(){return(0,S._)(function(){return(0,C._)(this,function(e){switch(e.label){case 0:return W(!0),(0,N.track)(M.events.AUTH_SIDEBAR_USED,{action:"Repl auth disabled"}),[4,u.updateDotReplit([(0,D.enableAuthPageOp)(!1),(0,D.enableAuthButtonOp)(!1)])];case 1:return e.sent().error&&(H("Couldn't disable Log in with Replit, please try again"),W(!1)),[2]}})})()},[W,u,H]),ee=(0,i.useMemo)(function(){return O?z?_?(0,j.jsx)(ei.View,{css:eR.errorContainer,children:(0,j.jsx)(eS.StatusBanner,{colorway:"warning",text:"An error ocurred retrieving auth for this App. Please try again later."})}):"html"===x||P?void 0:(0,j.jsx)(ei.View,{css:eR.errorContainer,children:(0,j.jsx)(eS.StatusBanner,{colorway:"warning",text:"Run your web app to use Log in with Replit"})}):(0,j.jsxs)(ei.View,{css:eR.errorContainer,children:[(0,j.jsx)(eS.StatusBanner,{colorway:"warning",text:"Please create a .replit file to use Log in with Replit"}),(0,j.jsx)(er.Text,{children:(0,j.jsx)("a",{href:"https://docs.replit.com/replit-workspace/configuring-repl",target:"_blank",rel:"noopener",children:"Learn more about the .replit file"})})]}):(0,j.jsx)(ei.View,{css:eR.errorContainer,children:(0,j.jsx)(eP,{})})},[_,z,O,P,x]),et="html"===x||"nodejs"===x,en=(0,j.jsx)(er.Text,{color:"dimmer",children:"You can use Log in with Replit with all web Apps. We have language clients for Nodejs and HTML - switch to an App that uses that language to see how to use it."}),eo=(0,j.jsxs)(ei.View,{gap:24,children:[(0,j.jsxs)(ei.View,{gap:8,children:[G?(0,j.jsxs)(er.Text,{color:"dimmer",children:["Your App will automatically direct users to a prebuilt login page. Start by importing the package below"," ",(0,j.jsxs)("span",{onClick:Y,css:eR.link,onKeyDown:Y,role:"button",tabIndex:0,children:[" ","or use your own custom button."]}),(0,j.jsx)("br",{}),"Repl Auth is not intended for API authentication."]}):(0,j.jsxs)(er.Text,{color:"dimmer",children:["Your users can log in to your App using a custom button. Start by importing the package below"," ",(0,j.jsxs)("span",{onClick:K,css:eR.link,onKeyDown:K,role:"button",tabIndex:0,children:[" ","or use a prebuilt login page."]})]}),et?void 0:en]}),(0,j.jsxs)(ei.View,{children:["nodejs"===x&&U?null:(0,j.jsx)(ey,{langKey:x}),U?(0,j.jsx)(ef,{langKey:x}):null]}),(0,j.jsxs)(ei.View,{gap:8,children:[(0,j.jsxs)(ei.View,{gap:2,children:[(0,j.jsx)(er.Text,{multiline:!1,variant:"small",css:eR.usageSectionTitleText,children:"Usage"}),(0,j.jsx)(e_.DividerH,{css:eR.divider})]}),(0,j.jsx)(ei.View,{children:(0,j.jsxs)(ei.View,{gap:12,children:[" ","nodejs"===x&&U?(0,j.jsx)(ey,{langKey:x}):null,(0,j.jsx)(ex,{langKey:x})]})})]}),(0,j.jsx)(Z.Button,{onClick:X,text:"Disable Auth",colorway:"negative",variant:"outlined",loading:$||T})]}),ea=(0,eb.usePaneUIContext)().getDescription({type:"replAuth"}),es=(0,j.jsxs)(ei.View,{gap:8,children:[(0,j.jsx)(er.Text,{css:J.rcss.textAlign.center,children:ea}),(0,j.jsx)(Z.Button,{colorway:"primary",onClick:K,text:"Enable Login Page",loading:$||T,disabled:!!F,iconLeft:(0,j.jsx)(eT.default,{})}),(0,j.jsxs)(er.Text,{color:"dimmer",css:J.rcss.textAlign.center,children:["Alternatively,"," ",(0,j.jsx)("span",{onClick:Y,css:eR.link,onKeyDown:Y,role:"button",tabIndex:0,children:"use a custom login button"}),".",(0,j.jsx)("br",{}),"Repl Auth is not intended for API authentication."]})]}),el=(0,j.jsx)(ek.ButtonLink,{href:I.LINKS_DOCS.REPL_AUTH,variant:"nofill",target:"_blank",rel:"noopener",iconLeft:(0,j.jsx)(eC.default,{}),text:"Learn more"});return(0,j.jsx)(B.default,{pane:{type:"replAuth"},maxWidth:q?600:450,headerText:"Login with Replit",body:(0,j.jsxs)(j.Fragment,{children:[F?(0,j.jsx)(eS.StatusBanner,{text:F,colorway:q?void 0:"warning",icon:(0,j.jsx)(eE.default,{})}):null,null!=ee?ee:q?eo:es]}),action:ee?void 0:el})}var eP=function(){return(0,j.jsxs)(ei.View,{gap:16,children:[(0,j.jsxs)(er.Text,{children:[(0,j.jsx)("a",{href:I.LINKS_DOCS.REPL_AUTH,target:"_blank",rel:"noopener",css:eR.link,children:"Replit Authentication"})," ","is the fastest and easiest way to set up authentication in your App. Try it out by logging in or signing up."]}),(0,j.jsx)(ek.ButtonLink,{href:"/auth",as:"/signup",colorway:"primary",text:"Sign up",iconLeft:(0,j.jsx)(ej.default,{})})]})};e.s(["default",()=>eA,"useReplAuthStatus",()=>eI],257042),e.i(244719);var eD=e.i(667279),eO=e.i(951262);function eN(){var e=(0,m._)(["\n  query ReplConfigIsExtension($replId: String!) {\n    getRepl(id: $replId) {\n      ... on Repl {\n        id\n        config {\n          isExtension\n        }\n      }\n    }\n  }\n"]);return eN=function(){return e},e}function eM(){var e=(0,m._)(["\n  mutation UpdateReplConfigIsExtension(\n    $replId: String!\n    $isExtension: Boolean!\n  ) {\n    updateRepl(input: { id: $replId, isExtension: $isExtension }) {\n      repl {\n        id\n        config {\n          isExtension\n        }\n      }\n    }\n  }\n"]);return eM=function(){return e},e}var eL={},eB=(0,x.gql)(eN());function eV(e){var t=(0,p._)({},eL,e);return y.useQuery(eB,t)}var eF=(0,x.gql)(eM()),eU=e.i(253344);function eG(){var e=eV({variables:{replId:(0,c.default)()},fetchPolicy:"cache-only"}).data,n=(0,t._)((0,i.useState)(function(){var t,n;return(null==e||null==(t=e.getRepl)?void 0:t.__typename)==="Repl"&&null!=(n=e.getRepl.config.isExtension)&&n}),2),r=n[0],o=n[1],a=(0,L.default)().dotReplit;return(0,i.useEffect)(function(){return a.watch(function(e){var t,n,r;o(null!=(r=null==(n=e.config)||null==(t=n.extension)?void 0:t.isExtension)&&r)})},[a]),r}function e$(){var e=(0,t._)((0,i.useState)(null),2),n=e[0],r=e[1],o=(0,L.default)().dotReplit;return(0,i.useEffect)(function(){return o.watch(function(e){var t,n,i=null==(n=e.config)||null==(t=n.extension)?void 0:t.extensionID;i?r((0,eU.asExtensionId)(i)):r(null)})},[o]),n}var ez=function(){var e=(0,L.default)().dotReplit,n=(0,t._)((0,i.useState)(null),2),r=n[0],o=n[1];return(0,i.useEffect)(function(){return e.watch(function(e){var t,n,r=null==(n=e.config)||null==(t=n.extension)?void 0:t.staticDirectory;r?o({path:r,relativePath:r.replace(/^\.\//,"")}):o(null)})},[e]),r};function eH(){var e,n,r,o=(0,c.default)(),a=eV({variables:{replId:o}}),s=a.data,l=a.loading,u=a.error,d=(0,t._)((e=(0,p._)({},eL,void 0),eO.useMutation(eF,e)),1)[0],f=!l&&!u&&!!(null==s?void 0:s.getRepl)&&"Repl"===s.getRepl.__typename&&null!=(r=null==(n=s.getRepl.config)?void 0:n.isExtension)&&r,h=(0,t._)((0,i.useState)(!1),2),g=h[0],m=h[1],x=(0,L.default)().dotReplit;(0,i.useEffect)(function(){return x.watch(function(e){var t,n,r;m(null!=(r=null==(n=e.config)||null==(t=n.extension)?void 0:t.isExtension)&&r)})},[x]),(0,i.useEffect)(function(){l||u||g!==f&&d({variables:{replId:o,isExtension:g},optimisticResponse:{__typename:"RootMutationType",updateRepl:{__typename:"UpdateReplPayload",repl:{id:o,__typename:"Repl",config:{__typename:"ReplConfig",isExtension:g}}}}})},[l,u,o,f,g,d])}e.s(["useIsExtensionRepl",()=>eG,"useReplExtensionId",()=>e$,"useStaticDirectoryPath",()=>ez,"useSyncReplConfigIsExtension",()=>eH],838124);var eW=e.i(240913),eq=e.i(903381),eK=".tutorial";function eY(){var e=(0,L.default)().fs,n=(0,t._)((0,i.useState)({isLoading:!0,isTutorial:!1}),2),r=n[0],o=n[1];return(0,i.useEffect)(function(){e.watchDir(eW.ROOT_PATH,{onChange:function(e){o({isLoading:!1,isTutorial:e.some(function(e){return e.type===eq.FileType.Directory&&e.filename===eK})})},onMoveOrDelete:function(){o({isLoading:!1,isTutorial:!1})},onError:function(){o({isLoading:!1,isTutorial:!1})}})},[e]),r}e.s(["TUTORIAL_DIR",()=>eK,"default",()=>eY],49416);var eQ=e.i(66718),eX=e.i(965863),eJ=e.i(852819),eZ=(0,a.atom)([]);(0,s.selectAtom)(eZ,function(e){return new Set(e.map(function(e){return e.type}))},o.default);var e0=["shell","git","diff","envEditor","deployments","database","neon","ghostwriterChat","preferences","multiplayer","objectStorage","adminPanel","webview","project","workflows","integrations","runnerOutput","replitAuth","securityScan","developer","agentChat"],e1=["agentChat","ghostwriterChat","deployments"];function e2(){return(0,eJ.useValue)(eZ)}function e3(){return(0,eJ.useGet)(eZ)}function e4(){var e,n,o,a,s,p,h=(0,eJ.useSet)(eZ),g=(n=(0,c.default)(),(a=(null==(o=(0,l.useWorkspaceToolPanesQuery)({variables:{replId:n}}).data)||null==(e=o.getRepl)?void 0:e.__typename)==="Repl"?null==o?void 0:o.getRepl:null)?{repl:a,currentUser:(null==o?void 0:o.currentUser)||null}:{repl:null,currentUser:null}),m=g.repl,x=g.currentUser,y=(0,r.useRouter)(),b=(0,d.useIsInMobileWorkspace)(),w=(0,u.useFlag)({controlName:"flag-neon-databases",logFlagToAnalytics:!1}),k=!!(null==m||null==(p=m.authorizations)||null==(s=p.viewDeploymentConfig)?void 0:s.isAuthorized),S=(0,u.useFlag)({controlName:"flag-nostalgic-spreadsheet"}),C=(0,u.useFlag)({controlName:"flag-recursive-robotonometry"}),j=_().hasProject,T=eG(),E=eY().isTutorial,R=(0,f.usePackagerConfigs)().configs.some(function(e){return"nix"!==e.id}),I=(0,eD.useExtensionTools)(),A=(null==x?void 0:x.isAdmin)||!!y.query.debug,P=(0,eb.usePaneUIContext)(),D=eI(),O=D.isDotReplitAuthButtonEnabled,N=D.isDotReplitAuthPageEnabled,M=D.isDotReplitAuthLoading,L=D.hasDotReplit&&!M&&(O||N);(0,i.useEffect)(function(){var e=b&&(null==m?void 0:m.authorizations.editPermissions.isAuthorized)?[{type:"multiplayer"}]:[];if(m&&x){var n=[[{type:"shell"},!0],[{type:"webview"},!0],[{type:"vnc"},!0],[{type:"runnerOutput"},!0],[{type:"git"},!0],[{type:"envEditor"},!0],[{type:"tutorial"},E],[{type:"database"},!S],[{type:"neon"},w],[{type:"replAuth"},R&&L],[{type:"replitAuth"},!0],[{type:"preferences"},!0],[{type:"adminPanel"},A],[{type:"deployments"},k],[{type:"ghostwriterChat"},!0],[{type:"searchReplace"},!0],[{type:"extensionStore",data:{page:"store"}},!0],[{type:"extensionDevtools"},T],[{type:"objectStorage"},!0],[{type:"automations"},C],[{type:"workflows"},!0],[{type:"project"},j],[{type:"integrations"},!0],[{type:"agentChat"},b],[{type:"securityScan"},!0],[{type:"developer"},!0]],r=!0,i=!1,o=void 0;try{for(var a,s=I[Symbol.iterator]();!(r=(a=s.next()).done);r=!0){var l=a.value;n.push([{type:"extension",data:{extensionId:l.extension.extensionId,installationId:l.extension.installationId,name:l.name||l.extension.manifest.name,icon:l.icon||l.extension.manifest.icon,baseUrl:l.extension.baseUrl,path:l.handler}},!0])}}catch(e){i=!0,o=e}finally{try{r||null==s.return||s.return()}finally{if(i)throw o}}var u=!0,c=!1,d=void 0;try{for(var f,p=n[Symbol.iterator]();!(u=(f=p.next()).done);u=!0){var g=(0,t._)(f.value,2),y=g[0];g[1]&&(!b||e0.includes(y.type))&&e.push(y)}}catch(e){c=!0,d=e}finally{try{u||null==p.return||p.return()}finally{if(c)throw d}}h(e.map(function(e){return{title:P.getTitle(e),pane:e}}).sort(function(e,t){return e1.includes(e.pane.type)?-1:e1.includes(t.pane.type)?1:e.title.localeCompare(t.title)}).map(function(e){return e.pane}))}},[h,b,m,x,R,w,E,A,k,T,I,P,j,L,S,C])}(0,a.atom)(function(e){var t=Array.from(e(eX.paneSessionsAtom).values()).flat(),r=e(eX.closedPaneSessionsAtom),i=(0,n._)(t).concat((0,n._)(r)).sort(function(e,t){return t.lastActiveAt-e.lastActiveAt}),o=[],a=!0,s=!1,l=void 0;try{for(var u,c=i[Symbol.iterator]();!(a=(u=c.next()).done);a=!0){var d=function(){var e=u.value;return 8===o.length?"break":(0,eQ.isFilePaneType)(e.pane.type)||"commands"===e.pane.type?"continue":void(-1===o.findIndex(function(t){return t.type===e.pane.type})&&o.push(e.pane))}();if("break"===d)break}}catch(e){s=!0,l=e}finally{try{a||null==c.return||c.return()}finally{if(s)throw l}}return o}),e.s(["useGetToolPanes",()=>e3,"useSetToolPanes",()=>e4,"useToolPanes",()=>e2],794633)},778203,e=>{"use strict";var t=e.i(207237),n=e.i(475032),r=e.i(529810);function i(){var e=(0,r.default)().container,i=(0,t.default)(),o=(0,n.default)(e,{fallbackToReplCo:!1}).url;if(!o)return null;var a=new URL(o).host,s=a.indexOf(":"),l="22";return -1!==s&&(a=a.substring(0,s),l="2022"),{sshUser:i,sshHostname:a,sshPort:l}}e.s(["default",()=>i])},100811,623059,e=>{"use strict";var t,n=e.i(297083),r=e.i(346715),i=e.i(817556),o=e.i(276385),a=e.i(960933),s=e.i(862927),l=e.i(9293),u=e.i(106020),c=((t={}).CommandBar="commandbar",t.FiletreeContextMenu="filetree-context-menu",t.SidebarSearch="sidebar-search",t.EditorContextMenu="editor-context-menu",t);e.s(["ContributionType",()=>c],623059);var d=e.i(211397),f=a.Type.Object({id:a.Type.Optional(a.Type.String()),icon:a.Type.Optional(a.Type.String()),type:a.Type.Union([a.Type.Literal("action"),a.Type.Literal("context")]),label:a.Type.String(),description:a.Type.String(),contributions:a.Type.Optional(a.Type.Array(a.Type.Enum(c)))});e.s(["parseCommandProxyToExtensionCommand",()=>function e(t,r){return(0,n._)(function(){var o,a,l;return(0,i._)(this,function(u){switch(u.label){case 0:return[4,t.data];case 1:if(o=u.sent(),!s.Value.Check(f,o))throw Error("Invalid command");if(a=null,"string"==typeof o.icon){if(""===o.icon)throw Error("Command icon cannot be empty. Omit it if you do not want an icon.");a=o.icon}return l={data:{label:o.label,description:o.description,type:o.type,iconPath:a,id:o.id?o.id:void 0},extension:r.extension},o.contributions&&(l.data.contributions=o.contributions,r.logger.warn("Command ".concat(o.label," uses deprecated contributions field"))),"context"===o.type?l.commands=function(o){var a=o.active,s=o.searchQuery,l=o.path;return(0,n._)(function(){var n,o,u,c,d,f;return(0,i._)(this,function(i){switch(i.label){case 0:n=null,i.label=1;case 1:return i.trys.push([1,3,,4]),[4,t.commands({active:a,searchQuery:s,path:l})];case 2:return n=i.sent(),[3,4];case 3:return o=i.sent(),r.logger.error(o.message,{commandError:o,api:"command"}),[2,[]];case 4:return[4,n.length];case 5:u=i.sent(),c=[],d=0,i.label=6;case 6:if(!(d<u))return[3,9];return f=c.push,[4,e(n[d],r)];case 7:f.apply(c,[i.sent()]),i.label=8;case 8:return d++,[3,6];case 9:return[2,c]}})})()}:l.run=function(){return(0,n._)(function(){var e;return(0,i._)(this,function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,t.run()];case 1:return n.sent(),[2,void 0];case 2:return e=n.sent(),r.logger.error(e.message,{runError:e,api:"command"}),[2,{type:"error",message:e.message}];case 3:return[2]}})})()},[2,l]}})})()},"wrapExtensionCommand",()=>function e(t,a){if(!["context","action"].includes(t.data.type))throw Error("Command type not supported: "+t.data.type);if("action"===t.data.type)return{match:u.matchLabel,data:{label:t.data.label,description:t.data.description,icon:t.data.iconPath?(0,o.jsx)(d.default,{src:(0,l.getAssetUrl)(t.extension.baseUrl,t.data.iconPath),layout:"fill",alt:""}):(0,o.jsx)(o.Fragment,{children:" "}),type:"action",run:function(){return(0,n._)(function(){var e;return(0,i._)(this,function(n){switch(n.label){case 0:if(!(e=t.run))throw Error("Action command must have run");return[4,e()];case 1:return[2,n.sent()]}})})()}}};var s=t.commands;if(!s)throw Error("Context command must have commands");return{match:u.matchLabel,data:{label:t.data.label,description:t.data.description,icon:t.data.iconPath?(0,o.jsx)(d.default,{src:(0,l.getAssetUrl)(t.extension.baseUrl,t.data.iconPath),layout:"fill",alt:""}):(0,o.jsx)(o.Fragment,{}),type:t.data.type},commands:function(o){var l=o.active,u=o.searchQuery;return(0,n._)(function(){var n;return(0,i._)(this,function(i){switch(i.label){case 0:return[4,s({active:l,searchQuery:u,path:n=(0,r._)(a.path).concat([{data:t.data}])})];case 1:return[2,i.sent().map(function(t){return e(t,{path:n})})]}})})()}}}],100811)},409792,e=>{"use strict";var t={sandbox:"allow-same-origin allow-forms allow-popups allow-popups-to-escape-sandbox allow-modals allow-downloads allow-downloads-without-user-activation allow-presentation allow-orientation-lock allow-pointer-lock allow-scripts",allow:"accelerometer; ambient-light-sensor; autoplay; battery; camera; display-capture; encrypted-media; execution-while-not-rendered; execution-while-out-of-viewport; fullscreen; gamepad; geolocation; gyroscope; layout-animations; legacy-image-formats; magnetometer; microphone; midi; navigation-override; oversized-images; payment; picture-in-picture; publickey-credentials; speaker-selection; sync-xhr; unoptimized-images; unsized-media; usb; screen-wake-lock; web-share; xr-spatial-tracking; clipboard-read; clipboard-write; pointer-lock",allowFullScreen:!0,allowtransparency:"true",allowpaymentrequest:"true",allowpopups:"true"};t.allow,e.s(["default",0,t])},160083,(e,t,n)=>{var r=e.r(365738),i=function(){this.Diff_Timeout=1,this.Diff_EditCost=4,this.Match_Threshold=.5,this.Match_Distance=1e3,this.Patch_DeleteThreshold=.5,this.Patch_Margin=4,this.Match_MaxBits=32};i.Diff=function(e,t){return[e,t]},i.prototype.diff_main=function(e,t,n,r){void 0===r&&(r=this.Diff_Timeout<=0?Number.MAX_VALUE:(new Date).getTime()+1e3*this.Diff_Timeout);var o=r;if(null==e||null==t)throw Error("Null input. (diff_main)");if(e==t)return e?[new i.Diff(0,e)]:[];void 0===n&&(n=!0);var a=n,s=this.diff_commonPrefix(e,t),l=e.substring(0,s);e=e.substring(s),t=t.substring(s),s=this.diff_commonSuffix(e,t);var u=e.substring(e.length-s);e=e.substring(0,e.length-s),t=t.substring(0,t.length-s);var c=this.diff_compute_(e,t,a,o);return l&&c.unshift(new i.Diff(0,l)),u&&c.push(new i.Diff(0,u)),this.diff_cleanupMerge(c),c},i.prototype.diff_compute_=function(e,t,n,r){if(!e)return[new i.Diff(1,t)];if(!t)return[new i.Diff(-1,e)];var o,a=e.length>t.length?e:t,s=e.length>t.length?t:e,l=a.indexOf(s);if(-1!=l)return o=[new i.Diff(1,a.substring(0,l)),new i.Diff(0,s),new i.Diff(1,a.substring(l+s.length))],e.length>t.length&&(o[0][0]=o[2][0]=-1),o;if(1==s.length)return[new i.Diff(-1,e),new i.Diff(1,t)];var u=this.diff_halfMatch_(e,t);if(u){var c=u[0],d=u[1],f=u[2],p=u[3],h=u[4],g=this.diff_main(c,f,n,r),m=this.diff_main(d,p,n,r);return g.concat([new i.Diff(0,h)],m)}return n&&e.length>100&&t.length>100?this.diff_lineMode_(e,t,r):this.diff_bisect_(e,t,r)},i.prototype.diff_lineMode_=function(e,t,n){var r=this.diff_linesToChars_(e,t);e=r.chars1,t=r.chars2;var o=r.lineArray,a=this.diff_main(e,t,!1,n);this.diff_charsToLines_(a,o),this.diff_cleanupSemantic(a),a.push(new i.Diff(0,""));for(var s=0,l=0,u=0,c="",d="";s<a.length;){switch(a[s][0]){case 1:u++,d+=a[s][1];break;case -1:l++,c+=a[s][1];break;case 0:if(l>=1&&u>=1){a.splice(s-l-u,l+u),s=s-l-u;for(var f=this.diff_main(c,d,!1,n),p=f.length-1;p>=0;p--)a.splice(s,0,f[p]);s+=f.length}u=0,l=0,c="",d=""}s++}return a.pop(),a},i.prototype.diff_bisect_=function(e,t,n){for(var r=e.length,o=t.length,a=Math.ceil((r+o)/2),s=2*a,l=Array(s),u=Array(s),c=0;c<s;c++)l[c]=-1,u[c]=-1;l[a+1]=0,u[a+1]=0;for(var d=r-o,f=d%2!=0,p=0,h=0,g=0,m=0,x=0;x<a&&!(new Date().getTime()>n);x++){for(var y=-x+p;y<=x-h;y+=2){for(var b,w=a+y,k=(b=y==-x||y!=x&&l[w-1]<l[w+1]?l[w+1]:l[w-1]+1)-y;b<r&&k<o&&e.charAt(b)==t.charAt(k);)b++,k++;if(l[w]=b,b>r)h+=2;else if(k>o)p+=2;else if(f){var _=a+d-y;if(_>=0&&_<s&&-1!=u[_]){var S=r-u[_];if(b>=S)return this.diff_bisectSplit_(e,t,b,k,n)}}}for(var C=-x+g;C<=x-m;C+=2){for(var S,_=a+C,j=(S=C==-x||C!=x&&u[_-1]<u[_+1]?u[_+1]:u[_-1]+1)-C;S<r&&j<o&&e.charAt(r-S-1)==t.charAt(o-j-1);)S++,j++;if(u[_]=S,S>r)m+=2;else if(j>o)g+=2;else if(!f){var w=a+d-C;if(w>=0&&w<s&&-1!=l[w]){var b=l[w],k=a+b-w;if(b>=(S=r-S))return this.diff_bisectSplit_(e,t,b,k,n)}}}}return[new i.Diff(-1,e),new i.Diff(1,t)]},i.prototype.diff_bisectSplit_=function(e,t,n,r,i){var o=e.substring(0,n),a=t.substring(0,r),s=e.substring(n),l=t.substring(r),u=this.diff_main(o,a,!1,i),c=this.diff_main(s,l,!1,i);return u.concat(c)},i.prototype.diff_linesToChars_=function(e,t){var n=[],r={};function i(e){for(var t="",i=0,a=-1,s=n.length;a<e.length-1;){-1==(a=e.indexOf("\n",i))&&(a=e.length-1);var l=e.substring(i,a+1);(r.hasOwnProperty?r.hasOwnProperty(l):void 0!==r[l])?t+=String.fromCharCode(r[l]):(s==o&&(l=e.substring(i),a=e.length),t+=String.fromCharCode(s),r[l]=s,n[s++]=l),i=a+1}return t}n[0]="";var o=4e4,a=i(e);return o=65535,{chars1:a,chars2:i(t),lineArray:n}},i.prototype.diff_charsToLines_=function(e,t){for(var n=0;n<e.length;n++){for(var r=e[n][1],i=[],o=0;o<r.length;o++)i[o]=t[r.charCodeAt(o)];e[n][1]=i.join("")}},i.prototype.diff_commonPrefix=function(e,t){if(!e||!t||e.charAt(0)!=t.charAt(0))return 0;for(var n=0,r=Math.min(e.length,t.length),i=r,o=0;n<i;)e.substring(o,i)==t.substring(o,i)?o=n=i:r=i,i=Math.floor((r-n)/2+n);return i},i.prototype.diff_commonSuffix=function(e,t){if(!e||!t||e.charAt(e.length-1)!=t.charAt(t.length-1))return 0;for(var n=0,r=Math.min(e.length,t.length),i=r,o=0;n<i;)e.substring(e.length-i,e.length-o)==t.substring(t.length-i,t.length-o)?o=n=i:r=i,i=Math.floor((r-n)/2+n);return i},i.prototype.diff_commonOverlap_=function(e,t){var n=e.length,r=t.length;if(0==n||0==r)return 0;n>r?e=e.substring(n-r):n<r&&(t=t.substring(0,n));var i=Math.min(n,r);if(e==t)return i;for(var o=0,a=1;;){var s=e.substring(i-a),l=t.indexOf(s);if(-1==l)return o;a+=l,(0==l||e.substring(i-a)==t.substring(0,a))&&(o=a,a++)}},i.prototype.diff_halfMatch_=function(e,t){if(this.Diff_Timeout<=0)return null;var n,r,i,o,a,s=e.length>t.length?e:t,l=e.length>t.length?t:e;if(s.length<4||2*l.length<s.length)return null;var u=this;function c(e,t,n){for(var r,i,o,a,s=e.substring(n,n+Math.floor(e.length/4)),l=-1,c="";-1!=(l=t.indexOf(s,l+1));){var d=u.diff_commonPrefix(e.substring(n),t.substring(l)),f=u.diff_commonSuffix(e.substring(0,n),t.substring(0,l));c.length<f+d&&(c=t.substring(l-f,l)+t.substring(l,l+d),r=e.substring(0,n-f),i=e.substring(n+d),o=t.substring(0,l-f),a=t.substring(l+d))}return 2*c.length>=e.length?[r,i,o,a,c]:null}var d=c(s,l,Math.ceil(s.length/4)),f=c(s,l,Math.ceil(s.length/2));return d||f?(n=f?d&&d[4].length>f[4].length?d:f:d,e.length>t.length?(r=n[0],i=n[1],o=n[2],a=n[3]):(o=n[0],a=n[1],r=n[2],i=n[3]),[r,i,o,a,n[4]]):null},i.prototype.diff_cleanupSemantic=function(e){for(var t=!1,n=[],r=0,o=null,a=0,s=0,l=0,u=0,c=0;a<e.length;)0==e[a][0]?(n[r++]=a,s=u,l=c,u=0,c=0,o=e[a][1]):(1==e[a][0]?u+=e[a][1].length:c+=e[a][1].length,o&&o.length<=Math.max(s,l)&&o.length<=Math.max(u,c)&&(e.splice(n[r-1],0,new i.Diff(-1,o)),e[n[r-1]+1][0]=1,r--,a=--r>0?n[r-1]:-1,s=0,l=0,u=0,c=0,o=null,t=!0)),a++;for(t&&this.diff_cleanupMerge(e),this.diff_cleanupSemanticLossless(e),a=1;a<e.length;){if(-1==e[a-1][0]&&1==e[a][0]){var d=e[a-1][1],f=e[a][1],p=this.diff_commonOverlap_(d,f),h=this.diff_commonOverlap_(f,d);p>=h?(p>=d.length/2||p>=f.length/2)&&(e.splice(a,0,new i.Diff(0,f.substring(0,p))),e[a-1][1]=d.substring(0,d.length-p),e[a+1][1]=f.substring(p),a++):(h>=d.length/2||h>=f.length/2)&&(e.splice(a,0,new i.Diff(0,d.substring(0,h))),e[a-1][0]=1,e[a-1][1]=f.substring(0,f.length-h),e[a+1][0]=-1,e[a+1][1]=d.substring(h),a++),a++}a++}},i.prototype.diff_cleanupSemanticLossless=function(e){function t(e,t){if(!e||!t)return 6;var n=e.charAt(e.length-1),r=t.charAt(0),o=n.match(i.nonAlphaNumericRegex_),a=r.match(i.nonAlphaNumericRegex_),s=o&&n.match(i.whitespaceRegex_),l=a&&r.match(i.whitespaceRegex_),u=s&&n.match(i.linebreakRegex_),c=l&&r.match(i.linebreakRegex_),d=u&&e.match(i.blanklineEndRegex_),f=c&&t.match(i.blanklineStartRegex_);if(d||f)return 5;if(u||c)return 4;if(o&&!s&&l)return 3;if(s||l)return 2;if(o||a)return 1;return 0}for(var n=1;n<e.length-1;){if(0==e[n-1][0]&&0==e[n+1][0]){var r=e[n-1][1],o=e[n][1],a=e[n+1][1],s=this.diff_commonSuffix(r,o);if(s){var l=o.substring(o.length-s);r=r.substring(0,r.length-s),o=l+o.substring(0,o.length-s),a=l+a}for(var u=r,c=o,d=a,f=t(r,o)+t(o,a);o.charAt(0)===a.charAt(0);){r+=o.charAt(0),o=o.substring(1)+a.charAt(0),a=a.substring(1);var p=t(r,o)+t(o,a);p>=f&&(f=p,u=r,c=o,d=a)}e[n-1][1]!=u&&(u?e[n-1][1]=u:(e.splice(n-1,1),n--),e[n][1]=c,d?e[n+1][1]=d:(e.splice(n+1,1),n--))}n++}},i.nonAlphaNumericRegex_=/[^a-zA-Z0-9]/,i.whitespaceRegex_=/\s/,i.linebreakRegex_=/[\r\n]/,i.blanklineEndRegex_=/\n\r?\n$/,i.blanklineStartRegex_=/^\r?\n\r?\n/,i.prototype.diff_cleanupEfficiency=function(e){for(var t=!1,n=[],r=0,o=null,a=0,s=!1,l=!1,u=!1,c=!1;a<e.length;)0==e[a][0]?(e[a][1].length<this.Diff_EditCost&&(u||c)?(n[r++]=a,s=u,l=c,o=e[a][1]):(r=0,o=null),u=c=!1):(-1==e[a][0]?c=!0:u=!0,o&&(s&&l&&u&&c||o.length<this.Diff_EditCost/2&&s+l+u+c==3)&&(e.splice(n[r-1],0,new i.Diff(-1,o)),e[n[r-1]+1][0]=1,r--,o=null,s&&l?(u=c=!0,r=0):(a=--r>0?n[r-1]:-1,u=c=!1),t=!0)),a++;t&&this.diff_cleanupMerge(e)},i.prototype.diff_cleanupMerge=function(e){e.push(new i.Diff(0,""));for(var t,n=0,r=0,o=0,a="",s="";n<e.length;)switch(e[n][0]){case 1:o++,s+=e[n][1],n++;break;case -1:r++,a+=e[n][1],n++;break;case 0:r+o>1?(0!==r&&0!==o&&(0!==(t=this.diff_commonPrefix(s,a))&&(n-r-o>0&&0==e[n-r-o-1][0]?e[n-r-o-1][1]+=s.substring(0,t):(e.splice(0,0,new i.Diff(0,s.substring(0,t))),n++),s=s.substring(t),a=a.substring(t)),0!==(t=this.diff_commonSuffix(s,a))&&(e[n][1]=s.substring(s.length-t)+e[n][1],s=s.substring(0,s.length-t),a=a.substring(0,a.length-t))),n-=r+o,e.splice(n,r+o),a.length&&(e.splice(n,0,new i.Diff(-1,a)),n++),s.length&&(e.splice(n,0,new i.Diff(1,s)),n++),n++):0!==n&&0==e[n-1][0]?(e[n-1][1]+=e[n][1],e.splice(n,1)):n++,o=0,r=0,a="",s=""}""===e[e.length-1][1]&&e.pop();var l=!1;for(n=1;n<e.length-1;)0==e[n-1][0]&&0==e[n+1][0]&&(e[n][1].substring(e[n][1].length-e[n-1][1].length)==e[n-1][1]?(e[n][1]=e[n-1][1]+e[n][1].substring(0,e[n][1].length-e[n-1][1].length),e[n+1][1]=e[n-1][1]+e[n+1][1],e.splice(n-1,1),l=!0):e[n][1].substring(0,e[n+1][1].length)==e[n+1][1]&&(e[n-1][1]+=e[n+1][1],e[n][1]=e[n][1].substring(e[n+1][1].length)+e[n+1][1],e.splice(n+1,1),l=!0)),n++;l&&this.diff_cleanupMerge(e)},i.prototype.diff_xIndex=function(e,t){var n,r=0,i=0,o=0,a=0;for(n=0;n<e.length&&(1!==e[n][0]&&(r+=e[n][1].length),-1!==e[n][0]&&(i+=e[n][1].length),!(r>t));n++)o=r,a=i;return e.length!=n&&-1===e[n][0]?a:a+(t-o)},i.prototype.diff_prettyHtml=function(e){for(var t=[],n=/&/g,r=/</g,i=/>/g,o=/\n/g,a=0;a<e.length;a++){var s=e[a][0],l=e[a][1].replace(n,"&amp;").replace(r,"&lt;").replace(i,"&gt;").replace(o,"&para;<br>");switch(s){case 1:t[a]='<ins style="background:#e6ffe6;">'+l+"</ins>";break;case -1:t[a]='<del style="background:#ffe6e6;">'+l+"</del>";break;case 0:t[a]="<span>"+l+"</span>"}}return t.join("")},i.prototype.diff_text1=function(e){for(var t=[],n=0;n<e.length;n++)1!==e[n][0]&&(t[n]=e[n][1]);return t.join("")},i.prototype.diff_text2=function(e){for(var t=[],n=0;n<e.length;n++)-1!==e[n][0]&&(t[n]=e[n][1]);return t.join("")},i.prototype.diff_levenshtein=function(e){for(var t=0,n=0,r=0,i=0;i<e.length;i++){var o=e[i][0],a=e[i][1];switch(o){case 1:n+=a.length;break;case -1:r+=a.length;break;case 0:t+=Math.max(n,r),n=0,r=0}}return t+Math.max(n,r)},i.prototype.diff_toDelta=function(e){for(var t=[],n=0;n<e.length;n++)switch(e[n][0]){case 1:t[n]="+"+encodeURI(e[n][1]);break;case -1:t[n]="-"+e[n][1].length;break;case 0:t[n]="="+e[n][1].length}return t.join("	").replace(/%20/g," ")},i.prototype.diff_fromDelta=function(e,t){for(var n=[],r=0,o=0,a=t.split(/\t/g),s=0;s<a.length;s++){var l=a[s].substring(1);switch(a[s].charAt(0)){case"+":try{n[r++]=new i.Diff(1,decodeURI(l))}catch(e){throw Error("Illegal escape in diff_fromDelta: "+l)}break;case"-":case"=":var u=parseInt(l,10);if(isNaN(u)||u<0)throw Error("Invalid number in diff_fromDelta: "+l);var c=e.substring(o,o+=u);"="==a[s].charAt(0)?n[r++]=new i.Diff(0,c):n[r++]=new i.Diff(-1,c);break;default:if(a[s])throw Error("Invalid diff operation in diff_fromDelta: "+a[s])}}if(o!=e.length)throw Error("Delta length ("+o+") does not equal source text length ("+e.length+").");return n},i.prototype.match_main=function(e,t,n){if(null==e||null==t||null==n)throw Error("Null input. (match_main)");return(n=Math.max(0,Math.min(n,e.length)),e==t)?0:e.length?e.substring(n,n+t.length)==t?n:this.match_bitap_(e,t,n):-1},i.prototype.match_bitap_=function(e,t,n){if(t.length>this.Match_MaxBits)throw Error("Pattern too long for this browser.");var r,i,o,a=this.match_alphabet_(t),s=this;function l(e,r){var i=e/t.length,o=Math.abs(n-r);return s.Match_Distance?i+o/s.Match_Distance:o?1:i}var u=this.Match_Threshold,c=e.indexOf(t,n);-1!=c&&(u=Math.min(l(0,c),u),-1!=(c=e.lastIndexOf(t,n+t.length))&&(u=Math.min(l(0,c),u)));var d=1<<t.length-1;c=-1;for(var f=t.length+e.length,p=0;p<t.length;p++){for(r=0,i=f;r<i;)l(p,n+i)<=u?r=i:f=i,i=Math.floor((f-r)/2+r);f=i;var h=Math.max(1,n-i+1),g=Math.min(n+i,e.length)+t.length,m=Array(g+2);m[g+1]=(1<<p)-1;for(var x=g;x>=h;x--){var y=a[e.charAt(x-1)];if(0===p?m[x]=(m[x+1]<<1|1)&y:m[x]=(m[x+1]<<1|1)&y|((o[x+1]|o[x])<<1|1)|o[x+1],m[x]&d){var b=l(p,x-1);if(b<=u)if(u=b,(c=x-1)>n)h=Math.max(1,2*n-c);else break}}if(l(p+1,n)>u)break;o=m}return c},i.prototype.match_alphabet_=function(e){for(var t={},n=0;n<e.length;n++)t[e.charAt(n)]=0;for(var n=0;n<e.length;n++)t[e.charAt(n)]|=1<<e.length-n-1;return t},i.prototype.patch_addContext_=function(e,t){if(0!=t.length){if(null===e.start2)throw Error("patch not initialized");for(var n=t.substring(e.start2,e.start2+e.length1),r=0;t.indexOf(n)!=t.lastIndexOf(n)&&n.length<this.Match_MaxBits-this.Patch_Margin-this.Patch_Margin;)r+=this.Patch_Margin,n=t.substring(e.start2-r,e.start2+e.length1+r);r+=this.Patch_Margin;var o=t.substring(e.start2-r,e.start2);o&&e.diffs.unshift(new i.Diff(0,o));var a=t.substring(e.start2+e.length1,e.start2+e.length1+r);a&&e.diffs.push(new i.Diff(0,a)),e.start1-=o.length,e.start2-=o.length,e.length1+=o.length+a.length,e.length2+=o.length+a.length}},i.prototype.patch_make=function(e,t,n){if("string"==typeof e&&"string"==typeof t&&void 0===n)o=e,(a=this.diff_main(o,t,!0)).length>2&&(this.diff_cleanupSemantic(a),this.diff_cleanupEfficiency(a));else if(e&&(void 0===e?"undefined":r._(e))=="object"&&void 0===t&&void 0===n)a=e,o=this.diff_text1(a);else if("string"==typeof e&&t&&(void 0===t?"undefined":r._(t))=="object"&&void 0===n)o=e,a=t;else if("string"==typeof e&&"string"==typeof t&&n&&(void 0===n?"undefined":r._(n))=="object")o=e,a=n;else throw Error("Unknown call format to patch_make.");if(0===a.length)return[];for(var o,a,s=[],l=new i.patch_obj,u=0,c=0,d=0,f=o,p=o,h=0;h<a.length;h++){var g=a[h][0],m=a[h][1];switch(!u&&0!==g&&(l.start1=c,l.start2=d),g){case 1:l.diffs[u++]=a[h],l.length2+=m.length,p=p.substring(0,d)+m+p.substring(d);break;case -1:l.length1+=m.length,l.diffs[u++]=a[h],p=p.substring(0,d)+p.substring(d+m.length);break;case 0:m.length<=2*this.Patch_Margin&&u&&a.length!=h+1?(l.diffs[u++]=a[h],l.length1+=m.length,l.length2+=m.length):m.length>=2*this.Patch_Margin&&u&&(this.patch_addContext_(l,f),s.push(l),l=new i.patch_obj,u=0,f=p,c=d)}1!==g&&(c+=m.length),-1!==g&&(d+=m.length)}return u&&(this.patch_addContext_(l,f),s.push(l)),s},i.prototype.patch_deepCopy=function(e){for(var t=[],n=0;n<e.length;n++){var r=e[n],o=new i.patch_obj;o.diffs=[];for(var a=0;a<r.diffs.length;a++)o.diffs[a]=new i.Diff(r.diffs[a][0],r.diffs[a][1]);o.start1=r.start1,o.start2=r.start2,o.length1=r.length1,o.length2=r.length2,t[n]=o}return t},i.prototype.patch_apply=function(e,t){if(0==e.length)return[t,[]];e=this.patch_deepCopy(e);var n=this.patch_addPadding(e);t=n+t+n,this.patch_splitMax(e);for(var r=0,i=[],o=0;o<e.length;o++){var a=e[o].start2+r,s=this.diff_text1(e[o].diffs),l=-1;if(s.length>this.Match_MaxBits?-1!=(c=this.match_main(t,s.substring(0,this.Match_MaxBits),a))&&(-1==(l=this.match_main(t,s.substring(s.length-this.Match_MaxBits),a+s.length-this.Match_MaxBits))||c>=l)&&(c=-1):c=this.match_main(t,s,a),-1==c)i[o]=!1,r-=e[o].length2-e[o].length1;else if(i[o]=!0,r=c-a,d=-1==l?t.substring(c,c+s.length):t.substring(c,l+this.Match_MaxBits),s==d)t=t.substring(0,c)+this.diff_text2(e[o].diffs)+t.substring(c+s.length);else{var u=this.diff_main(s,d,!1);if(s.length>this.Match_MaxBits&&this.diff_levenshtein(u)/s.length>this.Patch_DeleteThreshold)i[o]=!1;else{this.diff_cleanupSemanticLossless(u);for(var c,d,f,p=0,h=0;h<e[o].diffs.length;h++){var g=e[o].diffs[h];0!==g[0]&&(f=this.diff_xIndex(u,p)),1===g[0]?t=t.substring(0,c+f)+g[1]+t.substring(c+f):-1===g[0]&&(t=t.substring(0,c+f)+t.substring(c+this.diff_xIndex(u,p+g[1].length))),-1!==g[0]&&(p+=g[1].length)}}}}return[t=t.substring(n.length,t.length-n.length),i]},i.prototype.patch_addPadding=function(e){for(var t=this.Patch_Margin,n="",r=1;r<=t;r++)n+=String.fromCharCode(r);for(var r=0;r<e.length;r++)e[r].start1+=t,e[r].start2+=t;var o=e[0],a=o.diffs;if(0==a.length||0!=a[0][0])a.unshift(new i.Diff(0,n)),o.start1-=t,o.start2-=t,o.length1+=t,o.length2+=t;else if(t>a[0][1].length){var s=t-a[0][1].length;a[0][1]=n.substring(a[0][1].length)+a[0][1],o.start1-=s,o.start2-=s,o.length1+=s,o.length2+=s}if(0==(a=(o=e[e.length-1]).diffs).length||0!=a[a.length-1][0])a.push(new i.Diff(0,n)),o.length1+=t,o.length2+=t;else if(t>a[a.length-1][1].length){var s=t-a[a.length-1][1].length;a[a.length-1][1]+=n.substring(0,s),o.length1+=s,o.length2+=s}return n},i.prototype.patch_splitMax=function(e){for(var t=this.Match_MaxBits,n=0;n<e.length;n++)if(!(e[n].length1<=t)){var r=e[n];e.splice(n--,1);for(var o=r.start1,a=r.start2,s="";0!==r.diffs.length;){var l=new i.patch_obj,u=!0;for(l.start1=o-s.length,l.start2=a-s.length,""!==s&&(l.length1=l.length2=s.length,l.diffs.push(new i.Diff(0,s)));0!==r.diffs.length&&l.length1<t-this.Patch_Margin;){var c=r.diffs[0][0],d=r.diffs[0][1];1===c?(l.length2+=d.length,a+=d.length,l.diffs.push(r.diffs.shift()),u=!1):-1===c&&1==l.diffs.length&&0==l.diffs[0][0]&&d.length>2*t?(l.length1+=d.length,o+=d.length,u=!1,l.diffs.push(new i.Diff(c,d)),r.diffs.shift()):(d=d.substring(0,t-l.length1-this.Patch_Margin),l.length1+=d.length,o+=d.length,0===c?(l.length2+=d.length,a+=d.length):u=!1,l.diffs.push(new i.Diff(c,d)),d==r.diffs[0][1]?r.diffs.shift():r.diffs[0][1]=r.diffs[0][1].substring(d.length))}s=(s=this.diff_text2(l.diffs)).substring(s.length-this.Patch_Margin);var f=this.diff_text1(r.diffs).substring(0,this.Patch_Margin);""!==f&&(l.length1+=f.length,l.length2+=f.length,0!==l.diffs.length&&0===l.diffs[l.diffs.length-1][0]?l.diffs[l.diffs.length-1][1]+=f:l.diffs.push(new i.Diff(0,f))),u||e.splice(++n,0,l)}}},i.prototype.patch_toText=function(e){for(var t=[],n=0;n<e.length;n++)t[n]=e[n];return t.join("")},i.prototype.patch_fromText=function(e){var t=[];if(!e)return t;for(var n=e.split("\n"),r=0,o=/^@@ -(\d+),?(\d*) \+(\d+),?(\d*) @@$/;r<n.length;){var a=n[r].match(o);if(!a)throw Error("Invalid patch string: "+n[r]);var s=new i.patch_obj;for(t.push(s),s.start1=parseInt(a[1],10),""===a[2]?(s.start1--,s.length1=1):"0"==a[2]?s.length1=0:(s.start1--,s.length1=parseInt(a[2],10)),s.start2=parseInt(a[3],10),""===a[4]?(s.start2--,s.length2=1):"0"==a[4]?s.length2=0:(s.start2--,s.length2=parseInt(a[4],10)),r++;r<n.length;){var l=n[r].charAt(0);try{var u=decodeURI(n[r].substring(1))}catch(e){throw Error("Illegal escape in patch_fromText: "+u)}if("-"==l)s.diffs.push(new i.Diff(-1,u));else if("+"==l)s.diffs.push(new i.Diff(1,u));else if(" "==l)s.diffs.push(new i.Diff(0,u));else if("@"==l)break;else if(""===l);else throw Error('Invalid patch mode "'+l+'" in: '+u);r++}}return t},i.patch_obj=function(){this.diffs=[],this.start1=null,this.start2=null,this.length1=0,this.length2=0},i.patch_obj.prototype.toString=function(){e=0===this.length1?this.start1+",0":1==this.length1?this.start1+1:this.start1+1+","+this.length1;for(var e,t,n=0===this.length2?this.start2+",0":1==this.length2?this.start2+1:this.start2+1+","+this.length2,r=["@@ -"+e+" +"+n+" @@\n"],i=0;i<this.diffs.length;i++){switch(this.diffs[i][0]){case 1:t="+";break;case -1:t="-";break;case 0:t=" "}r[i+1]=t+encodeURI(this.diffs[i][1])+"\n"}return r.join("").replace(/%20/g," ")},t.exports=i,t.exports.diff_match_patch=i,t.exports.DIFF_DELETE=-1,t.exports.DIFF_INSERT=1,t.exports.DIFF_EQUAL=0},960308,e=>{"use strict";var t=e.i(904851),n=e.i(90659),r=e.i(721281),i=e.i(530658),o=e.i(817556),a=e.i(160083),s=a.default.DIFF_DELETE,l=a.default.DIFF_INSERT,u=a.default.DIFF_EQUAL;function c(e,t){var n=new a.default,r=n.diff_linesToChars_(e,t),i=r.chars1,o=r.chars2,s=r.lineArray,l=n.diff_main(i,o,!1);return n.diff_charsToLines_(l,s),l}function d(e){return e.split("\n").length-1}function f(e,t,n){if(e>0){var r=function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;if(0===n)return 0;var i=t.indexOf("\n",r);return -1===i?null:1===n?i+1:e(t,n-1,i+1)}(n,t);if(null!==r)return{lineNumber:t,character:r,padding:e}}return null}function p(e,t){var n=!1,r=!1;n="\n"===e[e.length-1],r="\n"===t[t.length-1];for(var o=c(e+(n?"":"\n"),t+(r?"":"\n")),a=0,p=0,h=[],g=[],m=[],x=[],y=0,b=0,w=0;w<o.length;w++){var k=(0,i._)(o[w],2),_=k[0],S=d(k[1]);switch(_){case s:var C,j=(0,i._)(null!=(C=o[w+1])?C:[],2),T=j[0],E=j[1];a+=S;for(var R=0;R<S;R++)h.push(a-R);var I=S;T===l&&(I-=d(E));var A=f(I,p,t);A&&x.push(A);break;case l:var P,D=(0,i._)(null!=(P=o[w-1])?P:[],2),O=D[0],N=D[1];p+=S;for(var M=0;M<S;M++)g.push(p-M);var L=S;O===s&&(L-=d(N));var B=f(L,a,e);B&&m.push(B);break;case u:p>b&&(b=p),a>y&&(y=a),a+=S,p+=S}}return{leftPadded:m.filter(function(e){return e.lineNumber<b}),rightPadded:x.filter(function(e){return e.lineNumber<y}),leftColored:h,rightColored:g,changedTrailingNewline:n!==r,leftTrailingNewline:n,rightTrailingNewline:r}}var h=function(){function e(n,o){(0,t._)(this,e),(0,r._)(this,"deleted",void 0),(0,r._)(this,"inserted",void 0),(0,r._)(this,"linePositions",void 0),(0,r._)(this,"lineLengths",void 0),(0,r._)(this,"currentTrailingNewline",void 0),(0,r._)(this,"otherTrailingNewline",void 0),(0,r._)(this,"changedTrailingNewline",void 0),this.deleted=new Set,this.inserted=new Map,this.linePositions=new Map,this.lineLengths=new Map,this.currentTrailingNewline="\n"===n[n.length-1],this.otherTrailingNewline="\n"===o[o.length-1],this.changedTrailingNewline=this.currentTrailingNewline!==this.otherTrailingNewline;var a=c(n,o),d=[],f=!0,p=!1,h=void 0;try{for(var g,m=a[Symbol.iterator]();!(f=(g=m.next()).done);f=!0){var x=(0,i._)(g.value,2),y=x[0],b=x[1].split("\n");""===b[b.length-1]&&b.pop();var w=!0,k=!1,_=void 0;try{for(var S,C=b[Symbol.iterator]();!(w=(S=C.next()).done);w=!0){var j=S.value;d.push([y,j])}}catch(e){k=!0,_=e}finally{try{w||null==C.return||C.return()}finally{if(k)throw _}}}}catch(e){p=!0,h=e}finally{try{f||null==m.return||m.return()}finally{if(p)throw h}}this.currentTrailingNewline&&!this.otherTrailingNewline?d.push([s,""]):!this.currentTrailingNewline&&this.otherTrailingNewline?d.push([l,""]):this.currentTrailingNewline&&this.otherTrailingNewline&&d.push([u,""]);var T=1,E=0,R=1,I=!0,A=!1,P=void 0;try{for(var D,O=d[Symbol.iterator]();!(I=(D=O.next()).done);I=!0){var N=(0,i._)(D.value,2),M=N[0],L=N[1];switch(M){case s:this.linePositions.set(T,E),this.lineLengths.set(T,L.length),this.deleted.add(T),E+=L.length+1,T++;break;case l:var B=T-1,V=this.inserted.get(B);V||(V=[],this.inserted.set(B,V)),V.push({number:R,content:L}),R++;break;case u:this.linePositions.set(T,E),this.lineLengths.set(T,L.length),E+=L.length+1,T++,R++}}}catch(e){A=!0,P=e}finally{try{I||null==O.return||O.return()}finally{if(A)throw P}}}return(0,n._)(e,[{key:"startInsertions",value:function(){var e=this.inserted.get(0);return e&&0!==e.length?e:null}},{key:"lineIsDeleted",value:function(e){return this.deleted.has(e)}},{key:"lineInsertions",value:function(e){var t=this.inserted.get(e);return t&&0!==t.length?t:null}},{key:"lineInsertedContent",value:function(e){var t=this.lineInsertions(e);return t?t.map(function(e){return e.content}).join("\n"):null}},{key:"offsetFor",value:function(e){var t,n,r;r=0+(null!=(n=null==(t=this.inserted.get(0))?void 0:t.length)?n:0);for(var i=1;i<e;i++){this.lineIsDeleted(i)&&r--;var o=this.lineInsertions(i);o&&(r+=o.length)}return r}},{key:"linePosition",value:function(e){var t;return null!=(t=this.linePositions.get(e))?t:null}},{key:"lineLength",value:function(e){var t;return null!=(t=this.lineLengths.get(e))?t:null}},{key:"line",value:function(e){var t=this.linePosition(e),n=this.lineLength(e);if(null===t||null===n)return null;var r=this.offsetFor(e),i=this.lineIsDeleted(e),o=this.lineInsertions(e);return{number:e,from:t,to:t+n,length:n,offset:r,isDeleted:i,insertions:o}}},{key:"lines",value:function(){var e,t,n,r,a,s,l,u;return(0,o._)(this,function(o){switch(o.label){case 0:e=!0,t=!1,n=void 0,o.label=1;case 1:o.trys.push([1,6,7,8]),r=this.linePositions[Symbol.iterator](),o.label=2;case 2:if(e=(a=r.next()).done)return[3,5];if(s=(0,i._)(a.value,1)[0],!(l=this.line(s)))throw Error("line should not be null");return[4,l];case 3:o.sent(),o.label=4;case 4:return e=!0,[3,2];case 5:return[3,8];case 6:return u=o.sent(),t=!0,n=u,[3,8];case 7:try{e||null==r.return||r.return()}finally{if(t)throw n}return[7];case 8:return[2]}})}}]),e}();e.s(["LineBasedDiff",()=>h,"getDiffViewerInstructions",()=>p])},816639,e=>{"use strict";var t,n,r,i=e.i(878420),o=e.i(64386),a=e.i(886513),s=e.i(530658),l=e.i(276385),u=e.i(389959),c=e.i(399119),d=e.i(904851),f=e.i(90659),p=e.i(721281),h=e.i(445789),g=e.i(753950),m=e.i(179302),x=e.i(960308),y=m.EditorView.baseTheme({".cm-diff-inserted":{backgroundColor:"#0053A644",borderLeft:"#0053A6 solid 3px"},".cm-diff-deleted":{backgroundColor:"#c93c3733",borderLeft:"#c93c37 solid 3px"}}),b=m.Decoration.line({attributes:{class:"cm-diff-inserted"}}),w=m.Decoration.line({attributes:{class:"cm-diff-deleted"}}),k=g.StateEffect.define({map:function(e,t){return e.map(t)}}),_=function(e){function t(){return(0,d._)(this,t),(0,c._)(this,t,arguments)}return(0,h._)(t,e),(0,f._)(t,[{key:"toDOM",value:function(){var e=document.createElement("div");return e.className="cm-diff-alignment cm-line",e.innerHTML="&nbsp;",e}},{key:"ignoreEvent",value:function(){return!1}}]),t}(m.WidgetType);function S(e){var t=new g.RangeSetBuilder,n=new _;e.sort(function(e,t){return e.character-t.character});var r=!0,i=!1,o=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done);r=!0)for(var l=a.value,u=l.character,c=l.padding,d=0;d<c;d++)t.add(u,u,m.Decoration.widget({widget:n,side:-1,block:!0}))}catch(e){i=!0,o=e}finally{try{r||null==s.return||s.return()}finally{if(i)throw o}}return t.finish()}function C(e){var t=e.coloredLines,n=e.colorDecoration;return[y,m.ViewPlugin.fromClass(function e(r){(0,d._)(this,e),(0,p._)(this,"decorations",void 0);var i=new g.RangeSetBuilder,o=!0,a=!1,s=void 0;try{for(var l,u=t[Symbol.iterator]();!(o=(l=u.next()).done);o=!0){var c=l.value,f=r.state.doc.line(c);i.add(f.from,f.from,n)}}catch(e){a=!0,s=e}finally{try{o||null==u.return||u.return()}finally{if(a)throw s}}this.decorations=i.finish()},{decorations:function(e){return e.decorations}}),g.StateField.define({create:function(){return m.Decoration.none},update:function(e,t){var n=!0,r=!1,i=void 0;try{for(var o,a=t.effects[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var s=o.value;if(s.is(k))return s.value}}catch(e){r=!0,i=e}finally{try{n||null==a.return||a.return()}finally{if(r)throw i}}return t.docChanged?e.map(t.changes):e},provide:function(e){return m.EditorView.decorations.from(e)}})]}var j=e.i(221250),T=e.i(542101),E=e.i(409146),R=(t=function(e,t){return m.EditorView.domEventHandlers({scroll:function(n,r){if(r===e&&n.target){var i=n.target;if(i.scrollTop){var o=i.scrollTop;t.scrollDOM.scrollTo({top:o})}}}})},n=new g.Compartment,r=new g.Compartment,{extensions:function(){return{right:n.of([]),left:r.of([])}},setup:function(e,i){e.dispatch({effects:r.reconfigure(t(e,i))}),i.dispatch({effects:n.reconfigure(t(i,e))})}}),I=R.extensions,A=R.setup;function P(e){var t=e.left,n=e.right,r=e.showDiffDecorations,l=void 0===r||r,c=t.code,d=(0,a._)(t,["code"]),f=n.code,p=(0,a._)(n,["code"]),h=(0,T.default)(),m=h.ref,y=h.view,_=(0,T.default)(),j=_.ref,E=_.view,R=(0,u.useMemo)(function(){var e=I().left;return d.extensions?[d.extensions,e]:e},[d.extensions]),P=(0,u.useMemo)(function(){var e=I().right;return p.extensions?[p.extensions,e]:e},[p.extensions]);d=(0,o._)((0,i._)({},d),{extensions:R}),p=(0,o._)((0,i._)({},p),{extensions:P});var D=(0,s._)((0,u.useState)(!1),2),O=D[0],N=D[1],M=(0,s._)((0,u.useState)(!1),2),L=M[0],B=M[1];return(0,u.useEffect)(function(){if(y&&E&&O&&L&&l){var e=setTimeout(function(){var e;A(y,E),e=(0,x.getDiffViewerInstructions)(y.state.doc.sliceString(0),E.state.doc.sliceString(0)),y.dispatch({effects:[g.StateEffect.appendConfig.of(C({coloredLines:e.leftColored.sort(function(e,t){return e-t}),colorDecoration:w})),k.of(S(e.leftPadded))]}),E.dispatch({effects:[g.StateEffect.appendConfig.of(C({coloredLines:e.rightColored.sort(function(e,t){return e-t}),colorDecoration:b})),k.of(S(e.rightPadded))]})});return function(){return clearTimeout(e)}}},[y,E,O,L,l]),(0,u.useEffect)(function(){y&&(y.dispatch({changes:{from:0,to:y.state.doc.length,insert:c}}),N(!0))},[c,y]),(0,u.useEffect)(function(){E&&(E.dispatch({changes:{from:0,to:E.state.doc.length,insert:f}}),B(!0))},[f,E]),{left:{view:y,ref:m,code:c,options:d,ready:O},right:{view:E,ref:j,code:f,options:p,ready:L}}}function D(e){var t=e.diffViewer,n=(0,a._)(e,["diffViewer"]),r=(0,i._)({},t.options,n);return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(j.default,(0,i._)({ref:t.ref,css:{height:t.ready?0:"auto"},initialDoc:t.code,lineWrapping:!1,readOnly:!0},r)),!t.ready&&(0,l.jsx)(E.default,{code:t.code,language:r.language,filePath:r.filePath,lineNumbers:!r.hideGutter,fontSize:r.fontSize})]})}e.s(["DiffComponent",()=>D,"useDiffViewers",()=>P],816639)},725182,e=>{"use strict";e.i(33699);var t=e.i(399528),n=e.i(878420),r=e.i(569384),i=e.i(973245),o=e.i(304277);function a(){var e=(0,r._)(["\n  query WorkspaceShowAdmin {\n    currentUser {\n      id\n      isAdmin: hasRole(role: ADMIN)\n    }\n  }\n"]);return a=function(){return e},e}e.i(566901);var s={},l=(0,i.gql)(a());function u(){var e,r,i=(e=(0,n._)({},s,void 0),o.useQuery(l,e)).data,a=(0,t.useRouter)();return(null==i||null==(r=i.currentUser)?void 0:r.isAdmin)||!!a.query.debug}e.s(["useShowAdmin",()=>u],725182)},989740,e=>{"use strict";var t=e.i(297083),n=e.i(530658),r=e.i(346715),i=e.i(817556),o=e.i(389959),a=e.i(816639),s=e.i(205104),l=e.i(903381),u=e.i(858248),c=e.i(709485),d=e.i(529810),f=e.i(37292),p=e.i(725182),h=e.i(965863);function g(e){var g,m,x=e.moveOrDeleteFile,y=(0,d.default)().fs,b=(0,o.useRef)(new Map),w=(0,h.useActiveFile)(),k=(0,n._)((0,o.useState)(!1),2),_=k[0],S=k[1],C=(0,n._)((0,o.useState)(!1),2),j=C[0],T=C[1],E=(0,n._)((0,o.useState)([]),2),R=E[0],I=E[1],A=(0,p.useShowAdmin)(),P=(0,f.useThrowBsod)(),D=R.map(function(e){return e.path}).map(function(e){return{title:e,path:e}}),O=(0,n._)((0,o.useState)(),2),N=O[0],M=O[1],L=(0,h.useHandleFileMoveOrDelete)();(0,o.useEffect)(function(){if(w&&!b.current.has(w)){var e=function(e){var t=e.node.path;L(e.eventType===l.ChangeEventType.Move?{path:t,type:"move",to:e.to}:{path:t,type:"delete"}),x&&x(e),b.current.delete(w),I(function(e){return e.filter(function(e){return e.path!==w})})};(0,s.isOTFile)(w)?y.watchTextFile(w,{onMoveOrDelete:e,onError:function(e,t){e.code||(y.flush(),y.persist({skipDebounce:!0}),P({error:e,extras:t,tags:{ot:!0},origin:"useContentsDiverged: fs.watchTextFile"}))},onReconnectFail:function(e,t){I(function(n){return(0,r._)(n.filter(function(e){return e.path!==w})||[]).concat([{path:w,prompt:t,cb:e}])}),S(!0),N||M(w)}}):y.watchFile(w,{onChange:function(){},onMoveOrDelete:e}),b.current.set(w,!0)}},[w,y,P,x,N,L]);var B=N?R.find(function(e){return e.path===N}):null,V=null==B?void 0:B.prompt,F=(0,a.useDiffViewers)({left:{code:null!=(g=null==V?void 0:V.localContent)?g:"",filePath:N},right:{code:null!=(m=null==V?void 0:V.remoteContent)?m:"",filePath:N}});return{isConverging:j,didContentsDiverge:_,showMoreDetail:A,failedFiles:R,failedFilesOptions:D,selectedFile:N,setSelectedFile:M,reviewingPrompt:V,onChoice:function(e){return(0,t._)(function(){return(0,i._)(this,function(t){switch(t.label){case 0:return(0,u.track)(c.events.FILE_RECONNECT_FALLBACK_CHOSEN,{choice:e}),(0,u.track)(c.events.CONTENTS_DIVERGED_ACTION,{action:"local"===e?"client":"server"}),T(!0),[4,Promise.all(R.map(function(t){return I(function(e){var n=e.filter(function(e){return e.path!==t.path});return 0===n.length?S(!1):M(n[0].path),n}),t.cb(e)}))];case 1:return t.sent(),T(!1),[2]}})})()},local:F.left,remote:F.right}}e.s(["default",()=>g])},260924,317919,e=>{"use strict";var t=e.i(904851),n=e.i(90659),r=e.i(721281),i=e.i(530658),o=e.i(119468),a=e.i(389959),s=e.i(223808),l=e.i(110812),u=e.i(282453),c=function(){function e(n){var a=this;if((0,t._)(this,e),(0,r._)(this,"map",void 0),(0,r._)(this,"saveToLocalStorage",(0,s.default)(function(){u.default.set("stateCache",{version:2,entries:Array.from(a.map.entries())})},500,{leading:!1,trailing:!0,maxWait:1e3})),this.map=new l.LRU(20),n){if((void 0===n?"undefined":(0,o._)(n))!=="object"||null===n||!Object.prototype.hasOwnProperty.call(n,"version")||!Object.prototype.hasOwnProperty.call(n,"entries")||"number"!=typeof n.version||2!==n.version)return;var c=n.entries,d=!0,f=!1,p=void 0;try{for(var h,g=c[Symbol.iterator]();!(d=(h=g.next()).done);d=!0){var m=(0,i._)(h.value,2),x=m[0],y=m[1];this.map.set(x,y)}}catch(e){f=!0,p=e}finally{try{d||null==g.return||g.return()}finally{if(f)throw p}}}}return(0,n._)(e,[{key:"set",value:function(e,t){this.map.set(e,t),this.saveToLocalStorage()}},{key:"get",value:function(e){return this.map.get(e)}}]),e}(),d=(0,a.createContext)(null);e.s(["StateCache",()=>c,"StateCacheContext",()=>d],260924);var f=e.i(276385),p=e.i(541793),h=e.i(399344),g=e.i(830597);function m(e){var t=(0,i._)((0,a.useState)(function(){var t,n,r,i,o,a,s;return n=(t={fs:e.fs,container:e.container,dotReplit:e.dotReplit,ports:e.ports,secrets:e.secrets}).container,r=t.fs,i=t.dotReplit,o=t.ports,a=t.secrets,(s=(0,p.createStore)()).set(h.containerAtom,n),s.set(h.fsAtom,r),s.set(h.dotReplitAtom,i),s.set(h.portsAtom,o),s.set(h.secretsAtom,a),s}),1)[0];return(0,f.jsxs)(g.DeploymentContext.Provider,{value:t,children:[e.children,(0,f.jsx)(h.Init,{replId:e.replId,orgId:e.orgId})]})}e.s(["DeploymentProvider",()=>m],317919)},86159,109858,e=>{"use strict";var t=e.i(389959),n=e.i(541793),r=e.i(161322),i=e.i(98816),o=(0,t.createContext)(void 0),a=(0,n.atom)(null),s=function(e){var t=e.activeTourId,n=e.activeStepId;return"".concat(t,":").concat(n)},l=(0,n.atom)(new Map),u=(0,n.atom)(function(e){return!e(w)&&!e(y)}),c=(0,n.atom)(function(e){var t,n,r=e(b);return r&&null!=(n=null==(t=e(a))?void 0:t.steps.find(function(e){return e.id===r}))?n:null}),d=(0,n.atom)(function(e){var t=e(c);return(null==t?void 0:t.isModal)?t:null}),f=(0,n.atom)(function(e){var t,n=e(b);if(!n)return -1;var r=e(a);return null!=(t=null==r?void 0:r.steps.findIndex(function(e){return n===e.id}))?t:-1}),p=(0,n.atom)(function(e){var t,n=null==(t=e(a))?void 0:t.id,r=e(b);return r&&n?e(l).get(s({activeTourId:n,activeStepId:r})):null}),h=(0,n.atom)(function(e){var t=e(a),n=e(l);return null==t?void 0:t.steps.filter(function(e){return!e.autoSkipIfNoTarget||!!n.get(s({activeTourId:t.id,activeStepId:e.id}))})}),g=(0,n.atom)(function(e){var t,n=e(b);if(!n)return -1;var r=e(h);return null!=(t=null==r?void 0:r.findIndex(function(e){return n===e.id}))?t:-1}),m=(0,n.atom)(function(e){var t,n;return null!=(n=null==(t=e(h))?void 0:t.length)?n:0}),x=(0,n.atom)(null,function(e,t,n,r,i){t(l,function(e){var t=new Map(e);return i?t.set(s({activeTourId:n,activeStepId:r}),i):t.delete(s({activeTourId:n,activeStepId:r})),t})}),y=(0,n.atom)(!1),b=(0,n.atom)(null),w=(0,n.atom)(!1),k=(0,n.atom)(function(e){return e(a)&&!e(y)&&!e(w)}),_=(0,n.atom)(null),S=(0,n.atom)(null,function(e,t,n){var r,i=e(a);if(i&&!((r="number"==typeof n?n:i.steps.findIndex(function(e){return n===e.id}))<0)&&!(r>=i.steps.length)){for(var o=e(f),u=e(l),c=i.steps[r],d=r<o;!u.get(s({activeTourId:i.id,activeStepId:c.id}))&&c.autoSkipIfNoTarget;){if((r=d?r-1:r+1)<0||r>=i.steps.length)return;c=i.steps[r]}t(b,c.id)}}),C=(0,n.atom)(null,function(e,t){var n=e(a);if(n){var r=e(f),i=e(l);t(_,null);var o=n.steps[r+1];if(o&&o.autoSkipIfNoTarget)for(var u=r+1;o&&o.autoSkipIfNoTarget&&!i.get(s({activeTourId:n.id,activeStepId:o.id}));)u++,o=n.steps[u];if(!o)return void t(w,!0);t(b,o.id)}}),j=(0,n.atom)(null,function(e,t){t(S,0),t(w,!1)});function T(e){var t=e.tour,r=(0,n.createStore)();return r.set(a,t),r.set(b,t.steps[0].id),r}function E(){var e=(0,t.useContext)(o);return(0,r.useAtomValue)(y,{store:e})}function R(e,a){var s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},l=(0,t.useContext)(o),u=(0,t.useMemo)(function(){return(0,n.atom)(function(e){return!(e(y)||e(w))&&a===e(b)})},[a]),c=(0,r.useSetAtom)(C,{store:l}),d=(0,r.useSetAtom)(S,{store:l}),f=A(e,a),p=(0,r.useAtomValue)(u,{store:l}),h=(0,t.useRef)(p),g=(0,i.default)(s.onEnter),m=(0,i.default)(s.onExit);return(0,t.useEffect)(function(){if(p){var e;null==(e=g.current)||e.call(g)}},[p,g]),(0,t.useEffect)(function(){if(h.current&&!p){var e;null==(e=m.current)||e.call(m)}h.current=p},[p,m]),{isActive:p,tourRef:f,next:c,goto:d}}e.s(["activeStepAtom",()=>c,"activeStepIdAtom",()=>b,"createTourStore",()=>T,"currentStepElementAtom",()=>p,"currentStepIndexAtom",()=>f,"filteredCurrentStepIndexAtom",()=>g,"gotoAtom",()=>S,"isDoneAtom",()=>w,"isLoadingAtom",()=>y,"isTouringAtom",()=>k,"modalStepAtom",()=>d,"nextAtom",()=>C,"restartAtom",()=>j,"setStepElementsAtom",()=>x,"showStepAtom",()=>u,"totalStepsAtom",()=>m,"tourContext",()=>o,"tourPausedReasonAtom",()=>_],109858);var I=function(){};function A(e,n){var i=(0,t.useContext)(o),a=(0,r.useSetAtom)(x,{store:i}),s=(0,t.useCallback)(function(t){a(e,n,t)},[e,a,n]);return i?s:I}function P(){var e=(0,t.useContext)(o);if(!e)throw Error("useTourModal must be used within a TourRoot");var n=(0,r.useAtomValue)(d,{store:e}),i=(0,r.useSetAtom)(S,{store:e}),a=(0,r.useAtomValue)(f,{store:e}),s=(0,r.useAtomValue)(m,{store:e}),l=(0,r.useSetAtom)(w,{store:e});return{activeStep:n,totalSteps:s,goto:i,currentStepIndex:a,done:(0,t.useCallback)(function(){return l(!0)},[l])}}function D(){var e=(0,t.useContext)(o),n=(0,r.useAtomValue)(k,{store:e});return e&&n}function O(){var e=(0,t.useContext)(o),n=(0,r.useAtomValue)(c,{store:e});return e?n:null}e.s(["useActiveTourStep",()=>O,"useIsTourLoading",()=>E,"useIsTouring",()=>D,"useSetTourStepTarget",()=>A,"useTourModal",()=>P,"useTourStep",()=>R],86159)},710078,e=>{"use strict";var t=e.i(276385),n=e.i(205104),r=e.i(140487),i=e.i(960178),o=e.i(625484),a=e.i(752723);function s(e){var s,l=e.paths,u=e.onCancel,c=e.onConfirm;return(0,t.jsxs)(o.View,{gap:24,children:[(0,t.jsx)(i.Header,{level:1,variant:"headerDefault",children:l.length>1?"Overwrite files?":"Overwrite file?"}),(0,t.jsxs)(i.Text,{children:[(s=(s=l).map(n.getFileName)).length<2?s[0]:"".concat(s.slice(0,-1).join(", ")," and ").concat(s.slice(-1))," already"," ",l.length>1?"exist":"exists"," in the destination, are you sure you want to overwrite ",l.length>1?"them":"it","? This cannot be undone."]}),(0,t.jsxs)(o.View,{row:!0,gap:12,justify:"end",children:[(0,t.jsx)(r.Button,{onClick:function(){return u()},text:"Cancel"}),(0,t.jsx)(r.Button,{colorway:"negative",onClick:function(){return c()},text:"Yes, overwrite ".concat(l.length>1?"these files":"this file"),iconLeft:(0,t.jsx)(a.default,{})})]})]})}e.s(["default",()=>s])},939040,e=>{"use strict";var t=e.i(903381),n=function(e){if(1===e.length)return e[0].type===t.FileType.File?"file":"folder";if(e.length>1){var n=e.filter(function(e){return e.type===t.FileType.File}).length,r=e.filter(function(e){return e.type===t.FileType.Directory}).length,i=n>1?"files":"file",o=r>1?"folders":"folder",a="file";return n>0&&r>0?a="".concat(i," and ").concat(o):n>0?a="".concat(i):r>0&&(a="".concat(o)),"".concat(a)}return""};function r(e){var t=n(e),r=1===e.length?t:"".concat(e.length," ").concat(t),i=e.slice(0,5).map(function(e){return e.path}).join(", ");return{name:r,description:e.length>5?"".concat(i," and ").concat(e.length-5," more ").concat(n(e.slice(5))):i,confirmDescription:r}}e.s(["getDeleteText",()=>r])},666976,e=>{"use strict";var t=e.i(389959),n=e.i(650587);function r(){var e=(0,n.useIsMobile)();return(0,t.useMemo)(function(){return!e&&function(){if("undefined"==typeof document)return!1;var e=document.createElement("input");return"webkitdirectory"in e||"mozdirectory"in e||"msdirectory"in e||"odirectory"in e||"directory"in e}()},[e])}e.s(["useCanUploadDir",()=>r])},429225,169566,84396,e=>{"use strict";var t=e.i(721281),n=e.i(167626),r=e.i(878420),i=e.i(276385),o=e.i(389959),a=e.i(921211),s=e.i(123111),l=e.i(869226),u=e.i(131141),c=e.i(541793),d=e.i(814563),f=e.i(530658),p=e.i(161322);e.i(719518);var h=e.i(824359),g=(0,o.createContext)(null);function m(){var e=(0,o.useContext)(g);if(!e)throw Error("Expected store in context");return e}function x(e){return(0,p.useAtomValue)(e,{store:m()})}function y(e){return(0,h.useObservableAtom)(e,m())}var b=function(e){return(0,p.useSetAtom)(e,{store:m()})};function w(e){var t=(0,f._)((0,o.useState)(function(){return(0,c.createStore)()}),1)[0];return(0,i.jsx)(g.Provider,{value:t,children:e.children})}e.s(["ContextMenuProvider",()=>w,"useObservableValue",()=>y,"useSet",()=>b,"useValue",()=>x],169566);var k=(0,e.i(123850).createCssVarTokens)(["display","visibility","transform","maxHeight","width"]),_=k.cssVars,S=k.styleTokens,C=e.i(480028),j=e.i(929872),T=(0,c.atom)(null),E=(0,c.atom)("default"),R=(0,c.atom)({command:null,offset:{x:0,y:0},visible:!1}),I=(0,d.selectAtom)(R,function(e){return e.offset}),A=(0,d.selectAtom)(R,function(e){return e.command}),P=(0,d.selectAtom)(R,function(e){return e.visible}),D=(0,d.selectAtom)(R,function(e){return e.onKeyDownHandler}),O=(0,d.selectAtom)(T,function(e){var t;return null!=(t=null==e?void 0:e.initial)?t:null}),N=(0,c.atom)(function(e){var t=e(I);if(!t)return null;var n=t.y,r=window.innerHeight-n,i=e(O),o=null!==i?i-r:0;return o>0&&(n=Math.max(16,n-Math.min(200,o))),n}),M=(0,c.atom)(function(e){var t=e(I);if(!t)return null;var n=t.x,r=window.innerWidth,i=e(B),o=n+(null!=i?i:V)-r+16;return o>0&&(n=Math.max(16,n-o)),n}),L=(0,c.atom)(function(e){var n=e(M),r=e(N);return null==n||null===r?null:(0,t._)({},_.transform,"translate(".concat(n,"px, ").concat(r,"px)"))}),B=(0,c.atom)(null),V=180,F=(0,c.atom)(function(e){var n=e(B);return(0,t._)({},_.width,(null===n?V:n)+"px")}),U=(0,c.atom)(function(e){var n=e(N);return null===n?null:(0,t._)({},_.maxHeight,"calc(100vh - ".concat(C.tokens.space16," - ").concat(n,"px)"))}),G=(0,c.atom)(null,function(e,t){t(T,null),t(B,null),t($,null),t(R,function(e){return(0,u.produce)(e,function(e){e.visible=!1,e.command=null})})}),$=(0,c.atom)(null),z=(0,c.atom)(null,function(e,t,n){if(t(E,n.background),n.width&&t(B,n.width),n.target){var r=n.target.getBoundingClientRect(),i={x:r.x,y:r.y+r.height+8};t($,r),t(R,function(e){return(0,u.produce)(e,function(e){e.command=n.command,e.offset=i,e.visible=!0,e.onKeyDownHandler=n.onKeyDownHandler})});return}t(R,function(e){return(0,u.produce)(e,function(e){e.command=n.command,e.offset=n.offset,e.visible=!0,e.onKeyDownHandler=n.onKeyDownHandler})})});function H(){var e=b(z),t=b(G),r=y(P),i=(0,j.useSurfaceBackgroundColorName)({elevated:!0});return{openContextMenu:(0,o.useCallback)(function(t){e((0,n._)(t.target,HTMLElement)?{command:t.command,target:t.target,width:t.width,background:i,onKeyDownHandler:t.onKeyDownHandler}:{command:t.command,offset:t.target,target:null,width:t.width,background:i,onKeyDownHandler:t.onKeyDownHandler})},[e,i]),closeContextMenu:t,isVisible:r,onContextMenu:(0,o.useCallback)(function(t,n){var r=n.command,o=n.width,a=n.onKeyDownHandler;t.preventDefault(),e({command:r,offset:{x:t.clientX,y:Math.min(window.innerHeight-64,t.clientY)},target:null,width:o,background:i,onKeyDownHandler:a})},[e,i])}}e.s(["backgroundAtom",()=>E,"commandAtom",()=>A,"hideAtom",()=>G,"maxHeightAtom",()=>U,"onKeyDownHandlerAtom",()=>D,"targetRectAtom",()=>$,"totalHeightAtom",()=>T,"transformAtom",()=>L,"useContextMenu",()=>H,"visibleAtom",()=>P,"widthAtom",()=>F],84396);var W=e.i(446530),q=e.i(613355),K=e.i(399144),Y=e.i(980338),Q=(0,W.cssRecord)({surface:[q.rcss.shadow(3),q.rcss.borderRadius(8),q.rcss.position.absolute,{top:0,left:0,border:"1px solid",borderColor:C.tokens.outlineDefault,maxWidth:"min(500px, calc(100vw - ".concat(C.tokens.space16,"))"),minWidth:"min(100px, calc(100vw - ".concat(C.tokens.space16,"))"),maxHeight:S.maxHeight,width:S.width,transform:S.transform,visibility:S.visibility,display:S.display}]});function X(){var e=x($);return e?(0,i.jsx)("div",{style:{position:"fixed",width:e.width,height:e.height,top:e.y,left:e.x}}):null}var J=(0,o.memo)(function(){var e=b(G),u=x(A),c=x(D),d=y(P),f=(0,o.useRef)(function(){});(0,o.useEffect)(function(){var e=function(e){if(e){var t;null==(t=f.current)||t.call(f);return}};return e(d.current),d.subscribe(e)},[d]);var p=b(T),h=(0,o.useRef)(null);(0,o.useEffect)(function(){var t=function(t){var r;(0,n._)(t.target,HTMLElement)&&(null==(r=h.current)?void 0:r.contains(t.target))||e()},r=function(){e()},i=function(e){e?(window.addEventListener("blur",r),document.addEventListener("pointerdown",t)):(window.removeEventListener("blur",r),document.removeEventListener("pointerdown",t))},o=d.subscribe(i);return function(){o(),i(!1)}},[d,e]);var g=y(L);(0,l.useStyleSet)(h,g),(0,l.useStyleSet)(h,y(U)),(0,l.useStyleSet)(h,d,function(e){var n;return n={},(0,t._)(n,_.visibility,e?"visible":"hidden"),(0,t._)(n,_.display,e?"flex":"none"),n});var m=y(F);(0,l.useStyleSet)(h,m);var w=(0,s.default)(),k=x(P)&&!w,S=x(E),C=(0,r._)({},g.current,m.current);return u?(0,i.jsxs)(K.Portal,{children:[(0,i.jsx)(X,{}),(0,i.jsx)(a.FocusScope,{autoFocus:k,restoreFocus:!0,contain:!0,children:(0,i.jsx)(j.Surface,{onKeyDown:function(t){"Escape"===t.key&&e()},innerRef:h,css:Q.surface,style:C,background:S,children:(0,i.jsx)(Y.CommandBar,{iconBreadcrumbs:!0,command:u,onAction:e,onSelect:e,onTotalHeightChange:p,onKeyDown:c,focusRef:f,compact:!0})})})]}):null});e.s(["ContextMenu",()=>J],429225)},779830,325602,226349,714603,e=>{"use strict";var t,n=e.i(346715),r=e.i(276385),i=e.i(389959),o=e.i(877212),a=e.i(903381),s=e.i(61524),l=e.i(666976),u=e.i(574203),c=e.i(605526),d=e.i(207237),f=e.i(106020);e.i(429225);var p=e.i(84396);(t={}).AddFile="AddFile",t.AddFolder="AddFolder",t.UploadFile="UploadFile",t.UploadFolder="UploadFolder",t.DownloadZip="DownloadZip",t.Duplicate="Duplicate",t.ShowHiddenFiles="ShowHiddenFiles",t.HideHiddenFiles="HideHiddenFiles",t.OpenTab="OpenTab",t.OpenPane="OpenPane",t.CopyLink="CopyLink",t.CopyFilePath="CopyFilePath",t.CopyFolderPath="CopyFolderPath",t.OpenShellHere="OpenShellHere",t.Rename="Rename",t.Download="Download",t.DownloadFolder="DownloadFolder",t.Delete="Delete",t.OpenWith="OpenWith";var h={AddFile:{type:"AddFile",text:"Add file"},AddFolder:{type:"AddFolder",text:"Add folder"},UploadFile:{type:"UploadFile",text:"Upload files"},UploadFolder:{type:"UploadFolder",text:"Upload folder"},DownloadZip:{type:"DownloadZip",text:"Download as zip"},Duplicate:{type:"Duplicate",text:"Duplicate file"},ShowHiddenFiles:{type:"ShowHiddenFiles",text:"Show hidden files"},HideHiddenFiles:{type:"HideHiddenFiles",text:"Hide hidden files"},OpenTab:{type:"OpenTab",text:"Open tab"},OpenPane:{type:"OpenPane",text:"Open pane"},CopyFilePath:{type:"CopyFilePath",text:"Copy file path"},CopyFolderPath:{type:"CopyFolderPath",text:"Copy folder path"},CopyLink:{type:"CopyLink",text:"Copy link"},OpenShellHere:{type:"OpenShellHere",text:"Open shell here"},Rename:{type:"Rename",text:"Rename"},Download:{type:"Download",text:"Download"},DownloadFolder:{type:"DownloadFolder",text:"Download folder"},Delete:{type:"Delete",text:"Delete"}};e.s(["NodeActions",()=>h],325602);var g=e.i(934226),m=e.i(297083),x=e.i(817556);e.i(878420);var y=e.i(569384),b=e.i(973245);function w(){var e=(0,y._)(["\n  query FiletreeDownloadZip($replId: String!) {\n    getRepl(id: $replId) {\n      ... on Repl {\n        id\n        url\n      }\n    }\n  }\n"]);return w=function(){return e},e}e.i(304277),e.i(566901);var k=(0,b.gql)(w()),_=e.i(173738);function S(e){return(0,m._)(function(){var t,n,r;return(0,x._)(this,function(i){switch(i.label){case 0:return[4,null===_.apolloClient||void 0===_.apolloClient?void 0:_.apolloClient.query({query:k,variables:{replId:e}})];case 1:return r=(null==(n=i.sent())||null==(t=n.data)?void 0:t.getRepl.__typename)==="Repl"?n.data.getRepl.url:window.location.pathname,window.open(r+".zip","_blank"),[2]}})})()}e.s(["downloadZip",()=>S],226349);var C=e.i(858248),j=e.i(709485);function T(e){(0,C.track)(j.events.FILETREE_USED,e)}e.s(["default",()=>T],714603),e.i(545082);var E=e.i(423111),R=e.i(480028),I=e.i(136540),A=e.i(254806),P=e.i(757390),D=e.i(841691),O=e.i(90102),N=e.i(849803),M=e.i(810975),L=e.i(196353),B=e.i(793579),V=e.i(224996),F=e.i(918208);function U(e){var t=e.filetree,m=e.size,x=e.closeFiletree,y=(0,d.default)(),b=(0,c.useOrgId)(y).orgId,w=(0,u.default)(b).banSourceCodeExport,k=(0,E.useSetAreHiddenFilesVisible)(),_=(0,E.useAreHiddenFilesVisible)(),C=(0,i.useRef)(null),j=(0,i.useRef)(null),U=(0,l.useCanUploadDir)(),G=(0,o.useSupportsAgent)(),$=(0,s.usePreferences)("agentPosition"),z=$.preferences.agentPosition,H=$.update,W=(0,i.useCallback)(function(){var e=[];return U&&e.push({icon:(0,r.jsx)(M.default,{}),label:h.UploadFolder.text,run:function(){j.current&&(j.current.click(),T({replId:y,action:"uploaded",fileType:a.FileType.Directory}))}}),w||e.push({icon:(0,r.jsx)(P.default,{}),label:h.DownloadZip.text,run:function(){return S(y)}},{icon:_?(0,r.jsx)(O.default,{}):(0,r.jsx)(D.default,{}),label:_?h.HideHiddenFiles.text:h.ShowHiddenFiles.text,run:function(){k(!_)}}),t.getExpandedDirs()&&e.push({icon:(0,r.jsx)(A.default,{}),label:"Collapse all",run:function(){var e=t.getExpandedDirs();e&&t.collapse((0,n._)(e))}}),x&&e.push({icon:(0,r.jsx)(N.default,{}),label:"Close files",run:x}),G&&e.push({icon:"leftSidebar"===z?(0,r.jsx)(V.default,{}):(0,r.jsx)(F.default,{}),label:"Move filetree to the "+("leftSidebar"===z?"left":"right"),run:function(){H({agentPosition:"leftSidebar"===z?"rightSidebar":"leftSidebar"})}}),{data:{type:"context",label:"Search actions",icon:(0,r.jsx)(B.default,{})},commands:function(){return e.map(function(e){return{match:f.matchLabel,data:{type:"action",label:e.label,run:e.run,icon:e.icon}}})}}},[_,k,y,U,t,w,x,G,z,H]),q=(0,p.useContextMenu)().openContextMenu,K=(0,i.useRef)(null);return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(I.IconButton,{size:m,alt:"menu",tooltipBehavior:"hidden",ref:K,onClick:function(){return K.current&&q({target:K.current,command:W()})},children:(0,r.jsx)(L.default,{color:R.tokens.foregroundDimmest})}),(0,r.jsx)(g.UploadInputs,{fileUploadInputRef:C,dirUploadInputRef:j,uploadFiles:t.upload})]})}e.s(["RootActions",()=>U],779830)},709867,e=>{"use strict";var t=e.i(721281),n=e.i(188507);function r(e){var r;return(null==e?void 0:e.agentMode)?(r={},(0,t._)(r,n.AgentMode.AGENT_MODE_UNSPECIFIED,"build"),(0,t._)(r,n.AgentMode.AGENT_MODE_GENERAL,"build"),(0,t._)(r,n.AgentMode.AGENT_MODE_DISCUSSION,"plan"),(0,t._)(r,n.AgentMode.AGENT_MODE_INITIAL_PLANNING,"plan"),(0,t._)(r,n.AgentMode.AGENT_MODE_QUICK_EDIT,"quick-edit"),r)[e.agentMode]:"build"}e.s(["BUILD_MODE_DESCRIPTION",()=>"Make, test, iterate","BUILD_MODE_LABEL",()=>"Build","EDIT_MODE_DESCRIPTION",()=>"Modify a specific element","EDIT_MODE_LABEL",()=>"Edit","PLAN_MODE_DESCRIPTION",()=>"Ask questions, plan your work","PLAN_MODE_LABEL",()=>"Plan","QUICK_EDIT_MODE_DESCRIPTION",()=>"Make an edit, fast (experimental)","VISUAL_SELECTOR_PILL_PLACEHOLDER",()=>"Choose from preview","getAgentChatModeId",()=>r])},6560,e=>{"use strict";var t=e.i(297083),n=e.i(530658),r=e.i(346715),i=e.i(817556),o=e.i(276385),a=e.i(906368),s=e.i(995683),l=e.i(106020),u=e.i(292849),c=e.i(630818),d=e.i(960178),f=e.i(625484),p=e.i(989481),h=e.i(761922),g=e.i(42458);function m(e){return(0,t._)(function(e){var t,n,r,a;return(0,i._)(this,function(i){switch(i.label){case 0:if(t=e.searchQuery,n=e.paths,r=e.run,a=e.description,!t)return[2,n.map(function(e){return{data:{type:"action",label:e,icon:(0,o.jsx)(c.default,{path:e}),description:a,run:function(){return r(e)}},match:function(){return{score:1,render:(0,u.createFileMatchRender)({path:e,description:a})}}}})];return[4,(0,u.filterFiles)(t,n)];case 1:return[2,i.sent().map(function(e){var t=e.path,n=e.score,i=e.ranges;return{data:{type:"action",label:t,icon:(0,o.jsx)(c.default,{path:t}),run:function(){return r(t)}},match:function(){return{score:n,render:(0,u.createFileMatchRender)({path:t,ranges:i,description:a})}}}})]}})}).apply(this,arguments)}function x(){return(0,o.jsxs)(f.View,{row:!0,gap:8,children:[(0,o.jsx)(g.default,{}),(0,o.jsx)(d.Text,{color:"dimmest",multiline:!1,children:"Something went wrong searching your App's files. Please try again."})]})}function y(e){return(0,l.createCommand)({type:"context",label:"Files",description:"Find a file",icon:(0,o.jsx)(h.default,{}),keyboardShortcut:e.keyboardShortcut?e.keyboardShortcut:void 0},{match:e.lazyLoad?l.fzfMatchLabel:(0,l.createFzfMatchLabel)({defaultScore:p.commandDefaultScores.findOrCreateFile}),commands:function(l){return(0,t._)(function(){var u,d,f,p,h,y,b,w,k,_,S,C,j,T,E,R,I,A,P,D;return(0,i._)(this,function(O){switch(O.label){case 0:if(e.lazyLoad&&!l.active)return[2,[]];return u=e.fs,d=e.shouldHideFile,[4,Promise.resolve(e.getRecentFiles())];case 1:if(f=O.sent(),p=[],!(l.searchQuery||l.active))return[3,3];return[4,u.listFiles()];case 2:if((h=O.sent()).error)return a.captureException(Error("Find or create file returned an error"),{extra:{message:h.error}}),[2,[{data:{type:"error",label:h.error,icon:(0,o.jsx)(g.default,{})},match:function(){return{score:1,render:{content:(0,o.jsx)(x,{})}}}}]];if(!h.files)throw Error("Expected files");y=!0,b=!1,w=void 0;try{for(k=h.files[Symbol.iterator]();!(y=(_=k.next()).done);y=!0)S=_.value,d(S)||f.includes(S)||p.push(S)}catch(e){b=!0,w=e}finally{try{y||null==k.return||k.return()}finally{if(b)throw w}}O.label=3;case 3:return C=[],[4,Promise.all([m({searchQuery:l.searchQuery,paths:f,description:"Recently opened",run:function(t){e.openFile({path:t})}}),m({searchQuery:l.searchQuery,paths:p,run:function(t){e.openFile({path:t})}})])];case 4:if(T=(j=n._.apply(void 0,[O.sent(),2]))[0],E=j[1],!e.getCurrentlyOpenFilePanesCommands)return[3,6];return[4,e.getCurrentlyOpenFilePanesCommands({searchQuery:l.searchQuery})];case 5:I=O.sent(),(R=C).push.apply(R,(0,r._)(I)),O.label=6;case 6:return T.length&&(A=C).push.apply(A,(0,r._)(T)),E.length&&(P=C).push.apply(P,(0,r._)(E)),0===E.length&&0===T.length&&l.active&&(D=l.searchQuery,C.push({data:{label:D,description:"Create a new file",icon:(0,o.jsx)(c.default,{path:D}),type:"action",run:function(){return(0,t._)(function(){return(0,i._)(this,function(t){switch(t.label){case 0:return[4,u.writeFile(D,s.default.from(""))];case 1:if(t.sent().error)return[2,{type:"error",message:'Could not create "'+D+'"'}];return e.openFile({path:D}),[2]}})})()}},match:function(){return{score:1}}})),[2,C]}})})()}})}e.s(["createFileCommands",()=>m,"createFindOrCreateFileCommand",()=>y])},10581,e=>{"use strict";var t,n,r=e.i(960933),i=((t={}).NOT_INITIALIZED="NOT_INITIALIZED",t.ON_UNBORN_BRANCH="ON_UNBORN_BRANCH",t.MERGING="MERGING",t.REBASING="REBASING",t.REVERTING="REVERTING",t.CHERRY_PICKING="CHERRY_PICKING",t.APPLYING_MAILBOX="APPLYING_MAILBOX",t.BISECTING="BISECTING",t.INDEX_LOCKED="INDEX_LOCKED",t.CONFIG_LOCKED="CONFIG_LOCKED",t.DIRTY_WORKTREE="DIRTY_WORKTREE",t.DIRTY_INDEX="DIRTY_INDEX",t.CLEAN="CLEAN",t.DETACHED_HEAD="DETACHED_HEAD",t.HEAD_MISSING="HEAD_MISSING",t.TREE_CORRUPTED="TREE_CORRUPTED",t);r.Type.Enum(i);var o=((n={}).INITIALIZING="INITIALIZING",n.INTERMEDIATE="INTERMEDIATE",n.NORMAL="NORMAL",n.DETACHED_HEAD="DETACHED_HEAD",n.HEAD_MISSING="HEAD_MISSING",n);r.Type.Enum(o),e.s(["GitRepositoryState",()=>i,"GitRepositoryStateType",()=>o])},483570,e=>{"use strict";var t=e.i(297083),n=e.i(817556),r=e.i(10581),i=e.i(61524),o=e.i(597865);function a(){var e,a,s=(0,i.usePreferences)("showFileTreeGitStatus").preferences.showFileTreeGitStatus,l=(0,o.default)(function(e){return(0,t._)(function(){var t,i;return(0,n._)(this,function(n){switch(n.label){case 0:if(!s)return[2,{status:null,error:null}];return[4,e.getRepositoryState()];case 1:if((t=n.sent()).error)return[2,t];if(t.type!==r.GitRepositoryStateType.NORMAL)return[2,{status:null,error:null}];return[4,e.status()];case 2:if((i=n.sent()).error)return[2,i];return[2,{status:i,error:null}]}})})()},[s]);return l&&!l.error&&(null==(e=l.status)?void 0:e.changes)?function(e){var t=new Map,n=!0,r=!1,i=void 0;try{for(var o,a=e[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var s=o.value;t.set(s.path,{index:s.type.index,worktree:s.type.worktree})}}catch(e){r=!0,i=e}finally{try{n||null==a.return||a.return()}finally{if(r)throw i}}return t}(null==(a=l.status)?void 0:a.changes):null}e.s(["useFileTreeGitStatus",()=>a])},251923,e=>{"use strict";var t=e.i(205104),n=e.i(664152),r=e.i(603237),i=new Map,o=function(e,n){if((0,t.isOTFile)(e)){var r=window.performance.now();i.set(e,{start:r,source:n})}},a=function(e){var t=i.get(e);if(void 0!==t){var o=t.start,a=t.source,s=window.performance.now(),l=(0,r.getFileViewerType)(e);n.logger.time("time to load file",s-o,{from:a,fileViewerType:l}),i.delete(e)}};function s(e){return{trackTimeToLoadFileStart:function(t){return o(t,e)},trackTimeToLoadFileEnd:a}}e.s(["default",()=>s])},312421,714312,e=>{"use strict";var t=e.i(878420),n=e.i(389959),r=e.i(207237),i=e.i(251923),o=e.i(714603);function a(){var e=(0,r.default)(),a=(0,i.default)("fileTree").trackTimeToLoadFileStart;return(0,n.useCallback)(function(n){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};a(n);var i={action:"select",source:"filetree"};r.newTab?i={action:"newTab",source:"filetree"}:r.newPane&&(i={action:"newPane",source:"filetree"}),(0,o.default)((0,t._)({replId:e},i))},[e,a])}e.s(["useTrackOpenFile",()=>a],312421);var s=e.i(530658),l=e.i(346715),u=e.i(205104),c=e.i(903381),d=["json","md","draw","txt"],f=[".gitignore",".replit"];function p(e,t){var n=new Map,r=!0,i=!1,o=void 0;try{for(var a,c=e[Symbol.iterator]();!(r=(a=c.next()).done);r=!0){var d,f=a.value,p=(0,u.getExt)(f);if(p&&(!t||p.startsWith(t))){var h=null!=(d=n.get(p))?d:0;n.set(p,h+1)}}}catch(e){i=!0,o=e}finally{try{r||null==c.return||c.return()}finally{if(i)throw o}}return(0,l._)(n.entries()).sort(function(e,t){var n=(0,s._)(e,2)[1];return(0,s._)(t,2)[1]-n}).map(function(e){return(0,s._)(e,1)[0]})}function h(e,t){if(e.fileType===c.FileType.Directory||!e.input)return[];if("."===e.input)return f.map(function(e){return{value:e,highlight:[{from:1,to:e.length}]}});if(e.input.startsWith("."))return f.filter(function(t){return t.startsWith(e.input)}).map(function(t){return{value:t,highlight:[{from:t.length-e.input.length,to:t.length}]}});var n=(0,u.getExt)(e.input),r=p(e.siblings.map(function(e){return e.filename}),n);if(r.length<3&&r.push.apply(r,(0,l._)(p(t(),n))),r.length<3){var i=n?d.filter(function(e){return e.startsWith(n)}):d;r.push.apply(r,(0,l._)(i))}return(0,l._)(new Set(r)).slice(0,3).map(function(t){var r=e.input;r.endsWith(".")?r=r.slice(0,-1):n&&(r=r.slice(0,-(n.length+1)));var i=r+"."+t;return{value:i,highlight:[{from:e.input.length,to:i.length}]}})}e.s(["getFileExtensionSuggestions",()=>h],714312)},133294,e=>{"use strict";var t=e.i(297083),n=e.i(817556),r=e.i(205104),i=e.i(240913),o=/\(copy\)( \d+)?$/,a=/\d+$/;function s(e,s){return(0,t._)(function(){var t,l,u,c,d,f;return(0,n._)(this,function(n){switch(n.label){case 0:return t=(0,r.getParentPath)(e),[4,s.readDir(0===t.length?i.ROOT_PATH:t)];case 1:if((l=n.sent()).error)throw l.error;return u=new Set(l.children.map(function(e){return e.filename})),c=function(e,t){var n=(0,r.getExt)(e),i=(0,r.getBaseName)(e);if(!i&&e.startsWith(".")){var s=e.lastIndexOf(".");i=s>0?e.slice(0,s):e}for(var l=o.test(i)?e:"".concat(i," (copy)").concat(n.length>0?".".concat(n):""),u=1;u<=t.size&&t.has(l);u++){var c=(0,r.getBaseName)(l),d=c.split(" ");a.test(c)&&d.pop(),l="".concat(d.join(" ")," ").concat(u),n.length>0&&(l+=".".concat(n))}return l}((0,r.getFileName)(e),u),d=t?"".concat(t,"/").concat(c):c,[4,s.copyFile(e,d)];case 2:if((f=n.sent()).error)throw f.error;return[2,d]}})})()}e.s(["default",()=>s],133294)},974009,e=>{"use strict";var t=e.i(297083),n=e.i(817556),r=e.i(399528),i=e.i(629712),o=e.i(501005);function a(e,a){return(0,t._)(function(){var s,l,u,c,d,f,p;return(0,n._)(this,function(h){switch(h.label){case 0:return l=(s=e.split("/")).length>1?s[s.length-1]:e,(u=document.createElement("a")).download=l+".zip",u.target="_blank",u.style.display="none",c=function(){return(0,t._)(function(){return(0,n._)(this,function(e){return[2,{isEmbed:!!(r.default.query.lite||r.default.query.embed),hCaptchaSiteKey:o.HCAPTCHA_SITE_KEY}]})})()},[4,(0,i.getZipperToken)({replId:a,getCaptcha:c})];case 1:return f=(d=h.sent()).baseUrl,p=d.token,u.href="".concat(f,"/repl/").concat(a,"?token=").concat(p,"&subdir=").concat(encodeURIComponent(e),"&dir=").concat(l),document.body.appendChild(u),u.click(),setTimeout(function(){document.body.removeChild(u)},1e4),[2]}})})()}e.s(["default",()=>a])},185511,e=>{"use strict";var t=e.i(297083),n=e.i(817556),r=e.i(276385),i=e.i(399528),o=e.i(908410),a=e.i(205104),s=e.i(134628),l=e.i(993796),u=e.i(125674),c=e.i(610357),d=e.i(539539),f=e.i(974009),p=e.i(133294),h=e.i(441329),g=e.i(529810),m=e.i(479407),x=e.i(106020),y=e.i(736318);e.i(282890);var b=e.i(66718);e.i(545082);var w=e.i(375310),k=e.i(480028),_=e.i(107413),S=e.i(51606),C=e.i(757390),j=e.i(292642),T=e.i(703505);function E(e,i,o){return{match:x.matchLabel,data:{label:"Download",icon:(0,r.jsx)(C.default,{}),type:"action",run:function(){return(0,t._)(function(){var t;return(0,n._)(this,function(n){switch(n.label){case 0:return[4,i.readFile(e)];case 1:if((t=n.sent()).error)return[2,{type:"error",message:"Error downloading file"}];return[4,(0,d.default)(e,t.content,o)];case 2:return n.sent(),[2]}})})()}}}}function R(e,i){return{match:x.matchLabel,data:{label:"Download",icon:(0,r.jsx)(C.default,{}),type:"action",run:function(){return(0,t._)(function(){var t,r,l;return(0,n._)(this,function(n){switch(n.label){case 0:return[4,i.readFile(e)];case 1:if((t=n.sent()).error||!(r=t.content.toString("base64")))return[2,{type:"error",message:"Error downloading file"}];return l=(0,a.getFileName)(e),(0,m.sendMessage)({messageType:s.BridgeMessageType.DOWNLOAD_FILE,fileName:l,fileContent:r},(0,o.nanoid)()),[2]}})})()}}}}function I(e){return{match:x.matchLabel,data:{label:"Download folder",icon:(0,r.jsx)(C.default,{}),type:"action",run:function(){return(0,t._)(function(){var t;return(0,n._)(this,function(n){switch(n.label){case 0:return t=i.default.query.replId,[4,(0,f.default)(e,t)];case 1:return n.sent(),[2]}})})()}}}}function A(e){var i=e.path,o=e.performPaneOperation,a=(0,g.default)(),s=(0,w.useSetPendingDeleteFile)(),d=(0,h.useIsInBonsaiWebview)(),f=(0,l.useFlag)({controlName:"flag-direct-file-downloads"});return(0,u.default)(function(){var e,l;return i?[{match:x.matchLabel,data:{label:"Copy file path",icon:(0,r.jsx)(_.default,{}),type:"action",run:function(){(0,c.default)(i)}}},{match:x.matchLabel,data:{label:"Copy link",icon:(0,r.jsx)(j.default,{}),type:"action",run:function(){var e=(0,y.createDeeplinkURL)({path:i});(0,c.default)(e)}}},(e=a.fs,l=function(e){o({operation:"replace",pane:{type:(0,b.getPaneTypeForFile)({path:e}),data:{path:e}}})},{match:x.matchLabel,data:{label:"Duplicate file",icon:(0,r.jsx)(S.default,{}),type:"action",run:function(){return(0,t._)(function(){var t;return(0,n._)(this,function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,(0,p.default)(i,e)];case 1:return t=n.sent(),[3,3];case 2:return n.sent(),[2,{type:"error",message:"Error duplicating file"}];case 3:return l(t),[2]}})})()}}}),d?R(i,a.fs):E(i,a.fs,f),{match:x.matchLabel,data:{label:"Delete",icon:(0,r.jsx)(T.default,{color:k.tokens.redDefault}),type:"action",run:function(){s(i)}}}]:null},[i,a.fs,d,s,o,f])}e.s(["createBonsaiDownloadCommand",()=>R,"createDownloadCommand",()=>E,"createDownloadFolderCommand",()=>I,"useFileCommands",()=>A])},274526,e=>{"use strict";var t=e.i(297083),n=e.i(346715),r=e.i(817556),i=e.i(276385),o=e.i(389959),a=e.i(205104),s=e.i(240913),l=e.i(903381),u=e.i(993796),c=e.i(207237),d=e.i(610357),f=e.i(133294),p=e.i(529810),h=e.i(106020),g=e.i(185511),m=e.i(736318),x=e.i(714603);e.i(545082);var y=e.i(423111),b=e.i(480028),w=e.i(107413),k=e.i(254806),_=e.i(51606),S=e.i(283023),C=e.i(841691),j=e.i(90102),T=e.i(419735),E=e.i(842435),R=e.i(292642),I=e.i(693908),A=e.i(793579),P=e.i(703505);function D(e){return{match:h.matchLabel,data:{type:"action",label:"Rename",icon:(0,i.jsx)(S.default,{}),run:e}}}function O(e){return{match:h.matchLabel,data:{type:"action",label:"Save file",icon:(0,i.jsx)(I.default,{}),run:e}}}function N(e){return[{label:"Add file",icon:(0,i.jsx)(T.default,{}),run:function(){return e(l.FileType.File)}},{label:"Add folder",icon:(0,i.jsx)(E.default,{}),run:function(){return e(l.FileType.Directory)}}].map(function(e){var t=e.label,n=e.icon,r=e.run;return{match:h.matchLabel,data:{type:"action",label:t,icon:n,run:r}}})}function M(e){return[{label:"Copy file path",icon:(0,i.jsx)(w.default,{}),run:function(){return(0,d.default)(e)}},{label:"Copy link",icon:(0,i.jsx)(R.default,{}),run:function(){return(0,d.default)((0,m.createDeeplinkURL)({path:e}))}}].map(function(e){var t=e.label,n=e.icon,r=e.run;return{match:h.matchLabel,data:{type:"action",label:t,icon:n,run:r}}})}function L(e){return{match:h.matchLabel,data:{type:"action",label:"Duplicate file",icon:(0,i.jsx)(_.default,{}),run:e}}}function B(e){return{match:h.matchLabel,data:{type:"action",icon:(0,i.jsx)(P.default,{color:b.tokens.redDefault}),label:"Delete",run:e}}}function V(){var e=(0,c.default)(),d=(0,p.default)().fs,m=(0,u.useFlag)({controlName:"flag-direct-file-downloads"}),b=(0,o.useCallback)(function(n,i){var o=n.path,s=[{data:{type:"group",key:"rename"},commands:function(){return[D(function(){return i.rename(o)})]}}];return(0,a.isOTFile)(o)&&s.push({data:{type:"group",key:"saveFile"},commands:function(){return[O(function(){return(0,t._)(function(){return(0,r._)(this,function(e){switch(e.label){case 0:return[4,d.flush(new Set([o]),l.FlushSource.MANUAL_SAVE)];case 1:return e.sent(),[2]}})})()})]}}),s.push({data:{type:"group",key:"copy"},commands:function(){return M(o)}}),s.push(L(function(){return(0,t._)(function(){var t;return(0,r._)(this,function(n){switch(n.label){case 0:t=null,n.label=1;case 1:return n.trys.push([1,3,,4]),[4,(0,f.default)(o,d)];case 2:return t=n.sent(),[3,4];case 3:return n.sent(),[2,{type:"error",message:"Error duplicating file"}];case 4:return(0,x.default)({replId:e,action:"duplicated",fileType:l.FileType.File}),i.rename(t),[2]}})})()})),s.push((0,g.createDownloadCommand)(o,d,m)),s.push({data:{type:"group",key:"deleteFile"},commands:function(){return[B(function(){return i.deleteNodes(n)})]}}),s},[e,d,m]),w=(0,y.useSetAreHiddenFilesVisible)(),_=(0,y.useAreHiddenFilesVisible)(),S=(0,o.useCallback)(function(e,t){var r=e.path,o=r===s.ROOT_PATH,a=o?[]:[{data:{type:"group",key:"rename"},commands:function(){return[D(function(){return t.rename(e.path)})]}}];return a.push.apply(a,(0,n._)(N(function(n){return t.create(n,e.path)}))),o||a.push({data:{type:"group",key:"copy"},commands:function(){return M(r)}}),t.getExpandedDirs()&&a.push({match:h.matchLabel,data:{icon:(0,i.jsx)(k.default,{}),type:"action",label:"Collapse "+(o?"all":"child folders"),run:function(){var e=t.getExpandedDirs(r);e&&t.collapse((0,n._)(e))}}}),o||a.push({data:{type:"group",key:"deleteFile"},commands:function(){return[B(function(){return t.deleteNodes(e)})]}}),o&&a.push({data:{type:"group",key:"hiddenFiles"},commands:function(){return[{match:h.matchLabel,data:{type:"action",label:(_?"Hide":"Show")+" hidden files",icon:_?(0,i.jsx)(j.default,{}):(0,i.jsx)(C.default,{}),run:function(){w(!_)}}}]}}),a},[_,w]);return(0,o.useCallback)(function(e,t){return{data:{type:"context",label:"Search actions",icon:(0,i.jsx)(A.default,{})},commands:function(){return e.type===l.FileType.Directory?S(e,t):b(e,t)}}},[b,S])}e.s(["getCopyCommands",()=>M,"getCreateCommands",()=>N,"getDeleteCommand",()=>B,"getDuplicateCommand",()=>L,"getRenameCommand",()=>D,"getSaveCommand",()=>O,"useGetContextMenuCommand",()=>V])},41e4,e=>{"use strict";var t,n=e.i(297083),r=e.i(530658),i=e.i(817556),o=e.i(623474),a=e.i(389959),s=e.i(541793),l=e.i(161322),u=e.i(995683),c=e.i(240913),d=e.i(903381),f=e.i(98816),p=e.i(635984),h=e.i(529810),g=((t={}).IDLE="IDLE",t.STARTING="STARTING",t.UPLOADING="UPLOADING",t.UPLOADED="UPLOADED",t.RESTARTING="RESTARTING",t.ERROR="ERROR",t),m="(click to upload dev build)",x=(0,s.atom)(["IDLE","pid2 running latest prod ".concat(m)]);function y(){return(0,l.useAtomValue)(x)}function b(){var e,t=(0,h.default)(),s=t.fs,g=t.container,b=null==(e=g.getContext())?void 0:e.repl,k=(0,l.useSetAtom)(x),_=(0,r._)(y(),2),S=_[0];_[1];var C=(0,f.default)(S);return(0,a.useCallback)(function(){return(0,n._)(function(){return(0,i._)(this,function(e){switch(e.label){case 0:var t,r,a;if(!b||"IDLE"!==C.current&&"ERROR"!==C.current)return[2];return k(["STARTING","starting pid2 upload process"]),[4,(t=g,r=s,a=function(e,t){k([e,t])},(0,n._)(function(){var e,s,l,f,h,g,x,y,b,k,_,S,C,j;return(0,i._)(this,function(T){switch(T.label){case 0:return[4,(0,p.getPid2Version)()];case 1:var E,R,I,A;if("dev"===(l=T.sent()))return a("IDLE","dev is not a version we can upload to the container"),[2];return[4,(E=l,R=t,I=r,A=a,(0,n._)(function(){var e,t,n,r,a,s,l,f,p,h;return(0,i._)(this,function(i){switch(i.label){case 0:return e=o.default.join(c.ROOT_PATH,".cache/replit/pid2/".concat(E)),t=o.default.join(e,"success"),[4,I.stat(t)];case 1:if((n=i.sent()).exists&&n.type===d.FileType.File)return[2];return A("UPLOADING","pid2: uploading version ".concat(E," to container...")),[4,fetch("/pid2/bundle")];case 2:if(!(r=i.sent()).ok)throw Error("Error fetching PID2 bundle: ".concat(r.statusText));if(!r.body)throw Error("Error fetching PID2 bundle: ".concat(r));return[4,r.arrayBuffer()];case 3:return a=i.sent(),s=".cache/replit/pid2/pid2-".concat(E,".tar.gz"),[4,I.writeFile(s,u.default.from(a))];case 4:if((l=i.sent()).error)throw Error("pid2: writing tarball: ".concat(l.error));return[4,R.exec("mkdir","-p",e)];case 5:if((f=i.sent()).error)throw Error("pid2: mkdir: ".concat(f.error));return[4,R.exec("tar","-C",e,"-xf",s)];case 6:if((p=i.sent()).error)throw Error("pid2: untar: ".concat(p.error));return[4,I.writeFile(o.default.join(e,"pid2.version"),E)];case 7:if((h=i.sent()).error)throw Error("pid2: writeVersion: ".concat(h.error));return[4,R.exec("touch",t)];case 8:return i.sent(),[4,R.exec("rm","-f",s)];case 9:return i.sent(),A("UPLOADED","pid2: ".concat(E," upload success")),[2]}})})())];case 2:return T.sent(),[4,w(t,a)];case 3:if(!(f=T.sent()))return[2];return h=o.default.join(f.REPL_HOME,".cache/replit/pid2/".concat(l)),g=o.default.join(h,"pid2"),[4,t.exec("stat","-c","%N",f.pid2BinDst)];case 4:return x=T.sent(),[4,t.exec("stat","-c","%N",f.pid2BinDst2)];case 5:if(y=T.sent(),!x.error&&(null==(e=x.output)?void 0:e.includes(g))&&!y.error&&(null==(s=y.output)?void 0:s.includes(g)))return a("IDLE","pid2 version ".concat(l," already exists in container ").concat(m)),[2];return b=o.default.dirname(f.pid2BinDst),[4,t.exec("mkdir","-p",b)];case 6:if((k=T.sent()).error)throw Error("pid2: mkdir ".concat(b,": ").concat(k.error));return[4,t.exec("ln","-sf",g,f.pid2BinDst)];case 7:if((_=T.sent()).error)throw Error("pid2: link ".concat(f.pid2BinDst,": ").concat(_.error));return S=o.default.dirname(f.pid2BinDst2),[4,t.exec("mkdir","-p",S)];case 8:if(T.sent().error)throw Error("pid2: mkdir ".concat(S,": ").concat(k.error));return[4,t.exec("ln","-sf",g,f.pid2BinDst2)];case 9:if(C=T.sent(),_.error)throw Error("pid2: link ".concat(f.pid2BinDst2,": ").concat(C.error));return a("RESTARTING","pid2 version ".concat(l," installed, restarting pid2")),[4,t.exec("bash","-c","kill -9 $(pidof pid2)")];case 10:return(j=T.sent()).error&&a("ERROR","pid2: couldn't kill ".concat(j.error)),a("IDLE","pid2 version ".concat(l," installed ").concat(m)),[2]}})})())];case 1:return e.sent(),[2]}})})()},[C,b,k,g,s])}function w(e,t){return(0,n._)(function(){var n,r,a;return(0,i._)(this,function(i){switch(i.label){case 0:return[4,e.exec("printenv","REPL_HOME")];case 1:if((n=i.sent()).error||!n.output)return t("IDLE","could not printenv REPL_HOME"),[2,null];return r=n.output.trim(),a=o.default.join(r,".local/bin/pid2"),[2,{REPL_HOME:r,pid2BinDst:"/home/runner/bin/pid2",pid2BinDst2:a}]}})})()}e.s(["Pid2UploadState",()=>g,"getPid2Paths",()=>w,"usePid2UploadState",()=>y,"useUploadPid2",()=>b])},556088,e=>{"use strict";var t=e.i(346715),n=e.i(55796),r=[{id:"true",editorPreferencesValue:!0,title:"true"},{id:"false",editorPreferencesValue:!1,title:"false"}],i={fontSize:{id:"fontSize",name:"Font Size",description:"Change the font size of the editor.",type:"select",editorPreferencesKey:"fontSize",options:[{id:"10",editorPreferencesValue:10,title:"tiny"},{id:"12",editorPreferencesValue:12,title:"small"},{id:"14",editorPreferencesValue:14,title:"normal"},{id:"18",editorPreferencesValue:18,title:"large"},{id:"24",editorPreferencesValue:24,title:"huge"}]},wrapping:{id:"wrapping",name:"Wrapping",description:"Change whether the editor wraps lines or not.",type:"select",editorPreferencesKey:"wrapping",options:[{id:"none",editorPreferencesValue:!1,title:"none"},{id:"soft",editorPreferencesValue:!0,title:"soft wrap"}]},minimap:{id:"minimap",name:"Minimap",description:"Change the minimap display.",type:"select",editorPreferencesKey:"minimapDisplay",options:[{id:"none",editorPreferencesValue:"none",title:"none"},{id:"blocks",editorPreferencesValue:"blocks",title:"blocks"},{id:"characters",editorPreferencesValue:"characters",title:"characters"}]},indentationDetection:{id:"indentDetection",name:"Indentation Detection",description:"Automatically detect indentation settings when opening a file.",type:"boolean",editorPreferencesKey:"indentDetection",options:r},indentFormatPastes:{id:"indentFormatPastes",name:"Format Pasted Text Indentation",description:"Automatically format the indentation of pasted text.",type:"boolean",editorPreferencesKey:"indentFormatPastes",options:r},indentIsSpaces:{id:"indentationCharacter",name:"Indentation Character",description:"The character used for indenting lines.",type:"select",editorPreferencesKey:"indentIsSpaces",options:[{id:"spaces",editorPreferencesValue:!0,title:"spaces"},{id:"tabs",editorPreferencesValue:!1,title:"tabs"}]},keyboardHandler:{id:"keyboardHandler",name:"Keybinds",description:"Use another keyboard mapping",type:"select",editorPreferencesKey:"keyboardHandler",options:[{id:"default",editorPreferencesValue:null,title:"default"},{id:"emacs",editorPreferencesValue:"emacs",title:"emacs"},{id:"vim",editorPreferencesValue:"vim",title:"vim"}]},showFileTreeGitStatus:{id:"showFileTreeGitStatus",name:"Filetree Git Status",description:"Show the Git status of files in the file tree.",type:"boolean",editorPreferencesKey:"showFileTreeGitStatus",options:r},codeIntelligence:{id:"codeIntelligence",name:"Code Intelligence",description:"Code intelligence gives you autocomplete, as well as hints as you type.",type:"boolean",editorPreferencesKey:"codeIntelligence",options:r},semanticTokens:{id:"semanticTokens",name:"Semantic Tokens",description:"Enables enhanced syntax highlighting from language servers.",type:"boolean",editorPreferencesKey:"semanticTokens",options:r},shellBellAudio:{id:"shellBellAudio",name:"Shell Bell Audible Indicator",description:"Play sound in the Shell on issues like a failed tab completion.",type:"boolean",editorPreferencesKey:"shellBellAudio",options:r},accessibleTerminal:{id:"accessibleTerminal",name:"Accessible Terminal Output",description:"Enable this setting to use a screen reader. Warning: this can negatively affect performance.",type:"boolean",editorPreferencesKey:"accessibleTerminal",options:r},webviewAutoOpenOnPortOpened:{id:"webviewAutoOpenOnPortOpened",name:"Automatic Webview",description:"Open a webview automatically when a port is open.",type:"boolean",editorPreferencesKey:"webviewAutoOpenOnPortOpened",options:r},forwardPortsAutomatically:{id:"forwardPortsAutomatically",name:"Forward Opened Ports Automatically",description:"Automatically configure detected newly opened ports.",type:"select",editorPreferencesKey:"forwardPortsAutomatically",options:[{id:"none",editorPreferencesValue:"none",title:"never"},{id:"only-global",editorPreferencesValue:"only-global",title:"all ports except localhost"},{id:"all",editorPreferencesValue:"all",title:"all ports"}]},agentAudioNotification:{id:"agentAudioNotification",name:"Agent Audio Notification",description:"Play a sound when the Agent needs your response.",type:"boolean",editorPreferencesKey:"agentAudioNotification",options:r},agentPushNotification:{id:"agentPushNotification",name:"Agent Push Notification",description:"Send a push notification when the Agent needs your response.",type:"boolean",editorPreferencesKey:"agentPushNotification",options:r},agentPosition:{id:"agentPosition",name:"Agent Position",description:"Choose whether the Agent appears in the left or right sidebar.",type:"select",editorPreferencesKey:"agentPosition",options:[{id:"leftSidebar",editorPreferencesValue:"leftSidebar",title:"Left"},{id:"rightSidebar",editorPreferencesValue:"rightSidebar",title:"Right"}]},assistantPushNotification:{id:"assistantPushNotification",name:"Assistant Push Notification",description:"Send a push notification when the Assistant needs your response.",type:"boolean",editorPreferencesKey:"assistantPushNotification",options:r},multiselectModifierKey:{id:"multiselectModifierKey",name:"Multiselect Modifier Key",description:"Modifier key for selecting multiple items in the filetree.",type:"select",editorPreferencesKey:"multiselectModifierKey",options:[{id:"cmdOrCtrlKey",editorPreferencesValue:"cmdOrCtrlKey",title:"cmdOrCtrlKey"},{id:"altKey",editorPreferencesValue:"altKey",title:"altKey"}]},codeSuggestion:{id:"codeSuggestion",name:"AI Code Completion",description:'Code completion provides inline "ghost text" suggestions while you code.',type:"boolean",editorPreferencesKey:"codeSuggestion",options:r},assistantAutoApplyChanges:{id:"assistantAutoApplyChanges",name:"Auto Apply Changes",description:"Automatically apply changes made by the AI assistant to your code.",type:"boolean",editorPreferencesKey:"assistantAutoApplyChanges",options:r},assistantAutoRestartRepl:{id:"assistantAutoRestartRepl",name:"Auto Restart Workflows",description:"Automatically restart workflows after applying code changes.",type:"boolean",editorPreferencesKey:"assistantAutoRestartRepl",options:r},assistantAdvancedModelOverride:{id:"assistantAdvancedModelOverride",name:"Advanced Model Override",description:"Override the default advanced model.",type:"select",editorPreferencesKey:"assistantAdvancedModelOverride",options:[{id:"default",editorPreferencesValue:null,title:"default"}].concat((0,t._)(Array.from(n.ASSISTANT_ADVANCED_MODEL_OVERRIDE_OPTIONS).map(function(e){return{id:e.qualified,editorPreferencesValue:e.qualified,title:e.readable}})))}};e.s(["userPreferences",()=>i])},211733,e=>{"use strict";var t=e.i(276385),n=e.i(824108),r=e.i(133783),i=e.i(446530),o=e.i(613355),a=e.i(140487),s=e.i(396776),l=e.i(929872),u=e.i(960178),c=e.i(625484),d=e.i(616278),f=e.i(363201),p=(0,i.cssRecord)({connectButtonRow:[o.rcss.flex.rowReverse]});function h(e){var i=e.onConfirm,o=(0,r.default)(),h="Host *.replit.dev\n  Port 22\n  IdentityFile ".concat(o,"/.ssh/replit");return(0,t.jsxs)(l.Surface,{gap:12,children:[(0,t.jsxs)(c.View,{gap:4,children:[(0,t.jsx)(u.Header,{level:1,variant:"subheadBig",children:"Update your SSH configuration"}),(0,t.jsxs)(u.Text,{color:"dimmer",children:["Before connecting over SSH, you need to update your local SSH configuration file, which is usually located at ",o,"/.ssh/config"]})]}),(0,t.jsx)(n.default,{code:h,header:".ssh/config",multiline:!0}),(0,t.jsx)(s.StatusBanner,{text:"You can find this information later in the SSH docs",icon:(0,t.jsx)(f.default,{})}),(0,t.jsx)(c.View,{css:p.connectButtonRow,children:(0,t.jsx)(a.Button,{text:"I updated my config",iconLeft:(0,t.jsx)(d.default,{}),onClick:i,colorway:"primary",stretch:!1})})]})}e.s(["default",()=>h])},959407,e=>{"use strict";var t=e.i(530658),n=e.i(389959),r=e.i(529810),i=e.i(778203),o=e.i(806804);function a(e){var a=(0,t._)((0,n.useState)(!1),2),s=a[0],l=a[1],u=function(e){var o,a,s,l,u=(0,i.default)(),c=(o=(0,r.default)().container,s=(a=(0,t._)((0,n.useState)("/home/runner"),2))[0],l=a[1],(0,n.useEffect)(function(){o.exec("pwd").then(function(e){var t;e.output&&l((null==(t=e.output)?void 0:t.replace("\n",""))||"")})},[o]),s);if(!u)return"".concat(e,"://vscode-remote/ssh-remote");var d=u.sshUser,f=u.sshHostname,p=u.sshPort,h="".concat(e,"://vscode-remote/ssh-remote+").concat(d,"@").concat(f,":").concat(p).concat(c);try{return window.encodeURI(h)}catch(e){return h}}(e),c=(0,o.default)("ssh","workspace-ssh-connect-to-vscode-config-tour"),d=c.register;return(0,n.useEffect)(function(){d()},[d]),{openEditor:(0,n.useCallback)(function(){c.shouldDisplay?l(!0):window.location.href=u},[c.shouldDisplay,u]),onConfirmConfig:(0,n.useCallback)(function(){l(!1),c.dismiss(),window.location.href=u},[c,u]),isConfigModalOpen:s,closeConfigModal:(0,n.useCallback)(function(){l(!1)},[])}}e.s(["default",()=>a])},843754,e=>{"use strict";var t,n=e.i(297083),r=e.i(886513),i=e.i(817556),o=e.i(626430),a=e.i(866408),s=((t={}).CHANNEL_OPENED="CHANNEL_OPENED",t.OUTPUT_RECEIVED="OUTPUT_RECEIVED",t.STDERR_RECEIVED="STDERR_RECEIVED",t.STATE_CHANGED="STATE_CHANGED",t);function l(e){var t=e.container,l=(0,a.default)(),u=null,c=!1,d="",f="",p=t.openChannel({service:"exec"},function(e){var t=e.channel,n=!1;return t.onCommand(function(e){if(null!=e.output)d+=e.output,l.emit(s.OUTPUT_RECEIVED,e.output);else if(null!=e.stderr)f+=e.stderr,l.emit(s.STDERR_RECEIVED,e.stderr);else if(null!=e.state){if(!n){n=!0;return}l.emit(s.STATE_CHANGED,{state:e.state,outputBuffer:d,stderrBuffer:f}),e.state===o.api.State.Stopped&&(d="",f="")}}),u=t,l.emit(s.CHANNEL_OPENED,t),function(){u=null}});return{request:function(e){return(0,n._)(function(){var t,a,d,f,p,h,g,m,x,y;return(0,i._)(this,function(b){switch(b.label){case 0:return t=e.env,a=e.args,f=void 0===(d=e.lifecycle)?o.api.Exec.Lifecycle.NON_BLOCKING:d,h=void 0!==(p=e.splitStderr)&&p,g=e.noUserEnv,m=(0,r._)(e,["env","args","lifecycle","splitStderr","noUserEnv"]),[4,(0,n._)(function(){return(0,i._)(this,function(e){if(c)throw Error("closed");return u?[2,u]:[2,new Promise(function(e){l.once(s.CHANNEL_OPENED,function(t){e(t)})})]})})()];case 1:return y=(x=b.sent()).request({exec:{env:t,args:a,lifecycle:f,splitStderr:h,noUserEnv:null!=g&&g}}),f===o.api.Exec.Lifecycle.STDIN&&"stdin"in m&&(x.send({input:m.stdin}),x.send({inputClose:{}})),[2,y]}})})()},onOutput:function(e){return l.on(s.OUTPUT_RECEIVED,e),function(){l.off(s.OUTPUT_RECEIVED,e)}},onStderr:function(e){return l.on(s.STDERR_RECEIVED,e),function(){l.off(s.STDERR_RECEIVED,e)}},onStateChanged:function(e){return l.on(s.STATE_CHANGED,e),function(){l.off(s.STATE_CHANGED,e)}},getStatus:function(){return u?u.status:"closed"},dispose:function(){c=!0,p(),u=null}}}e.s(["default",()=>l],843754)},578166,316346,189920,431544,606296,e=>{"use strict";var t,n,r,i,o=e.i(297083),a=e.i(530658),s=e.i(817556),l=e.i(276385),u=e.i(906368),c=e.i(890963),d=e.i(106020),f=e.i(262206),p=e.i(878420),h=e.i(223808),g=e.i(15053),m=e.i(843754),x=e.i(664152),y=e.i(886513),b=e.i(937500),w=e.i(64386),k=e.i(346715);e.i(694906);var _=e.i(55449);function S(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.map(function(e){return e.match(/["\s]/)&&!e.match(/'/)?"'".concat(e.replace(/(['\\])/g,"\\$1"),"'"):e.match(/["'\s]/)?'"'.concat(e.replace(/(["\\$`!])/g,"\\$1"),'"'):e.replace(/[#!"$&'()*,:;<=>?@[\\\]^`{|}]/g,"\\$&")}).join(" ")}function C(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=[],r=function(e){return e.forEach(function(e){return e&&n.push("-g",e)})},i=[],o=[],a=!0,s=!1,l=void 0;try{for(var u,c=e[Symbol.iterator]();!(a=(u=c.next()).done);a=!0){var d=u.value,f=T(d);f.startsWith("**")?i.push(f):o.push(f)}}catch(e){s=!0,l=e}finally{try{a||null==c.return||c.return()}finally{if(s)throw l}}return o.length>0&&(r(["!*"]),new Set(o).forEach(function(e){r((function(e){var t=function(e){Array.isArray(r[e])||(r[e]=[]);var t,i=n[e],o=i.startsWith("{")&&i.endsWith("}")?R(i.substring(1,i.length-1),","):[i];(t=r[e]).push.apply(t,(0,k._)(o.map(function(t){var n=r[e-1];return n&&n.length>0?n.map(function(e){return"".concat(e,"/").concat(t)}):t}).flat(2)))},n=R(e,"/").filter(function(e){return e.length>0});"**"!==n[n.length-1]&&n.push("**");for(var r={},i=0;i<n.length;i++)t(i);return Object.values(r).flat(2)})(e).map(j))})),r(i),r(t.map(function(e){return"!".concat(j(T(e)))})),n}function j(e){return e.startsWith("**")||e.startsWith("/")?e:"/".concat(e)}function T(e){return e.replaceAll(/\*/g,function(e,t,n){return t>0&&("*"===n[t-1]||"\\"===n[t-1])||t<n.length-1&&"*"===n[t+1]?e:"**"})}var E=(t={},n={},(r=function(e,r){t[e]=r,n[r]=e})("{","}"),r("(",")"),r("[","]"),{hasKey:function(e){return e in t},getKey:function(e){return t[e]},hasValue:function(e){return e in n},getValue:function(e){return n[e]}});function R(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:",";if(0===e.length)return[];var n=[],r=[],i="",o=!0,a=!1,s=void 0;try{for(var l,u=e[Symbol.iterator]();!(o=(l=u.next()).done);o=!0){var c=l.value;if(c===t){if(0===r.length){n.push(i),i="";continue}}else if(E.hasKey(c))r.push(c);else if(E.hasValue(c)&&r.pop()!==E.getValue(c))return[e];i+=c}}catch(e){a=!0,s=e}finally{try{o||null==u.return||u.return()}finally{if(a)throw s}}return 0!==r.length?[e]:(i.length>0&&n.push(i),n)}e.s(["optimizeGlobs",()=>C,"splitGlobAware",()=>R],316346);var I=((i={}).PARTIAL_RESULTS="Displaying partial results, try being more specific with your search.",i.EMPTY_RESULTS="Nothing came up searching your App's content.",i.EMPTY_QUERY="No search query was provided.",i.INVALID_LINE="We encountered an invalid line while parsing your search results.",i.INVALID_COMMAND="Ripgrep returned an invalid response.",i.CONTAINER_DISCONNECTED="Disconnected from the container.",i.CONTAINER_CONNECTING="Connecting to the container.",i.CHANNEL_CLOSED="Channel was closed.",i);function A(){var e="",t=new Map;return function(n){var r=new Set,i=!1;if(n.trim().startsWith("error"))return{error:I.INVALID_COMMAND,filesMap:t,filesMapChanges:r};var o=n.indexOf("\n"),a=0,s=e+n;if(o>=0)o+=e.length;else{e=s;return}for(;o>=0;){var l=s.substring(a,o).trim();if(0!==l.length){var u=function(e){try{return JSON.parse(e)}catch(e){return null}}(l);u&&!function(e,t,n){switch(e.type){case"begin":var r=P(e.data.path);if(!r)return!1;t.set(r,{path:r,lines:[],dedentBy:0}),n.add(r);break;case"end":break;case"match":case"context":var i=P(e.data.path);if(!i)return!1;n.add(i);var o=t.get(i);if(!o)return!1;var a=function(e,t){var n,r,i=P(e.data.lines);if(!i)return null;var o=i.trimEnd().split(/\r?\n/),a=[];(null==(n=o[0])?void 0:n.trim())===""&&o.shift(),(null==(r=o[o.length-1])?void 0:r.trim())===""&&o.pop();var s=0,l=0,u=e.data.submatches;return o.forEach(function(t,n){var r=e.data.line_number+n,i=l;l+=t.length+1;for(var o=[];s<u.length;){var c=u[s];if(c.start>=l)break;var d=c.start-i,f=void 0;if(f=c.end<l?c.end-c.start:c.end===l?c.end-c.start-1:t.length-d,d<t.length&&o.push({start:d,length:f}),c.end>l){c.start=l;break}s++}a.push({lineNumber:r,content:t,matches:o})}),(0,w._)((0,p._)({},t),{lines:t.lines.concat(a)})}(e,o);a&&t.set(i,a);break;case"error":return x.logger.error("Invalid Search Line",{line:JSON.stringify(e)}),!1}return!0}(u,t,r)&&(i=!0)}a=o+1,o=s.indexOf("\n",a)}return e=s.substring(a),{error:i?I.INVALID_LINE:null,filesMap:t,filesMapChanges:r}}}function P(e){return e?"bytes"in e?b.Buffer.from(e.bytes,"base64").toString():e.text:null}function D(e){var t,n=e.lines.length>0?(t=Math).min.apply(t,(0,k._)(e.lines.map(function(e){return e.content.match(/^[\t ]+/)}).flat().map(function(e){return(null==e?void 0:e.length)||0}))):0;return(0,w._)((0,p._)({},e),{dedentBy:n})}function O(e,t,n){for(var r=(0,k._)(e),i=new Set,o=0;o<r.length;o++){var a=r[o].path,s=t.get(a);n.has(a)&&s&&(r[o]=s,i.add(a))}var l=!0,u=!1,c=void 0;try{for(var d,f=n[Symbol.iterator]();!(l=(d=f.next()).done);l=!0){var p=d.value,h=t.get(p);!i.has(p)&&h&&r.push(h)}}catch(e){u=!0,c=e}finally{try{l||null==f.return||f.return()}finally{if(u)throw c}}return r}function N(e){var t=e.mode,n=e.query,r=e.context,i=e.isRegex,o=e.isCaseSensitive,a=e.isMatchingWholeWords,s=e.includeGlobs,l=e.excludeGlobs,u=void 0===l?(0,k._)(_.ignoredDirs):l,c=["rg"];switch(t){case"json":c.push("--json");break;case"files":c.push("--files-with-matches")}return null!==r&&c.push("--context","".concat(r)),n.includes("\n")&&c.push("--multiline"),i||c.push("--fixed-strings"),c.push("--max-count","100"),c.push("--max-filesize","4M"),c.push("--max-depth","24"),c.push("--max-columns","512"),c.push("--max-columns-preview"),c.push(o?"--case-sensitive":"--ignore-case"),c.push("--hidden"),a&&c.push("--word-regexp"),c.push.apply(c,(0,k._)(C(s,u))),c.push("--",n),function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:524288;return["sh","-c","".concat(S.apply(void 0,(0,k._)(e))," | head -c ").concat(t)]}(c)}e.s(["SearchError",()=>I],189920),e.s(["RG_LIMIT",()=>524288,"createParseOutput",()=>A,"createSearchCommand",()=>N,"dedentSearchFile",()=>D,"updateSearchFiles",()=>O],431544);var M="exit status 1";e.i(282332);var L=e.i(8808);function B(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return{error:e,data:t}}var V="File Search Used";function F(e){var t=e.container,n=e.onError,r=e.onUpdate,i=e.onLoadingStateChange,o=e.isStreaming,a=e.trackLatency,s=void 0!==a&&a,l=(0,m.default)({container:t}),c=[],d=(0,g.v4)(),f=Date.now(),b=function(e){r(c=e)};return(0,h.default)(function(e){var t=(0,g.v4)();d=t,f=Date.now(),n(null),i(!0);var r=!0;if(""===e.query){b([]),i(!1);return}!function(e){var t=e.execer,n=e.onComplete,r=e.onError,i=e.onParse,o=(0,y._)(e,["execer","onComplete","onError","onParse"]);if(0===o.query.length)return n("abort");var a=new TextEncoder,s=A(),l=0,c=0,d=function(){},f=function(e){r(e),n("error")},p=function(e){0===l&&"finished"===e?f(I.EMPTY_RESULTS):("finished"===e?n(e,{bytes:c}):n(e),d())},h=t.onOutput(function(e){var t=a.encode(e).length;c+=t;var n=s(e);if(n){var r=n.error,o=n.filesMap,u=n.filesMapChanges;r&&f(r),l=o.size,u.forEach(function(e){var t=o.get(e);t&&o.set(e,D(t))}),i(o,u)}}),g=t.onStderr(function(e){if(e.trim()===M)return f(I.EMPTY_RESULTS);f(I.INVALID_COMMAND)});d=function(){h(),g()};var m=N(o);t.request({args:m,noUserEnv:!0}).then(function(e){if(e.error)return e.error.trim()===M?f(I.EMPTY_RESULTS):f(I.INVALID_COMMAND);p("finished")}).catch(function(e){return u.captureException(Error("Ripgrep search command failed with error: ".concat(e))),f(I.INVALID_COMMAND)})}((0,p._)({execer:l,onComplete:function(r,o){if(d===t){i(!1);var a,l,u,c,p="finished"===r&&o&&524288===o.bytes;p&&n(I.PARTIAL_RESULTS),s&&x.logger.time("".concat(V," - complete"),Date.now()-f,{query:e.query,isRegex:e.isRegex,isCaseSensitive:e.isCaseSensitive,hasIncludes:(null!=(u=null==e||null==(a=e.includeGlobs)?void 0:a.length)?u:0)>0,hasExcludes:(null!=(c=null==e||null==(l=e.excludeGlobs)?void 0:l.length)?c:0)>0,latency:Date.now()-f,isPartialResults:p})}},onError:function(e){d===t&&n(e)},onParse:function(n,a){if(d===t){if(r){if(s){var l,u,p,h;x.logger.time("".concat(V," - first_chunk"),Date.now()-f,{query:e.query,isRegex:e.isRegex,isCaseSensitive:e.isCaseSensitive,hasIncludes:(null!=(p=null==e||null==(l=e.includeGlobs)?void 0:l.length)?p:0)>0,hasExcludes:(null!=(h=null==e||null==(u=e.excludeGlobs)?void 0:u.length)?h:0)>0})}b(O([],n,a)),r=!1}else b(O(c,n,a));o&&i(!1)}},mode:"json",context:0},e))},200)}function U(e){var t=e.container,n=(0,h.default)(function(e,n,r){var i;(i=(0,p._)({container:t,mode:"json",context:1,isCaseSensitive:!1},e),(0,o._)(function(){var e,t,n,r,o,a,l;return(0,s._)(this,function(s){switch(s.label){case 0:if(t=i.container,0===(n=(0,y._)(i,["container"])).query.trim().length)return[2,B(I.EMPTY_QUERY)];if(t.getConnectionState()===L.ConnectionState.DISCONNECTED)return[2,B(I.CONTAINER_DISCONNECTED)];if(t.getConnectionState()===L.ConnectionState.CONNECTING)return[2,B(I.CONTAINER_CONNECTING)];return[4,(e=t).exec.apply(e,(0,k._)(N(n)))];case 1:if(o=(r=s.sent()).output,a=r.error)switch(a){case M:return[2,B(I.EMPTY_RESULTS)];case"signal: broken pipe":return[2,B(I.PARTIAL_RESULTS)];case"Channel closed":return[2,B(I.CHANNEL_CLOSED)];default:return u.captureException(Error("Ripgrep search command failed with error: ".concat(a))),[2,{error:a,data:null}]}if(!(null==o?void 0:o.trim())||!(l=A()(o))||0===l.filesMap.size)return[2,B(I.EMPTY_RESULTS)];return[2,B(l.error,l.filesMap)]}})})()).then(function(e){var t=e.data?function(e){var t={},n=!0,r=!1,i=void 0;try{for(var o,s=e.entries()[Symbol.iterator]();!(n=(o=s.next()).done);n=!0){var l=(0,a._)(o.value,2),u=l[0],c=l[1];t[u]=c.lines.map(function(e){return{content:e.content,lineNumber:e.lineNumber,matches:e.matches.map(function(e){return{column:e.start,length:e.length}})}}).filter(function(e){return e.matches.length>0})}}catch(e){r=!0,i=e}finally{try{n||null==s.return||s.return()}finally{if(r)throw i}}return t}(e.data):{},r=e.error===I.PARTIAL_RESULTS;if(r);else if(e.error)return n({error:e.error,results:null,isPartialResult:r});return n({error:null,results:t,isPartialResult:r})}).catch(r)},200);return function(e){return new Promise(function(t,r){return n(e,t,r)})}}e.s(["createAsyncSearchFunction",()=>U,"default",()=>F],606296);var G=e.i(480028),$=e.i(446530),z=e.i(613355),H=e.i(630818),W=e.i(960178),q=e.i(625484),K=e.i(989481),Y=e.i(37068),Q=e.i(793579),X=e.i(42458),J=(0,$.cssRecord)({singleLine:[{whiteSpace:"nowrap",fontFamily:G.tokens.fontFamilyCode},z.rcss.truncate,z.rcss.color.foregroundDimmest]});function Z(e){var t=e.path,n=e.line;return(0,l.jsxs)(q.View,{grow:!0,shrink:!0,p:8,gap:4,align:"start",children:[(0,l.jsxs)(q.View,{row:!0,gap:4,align:"center",children:[(0,l.jsx)(H.default,{path:t,size:12}),(0,l.jsxs)(W.Text,{variant:"small",color:"dimmest",multiline:!1,children:[t.replace(/^\.\//,""),":",n.lineNumber]})]}),(0,l.jsx)(q.View,{css:J.singleLine,children:(0,l.jsx)(Y.HighlightMatches,{source:n.content,matches:n.matches})})]})}function ee(){return(0,l.jsxs)(q.View,{px:8,row:!0,gap:8,align:"center",children:[(0,l.jsx)(X.default,{}),(0,l.jsx)(W.Text,{color:"dimmest",multiline:!1,children:"Something went wrong searching your App's contents. Please try again."})]})}function et(){return(0,l.jsxs)(q.View,{row:!0,gap:8,p:8,align:"center",children:[(0,l.jsx)(X.default,{}),(0,l.jsx)(W.Text,{color:"dimmest",multiline:!1,children:"Displaying only part of the results, try being more specific with your search."})]})}function en(){return(0,l.jsx)(q.View,{row:!0,gap:8,p:8,align:"center",children:(0,l.jsx)(W.Text,{color:"dimmest",multiline:!1,children:"Nothing came up searching your App's content."})})}var er=(0,f.defaultKeyCombo)({cmdOrCtrl:!0,shift:!0,key:"f"});function ei(e){var t,n=U({container:e.container});return(0,d.createCommand)({type:"context",description:"Search through your files",label:"Search",icon:(0,l.jsx)(Q.default,{}),keyboardShortcut:e.keyboardShortcut?er:void 0},{match:e.activeOnly?d.fzfMatchLabel:(0,d.createFzfMatchLabel)({defaultScore:K.commandDefaultScores.searchFileContents}),commands:function(r){return(0,o._)(function(){var i,o,d,f,p,h,g,m,x,y,b,w;return(0,s._)(this,function(s){switch(s.label){case 0:if(!r.searchQuery||!r.active&&e.activeOnly)return[2,[]];return t=i=Math.random(),[4,n({query:r.searchQuery})];case 1:if(d=(o=s.sent()).results,f=o.error,p=o.isPartialResult,i!==t)return[2,[]];if(null!==f){if(!r.active)return[2,[]];return u.captureException(Error("Search file contents returned an error"),{extra:{message:f}}),[2,[{data:{type:"error",label:"error",icon:(0,l.jsx)(X.default,{})},match:function(){return{score:1,render:{content:(0,l.jsx)(ee,{})}}}}]]}h=[],g=!0,m=!1,x=void 0;try{for(y=function(){var t=(0,a._)(w.value,2),n=t[0];t[1].forEach(function(t){var i=t.matches[0].column;h.push({match:function(){var e=(0,c.fzfMatch)(r.searchQuery,t.content,{filterLowMatchScores:!0});return{score:Math.floor(((null==e?void 0:e.score)||1)*K.commandMatchScoreMultipliers.fileContentsSearch),render:{height:60,content:(0,l.jsx)(Z,{path:n,line:t})}}},data:{type:"action",label:n,icon:(0,l.jsx)(H.default,{path:n}),key:[n,t.lineNumber,i].join(":"),run:function(){e.openFile({path:n,line:t.lineNumber,col:i})}}})})},b=Object.entries(d)[Symbol.iterator]();!(g=(w=b.next()).done);g=!0)y()}catch(e){m=!0,x=e}finally{try{g||null==b.return||b.return()}finally{if(m)throw x}}if(0===h.length&&r.active)return[2,[{data:{type:"output",label:"",icon:(0,l.jsx)(q.View,{})},match:function(){return{score:1,render:{content:(0,l.jsx)(en,{})}}}}]];if(r.active)if(0===h.length)return[2,[{data:{type:"output",label:"",icon:(0,l.jsx)(q.View,{})},match:function(){return{score:1,render:{content:(0,l.jsx)(en,{})}}}}]];else p&&h.push({data:{type:"error",label:"error",icon:(0,l.jsx)(X.default,{})},match:function(){return{score:1/0,render:{content:(0,l.jsx)(et,{})}}}});return[2,h]}})})()}})}e.s(["createSearchFileContentsCommand",()=>ei,"keyboardShortcut",()=>er],578166)},338188,e=>{"use strict";var t=e.i(297083),n=e.i(721281),r=e.i(878420),i=e.i(64386),o=e.i(886513),a=e.i(530658),s=e.i(346715),l=e.i(817556),u=e.i(478902),c=e.i(389959),d=e.i(971131),f=Math.min,p=Math.max,h=Math.abs,g=Math.floor,m=function(e,t,n){return f(n,p(t,e))},x=function(e){return(0,s._)(e).sort(function(e,t){return e-t})},y="function"==typeof queueMicrotask?queueMicrotask:function(e){Promise.resolve().then(e)},b=function(e){var t,n;return function(){return t||(t=!0,n=e()),n}},w=function(e,t,n){for(var r=n?"unshift":"push",i=0;i<t;i++)e[r](-1);return e},k=function(e,t){var n=e.t[t];return -1===n?e.o:n},_=function(e,t,n){var r=-1===e.t[t];return e.t[t]=n,e.i=f(t,e.i),r},S=function(e,t){if(!e.l)return 0;if(e.i>=t)return e.u[t];e.i<0&&(e.u[0]=0,e.i=0);for(var n=e.i,r=e.u[n];n<t;)r+=k(e,n),e.u[++n]=r;return e.i=t,r},C=function(e,t){for(var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:e.l-1;n<=r;){var i=g((n+r)/2),o=S(e,i);if(o<=t){if(o+k(e,i)>t)return i;n=i+1}else r=i-1}return m(n,0,e.l-1)},j=function(e,t,n){var r=t-e.l;return e.i=n?-1:f(t-1,e.i),e.l=t,r>0?(w(e.u,r),w(e.t,r,n),e.o*r):(e.u.splice(r),(n?e.t.splice(0,-r):e.t.splice(r)).reduce(function(t,n){return t-(-1===n?e.o:n)},0))},T="undefined"!=typeof window,E=function(){return document.documentElement},R=function(e){return e.ownerDocument},I=function(e){return e.defaultView},A=b(function(){return!!T&&"rtl"===getComputedStyle(E()).direction}),P=b(function(){return/iP(hone|od|ad)/.test(navigator.userAgent)}),D=b(function(){return"scrollBehavior"in E().style}),O=function(e){return!!e.v()},N=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:40,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:4,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,i=arguments.length>4?arguments[4]:void 0,o=arguments.length>5&&void 0!==arguments[5]&&arguments[5],s=!!r,l=1,u=0,c=0,d=0,g=0,m=0,y=0,b=0,T=0,E=s?[0,p(r-1,0)]:null,R=[0,0],I=0,A={o:i?i[1]:t,t:i&&i[0]?w(i[0].slice(0,f(e,i[0].length)),p(0,e-i[0].length)):w([],e),l:e,i:-1,u:w([],e)},D=new Set,O=function(){return d-c},N=function(){return O()+m+g},M=function(e){var t=u,n=R[0];if(n=f(n,A.l-1),S(A,n)<=e){var r=C(A,e+t,n);return[C(A,e,n,r),r]}var i=C(A,e,void 0,n);return[i,C(A,e+t,i)]},L=function(){return A.l?S(A,A.l-1)+k(A,A.l-1):0},B=function(e){return S(A,e)-m},V=function(e){return k(A,e)},F=function(e){e&&(P()&&0!==b?m+=e:g+=e)};return{p:function(){return l},m:function(){return[A.t.slice(),A.o]},_:function(){var e,t,r,i;return y?(e=(r=(0,a._)(R,2))[0],t=r[1]):(e=(i=(0,a._)(R=M(p(0,N())),2))[0],t=i[1],E&&(e=f(e,E[0]),t=p(t,E[1]))),1!==b&&(e-=p(0,n)),2!==b&&(t+=p(0,n)),[p(e,0),f(t,A.l-1)]},S:function(){return C(A,N())},$:function(){return C(A,N()+u)},I:function(e){return -1===A.t[e]},k:function(){return!!E&&A.t.slice(p(0,E[0]-1),f(A.l-1,E[1]+1)+1).includes(-1)},T:B,R:V,M:function(){return A.l},C:function(){return d},H:function(){return 0!==b},v:function(){return u},W:function(){return c},h:L,O:function(){return y=g,g=0,[y,2===T||O()+u>=L()]},B:function(e,t){var n=[e,t];return D.add(n),function(){D.delete(n)}},J:function(e,t){var n,r,i=0;switch(e){case 1:var f=y;y=0;var w=t-d,k=h(w);f&&k<h(f)+1||0!==T||(b=w<0?2:1),s&&(E=null,s=!1),d=t,i=4;var S=O();S>=-u&&S<=L()&&(i+=1,r=k>u);break;case 2:i=8,0!==b&&(n=!0,i+=1),b=0,T=0,E=null;break;case 3:var R,P,U,G,$,z,H,W,q=t.filter(function(e){var t=(0,a._)(e,2),n=t[0],r=t[1];return A.t[n]!==r});if(!q.length)break;F(q.reduce(function(e,t){var n=(0,a._)(t,2),r=n[0],i=n[1];return(2===T||(E?!s&&r<E[0]:B(r)+(0===b&&0===T?V(r):0)<O()))&&(e+=i-V(r)),e},0));var K=!0,Y=!1,Q=void 0;try{for(var X,J=q[Symbol.iterator]();!(K=(X=J.next()).done);K=!0){var Z=(0,a._)(X.value,2),ee=Z[0],et=Z[1],en=V(ee),er=_(A,ee,et);o&&(I+=er?et:et-en)}}catch(e){Y=!0,Q=e}finally{try{K||null==J.return||J.return()}finally{if(Y)throw Q}}o&&u&&I>u&&(F((R=C(A,N()),P=0,U=[],A.t.forEach(function(e,t){-1!==e&&(U.push(e),t<R&&P++)}),A.i=-1,z=($=(G=x(U)).length)/2|0,H=$%2==0?(G[z-1]+G[z])/2:G[z],W=A.o,((A.o=H)-W)*p(R-P,0))),o=!1),i=3,r=!0;break;case 4:u!==t&&(u=t,i=3);break;case 5:t[1]?(F(j(A,t[0],!0)),T=2):j(A,t[0]),i=1;break;case 6:c=t;break;case 7:T=1;break;case 8:E=M(t),i=1}i&&(l=1+(0x7fffffff&l),n&&m&&(g+=m,m=0),D.forEach(function(e){var t=(0,a._)(e,2),n=t[0],o=t[1];i&n&&o(r)}))}}},M=setTimeout,L=function(e,t){return t&&A()?-e:e},B=function(e,t,n,r,i,o){var s,l,u,c=Date.now,d=0,f=!1,p=!1,h=!1,g=!1,m=(l=function(){null!=s&&clearTimeout(s)},(u=function(){l(),s=M(function(){s=null,function(){if(f||p)return f=!1,m();h=!1,e.J(2)}()},150)}).L=l,u),x=function(){d=c(),h&&(g=!0),o&&e.J(6,o()),e.J(1,r()),m()},y=function(t){if(!f&&e.H()&&!t.ctrlKey){var r=c()-d;150>r&&50<r&&(n?t.deltaX:t.deltaY)&&(f=!0)}},b=function(){p=!0,h=g=!1},w=function(){p=!1,P()&&(h=!0)};return t.addEventListener("scroll",x),t.addEventListener("wheel",y,{passive:!0}),t.addEventListener("touchstart",b,{passive:!0}),t.addEventListener("touchend",w,{passive:!0}),{P:function(){t.removeEventListener("scroll",x),t.removeEventListener("wheel",y),t.removeEventListener("touchstart",b),t.removeEventListener("touchend",w),m.L()},A:function(){var t=(0,a._)(e.O(),2),o=t[0],s=t[1];o&&(i(L(o,n),s,g),g=!1,s&&e.v()>e.h()&&e.J(1,r()))}}},V=function(e,r){var i,o,s,u=r?"scrollLeft":"scrollTop",c=r?"overflowX":"overflowY",d=function(o,c){return(0,t._)(function(){var t,f,p,h,g,m,x,b;return(0,l._)(this,function(l){switch(l.label){case 0:if(!i)return[2,void y(function(){return d(o,c)})];if(s&&s(),t=function(){var t;return[new Promise(function(n,r){t=n,s=r,O(e)&&M(r,150)}),e.B(2,function(){t&&t()})]},!(c&&D()))return[3,8];l.label=1;case 1:if(e.J(8,o()),!e.k())return[3,7];p=(f=(0,a._)(t(),2))[0],h=f[1],l.label=2;case 2:return l.trys.push([2,4,5,6]),[4,p];case 3:return l.sent(),[3,6];case 4:return l.sent(),[2];case 5:return h(),[7];case 6:return[3,1];case 7:return i.scrollTo((g={},(0,n._)(g,r?"left":"top",L(o(),r)),(0,n._)(g,"behavior","smooth"),g)),[3,14];case 8:x=(m=(0,a._)(t(),2))[0],b=m[1],l.label=9;case 9:return l.trys.push([9,11,12,13]),i[u]=L(o(),r),e.J(7),[4,x];case 10:return l.sent(),[3,13];case 11:return l.sent(),[2];case 12:return b(),[7];case 13:return[3,8];case 14:return[2]}})})()};return{V:function(t){i=t,o=B(e,t,r,function(){return L(t[u],r)},function(n,r,i){if(i){var o=t.style,a=o[c];o[c]="hidden",M(function(){o[c]=a})}r?(t[u]=e.C()+n,s&&s()):t[u]+=n})},X:function(){o&&o.P()},Y:function(e){d(function(){return e})},j:function(t){t+=e.C(),d(function(){return t})},q:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=n.align,i=n.smooth,o=n.offset,a=void 0===o?0:o;if(t=m(t,0,e.M()-1),"nearest"===r){var s=e.T(t),l=e.C();if(s<l)r="start";else{if(!(s+e.R(t)>l+e.v()))return;r="end"}}d(function(){return a+e.W()+e.T(t)+("end"===r?e.R(t)-e.v():"center"===r?(e.R(t)-e.v())/2:0)},i)},D:function(){o&&o.A()}}},F=function(e){var t;return{U:function(n){(t||(t=new(I(R(n))).ResizeObserver(e))).observe(n)},F:function(e){t.unobserve(e)},P:function(){t&&t.disconnect()}}},U=function(e,t){var n,r=t?"width":"height",i=new WeakMap,o=F(function(t){var o=[],a=!0,s=!1,l=void 0;try{for(var u,c=t[Symbol.iterator]();!(a=(u=c.next()).done);a=!0){var d=u.value,f=d.target,p=d.contentRect;if(f.offsetParent)if(f===n)e.J(4,p[r]);else{var h=i.get(f);null!=h&&o.push([h,p[r]])}}}catch(e){s=!0,l=e}finally{try{a||null==c.return||c.return()}finally{if(s)throw l}}o.length&&e.J(3,o)});return{G:function(e){o.U(n=e)},K:function(e,t){return i.set(e,t),o.U(e),function(){i.delete(e),o.F(e)}},X:o.P}},G=T?c.useLayoutEffect:c.useEffect,$="current",z=function(e,t){var n=!0,r=!1,i=void 0;if(Array.isArray(e))try{for(var o,a=e[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var s=o.value;z(s,t)}}catch(e){r=!0,i=e}finally{try{n||null==a.return||a.return()}finally{if(r)throw i}}else null==e||"boolean"==typeof e||t.push(e)},H=function(e,t){var n=e.key;return null!=n?n:"_"+t},W=function(e){var t=(0,c.useRef)();return t[$]||(t[$]=e())},q=function(e){var t=(0,c.useRef)(e);return G(function(){t[$]=e},[e]),t},K=(0,c.memo)(function(e){var t=e.N,r=e.Z,i=e.ee,o=e.te,a=e.ne,s=e.oe,l=e.re,d=e.ie,f=(0,c.useRef)(null);G(function(){return r(f[$],i)},[i]);var p=(0,c.useMemo)(function(){var e,t=(e={position:a&&d?void 0:"absolute"},(0,n._)(e,l?"height":"width","100%"),(0,n._)(e,l?"top":"left",0),(0,n._)(e,l?A()?"right":"left":"top",o),(0,n._)(e,"visibility",!a||d?"visible":"hidden"),e);return l&&(t.display="flex"),t},[o,a,d,l]);return(0,u.jsx)(s,"string"==typeof s?{ref:f,style:p,children:t}:{ref:f,style:p,index:i,children:t})}),Y=(0,c.forwardRef)(function(e,t){var n,r,i=e.children,o=e.count,l=e.overscan,f=e.itemSize,h=e.shift,g=e.horizontal,m=e.keepMounted,b=e.cache,w=e.startMargin,k=void 0===w?0:w,_=e.ssrCount,S=e.as,C=e.item,j=void 0===C?"div":C,T=e.scrollRef,E=e.onScroll,R=e.onScrollEnd,I=(0,a._)((n=i,r=o,(0,c.useMemo)(function(){if("function"==typeof n)return[n,r||0];var e,t=(z(n,e=[]),e);return[function(e){return t[e]},t.length]},[n,r])),2),A=I[0],P=I[1],D=(0,c.useRef)(null),O=(0,c.useRef)(!!_),M=q(E),L=q(R),B=(0,a._)(W(function(){var e=!!g,t=N(P,f,l,_,b,!f);return[t,U(t,e),V(t,e),e]}),4),F=B[0],Y=B[1],Q=B[2],X=B[3];P!==F.M()&&F.J(5,[P,h]),k!==F.W()&&F.J(6,k);var J=(0,a._)((0,c.useReducer)(F.p,void 0,F.p),2),Z=J[0],ee=J[1],et=(0,a._)(F._(),2),en=et[0],er=et[1],ei=F.H(),eo=F.h(),ea=[],es=function(e){var t=A(e);return(0,u.jsx)(K,{Z:Y.K,ee:e,te:F.T(e),ne:F.I(e),oe:j,N:t,re:X,ie:O[$]},H(t,e))};G(function(){O[$]=!1;var e=F.B(1,function(e){e?(0,d.flushSync)(ee):ee()}),t=F.B(4,function(){M[$]&&M[$](F.C())}),n=F.B(8,function(){L[$]&&L[$]()}),r=function(e){Y.G(e),Q.V(e)};return T?y(function(){return r(T[$])}):r(D[$].parentElement),function(){e(),t(),n(),Y.X(),Q.X()}},[]),G(function(){Q.D()},[Z]),(0,c.useImperativeHandle)(t,function(){return{get cache(){return F.m()},get scrollOffset(){return F.C()},get scrollSize(){var e;return p((e=F).h(),e.v())},get viewportSize(){return F.v()},findStartIndex:F.S,findEndIndex:F.$,getItemOffset:F.T,getItemSize:F.R,scrollToIndex:Q.q,scrollTo:Q.Y,scrollBy:Q.j}},[]);for(var el=en;el<=er;el++)ea.push(es(el));if(m){var eu=[],ec=[];x(m).forEach(function(e){e<en&&eu.push(es(e)),e>er&&ec.push(es(e))}),ea.unshift.apply(ea,(0,s._)(eu)),ea.push.apply(ea,(0,s._)(ec))}return(0,u.jsx)(void 0===S?"div":S,{ref:D,style:{overflowAnchor:"none",flex:"none",position:"relative",visibility:"hidden",width:X?eo:"100%",height:X?"100%":eo,pointerEvents:ei?"none":void 0},children:ea})}),Q=(0,c.forwardRef)(function(e,t){var a,s=e.children,l=e.count,d=e.overscan,f=e.itemSize,p=e.shift,h=e.horizontal,g=e.keepMounted,m=e.reverse,x=e.cache,y=e.ssrCount,b=e.item,w=e.onScroll,k=e.onScrollEnd,_=e.style,S=(0,o._)(e,["children","count","overscan","itemSize","shift","horizontal","keepMounted","reverse","cache","ssrCount","item","onScroll","onScrollEnd","style"]),C=(0,c.useRef)(null),j=m&&!h,T=(0,u.jsx)(Y,{ref:t,scrollRef:j?C:void 0,count:l,overscan:d,itemSize:f,shift:p,horizontal:h,keepMounted:g,cache:x,ssrCount:y,item:b,onScroll:w,onScrollEnd:k,children:s});return j&&(T=(0,u.jsx)("div",{style:{visibility:"hidden",display:"flex",flexDirection:"column",justifyContent:"flex-end",minHeight:"100%"},children:T})),(0,u.jsx)("div",(0,i._)((0,r._)({ref:C},S),{style:(0,r._)((a={display:h?"inline-block":"block"},(0,n._)(a,h?"overflowX":"overflowY","auto"),(0,n._)(a,"contain","strict"),(0,n._)(a,"width","100%"),(0,n._)(a,"height","100%"),a),_),children:T}))});e.s(["VList",()=>Q])},72675,e=>{e.v(["0BSD","AAL","ADSL","AFL-1.1","AFL-1.2","AFL-2.0","AFL-2.1","AFL-3.0","AGPL-1.0-only","AGPL-1.0-or-later","AGPL-3.0-only","AGPL-3.0-or-later","AMDPLPA","AML","AMPAS","ANTLR-PD","ANTLR-PD-fallback","APAFML","APL-1.0","APSL-1.0","APSL-1.1","APSL-1.2","APSL-2.0","Abstyles","AdaCore-doc","Adobe-2006","Adobe-Glyph","Afmparse","Aladdin","Apache-1.0","Apache-1.1","Apache-2.0","App-s2p","Arphic-1999","Artistic-1.0","Artistic-1.0-Perl","Artistic-1.0-cl8","Artistic-2.0","BSD-1-Clause","BSD-2-Clause","BSD-2-Clause-Patent","BSD-2-Clause-Views","BSD-3-Clause","BSD-3-Clause-Attribution","BSD-3-Clause-Clear","BSD-3-Clause-LBNL","BSD-3-Clause-Modification","BSD-3-Clause-No-Military-License","BSD-3-Clause-No-Nuclear-License","BSD-3-Clause-No-Nuclear-License-2014","BSD-3-Clause-No-Nuclear-Warranty","BSD-3-Clause-Open-MPI","BSD-4-Clause","BSD-4-Clause-Shortened","BSD-4-Clause-UC","BSD-4.3RENO","BSD-4.3TAHOE","BSD-Advertising-Acknowledgement","BSD-Attribution-HPND-disclaimer","BSD-Protection","BSD-Source-Code","BSL-1.0","BUSL-1.1","Baekmuk","Bahyph","Barr","Beerware","BitTorrent-1.0","BitTorrent-1.1","Bitstream-Charter","Bitstream-Vera","BlueOak-1.0.0","Borceux","Brian-Gladman-3-Clause","C-UDA-1.0","CAL-1.0","CAL-1.0-Combined-Work-Exception","CATOSL-1.1","CC-BY-1.0","CC-BY-2.0","CC-BY-2.5","CC-BY-2.5-AU","CC-BY-3.0","CC-BY-3.0-AT","CC-BY-3.0-DE","CC-BY-3.0-IGO","CC-BY-3.0-NL","CC-BY-3.0-US","CC-BY-4.0","CC-BY-NC-1.0","CC-BY-NC-2.0","CC-BY-NC-2.5","CC-BY-NC-3.0","CC-BY-NC-3.0-DE","CC-BY-NC-4.0","CC-BY-NC-ND-1.0","CC-BY-NC-ND-2.0","CC-BY-NC-ND-2.5","CC-BY-NC-ND-3.0","CC-BY-NC-ND-3.0-DE","CC-BY-NC-ND-3.0-IGO","CC-BY-NC-ND-4.0","CC-BY-NC-SA-1.0","CC-BY-NC-SA-2.0","CC-BY-NC-SA-2.0-DE","CC-BY-NC-SA-2.0-FR","CC-BY-NC-SA-2.0-UK","CC-BY-NC-SA-2.5","CC-BY-NC-SA-3.0","CC-BY-NC-SA-3.0-DE","CC-BY-NC-SA-3.0-IGO","CC-BY-NC-SA-4.0","CC-BY-ND-1.0","CC-BY-ND-2.0","CC-BY-ND-2.5","CC-BY-ND-3.0","CC-BY-ND-3.0-DE","CC-BY-ND-4.0","CC-BY-SA-1.0","CC-BY-SA-2.0","CC-BY-SA-2.0-UK","CC-BY-SA-2.1-JP","CC-BY-SA-2.5","CC-BY-SA-3.0","CC-BY-SA-3.0-AT","CC-BY-SA-3.0-DE","CC-BY-SA-4.0","CC-PDDC","CC0-1.0","CDDL-1.0","CDDL-1.1","CDL-1.0","CDLA-Permissive-1.0","CDLA-Permissive-2.0","CDLA-Sharing-1.0","CECILL-1.0","CECILL-1.1","CECILL-2.0","CECILL-2.1","CECILL-B","CECILL-C","CERN-OHL-1.1","CERN-OHL-1.2","CERN-OHL-P-2.0","CERN-OHL-S-2.0","CERN-OHL-W-2.0","CFITSIO","CMU-Mach","CNRI-Jython","CNRI-Python","CNRI-Python-GPL-Compatible","COIL-1.0","CPAL-1.0","CPL-1.0","CPOL-1.02","CUA-OPL-1.0","Caldera","ClArtistic","Clips","Community-Spec-1.0","Condor-1.1","Cornell-Lossless-JPEG","Crossword","CrystalStacker","Cube","D-FSL-1.0","DL-DE-BY-2.0","DOC","DRL-1.0","DSDP","Dotseqn","ECL-1.0","ECL-2.0","EFL-1.0","EFL-2.0","EPICS","EPL-1.0","EPL-2.0","EUDatagrid","EUPL-1.0","EUPL-1.1","EUPL-1.2","Elastic-2.0","Entessa","ErlPL-1.1","Eurosym","FDK-AAC","FSFAP","FSFUL","FSFULLR","FSFULLRWD","FTL","Fair","Frameworx-1.0","FreeBSD-DOC","FreeImage","GD","GFDL-1.1-invariants-only","GFDL-1.1-invariants-or-later","GFDL-1.1-no-invariants-only","GFDL-1.1-no-invariants-or-later","GFDL-1.1-only","GFDL-1.1-or-later","GFDL-1.2-invariants-only","GFDL-1.2-invariants-or-later","GFDL-1.2-no-invariants-only","GFDL-1.2-no-invariants-or-later","GFDL-1.2-only","GFDL-1.2-or-later","GFDL-1.3-invariants-only","GFDL-1.3-invariants-or-later","GFDL-1.3-no-invariants-only","GFDL-1.3-no-invariants-or-later","GFDL-1.3-only","GFDL-1.3-or-later","GL2PS","GLWTPL","GPL-1.0-only","GPL-1.0-or-later","GPL-2.0-only","GPL-2.0-or-later","GPL-3.0-only","GPL-3.0-or-later","Giftware","Glide","Glulxe","Graphics-Gems","HP-1986","HPND","HPND-Markus-Kuhn","HPND-export-US","HPND-sell-variant","HPND-sell-variant-MIT-disclaimer","HTMLTIDY","HaskellReport","Hippocratic-2.1","IBM-pibs","ICU","IEC-Code-Components-EULA","IJG","IJG-short","IPA","IPL-1.0","ISC","ImageMagick","Imlib2","Info-ZIP","Intel","Intel-ACPI","Interbase-1.0","JPL-image","JPNIC","JSON","Jam","JasPer-2.0","Kazlib","Knuth-CTAN","LAL-1.2","LAL-1.3","LGPL-2.0-only","LGPL-2.0-or-later","LGPL-2.1-only","LGPL-2.1-or-later","LGPL-3.0-only","LGPL-3.0-or-later","LGPLLR","LOOP","LPL-1.0","LPL-1.02","LPPL-1.0","LPPL-1.1","LPPL-1.2","LPPL-1.3a","LPPL-1.3c","LZMA-SDK-9.11-to-9.20","LZMA-SDK-9.22","Latex2e","Leptonica","LiLiQ-P-1.1","LiLiQ-R-1.1","LiLiQ-Rplus-1.1","Libpng","Linux-OpenIB","Linux-man-pages-copyleft","MIT","MIT-0","MIT-CMU","MIT-Modern-Variant","MIT-Wu","MIT-advertising","MIT-enna","MIT-feh","MIT-open-group","MITNFA","MPL-1.0","MPL-1.1","MPL-2.0","MPL-2.0-no-copyleft-exception","MS-LPL","MS-PL","MS-RL","MTLL","MakeIndex","Martin-Birgmeier","Minpack","MirOS","Motosoto","MulanPSL-1.0","MulanPSL-2.0","Multics","Mup","NAIST-2003","NASA-1.3","NBPL-1.0","NCGL-UK-2.0","NCSA","NGPL","NICTA-1.0","NIST-PD","NIST-PD-fallback","NLOD-1.0","NLOD-2.0","NLPL","NOSL","NPL-1.0","NPL-1.1","NPOSL-3.0","NRL","NTP","NTP-0","Naumen","Net-SNMP","NetCDF","Newsletr","Nokia","Noweb","O-UDA-1.0","OCCT-PL","OCLC-2.0","ODC-By-1.0","ODbL-1.0","OFFIS","OFL-1.0","OFL-1.0-RFN","OFL-1.0-no-RFN","OFL-1.1","OFL-1.1-RFN","OFL-1.1-no-RFN","OGC-1.0","OGDL-Taiwan-1.0","OGL-Canada-2.0","OGL-UK-1.0","OGL-UK-2.0","OGL-UK-3.0","OGTSL","OLDAP-1.1","OLDAP-1.2","OLDAP-1.3","OLDAP-1.4","OLDAP-2.0","OLDAP-2.0.1","OLDAP-2.1","OLDAP-2.2","OLDAP-2.2.1","OLDAP-2.2.2","OLDAP-2.3","OLDAP-2.4","OLDAP-2.5","OLDAP-2.6","OLDAP-2.7","OLDAP-2.8","OML","OPL-1.0","OPUBL-1.0","OSET-PL-2.1","OSL-1.0","OSL-1.1","OSL-2.0","OSL-2.1","OSL-3.0","OpenPBS-2.3","OpenSSL","PDDL-1.0","PHP-3.0","PHP-3.01","PSF-2.0","Parity-6.0.0","Parity-7.0.0","Plexus","PolyForm-Noncommercial-1.0.0","PolyForm-Small-Business-1.0.0","PostgreSQL","Python-2.0","Python-2.0.1","QPL-1.0","QPL-1.0-INRIA-2004","Qhull","RHeCos-1.1","RPL-1.1","RPL-1.5","RPSL-1.0","RSA-MD","RSCPL","Rdisc","Ruby","SAX-PD","SCEA","SGI-B-1.0","SGI-B-1.1","SGI-B-2.0","SHL-0.5","SHL-0.51","SISSL","SISSL-1.2","SMLNJ","SMPPL","SNIA","SPL-1.0","SSH-OpenSSH","SSH-short","SSPL-1.0","SWL","Saxpath","SchemeReport","Sendmail","Sendmail-8.23","SimPL-2.0","Sleepycat","Spencer-86","Spencer-94","Spencer-99","SugarCRM-1.1.3","SunPro","Symlinks","TAPR-OHL-1.0","TCL","TCP-wrappers","TMate","TORQUE-1.1","TOSL","TPDL","TPL-1.0","TTWL","TU-Berlin-1.0","TU-Berlin-2.0","UCAR","UCL-1.0","UPL-1.0","Unicode-DFS-2015","Unicode-DFS-2016","Unicode-TOU","Unlicense","VOSTROM","VSL-1.0","Vim","W3C","W3C-19980720","W3C-20150513","WTFPL","Watcom-1.0","Wsuipa","X11","X11-distribute-modifications-variant","XFree86-1.1","XSkat","Xerox","Xnet","YPL-1.0","YPL-1.1","ZPL-1.1","ZPL-2.0","ZPL-2.1","Zed","Zend-2.0","Zimbra-1.3","Zimbra-1.4","Zlib","blessing","bzip2-1.0.6","checkmk","copyleft-next-0.3.0","copyleft-next-0.3.1","curl","diffmark","dvipdfm","eGenix","etalab-2.0","gSOAP-1.3b","gnuplot","iMatix","libpng-2.0","libselinux-1.0","libtiff","libutil-David-Nugent","mpi-permissive","mpich2","mplus","psfrag","psutils","snprintf","w3m","xinetd","xlock","xpp","zlib-acknowledgement"])},170957,e=>{e.v(["AGPL-1.0","AGPL-3.0","BSD-2-Clause-FreeBSD","BSD-2-Clause-NetBSD","GFDL-1.1","GFDL-1.2","GFDL-1.3","GPL-1.0","GPL-2.0","GPL-2.0-with-GCC-exception","GPL-2.0-with-autoconf-exception","GPL-2.0-with-bison-exception","GPL-2.0-with-classpath-exception","GPL-2.0-with-font-exception","GPL-3.0","GPL-3.0-with-GCC-exception","GPL-3.0-with-autoconf-exception","LGPL-2.0","LGPL-2.1","LGPL-3.0","Nunit","StandardML-NJ","bzip2-1.0.5","eCos-2.0","wxWindows"])},125107,e=>{e.v(["389-exception","Autoconf-exception-2.0","Autoconf-exception-3.0","Bison-exception-2.2","Bootloader-exception","CLISP-exception-2.0","Classpath-exception-2.0","DigiRule-FOSS-exception","FLTK-exception","Fawkes-Runtime-exception","Font-exception-2.0","GCC-exception-2.0","GCC-exception-3.1","LZMA-exception","Libtool-exception","Linux-syscall-note","Nokia-Qt-exception-1.1","OCCT-exception-1.0","Qwt-exception-1.0","WxWindows-exception-3.1","eCos-exception-2.0","freertos-exception-2.0","gnu-javamail-exception","i2p-gpl-java-exception","mif-exception","openvpn-openssl-exception","u-boot-exception-2.0"])},706373,(e,t,n)=>{"use strict";var r=e.r(954546),i=[].concat(e.r(72675)).concat(e.r(170957)),o=e.r(125107);t.exports=function(e){var t=0;function n(){return t<e.length}function a(n){if(r._(n,RegExp)){var i=e.slice(t).match(n);if(i)return t+=i[0].length,i[0]}else if(e.indexOf(n,t)===t)return t+=n.length,n}function s(){return a(/[A-Za-z0-9-.]+/)}function l(){var e=s();if(!e)throw Error("Expected idstring at offset "+t);return e}for(var u=[];n()&&(a(/[ ]*/),n());){var c=function(){var n,r;return function(){for(var n,r=["WITH","AND","OR","(",")",":","+"],i=0;i<r.length&&!(n=a(r[i]));i++);if("+"===n&&t>1&&" "===e[t-2])throw Error("Space before `+`");return n&&{type:"OPERATOR",string:n}}()||function(){if(a("DocumentRef-"))return{type:"DOCUMENTREF",string:l()}}()||function(){if(a("LicenseRef-"))return{type:"LICENSEREF",string:l()}}()||(n=t,r=s(),-1!==i.indexOf(r)?{type:"LICENSE",string:r}:-1!==o.indexOf(r)?{type:"EXCEPTION",string:r}:void(t=n))}();if(!c)throw Error("Unexpected `"+e[t]+"` at offset "+t);u.push(c)}return u}},512225,(e,t,n)=>{"use strict";t.exports=function(e){var t=0;function n(){return t<e.length}function r(){return n()?e[t]:null}function i(){if(!n())throw Error();t++}function o(e){var t=r();if(t&&"OPERATOR"===t.type&&e===t.string)return i(),t.string}function a(e,t){return function n(){var r=t();if(r){if(!o(e))return r;var i=n();if(!i)throw Error("Expected expression");return{left:r,conjunction:e.toLowerCase(),right:i}}}}var s=a("AND",function(){return function(){if(o("(")){var e=l();if(!o(")"))throw Error("Expected `)`");return e}}()||function(){var e=t,n="",a=r();if("DOCUMENTREF"===a.type&&(i(),n+="DocumentRef-"+a.string+":",!o(":")))throw Error("Expected `:` after `DocumentRef-...`");if("LICENSEREF"===(a=r()).type)return i(),{license:n+="LicenseRef-"+a.string};t=e}()||function(){var e=r();if(e&&"LICENSE"===e.type){i();var t={license:e.string};o("+")&&(t.plus=!0);var n=function(){if(o("WITH")){var e=r();if(e&&"EXCEPTION"===e.type)return i(),e.string;throw Error("Expected exception after `WITH`")}}();return n&&(t.exception=n),t}}()}),l=a("OR",s),u=l();if(!u||n())throw Error("Syntax error");return u}},977122,(e,t,n)=>{"use strict";var r=e.r(706373),i=e.r(512225);t.exports=function(e){return i(r(e))}},994296,(e,t,n)=>{var r=e.r(977122),i=e.r(72675);function o(e){try{return r(e),!0}catch(e){return!1}}function a(e,t){var n=t[0].length-e[0].length;return 0!==n?n:e[0].toUpperCase().localeCompare(t[0].toUpperCase())}var s=[["APGL","AGPL"],["Gpl","GPL"],["GLP","GPL"],["APL","Apache"],["ISD","ISC"],["GLP","GPL"],["IST","ISC"],["Claude","Clause"],[" or later","+"],[" International",""],["GNU","GPL"],["GUN","GPL"],["+",""],["GNU GPL","GPL"],["GNU LGPL","LGPL"],["GNU/GPL","GPL"],["GNU GLP","GPL"],["GNU LESSER GENERAL PUBLIC LICENSE","LGPL"],["GNU Lesser General Public License","LGPL"],["GNU LESSER GENERAL PUBLIC LICENSE","LGPL-2.1"],["GNU Lesser General Public License","LGPL-2.1"],["LESSER GENERAL PUBLIC LICENSE","LGPL"],["Lesser General Public License","LGPL"],["LESSER GENERAL PUBLIC LICENSE","LGPL-2.1"],["Lesser General Public License","LGPL-2.1"],["GNU General Public License","GPL"],["Gnu public license","GPL"],["GNU Public License","GPL"],["GNU GENERAL PUBLIC LICENSE","GPL"],["MTI","MIT"],["Mozilla Public License","MPL"],["Universal Permissive License","UPL"],["WTH","WTF"],["WTFGPL","WTFPL"],["-License",""]].sort(a),l=[function(e){return e.toUpperCase()},function(e){return e.trim()},function(e){return e.replace(/\./g,"")},function(e){return e.replace(/\s+/g,"")},function(e){return e.replace(/\s+/g,"-")},function(e){return e.replace("v","-")},function(e){return e.replace(/,?\s*(\d)/,"-$1")},function(e){return e.replace(/,?\s*(\d)/,"-$1.0")},function(e){return e.replace(/,?\s*(V\.|v\.|V|v|Version|version)\s*(\d)/,"-$2")},function(e){return e.replace(/,?\s*(V\.|v\.|V|v|Version|version)\s*(\d)/,"-$2.0")},function(e){return e[0].toUpperCase()+e.slice(1)},function(e){return e.replace("/","-")},function(e){return e.replace(/\s*V\s*(\d)/,"-$1").replace(/(\d)$/,"$1.0")},function(e){return -1!==e.indexOf("3.0")?e+"-or-later":e+"-only"},function(e){return e+"only"},function(e){return e.replace(/(\d)$/,"-$1.0")},function(e){return e.replace(/(-| )?(\d)$/,"-$2-Clause")},function(e){return e.replace(/(-| )clause(-| )(\d)/,"-$3-Clause")},function(e){return e.replace(/\b(Modified|New|Revised)(-| )?BSD((-| )License)?/i,"BSD-3-Clause")},function(e){return e.replace(/\bSimplified(-| )?BSD((-| )License)?/i,"BSD-2-Clause")},function(e){return e.replace(/\b(Free|Net)(-| )?BSD((-| )License)?/i,"BSD-2-Clause-$1BSD")},function(e){return e.replace(/\bClear(-| )?BSD((-| )License)?/i,"BSD-3-Clause-Clear")},function(e){return e.replace(/\b(Old|Original)(-| )?BSD((-| )License)?/i,"BSD-4-Clause")},function(e){return"CC-"+e},function(e){return"CC-"+e+"-4.0"},function(e){return e.replace("Attribution","BY").replace("NonCommercial","NC").replace("NoDerivatives","ND").replace(/ (\d)/,"-$1").replace(/ ?International/,"")},function(e){return"CC-"+e.replace("Attribution","BY").replace("NonCommercial","NC").replace("NoDerivatives","ND").replace(/ (\d)/,"-$1").replace(/ ?International/,"")+"-4.0"}],u=i.map(function(e){var t=/^(.*)-\d+\.\d+$/.exec(e);return t?[t[0],t[1]]:[e,null]}).reduce(function(e,t){var n=t[1];return e[n]=e[n]||[],e[n].push(t[0]),e},{}),c=Object.keys(u).map(function(e){return[e,u[e]]}).filter(function(e){return 1===e[1].length&&null!==e[0]&&"APL"!==e[0]}).map(function(e){return[e[0],e[1][0]]});u=void 0;var d=[["UNLI","Unlicense"],["WTF","WTFPL"],["2 CLAUSE","BSD-2-Clause"],["2-CLAUSE","BSD-2-Clause"],["3 CLAUSE","BSD-3-Clause"],["3-CLAUSE","BSD-3-Clause"],["AFFERO","AGPL-3.0-or-later"],["AGPL","AGPL-3.0-or-later"],["APACHE","Apache-2.0"],["ARTISTIC","Artistic-2.0"],["Affero","AGPL-3.0-or-later"],["BEER","Beerware"],["BOOST","BSL-1.0"],["BSD","BSD-2-Clause"],["CDDL","CDDL-1.1"],["ECLIPSE","EPL-1.0"],["FUCK","WTFPL"],["GNU","GPL-3.0-or-later"],["LGPL","LGPL-3.0-or-later"],["GPLV1","GPL-1.0-only"],["GPL-1","GPL-1.0-only"],["GPLV2","GPL-2.0-only"],["GPL-2","GPL-2.0-only"],["GPL","GPL-3.0-or-later"],["MIT +NO-FALSE-ATTRIBS","MITNFA"],["MIT","MIT"],["MPL","MPL-2.0"],["X11","X11"],["ZLIB","Zlib"]].concat(c).sort(a),f=function(e){for(var t=0;t<l.length;t++){var n=l[t](e).trim();if(n!==e&&o(n))return n}return null},p=function(e){for(var t=e.toUpperCase(),n=0;n<d.length;n++){var r=d[n];if(t.indexOf(r[0])>-1)return r[1]}return null},h=function(e,t){for(var n=0;n<s.length;n++){var r=s[n],i=r[0];if(e.indexOf(i)>-1){var o=t(e.replace(i,r[1]));if(null!==o)return o}}return null};t.exports=function(e,t){var n=void 0===(t=t||{}).upgrade||!!t.upgrade;function r(e){var t;return n?-1!==["GPL-1.0","LGPL-1.0","AGPL-1.0","GPL-2.0","LGPL-2.0","AGPL-2.0","LGPL-2.1"].indexOf(t=e)?t+"-only":-1!==["GPL-1.0+","GPL-2.0+","GPL-3.0+","LGPL-2.0+","LGPL-2.1+","LGPL-3.0+","AGPL-1.0+","AGPL-3.0+"].indexOf(t)?t.replace(/\+$/,"-or-later"):-1!==["GPL-3.0","LGPL-3.0","AGPL-3.0"].indexOf(t)?t+"-or-later":t:e}if("string"!=typeof e||0===e.trim().length)throw Error("Invalid argument. Expected non-empty string.");if(o(e=e.trim()))return r(e);var i=e.replace(/\+$/,"").trim();if(o(i))return r(i);var a=f(e);return null!==a||null!==(a=h(e,function(e){return o(e)?e:f(e)}))||null!==(a=p(e))||null!==(a=h(e,p))?r(a):null}},477758,e=>{"use strict";var t=e.i(389959),n=e.i(994296);function r(e){return(0,t.useMemo)(function(){if(!e||e.length>40)return"Unknown License";var t=(0,n.default)(e,{upgrade:!1});return t||"Unknown License"},[e])}e.s(["default",()=>r])},102905,642714,e=>{"use strict";var t=e.i(297083),n=e.i(817556);function r(e){return null==e?void 0:e.replace(/^pkgs\./,"")}let i={name:"nix",getInstalledPackages:function(e){return(0,t._)(function(e){var t;return(0,n._)(this,function(n){switch(n.label){case 0:return[4,e.services.nixService.listPackages()];case 1:if(null!==(t=n.sent()).error)return[2,[]];return[2,t.packages.filter(function(e){return!!e.name}).map(function(e){return{name:e.name,version:e.version}})]}})}).apply(this,arguments)},getPackageInfo:function(e){return(0,t._)(function(e){var t,r;return(0,n._)(this,function(n){switch(n.label){case 0:return t=e.name,[4,e.services.nixService.packageInfo(t)];case 1:if(null!==(r=n.sent()).error)return[2,{}];return[2,r.package]}})}).apply(this,arguments)},search:function(e){return(0,t._)(function(e){var t,r,i,o;return(0,n._)(this,function(n){switch(n.label){case 0:return t=e.query,r=e.services.nixService,i=e.nixOpts,[4,r.searchPackages(t,i)];case 1:if(null!==(o=n.sent()).error)throw Error("Could not search Nix packages");return[2,o.packages.map(function(e){var t,n;return{name:e.name,version:e.version,description:e.description,homepageURL:null!=(t=e.homepageURL[0])?t:null,license:null!=(n=e.licenses[0])?n:null}})]}})}).apply(this,arguments)},install:function(e){return(0,t._)(function(e){var t,r,i;return(0,n._)(this,function(n){switch(n.label){case 0:return t=e.pkgs,r=e.services.nixService,i=t.filter(function(e){return null!=e.name}).map(function(e){return"pkgs.".concat(e.name)}),[4,r.addPackages(i)];case 1:return n.sent(),[2]}})}).apply(this,arguments)},uninstall:function(e){return(0,t._)(function(e){var t,r,i;return(0,n._)(this,function(n){switch(n.label){case 0:return t=e.pkgs,r=e.services.nixService,i=t.filter(function(e){return null!=e.name}).map(function(e){return"pkgs.".concat(e.name)}),[4,r.removePackages(i)];case 1:return n.sent(),[2]}})}).apply(this,arguments)}};e.s(["default",0,i,"normalizeNixPackageName",()=>r],642714);let o={name:"upm",getInstalledPackages:function(e){return(0,t._)(function(e){var t,r;return(0,n._)(this,function(n){switch(n.label){case 0:return t=e.id,[4,e.services.packager.listSpecfile(t)];case 1:if((r=n.sent()).error||null===r.packages)return[2,[]];return[2,r.packages]}})}).apply(this,arguments)},getPackageInfo:function(e){return(0,t._)(function(e){var t,r;return(0,n._)(this,function(n){return t=e.id,r=e.name,[2,e.services.packager.fetchPackageInfo(r,t)]})}).apply(this,arguments)},search:function(e){return(0,t._)(function(e){var t,r;return(0,n._)(this,function(n){return t=e.id,r=e.query,[2,e.services.packager.searchPackages(r,t)]})}).apply(this,arguments)},install:function(e){return(0,t._)(function(e){var t,r;return(0,n._)(this,function(n){switch(n.label){case 0:return t=e.id,r=e.pkgs,[4,e.services.packager.addPackages(r,t)];case 1:if(!n.sent())throw Error("Package install failed");return[2]}})}).apply(this,arguments)},uninstall:function(e){return(0,t._)(function(e){var t,r,i,o;return(0,n._)(this,function(n){switch(n.label){case 0:return t=e.id,r=e.pkgs,i=e.services.packager,o=r.filter(function(e){return e.name}).map(function(e){return e.name}),[4,i.removePackages(o,t)];case 1:if(!n.sent())throw Error("Package uninstall failed");return[2]}})}).apply(this,arguments)}};function a(e){return"nix"===e?i:o}e.s(["getPackager",()=>a],102905)},943695,e=>{"use strict";var t=e.i(530658),n=e.i(389959),r=e.i(541793),i=e.i(161322),o=e.i(719518);function a(){return(0,t._)((0,n.useState)(function(){return(0,r.createStore)()}),1)[0]}var s=(0,n.createContext)(null);function l(){var e=(0,n.useContext)(s);if(!e)throw Error("Expected store in context");return e}var u=function(e){return(0,i.useSetAtom)(e,{store:l()})},c=(0,r.atom)(null);function d(){return(0,i.useAtomValue)(c,{store:l()})}function f(){return(0,o.useAtomCallback)((0,n.useCallback)(function(e){return e(c)},[c]),{store:l()})}e.s(["PackagerContext",()=>s,"configAtom",()=>c,"useConfig",()=>d,"useGetConfig",()=>f,"useInitStore",()=>a,"useSet",()=>u])},919159,e=>{"use strict";var t=e.i(297083),n=e.i(530658),r=e.i(817556),i=e.i(389959),o=e.i(529810),a=e.i(102905),s=e.i(943695),l=new Map;function u(e){var u,c=(0,s.useConfig)(),d=(0,o.default)(),f=(0,n._)((0,i.useState)(null!=(u=l.get("".concat(null==c?void 0:c.id,":").concat(e.name)))?u:null),2),p=f[0],h=f[1];return(0,i.useEffect)(function(){if((null==c?void 0:c.id)&&e.name){var n=e.name;if(!l.has(n)){var i=(0,a.getPackager)(c.id),o=!1;return(0,t._)(function(){var e;return(0,r._)(this,function(t){switch(t.label){case 0:return[4,i.getPackageInfo({id:c.id,name:n,services:d})];case 1:if((e=t.sent())&&"string"!=typeof(null==e?void 0:e.homepageURL)&&delete e.homepageURL,o)return[2];return l.set("".concat(c.id,":").concat(n),null!=e?e:null),h(null!=e?e:null),[2]}})})(),function(){o=!0}}}},[null==c?void 0:c.id,e.name]),p}e.s(["default",()=>u])},465713,e=>{"use strict";var t=e.i(276385),n=e.i(943695);function r(e){var r=e.children,i=e.config,o=(0,n.useSet)(n.configAtom);return i.id&&o(i),(0,t.jsx)(t.Fragment,{children:r})}function i(e){var i=e.children,o=e.config,a=(0,n.useInitStore)();return(0,t.jsx)(n.PackagerContext.Provider,{value:a,children:o?(0,t.jsx)(r,{config:o,children:i}):i})}e.s(["default",()=>i])},595974,e=>{"use strict";var t,n,r=e.i(721281),i=e.i(878420),o=e.i(64386),a=e.i(530658),s=e.i(633600),l=e.i(389959),u=e.i(131141),c=e.i(541793),d=e.i(161322),f=e.i(719518),p=e.i(642714),h=((t={}).Uninitialized="Uninitialized",t.Initializing="Initializing",t.Installing="Installing",t.Uninstalling="Uninstalling",t.Idle="Idle",t),g=((n={}).Install="Install",n.Uninstall="Uninstall",n);function m(){return(0,a._)((0,l.useState)(function(){return(0,c.createStore)()}),1)[0]}var x=(0,l.createContext)(null);function y(){var e=(0,l.useContext)(x);if(!e)throw Error("Expected store in context");return e}var b=function(e){return(0,d.useSetAtom)(e,{store:y()})};function w(e){return(0,f.useAtomCallback)((0,l.useCallback)(function(t){return t(e)},[e]),{store:y()})}function k(e){return(0,d.useAtomValue)(e,{store:y()})}var _=(0,c.atom)({});function S(e){var t,n=k(_);return e&&null!=(t=n[e])?t:[]}function C(){var e=b(_);return function(t,n){e(function(e){return(0,u.produce)(e,function(e){var r=e[t];if(!r||0===r.length){e[t]=n;return}var i=!0,o=!1,a=void 0;try{for(var s,l=n[Symbol.iterator]();!(i=(s=l.next()).done);i=!0)!function(){var e=s.value;r.find(function(t){return t.name===e.name})||r.push(e)}()}catch(e){o=!0,a=e}finally{try{i||null==l.return||l.return()}finally{if(o)throw a}}})})}}function j(){var e=b(_);return function(t,n){e(function(e){return(0,u.produce)(e,function(e){var r=e[t];if(r&&0!==r.length){var i=!0,o=!1,a=void 0;try{for(var s,l=n[Symbol.iterator]();!(i=(s=l.next()).done);i=!0)!function(){var e=s.value,t=r.findIndex(function(t){return t.name===e.name});-1!==t&&r.splice(t,1)}()}catch(e){o=!0,a=e}finally{try{i||null==l.return||l.return()}finally{if(o)throw a}}}})})}}var T=(0,c.atom)({});function E(){var e=w(T);return function(t){var n;return null!=(n=e()[t])?n:null}}function R(){var e=b(T);return function(t,n){e(function(e){return(0,o._)((0,i._)({},e),(0,r._)({},t,n))})}}var I=(0,c.atom)(null);function A(){return k(I)}var P=(0,c.atom)([]);function D(){return k(P)}var O=(0,c.atom)({});function N(e){var t,n=k(O);return e&&null!=(t=n[e])?t:[]}function M(){var e=w(O);return function(t){var n;return null!=(n=e()[t])?n:[]}}function L(){var e=b(O);return function(t,n){e(function(e){return(0,o._)((0,i._)({},e),(0,r._)({},t,n.map(function(e){return"nix"===t?(0,o._)((0,i._)({},e),{name:(0,p.normalizeNixPackageName)(e.name)}):e})))})}}var B=(0,c.atom)(null,function(e,t,n){var r=n.id,i=n.pkg;if(!i.name)throw Error("Package does not have a name.");t(P,function(e){return(0,u.produce)(e,function(e){if(!e.find(function(e){return e.pkgs.find(function(t){return e.id===r&&t.name===i.name})})){var t=e.find(function(e){return"Install"===e.kind});t?t.pkgs.push(i):e.push({kind:"Install",id:r,pkgs:[i]})}})})});function V(){return b(B)}var F=(0,c.atom)(null,function(e,t,n){var r=n.id,i=n.pkg;if(!i.name)throw Error("Package does not have a name.");t(P,function(e){return(0,u.produce)(e,function(e){if(!e.find(function(e){return e.pkgs.find(function(t){return e.id===r&&t.name===i.name})})){var t=e.find(function(e){return"Uninstall"===e.kind});t?t.pkgs.push(i):e.push({kind:"Uninstall",id:r,pkgs:[i]})}})})});function U(){return b(F)}var G=(0,c.atom)(null,function(e,t,n){var r=(0,s._)(e(P)),i=r[0],o=r.slice(1);n===i&&(t(P,o),t(I,n))});function $(){return b(G)}var z=(0,c.atom)(null,function(e,t,n){t(P,function(e){return(0,u.produce)(e,function(e){var t=!0,r=!1,i=void 0;try{for(var o,a=e[Symbol.iterator]();!(t=(o=a.next()).done);t=!0){var s=o.value,l=s.pkgs.findIndex(function(e){return e.name===n});-1!==l&&s.pkgs.splice(l,1)}}catch(e){r=!0,i=e}finally{try{t||null==a.return||a.return()}finally{if(r)throw i}}})})});function H(){return b(z)}e.s(["GlobalPackagerContext",()=>x,"PackagerActionKind",()=>g,"PackagerStatus",()=>h,"actionQueueAtom",()=>P,"currentActionAtom",()=>I,"statusAtom",()=>T,"useActionQueue",()=>D,"useAddErrors",()=>C,"useCancelPackageAction",()=>H,"useCurrentAction",()=>A,"useErrors",()=>S,"useGet",()=>w,"useGetInstalledPackages",()=>M,"useGetStatus",()=>E,"useInitStore",()=>m,"useInstallPackage",()=>V,"useInstalledPackages",()=>N,"useRemoveErrors",()=>j,"useSet",()=>b,"useSetInstalledPackages",()=>L,"useSetStatus",()=>R,"useShiftActionQueue",()=>$,"useUninstallPackage",()=>U,"useValue",()=>k])},416086,e=>{"use strict";var t=e.i(297083),n=e.i(878420),r=e.i(64386),i=e.i(886513),o=e.i(530658),a=e.i(817556),s=e.i(276385),l=e.i(389959),u=e.i(338188),c=e.i(709485),d=e.i(399344),f=e.i(649960),p=e.i(858248),h=e.i(477758),g=e.i(919159),m=e.i(545453),x=e.i(465713),y=e.i(595974),b=e.i(943695),w=e.i(480028),k=e.i(446530),_=e.i(613355),S=e.i(965153),C=e.i(140487),j=e.i(136540),T=e.i(11235),E=(0,k.cssRecord)({shadow:{position:"absolute",transition:"opacity 0.1s ease-in-out",'&[data-position="top"], &[data-position="bottom"]':{left:0,right:0,height:12},'&[data-position="left"], &[data-position="right"]':{top:0,bottom:0,height:12},'&[data-position="top"]':{top:0,backgroundImage:"linear-gradient(to top, transparent, var(--shadow-color))"},'&[data-position="bottom"]':{bottom:0,backgroundImage:"linear-gradient(to bottom, transparent, var(--shadow-color))"},'&[data-position="left"]':{left:0,backgroundImage:"linear-gradient(to left, transparent, var(--shadow-color))"},'&[data-position="right"]':{right:0,backgroundImage:"linear-gradient(to right, transparent, var(--shadow-color))"}}});function R(e){var t=e.scrolledAmount,n=e.scrollableAmount,r=e.orientation,i=void 0===r?"vertical":r,o=e.hideEnd,a=e.shadowColor,l=void 0===a?"color-mix(in srgb, ".concat(w.tokens.backgroundDefault," 32%, transparent)"):a;return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{css:E.shadow,"data-position":"vertical"===i?"top":"left",style:{"--shadow-color":l,opacity:+(t>0)}}),!(void 0!==o&&o)&&(0,s.jsx)("div",{css:E.shadow,"data-position":"vertical"===i?"bottom":"right",style:{"--shadow-color":l,opacity:+(t<n)}})]})}var I=e.i(960178),A=e.i(751273),P=e.i(625484),D=e.i(243914),O=e.i(363201),N=e.i(634669),M=e.i(952030),L=e.i(703505),B=(0,k.cssRecord)({header:[_.rcss.height(36)],description:[_.rcss.flex.column,_.rcss.gap(8)],divider:[_.rcss.backgroundColor.outlineDimmer],package:[_.rcss.border({color:"transparent"}),_.rcss.justify.spaceBetween,{"&:hover":{backgroundColor:w.tokens.backgroundHighest}}],packageList:[_.rcss.height(220),_.rcss.overflowY("auto")],packageMetadata:[_.rcss.overflow("hidden"),_.rcss.mr(8)],packageName:[_.rcss.truncate,_.rcss.flex.growAndShrink(1),_.rcss.mx(8),{"> a":[_.rcss.ml(4),{color:"currentColor",lineHeight:0}]}],packagerRoot:[_.rcss.flex.column,_.rcss.gap(8)],packager:[_.rcss.backgroundColor.backgroundHigher,_.rcss.borderRadius(4),_.rcss.overflow("hidden")],packagerHeaderTitle:[_.rcss.truncate,_.rcss.flex.shrink(1)],packagerEmptyState:[_.rcss.backgroundColor.backgroundOverlay,_.rcss.borderRadius(0,0,4,4),_.rcss.color.foregroundDimmest],dividerInner:[_.rcss.p(0),_.rcss.m(0),{borderBottom:"1px solid",borderBottomColor:w.tokens.backgroundHighest}]});function V(e){var t=e.pkg,i=e.uninstall,o=(0,b.useConfig)(),a=(0,g.default)(t),u=(0,l.useMemo)(function(){var e=(null==a?void 0:a.description)||t.description;if(e&&/<[^>]+>|<\/[^>]+>/.test(e)){var n=document.createElement("DIV");return n.innerHTML=e,(n.textContent||n.innerText||"").trim()}return e},[null==a?void 0:a.description,t.description]),c=(0,h.default)((null==a?void 0:a.license)||t.license),d=(0,l.useMemo)(function(){if(a){var e;return(0,r._)((0,n._)({},a),{version:null!=(e=null==a?void 0:a.version)?e:t.spec,name:(null==o?void 0:o.id)==="nix"&&(null==a?void 0:a.prettyName)||t.name,license:c,description:u})}return t},[null==o?void 0:o.id,u,a,c,t]),f=(0,y.useActionQueue)(),p=(0,y.useCurrentAction)(),m=(0,l.useMemo)(function(){return f.some(function(e){return e.pkgs.some(function(e){return e.name===t.name})})},[t.name,f]),x=(0,l.useMemo)(function(){return!!(null!==p&&p.pkgs.find(function(e){return e.name===t.name}))},[p]);return(0,s.jsxs)(P.View,{css:B.package,p:4,row:!0,align:"center",tag:"li",children:[(0,s.jsxs)(P.View,{css:B.packageMetadata,grow:!0,shrink:!0,align:"center",row:!0,children:[(0,s.jsx)(N.default,{}),(0,s.jsxs)(I.Text,{css:B.packageName,children:[d.name,d.homepageURL?(0,s.jsx)("a",{href:d.homepageURL,target:"_blank",children:(0,s.jsx)(D.default,{})}):null]}),d.version?(0,s.jsx)(I.Text,{color:"dimmer",children:d.version}):null]}),(0,s.jsxs)(P.View,{css:[_.rcss.gap(4),_.rcss.align.center],row:!0,children:[d.description||d.license?(0,s.jsx)(A.Tooltip,{tooltip:(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{children:d.description}),d.license?(0,s.jsx)(I.Text,{variant:"small",color:"dimmer",children:d.license}):null]}),children:(0,s.jsx)(O.default,{})}):null,(0,s.jsx)(j.IconButton,{alt:"Uninstall",disabled:x||m,onClick:function(){i()},children:(0,s.jsx)(L.default,{})})]})]})}function F(e){var t=e.onAddPackage,n=e.name,r=e.id,i=e.addText;return(0,s.jsxs)(P.View,{grow:!0,shrink:!0,pl:4,row:!0,justify:"space-between",children:[(0,s.jsx)(I.Text,{css:B.packagerHeaderTitle,id:r,children:n}),(0,s.jsx)(j.IconButton,{alt:i,onClick:t,children:(0,s.jsx)(M.default,{})})]})}function U(e){var t=e.packages,n=e.labelId,r=(0,b.useConfig)(),i=(0,y.useUninstallPackage)(),a=(0,o._)((0,l.useState)(0),2),c=a[0],d=a[1],p=(0,o._)((0,l.useState)(0),2),h=p[0],g=p[1],m=(0,f.default)(function(e){return g(e.height)});return r?(0,s.jsx)(P.View,{css:_.rcss.position.relative,innerRef:m,children:(0,s.jsxs)(P.View,{css:B.packageList,onScroll:function(e){d(e.target.scrollTop)},children:[(0,s.jsx)(R,{scrolledAmount:c,scrollableAmount:34*t.length-h,hideEnd:!0}),(0,s.jsx)(u.VList,{style:{height:"100%"},role:"list","aria-labelledby":n,children:t.map(function(e){return(0,s.jsx)(V,{pkg:e,uninstall:function(){i({id:r.id,pkg:e})}},e.name)})})]})}):null}var G=new Map;function $(e){var n=e.onAddPackage,r=e.openFile,i=(0,b.useConfig)(),u=(0,y.useInstalledPackages)(null==i?void 0:i.id),f=(0,l.useMemo)(function(){return u.filter(function(e){return e.name}).sort(function(e,t){return e.name&&t.name?e.name.localeCompare(t.name):0})},[u]),h=(0,l.useId)(),g=(0,l.useCallback)(function(){n(null==i?void 0:i.id)},[n,null==i?void 0:i.id]),m=(null==i?void 0:i.id)==="nix",x=(0,l.useMemo)(function(){return null==i?void 0:i.packagerFiles.filter(function(e){return!e.includes("lock")&&!e.endsWith("/")})},[null==i?void 0:i.packagerFiles]),w=(0,d.useFsService)(),k=(0,o._)((0,l.useState)(i?G.get(i.id):void 0),2),_=k[0],j=k[1];return((0,l.useEffect)(function(){(0,t._)(function(){var e,t,n,r,o,s,l;return(0,a._)(this,function(a){switch(a.label){case 0:if(!x||!i)return[2];e=!0,t=!1,n=void 0,a.label=1;case 1:a.trys.push([1,6,7,8]),r=x[Symbol.iterator](),a.label=2;case 2:if(e=(o=r.next()).done)return[3,5];return s=o.value,[4,w.readFile(s)];case 3:if("content"in a.sent())return G.set(i.id,s),j(s),[3,5];a.label=4;case 4:return e=!0,[3,2];case 5:return[3,8];case 6:return l=a.sent(),t=!0,n=l,[3,8];case 7:try{e||null==r.return||r.return()}finally{if(t)throw n}return[7];case 8:return[2]}})})()},[i,w,x]),i)?(0,s.jsxs)(P.View,{css:B.packagerRoot,children:[(0,s.jsx)(P.View,{css:B.packager,children:(0,s.jsx)(S.AccordionItem,{defaultExpanded:!0,headerContent:(0,s.jsx)(F,{id:h,name:i.name,addText:m?"Add new dependency":"Add new package",onAddPackage:g}),children:(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(W,{css:B.divider}),f.length>0?(0,s.jsx)(U,{packages:f,labelId:h}):(0,s.jsx)(P.View,{css:B.packagerEmptyState,p:8,align:"center",children:m?"No dependencies found":"No packages found"})]})})}),(0,s.jsx)(C.Button,{colorway:"primary",variant:"outlined",text:m?"Add new dependency":"Add new package",iconLeft:(0,s.jsx)(M.default,{}),onClick:g}),_?(0,s.jsx)(C.Button,{variant:"nofill",text:"Open ".concat(_),iconLeft:(0,s.jsx)(N.default,{}),onClick:function(){(0,p.track)(c.events.DEPENDENCIES_PACKAGER_FILE_OPENED,{packagerId:i.id,file:_}),r({path:_})}}):null]}):null}function z(e){var t=e.configs,r=e.description,o=e.title,a=e.openFile,l=(0,i._)(e,["configs","description","title","openFile"]);return(0,s.jsxs)(P.View,{children:[(0,s.jsx)(P.View,{css:B.header,row:!0,justify:"space-between",children:(0,s.jsx)(I.Header,{variant:"subheadDefault",level:2,children:o})}),(0,s.jsxs)(P.View,{gap:8,children:[(0,s.jsx)(T.Prose,{color:"dimmer",css:B.description,children:r}),t.length>0?t.map(function(e){return(0,s.jsx)(x.default,{config:e,children:(0,s.jsx)($,(0,n._)({openFile:a},l))},e.id)}):null]})]})}function H(e){var t=(0,m.usePackagerConfigs)().configs,i=(0,l.useMemo)(function(){return t.find(function(e){return"nix"===e.id})},[t]);return i?(0,s.jsx)(z,(0,r._)((0,n._)({title:"System Dependencies",description:(0,s.jsxs)("span",{children:["Add additional support to your environment with"," ",(0,s.jsx)("a",{href:"https://search.nixos.org/packages",target:"_blank",children:"Nix packages"}),"."]})},e),{configs:[i]})):null}var W=function(){return(0,s.jsx)("div",{css:B.dividerInner})};e.s(["NixPackager",()=>H,"PackagerSection",()=>z],416086)},539143,(e,t,n)=>{var r,i=e.i(33699),o=e.r(561584),a=e.r(365738);t.exports=(void 0===i.default?"undefined":a._(i.default))==="object"&&i.default.env&&i.default.env.NODE_DEBUG&&/\bsemver\b/i.test(i.default.env.NODE_DEBUG)?function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return(r=console).error.apply(r,["SEMVER"].concat(o._(t)))}:function(){}},511234,(e,t,n)=>{t.exports={MAX_LENGTH:256,MAX_SAFE_COMPONENT_LENGTH:16,MAX_SAFE_BUILD_LENGTH:250,MAX_SAFE_INTEGER:Number.MAX_SAFE_INTEGER||0x1fffffffffffff,RELEASE_TYPES:["major","premajor","minor","preminor","patch","prepatch","prerelease"],SEMVER_SPEC_VERSION:"2.0.0",FLAG_INCLUDE_PRERELEASE:1,FLAG_LOOSE:2}},308145,(e,t,n)=>{var r=e.r(316330),i=e.r(511234),o=i.MAX_SAFE_COMPONENT_LENGTH,a=i.MAX_SAFE_BUILD_LENGTH,s=i.MAX_LENGTH,l=e.r(539143),u=(n=t.exports={}).re=[],c=n.safeRe=[],d=n.src=[],f=n.t={},p=0,h="[a-zA-Z0-9-]",g=[["\\s",1],["\\d",s],[h,a]],m=function(e){var t=!0,n=!1,i=void 0;try{for(var o,a=g[Symbol.iterator]();!(t=(o=a.next()).done);t=!0){var s=r._(o.value,2),l=s[0],u=s[1];e=e.split("".concat(l,"*")).join("".concat(l,"{0,").concat(u,"}")).split("".concat(l,"+")).join("".concat(l,"{1,").concat(u,"}"))}}catch(e){n=!0,i=e}finally{try{t||null==a.return||a.return()}finally{if(n)throw i}}return e},x=function(e,t,n){var r=m(t),i=p++;l(e,i,t),f[e]=i,d[i]=t,u[i]=new RegExp(t,n?"g":void 0),c[i]=new RegExp(r,n?"g":void 0)};x("NUMERICIDENTIFIER","0|[1-9]\\d*"),x("NUMERICIDENTIFIERLOOSE","\\d+"),x("NONNUMERICIDENTIFIER","\\d*[a-zA-Z-]".concat(h,"*")),x("MAINVERSION","(".concat(d[f.NUMERICIDENTIFIER],")\\.")+"(".concat(d[f.NUMERICIDENTIFIER],")\\.")+"(".concat(d[f.NUMERICIDENTIFIER],")")),x("MAINVERSIONLOOSE","(".concat(d[f.NUMERICIDENTIFIERLOOSE],")\\.")+"(".concat(d[f.NUMERICIDENTIFIERLOOSE],")\\.")+"(".concat(d[f.NUMERICIDENTIFIERLOOSE],")")),x("PRERELEASEIDENTIFIER","(?:".concat(d[f.NUMERICIDENTIFIER],"|").concat(d[f.NONNUMERICIDENTIFIER],")")),x("PRERELEASEIDENTIFIERLOOSE","(?:".concat(d[f.NUMERICIDENTIFIERLOOSE],"|").concat(d[f.NONNUMERICIDENTIFIER],")")),x("PRERELEASE","(?:-(".concat(d[f.PRERELEASEIDENTIFIER],"(?:\\.").concat(d[f.PRERELEASEIDENTIFIER],")*))")),x("PRERELEASELOOSE","(?:-?(".concat(d[f.PRERELEASEIDENTIFIERLOOSE],"(?:\\.").concat(d[f.PRERELEASEIDENTIFIERLOOSE],")*))")),x("BUILDIDENTIFIER","".concat(h,"+")),x("BUILD","(?:\\+(".concat(d[f.BUILDIDENTIFIER],"(?:\\.").concat(d[f.BUILDIDENTIFIER],")*))")),x("FULLPLAIN","v?".concat(d[f.MAINVERSION]).concat(d[f.PRERELEASE],"?").concat(d[f.BUILD],"?")),x("FULL","^".concat(d[f.FULLPLAIN],"$")),x("LOOSEPLAIN","[v=\\s]*".concat(d[f.MAINVERSIONLOOSE]).concat(d[f.PRERELEASELOOSE],"?").concat(d[f.BUILD],"?")),x("LOOSE","^".concat(d[f.LOOSEPLAIN],"$")),x("GTLT","((?:<|>)?=?)"),x("XRANGEIDENTIFIERLOOSE","".concat(d[f.NUMERICIDENTIFIERLOOSE],"|x|X|\\*")),x("XRANGEIDENTIFIER","".concat(d[f.NUMERICIDENTIFIER],"|x|X|\\*")),x("XRANGEPLAIN","[v=\\s]*(".concat(d[f.XRANGEIDENTIFIER],")")+"(?:\\.(".concat(d[f.XRANGEIDENTIFIER],")")+"(?:\\.(".concat(d[f.XRANGEIDENTIFIER],")")+"(?:".concat(d[f.PRERELEASE],")?").concat(d[f.BUILD],"?")+")?)?"),x("XRANGEPLAINLOOSE","[v=\\s]*(".concat(d[f.XRANGEIDENTIFIERLOOSE],")")+"(?:\\.(".concat(d[f.XRANGEIDENTIFIERLOOSE],")")+"(?:\\.(".concat(d[f.XRANGEIDENTIFIERLOOSE],")")+"(?:".concat(d[f.PRERELEASELOOSE],")?").concat(d[f.BUILD],"?")+")?)?"),x("XRANGE","^".concat(d[f.GTLT],"\\s*").concat(d[f.XRANGEPLAIN],"$")),x("XRANGELOOSE","^".concat(d[f.GTLT],"\\s*").concat(d[f.XRANGEPLAINLOOSE],"$")),x("COERCE","".concat("(^|[^\\d])(\\d{1,").concat(o,"})")+"(?:\\.(\\d{1,".concat(o,"}))?")+"(?:\\.(\\d{1,".concat(o,"}))?")+"(?:$|[^\\d])"),x("COERCERTL",d[f.COERCE],!0),x("LONETILDE","(?:~>?)"),x("TILDETRIM","(\\s*)".concat(d[f.LONETILDE],"\\s+"),!0),n.tildeTrimReplace="$1~",x("TILDE","^".concat(d[f.LONETILDE]).concat(d[f.XRANGEPLAIN],"$")),x("TILDELOOSE","^".concat(d[f.LONETILDE]).concat(d[f.XRANGEPLAINLOOSE],"$")),x("LONECARET","(?:\\^)"),x("CARETTRIM","(\\s*)".concat(d[f.LONECARET],"\\s+"),!0),n.caretTrimReplace="$1^",x("CARET","^".concat(d[f.LONECARET]).concat(d[f.XRANGEPLAIN],"$")),x("CARETLOOSE","^".concat(d[f.LONECARET]).concat(d[f.XRANGEPLAINLOOSE],"$")),x("COMPARATORLOOSE","^".concat(d[f.GTLT],"\\s*(").concat(d[f.LOOSEPLAIN],")$|^$")),x("COMPARATOR","^".concat(d[f.GTLT],"\\s*(").concat(d[f.FULLPLAIN],")$|^$")),x("COMPARATORTRIM","(\\s*)".concat(d[f.GTLT],"\\s*(").concat(d[f.LOOSEPLAIN],"|").concat(d[f.XRANGEPLAIN],")"),!0),n.comparatorTrimReplace="$1$2$3",x("HYPHENRANGE","^\\s*(".concat(d[f.XRANGEPLAIN],")")+"\\s+-\\s+"+"(".concat(d[f.XRANGEPLAIN],")")+"\\s*$"),x("HYPHENRANGELOOSE","^\\s*(".concat(d[f.XRANGEPLAINLOOSE],")")+"\\s+-\\s+"+"(".concat(d[f.XRANGEPLAINLOOSE],")")+"\\s*$"),x("STAR","(<|>)?=?\\s*\\*"),x("GTE0","^\\s*>=\\s*0\\.0\\.0\\s*$"),x("GTE0PRE","^\\s*>=\\s*0\\.0\\.0-0\\s*$")},169781,(e,t,n)=>{var r=e.r(365738),i=Object.freeze({loose:!0}),o=Object.freeze({});t.exports=function(e){return e?(void 0===e?"undefined":r._(e))!=="object"?i:e:o}},430622,(e,t,n)=>{var r=/^[0-9]+$/,i=function(e,t){var n=r.test(e),i=r.test(t);return n&&i&&(e*=1,t*=1),e===t?0:n&&!i?-1:i&&!n?1:e<t?-1:1};t.exports={compareIdentifiers:i,rcompareIdentifiers:function(e,t){return i(t,e)}}},769627,(e,t,n)=>{var r=e.r(883735),i=e.r(619314),o=e.r(954546),a=e.r(365738),s=e.r(539143),l=e.r(511234),u=l.MAX_LENGTH,c=l.MAX_SAFE_INTEGER,d=e.r(308145),f=d.safeRe,p=d.t,h=e.r(169781),g=e.r(430622).compareIdentifiers;t.exports=function(){"use strict";function e(t,n){if(r._(this,e),n=h(n),o._(t,e))if(!!n.loose===t.loose&&!!n.includePrerelease===t.includePrerelease)return t;else t=t.version;else if("string"!=typeof t)throw TypeError('Invalid version. Must be a string. Got type "'.concat(void 0===t?"undefined":a._(t),'".'));if(t.length>u)throw TypeError("version is longer than ".concat(u," characters"));s("SemVer",t,n),this.options=n,this.loose=!!n.loose,this.includePrerelease=!!n.includePrerelease;var i=t.trim().match(n.loose?f[p.LOOSE]:f[p.FULL]);if(!i)throw TypeError("Invalid Version: ".concat(t));if(this.raw=t,this.major=+i[1],this.minor=+i[2],this.patch=+i[3],this.major>c||this.major<0)throw TypeError("Invalid major version");if(this.minor>c||this.minor<0)throw TypeError("Invalid minor version");if(this.patch>c||this.patch<0)throw TypeError("Invalid patch version");i[4]?this.prerelease=i[4].split(".").map(function(e){if(/^[0-9]+$/.test(e)){var t=+e;if(t>=0&&t<c)return t}return e}):this.prerelease=[],this.build=i[5]?i[5].split("."):[],this.format()}return i._(e,[{key:"format",value:function(){return this.version="".concat(this.major,".").concat(this.minor,".").concat(this.patch),this.prerelease.length&&(this.version+="-".concat(this.prerelease.join("."))),this.version}},{key:"toString",value:function(){return this.version}},{key:"compare",value:function(t){if(s("SemVer.compare",this.version,this.options,t),!o._(t,e)){if("string"==typeof t&&t===this.version)return 0;t=new e(t,this.options)}return t.version===this.version?0:this.compareMain(t)||this.comparePre(t)}},{key:"compareMain",value:function(t){return o._(t,e)||(t=new e(t,this.options)),g(this.major,t.major)||g(this.minor,t.minor)||g(this.patch,t.patch)}},{key:"comparePre",value:function(t){if(o._(t,e)||(t=new e(t,this.options)),this.prerelease.length&&!t.prerelease.length)return -1;if(!this.prerelease.length&&t.prerelease.length)return 1;if(!this.prerelease.length&&!t.prerelease.length)return 0;var n=0;do{var r=this.prerelease[n],i=t.prerelease[n];if(s("prerelease compare",n,r,i),void 0===r&&void 0===i)return 0;if(void 0===i)return 1;if(void 0===r)return -1;else if(r===i)continue;else return g(r,i)}while(++n)}},{key:"compareBuild",value:function(t){o._(t,e)||(t=new e(t,this.options));var n=0;do{var r=this.build[n],i=t.build[n];if(s("prerelease compare",n,r,i),void 0===r&&void 0===i)return 0;if(void 0===i)return 1;if(void 0===r)return -1;else if(r===i)continue;else return g(r,i)}while(++n)}},{key:"inc",value:function(e,t,n){switch(e){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",t,n);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",t,n);break;case"prepatch":this.prerelease.length=0,this.inc("patch",t,n),this.inc("pre",t,n);break;case"prerelease":0===this.prerelease.length&&this.inc("patch",t,n),this.inc("pre",t,n);break;case"major":(0!==this.minor||0!==this.patch||0===this.prerelease.length)&&this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":(0!==this.patch||0===this.prerelease.length)&&this.minor++,this.patch=0,this.prerelease=[];break;case"patch":0===this.prerelease.length&&this.patch++,this.prerelease=[];break;case"pre":var r=+!!Number(n);if(!t&&!1===n)throw Error("invalid increment argument: identifier is empty");if(0===this.prerelease.length)this.prerelease=[r];else{for(var i=this.prerelease.length;--i>=0;)"number"==typeof this.prerelease[i]&&(this.prerelease[i]++,i=-2);if(-1===i){if(t===this.prerelease.join(".")&&!1===n)throw Error("invalid increment argument: identifier already exists");this.prerelease.push(r)}}if(t){var o=[t,r];!1===n&&(o=[t]),0===g(this.prerelease[0],t)?isNaN(this.prerelease[1])&&(this.prerelease=o):this.prerelease=o}break;default:throw Error("invalid increment argument: ".concat(e))}return this.raw=this.format(),this.build.length&&(this.raw+="+".concat(this.build.join("."))),this}}]),e}()},499116,(e,t,n)=>{var r=e.r(769627);t.exports=function(e,t,n){return new r(e,n).compare(new r(t,n))}},483776,(e,t,n)=>{var r=e.r(499116);t.exports=function(e,t,n){return r(e,t,n)>0}},790951,(e,t,n)=>{var r=e.r(954546),i=e.r(769627);t.exports=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(r._(e,i))return e;try{return new i(e,t)}catch(e){if(!n)return null;throw e}}},182435,(e,t,n)=>{var r=e.r(790951);t.exports=function(e,t){var n=r(e,t);return n?n.version:null}},691056,e=>{"use strict";var t=e.i(389959);e.s(["default",0,function(e,n,r){(0,t.useEffect)(function(){var t=setTimeout(e,r);return function(){clearTimeout(t)}},n)}])},241828,608738,e=>{"use strict";var t=e.i(297083),n=e.i(817556),r=e.i(761732),i=e.i(664152),o=e.i(529810);function a(){var e=(0,o.default)().toolchain;return{modules:(0,r.default)(e.modules),configs:(0,r.default)(e.configs),moduleConfig:(0,r.default)(e.moduleConfig),setModuleConfig:function(r){return(0,t._)(function(){return(0,n._)(this,function(t){return[2,e.setModuleConfig(r)]})})()},addModule:function(r){return(0,t._)(function(){return(0,n._)(this,function(t){switch(t.label){case 0:return[4,e.addModule(r).catch(function(e){i.logger.error("Toolchain: failed to add Nix module: "+e.message)})];case 1:return t.sent(),[2]}})})()},removeModule:function(r){return(0,t._)(function(){return(0,n._)(this,function(t){switch(t.label){case 0:return[4,e.removeModule(r).catch(function(e){i.logger.error("Toolchain: failed to remove Nix module: "+e.message)})];case 1:return t.sent(),[2]}})})()},upgradeModule:function(r,o){return(0,t._)(function(){return(0,n._)(this,function(t){switch(t.label){case 0:return[4,e.upgradeModule(r,o).catch(function(e){i.logger.error("Toolchain: failed to upgrade Nix module: "+e.message)})];case 1:return t.sent(),[2]}})})()}}}e.s(["useNixModules",()=>a],241828);var s=e.i(530658),l=e.i(389959),u=e.i(790155);function c(){var e=(0,o.default)().toolchain,t=(0,s._)((0,l.useState)(null),2),n=t[0],r=t[1];return(0,l.useEffect)(function(){var t=!1;return e.getRegistry().then(function(e){t||r(e)}).catch(function(e){u.logger.error("Toolchain: failed to get module registry: ".concat(e.message))}),function(){t=!0}},[e]),n}e.s(["default",()=>c],608738)},795122,e=>{"use strict";var t=e.i(530658),n=e.i(346715),r=e.i(276385),i=e.i(389959),o=e.i(241828),a=e.i(858248),s=e.i(709485),l=e.i(646982),u=e.i(446530),c=e.i(613355),d=e.i(965153),f=e.i(988676),p=e.i(136540),h=e.i(929872),g=e.i(960178),m=e.i(751273),x=e.i(625484),y=e.i(757390),b=e.i(363201),w=e.i(940745),k=e.i(703505),_=(0,u.cssRecord)({module:[c.rcss.borderRadius(4),c.rcss.width("100%"),c.rcss.overflow("hidden")],submoduleName:[c.rcss.truncate,c.rcss.mx(8),c.rcss.flex.growAndShrink(1)],moduleActions:[c.rcss.center],divider:[c.rcss.backgroundColor.outlineDimmer]});function S(e){var t=e.isModifying,n=e.isInstalled,i=e.onInstallClick,o=e.onRemoveClick,a=e.module;if(t)return(0,r.jsx)(p.IconButton,{alt:"Updating module",tooltipBehavior:"hidden",children:(0,r.jsx)(w.default,{})});if(n){var s="replit"===a.id;return(0,r.jsx)(p.IconButton,{alt:s?"The base module can't be removed":"Remove module",disabled:s,onClick:o,children:(0,r.jsx)(k.default,{})})}return(0,r.jsx)(p.IconButton,{alt:"Add module",onClick:i,children:(0,r.jsx)(y.default,{})})}function C(e){var n=e.module,l=e.isInstalled,u=(0,o.useNixModules)(),c=u.addModule,d=u.removeModule,f=(0,t._)((0,i.useState)(!1),2),p=f[0],h=f[1];return(0,i.useEffect)(function(){h(!1)},[l]),(0,r.jsxs)(x.View,{grow:!0,shrink:!0,row:!0,justify:"space-between",children:[(0,r.jsxs)(x.View,{row:!0,gap:12,children:[(0,r.jsx)(g.Text,{children:n.name}),n.displayVersion?(0,r.jsx)(g.Text,{color:"dimmer",children:n.displayVersion}):null]}),(0,r.jsxs)(x.View,{css:_.moduleActions,row:!0,gap:4,children:[n.description?(0,r.jsx)(m.Tooltip,{tooltip:n.description,children:(0,r.jsx)(b.default,{})}):null,(0,r.jsx)(S,{module:n,isInstalled:l,isModifying:p,onInstallClick:function(){h(!0),c(n.id),(0,a.track)(s.events.NIX_MODULE,{action:"added",moduleId:n.id})},onRemoveClick:function(){h(!0),d(n.id),(0,a.track)(s.events.NIX_MODULE,{action:"removed",moduleId:n.id})}})]})]})}function j(e){var t=e.module,i=e.defaultExpanded,o=e.isInstalled,a=(0,n._)(t.runners).concat((0,n._)(t.packagers),(0,n._)(t.formatters),(0,n._)(t.languageServers));return(0,r.jsx)(h.Surface,{elevated:!0,css:_.module,children:(0,r.jsxs)(d.AccordionItem,{round:!1,defaultExpanded:i,headerContent:(0,r.jsx)(C,{module:t,isInstalled:o}),children:[a.length>0?(0,r.jsx)(f.DividerH,{css:_.divider}):null,a.map(function(e){return(0,r.jsxs)(x.View,{p:4,row:!0,align:"center",children:[(0,r.jsx)(l.default,{module:e}),(0,r.jsx)(g.Text,{css:_.submoduleName,children:e.name}),e.displayVersion?(0,r.jsx)(g.Text,{color:"dimmer",children:e.displayVersion}):null]},e.id)})]})})}e.s(["default",()=>j])},227980,161777,117710,e=>{"use strict";var t=e.i(276385),n=e.i(446530),r=e.i(613355),i=e.i(625484),o=e.i(940745),a=(0,n.cssRecord)({overviewPane:[r.rcss.flex.column,r.rcss.gap(24),r.rcss.width("100%"),r.rcss.maxWidth(600),{margin:"0 auto"}],loading:[r.rcss.center,r.rcss.flex.growAndShrink(1)],emptyState:[r.rcss.center,r.rcss.flex.growAndShrink(1)]}),s=function(){return(0,t.jsx)(i.View,{css:a.loading,children:(0,t.jsx)(o.default,{})})},l=function(e){var n=e.children;return(0,t.jsx)(i.View,{css:a.emptyState,children:n})},u=function(e){var n=e.children;return(0,t.jsx)(i.View,{css:a.overviewPane,p:12,children:n})};e.s(["EmptyState",()=>l,"LoadingState",()=>s,"MAX_PANE_CONTENT_WIDTH",()=>600,"OverviewPane",()=>u],227980);var c=/(.+)(?:\S+)?<([^>,]+)[>,]/,d=i.SpecializedView.span;function f(e){var n=e.author,r=c.exec(n);if(r){var i=r[1],o=r[2];return(0,t.jsxs)(t.Fragment,{children:["By ",i,(0,t.jsxs)("a",{href:"mailto:".concat(o),children:["<",o,">"]})]})}return(0,t.jsxs)(d,{children:["By ",n]})}e.s(["default",()=>f],161777);var p=e.i(993134),h=e.i(757390),g=e.i(703505);function m(e){var n=e.isInstalled,r=e.isInQueue;return e.isCurrentAction?(0,t.jsx)(o.default,{}):r?(0,t.jsx)(p.default,{}):n?(0,t.jsx)(g.default,{}):(0,t.jsx)(h.default,{})}e.s(["default",()=>m],117710)},838322,886080,e=>{"use strict";var t=e.i(530658),n=e.i(276385),r=e.i(389959),i=e.i(161777),o=e.i(117710),a=e.i(477758),s=e.i(595974),l=e.i(943695),u=e.i(480028),c=e.i(446530),d=e.i(6338),f=e.i(613355),p=e.i(140487),h=e.i(136540),g=e.i(396776),m=e.i(929872),x=e.i(960178),y=e.i(625484),b=e.i(782096),w=e.i(476891),k=e.i(42458),_=y.SpecializedView.span,S=(0,c.cssRecord)({metadataSkeletonVersion:[d.loadingStyle.foregroundPulse(),f.rcss.height(16),f.rcss.maxWidth(64),f.rcss.borderRadius(4)],metadataSkeletonDescription:[d.loadingStyle.foregroundPulse(),f.rcss.height(16),f.rcss.borderRadius(4),f.rcss.maxWidth(425)],root:[f.rcss.borderRadius(8),f.rcss.p(8)],headerTitle:[f.rcss.display.flex,f.rcss.rowWithGap(8),f.rcss.flex.growAndShrink(1)],headerTitleText:[f.rcss.display.inline,f.rcss.flex.growAndShrink(1),f.rcss.overflow("hidden"),f.rcss.truncate],headerTitlePills:[f.rcss.display.inlineFlex,f.rcss.rowWithGap(4),f.rcss.flex.shrink(0)],headerButton:[],error:[f.rcss.mt(4)],actions:[f.rcss.mt(8)],consoleButton:[f.rcss.width("calc(50% - ".concat(u.tokens.space8,")"))],cancelButton:[f.rcss.width("calc(50% - ".concat(u.tokens.space8,")"))],actionButton:[f.rcss.flex.grow(1),f.rcss.flex.shrink(0)]});function C(e){var t=e.title,r=e.content,i=e.isExpanded;return(0,n.jsxs)(y.View,{gap:2,children:[t?(0,n.jsx)(x.Text,{color:"dimmer",children:t}):null,r?(0,n.jsx)(x.Text,{maxLines:i?void 0:1,children:r}):null]})}function j(e){var t=e.title,r=e.content;return(0,n.jsxs)(y.View,{pt:4,gap:8,children:[void 0===t||t?(0,n.jsx)(y.View,{css:S.metadataSkeletonVersion}):null,void 0===r||r?(0,n.jsx)(y.View,{css:S.metadataSkeletonDescription}):null]})}function T(e){var u,c=e.name,d=e.pkg,f=e.isMetadataLoading,T=e.openConsole,E=e.pills,R=(0,l.useConfig)(),I=(0,s.useInstalledPackages)(null==R?void 0:R.id),A=(0,s.useErrors)(null==R?void 0:R.id),P=(0,s.useCurrentAction)(),D=(0,s.useActionQueue)(),O=(0,s.useRemoveErrors)(),N=(0,a.default)(d.license),M=(0,r.useMemo)(function(){return!!(null!==P&&P.pkgs.find(function(e){return e.name===d.name}))},[P]),L=(0,r.useMemo)(function(){return D.find(function(e){return e.pkgs.find(function(e){return e.name===d.name})})},[D]),B=D.length>1&&!!L,V=(0,r.useMemo)(function(){return!!I.find(function(e){var t,n;return(null==(t=e.name)?void 0:t.toLowerCase())===(null==(n=d.name)?void 0:n.toLowerCase())})},[I]),F=!!(d.homepageURL||d.license||d.author),U=(0,r.useMemo)(function(){return!!A.find(function(e){return e.name===d.name})},[A]),G=(0,t._)((0,r.useState)(!1),2),$=G[0],z=G[1],H=(0,s.useInstallPackage)(),W=(0,s.useUninstallPackage)(),q=(0,s.useCancelPackageAction)();return(0,n.jsxs)(m.Surface,{css:S.root,elevated:!0,children:[(0,n.jsxs)(y.View,{row:!0,justify:"space-between",children:[(0,n.jsxs)(x.Header,{css:S.headerTitle,level:2,variant:"subheadDefault",multiline:!1,children:[(0,n.jsxs)(_,{css:S.headerTitleText,children:[null!=c?c:d.name,d.version?(0,n.jsxs)(x.Text,{color:"dimmer",children:["@",d.version]}):null]}),E?(0,n.jsx)(y.View,{css:S.headerTitlePills,children:E}):null]}),F?(0,n.jsx)(h.IconButton,{css:S.headerButton,alt:"Show more info",tooltipBehavior:"hidden",onClick:function(){return z(function(e){return!e})},children:(0,n.jsx)(b.default,{rotate:90*!!$})}):null]}),(0,n.jsx)(y.View,{gap:4,children:void 0!==f&&f?(0,n.jsx)(j,{title:!1}):(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(C,{content:null!=(u=d.description)?u:"This package has no description.",isExpanded:!0}),d.homepageURL&&$?(0,n.jsx)(C,{content:(0,n.jsx)("a",{href:d.homepageURL,rel:"noreferrer noopener",target:"_blank",children:d.homepageURL}),isExpanded:$}):null,N&&$?(0,n.jsx)(C,{content:N,isExpanded:$}):null,d.author&&$?(0,n.jsx)(C,{content:(0,n.jsx)(i.default,{author:d.author}),isExpanded:$}):null]})}),U?(0,n.jsx)(g.StatusBanner,{css:S.error,colorway:"negative",icon:(0,n.jsx)(k.default,{}),text:"Couldn't ".concat(V?"uninstall":"install"," package. See Console for details, or try again.")}):null,(0,n.jsx)(y.View,{css:S.actions,row:!0,gap:8,children:U?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(p.Button,{css:S.consoleButton,text:"Console",onClick:function(){T()},disabled:M||B,colorway:"primary",iconLeft:(0,n.jsx)(w.default,{})}),(0,n.jsx)(p.Button,{css:S.actionButton,text:"Try Again",onClick:function(){(null==R?void 0:R.id)&&(O(R.id,[d]),V?W({id:R.id,pkg:d}):H({id:R.id,pkg:d}))},loading:M||B,colorway:V?"red":void 0,variant:V?"outlined":void 0,iconLeft:(0,n.jsx)(o.default,{isInstalled:V,isInQueue:B,isCurrentAction:M})})]}):(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(p.Button,{css:S.actionButton,text:M?(null==P?void 0:P.kind)===s.PackagerActionKind.Install?"Installing":"Removing":B?(null==L?void 0:L.kind)===s.PackagerActionKind.Install?"Waiting to install":"Waiting to remove":V?"Remove":"Install",onClick:function(){(null==R?void 0:R.id)&&(V?W({id:R.id,pkg:d}):H({id:R.id,pkg:d}))},loading:M||B,colorway:V?"red":void 0,variant:V?"outlined":void 0,iconLeft:(0,n.jsx)(o.default,{isInstalled:V,isInQueue:B,isCurrentAction:M})}),B?(0,n.jsx)(p.Button,{css:S.cancelButton,text:"Cancel",onClick:function(){d.name&&q(d.name)},disabled:M,loading:M}):null]})})]})}e.s(["default",()=>T],838322);var E=e.i(878420),R=e.i(529810),I=e.i(102905);function A(){var e=(0,R.default)(),t=(0,l.useGetConfig)();return(0,r.useCallback)(function(n){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=t();return(null==i?void 0:i.id)?(0,I.getPackager)(i.id).search((0,E._)({id:i.id,query:n,services:e},r)):[]},[])}e.s(["default",()=>A],886080)},271112,e=>{"use strict";var t=e.i(297083),n=e.i(878420),r=e.i(64386),i=e.i(886513),o=e.i(530658),a=e.i(817556),s=e.i(276385),l=e.i(389959),u=e.i(415756),c=e.i(483776),d=e.i(182435),f=e.i(709485),p=e.i(691056),h=e.i(241828),g=e.i(142365),m=e.i(608738),x=e.i(795122),y=e.i(227980),b=e.i(838322),w=e.i(545453),k=e.i(886080),_=e.i(465713),S=e.i(480028),C=e.i(446530),j=e.i(613355),T=e.i(136540),E=e.i(85742),R=e.i(624782),I=e.i(51054),A=e.i(12034),P=e.i(751273),D=e.i(625484),O=e.i(352767),N=e.i(422908),M=(0,C.cssRecord)({root:[j.rcss.flex.column,j.rcss.flex.growAndShrink(1)],headerRoot:[j.rcss.border({color:S.tokens.outlineDimmest,width:1,direction:"bottom"})],header:[j.rcss.width("100%"),j.rcss.maxWidth(y.MAX_PANE_CONTENT_WIDTH),j.rcss.colWithGap(8),j.rcss.p(8),{margin:"0 auto"},j.rcss.rowWithGap(8),j.rcss.p(8),j.rcss.align.center],select:[j.rcss.minWidth(160)],resultsRoot:[j.rcss.overflow("auto")],resultsScroller:[j.rcss.width("100%"),j.rcss.maxWidth(600),j.rcss.flex.growAndShrink(1),j.rcss.p(8),{margin:"0 auto"},j.rcss.overflow("auto")]});function L(e){var n=e.query,r=e.openConsole,i=e.computePills,u=(0,o._)((0,l.useState)([]),2),c=u[0],d=u[1],f=(0,l.useRef)(0),h=(0,o._)((0,l.useState)(!1),2),g=h[0],m=h[1],x=(0,k.default)();return((0,l.useEffect)(function(){""===n.trim()?d([]):m(!0)},[n]),(0,p.default)(function(){var e=++f.current;(0,t._)(function(){var t;return(0,a._)(this,function(r){switch(r.label){case 0:return[4,x(n)];case 1:return t=r.sent(),e===f.current&&(d(t),m(!1)),[2]}})})()},[n],500),g)?(0,s.jsx)(y.LoadingState,{}):0===c.length?(0,s.jsx)(y.EmptyState,{children:n?"No results were found.":"Start typing above to see results."}):(0,s.jsx)(D.View,{gap:8,children:c.map(function(e){var t,n=null!=(t=null==i?void 0:i(e))?t:[];return(0,s.jsx)(b.default,{pkg:e,openConsole:r,pills:n},e.name)})})}function B(e){return e.length>0&&(0,d.default)(e)}function V(e){var t,n,r,i,o,a=e.query,d=(0,m.default)(),f=(0,h.useNixModules)().modules,p=(0,l.useMemo)(function(){return new Set(null==f?void 0:f.map(function(e){return e.id}))},[f]),g=(n=(t={modules:null!=(o=null==d?void 0:d.fullModules)?o:[],query:a}).modules,r=t.query,i=(0,l.useMemo)(function(){return new u.Fzf(n,{selector:function(e){return e.name},tiebreakers:[function(e,t){var n=2===e.item.displayVersion.split(".").length?"".concat(e.item.displayVersion,".0"):e.item.displayVersion,r=2===t.item.displayVersion.split(".").length?"".concat(t.item.displayVersion,".0"):t.item.displayVersion;return B(n)||B(r)?!B(r)&&B(n)?1:!B(n)&&B(r)||(0,c.default)(n,r)?-1:+!!(0,c.default)(r,n):0}]})},[n]),(0,l.useMemo)(function(){return r?i.find(r).map(function(e){return e.item}):n},[i,n,r]));return 0===(g=(0,l.useMemo)(function(){return g.sort(function(e,t){var n=e.internal||e.demoted,r=t.internal||t.demoted;return n&&!r?1:!n&&r?-1:0})},[g])).length?(0,s.jsx)(y.EmptyState,{children:a?"No results were found.":"Start typing above to see results."}):(0,s.jsx)(D.View,{gap:8,children:g?g.map(function(e){var t="".concat(e.id,"-").concat(e.resolutionPath,"-").concat(e.version),n=p.has(e.id);return(0,s.jsx)(D.View,{row:!0,align:"center",justify:"space-between",children:(0,s.jsx)(x.default,{module:e,isInstalled:n,defaultExpanded:!1})},t)}):null})}function F(e){var t=e.onBack,n=e.initialQuery,r=e.setQuery,i=e.categories,a=e.category,u=e.setCategory,c=e.children,d=e.disableCategorySelection,f=e.searchPlaceholder,p=(0,o._)((0,l.useState)(null!=n?n:""),2),h=p[0],g=p[1],m=(0,l.useDeferredValue)(h);return(0,l.useEffect)(function(){r(m)},[m,r]),(0,s.jsxs)(D.View,{css:M.root,children:[(0,s.jsx)(D.View,{css:M.headerRoot,children:(0,s.jsxs)(D.View,{css:M.header,children:[(0,s.jsx)(T.IconButton,{alt:"Back",onClick:function(){return t()},children:(0,s.jsx)(O.default,{})}),!d&&i&&i.length>0?(0,s.jsx)(A.Select,{items:i,css:M.select,"aria-label":"Change search context",selectedKey:a,onSelectionChange:function(e){var t=null==i?void 0:i.find(function(t){return t.value===e});if(!t)throw Error("Expected config");g(""),u(t.value)},children:function(e){return(0,s.jsx)(E.ListBoxItem,{id:e.value,label:e.label})}}):null,(0,s.jsx)(D.View,{grow:!0,shrink:!0,children:(0,s.jsx)(I.SearchBar,{value:h,onChange:function(e){g(e.target.value)},onClear:function(){return g("")},placeholder:void 0===f?"Search packages...":f,autoFocus:!0})})]})}),(0,s.jsx)(D.View,{css:M.resultsRoot,grow:!0,shrink:!0,children:(0,s.jsx)(D.View,{css:M.resultsScroller,children:c})})]})}function U(e){var t=e.onBack,a=e.initialCategory,u=e.openConsole,c=(0,i._)(e,["onBack","initialCategory","openConsole"]),d=(0,w.usePackagerConfigs)().configs,f=(0,o._)((0,l.useState)(""),2),p=f[0],h=f[1],g=(0,l.useMemo)(function(){return d.filter(function(e){return"nix"!==e.id}).map(function(e){return{value:e.id,label:e.name.replace(/\s*packager\s*.*$/,"")}})},[d]),m=(0,o._)((0,l.useState)(null!=a?a:g[0].value),2),x=m[0],y=m[1],b=(0,l.useMemo)(function(){return d.find(function(e){return e.id===x})},[x,d]);return(0,s.jsx)(F,(0,r._)((0,n._)({categories:g,initialQuery:p,setQuery:h,onBack:t,setCategory:function(e){h(""),y(e)},category:x},c),{children:(0,s.jsx)(_.default,{config:b,children:(0,s.jsx)(L,{query:p,openConsole:u})})}))}var G=[{value:"Modules",label:"Modules"},{value:"Packages",label:"Packages"}];function $(e){var t=e.onBack,a=e.initialCategory,u=void 0===a?G[0].value:a,c=e.openConsole,d=(0,i._)(e,["onBack","initialCategory","openConsole"]),p=(0,w.usePackagerConfigs)().configs,h=(0,l.useMemo)(function(){return p.find(function(e){return"nix"===e.id})},[p]),m=(0,o._)((0,l.useState)(""),2),x=m[0],y=m[1],b=(0,o._)((0,l.useState)(u),2),k=b[0],S=b[1];return((0,g.useTrackEffectWithPredicate)(f.events.NIX_MODULE,{action:"search_viewed"},function(){return"Modules"===k},[]),(0,g.useTrackEffectWithPredicate)(f.events.NIX_MODULE,{action:"search_used",query:x},function(){return!!(x&&"Modules"===k)},[x]),h)?(0,s.jsx)(F,(0,r._)((0,n._)({categories:G,initialQuery:x,setQuery:y,onBack:t,setCategory:function(e){y(""),S(e)},category:k,searchPlaceholder:"Modules"===k?"Search modules...":void 0},d),{children:"Packages"===k?(0,s.jsx)(_.default,{config:h,children:(0,s.jsx)(L,{query:x,openConsole:c,computePills:function(e){var t;return null!=(t=e.present)&&t?[(0,s.jsx)(P.Tooltip,{tooltip:"Cached packages are faster to install in your App",children:(0,s.jsx)(R.Pill,{text:"cached",iconLeft:(0,s.jsx)(N.default,{}),colorway:"green"})},"cached-".concat(e.name,"-").concat(e.version))]:[]}})}):(0,s.jsx)(V,{query:x})})):null}e.s(["ImportSearch",()=>U,"NixSearch",()=>$])},9303,e=>{"use strict";var t=e.i(276385),n=e.i(389959),r=e.i(530658),i=e.i(709485),o=e.i(142365),a=e.i(416086),s=e.i(271112),l=e.i(227980),u=e.i(545453),c=e.i(960178);function d(e){var d=e.openFile,f=e.openConsole,p=e.openNixTab,h=(0,u.usePackagerConfigs)().configs,g=(0,n.useMemo)(function(){return h.filter(function(e){return"nix"!==e.id})},[h]),m=(0,r._)((0,n.useState)({mode:"Overview"}),2),x=m[0],y=m[1];switch((0,o.useTrackEffect)(i.events.DEPENDENCIES_TAB_VIEWED,{tab:"import"}),x.mode){case"Overview":return(0,t.jsx)(l.OverviewPane,{children:(0,t.jsx)(a.PackagerSection,{title:"Manage Imports",configs:g,openFile:d,onAddPackage:function(e){y({mode:"Search",initialPackager:e})},description:(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(c.Text,{children:"Packagers manage language-specific dependencies for your project. These can be imported directly from your codebase."}),0===g.length?(0,t.jsx)(c.Text,{color:"dimmest",children:(0,t.jsxs)("p",{children:["You don't currently have any packagers. Add language support by"," ",(0,t.jsx)("a",{href:"",onClick:function(e){e.preventDefault(),p()},children:"adding a System Module"}),"."]})}):null]})})});case"Search":return(0,t.jsx)(s.ImportSearch,{onBack:function(){return y({mode:"Overview"})},initialCategory:x.initialPackager,openConsole:f})}}var f=e.i(634669),p={label:"Imports",description:"Import and manage language-specific packages and dependencies",icon:(0,t.jsx)(f.default,{}),component:function(e){var r=e.openPane,i=(0,n.useCallback)(function(e){return r({type:"codeEditor",data:e})},[r]),o=(0,n.useCallback)(function(){r({type:"shell"})},[r]);return(0,t.jsx)(d,{openFile:i,openConsole:o,openNixTab:function(){}})}};e.s(["dependenciesImportTab",()=>p],9303)},363966,e=>{"use strict";var t=e.i(276385),n=e.i(389959),r=e.i(795122),i=e.i(625484);function o(e){var o=e.modules,a=(0,n.useMemo)(function(){return o.filter(function(e){return"replit"!==e.id})},[o]);return(0,t.jsx)(i.View,{gap:8,children:a.map(function(e){return(0,t.jsx)(r.default,{module:e,defaultExpanded:!0,isInstalled:!0},e.id)})})}e.s(["default",()=>o])},162225,e=>{"use strict";var t=e.i(276385),n=e.i(389959),r=e.i(530658),i=e.i(761201),o=e.i(709485),a=e.i(241828),s=e.i(142365),l=e.i(363966),u=e.i(416086),c=e.i(271112),d=e.i(227980),f=e.i(446530),p=e.i(613355),h=e.i(140487),g=e.i(91720),m=e.i(11235),x=e.i(960178),y=e.i(625484),b=e.i(243914),w=e.i(952030),k=e.i(397124),_=(0,f.cssRecord)({systemModules:[p.rcss.flex.column,p.rcss.gap(8)],sectionHeader:[p.rcss.height(36)]});function S(e){var f=e.openFile,p=e.openConsole,S=(0,a.useNixModules)().modules,C=(0,r._)((0,n.useState)({mode:"Overview"}),2),j=C[0],T=C[1];if((0,s.useTrackEffect)(o.events.DEPENDENCIES_TAB_VIEWED,{tab:"nix"}),!S)return null;switch(j.mode){case"Overview":return(0,t.jsxs)(d.OverviewPane,{children:[(0,t.jsxs)(y.View,{children:[(0,t.jsx)(y.View,{css:_.sectionHeader,row:!0,justify:"space-between",children:(0,t.jsx)(x.Header,{variant:"subheadDefault",level:2,children:"System Modules"})}),(0,t.jsxs)(y.View,{css:_.systemModules,children:[(0,t.jsx)(m.Prose,{color:"dimmer",children:"Modules combine support for programming languages, formatters, and packagers. These provide the foundation for your App."}),(0,t.jsx)(l.default,{modules:S}),(0,t.jsx)(h.Button,{text:"Add new module",variant:S.length>0?"outlined":"default",colorway:"primary",iconLeft:(0,t.jsx)(w.default,{}),onClick:function(){T({mode:"Search",initialCategory:"Modules"})}}),(0,t.jsx)(h.Button,{text:"Open .replit",variant:"nofill",iconLeft:(0,t.jsx)(k.default,{}),onClick:function(){f({path:".replit"})}})]})]}),(0,t.jsx)(u.NixPackager,{onAddPackage:function(){T({mode:"Search",initialCategory:"Packages"})},openFile:f}),(0,t.jsx)(g.ButtonLink,{href:i.LINKS_DOCS.DEPENDENCY_MANAGEMENT,target:"_blank",rel:"noopener",variant:"underlinedOnHover",colorway:"primary",iconRight:(0,t.jsx)(b.default,{}),text:"Learn more about Nix and .replit configuration"})]});case"Search":return(0,t.jsx)(c.NixSearch,{onBack:function(){return T({mode:"Overview"})},initialCategory:j.initialCategory,openConsole:p})}}var C=e.i(26482),j={label:"System",description:"Manage system-level packages and dependencies using Nix package manager",icon:(0,t.jsx)(C.default,{}),component:function(e){var r=e.openPane,i=(0,n.useCallback)(function(e){return r({type:"codeEditor",data:e})},[r]),o=(0,n.useCallback)(function(){r({type:"shell"})},[r]);return(0,t.jsx)(S,{openFile:i,openConsole:o})}};e.s(["dependenciesNixTab",()=>j],162225)},801127,e=>{"use strict";var t,n=e.i(297083),r=e.i(878420),i=e.i(64386),o=e.i(346715),a=e.i(817556),s=e.i(906368),l=e.i(992785),u=e.i(131141),c=e.i(223808),d=e.i(569910),f=e.i(826771),p=e.i(282332),h=e.i(8808),g=new Set([3e3,3001,3002,3003,4200,5e3,5173,6e3,6800,80,8e3,8008,8080,8081,8099,9e3]);function m(e,t){return new Set(Array.from(e).filter(function(e){return!t.has(e)}))}var x=((t={}).FORWARDED="FORWARDED",t.INTERNAL_ONLY="INTERNAL_ONLY",t.NO_MORE_EXTERNAL_PORTS_AVAILABLE="NO_MORE_EXTERNAL_PORTS_AVAILABLE",t.MISCONFIGURED="MISCONFIGURED",t.CONFIG_MISSING="CONFIG_MISSING",t);function y(e){var t=e.type;switch(t){case"FORWARDED":case"MISCONFIGURED":return e.externalPort;case"INTERNAL_ONLY":case"NO_MORE_EXTERNAL_PORTS_AVAILABLE":case"CONFIG_MISSING":return;default:(0,d.default)(t)}}function b(e){var t;return null!=(t=e.isLocalhost)&&t}function w(e){return e===p.VNC_PORT}function k(e){return e===p.VSCODE_PORT}function _(e){return e===p.GALLERY_PREVIEW_PORT}function S(e){return w(e.localPort)}function C(e){return k(e.localPort)}function j(e){return e?m(g,new Set(e.map(function(e){return y(e.configuration)}))):g}function T(e){var t=e.localPort,n=j(e.portsState.current);if(0!==n.size){var r=n.has(80),i=n.has(t);return r?80:i?t:Array.from(n).sort()[0]}}function E(e){var t=e.container,p=e.dotReplit,g=(0,f.observableValue)(null),x=(0,f.observableValue)(!1),E=(0,f.observableValue)("only-global"),R=(0,c.default)(function(){return(0,n._)(function(){var e;return(0,a._)(this,function(t){switch(t.label){case 0:if(!g.current)return[2];return e=g.current.filter(function(e){return!e.isTemporary}).map(function(e){var t=e.configuration.type;switch(t){case"FORWARDED":case"MISCONFIGURED":return(0,r._)({localPort:e.configuration.localPort,externalPort:e.configuration.externalPort},b(e.configuration)?{exposeLocalhost:!0}:void 0);case"INTERNAL_ONLY":return{localPort:e.configuration.localPort};case"NO_MORE_EXTERNAL_PORTS_AVAILABLE":case"CONFIG_MISSING":return!1;default:(0,d.default)(t)}}).filter(Boolean).sort(function(e,t){return e.localPort-t.localPort}),[4,p.updateDotReplit([{op:"add",path:"ports",value:JSON.stringify(e)}])];case 1:return t.sent(),[2]}})})()},1e3,{leading:!1,trailing:!0});function I(){x.set(!0),R()}return!function(e){var t=e.container,n=e.dotReplit,a=e.portsState,c=e.writeDotReplitPortsConfig,d=e.isThisServiceUpdatingDotReplit,f=e.forwardPortsAutomatically;function p(e){return e.sort(function(e,t){var n,r;return(null!=(n=e.configuration.localPort)?n:0)-(null!=(r=t.configuration.localPort)?r:0)})}var g=[];function x(e){try{var t=function(e){var t=e.portsState,n=e.portInfo,o=e.forwardPortsAutomatically;if(null===t.current)throw Error("processOpenedPort can only assign ports if dotReplit config was read");var a={pid:n.pid,cgroup:n.cgroup,address:n.address,cmdline:n.cmdline},s="127.0.0.1"===a.address,l=w(n.port),u=k(n.port),c=_(n.port),d=t.current.find(function(e){return e.configuration.localPort===n.port});if(void 0!==d)return{isOpen:!0,isTemporary:!!l||d.isTemporary,processInfo:a,configuration:(0,i._)((0,r._)({},d.configuration),{isLocalhost:s})};if(c)return{isOpen:!0,isTemporary:!0,processInfo:a,configuration:{type:"FORWARDED",localPort:n.port,externalPort:n.port,isLocalhost:s,isVscode:u,isVnc:l}};if("none"===o.current||"only-global"===o.current&&s||l||u)return{isOpen:!0,isTemporary:!0,processInfo:a,configuration:{type:"INTERNAL_ONLY",localPort:n.port,isLocalhost:s,isVscode:u,isVnc:l}};var f=T({localPort:n.port,portsState:t});return void 0===f?{isOpen:!0,isTemporary:!1,processInfo:a,configuration:{type:"NO_MORE_EXTERNAL_PORTS_AVAILABLE",localPort:n.port,isLocalhost:s,isVscode:u,isVnc:l}}:{isOpen:!0,isTemporary:!1,processInfo:a,configuration:{type:"FORWARDED",localPort:n.port,externalPort:f,isLocalhost:s,isVscode:u,isVnc:l}}}({portsState:a,portInfo:e,forwardPortsAutomatically:f}),n=!1;a.update(function(r){if(!r)throw Error("processOpenedPort can only execute if we red .replit first");return(0,u.produce)(r,function(i){var o=i.findIndex(function(t){return t.configuration.localPort===e.port});return -1===o?(o=r.length,n=!0):(0,l.default)(r[o].configuration,t.configuration)||(n=!0),i[o]=t,p(i)})}),n&&c()}catch(e){throw s.withScope(function(t){t.setTag("service","ports"),s.captureException(e)}),e}}function E(e){try{var t=!1;a.update(function(n){if(!n)throw Error("onPortClosed can only execute if we red .replit first");return(0,u.produce)(n,function(n){var r=n.findIndex(function(t){return t.configuration.localPort===e.port});if(-1!==r){var i,o=n[r];o.isTemporary||(i=o.configuration.localPort,32768<=i&&i<=60999)?(n.splice(r,1),t=!0):o.isOpen=!1}})}),t&&c()}catch(e){throw s.withScope(function(t){t.setTag("service","ports"),s.captureException(e)}),e}}t.onPortOpened(function(e){null===a.current?g.push({type:"portOpen",portInfo:e}):x(e)}),t.onPortClosed(function(e){null===a.current?g.push({type:"portClose",portInfo:e}):E(e)}),t.onConnectionStateChanged(function(e){e!==h.ConnectionState.CONNECTED&&null!==a.current&&a.set(a.current.filter(function(e){return!e.isTemporary}).map(function(e){return{isOpen:!1,isTemporary:e.isTemporary,configuration:e.configuration}}))}),n.watch(function(e){var t,n=e.config,s=null!=(t=null==n?void 0:n.ports)?t:[];if(!0===d.current){var l=a.current;if(!l||s.length!==l.length)return;s.every(function(e,t){var n,r=l[t];return e.localPort===r.configuration.localPort&&e.externalPort===(null!=(n=y(r.configuration))?n:0)})&&d.set(!1);return}a.update(function(e){e||(e=[]);var t=new Set(s.map(function(e){return e.localPort}).filter(function(e){return null!=e})),n=new Set(e.map(function(e){return e.configuration.localPort})),a=new Set(e.filter(function(e){return e.isOpen}).map(function(e){return e.configuration.localPort})),l=m(t,n),u=(g=new Set((0,o._)(Array.from(t)).concat((0,o._)(Array.from(a)))),new Set(Array.from(n).filter(function(e){return g.has(e)}))),c=[],d=!0,f=!1,h=void 0;try{for(var g,x,y=u[Symbol.iterator]();!(d=(x=y.next()).done);d=!0)!function(){var t=x.value,n=e.find(function(e){return e.configuration.localPort===t}),o=s.find(function(e){return e.localPort===t});if(!n)throw Error("couldn't find match for local port: ".concat(t));if(!o)return c.push((0,i._)((0,r._)({},n),{configuration:{type:"CONFIG_MISSING",localPort:n.configuration.localPort,isLocalhost:b(n.configuration),isVscode:C(n.configuration),isVnc:S(n.configuration)}}));var a=n.configuration;a=null!=o.externalPort&&0!==o.externalPort?{type:j(c).has(o.externalPort)?"FORWARDED":"MISCONFIGURED",localPort:n.configuration.localPort,externalPort:o.externalPort,isLocalhost:b(n.configuration),isVscode:C(n.configuration),isVnc:S(n.configuration)}:{type:"INTERNAL_ONLY",localPort:n.configuration.localPort,isLocalhost:b(n.configuration),isVscode:C(n.configuration),isVnc:S(n.configuration)},c.push((0,i._)((0,r._)({},n),{configuration:a}))}()}catch(e){f=!0,h=e}finally{try{d||null==y.return||y.return()}finally{if(f)throw h}}var _=!0,T=!1,E=void 0;try{for(var R,I=l[Symbol.iterator]();!(_=(R=I.next()).done);_=!0)!function(){var e,t=R.value,n=s.find(function(e){return e.localPort===t});if(!n)throw Error("couldn't find match for local port: ".concat(t));var r=null!=n.externalPort&&0!==n.externalPort?n.externalPort:void 0;if(void 0!==r){var i,o=j(c).has(r);c.push({isOpen:!1,isTemporary:!1,configuration:{type:o?"FORWARDED":"MISCONFIGURED",localPort:t,externalPort:r,isLocalhost:null!=(i=n.exposeLocalhost)&&i,isVscode:k(t),isVnc:w(t)}})}else c.push({isOpen:!1,isTemporary:!1,configuration:{type:"INTERNAL_ONLY",localPort:t,isLocalhost:null!=(e=n.exposeLocalhost)&&e,isVscode:k(t),isVnc:w(t)}})}()}catch(e){T=!0,E=e}finally{try{_||null==I.return||I.return()}finally{if(T)throw E}}return p(c)}),g.length>0&&(g.forEach(function(e){var t=e.type,n=e.portInfo;"portOpen"===t?x(n):"portClose"===t&&E(n)}),g=[])})}({container:t,dotReplit:p,portsState:g,writeDotReplitPortsConfig:I,isThisServiceUpdatingDotReplit:x,forwardPortsAutomatically:E}),{tryExposingPortAutomatically:function(e){var t=T({localPort:e,portsState:g});void 0!==t&&(g.update((0,u.produce)(function(n){if(n){var r=n.find(function(t){return t.configuration.localPort===e});r&&(r.isTemporary=!1,r.configuration={type:"FORWARDED",localPort:e,externalPort:t,isLocalhost:r.configuration.isLocalhost,isVscode:k(e),isVnc:w(e)})}})),I())},updateDotReplitPortsMapping:function(e,t,n){g.update((0,u.produce)(function(r){var i,o=null==r?void 0:r.find(function(t){return t.configuration.localPort===e}),a=n;void 0===a&&(a=null!=(i=null==o?void 0:o.configuration.isLocalhost)&&i);var s=void 0!==t?{type:"FORWARDED",localPort:e,externalPort:t,isLocalhost:a,isVscode:k(e),isVnc:w(e)}:{type:"INTERNAL_ONLY",localPort:e,isLocalhost:a,isVscode:k(e),isVnc:w(e)};o?(o.isTemporary=!1,o.configuration=s):(r||(r=[]),r.push({isOpen:!1,isTemporary:!1,configuration:s}))})),I()},removeDotReplitPortsMapping:function(e,t){g.update((0,u.produce)(function(n){var r;void 0!==(r=void 0!==t?null==n?void 0:n.findIndex(function(n){return n.configuration.localPort===e&&("FORWARDED"===n.configuration.type||"MISCONFIGURED"===n.configuration.type)&&n.configuration.externalPort===t}):null==n?void 0:n.findIndex(function(t){return t.configuration.localPort===e}))&&(null==n||n.splice(r,1))})),I()},portsState:g,setForwardPortsAutomatically:function(e){E.set(e)}}}e.s(["ForwardableExternalPortsDotDevDomain",()=>g,"PortConfigurationType",()=>x,"createPortsService",()=>E,"getExternalPort",()=>y,"getIsLocalhost",()=>b,"isGalleryPreviewPort",()=>_])},739434,909478,e=>{"use strict";var t=e.i(475032),n=e.i(389959),r=e.i(761732),i=e.i(801127),o=e.i(529810);function a(e){var t=(0,r.default)(e.portsState);return(0,n.useMemo)(function(){return t?t.filter(function(e){return e.isOpen&&e.configuration.type===i.PortConfigurationType.FORWARDED}):[]},[t])}function s(e){var t=(0,o.default)().ports,a=(0,r.default)(t.portsState);return(0,n.useMemo)(function(){if(a)return a.find(function(t){return t.configuration.type===i.PortConfigurationType.FORWARDED&&t.configuration.externalPort===e})},[a,e])}function l(e){return u((0,o.default)().ports,e)}function u(e,t){var i=(0,r.default)(e.portsState);return(0,n.useMemo)(function(){return t&&i?i.filter(function(e){var n;return null!=(n=e.isOpen&&(null==t?void 0:t.endsWith(e.processInfo.cgroup)))&&n}):[]},[i,t])}function c(){var e=(0,o.default)().ports,t=(0,r.default)(e.portsState);return null==t?void 0:t.some(function(e){return e.configuration.isVnc&&e.isOpen})}function d(e){return 80===e||443===e}function f(e,t){var n=new URL(e);return!t||d(t)?(n.hostname.endsWith(".localhost")?n.port="8081":n.port&&(n.port=""),n):(n.port=t.toString(),n)}function p(e){var n,r,i,o=e.container,s=e.ports,l=e.addDevToolsSuffix,u=!(r=a(s)).length||r.some(function(e){return 80===e.configuration.externalPort})?80:null!=(n=r[0].configuration.externalPort)?n:80,c=(0,t.default)(o),d=c.url,p=c.reachability;if(!u||!d)return null;var h=f(d,u).toString(),g=f(d+"/__replco/workspace_iframe.html",u).toString();return{iframeSrc:void 0===l||l?g:(i=new URL(h)).hostname.endsWith(".localhost")?h:(i.protocol="https:",i.toString()),presentationUrl:h,baseUrl:d,reachability:p}}e.s(["useIsVNCPortOpened",()=>c,"useOpenedAndForwardedPorts",()=>a,"useOpenedPortMatchingExternalPort",()=>s,"useOpenedPortsMatchingCgroup",()=>l,"useOpenedPortsMatchingCgroupWithExplicitService",()=>u],909478),e.s(["addPortToUrl",()=>f,"isDefaultPort",()=>d,"useUrls",()=>p],739434)},408450,e=>{e.v({expoGoLink:"DevURLInfo-module__Y2imda__expoGoLink",qrCode:"DevURLInfo-module__Y2imda__qrCode",url:"DevURLInfo-module__Y2imda__url"})},371222,282094,531875,460513,886977,100915,604957,154488,840752,93728,e=>{"use strict";var t,n,r,i=e.i(276385),o=e.i(389959),a=e.i(529810),s=e.i(530658),l=e.i(412160),u=e.i(921521),c=e.i(993796),d=e.i(222342),f=e.i(761732),p=e.i(739434),h=e.i(801127),g=e.i(878420),m=e.i(64386),x=e.i(886513),y=e.i(446530),b=e.i(613355),w=e.i(625484),k=(0,y.cssRecord)({table:{},tableRow:[b.rcss.rowWithGap(12),b.rcss.align.center,b.rcss.border({direction:"bottom"}),{boxSizing:"border-box"}],column:[b.rcss.display.flex,b.rcss.colWithGap(0),b.rcss.justify.center,b.rcss.border({direction:"right"}),{":last-child":{borderRight:0}}],cell:[b.rcss.rowWithGap(4),b.rcss.align.center,b.rcss.color.foregroundDimmest,b.rcss.justify.spaceBetween,b.rcss.fontSize("small"),b.rcss.mx(4),b.rcss.py(2),{overflow:"hidden",whiteSpace:"nowrap"}]}),_=function(e){var t=e.children,n=(0,x._)(e,["children"]);return(0,i.jsx)("tr",(0,m._)((0,g._)({css:k.tableRow},n),{children:(0,i.jsx)(w.View,{row:!0,gap:0,children:t})}))},S=function(e){var t=e.header,n=e.width,r=e.last,o=e.children,a={};return(n&&(a.width=n),r&&(a.marginLeft="auto"),void 0!==t&&t)?(0,i.jsx)("th",{style:a,children:(0,i.jsx)(w.View,{css:k.cell,children:o})}):(0,i.jsx)("td",{css:k.column,style:a,children:(0,i.jsx)(w.View,{css:k.cell,children:o})})},C=function(e){var t=e.children;return(0,i.jsx)("table",{css:k.table,children:t})};e.s(["Column",()=>S,"Row",()=>_,"Table",()=>C],282094);var j=e.i(754458),T=e.i(480028),E=e.i(88619),R=e.i(960178),I=e.i(408450);function A(e){var t=e.url,n=e.expoUrl;return(0,i.jsxs)(w.View,{gap:8,children:[(0,i.jsxs)(w.View,{children:[(0,i.jsxs)(w.View,{row:!0,gap:4,align:"center",children:[(0,i.jsx)(l.default,{href:t,clsx:I.default.url,target:"_blank",children:t}),(0,i.jsx)(E.CopyIconButton,{textToCopy:t,tooltipText:"Copy link"})]}),(0,i.jsx)(R.Text,{color:"dimmer",variant:"small",children:"Dev URLs are temporary and will sleep after you leave the workspace."})]}),(0,i.jsxs)(w.View,{gap:4,children:[(0,i.jsx)(j.default,{bgColor:T.tokens.backgroundHigher,fgColor:T.tokens.foregroundDefault,clsx:I.default.qrCode,size:128,value:null!=n?n:t}),n?(0,i.jsx)(w.View,{children:(0,i.jsxs)(R.Text,{variant:"small",color:"dimmer",children:["Install"," ",(0,i.jsx)(l.default,{href:"https://expo.dev/go",clsx:I.default.expoGoLink,target:"_blank",children:"Expo Go"})," ","to scan and preview"]})}):null]})]})}e.s(["default",()=>A],531875);var P=e.i(297083),D=e.i(817556),O=e.i(569384),N=e.i(973245),M=e.i(304277);e.i(566901);var L=e.i(951262);function B(){var e=(0,O._)(["\n  query GetReplShieldStatus($replId: String!) {\n    getRepl(id: $replId) {\n      ... on Repl {\n        id\n        isReplShieldEnabled\n        authorizations {\n          editDevUrlPrivacy {\n            isAuthorized\n            message\n          }\n        }\n      }\n      ... on Error {\n        message\n      }\n    }\n  }\n"]);return B=function(){return e},e}function V(){var e=(0,O._)(["\n  mutation ToggleReplShield($input: SetReplShieldInput!) {\n    setReplShield(input: $input) {\n      ... on Repl {\n        id\n        isReplShieldEnabled\n      }\n      ... on UserError {\n        message\n      }\n      ... on NotFoundError {\n        message\n      }\n      ... on UnauthorizedError {\n        message\n      }\n    }\n  }\n"]);return V=function(){return e},e}var F={},U=(0,N.gql)(B()),G=(0,N.gql)(V()),$=e.i(596139),z=e.i(968783),H=e.i(207237),W=e.i(541793),q=e.i(161322);function K(){var e=(0,O._)(["\n  mutation MintReplShieldToken($input: MintReplShieldTokenInput!) {\n    mintReplShieldToken(input: $input) {\n      ... on ReplShieldToken {\n        token\n      }\n      ... on Error {\n        message\n      }\n    }\n  }\n"]);return K=function(){return e},e}var Y={},Q=(0,N.gql)(K()),X=e.i(98816),J=function(e){try{var t=e.split(".")[1],n=JSON.parse(atob(t));return n.exp?1e3*n.exp:null}catch(e){return null}},Z=(0,W.atom)(null),ee=(0,W.atom)(!1);function et(){var e,t=(0,H.default)(),n=(0,s._)((e=(0,g._)({},Y,void 0),L.useMutation(Q,e)),2),r=n[0],i=n[1].loading,a=(0,s._)((0,q.useAtom)(Z),2),l=a[0],u=a[1],c=(0,s._)((0,q.useAtom)(ee),2),d=c[0],f=c[1],p=(0,o.useRef)(null),h=(0,X.default)(i),m=(0,o.useCallback)(function(){return(0,P._)(function(){var e,n,i;return(0,D._)(this,function(o){switch(o.label){case 0:if(!t||h.current)return[2];f(!1),o.label=1;case 1:return o.trys.push([1,3,,4]),[4,r({variables:{input:{replId:t}}})];case 2:if((n=null==(e=o.sent().data)?void 0:e.mintReplShieldToken)&&"ReplShieldToken"===n.__typename){if(!(i=n.token))return[2,null];return u(i),[2,i]}return f(!0),[2,null];case 3:return o.sent(),f(!0),[2,null];case 4:return[2]}})})()},[t,r,u,f,h]),x=(0,o.useCallback)(function(){return(0,P._)(function(){return(0,D._)(this,function(e){return u(null),f(!1),[2,m()]})})()},[m,u,f]),y=(0,o.useCallback)(function(){if(!l)return!1;var e=J(l);if(!e)return!1;var t=e-Date.now();return!(t<=0)&&!(t<=3e5)},[l]),b=(0,o.useCallback)(function(){if(p.current&&(clearTimeout(p.current),p.current=null),l){var e=J(l);if(e){var t=e-Date.now();if(t<=3e5)return void m();p.current=setTimeout(function(){m()},t-3e5)}}},[l,m]);return(0,o.useEffect)(function(){return!t||l||h.current||d||m(),t&&l&&!h.current&&!d&&(y()?b():m()),function(){p.current&&(clearTimeout(p.current),p.current=null)}},[t,l,m,d,y,b,h]),{token:l,error:d,retry:m,loading:i,forceRemint:x}}e.s(["useReplShieldToken",()=>et],460513);var en=e.i(112767),er=e.i(751273),ei=e.i(947108),eo=(0,y.cssRecord)({titleRow:[b.rcss.gap(8),b.rcss.align.center]});function ea(){var e,t,n,r,a,l,u,c,f,p,h=(0,d.default)().showError,m=(0,H.default)(),x=(0,s._)((0,o.useState)(null),2),y=x[0],k=x[1],_=et().forceRemint,S=(0,z.useCurrentUserStoredOrgContext)(),C=S.loading,j=S.orgId,T=!C&&!j,E=(e={variables:{replId:m},skip:!m},t=(0,g._)({},F,e),M.useQuery(U,t)),I=E.data,A=E.loading,O=(0,s._)((n=(0,g._)({},F,void 0),L.useMutation(G,n)),2),N=O[0],B=O[1].loading,V=(null==I||null==(r=I.getRepl)?void 0:r.__typename)==="Repl"&&I.getRepl.isReplShieldEnabled,W=(null==I||null==(a=I.getRepl)?void 0:a.__typename)==="Repl"&&(null==(u=I.getRepl.authorizations)||null==(l=u.editDevUrlPrivacy)?void 0:l.isAuthorized),q=(null==I||null==(c=I.getRepl)?void 0:c.__typename)==="Repl"&&(null==(p=I.getRepl.authorizations)||null==(f=p.editDevUrlPrivacy)?void 0:f.message),K=null!==y?y:V;return(0,i.jsx)(w.View,{p:4,children:(0,i.jsxs)(w.View,{row:!0,justify:"space-between",children:[(0,i.jsxs)(w.View,{gap:4,children:[(0,i.jsxs)(w.View,{css:eo.titleRow,row:!0,children:[(0,i.jsx)(R.Text,{children:"Private Dev URL"}),T?(0,i.jsx)(ei.default,{plan:"Teams",size:"small",tooltipProps:{description:"Private Dev URL is only available on Replit ".concat($.replitTeamsPlanName,".")}}):null]}),(0,i.jsx)(R.Text,{variant:"small",css:b.rcss.color.foregroundDimmer,children:"Restrict Dev URL access to authenticated editors only."}),(0,i.jsx)(R.Text,{variant:"small",css:b.rcss.color.foregroundDimmer,children:"When this option is disabled, anyone with the Dev URL can access your app preview."})]}),(0,i.jsx)(w.View,{row:!0,align:"center",children:(0,i.jsx)(er.Tooltip,{tooltip:B?"Loading...":A?"Loading status...":W?T?"Private Dev URL is only available on Replit ".concat($.replitTeamsPlanName,"."):"Toggle to ".concat(K?"disable":"enable"," private dev URL"):q||"You do not have permission to change this setting",children:(0,i.jsx)(w.View,{children:(0,i.jsx)(en.Switch,{"aria-label":"Toggle private dev URL",isSelected:K,onChange:function(){return(0,P._)(function(){var e,t,n,r,i,o,a;return(0,D._)(this,function(s){switch(s.label){case 0:if(!m||!W)return[2];k(!K),s.label=1;case 1:return s.trys.push([1,6,,7]),[4,N({variables:{input:{replId:m,isEnabled:!K}},refetchQueries:[{query:U,variables:{replId:m}}]})];case 2:if((null==(t=(a=s.sent()).data)||null==(e=t.setReplShield)?void 0:e.__typename)!=="UserError"&&(null==(r=a.data)||null==(n=r.setReplShield)?void 0:n.__typename)!=="NotFoundError"&&(null==(o=a.data)||null==(i=o.setReplShield)?void 0:i.__typename)!=="UnauthorizedError")return[3,3];return h(a.data.setReplShield.message),k(null),[3,5];case 3:return[4,_()];case 4:s.sent(),s.label=5;case 5:return[3,7];case 6:return s.sent(),h("Failed to toggle configuration"),k(null),[3,7];case 7:return[2]}})})()},isDisabled:B||A||!W||T,colorway:K?"positive":"primary"})})})})]})})}e.s(["default",()=>ea],886977);var es=e.i(140487),el=e.i(988676),eu=e.i(136540),ec=e.i(607278),ed=e.i(601059),ef=e.i(396776),ep=e.i(369948),eh=e.i(283110),eg=e.i(243914),em=e.i(363201),ev=e.i(115357),ex=e.i(196353),ey=e.i(952030),eb=e.i(703505),ew=e.i(170314),ek=e.i(42458),e_="VNC ports do not require external port",eS="VSCode ports do not require external port",eC=(0,y.cssRecord)({secondaryUrl:[b.rcss.color.foregroundDimmest,b.rcss.fontSize("small"),b.rcss.focusRing,{"&:hover":[b.rcss.cursor.pointer,b.rcss.color.accentPrimaryStrongest]}],portHeader:[b.rcss.align.baseline],openPort:[b.rcss.color.accentPositiveStronger],localPortIcon:[b.rcss.color.foregroundDefault,b.rcss.px(4),{flex:"0 0 auto",marginLeft:"auto"}],portStatus:[b.rcss.py(0),b.rcss.px(4),b.rcss.overflow("hidden")],newPort:[b.rcss.color.foregroundDefault,b.rcss.rowWithGap(4),b.rcss.align.center,b.rcss.my(1),b.rcss.borderRadius(16),b.rcss.height(20)],externalPortButton:[{"&":[b.rcss.height(20),b.rcss.borderRadius(16),b.rcss.color.foregroundDefault]}],textButton:[b.rcss.cursor.pointer,b.rcss.reset.button,b.rcss.color.accentPrimaryStronger,b.rcss.focusRing,b.rcss.hover(b.rcss.color.accentPrimaryStrongest),{lineHeight:1.2,":not([disabled])":{cursor:"pointer"}}],newPortInput:[b.rcss.height(20),b.rcss.my(1)],newPortClose:b.rcss.mr(4),vncTooltip:[b.rcss.flex.growAndShrink(1)],vscodeTooltip:[b.rcss.flex.growAndShrink(1)]});function ej(e){var t,n,r,o=e.localPort,s=e.externalPort,l=e.isLocalhost,u=e.onPortChange,c=(0,a.default)().ports.updateDotReplitPortsMapping,d=(t=(0,a.default)().ports,r=new Set(null==(n=(0,f.default)(t.portsState))?void 0:n.map(function(e){var t;return null!=(t=(0,h.getExternalPort)(e.configuration))&&t}).filter(Boolean)),Array.from(h.ForwardableExternalPortsDotDevDomain).sort(function(e,t){return e-t}).map(function(e){return{isAvailable:!r.has(e),externalPort:e}}));return(0,i.jsx)(w.View,{row:!0,children:void 0!==s&&0!==s?(0,i.jsx)(es.Button,{css:eC.externalPortButton,iconRight:(0,i.jsx)(eh.default,{}),text:":".concat(s),size:"small",onClick:function(){o&&(c(o,void 0,l),null==u||u())}}):(0,i.jsx)(ed.PopupMenu,{label:"Set external port",onAction:function(e){if(o){var t=d.find(function(t){return String(t.externalPort)===e});t&&t.isAvailable&&(c(o,t.externalPort,l),null==u||u())}},children:d.map(function(e){var t=e.isAvailable,n=e.externalPort;return(0,i.jsx)(ed.MenuItem,{id:String(n),"aria-label":String(n),isDisabled:!t,label:":".concat(n)},String(n))})})})}function eT(e){var t=e.portState,n=null;switch(t.configuration.type){case h.PortConfigurationType.MISCONFIGURED:n=(0,i.jsx)(er.Tooltip,{tooltip:"Port misconfigured",delay:"default",children:(0,i.jsx)(ek.default,{})});break;case h.PortConfigurationType.CONFIG_MISSING:n=(0,i.jsx)(er.Tooltip,{tooltip:"Configuration missing",delay:"default",children:(0,i.jsx)(ek.default,{})});break;case h.PortConfigurationType.NO_MORE_EXTERNAL_PORTS_AVAILABLE:n=(0,i.jsx)(ek.default,{});break;case h.PortConfigurationType.FORWARDED:n=(0,i.jsx)(ep.default,{});case h.PortConfigurationType.INTERNAL_ONLY:}return(0,i.jsx)("span",{css:eC.localPortIcon,children:n})}function eE(e){var t=e.portState,n=e.width,r=(0,h.getIsLocalhost)(t.configuration)?"localhost":"0.0.0.0";return(0,i.jsxs)(S,{width:n||130,children:[(0,i.jsxs)(R.Text,{css:t.isOpen&&eC.openPort,children:[r,":",t.configuration.localPort]}),(0,i.jsx)(eT,{portState:t})]})}function eR(e){var t,n=e.portState,r=e.openWebview,o=e.openVncOutput,a=e.openVscode,s=e.width;if(n.configuration.type===h.PortConfigurationType.NO_MORE_EXTERNAL_PORTS_AVAILABLE)return(0,i.jsx)(S,{width:s||180,children:(0,i.jsx)(ef.StatusBanner,{css:eC.portStatus,icon:(0,i.jsx)(ek.default,{}),text:"No ports available"})});var l=!!o&&n.configuration.isVnc,u=!!a&&n.configuration.isVscode,c=!l&&!u&&!!r&&n.isOpen&&n.configuration.type===h.PortConfigurationType.FORWARDED;return t=n.configuration.isVnc?(0,i.jsx)(er.Tooltip,{tooltip:e_,css:eC.vncTooltip,children:(0,i.jsx)(ef.StatusBanner,{css:eC.portStatus,icon:(0,i.jsx)(em.default,{}),text:e_})}):n.configuration.isVscode?(0,i.jsx)(er.Tooltip,{tooltip:eS,css:eC.vscodeTooltip,children:(0,i.jsx)(ef.StatusBanner,{css:eC.portStatus,icon:(0,i.jsx)(em.default,{}),text:eS})}):(0,i.jsx)(ej,{localPort:n.configuration.localPort,externalPort:(0,h.getExternalPort)(n.configuration),isLocalhost:(0,h.getIsLocalhost)(n.configuration)}),(0,i.jsxs)(S,{width:s||180,children:[t,c?(0,i.jsx)(eu.IconButton,{alt:"Open in Preview",onClick:r,css:b.rcss.color.foregroundDefault,children:(0,i.jsx)(ev.default,{})}):null,l?(0,i.jsx)(eu.IconButton,{alt:"View VNC output",onClick:o,css:b.rcss.color.foregroundDefault,children:(0,i.jsx)(ev.default,{})}):null,u?(0,i.jsx)(eu.IconButton,{alt:"Open VSCode",onClick:a,css:b.rcss.color.foregroundDefault,children:(0,i.jsx)(ew.default,{})}):null]})}function eI(e){var t,n=e.portState;return n.isOpen?(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(S,{width:100,children:(t=n.processInfo.cmdline[0].split("/"))[t.length-1]}),(0,i.jsx)(S,{width:100,children:n.processInfo.pid})]}):(0,i.jsx)(S,{width:100})}var eA=((t=eA||{}).OPEN_WEBVIEW="OPEN_WEBVIEW",t.OPEN_VNC_OUTPUT="OPEN_VNC_OUTPUT",t.OPEN_VSCODE="OPEN_VSCODE",t.EXTERNAL_LINK="EXTERNAL_LINK",t.REMOVE="REMOVE",t);function eP(e){var t=e.portState,n=e.onAction,r=[{label:"Open external link",key:"EXTERNAL_LINK",icon:(0,i.jsx)(eg.default,{})},{label:"Remove port config",key:"REMOVE",icon:(0,i.jsx)(eb.default,{})}];return t.configuration.isVnc?r.unshift({label:"View VNC output",key:"OPEN_VNC_OUTPUT",icon:(0,i.jsx)(ev.default,{})}):t.configuration.isVscode?r.unshift({label:"Open VSCode",key:"OPEN_VSCODE",icon:(0,i.jsx)(ew.default,{})}):r.unshift({label:"Open Preview",key:"OPEN_WEBVIEW",icon:(0,i.jsx)(ev.default,{})}),(0,i.jsx)(S,{width:30,last:!0,children:(0,i.jsx)(ed.PopupMenu,{trigger:(0,i.jsx)(eu.IconButton,{alt:"More",children:(0,i.jsx)(ex.default,{})}),items:r,onAction:function(e){switch(e){case"OPEN_WEBVIEW":case"OPEN_VNC_OUTPUT":case"OPEN_VSCODE":case"EXTERNAL_LINK":case"REMOVE":n({type:e,payload:{portState:t}})}},children:function(e){return(0,i.jsx)(ed.MenuItem,{label:e.label,icon:e.icon},e.key)}})})}function eD(e){var t=e.portState,n=e.portAction;return(0,i.jsxs)(_,{children:[(0,i.jsx)(eE,{portState:t}),(0,i.jsx)(eR,{portState:t,openWebview:function(){n({type:"OPEN_WEBVIEW",payload:{portState:t}})},openVncOutput:function(){n({type:"OPEN_VNC_OUTPUT",payload:{portState:t}})},openVscode:function(){n({type:"OPEN_VSCODE",payload:{portState:t}})}}),(0,i.jsx)(eI,{portState:t}),(0,i.jsx)(eP,{portState:t,onAction:n})]},t.configuration.localPort)}var eO=function(e){var t=e.text,n=e.onClick;return(0,i.jsx)("button",{css:eC.textButton,onClick:n,children:t})};function eN(e){var t,n=e.openDotReplit,r=(0,s._)((0,o.useState)(!1),2),l=r[0],u=r[1],c=(0,s._)((0,o.useState)(),2),d=c[0],f=c[1],p=null==(t=(0,a.default)().ports.portsState.current)?void 0:t.some(function(e){return e.configuration.localPort===d});return l?(0,i.jsxs)(_,{children:[(0,i.jsxs)(S,{width:130,children:[(0,i.jsx)(eu.IconButton,{css:eC.newPortClose,alt:"Close",onClick:function(){return u(!1)},size:18,children:(0,i.jsx)(eh.default,{})}),(0,i.jsx)(ec.Input,{css:eC.newPortInput,value:(null==d?void 0:d.toString())||"",onChange:function(e){return f(e.target.value?parseInt(e.target.value,10):void 0)}})]}),(0,i.jsx)(S,{children:p?(0,i.jsx)(ef.StatusBanner,{css:eC.portStatus,colorway:"warning",text:"Local port already exists"}):(0,i.jsx)(ej,{localPort:d,isLocalhost:!1,onPortChange:function(){return u(!1)}})})]}):(0,i.jsxs)(_,{children:[(0,i.jsx)(S,{width:130,children:(0,i.jsx)(es.Button,{css:eC.newPort,iconLeft:(0,i.jsx)(ey.default,{size:12}),text:"New port",size:"small",onClick:function(){return u(!0)}})}),(0,i.jsx)(S,{children:(0,i.jsxs)(R.Text,{variant:"small",children:["This port config is saved in the"," ",(0,i.jsx)(eO,{text:".replit file",onClick:n}),"."," "]})})]})}function eM(e){var t,n=e.openDotReplit,r=e.openWebview,o=e.openVncOutput,s=e.openVscode,f=e.ports,g=e.container,m=(0,u.default)(),x=(0,p.useUrls)({container:g,ports:f,addDevToolsSuffix:!m}),y=(0,d.default)().showError,b=(0,c.useFlag)({controlName:"flag-repl-shield-toggle"}),k=(0,a.default)().ports,j=k.portsState,T=k.removeDotReplitPortsMapping,E=function(e){switch(e.type){case"OPEN_WEBVIEW":r(e.payload.portState.configuration.localPort);break;case"OPEN_VNC_OUTPUT":o();break;case"OPEN_VSCODE":s();break;case"EXTERNAL_LINK":var t=(0,h.getExternalPort)(e.payload.portState.configuration);if(!(null==x?void 0:x.presentationUrl))return void y("URL not available.");var n=(0,p.addPortToUrl)(null==x?void 0:x.presentationUrl,t).toString();window.open(n,"_blank");break;case"REMOVE":T(e.payload.portState.configuration.localPort,(0,h.getExternalPort)(e.payload.portState.configuration))}};return(0,i.jsxs)(w.View,{p:12,gap:16,children:[b?(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(ea,{}),(0,i.jsx)(el.DividerH,{})]}):null,(null==x?void 0:x.presentationUrl)?(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(A,{url:x.presentationUrl}),(0,i.jsx)(el.DividerH,{})]}):null,(0,i.jsxs)(w.View,{gap:4,children:[(0,i.jsxs)(w.View,{css:eC.portHeader,row:!0,gap:8,children:[(0,i.jsx)(R.Text,{children:"Ports"}),(0,i.jsx)(l.default,{href:"https://docs.replit.com/replit-workspace/workspace-features/webview",css:eC.secondaryUrl,target:"_blank",children:"Learn more"})]}),(0,i.jsxs)(C,{children:[(0,i.jsxs)(_,{children:[(0,i.jsx)(S,{header:!0,width:130,children:"Internal Port"}),(0,i.jsx)(S,{header:!0,width:180,children:"External Port"}),(0,i.jsx)(S,{header:!0,width:100,children:"Name"}),(0,i.jsx)(S,{header:!0,width:100,children:"Pid"})]}),j.current&&(null==(t=j.current)?void 0:t.length)>0?j.current.map(function(e){return(0,i.jsx)(eD,{portState:e,portAction:E},e.configuration.localPort)}):null,(0,i.jsx)(eN,{openDotReplit:n})]})]})]})}var eL=e.i(88358),eB={label:"Networking",description:"Configure web server ports for your App",icon:(0,i.jsx)(eL.default,{}),component:function(e){var t=e.openPane,n=(0,a.default)(),r=n.ports,s=n.container,l=(0,o.useCallback)(function(){t({type:"codeEditor",data:{path:".replit"}})},[t]),u=(0,o.useCallback)(function(e){t({type:"webview",data:e?{ports:{type:"local",port:e}}:void 0})},[t]),c=(0,o.useCallback)(function(){t({type:"vnc"})},[t]),d=(0,o.useCallback)(function(){t({type:"webview",data:{ports:{type:"local",port:8080}}})},[t]);return(0,i.jsx)(eM,{openDotReplit:l,openWebview:u,openVncOutput:c,openVscode:d,ports:r,container:s})}};function eV(){var e=(0,O._)(["\n  fragment DeveloperToolsResourcesRepl on Repl {\n    id\n    owner {\n      __typename\n      ... on Team {\n        id\n      }\n      ... on User {\n        id\n      }\n    }\n  }\n"]);return eV=function(){return e},e}function eF(){var e=(0,O._)(["\n  fragment DeveloperToolsResourcesCurrentUser on CurrentUser {\n    id\n    userSubscriptionType\n  }\n"]);return eF=function(){return e},e}function eU(){var e=(0,O._)(["\n  query DeveloperToolsResources($replId: String!) {\n    getRepl(id: $replId) {\n      ... on Repl {\n        ...DeveloperToolsResourcesRepl\n      }\n    }\n    currentUser {\n      ...DeveloperToolsResourcesCurrentUser\n    }\n  }\n  ","\n  ","\n"]);return eU=function(){return e},e}e.s(["networkingTab",()=>eB],371222);var eG={},e$=(0,N.gql)(eV()),ez=(0,N.gql)(eF()),eH=(0,N.gql)(eU(),e$,ez),eW=e.i(225185),eq=e.i(973519),eK=e.i(858248),eY=e.i(709485),eQ=e.i(399119),eX=e.i(904851),eJ=e.i(90659),eZ=e.i(721281),e0=e.i(663355),e1=e.i(862470),e2=e.i(445789),e3=e.i(167626),e4=e.i(346715),e8=e.i(119468),e5=e.i(463348);function e6(e){return e+.5|0}var e9=function(e,t,n){return Math.max(Math.min(e,n),t)};function e7(e){return e9(e6(2.55*e),0,255)}function te(e){return e9(e6(255*e),0,255)}function tt(e){return e9(e6(e/2.55)/100,0,1)}function tn(e){return e9(e6(100*e),0,100)}var tr={0:0,1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,A:10,B:11,C:12,D:13,E:14,F:15,a:10,b:11,c:12,d:13,e:14,f:15},ti=Array.from("0123456789ABCDEF"),to=function(e){return ti[15&e]},ta=function(e){return ti[(240&e)>>4]+ti[15&e]},ts=function(e){return(240&e)>>4==(15&e)},tl=/^(hsla?|hwb|hsv)\(\s*([-+.e\d]+)(?:deg)?[\s,]+([-+.e\d]+)%[\s,]+([-+.e\d]+)%(?:[\s,]+([-+.e\d]+)(%)?)?\s*\)$/;function tu(e,t,n){var r=t*Math.min(n,1-n),i=function(t){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:(t+e/30)%12;return n-r*Math.max(Math.min(i-3,9-i,1),-1)};return[i(0),i(8),i(4)]}function tc(e,t,n){var r=function(r){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:(r+e/60)%6;return n-n*t*Math.max(Math.min(i,4-i,1),0)};return[r(5),r(3),r(1)]}function td(e,t,n){var r,i=tu(e,1,.5);for(t+n>1&&(r=1/(t+n),t*=r,n*=r),r=0;r<3;r++)i[r]*=1-t-n,i[r]+=t;return i}function tf(e){var t,n,r,i=e.r/255,o=e.g/255,a=e.b/255,s=Math.max(i,o,a),l=Math.min(i,o,a),u=(s+l)/2;return s!==l&&(r=s-l,n=u>.5?r/(2-s-l):r/(s+l),t=60*(t=i===s?(o-a)/r+6*(o<a):o===s?(a-i)/r+2:(i-o)/r+4)+.5),[0|t,n||0,u]}function tp(e,t,n,r){return(Array.isArray(t)?e(t[0],t[1],t[2]):e(t,n,r)).map(te)}function th(e){return(e%360+360)%360}var tg={x:"dark",Z:"light",Y:"re",X:"blu",W:"gr",V:"medium",U:"slate",A:"ee",T:"ol",S:"or",B:"ra",C:"lateg",D:"ights",R:"in",Q:"turquois",E:"hi",P:"ro",O:"al",N:"le",M:"de",L:"yello",F:"en",K:"ch",G:"arks",H:"ea",I:"ightg",J:"wh"},tm={OiceXe:"f0f8ff",antiquewEte:"faebd7",aqua:"ffff",aquamarRe:"7fffd4",azuY:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"0",blanKedOmond:"ffebcd",Xe:"ff",XeviTet:"8a2be2",bPwn:"a52a2a",burlywood:"deb887",caMtXe:"5f9ea0",KartYuse:"7fff00",KocTate:"d2691e",cSO:"ff7f50",cSnflowerXe:"6495ed",cSnsilk:"fff8dc",crimson:"dc143c",cyan:"ffff",xXe:"8b",xcyan:"8b8b",xgTMnPd:"b8860b",xWay:"a9a9a9",xgYF:"6400",xgYy:"a9a9a9",xkhaki:"bdb76b",xmagFta:"8b008b",xTivegYF:"556b2f",xSange:"ff8c00",xScEd:"9932cc",xYd:"8b0000",xsOmon:"e9967a",xsHgYF:"8fbc8f",xUXe:"483d8b",xUWay:"2f4f4f",xUgYy:"2f4f4f",xQe:"ced1",xviTet:"9400d3",dAppRk:"ff1493",dApskyXe:"bfff",dimWay:"696969",dimgYy:"696969",dodgerXe:"1e90ff",fiYbrick:"b22222",flSOwEte:"fffaf0",foYstWAn:"228b22",fuKsia:"ff00ff",gaRsbSo:"dcdcdc",ghostwEte:"f8f8ff",gTd:"ffd700",gTMnPd:"daa520",Way:"808080",gYF:"8000",gYFLw:"adff2f",gYy:"808080",honeyMw:"f0fff0",hotpRk:"ff69b4",RdianYd:"cd5c5c",Rdigo:"4b0082",ivSy:"fffff0",khaki:"f0e68c",lavFMr:"e6e6fa",lavFMrXsh:"fff0f5",lawngYF:"7cfc00",NmoncEffon:"fffacd",ZXe:"add8e6",ZcSO:"f08080",Zcyan:"e0ffff",ZgTMnPdLw:"fafad2",ZWay:"d3d3d3",ZgYF:"90ee90",ZgYy:"d3d3d3",ZpRk:"ffb6c1",ZsOmon:"ffa07a",ZsHgYF:"20b2aa",ZskyXe:"87cefa",ZUWay:"778899",ZUgYy:"778899",ZstAlXe:"b0c4de",ZLw:"ffffe0",lime:"ff00",limegYF:"32cd32",lRF:"faf0e6",magFta:"ff00ff",maPon:"800000",VaquamarRe:"66cdaa",VXe:"cd",VScEd:"ba55d3",VpurpN:"9370db",VsHgYF:"3cb371",VUXe:"7b68ee",VsprRggYF:"fa9a",VQe:"48d1cc",VviTetYd:"c71585",midnightXe:"191970",mRtcYam:"f5fffa",mistyPse:"ffe4e1",moccasR:"ffe4b5",navajowEte:"ffdead",navy:"80",Tdlace:"fdf5e6",Tive:"808000",TivedBb:"6b8e23",Sange:"ffa500",SangeYd:"ff4500",ScEd:"da70d6",pOegTMnPd:"eee8aa",pOegYF:"98fb98",pOeQe:"afeeee",pOeviTetYd:"db7093",papayawEp:"ffefd5",pHKpuff:"ffdab9",peru:"cd853f",pRk:"ffc0cb",plum:"dda0dd",powMrXe:"b0e0e6",purpN:"800080",YbeccapurpN:"663399",Yd:"ff0000",Psybrown:"bc8f8f",PyOXe:"4169e1",saddNbPwn:"8b4513",sOmon:"fa8072",sandybPwn:"f4a460",sHgYF:"2e8b57",sHshell:"fff5ee",siFna:"a0522d",silver:"c0c0c0",skyXe:"87ceeb",UXe:"6a5acd",UWay:"708090",UgYy:"708090",snow:"fffafa",sprRggYF:"ff7f",stAlXe:"4682b4",tan:"d2b48c",teO:"8080",tEstN:"d8bfd8",tomato:"ff6347",Qe:"40e0d0",viTet:"ee82ee",JHt:"f5deb3",wEte:"ffffff",wEtesmoke:"f5f5f5",Lw:"ffff00",LwgYF:"9acd32"},tv=/^rgba?\(\s*([-+.\d]+)(%)?[\s,]+([-+.e\d]+)(%)?[\s,]+([-+.e\d]+)(%)?(?:[\s,/]+([-+.e\d]+)(%)?)?\s*\)$/,tx=function(e){return e<=.0031308?12.92*e:1.055*Math.pow(e,1/2.4)-.055},ty=function(e){return e<=.04045?e/12.92:Math.pow((e+.055)/1.055,2.4)};function tb(e,t,n){if(e){var r=tf(e);r[t]=Math.max(0,Math.min(r[t]+r[t]*n,0===t?360:1)),e.r=(r=tp(tu,r,void 0,void 0))[0],e.g=r[1],e.b=r[2]}}function tw(e,t){return e?Object.assign(t||{},e):e}function tk(e){var t={r:0,g:0,b:0,a:255};return Array.isArray(e)?e.length>=3&&(t={r:e[0],g:e[1],b:e[2],a:255},e.length>3&&(t.a=te(e[3]))):(t=tw(e,{r:0,g:0,b:0,a:1})).a=te(t.a),t}var t_=function(){function e(t){if((0,eX._)(this,e),(0,e3._)(t,e))return t;var n,i,o,a,s=void 0===t?"undefined":(0,e8._)(t);"object"===s?a=tk(t):"string"===s&&(i=t.length,"#"===t[0]&&(4===i||5===i?n={r:255&17*tr[t[1]],g:255&17*tr[t[2]],b:255&17*tr[t[3]],a:5===i?17*tr[t[4]]:255}:(7===i||9===i)&&(n={r:tr[t[1]]<<4|tr[t[2]],g:tr[t[3]]<<4|tr[t[4]],b:tr[t[5]]<<4|tr[t[6]],a:9===i?tr[t[7]]<<4|tr[t[8]]:255})),a=n||(r||((r=function(){var e,t,n,r,i,o={},a=Object.keys(tm),s=Object.keys(tg);for(e=0;e<a.length;e++){for(t=0,r=i=a[e];t<s.length;t++)n=s[t],i=i.replace(n,tg[n]);n=parseInt(tm[r],16),o[i]=[n>>16&255,n>>8&255,255&n]}return o}()).transparent=[0,0,0,0]),(o=r[t.toLowerCase()])&&{r:o[0],g:o[1],b:o[2],a:4===o.length?o[3]:255})||("r"===t.charAt(0)?function(e){var t,n,r,i=tv.exec(e),o=255;if(i){if(i[7]!==t){var a=+i[7];o=i[8]?e7(a):e9(255*a,0,255)}return t=+i[1],n=+i[3],r=+i[5],t=255&(i[2]?e7(t):e9(t,0,255)),{r:t,g:n=255&(i[4]?e7(n):e9(n,0,255)),b:r=255&(i[6]?e7(r):e9(r,0,255)),a:o}}}(t):function(e){var t,n=tl.exec(e),r=255;if(n){n[5]!==t&&(r=n[6]?e7(+n[5]):te(+n[5]));var i=th(+n[2]),o=n[3]/100,a=n[4]/100;return{r:(t="hwb"===n[1]?tp(td,i,o,a):"hsv"===n[1]?tp(tc,i,o,a):tp(tu,i,o,a))[0],g:t[1],b:t[2],a:r}}}(t))),this._rgb=a,this._valid=!!a}return(0,eJ._)(e,[{key:"valid",get:function(){return this._valid}},{key:"rgb",get:function(){var e=tw(this._rgb);return e&&(e.a=tt(e.a)),e},set:function(e){this._rgb=tk(e)}},{key:"rgbString",value:function(){var e;return this._valid?(e=this._rgb)&&(e.a<255?"rgba(".concat(e.r,", ").concat(e.g,", ").concat(e.b,", ").concat(tt(e.a),")"):"rgb(".concat(e.r,", ").concat(e.g,", ").concat(e.b,")")):void 0}},{key:"hexString",value:function(){var e,t,n,r;return this._valid?(n=ts((t=e=this._rgb).r)&&ts(t.g)&&ts(t.b)&&ts(t.a)?to:ta,e?"#"+n(e.r)+n(e.g)+n(e.b)+(r=e.a,r<255?n(r):""):void 0):void 0}},{key:"hslString",value:function(){return this._valid?function(e){if(e){var t=tf(e),n=t[0],r=tn(t[1]),i=tn(t[2]);return e.a<255?"hsla(".concat(n,", ").concat(r,"%, ").concat(i,"%, ").concat(tt(e.a),")"):"hsl(".concat(n,", ").concat(r,"%, ").concat(i,"%)")}}(this._rgb):void 0}},{key:"mix",value:function(e,t){if(e){var n,r=this.rgb,i=e.rgb,o=t===n?.5:t,a=2*o-1,s=r.a-i.a,l=((a*s==-1?a:(a+s)/(1+a*s))+1)/2;n=1-l,r.r=255&l*r.r+n*i.r+.5,r.g=255&l*r.g+n*i.g+.5,r.b=255&l*r.b+n*i.b+.5,r.a=o*r.a+(1-o)*i.a,this.rgb=r}return this}},{key:"interpolate",value:function(e,t){var n,r,i,o,a;return e&&(this._rgb=(n=this._rgb,r=e._rgb,i=ty(tt(n.r)),o=ty(tt(n.g)),a=ty(tt(n.b)),{r:te(tx(i+t*(ty(tt(r.r))-i))),g:te(tx(o+t*(ty(tt(r.g))-o))),b:te(tx(a+t*(ty(tt(r.b))-a))),a:n.a+t*(r.a-n.a)})),this}},{key:"clone",value:function(){return new e(this.rgb)}},{key:"alpha",value:function(e){return this._rgb.a=te(e),this}},{key:"clearer",value:function(e){var t=this._rgb;return t.a*=1-e,this}},{key:"greyscale",value:function(){var e=this._rgb,t=e6(.3*e.r+.59*e.g+.11*e.b);return e.r=e.g=e.b=t,this}},{key:"opaquer",value:function(e){var t=this._rgb;return t.a*=1+e,this}},{key:"negate",value:function(){var e=this._rgb;return e.r=255-e.r,e.g=255-e.g,e.b=255-e.b,this}},{key:"lighten",value:function(e){return tb(this._rgb,2,e),this}},{key:"darken",value:function(e){return tb(this._rgb,2,-e),this}},{key:"saturate",value:function(e){return tb(this._rgb,1,e),this}},{key:"desaturate",value:function(e){return tb(this._rgb,1,-e),this}},{key:"rotate",value:function(e){var t,n;return t=this._rgb,(n=tf(t))[0]=th(n[0]+e),t.r=(n=tp(tu,n,void 0,void 0))[0],t.g=n[1],t.b=n[2],this}}]),e}();function tS(){}var tC=(n=0,function(){return n++});function tj(e){return null==e}function tT(e){if(Array.isArray&&Array.isArray(e))return!0;var t=Object.prototype.toString.call(e);return"[object"===t.slice(0,7)&&"Array]"===t.slice(-6)}function tE(e){return null!==e&&"[object Object]"===Object.prototype.toString.call(e)}function tR(e){return("number"==typeof e||(0,e3._)(e,Number))&&isFinite(+e)}function tI(e,t){return tR(e)?e:t}function tA(e,t){return void 0===e?t:e}var tP=function(e,t){return"string"==typeof e&&e.endsWith("%")?parseFloat(e)/100*t:+e};function tD(e,t,n){if(e&&"function"==typeof e.call)return e.apply(n,t)}function tO(e,t,n,r){var i,o,a;if(tT(e))if(o=e.length,r)for(i=o-1;i>=0;i--)t.call(n,e[i],i);else for(i=0;i<o;i++)t.call(n,e[i],i);else if(tE(e))for(i=0,o=(a=Object.keys(e)).length;i<o;i++)t.call(n,e[a[i]],a[i])}function tN(e,t){var n,r,i,o;if(!e||!t||e.length!==t.length)return!1;for(n=0,r=e.length;n<r;++n)if(i=e[n],o=t[n],i.datasetIndex!==o.datasetIndex||i.index!==o.index)return!1;return!0}function tM(e){if(tT(e))return e.map(tM);if(tE(e)){for(var t=Object.create(null),n=Object.keys(e),r=n.length,i=0;i<r;++i)t[n[i]]=tM(e[n[i]]);return t}return e}function tL(e){return -1===["__proto__","prototype","constructor"].indexOf(e)}function tB(e,t,n,r){if(tL(e)){var i=t[e],o=n[e];tE(i)&&tE(o)?tV(i,o,r):t[e]=tM(o)}}function tV(e,t,n){var r,i=tT(t)?t:[t],o=i.length;if(!tE(e))return e;for(var a=(n=n||{}).merger||tB,s=0;s<o;++s)if(tE(r=i[s]))for(var l=Object.keys(r),u=0,c=l.length;u<c;++u)a(l[u],e,r,n);return e}function tF(e,t){return tV(e,t,{merger:tU})}function tU(e,t,n){if(tL(e)){var r=t[e],i=n[e];tE(r)&&tE(i)?tF(r,i):Object.prototype.hasOwnProperty.call(t,e)||(t[e]=tM(i))}}var tG={"":function(e){return e},x:function(e){return e.x},y:function(e){return e.y}};function t$(e,t){var n;return(tG[t]||(tG[t]=(n=function(e){var t=e.split("."),n=[],r="",i=!0,o=!1,a=void 0;try{for(var s,l=t[Symbol.iterator]();!(i=(s=l.next()).done);i=!0){var u=s.value;(r+=u).endsWith("\\")?r=r.slice(0,-1)+".":(n.push(r),r="")}}catch(e){o=!0,a=e}finally{try{i||null==l.return||l.return()}finally{if(o)throw a}}return n}(t),function(e){var t=!0,r=!1,i=void 0;try{for(var o,a=n[Symbol.iterator]();!(t=(o=a.next()).done);t=!0){var s=o.value;if(""===s)break;e=e&&e[s]}}catch(e){r=!0,i=e}finally{try{t||null==a.return||a.return()}finally{if(r)throw i}}return e})))(e)}function tz(e){return e.charAt(0).toUpperCase()+e.slice(1)}var tH=function(e){return void 0!==e},tW=function(e){return"function"==typeof e},tq=function(e,t){if(e.size!==t.size)return!1;var n=!0,r=!1,i=void 0;try{for(var o,a=e[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var s=o.value;if(!t.has(s))return!1}}catch(e){r=!0,i=e}finally{try{n||null==a.return||a.return()}finally{if(r)throw i}}return!0},tK=Math.PI,tY=2*tK,tQ=tY+tK,tX=1/0,tJ=tK/180,tZ=tK/2,t0=tK/4,t1=2*tK/3,t2=Math.log10,t3=Math.sign;function t4(e,t,n){return Math.abs(e-t)<n}function t8(e){var t=Math.round(e),n=Math.pow(10,Math.floor(t2(e=t4(e,t,e/1e3)?t:e))),r=e/n;return(r<=1?1:r<=2?2:r<=5?5:10)*n}function t5(e){return!isNaN(parseFloat(e))&&isFinite(e)}function t6(e,t,n){var r,i,o;for(r=0,i=e.length;r<i;r++)isNaN(o=e[r][n])||(t.min=Math.min(t.min,o),t.max=Math.max(t.max,o))}function t9(e){return tK/180*e}function t7(e){if(tR(e)){for(var t=1,n=0;Math.round(e*t)/t!==e;)t*=10,n++;return n}}function ne(e,t){var n=t.x-e.x,r=t.y-e.y,i=Math.sqrt(n*n+r*r),o=Math.atan2(r,n);return o<-.5*tK&&(o+=tY),{angle:o,distance:i}}function nt(e,t){return Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2))}function nn(e,t){return(e-t+tQ)%tY-tK}function nr(e){return(e%tY+tY)%tY}function ni(e,t,n,r){var i=nr(e),o=nr(t),a=nr(n),s=nr(o-i),l=nr(a-i),u=nr(i-o),c=nr(i-a);return i===o||i===a||r&&o===a||s>l&&u<c}function no(e,t,n){return Math.max(t,Math.min(n,e))}function na(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1e-6;return e>=Math.min(t,n)-r&&e<=Math.max(t,n)+r}function ns(e,t,n){n=n||function(n){return e[n]<t};for(var r,i=e.length-1,o=0;i-o>1;)n(r=o+i>>1)?o=r:i=r;return{lo:o,hi:i}}var nl=function(e,t,n,r){return ns(e,n,r?function(r){var i=e[r][t];return i<n||i===n&&e[r+1][t]===n}:function(r){return e[r][t]<n})},nu=function(e,t,n){return ns(e,n,function(r){return e[r][t]>=n})},nc=["push","pop","shift","splice","unshift"];function nd(e,t){var n=e._chartjs;if(n){var r=n.listeners,i=r.indexOf(t);-1!==i&&r.splice(i,1),r.length>0||(nc.forEach(function(t){delete e[t]}),delete e._chartjs)}}function nf(e){var t=new Set(e);return t.size===e.length?e:Array.from(t)}var np="undefined"==typeof window?function(e){return e()}:window.requestAnimationFrame;function nh(e,t){var n=[],r=!1;return function(){for(var i=arguments.length,o=Array(i),a=0;a<i;a++)o[a]=arguments[a];n=o,r||(r=!0,np.call(window,function(){r=!1,e.apply(t,n)}))}}var ng=function(e){return"start"===e?"left":"end"===e?"right":"center"},nm=function(e,t,n){return"start"===e?t:"end"===e?n:(t+n)/2};function nv(e,t,n){var r=t.length,i=0,o=r;if(e._sorted){var a=e.iScale,s=e._parsed,l=a.axis,u=a.getUserBounds(),c=u.min,d=u.max,f=u.minDefined,p=u.maxDefined;f&&(i=no(Math.min(nl(s,l,c).lo,n?r:nl(t,l,a.getPixelForValue(c)).lo),0,r-1)),o=p?no(Math.max(nl(s,a.axis,d,!0).hi+1,n?0:nl(t,l,a.getPixelForValue(d),!0).hi+1),i,r)-i:r-i}return{start:i,count:o}}function nx(e){var t=e.xScale,n=e.yScale,r=e._scaleRanges,i={xmin:t.min,xmax:t.max,ymin:n.min,ymax:n.max};if(!r)return e._scaleRanges=i,!0;var o=r.xmin!==t.min||r.xmax!==t.max||r.ymin!==n.min||r.ymax!==n.max;return Object.assign(r,i),o}var ny=function(e){return 0===e||1===e},nb=function(e,t,n){return-(Math.pow(2,10*(e-=1))*Math.sin((e-t)*tY/n))},nw=function(e,t,n){return Math.pow(2,-10*e)*Math.sin((e-t)*tY/n)+1},nk={linear:function(e){return e},easeInQuad:function(e){return e*e},easeOutQuad:function(e){return-e*(e-2)},easeInOutQuad:function(e){return(e/=.5)<1?.5*e*e:-.5*(--e*(e-2)-1)},easeInCubic:function(e){return e*e*e},easeOutCubic:function(e){return(e-=1)*e*e+1},easeInOutCubic:function(e){return(e/=.5)<1?.5*e*e*e:.5*((e-=2)*e*e+2)},easeInQuart:function(e){return e*e*e*e},easeOutQuart:function(e){return-((e-=1)*e*e*e-1)},easeInOutQuart:function(e){return(e/=.5)<1?.5*e*e*e*e:-.5*((e-=2)*e*e*e-2)},easeInQuint:function(e){return e*e*e*e*e},easeOutQuint:function(e){return(e-=1)*e*e*e*e+1},easeInOutQuint:function(e){return(e/=.5)<1?.5*e*e*e*e*e:.5*((e-=2)*e*e*e*e+2)},easeInSine:function(e){return-Math.cos(e*tZ)+1},easeOutSine:function(e){return Math.sin(e*tZ)},easeInOutSine:function(e){return -.5*(Math.cos(tK*e)-1)},easeInExpo:function(e){return 0===e?0:Math.pow(2,10*(e-1))},easeOutExpo:function(e){return 1===e?1:-Math.pow(2,-10*e)+1},easeInOutExpo:function(e){return ny(e)?e:e<.5?.5*Math.pow(2,10*(2*e-1)):.5*(-Math.pow(2,-10*(2*e-1))+2)},easeInCirc:function(e){return e>=1?e:-(Math.sqrt(1-e*e)-1)},easeOutCirc:function(e){return Math.sqrt(1-(e-=1)*e)},easeInOutCirc:function(e){return(e/=.5)<1?-.5*(Math.sqrt(1-e*e)-1):.5*(Math.sqrt(1-(e-=2)*e)+1)},easeInElastic:function(e){return ny(e)?e:nb(e,.075,.3)},easeOutElastic:function(e){return ny(e)?e:nw(e,.075,.3)},easeInOutElastic:function(e){return ny(e)?e:e<.5?.5*nb(2*e,.1125,.45):.5+.5*nw(2*e-1,.1125,.45)},easeInBack:function(e){return e*e*(2.70158*e-1.70158)},easeOutBack:function(e){return(e-=1)*e*(2.70158*e+1.70158)+1},easeInOutBack:function(e){var t=1.70158;return(e/=.5)<1?.5*(e*e*(((t*=1.525)+1)*e-t)):.5*((e-=2)*e*(((t*=1.525)+1)*e+t)+2)},easeInBounce:function(e){return 1-nk.easeOutBounce(1-e)},easeOutBounce:function(e){return e<.36363636363636365?7.5625*e*e:e<.7272727272727273?7.5625*(e-=.5454545454545454)*e+.75:e<.9090909090909091?7.5625*(e-=.8181818181818182)*e+.9375:7.5625*(e-=.9545454545454546)*e+.984375},easeInOutBounce:function(e){return e<.5?.5*nk.easeInBounce(2*e):.5*nk.easeOutBounce(2*e-1)+.5}};function n_(e){if(e&&(void 0===e?"undefined":(0,e8._)(e))==="object"){var t=e.toString();return"[object CanvasPattern]"===t||"[object CanvasGradient]"===t}return!1}function nS(e){return n_(e)?e:new t_(e)}function nC(e){return n_(e)?e:new t_(e).saturate(.5).darken(.1).hexString()}var nj=["x","y","borderWidth","radius","tension"],nT=["color","borderColor","backgroundColor"],nE=new Map;function nR(e,t,n){var r,i,o;return(i=t+JSON.stringify(r=(r=n)||{}),!(o=nE.get(i))&&(o=new Intl.NumberFormat(t,r),nE.set(i,o)),o).format(e)}var nI={values:function(e){return tT(e)?e:""+e},numeric:function(e,t,n){if(0===e)return"0";var r,i=this.chart.options.locale,o=e;if(n.length>1){var a,s,l,u=Math.max(Math.abs(n[0].value),Math.abs(n[n.length-1].value));(u<1e-4||u>1e15)&&(r="scientific"),a=e,Math.abs(l=(s=n).length>3?s[2].value-s[1].value:s[1].value-s[0].value)>=1&&a!==Math.floor(a)&&(l=a-Math.floor(a)),o=l}var c=t2(Math.abs(o)),d=isNaN(c)?1:Math.max(Math.min(-1*Math.floor(c),20),0),f={notation:r,minimumFractionDigits:d,maximumFractionDigits:d};return Object.assign(f,this.options.ticks.format),nR(e,i,f)},logarithmic:function(e,t,n){return 0===e?"0":[1,2,3,5,10,15].includes(n[t].significand||e/Math.pow(10,Math.floor(t2(e))))||t>.8*n.length?nI.numeric.call(this,e,t,n):""}},nA=Object.create(null),nP=Object.create(null);function nD(e,t){if(!t)return e;for(var n=t.split("."),r=0,i=n.length;r<i;++r){var o=n[r];e=e[o]||(e[o]=Object.create(null))}return e}function nO(e,t,n){return"string"==typeof t?tV(nD(e,t),n):tV(nD(e,""),t)}var nN=new(function(){function e(t,n){(0,eX._)(this,e),this.animation=void 0,this.backgroundColor="rgba(0,0,0,0.1)",this.borderColor="rgba(0,0,0,0.1)",this.color="#666",this.datasets={},this.devicePixelRatio=function(e){return e.chart.platform.getDevicePixelRatio()},this.elements={},this.events=["mousemove","mouseout","click","touchstart","touchmove"],this.font={family:"'Helvetica Neue', 'Helvetica', 'Arial', sans-serif",size:12,style:"normal",lineHeight:1.2,weight:null},this.hover={},this.hoverBackgroundColor=function(e,t){return nC(t.backgroundColor)},this.hoverBorderColor=function(e,t){return nC(t.borderColor)},this.hoverColor=function(e,t){return nC(t.color)},this.indexAxis="x",this.interaction={mode:"nearest",intersect:!0,includeInvisible:!1},this.maintainAspectRatio=!0,this.onHover=null,this.onClick=null,this.parsing=!0,this.plugins={},this.responsive=!0,this.scale=void 0,this.scales={},this.showLine=!0,this.drawActiveElementsOnTop=!0,this.describe(t),this.apply(n)}return(0,eJ._)(e,[{key:"set",value:function(e,t){return nO(this,e,t)}},{key:"get",value:function(e){return nD(this,e)}},{key:"describe",value:function(e,t){return nO(nP,e,t)}},{key:"override",value:function(e,t){return nO(nA,e,t)}},{key:"route",value:function(e,t,n,r){var i,o=nD(this,e),a=nD(this,n),s="_"+t;Object.defineProperties(o,(i={},(0,eZ._)(i,s,{value:o[t],writable:!0}),(0,eZ._)(i,t,{enumerable:!0,get:function(){var e=this[s],t=a[r];return tE(e)?Object.assign({},t,e):tA(e,t)},set:function(e){this[s]=e}}),i))}},{key:"apply",value:function(e){var t=this;e.forEach(function(e){return e(t)})}}]),e}())({_scriptable:function(e){return!e.startsWith("on")},_indexable:function(e){return"events"!==e},hover:{_fallback:"interaction"},interaction:{_scriptable:!1,_indexable:!1}},[function(e){e.set("animation",{delay:void 0,duration:1e3,easing:"easeOutQuart",fn:void 0,from:void 0,loop:void 0,to:void 0,type:void 0}),e.describe("animation",{_fallback:!1,_indexable:!1,_scriptable:function(e){return"onProgress"!==e&&"onComplete"!==e&&"fn"!==e}}),e.set("animations",{colors:{type:"color",properties:nT},numbers:{type:"number",properties:nj}}),e.describe("animations",{_fallback:"animation"}),e.set("transitions",{active:{animation:{duration:400}},resize:{animation:{duration:0}},show:{animations:{colors:{from:"transparent"},visible:{type:"boolean",duration:0}}},hide:{animations:{colors:{to:"transparent"},visible:{type:"boolean",easing:"linear",fn:function(e){return 0|e}}}}})},function(e){e.set("layout",{autoPadding:!0,padding:{top:0,right:0,bottom:0,left:0}})},function(e){e.set("scale",{display:!0,offset:!1,reverse:!1,beginAtZero:!1,bounds:"ticks",clip:!0,grace:0,grid:{display:!0,lineWidth:1,drawOnChartArea:!0,drawTicks:!0,tickLength:8,tickWidth:function(e,t){return t.lineWidth},tickColor:function(e,t){return t.color},offset:!1},border:{display:!0,dash:[],dashOffset:0,width:1},title:{display:!1,text:"",padding:{top:4,bottom:4}},ticks:{minRotation:0,maxRotation:50,mirror:!1,textStrokeWidth:0,textStrokeColor:"",padding:3,display:!0,autoSkip:!0,autoSkipPadding:3,labelOffset:0,callback:nI.values,minor:{},major:{},align:"center",crossAlign:"near",showLabelBackdrop:!1,backdropColor:"rgba(255, 255, 255, 0.75)",backdropPadding:2}}),e.route("scale.ticks","color","","color"),e.route("scale.grid","color","","borderColor"),e.route("scale.border","color","","borderColor"),e.route("scale.title","color","","color"),e.describe("scale",{_fallback:!1,_scriptable:function(e){return!e.startsWith("before")&&!e.startsWith("after")&&"callback"!==e&&"parser"!==e},_indexable:function(e){return"borderDash"!==e&&"tickBorderDash"!==e&&"dash"!==e}}),e.describe("scales",{_fallback:"scale"}),e.describe("scale.ticks",{_scriptable:function(e){return"backdropPadding"!==e&&"callback"!==e},_indexable:function(e){return"backdropPadding"!==e}})}]);function nM(e,t,n,r,i){var o=t[i];return o||(o=t[i]=e.measureText(i).width,n.push(i)),o>r&&(r=o),r}function nL(e,t,n){var r=e.currentDevicePixelRatio,i=0!==n?Math.max(n/2,.5):0;return Math.round((t-i)*r)/r+i}function nB(e,t){(t=t||e.getContext("2d")).save(),t.resetTransform(),t.clearRect(0,0,e.width,e.height),t.restore()}function nV(e,t,n,r){nF(e,t,n,r,null)}function nF(e,t,n,r,i){var o,a,s,l,u,c,d,f,p=t.pointStyle,h=t.rotation,g=t.radius,m=(h||0)*tJ;if(p&&(void 0===p?"undefined":(0,e8._)(p))==="object"&&("[object HTMLImageElement]"===(o=p.toString())||"[object HTMLCanvasElement]"===o)){e.save(),e.translate(n,r),e.rotate(m),e.drawImage(p,-p.width/2,-p.height/2,p.width,p.height),e.restore();return}if(!isNaN(g)&&!(g<=0)){switch(e.beginPath(),p){default:i?e.ellipse(n,r,i/2,g,0,0,tY):e.arc(n,r,g,0,tY),e.closePath();break;case"triangle":c=i?i/2:g,e.moveTo(n+Math.sin(m)*c,r-Math.cos(m)*g),m+=t1,e.lineTo(n+Math.sin(m)*c,r-Math.cos(m)*g),m+=t1,e.lineTo(n+Math.sin(m)*c,r-Math.cos(m)*g),e.closePath();break;case"rectRounded":u=.516*g,a=Math.cos(m+t0)*(l=g-u),d=Math.cos(m+t0)*(i?i/2-u:l),s=Math.sin(m+t0)*l,f=Math.sin(m+t0)*(i?i/2-u:l),e.arc(n-d,r-s,u,m-tK,m-tZ),e.arc(n+f,r-a,u,m-tZ,m),e.arc(n+d,r+s,u,m,m+tZ),e.arc(n-f,r+a,u,m+tZ,m+tK),e.closePath();break;case"rect":if(!h){l=Math.SQRT1_2*g,c=i?i/2:l,e.rect(n-c,r-l,2*c,2*l);break}m+=t0;case"rectRot":d=Math.cos(m)*(i?i/2:g),a=Math.cos(m)*g,s=Math.sin(m)*g,f=Math.sin(m)*(i?i/2:g),e.moveTo(n-d,r-s),e.lineTo(n+f,r-a),e.lineTo(n+d,r+s),e.lineTo(n-f,r+a),e.closePath();break;case"crossRot":m+=t0;case"cross":d=Math.cos(m)*(i?i/2:g),a=Math.cos(m)*g,s=Math.sin(m)*g,f=Math.sin(m)*(i?i/2:g),e.moveTo(n-d,r-s),e.lineTo(n+d,r+s),e.moveTo(n+f,r-a),e.lineTo(n-f,r+a);break;case"star":d=Math.cos(m)*(i?i/2:g),a=Math.cos(m)*g,s=Math.sin(m)*g,f=Math.sin(m)*(i?i/2:g),e.moveTo(n-d,r-s),e.lineTo(n+d,r+s),e.moveTo(n+f,r-a),e.lineTo(n-f,r+a),m+=t0,d=Math.cos(m)*(i?i/2:g),a=Math.cos(m)*g,s=Math.sin(m)*g,f=Math.sin(m)*(i?i/2:g),e.moveTo(n-d,r-s),e.lineTo(n+d,r+s),e.moveTo(n+f,r-a),e.lineTo(n-f,r+a);break;case"line":a=i?i/2:Math.cos(m)*g,s=Math.sin(m)*g,e.moveTo(n-a,r-s),e.lineTo(n+a,r+s);break;case"dash":e.moveTo(n,r),e.lineTo(n+Math.cos(m)*(i?i/2:g),r+Math.sin(m)*g);break;case!1:e.closePath()}e.fill(),t.borderWidth>0&&e.stroke()}}function nU(e,t,n){return n=n||.5,!t||e&&e.x>t.left-n&&e.x<t.right+n&&e.y>t.top-n&&e.y<t.bottom+n}function nG(e,t){e.save(),e.beginPath(),e.rect(t.left,t.top,t.right-t.left,t.bottom-t.top),e.clip()}function n$(e){e.restore()}function nz(e,t,n,r,i){if(!t)return e.lineTo(n.x,n.y);if("middle"===i){var o=(t.x+n.x)/2;e.lineTo(o,t.y),e.lineTo(o,n.y)}else"after"===i!=!!r?e.lineTo(t.x,n.y):e.lineTo(n.x,t.y);e.lineTo(n.x,n.y)}function nH(e,t,n,r){if(!t)return e.lineTo(n.x,n.y);e.bezierCurveTo(r?t.cp1x:t.cp2x,r?t.cp1y:t.cp2y,r?n.cp2x:n.cp1x,r?n.cp2y:n.cp1y,n.x,n.y)}function nW(e,t,n,r,i){var o,a,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{},l=tT(t)?t:[t],u=s.strokeWidth>0&&""!==s.strokeColor;for(e.save(),e.font=i.string,s.translation&&e.translate(s.translation[0],s.translation[1]),tj(s.rotation)||e.rotate(s.rotation),s.color&&(e.fillStyle=s.color),s.textAlign&&(e.textAlign=s.textAlign),s.textBaseline&&(e.textBaseline=s.textBaseline),o=0;o<l.length;++o)a=l[o],s.backdrop&&function(e,t){var n=e.fillStyle;e.fillStyle=t.color,e.fillRect(t.left,t.top,t.width,t.height),e.fillStyle=n}(e,s.backdrop),u&&(s.strokeColor&&(e.strokeStyle=s.strokeColor),tj(s.strokeWidth)||(e.lineWidth=s.strokeWidth),e.strokeText(a,n,r,s.maxWidth)),e.fillText(a,n,r,s.maxWidth),function(e,t,n,r,i){if(i.strikethrough||i.underline){var o=e.measureText(r),a=t-o.actualBoundingBoxLeft,s=t+o.actualBoundingBoxRight,l=n-o.actualBoundingBoxAscent,u=n+o.actualBoundingBoxDescent,c=i.strikethrough?(l+u)/2:u;e.strokeStyle=e.fillStyle,e.beginPath(),e.lineWidth=i.decorationWidth||2,e.moveTo(a,c),e.lineTo(s,c),e.stroke()}}(e,n,r,a,s),r+=Number(i.lineHeight);e.restore()}function nq(e,t){var n=t.x,r=t.y,i=t.w,o=t.h,a=t.radius;e.arc(n+a.topLeft,r+a.topLeft,a.topLeft,1.5*tK,tK,!0),e.lineTo(n,r+o-a.bottomLeft),e.arc(n+a.bottomLeft,r+o-a.bottomLeft,a.bottomLeft,tK,tZ,!0),e.lineTo(n+i-a.bottomRight,r+o),e.arc(n+i-a.bottomRight,r+o-a.bottomRight,a.bottomRight,tZ,0,!0),e.lineTo(n+i,r+a.topRight),e.arc(n+i-a.topRight,r+a.topRight,a.topRight,0,-tZ,!0),e.lineTo(n+a.topLeft,r)}var nK=/^(normal|(\d+(?:\.\d+)?)(px|em|%)?)$/,nY=/^(normal|italic|initial|inherit|unset|(oblique( -?[0-9]?[0-9]deg)?))$/;function nQ(e,t){var n={},r=tE(t),i=r?Object.keys(t):t,o=tE(e)?r?function(n){return tA(e[n],e[t[n]])}:function(t){return e[t]}:function(){return e},a=!0,s=!1,l=void 0;try{for(var u,c=i[Symbol.iterator]();!(a=(u=c.next()).done);a=!0){var d=u.value;n[d]=+o(d)||0}}catch(e){s=!0,l=e}finally{try{a||null==c.return||c.return()}finally{if(s)throw l}}return n}function nX(e){return nQ(e,{top:"y",right:"x",bottom:"y",left:"x"})}function nJ(e){return nQ(e,["topLeft","topRight","bottomLeft","bottomRight"])}function nZ(e){var t=nX(e);return t.width=t.left+t.right,t.height=t.top+t.bottom,t}function n0(e,t){e=e||{},t=t||nN.font;var n=tA(e.size,t.size);"string"==typeof n&&(n=parseInt(n,10));var r=tA(e.style,t.style);r&&!(""+r).match(nY)&&(console.warn('Invalid font style specified: "'+r+'"'),r=void 0);var i={family:tA(e.family,t.family),lineHeight:function(e,t){var n=(""+e).match(nK);if(!n||"normal"===n[1])return 1.2*t;switch(e=+n[2],n[3]){case"px":return e;case"%":e/=100}return t*e}(tA(e.lineHeight,t.lineHeight),n),size:n,style:r,weight:tA(e.weight,t.weight),string:""};return i.string=!i||tj(i.size)||tj(i.family)?null:(i.style?i.style+" ":"")+(i.weight?i.weight+" ":"")+i.size+"px "+i.family,i}function n1(e,t,n,r){var i,o,a,s=!0;for(i=0,o=e.length;i<o;++i)if(void 0!==(a=e[i])&&(void 0!==t&&"function"==typeof a&&(a=a(t),s=!1),void 0!==n&&tT(a)&&(a=a[n%a.length],s=!1),void 0!==a))return r&&!s&&(r.cacheable=!1),a}function n2(e,t){return Object.assign(Object.create(e),t)}function n3(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[""],r=arguments.length>2?arguments[2]:void 0,i=arguments.length>3?arguments[3]:void 0,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:function(){return e[0]},a=r||e;return void 0===i&&(i=re("_fallback",e)),new Proxy((t={},(0,eZ._)(t,Symbol.toStringTag,"Object"),(0,eZ._)(t,"_cacheable",!0),(0,eZ._)(t,"_scopes",e),(0,eZ._)(t,"_rootScopes",a),(0,eZ._)(t,"_fallback",i),(0,eZ._)(t,"_getTarget",o),(0,eZ._)(t,"override",function(t){return n3([t].concat((0,e4._)(e)),n,a,i)}),t),{deleteProperty:function(t,n){return delete t[n],delete t._keys,delete e[0][n],!0},get:function(t,r){return n6(t,r,function(){return function(e,t,n,r){var i=!0,o=!1,a=void 0;try{for(var s,l,u=t[Symbol.iterator]();!(i=(l=u.next()).done);i=!0){var c=l.value;if(s=re(c?c+tz(e):e,n),void 0!==s)return n5(e,s)?n9(n,r,e,s):s}}catch(e){o=!0,a=e}finally{try{i||null==u.return||u.return()}finally{if(o)throw a}}}(r,n,e,t)})},getOwnPropertyDescriptor:function(e,t){return Reflect.getOwnPropertyDescriptor(e._scopes[0],t)},getPrototypeOf:function(){return Reflect.getPrototypeOf(e[0])},has:function(e,t){return rt(e).includes(t)},ownKeys:function(e){return rt(e)},set:function(e,t,n){var r=e._storage||(e._storage=o());return e[t]=r[t]=n,delete e._keys,!0}})}function n4(e,t,n,r){return new Proxy({_cacheable:!1,_proxy:e,_context:t,_subProxy:n,_stack:new Set,_descriptors:n8(e,r),setContext:function(t){return n4(e,t,n,r)},override:function(i){return n4(e.override(i),t,n,r)}},{deleteProperty:function(t,n){return delete t[n],delete e[n],!0},get:function(e,t,n){return n6(e,t,function(){var r,i,o,a,s,l,u,c;return r=e,i=t,o=n,a=r._proxy,s=r._context,l=r._subProxy,u=r._descriptors,tW(c=a[i])&&u.isScriptable(i)&&(c=function(e,t,n,r){var i=n._proxy,o=n._context,a=n._subProxy,s=n._stack;if(s.has(e))throw Error("Recursion detected: "+Array.from(s).join("->")+"->"+e);s.add(e);var l=t(o,a||r);return s.delete(e),n5(e,l)&&(l=n9(i._scopes,i,e,l)),l}(i,c,r,o)),tT(c)&&c.length&&(c=function(e,t,n,r){var i=n._proxy,o=n._context,a=n._subProxy,s=n._descriptors;if(void 0!==o.index&&r(e))return t[o.index%t.length];if(tE(t[0])){var l=t,u=i._scopes.filter(function(e){return e!==l});t=[];var c=!0,d=!1,f=void 0;try{for(var p,h=l[Symbol.iterator]();!(c=(p=h.next()).done);c=!0){var g=p.value,m=n9(u,i,e,g);t.push(n4(m,o,a&&a[e],s))}}catch(e){d=!0,f=e}finally{try{c||null==h.return||h.return()}finally{if(d)throw f}}}return t}(i,c,r,u.isIndexable)),n5(i,c)&&(c=n4(c,s,l&&l[i],u)),c})},getOwnPropertyDescriptor:function(t,n){return t._descriptors.allKeys?Reflect.has(e,n)?{enumerable:!0,configurable:!0}:void 0:Reflect.getOwnPropertyDescriptor(e,n)},getPrototypeOf:function(){return Reflect.getPrototypeOf(e)},has:function(t,n){return Reflect.has(e,n)},ownKeys:function(){return Reflect.ownKeys(e)},set:function(t,n,r){return e[n]=r,delete t[n],!0}})}function n8(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{scriptable:!0,indexable:!0},n=e._scriptable,r=void 0===n?t.scriptable:n,i=e._indexable,o=void 0===i?t.indexable:i,a=e._allKeys;return{allKeys:void 0===a?t.allKeys:a,scriptable:r,indexable:o,isScriptable:tW(r)?r:function(){return r},isIndexable:tW(o)?o:function(){return o}}}var n5=function(e,t){return tE(t)&&"adapters"!==e&&(null===Object.getPrototypeOf(t)||t.constructor===Object)};function n6(e,t,n){if(Object.prototype.hasOwnProperty.call(e,t))return e[t];var r=n();return e[t]=r,r}function n9(e,t,n,r){var i,o=t._rootScopes,a=(i=t._fallback,tW(i)?i(n,r):i),s=(0,e4._)(e).concat((0,e4._)(o)),l=new Set;l.add(r);var u=n7(l,s,n,a||n,r);return null!==u&&(void 0===a||a===n||null!==(u=n7(l,s,a,u,r)))&&n3(Array.from(l),[""],o,a,function(){var e,i,o,a,s;return e=t,i=n,o=r,i in(a=e._getTarget())||(a[i]={}),tT(s=a[i])&&tE(o)?o:s||{}})}function n7(e,t,n,r,i){for(;n;)n=function(e,t,n,r,i){var o=!0,a=!1,s=void 0;try{for(var l,u=t[Symbol.iterator]();!(o=(l=u.next()).done);o=!0){var c=l.value,d=!0===n?c:"string"==typeof n?t$(c,n):void 0;if(d){e.add(d);var f,p=(f=d._fallback,tW(f)?f(n,i):f);if(void 0!==p&&p!==n&&p!==r)return p}else if(!1===d&&void 0!==r&&n!==r)return null}}catch(e){a=!0,s=e}finally{try{o||null==u.return||u.return()}finally{if(a)throw s}}return!1}(e,t,n,r,i);return n}function re(e,t){var n=!0,r=!1,i=void 0;try{for(var o,a=t[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var s=o.value;if(s){var l=s[e];if(void 0!==l)return l}}}catch(e){r=!0,i=e}finally{try{n||null==a.return||a.return()}finally{if(r)throw i}}}function rt(e){var t=e._keys;return t||(t=e._keys=function(e){var t=new Set,n=!0,r=!1,i=void 0;try{for(var o,a=e[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var s=o.value,l=!0,u=!1,c=void 0;try{for(var d,f=Object.keys(s).filter(function(e){return!e.startsWith("_")})[Symbol.iterator]();!(l=(d=f.next()).done);l=!0){var p=d.value;t.add(p)}}catch(e){u=!0,c=e}finally{try{l||null==f.return||f.return()}finally{if(u)throw c}}}}catch(e){r=!0,i=e}finally{try{n||null==a.return||a.return()}finally{if(r)throw i}}return Array.from(t)}(e._scopes)),t}function rn(e,t,n,r){var i,o,a,s=e.iScale,l=this._parsing.key,u=void 0===l?"r":l,c=Array(r);for(i=0;i<r;++i)a=t[o=i+n],c[i]={r:s.parse(t$(a,u),o)};return c}var rr=Number.EPSILON||1e-14,ri=function(e,t){return t<e.length&&!e[t].skip&&e[t]},ro=function(e){return"x"===e?"y":"x"};function ra(e,t,n){return Math.max(Math.min(e,n),t)}function rs(){return"undefined"!=typeof window&&"undefined"!=typeof document}function rl(e){var t=e.parentNode;return t&&"[object ShadowRoot]"===t.toString()&&(t=t.host),t}function ru(e,t,n){var r;return"string"==typeof e?(r=parseInt(e,10),-1!==e.indexOf("%")&&(r=r/100*t.parentNode[n])):r=e,r}var rc=function(e){return e.ownerDocument.defaultView.getComputedStyle(e,null)},rd=["top","right","bottom","left"];function rf(e,t,n){var r={};n=n?"-"+n:"";for(var i=0;i<4;i++){var o=rd[i];r[o]=parseFloat(e[t+"-"+o+n])||0}return r.width=r.left+r.right,r.height=r.top+r.bottom,r}function rp(e,t){if("native"in e)return e;var n=t.canvas,r=t.currentDevicePixelRatio,i=rc(n),o="border-box"===i.boxSizing,a=rf(i,"padding"),s=rf(i,"border","width"),l=function(e,t){var n,r,i,o=e.touches,a=o&&o.length?o[0]:e,s=a.offsetX,l=a.offsetY,u=!1;if(n=e.target,(s>0||l>0)&&(!n||!n.shadowRoot))r=s,i=l;else{var c=t.getBoundingClientRect();r=a.clientX-c.left,i=a.clientY-c.top,u=!0}return{x:r,y:i,box:u}}(e,n),u=l.x,c=l.y,d=l.box,f=a.left+(d&&s.left),p=a.top+(d&&s.top),h=t.width,g=t.height;return o&&(h-=a.width+s.width,g-=a.height+s.height),{x:Math.round((u-f)/h*n.width/r),y:Math.round((c-p)/g*n.height/r)}}var rh=function(e){return Math.round(10*e)/10};function rg(e,t,n){var r=t||1,i=Math.floor(e.height*r),o=Math.floor(e.width*r);e.height=Math.floor(e.height),e.width=Math.floor(e.width);var a=e.canvas;return a.style&&(n||!a.style.height&&!a.style.width)&&(a.style.height="".concat(e.height,"px"),a.style.width="".concat(e.width,"px")),(e.currentDevicePixelRatio!==r||a.height!==i||a.width!==o)&&(e.currentDevicePixelRatio=r,a.height=i,a.width=o,e.ctx.setTransform(r,0,0,r,0,0),!0)}var rm=function(){var e=!1;try{var t={get passive(){return e=!0,!1}};window.addEventListener("test",null,t),window.removeEventListener("test",null,t)}catch(e){}return e}();function rv(e,t){var n=rc(e).getPropertyValue(t),r=n&&n.match(/^(\d+)(\.\d+)?px$/);return r?+r[1]:void 0}function rx(e,t,n,r){return{x:e.x+n*(t.x-e.x),y:e.y+n*(t.y-e.y)}}function ry(e,t,n,r){return{x:e.x+n*(t.x-e.x),y:"middle"===r?n<.5?e.y:t.y:"after"===r?n<1?e.y:t.y:n>0?t.y:e.y}}function rb(e,t,n,r){var i={x:e.cp2x,y:e.cp2y},o={x:t.cp1x,y:t.cp1y},a=rx(e,i,n),s=rx(i,o,n),l=rx(o,t,n),u=rx(a,s,n),c=rx(s,l,n);return rx(u,c,n)}function rw(e,t,n){var r;return e?(r=n,{x:function(e){return t+t+r-e},setWidth:function(e){r=e},textAlign:function(e){return"center"===e?e:"right"===e?"left":"right"},xPlus:function(e,t){return e-t},leftForLtr:function(e,t){return e-t}}):{x:function(e){return e},setWidth:function(e){},textAlign:function(e){return e},xPlus:function(e,t){return e+t},leftForLtr:function(e,t){return e}}}function rk(e,t){var n,r;("ltr"===t||"rtl"===t)&&(r=[(n=e.canvas.style).getPropertyValue("direction"),n.getPropertyPriority("direction")],n.setProperty("direction",t,"important"),e.prevTextDirection=r)}function r_(e,t){void 0!==t&&(delete e.prevTextDirection,e.canvas.style.setProperty("direction",t[0],t[1]))}function rS(e){return"angle"===e?{between:ni,compare:nn,normalize:nr}:{between:na,compare:function(e,t){return e-t},normalize:function(e){return e}}}function rC(e){var t=e.start,n=e.end,r=e.count;return{start:t%r,end:n%r,loop:e.loop&&(n-t+1)%r==0,style:e.style}}function rj(e,t,n){if(!n)return[e];for(var r,i,o,a=n.property,s=n.start,l=n.end,u=t.length,c=rS(a),d=c.compare,f=c.between,p=c.normalize,h=function(e,t,n){var r,i=n.property,o=n.start,a=n.end,s=rS(i),l=s.between,u=s.normalize,c=t.length,d=e.start,f=e.end,p=e.loop;if(p){for(d+=c,f+=c,r=0;r<c&&l(u(t[d%c][i]),o,a);++r)d--,f--;d%=c,f%=c}return f<d&&(f+=c),{start:d,end:f,loop:p,style:e.style}}(e,t,n),g=h.start,m=h.end,x=h.loop,y=h.style,b=[],w=!1,k=null,_=g,S=g;_<=m;++_)(i=t[_%u]).skip||(r=p(i[a]))!==o&&(w=f(r,s,l),null===k&&(w||f(s,o,r)&&0!==d(s,o))&&(k=0===d(r,s)?_:S),null!==k&&(!w||0===d(l,r)||f(l,o,r))&&(b.push(rC({start:k,end:_,loop:x,count:u,style:y})),k=null),S=_,o=r);return null!==k&&b.push(rC({start:k,end:m,loop:x,count:u,style:y})),b}function rT(e,t){for(var n=[],r=e.segments,i=0;i<r.length;i++){var o=rj(r[i],e.points,t);o.length&&n.push.apply(n,(0,e4._)(o))}return n}function rE(e,t,n,r){return r&&r.setContext&&n?function(e,t,n,r){var i=e._chart.getContext(),o=rR(e.options),a=e._datasetIndex,s=e.options.spanGaps,l=n.length,u=[],c=o,d=t[0].start,f=d;function p(e,t,r,i){var o=s?-1:1;if(e!==t){for(e+=l;n[e%l].skip;)e-=o;for(;n[t%l].skip;)t+=o;e%l!=t%l&&(u.push({start:e%l,end:t%l,loop:r,style:i}),c=i,d=t%l)}}var h=!0,g=!1,m=void 0;try{for(var x,y=t[Symbol.iterator]();!(h=(x=y.next()).done);h=!0){var b=x.value,w=n[(d=s?d:b.start)%l],k=void 0;for(f=d+1;f<=b.end;f++){var _=n[f%l];k=rR(r.setContext(n2(i,{type:"segment",p0:w,p1:_,p0DataIndex:(f-1)%l,p1DataIndex:f%l,datasetIndex:a}))),function(e,t){if(!t)return!1;var n=[],r=function(e,t){return n_(t)?(n.includes(t)||n.push(t),n.indexOf(t)):t};return JSON.stringify(e,r)!==JSON.stringify(t,r)}(k,c)&&p(d,f-1,b.loop,c),w=_,c=k}d<f-1&&p(d,f-1,b.loop,c)}}catch(e){g=!0,m=e}finally{try{h||null==y.return||y.return()}finally{if(g)throw m}}return u}(e,t,n,r):t}function rR(e){return{backgroundColor:e.backgroundColor,borderCapStyle:e.borderCapStyle,borderDash:e.borderDash,borderDashOffset:e.borderDashOffset,borderJoinStyle:e.borderJoinStyle,borderWidth:e.borderWidth,borderColor:e.borderColor}}var rI=new(function(){function e(){(0,eX._)(this,e),this._request=null,this._charts=new Map,this._running=!1,this._lastDate=void 0}return(0,eJ._)(e,[{key:"_notify",value:function(e,t,n,r){var i=t.listeners[r],o=t.duration;i.forEach(function(r){return r({chart:e,initial:t.initial,numSteps:o,currentStep:Math.min(n-t.start,o)})})}},{key:"_refresh",value:function(){var e=this;this._request||(this._running=!0,this._request=np.call(window,function(){e._update(),e._request=null,e._running&&e._refresh()}))}},{key:"_update",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Date.now(),n=0;this._charts.forEach(function(r,i){if(r.running&&r.items.length){for(var o,a=r.items,s=a.length-1,l=!1;s>=0;--s)(o=a[s])._active?(o._total>r.duration&&(r.duration=o._total),o.tick(t),l=!0):(a[s]=a[a.length-1],a.pop());l&&(i.draw(),e._notify(i,r,t,"progress")),a.length||(r.running=!1,e._notify(i,r,t,"complete"),r.initial=!1),n+=a.length}}),this._lastDate=t,0===n&&(this._running=!1)}},{key:"_getAnims",value:function(e){var t=this._charts,n=t.get(e);return n||(n={running:!1,initial:!0,items:[],listeners:{complete:[],progress:[]}},t.set(e,n)),n}},{key:"listen",value:function(e,t,n){this._getAnims(e).listeners[t].push(n)}},{key:"add",value:function(e,t){var n;t&&t.length&&(n=this._getAnims(e).items).push.apply(n,(0,e4._)(t))}},{key:"has",value:function(e){return this._getAnims(e).items.length>0}},{key:"start",value:function(e){var t=this._charts.get(e);t&&(t.running=!0,t.start=Date.now(),t.duration=t.items.reduce(function(e,t){return Math.max(e,t._duration)},0),this._refresh())}},{key:"running",value:function(e){if(!this._running)return!1;var t=this._charts.get(e);return!!t&&!!t.running&&!!t.items.length}},{key:"stop",value:function(e){var t=this._charts.get(e);if(t&&t.items.length){for(var n=t.items,r=n.length-1;r>=0;--r)n[r].cancel();t.items=[],this._notify(e,t,Date.now(),"complete")}}},{key:"remove",value:function(e){return this._charts.delete(e)}}]),e}()),rA="transparent",rP={boolean:function(e,t,n){return n>.5?t:e},color:function(e,t,n){var r=nS(e||rA),i=r.valid&&nS(t||rA);return i&&i.valid?i.mix(r,n).hexString():t},number:function(e,t,n){return e+(t-e)*n}},rD=function(){function e(t,n,r,i){(0,eX._)(this,e);var o=n[r];i=n1([t.to,i,o,t.from]);var a=n1([t.from,o,i]);this._active=!0,this._fn=t.fn||rP[t.type||(void 0===a?"undefined":(0,e8._)(a))],this._easing=nk[t.easing]||nk.linear,this._start=Math.floor(Date.now()+(t.delay||0)),this._duration=this._total=Math.floor(t.duration),this._loop=!!t.loop,this._target=n,this._prop=r,this._from=a,this._to=i,this._promises=void 0}return(0,eJ._)(e,[{key:"active",value:function(){return this._active}},{key:"update",value:function(e,t,n){if(this._active){this._notify(!1);var r=this._target[this._prop],i=n-this._start,o=this._duration-i;this._start=n,this._duration=Math.floor(Math.max(o,e.duration)),this._total+=i,this._loop=!!e.loop,this._to=n1([e.to,t,r,e.from]),this._from=n1([e.from,r,t])}}},{key:"cancel",value:function(){this._active&&(this.tick(Date.now()),this._active=!1,this._notify(!1))}},{key:"tick",value:function(e){var t,n=e-this._start,r=this._duration,i=this._prop,o=this._from,a=this._loop,s=this._to;if(this._active=o!==s&&(a||n<r),!this._active){this._target[i]=s,this._notify(!0);return}if(n<0){this._target[i]=o;return}t=n/r%2,t=a&&t>1?2-t:t,t=this._easing(Math.min(1,Math.max(0,t))),this._target[i]=this._fn(o,s,t)}},{key:"wait",value:function(){var e=this._promises||(this._promises=[]);return new Promise(function(t,n){e.push({res:t,rej:n})})}},{key:"_notify",value:function(e){for(var t=e?"res":"rej",n=this._promises||[],r=0;r<n.length;r++)n[r][t]()}}]),e}(),rO=function(){function e(t,n){(0,eX._)(this,e),this._chart=t,this._properties=new Map,this.configure(n)}return(0,eJ._)(e,[{key:"configure",value:function(e){if(tE(e)){var t=Object.keys(nN.animation),n=this._properties;Object.getOwnPropertyNames(e).forEach(function(r){var i=e[r];if(tE(i)){var o={},a=!0,s=!1,l=void 0;try{for(var u,c=t[Symbol.iterator]();!(a=(u=c.next()).done);a=!0){var d=u.value;o[d]=i[d]}}catch(e){s=!0,l=e}finally{try{a||null==c.return||c.return()}finally{if(s)throw l}}(tT(i.properties)&&i.properties||[r]).forEach(function(e){e!==r&&n.has(e)||n.set(e,o)})}})}}},{key:"_animateOptions",value:function(e,t){var n=t.options,r=function(e,t){if(t){var n=e.options;if(!n){e.options=t;return}return n.$shared&&(e.options=n=Object.assign({},n,{$shared:!1,$animations:{}})),n}}(e,n);if(!r)return[];var i=this._createAnimations(r,n);return n.$shared&&(function(e,t){for(var n=[],r=Object.keys(t),i=0;i<r.length;i++){var o=e[r[i]];o&&o.active()&&n.push(o.wait())}return Promise.all(n)})(e.options.$animations,n).then(function(){e.options=n},function(){}),i}},{key:"_createAnimations",value:function(e,t){var n=this._properties,r=[],i=e.$animations||(e.$animations={}),o=Object.keys(t),a=Date.now();for(s=o.length-1;s>=0;--s){var s,l=o[s];if("$"!==l.charAt(0)){if("options"===l){r.push.apply(r,(0,e4._)(this._animateOptions(e,t)));continue}var u=t[l],c=i[l],d=n.get(l);if(c)if(d&&c.active()){c.update(d,u,a);continue}else c.cancel();if(!d||!d.duration){e[l]=u;continue}i[l]=c=new rD(d,e,l,u),r.push(c)}}return r}},{key:"update",value:function(e,t){if(0===this._properties.size)return void Object.assign(e,t);var n=this._createAnimations(e,t);if(n.length)return rI.add(this._chart,n),!0}}]),e}();function rN(e,t){var n=e&&e.options||{},r=n.reverse,i=void 0===n.min?t:0,o=void 0===n.max?t:0;return{start:r?o:i,end:r?i:o}}function rM(e,t){var n,r,i=[],o=e._getSortedDatasetMetas(t);for(n=0,r=o.length;n<r;++n)i.push(o[n].index);return i}function rL(e,t,n){var r,i,o,a,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},l=e.keys,u="single"===s.mode;if(null!==t){for(r=0,i=l.length;r<i;++r){if((o=+l[r])===n){if(s.all)continue;break}tR(a=e.values[o])&&(u||0===t||t3(t)===t3(a))&&(t+=a)}return t}}function rB(e,t){var n=e&&e.options.stacked;return n||void 0===n&&void 0!==t.stack}function rV(e,t,n,r){var i=!0,o=!1,a=void 0;try{for(var s,l=t.getMatchingVisibleMetas(r).reverse()[Symbol.iterator]();!(i=(s=l.next()).done);i=!0){var u=s.value,c=e[u.index];if(n&&c>0||!n&&c<0)return u.index}}catch(e){o=!0,a=e}finally{try{i||null==l.return||l.return()}finally{if(o)throw a}}return null}function rF(e,t){for(var n,r=e.chart,i=e._cachedMeta,o=r._stacks||(r._stacks={}),a=i.iScale,s=i.vScale,l=i.index,u=a.axis,c=s.axis,d="".concat(a.id,".").concat(s.id,".").concat(i.stack||i.type),f=t.length,p=0;p<f;++p){var h=t[p],g=h[u],m=h[c];(n=(h._stacks||(h._stacks={}))[c]=function(e,t,n){var r=e[t]||(e[t]={});return r[n]||(r[n]={})}(o,d,g))[l]=m,n._top=rV(n,s,!0,i.type),n._bottom=rV(n,s,!1,i.type),(n._visualValues||(n._visualValues={}))[l]=m}}function rU(e,t){var n=e.scales;return Object.keys(n).filter(function(e){return n[e].axis===t}).shift()}function rG(e,t){var n=e.controller.index,r=e.vScale&&e.vScale.axis;if(r){t=t||e._parsed;var i=!0,o=!1,a=void 0;try{for(var s,l=t[Symbol.iterator]();!(i=(s=l.next()).done);i=!0){var u=s.value._stacks;if(!u||void 0===u[r]||void 0===u[r][n])return;delete u[r][n],void 0!==u[r]._visualValues&&void 0!==u[r]._visualValues[n]&&delete u[r]._visualValues[n]}}catch(e){o=!0,a=e}finally{try{i||null==l.return||l.return()}finally{if(o)throw a}}}}var r$=function(e){return"reset"===e||"none"===e},rz=function(e,t){return t?e:Object.assign({},e)},rH=function(){function e(t,n){(0,eX._)(this,e),this.chart=t,this._ctx=t.ctx,this.index=n,this._cachedDataOpts={},this._cachedMeta=this.getMeta(),this._type=this._cachedMeta.type,this.options=void 0,this._parsing=!1,this._data=void 0,this._objectData=void 0,this._sharedOptions=void 0,this._drawStart=void 0,this._drawCount=void 0,this.enableOptionSharing=!1,this.supportsDecimation=!1,this.$context=void 0,this._syncList=[],this.datasetElementType=((0,e3._)(this,e)?this.constructor:void 0).datasetElementType,this.dataElementType=((0,e3._)(this,e)?this.constructor:void 0).dataElementType,this.initialize()}return(0,eJ._)(e,[{key:"initialize",value:function(){var e=this._cachedMeta;this.configure(),this.linkScales(),e._stacked=rB(e.vScale,e),this.addElements(),this.options.fill&&!this.chart.isPluginEnabled("filler")&&console.warn("Tried to use the 'fill' option without the 'Filler' plugin enabled. Please import and register the 'Filler' plugin and make sure it is not disabled in the options")}},{key:"updateIndex",value:function(e){this.index!==e&&rG(this._cachedMeta),this.index=e}},{key:"linkScales",value:function(){var e=this.chart,t=this._cachedMeta,n=this.getDataset(),r=function(e,t,n,r){return"x"===e?t:"r"===e?r:n},i=t.xAxisID=tA(n.xAxisID,rU(e,"x")),o=t.yAxisID=tA(n.yAxisID,rU(e,"y")),a=t.rAxisID=tA(n.rAxisID,rU(e,"r")),s=t.indexAxis,l=t.iAxisID=r(s,i,o,a),u=t.vAxisID=r(s,o,i,a);t.xScale=this.getScaleForId(i),t.yScale=this.getScaleForId(o),t.rScale=this.getScaleForId(a),t.iScale=this.getScaleForId(l),t.vScale=this.getScaleForId(u)}},{key:"getDataset",value:function(){return this.chart.data.datasets[this.index]}},{key:"getMeta",value:function(){return this.chart.getDatasetMeta(this.index)}},{key:"getScaleForId",value:function(e){return this.chart.scales[e]}},{key:"_getOtherScale",value:function(e){var t=this._cachedMeta;return e===t.iScale?t.vScale:t.iScale}},{key:"reset",value:function(){this._update("reset")}},{key:"_destroy",value:function(){var e=this._cachedMeta;this._data&&nd(this._data,this),e._stacked&&rG(e)}},{key:"_dataCheck",value:function(){var e=this.getDataset(),t=e.data||(e.data=[]),n=this._data;if(tE(t))this._data=function(e){var t,n,r,i=Object.keys(e),o=Array(i.length);for(t=0,n=i.length;t<n;++t)r=i[t],o[t]={x:r,y:e[r]};return o}(t);else if(n!==t){if(n){nd(n,this);var r=this._cachedMeta;rG(r),r._parsed=[]}t&&Object.isExtensible(t)&&(t._chartjs?t._chartjs.listeners.push(this):(Object.defineProperty(t,"_chartjs",{configurable:!0,enumerable:!1,value:{listeners:[this]}}),nc.forEach(function(e){var n="_onData"+tz(e),r=t[e];Object.defineProperty(t,e,{configurable:!0,enumerable:!1,value:function(){for(var e=arguments.length,i=Array(e),o=0;o<e;o++)i[o]=arguments[o];var a=r.apply(this,i);return t._chartjs.listeners.forEach(function(e){"function"==typeof e[n]&&e[n].apply(e,(0,e4._)(i))}),a}})}))),this._syncList=[],this._data=t}}},{key:"addElements",value:function(){var e=this._cachedMeta;this._dataCheck(),this.datasetElementType&&(e.dataset=new this.datasetElementType)}},{key:"buildOrUpdateElements",value:function(e){var t=this._cachedMeta,n=this.getDataset(),r=!1;this._dataCheck();var i=t._stacked;t._stacked=rB(t.vScale,t),t.stack!==n.stack&&(r=!0,rG(t),t.stack=n.stack),this._resyncElements(e),(r||i!==t._stacked)&&rF(this,t._parsed)}},{key:"configure",value:function(){var e=this.chart.config,t=e.datasetScopeKeys(this._type),n=e.getOptionScopes(this.getDataset(),t,!0);this.options=e.createResolver(n,this.getContext()),this._parsing=this.options.parsing,this._cachedDataOpts={}}},{key:"parse",value:function(e,t){var n,r,i,o=this._cachedMeta,a=this._data,s=o.iScale,l=o._stacked,u=s.axis,c=0===e&&t===a.length||o._sorted,d=e>0&&o._parsed[e-1];if(!1===this._parsing)o._parsed=a,o._sorted=!0,i=a;else{for(n=0,i=tT(a[e])?this.parseArrayData(o,a,e,t):tE(a[e])?this.parseObjectData(o,a,e,t):this.parsePrimitiveData(o,a,e,t);n<t;++n)o._parsed[n+e]=r=i[n],c&&((null===r[u]||d&&r[u]<d[u])&&(c=!1),d=r);o._sorted=c}l&&rF(this,i)}},{key:"parsePrimitiveData",value:function(e,t,n,r){var i,o,a,s=e.iScale,l=e.vScale,u=s.axis,c=l.axis,d=s.getLabels(),f=s===l,p=Array(r);for(i=0;i<r;++i)o=i+n,p[i]=(a={},(0,eZ._)(a,u,f||s.parse(d[o],o)),(0,eZ._)(a,c,l.parse(t[o],o)),a);return p}},{key:"parseArrayData",value:function(e,t,n,r){var i,o,a,s=e.xScale,l=e.yScale,u=Array(r);for(i=0;i<r;++i)a=t[o=i+n],u[i]={x:s.parse(a[0],o),y:l.parse(a[1],o)};return u}},{key:"parseObjectData",value:function(e,t,n,r){var i,o,a,s=e.xScale,l=e.yScale,u=this._parsing,c=u.xAxisKey,d=void 0===c?"x":c,f=u.yAxisKey,p=void 0===f?"y":f,h=Array(r);for(i=0;i<r;++i)a=t[o=i+n],h[i]={x:s.parse(t$(a,d),o),y:l.parse(t$(a,p),o)};return h}},{key:"getParsed",value:function(e){return this._cachedMeta._parsed[e]}},{key:"getDataElement",value:function(e){return this._cachedMeta.data[e]}},{key:"applyStack",value:function(e,t,n){var r=this.chart,i=this._cachedMeta,o=t[e.axis];return rL({keys:rM(r,!0),values:t._stacks[e.axis]._visualValues},o,i.index,{mode:n})}},{key:"updateRangeFromParsed",value:function(e,t,n,r){var i=n[t.axis],o=null===i?NaN:i,a=r&&n._stacks[t.axis];r&&a&&(r.values=a,o=rL(r,i,this._cachedMeta.index)),e.min=Math.min(e.min,o),e.max=Math.max(e.max,o)}},{key:"getMinMax",value:function(e,t){var n,r,i,o,a,s,l=this._cachedMeta,u=l._parsed,c=l._sorted&&e===l.iScale,d=u.length,f=this._getOtherScale(e),p=(n=this.chart,t&&!l.hidden&&l._stacked&&{keys:rM(n,!0),values:null}),h={min:1/0,max:-1/0},g=(i=(r=f.getUserBounds()).min,o=r.max,{min:r.minDefined?i:-1/0,max:r.maxDefined?o:1/0}),m=g.min,x=g.max;function y(){var t=(s=u[a])[f.axis];return!tR(s[e.axis])||m>t||x<t}for(a=0;a<d&&(y()||(this.updateRangeFromParsed(h,e,s,p),!c));++a);if(c){for(a=d-1;a>=0;--a)if(!y()){this.updateRangeFromParsed(h,e,s,p);break}}return h}},{key:"getAllParsedValues",value:function(e){var t,n,r,i=this._cachedMeta._parsed,o=[];for(t=0,n=i.length;t<n;++t)tR(r=i[t][e.axis])&&o.push(r);return o}},{key:"getMaxOverflow",value:function(){return!1}},{key:"getLabelAndValue",value:function(e){var t=this._cachedMeta,n=t.iScale,r=t.vScale,i=this.getParsed(e);return{label:n?""+n.getLabelForValue(i[n.axis]):"",value:r?""+r.getLabelForValue(i[r.axis]):""}}},{key:"_update",value:function(e){var t,n,r,i,o,a=this._cachedMeta;this.update(e||"default"),tE(t=tA(this.options.clip,function(e,t,n){if(!1===n)return!1;var r=rN(e,n),i=rN(t,n);return{top:i.end,right:r.end,bottom:i.start,left:r.start}}(a.xScale,a.yScale,this.getMaxOverflow())))?(n=t.top,r=t.right,i=t.bottom,o=t.left):n=r=i=o=t,a._clip={top:n,right:r,bottom:i,left:o,disabled:!1===t}}},{key:"update",value:function(e){}},{key:"draw",value:function(){var e,t=this._ctx,n=this.chart,r=this._cachedMeta,i=r.data||[],o=n.chartArea,a=[],s=this._drawStart||0,l=this._drawCount||i.length-s,u=this.options.drawActiveElementsOnTop;for(r.dataset&&r.dataset.draw(t,o,s,l),e=s;e<s+l;++e){var c=i[e];c.hidden||(c.active&&u?a.push(c):c.draw(t,o))}for(e=0;e<a.length;++e)a[e].draw(t,o)}},{key:"getStyle",value:function(e,t){var n=t?"active":"default";return void 0===e&&this._cachedMeta.dataset?this.resolveDatasetElementOptions(n):this.resolveDataElementOptions(e||0,n)}},{key:"getContext",value:function(e,t,n){var r,i,o=this.getDataset();if(e>=0&&e<this._cachedMeta.data.length){var a=this._cachedMeta.data[e];(i=a.$context||(a.$context=n2(this.getContext(),{active:!1,dataIndex:e,parsed:void 0,raw:void 0,element:a,index:e,mode:"default",type:"data"}))).parsed=this.getParsed(e),i.raw=o.data[e],i.index=i.dataIndex=e}else(i=this.$context||(this.$context=n2(this.chart.getContext(),{active:!1,dataset:void 0,datasetIndex:r=this.index,index:r,mode:"default",type:"dataset"}))).dataset=o,i.index=i.datasetIndex=this.index;return i.active=!!t,i.mode=n,i}},{key:"resolveDatasetElementOptions",value:function(e){return this._resolveElementOptions(this.datasetElementType.id,e)}},{key:"resolveDataElementOptions",value:function(e,t){return this._resolveElementOptions(this.dataElementType.id,t,e)}},{key:"_resolveElementOptions",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"default",r=arguments.length>2?arguments[2]:void 0,i="active"===n,o=this._cachedDataOpts,a=e+"-"+n,s=o[a],l=this.enableOptionSharing&&tH(r);if(s)return rz(s,l);var u=this.chart.config,c=u.datasetElementScopeKeys(this._type,e),d=u.getOptionScopes(this.getDataset(),c),f=Object.keys(nN.elements[e]),p=u.resolveNamedOptions(d,f,function(){return t.getContext(r,i,n)},i?["".concat(e,"Hover"),"hover",e,""]:[e,""]);return p.$shared&&(p.$shared=l,o[a]=Object.freeze(rz(p,l))),p}},{key:"_resolveAnimations",value:function(e,t,n){var r,i=this.chart,o=this._cachedDataOpts,a="animation-".concat(t),s=o[a];if(s)return s;if(!1!==i.options.animation){var l=this.chart.config,u=l.datasetAnimationScopeKeys(this._type,t),c=l.getOptionScopes(this.getDataset(),u);r=l.createResolver(c,this.getContext(e,n,t))}var d=new rO(i,r&&r.animations);return r&&r._cacheable&&(o[a]=Object.freeze(d)),d}},{key:"getSharedOptions",value:function(e){if(e.$shared)return this._sharedOptions||(this._sharedOptions=Object.assign({},e))}},{key:"includeOptions",value:function(e,t){return!t||r$(e)||this.chart._animationsDisabled}},{key:"_getSharedOptions",value:function(e,t){var n=this.resolveDataElementOptions(e,t),r=this._sharedOptions,i=this.getSharedOptions(n),o=this.includeOptions(t,i)||i!==r;return this.updateSharedOptions(i,t,n),{sharedOptions:i,includeOptions:o}}},{key:"updateElement",value:function(e,t,n,r){r$(r)?Object.assign(e,n):this._resolveAnimations(t,r).update(e,n)}},{key:"updateSharedOptions",value:function(e,t,n){e&&!r$(t)&&this._resolveAnimations(void 0,t).update(e,n)}},{key:"_setStyle",value:function(e,t,n,r){e.active=r;var i=this.getStyle(t,r);this._resolveAnimations(t,n,r).update(e,{options:!r&&this.getSharedOptions(i)||i})}},{key:"removeHoverStyle",value:function(e,t,n){this._setStyle(e,n,"active",!1)}},{key:"setHoverStyle",value:function(e,t,n){this._setStyle(e,n,"active",!0)}},{key:"_removeDatasetHoverStyle",value:function(){var e=this._cachedMeta.dataset;e&&this._setStyle(e,void 0,"active",!1)}},{key:"_setDatasetHoverStyle",value:function(){var e=this._cachedMeta.dataset;e&&this._setStyle(e,void 0,"active",!0)}},{key:"_resyncElements",value:function(e){var t=this._data,n=this._cachedMeta.data,r=!0,i=!1,o=void 0;try{for(var a,l=this._syncList[Symbol.iterator]();!(r=(a=l.next()).done);r=!0){var u=(0,s._)(a.value,3),c=u[0],d=u[1],f=u[2];this[c](d,f)}}catch(e){i=!0,o=e}finally{try{r||null==l.return||l.return()}finally{if(i)throw o}}this._syncList=[];var p=n.length,h=t.length,g=Math.min(h,p);g&&this.parse(0,g),h>p?this._insertElements(p,h-p,e):h<p&&this._removeElements(h,p-h)}},{key:"_insertElements",value:function(e,t){var n,r=!(arguments.length>2)||void 0===arguments[2]||arguments[2],i=this._cachedMeta,o=i.data,a=e+t,s=function(e){for(e.length+=t,n=e.length-1;n>=a;n--)e[n]=e[n-t]};for(s(o),n=e;n<a;++n)o[n]=new this.dataElementType;this._parsing&&s(i._parsed),this.parse(e,t),r&&this.updateElements(o,e,t,"reset")}},{key:"updateElements",value:function(e,t,n,r){}},{key:"_removeElements",value:function(e,t){var n=this._cachedMeta;if(this._parsing){var r=n._parsed.splice(e,t);n._stacked&&rG(n,r)}n.data.splice(e,t)}},{key:"_sync",value:function(e){if(this._parsing)this._syncList.push(e);else{var t=(0,s._)(e,3),n=t[0],r=t[1],i=t[2];this[n](r,i)}this.chart._dataChanges.push([this.index].concat((0,e4._)(e)))}},{key:"_onDataPush",value:function(){var e=arguments.length;this._sync(["_insertElements",this.getDataset().data.length-e,e])}},{key:"_onDataPop",value:function(){this._sync(["_removeElements",this._cachedMeta.data.length-1,1])}},{key:"_onDataShift",value:function(){this._sync(["_removeElements",0,1])}},{key:"_onDataSplice",value:function(e,t){t&&this._sync(["_removeElements",e,t]);var n=arguments.length-2;n&&this._sync(["_insertElements",e,n])}},{key:"_onDataUnshift",value:function(){this._sync(["_insertElements",0,arguments.length])}}]),e}();function rW(e,t,n,r){if(tT(e)){var i,o,a,s,l,u;a=Math.min(i=n.parse(e[0],r),o=n.parse(e[1],r)),s=Math.max(i,o),l=a,u=s,Math.abs(a)>Math.abs(s)&&(l=s,u=a),t[n.axis]=u,t._custom={barStart:l,barEnd:u,start:i,end:o,min:a,max:s}}else t[n.axis]=n.parse(e,r);return t}function rq(e,t,n,r){var i,o,a,s,l=e.iScale,u=e.vScale,c=l.getLabels(),d=l===u,f=[];for(i=n,o=n+r;i<o;++i)s=t[i],(a={})[l.axis]=d||l.parse(c[i],i),f.push(rW(s,a,u,i));return f}function rK(e){return e&&void 0!==e.barStart&&void 0!==e.barEnd}function rY(e,t,n,r){var i,o,a;return r?rQ((i=e,o=t,a=n,e=i===o?a:i===a?o:i),n,t):rQ(e,t,n)}function rQ(e,t,n){return"start"===e?t:"end"===e?n:e}(0,eZ._)(rH,"defaults",{}),(0,eZ._)(rH,"datasetElementType",null),(0,eZ._)(rH,"dataElementType",null);var rX=function(e){function t(){return(0,eX._)(this,t),(0,eQ._)(this,t,arguments)}return(0,e2._)(t,e),(0,eJ._)(t,[{key:"parsePrimitiveData",value:function(e,t,n,r){return rq(e,t,n,r)}},{key:"parseArrayData",value:function(e,t,n,r){return rq(e,t,n,r)}},{key:"parseObjectData",value:function(e,t,n,r){var i,o,a,s,l=e.iScale,u=e.vScale,c=this._parsing,d=c.xAxisKey,f=void 0===d?"x":d,p=c.yAxisKey,h=void 0===p?"y":p,g="x"===l.axis?f:h,m="x"===u.axis?f:h,x=[];for(i=n,o=n+r;i<o;++i)s=t[i],(a={})[l.axis]=l.parse(t$(s,g),i),x.push(rW(t$(s,m),a,u,i));return x}},{key:"updateRangeFromParsed",value:function(e,n,r,i){(0,e0._)((0,e1._)(t.prototype),"updateRangeFromParsed",this).call(this,e,n,r,i);var o=r._custom;o&&n===this._cachedMeta.vScale&&(e.min=Math.min(e.min,o.min),e.max=Math.max(e.max,o.max))}},{key:"getMaxOverflow",value:function(){return 0}},{key:"getLabelAndValue",value:function(e){var t=this._cachedMeta,n=t.iScale,r=t.vScale,i=this.getParsed(e),o=i._custom,a=rK(o)?"["+o.start+", "+o.end+"]":""+r.getLabelForValue(i[r.axis]);return{label:""+n.getLabelForValue(i[n.axis]),value:a}}},{key:"initialize",value:function(){this.enableOptionSharing=!0,(0,e0._)((0,e1._)(t.prototype),"initialize",this).call(this),this._cachedMeta.stack=this.getDataset().stack}},{key:"update",value:function(e){var t=this._cachedMeta;this.updateElements(t.data,0,t.data.length,e)}},{key:"updateElements",value:function(e,t,n,r){for(var i="reset"===r,o=this.index,a=this._cachedMeta.vScale,s=a.getBasePixel(),l=a.isHorizontal(),u=this._getRuler(),c=this._getSharedOptions(t,r),d=c.sharedOptions,f=c.includeOptions,p=t;p<t+n;p++){var h=this.getParsed(p),g=i||tj(h[a.axis])?{base:s,head:s}:this._calculateBarValuePixels(p),m=this._calculateBarIndexPixels(p,u),x=(h._stacks||{})[a.axis],y={horizontal:l,base:g.base,enableBorderRadius:!x||rK(h._custom)||o===x._top||o===x._bottom,x:l?g.head:m.center,y:l?m.center:g.head,height:l?m.size:Math.abs(g.size),width:l?Math.abs(g.size):m.size};f&&(y.options=d||this.resolveDataElementOptions(p,e[p].active?"active":r));var b=y.options||e[p].options;!function(e,t,n,r){var i,o,a,s,l,u=t.borderSkipped,c={};if(!u){e.borderSkipped=c;return}if(!0===u){e.borderSkipped={top:!0,right:!0,bottom:!0,left:!0};return}var d=(e.horizontal?(i=e.base>e.x,o="left",a="right"):(i=e.base<e.y,o="bottom",a="top"),i?(s="end",l="start"):(s="start",l="end"),{start:o,end:a,reverse:i,top:s,bottom:l}),f=d.start,p=d.end,h=d.reverse,g=d.top,m=d.bottom;"middle"===u&&n&&(e.enableBorderRadius=!0,(n._top||0)===r?u=g:(n._bottom||0)===r?u=m:(c[rY(m,f,p,h)]=!0,u=g)),c[rY(u,f,p,h)]=!0,e.borderSkipped=c}(y,b,x,o),function(e,t,n){var r=t.inflateAmount;e.inflateAmount="auto"===r?.33*(1===n):r}(y,b,u.ratio),this.updateElement(e[p],p,y,r)}}},{key:"_getStacks",value:function(e,t){var n=this._cachedMeta.iScale,r=n.getMatchingVisibleMetas(this._type).filter(function(e){return e.controller.options.grouped}),i=n.options.stacked,o=[],a=!0,s=!1,l=void 0;try{for(var u,c=r[Symbol.iterator]();!(a=(u=c.next()).done);a=!0){var d=u.value;if(!(void 0!==t&&function(e){var n=e.controller.getParsed(t),r=n&&n[e.vScale.axis];if(tj(r)||isNaN(r))return!0}(d))&&((!1===i||-1===o.indexOf(d.stack)||void 0===i&&void 0===d.stack)&&o.push(d.stack),d.index===e))break}}catch(e){s=!0,l=e}finally{try{a||null==c.return||c.return()}finally{if(s)throw l}}return o.length||o.push(void 0),o}},{key:"_getStackCount",value:function(e){return this._getStacks(void 0,e).length}},{key:"_getStackIndex",value:function(e,t,n){var r=this._getStacks(e,n),i=void 0!==t?r.indexOf(t):-1;return -1===i?r.length-1:i}},{key:"_getRuler",value:function(){var e,t,n=this.options,r=this._cachedMeta,i=r.iScale,o=[];for(e=0,t=r.data.length;e<t;++e)o.push(i.getPixelForValue(this.getParsed(e)[i.axis],e));var a=n.barThickness;return{min:a||function(e){var t,n,r,i,o=e.iScale,a=function(e,t){if(!e._cache.$bar){for(var n=e.getMatchingVisibleMetas(t),r=[],i=0,o=n.length;i<o;i++)r=r.concat(n[i].controller.getAllParsedValues(e));e._cache.$bar=nf(r.sort(function(e,t){return e-t}))}return e._cache.$bar}(o,e.type),s=o._length,l=function(){32767!==r&&-32768!==r&&(tH(i)&&(s=Math.min(s,Math.abs(r-i)||s)),i=r)};for(t=0,n=a.length;t<n;++t)r=o.getPixelForValue(a[t]),l();for(t=0,i=void 0,n=o.ticks.length;t<n;++t)r=o.getPixelForTick(t),l();return s}(r),pixels:o,start:i._startPixel,end:i._endPixel,stackCount:this._getStackCount(),scale:i,grouped:n.grouped,ratio:a?1:n.categoryPercentage*n.barPercentage}}},{key:"_calculateBarValuePixels",value:function(e){var t,n,r=this._cachedMeta,i=r.vScale,o=r._stacked,a=r.index,s=this.options,l=s.base,u=s.minBarLength,c=l||0,d=this.getParsed(e),f=d._custom,p=rK(f),h=d[i.axis],g=0,m=o?this.applyStack(i,d,o):h;m!==h&&(g=m-h,m=h),p&&(h=f.barStart,m=f.barEnd-f.barStart,0!==h&&t3(h)!==t3(f.barEnd)&&(g=0),g+=h);var x=tj(l)||p?g:l,y=i.getPixelForValue(x);if(Math.abs(n=(t=this.chart.getDataVisibility(e)?i.getPixelForValue(g+m):y)-y)<u){n=(0!==(b=n)?t3(b):(i.isHorizontal()?1:-1)*(i.min>=c?1:-1))*u,h===c&&(y-=n/2);var b,w=i.getPixelForDecimal(0),k=i.getPixelForDecimal(1),_=Math.min(w,k);t=(y=Math.max(Math.min(y,Math.max(w,k)),_))+n,o&&!p&&(d._stacks[i.axis]._visualValues[a]=i.getValueForPixel(t)-i.getValueForPixel(y))}if(y===i.getPixelForValue(c)){var S=t3(n)*i.getLineWidthForValue(c)/2;y+=S,n-=S}return{size:n,base:y,head:t,center:t+n/2}}},{key:"_calculateBarIndexPixels",value:function(e,t){var n,r,i=t.scale,o=this.options,a=o.skipNull,s=tA(o.maxBarThickness,1/0);if(t.grouped){var l,u,c,d,f,p,h,g,m,x=a?this._getStackCount(e):t.stackCount,y="flex"===o.barThickness?(u=(l=t.pixels)[e],c=e>0?l[e-1]:null,d=e<l.length-1?l[e+1]:null,f=o.categoryPercentage,null===c&&(c=u-(null===d?t.end-t.start:d-u)),null===d&&(d=u+u-c),p=u-(u-Math.min(c,d))/2*f,{chunk:Math.abs(d-c)/2*f/x,ratio:o.barPercentage,start:p}):(tj(m=o.barThickness)?(h=t.min*o.categoryPercentage,g=o.barPercentage):(h=m*x,g=1),{chunk:h/x,ratio:g,start:t.pixels[e]-h/2}),b=this._getStackIndex(this.index,this._cachedMeta.stack,a?e:void 0);n=y.start+y.chunk*b+y.chunk/2,r=Math.min(s,y.chunk*y.ratio)}else n=i.getPixelForValue(this.getParsed(e)[i.axis],e),r=Math.min(s,t.min*t.ratio);return{base:n-r/2,head:n+r/2,center:n,size:r}}},{key:"draw",value:function(){for(var e=this._cachedMeta,t=e.vScale,n=e.data,r=n.length,i=0;i<r;++i)null!==this.getParsed(i)[t.axis]&&n[i].draw(this._ctx)}}]),t}(rH);(0,eZ._)(rX,"id","bar"),(0,eZ._)(rX,"defaults",{datasetElementType:!1,dataElementType:"bar",categoryPercentage:.8,barPercentage:.9,grouped:!0,animations:{numbers:{type:"number",properties:["x","y","base","width","height"]}}}),(0,eZ._)(rX,"overrides",{scales:{_index_:{type:"category",offset:!0,grid:{offset:!0}},_value_:{type:"linear",beginAtZero:!0}}});var rJ=function(e){function t(){return(0,eX._)(this,t),(0,eQ._)(this,t,arguments)}return(0,e2._)(t,e),(0,eJ._)(t,[{key:"initialize",value:function(){this.enableOptionSharing=!0,(0,e0._)((0,e1._)(t.prototype),"initialize",this).call(this)}},{key:"parsePrimitiveData",value:function(e,n,r,i){for(var o=(0,e0._)((0,e1._)(t.prototype),"parsePrimitiveData",this).call(this,e,n,r,i),a=0;a<o.length;a++)o[a]._custom=this.resolveDataElementOptions(a+r).radius;return o}},{key:"parseArrayData",value:function(e,n,r,i){for(var o=(0,e0._)((0,e1._)(t.prototype),"parseArrayData",this).call(this,e,n,r,i),a=0;a<o.length;a++){var s=n[r+a];o[a]._custom=tA(s[2],this.resolveDataElementOptions(a+r).radius)}return o}},{key:"parseObjectData",value:function(e,n,r,i){for(var o=(0,e0._)((0,e1._)(t.prototype),"parseObjectData",this).call(this,e,n,r,i),a=0;a<o.length;a++){var s=n[r+a];o[a]._custom=tA(s&&s.r&&+s.r,this.resolveDataElementOptions(a+r).radius)}return o}},{key:"getMaxOverflow",value:function(){for(var e=this._cachedMeta.data,t=0,n=e.length-1;n>=0;--n)t=Math.max(t,e[n].size(this.resolveDataElementOptions(n))/2);return t>0&&t}},{key:"getLabelAndValue",value:function(e){var t=this._cachedMeta,n=this.chart.data.labels||[],r=t.xScale,i=t.yScale,o=this.getParsed(e),a=r.getLabelForValue(o.x),s=i.getLabelForValue(o.y),l=o._custom;return{label:n[e]||"",value:"("+a+", "+s+(l?", "+l:"")+")"}}},{key:"update",value:function(e){var t=this._cachedMeta.data;this.updateElements(t,0,t.length,e)}},{key:"updateElements",value:function(e,t,n,r){for(var i="reset"===r,o=this._cachedMeta,a=o.iScale,s=o.vScale,l=this._getSharedOptions(t,r),u=l.sharedOptions,c=l.includeOptions,d=a.axis,f=s.axis,p=t;p<t+n;p++){var h=e[p],g=!i&&this.getParsed(p),m={},x=m[d]=i?a.getPixelForDecimal(.5):a.getPixelForValue(g[d]),y=m[f]=i?s.getBasePixel():s.getPixelForValue(g[f]);m.skip=isNaN(x)||isNaN(y),c&&(m.options=u||this.resolveDataElementOptions(p,h.active?"active":r),i&&(m.options.radius=0)),this.updateElement(h,p,m,r)}}},{key:"resolveDataElementOptions",value:function(e,n){var r=this.getParsed(e),i=(0,e0._)((0,e1._)(t.prototype),"resolveDataElementOptions",this).call(this,e,n);i.$shared&&(i=Object.assign({},i,{$shared:!1}));var o=i.radius;return"active"!==n&&(i.radius=0),i.radius+=tA(r&&r._custom,o),i}}]),t}(rH);(0,eZ._)(rJ,"id","bubble"),(0,eZ._)(rJ,"defaults",{datasetElementType:!1,dataElementType:"point",animations:{numbers:{type:"number",properties:["x","y","borderWidth","radius"]}}}),(0,eZ._)(rJ,"overrides",{scales:{x:{type:"linear"},y:{type:"linear"}}});var rZ=function(e){function t(e,n){var r;return(0,eX._)(this,t),(r=(0,eQ._)(this,t,[e,n])).enableOptionSharing=!0,r.innerRadius=void 0,r.outerRadius=void 0,r.offsetX=void 0,r.offsetY=void 0,r}return(0,e2._)(t,e),(0,eJ._)(t,[{key:"linkScales",value:function(){}},{key:"parse",value:function(e,t){var n=this.getDataset().data,r=this._cachedMeta;if(!1===this._parsing)r._parsed=n;else{var i,o,a=function(e){return+n[e]};if(tE(n[e])){var s=this._parsing.key,l=void 0===s?"value":s;a=function(e){return+t$(n[e],l)}}for(i=e,o=e+t;i<o;++i)r._parsed[i]=a(i)}}},{key:"_getRotation",value:function(){return t9(this.options.rotation-90)}},{key:"_getCircumference",value:function(){return t9(this.options.circumference)}},{key:"_getRotationExtents",value:function(){for(var e=tY,t=-tY,n=0;n<this.chart.data.datasets.length;++n)if(this.chart.isDatasetVisible(n)&&this.chart.getDatasetMeta(n).type===this._type){var r=this.chart.getDatasetMeta(n).controller,i=r._getRotation(),o=r._getCircumference();e=Math.min(e,i),t=Math.max(t,i+o)}return{rotation:e,circumference:t-e}}},{key:"update",value:function(e){var t,n=this.chart.chartArea,r=this._cachedMeta,i=r.data,o=this.getMaxBorderWidth()+this.getMaxOffset(i)+this.options.spacing,a=Math.max((Math.min(n.width,n.height)-o)/2,0),s=Math.min((t=this.options.cutout,"string"==typeof t&&t.endsWith("%")?parseFloat(t)/100:t/a),1),l=this._getRingWeight(this.index),u=this._getRotationExtents(),c=u.circumference,d=function(e,t,n){var r=1,i=1,o=0,a=0;if(t<tY){var s=e+t,l=Math.cos(e),u=Math.sin(e),c=Math.cos(s),d=Math.sin(s),f=function(t,r,i){return ni(t,e,s,!0)?1:Math.max(r,r*n,i,i*n)},p=function(t,r,i){return ni(t,e,s,!0)?-1:Math.min(r,r*n,i,i*n)},h=f(0,l,c),g=f(tZ,u,d),m=p(tK,l,c),x=p(tK+tZ,u,d);r=(h-m)/2,i=(g-x)/2,o=-(h+m)/2,a=-(g+x)/2}return{ratioX:r,ratioY:i,offsetX:o,offsetY:a}}(u.rotation,c,s),f=d.ratioX,p=d.ratioY,h=d.offsetX,g=d.offsetY,m=Math.max(Math.min((n.width-o)/f,(n.height-o)/p)/2,0),x=tP(this.options.radius,m),y=Math.max(x*s,0),b=(x-y)/this._getVisibleDatasetWeightTotal();this.offsetX=h*x,this.offsetY=g*x,r.total=this.calculateTotal(),this.outerRadius=x-b*this._getRingWeightOffset(this.index),this.innerRadius=Math.max(this.outerRadius-b*l,0),this.updateElements(i,0,i.length,e)}},{key:"_circumference",value:function(e,t){var n=this.options,r=this._cachedMeta,i=this._getCircumference();return t&&n.animation.animateRotate||!this.chart.getDataVisibility(e)||null===r._parsed[e]||r.data[e].hidden?0:this.calculateCircumference(r._parsed[e]*i/tY)}},{key:"updateElements",value:function(e,t,n,r){var i,o="reset"===r,a=this.chart,s=a.chartArea,l=a.options.animation,u=(s.left+s.right)/2,c=(s.top+s.bottom)/2,d=o&&l.animateScale,f=d?0:this.innerRadius,p=d?0:this.outerRadius,h=this._getSharedOptions(t,r),g=h.sharedOptions,m=h.includeOptions,x=this._getRotation();for(i=0;i<t;++i)x+=this._circumference(i,o);for(i=t;i<t+n;++i){var y=this._circumference(i,o),b=e[i],w={x:u+this.offsetX,y:c+this.offsetY,startAngle:x,endAngle:x+y,circumference:y,outerRadius:p,innerRadius:f};m&&(w.options=g||this.resolveDataElementOptions(i,b.active?"active":r)),x+=y,this.updateElement(b,i,w,r)}}},{key:"calculateTotal",value:function(){var e,t=this._cachedMeta,n=t.data,r=0;for(e=0;e<n.length;e++){var i=t._parsed[e];null!==i&&!isNaN(i)&&this.chart.getDataVisibility(e)&&!n[e].hidden&&(r+=Math.abs(i))}return r}},{key:"calculateCircumference",value:function(e){var t=this._cachedMeta.total;return t>0&&!isNaN(e)?Math.abs(e)/t*tY:0}},{key:"getLabelAndValue",value:function(e){var t=this._cachedMeta,n=this.chart,r=n.data.labels||[],i=nR(t._parsed[e],n.options.locale);return{label:r[e]||"",value:i}}},{key:"getMaxBorderWidth",value:function(e){var t,n,r,i,o,a=0,s=this.chart;if(!e){for(t=0,n=s.data.datasets.length;t<n;++t)if(s.isDatasetVisible(t)){e=(r=s.getDatasetMeta(t)).data,i=r.controller;break}}if(!e)return 0;for(t=0,n=e.length;t<n;++t)"inner"!==(o=i.resolveDataElementOptions(t)).borderAlign&&(a=Math.max(a,o.borderWidth||0,o.hoverBorderWidth||0));return a}},{key:"getMaxOffset",value:function(e){for(var t=0,n=0,r=e.length;n<r;++n){var i=this.resolveDataElementOptions(n);t=Math.max(t,i.offset||0,i.hoverOffset||0)}return t}},{key:"_getRingWeightOffset",value:function(e){for(var t=0,n=0;n<e;++n)this.chart.isDatasetVisible(n)&&(t+=this._getRingWeight(n));return t}},{key:"_getRingWeight",value:function(e){return Math.max(tA(this.chart.data.datasets[e].weight,1),0)}},{key:"_getVisibleDatasetWeightTotal",value:function(){return this._getRingWeightOffset(this.chart.data.datasets.length)||1}}]),t}(rH);(0,eZ._)(rZ,"id","doughnut"),(0,eZ._)(rZ,"defaults",{datasetElementType:!1,dataElementType:"arc",animation:{animateRotate:!0,animateScale:!1},animations:{numbers:{type:"number",properties:["circumference","endAngle","innerRadius","outerRadius","startAngle","x","y","offset","borderWidth","spacing"]}},cutout:"50%",rotation:0,circumference:360,radius:"100%",spacing:0,indexAxis:"r"}),(0,eZ._)(rZ,"descriptors",{_scriptable:function(e){return"spacing"!==e},_indexable:function(e){return"spacing"!==e&&!e.startsWith("borderDash")&&!e.startsWith("hoverBorderDash")}}),(0,eZ._)(rZ,"overrides",{aspectRatio:1,plugins:{legend:{labels:{generateLabels:function(e){var t=e.data;if(t.labels.length&&t.datasets.length){var n=e.legend.options.labels,r=n.pointStyle,i=n.color;return t.labels.map(function(t,n){var o=e.getDatasetMeta(0).controller.getStyle(n);return{text:t,fillStyle:o.backgroundColor,strokeStyle:o.borderColor,fontColor:i,lineWidth:o.borderWidth,pointStyle:r,hidden:!e.getDataVisibility(n),index:n}})}return[]}},onClick:function(e,t,n){n.chart.toggleDataVisibility(t.index),n.chart.update()}}}});var r0=function(e){function t(){return(0,eX._)(this,t),(0,eQ._)(this,t,arguments)}return(0,e2._)(t,e),(0,eJ._)(t,[{key:"initialize",value:function(){this.enableOptionSharing=!0,this.supportsDecimation=!0,(0,e0._)((0,e1._)(t.prototype),"initialize",this).call(this)}},{key:"update",value:function(e){var t=this._cachedMeta,n=t.dataset,r=t.data,i=void 0===r?[]:r,o=t._dataset,a=this.chart._animationsDisabled,s=nv(t,i,a),l=s.start,u=s.count;this._drawStart=l,this._drawCount=u,nx(t)&&(l=0,u=i.length),n._chart=this.chart,n._datasetIndex=this.index,n._decimated=!!o._decimated,n.points=i;var c=this.resolveDatasetElementOptions(e);this.options.showLine||(c.borderWidth=0),c.segment=this.options.segment,this.updateElement(n,void 0,{animated:!a,options:c},e),this.updateElements(i,l,u,e)}},{key:"updateElements",value:function(e,t,n,r){for(var i="reset"===r,o=this._cachedMeta,a=o.iScale,s=o.vScale,l=o._stacked,u=o._dataset,c=this._getSharedOptions(t,r),d=c.sharedOptions,f=c.includeOptions,p=a.axis,h=s.axis,g=this.options,m=g.spanGaps,x=g.segment,y=t5(m)?m:1/0,b=this.chart._animationsDisabled||i||"none"===r,w=t+n,k=e.length,_=t>0&&this.getParsed(t-1),S=0;S<k;++S){var C=e[S],j=b?C:{};if(S<t||S>=w){j.skip=!0;continue}var T=this.getParsed(S),E=tj(T[h]),R=j[p]=a.getPixelForValue(T[p],S),I=j[h]=i||E?s.getBasePixel():s.getPixelForValue(l?this.applyStack(s,T,l):T[h],S);j.skip=isNaN(R)||isNaN(I)||E,j.stop=S>0&&Math.abs(T[p]-_[p])>y,x&&(j.parsed=T,j.raw=u.data[S]),f&&(j.options=d||this.resolveDataElementOptions(S,C.active?"active":r)),b||this.updateElement(C,S,j,r),_=T}}},{key:"getMaxOverflow",value:function(){var e=this._cachedMeta,t=e.dataset,n=t.options&&t.options.borderWidth||0,r=e.data||[];return r.length?Math.max(n,r[0].size(this.resolveDataElementOptions(0)),r[r.length-1].size(this.resolveDataElementOptions(r.length-1)))/2:n}},{key:"draw",value:function(){var e=this._cachedMeta;e.dataset.updateControlPoints(this.chart.chartArea,e.iScale.axis),(0,e0._)((0,e1._)(t.prototype),"draw",this).call(this)}}]),t}(rH);(0,eZ._)(r0,"id","line"),(0,eZ._)(r0,"defaults",{datasetElementType:"line",dataElementType:"point",showLine:!0,spanGaps:!1}),(0,eZ._)(r0,"overrides",{scales:{_index_:{type:"category"},_value_:{type:"linear"}}});var r1=function(e){function t(e,n){var r;return(0,eX._)(this,t),(r=(0,eQ._)(this,t,[e,n])).innerRadius=void 0,r.outerRadius=void 0,r}return(0,e2._)(t,e),(0,eJ._)(t,[{key:"getLabelAndValue",value:function(e){var t=this._cachedMeta,n=this.chart,r=n.data.labels||[],i=nR(t._parsed[e].r,n.options.locale);return{label:r[e]||"",value:i}}},{key:"parseObjectData",value:function(e,t,n,r){return rn.bind(this)(e,t,n,r)}},{key:"update",value:function(e){var t=this._cachedMeta.data;this._updateRadius(),this.updateElements(t,0,t.length,e)}},{key:"getMinMax",value:function(){var e=this,t=this._cachedMeta,n={min:1/0,max:-1/0};return t.data.forEach(function(t,r){var i=e.getParsed(r).r;!isNaN(i)&&e.chart.getDataVisibility(r)&&(i<n.min&&(n.min=i),i>n.max&&(n.max=i))}),n}},{key:"_updateRadius",value:function(){var e=this.chart,t=e.chartArea,n=e.options,r=Math.max(Math.min(t.right-t.left,t.bottom-t.top)/2,0),i=Math.max(n.cutoutPercentage?r/100*n.cutoutPercentage:1,0),o=(r-i)/e.getVisibleDatasetCount();this.outerRadius=r-o*this.index,this.innerRadius=this.outerRadius-o}},{key:"updateElements",value:function(e,t,n,r){var i,o="reset"===r,a=this.chart,s=a.options.animation,l=this._cachedMeta.rScale,u=l.xCenter,c=l.yCenter,d=l.getIndexAngle(0)-.5*tK,f=d,p=360/this.countVisibleElements();for(i=0;i<t;++i)f+=this._computeAngle(i,r,p);for(i=t;i<t+n;i++){var h=e[i],g=f,m=f+this._computeAngle(i,r,p),x=a.getDataVisibility(i)?l.getDistanceFromCenterForValue(this.getParsed(i).r):0;f=m,o&&(s.animateScale&&(x=0),s.animateRotate&&(g=m=d));var y={x:u,y:c,innerRadius:0,outerRadius:x,startAngle:g,endAngle:m,options:this.resolveDataElementOptions(i,h.active?"active":r)};this.updateElement(h,i,y,r)}}},{key:"countVisibleElements",value:function(){var e=this,t=this._cachedMeta,n=0;return t.data.forEach(function(t,r){!isNaN(e.getParsed(r).r)&&e.chart.getDataVisibility(r)&&n++}),n}},{key:"_computeAngle",value:function(e,t,n){return this.chart.getDataVisibility(e)?t9(this.resolveDataElementOptions(e,t).angle||n):0}}]),t}(rH);(0,eZ._)(r1,"id","polarArea"),(0,eZ._)(r1,"defaults",{dataElementType:"arc",animation:{animateRotate:!0,animateScale:!0},animations:{numbers:{type:"number",properties:["x","y","startAngle","endAngle","innerRadius","outerRadius"]}},indexAxis:"r",startAngle:0}),(0,eZ._)(r1,"overrides",{aspectRatio:1,plugins:{legend:{labels:{generateLabels:function(e){var t=e.data;if(t.labels.length&&t.datasets.length){var n=e.legend.options.labels,r=n.pointStyle,i=n.color;return t.labels.map(function(t,n){var o=e.getDatasetMeta(0).controller.getStyle(n);return{text:t,fillStyle:o.backgroundColor,strokeStyle:o.borderColor,fontColor:i,lineWidth:o.borderWidth,pointStyle:r,hidden:!e.getDataVisibility(n),index:n}})}return[]}},onClick:function(e,t,n){n.chart.toggleDataVisibility(t.index),n.chart.update()}}},scales:{r:{type:"radialLinear",angleLines:{display:!1},beginAtZero:!0,grid:{circular:!0},pointLabels:{display:!1},startAngle:0}}});var r2=function(e){function t(){return(0,eX._)(this,t),(0,eQ._)(this,t,arguments)}return(0,e2._)(t,e),t}(rZ);(0,eZ._)(r2,"id","pie"),(0,eZ._)(r2,"defaults",{cutout:0,rotation:0,circumference:360,radius:"100%"});var r3=function(e){function t(){return(0,eX._)(this,t),(0,eQ._)(this,t,arguments)}return(0,e2._)(t,e),(0,eJ._)(t,[{key:"getLabelAndValue",value:function(e){var t=this._cachedMeta.vScale,n=this.getParsed(e);return{label:t.getLabels()[e],value:""+t.getLabelForValue(n[t.axis])}}},{key:"parseObjectData",value:function(e,t,n,r){return rn.bind(this)(e,t,n,r)}},{key:"update",value:function(e){var t=this._cachedMeta,n=t.dataset,r=t.data||[],i=t.iScale.getLabels();if(n.points=r,"resize"!==e){var o=this.resolveDatasetElementOptions(e);this.options.showLine||(o.borderWidth=0);var a={_loop:!0,_fullLoop:i.length===r.length,options:o};this.updateElement(n,void 0,a,e)}this.updateElements(r,0,r.length,e)}},{key:"updateElements",value:function(e,t,n,r){for(var i=this._cachedMeta.rScale,o="reset"===r,a=t;a<t+n;a++){var s=e[a],l=this.resolveDataElementOptions(a,s.active?"active":r),u=i.getPointPositionForValue(a,this.getParsed(a).r),c=o?i.xCenter:u.x,d=o?i.yCenter:u.y,f={x:c,y:d,angle:u.angle,skip:isNaN(c)||isNaN(d),options:l};this.updateElement(s,a,f,r)}}}]),t}(rH);(0,eZ._)(r3,"id","radar"),(0,eZ._)(r3,"defaults",{datasetElementType:"line",dataElementType:"point",indexAxis:"r",showLine:!0,elements:{line:{fill:"start"}}}),(0,eZ._)(r3,"overrides",{aspectRatio:1,scales:{r:{type:"radialLinear"}}});var r4=function(e){function t(){return(0,eX._)(this,t),(0,eQ._)(this,t,arguments)}return(0,e2._)(t,e),(0,eJ._)(t,[{key:"getLabelAndValue",value:function(e){var t=this._cachedMeta,n=this.chart.data.labels||[],r=t.xScale,i=t.yScale,o=this.getParsed(e),a=r.getLabelForValue(o.x),s=i.getLabelForValue(o.y);return{label:n[e]||"",value:"("+a+", "+s+")"}}},{key:"update",value:function(e){var t=this._cachedMeta,n=t.data,r=void 0===n?[]:n,i=this.chart._animationsDisabled,o=nv(t,r,i),a=o.start,s=o.count;if(this._drawStart=a,this._drawCount=s,nx(t)&&(a=0,s=r.length),this.options.showLine){this.datasetElementType||this.addElements();var l=t.dataset,u=t._dataset;l._chart=this.chart,l._datasetIndex=this.index,l._decimated=!!u._decimated,l.points=r;var c=this.resolveDatasetElementOptions(e);c.segment=this.options.segment,this.updateElement(l,void 0,{animated:!i,options:c},e)}else this.datasetElementType&&(delete t.dataset,this.datasetElementType=!1);this.updateElements(r,a,s,e)}},{key:"addElements",value:function(){var e=this.options.showLine;!this.datasetElementType&&e&&(this.datasetElementType=this.chart.registry.getElement("line")),(0,e0._)((0,e1._)(t.prototype),"addElements",this).call(this)}},{key:"updateElements",value:function(e,t,n,r){for(var i="reset"===r,o=this._cachedMeta,a=o.iScale,s=o.vScale,l=o._stacked,u=o._dataset,c=this.resolveDataElementOptions(t,r),d=this.getSharedOptions(c),f=this.includeOptions(r,d),p=a.axis,h=s.axis,g=this.options,m=g.spanGaps,x=g.segment,y=t5(m)?m:1/0,b=this.chart._animationsDisabled||i||"none"===r,w=t>0&&this.getParsed(t-1),k=t;k<t+n;++k){var _=e[k],S=this.getParsed(k),C=b?_:{},j=tj(S[h]),T=C[p]=a.getPixelForValue(S[p],k),E=C[h]=i||j?s.getBasePixel():s.getPixelForValue(l?this.applyStack(s,S,l):S[h],k);C.skip=isNaN(T)||isNaN(E)||j,C.stop=k>0&&Math.abs(S[p]-w[p])>y,x&&(C.parsed=S,C.raw=u.data[k]),f&&(C.options=d||this.resolveDataElementOptions(k,_.active?"active":r)),b||this.updateElement(_,k,C,r),w=S}this.updateSharedOptions(d,r,c)}},{key:"getMaxOverflow",value:function(){var e=this._cachedMeta,t=e.data||[];if(!this.options.showLine){for(var n=0,r=t.length-1;r>=0;--r)n=Math.max(n,t[r].size(this.resolveDataElementOptions(r))/2);return n>0&&n}var i=e.dataset,o=i.options&&i.options.borderWidth||0;return t.length?Math.max(o,t[0].size(this.resolveDataElementOptions(0)),t[t.length-1].size(this.resolveDataElementOptions(t.length-1)))/2:o}}]),t}(rH);function r8(){throw Error("This method is not implemented: Check that a complete date adapter is provided.")}(0,eZ._)(r4,"id","scatter"),(0,eZ._)(r4,"defaults",{datasetElementType:!1,dataElementType:"point",showLine:!1,fill:!1}),(0,eZ._)(r4,"overrides",{interaction:{mode:"point"},scales:{x:{type:"linear"},y:{type:"linear"}}});var r5={_date:function(){function e(t){(0,eX._)(this,e),(0,eZ._)(this,"options",void 0),this.options=t||{}}return(0,eJ._)(e,[{key:"init",value:function(){}},{key:"formats",value:function(){return r8()}},{key:"parse",value:function(){return r8()}},{key:"format",value:function(){return r8()}},{key:"add",value:function(){return r8()}},{key:"diff",value:function(){return r8()}},{key:"startOf",value:function(){return r8()}},{key:"endOf",value:function(){return r8()}}],[{key:"override",value:function(t){Object.assign(e.prototype,t)}}]),e}()};function r6(e,t,n,r,i){for(var o=e.getSortedVisibleDatasetMetas(),a=n[t],s=0,l=o.length;s<l;++s)for(var u=o[s],c=u.index,d=u.data,f=function(e,t,n,r){var i=e.controller,o=e.data,a=e._sorted,s=i._cachedMeta.iScale;if(s&&t===s.axis&&"r"!==t&&a&&o.length){var l=s._reversePixels?nu:nl;if(!r)return l(o,t,n);if(i._sharedOptions){var u=o[0],c="function"==typeof u.getRange&&u.getRange(t);if(c){var d=l(o,t,n-c),f=l(o,t,n+c);return{lo:d.lo,hi:f.hi}}}}return{lo:0,hi:o.length-1}}(o[s],t,a,i),p=f.lo,h=f.hi,g=p;g<=h;++g){var m=d[g];m.skip||r(m,c,g)}}function r9(e,t,n,r,i){var o=[];return(i||e.isPointInArea(t))&&r6(e,n,t,function(n,a,s){(i||nU(n,e.chartArea,0))&&n.inRange(t.x,t.y,r)&&o.push({element:n,datasetIndex:a,index:s})},!0),o}function r7(e,t,n,r,i,o){var a,s,l,u,c,d;return o||e.isPointInArea(t)?"r"!==n||r?(a=[],s=-1!==n.indexOf("x"),l=-1!==n.indexOf("y"),u=function(e,t){return Math.sqrt(Math.pow(s?Math.abs(e.x-t.x):0,2)+Math.pow(l?Math.abs(e.y-t.y):0,2))},c=1/0,r6(e,n,t,function(n,s,l){var d=n.inRange(t.x,t.y,i);if(!r||d){var f=n.getCenterPoint(i);if(o||e.isPointInArea(f)||d){var p=u(t,f);p<c?(a=[{element:n,datasetIndex:s,index:l}],c=p):p===c&&a.push({element:n,datasetIndex:s,index:l})}}}),a):(d=[],r6(e,n,t,function(e,n,r){var o=e.getProps(["startAngle","endAngle"],i),a=o.startAngle,s=o.endAngle;ni(ne(e,{x:t.x,y:t.y}).angle,a,s)&&d.push({element:e,datasetIndex:n,index:r})}),d):[]}function ie(e,t,n,r,i){var o=[],a="x"===n?"inXRange":"inYRange",s=!1;return(r6(e,n,t,function(e,r,l){e[a](t[n],i)&&(o.push({element:e,datasetIndex:r,index:l}),s=s||e.inRange(t.x,t.y,i))}),r&&!s)?[]:o}var it={index:function(e,t,n,r){var i=rp(t,e),o=n.axis||"x",a=n.includeInvisible||!1,s=n.intersect?r9(e,i,o,r,a):r7(e,i,o,!1,r,a),l=[];return s.length?(e.getSortedVisibleDatasetMetas().forEach(function(e){var t=s[0].index,n=e.data[t];n&&!n.skip&&l.push({element:n,datasetIndex:e.index,index:t})}),l):[]},dataset:function(e,t,n,r){var i=rp(t,e),o=n.axis||"xy",a=n.includeInvisible||!1,s=n.intersect?r9(e,i,o,r,a):r7(e,i,o,!1,r,a);if(s.length>0){var l=s[0].datasetIndex,u=e.getDatasetMeta(l).data;s=[];for(var c=0;c<u.length;++c)s.push({element:u[c],datasetIndex:l,index:c})}return s},point:function(e,t,n,r){var i=rp(t,e);return r9(e,i,n.axis||"xy",r,n.includeInvisible||!1)},nearest:function(e,t,n,r){var i=rp(t,e),o=n.axis||"xy",a=n.includeInvisible||!1;return r7(e,i,o,n.intersect,r,a)},x:function(e,t,n,r){var i=rp(t,e);return ie(e,i,"x",n.intersect,r)},y:function(e,t,n,r){var i=rp(t,e);return ie(e,i,"y",n.intersect,r)}},ir=["left","top","right","bottom"];function ii(e,t){return e.filter(function(e){return e.pos===t})}function io(e,t){return e.filter(function(e){return -1===ir.indexOf(e.pos)&&e.box.axis===t})}function ia(e,t){return e.sort(function(e,n){var r=t?n:e,i=t?e:n;return r.weight===i.weight?r.index-i.index:r.weight-i.weight})}function is(e,t,n,r){return Math.max(e[n],t[n])+Math.max(e[r],t[r])}function il(e,t){e.top=Math.max(e.top,t.top),e.left=Math.max(e.left,t.left),e.bottom=Math.max(e.bottom,t.bottom),e.right=Math.max(e.right,t.right)}function iu(e,t,n,r){var i,o,a,s,l,u,c=[];for(i=0,o=e.length,l=0;i<o;++i){(s=(a=e[i]).box).update(a.width||t.w,a.height||t.h,function(e,t){var n=t.maxPadding;return function(e){var r={left:0,top:0,right:0,bottom:0};return e.forEach(function(e){r[e]=Math.max(t[e],n[e])}),r}(e?["left","right"]:["top","bottom"])}(a.horizontal,t));var d=function(e,t,n,r){var i=n.pos,o=n.box,a=e.maxPadding;if(!tE(i)){n.size&&(e[i]-=n.size);var s=r[n.stack]||{size:0,count:1};s.size=Math.max(s.size,n.horizontal?o.height:o.width),n.size=s.size/s.count,e[i]+=n.size}o.getPadding&&il(a,o.getPadding());var l=Math.max(0,t.outerWidth-is(a,e,"left","right")),u=Math.max(0,t.outerHeight-is(a,e,"top","bottom")),c=l!==e.w,d=u!==e.h;return e.w=l,e.h=u,n.horizontal?{same:c,other:d}:{same:d,other:c}}(t,n,a,r),f=d.same,p=d.other;l|=f&&c.length,u=u||p,s.fullSize||c.push(a)}return l&&iu(c,t,n,r)||u}function ic(e,t,n,r,i){e.top=n,e.left=t,e.right=t+r,e.bottom=n+i,e.width=r,e.height=i}function id(e,t,n,r){var i=n.padding,o=t.x,a=t.y,s=!0,l=!1,u=void 0;try{for(var c,d=e[Symbol.iterator]();!(s=(c=d.next()).done);s=!0){var f=c.value,p=f.box,h=r[f.stack]||{count:1,placed:0,weight:1},g=f.stackWeight/h.weight||1;if(f.horizontal){var m=t.w*g,x=h.size||p.height;tH(h.start)&&(a=h.start),p.fullSize?ic(p,i.left,a,n.outerWidth-i.right-i.left,x):ic(p,t.left+h.placed,a,m,x),h.start=a,h.placed+=m,a=p.bottom}else{var y=t.h*g,b=h.size||p.width;tH(h.start)&&(o=h.start),p.fullSize?ic(p,o,i.top,b,n.outerHeight-i.bottom-i.top):ic(p,o,t.top+h.placed,b,y),h.start=o,h.placed+=y,o=p.right}}}catch(e){l=!0,u=e}finally{try{s||null==d.return||d.return()}finally{if(l)throw u}}t.x=o,t.y=a}var ip=function(e,t){e.boxes||(e.boxes=[]),t.fullSize=t.fullSize||!1,t.position=t.position||"top",t.weight=t.weight||0,t._layers=t._layers||function(){return[{z:0,draw:function(e){t.draw(e)}}]},e.boxes.push(t)},ih=function(e,t){var n=e.boxes?e.boxes.indexOf(t):-1;-1!==n&&e.boxes.splice(n,1)},ig=function(e,t,n){t.fullSize=n.fullSize,t.position=n.position,t.weight=n.weight},im=function(e,t,n,r){if(e){var i,o,a,s,l,u,c,d,f=nZ(e.options.layout.padding),p=Math.max(t-f.width,0),h=Math.max(n-f.height,0),g=(o=ia((i=function(e){var t,n,r,i,o,a,s,l,u=[];for(t=0,n=(e||[]).length;t<n;++t)i=(r=e[t]).position,o=(s=r.options).stack,a=void 0===(l=s.stackWeight)?1:l,u.push({index:t,box:r,pos:i,horizontal:r.isHorizontal(),weight:r.weight,stack:o&&i+o,stackWeight:a});return u}(e.boxes)).filter(function(e){return e.box.fullSize}),!0),a=ia(ii(i,"left"),!0),s=ia(ii(i,"right")),l=ia(ii(i,"top"),!0),u=ia(ii(i,"bottom")),c=io(i,"x"),d=io(i,"y"),{fullSize:o,leftAndTop:a.concat(l),rightAndBottom:s.concat(d).concat(u).concat(c),chartArea:ii(i,"chartArea"),vertical:a.concat(s).concat(d),horizontal:l.concat(u).concat(c)}),m=g.vertical,x=g.horizontal;tO(e.boxes,function(e){"function"==typeof e.beforeLayout&&e.beforeLayout()});var y=Object.freeze({outerWidth:t,outerHeight:n,padding:f,availableWidth:p,availableHeight:h,vBoxMaxWidth:p/2/(m.reduce(function(e,t){return t.box.options&&!1===t.box.options.display?e:e+1},0)||1),hBoxMaxHeight:h/2}),b=Object.assign({},f);il(b,nZ(r));var w=Object.assign({maxPadding:b,w:p,h:h,x:f.left,y:f.top},f),k=function(e,t){var n,r,i,o=function(e){var t={},n=!0,r=!1,i=void 0;try{for(var o,a=e[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var s=o.value,l=s.stack,u=s.pos,c=s.stackWeight;if(l&&ir.includes(u)){var d=t[l]||(t[l]={count:0,placed:0,weight:0,size:0});d.count++,d.weight+=c}}}catch(e){r=!0,i=e}finally{try{n||null==a.return||a.return()}finally{if(r)throw i}}return t}(e),a=t.vBoxMaxWidth,s=t.hBoxMaxHeight;for(n=0,r=e.length;n<r;++n){var l=(i=e[n]).box.fullSize,u=o[i.stack],c=u&&i.stackWeight/u.weight;i.horizontal?(i.width=c?c*a:l&&t.availableWidth,i.height=s):(i.width=a,i.height=c?c*s:l&&t.availableHeight)}return o}(m.concat(x),y);iu(g.fullSize,w,y,k),iu(m,w,y,k),iu(x,w,y,k)&&iu(m,w,y,k);var _=w.maxPadding;function S(e){var t=Math.max(_[e]-w[e],0);return w[e]+=t,t}w.y+=S("top"),w.x+=S("left"),S("right"),S("bottom"),id(g.leftAndTop,w,y,k),w.x+=w.w,w.y+=w.h,id(g.rightAndBottom,w,y,k),e.chartArea={left:w.left,top:w.top,right:w.left+w.w,bottom:w.top+w.h,height:w.h,width:w.w},tO(g.chartArea,function(t){var n=t.box;Object.assign(n,e.chartArea),n.update(w.w,w.h,{left:0,top:0,right:0,bottom:0})})}},iv=function(){function e(){(0,eX._)(this,e)}return(0,eJ._)(e,[{key:"acquireContext",value:function(e,t){}},{key:"releaseContext",value:function(e){return!1}},{key:"addEventListener",value:function(e,t,n){}},{key:"removeEventListener",value:function(e,t,n){}},{key:"getDevicePixelRatio",value:function(){return 1}},{key:"getMaximumSize",value:function(e,t,n,r){return t=Math.max(0,t||e.width),n=n||e.height,{width:t,height:Math.max(0,r?Math.floor(t/r):n)}}},{key:"isAttached",value:function(e){return!0}},{key:"updateConfig",value:function(e){}}]),e}(),ix=function(e){function t(){return(0,eX._)(this,t),(0,eQ._)(this,t,arguments)}return(0,e2._)(t,e),(0,eJ._)(t,[{key:"acquireContext",value:function(e){return e&&e.getContext&&e.getContext("2d")||null}},{key:"updateConfig",value:function(e){e.options.animation=!1}}]),t}(iv),iy="$chartjs",ib={touchstart:"mousedown",touchmove:"mousemove",touchend:"mouseup",pointerenter:"mouseenter",pointerdown:"mousedown",pointermove:"mousemove",pointerup:"mouseup",pointerleave:"mouseout",pointerout:"mouseout"},iw=function(e){return null===e||""===e},ik=!!rm&&{passive:!0};function i_(e,t){var n=!0,r=!1,i=void 0;try{for(var o,a=e[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var s=o.value;if(s===t||s.contains(t))return!0}}catch(e){r=!0,i=e}finally{try{n||null==a.return||a.return()}finally{if(r)throw i}}}function iS(e,t,n){var r=e.canvas,i=new MutationObserver(function(e){var t=!1,i=!0,o=!1,a=void 0;try{for(var s,l=e[Symbol.iterator]();!(i=(s=l.next()).done);i=!0){var u=s.value;t=(t=t||i_(u.addedNodes,r))&&!i_(u.removedNodes,r)}}catch(e){o=!0,a=e}finally{try{i||null==l.return||l.return()}finally{if(o)throw a}}t&&n()});return i.observe(document,{childList:!0,subtree:!0}),i}function iC(e,t,n){var r=e.canvas,i=new MutationObserver(function(e){var t=!1,i=!0,o=!1,a=void 0;try{for(var s,l=e[Symbol.iterator]();!(i=(s=l.next()).done);i=!0){var u=s.value;t=(t=t||i_(u.removedNodes,r))&&!i_(u.addedNodes,r)}}catch(e){o=!0,a=e}finally{try{i||null==l.return||l.return()}finally{if(o)throw a}}t&&n()});return i.observe(document,{childList:!0,subtree:!0}),i}var ij=new Map,iT=0;function iE(){var e=window.devicePixelRatio;e!==iT&&(iT=e,ij.forEach(function(t,n){n.currentDevicePixelRatio!==e&&t()}))}function iR(e,t,n){var r=e.canvas,i=r&&rl(r);if(i){var o=nh(function(e,t){var r=i.clientWidth;n(e,t),r<i.clientWidth&&n()},window),a=new ResizeObserver(function(e){var t=e[0],n=t.contentRect.width,r=t.contentRect.height;(0!==n||0!==r)&&o(n,r)});return a.observe(i),ij.size||window.addEventListener("resize",iE),ij.set(e,o),a}}function iI(e,t,n){n&&n.disconnect(),"resize"===t&&(ij.delete(e),ij.size||window.removeEventListener("resize",iE))}function iA(e,t,n){var r=e.canvas,i=nh(function(t){var r,i,o,a;null!==e.ctx&&n((r=ib[t.type]||t.type,o=(i=rp(t,e)).x,{type:r,chart:e,native:t,x:void 0!==o?o:null,y:void 0!==(a=i.y)?a:null}))},e);return r.addEventListener(t,i,ik),i}var iP=function(e){function t(){return(0,eX._)(this,t),(0,eQ._)(this,t,arguments)}return(0,e2._)(t,e),(0,eJ._)(t,[{key:"acquireContext",value:function(e,t){var n=e&&e.getContext&&e.getContext("2d");return n&&n.canvas===e?(!function(e,t){var n=e.style,r=e.getAttribute("height"),i=e.getAttribute("width");if(e[iy]={initial:{height:r,width:i,style:{display:n.display,height:n.height,width:n.width}}},n.display=n.display||"block",n.boxSizing=n.boxSizing||"border-box",iw(i)){var o=rv(e,"width");void 0!==o&&(e.width=o)}if(iw(r))if(""===e.style.height)e.height=e.width/(t||2);else{var a=rv(e,"height");void 0!==a&&(e.height=a)}}(e,t),n):null}},{key:"releaseContext",value:function(e){var t=e.canvas;if(!t[iy])return!1;var n=t[iy].initial;["height","width"].forEach(function(e){var r=n[e];tj(r)?t.removeAttribute(e):t.setAttribute(e,r)});var r=n.style||{};return Object.keys(r).forEach(function(e){t.style[e]=r[e]}),t.width=t.width,delete t[iy],!0}},{key:"addEventListener",value:function(e,t,n){this.removeEventListener(e,t);var r=e.$proxies||(e.$proxies={}),i={attach:iS,detach:iC,resize:iR}[t]||iA;r[t]=i(e,t,n)}},{key:"removeEventListener",value:function(e,t){var n=e.$proxies||(e.$proxies={}),r=n[t];r&&((({attach:iI,detach:iI,resize:iI})[t]||function(e,t,n){e.canvas.removeEventListener(t,n,ik)})(e,t,r),n[t]=void 0)}},{key:"getDevicePixelRatio",value:function(){return window.devicePixelRatio}},{key:"getMaximumSize",value:function(e,t,n,r){return function(e,t,n,r){var i=rc(e),o=rf(i,"margin"),a=ru(i.maxWidth,e,"clientWidth")||tX,s=ru(i.maxHeight,e,"clientHeight")||tX,l=function(e,t,n){var r,i;if(void 0===t||void 0===n){var o=rl(e);if(o){var a=o.getBoundingClientRect(),s=rc(o),l=rf(s,"border","width"),u=rf(s,"padding");t=a.width-u.width-l.width,n=a.height-u.height-l.height,r=ru(s.maxWidth,o,"clientWidth"),i=ru(s.maxHeight,o,"clientHeight")}else t=e.clientWidth,n=e.clientHeight}return{width:t,height:n,maxWidth:r||tX,maxHeight:i||tX}}(e,t,n),u=l.width,c=l.height;if("content-box"===i.boxSizing){var d=rf(i,"border","width"),f=rf(i,"padding");u-=f.width+d.width,c-=f.height+d.height}return u=Math.max(0,u-o.width),c=Math.max(0,r?u/r:c-o.height),u=rh(Math.min(u,a,l.maxWidth)),c=rh(Math.min(c,s,l.maxHeight)),u&&!c&&(c=rh(u/2)),(void 0!==t||void 0!==n)&&r&&l.height&&c>l.height&&(u=rh(Math.floor((c=l.height)*r))),{width:u,height:c}}(e,t,n,r)}},{key:"isAttached",value:function(e){var t=rl(e);return!!(t&&t.isConnected)}}]),t}(iv),iD=function(){function e(){(0,eX._)(this,e),(0,eZ._)(this,"x",void 0),(0,eZ._)(this,"y",void 0),(0,eZ._)(this,"active",!1),(0,eZ._)(this,"options",void 0),(0,eZ._)(this,"$animations",void 0)}return(0,eJ._)(e,[{key:"tooltipPosition",value:function(e){var t=this.getProps(["x","y"],e);return{x:t.x,y:t.y}}},{key:"hasValue",value:function(){return t5(this.x)&&t5(this.y)}},{key:"getProps",value:function(e,t){var n=this,r=this.$animations;if(!t||!r)return this;var i={};return e.forEach(function(e){i[e]=r[e]&&r[e].active()?r[e]._to:n[e]}),i}}]),e}();function iO(e,t,n,r,i){var o,a,s,l=tA(r,0),u=Math.min(tA(i,e.length),e.length),c=0;for(n=Math.ceil(n),i&&(n=(o=i-r)/Math.floor(o/n)),s=l;s<0;)s=Math.round(l+ ++c*n);for(a=Math.max(l,0);a<u;a++)a===s&&(t.push(e[a]),s=Math.round(l+ ++c*n))}(0,eZ._)(iD,"defaults",{}),(0,eZ._)(iD,"defaultRoutes",void 0);var iN=function(e,t,n){return"top"===t||"left"===t?e[t]+n:e[t]-n},iM=function(e,t){return Math.min(t||e,e)};function iL(e,t){for(var n=[],r=e.length/t,i=e.length,o=0;o<i;o+=r)n.push(e[Math.floor(o)]);return n}function iB(e){return e.drawTicks?e.tickLength:0}function iV(e,t){if(!e.display)return 0;var n=n0(e.font,t),r=nZ(e.padding);return(tT(e.text)?e.text.length:1)*n.lineHeight+r.height}var iF=function(e){function t(e){var n;return(0,eX._)(this,t),(n=(0,eQ._)(this,t)).id=e.id,n.type=e.type,n.options=void 0,n.ctx=e.ctx,n.chart=e.chart,n.top=void 0,n.bottom=void 0,n.left=void 0,n.right=void 0,n.width=void 0,n.height=void 0,n._margins={left:0,right:0,top:0,bottom:0},n.maxWidth=void 0,n.maxHeight=void 0,n.paddingTop=void 0,n.paddingBottom=void 0,n.paddingLeft=void 0,n.paddingRight=void 0,n.axis=void 0,n.labelRotation=void 0,n.min=void 0,n.max=void 0,n._range=void 0,n.ticks=[],n._gridLineItems=null,n._labelItems=null,n._labelSizes=null,n._length=0,n._maxLength=0,n._longestTextCache={},n._startPixel=void 0,n._endPixel=void 0,n._reversePixels=!1,n._userMax=void 0,n._userMin=void 0,n._suggestedMax=void 0,n._suggestedMin=void 0,n._ticksLength=0,n._borderValue=0,n._cache={},n._dataLimitsCached=!1,n.$context=void 0,n}return(0,e2._)(t,e),(0,eJ._)(t,[{key:"init",value:function(e){this.options=e.setContext(this.getContext()),this.axis=e.axis,this._userMin=this.parse(e.min),this._userMax=this.parse(e.max),this._suggestedMin=this.parse(e.suggestedMin),this._suggestedMax=this.parse(e.suggestedMax)}},{key:"parse",value:function(e,t){return e}},{key:"getUserBounds",value:function(){var e=this._userMin,t=this._userMax,n=this._suggestedMin,r=this._suggestedMax;return e=tI(e,1/0),t=tI(t,-1/0),n=tI(n,1/0),r=tI(r,-1/0),{min:tI(e,n),max:tI(t,r),minDefined:tR(e),maxDefined:tR(t)}}},{key:"getMinMax",value:function(e){var t,n=this.getUserBounds(),r=n.min,i=n.max,o=n.minDefined,a=n.maxDefined;if(o&&a)return{min:r,max:i};for(var s=this.getMatchingVisibleMetas(),l=0,u=s.length;l<u;++l)t=s[l].controller.getMinMax(this,e),o||(r=Math.min(r,t.min)),a||(i=Math.max(i,t.max));return r=a&&r>i?i:r,i=o&&r>i?r:i,{min:tI(r,tI(i,r)),max:tI(i,tI(r,i))}}},{key:"getPadding",value:function(){return{left:this.paddingLeft||0,top:this.paddingTop||0,right:this.paddingRight||0,bottom:this.paddingBottom||0}}},{key:"getTicks",value:function(){return this.ticks}},{key:"getLabels",value:function(){var e=this.chart.data;return this.options.labels||(this.isHorizontal()?e.xLabels:e.yLabels)||e.labels||[]}},{key:"getLabelItems",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.chart.chartArea;return this._labelItems||(this._labelItems=this._computeLabelItems(e))}},{key:"beforeLayout",value:function(){this._cache={},this._dataLimitsCached=!1}},{key:"beforeUpdate",value:function(){tD(this.options.beforeUpdate,[this])}},{key:"update",value:function(e,t,n){var r,i,o,a,s=this.options,l=s.beginAtZero,u=s.grace,c=s.ticks,d=c.sampleSize;this.beforeUpdate(),this.maxWidth=e,this.maxHeight=t,this._margins=n=Object.assign({left:0,right:0,top:0,bottom:0},n),this.ticks=null,this._labelSizes=null,this._gridLineItems=null,this._labelItems=null,this.beforeSetDimensions(),this.setDimensions(),this.afterSetDimensions(),this._maxLength=this.isHorizontal()?this.width+n.left+n.right:this.height+n.top+n.bottom,this._dataLimitsCached||(this.beforeDataLimits(),this.determineDataLimits(),this.afterDataLimits(),this._range=(r=this.min,o=tP(u,((i=this.max)-r)/2),{min:(a=function(e,t){return l&&0===e?0:e+t})(r,-Math.abs(o)),max:a(i,o)}),this._dataLimitsCached=!0),this.beforeBuildTicks(),this.ticks=this.buildTicks()||[],this.afterBuildTicks();var f=d<this.ticks.length;this._convertTicksToLabels(f?iL(this.ticks,d):this.ticks),this.configure(),this.beforeCalculateLabelRotation(),this.calculateLabelRotation(),this.afterCalculateLabelRotation(),c.display&&(c.autoSkip||"auto"===c.source)&&(this.ticks=function(e,t){var n=e.options.ticks,r=(f=(d=e).options.offset,p=d._tickSize(),Math.floor(Math.min(d._length/p+ +!f,d._maxLength/p))),i=Math.min(n.maxTicksLimit||r,r),o=n.major.enabled?function(e){var t,n,r=[];for(t=0,n=e.length;t<n;t++)e[t].major&&r.push(t);return r}(t):[],a=o.length,s=o[0],l=o[a-1],u=[];if(a>i)return function(e,t,n,r){var i,o=0,a=n[0];for(i=0,r=Math.ceil(r);i<e.length;i++)i===a&&(t.push(e[i]),a=n[++o*r])}(t,u,o,a/i),u;var c=function(e,t,n){var r=function(e){var t,n,r=e.length;if(r<2)return!1;for(n=e[0],t=1;t<r;++t)if(e[t]-e[t-1]!==n)return!1;return n}(e),i=t.length/n;if(!r)return Math.max(i,1);for(var o=function(e){var t,n=[],r=Math.sqrt(e);for(t=1;t<r;t++)e%t==0&&(n.push(t),n.push(e/t));return r===(0|r)&&n.push(r),n.sort(function(e,t){return e-t}).pop(),n}(r),a=0,s=o.length-1;a<s;a++){var l=o[a];if(l>i)return l}return Math.max(i,1)}(o,t,i);if(a>0){var d,f,p,h,g,m=a>1?Math.round((l-s)/(a-1)):null;for(iO(t,u,c,tj(m)?0:s-m,s),h=0,g=a-1;h<g;h++)iO(t,u,c,o[h],o[h+1]);return iO(t,u,c,l,tj(m)?t.length:l+m),u}return iO(t,u,c),u}(this,this.ticks),this._labelSizes=null,this.afterAutoSkip()),f&&this._convertTicksToLabels(this.ticks),this.beforeFit(),this.fit(),this.afterFit(),this.afterUpdate()}},{key:"configure",value:function(){var e,t,n=this.options.reverse;this.isHorizontal()?(e=this.left,t=this.right):(e=this.top,t=this.bottom,n=!n),this._startPixel=e,this._endPixel=t,this._reversePixels=n,this._length=t-e,this._alignToPixels=this.options.alignToPixels}},{key:"afterUpdate",value:function(){tD(this.options.afterUpdate,[this])}},{key:"beforeSetDimensions",value:function(){tD(this.options.beforeSetDimensions,[this])}},{key:"setDimensions",value:function(){this.isHorizontal()?(this.width=this.maxWidth,this.left=0,this.right=this.width):(this.height=this.maxHeight,this.top=0,this.bottom=this.height),this.paddingLeft=0,this.paddingTop=0,this.paddingRight=0,this.paddingBottom=0}},{key:"afterSetDimensions",value:function(){tD(this.options.afterSetDimensions,[this])}},{key:"_callHooks",value:function(e){this.chart.notifyPlugins(e,this.getContext()),tD(this.options[e],[this])}},{key:"beforeDataLimits",value:function(){this._callHooks("beforeDataLimits")}},{key:"determineDataLimits",value:function(){}},{key:"afterDataLimits",value:function(){this._callHooks("afterDataLimits")}},{key:"beforeBuildTicks",value:function(){this._callHooks("beforeBuildTicks")}},{key:"buildTicks",value:function(){return[]}},{key:"afterBuildTicks",value:function(){this._callHooks("afterBuildTicks")}},{key:"beforeTickToLabelConversion",value:function(){tD(this.options.beforeTickToLabelConversion,[this])}},{key:"generateTickLabels",value:function(e){var t,n,r,i=this.options.ticks;for(t=0,n=e.length;t<n;t++)(r=e[t]).label=tD(i.callback,[r.value,t,e],this)}},{key:"afterTickToLabelConversion",value:function(){tD(this.options.afterTickToLabelConversion,[this])}},{key:"beforeCalculateLabelRotation",value:function(){tD(this.options.beforeCalculateLabelRotation,[this])}},{key:"calculateLabelRotation",value:function(){var e,t,n,r=this.options,i=r.ticks,o=iM(this.ticks.length,r.ticks.maxTicksLimit),a=i.minRotation||0,s=i.maxRotation,l=a;if(!this._isVisible()||!i.display||a>=s||o<=1||!this.isHorizontal()){this.labelRotation=a;return}var u=this._getLabelSizes(),c=u.widest.width,d=u.highest.height,f=no(this.chart.width-c,0,this.maxWidth);c+6>(e=r.offset?this.maxWidth/o:f/(o-1))&&(e=f/(o-(r.offset?.5:1)),t=this.maxHeight-iB(r.grid)-i.padding-iV(r.title,this.chart.options.font),n=Math.sqrt(c*c+d*d),l=Math.max(a,Math.min(s,l=180/tK*Math.min(Math.asin(no((u.highest.height+6)/e,-1,1)),Math.asin(no(t/n,-1,1))-Math.asin(no(d/n,-1,1)))))),this.labelRotation=l}},{key:"afterCalculateLabelRotation",value:function(){tD(this.options.afterCalculateLabelRotation,[this])}},{key:"afterAutoSkip",value:function(){}},{key:"beforeFit",value:function(){tD(this.options.beforeFit,[this])}},{key:"fit",value:function(){var e={width:0,height:0},t=this.chart,n=this.options,r=n.ticks,i=n.title,o=n.grid,a=this._isVisible(),s=this.isHorizontal();if(a){var l=iV(i,t.options.font);if(s?(e.width=this.maxWidth,e.height=iB(o)+l):(e.height=this.maxHeight,e.width=iB(o)+l),r.display&&this.ticks.length){var u=this._getLabelSizes(),c=u.first,d=u.last,f=u.widest,p=u.highest,h=2*r.padding,g=t9(this.labelRotation),m=Math.cos(g),x=Math.sin(g);if(s){var y=r.mirror?0:x*f.width+m*p.height;e.height=Math.min(this.maxHeight,e.height+y+h)}else{var b=r.mirror?0:m*f.width+x*p.height;e.width=Math.min(this.maxWidth,e.width+b+h)}this._calculatePadding(c,d,x,m)}}this._handleMargins(),s?(this.width=this._length=t.width-this._margins.left-this._margins.right,this.height=e.height):(this.width=e.width,this.height=this._length=t.height-this._margins.top-this._margins.bottom)}},{key:"_calculatePadding",value:function(e,t,n,r){var i=this.options,o=i.ticks,a=o.align,s=o.padding,l=i.position,u=0!==this.labelRotation,c="top"!==l&&"x"===this.axis;if(this.isHorizontal()){var d=this.getPixelForTick(0)-this.left,f=this.right-this.getPixelForTick(this.ticks.length-1),p=0,h=0;u?c?(p=r*e.width,h=n*t.height):(p=n*e.height,h=r*t.width):"start"===a?h=t.width:"end"===a?p=e.width:"inner"!==a&&(p=e.width/2,h=t.width/2),this.paddingLeft=Math.max((p-d+s)*this.width/(this.width-d),0),this.paddingRight=Math.max((h-f+s)*this.width/(this.width-f),0)}else{var g=t.height/2,m=e.height/2;"start"===a?(g=0,m=e.height):"end"===a&&(g=t.height,m=0),this.paddingTop=g+s,this.paddingBottom=m+s}}},{key:"_handleMargins",value:function(){this._margins&&(this._margins.left=Math.max(this.paddingLeft,this._margins.left),this._margins.top=Math.max(this.paddingTop,this._margins.top),this._margins.right=Math.max(this.paddingRight,this._margins.right),this._margins.bottom=Math.max(this.paddingBottom,this._margins.bottom))}},{key:"afterFit",value:function(){tD(this.options.afterFit,[this])}},{key:"isHorizontal",value:function(){var e=this.options,t=e.axis,n=e.position;return"top"===n||"bottom"===n||"x"===t}},{key:"isFullSize",value:function(){return this.options.fullSize}},{key:"_convertTicksToLabels",value:function(e){var t,n;for(this.beforeTickToLabelConversion(),this.generateTickLabels(e),t=0,n=e.length;t<n;t++)tj(e[t].label)&&(e.splice(t,1),n--,t--);this.afterTickToLabelConversion()}},{key:"_getLabelSizes",value:function(){var e=this._labelSizes;if(!e){var t=this.options.ticks.sampleSize,n=this.ticks;t<n.length&&(n=iL(n,t)),this._labelSizes=e=this._computeLabelSizes(n,n.length,this.options.ticks.maxTicksLimit)}return e}},{key:"_computeLabelSizes",value:function(e,t,n){var r,i,o,a,s,l,u,c,d,f,p,h=this.ctx,g=this._longestTextCache,m=[],x=[],y=Math.floor(t/iM(t,n)),b=0,w=0;for(r=0;r<t;r+=y){if(a=e[r].label,h.font=l=(s=this._resolveTickFontOptions(r)).string,u=g[l]=g[l]||{data:{},gc:[]},c=s.lineHeight,d=f=0,tj(a)||tT(a)){if(tT(a))for(i=0,o=a.length;i<o;++i)tj(p=a[i])||tT(p)||(d=nM(h,u.data,u.gc,d,p),f+=c)}else d=nM(h,u.data,u.gc,d,a),f=c;m.push(d),x.push(f),b=Math.max(d,b),w=Math.max(f,w)}tO(g,function(e){var n,r=e.gc,i=r.length/2;if(i>t){for(n=0;n<i;++n)delete e.data[r[n]];r.splice(0,i)}});var k=m.indexOf(b),_=x.indexOf(w),S=function(e){return{width:m[e]||0,height:x[e]||0}};return{first:S(0),last:S(t-1),widest:S(k),highest:S(_),widths:m,heights:x}}},{key:"getLabelForValue",value:function(e){return e}},{key:"getPixelForValue",value:function(e,t){return NaN}},{key:"getValueForPixel",value:function(e){}},{key:"getPixelForTick",value:function(e){var t=this.ticks;return e<0||e>t.length-1?null:this.getPixelForValue(t[e].value)}},{key:"getPixelForDecimal",value:function(e){this._reversePixels&&(e=1-e);var t=this._startPixel+e*this._length;return no(this._alignToPixels?nL(this.chart,t,0):t,-32768,32767)}},{key:"getDecimalForPixel",value:function(e){var t=(e-this._startPixel)/this._length;return this._reversePixels?1-t:t}},{key:"getBasePixel",value:function(){return this.getPixelForValue(this.getBaseValue())}},{key:"getBaseValue",value:function(){var e=this.min,t=this.max;return e<0&&t<0?t:e>0&&t>0?e:0}},{key:"getContext",value:function(e){var t,n=this.ticks||[];if(e>=0&&e<n.length){var r=n[e];return r.$context||(r.$context=n2(this.getContext(),{tick:r,index:e,type:"tick"}))}return this.$context||(this.$context=(t=this.chart.getContext(),n2(t,{scale:this,type:"scale"})))}},{key:"_tickSize",value:function(){var e=this.options.ticks,t=t9(this.labelRotation),n=Math.abs(Math.cos(t)),r=Math.abs(Math.sin(t)),i=this._getLabelSizes(),o=e.autoSkipPadding||0,a=i?i.widest.width+o:0,s=i?i.highest.height+o:0;return this.isHorizontal()?s*n>a*r?a/n:s/r:s*r<a*n?s/n:a/r}},{key:"_isVisible",value:function(){var e=this.options.display;return"auto"!==e?!!e:this.getMatchingVisibleMetas().length>0}},{key:"_computeGridLineItems",value:function(e){var t,n,r,i,o,a,s,l,u,c,d,f,p=this.axis,h=this.chart,g=this.options,m=g.grid,x=g.position,y=g.border,b=m.offset,w=this.isHorizontal(),k=this.ticks.length+ +!!b,_=iB(m),S=[],C=y.setContext(this.getContext()),j=C.display?C.width:0,T=j/2,E=function(e){return nL(h,e,j)};if("top"===x)t=E(this.bottom),a=this.bottom-_,l=t-T,c=E(e.top)+T,f=e.bottom;else if("bottom"===x)t=E(this.top),c=e.top,f=E(e.bottom)-T,a=t+T,l=this.top+_;else if("left"===x)t=E(this.right),o=this.right-_,s=t-T,u=E(e.left)+T,d=e.right;else if("right"===x)t=E(this.left),u=e.left,d=E(e.right)-T,o=t+T,s=this.left+_;else if("x"===p){if("center"===x)t=E((e.top+e.bottom)/2+.5);else if(tE(x)){var R=Object.keys(x)[0],I=x[R];t=E(this.chart.scales[R].getPixelForValue(I))}c=e.top,f=e.bottom,l=(a=t+T)+_}else if("y"===p){if("center"===x)t=E((e.left+e.right)/2);else if(tE(x)){var A=Object.keys(x)[0],P=x[A];t=E(this.chart.scales[A].getPixelForValue(P))}s=(o=t-T)-_,u=e.left,d=e.right}var D=tA(g.ticks.maxTicksLimit,k),O=Math.max(1,Math.ceil(k/D));for(n=0;n<k;n+=O){var N=this.getContext(n),M=m.setContext(N),L=y.setContext(N),B=M.lineWidth,V=M.color,F=L.dash||[],U=L.dashOffset,G=M.tickWidth,$=M.tickColor,z=M.tickBorderDash||[],H=M.tickBorderDashOffset;void 0!==(r=function(e,t,n){var r,i=e.ticks.length,o=Math.min(t,i-1),a=e._startPixel,s=e._endPixel,l=e.getPixelForTick(o);if(!n||(r=1===i?Math.max(l-a,s-l):0===t?(e.getPixelForTick(1)-l)/2:(l-e.getPixelForTick(o-1))/2,!((l+=o<t?r:-r)<a-1e-6)&&!(l>s+1e-6)))return l}(this,n,b))&&(i=nL(h,r,B),w?o=s=u=d=i:a=l=c=f=i,S.push({tx1:o,ty1:a,tx2:s,ty2:l,x1:u,y1:c,x2:d,y2:f,width:B,color:V,borderDash:F,borderDashOffset:U,tickWidth:G,tickColor:$,tickBorderDash:z,tickBorderDashOffset:H}))}return this._ticksLength=k,this._borderValue=t,S}},{key:"_computeLabelItems",value:function(e){var t,n,r,i,o,a,s,l,u,c,d,f=this.axis,p=this.options,h=p.position,g=p.ticks,m=this.isHorizontal(),x=this.ticks,y=g.align,b=g.crossAlign,w=g.padding,k=g.mirror,_=iB(p.grid),S=_+w,C=k?-w:S,j=-t9(this.labelRotation),T=[],E="middle";if("top"===h)o=this.bottom-C,a=this._getXAxisLabelAlignment();else if("bottom"===h)o=this.top+C,a=this._getXAxisLabelAlignment();else if("left"===h){var R=this._getYAxisLabelAlignment(_);a=R.textAlign,i=R.x}else if("right"===h){var I=this._getYAxisLabelAlignment(_);a=I.textAlign,i=I.x}else if("x"===f){if("center"===h)o=(e.top+e.bottom)/2+S;else if(tE(h)){var A=Object.keys(h)[0],P=h[A];o=this.chart.scales[A].getPixelForValue(P)+S}a=this._getXAxisLabelAlignment()}else if("y"===f){if("center"===h)i=(e.left+e.right)/2-S;else if(tE(h)){var D=Object.keys(h)[0],O=h[D];i=this.chart.scales[D].getPixelForValue(O)}a=this._getYAxisLabelAlignment(_).textAlign}"y"===f&&("start"===y?E="top":"end"===y&&(E="bottom"));var N=this._getLabelSizes();for(t=0,n=x.length;t<n;++t){r=x[t].label;var M=g.setContext(this.getContext(t));s=this.getPixelForTick(t)+g.labelOffset,u=(l=this._resolveTickFontOptions(t)).lineHeight;var L=(c=tT(r)?r.length:1)/2,B=M.color,V=M.textStrokeColor,F=M.textStrokeWidth,U=a;m?(i=s,"inner"===a&&(U=t===n-1?this.options.reverse?"left":"right":0===t?this.options.reverse?"right":"left":"center"),d="top"===h?"near"===b||0!==j?-c*u+u/2:"center"===b?-N.highest.height/2-L*u+u:-N.highest.height+u/2:"near"===b||0!==j?u/2:"center"===b?N.highest.height/2-L*u:N.highest.height-c*u,k&&(d*=-1),0===j||M.showLabelBackdrop||(i+=u/2*Math.sin(j))):(o=s,d=(1-c)*u/2);var G=void 0;if(M.showLabelBackdrop){var $=nZ(M.backdropPadding),z=N.heights[t],H=N.widths[t],W=d-$.top,q=0-$.left;switch(E){case"middle":W-=z/2;break;case"bottom":W-=z}switch(a){case"center":q-=H/2;break;case"right":q-=H}G={left:q,top:W,width:H+$.width,height:z+$.height,color:M.backdropColor}}T.push({label:r,font:l,textOffset:d,options:{rotation:j,color:B,strokeColor:V,strokeWidth:F,textAlign:U,textBaseline:E,translation:[i,o],backdrop:G}})}return T}},{key:"_getXAxisLabelAlignment",value:function(){var e=this.options,t=e.position,n=e.ticks;if(-t9(this.labelRotation))return"top"===t?"left":"right";var r="center";return"start"===n.align?r="left":"end"===n.align?r="right":"inner"===n.align&&(r="inner"),r}},{key:"_getYAxisLabelAlignment",value:function(e){var t,n,r=this.options,i=r.position,o=r.ticks,a=o.crossAlign,s=o.mirror,l=o.padding,u=this._getLabelSizes(),c=e+l,d=u.widest.width;return"left"===i?s?(n=this.right+l,"near"===a?t="left":"center"===a?(t="center",n+=d/2):(t="right",n+=d)):(n=this.right-c,"near"===a?t="right":"center"===a?(t="center",n-=d/2):(t="left",n=this.left)):"right"===i?s?(n=this.left+l,"near"===a?t="right":"center"===a?(t="center",n-=d/2):(t="left",n-=d)):(n=this.left+c,"near"===a?t="left":"center"===a?(t="center",n+=d/2):(t="right",n=this.right)):t="right",{textAlign:t,x:n}}},{key:"_computeLabelArea",value:function(){if(!this.options.ticks.mirror){var e=this.chart,t=this.options.position;if("left"===t||"right"===t)return{top:0,left:this.left,bottom:e.height,right:this.right};if("top"===t||"bottom"===t)return{top:this.top,left:0,bottom:this.bottom,right:e.width}}}},{key:"drawBackground",value:function(){var e=this.ctx,t=this.options.backgroundColor,n=this.left,r=this.top,i=this.width,o=this.height;t&&(e.save(),e.fillStyle=t,e.fillRect(n,r,i,o),e.restore())}},{key:"getLineWidthForValue",value:function(e){var t=this.options.grid;if(!this._isVisible()||!t.display)return 0;var n=this.ticks.findIndex(function(t){return t.value===e});return n>=0?t.setContext(this.getContext(n)).lineWidth:0}},{key:"drawGrid",value:function(e){var t,n,r=this.options.grid,i=this.ctx,o=this._gridLineItems||(this._gridLineItems=this._computeGridLineItems(e)),a=function(e,t,n){n.width&&n.color&&(i.save(),i.lineWidth=n.width,i.strokeStyle=n.color,i.setLineDash(n.borderDash||[]),i.lineDashOffset=n.borderDashOffset,i.beginPath(),i.moveTo(e.x,e.y),i.lineTo(t.x,t.y),i.stroke(),i.restore())};if(r.display)for(t=0,n=o.length;t<n;++t){var s=o[t];r.drawOnChartArea&&a({x:s.x1,y:s.y1},{x:s.x2,y:s.y2},s),r.drawTicks&&a({x:s.tx1,y:s.ty1},{x:s.tx2,y:s.ty2},{color:s.tickColor,width:s.tickWidth,borderDash:s.tickBorderDash,borderDashOffset:s.tickBorderDashOffset})}}},{key:"drawBorder",value:function(){var e,t,n,r,i=this.chart,o=this.ctx,a=this.options,s=a.border,l=a.grid,u=s.setContext(this.getContext()),c=s.display?u.width:0;if(c){var d=l.setContext(this.getContext(0)).lineWidth,f=this._borderValue;this.isHorizontal()?(e=nL(i,this.left,c)-c/2,t=nL(i,this.right,d)+d/2,n=r=f):(n=nL(i,this.top,c)-c/2,r=nL(i,this.bottom,d)+d/2,e=t=f),o.save(),o.lineWidth=u.width,o.strokeStyle=u.color,o.beginPath(),o.moveTo(e,n),o.lineTo(t,r),o.stroke(),o.restore()}}},{key:"drawLabels",value:function(e){if(this.options.ticks.display){var t=this.ctx,n=this._computeLabelArea();n&&nG(t,n);var r=this.getLabelItems(e),i=!0,o=!1,a=void 0;try{for(var s,l=r[Symbol.iterator]();!(i=(s=l.next()).done);i=!0){var u=s.value,c=u.options,d=u.font,f=u.label,p=u.textOffset;nW(t,f,0,p,d,c)}}catch(e){o=!0,a=e}finally{try{i||null==l.return||l.return()}finally{if(o)throw a}}n&&n$(t)}}},{key:"drawTitle",value:function(){var e=this.ctx,t=this.options,n=t.position,r=t.title,i=t.reverse;if(r.display){var o,a,s=n0(r.font),l=nZ(r.padding),u=r.align,c=s.lineHeight/2;"bottom"===n||"center"===n||tE(n)?(c+=l.bottom,tT(r.text)&&(c+=s.lineHeight*(r.text.length-1))):c+=l.top;var d=function(e,t,n,r){var i,o,a,s=e.top,l=e.left,u=e.bottom,c=e.right,d=e.chart,f=d.chartArea,p=d.scales,h=0,g=u-s,m=c-l;if(e.isHorizontal()){if(o=nm(r,l,c),tE(n)){var x=Object.keys(n)[0],y=n[x];a=p[x].getPixelForValue(y)+g-t}else a="center"===n?(f.bottom+f.top)/2+g-t:iN(e,n,t);i=c-l}else{if(tE(n)){var b=Object.keys(n)[0],w=n[b];o=p[b].getPixelForValue(w)-m+t}else o="center"===n?(f.left+f.right)/2-m+t:iN(e,n,t);a=nm(r,u,s),h="left"===n?-tZ:tZ}return{titleX:o,titleY:a,maxWidth:i,rotation:h}}(this,c,n,u),f=d.titleX,p=d.titleY,h=d.maxWidth,g=d.rotation;nW(e,r.text,0,0,s,{color:r.color,maxWidth:h,rotation:g,textAlign:(o=ng(u),(i&&"right"!==n||!i&&"right"===n)&&(o="left"===(a=o)?"right":"right"===a?"left":a),o),textBaseline:"middle",translation:[f,p]})}}},{key:"draw",value:function(e){this._isVisible()&&(this.drawBackground(),this.drawGrid(e),this.drawBorder(),this.drawTitle(),this.drawLabels(e))}},{key:"_layers",value:function(){var e=this,n=this.options,r=n.ticks&&n.ticks.z||0,i=tA(n.grid&&n.grid.z,-1),o=tA(n.border&&n.border.z,0);return this._isVisible()&&this.draw===t.prototype.draw?[{z:i,draw:function(t){e.drawBackground(),e.drawGrid(t),e.drawTitle()}},{z:o,draw:function(){e.drawBorder()}},{z:r,draw:function(t){e.drawLabels(t)}}]:[{z:r,draw:function(t){e.draw(t)}}]}},{key:"getMatchingVisibleMetas",value:function(e){var t,n,r=this.chart.getSortedVisibleDatasetMetas(),i=this.axis+"AxisID",o=[];for(t=0,n=r.length;t<n;++t){var a=r[t];a[i]!==this.id||e&&a.type!==e||o.push(a)}return o}},{key:"_resolveTickFontOptions",value:function(e){return n0(this.options.ticks.setContext(this.getContext(e)).font)}},{key:"_maxDigits",value:function(){var e=this._resolveTickFontOptions(0).lineHeight;return(this.isHorizontal()?this.width:this.height)/e}}]),t}((0,e5._)(iD)),iU=function(){function e(t,n,r){(0,eX._)(this,e),this.type=t,this.scope=n,this.override=r,this.items=Object.create(null)}return(0,eJ._)(e,[{key:"isForType",value:function(e){return Object.prototype.isPrototypeOf.call(this.type.prototype,e.prototype)}},{key:"register",value:function(e){var t,n,r,i,o,a,s,l,u=Object.getPrototypeOf(e);"id"in(t=u)&&"defaults"in t&&(l=this.register(u));var c=this.items,d=e.id,f=this.scope+"."+d;if(!d)throw Error("class does not have id: "+e);return d in c||(c[d]=e,n=e,r=f,i=l,o=tV(Object.create(null),[i?nN.get(i):{},nN.get(r),n.defaults]),nN.set(r,o),n.defaultRoutes&&(a=r,Object.keys(s=n.defaultRoutes).forEach(function(e){var t=e.split("."),n=t.pop(),r=[a].concat(t).join("."),i=s[e].split("."),o=i.pop(),l=i.join(".");nN.route(r,n,l,o)})),n.descriptors&&nN.describe(r,n.descriptors),this.override&&nN.override(e.id,e.overrides)),f}},{key:"get",value:function(e){return this.items[e]}},{key:"unregister",value:function(e){var t=this.items,n=e.id,r=this.scope;n in t&&delete t[n],r&&n in nN[r]&&(delete nN[r][n],this.override&&delete nA[n])}}]),e}(),iG=new(function(){function e(){(0,eX._)(this,e),this.controllers=new iU(rH,"datasets",!0),this.elements=new iU(iD,"elements"),this.plugins=new iU(Object,"plugins"),this.scales=new iU(iF,"scales"),this._typedRegistries=[this.controllers,this.scales,this.elements]}return(0,eJ._)(e,[{key:"add",value:function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];this._each("register",t)}},{key:"remove",value:function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];this._each("unregister",t)}},{key:"addControllers",value:function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];this._each("register",t,this.controllers)}},{key:"addElements",value:function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];this._each("register",t,this.elements)}},{key:"addPlugins",value:function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];this._each("register",t,this.plugins)}},{key:"addScales",value:function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];this._each("register",t,this.scales)}},{key:"getController",value:function(e){return this._get(e,this.controllers,"controller")}},{key:"getElement",value:function(e){return this._get(e,this.elements,"element")}},{key:"getPlugin",value:function(e){return this._get(e,this.plugins,"plugin")}},{key:"getScale",value:function(e){return this._get(e,this.scales,"scale")}},{key:"removeControllers",value:function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];this._each("unregister",t,this.controllers)}},{key:"removeElements",value:function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];this._each("unregister",t,this.elements)}},{key:"removePlugins",value:function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];this._each("unregister",t,this.plugins)}},{key:"removeScales",value:function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];this._each("unregister",t,this.scales)}},{key:"_each",value:function(e,t,n){var r=this;(0,e4._)(t).forEach(function(t){var i=n||r._getRegistryForType(t);n||i.isForType(t)||i===r.plugins&&t.id?r._exec(e,i,t):tO(t,function(t){var i=n||r._getRegistryForType(t);r._exec(e,i,t)})})}},{key:"_exec",value:function(e,t,n){var r=tz(e);tD(n["before"+r],[],n),t[e](n),tD(n["after"+r],[],n)}},{key:"_getRegistryForType",value:function(e){for(var t=0;t<this._typedRegistries.length;t++){var n=this._typedRegistries[t];if(n.isForType(e))return n}return this.plugins}},{key:"_get",value:function(e,t,n){var r=t.get(e);if(void 0===r)throw Error('"'+e+'" is not a registered '+n+".");return r}}]),e}()),i$=function(){function e(){(0,eX._)(this,e),this._init=[]}return(0,eJ._)(e,[{key:"notify",value:function(e,t,n,r){"beforeInit"===t&&(this._init=this._createDescriptors(e,!0),this._notify(this._init,e,"install"));var i=r?this._descriptors(e).filter(r):this._descriptors(e),o=this._notify(i,e,t,n);return"afterDestroy"===t&&(this._notify(i,e,"stop"),this._notify(this._init,e,"uninstall")),o}},{key:"_notify",value:function(e,t,n,r){r=r||{};var i=!0,o=!1,a=void 0;try{for(var s,l=e[Symbol.iterator]();!(i=(s=l.next()).done);i=!0){var u=s.value,c=u.plugin,d=c[n],f=[t,r,u.options];if(!1===tD(d,f,c)&&r.cancelable)return!1}}catch(e){o=!0,a=e}finally{try{i||null==l.return||l.return()}finally{if(o)throw a}}return!0}},{key:"invalidate",value:function(){tj(this._cache)||(this._oldCache=this._cache,this._cache=void 0)}},{key:"_descriptors",value:function(e){if(this._cache)return this._cache;var t=this._cache=this._createDescriptors(e);return this._notifyStateChanges(e),t}},{key:"_createDescriptors",value:function(e,t){var n=e&&e.config,r=tA(n.options&&n.options.plugins,{}),i=function(e){for(var t={},n=[],r=Object.keys(iG.plugins.items),i=0;i<r.length;i++)n.push(iG.getPlugin(r[i]));for(var o=e.plugins||[],a=0;a<o.length;a++){var s=o[a];-1===n.indexOf(s)&&(n.push(s),t[s.id]=!0)}return{plugins:n,localIds:t}}(n);return!1!==r||t?function(e,t,n,r){var i=t.plugins,o=t.localIds,a=[],s=e.getContext(),l=!0,u=!1,c=void 0;try{for(var d,f=i[Symbol.iterator]();!(l=(d=f.next()).done);l=!0){var p,h=d.value,g=h.id,m=(p=n[g],r||!1!==p?!0===p?{}:p:null);null!==m&&a.push({plugin:h,options:function(e,t,n,r){var i=t.plugin,o=t.local,a=e.pluginScopeKeys(i),s=e.getOptionScopes(n,a);return o&&i.defaults&&s.push(i.defaults),e.createResolver(s,r,[""],{scriptable:!1,indexable:!1,allKeys:!0})}(e.config,{plugin:h,local:o[g]},m,s)})}}catch(e){u=!0,c=e}finally{try{l||null==f.return||f.return()}finally{if(u)throw c}}return a}(e,i,r,t):[]}},{key:"_notifyStateChanges",value:function(e){var t=this._oldCache||[],n=this._cache,r=function(e,t){return e.filter(function(e){return!t.some(function(t){return e.plugin.id===t.plugin.id})})};this._notify(r(t,n),e,"stop"),this._notify(r(n,t),e,"start")}}]),e}();function iz(e,t){var n=nN.datasets[e]||{};return((t.datasets||{})[e]||{}).indexAxis||t.indexAxis||n.indexAxis||"x"}function iH(e){if("x"===e||"y"===e||"r"===e)return e}function iW(e){for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];if(iH(e))return e;var i=!0,o=!1,a=void 0;try{for(var s,l=n[Symbol.iterator]();!(i=(s=l.next()).done);i=!0){var u,c=s.value,d=c.axis||(u=c.position,"top"===u||"bottom"===u?"x":"left"===u||"right"===u?"y":void 0)||e.length>1&&iH(e[0].toLowerCase());if(d)return d}}catch(e){o=!0,a=e}finally{try{i||null==l.return||l.return()}finally{if(o)throw a}}throw Error("Cannot determine type of '".concat(e,"' axis. Please provide 'axis' or 'position' option."))}function iq(e,t,n){if(n[t+"AxisID"]===e)return{axis:t}}function iK(e){var t,n,r,i,o=e.options||(e.options={});o.plugins=tA(o.plugins,{}),t=nA[e.type]||{scales:{}},n=o.scales||{},r=iz(e.type,o),i=Object.create(null),Object.keys(n).forEach(function(o){var a=n[o];if(!tE(a))return console.error("Invalid scale configuration for scale: ".concat(o));if(a._proxy)return console.warn("Ignoring resolver passed as options for scale: ".concat(o));var s=iW(o,a,function(e,t){if(t.data&&t.data.datasets){var n=t.data.datasets.filter(function(t){return t.xAxisID===e||t.yAxisID===e});if(n.length)return iq(e,"x",n[0])||iq(e,"y",n[0])}return{}}(o,e),nN.scales[a.type]),l=s===r?"_index_":"_value_",u=t.scales||{};i[o]=tF(Object.create(null),[{axis:s},a,u[s],u[l]])}),e.data.datasets.forEach(function(t){var r=t.type||e.type,a=t.indexAxis||iz(r,o),s=(nA[r]||{}).scales||{};Object.keys(s).forEach(function(e){var r,o=(r=e,"_index_"===e?r=a:"_value_"===e&&(r="x"===a?"y":"x"),r),l=t[o+"AxisID"]||o;i[l]=i[l]||Object.create(null),tF(i[l],[{axis:o},n[l],s[e]])})}),Object.keys(i).forEach(function(e){var t=i[e];tF(t,[nN.scales[t.type],nN.scale])}),o.scales=i}function iY(e){return(e=e||{}).datasets=e.datasets||[],e.labels=e.labels||[],e}var iQ=new Map,iX=new Set;function iJ(e,t){var n=iQ.get(e);return n||(n=t(),iQ.set(e,n),iX.add(n)),n}var iZ=function(e,t,n){var r=t$(t,n);void 0!==r&&e.add(r)},i0=function(){function e(t){var n;(0,eX._)(this,e),this._config=((n=(n=t)||{}).data=iY(n.data),iK(n),n),this._scopeCache=new Map,this._resolverCache=new Map}return(0,eJ._)(e,[{key:"platform",get:function(){return this._config.platform}},{key:"type",get:function(){return this._config.type},set:function(e){this._config.type=e}},{key:"data",get:function(){return this._config.data},set:function(e){this._config.data=iY(e)}},{key:"options",get:function(){return this._config.options},set:function(e){this._config.options=e}},{key:"plugins",get:function(){return this._config.plugins}},{key:"update",value:function(){var e=this._config;this.clearCache(),iK(e)}},{key:"clearCache",value:function(){this._scopeCache.clear(),this._resolverCache.clear()}},{key:"datasetScopeKeys",value:function(e){return iJ(e,function(){return[["datasets.".concat(e),""]]})}},{key:"datasetAnimationScopeKeys",value:function(e,t){return iJ("".concat(e,".transition.").concat(t),function(){return[["datasets.".concat(e,".transitions.").concat(t),"transitions.".concat(t)],["datasets.".concat(e),""]]})}},{key:"datasetElementScopeKeys",value:function(e,t){return iJ("".concat(e,"-").concat(t),function(){return[["datasets.".concat(e,".elements.").concat(t),"datasets.".concat(e),"elements.".concat(t),""]]})}},{key:"pluginScopeKeys",value:function(e){var t=e.id,n=this.type;return iJ("".concat(n,"-plugin-").concat(t),function(){return[["plugins.".concat(t)].concat((0,e4._)(e.additionalOptionScopes||[]))]})}},{key:"_cachedScopes",value:function(e,t){var n=this._scopeCache,r=n.get(e);return(!r||t)&&(r=new Map,n.set(e,r)),r}},{key:"getOptionScopes",value:function(e,t,n){var r=this.options,i=this.type,o=this._cachedScopes(e,n),a=o.get(t);if(a)return a;var s=new Set;t.forEach(function(t){e&&(s.add(e),t.forEach(function(t){return iZ(s,e,t)})),t.forEach(function(e){return iZ(s,r,e)}),t.forEach(function(e){return iZ(s,nA[i]||{},e)}),t.forEach(function(e){return iZ(s,nN,e)}),t.forEach(function(e){return iZ(s,nP,e)})});var l=Array.from(s);return 0===l.length&&l.push(Object.create(null)),iX.has(t)&&o.set(t,l),l}},{key:"chartOptionScopes",value:function(){var e=this.options,t=this.type;return[e,nA[t]||{},nN.datasets[t]||{},{type:t},nN,nP]}},{key:"resolveNamedOptions",value:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[""],i={$shared:!0},o=i1(this._resolverCache,e,r),a=o.resolver,s=o.subPrefixes,l=a;if(function(e,t){var n=n8(e),r=n.isScriptable,i=n.isIndexable,o=!0,a=!1,s=void 0;try{for(var l,u=t[Symbol.iterator]();!(o=(l=u.next()).done);o=!0){var c=l.value,d=r(c),f=i(c),p=(f||d)&&e[c];if(d&&(tW(p)||i2(p))||f&&tT(p))return!0}}catch(e){a=!0,s=e}finally{try{o||null==u.return||u.return()}finally{if(a)throw s}}return!1}(a,t)){i.$shared=!1,n=tW(n)?n():n;var u=this.createResolver(e,n,s);l=n4(a,n,u)}var c=!0,d=!1,f=void 0;try{for(var p,h=t[Symbol.iterator]();!(c=(p=h.next()).done);c=!0){var g=p.value;i[g]=l[g]}}catch(e){d=!0,f=e}finally{try{c||null==h.return||h.return()}finally{if(d)throw f}}return i}},{key:"createResolver",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[""],r=arguments.length>3?arguments[3]:void 0,i=i1(this._resolverCache,e,n).resolver;return tE(t)?n4(i,t,void 0,r):i}}]),e}();function i1(e,t,n){var r=e.get(t);r||(r=new Map,e.set(t,r));var i=n.join(),o=r.get(i);return o||(o={resolver:n3(t,n),subPrefixes:n.filter(function(e){return!e.toLowerCase().includes("hover")})},r.set(i,o)),o}var i2=function(e){return tE(e)&&Object.getOwnPropertyNames(e).reduce(function(t,n){return t||tW(e[n])},!1)},i3=["top","bottom","left","right","chartArea"];function i4(e,t){return"top"===e||"bottom"===e||-1===i3.indexOf(e)&&"x"===t}function i8(e,t){return function(n,r){return n[e]===r[e]?n[t]-r[t]:n[e]-r[e]}}function i5(e){var t=e.chart,n=t.options.animation;t.notifyPlugins("afterRender"),tD(n&&n.onComplete,[e],t)}function i6(e){var t=e.chart,n=t.options.animation;tD(n&&n.onProgress,[e],t)}function i9(e){return rs()&&"string"==typeof e?e=document.getElementById(e):e&&e.length&&(e=e[0]),e&&e.canvas&&(e=e.canvas),e}var i7={},oe=function(e){var t=i9(e);return Object.values(i7).filter(function(e){return e.canvas===t}).pop()};function ot(e,t,n){return e.options.clip?e[n]:t[n]}var on=function(){function e(t,n){var r,i,o,a=this;(0,eX._)(this,e);var s=this.config=new i0(n),l=i9(t),u=oe(l);if(u)throw Error("Canvas is already in use. Chart with ID '"+u.id+"' must be destroyed before the canvas with ID '"+u.canvas.id+"' can be reused.");var c=s.createResolver(s.chartOptionScopes(),this.getContext());this.platform=new(s.platform||(!rs()||"undefined"!=typeof OffscreenCanvas&&(0,e3._)(l,OffscreenCanvas)?ix:iP)),this.platform.updateConfig(s);var d=this.platform.acquireContext(l,c.aspectRatio),f=d&&d.canvas,p=f&&f.height,h=f&&f.width;(this.id=tC(),this.ctx=d,this.canvas=f,this.width=h,this.height=p,this._options=c,this._aspectRatio=this.aspectRatio,this._layers=[],this._metasets=[],this._stacks=void 0,this.boxes=[],this.currentDevicePixelRatio=void 0,this.chartArea=void 0,this._active=[],this._lastEvent=void 0,this._listeners={},this._responsiveListeners=void 0,this._sortedMetasets=[],this.scales={},this._plugins=new i$,this.$proxies={},this._hiddenIndices={},this.attached=!1,this._animationsDisabled=void 0,this.$context=void 0,this._doResize=(r=function(e){return a.update(e)},i=c.resizeDelay||0,function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return i?(clearTimeout(o),o=setTimeout(r,i,t)):r.apply(this,t),i}),this._dataChanges=[],i7[this.id]=this,d&&f)?(rI.listen(this,"complete",i5),rI.listen(this,"progress",i6),this._initialize(),this.attached&&this.update()):console.error("Failed to create chart: can't acquire context from the given item")}return(0,eJ._)(e,[{key:"aspectRatio",get:function(){var e=this.options,t=e.aspectRatio,n=e.maintainAspectRatio,r=this.width,i=this.height,o=this._aspectRatio;return tj(t)?n&&o?o:i?r/i:null:t}},{key:"data",get:function(){return this.config.data},set:function(e){this.config.data=e}},{key:"options",get:function(){return this._options},set:function(e){this.config.options=e}},{key:"registry",get:function(){return iG}},{key:"_initialize",value:function(){return this.notifyPlugins("beforeInit"),this.options.responsive?this.resize():rg(this,this.options.devicePixelRatio),this.bindEvents(),this.notifyPlugins("afterInit"),this}},{key:"clear",value:function(){return nB(this.canvas,this.ctx),this}},{key:"stop",value:function(){return rI.stop(this),this}},{key:"resize",value:function(e,t){rI.running(this)?this._resizeBeforeDraw={width:e,height:t}:this._resize(e,t)}},{key:"_resize",value:function(e,t){var n=this.options,r=this.canvas,i=n.maintainAspectRatio&&this.aspectRatio,o=this.platform.getMaximumSize(r,e,t,i),a=n.devicePixelRatio||this.platform.getDevicePixelRatio(),s=this.width?"resize":"attach";this.width=o.width,this.height=o.height,this._aspectRatio=this.aspectRatio,rg(this,a,!0)&&(this.notifyPlugins("resize",{size:o}),tD(n.onResize,[this,o],this),this.attached&&this._doResize(s)&&this.render())}},{key:"ensureScalesHaveIDs",value:function(){tO(this.options.scales||{},function(e,t){e.id=t})}},{key:"buildOrUpdateScales",value:function(){var e=this,t=this.options,n=t.scales,r=this.scales,i=Object.keys(r).reduce(function(e,t){return e[t]=!1,e},{}),o=[];n&&(o=o.concat(Object.keys(n).map(function(e){var t=n[e],r=iW(e,t),i="r"===r,o="x"===r;return{options:t,dposition:i?"chartArea":o?"bottom":"left",dtype:i?"radialLinear":o?"category":"linear"}}))),tO(o,function(n){var o=n.options,a=o.id,s=iW(a,o),l=tA(o.type,n.dtype);(void 0===o.position||i4(o.position,s)!==i4(n.dposition))&&(o.position=n.dposition),i[a]=!0;var u=null;a in r&&r[a].type===l?u=r[a]:r[(u=new(iG.getScale(l))({id:a,type:l,ctx:e.ctx,chart:e})).id]=u,u.init(o,t)}),tO(i,function(e,t){e||delete r[t]}),tO(r,function(t){ig(e,t,t.options),ip(e,t)})}},{key:"_updateMetasets",value:function(){var e=this._metasets,t=this.data.datasets.length,n=e.length;if(e.sort(function(e,t){return e.index-t.index}),n>t){for(var r=t;r<n;++r)this._destroyDatasetMeta(r);e.splice(t,n-t)}this._sortedMetasets=e.slice(0).sort(i8("order","index"))}},{key:"_removeUnreferencedMetasets",value:function(){var e=this,t=this._metasets,n=this.data.datasets;t.length>n.length&&delete this._stacks,t.forEach(function(t,r){0===n.filter(function(e){return e===t._dataset}).length&&e._destroyDatasetMeta(r)})}},{key:"buildOrUpdateControllers",value:function(){var e,t,n=[],r=this.data.datasets;for(this._removeUnreferencedMetasets(),e=0,t=r.length;e<t;e++){var i=r[e],o=this.getDatasetMeta(e),a=i.type||this.config.type;if(o.type&&o.type!==a&&(this._destroyDatasetMeta(e),o=this.getDatasetMeta(e)),o.type=a,o.indexAxis=i.indexAxis||iz(a,this.options),o.order=i.order||0,o.index=e,o.label=""+i.label,o.visible=this.isDatasetVisible(e),o.controller)o.controller.updateIndex(e),o.controller.linkScales();else{var s=iG.getController(a),l=nN.datasets[a],u=l.datasetElementType,c=l.dataElementType;Object.assign(s,{dataElementType:iG.getElement(c),datasetElementType:u&&iG.getElement(u)}),o.controller=new s(this,e),n.push(o.controller)}}return this._updateMetasets(),n}},{key:"_resetElements",value:function(){var e=this;tO(this.data.datasets,function(t,n){e.getDatasetMeta(n).controller.reset()},this)}},{key:"reset",value:function(){this._resetElements(),this.notifyPlugins("reset")}},{key:"update",value:function(e){var t=this.config;t.update();var n=this._options=t.createResolver(t.chartOptionScopes(),this.getContext()),r=this._animationsDisabled=!n.animation;if(this._updateScales(),this._checkEventBindings(),this._updateHiddenIndices(),this._plugins.invalidate(),!1!==this.notifyPlugins("beforeUpdate",{mode:e,cancelable:!0})){var i=this.buildOrUpdateControllers();this.notifyPlugins("beforeElementsUpdate");for(var o=0,a=0,s=this.data.datasets.length;a<s;a++){var l=this.getDatasetMeta(a).controller,u=!r&&-1===i.indexOf(l);l.buildOrUpdateElements(u),o=Math.max(+l.getMaxOverflow(),o)}o=this._minPadding=n.layout.autoPadding?o:0,this._updateLayout(o),r||tO(i,function(e){e.reset()}),this._updateDatasets(e),this.notifyPlugins("afterUpdate",{mode:e}),this._layers.sort(i8("z","_idx"));var c=this._active,d=this._lastEvent;d?this._eventHandler(d,!0):c.length&&this._updateHoverStyles(c,c,!0),this.render()}}},{key:"_updateScales",value:function(){var e=this;tO(this.scales,function(t){ih(e,t)}),this.ensureScalesHaveIDs(),this.buildOrUpdateScales()}},{key:"_checkEventBindings",value:function(){var e=this.options;tq(new Set(Object.keys(this._listeners)),new Set(e.events))&&!!this._responsiveListeners===e.responsive||(this.unbindEvents(),this.bindEvents())}},{key:"_updateHiddenIndices",value:function(){var e=this._hiddenIndices,t=this._getUniformDataChanges()||[],n=!0,r=!1,i=void 0;try{for(var o,a=t[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var s=o.value,l=s.method,u=s.start,c=s.count,d="_removeElements"===l?-c:c;!function(e,t,n){var r=Object.keys(e),i=!0,o=!1,a=void 0;try{for(var s,l=r[Symbol.iterator]();!(i=(s=l.next()).done);i=!0){var u=s.value,c=+u;if(c>=t){var d=e[u];delete e[u],(n>0||c>t)&&(e[c+n]=d)}}}catch(e){o=!0,a=e}finally{try{i||null==l.return||l.return()}finally{if(o)throw a}}}(e,u,d)}}catch(e){r=!0,i=e}finally{try{n||null==a.return||a.return()}finally{if(r)throw i}}}},{key:"_getUniformDataChanges",value:function(){var e=this._dataChanges;if(e&&e.length){this._dataChanges=[];for(var t=this.data.datasets.length,n=function(t){return new Set(e.filter(function(e){return e[0]===t}).map(function(e,t){return t+","+e.splice(1).join(",")}))},r=n(0),i=1;i<t;i++)if(!tq(r,n(i)))return;return Array.from(r).map(function(e){return e.split(",")}).map(function(e){return{method:e[1],start:+e[2],count:+e[3]}})}}},{key:"_updateLayout",value:function(e){var t=this;if(!1!==this.notifyPlugins("beforeLayout",{cancelable:!0})){im(this,this.width,this.height,e);var n=this.chartArea,r=n.width<=0||n.height<=0;this._layers=[],tO(this.boxes,function(e){var n;r&&"chartArea"===e.position||(e.configure&&e.configure(),(n=t._layers).push.apply(n,(0,e4._)(e._layers())))},this),this._layers.forEach(function(e,t){e._idx=t}),this.notifyPlugins("afterLayout")}}},{key:"_updateDatasets",value:function(e){if(!1!==this.notifyPlugins("beforeDatasetsUpdate",{mode:e,cancelable:!0})){for(var t=0,n=this.data.datasets.length;t<n;++t)this.getDatasetMeta(t).controller.configure();for(var r=0,i=this.data.datasets.length;r<i;++r)this._updateDataset(r,tW(e)?e({datasetIndex:r}):e);this.notifyPlugins("afterDatasetsUpdate",{mode:e})}}},{key:"_updateDataset",value:function(e,t){var n=this.getDatasetMeta(e),r={meta:n,index:e,mode:t,cancelable:!0};!1!==this.notifyPlugins("beforeDatasetUpdate",r)&&(n.controller._update(t),r.cancelable=!1,this.notifyPlugins("afterDatasetUpdate",r))}},{key:"render",value:function(){!1!==this.notifyPlugins("beforeRender",{cancelable:!0})&&(rI.has(this)?this.attached&&!rI.running(this)&&rI.start(this):(this.draw(),i5({chart:this})))}},{key:"draw",value:function(){if(this._resizeBeforeDraw){var e,t=this._resizeBeforeDraw,n=t.width,r=t.height;this._resize(n,r),this._resizeBeforeDraw=null}if((this.clear(),!(this.width<=0)&&!(this.height<=0))&&!1!==this.notifyPlugins("beforeDraw",{cancelable:!0})){var i=this._layers;for(e=0;e<i.length&&i[e].z<=0;++e)i[e].draw(this.chartArea);for(this._drawDatasets();e<i.length;++e)i[e].draw(this.chartArea);this.notifyPlugins("afterDraw")}}},{key:"_getSortedDatasetMetas",value:function(e){var t,n,r=this._sortedMetasets,i=[];for(t=0,n=r.length;t<n;++t){var o=r[t];(!e||o.visible)&&i.push(o)}return i}},{key:"getSortedVisibleDatasetMetas",value:function(){return this._getSortedDatasetMetas(!0)}},{key:"_drawDatasets",value:function(){if(!1!==this.notifyPlugins("beforeDatasetsDraw",{cancelable:!0})){for(var e=this.getSortedVisibleDatasetMetas(),t=e.length-1;t>=0;--t)this._drawDataset(e[t]);this.notifyPlugins("afterDatasetsDraw")}}},{key:"_drawDataset",value:function(e){var t,n,r,i=this.ctx,o=e._clip,a=!o.disabled,s=(t=this.chartArea,n=e.xScale,r=e.yScale,n&&r?{left:ot(n,t,"left"),right:ot(n,t,"right"),top:ot(r,t,"top"),bottom:ot(r,t,"bottom")}:t),l={meta:e,index:e.index,cancelable:!0};!1!==this.notifyPlugins("beforeDatasetDraw",l)&&(a&&nG(i,{left:!1===o.left?0:s.left-o.left,right:!1===o.right?this.width:s.right+o.right,top:!1===o.top?0:s.top-o.top,bottom:!1===o.bottom?this.height:s.bottom+o.bottom}),e.controller.draw(),a&&n$(i),l.cancelable=!1,this.notifyPlugins("afterDatasetDraw",l))}},{key:"isPointInArea",value:function(e){return nU(e,this.chartArea,this._minPadding)}},{key:"getElementsAtEventForMode",value:function(e,t,n,r){var i=it[t];return"function"==typeof i?i(this,e,n,r):[]}},{key:"getDatasetMeta",value:function(e){var t=this.data.datasets[e],n=this._metasets,r=n.filter(function(e){return e&&e._dataset===t}).pop();return r||(r={type:null,data:[],dataset:null,controller:null,hidden:null,xAxisID:null,yAxisID:null,order:t&&t.order||0,index:e,_dataset:t,_parsed:[],_sorted:!1},n.push(r)),r}},{key:"getContext",value:function(){return this.$context||(this.$context=n2(null,{chart:this,type:"chart"}))}},{key:"getVisibleDatasetCount",value:function(){return this.getSortedVisibleDatasetMetas().length}},{key:"isDatasetVisible",value:function(e){var t=this.data.datasets[e];if(!t)return!1;var n=this.getDatasetMeta(e);return"boolean"==typeof n.hidden?!n.hidden:!t.hidden}},{key:"setDatasetVisibility",value:function(e,t){this.getDatasetMeta(e).hidden=!t}},{key:"toggleDataVisibility",value:function(e){this._hiddenIndices[e]=!this._hiddenIndices[e]}},{key:"getDataVisibility",value:function(e){return!this._hiddenIndices[e]}},{key:"_updateVisibility",value:function(e,t,n){var r=n?"show":"hide",i=this.getDatasetMeta(e),o=i.controller._resolveAnimations(void 0,r);tH(t)?(i.data[t].hidden=!n,this.update()):(this.setDatasetVisibility(e,n),o.update(i,{visible:n}),this.update(function(t){return t.datasetIndex===e?r:void 0}))}},{key:"hide",value:function(e,t){this._updateVisibility(e,t,!1)}},{key:"show",value:function(e,t){this._updateVisibility(e,t,!0)}},{key:"_destroyDatasetMeta",value:function(e){var t=this._metasets[e];t&&t.controller&&t.controller._destroy(),delete this._metasets[e]}},{key:"_stop",value:function(){var e,t;for(this.stop(),rI.remove(this),e=0,t=this.data.datasets.length;e<t;++e)this._destroyDatasetMeta(e)}},{key:"destroy",value:function(){this.notifyPlugins("beforeDestroy");var e=this.canvas,t=this.ctx;this._stop(),this.config.clearCache(),e&&(this.unbindEvents(),nB(e,t),this.platform.releaseContext(t),this.canvas=null,this.ctx=null),delete i7[this.id],this.notifyPlugins("afterDestroy")}},{key:"toBase64Image",value:function(){for(var e,t=arguments.length,n=Array(t),r=0;r<t;r++)n[r]=arguments[r];return(e=this.canvas).toDataURL.apply(e,(0,e4._)(n))}},{key:"bindEvents",value:function(){this.bindUserEvents(),this.options.responsive?this.bindResponsiveEvents():this.attached=!0}},{key:"bindUserEvents",value:function(){var e=this,t=this._listeners,n=this.platform,r=function(r,i){n.addEventListener(e,r,i),t[r]=i},i=function(t,n,r){t.offsetX=n,t.offsetY=r,e._eventHandler(t)};tO(this.options.events,function(e){return r(e,i)})}},{key:"bindResponsiveEvents",value:function(){var e,t=this;this._responsiveListeners||(this._responsiveListeners={});var n=this._responsiveListeners,r=this.platform,i=function(e,i){r.addEventListener(t,e,i),n[e]=i},o=function(e,i){n[e]&&(r.removeEventListener(t,e,i),delete n[e])},a=function(e,n){t.canvas&&t.resize(e,n)},s=function(){o("attach",s),t.attached=!0,t.resize(),i("resize",a),i("detach",e)};e=function(){t.attached=!1,o("resize",a),t._stop(),t._resize(0,0),i("attach",s)},r.isAttached(this.canvas)?s():e()}},{key:"unbindEvents",value:function(){var e=this;tO(this._listeners,function(t,n){e.platform.removeEventListener(e,n,t)}),this._listeners={},tO(this._responsiveListeners,function(t,n){e.platform.removeEventListener(e,n,t)}),this._responsiveListeners=void 0}},{key:"updateHoverStyle",value:function(e,t,n){var r,i,o,a=n?"set":"remove";for("dataset"===t&&this.getDatasetMeta(e[0].datasetIndex).controller["_"+a+"DatasetHoverStyle"](),i=0,o=e.length;i<o;++i){var s=(r=e[i])&&this.getDatasetMeta(r.datasetIndex).controller;s&&s[a+"HoverStyle"](r.element,r.datasetIndex,r.index)}}},{key:"getActiveElements",value:function(){return this._active||[]}},{key:"setActiveElements",value:function(e){var t=this,n=this._active||[],r=e.map(function(e){var n=e.datasetIndex,r=e.index,i=t.getDatasetMeta(n);if(!i)throw Error("No dataset found at index "+n);return{datasetIndex:n,element:i.data[r],index:r}});tN(r,n)||(this._active=r,this._lastEvent=null,this._updateHoverStyles(r,n))}},{key:"notifyPlugins",value:function(e,t,n){return this._plugins.notify(this,e,t,n)}},{key:"isPluginEnabled",value:function(e){return 1===this._plugins._cache.filter(function(t){return t.plugin.id===e}).length}},{key:"_updateHoverStyles",value:function(e,t,n){var r=this.options.hover,i=function(e,t){return e.filter(function(e){return!t.some(function(t){return e.datasetIndex===t.datasetIndex&&e.index===t.index})})},o=i(t,e),a=n?e:i(e,t);o.length&&this.updateHoverStyle(o,r.mode,!1),a.length&&r.mode&&this.updateHoverStyle(a,r.mode,!0)}},{key:"_eventHandler",value:function(e,t){var n=this,r={event:e,replay:t,cancelable:!0,inChartArea:this.isPointInArea(e)},i=function(t){return(t.options.events||n.options.events).includes(e.native.type)};if(!1!==this.notifyPlugins("beforeEvent",r,i)){var o=this._handleEvent(e,t,r.inChartArea);return r.cancelable=!1,this.notifyPlugins("afterEvent",r,i),(o||r.changed)&&this.render(),this}}},{key:"_handleEvent",value:function(e,t,n){var r,i=this._active,o=void 0===i?[]:i,a=this.options,s=this._getActiveElements(e,o,n,t),l="mouseup"===e.type||"click"===e.type||"contextmenu"===e.type,u=(r=this._lastEvent,n&&"mouseout"!==e.type?l?r:e:null);n&&(this._lastEvent=null,tD(a.onHover,[e,s,this],this),l&&tD(a.onClick,[e,s,this],this));var c=!tN(s,o);return(c||t)&&(this._active=s,this._updateHoverStyles(s,o,t)),this._lastEvent=u,c}},{key:"_getActiveElements",value:function(e,t,n,r){if("mouseout"===e.type)return[];if(!n)return t;var i=this.options.hover;return this.getElementsAtEventForMode(e,i.mode,i,r)}}],[{key:"register",value:function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];iG.add.apply(iG,(0,e4._)(t)),or()}},{key:"unregister",value:function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];iG.remove.apply(iG,(0,e4._)(t)),or()}}]),e}();function or(){return tO(on.instances,function(e){return e._plugins.invalidate()})}function oi(e,t,n,r){return{x:n+e*Math.cos(t),y:r+e*Math.sin(t)}}function oo(e,t,n,r,i,o){var a,s,l,u,c,d,f,p,h=t.x,g=t.y,m=t.startAngle,x=t.pixelMargin,y=t.innerRadius,b=Math.max(t.outerRadius+r+n-x,0),w=y>0?y+r+n+x:0,k=0,_=i-m;if(r){var S=b>0?b-r:0,C=((y>0?y-r:0)+S)/2;k=(_-(0!==C?_*C/(C+r):_))/2}var j=Math.max(.001,_*b-n/tK)/b,T=(_-j)/2,E=m+T+k,R=i-T-k,I=(a=t,s=w,l=b,u=R-E,c=nQ(a.options.borderRadius,["outerStart","outerEnd","innerStart","innerEnd"]),f=Math.min(d=(l-s)/2,u*s/2),{outerStart:(p=function(e){var t=(l-Math.min(d,e))*u/2;return no(e,0,Math.min(d,t))})(c.outerStart),outerEnd:p(c.outerEnd),innerStart:no(c.innerStart,0,f),innerEnd:no(c.innerEnd,0,f)}),A=I.outerStart,P=I.outerEnd,D=I.innerStart,O=I.innerEnd,N=b-A,M=b-P,L=E+A/N,B=R-P/M,V=w+D,F=w+O,U=E+D/V,G=R-O/F;if(e.beginPath(),o){var $=(L+B)/2;if(e.arc(h,g,b,L,$),e.arc(h,g,b,$,B),P>0){var z=oi(M,B,h,g);e.arc(z.x,z.y,P,B,R+tZ)}var H=oi(F,R,h,g);if(e.lineTo(H.x,H.y),O>0){var W=oi(F,G,h,g);e.arc(W.x,W.y,O,R+tZ,G+Math.PI)}var q=(R-O/w+(E+D/w))/2;if(e.arc(h,g,w,R-O/w,q,!0),e.arc(h,g,w,q,E+D/w,!0),D>0){var K=oi(V,U,h,g);e.arc(K.x,K.y,D,U+Math.PI,E-tZ)}var Y=oi(N,E,h,g);if(e.lineTo(Y.x,Y.y),A>0){var Q=oi(N,L,h,g);e.arc(Q.x,Q.y,A,E-tZ,L)}}else{e.moveTo(h,g);var X=Math.cos(L)*b+h,J=Math.sin(L)*b+g;e.lineTo(X,J);var Z=Math.cos(B)*b+h,ee=Math.sin(B)*b+g;e.lineTo(Z,ee)}e.closePath()}(0,eZ._)(on,"defaults",nN),(0,eZ._)(on,"instances",i7),(0,eZ._)(on,"overrides",nA),(0,eZ._)(on,"registry",iG),(0,eZ._)(on,"version","4.4.0"),(0,eZ._)(on,"getChart",oe);var oa=function(e){function t(e){var n;return(0,eX._)(this,t),n=(0,eQ._)(this,t),(0,eZ._)(n,"circumference",void 0),(0,eZ._)(n,"endAngle",void 0),(0,eZ._)(n,"fullCircles",void 0),(0,eZ._)(n,"innerRadius",void 0),(0,eZ._)(n,"outerRadius",void 0),(0,eZ._)(n,"pixelMargin",void 0),(0,eZ._)(n,"startAngle",void 0),n.options=void 0,n.circumference=void 0,n.startAngle=void 0,n.endAngle=void 0,n.innerRadius=void 0,n.outerRadius=void 0,n.pixelMargin=0,n.fullCircles=0,e&&Object.assign(n,e),n}return(0,e2._)(t,e),(0,eJ._)(t,[{key:"inRange",value:function(e,t,n){var r=ne(this.getProps(["x","y"],n),{x:e,y:t}),i=r.angle,o=r.distance,a=this.getProps(["startAngle","endAngle","innerRadius","outerRadius","circumference"],n),s=a.startAngle,l=a.endAngle,u=a.innerRadius,c=a.outerRadius,d=a.circumference,f=(this.options.spacing+this.options.borderWidth)/2,p=tA(d,l-s)>=tY||ni(i,s,l),h=na(o,u+f,c+f);return p&&h}},{key:"getCenterPoint",value:function(e){var t=this.getProps(["x","y","startAngle","endAngle","innerRadius","outerRadius"],e),n=t.x,r=t.y,i=t.startAngle,o=t.endAngle,a=t.innerRadius,s=t.outerRadius,l=this.options,u=l.offset,c=l.spacing,d=(i+o)/2,f=(a+s+c+u)/2;return{x:n+Math.cos(d)*f,y:r+Math.sin(d)*f}}},{key:"tooltipPosition",value:function(e){return this.getCenterPoint(e)}},{key:"draw",value:function(e){var t=this.options,n=this.circumference,r=(t.offset||0)/4,i=(t.spacing||0)/2,o=t.circular;if(this.pixelMargin=.33*("inner"===t.borderAlign),this.fullCircles=n>tY?Math.floor(n/tY):0,0!==n&&!(this.innerRadius<0)&&!(this.outerRadius<0)){e.save();var a=(this.startAngle+this.endAngle)/2;e.translate(Math.cos(a)*r,Math.sin(a)*r);var s=r*(1-Math.sin(Math.min(tK,n||0)));e.fillStyle=t.backgroundColor,e.strokeStyle=t.borderColor,function(e,t,n,r,i){var o=t.fullCircles,a=t.startAngle,s=t.circumference,l=t.endAngle;if(o){oo(e,t,n,r,l,i);for(var u=0;u<o;++u)e.fill();isNaN(s)||(l=a+(s%tY||tY))}oo(e,t,n,r,l,i),e.fill()}(e,this,s,i,o),function(e,t,n,r,i){var o=t.fullCircles,a=t.startAngle,s=t.circumference,l=t.options,u=l.borderWidth,c=l.borderJoinStyle,d=l.borderDash,f=l.borderDashOffset,p="inner"===l.borderAlign;if(u){e.setLineDash(d||[]),e.lineDashOffset=f,p?(e.lineWidth=2*u,e.lineJoin=c||"round"):(e.lineWidth=u,e.lineJoin=c||"bevel");var h,g,m,x,y,b,w,k,_=t.endAngle;if(o){oo(e,t,n,r,_,i);for(var S=0;S<o;++S)e.stroke();isNaN(s)||(_=a+(s%tY||tY))}p&&(h=_,g=t.startAngle,m=t.pixelMargin,x=t.x,y=t.y,b=t.outerRadius,w=t.innerRadius,k=m/b,e.beginPath(),e.arc(x,y,b,g-k,h+k),w>m?(k=m/w,e.arc(x,y,w,h+k,g-k,!0)):e.arc(x,y,m,h+tZ,g-tZ),e.closePath(),e.clip()),o||(oo(e,t,n,r,_,i),e.stroke())}}(e,this,s,i,o),e.restore()}}}]),t}((0,e5._)(iD));function os(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:t;e.lineCap=tA(n.borderCapStyle,t.borderCapStyle),e.setLineDash(tA(n.borderDash,t.borderDash)),e.lineDashOffset=tA(n.borderDashOffset,t.borderDashOffset),e.lineJoin=tA(n.borderJoinStyle,t.borderJoinStyle),e.lineWidth=tA(n.borderWidth,t.borderWidth),e.strokeStyle=tA(n.borderColor,t.borderColor)}function ol(e,t,n){e.lineTo(n.x,n.y)}function ou(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=e.length,i=n.start,o=void 0===i?0:i,a=n.end,s=void 0===a?r-1:a,l=t.start,u=t.end,c=Math.max(o,l),d=Math.min(s,u);return{count:r,start:c,loop:t.loop,ilen:d<c&&!(o<l&&s<l||o>u&&s>u)?r+d-c:d-c}}function oc(e,t,n,r){var i,o,a,s=t.points,l=t.options,u=ou(s,n,r),c=u.count,d=u.start,f=u.loop,p=u.ilen,h=l.stepped?nz:l.tension||"monotone"===l.cubicInterpolationMode?nH:ol,g=r||{},m=g.move,x=void 0===m||m,y=g.reverse;for(i=0;i<=p;++i)(o=s[(d+(y?p-i:i))%c]).skip||(x?(e.moveTo(o.x,o.y),x=!1):h(e,a,o,y,l.stepped),a=o);return f&&h(e,a,o=s[(d+(y?p:0))%c],y,l.stepped),!!f}function od(e,t,n,r){var i,o,a,s,l,u,c=t.points,d=ou(c,n,r),f=d.count,p=d.start,h=d.ilen,g=r||{},m=g.move,x=g.reverse,y=0,b=0,w=function(e){return(p+(x?h-e:e))%f},k=function(){s!==l&&(e.lineTo(y,l),e.lineTo(y,s),e.lineTo(y,u))};for((void 0===m||m)&&(o=c[w(0)],e.moveTo(o.x,o.y)),i=0;i<=h;++i)if(!(o=c[w(i)]).skip){var _=o.x,S=o.y,C=0|_;C===a?(S<s?s=S:S>l&&(l=S),y=(b*y+_)/++b):(k(),e.lineTo(_,S),a=C,b=0,s=l=S),u=S}k()}function of(e){var t=e.options,n=t.borderDash&&t.borderDash.length;return e._decimated||e._loop||t.tension||"monotone"===t.cubicInterpolationMode||t.stepped||n?oc:od}(0,eZ._)(oa,"id","arc"),(0,eZ._)(oa,"defaults",{borderAlign:"center",borderColor:"#fff",borderDash:[],borderDashOffset:0,borderJoinStyle:void 0,borderRadius:0,borderWidth:2,offset:0,spacing:0,angle:void 0,circular:!0}),(0,eZ._)(oa,"defaultRoutes",{backgroundColor:"backgroundColor"}),(0,eZ._)(oa,"descriptors",{_scriptable:!0,_indexable:function(e){return"borderDash"!==e}});var op="function"==typeof Path2D,oh=function(e){function t(e){var n;return(0,eX._)(this,t),(n=(0,eQ._)(this,t)).animated=!0,n.options=void 0,n._chart=void 0,n._loop=void 0,n._fullLoop=void 0,n._path=void 0,n._points=void 0,n._segments=void 0,n._decimated=!1,n._pointsUpdated=!1,n._datasetIndex=void 0,e&&Object.assign(n,e),n}return(0,e2._)(t,e),(0,eJ._)(t,[{key:"updateControlPoints",value:function(e,t){var n=this.options;if((n.tension||"monotone"===n.cubicInterpolationMode)&&!n.stepped&&!this._pointsUpdated){var r=n.spanGaps?this._loop:this._fullLoop;!function(e,t,n,r,i){var o,a,s,l;if(t.spanGaps&&(e=e.filter(function(e){return!e.skip})),"monotone"===t.cubicInterpolationMode)!function(e){var t,n,r,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"x",o=ro(i),a=e.length,s=Array(a).fill(0),l=Array(a),u=ri(e,0);for(t=0;t<a;++t)if(n=r,r=u,u=ri(e,t+1),r){if(u){var c=u[i]-r[i];s[t]=0!==c?(u[o]-r[o])/c:0}l[t]=n?u?t3(s[t-1])!==t3(s[t])?0:(s[t-1]+s[t])/2:s[t-1]:s[t]}!function(e,t,n){for(var r,i,o,a,s,l=e.length,u=ri(e,0),c=0;c<l-1;++c)if(s=u,u=ri(e,c+1),s&&u){if(t4(t[c],0,rr)){n[c]=n[c+1]=0;continue}(a=Math.pow(r=n[c]/t[c],2)+Math.pow(i=n[c+1]/t[c],2))<=9||(o=3/Math.sqrt(a),n[c]=r*o*t[c],n[c+1]=i*o*t[c])}}(e,s,l),function(e,t){for(var n,r,i,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"x",a=ro(o),s=e.length,l=ri(e,0),u=0;u<s;++u)if(r=i,i=l,l=ri(e,u+1),i){var c=i[o],d=i[a];r&&(n=(c-r[o])/3,i["cp1".concat(o)]=c-n,i["cp1".concat(a)]=d-n*t[u]),l&&(n=(l[o]-c)/3,i["cp2".concat(o)]=c+n,i["cp2".concat(a)]=d+n*t[u])}}(e,l,i)}(e,i);else{var u=r?e[e.length-1]:e[0];for(o=0,a=e.length;o<a;++o)l=function(e,t,n,r){var i=e.skip?t:e,o=n.skip?t:n,a=nt(t,i),s=nt(o,t),l=a/(a+s),u=s/(a+s);l=isNaN(l)?0:l,u=isNaN(u)?0:u;var c=r*l,d=r*u;return{previous:{x:t.x-c*(o.x-i.x),y:t.y-c*(o.y-i.y)},next:{x:t.x+d*(o.x-i.x),y:t.y+d*(o.y-i.y)}}}(u,s=e[o],e[Math.min(o+1,a-!r)%a],t.tension),s.cp1x=l.previous.x,s.cp1y=l.previous.y,s.cp2x=l.next.x,s.cp2y=l.next.y,u=s}t.capBezierPoints&&function(e,t){var n,r,i,o,a,s=nU(e[0],t);for(n=0,r=e.length;n<r;++n)a=o,o=s,s=n<r-1&&nU(e[n+1],t),o&&(i=e[n],a&&(i.cp1x=ra(i.cp1x,t.left,t.right),i.cp1y=ra(i.cp1y,t.top,t.bottom)),s&&(i.cp2x=ra(i.cp2x,t.left,t.right),i.cp2y=ra(i.cp2y,t.top,t.bottom)))}(e,n)}(this._points,n,e,r,t),this._pointsUpdated=!0}}},{key:"points",get:function(){return this._points},set:function(e){this._points=e,delete this._segments,delete this._path,this._pointsUpdated=!1}},{key:"segments",get:function(){return this._segments||(this._segments=function(e,t){var n=e.points,r=e.options.spanGaps,i=n.length;if(!i)return[];var o=!!e._loop,a=function(e,t,n,r){var i=0,o=t-1;if(n&&!r)for(;i<t&&!e[i].skip;)i++;for(;i<t&&e[i].skip;)i++;for(i%=t,n&&(o+=i);o>i&&e[o%t].skip;)o--;return{start:i,end:o%=t}}(n,i,o,r),s=a.start,l=a.end;if(!0===r)return rE(e,[{start:s,end:l,loop:o}],n,t);var u=l<s?l+i:l,c=!!e._fullLoop&&0===s&&l===i-1;return rE(e,function(e,t,n,r){var i,o=e.length,a=[],s=t,l=e[t];for(i=t+1;i<=n;++i){var u=e[i%o];u.skip||u.stop?l.skip||(r=!1,a.push({start:t%o,end:(i-1)%o,loop:r}),t=s=u.stop?i:null):(s=i,l.skip&&(t=i)),l=u}return null!==s&&a.push({start:t%o,end:s%o,loop:r}),a}(n,s,u,c),n,t)}(this,this.options.segment))}},{key:"first",value:function(){var e=this.segments,t=this.points;return e.length&&t[e[0].start]}},{key:"last",value:function(){var e=this.segments,t=this.points,n=e.length;return n&&t[e[n-1].end]}},{key:"interpolate",value:function(e,t){var n,r,i=this.options,o=e[t],a=this.points,s=rT(this,{property:t,start:o,end:o});if(s.length){var l=[],u=i.stepped?ry:i.tension||"monotone"===i.cubicInterpolationMode?rb:rx;for(n=0,r=s.length;n<r;++n){var c=s[n],d=c.start,f=c.end,p=a[d],h=a[f];if(p===h){l.push(p);continue}var g=Math.abs((o-p[t])/(h[t]-p[t])),m=u(p,h,g,i.stepped);m[t]=e[t],l.push(m)}return 1===l.length?l[0]:l}}},{key:"pathSegment",value:function(e,t,n){return of(this)(e,this,t,n)}},{key:"path",value:function(e,t,n){var r=this.segments,i=of(this),o=this._loop;t=t||0,n=n||this.points.length-t;var a=!0,s=!1,l=void 0;try{for(var u,c=r[Symbol.iterator]();!(a=(u=c.next()).done);a=!0){var d=u.value;o&=i(e,this,d,{start:t,end:t+n-1})}}catch(e){s=!0,l=e}finally{try{a||null==c.return||c.return()}finally{if(s)throw l}}return!!o}},{key:"draw",value:function(e,t,n,r){var i=this.options||{};(this.points||[]).length&&i.borderWidth&&(e.save(),function(e,t,n,r){if(op&&!t.options.segment){var i;(i=t._path)||(i=t._path=new Path2D,t.path(i,n,r)&&i.closePath()),os(e,t.options),e.stroke(i)}else!function(e,t,n,r){var i=t.segments,o=t.options,a=of(t),s=!0,l=!1,u=void 0;try{for(var c,d=i[Symbol.iterator]();!(s=(c=d.next()).done);s=!0){var f=c.value;os(e,o,f.style),e.beginPath(),a(e,t,f,{start:n,end:n+r-1})&&e.closePath(),e.stroke()}}catch(e){l=!0,u=e}finally{try{s||null==d.return||d.return()}finally{if(l)throw u}}}(e,t,n,r)}(e,this,n,r),e.restore()),this.animated&&(this._pointsUpdated=!1,this._path=void 0)}}]),t}((0,e5._)(iD));function og(e,t,n,r){var i=e.options;return Math.abs(t-e.getProps([n],r)[n])<i.radius+i.hitRadius}(0,eZ._)(oh,"id","line"),(0,eZ._)(oh,"defaults",{borderCapStyle:"butt",borderDash:[],borderDashOffset:0,borderJoinStyle:"miter",borderWidth:3,capBezierPoints:!0,cubicInterpolationMode:"default",fill:!1,spanGaps:!1,stepped:!1,tension:0}),(0,eZ._)(oh,"defaultRoutes",{backgroundColor:"backgroundColor",borderColor:"borderColor"}),(0,eZ._)(oh,"descriptors",{_scriptable:!0,_indexable:function(e){return"borderDash"!==e&&"fill"!==e}});var om=function(e){function t(e){var n;return(0,eX._)(this,t),n=(0,eQ._)(this,t),(0,eZ._)(n,"parsed",void 0),(0,eZ._)(n,"skip",void 0),(0,eZ._)(n,"stop",void 0),n.options=void 0,n.parsed=void 0,n.skip=void 0,n.stop=void 0,e&&Object.assign(n,e),n}return(0,e2._)(t,e),(0,eJ._)(t,[{key:"inRange",value:function(e,t,n){var r=this.options,i=this.getProps(["x","y"],n);return Math.pow(e-i.x,2)+Math.pow(t-i.y,2)<Math.pow(r.hitRadius+r.radius,2)}},{key:"inXRange",value:function(e,t){return og(this,e,"x",t)}},{key:"inYRange",value:function(e,t){return og(this,e,"y",t)}},{key:"getCenterPoint",value:function(e){var t=this.getProps(["x","y"],e);return{x:t.x,y:t.y}}},{key:"size",value:function(e){var t=(e=e||this.options||{}).radius||0,n=(t=Math.max(t,t&&e.hoverRadius||0))&&e.borderWidth||0;return(t+n)*2}},{key:"draw",value:function(e,t){var n=this.options;!this.skip&&!(n.radius<.1)&&nU(this,t,this.size(n)/2)&&(e.strokeStyle=n.borderColor,e.lineWidth=n.borderWidth,e.fillStyle=n.backgroundColor,nV(e,n,this.x,this.y))}},{key:"getRange",value:function(){var e=this.options||{};return e.radius+e.hitRadius}}]),t}((0,e5._)(iD));function ov(e,t){var n,r,i,o,a,s=e.getProps(["x","y","base","width","height"],t),l=s.x,u=s.y,c=s.base,d=s.width,f=s.height;return e.horizontal?(a=f/2,n=Math.min(l,c),r=Math.max(l,c),i=u-a,o=u+a):(n=l-(a=d/2),r=l+a,i=Math.min(u,c),o=Math.max(u,c)),{left:n,top:i,right:r,bottom:o}}function ox(e,t,n,r){return e?0:no(t,n,r)}function oy(e,t,n,r){var i=null===t,o=null===n,a=e&&!(i&&o)&&ov(e,r);return a&&(i||na(t,a.left,a.right))&&(o||na(n,a.top,a.bottom))}function ob(e,t){e.rect(t.x,t.y,t.w,t.h)}function ow(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=e.x!==n.x?-t:0,i=e.y!==n.y?-t:0,o=(e.x+e.w!==n.x+n.w?t:0)-r,a=(e.y+e.h!==n.y+n.h?t:0)-i;return{x:e.x+r,y:e.y+i,w:e.w+o,h:e.h+a,radius:e.radius}}(0,eZ._)(om,"id","point"),(0,eZ._)(om,"defaults",{borderWidth:1,hitRadius:1,hoverBorderWidth:1,hoverRadius:4,pointStyle:"circle",radius:3,rotation:0}),(0,eZ._)(om,"defaultRoutes",{backgroundColor:"backgroundColor",borderColor:"borderColor"});var ok=function(e){function t(e){var n;return(0,eX._)(this,t),(n=(0,eQ._)(this,t)).options=void 0,n.horizontal=void 0,n.base=void 0,n.width=void 0,n.height=void 0,n.inflateAmount=void 0,e&&Object.assign(n,e),n}return(0,e2._)(t,e),(0,eJ._)(t,[{key:"draw",value:function(e){var t,n,r,i,o,a,s,l,u,c,d,f,p,h,g,m,x,y,b,w=this.inflateAmount,k=this.options,_=k.borderColor,S=k.backgroundColor,C=(n=(t=ov(this)).right-t.left,r=t.bottom-t.top,i=n/2,o=r/2,a=this.options.borderWidth,s=this.borderSkipped,l=nX(a),u={t:ox(s.top,l.top,0,o),r:ox(s.right,l.right,0,i),b:ox(s.bottom,l.bottom,0,o),l:ox(s.left,l.left,0,i)},c=n/2,d=r/2,f=this.getProps(["enableBorderRadius"]).enableBorderRadius,h=nJ(p=this.options.borderRadius),g=Math.min(c,d),m=this.borderSkipped,y={topLeft:ox(!(x=f||tE(p))||m.top||m.left,h.topLeft,0,g),topRight:ox(!x||m.top||m.right,h.topRight,0,g),bottomLeft:ox(!x||m.bottom||m.left,h.bottomLeft,0,g),bottomRight:ox(!x||m.bottom||m.right,h.bottomRight,0,g)},{outer:{x:t.left,y:t.top,w:n,h:r,radius:y},inner:{x:t.left+u.l,y:t.top+u.t,w:n-u.l-u.r,h:r-u.t-u.b,radius:{topLeft:Math.max(0,y.topLeft-Math.max(u.t,u.l)),topRight:Math.max(0,y.topRight-Math.max(u.t,u.r)),bottomLeft:Math.max(0,y.bottomLeft-Math.max(u.b,u.l)),bottomRight:Math.max(0,y.bottomRight-Math.max(u.b,u.r))}}}),j=C.inner,T=C.outer,E=(b=T.radius).topLeft||b.topRight||b.bottomLeft||b.bottomRight?nq:ob;e.save(),(T.w!==j.w||T.h!==j.h)&&(e.beginPath(),E(e,ow(T,w,j)),e.clip(),E(e,ow(j,-w,T)),e.fillStyle=_,e.fill("evenodd")),e.beginPath(),E(e,ow(j,w)),e.fillStyle=S,e.fill(),e.restore()}},{key:"inRange",value:function(e,t,n){return oy(this,e,t,n)}},{key:"inXRange",value:function(e,t){return oy(this,e,null,t)}},{key:"inYRange",value:function(e,t){return oy(this,null,e,t)}},{key:"getCenterPoint",value:function(e){var t=this.getProps(["x","y","base","horizontal"],e),n=t.x,r=t.y,i=t.base,o=t.horizontal;return{x:o?(n+i)/2:n,y:o?r:(r+i)/2}}},{key:"getRange",value:function(e){return"x"===e?this.width/2:this.height/2}}]),t}((0,e5._)(iD));(0,eZ._)(ok,"id","bar"),(0,eZ._)(ok,"defaults",{borderSkipped:"start",borderWidth:0,borderRadius:0,inflateAmount:"auto",pointStyle:void 0}),(0,eZ._)(ok,"defaultRoutes",{backgroundColor:"backgroundColor",borderColor:"borderColor"});var o_=["rgb(54, 162, 235)","rgb(255, 99, 132)","rgb(255, 159, 64)","rgb(255, 205, 86)","rgb(75, 192, 192)","rgb(153, 102, 255)","rgb(201, 203, 207)"],oS=o_.map(function(e){return e.replace("rgb(","rgba(").replace(")",", 0.5)")});function oC(e,t,n,r){if(!r){var i=t[e],o=n[e];return"angle"===e&&(i=nr(i),o=nr(o)),{property:e,start:i,end:o}}}function oj(e,t,n){for(;t>e;t--){var r=n[t];if(!isNaN(r.x)&&!isNaN(r.y))break}return t}function oT(e,t,n,r){return e&&t?r(e[n],t[n]):e?e[n]:t?t[n]:0}function oE(e,t){var n,r,i,o,a,s,l,u=[],c=!1;return tT(e)?(c=!0,u=e):(i=void 0===(r=(n=e||{}).x)?null:r,a=void 0===(o=n.y)?null:o,s=t.points,l=[],t.segments.forEach(function(e){var t=e.start,n=e.end;n=oj(t,n,s);var r=s[t],o=s[n];null!==a?(l.push({x:r.x,y:a}),l.push({x:o.x,y:a})):null!==i&&(l.push({x:i,y:r.y}),l.push({x:i,y:o.y}))}),u=l),u.length?new oh({points:u,options:{tension:0},_loop:c,_fullLoop:c}):null}function oR(e){return e&&!1!==e.fill}var oI=function(){function e(t){(0,eX._)(this,e),this.x=t.x,this.y=t.y,this.radius=t.radius}return(0,eJ._)(e,[{key:"pathSegment",value:function(e,t,n){var r=this.x,i=this.y,o=this.radius;return t=t||{start:0,end:tY},e.arc(r,i,o,t.end,t.start,!0),!n.bounds}},{key:"interpolate",value:function(e){var t=this.x,n=this.y,r=this.radius,i=e.angle;return{x:t+Math.cos(i)*r,y:n+Math.sin(i)*r,angle:i}}}]),e}();function oA(e,t,n){var r,i,o,a,s,l,u,c,d,f=function(e){var t,n,r,i,o=e.chart,a=e.fill,s=e.line;if(tR(a)){return t=o,n=a,(r=t.getDatasetMeta(n))&&t.isDatasetVisible(n)?r.dataset:null}if("stack"===a)return function(e){var t=e.scale,n=e.index,r=e.line,i=[],o=r.segments,a=r.points,s=function(e,t){for(var n=[],r=e.getMatchingVisibleMetas("line"),i=0;i<r.length;i++){var o=r[i];if(o.index===t)break;o.hidden||n.unshift(o.dataset)}return n}(t,n);s.push(oE({x:null,y:t.bottom},r));for(var l=0;l<o.length;l++)for(var u=o[l],c=u.start;c<=u.end;c++)!function(e,t,n){for(var r=[],i=0;i<n.length;i++){var o=function(e,t,n){var r=e.interpolate(t,"x");if(!r)return{};for(var i=r.x,o=e.segments,a=e.points,s=!1,l=!1,u=0;u<o.length;u++){var c=o[u],d=a[c.start].x,f=a[c.end].x;if(na(i,d,f)){s=i===d,l=i===f;break}}return{first:s,last:l,point:r}}(n[i],t,"x"),a=o.first,s=o.last,l=o.point;if(l&&(!a||!s)){if(a)r.unshift(l);else if(e.push(l),!s)break}}e.push.apply(e,(0,e4._)(r))}(i,a[c],s);return new oh({points:i,options:{}})}(e);if("shape"===a)return!0;var l=((i=e).scale||{}).getPointPositionForValue?function(e){var t=e.scale,n=e.fill,r=t.options,i=t.getLabels().length,o=r.reverse?t.max:t.min,a="start"===n?o:"end"===n?t.options.reverse?t.min:t.max:tE(n)?n.value:t.getBaseValue(),s=[];if(r.grid.circular){var l=t.getPointPositionForValue(0,o);return new oI({x:l.x,y:l.y,radius:t.getDistanceFromCenterForValue(a)})}for(var u=0;u<i;++u)s.push(t.getPointPositionForValue(u,a));return s}(i):function(e){var t,n,r=e.scale,i=void 0===r?{}:r,o=(t=e.fill,n=null,"start"===t?n=i.bottom:"end"===t?n=i.top:tE(t)?n=i.getPixelForValue(t.value):i.getBasePixel&&(n=i.getBasePixel()),n);if(tR(o)){var a=i.isHorizontal();return{x:a?o:null,y:a?null:o}}return null}(i);return(0,e3._)(l,oI)?l:oE(l,s)}(t),p=t.line,h=t.scale,g=t.axis,m=p.options,x=m.fill,y=m.backgroundColor,b=x||{},w=b.above,k=b.below;f&&p.points.length&&(nG(e,n),r=e,o=(i={line:p,target:f,above:void 0===w?y:w,below:void 0===k?y:k,area:n,scale:h,axis:g}).line,a=i.target,s=i.above,l=i.below,u=i.area,c=i.scale,d=o._loop?"angle":i.axis,r.save(),"x"===d&&l!==s&&(oP(r,a,u.top),oD(r,{line:o,target:a,color:s,scale:c,property:d}),r.restore(),r.save(),oP(r,a,u.bottom)),oD(r,{line:o,target:a,color:l,scale:c,property:d}),r.restore(),n$(e))}function oP(e,t,n){var r=t.segments,i=t.points,o=!0,a=!1;e.beginPath();var s=!0,l=!1,u=void 0;try{for(var c,d=r[Symbol.iterator]();!(s=(c=d.next()).done);s=!0){var f=c.value,p=f.start,h=f.end,g=i[p],m=i[oj(p,h,i)];o?(e.moveTo(g.x,g.y),o=!1):(e.lineTo(g.x,n),e.lineTo(g.x,g.y)),(a=!!t.pathSegment(e,f,{move:a}))?e.closePath():e.lineTo(m.x,n)}}catch(e){l=!0,u=e}finally{try{s||null==d.return||d.return()}finally{if(l)throw u}}e.lineTo(t.first().x,n),e.closePath(),e.clip()}function oD(e,t){var n=t.line,r=t.target,i=t.property,o=t.color,a=t.scale,s=function(e,t,n){var r=e.segments,i=e.points,o=t.points,a=[],s=!0,l=!1,u=void 0;try{for(var c,d=r[Symbol.iterator]();!(s=(c=d.next()).done);s=!0){var f=c.value,p=f.start,h=f.end;h=oj(p,h,i);var g=oC(n,i[p],i[h],f.loop);if(!t.segments){a.push({source:f,target:g,start:i[p],end:i[h]});continue}var m=rT(t,g),x=!0,y=!1,b=void 0;try{for(var w,k=m[Symbol.iterator]();!(x=(w=k.next()).done);x=!0){var _=w.value,S=oC(n,o[_.start],o[_.end],_.loop),C=rj(f,i,S),j=!0,T=!1,E=void 0;try{for(var R,I=C[Symbol.iterator]();!(j=(R=I.next()).done);j=!0){var A=R.value;a.push({source:A,target:_,start:(0,eZ._)({},n,oT(g,S,"start",Math.max)),end:(0,eZ._)({},n,oT(g,S,"end",Math.min))})}}catch(e){T=!0,E=e}finally{try{j||null==I.return||I.return()}finally{if(T)throw E}}}}catch(e){y=!0,b=e}finally{try{x||null==k.return||k.return()}finally{if(y)throw b}}}}catch(e){l=!0,u=e}finally{try{s||null==d.return||d.return()}finally{if(l)throw u}}return a}(n,r,i),l=!0,u=!1,c=void 0;try{for(var d,f=s[Symbol.iterator]();!(l=(d=f.next()).done);l=!0){var p=d.value,h=p.source,g=p.target,m=p.start,x=p.end,y=h.style,b=(void 0===y?{}:y).backgroundColor,w=void 0===b?o:b,k=!0!==r;e.save(),e.fillStyle=w,function(e,t,n){var r=t.chart.chartArea,i=r.top,o=r.bottom,a=n||{},s=a.property,l=a.start,u=a.end;"x"===s&&(e.beginPath(),e.rect(l,i,u-l,o-i),e.clip())}(e,a,k&&oC(i,m,x)),e.beginPath();var _=!!n.pathSegment(e,h),S=void 0;if(k){_?e.closePath():oO(e,r,x,i);var C=!!r.pathSegment(e,g,{move:_,reverse:!0});(S=_&&C)||oO(e,r,m,i)}e.closePath(),e.fill(S?"evenodd":"nonzero"),e.restore()}}catch(e){u=!0,c=e}finally{try{l||null==f.return||f.return()}finally{if(u)throw c}}}function oO(e,t,n,r){var i=t.interpolate(n,r);i&&e.lineTo(i.x,i.y)}var oN={id:"filler",afterDatasetsUpdate:function(e,t,n){var r,i,o,a,s=(e.data.datasets||[]).length,l=[];for(i=0;i<s;++i)o=(r=e.getDatasetMeta(i)).dataset,a=null,o&&o.options&&(0,e3._)(o,oh)&&(a={visible:e.isDatasetVisible(i),index:i,fill:function(e,t,n){var r,i,o,a,s=function(e){var t=e.options,n=t.fill,r=tA(n&&n.target,n);return void 0===r&&(r=!!t.backgroundColor),!1!==r&&null!==r&&(!0===r?"origin":r)}(e);if(tE(s))return!isNaN(s.value)&&s;var l=parseFloat(s);return tR(l)&&Math.floor(l)===l?(r=s[0],i=t,o=l,a=n,("-"===r||"+"===r)&&(o=i+o),o!==i&&!(o<0)&&!(o>=a)&&o):["origin","start","end","stack","shape"].indexOf(s)>=0&&s}(o,i,s),chart:e,axis:r.controller.options.indexAxis,scale:r.vScale,line:o}),r.$filler=a,l.push(a);for(i=0;i<s;++i)(a=l[i])&&!1!==a.fill&&(a.fill=function(e,t,n){var r,i=e[t].fill,o=[t];if(!n)return i;for(;!1!==i&&-1===o.indexOf(i);){if(!tR(i))return i;if(!(r=e[i]))break;if(r.visible)return i;o.push(i),i=r.fill}return!1}(l,i,n.propagate))},beforeDraw:function(e,t,n){for(var r="beforeDraw"===n.drawTime,i=e.getSortedVisibleDatasetMetas(),o=e.chartArea,a=i.length-1;a>=0;--a){var s=i[a].$filler;s&&(s.line.updateControlPoints(o,s.axis),r&&s.fill&&oA(e.ctx,s,o))}},beforeDatasetsDraw:function(e,t,n){if("beforeDatasetsDraw"===n.drawTime)for(var r=e.getSortedVisibleDatasetMetas(),i=r.length-1;i>=0;--i){var o=r[i].$filler;oR(o)&&oA(e.ctx,o,e.chartArea)}},beforeDatasetDraw:function(e,t,n){var r=t.meta.$filler;oR(r)&&"beforeDatasetDraw"===n.drawTime&&oA(e.ctx,r,e.chartArea)},defaults:{propagate:!0,drawTime:"beforeDatasetDraw"}},oM=function(e,t){var n=e.boxHeight,r=void 0===n?t:n,i=e.boxWidth,o=void 0===i?t:i;return e.usePointStyle&&(r=Math.min(r,t),o=e.pointStyleWidth||Math.min(o,t)),{boxWidth:o,boxHeight:r,itemHeight:Math.max(t,r)}};function oL(e,t){return t*(e.text?e.text.length:0)}(function(e){function t(e){var n;return(0,eX._)(this,t),(n=(0,eQ._)(this,t))._added=!1,n.legendHitBoxes=[],n._hoveredItem=null,n.doughnutMode=!1,n.chart=e.chart,n.options=e.options,n.ctx=e.ctx,n.legendItems=void 0,n.columnSizes=void 0,n.lineWidths=void 0,n.maxHeight=void 0,n.maxWidth=void 0,n.top=void 0,n.bottom=void 0,n.left=void 0,n.right=void 0,n.height=void 0,n.width=void 0,n._margins=void 0,n.position=void 0,n.weight=void 0,n.fullSize=void 0,n}(0,e2._)(t,e),(0,eJ._)(t,[{key:"update",value:function(e,t,n){this.maxWidth=e,this.maxHeight=t,this._margins=n,this.setDimensions(),this.buildLabels(),this.fit()}},{key:"setDimensions",value:function(){this.isHorizontal()?(this.width=this.maxWidth,this.left=this._margins.left,this.right=this.width):(this.height=this.maxHeight,this.top=this._margins.top,this.bottom=this.height)}},{key:"buildLabels",value:function(){var e=this,t=this.options.labels||{},n=tD(t.generateLabels,[this.chart],this)||[];t.filter&&(n=n.filter(function(n){return t.filter(n,e.chart.data)})),t.sort&&(n=n.sort(function(n,r){return t.sort(n,r,e.chart.data)})),this.options.reverse&&n.reverse(),this.legendItems=n}},{key:"fit",value:function(){var e,t,n=this.options,r=this.ctx;if(!n.display){this.width=this.height=0;return}var i=n.labels,o=n0(i.font),a=o.size,s=this._computeTitleHeight(),l=oM(i,a),u=l.boxWidth,c=l.itemHeight;r.font=o.string,this.isHorizontal()?(e=this.maxWidth,t=this._fitRows(s,a,u,c)+10):(t=this.maxHeight,e=this._fitCols(s,o,u,c)+10),this.width=Math.min(e,n.maxWidth||this.maxWidth),this.height=Math.min(t,n.maxHeight||this.maxHeight)}},{key:"_fitRows",value:function(e,t,n,r){var i=this.ctx,o=this.maxWidth,a=this.options.labels.padding,s=this.legendHitBoxes=[],l=this.lineWidths=[0],u=r+a,c=e;i.textAlign="left",i.textBaseline="middle";var d=-1,f=-u;return this.legendItems.forEach(function(e,p){var h=n+t/2+i.measureText(e.text).width;(0===p||l[l.length-1]+h+2*a>o)&&(c+=u,l[l.length-(p>0?0:1)]=0,f+=u,d++),s[p]={left:0,top:f,row:d,width:h,height:r},l[l.length-1]+=h+a}),c}},{key:"_fitCols",value:function(e,t,n,r){var i=this.ctx,o=this.maxHeight,a=this.options.labels.padding,s=this.legendHitBoxes=[],l=this.columnSizes=[],u=o-e,c=a,d=0,f=0,p=0,h=0;return this.legendItems.forEach(function(e,o){var g,m,x,y,b,w,k,_,S,C,j,T,E,R,I=(g=n,m=t,x=i,y=e,b=r,{itemWidth:(w=y,k=g,_=m,S=x,(C=w.text)&&"string"!=typeof C&&(C=C.reduce(function(e,t){return e.length>t.length?e:t})),k+_.size/2+S.measureText(C).width),itemHeight:(j=b,T=y,E=m.lineHeight,R=j,"string"!=typeof T.text&&(R=oL(T,E)),R)}),A=I.itemWidth,P=I.itemHeight;o>0&&f+P+2*a>u&&(c+=d+a,l.push({width:d,height:f}),p+=d+a,h++,d=f=0),s[o]={left:p,top:f,col:h,width:A,height:P},d=Math.max(d,A),f+=P+a}),c+=d,l.push({width:d,height:f}),c}},{key:"adjustHitBoxes",value:function(){if(this.options.display){var e=this._computeTitleHeight(),t=this.legendHitBoxes,n=this.options,r=n.align,i=n.labels.padding,o=rw(n.rtl,this.left,this.width);if(this.isHorizontal()){var a=0,s=nm(r,this.left+i,this.right-this.lineWidths[a]),l=!0,u=!1,c=void 0;try{for(var d,f=t[Symbol.iterator]();!(l=(d=f.next()).done);l=!0){var p=d.value;a!==p.row&&(a=p.row,s=nm(r,this.left+i,this.right-this.lineWidths[a])),p.top+=this.top+e+i,p.left=o.leftForLtr(o.x(s),p.width),s+=p.width+i}}catch(e){u=!0,c=e}finally{try{l||null==f.return||f.return()}finally{if(u)throw c}}}else{var h=0,g=nm(r,this.top+e+i,this.bottom-this.columnSizes[h].height),m=!0,x=!1,y=void 0;try{for(var b,w=t[Symbol.iterator]();!(m=(b=w.next()).done);m=!0){var k=b.value;k.col!==h&&(h=k.col,g=nm(r,this.top+e+i,this.bottom-this.columnSizes[h].height)),k.top=g,k.left+=this.left+i,k.left=o.leftForLtr(o.x(k.left),k.width),g+=k.height+i}}catch(e){x=!0,y=e}finally{try{m||null==w.return||w.return()}finally{if(x)throw y}}}}}},{key:"isHorizontal",value:function(){return"top"===this.options.position||"bottom"===this.options.position}},{key:"draw",value:function(){if(this.options.display){var e=this.ctx;nG(e,this),this._draw(),n$(e)}}},{key:"_draw",value:function(){var e,t=this,n=this.options,r=this.columnSizes,i=this.lineWidths,o=this.ctx,a=n.align,s=n.labels,l=nN.color,u=rw(n.rtl,this.left,this.width),c=n0(s.font),d=s.padding,f=c.size,p=f/2;this.drawTitle(),o.textAlign=u.textAlign("left"),o.textBaseline="middle",o.lineWidth=.5,o.font=c.string;var h=oM(s,f),g=h.boxWidth,m=h.boxHeight,x=h.itemHeight,y=function(e,t,n){if(!(isNaN(g)||g<=0||isNaN(m))&&!(m<0)){o.save();var r=tA(n.lineWidth,1);if(o.fillStyle=tA(n.fillStyle,l),o.lineCap=tA(n.lineCap,"butt"),o.lineDashOffset=tA(n.lineDashOffset,0),o.lineJoin=tA(n.lineJoin,"miter"),o.lineWidth=r,o.strokeStyle=tA(n.strokeStyle,l),o.setLineDash(tA(n.lineDash,[])),s.usePointStyle)nF(o,{radius:m*Math.SQRT2/2,pointStyle:n.pointStyle,rotation:n.rotation,borderWidth:r},u.xPlus(e,g/2),t+p,s.pointStyleWidth&&g);else{var i=t+Math.max((f-m)/2,0),a=u.leftForLtr(e,g),c=nJ(n.borderRadius);o.beginPath(),Object.values(c).some(function(e){return 0!==e})?nq(o,{x:a,y:i,w:g,h:m,radius:c}):o.rect(a,i,g,m),o.fill(),0!==r&&o.stroke()}o.restore()}},b=function(e,t,n){nW(o,n.text,e,t+x/2,c,{strikethrough:n.hidden,textAlign:u.textAlign(n.textAlign)})},w=this.isHorizontal(),k=this._computeTitleHeight();e=w?{x:nm(a,this.left+d,this.right-i[0]),y:this.top+d+k,line:0}:{x:this.left+d,y:nm(a,this.top+k+d,this.bottom-r[0].height),line:0},rk(this.ctx,n.textDirection);var _=x+d;this.legendItems.forEach(function(l,f){o.strokeStyle=l.fontColor,o.fillStyle=l.fontColor;var h,m,x=o.measureText(l.text).width,S=u.textAlign(l.textAlign||(l.textAlign=s.textAlign)),C=g+p+x,j=e.x,T=e.y;if(u.setWidth(t.width),w?f>0&&j+C+d>t.right&&(T=e.y+=_,e.line++,j=e.x=nm(a,t.left+d,t.right-i[e.line])):f>0&&T+_>t.bottom&&(j=e.x=j+r[e.line].width+d,e.line++,T=e.y=nm(a,t.top+k+d,t.bottom-r[e.line].height)),y(u.x(j),T,l),h=j+g+p,m=w?j+C:t.right,j=S===(n.rtl?"left":"right")?m:"center"===S?(h+m)/2:h,b(u.x(j),T,l),w)e.x+=C+d;else if("string"!=typeof l.text){var E=c.lineHeight;e.y+=oL(l,E)+d}else e.y+=_}),r_(this.ctx,n.textDirection)}},{key:"drawTitle",value:function(){var e,t,n=this.options,r=n.title,i=n0(r.font),o=nZ(r.padding);if(r.display){var a=rw(n.rtl,this.left,this.width),s=this.ctx,l=r.position,u=i.size/2,c=o.top+u,d=this.left,f=this.width;if(this.isHorizontal())f=(t=Math).max.apply(t,(0,e4._)(this.lineWidths)),e=this.top+c,d=nm(n.align,d,this.right-f);else{var p=this.columnSizes.reduce(function(e,t){return Math.max(e,t.height)},0);e=c+nm(n.align,this.top,this.bottom-p-n.labels.padding-this._computeTitleHeight())}var h=nm(l,d,d+f);s.textAlign=a.textAlign(ng(l)),s.textBaseline="middle",s.strokeStyle=r.color,s.fillStyle=r.color,s.font=i.string,nW(s,r.text,h,e,i)}}},{key:"_computeTitleHeight",value:function(){var e=this.options.title,t=n0(e.font),n=nZ(e.padding);return e.display?t.lineHeight+n.height:0}},{key:"_getLegendItemAt",value:function(e,t){var n,r,i;if(na(e,this.left,this.right)&&na(t,this.top,this.bottom)){for(n=0,i=this.legendHitBoxes;n<i.length;++n)if(na(e,(r=i[n]).left,r.left+r.width)&&na(t,r.top,r.top+r.height))return this.legendItems[n]}return null}},{key:"handleEvent",value:function(e){var t,n,r=this.options;if(t=e.type,n=r,("mousemove"===t||"mouseout"===t)&&(n.onHover||n.onLeave)||n.onClick&&("click"===t||"mouseup"===t)){var i=this._getLegendItemAt(e.x,e.y);if("mousemove"===e.type||"mouseout"===e.type){var o=this._hoveredItem,a=null!==o&&null!==i&&o.datasetIndex===i.datasetIndex&&o.index===i.index;o&&!a&&tD(r.onLeave,[e,o,this],this),this._hoveredItem=i,i&&!a&&tD(r.onHover,[e,i,this],this)}else i&&tD(r.onClick,[e,i,this],this)}}}])})((0,e5._)(iD));var oB=function(e){function t(e){var n;return(0,eX._)(this,t),(n=(0,eQ._)(this,t)).chart=e.chart,n.options=e.options,n.ctx=e.ctx,n._padding=void 0,n.top=void 0,n.bottom=void 0,n.left=void 0,n.right=void 0,n.width=void 0,n.height=void 0,n.position=void 0,n.weight=void 0,n.fullSize=void 0,n}return(0,e2._)(t,e),(0,eJ._)(t,[{key:"update",value:function(e,t){var n=this.options;if(this.left=0,this.top=0,!n.display){this.width=this.height=this.right=this.bottom=0;return}this.width=this.right=e,this.height=this.bottom=t;var r=tT(n.text)?n.text.length:1;this._padding=nZ(n.padding);var i=r*n0(n.font).lineHeight+this._padding.height;this.isHorizontal()?this.height=i:this.width=i}},{key:"isHorizontal",value:function(){var e=this.options.position;return"top"===e||"bottom"===e}},{key:"_drawArgs",value:function(e){var t,n,r,i=this.top,o=this.left,a=this.bottom,s=this.right,l=this.options,u=l.align,c=0;return this.isHorizontal()?(n=nm(u,o,s),r=i+e,t=s-o):("left"===l.position?(n=o+e,r=nm(u,a,i),c=-.5*tK):(n=s-e,r=nm(u,i,a),c=.5*tK),t=a-i),{titleX:n,titleY:r,maxWidth:t,rotation:c}}},{key:"draw",value:function(){var e=this.ctx,t=this.options;if(t.display){var n=n0(t.font),r=n.lineHeight/2+this._padding.top,i=this._drawArgs(r),o=i.titleX,a=i.titleY,s=i.maxWidth,l=i.rotation;nW(e,t.text,0,0,n,{color:t.color,maxWidth:s,rotation:l,textAlign:ng(t.align),textBaseline:"middle",translation:[o,a]})}}}]),t}((0,e5._)(iD)),oV={id:"title",_element:oB,start:function(e,t,n){var r;r=new oB({ctx:e.ctx,options:n,chart:e}),ig(e,r,n),ip(e,r),e.titleBlock=r},stop:function(e){var t=e.titleBlock;ih(e,t),delete e.titleBlock},beforeUpdate:function(e,t,n){var r=e.titleBlock;ig(e,r,n),r.options=n},defaults:{align:"center",display:!1,font:{weight:"bold"},fullSize:!0,padding:10,position:"top",text:"",weight:2e3},defaultRoutes:{color:"color"},descriptors:{_scriptable:!0,_indexable:!1}},oF=(new WeakMap,{average:function(e){if(!e.length)return!1;var t,n,r=0,i=0,o=0;for(t=0,n=e.length;t<n;++t){var a=e[t].element;if(a&&a.hasValue()){var s=a.tooltipPosition();r+=s.x,i+=s.y,++o}}return{x:r/o,y:i/o}},nearest:function(e,t){if(!e.length)return!1;var n,r,i,o=t.x,a=t.y,s=1/0;for(n=0,r=e.length;n<r;++n){var l=e[n].element;if(l&&l.hasValue()){var u=nt(t,l.getCenterPoint());u<s&&(s=u,i=l)}}if(i){var c=i.tooltipPosition();o=c.x,a=c.y}return{x:o,y:a}}});function oU(e,t){return t&&(tT(t)?Array.prototype.push.apply(e,t):e.push(t)),e}function oG(e){return("string"==typeof e||(0,e3._)(e,String))&&e.indexOf("\n")>-1?e.split("\n"):e}function o$(e,t){var n=e.chart.ctx,r=e.body,i=e.footer,o=e.title,a=t.boxWidth,s=t.boxHeight,l=n0(t.bodyFont),u=n0(t.titleFont),c=n0(t.footerFont),d=o.length,f=i.length,p=r.length,h=nZ(t.padding),g=h.height,m=0,x=r.reduce(function(e,t){return e+t.before.length+t.lines.length+t.after.length},0);x+=e.beforeBody.length+e.afterBody.length,d&&(g+=d*u.lineHeight+(d-1)*t.titleSpacing+t.titleMarginBottom),x&&(g+=p*(t.displayColors?Math.max(s,l.lineHeight):l.lineHeight)+(x-p)*l.lineHeight+(x-1)*t.bodySpacing),f&&(g+=t.footerMarginTop+f*c.lineHeight+(f-1)*t.footerSpacing);var y=0,b=function(e){m=Math.max(m,n.measureText(e).width+y)};return n.save(),n.font=u.string,tO(e.title,b),n.font=l.string,tO(e.beforeBody.concat(e.afterBody),b),y=t.displayColors?a+2+t.boxPadding:0,tO(r,function(e){tO(e.before,b),tO(e.lines,b),tO(e.after,b)}),y=0,n.font=c.string,tO(e.footer,b),n.restore(),{width:m+=h.width,height:g}}function oz(e,t,n){var r,i,o,a,s,l,u,c,d,f=n.yAlign||t.yAlign||((r=n.y)<(i=n.height)/2?"top":r>e.height-i/2?"bottom":"center");return{xAlign:n.xAlign||t.xAlign||(o=n.x,a=n.width,s=e.width,u=(l=e.chartArea).left,c=l.right,d="center","center"===f?d=o<=(u+c)/2?"left":"right":o<=a/2?d="left":o>=s-a/2&&(d="right"),function(e,t,n,r){var i=r.x,o=r.width,a=n.caretSize+n.caretPadding;if("left"===e&&i+o+a>t.width||"right"===e&&i-o-a<0)return!0}(d,e,t,n)&&(d="center"),d),yAlign:f}}function oH(e,t,n,r){var i,o,a,s,l=e.caretSize,u=e.caretPadding,c=e.cornerRadius,d=n.xAlign,f=n.yAlign,p=l+u,h=nJ(c),g=h.topLeft,m=h.topRight,x=h.bottomLeft,y=h.bottomRight,b=(i=t.x,o=t.width,"right"===d?i-=o:"center"===d&&(i-=o/2),i),w=(a=t.y,s=t.height,"top"===f?a+=p:"bottom"===f?a-=s+p:a-=s/2,a);return"center"===f?"left"===d?b+=p:"right"===d&&(b-=p):"left"===d?b-=Math.max(g,x)+l:"right"===d&&(b+=Math.max(m,y)+l),{x:no(b,0,r.width-t.width),y:no(w,0,r.height-t.height)}}function oW(e,t,n){var r=nZ(n.padding);return"center"===t?e.x+e.width/2:"right"===t?e.x+e.width-r.right:e.x+r.left}function oq(e,t){var n=t&&t.dataset&&t.dataset.tooltip&&t.dataset.tooltip.callbacks;return n?e.override(n):e}var oK={beforeTitle:tS,title:function(e){if(e.length>0){var t=e[0],n=t.chart.data.labels,r=n?n.length:0;if(this&&this.options&&"dataset"===this.options.mode)return t.dataset.label||"";if(t.label)return t.label;if(r>0&&t.dataIndex<r)return n[t.dataIndex]}return""},afterTitle:tS,beforeBody:tS,beforeLabel:tS,label:function(e){if(this&&this.options&&"dataset"===this.options.mode)return e.label+": "+e.formattedValue||e.formattedValue;var t=e.dataset.label||"";t&&(t+=": ");var n=e.formattedValue;return tj(n)||(t+=n),t},labelColor:function(e){var t=e.chart.getDatasetMeta(e.datasetIndex).controller.getStyle(e.dataIndex);return{borderColor:t.borderColor,backgroundColor:t.backgroundColor,borderWidth:t.borderWidth,borderDash:t.borderDash,borderDashOffset:t.borderDashOffset,borderRadius:0}},labelTextColor:function(){return this.options.bodyColor},labelPointStyle:function(e){var t=e.chart.getDatasetMeta(e.datasetIndex).controller.getStyle(e.dataIndex);return{pointStyle:t.pointStyle,rotation:t.rotation}},afterLabel:tS,afterBody:tS,beforeFooter:tS,footer:tS,afterFooter:tS};function oY(e,t,n,r){var i=e[t].call(n,r);return void 0===i?oK[t].call(n,r):i}var oQ=function(e){function t(e){var n;return(0,eX._)(this,t),(n=(0,eQ._)(this,t)).opacity=0,n._active=[],n._eventPosition=void 0,n._size=void 0,n._cachedAnimations=void 0,n._tooltipItems=[],n.$animations=void 0,n.$context=void 0,n.chart=e.chart,n.options=e.options,n.dataPoints=void 0,n.title=void 0,n.beforeBody=void 0,n.body=void 0,n.afterBody=void 0,n.footer=void 0,n.xAlign=void 0,n.yAlign=void 0,n.x=void 0,n.y=void 0,n.height=void 0,n.width=void 0,n.caretX=void 0,n.caretY=void 0,n.labelColors=void 0,n.labelPointStyles=void 0,n.labelTextColors=void 0,n}return(0,e2._)(t,e),(0,eJ._)(t,[{key:"initialize",value:function(e){this.options=e,this._cachedAnimations=void 0,this.$context=void 0}},{key:"_resolveAnimations",value:function(){var e=this._cachedAnimations;if(e)return e;var t=this.chart,n=this.options.setContext(this.getContext()),r=n.enabled&&t.options.animation&&n.animations,i=new rO(this.chart,r);return r._cacheable&&(this._cachedAnimations=Object.freeze(i)),i}},{key:"getContext",value:function(){var e;return this.$context||(this.$context=(e=this.chart.getContext(),n2(e,{tooltip:this,tooltipItems:this._tooltipItems,type:"tooltip"})))}},{key:"getTitle",value:function(e,t){var n=t.callbacks,r=oY(n,"beforeTitle",this,e),i=oY(n,"title",this,e),o=oY(n,"afterTitle",this,e),a=[];return a=oU(a,oG(r)),a=oU(a,oG(i)),a=oU(a,oG(o))}},{key:"getBeforeBody",value:function(e,t){return oU([],oG(oY(t.callbacks,"beforeBody",this,e)))}},{key:"getBody",value:function(e,t){var n=this,r=t.callbacks,i=[];return tO(e,function(e){var t={before:[],lines:[],after:[]},o=oq(r,e);oU(t.before,oG(oY(o,"beforeLabel",n,e))),oU(t.lines,oY(o,"label",n,e)),oU(t.after,oG(oY(o,"afterLabel",n,e))),i.push(t)}),i}},{key:"getAfterBody",value:function(e,t){return oU([],oG(oY(t.callbacks,"afterBody",this,e)))}},{key:"getFooter",value:function(e,t){var n=t.callbacks,r=oY(n,"beforeFooter",this,e),i=oY(n,"footer",this,e),o=oY(n,"afterFooter",this,e),a=[];return a=oU(a,oG(r)),a=oU(a,oG(i)),a=oU(a,oG(o))}},{key:"_createItems",value:function(e){var t,n,r=this,i=this._active,o=this.chart.data,a=[],s=[],l=[],u=[];for(t=0,n=i.length;t<n;++t)u.push(function(e,t){var n=t.element,r=t.datasetIndex,i=t.index,o=e.getDatasetMeta(r).controller,a=o.getLabelAndValue(i),s=a.label,l=a.value;return{chart:e,label:s,parsed:o.getParsed(i),raw:e.data.datasets[r].data[i],formattedValue:l,dataset:o.getDataset(),dataIndex:i,datasetIndex:r,element:n}}(this.chart,i[t]));return e.filter&&(u=u.filter(function(t,n,r){return e.filter(t,n,r,o)})),e.itemSort&&(u=u.sort(function(t,n){return e.itemSort(t,n,o)})),tO(u,function(t){var n=oq(e.callbacks,t);a.push(oY(n,"labelColor",r,t)),s.push(oY(n,"labelPointStyle",r,t)),l.push(oY(n,"labelTextColor",r,t))}),this.labelColors=a,this.labelPointStyles=s,this.labelTextColors=l,this.dataPoints=u,u}},{key:"update",value:function(e,t){var n,r=this.options.setContext(this.getContext()),i=this._active,o=[];if(i.length){var a=oF[r.position].call(this,i,this._eventPosition);o=this._createItems(r),this.title=this.getTitle(o,r),this.beforeBody=this.getBeforeBody(o,r),this.body=this.getBody(o,r),this.afterBody=this.getAfterBody(o,r),this.footer=this.getFooter(o,r);var s=this._size=o$(this,r),l=Object.assign({},a,s),u=oz(this.chart,r,l),c=oH(r,l,u,this.chart);this.xAlign=u.xAlign,this.yAlign=u.yAlign,n={opacity:1,x:c.x,y:c.y,width:s.width,height:s.height,caretX:a.x,caretY:a.y}}else 0!==this.opacity&&(n={opacity:0});this._tooltipItems=o,this.$context=void 0,n&&this._resolveAnimations().update(this,n),e&&r.external&&r.external.call(this,{chart:this.chart,tooltip:this,replay:t})}},{key:"drawCaret",value:function(e,t,n,r){var i=this.getCaretPosition(e,n,r);t.lineTo(i.x1,i.y1),t.lineTo(i.x2,i.y2),t.lineTo(i.x3,i.y3)}},{key:"getCaretPosition",value:function(e,t,n){var r,i,o,a,s,l,u=this.xAlign,c=this.yAlign,d=n.caretSize,f=nJ(n.cornerRadius),p=f.topLeft,h=f.topRight,g=f.bottomLeft,m=f.bottomRight,x=e.x,y=e.y,b=t.width,w=t.height;return"center"===c?(s=y+w/2,"left"===u?(i=(r=x)-d,a=s+d,l=s-d):(i=(r=x+b)+d,a=s-d,l=s+d),o=r):(i="left"===u?x+Math.max(p,g)+d:"right"===u?x+b-Math.max(h,m)-d:this.caretX,"top"===c?(s=(a=y)-d,r=i-d,o=i+d):(s=(a=y+w)+d,r=i+d,o=i-d),l=a),{x1:r,x2:i,x3:o,y1:a,y2:s,y3:l}}},{key:"drawTitle",value:function(e,t,n){var r,i,o,a=this.title,s=a.length;if(s){var l=rw(n.rtl,this.x,this.width);for(o=0,e.x=oW(this,n.titleAlign,n),t.textAlign=l.textAlign(n.titleAlign),t.textBaseline="middle",r=n0(n.titleFont),i=n.titleSpacing,t.fillStyle=n.titleColor,t.font=r.string;o<s;++o)t.fillText(a[o],l.x(e.x),e.y+r.lineHeight/2),e.y+=r.lineHeight+i,o+1===s&&(e.y+=n.titleMarginBottom-i)}}},{key:"_drawColorBox",value:function(e,t,n,r,i){var o=this.labelColors[n],a=this.labelPointStyles[n],s=i.boxHeight,l=i.boxWidth,u=n0(i.bodyFont),c=oW(this,"left",i),d=r.x(c),f=s<u.lineHeight?(u.lineHeight-s)/2:0,p=t.y+f;if(i.usePointStyle){var h={radius:Math.min(l,s)/2,pointStyle:a.pointStyle,rotation:a.rotation,borderWidth:1},g=r.leftForLtr(d,l)+l/2,m=p+s/2;e.strokeStyle=i.multiKeyBackground,e.fillStyle=i.multiKeyBackground,nV(e,h,g,m),e.strokeStyle=o.borderColor,e.fillStyle=o.backgroundColor,nV(e,h,g,m)}else{e.lineWidth=tE(o.borderWidth)?(x=Math).max.apply(x,(0,e4._)(Object.values(o.borderWidth))):o.borderWidth||1,e.strokeStyle=o.borderColor,e.setLineDash(o.borderDash||[]),e.lineDashOffset=o.borderDashOffset||0;var x,y=r.leftForLtr(d,l),b=r.leftForLtr(r.xPlus(d,1),l-2),w=nJ(o.borderRadius);Object.values(w).some(function(e){return 0!==e})?(e.beginPath(),e.fillStyle=i.multiKeyBackground,nq(e,{x:y,y:p,w:l,h:s,radius:w}),e.fill(),e.stroke(),e.fillStyle=o.backgroundColor,e.beginPath(),nq(e,{x:b,y:p+1,w:l-2,h:s-2,radius:w}),e.fill()):(e.fillStyle=i.multiKeyBackground,e.fillRect(y,p,l,s),e.strokeRect(y,p,l,s),e.fillStyle=o.backgroundColor,e.fillRect(b,p+1,l-2,s-2))}e.fillStyle=this.labelTextColors[n]}},{key:"drawBody",value:function(e,t,n){var r,i,o,a,s,l,u=this.body,c=n.bodySpacing,d=n.bodyAlign,f=n.displayColors,p=n.boxHeight,h=n.boxWidth,g=n.boxPadding,m=n0(n.bodyFont),x=m.lineHeight,y=0,b=rw(n.rtl,this.x,this.width),w=function(n){t.fillText(n,b.x(e.x+y),e.y+x/2),e.y+=x+c},k=b.textAlign(d);for(t.textAlign=d,t.textBaseline="middle",t.font=m.string,e.x=oW(this,k,n),t.fillStyle=n.bodyColor,tO(this.beforeBody,w),y=f&&"right"!==k?"center"===d?h/2+g:h+2+g:0,o=0,s=u.length;o<s;++o){for(r=u[o],t.fillStyle=this.labelTextColors[o],tO(r.before,w),i=r.lines,f&&i.length&&(this._drawColorBox(t,e,o,b,n),x=Math.max(m.lineHeight,p)),a=0,l=i.length;a<l;++a)w(i[a]),x=m.lineHeight;tO(r.after,w)}y=0,x=m.lineHeight,tO(this.afterBody,w),e.y-=c}},{key:"drawFooter",value:function(e,t,n){var r,i,o=this.footer,a=o.length;if(a){var s=rw(n.rtl,this.x,this.width);for(e.x=oW(this,n.footerAlign,n),e.y+=n.footerMarginTop,t.textAlign=s.textAlign(n.footerAlign),t.textBaseline="middle",r=n0(n.footerFont),t.fillStyle=n.footerColor,t.font=r.string,i=0;i<a;++i)t.fillText(o[i],s.x(e.x),e.y+r.lineHeight/2),e.y+=r.lineHeight+n.footerSpacing}}},{key:"drawBackground",value:function(e,t,n,r){var i=this.xAlign,o=this.yAlign,a=e.x,s=e.y,l=n.width,u=n.height,c=nJ(r.cornerRadius),d=c.topLeft,f=c.topRight,p=c.bottomLeft,h=c.bottomRight;t.fillStyle=r.backgroundColor,t.strokeStyle=r.borderColor,t.lineWidth=r.borderWidth,t.beginPath(),t.moveTo(a+d,s),"top"===o&&this.drawCaret(e,t,n,r),t.lineTo(a+l-f,s),t.quadraticCurveTo(a+l,s,a+l,s+f),"center"===o&&"right"===i&&this.drawCaret(e,t,n,r),t.lineTo(a+l,s+u-h),t.quadraticCurveTo(a+l,s+u,a+l-h,s+u),"bottom"===o&&this.drawCaret(e,t,n,r),t.lineTo(a+p,s+u),t.quadraticCurveTo(a,s+u,a,s+u-p),"center"===o&&"left"===i&&this.drawCaret(e,t,n,r),t.lineTo(a,s+d),t.quadraticCurveTo(a,s,a+d,s),t.closePath(),t.fill(),r.borderWidth>0&&t.stroke()}},{key:"_updateAnimationTarget",value:function(e){var t=this.chart,n=this.$animations,r=n&&n.x,i=n&&n.y;if(r||i){var o=oF[e.position].call(this,this._active,this._eventPosition);if(!o)return;var a=this._size=o$(this,e),s=Object.assign({},o,this._size),l=oz(t,e,s),u=oH(e,s,l,t);(r._to!==u.x||i._to!==u.y)&&(this.xAlign=l.xAlign,this.yAlign=l.yAlign,this.width=a.width,this.height=a.height,this.caretX=o.x,this.caretY=o.y,this._resolveAnimations().update(this,u))}}},{key:"_willRender",value:function(){return!!this.opacity}},{key:"draw",value:function(e){var t=this.options.setContext(this.getContext()),n=this.opacity;if(n){this._updateAnimationTarget(t);var r={width:this.width,height:this.height},i={x:this.x,y:this.y};n=.001>Math.abs(n)?0:n;var o=nZ(t.padding),a=this.title.length||this.beforeBody.length||this.body.length||this.afterBody.length||this.footer.length;t.enabled&&a&&(e.save(),e.globalAlpha=n,this.drawBackground(i,e,r,t),rk(e,t.textDirection),i.y+=o.top,this.drawTitle(i,e,t),this.drawBody(i,e,t),this.drawFooter(i,e,t),r_(e,t.textDirection),e.restore())}}},{key:"getActiveElements",value:function(){return this._active||[]}},{key:"setActiveElements",value:function(e,t){var n=this,r=this._active,i=e.map(function(e){var t=e.datasetIndex,r=e.index,i=n.chart.getDatasetMeta(t);if(!i)throw Error("Cannot find a dataset at index "+t);return{datasetIndex:t,element:i.data[r],index:r}}),o=!tN(r,i),a=this._positionChanged(i,t);(o||a)&&(this._active=i,this._eventPosition=t,this._ignoreReplayEvents=!0,this.update(!0))}},{key:"handleEvent",value:function(e,t){var n=!(arguments.length>2)||void 0===arguments[2]||arguments[2];if(t&&this._ignoreReplayEvents)return!1;this._ignoreReplayEvents=!1;var r=this.options,i=this._active||[],o=this._getActiveElements(e,i,t,n),a=this._positionChanged(o,e),s=t||!tN(o,i)||a;return s&&(this._active=o,(r.enabled||r.external)&&(this._eventPosition={x:e.x,y:e.y},this.update(!0,t))),s}},{key:"_getActiveElements",value:function(e,t,n,r){var i=this.options;if("mouseout"===e.type)return[];if(!r)return t;var o=this.chart.getElementsAtEventForMode(e,i.mode,i,n);return i.reverse&&o.reverse(),o}},{key:"_positionChanged",value:function(e,t){var n=this.caretX,r=this.caretY,i=oF[this.options.position].call(this,e,t);return!1!==i&&(n!==i.x||r!==i.y)}}]),t}((0,e5._)(iD));(0,eZ._)(oQ,"positioners",oF);var oX={id:"tooltip",_element:oQ,positioners:oF,afterInit:function(e,t,n){n&&(e.tooltip=new oQ({chart:e,options:n}))},beforeUpdate:function(e,t,n){e.tooltip&&e.tooltip.initialize(n)},reset:function(e,t,n){e.tooltip&&e.tooltip.initialize(n)},afterDraw:function(e){var t=e.tooltip;if(t&&t._willRender()){var n={tooltip:t};if(!1===e.notifyPlugins("beforeTooltipDraw",(0,m._)((0,g._)({},n),{cancelable:!0})))return;t.draw(e.ctx),e.notifyPlugins("afterTooltipDraw",n)}},afterEvent:function(e,t){if(e.tooltip){var n=t.replay;e.tooltip.handleEvent(t.event,n,t.inChartArea)&&(t.changed=!0)}},defaults:{enabled:!0,external:null,position:"average",backgroundColor:"rgba(0,0,0,0.8)",titleColor:"#fff",titleFont:{weight:"bold"},titleSpacing:2,titleMarginBottom:6,titleAlign:"left",bodyColor:"#fff",bodySpacing:2,bodyFont:{},bodyAlign:"left",footerColor:"#fff",footerSpacing:2,footerMarginTop:6,footerFont:{weight:"bold"},footerAlign:"left",padding:6,caretPadding:2,caretSize:5,cornerRadius:6,boxHeight:function(e,t){return t.bodyFont.size},boxWidth:function(e,t){return t.bodyFont.size},multiKeyBackground:"#fff",displayColors:!0,boxPadding:0,borderColor:"rgba(0,0,0,0)",borderWidth:0,animation:{duration:400,easing:"easeOutQuart"},animations:{numbers:{type:"number",properties:["x","y","width","height","caretX","caretY"]},opacity:{easing:"linear",duration:200}},callbacks:oK},defaultRoutes:{bodyFont:"font",footerFont:"font",titleFont:"font"},descriptors:{_scriptable:function(e){return"filter"!==e&&"itemSort"!==e&&"external"!==e},_indexable:!1,callbacks:{_scriptable:!1,_indexable:!1},animation:{_fallback:!1},animations:{_fallback:"animation"}},additionalOptionScopes:["interaction"]};function oJ(e){var t=this.getLabels();return e>=0&&e<t.length?t[e]:e}var oZ=function(e){function t(e){var n;return(0,eX._)(this,t),(n=(0,eQ._)(this,t,[e]))._startValue=void 0,n._valueRange=0,n._addedLabels=[],n}return(0,e2._)(t,e),(0,eJ._)(t,[{key:"init",value:function(e){var n=this._addedLabels;if(n.length){var r=this.getLabels(),i=!0,o=!1,a=void 0;try{for(var s,l=n[Symbol.iterator]();!(i=(s=l.next()).done);i=!0){var u=s.value,c=u.index,d=u.label;r[c]===d&&r.splice(c,1)}}catch(e){o=!0,a=e}finally{try{i||null==l.return||l.return()}finally{if(o)throw a}}this._addedLabels=[]}(0,e0._)((0,e1._)(t.prototype),"init",this).call(this,e)}},{key:"parse",value:function(e,t){if(tj(e))return null;var n,r,i=this.getLabels();return n=t=isFinite(t)&&i[t]===e?t:function(e,t,n,r){var i,o=e.indexOf(t);return -1===o?(i=n,"string"==typeof t?(i=e.push(t)-1,r.unshift({index:i,label:t})):isNaN(t)&&(i=null),i):o!==e.lastIndexOf(t)?n:o}(i,e,tA(t,e),this._addedLabels),r=i.length-1,null===n?null:no(Math.round(n),0,r)}},{key:"determineDataLimits",value:function(){var e=this.getUserBounds(),t=e.minDefined,n=e.maxDefined,r=this.getMinMax(!0),i=r.min,o=r.max;"ticks"===this.options.bounds&&(t||(i=0),n||(o=this.getLabels().length-1)),this.min=i,this.max=o}},{key:"buildTicks",value:function(){var e=this.min,t=this.max,n=this.options.offset,r=[],i=this.getLabels();i=0===e&&t===i.length-1?i:i.slice(e,t+1),this._valueRange=Math.max(i.length-!n,1),this._startValue=this.min-.5*!!n;for(var o=e;o<=t;o++)r.push({value:o});return r}},{key:"getLabelForValue",value:function(e){return oJ.call(this,e)}},{key:"configure",value:function(){(0,e0._)((0,e1._)(t.prototype),"configure",this).call(this),this.isHorizontal()||(this._reversePixels=!this._reversePixels)}},{key:"getPixelForValue",value:function(e){return"number"!=typeof e&&(e=this.parse(e)),null===e?NaN:this.getPixelForDecimal((e-this._startValue)/this._valueRange)}},{key:"getPixelForTick",value:function(e){var t=this.ticks;return e<0||e>t.length-1?null:this.getPixelForValue(t[e].value)}},{key:"getValueForPixel",value:function(e){return Math.round(this._startValue+this.getDecimalForPixel(e)*this._valueRange)}},{key:"getBasePixel",value:function(){return this.bottom}}]),t}(iF);function o0(e,t,n){var r=n.horizontal,i=t9(n.minRotation),o=(r?Math.sin(i):Math.cos(i))||.001,a=.75*t*(""+e).length;return Math.min(t/o,a)}(0,eZ._)(oZ,"id","category"),(0,eZ._)(oZ,"defaults",{ticks:{callback:oJ}});var o1=function(e){function t(e){var n;return(0,eX._)(this,t),(n=(0,eQ._)(this,t,[e])).start=void 0,n.end=void 0,n._startValue=void 0,n._endValue=void 0,n._valueRange=0,n}return(0,e2._)(t,e),(0,eJ._)(t,[{key:"parse",value:function(e,t){return tj(e)||("number"==typeof e||(0,e3._)(e,Number))&&!isFinite(+e)?null:+e}},{key:"handleTickRangeOptions",value:function(){var e=this.options.beginAtZero,t=this.getUserBounds(),n=t.minDefined,r=t.maxDefined,i=this.min,o=this.max,a=function(e){return i=n?i:e},s=function(e){return o=r?o:e};if(e){var l=t3(i),u=t3(o);l<0&&u<0?s(0):l>0&&u>0&&a(0)}if(i===o){var c=0===o?1:Math.abs(.05*o);s(o+c),e||a(i-c)}this.min=i,this.max=o}},{key:"getTickLimit",value:function(){var e,t=this.options.ticks,n=t.maxTicksLimit,r=t.stepSize;return r?(e=Math.ceil(this.max/r)-Math.floor(this.min/r)+1)>1e3&&(console.warn("scales.".concat(this.id,".ticks.stepSize: ").concat(r," would result generating up to ").concat(e," ticks. Limiting to 1000.")),e=1e3):(e=this.computeTickLimit(),n=n||11),n&&(e=Math.min(n,e)),e}},{key:"computeTickLimit",value:function(){return 1/0}},{key:"buildTicks",value:function(){var e=this.options,t=e.ticks,n=this.getTickLimit(),r=function(e,t){var n,r,i,o,a,s,l,u=[],c=e.bounds,d=e.step,f=e.min,p=e.max,h=e.precision,g=e.count,m=e.maxTicks,x=e.maxDigits,y=e.includeBounds,b=d||1,w=m-1,k=t.min,_=t.max,S=!tj(f),C=!tj(p),j=!tj(g),T=(_-k)/(x+1),E=t8((_-k)/w/b)*b;if(E<1e-14&&!S&&!C)return[{value:k},{value:_}];((l=Math.ceil(_/E)-Math.floor(k/E))>w&&(E=t8(l*E/w/b)*b),tj(h)||(E=Math.ceil(E*(o=Math.pow(10,h)))/o),"ticks"===c?(a=Math.floor(k/E)*E,s=Math.ceil(_/E)*E):(a=k,s=_),S&&C&&d&&(n=(p-f)/d,r=E/1e3,(i=Math.round(n))-r<=n&&i+r>=n))?(l=Math.round(Math.min((p-f)/E,m)),E=(p-f)/l,a=f,s=p):j?(a=S?f:a,E=((s=C?p:s)-a)/(l=g-1)):l=t4(l=(s-a)/E,Math.round(l),E/1e3)?Math.round(l):Math.ceil(l);var R=Math.max(t7(E),t7(a));a=Math.round(a*(o=Math.pow(10,tj(h)?R:h)))/o,s=Math.round(s*o)/o;var I=0;for(S&&(y&&a!==f?(u.push({value:f}),a<f&&I++,t4(Math.round((a+I*E)*o)/o,f,o0(f,T,e))&&I++):a<f&&I++);I<l;++I){var A=Math.round((a+I*E)*o)/o;if(C&&A>p)break;u.push({value:A})}return C&&y&&s!==p?u.length&&t4(u[u.length-1].value,p,o0(p,T,e))?u[u.length-1].value=p:u.push({value:p}):C&&s!==p||u.push({value:s}),u}({maxTicks:n=Math.max(2,n),bounds:e.bounds,min:e.min,max:e.max,precision:t.precision,step:t.stepSize,count:t.count,maxDigits:this._maxDigits(),horizontal:this.isHorizontal(),minRotation:t.minRotation||0,includeBounds:!1!==t.includeBounds},this._range||this);return"ticks"===e.bounds&&t6(r,this,"value"),e.reverse?(r.reverse(),this.start=this.max,this.end=this.min):(this.start=this.min,this.end=this.max),r}},{key:"configure",value:function(){var e=this.ticks,n=this.min,r=this.max;if((0,e0._)((0,e1._)(t.prototype),"configure",this).call(this),this.options.offset&&e.length){var i=(r-n)/Math.max(e.length-1,1)/2;n-=i,r+=i}this._startValue=n,this._endValue=r,this._valueRange=r-n}},{key:"getLabelForValue",value:function(e){return nR(e,this.chart.options.locale,this.options.ticks.format)}}]),t}(iF),o2=function(e){function t(){return(0,eX._)(this,t),(0,eQ._)(this,t,arguments)}return(0,e2._)(t,e),(0,eJ._)(t,[{key:"determineDataLimits",value:function(){var e=this.getMinMax(!0),t=e.min,n=e.max;this.min=tR(t)?t:0,this.max=tR(n)?n:1,this.handleTickRangeOptions()}},{key:"computeTickLimit",value:function(){var e=this.isHorizontal(),t=e?this.width:this.height,n=t9(this.options.ticks.minRotation),r=(e?Math.sin(n):Math.cos(n))||.001;return Math.ceil(t/Math.min(40,this._resolveTickFontOptions(0).lineHeight/r))}},{key:"getPixelForValue",value:function(e){return null===e?NaN:this.getPixelForDecimal((e-this._startValue)/this._valueRange)}},{key:"getValueForPixel",value:function(e){return this._startValue+this.getDecimalForPixel(e)*this._valueRange}}]),t}(o1);(0,eZ._)(o2,"id","linear"),(0,eZ._)(o2,"defaults",{ticks:{callback:nI.numeric}});var o3=function(e){return Math.floor(t2(e))},o4=function(e,t){return Math.pow(10,o3(e)+t)};function o8(e){return 1==e/Math.pow(10,o3(e))}function o5(e,t,n){var r=Math.pow(10,n),i=Math.floor(e/r);return Math.ceil(t/r)-i}var o6=function(e){function t(e){var n;return(0,eX._)(this,t),(n=(0,eQ._)(this,t,[e])).start=void 0,n.end=void 0,n._startValue=void 0,n._valueRange=0,n}return(0,e2._)(t,e),(0,eJ._)(t,[{key:"parse",value:function(e,t){var n=o1.prototype.parse.apply(this,[e,t]);if(0===n){this._zero=!0;return}return tR(n)&&n>0?n:null}},{key:"determineDataLimits",value:function(){var e=this.getMinMax(!0),t=e.min,n=e.max;this.min=tR(t)?Math.max(0,t):null,this.max=tR(n)?Math.max(0,n):null,this.options.beginAtZero&&(this._zero=!0),this._zero&&this.min!==this._suggestedMin&&!tR(this._userMin)&&(this.min=t===o4(this.min,0)?o4(this.min,-1):o4(this.min,0)),this.handleTickRangeOptions()}},{key:"handleTickRangeOptions",value:function(){var e=this.getUserBounds(),t=e.minDefined,n=e.maxDefined,r=this.min,i=this.max,o=function(e){return r=t?r:e},a=function(e){return i=n?i:e};r===i&&(r<=0?(o(1),a(10)):(o(o4(r,-1)),a(o4(i,1)))),r<=0&&o(o4(i,-1)),i<=0&&a(o4(r,1)),this.min=r,this.max=i}},{key:"buildTicks",value:function(){var e=this.options,t=function(e,t){var n=t.min,r=t.max;n=tI(e.min,n);for(var i=[],o=o3(n),a=function(e,t){for(var n=o3(t-e);o5(e,t,n)>10;)n++;for(;10>o5(e,t,n);)n--;return Math.min(n,o3(e))}(n,r),s=a<0?Math.pow(10,Math.abs(a)):1,l=Math.pow(10,a),u=o>a?Math.pow(10,o):0,c=Math.round((n-u)*s)/s,d=Math.floor((n-u)/l/10)*l*10,f=Math.floor((c-d)/Math.pow(10,a)),p=tI(e.min,Math.round((u+d+f*Math.pow(10,a))*s)/s);p<r;)i.push({value:p,major:o8(p),significand:f}),f>=10?f=f<15?15:20:f++,f>=20&&(f=2,s=++a>=0?1:s),p=Math.round((u+d+f*Math.pow(10,a))*s)/s;var h=tI(e.max,p);return i.push({value:h,major:o8(h),significand:f}),i}({min:this._userMin,max:this._userMax},this);return"ticks"===e.bounds&&t6(t,this,"value"),e.reverse?(t.reverse(),this.start=this.max,this.end=this.min):(this.start=this.min,this.end=this.max),t}},{key:"getLabelForValue",value:function(e){return void 0===e?"0":nR(e,this.chart.options.locale,this.options.ticks.format)}},{key:"configure",value:function(){var e=this.min;(0,e0._)((0,e1._)(t.prototype),"configure",this).call(this),this._startValue=t2(e),this._valueRange=t2(this.max)-t2(e)}},{key:"getPixelForValue",value:function(e){return((void 0===e||0===e)&&(e=this.min),null===e||isNaN(e))?NaN:this.getPixelForDecimal(e===this.min?0:(t2(e)-this._startValue)/this._valueRange)}},{key:"getValueForPixel",value:function(e){var t=this.getDecimalForPixel(e);return Math.pow(10,this._startValue+t*this._valueRange)}}]),t}(iF);function o9(e){var t=e.ticks;if(t.display&&e.display){var n=nZ(t.backdropPadding);return tA(t.font&&t.font.size,nN.font.size)+n.height}return 0}function o7(e,t,n,r,i){return e===r||e===i?{start:t-n/2,end:t+n/2}:e<r||e>i?{start:t-n,end:t}:{start:t,end:t+n}}function ae(e,t,n,r){var i=e.ctx;if(n)i.arc(e.xCenter,e.yCenter,t,0,tY);else{var o=e.getPointPosition(0,t);i.moveTo(o.x,o.y);for(var a=1;a<r;a++)o=e.getPointPosition(a,t),i.lineTo(o.x,o.y)}}(0,eZ._)(o6,"id","logarithmic"),(0,eZ._)(o6,"defaults",{ticks:{callback:nI.logarithmic,major:{enabled:!0}}});var at=function(e){function t(e){var n;return(0,eX._)(this,t),(n=(0,eQ._)(this,t,[e])).xCenter=void 0,n.yCenter=void 0,n.drawingArea=void 0,n._pointLabels=[],n._pointLabelItems=[],n}return(0,e2._)(t,e),(0,eJ._)(t,[{key:"setDimensions",value:function(){var e=this._padding=nZ(o9(this.options)/2),t=this.width=this.maxWidth-e.width,n=this.height=this.maxHeight-e.height;this.xCenter=Math.floor(this.left+t/2+e.left),this.yCenter=Math.floor(this.top+n/2+e.top),this.drawingArea=Math.floor(Math.min(t,n)/2)}},{key:"determineDataLimits",value:function(){var e=this.getMinMax(!1),t=e.min,n=e.max;this.min=tR(t)&&!isNaN(t)?t:0,this.max=tR(n)&&!isNaN(n)?n:0,this.handleTickRangeOptions()}},{key:"computeTickLimit",value:function(){return Math.ceil(this.drawingArea/o9(this.options))}},{key:"generateTickLabels",value:function(e){var t=this;o1.prototype.generateTickLabels.call(this,e),this._pointLabels=this.getLabels().map(function(e,n){var r=tD(t.options.pointLabels.callback,[e,n],t);return r||0===r?r:""}).filter(function(e,n){return t.chart.getDataVisibility(n)})}},{key:"fit",value:function(){var e=this.options;e.display&&e.pointLabels.display?function(e){for(var t={l:e.left+e._padding.left,r:e.right-e._padding.right,t:e.top+e._padding.top,b:e.bottom-e._padding.bottom},n=Object.assign({},t),r=[],i=[],o=e._pointLabels.length,a=e.options.pointLabels,s=a.centerPointLabels?tK/o:0,l=0;l<o;l++){var u,c,d=a.setContext(e.getPointLabelContext(l));i[l]=d.padding;var f=e.getPointPosition(l,e.drawingArea+i[l],s),p=n0(d.font),h=(u=e.ctx,c=tT(c=e._pointLabels[l])?c:[c],{w:function(e,t,n,r){var i,o,a,s,l,u=(r=r||{}).data=r.data||{},c=r.garbageCollect=r.garbageCollect||[];r.font!==t&&(u=r.data={},c=r.garbageCollect=[],r.font=t),e.save(),e.font=t;var d=0,f=n.length;for(i=0;i<f;i++)if(null==(s=n[i])||tT(s)){if(tT(s))for(o=0,a=s.length;o<a;o++)null==(l=s[o])||tT(l)||(d=nM(e,u,c,d,l))}else d=nM(e,u,c,d,s);e.restore();var p=c.length/2;if(p>n.length){for(i=0;i<p;i++)delete u[c[i]];c.splice(0,p)}return d}(u,p.string,c),h:c.length*p.lineHeight});r[l]=h;var g=nr(e.getIndexAngle(l)+s),m=Math.round(180/tK*g);!function(e,t,n,r,i){var o=Math.abs(Math.sin(n)),a=Math.abs(Math.cos(n)),s=0,l=0;r.start<t.l?(s=(t.l-r.start)/o,e.l=Math.min(e.l,t.l-s)):r.end>t.r&&(s=(r.end-t.r)/o,e.r=Math.max(e.r,t.r+s)),i.start<t.t?(l=(t.t-i.start)/a,e.t=Math.min(e.t,t.t-l)):i.end>t.b&&(l=(i.end-t.b)/a,e.b=Math.max(e.b,t.b+l))}(n,t,g,o7(m,f.x,h.w,0,180),o7(m,f.y,h.h,90,270))}e.setCenterPoint(t.l-n.l,n.r-t.r,t.t-n.t,n.b-t.b),e._pointLabelItems=function(e,t,n){for(var r,i=[],o=e._pointLabels.length,a=e.options,s=a.pointLabels,l=s.centerPointLabels,u=s.display,c={extra:o9(a)/2,additionalAngle:l?tK/o:0},d=0;d<o;d++){c.padding=n[d],c.size=t[d];var f=function(e,t,n){var r,i,o,a,s,l,u,c=e.drawingArea,d=n.extra,f=n.additionalAngle,p=n.padding,h=n.size,g=e.getPointPosition(t,c+d+p,f),m=Math.round(180/tK*nr(g.angle+tZ)),x=(r=g.y,i=h.h,90===(o=m)||270===o?r-=i/2:(o>270||o<90)&&(r-=i),r),y=0===(a=m)||180===a?"center":a<180?"left":"right",b=(s=g.x,l=h.w,"right"===(u=y)?s-=l:"center"===u&&(s-=l/2),s);return{visible:!0,x:g.x,y:x,textAlign:y,left:b,top:x,right:b+h.w,bottom:x+h.h}}(e,d,c);i.push(f),"auto"===u&&(f.visible=function(e,t){if(!t)return!0;var n=e.left,r=e.top,i=e.right,o=e.bottom;return!(nU({x:n,y:r},t)||nU({x:n,y:o},t)||nU({x:i,y:r},t)||nU({x:i,y:o},t))}(f,r),f.visible&&(r=f))}return i}(e,r,i)}(this):this.setCenterPoint(0,0,0,0)}},{key:"setCenterPoint",value:function(e,t,n,r){this.xCenter+=Math.floor((e-t)/2),this.yCenter+=Math.floor((n-r)/2),this.drawingArea-=Math.min(this.drawingArea/2,Math.max(e,t,n,r))}},{key:"getIndexAngle",value:function(e){return nr(e*(tY/(this._pointLabels.length||1))+t9(this.options.startAngle||0))}},{key:"getDistanceFromCenterForValue",value:function(e){if(tj(e))return NaN;var t=this.drawingArea/(this.max-this.min);return this.options.reverse?(this.max-e)*t:(e-this.min)*t}},{key:"getValueForDistanceFromCenter",value:function(e){if(tj(e))return NaN;var t=e/(this.drawingArea/(this.max-this.min));return this.options.reverse?this.max-t:this.min+t}},{key:"getPointLabelContext",value:function(e){var t=this._pointLabels||[];if(e>=0&&e<t.length){var n=t[e];return n2(this.getContext(),{label:n,index:e,type:"pointLabel"})}}},{key:"getPointPosition",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=this.getIndexAngle(e)-tZ+n;return{x:Math.cos(r)*t+this.xCenter,y:Math.sin(r)*t+this.yCenter,angle:r}}},{key:"getPointPositionForValue",value:function(e,t){return this.getPointPosition(e,this.getDistanceFromCenterForValue(t))}},{key:"getBasePosition",value:function(e){return this.getPointPositionForValue(e||0,this.getBaseValue())}},{key:"getPointLabelPosition",value:function(e){var t=this._pointLabelItems[e];return{left:t.left,top:t.top,right:t.right,bottom:t.bottom}}},{key:"drawBackground",value:function(){var e=this.options,t=e.backgroundColor,n=e.grid.circular;if(t){var r=this.ctx;r.save(),r.beginPath(),ae(this,this.getDistanceFromCenterForValue(this._endValue),n,this._pointLabels.length),r.closePath(),r.fillStyle=t,r.fill(),r.restore()}}},{key:"drawGrid",value:function(){var e,t,n,r=this,i=this.ctx,o=this.options,a=o.angleLines,s=o.grid,l=o.border,u=this._pointLabels.length;if(o.pointLabels.display&&function(e,t){for(var n=e.ctx,r=e.options.pointLabels,i=t-1;i>=0;i--){var o=e._pointLabelItems[i];if(o.visible){var a=r.setContext(e.getPointLabelContext(i));!function(e,t,n){var r=n.left,i=n.top,o=n.right,a=n.bottom,s=t.backdropColor;if(!tj(s)){var l=nJ(t.borderRadius),u=nZ(t.backdropPadding);e.fillStyle=s;var c=r-u.left,d=i-u.top,f=o-r+u.width,p=a-i+u.height;Object.values(l).some(function(e){return 0!==e})?(e.beginPath(),nq(e,{x:c,y:d,w:f,h:p,radius:l}),e.fill()):e.fillRect(c,d,f,p)}}(n,a,o);var s=n0(a.font),l=o.x,u=o.y,c=o.textAlign;nW(n,e._pointLabels[i],l,u+s.lineHeight/2,s,{color:a.color,textAlign:c,textBaseline:"middle"})}}}(this,u),s.display&&this.ticks.forEach(function(e,n){if(0!==n){t=r.getDistanceFromCenterForValue(e.value);var i,o,a,c,d,f=r.getContext(n),p=s.setContext(f),h=l.setContext(f);i=t,o=r.ctx,a=p.circular,c=p.color,d=p.lineWidth,(a||u)&&c&&d&&!(i<0)&&(o.save(),o.strokeStyle=c,o.lineWidth=d,o.setLineDash(h.dash),o.lineDashOffset=h.dashOffset,o.beginPath(),ae(r,i,a,u),o.closePath(),o.stroke(),o.restore())}}),a.display){for(i.save(),e=u-1;e>=0;e--){var c=a.setContext(this.getPointLabelContext(e)),d=c.color,f=c.lineWidth;f&&d&&(i.lineWidth=f,i.strokeStyle=d,i.setLineDash(c.borderDash),i.lineDashOffset=c.borderDashOffset,t=this.getDistanceFromCenterForValue(o.ticks.reverse?this.min:this.max),n=this.getPointPosition(e,t),i.beginPath(),i.moveTo(this.xCenter,this.yCenter),i.lineTo(n.x,n.y),i.stroke())}i.restore()}}},{key:"drawBorder",value:function(){}},{key:"drawLabels",value:function(){var e,t,n=this,r=this.ctx,i=this.options,o=i.ticks;if(o.display){var a=this.getIndexAngle(0);r.save(),r.translate(this.xCenter,this.yCenter),r.rotate(a),r.textAlign="center",r.textBaseline="middle",this.ticks.forEach(function(a,s){if(0!==s||i.reverse){var l=o.setContext(n.getContext(s)),u=n0(l.font);if(e=n.getDistanceFromCenterForValue(n.ticks[s].value),l.showLabelBackdrop){r.font=u.string,t=r.measureText(a.label).width,r.fillStyle=l.backdropColor;var c=nZ(l.backdropPadding);r.fillRect(-t/2-c.left,-e-u.size/2-c.top,t+c.width,u.size+c.height)}nW(r,a.label,0,-e,u,{color:l.color,strokeColor:l.textStrokeColor,strokeWidth:l.textStrokeWidth})}}),r.restore()}}},{key:"drawTitle",value:function(){}}]),t}(o1);(0,eZ._)(at,"id","radialLinear"),(0,eZ._)(at,"defaults",{display:!0,animate:!0,position:"chartArea",angleLines:{display:!0,lineWidth:1,borderDash:[],borderDashOffset:0},grid:{circular:!1},startAngle:0,ticks:{showLabelBackdrop:!0,callback:nI.numeric},pointLabels:{backdropColor:void 0,backdropPadding:2,display:!0,font:{size:10},callback:function(e){return e},padding:5,centerPointLabels:!1}}),(0,eZ._)(at,"defaultRoutes",{"angleLines.color":"borderColor","pointLabels.color":"color","ticks.color":"color"}),(0,eZ._)(at,"descriptors",{angleLines:{_fallback:"grid"}});var an={millisecond:{common:!0,size:1,steps:1e3},second:{common:!0,size:1e3,steps:60},minute:{common:!0,size:6e4,steps:60},hour:{common:!0,size:36e5,steps:24},day:{common:!0,size:864e5,steps:30},week:{common:!1,size:6048e5,steps:4},month:{common:!0,size:2628e6,steps:12},quarter:{common:!1,size:7884e6,steps:4},year:{common:!0,size:3154e7}},ar=Object.keys(an);function ai(e,t){return e-t}function ao(e,t){if(tj(t))return null;var n=e._adapter,r=e._parseOpts,i=r.parser,o=r.round,a=r.isoWeekday,s=t;return("function"==typeof i&&(s=i(s)),tR(s)||(s="string"==typeof i?n.parse(s,i):n.parse(s)),null===s)?null:(o&&(s="week"===o&&(t5(a)||!0===a)?n.startOf(s,"isoWeek",a):n.startOf(s,o)),+s)}function aa(e,t,n,r){for(var i=ar.length,o=ar.indexOf(e);o<i-1;++o){var a=an[ar[o]],s=a.steps?a.steps:Number.MAX_SAFE_INTEGER;if(a.common&&Math.ceil((n-t)/(s*a.size))<=r)return ar[o]}return ar[i-1]}function as(e,t,n){if(n){if(n.length){var r=ns(n,t),i=r.lo,o=r.hi;e[n[i]>=t?n[i]:n[o]]=!0}}else e[t]=!0}function al(e,t,n){var r,i,o=[],a={},s=t.length;for(r=0;r<s;++r)a[i=t[r]]=r,o.push({value:i,major:!1});return 0!==s&&n?function(e,t,n,r){var i,o,a=e._adapter,s=+a.startOf(t[0].value,r),l=t[t.length-1].value;for(i=s;i<=l;i=+a.add(i,1,r))(o=n[i])>=0&&(t[o].major=!0);return t}(e,o,a,n):o}var au=function(e){function t(e){var n;return(0,eX._)(this,t),(n=(0,eQ._)(this,t,[e]))._cache={data:[],labels:[],all:[]},n._unit="day",n._majorUnit=void 0,n._offsets={},n._normalized=!1,n._parseOpts=void 0,n}return(0,e2._)(t,e),(0,eJ._)(t,[{key:"init",value:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=e.time||(e.time={}),i=this._adapter=new r5._date(e.adapters.date);i.init(n),tF(r.displayFormats,i.formats()),this._parseOpts={parser:r.parser,round:r.round,isoWeekday:r.isoWeekday},(0,e0._)((0,e1._)(t.prototype),"init",this).call(this,e),this._normalized=n.normalized}},{key:"parse",value:function(e,t){return void 0===e?null:ao(this,e)}},{key:"beforeLayout",value:function(){(0,e0._)((0,e1._)(t.prototype),"beforeLayout",this).call(this),this._cache={data:[],labels:[],all:[]}}},{key:"determineDataLimits",value:function(){var e=this.options,t=this._adapter,n=e.time.unit||"day",r=this.getUserBounds(),i=r.min,o=r.max,a=r.minDefined,s=r.maxDefined;function l(e){a||isNaN(e.min)||(i=Math.min(i,e.min)),s||isNaN(e.max)||(o=Math.max(o,e.max))}a&&s||(l(this._getLabelBounds()),("ticks"!==e.bounds||"labels"!==e.ticks.source)&&l(this.getMinMax(!1))),i=tR(i)&&!isNaN(i)?i:+t.startOf(Date.now(),n),o=tR(o)&&!isNaN(o)?o:+t.endOf(Date.now(),n)+1,this.min=Math.min(i,o-1),this.max=Math.max(i+1,o)}},{key:"_getLabelBounds",value:function(){var e=this.getLabelTimestamps(),t=1/0,n=-1/0;return e.length&&(t=e[0],n=e[e.length-1]),{min:t,max:n}}},{key:"buildTicks",value:function(){var e=this.options,t=e.time,n=e.ticks,r="labels"===n.source?this.getLabelTimestamps():this._generate();"ticks"===e.bounds&&r.length&&(this.min=this._userMin||r[0],this.max=this._userMax||r[r.length-1]);var i=this.min,o=function(e,t,n){for(var r=0,i=e.length;r<i&&e[r]<t;)r++;for(;i>r&&e[i-1]>n;)i--;return r>0||i<e.length?e.slice(r,i):e}(r,i,this.max);return this._unit=t.unit||(n.autoSkip?aa(t.minUnit,this.min,this.max,this._getLabelCapacity(i)):function(e,t,n,r,i){for(var o=ar.length-1;o>=ar.indexOf(n);o--){var a=ar[o];if(an[a].common&&e._adapter.diff(i,r,a)>=t-1)return a}return ar[n?ar.indexOf(n):0]}(this,o.length,t.minUnit,this.min,this.max)),this._majorUnit=n.major.enabled&&"year"!==this._unit?function(e){for(var t=ar.indexOf(e)+1,n=ar.length;t<n;++t)if(an[ar[t]].common)return ar[t]}(this._unit):void 0,this.initOffsets(r),e.reverse&&o.reverse(),al(this,o,this._majorUnit)}},{key:"afterAutoSkip",value:function(){this.options.offsetAfterAutoskip&&this.initOffsets(this.ticks.map(function(e){return+e.value}))}},{key:"initOffsets",value:function(){var e,t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],r=0,i=0;this.options.offset&&n.length&&(e=this.getDecimalForValue(n[0]),r=1===n.length?1-e:(this.getDecimalForValue(n[1])-e)/2,t=this.getDecimalForValue(n[n.length-1]),i=1===n.length?t:(t-this.getDecimalForValue(n[n.length-2]))/2);var o=n.length<3?.5:.25;r=no(r,0,o),i=no(i,0,o),this._offsets={start:r,end:i,factor:1/(r+1+i)}}},{key:"_generate",value:function(){var e,t,n=this._adapter,r=this.min,i=this.max,o=this.options,a=o.time,s=a.unit||aa(a.minUnit,r,i,this._getLabelCapacity(r)),l=tA(o.ticks.stepSize,1),u="week"===s&&a.isoWeekday,c=t5(u)||!0===u,d={},f=r;if(c&&(f=+n.startOf(f,"isoWeek",u)),f=+n.startOf(f,c?"day":s),n.diff(i,r,s)>1e5*l)throw Error(r+" and "+i+" are too far apart with stepSize of "+l+" "+s);var p="data"===o.ticks.source&&this.getDataTimestamps();for(e=f,t=0;e<i;e=+n.add(e,l,s),t++)as(d,e,p);return(e===i||"ticks"===o.bounds||1===t)&&as(d,e,p),Object.keys(d).sort(ai).map(function(e){return+e})}},{key:"getLabelForValue",value:function(e){var t=this._adapter,n=this.options.time;return n.tooltipFormat?t.format(e,n.tooltipFormat):t.format(e,n.displayFormats.datetime)}},{key:"format",value:function(e,t){var n=this.options.time.displayFormats,r=this._unit,i=t||n[r];return this._adapter.format(e,i)}},{key:"_tickFormatFunction",value:function(e,t,n,r){var i=this.options,o=i.ticks.callback;if(o)return tD(o,[e,t,n],this);var a=i.time.displayFormats,s=this._unit,l=this._majorUnit,u=s&&a[s],c=l&&a[l],d=n[t],f=l&&c&&d&&d.major;return this._adapter.format(e,r||(f?c:u))}},{key:"generateTickLabels",value:function(e){var t,n,r;for(t=0,n=e.length;t<n;++t)(r=e[t]).label=this._tickFormatFunction(r.value,t,e)}},{key:"getDecimalForValue",value:function(e){return null===e?NaN:(e-this.min)/(this.max-this.min)}},{key:"getPixelForValue",value:function(e){var t=this._offsets,n=this.getDecimalForValue(e);return this.getPixelForDecimal((t.start+n)*t.factor)}},{key:"getValueForPixel",value:function(e){var t=this._offsets,n=this.getDecimalForPixel(e)/t.factor-t.end;return this.min+n*(this.max-this.min)}},{key:"_getLabelSize",value:function(e){var t=this.options.ticks,n=this.ctx.measureText(e).width,r=t9(this.isHorizontal()?t.maxRotation:t.minRotation),i=Math.cos(r),o=Math.sin(r),a=this._resolveTickFontOptions(0).size;return{w:n*i+a*o,h:n*o+a*i}}},{key:"_getLabelCapacity",value:function(e){var t=this.options.time,n=t.displayFormats,r=n[t.unit]||n.millisecond,i=this._tickFormatFunction(e,0,al(this,[e],this._majorUnit),r),o=this._getLabelSize(i),a=Math.floor(this.isHorizontal()?this.width/o.w:this.height/o.h)-1;return a>0?a:1}},{key:"getDataTimestamps",value:function(){var e,t,n=this._cache.data||[];if(n.length)return n;var r=this.getMatchingVisibleMetas();if(this._normalized&&r.length)return this._cache.data=r[0].controller.getAllParsedValues(this);for(e=0,t=r.length;e<t;++e)n=n.concat(r[e].controller.getAllParsedValues(this));return this._cache.data=this.normalize(n)}},{key:"getLabelTimestamps",value:function(){var e,t,n=this._cache.labels||[];if(n.length)return n;var r=this.getLabels();for(e=0,t=r.length;e<t;++e)n.push(ao(this,r[e]));return this._cache.labels=this._normalized?n:this.normalize(n)}},{key:"normalize",value:function(e){return nf(e.sort(ai))}}]),t}(iF);function ac(e,t,n){var r,i,o,a,s,l,u,c,d,f,p=0,h=e.length-1;n?(t>=e[p].pos&&t<=e[h].pos&&(p=(s=nl(e,"pos",t)).lo,h=s.hi),r=(l=e[p]).pos,o=l.time,i=(u=e[h]).pos,a=u.time):(t>=e[p].time&&t<=e[h].time&&(p=(c=nl(e,"time",t)).lo,h=c.hi),r=(d=e[p]).time,o=d.pos,i=(f=e[h]).time,a=f.pos);var g=i-r;return g?o+(a-o)*(t-r)/g:o}(0,eZ._)(au,"id","time"),(0,eZ._)(au,"defaults",{bounds:"data",adapters:{},time:{parser:!1,unit:!1,round:!1,isoWeekday:!1,minUnit:"millisecond",displayFormats:{}},ticks:{source:"auto",callback:!1,major:{enabled:!1}}});var ad=function(e){function t(e){var n;return(0,eX._)(this,t),(n=(0,eQ._)(this,t,[e]))._table=[],n._minPos=void 0,n._tableRange=void 0,n}return(0,e2._)(t,e),(0,eJ._)(t,[{key:"initOffsets",value:function(){var e=this._getTimestampsForTable(),n=this._table=this.buildLookupTable(e);this._minPos=ac(n,this.min),this._tableRange=ac(n,this.max)-this._minPos,(0,e0._)((0,e1._)(t.prototype),"initOffsets",this).call(this,e)}},{key:"buildLookupTable",value:function(e){var t,n,r,i=this.min,o=this.max,a=[],s=[];for(t=0,n=e.length;t<n;++t)(r=e[t])>=i&&r<=o&&a.push(r);if(a.length<2)return[{time:i,pos:0},{time:o,pos:1}];for(t=0,n=a.length;t<n;++t)Math.round((a[t+1]+a[t-1])/2)!==(r=a[t])&&s.push({time:r,pos:t/(n-1)});return s}},{key:"_generate",value:function(){var e=this.min,n=this.max,r=(0,e0._)((0,e1._)(t.prototype),"getDataTimestamps",this).call(this);return r.includes(e)&&r.length||r.splice(0,0,e),r.includes(n)&&1!==r.length||r.push(n),r.sort(function(e,t){return e-t})}},{key:"_getTimestampsForTable",value:function(){var e=this._cache.all||[];if(e.length)return e;var t=this.getDataTimestamps(),n=this.getLabelTimestamps();return e=t.length&&n.length?this.normalize(t.concat(n)):t.length?t:n,e=this._cache.all=e}},{key:"getDecimalForValue",value:function(e){return(ac(this._table,e)-this._minPos)/this._tableRange}},{key:"getValueForPixel",value:function(e){var t=this._offsets,n=this.getDecimalForPixel(e)/t.factor-t.end;return ac(this._table,n*this._tableRange+this._minPos,!0)}}]),t}(au);(0,eZ._)(ad,"id","timeseries"),(0,eZ._)(ad,"defaults",au.defaults),e.s(["ArcElement",()=>oa,"BarController",()=>rX,"BarElement",()=>ok,"BubbleController",()=>rJ,"CategoryScale",()=>oZ,"Chart",()=>on,"DoughnutController",()=>rZ,"Filler",()=>oN,"LineController",()=>r0,"LineElement",()=>oh,"LinearScale",()=>o2,"PieController",()=>r2,"PointElement",()=>om,"PolarAreaController",()=>r1,"RadarController",()=>r3,"ScatterController",()=>r4,"TimeScale",()=>au,"Title",()=>oV,"Tooltip",()=>oX,"_adapters",()=>r5],100915);var af="label";function ap(e,t){"function"==typeof e?e(t):e&&(e.current=t)}function ah(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:af,r=[];e.datasets=t.map(function(t){var i=e.datasets.find(function(e){return e[n]===t[n]});return!i||!t.data||r.includes(i)?(0,g._)({},t):(r.push(i),Object.assign(i,t),i)})}var ag=(0,o.forwardRef)(function(e,t){var n=e.height,r=e.width,i=e.redraw,a=void 0!==i&&i,s=e.datasetIdKey,l=e.type,u=e.data,c=e.options,d=e.plugins,f=void 0===d?[]:d,p=e.fallbackContent,h=e.updateMode,m=(0,x._)(e,["height","width","redraw","datasetIdKey","type","data","options","plugins","fallbackContent","updateMode"]),y=(0,o.useRef)(null),b=(0,o.useRef)(),w=function(){y.current&&(b.current=new on(y.current,{type:l,data:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:af,n={labels:[],datasets:[]};return n.labels=e.labels,ah(n,e.datasets,t),n}(u,s),options:c&&(0,g._)({},c),plugins:f}),ap(t,b.current))},k=function(){ap(t,null),b.current&&(b.current.destroy(),b.current=null)};return(0,o.useEffect)(function(){var e;!a&&b.current&&c&&(e=b.current,Object.assign(e.options,c))},[a,c]),(0,o.useEffect)(function(){!a&&b.current&&(b.current.config.data.labels=u.labels)},[a,u.labels]),(0,o.useEffect)(function(){!a&&b.current&&u.datasets&&ah(b.current.config.data,u.datasets,s)},[a,u.datasets]),(0,o.useEffect)(function(){b.current&&(a?(k(),setTimeout(w)):b.current.update(h))},[a,c,u.labels,u.datasets,h]),(0,o.useEffect)(function(){b.current&&(k(),setTimeout(w))},[l]),(0,o.useEffect)(function(){return w(),function(){return k()}},[]),o.default.createElement("canvas",Object.assign({ref:y,role:"img",height:void 0===n?150:n,width:void 0===r?300:r},m),p)});function am(e,t){return on.register(t),(0,o.forwardRef)(function(t,n){return o.default.createElement(ag,Object.assign({},t,{ref:n,type:e}))})}var av=am("line",r0),ax=am("bar",rX),ay=am("pie",r2);e.s(["Bar",()=>ax,"Line",()=>av,"Pie",()=>ay],604957);var ab=e.i(604963),aw=w.SpecializedView.span,ak=(0,y.cssRecord)({triggerWrapper:[{":focus":{outline:"2px solid ".concat(T.tokens.accentPrimaryDefault),outlineOffset:"-1px",borderRadius:"4px"}}]});function a_(e){var t=e.label,n=e.children,r=e.inline,a=(0,s._)(n,2),l=a[0],u=a[1],c=(0,s._)((0,o.useState)(!1),2),d=c[0],f=c[1],p=(0,s._)((0,o.useState)(!1),2),h=p[0],g=p[1],m=(0,o.useRef)(!1);return((0,o.useEffect)(function(){h&&(m.current=!0);var e=setTimeout(function(){f(h)},200);return function(){clearTimeout(e)}},[h]),void 0!==r&&r)?(0,i.jsxs)(w.View,{children:[l,u]}):(0,i.jsxs)(ab.PopoverTrigger,{label:t,isOpen:d,onOpenChange:function(){return f(!d)},placement:"right",offset:16,children:[(0,i.jsx)(aw,{onMouseEnter:function(){return g(!0)},onMouseLeave:function(){return g(!1)},onClick:function(){return f(!0)},onKeyDown:function(e){"Enter"===e.key&&f(!0)},tabIndex:0,css:ak.triggerWrapper,children:l}),(0,i.jsx)(aw,{onMouseEnter:function(){return g(!0)},onMouseLeave:function(){return g(!1)},children:u})]})}var aS=e.i(394212),aC=e.i(960933),aj=e.i(992785),aT=e.i(131141),aE=e.i(814563),aR=e.i(299798),aI=e.i(852819),aA=e.i(912790);function aP(e,t){var n=100*t;return e.slice(0,aV).filter(function(e){return e>=n}).length}function aD(e){return aP(e,aB)>=aF?"danger":aP(e,aL)>=aF?"warning":"ok"}function aO(e){return Math.round(10*e)/10}function aN(e){return Math.round((e+Number.EPSILON)*100)/100}function aM(e){return e/1024/1024}var aL=.9,aB=1,aV=10,aF=5,aU=aC.Type.Union([aC.Type.Literal("ok"),aC.Type.Literal("warning"),aC.Type.Literal("danger")]);aC.Type.Object({cpu:aC.Type.Object({numVCpu:aC.Type.Number(),utilPercent:aC.Type.Number(),recentUtilPercents:aC.Type.Array(aC.Type.Number()),status:aU,user:aC.Type.Object({utilPercent:aC.Type.Number(),recentUtilPercents:aC.Type.Array(aC.Type.Number())}),system:aC.Type.Object({utilPercent:aC.Type.Number(),recentUtilPercents:aC.Type.Array(aC.Type.Number())})}),memory:aC.Type.Object({softLimitBytes:aC.Type.Number(),hardLimitBytes:aC.Type.Number(),usageBytes:aC.Type.Number(),recentUtilPercents:aC.Type.Array(aC.Type.Number()),status:aU,rss:aC.Type.Object({usageBytes:aC.Type.Number(),recentUtilPercents:aC.Type.Array(aC.Type.Number())}),cache:aC.Type.Object({usageBytes:aC.Type.Number(),recentUtilPercents:aC.Type.Array(aC.Type.Number())})}),storage:aC.Type.Object({usedBytes:aC.Type.Number(),totalBytes:aC.Type.Number(),scratchUsedBytes:aC.Type.Number(),scratchTotalBytes:aC.Type.Number(),nixUsedBytes:aC.Type.Number(),workspaceUsedBytes:aC.Type.Number()})});var aG={cpu:{numVCpu:0,utilPercent:0,recentUtilPercents:Array(20).fill(0),status:"ok",user:{utilPercent:0,recentUtilPercents:Array(20).fill(0)},system:{utilPercent:0,recentUtilPercents:Array(20).fill(0)}},memory:{softLimitBytes:0,hardLimitBytes:0,usageBytes:0,recentUtilPercents:Array(20).fill(0),status:"ok",rss:{usageBytes:0,recentUtilPercents:Array(20).fill(0)},cache:{usageBytes:0,recentUtilPercents:Array(20).fill(0)}},storage:{usedBytes:0,totalBytes:0,scratchUsedBytes:0,scratchTotalBytes:0,nixUsedBytes:0,workspaceUsedBytes:0}},a$=(0,W.atom)(aG),az=(0,W.atom)(!0);function aH(){return(0,aI.useValue)(az)}var aW=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return Math.min(t?Math.round(e):e,100)};function aq(e,t){e.unshift(t),e.pop()}var aK=(0,W.atom)(null,function(e,t,n){t(a$,function(e){return(0,aT.produce)(e,function(e){var t,r,i,o,a,s,l,u,c,d,f,p,h,g;l=e.cpu,u=e.memory,c=e.storage,l.numVCpu=n.numVCpu,l.utilPercent=aW(n.cpuUtilizationPercent,!0),l.recentUtilPercents.unshift(l.utilPercent),l.status=aD(l.recentUtilPercents),d=l.user,f=l.system,d.utilPercent=aW(n.user.cpuUtilizationPercent),aq(d.recentUtilPercents,d.utilPercent),f.utilPercent=aW(n.system.cpuUtilizationPercent),aq(f.recentUtilPercents,f.utilPercent),u.softLimitBytes=n.memorySoftLimitBytes,u.hardLimitBytes=n.memoryHardLimitBytes,u.usageBytes=n.memoryUsageRssBytes,p=u.usageBytes/u.softLimitBytes*100,aq(u.recentUtilPercents,p),u.status=aD(u.recentUtilPercents),h=u.rss,g=u.cache,h.usageBytes=n.memoryUsageRssBytes,aq(h.recentUtilPercents,n.memoryUsageRssBytes/n.memorySoftLimitBytes*100),g.usageBytes=n.memoryUsageCacheBytes,aq(g.recentUtilPercents,n.memoryUsageCacheBytes/n.memorySoftLimitBytes*100),c.usedBytes=(null==(t=n.storage)?void 0:t.diskUsedBytes)||0,c.totalBytes=(null==(r=n.storage)?void 0:r.diskLimitBytes)||0x40000000,c.scratchUsedBytes=(null==(i=n.storage)?void 0:i.scratchDiskUsedBytes)||0,c.scratchTotalBytes=(null==(o=n.storage)?void 0:o.scratchDiskLimitBytes)||0x40000000,c.nixUsedBytes=(null==(a=n.storage)?void 0:a.diskUsedNixBytes)||0,c.workspaceUsedBytes=(null==(s=n.storage)?void 0:s.diskUsedWorkspaceBytes)||0})})}),aY=(0,aE.selectAtom)(a$,function(e){return"ok"!==e.cpu.status?e.cpu.status:null}),aQ=(0,aE.selectAtom)(a$,function(e){return"ok"!==e.memory.status?e.memory.status:null}),aX=(0,W.atom)(function(e){var t=e(aQ);if(t)return{type:"ram_alert",status:t};var n=e(aY);return n?{type:"cpu_alert",status:n}:null});function aJ(){return(0,aI.useObservableValue)(aX)}(0,W.atom)(function(e){for(var t=e(a$),n=t.cpu,r=t.memory,i=0,o=["danger","warning"];i<o.length;i++){var a=o[i];if(n.status===a||r.status===a)return"danger"}return"ok"});var aZ=(0,aE.selectAtom)(a$,function(e){var t=aO((0,aA.bytesToGib)(e.memory.softLimitBytes));return{numVCpu:aO(e.cpu.numVCpu),ramTotalGB:t}},aj.default);function a0(){return(0,aI.useValue)(aZ)}var a1=(0,aE.selectAtom)(a$,function(e){var t=e.cpu,n=t.status,r=t.recentUtilPercents,i=t.user,o=t.system,a=aN(t.utilPercent),s=aN(i.utilPercent),l=aN(o.utilPercent);return{status:n,currentPercent:a,recentUtilPercents:r,currentUserPercent:s,recentUserUtilPercents:i.recentUtilPercents,currentSystemPercent:l,recentSystemUtilPercents:o.recentUtilPercents}},aj.default);function a2(){return(0,aI.useValue)(a1)}var a3=(0,aE.selectAtom)(a$,function(e){var t=e.memory,n=t.status,r=t.recentUtilPercents,i=t.cache,o=t.rss,a=t.softLimitBytes,s=t.usageBytes,l=aM(a);return{status:n,currentPercent:Math.round(100*Math.min(1,Math.round(aN(aM(s)))/l)),currentRssInBytes:1024*Math.round(aN(aM(o.usageBytes)))*1024,currentCacheInBytes:1024*Math.round(aN(aM(i.usageBytes)))*1024,recentUtilPercents:r,recentRssUtilPercents:o.recentUtilPercents,recentCacheUtilPercents:i.recentUtilPercents}},aj.default);function a4(){return(0,aI.useValue)(a3)}var a8=(0,aE.selectAtom)(a$,function(e){var t=e.storage;return{replUsedInMib:aM(t.usedBytes),replTotalInMib:aM(t.totalBytes),scratchUsedInMib:aM(t.scratchUsedBytes),scratchTotalInMib:aM(t.scratchTotalBytes),nixUsedInMib:aM(t.nixUsedBytes),workspaceUsedInMib:aM(t.workspaceUsedBytes)}},aj.default);function a5(){return(0,aI.useValue)(a8)}var a6=(0,aE.selectAtom)(a$,function(e){var t=e.cpu,n=e.memory;return{numVCpu:t.numVCpu,ramQuotaMiBs:aM(n.softLimitBytes),cpuRecentUtilPercents:t.recentUtilPercents,ramRecentUtilPercents:n.recentUtilPercents}},aj.default);function a9(){return(0,aI.useValue)(a6)}function a7(){var e=(0,aI.useSet)(az),t=(0,aI.useSet)(aK),n=(0,o.useRef)(!0),r=(0,o.useCallback)(function(r){t(r),n.current?n.current=!1:e(!1)},[t,e]);(0,aR.usePid2)(function(e,t){var n=t.signal;return(0,P._)(function(){var t,i,o,a,s,l,u,c;return(0,D._)(this,function(d){switch(d.label){case 0:t=e.resources.monitor.subscribe({},{signal:n}).resReadable,i=!1,o=!1,d.label=1;case 1:d.trys.push([1,6,7,12]),s=(0,aS._)(t),d.label=2;case 2:return[4,s.next()];case 3:if(!(i=!(l=d.sent()).done))return[3,5];if(!(u=l.value).ok)return[2];r(u.payload),d.label=4;case 4:return i=!1,[3,2];case 5:return[3,12];case 6:return c=d.sent(),o=!0,a=c,[3,12];case 7:if(d.trys.push([7,,10,11]),!(i&&null!=s.return))return[3,9];return[4,s.return()];case 8:d.sent(),d.label=9;case 9:return[3,11];case 10:if(o)throw a;return[7];case 11:return[7];case 12:return[2]}})})()},[r])}(0,aE.selectAtom)(a$,function(e){return e.cpu.numVCpu}),(0,aE.selectAtom)(a$,function(e){return aM(e.memory.softLimitBytes)}),(0,aE.selectAtom)(a$,function(e){return aM(e.storage.totalBytes)}),(0,aE.selectAtom)(a$,function(e){return aM(e.storage.usedBytes)}),e.s(["ALERTING_WINDOW_SECONDS",()=>20,"COUNT_TO_ALERT_AT",()=>aF,"DANGER_THRESHOLD",()=>aB,"WARNING_THRESHOLD",()=>aL,"useAccountUsage",()=>a5,"useAlertObservable",()=>aJ,"useCompute",()=>a0,"useComputeAlertData",()=>a9,"useComputeCpu",()=>a2,"useComputeRam",()=>a4,"useInitResouceMonitoring",()=>a7,"useResourcesLoading",()=>aH],154488);var se=e.i(703774);function st(e){return e>eW.ONE_GIB_IN_BYTES?"".concat((0,aA.bytesToGib)(e).toLocaleString(void 0,{maximumFractionDigits:1})," GiB"):"".concat(Math.round((0,aA.bytesToMib)(e)).toLocaleString()," MiB")}on.register(oh,oN);var sn=(0,y.cssRecord)({sectionPadding:[b.rcss.py(4),b.rcss.px(12)],rowSpacing:[b.rcss.rowWithGap(8),b.rcss.justify.spaceBetween,b.rcss.align.center]}),sr=(0,y.cssRecord)({wrapper:[b.rcss.borderRadius(4),b.rcss.border({color:T.tokens.outlineDimmer}),b.rcss.overflow("hidden")],rowSection:[sn.sectionPadding,sn.rowSpacing],hoverRowSection:[sn.sectionPadding,sn.rowSpacing,{":hover":{backgroundColor:T.tokens.backgroundHigher}}],hoverColumnSection:[sn.sectionPadding,b.rcss.colWithGap(8),{":hover":{backgroundColor:T.tokens.backgroundHigher}}],sectionHeading:[b.rcss.fontWeight.bold],alignedRow:[b.rcss.rowWithGap(8),b.rcss.align.center],alignedSpaceBetweenRow:[sn.rowSpacing],detailContent:[b.rcss.width(260)],detailSectionsWrapper:[b.rcss.borderRadius(4),b.rcss.border({color:T.tokens.outlineDimmer}),b.rcss.overflow("hidden")],warningText:[b.rcss.color.orangeStronger],dangerText:[b.rcss.color.redStronger],chartWrapper:[b.rcss.width(22),b.rcss.height(18),b.rcss.borderRadius(2)],indentAgain:[b.rcss.pl(24)]});function si(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.inline,n=void 0!==t&&t,r=a0();return(0,i.jsxs)(w.View,{css:sr.wrapper,children:[(0,i.jsxs)(w.View,{css:sr.rowSection,children:[(0,i.jsx)(R.Text,{css:sr.sectionHeading,children:"Compute"}),(0,i.jsx)(w.View,{css:sr.alignedRow,children:(0,i.jsxs)(R.Text,{color:"dimmer",children:[r.numVCpu," vCPU, ",r.ramTotalGB," GiB RAM"]})})]}),(0,i.jsx)(el.DividerH,{}),(0,i.jsx)(so,{inline:n}),(0,i.jsx)(sa,{inline:n})]})}function so(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.inline,n=a2();return(0,i.jsx)(ss,{title:"CPU",displayValue:"".concat(n.currentPercent,"%"),recentPercents:n.recentUtilPercents,status:n.status,detailText:"The amount of processing power this Repl is using.",detailRows:[{title:"User",displayValue:"".concat(n.currentUserPercent,"%"),recentPercents:n.recentUserUtilPercents},{title:"System",displayValue:"".concat(n.currentSystemPercent,"%"),recentPercents:n.recentSystemUtilPercents}],inline:void 0!==t&&t})}function sa(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.inline,n=a4();return(0,i.jsx)(ss,{title:"RAM",displayValue:"".concat(n.currentPercent,"%"),recentPercents:n.recentUtilPercents,status:n.status,detailText:"The memory this Repl is using.",detailRows:[{title:"Active",displayValue:st(n.currentRssInBytes),recentPercents:n.recentRssUtilPercents},{title:"Cache",displayValue:st(n.currentCacheInBytes),recentPercents:n.recentCacheUtilPercents}],inline:void 0!==t&&t})}function ss(e){var t=e.title,n=e.displayValue,r=e.status,o=e.recentPercents,a=e.detailText,s=e.detailRows,l=e.inline,u=void 0!==l&&l;return(0,i.jsxs)(a_,{label:"Compute details",inline:u,children:[(0,i.jsxs)(w.View,{css:u?sr.rowSection:sr.hoverRowSection,children:[(0,i.jsxs)(w.View,{css:sr.alignedRow,children:[(0,i.jsx)(R.Text,{children:t}),(0,i.jsx)(sl,{status:r})]}),(0,i.jsxs)(w.View,{css:sr.alignedRow,children:[(0,i.jsx)(R.Text,{color:"dimmer",children:n}),(0,i.jsx)(w.View,{css:sr.chartWrapper,children:(0,i.jsx)(su,{data:o,colorAreaUnderLine:!0})})]})]}),(0,i.jsxs)(w.View,{px:u?12:void 0,children:[(0,i.jsx)(R.Text,{variant:u?"small":void 0,color:u?"dimmer":void 0,children:a}),(0,i.jsx)(w.View,{children:s.map(function(e,t){return(0,i.jsxs)(w.View,{css:sr.rowSection,style:u?{paddingLeft:0,paddingRight:0}:void 0,children:[(0,i.jsx)(R.Text,{children:e.title}),(0,i.jsxs)(w.View,{css:sr.alignedRow,children:[(0,i.jsx)(R.Text,{color:"dimmer",children:e.displayValue}),(0,i.jsx)(w.View,{css:sr.chartWrapper,children:(0,i.jsx)(su,{data:e.recentPercents,colorAreaUnderLine:!0})})]})]},t)})})]})]})}function sl(e){var t=e.status;return"warning"===t?(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(ek.default,{color:T.tokens.orangeStronger}),(0,i.jsx)(R.Text,{css:sr.warningText,children:"Near limit"})]}):"danger"===t?(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(ek.default,{color:T.tokens.redStronger}),(0,i.jsx)(R.Text,{css:sr.dangerText,children:"At limit"})]}):null}function su(e){var t=e.data,n=e.colorAreaUnderLine,r=void 0!==n&&n,o=e.showHorizontalGridLines,a=(0,se.useTheme)().values,s=t.map(function(e,t){return{x:-t,y:e}}),l=aL-.05,u=aB-.02;return(0,i.jsx)(av,{updateMode:"none",options:{clip:4,animation:!1,maintainAspectRatio:!1,events:[],elements:{point:{radius:0},line:{tension:.3,borderWidth:1}},scales:{x:{display:!1,type:"linear",grid:{display:!1},min:0,max:-(t.length-1)},y:{display:void 0!==o&&o,min:0,max:100,ticks:{display:!1,stepSize:10},afterBuildTicks:function(e){var t=[10,50,90];e.ticks=e.ticks.filter(function(e){return t.includes(e.value)})},grid:{color:function(e){return e.tick.value>100*l?a.global.orangeDimmer:a.global.outlineDimmest},drawTicks:!1},border:{dash:[2,2],display:!1}}}},data:{datasets:[{data:s,fill:{target:"origin"},borderColor:function(e){var t=e.chart,n=t.ctx,r=t.chartArea;if(r){var i=n.createLinearGradient(0,r.bottom,0,r.top),o=a.global.blueDefault,s=a.global.orangeDefault,c=a.global.redDefault;return i.addColorStop(0,o),i.addColorStop(l-.08,o),i.addColorStop(l+.08,s),i.addColorStop(u-.08,s),i.addColorStop(u,c),i}},backgroundColor:function(e){if(!r)return"transparent";var n=e.chart,i=n.ctx,o=n.chartArea;if(o){var c=i.createLinearGradient(o.left,0,o.right,0),d=sc(a.global.blueDimmest),f=sc(a.global.orangeDimmest),p=sc(a.global.redDimmest);return s.forEach(function(e,n){if(c){var r=1-n/(t.length-1);e.y<100*l?c.addColorStop(r,d):e.y<100*u?c.addColorStop(r,f):c.addColorStop(r,p)}}),c}}}]}})}function sc(e){var t,n,r=(t=(t=e).replace(/^#?([a-f\d])([a-f\d])([a-f\d])$/i,function(e,t,n,r){return t+t+n+n+r+r}),(n=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(t))?{r:parseInt(n[1],16),g:parseInt(n[2],16),b:parseInt(n[3],16)}:null);if(!r)return e;var i=r.r,o=r.g,a=r.b;return"rgba(".concat(i,", ").concat(o,", ").concat(a,", ",.5,")")}function sd(e){var t=e.alertDialogType,n=e.onRequestUpgrade,r=a9();if(!r)return null;var o="cpu_alert"===t?r.cpuRecentUtilPercents:r.ramRecentUtilPercents,a="cpu_alert"===t?"CPU":"RAM",s="You have been near the ".concat("cpu_alert"===t?"".concat(r.numVCpu," vCPU"):"".concat((0,aA.bytesToGib)(1024*r.ramQuotaMiBs*1024)," GiB RAM")," limit of the free plan ").concat(aF," or more times in the past ").concat(20," seconds. More ").concat("cpu_alert"===t?"vCPUs":"RAM"," would improve performance and limit disruptions.");return(0,i.jsxs)(w.View,{p:8,gap:8,children:[(0,i.jsx)(ek.default,{color:T.tokens.orangeStrongest}),(0,i.jsxs)(R.Text,{variant:"subheadDefault",multiline:!1,children:["High ",a," usage"]}),(0,i.jsx)(R.Text,{color:"dimmer",children:s}),(0,i.jsx)(w.View,{css:sf.chartWrapper,children:(0,i.jsx)(su,{data:o,showHorizontalGridLines:!0})}),(0,i.jsx)(es.Button,{size:"big",colorway:"warning",text:"Increase ".concat(a," limit"),onClick:function(){(0,eK.track)(eY.events.UPGRADE_SELECTED,{source:"compute_alert_dialog"}),n()}})]})}var sf=(0,y.cssRecord)({chartWrapper:[b.rcss.height(67),b.rcss.backgroundColor.backgroundRoot,b.rcss.borderRadius(12),b.rcss.py(12),b.rcss.px(16)]});function sp(){var e=(0,O._)(["\n  query ReplResourcesCurrentUser {\n    currentUser {\n      __typename\n      ... on CurrentUser {\n        id\n        userSubscriptionType\n        userSubscription {\n          isTrial\n        }\n        paymentMethod {\n          __typename\n          ... on PaymentMethod {\n            id\n            last4\n          }\n        }\n      }\n    }\n  }\n"]);return sp=function(){return e},e}function sh(){var e=(0,O._)(["\n  query ReplResourcesReplInfo($replId: String!) {\n    getRepl(id: $replId) {\n      __typename\n      ... on Repl {\n        id\n        org {\n          __typename\n          id\n          type\n        }\n        owner {\n          __typename\n          ... on Team {\n            id\n          }\n          ... on User {\n            id\n          }\n        }\n        authorizations {\n          editResources {\n            isAuthorized\n            code\n            message\n          }\n          editFileContents {\n            isAuthorized\n            code\n            message\n          }\n        }\n      }\n    }\n  }\n"]);return sh=function(){return e},e}var sg={},sm=(0,N.gql)(sp()),sv=(0,N.gql)(sh()),sx=e.i(758386),sy=e.i(158689),sb=function(){var e=(0,sx.useUpsellContext)(),t=e.showResourcesUpsell,n=e.refetch,r=(0,eq.useGlobalModal)().show;return t?(0,i.jsx)(er.Tooltip,{tooltip:sw,children:(0,i.jsx)(sy.Pill,{css:sk.pill,text:"CPU/RAM Limited",onClick:function(){return(0,P._)(function(){return(0,D._)(this,function(e){switch(e.label){case 0:return[4,r("MembershipPurchaseModal",{headingText:"Upgrade for a faster Workspace",subHeadingText:"Unlock 4 vCPU, 8 GiB RAM, and ".concat((0,aA.bytesToGib)(eW.PRO_PLAN_STORAGE_QUOTA)," GiB of storage"),analyticsContext:{upgrade:{context:"repl_resources"}},onPurchaseComplete:function(){return n()}})];case 1:return e.sent(),[2]}})})()}})}):null},sw="Your development resources are limited. Upgrade for more speed, storage, better AI, and more.",sk=(0,y.cssRecord)({pill:[b.rcss.cursor.pointer]}),s_=e.i(739521),sS=e.i(557862),sC=e.i(857714);function sj(e){return e>eW.ONE_GIB_IN_BYTES?"".concat((0,aA.bytesToGib)(e).toLocaleString(void 0,{maximumFractionDigits:1})," GiB"):"".concat(Math.round((0,aA.bytesToMib)(e)).toLocaleString()," MiB")}function sT(e,t){return 0===t||0===e?0:Math.round(e/t*100)}function sE(e){var t=e.isFileEditor,n=e.inline;return t?(0,i.jsxs)(w.View,{css:sr.wrapper,children:[(0,i.jsx)(w.View,{css:sr.rowSection,children:(0,i.jsx)(R.Text,{css:sr.sectionHeading,children:"Storage"})}),(0,i.jsx)(el.DividerH,{}),(0,i.jsx)(sR,{inline:void 0!==n&&n})]}):null}function sR(e){var t=e.inline,n=void 0!==t&&t,r=(0,s._)((0,o.useState)(!1),2),a=r[0],l=r[1],u=a5(),c=u.replUsedInMib,d=u.replTotalInMib,f=u.scratchUsedInMib,p=u.scratchTotalInMib,h=u.nixUsedInMib,g=u.workspaceUsedInMib,m=[{title:"This App",usageDisplayText:"".concat(sj(1024*c*1024)),percentOfUsage:sT(1024*c*1024,1024*d*1024),indent:0},{title:"Workspace",usageDisplayText:"".concat(sj(1024*g*1024)),percentOfUsage:null,indent:1},{title:"Nix packages",usageDisplayText:"".concat(sj(1024*h*1024)),percentOfUsage:null,nix:!0,indent:1},{title:"Scratch disk",usageDisplayText:"".concat(sj(1024*f*1024)),percentOfUsage:sT(1024*f*1024,1024*p*1024),indent:0}],x=(0,i.jsx)(i.Fragment,{children:m.map(function(e,t){return(0,i.jsxs)(w.View,{css:sr.rowSection,children:[(0,i.jsxs)(w.View,{css:sr.alignedRow,children:[e.indent>0?(0,i.jsx)(w.View,{css:e.indent>1&&sr.indentAgain,children:(0,i.jsx)(sC.default,{color:T.tokens.outlineDefault,size:16})}):null,(0,i.jsx)(R.Text,{children:e.title})]}),e.nix?(0,i.jsx)(w.View,{css:sr.alignedRow,style:n?{marginRight:"auto"}:void 0,children:(0,i.jsx)(eu.IconButton,{onClick:function(){return l(!0)},alt:"Delete Nix packages",disabled:h<1,children:(0,i.jsx)(eb.default,{})})}):null,(0,i.jsxs)(w.View,{css:sr.alignedRow,children:[(0,i.jsx)(R.Text,{color:"dimmer",children:e.usageDisplayText}),null===e.percentOfUsage?null:(0,i.jsxs)(R.Text,{color:"dimmer",children:["(",e.percentOfUsage,"%)"]})]})]},t)})});return(0,i.jsxs)(i.Fragment,{children:[n?x:(0,i.jsxs)(a_,{label:"Storage details",children:[(0,i.jsx)(w.View,{css:sr.hoverColumnSection,children:(0,i.jsxs)(w.View,{css:sr.alignedSpaceBetweenRow,children:[(0,i.jsx)(w.View,{css:sr.alignedRow,children:(0,i.jsx)(R.Text,{children:"This App"})}),(0,i.jsxs)(R.Text,{color:"dimmer",children:[sj(1024*c*1024)," "]})]})}),(0,i.jsxs)(w.View,{p:8,gap:8,css:sr.detailContent,children:[(0,i.jsx)(R.Text,{children:"This App's storage usage"}),(0,i.jsx)(w.View,{css:sr.detailSectionsWrapper,children:x})]})]}),(0,i.jsx)(sI,{isOpen:a,onClose:function(){return l(!1)}})]})}var sI=function(e){var t=e.onClose,n=e.isOpen,r=(0,a.default)().container;return(0,i.jsx)(s_.Modal,{isOpen:n,onRequestClose:t,children:(0,i.jsx)(sS.default,{name:"Nix Packages",description:"this App's Nix packages",confirmDescription:"Nix packages",hideModal:t,delete:function(){t();var e=r.openChannel({service:"file",skip:function(e){return!e.repl.authorizations.editFileContents.isAuthorized}},function(t){return t.channel.request({resetNixFilesystem:{}}).then(function(t){t.ok&&e()}),function(){}})}})})},sA=e.i(624782),sP=e.i(33914),sD=e.i(940745),sO=(0,y.cssRecord)({trialButton:[b.rcss.borderRadius(4)],loadingStateWrapper:[b.rcss.center,b.rcss.p(16)]});function sN(e){var t,n,r,o,a,s,l,u,c,d,f,p,h,m,x,y,k,_,S=e.onRequestUpgrade,C=e.inline,j=void 0!==C&&C,T=(a=(0,g._)({},sg,void 0),M.useQuery(sm,a)),E=T.data,I=T.loading,A=(s={variables:{replId:(0,H.default)()}},l=(0,g._)({},sg,s),M.useQuery(sv,l)),P=A.data,D=A.loading,O=(null==P?void 0:P.getRepl.__typename)==="Repl"?P.getRepl:null,N=(null==O||null==(u=O.org)?void 0:u.id)!==void 0&&(null==O||null==(c=O.org)?void 0:c.type)==="team",L=(null==O||null==(d=O.owner)?void 0:d.__typename)==="Team"||N,B=(null==O||null==(f=O.owner)?void 0:f.id)===(null==E||null==(p=E.currentUser)?void 0:p.id),V=null==E||null==(h=E.currentUser)?void 0:h.userSubscriptionType,F=(null==E||null==(x=E.currentUser)||null==(m=x.paymentMethod)?void 0:m.__typename)==="PaymentMethod"&&null!==E.currentUser.paymentMethod.id,U=null==E||null==(k=E.currentUser)||null==(y=k.userSubscription)?void 0:y.isTrial,G=B&&("HACKER_PRO"!==V||U&&!F)&&!N,z=(0,sx.useUpsellContext)().showResourcesUpsell,W=null==O?void 0:O.authorizations.editResources,q=null!=(_=null==O?void 0:O.authorizations.editFileContents.isAuthorized)&&_,K=aH();return I||D||K||!W?(0,i.jsx)(w.View,{css:sO.loadingStateWrapper,children:(0,i.jsx)(sD.default,{})}):(0,i.jsxs)(w.View,{p:8,gap:8,children:[(0,i.jsxs)(w.View,{gap:4,children:[(0,i.jsxs)(w.View,{row:!0,gap:8,children:[(0,i.jsx)(R.Text,{variant:"subheadDefault",children:"Resources"}),(0,i.jsx)(sM,{resourceTier:(n=(t={isTeamRepl:L,isReplOwner:B,plan:V}).isTeamRepl,r=t.isReplOwner,o=t.plan,n?"team":r&&"HACKER_PRO"===o?"member":r&&null===o?"free":"hidden"),isOnTrial:U,showResourcesUpsell:z})]}),(0,i.jsx)(R.Text,{color:"dimmest",children:"Resources for cloud development environment"})]}),(0,i.jsx)(si,{inline:j}),!N||q?(0,i.jsx)(sE,{isFileEditor:q,inline:j}):null,G?(0,i.jsxs)(w.View,{gap:8,children:[(0,i.jsx)(es.Button,{colorway:"blurple",iconLeft:(0,i.jsx)(sP.default,{}),text:"Join Replit ".concat($.corePlanName),onClick:function(){return S()},css:sO.trialButton}),(0,i.jsxs)(R.Text,{css:b.rcss.textAlign.center,color:"dimmer",variant:"small",children:["Get 4 vCPU, 8 GiB RAM, and ",(0,aA.bytesToGib)(eW.PRO_PLAN_STORAGE_QUOTA)," GiB Storage"]})]}):null]})}function sM(e){var t=e.resourceTier,n=e.isOnTrial,r=e.showResourcesUpsell;switch(t){case"free":return r?(0,i.jsx)(sb,{}):(0,i.jsx)(sA.Pill,{text:"Free",colorway:"grey"});case"member":if(n)return(0,i.jsx)(sA.Pill,{text:"".concat($.corePlanName," Trial"),colorway:"blue"});return(0,i.jsx)(sA.Pill,{text:"".concat($.corePlanName),colorway:"purple"});case"team":return(0,i.jsx)(sA.Pill,{text:"Team",colorway:"green"});default:return null}}var sL=e.i(399528),sB=e.i(441329),sV=e.i(806804),sF=e.i(729122);function sU(e){var t,n,r,a,l,u,c,d,f,p,h,g,m,x,y,b,k,_,S,C,j=e.repl,T=e.currentUser,E=e.inline,R=(0,s._)((0,o.useState)("resources"),2),I=R[0],A=R[1],O=(0,eq.useGlobalModal)().show,N=(r=(t={repl:j,currentUser:T,onAlert:function(e){A(e)}}).repl,a=t.currentUser,l=t.onAlert,u=aJ(),c=(0,sL.useRouter)(),f=(d=(0,s._)((0,o.useState)(!1),2))[0],p=d[1],h=(null==(n=r.owner)?void 0:n.__typename)==="User"&&r.owner.id===(null==a?void 0:a.id),g=null==a?void 0:a.userSubscriptionType,x=(m=(0,sV.default)("announcement","resources-upgrade-modal")).shouldDisplay,y=m.register,b=m.dismiss,(0,o.useEffect)(function(){!(0,sB.isInBonsaiWebview)(c)&&h&&null===g&&y()},[h,y,c,g]),_=(k=(0,s._)((0,o.useState)(!0),2))[0],S=k[1],(0,o.useEffect)(function(){var e=setTimeout(function(){S(!1)},6e4);return function(){return clearTimeout(e)}},[]),C=(0,sF.useRunInfo)().isRunning,(0,o.useEffect)(function(){!f&&C&&(f||p(!0))},[C,f]),(0,o.useEffect)(function(){if(!(_||(0,sB.isInBonsaiWebview)(c))&&x&&f)return u.subscribe(function(e){e&&l(e.type)})},[u,y,_,h,l,c,x,g,f]),{dismissAlert:b}).dismissAlert,M=function(){return(0,P._)(function(){return(0,D._)(this,function(e){switch(e.label){case 0:return[4,O("MembershipPurchaseModal",{headingText:"Upgrade for a faster Workspace",subHeadingText:"Unlock 4 vCPU, 8 GiB RAM, and ".concat((0,aA.bytesToGib)(eW.PRO_PLAN_STORAGE_QUOTA)," GiB of storage"),analyticsContext:{upgrade:{context:"repl_resources"}}})];case 1:return e.sent(),[2]}})})()};return(0,i.jsx)(i.Fragment,{children:(0,i.jsxs)(w.View,{css:{overflow:"auto",maxHeight:"80vh"},children:["resources"===I?(0,i.jsx)(sN,{onRequestUpgrade:M,inline:void 0!==E&&E}):null,"cpu_alert"===I||"ram_alert"===I?(0,i.jsxs)(w.View,{css:sG.alertDialogWrapper,children:[(0,i.jsx)(eu.IconButton,{onClick:function(){N(),A("resources")},alt:"Close",css:sG.alertDialogCloseButton,children:(0,i.jsx)(eh.default,{})}),(0,i.jsx)(sd,{alertDialogType:I,onRequestUpgrade:M})]}):null]})})}var sG=(0,y.cssRecord)({alertDialogWrapper:[b.rcss.position.relative],alertDialogCloseButton:[b.rcss.position.absolute,b.rcss.top(8),b.rcss.right(8),b.rcss.zIndex(1)]}),s$={label:"Resources",description:"Monitor CPU, memory usage and upgrade resources",icon:(0,i.jsx)(ev.default,{}),component:function(){var e,t,n=(e={variables:{replId:(0,H.default)()}},t=(0,g._)({},eG,e),M.useQuery(eH,t)).data,r=(null==n?void 0:n.getRepl.__typename)==="Repl"?n.getRepl:null,o=null==n?void 0:n.currentUser;return r&&o?(0,i.jsx)(sU,{repl:r,currentUser:o,inline:!0}):(0,i.jsx)(w.View,{p:32,children:(0,i.jsx)(sD.default,{})})}};function sz(){var e=(0,O._)(["\n  query SshPane($replId: String!) {\n    getRepl(id: $replId) {\n      ... on Repl {\n        id\n        authorizations {\n          connectUsingSsh {\n            isAuthorized\n            message\n            code\n          }\n        }\n        org {\n          id\n          type\n        }\n      }\n      ... on ReplRedirect {\n        replUrl\n      }\n    }\n  }\n"]);return sz=function(){return e},e}function sH(){var e=(0,O._)(["\n  query SshPaneCurrentUser {\n    currentUser {\n      id\n      __typename\n      publicSshKeys {\n        ... on PublicSshKeysOutput {\n          keys {\n            id\n            key\n            label\n            timeCreated\n          }\n        }\n        ... on UnauthorizedError {\n          message\n        }\n      }\n    }\n  }\n"]);return sH=function(){return e},e}e.s(["resourcesTab",()=>s$],840752);var sW={},sq=(0,N.gql)(sz());function sK(e){var t=(0,g._)({},sW,e);return M.useQuery(sq,t)}var sY=(0,N.gql)(sH());function sQ(e){var t=(0,g._)({},sW,e);return M.useQuery(sY,t)}e.s(["useSshPaneCurrentUserQuery",()=>sQ,"useSshPaneQuery",()=>sK],93728)},77164,e=>{"use strict";var t=e.i(276385),n=e.i(9303),r=e.i(162225),i=e.i(371222),o=e.i(840752),a=e.i(297083),s=e.i(167626);e.i(878420);var l=e.i(530658),u=e.i(817556),c=e.i(389959);e.i(368964);var d=e.i(93728);e.i(596139);var f=e.i(903381),p=e.i(811081),h=e.i(255614),g=e.i(993796),m=e.i(222342),x=e.i(207237),y=e.i(282453),b=e.i(858248),w=e.i(709485);e.i(973519);var k=e.i(299798),_=e.i(475032),S=e.i(739434),C=e.i(529810),j=e.i(200004),T=e.i(948981),E=e.i(824108),R=e.i(211733),I=e.i(22866),A=e.i(133783),P=e.i(959407),D=e.i(961228),O=e.i(778203),N=e.i(712516),M=e.i(480028),L=e.i(703774),B=e.i(446530),V=e.i(613355),F=e.i(140487),U=e.i(739521),G=e.i(624782);e.i(396776);var $=e.i(552144),z=e.i(929872);e.i(545969);var H=e.i(960178),W=e.i(751273),q=e.i(625484),K=e.i(211397),Y=e.i(33914),Q=e.i(216373),X=e.i(709860),J=e.i(952030),Z=e.i(42458);function ee(){return(0,t.jsx)(K.default,{src:"/public/images/cursor-ide-logo.png",width:24,height:24,alt:"Cursor Logo"})}function et(e){var n=e.disabled,r=(0,l._)((0,c.useState)(!1),2),i=r[0],o=r[1],d=(0,m.default)(),f=d.showError,p=d.showConfirm,h=(0,g.useFlag)({controlName:"flag-codename"}),x=(0,C.default)().container,y=(0,_.default)(x).url,b=(0,L.useTheme)().isDarkColorScheme;return((0,k.usePid2)(function(e,n){var r=n.signal;return(0,a._)(function(){var n,a,l,c,d,h;return(0,u._)(this,function(u){switch(u.label){case 0:if(!i)return[2];u.label=1;case 1:return u.trys.push([1,3,4,5]),[4,e.vscode.start.rpc({darkMode:b},{signal:r})];case 2:return(n=u.sent()).ok?y?((a=(0,S.addPortToUrl)(y,5905)).searchParams.set("folder","/home/runner/workspace"),a.searchParams.set("tkn",n.payload.token),window.open(a.toString(),"_blank")?p("VS Code launched successfully",3e3):f((0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{children:"VS Code is ready but popup was blocked"}),(0,t.jsx)("div",{children:"Please allow popups for this site and try again."})]}))):f("VS Code server started but URL generation failed. Please try again."):n.payload&&(l=n.payload.code,c=n.payload.message,"START_FAILED"===l?f((0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{children:"Failed to start VS Code server:"}),(0,t.jsx)("div",{children:c||"Please try again or contact support."})]})):"NOT_RUNNING"===l?f("VS Code service is not available. Please try again later."):f("Unknown VS Code error: ".concat(c))),[3,5];case 3:return d=u.sent(),h=(0,s._)(d,Error)?d.message:"Unknown error",f((0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{children:"Failed to connect to VS Code service:"}),(0,t.jsx)("div",{children:h})]})),[3,5];case 4:return o(!1),[7];case 5:return[2]}})})()},[i,y,b,f,p]),h)?(0,t.jsxs)(z.Surface,{css:ei.connectInstructions,elevated:!0,children:[(0,t.jsxs)(q.View,{css:ei.connectHeader,children:[(0,t.jsxs)(q.View,{row:!0,gap:8,align:"center",children:[(0,t.jsx)(H.Header,{level:3,children:"VS Code in Browser"}),(0,t.jsx)(G.Pill,{text:"Alpha",colorway:"warning",variant:"muted"})]}),(0,t.jsx)(H.Text,{color:"dimmer",children:"Launch VS Code directly in your browser without setting up SSH."})]}),(0,t.jsx)(F.Button,{text:n?"VS Code Unavailable":"Launch VS Code in Browser",iconLeft:(0,t.jsx)(X.default,{}),css:ei.launchEditorButton,disabled:n||i,loading:i,onClick:function(){o(!0)}})]}):null}function en(e){var n=e.editor,r=e.disabled,i=(0,P.default)(n),o=i.openEditor,a=i.onConfirmConfig,s=i.isConfigModalOpen,l=i.closeConfigModal;return(0,t.jsxs)(z.Surface,{css:ei.connectInstructions,elevated:!0,children:[(0,t.jsxs)(q.View,{css:ei.connectHeader,children:[(0,t.jsxs)(H.Header,{level:3,children:["Connect to ","vscode"===n?"VS Code":"Cursor"]}),(0,t.jsxs)(H.Text,{color:"dimmer",children:["One-click SSH setup will launch"," ","vscode"===n?"VS Code":"Cursor"," and configure keys for you."]})]}),(0,t.jsx)(F.Button,{text:r?"SSH Key Setup Required":"Launch ".concat("vscode"===n?"VS Code":"Cursor"),iconLeft:"vscode"===n?(0,t.jsx)(X.default,{}):(0,t.jsx)(ee,{}),css:ei.launchEditorButton,disabled:r,onClick:function(){(0,b.track)(w.events.WORKSPACE,{action:"open_in_vscode_clicked",source:"ssh_pane",editor:n}),o()}}),(0,t.jsx)(U.Modal,{isOpen:s,onRequestClose:l,centered:!0,children:(0,t.jsx)(R.default,{onConfirm:a})})]})}function er(e){var n=e.sshHostname,r=e.sshUser,i=e.sshPort,o=(0,A.default)(),a="ssh -i ".concat(o,"/.ssh/replit -p ").concat(i," ").concat(r,"@").concat(n);return(0,t.jsxs)(z.Surface,{css:ei.connectInstructions,elevated:!0,children:[(0,t.jsxs)(q.View,{css:ei.connectHeader,children:[(0,t.jsx)(H.Header,{level:3,children:"Connect manually"}),(0,t.jsx)(H.Text,{color:"dimmer",children:"Use the command below to connect via CLI or another IDE."})]}),(0,t.jsx)(E.default,{code:a,header:"Shell command",multiline:!1,onCopy:function(){(0,b.track)(w.events.WORKSPACE,{action:"ssh_key_copied",source:"ssh_pane"})}})]})}var ei=(0,B.cssRecord)({tabContainer:[V.rcss.colWithGap(8),V.rcss.p(8)],connectEmptyState:[V.rcss.center,V.rcss.border({color:M.tokens.outlineDefault,width:1,style:"dashed"}),V.rcss.borderRadius(4),V.rcss.py(24),V.rcss.px(12)],connectHeader:[V.rcss.colWithGap(4)],connectInstructions:[V.rcss.colWithGap(12),V.rcss.p(8),V.rcss.borderRadius(4)],launchEditorButton:[V.rcss.borderRadius(8)]});function eo(e){var n=e.legacyKeys,r=e.openFile,i=(0,x.default)(),o="legacy-ssh-keys-warning-".concat(i),a=(0,l._)((0,c.useState)(function(){return!y.default.get(o,"boolean")}),2),s=a[0],u=a[1],d=(0,c.useRef)(!1);return((0,c.useEffect)(function(){return y.default.get(o,"boolean")||u(!0),function(){d.current&&y.default.set(o,!0)}},[o]),n&&0!==n.length&&s)?(0,t.jsx)(q.View,{children:(0,t.jsx)($.StatusBannerButton,{colorway:"warning",iconLeft:(0,t.jsx)(Z.default,{}),text:"Don't see your SSH keys here? We're moving from App-level keys to user-level keys. Click here to view your existing keys and re-add them using the 'New SSH Key' button above.",onClick:function(){r(T.SSH_AUTHORIZED_KEYS_FILE_PATH),d.current=!0}})}):null}function ea(){var e,n=(0,d.useSshPaneCurrentUserQuery)(),r=n.data,i=n.loading,o=(0,O.default)();if(i||!o)return(0,t.jsx)(N.default,{pane:{type:"developer",data:{tab:["ssh","connect"]}},loading:!0,maxWidth:450});var a=o.sshHostname,s=o.sshUser,l=o.sshPort,u=0===(r&&(null==(e=r.currentUser)?void 0:e.__typename)==="CurrentUser"&&"PublicSshKeysOutput"===r.currentUser.publicSshKeys.__typename?r.currentUser.publicSshKeys.keys:[]).length;return(0,t.jsxs)(q.View,{css:ei.tabContainer,children:[(0,t.jsx)(H.Header,{variant:"subheadDefault",level:2,children:"Use Replit with another editor"}),(0,t.jsx)(H.Text,{color:"dimmer",children:"SSH allows you to connect to an App from another machine or IDE."}),(0,t.jsxs)(q.View,{py:8,gap:16,children:[(0,t.jsx)(et,{}),(0,t.jsx)(en,{editor:"vscode",disabled:u}),(0,t.jsx)(en,{editor:"cursor",disabled:u}),u?(0,t.jsxs)(q.View,{css:ei.connectEmptyState,gap:8,children:[(0,t.jsx)(Q.default,{size:24,color:M.tokens.foregroundDimmest}),(0,t.jsx)(H.Text,{color:"dimmer",children:"You need to add an SSH key to your account before connecting"}),(0,t.jsx)(H.Text,{color:"dimmer",variant:"small",children:"Switch to the Keys tab to manage SSH keys"})]}):(0,t.jsx)(er,{sshHostname:a,sshPort:l,sshUser:s})]}),(0,t.jsx)(I.SshKeyTip,{})]})}function es(e){var n,r,i,o,s,g=e.openFile,m=(0,d.useSshPaneCurrentUserQuery)(),x=m.data,y=m.loading,b=(0,l._)((0,c.useState)(!1),2),w=b[0],k=b[1],_=(r=(n=(0,l._)((0,c.useState)(null),2))[0],i=n[1],o=(0,C.default)().fs,(0,c.useEffect)(function(){(0,a._)(function(){var e;return(0,u._)(this,function(t){switch(t.label){case 0:return[4,o.readFile(T.SSH_AUTHORIZED_KEYS_FILE_PATH)];case 1:if((e=t.sent()).error===f.FsErrors.NotFound||e.error===f.FsErrors.IsDirectory)return[2];if(e.error)throw Error("Unexpected error reading authorized keys");return i(e.content.toString().split("\n").map(function(e){return e.startsWith("#")||(0,h.default)(e)?null:e}).filter(Boolean)),[2]}})})()},[o]),r);if(y)return(0,t.jsx)(q.View,{p:16,children:"Loading..."});var S=x&&(null==(s=x.currentUser)?void 0:s.__typename)==="CurrentUser"&&"PublicSshKeysOutput"===x.currentUser.publicSshKeys.__typename?x.currentUser.publicSshKeys.keys:[],E=S.length>=p.SSH_KEY_LIMIT;return(0,t.jsxs)(q.View,{css:ei.tabContainer,children:[(0,t.jsxs)(q.View,{row:!0,justify:"space-between",children:[(0,t.jsx)(H.Header,{variant:"subheadDefault",level:2,children:"Manage SSH Keys"}),(0,t.jsx)(W.Tooltip,{tooltip:"You are over the SSH key limit. Please remove some of your keys to add more.",isDisabled:!E,children:(0,t.jsx)(F.Button,{text:"Add SSH key",colorway:"primary",size:"small",disabled:E,iconLeft:(0,t.jsx)(J.default,{}),onClick:function(){return k(!0)}})})]}),(0,t.jsx)(H.Text,{color:"dimmer",children:"Add authorized keys to configure SSH access to this App."}),(0,t.jsx)(eo,{legacyKeys:_,openFile:g}),(0,t.jsx)(D.UserSshKeyList,{keys:S}),(0,t.jsx)(U.Modal,{isOpen:w,onRequestClose:function(){return k(!1)},centered:!0,children:(0,t.jsx)(j.AddSshKeyDialog,{onConfirm:function(){return k(!1)}})})]})}var el={label:"Connect",description:"Establish SSH connections to remote servers and manage active sessions",icon:(0,t.jsx)(Y.default,{}),component:function(){return(0,t.jsx)(ea,{})}},eu={label:"Keys",description:"Manage SSH public and private keys for secure authentication",icon:(0,t.jsx)(Q.default,{}),component:function(e){var n=e.openPane,r=(0,c.useCallback)(function(e){return n({type:"codeEditor",data:{path:e}})},[n]);return(0,t.jsx)(es,{openFile:r})}},ec=e.i(982204),ed=e.i(62534),ef={networking:i.networkingTab,resources:o.resourcesTab,dependencies:{label:"Dependencies",description:"Install, upgrade, and manage dependencies for your environment, build system, and application runtime",icon:(0,t.jsx)(ec.default,{}),children:{import:n.dependenciesImportTab,nix:r.dependenciesNixTab}},ssh:{label:"SSH",description:"Configure remote access to connect to this Repl from another machine or IDE",icon:(0,t.jsx)(ed.default,{}),children:{connect:el,keys:eu}}};e.s(["developerTabs",()=>ef],77164)},448534,e=>{"use strict";var t=e.i(276385),n=e.i(452412),r=e.i(858248),i=e.i(709485),o=e.i(739521);function a(e){var a=e.shouldShowUpgradeModal,s=e.isUpgrading,l=e.onUpgradeConfirm,u=e.onUpgradeCancel,c=e.onClose;return(0,t.jsx)(o.Modal,{isOpen:a,onRequestClose:function(){(0,r.track)(i.events.VISUAL_EDITOR_UPGRADE_ACTION,{action:"closed"}),c()},centered:!0,maxWidth:450,children:(0,t.jsx)(n.default,{title:"Update visual editing tools",confirmLabel:"Update",cancelLabel:"Continue without updating",loading:s,onConfirm:function(){(0,r.track)(i.events.VISUAL_EDITOR_UPGRADE_ACTION,{action:"confirmed"}),l()},onCancel:function(){(0,r.track)(i.events.VISUAL_EDITOR_UPGRADE_ACTION,{action:"cancelled"}),u()},children:"Installing the update will restart your local app. It'll only take a moment. Proceed with the update?"})})}e.s(["UpgradeModal",()=>a])},414699,e=>{"use strict";var t=e.i(878420),n=e.i(64386),r=e.i(389959),i=e.i(161322),o=e.i(69470),a=e.i(459781),s={content:!0,fontSize:!0,fontStyle:!0,alignment:!0,textColor:!0,backgroundColor:!0,margin:!0,padding:!0,imageSource:!1};function l(e){var l=(0,i.useAtomValue)(o.versionAtom);return(0,r.useMemo)(function(){var r=function(e,r){var i,o,l,u=(null!=(o=null==e||null==(i=e.textContent)?void 0:i.length)?o:0)>0,c=(null!=(l=null==e?void 0:e.siblingCount)?l:0)>1,d=r&&!r.includes("standalone")&&(0,a.compareSemVer)(r,"0.2.7")>=0;switch(null==e?void 0:e.elementName.toLowerCase()){case"img":return(0,n._)((0,t._)({},s),{content:!1,fontSize:!1,fontStyle:!1,alignment:!1,textColor:!1,backgroundColor:!1,imageSource:!c&&!!d});case"input":case"textarea":case"select":return(0,n._)((0,t._)({},s),{content:!1,fontSize:!1,fontStyle:!1,alignment:!1,textColor:!1});default:return(0,n._)((0,t._)({},s),{content:u&&!c&&!(null==e?void 0:e.hasChildElements),fontSize:u,alignment:u,fontStyle:u})}}(null!=e?e:void 0,l);return(0,n._)((0,t._)({},r),{textSectionHeader:r.content||r.fontSize||r.fontStyle||r.alignment,imageSectionHeader:r.imageSource,appearanceSectionHeader:r.textColor||r.backgroundColor,layoutSectionHeader:r.margin||r.padding})},[e,l])}e.s(["useComponentVisibility",()=>l],414699)},5561,e=>{"use strict";var t=e.i(878420),n=e.i(64386),r=e.i(530658),i=e.i(788106),o=e.i(541793),a=e.i(814563),s=e.i(408880),l=e.i(445059),u=e.i(69470),c=e.i(559491),d=e.i(31586),f=function(e){if(!e)return 0;var t=parseFloat(e.replace("px",""));return isNaN(t)?0:t},p=function(e){if(!e)return{x:0,y:0};var t=e.split(" ");switch(t.length){case 1:return{x:f(t[0]),y:f(t[0])};case 2:return{x:f(t[1]),y:f(t[0])};case 3:return{x:f(t[1]),y:(f(t[0])+f(t[2]))/2};case 4:return{x:(f(t[1])+f(t[3]))/2,y:(f(t[0])+f(t[2]))/2};default:return{x:0,y:0}}},h=function(e){switch(e){case"left":case"start":default:return"left";case"right":case"end":return"right";case"center":return"center";case"justify":return"justify"}},g=function(e){var t,n,r,i,o,a,s,l=p(null==e||null==(t=e.computedStyles)?void 0:t.margin),u=p(null==e||null==(n=e.computedStyles)?void 0:n.padding);return{textContent:null==e?void 0:e.textContent,fontSize:f(null==e||null==(r=e.computedStyles)?void 0:r.fontSize),fontWeight:null==e||null==(i=e.computedStyles)?void 0:i.fontWeight,textAlign:h(null==e||null==(o=e.computedStyles)?void 0:o.textAlign),color:(0,d.toHex)(null==e||null==(a=e.computedStyles)?void 0:a.color),backgroundColor:(0,d.toHex)(null==e||null==(s=e.computedStyles)?void 0:s.backgroundColor),marginX:l.x,marginY:l.y,paddingX:u.x,paddingY:u.y,imageSrc:(null==e?void 0:e.srcAttribute)||""}},m=(0,o.atom)({}),x=(0,o.atom)(null,function(e,t,n){t(m,g(n)),t(b,a.RESET)}),y=(0,o.atom)(function(e){var t=e(m),n=e(u.selectedElementMetadataAtom);return!!n&&!(0,s.default)(t,g(n))}),b=(0,a.atomWithReset)({}),w=(0,o.atom)(null,function(e,n,r){n(b,(0,t._)({},e(b),r));var i=e(k);(0,c.updateSelectedElementInWebview)({style:i})}),k=(0,o.atom)(function(e){return Object.entries(e(b)).map(function(e){var t=(0,r._)(e,2),n=t[0],i=t[1];return"".concat(n,": ").concat(i)}).join("; ")}),_=(0,o.atom)(function(e){return e(m).fontSize},function(e,r,i){r(w,{"font-size":"".concat(i,"px")}),r(m,(0,n._)((0,t._)({},e(m)),{fontSize:i}))}),S=(0,o.atom)(function(e){return e(m).fontWeight},function(e,r,i){r(w,{"font-weight":i}),r(m,(0,n._)((0,t._)({},e(m)),{fontWeight:i}))}),C=(0,o.atom)(function(e){return e(m).textAlign},function(e,r,i){r(w,{"text-align":i}),r(m,(0,n._)((0,t._)({},e(m)),{textAlign:i}))}),j=(0,o.atom)(function(e){return e(m).color},function(e,r,o){(i.default.valid(o)||(0,d.isColorTransparentOrAliased)(o))&&r(w,{color:o}),r(m,(0,n._)((0,t._)({},e(m)),{color:o}))}),T=(0,o.atom)(function(e){return e(m).backgroundColor},function(e,r,o){(i.default.valid(o)||(0,d.isColorTransparentOrAliased)(o))&&r(w,{"background-color":o}),r(m,(0,n._)((0,t._)({},e(m)),{backgroundColor:o}))}),E=(0,o.atom)(function(e){return e(m).marginX},function(e,r,i){r(w,{"margin-left":"".concat(i,"px"),"margin-right":"".concat(i,"px")}),r(m,(0,n._)((0,t._)({},e(m)),{marginX:i}))}),R=(0,o.atom)(function(e){return e(m).marginY},function(e,r,i){r(w,{"margin-top":"".concat(i,"px"),"margin-bottom":"".concat(i,"px")}),r(m,(0,n._)((0,t._)({},e(m)),{marginY:i}))}),I=(0,o.atom)(function(e){return e(m).paddingX},function(e,r,i){r(w,{"padding-left":"".concat(i,"px"),"padding-right":"".concat(i,"px")}),r(m,(0,n._)((0,t._)({},e(m)),{paddingX:i}))}),A=(0,o.atom)(function(e){return e(m).paddingY},function(e,r,i){r(w,{"padding-top":"".concat(i,"px"),"padding-bottom":"".concat(i,"px")}),r(m,(0,n._)((0,t._)({},e(m)),{paddingY:i}))}),P=(0,o.atom)(!1),D=(0,o.atom)(function(e){return e(m).textContent},function(e,r,i){r(w,{content:i}),r(m,(0,n._)((0,t._)({},e(m)),{textContent:i})),e(P)||(0,c.updateSelectedElementInWebview)({textContent:i})}),O=(0,o.atom)(null,function(e,t,n){n!==e(m).textContent&&(t(P,!0),t(D,n),t(P,!1))}),N="/@fs/home/runner/workspace/",M=(0,o.atom)(function(e){var t=e(m).imageSrc;return(null==t?void 0:t.startsWith(N))?t.replace(N,""):t},function(e,r,i){r(m,(0,n._)((0,t._)({},e(m)),{imageSrc:i}));var o=i;i.startsWith(l.ATTACHED_ASSETS_PATH)&&(o="".concat(N).concat(i)),(0,c.updateSelectedElementInWebview)({src:o})});e.s(["backgroundColorInputAtom",()=>T,"colorInputAtom",()=>j,"editorStateAtom",()=>m,"fontSizeInpAtom",()=>_,"fontWeightInputAtom",()=>S,"hydrateEditorStateAtom",()=>x,"hydrateTextContentAtom",()=>O,"imageSourceInputAtom",()=>M,"isEditorStateDirtyAtom",()=>y,"marginXInputAtom",()=>E,"marginYInputAtom",()=>R,"paddingXInputAtom",()=>I,"paddingYInputAtom",()=>A,"styleAttributesAtom",()=>b,"textAlignInputAtom",()=>C,"textContentInputAtom",()=>D],5561)},341470,e=>{"use strict";var t=e.i(389959),n=e.i(906368),r=e.i(161322),i=e.i(709485),o=e.i(993796),a=e.i(858248),s=e.i(69470),l=e.i(414699),u=e.i(5561),c=e.i(559491);function d(e){var d=(0,r.useSetAtom)(s.setVisualSelectorElementAtom),f=(0,r.useSetAtom)(s.setVisualSelectorActiveAtom),p=(0,r.useSetAtom)(s.setSelectorScriptLoadedAtom),h=(0,r.useSetAtom)(s.setScreenshotBlobAtom),g=(0,r.useSetAtom)(s.clearVisualSelectorElementAtom),m=(0,r.useSetAtom)(u.hydrateTextContentAtom),x=(0,r.useSetAtom)(u.hydrateEditorStateAtom),y=(0,r.useSetAtom)(s.setVersionAtom),b=(0,r.useSetAtom)(s.focusAgentInputAtom),w=(0,r.useAtomValue)(s.selectedElementMetadataAtom),k=(0,l.useComponentVisibility)(w),_=(0,o.useFlag)({type:"string",controlName:"flag-cartographer-version",default:"0.0.10"}),S=(0,o.useFlag)({type:"boolean",controlName:"flag-killswitch-standalone-beacon"}),C=(0,t.useCallback)(function(){try{g(),(0,c.sendClearSelectionMessage)()}catch(e){n.captureException(e)}},[g]);return(0,t.useEffect)(function(){var t=function(t){if(null==(n=t.data)?void 0:n.type)switch(t.data.type){case"ELEMENT_SELECTED":if(t.data.payload){d(t.data.payload),x(t.data.payload),t.data.payload.screenshotBlob&&h(t.data.payload.screenshotBlob);var n,r,o=(0,c.getSourceIframe)(t);o&&(0,c.sendClearSelectionMessage)({excludeIframe:o}),(0,a.track)(i.events.VISUAL_SELECTOR,{action:"element_selected",element:(0,c.parseElementFromCartographerMessage)(t.data.payload)})}break;case"ELEMENT_TEXT_CHANGED":t.data.payload&&m(t.data.payload.textContent);break;case"REPLIT_VISUAL_EDITOR_ENABLED":f(!0);break;case"ELEMENT_UNSELECTED":C();break;case"REPLIT_VISUAL_EDITOR_DISABLED":C(),(null==e?void 0:e.agentChatModeId)==="edit"&&(null==e||null==(r=e.onVisualSelectorDisabled)||r.call(e));break;case"SELECTOR_SCRIPT_LOADED":var s=t.data.version;if(y(s),S&&s.includes("standalone"))return;s&&s.localeCompare(_,void 0,{numeric:!0})>-1&&(p(!0),(null==e?void 0:e.agentChatModeId)==="edit"&&(0,c.sendToggleVisualEditorMessage)(!0,!0),C())}};return window.addEventListener("message",t),function(){window.removeEventListener("message",t)}},[d,f,p,g,_,h,S,m,x,y,C,e]),(0,t.useEffect)(function(){w&&!k.content&&b()},[w,k.content,b]),{handleClearSelection:C}}e.s(["useBeaconHandler",()=>d])},98791,e=>{"use strict";var t=e.i(297083),n=e.i(530658),r=e.i(817556),i=e.i(389959),o=e.i(541793),a=e.i(161322),s=e.i(878420),l=e.i(569384),u=e.i(973245),c=e.i(304277);e.i(566901);var d=e.i(951262);function f(){var e=(0,l._)(["\n  query VisualSelectorConfig($replId: String!) {\n    getRepl(id: $replId) {\n      ... on Repl {\n        id\n        config {\n          visualSelectorUpgradeRefused\n        }\n      }\n    }\n  }\n"]);return f=function(){return e},e}function p(){var e=(0,l._)(["\n  mutation UpdateVisualSelectorUpgradeRefused(\n    $replId: String!\n    $visualSelectorUpgradeRefused: String!\n  ) {\n    updateRepl(\n      input: {\n        id: $replId\n        visualSelectorUpgradeRefused: $visualSelectorUpgradeRefused\n      }\n    ) {\n      repl {\n        id\n        config {\n          visualSelectorUpgradeRefused\n        }\n      }\n    }\n  }\n"]);return p=function(){return e},e}var h={},g=(0,u.gql)(f()),m=(0,u.gql)(p()),x=e.i(459781),y=e.i(993796),b=e.i(222342),w=e.i(207237),k=e.i(664152),_=e.i(927158),S=e.i(729122),C=e.i(69470),j=(0,o.atom)("unchecked");function T(){var e,o,l,u,f,p,T,E=(0,n._)((0,i.useState)(!1),2),R=E[0],I=E[1],A=(0,n._)((0,i.useState)(!1),2),P=A[0],D=A[1],O=(0,a.useAtomValue)(j),N=(0,a.useSetAtom)(j),M=(0,a.useAtomValue)(C.visualSelectorStateAtom).version,L=(0,S.useOnReRun)(),B=(0,w.default)(),V=(e={variables:{replId:B}},o=(0,s._)({},h,e),c.useQuery(g,o)).data,F=(0,n._)((l={onError:function(){G("Error storing upgrade refusal")}},u=(0,s._)({},h,l),d.useMutation(m,u)),1)[0],U=(0,y.useFlag)({controlName:"flag-visual-editor-upgrade-threshold",type:"string",default:"0.4.0"}),G=(0,b.default)().showError,$=(null==V||null==(f=V.getRepl)?void 0:f.__typename)==="Repl"&&null!=(T=null==(p=V.getRepl.config)?void 0:p.visualSelectorUpgradeRefused)?T:null,z=(0,_.usePid2Callback)(function(e){return function(){return(0,t._)(function(){var t;return(0,r._)(this,function(n){switch(n.label){case 0:D(!0),n.label=1;case 1:return n.trys.push([1,3,5,6]),[4,e.agentToolPackager.installPackages.rpc({pkgs:["@replit/vite-plugin-cartographer@latest"],language:"nodejs-npm"})];case 2:if(n.sent().ok)I(!1),N("ok"),L();else throw Error("Failed to upgrade cartographer package");return[3,6];case 3:return t=n.sent(),k.logger.error("Error Upgrading Cartographer Package",{errorMessage:t.message}),G("Error Upgrading Package"),I(!1),N("refused-upgrade"),[4,F({variables:{replId:B,visualSelectorUpgradeRefused:U}})];case 4:return n.sent(),[3,6];case 5:return D(!1),[7];case 6:return[2]}})})()}},[L,N,G,F,B,U]);return{shouldShowUpgradeModal:R,isUpgrading:P,checkVersionAndProceed:(0,i.useCallback)(function(){return"ok"===O||"refused-upgrade"===O||("needs-upgrade"===O?(I(!0),!1):M&&!M.includes("standalone")&&0>(0,x.compareSemVer)(M.replace(/[^0-9.]/g,""),U)?!!($&&(0,x.compareSemVer)($,U)>=0)||(N("needs-upgrade"),I(!0),!1):(N("ok"),!0))},[N,M,O,U,$]),handleUpgradeConfirm:(0,i.useCallback)(function(){z&&z()},[z]),handleUpgradeCancel:(0,i.useCallback)(function(){I(!1),N("refused-upgrade"),F({variables:{replId:B,visualSelectorUpgradeRefused:U}})},[N,F,B,U]),handleModalClose:(0,i.useCallback)(function(){I(!1)},[]),versionCheckResult:O}}e.s(["usePackageVersionCheck",()=>T],98791)},364357,e=>{e.v({disabled:"AgentChatModeDropdown-module__CxHzwa__disabled",emptyIcon:"AgentChatModeDropdown-module__CxHzwa__emptyIcon",glow:"AgentChatModeDropdown-module__CxHzwa__glow",modeItem:"AgentChatModeDropdown-module__CxHzwa__modeItem",popoverSurface:"AgentChatModeDropdown-module__CxHzwa__popoverSurface",selectButton:"AgentChatModeDropdown-module__CxHzwa__selectButton",toggleComboIcon:"AgentChatModeDropdown-module__CxHzwa__toggleComboIcon"})},971465,e=>{"use strict";var t=e.i(297083),n=e.i(721281),r=e.i(530658),i=e.i(817556),o=e.i(276385),a=e.i(389959),s=e.i(654647),l=e.i(413309),u=e.i(178339),c=e.i(368964),d=e.i(509908),f=e.i(448534),p=e.i(341470),h=e.i(98791);e.i(32109);var g=e.i(926118),m=e.i(384401),x=e.i(262206),y=e.i(709867),b=e.i(480028),w=e.i(446530),k=e.i(613355),_=e.i(140487),S=e.i(929872),C=e.i(960178),j=e.i(751273),T=e.i(625484),E=e.i(658886),R=e.i(616278),I=e.i(576073),A=e.i(462783),P=e.i(86116),D=e.i(634669),O=e.i(364357),N=(0,w.cssRecord)({base:[{":focus":k.sharedFocusStyles}]}),M={id:"agent.switchMode",name:"Switch Agent mode",description:"Cycle through Agent modes (Build, Plan, Edit)",default:(0,x.defaultKeyCombo)({cmdOrCtrl:!0,key:"i"})};function L(e){var n,g=e.disabled,x=void 0!==g&&g,b=e.selectedModeId,w=e.editModeVisibility,k=e.updateAgentSettings,j=e.setVisualSelectorEnabled,R=e.setIsEditModeActive,L=e.keyboardShortcutEnabled,F=void 0!==L&&L,U=e.onModeSwitchFocusInput,G=(0,r._)((0,a.useState)(!1),2),$=G[0],z=G[1],H=(0,a.useRef)(null),W=(0,a.useMemo)(function(){var e,t;return e=void 0,"disabled"===w?e="Unavailable for this app type":"loading"===w&&(e="Waiting for Preview to load"),t=[{id:"build",label:y.BUILD_MODE_LABEL,icon:(0,o.jsx)(D.default,{size:16}),description:y.BUILD_MODE_DESCRIPTION},{id:"plan",label:y.PLAN_MODE_LABEL,icon:(0,o.jsx)(E.default,{size:16}),description:y.PLAN_MODE_DESCRIPTION}],"hidden"!==w&&t.push({id:"edit",label:y.EDIT_MODE_LABEL,icon:(0,o.jsx)(P.default,{size:16}),description:y.EDIT_MODE_DESCRIPTION,disabledReason:e}),t},[w]),q=(0,a.useMemo)(function(){return W.filter(function(e){return!e.disabledReason})},[W]),K=null!=(n=W.find(function(e){return e.id===b}))?n:W[0],Y=(0,a.useCallback)(function(){R(!1),"edit"===b&&j(!1,{shouldClearSelection:!0,isEditingEnabled:!1})},[b,R,j]);(0,p.useBeaconHandler)({agentChatModeId:b,onVisualSelectorDisabled:function(){Y(),k({chatMode:"general"})}});var Q=(0,h.usePackageVersionCheck)(),X=Q.shouldShowUpgradeModal,J=Q.isUpgrading,Z=Q.checkVersionAndProceed,ee=Q.handleUpgradeConfirm,et=Q.handleUpgradeCancel,en=Q.handleModalClose,er=(0,a.useCallback)(function(){et(),j(!1)},[et,j]),ei=(0,a.useCallback)(function(e){return(0,t._)(function(){var t;return(0,i._)(this,function(n){if(t=e,z(!1),t===b)return null==U||U(),[2];switch(t){case"build":Y(),k({chatMode:c.AgentChatMode.General});break;case"plan":Y(),k({chatMode:c.AgentChatMode.Discussion});break;case"edit":"visible"===w&&Z()&&(j(!0,{isEditingEnabled:!0,shouldClearSelection:!1}),R(!0),k({chatMode:c.AgentChatMode.General}))}return null==U||U(),(0,d.trackAgentAnalyticsEvent)({action:"chat_mode_changed",agentChatMode:t}),[2]})})()},[b,U,Y,k,w,Z,j,R]),eo=(0,a.useCallback)(function(){var e=(q.indexOf(K)+1)%q.length;ei(q[e].id)},[q,ei,K]);return(0,m.useCommandBinding)(function(){return F?[M.id,eo]:void 0},[F,eo]),(0,o.jsxs)(T.View,{children:[(0,o.jsxs)(u.Select,{selectedKey:b,onSelectionChange:ei,isDisabled:x,"aria-label":"Modes",children:[(0,o.jsx)(_.Button,{size:"small",clsx:O.default.selectButton,text:null==K?void 0:K.label,iconLeft:null==K?void 0:K.icon,iconRight:$?(0,o.jsx)(I.default,{size:12}):(0,o.jsx)(A.default,{size:12}),alignment:"start",onClick:function(){return z(!$)},disabled:x,ref:H}),(0,o.jsx)(l.Popover,{placement:"top start",isOpen:$,onOpenChange:function(e){z(e),e||null==U||U()},children:(0,o.jsxs)(S.Surface,{clsx:O.default.popoverSurface,p:4,children:[F?(0,o.jsxs)(T.View,{row:!0,gap:4,px:4,pb:4,align:"center",children:[(0,o.jsx)(V,{}),(0,o.jsx)(C.Text,{variant:"small",color:"dimmest",children:"to switch modes"})]}):null,(0,o.jsx)(s.ListBox,{"aria-label":"Agent mode",selectionMode:"single",children:W.map(function(e){return(0,o.jsx)(s.ListBoxItem,{id:e.id,"aria-label":e.label,css:N.base,isDisabled:!!e.disabledReason,children:(0,o.jsx)(B,{title:e.label,icon:e.icon,description:e.description,isSelected:b===e.id,disabledReason:e.disabledReason})},e.id)})})]})})]}),(0,o.jsx)(f.UpgradeModal,{shouldShowUpgradeModal:X,isUpgrading:J,onUpgradeConfirm:ee,onUpgradeCancel:er,onClose:en})]})}function B(e){var t=e.title,r=e.icon,i=e.description,a=e.isSelected,s=e.disabledReason;return(0,o.jsx)(j.Tooltip,{tooltip:s,isDisabled:!s,children:(0,o.jsxs)(T.View,{clsx:[O.default.modeItem,N.base,(0,n._)({},O.default.disabled,!!s)],p:6,row:!0,gap:8,align:"center",justify:"space-between",children:[(0,o.jsxs)(T.View,{row:!0,gap:8,align:"center",children:[r,(0,o.jsx)(C.Text,{children:t}),(0,o.jsx)(C.Text,{color:"dimmest",children:i})]}),(0,o.jsx)(T.View,{children:a?(0,o.jsx)(R.default,{size:16,color:b.tokens.foregroundDimmer}):(0,o.jsx)(T.View,{clsx:O.default.emptyIcon})})]})})}function V(){return(0,o.jsx)(g.KeyComboBlocks,{className:O.default.toggleComboIcon,keyCombo:M.default,small:!0,hideBorder:!0})}e.s(["AgentChatModeDropdown",()=>L,"switchAgentModeCommand",()=>M])},936381,e=>{"use strict";var t=e.i(753950),n=t.StateEffect.define(),r=t.StateEffect.define();e.s(["inlinePocketEffect",()=>n,"setInlinePocketCodeBlock",()=>r])},468345,e=>{"use strict";var t=e.i(878420),n=e.i(64386),r=e.i(753950),i=e.i(179302),o=e.i(936381),a=e.i(738705),s=e.i(969932),l=e.i(858248),u=e.i(709485);function c(e){var t=e.state.field(d);if(t){var n=t.type;return"explainCode"===n?(0,l.track)(u.events.AI_INLINE_EVENT,{action:"inline_textbox_closed",intent_type:"explain",source:t.source}):"generateCode"===n?(0,l.track)(u.events.AI_INLINE_EVENT,{action:"inline_textbox_closed",intent_type:"generate",source:t.source}):"transformCode"===n&&(0,l.track)(u.events.AI_INLINE_EVENT,{action:"inline_textbox_closed",intent_type:"modify",source:t.source}),e.dispatch({effects:o.inlinePocketEffect.of(null)}),!0}return!1}var d=r.StateField.define({create:function(){return null},update:function(e,r){if((0,s.forEachEffect)(r,o.inlinePocketEffect,function(t){e=t.value?{id:t.value.id,codeReference:t.value.codeReference,type:t.value.type,source:t.value.source,loading:t.value.loading,data:t.value.data}:null}),!e||r.changes.empty)return e;var i=e.codeReference.range.indexFrom>r.newDoc.length?r.newDoc.length:r.changes.mapPos(e.codeReference.range.indexFrom),a=e.codeReference.range.indexTo>r.newDoc.length?r.newDoc.length:r.changes.mapPos(e.codeReference.range.indexTo);return i>=a?null:e=(0,n._)((0,t._)({},e),{codeReference:(0,n._)((0,t._)({},e.codeReference),{range:{indexFrom:i,indexTo:a,lineFrom:r.newDoc.lineAt(i).number,lineTo:r.newDoc.lineAt(a).number}})})},provide:function(e){return[r.Prec.highest(i.keymap.of([{key:"Escape",run:c}])),a.Loading.from(e,function(e){var t;return null!=(t=(null==e?void 0:e.loading)&&e.codeReference.range.indexFrom===e.codeReference.range.indexTo)?t:null})]}}),f=r.StateField.define({create:function(){return null},update:function(e,t){if(!t.state.field(d))return null;var n=!0,r=!1,i=void 0;try{for(var a,s=t.effects[Symbol.iterator]();!(n=(a=s.next()).done);n=!0){var l=a.value;l.is(o.inlinePocketEffect)&&(e=null),l.is(o.setInlinePocketCodeBlock)&&(e=l.value)}}catch(e){r=!0,i=e}finally{try{n||null==s.return||s.return()}finally{if(r)throw i}}return e}});e.s(["InlinePocketCodeBlock",()=>f,"InlinePocketState",()=>d])},787433,551837,e=>{"use strict";var t,n=e.i(904851),r=e.i(90659),i=e.i(721281),o=e.i(878420),a=e.i(64386),s=e.i(276385),l=e.i(389959),u=e.i(992785),c=e.i(753950),d=e.i(179302);e.i(508987);var f=e.i(457103),p=e.i(468345),h=e.i(928353),g=e.i(969932),m=e.i(700170),x=e.i(337761),y=e.i(332441);e.i(32109);var b=e.i(926118),w=e.i(541793),k=e.i(852819),_=(0,w.atom)(!1);function S(){return(0,k.useValue)(_)}function C(){var e=(0,k.useSet)(_);return(0,l.useCallback)(function(){return e(!0)},[e])}function j(e){var t=(0,k.useSet)(_),n=(0,l.useRef)(!1);(0,l.useEffect)(function(){n.current||(n.current=!0,t(e))},[t,e])}e.s(["useIconOnly",()=>S,"useSetIconOnly",()=>C,"useSetInitialIconOnlySelectionControls",()=>j],551837);var T=e.i(480028),E=e.i(446530),R=e.i(754873),I=e.i(123850),A=e.i(613355),P=e.i(929872),D=e.i(960178),O=e.i(751273),N=e.i(625484),M=e.i(196353),L=(0,I.createCssVarTokens)(["opacity","transform"]),B=L.cssVars,V=L.styleTokens,F=[A.rcss.display.flex,A.rcss.reset.button,A.rcss.cursor.pointer,A.rcss.center,R.interactive.nofill,A.rcss.height("100%"),A.rcss.borderRadius(0)],U=[F,A.rcss.width(28),{"& svg":A.rcss.display.block}],G=(0,E.cssRecord)({root:[A.rcss.borderRadius(6),A.rcss.border({color:T.tokens.outlineDefault}),A.rcss.position.relative,A.rcss.height(30),{opacity:V.opacity,transform:V.transform,transition:"opacity 120ms, transform 120ms","button:first-of-type":{borderTopLeftRadius:6,borderBottomLeftRadius:6},"button:last-of-type":{borderTopRightRadius:6,borderBottomRightRadius:6}}],moreButton:U,button:[F,A.rcss.rowWithGap(4),A.rcss.align.center,A.rcss.pl(4),A.rcss.pr(6),A.rcss.flex.growAndShrink(1),A.rcss.border({direction:"right",color:T.tokens.outlineDefault}),{fontFamily:T.tokens.fontFamilyDefault,"*":{color:T.tokens.foregroundDimmer},":hover *":{color:T.tokens.foregroundDefault},".shortcut":{color:T.tokens.foregroundDimmest},":hover .shortcut":{color:T.tokens.foregroundDimmer}}],iconButton:[U,A.rcss.border({direction:"right",color:T.tokens.outlineDefault})]}),$=new h.CodeMirrorComponent(function(e){var t,n=e.controls,r=e.verticalPlacement,u=e.onMoreClick,c=(0,l.useRef)(null),d=(0,y.useIsMac)(),f=C();(0,l.useEffect)(function(){var e;f(),(0,x.styleSet)(c,(e={},(0,i._)(e,B.opacity,"1"),(0,i._)(e,B.transform,"translateY(calc(".concat("top"===r?1:-1," * ").concat(T.tokens.space4,"))")),e))},[r,f]);var p=(0,l.useRef)(S());return(0,s.jsxs)(P.Surface,{innerRef:c,elevated:!0,css:G.root,align:"stretch",row:!0,style:(t={},(0,i._)(t,B.opacity,"0"),(0,i._)(t,B.transform,"translateY(calc(".concat("top"===r?1:-1," * ").concat(T.tokens.space16,"))")),t),children:[n.map(function(e){if(p.current){var t=(0,s.jsxs)(N.View,{row:!0,gap:2,align:"center",children:[(0,s.jsx)(D.Text,{variant:"small",multiline:!1,children:e.text}),e.shortcut?(0,s.jsx)(D.Text,{variant:"small",className:"shortcut",color:"dimmest",children:(0,b.keyComboText)(e.shortcut,d)}):null]});return(0,s.jsx)(O.Tooltip,{tooltip:t,children:function(t,n){return(0,s.jsx)(N.View,(0,a._)((0,o._)({},t),{innerRef:n,css:G.iconButton,onClick:e.onClick,tag:"button",children:e.icon}))}},e.text)}return(0,s.jsxs)(N.View,{css:G.button,onClick:e.onClick,tag:"button",children:[e.icon,(0,s.jsx)(D.Text,{variant:"small",multiline:!1,children:e.text}),e.shortcut?(0,s.jsxs)(D.Text,{variant:"small",className:"shortcut",children:["(",(0,b.keyComboText)(e.shortcut,d),")"]}):null]},e.text)}),u?(0,s.jsx)(N.View,{"aria-label":"More",css:G.moreButton,onClick:function(e){var t=(c.current||e.currentTarget).getBoundingClientRect();u({top:t.top,right:t.right})},tag:"button",children:(0,s.jsx)(M.default,{size:16})}):null]})}),z="cm-selection-controls-layer",H="cm-selection-controls-dom",W=d.EditorView.theme((t={},(0,i._)(t,".".concat(z),{width:"100%"}),(0,i._)(t,".".concat(H),{position:"absolute"}),t)),q=function(){function e(t){(0,n._)(this,e),(0,i._)(this,"options",void 0),this.options=t}return(0,r._)(e,[{key:"draw",value:function(){var e=this.options,t=e.controls,n=e.onMoreClick,r=e.top,i=e.align,o=e.verticalPlacement,a=$.create({controls:t,onMoreClick:n,verticalPlacement:o});return a.className=H,a.style.top=r+"px","left"===i.side?(a.style.left=i.value+"px",a.style.right=""):(a.style.right=i.value+"px",a.style.left=""),a.style.pointerEvents="none",setTimeout(function(){a.style.pointerEvents="auto"},200),a}},{key:"eq",value:function(e){return(0,u.default)(e.options,this.options)}}]),e}(),K=c.StateEffect.define(),Y=c.StateField.define({create:function(){return null},update:function(e,t){var n;return!t.state.selection||(null==(n=t.state.selection)?void 0:n.main.empty)?null:((0,g.forEachEffect)(t,K,function(t){e=t.value}),e)}}),Q=c.StateField.define({create:function(e){return!e.selection.main.empty},update:function(e,t){return!t.state.selection.main.empty}}),X=d.ViewPlugin.define(function(e){var t=function(){var t=e.state.selection.main;e.dispatch({effects:K.of(t.empty?null:Date.now())})},n=function(e){"Shift"===e.key&&t()},r=function(){document.addEventListener("mouseup",t),document.addEventListener("keyup",n)},i=function(){document.removeEventListener("mouseup",t),document.removeEventListener("keyup",n)};return{update:function(e){(0,f.hasChanged)(e,Q)&&(e.state.field(Q)?r():i())},destroy:i}}),J=new m.ReactCompartment(function(e){return[W,(0,d.layer)({above:!0,class:z,update:function(e){return(0,f.hasChanged)(e,p.InlinePocketState,Y)},markers:function(t){if(!t.hasFocus)return[];var n=t.state.field(Y)?t.state.selection.main:null;if(!n||t.state.field(p.InlinePocketState,!1))return[];var r=function(e,t){for(var n=Math.min(t.from,t.to),r=Math.max(t.from,t.to),i=null;n<=r;){var o=e.lineAt(n);n=o.to+1,null!==i&&o.length<i.length||(i=o)}return i}(t.state.doc,n);if(!r)return[];var i=t.coordsAtPos(r.to);if(!i)return[];var o=t.lineBlockAt(Math.min(n.anchor,n.head)),a=t.dom.getBoundingClientRect(),s=t.contentDOM.getBoundingClientRect(),l=o.top+t.documentPadding.top-30,u=s.right-i.left<200?{side:"right",value:a.right-s.right+16}:{side:"left",value:i.left-a.left},c="top";if(l<t.scrollDOM.scrollTop){var d=t.lineBlockAt(n.to);l=d.top+d.height,c="bottom"}return[new q({top:l,align:u,controls:e.controls(t),onMoreClick:e.onMoreClick,verticalPlacement:c})]}}),Q,Y,X]});e.s(["SelectionControls",()=>J],787433)},807290,e=>{"use strict";var t=e.i(878420),n=e.i(569384),r=e.i(973245),i=e.i(304277);function o(){var e=(0,n._)(["\n  query ReplTeamOrgSettings($replId: String!) {\n    getRepl(id: $replId) {\n      ... on Repl {\n        id\n        owner {\n          __typename\n          ... on Team {\n            id\n            organization {\n              id\n              isAiEnabled\n            }\n          }\n        }\n      }\n    }\n  }\n"]);return o=function(){return e},e}e.i(566901);var a={},s=(0,r.gql)(o()),l=e.i(207237);function u(){var e,n,r,o,u=(r={variables:{replId:(0,l.default)()}},o=(0,t._)({},a,r),i.useQuery(s,o)).data;return{isTeamWithAiDisabled:(null==u?void 0:u.getRepl.__typename)==="Repl"&&(null==(e=u.getRepl.owner)?void 0:e.__typename)==="Team"&&(null==(n=u.getRepl.owner.organization)?void 0:n.isAiEnabled)===!1}}e.s(["useIsTeamWithAiDisabled",()=>u],807290)},933101,e=>{"use strict";var t=e.i(276385),n=e.i(389959),r=e.i(629536),i=e.i(179302),o=e.i(787433),a=e.i(807290);e.i(32109);var s=e.i(384401),l=e.i(262206),u=e.i(480028),c=e.i(239337),d=e.i(770257),f={id:"editor.generateOrModifyWithAI",name:"AI",description:"Generate or modify selection with AI",default:(0,l.defaultKeyCombo)({cmdOrCtrl:!0,key:"i"}),scope:"editor"};function p(e){var l=e.editCode,p=e.explainCode,h=e.generateCode,g=e.onMoreClick,m=(0,a.useIsTeamWithAiDisabled)().isTeamWithAiDisabled,x=(0,s.useKeyCombo)(f.id),y=(0,n.useMemo)(function(){if(!x)return[];var e=Array.isArray(x)?x.join(" "):x;return i.keymap.of([{key:e,scope:"editor",run:function(e){return e.state.selection.main.empty?h(e,"shortcut"):l(e,"shortcut"),!0}}])},[x,h,l]),b=(0,n.useMemo)(function(){return{controls:function(e){return m?[]:[{text:"Modify with "+r.ASSISTANT_NAME,icon:(0,t.jsx)(d.default,{size:16,color:u.tokens.blurpleStronger}),onClick:function(){return l(e,"highlight")},shortcut:x},{text:"Explain with "+r.ASSISTANT_NAME,icon:(0,t.jsx)(c.default,{size:16,color:u.tokens.blurpleStronger}),onClick:function(){return p(e,"highlight")}}]},onMoreClick:g}},[l,p,g,x,m]),w=o.SelectionControls.use(b);return(0,n.useMemo)(function(){return[w,y]},[w,y])}e.s(["generateOrModifyWithAICommand",()=>f,"useSelectionControls",()=>p])},159667,e=>{"use strict";var t={gitCommit:{id:"git.commit",name:"Git: Commit",scope:"git",default:(0,e.i(262206).defaultKeyCombo)({cmdOrCtrl:!0,key:"Enter"})}},n=Object.values(t);e.s(["GitCommandScope",()=>"git","commands",()=>t,"gitCommands",()=>n])},256059,e=>{"use strict";var t=e.i(721281),n=e.i(276385),r=e.i(926118),i=e.i(480028),o=e.i(446530),a=e.i(123850),s=e.i(613355),l=e.i(625484),u=(0,a.createCssVarTokens)(["fontSize"]),c=u.cssVars,d=u.styleTokens,f=(0,o.cssRecord)({button:[s.rcss.reset.button,s.rcss.flex.row,s.rcss.align.center,s.rcss.cursor.pointer,s.rcss.hover({opacity:1}),{opacity:.6,fontFamily:i.tokens.fontFamilyDefault,"*":{fontSize:d.fontSize,borderColor:i.tokens.foregroundDimmest,color:i.tokens.foregroundDimmest},":hover *":{borderColor:i.tokens.foregroundDefault,color:i.tokens.foregroundDefault}}],keyCombo:[{marginLeft:"calc(".concat(d.fontSize," * 0.3)")}]});function p(e){return(0,n.jsxs)(l.View,{className:e.className,tag:"button",css:f.button,style:(0,t._)({},c.fontSize,e.fontSize+"px"),onClick:e.onClick,children:[(0,n.jsx)(l.View,{children:e.text}),e.keyCombo?(0,n.jsx)(l.View,{css:f.keyCombo,justify:"center",children:(0,n.jsx)(r.KeyComboBlocks,{fontSize:.8*e.fontSize,keyCombo:e.keyCombo})}):null]})}e.s(["HintButton",()=>p])},759025,e=>{"use strict";var t,n=e.i(276385),r=e.i(389959),i=e.i(358752),o=e.i(61524),a=e.i(441329),s=e.i(256059);e.i(32109);var l=e.i(384401),u=e.i(262206),c=e.i(446530),d=((t={}).Prompt="Prompt",t.CommandStart="CommandStart",t.CommandExecuted="CommandExecuted",t.CommandFinished="CommandFinished",t),f={A:"Prompt",B:"CommandStart",C:"CommandExecuted",D:"CommandFinished"},p={id:"shell.generateWithAI",name:"Generate with AI in the shell",default:(0,u.defaultKeyCombo)({cmdOrCtrl:!0,key:"i"}),scope:"editor"},h=(0,c.cssRecord)({root:{marginLeft:"auto"}});function g(e){var t=e.onFTCSState,u=e.onOpenGeneratePrompt,c=e.onUpdateCurrentPromptLineNumber,d=(0,o.usePreferences)("fontSize").preferences.fontSize,g=(0,r.useRef)(null),m=(0,r.useRef)(null),x=(0,a.useIsInMobileWorkspace)(),y=(0,l.useKeyCombo)(p.id),b=(0,r.useRef)(null);return(0,r.useCallback)(function(e,r){var o=f[r.split(";")[0]];if(o&&t&&t({state:o,data:r.split(";")[1]}),"B"===r){var a,l,p=e.buffer.active,w=p.cursorX,k=p.cursorY;c(k),g.current&&g.current.dispose(),m.current&&m.current.dispose(),b.current&&(b.current.unmount(),b.current=null);var _=Math.round(12.6);g.current=e.registerMarker(0),m.current=null!=(l=e.registerDecoration({marker:g.current,x:Math.max(0,e.cols-_),width:_,layer:"top"}))?l:null,null==(a=m.current)||a.onRender(function(t){for(var r=!1,o=e.buffer.active._buffer.lines._array[k],a=w;a<e.cols;a++)if((null==o?void 0:o.hasContent(a))!==0){r=!0;break}var l=!r;b.current||(b.current=(0,i.createRoot)(t)),b.current.render(l?(0,n.jsx)(s.HintButton,{css:h.root,onClick:function(e){e.stopPropagation(),u()},keyCombo:x?void 0:y,text:"Generate",fontSize:Math.round(.9*d)}):null)})}},[u,c,x,y,d,t])}e.s(["FTCSState",()=>d,"FTCS_OSC_ID",()=>133,"generateWithAIInShellCommand",()=>p,"useInBandFinalTermMessages",()=>g])},917375,e=>{"use strict";var t,n=e.i(276385),r=e.i(480028),i=e.i(446530),o=e.i(613355),a=e.i(625484),s=(0,i.cssRecord)({root:[o.rcss.borderRadius(8),o.rcss.backgroundColor.backgroundRoot,o.rcss.border({color:r.tokens.outlineDimmest})],video:[o.rcss.borderRadius(8),o.rcss.width("100%")]});function l(e){var t=e.src,r=e.autoPlay,i=e.loop,o=e.width;return(0,n.jsx)(a.View,{css:s.root,p:4,style:{width:void 0===o?280:o},children:(0,n.jsx)("video",{css:s.video,src:t,autoPlay:void 0===r||r,loop:void 0===i||i,playsInline:!0,muted:!0})})}var u=e.i(960178),c=((t={}).Welcome="Welcome",t.Editor="Editor",t.Examples="Examples",t.Run="Run",t.Output="Output",t.Sidepane="Sidepane",t.Share="Share",t),d=function(e){return"/public/videos/workspace-onboarding/".concat(e,".mp4")},f=(0,i.cssRecord)({welcome:[o.rcss.maxWidth(400)],tooltipContainer:[o.rcss.width("100%"),o.rcss.center,o.rcss.position.relative],textContainer:[o.rcss.colWithGap(8),o.rcss.width("100%"),o.rcss.py(8)]}),p={id:"workspace-desktop-new-user-tour",steps:[{id:"Welcome",isModal:!0,title:"Welcome to the Workspace",content:function(){return(0,n.jsx)(a.View,{"data-cy":"workspace-tour-welcome",css:f.welcome,children:(0,n.jsxs)(u.Text,{children:["The Workspace is where you create projects on Replit. These are called"," ",(0,n.jsx)("strong",{children:"Apps."}),(0,n.jsx)("br",{}),"Let's explore around!"]})})}},{id:"Editor",title:"Code Editor",content:function(){return(0,n.jsxs)(a.View,{css:f.tooltipContainer,children:[(0,n.jsx)(l,{src:d("editor"),autoPlay:!0,loop:!0}),(0,n.jsx)(a.View,{css:f.textContainer,children:(0,n.jsx)(u.Text,{children:"This is where you write code. The editor helps you by giving you suggestions and coloring your code."})})]})}},{id:"Examples",title:"Examples",content:"Click on one of these examples to insert into your editor",autoSkipIfNoTarget:!0},{id:"Run",title:"Run Button",content:function(){return(0,n.jsxs)(a.View,{css:f.tooltipContainer,children:[(0,n.jsx)(l,{src:d("run-button"),autoPlay:!0,loop:!0}),(0,n.jsx)(a.View,{css:f.textContainer,children:(0,n.jsx)(u.Text,{children:"Tap the Run button to run your code and see its output."})})]})},advanceOnTargetClick:!0},{id:"Output",title:"Output",content:function(){return(0,n.jsxs)(a.View,{css:f.tooltipContainer,children:[(0,n.jsx)(l,{src:d("output"),autoPlay:!0,loop:!0}),(0,n.jsx)(a.View,{css:f.textContainer,children:(0,n.jsx)(u.Text,{children:"This is where your run output appears. This can be text, websites, games, and more depending on the template youre using."})})]})}},{id:"Sidepane",title:"Sidebar",content:function(){return(0,n.jsxs)(a.View,{css:f.tooltipContainer,children:[(0,n.jsx)(l,{src:d("sidebar"),autoPlay:!0,loop:!0}),(0,n.jsxs)(a.View,{css:f.textContainer,children:[(0,n.jsxs)(u.Text,{children:[(0,n.jsx)("strong",{children:"Files"})," is where all of your Apps code is."]}),(0,n.jsxs)(u.Text,{children:[(0,n.jsx)("strong",{children:"Tools"})," is where Packages, Debugger, Chat, Git, and more can be found."]}),(0,n.jsx)(u.Text,{children:"You can drag and drop any file or tool. All tools open as tabs instead of opening in the sidebar."})]})]})}},{id:"Share",title:"Invite & Collaborate",content:function(){return(0,n.jsxs)(a.View,{css:f.tooltipContainer,children:[(0,n.jsx)(l,{src:d("invite-multiplayer"),autoPlay:!0,loop:!0}),(0,n.jsx)(a.View,{css:f.textContainer,children:(0,n.jsx)(u.Text,{children:"Invite others to your App to collaborate and work together at the same time."})})]})}}]};e.s(["TourStepIds",()=>c,"newUserTour",()=>p],917375)},406206,e=>{"use strict";var t=e.i(878420),n=e.i(64386),r=e.i(886513),i=e.i(346715),o=e.i(276385),a=e.i(480028),s=e.i(446530),l=e.i(754873),u=e.i(613355),c=e.i(112767),d=e.i(751273),f=e.i(625484),p=e.i(606867),h=[u.rcss.reset.button,u.rcss.p(2),u.rcss.height(22),u.rcss.rowWithGap(4),u.rcss.align.center,l.interactive.nofill,{transitionProperty:"background-color, box-shadow, opacity",opacity:.8,":focus":{zIndex:1,opacity:1}}],g=(0,s.cssRecord)({button:h,disabledButton:(0,i._)(h).concat([{color:a.tokens.foregroundDimmest,cursor:"default"}]),text:[{fontSize:a.tokens.fontSizeSmall}],switchWrapper:[u.rcss.height(22),u.rcss.pr(4),l.interactive.nofill,{opacity:.8,userSelect:"none","& > label":{gap:0,cursor:"pointer"},"& > label > svg":{scale:"0.6"}}]});function m(e){var i,a=e.altText,s=e.buttonText,l=e.icon,u=(0,r._)(e,["altText","buttonText","icon"]),c=null!=(i=u.disabledTooltip)?i:"This action is disabled";return(0,o.jsx)(d.Tooltip,{tooltip:c,isDisabled:!u.disabled,children:(0,o.jsxs)(f.View,(0,n._)((0,t._)({},u),{alt:a,tag:"button",css:u.disabled?g.disabledButton:g.button,children:[(0,o.jsx)(p.IconContext.Provider,{value:{size:12},children:l}),(0,o.jsx)(f.View,{css:g.text,children:s})]}))})}function x(e){var t=e.text,n=e.isSelected,r=e.onChange;return(0,o.jsx)(f.View,{css:g.switchWrapper,row:!0,align:"center",children:(0,o.jsx)(c.Switch,{colorway:"primary","aria-label":t,isSelected:n,onChange:r,children:(0,o.jsx)(f.View,{css:g.text,children:t})})})}e.s(["PaneHeaderActionButton",()=>m,"PaneHeaderSwitch",()=>x])},782672,e=>{"use strict";var t=e.i(394212),n=e.i(297083),r=e.i(817556),i=e.i(389959);e.i(242933);var o=e.i(279606);e.i(925218);var a=e.i(112077),s=e.i(267103),l=e.i(641555),u=e.i(299798);function c(){var e=(0,a.useCreateObservable)(null);return(0,u.usePid2)(function(i){return(0,n._)(function(){var n,o,a,s,l,u,c,d;return(0,r._)(this,function(r){switch(r.label){case 0:n=i.environment.nixState.subscribe({}).resReadable,o=!1,a=!1,r.label=1;case 1:r.trys.push([1,6,7,12]),l=(0,t._)(n),r.label=2;case 2:return[4,l.next()];case 3:if(!(o=!(u=r.sent()).done))return[3,5];(c=u.value).ok&&e.set(c.payload),r.label=4;case 4:return o=!1,[3,2];case 5:return[3,12];case 6:return d=r.sent(),a=!0,s=d,[3,12];case 7:if(r.trys.push([7,,10,11]),!(o&&null!=l.return))return[3,9];return[4,l.return()];case 8:r.sent(),r.label=9;case 9:return[3,11];case 10:if(a)throw s;return[7];case 11:return[7];case 12:return[2]}})})()},[e]),(0,i.useMemo)(function(){return o.Observable.from(e)},[e])}function d(){var e=c();return(0,l.useObservableMemo)(function(){return e.select(function(e){switch(null==e?void 0:e.status){case"error":case"rebuilding-after-error":return e;default:return null}})},[e],{default:null})}function f(){return(0,s.useObservable)(c())}e.s(["default",()=>f,"useNixError",()=>d])},150316,453726,627563,213447,e=>{"use strict";var t=e.i(530658),n=e.i(346715),r=e.i(276385),i=e.i(389959),o=e.i(908410),a=e.i(721281);e.s(["METADATA_HEIGHT_PX",()=>28,"TASK_CONNECTOR_X_OFFSET",()=>18,"TASK_TYPE_INDICATOR_X_OFFSET",()=>30],453726);var s=e.i(480028),l=e.i(446530),u=e.i(123850),c=e.i(613355),d=(0,u.createCssVarTokens)(["connectorHeight","connectorLeft","markerTop","markerBottom","markerLeft"]),f=d.cssVars,p=d.styleTokens,h=(0,l.cssRecord)({connectorSegmentBorder:[c.rcss.position.absolute,c.rcss.left(p.connectorLeft),c.rcss.width(18),c.rcss.height(p.connectorHeight),c.rcss.top("100%"),{borderRight:"2px solid ".concat(s.tokens.outlineDimmer)}],parallelSegmentBorder:[c.rcss.position.absolute,c.rcss.top(0),c.rcss.left(p.connectorLeft),c.rcss.bottom(0),c.rcss.height(p.connectorHeight),c.rcss.width(18),{borderLeft:"2px solid ".concat(s.tokens.outlineDimmer),borderBottom:"2px solid ".concat(s.tokens.outlineDimmer),borderRadius:"0 0 0 50px"}],parallelSegmentConnectorBorder:[c.rcss.position.absolute,c.rcss.top(0),c.rcss.bottom(0),c.rcss.left(p.connectorLeft),c.rcss.height("115%"),{borderLeft:"2px solid ".concat(s.tokens.outlineDimmer)}],marker:[c.rcss.position.absolute,c.rcss.top(-2),c.rcss.left(-3),c.rcss.height(4),c.rcss.width(4),c.rcss.backgroundColor.foregroundDimmest,c.rcss.borderRadius("full")],sequentialMarkerBorder:[c.rcss.position.relative,c.rcss.top(4),c.rcss.left(p.markerLeft),c.rcss.height(12),c.rcss.width(30),{borderTop:"2px solid ".concat(s.tokens.outlineDimmer),borderRight:"2px solid ".concat(s.tokens.outlineDimmer),borderRadius:"0 10px 0 0"}],parallelMarkerBorder:[c.rcss.position.relative,c.rcss.top(4),c.rcss.left(p.markerLeft),c.rcss.height(12),c.rcss.width(30),{borderLeft:"2px solid ".concat(s.tokens.outlineDimmer)}]});function g(e){var t,n,i=e.mode,o=e.dragAble,s=e.hideBottom,l=void 0!==s&&s,u=e.connectorHeight,c=e.connectorLeft;return"sequential"===(void 0===i?"sequential":i)?(0,r.jsx)(r.Fragment,{children:l?null:(0,r.jsx)("div",{css:h.connectorSegmentBorder,style:(t={},(0,a._)(t,f.connectorHeight,"".concat(null!=u?u:8,"px")),(0,a._)(t,f.connectorLeft,"".concat(null!=c?c:0,"px")),t)})}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{css:h.parallelSegmentBorder,style:(n={width:void 0===o||o?12:18},(0,a._)(n,f.connectorHeight,"".concat(null!=u?u:25,"px")),(0,a._)(n,f.connectorLeft,"".concat(null!=c?c:-12,"px")),n)}),l?null:(0,r.jsx)("div",{css:h.parallelSegmentConnectorBorder,style:(0,a._)({},f.connectorLeft,"".concat(null!=c?c:-12,"px"))})]})}function m(e){var t,n,i=e.top,o=void 0===i?-2:i,s=e.bottom,l=void 0===s?0:s,u=e.left;return"sequential"===e.mode?(0,r.jsx)("div",{css:h.sequentialMarkerBorder,style:(t={},(0,a._)(t,f.markerTop,"".concat(o,"px")),(0,a._)(t,f.markerBottom,"".concat(l,"px")),(0,a._)(t,f.markerLeft,"".concat(u,"px")),t),children:(0,r.jsx)("div",{css:h.marker})}):(0,r.jsx)("div",{css:h.parallelMarkerBorder,style:(n={},(0,a._)(n,f.markerTop,"".concat(o,"px")),(0,a._)(n,f.markerBottom,"".concat(l,"px")),(0,a._)(n,f.markerLeft,"".concat(u,"px")),n),children:(0,r.jsx)("div",{css:h.marker})})}e.s(["ConnectorSegment",()=>g,"ModeMarker",()=>m],627563);var x=e.i(878420),y=e.i(822243),b=e.i(848415),w=e.i(960933),k=e.i(862927),_=e.i(642049),S=e.i(982829),C=e.i(545453),j=e.i(729122),T=e.i(607278),E=e.i(85742),R=e.i(12034),I=e.i(960178),A=e.i(625484),P=(0,l.cssRecord)({root:[c.rcss.rowWithGap(4),c.rcss.align.center],input:[c.rcss.flex.growAndShrink(1),c.rcss.color.foregroundDefault],disabledInput:[c.rcss.flex.growAndShrink(1),c.rcss.borderRadius(4),c.rcss.px(8),c.rcss.py(4),c.rcss.color.foregroundDefault,c.rcss.backgroundColor.backgroundDefault,{opacity:.7}]});function D(e){switch(e.description){case"shell.exec":return(0,r.jsx)(N,{disabled:e.disabled,onArgsBlur:e.onArgsBlur,type:e.type,handleChange:e.handleChange,required:e.required,value:e.value,icon:e.icon,showIcon:e.showIcon});case"workflow.run":return(0,r.jsx)(O,{disabled:e.disabled,onArgsBlur:e.onArgsBlur,type:e.type,handleChange:e.handleChange,required:e.required,value:e.value,icon:e.icon,showIcon:e.showIcon});case"packager.installForLanguage":return(0,r.jsx)(M,{disabled:e.disabled,onArgsBlur:e.onArgsBlur,type:e.type,handleChange:e.handleChange,required:e.required,value:e.value,icon:e.icon,showIcon:e.showIcon});case"packager.installForAll":return(0,r.jsx)(M,{disabled:e.disabled,onArgsBlur:e.onArgsBlur,type:e.type,handleChange:e.handleChange,required:e.required,value:"all",icon:e.icon,showIcon:e.showIcon});default:return(0,r.jsx)(r.Fragment,{})}}function O(e){var t=(0,j.useWorkflows)().filter(function(e){var t;return!(null==(t=e.metadata)?void 0:t.generated)}).map(function(e){return{name:e.name,id:e.name}});return(0,r.jsxs)(A.View,{css:P.root,children:[e.showIcon?e.icon:null,(0,r.jsx)(R.Select,{css:P.input,isDisabled:e.disabled,onBlur:e.onArgsBlur,"aria-label":"Select a Workflow",selectedKey:e.value,onSelectionChange:function(t){"number"!=typeof t&&e.handleChange({type:"args",args:t})},items:t,children:function(e){return(0,r.jsx)(E.ListBoxItem,{label:e.name},e.id)}})]})}function N(e){return(0,r.jsxs)(A.View,{css:P.root,children:[e.showIcon?e.icon:null,e.disabled?(0,r.jsx)(I.Text,{css:P.disabledInput,children:e.value}):(0,r.jsx)(T.Input,{css:P.input,disabled:e.disabled,onBlur:e.onArgsBlur,placeholder:"shell command to execute",onChange:function(t){var n=t.currentTarget.value;e.handleChange({type:"args",args:n})},required:e.required,value:e.value,type:e.type})]})}function M(e){var t=(0,C.usePackagerConfigs)().configs.map(function(e){return{id:e.language}});return t.push({id:"all"}),(0,r.jsxs)(A.View,{css:P.root,children:[e.showIcon?e.icon:null,(0,r.jsx)(R.Select,{css:P.input,isDisabled:e.disabled,onBlur:e.onArgsBlur,"aria-label":"Select a Language to install",selectedKey:e.value,onSelectionChange:function(t){"number"!=typeof t&&("all"===t?e.handleChange({type:"task",task:"packager.installForAll"}):e.handleChange({type:"task",task:"packager.installForLanguage",args:t}))},items:t,children:function(e){return(0,r.jsx)(E.ListBoxItem,{label:e.id},e.id)}})]})}var L=(0,l.cssRecord)({taskSelect:[c.rcss.flex.growAndShrink(1)]});function B(e){var t;return(0,r.jsx)(R.Select,{isDisabled:e.disabled,"aria-label":"Select a task",selectedKey:"packager.installForAll"===(t=e.selectedKey)?"packager.installForLanguage":t,onSelectionChange:function(t){var n=e.supportedTasks;if(!n.includes(t))throw Error("Invalid task name: ".concat(t," (expected one of ").concat(n,")"));e.handleChange({type:"task",task:t})},items:e.items,css:L.taskSelect,children:function(e){return(0,r.jsx)(E.ListBoxItem,{label:e.description,icon:e.icon},e.id)}})}var V=e.i(988676),F=e.i(136540),U=e.i(929872),G=e.i(45262),$=e.i(634669),z=e.i(559073),H=e.i(342574),W=e.i(703505),q=new Map(_.TaskConfigSchema.anyOf.map(function(e){return[e.properties.task.const,e]})),K=["packager.installForAll","packager.installForLanguage","shell.exec","workflow.run"],Y={"shell.exec":{description:"Execute Shell Command",icon:(0,r.jsx)(H.default,{})},"packager.installForLanguage":{description:"Install Packages",icon:(0,r.jsx)($.default,{})},"workflow.run":{description:"Run Workflow",icon:(0,r.jsx)(z.default,{})}};function Q(e){var t=(0,j.useTask)(e),n=(0,j.useDeleteTask)(),i=(0,j.useUpdateWorkflowTask)(),o=(0,j.usePersistConfig)();return t?(0,r.jsx)(J,{disabled:e.disabled,format:e.format,lastTask:e.lastTask,taskIndex:e.taskIndex,initialConfig:t,onArgsBlur:o,onChange:function(t,n){null!==t&&i(e,t,{persist:"task"===n})},onReorder:e.onReorder,onRemove:function(){return n(e)},simplified:e.simplified}):(0,r.jsx)(I.Text,{children:"Task not found"})}w.Type.Object({type:w.Type.Literal("task"),taskIndex:w.Type.Number()});var X=(0,l.cssRecord)({root:[c.rcss.borderRadius(4),c.rcss.p(6),c.rcss.rowWithGap(6)],dragIcon:[{cursor:"grab"}],dropIndicator:[c.rcss.height(4),c.rcss.backgroundColor.blueDefault,c.rcss.m(8),c.rcss.borderRadius()]});function J(e){var n,o,a,s,l,u,c,d=(0,i.useRef)(null),f=(0,t._)((0,i.useState)((null==(n=e.initialConfig)?void 0:n.task)||null),2),p=f[0],h=f[1],g=(0,t._)((0,i.useState)(e.initialConfig&&"args"in e.initialConfig?e.initialConfig.args:null),2),m=g[0],w=g[1];(0,i.useEffect)(function(){e.initialConfig&&(h(e.initialConfig.task),"args"in e.initialConfig&&w(e.initialConfig.args))},[e.initialConfig]);var _=e.disabled?Object.entries(Y).map(function(e){var n=(0,t._)(e,2),r=n[0],i=n[1];return(0,x._)({id:r},i)}):Object.entries(Y).filter(function(e){var n=(0,t._)(e,2),r=n[0];return n[1],K.includes(r)}).map(function(e){var n=(0,t._)(e,2),r=n[0],i=n[1];return(0,x._)({id:r},i)}),C=p?function(e){var t,n=q.get(e);if(!n||!("args"in n.properties))return null;var r=null==(t=n.required)?void 0:t.includes("args");return{type:n.properties.args.type,required:r}}(p):null,j=(0,t._)((0,y.useDrag)(function(){return{type:"task",item:function(){return{type:"task",taskIndex:e.taskIndex}},collect:function(e){return{isDragging:!!e.isDragging()}},canDrag:function(){var e=document.activeElement;return!(e&&("INPUT"===e.tagName||"SELECT"===e.tagName))}}},[e]),2),T=j[0].isDragging,E=j[1],R=(0,t._)((0,b.useDrop)(function(){return{accept:"task",drop:function(t){var n,r=t.taskIndex;null==(n=e.onReorder)||n.call(e,r,e.taskIndex)},collect:function(t){var n=t.getItem(),r=null==n?void 0:n.taskIndex,i=!!t.isOver()&&r!==e.taskIndex;return{isAbove:i&&r>e.taskIndex,isBelow:i&&r<e.taskIndex}}}},[e]),2),I=R[0],P=I.isAbove,O=I.isBelow,N=R[1];function M(t){var n,r,i,o,a="task"===t.type?{task:"task"===t.type?t.task:p,args:null!=(n=t.args)?n:void 0}:{task:p,args:t.args};h(a.task),w(null!=(r=a.args)?r:null);var s=a.task?q.get(a.task):null;if(!s)return null;try{null==(i=e.onChange)||i.call(e,k.Value.Decode(s,a),t.type)}catch(n){null==(o=e.onChange)||o.call(e,null,t.type)}}return e.disabled||E(N(d)),(0,r.jsxs)(r.Fragment,{children:[P?(0,r.jsx)(V.DividerH,{css:X.dropIndicator}):null,(0,r.jsx)(U.Surface,{elevated:!0,disabled:e.disabled,innerRef:d,style:{opacity:T?.5:1},css:X.root,children:(0,r.jsx)(A.View,{grow:!0,shrink:!0,gap:4,children:(0,r.jsxs)(A.View,{row:!0,gap:4,align:"start",justify:"space-between",children:[e.disabled?null:(0,r.jsx)(A.View,{css:X.dragIcon,pt:6,children:(0,r.jsx)(G.default,{})}),(0,r.jsxs)(A.View,{grow:!0,shrink:!0,gap:4,children:[e.simplified?null:(0,r.jsx)(B,{disabled:e.disabled,handleChange:M,selectedKey:p,items:_,supportedTasks:K}),(0,r.jsx)(D,{description:p,disabled:e.disabled,type:null==C?void 0:C.type,value:e.format?(0,S.formatNixStorePath)(null!=(a=null==m?void 0:m.toString())?a:""):null!=(s=null==m?void 0:m.toString())?s:"",required:null!=(l=null==C?void 0:C.required)&&l,handleChange:M,onArgsBlur:e.onArgsBlur,showIcon:e.simplified,icon:p?null==(o=Y[p])?void 0:o.icon:void 0})]}),e.disabled?null:(0,r.jsx)(A.View,{row:!0,gap:8,children:(0,r.jsx)(F.IconButton,{disabled:null!=(u=e.lastTask)&&u,alt:null!=(c=e.lastTask)&&c?"Workflow must have at least one task":"Remove task",onClick:e.onRemove,children:(0,r.jsx)(W.default,{})})})]})})}),O?(0,r.jsx)(V.DividerH,{css:X.dropIndicator}):null]})}e.s(["EditTask",()=>J,"Task",()=>Q],213447);var Z=e.i(140487),ee=e.i(721321),et=e.i(952030);function en(e){var t=e.mode,n=void 0===t?"sequential":t,i=e.onChange,o=e.disabled;return(0,r.jsxs)(ee.ButtonGroup,{disabled:void 0!==o&&o,name:"mode",onChange:i,row:!0,value:null!=n?n:"sequential",children:[(0,r.jsx)(ee.ButtonGroupItem,{id:"sequential",text:"Sequential",value:"sequential"}),(0,r.jsx)(ee.ButtonGroupItem,{id:"parallel",text:"Parallel",value:"parallel"})]})}var er=(0,l.cssRecord)({root:[c.rcss.maxHeight(520),c.rcss.overflow("auto"),c.rcss.backgroundColor.backgroundDefault,c.rcss.borderRadius(0,0,4,4),c.rcss.border({color:s.tokens.backgroundHigher})],connectors:[c.rcss.position.relative,c.rcss.zIndex(0)],inputRow:[c.rcss.position.relative],switchInputs:[c.rcss.position.relative,c.rcss.align.center,c.rcss.justify.spaceBetween],nameWarning:[{color:s.tokens.redDefault}],task:[c.rcss.position.relative,c.rcss.zIndex(1)],tasks:[c.rcss.position.relative],taskItem:[c.rcss.position.relative]});function ei(e){var t,n=e.workflow,i=e.readOnlyMode,o=e.addTask,a=e.reorderTask,s=e.taskIds,l=e.workflowIndex,u=e.simplified;return(0,r.jsxs)(A.View,{children:[n.tasks.length>0?(0,r.jsx)(m,{mode:null!=(t=n.mode)?t:"sequential"}):null,(0,r.jsx)(A.View,{css:er.tasks,pl:12,pb:8,gap:8,children:n.tasks.map(function(e,t,o){var c,d,f,p;return(0,r.jsxs)(A.View,{css:er.taskItem,children:[(0,r.jsx)(g,{dragAble:!i,css:er.connectors,mode:n.mode,hideBottom:t>=o.length-1}),void 0!==l?(0,r.jsx)(Q,{css:er.task,disabled:i,format:null!=(f=null==(c=n.metadata)?void 0:c.generated)&&f,lastTask:1===o.length,onReorder:a,workflowIndex:l,taskIndex:t,simplified:u}):(0,r.jsx)(J,{css:er.task,disabled:i,format:null!=(p=null==(d=n.metadata)?void 0:d.generated)&&p,lastTask:1===o.length,onReorder:a,taskIndex:t,initialConfig:n.tasks[t],onChange:function(){},onRemove:function(){},simplified:u})]},s?s[t]:t)})}),i?null:(0,r.jsx)(Z.Button,{iconLeft:(0,r.jsx)(et.default,{}),text:"Add task",onClick:o})]})}function eo(e){var a,s=e.index,l=e.readOnly,u=(0,j.usePersistConfig)(),c=(0,j.useWorkflow)(s),d=(0,j.useWorkflowNames)(),f=(0,j.useUpdateWorkflow)(),p=(0,j.useUpdateWorkflowTasks)(),h=(0,j.useAddTask)(),g=void 0!==l&&l||(null==c||null==(a=c.metadata)?void 0:a.generated)||(null==c?void 0:c.name)==="Project"&&"agent"===c.author,m=(0,i.useMemo)(function(){return d.filter(function(e){return e===(null==c?void 0:c.name)}).length>1},[c,d]),x=(0,i.useMemo)(function(){var e;return Array.from({length:null!=(e=null==c?void 0:c.tasks.length)?e:0},function(e){return(0,o.nanoid)()})},[null==c?void 0:c.tasks.length]);return c?(0,r.jsxs)(A.View,{css:er.root,p:8,gap:8,children:[(0,r.jsx)(I.Text,{variant:"small",color:"dimmest",children:"Workflow"}),m?(0,r.jsxs)(I.Text,{variant:"small",css:er.nameWarning,children:[c.name," already exists"]}):null,(0,r.jsx)(A.View,{pb:4,row:!0,gap:8,align:"center",children:(0,r.jsx)(T.Input,{onBlur:u,value:c.name,placeholder:"Name of your workflow",onChange:function(e){f(s,function(t){t.name=e.currentTarget.value})},disabled:g})}),(0,r.jsx)(A.View,{css:er.switchInputs,row:!0,gap:4,children:(0,r.jsxs)(A.View,{children:[(0,r.jsx)(I.Text,{variant:"small",color:"dimmest",children:"Mode"}),(0,r.jsx)(en,{mode:c.mode,onChange:function(e){f(s,function(t){t.mode=e}),u()},disabled:g})]})}),(0,r.jsxs)(A.View,{css:er.inputRow,gap:4,children:[(0,r.jsx)(I.Text,{variant:"small",color:"dimmest",children:"Tasks"}),(0,r.jsx)(ei,{workflow:c,readOnlyMode:g,addTask:function(){return h(s)},reorderTask:function(e,r){var i=null==c?void 0:c.tasks;if(i&&e!==r){var o=(0,n._)(i),a=(0,t._)(o.splice(e,1),1)[0];o.splice(r,0,a);var l=(0,t._)(x.splice(e,1),1)[0];x.splice(r,0,l),p({workflowIndex:s},o,{persist:!0}),u()}},taskIds:x,workflowIndex:s})]})]}):(0,r.jsx)(I.Text,{children:"Workflow not found"})}e.s(["ModeSwitcher",()=>en,"Workflow",()=>eo,"WorkflowTasks",()=>ei],150316)},94764,262962,999292,367024,301141,e=>{"use strict";var t=e.i(276385),n=e.i(858248),r=e.i(709485),i=e.i(982829),o=e.i(530658),a=e.i(412160),s=e.i(389959),l=e.i(188507),u=e.i(877212),c=e.i(761201),d=e.i(761732),f=e.i(927158),p=e.i(346715),h=e.i(131141),g=e.i(908410),m=e.i(968323),x=e.i(627563),y=e.i(213447),b=e.i(150316),w=e.i(729122),k=e.i(480028),_=e.i(446530),S=e.i(613355),C=e.i(140487),j=e.i(887877),T=e.i(607278),E=e.i(929872),R=e.i(960178),I=e.i(751273),A=e.i(625484),P=e.i(788124),D=e.i(952030),O=e.i(693908),N=(0,_.cssRecord)({wrapper:[S.rcss.borderRadius(4),S.rcss.border({color:k.tokens.backgroundHigher})],root:[S.rcss.colWithGap(8),S.rcss.maxHeight(520),S.rcss.overflow("hidden")],inputs:[S.rcss.mb(4),S.rcss.p(8)],nameWarning:[{color:k.tokens.redDefault}],taskItem:[S.rcss.position.relative],buttons:[S.rcss.border({direction:"top",color:k.tokens.backgroundHigher})],nameInput:[S.rcss.my(4)]});function M(e){var i=(0,o._)((0,s.useState)(""),2),a=i[0],l=i[1],u=(0,o._)((0,s.useState)([{id:(0,g.nanoid)(),config:null}]),2),c=u[0],d=u[1],f=(0,o._)((0,s.useState)("sequential"),2),k=f[0],_=f[1],S=(0,w.useWorkflowNames)(),M=(0,s.useMemo)(function(){return!S.includes(a)},[a,S]),L=(0,s.useMemo)(function(){if(!a)return(0,m.Err)("Missing name");if(!M)return(0,m.Err)("".concat(a," already exists"));if(0===c.length)return(0,m.Err)("Missing tasks");var t=[],n=!0,r=!1,i=void 0;try{for(var o,s=c[Symbol.iterator]();!(n=(o=s.next()).done);n=!0){var l=o.value;if(null===l.config)return(0,m.Err)("Invalid task");t.push(l.config)}}catch(e){r=!0,i=e}finally{try{n||null==s.return||s.return()}finally{if(r)throw i}}return(0,m.Ok)({name:a,mode:k,author:e.userId,tasks:t})},[a,k,c,M,e.userId]);function B(e,t){if(c&&e!==t){var n=(0,p._)(c),r=(0,o._)(n.splice(e,1),1)[0];n.splice(t,0,r),d(n)}}return(0,t.jsx)(E.Surface,{css:N.wrapper,children:(0,t.jsxs)(j.Form,{css:N.root,onSubmit:function(t){(0,n.track)(r.events.WORKFLOW_CREATED,{pane:"workflows",shellExecCount:c.reduce(function(e,t){var n;return(null==(n=t.config)?void 0:n.task)==="shell.exec"?e+1:e},0),packagerCount:c.reduce(function(e,t){var n,r;return(null==(n=t.config)?void 0:n.task)==="packager.installForAll"||(null==(r=t.config)?void 0:r.task)==="packager.installForLanguage"?e+1:e},0),mode:k,userId:e.userId}),t.preventDefault(),L.ok&&e.onCreate(L.value)},children:[(0,t.jsxs)(A.View,{css:N.inputs,gap:8,children:[(0,t.jsxs)(A.View,{gap:2,children:[(0,t.jsx)(R.Text,{variant:"small",color:"dimmest",children:"Workflow"}),M?null:(0,t.jsx)(R.Text,{variant:"small",css:N.nameWarning,children:"Duplicate workflow name"}),(0,t.jsx)(T.Input,{css:N.nameInput,required:!0,placeholder:"Name",value:a,onChange:function(e){return l(e.currentTarget.value)}})]}),(0,t.jsxs)(A.View,{gap:2,children:[(0,t.jsx)(R.Text,{variant:"small",color:"dimmest",children:"Mode"}),(0,t.jsx)(b.ModeSwitcher,{mode:k,disabled:!1,onChange:_})]}),(0,t.jsxs)(A.View,{gap:2,children:[(0,t.jsx)(R.Text,{variant:"small",color:"dimmest",children:"Tasks"}),c.length?(0,t.jsx)(x.ModeMarker,{mode:k}):null,(0,t.jsxs)(A.View,{pl:12,gap:8,children:[(0,t.jsx)(P.default,{children:c.map(function(e,n){var r;return(0,t.jsxs)(A.View,{css:N.taskItem,children:[(0,t.jsx)(y.EditTask,{taskIndex:n,disabled:!1,format:!1,onReorder:B,onChange:function(e){d(function(t){return(0,h.produce)(t,function(t){t[n].config=e})})},onRemove:function(){d(function(e){return(0,h.produce)(e,function(e){e.splice(n,1)})})},initialConfig:null!=(r=c[n].config)?r:void 0}),(0,t.jsx)(x.ConnectorSegment,{mode:k,hideBottom:n>=c.length-1})]},e.id)})}),(0,t.jsx)(C.Button,{text:"Add task",type:"button",onClick:function(){d(function(e){return(0,h.produce)(e,function(e){e.push({id:(0,g.nanoid)(),config:null})})})},iconLeft:(0,t.jsx)(D.default,{})})]})]})]}),(0,t.jsxs)(A.View,{css:N.buttons,grow:!0,shrink:!0,justify:"end",p:8,row:!0,gap:12,children:[(0,t.jsx)(C.Button,{text:"Cancel",onClick:e.onCancel}),(0,t.jsx)(I.Tooltip,{tooltip:L.ok?"Save Workflow":L.error,children:(0,t.jsx)(C.Button,{iconLeft:(0,t.jsx)(O.default,{}),colorway:"primary",disabled:!L.ok,text:"Save",type:"submit"})})]})]})})}var L=e.i(878420),B=e.i(569384),V=e.i(973245),F=e.i(304277);function U(){var e=(0,B._)(["\n  query CurrentUserEnv {\n    currentUser {\n      id\n      username\n    }\n  }\n"]);return U=function(){return e},e}e.i(566901);var G={},$=(0,V.gql)(U());function z(){var e,t=(e=(0,L._)({},G,void 0),F.useQuery($,e)).data;return(null==t?void 0:t.currentUser)||void 0}e.s(["useCurrentUser",()=>z],262962);var H=e.i(417120),W=e.i(965153),q=e.i(988676),K=e.i(136540),Y=e.i(739521),Q=e.i(719976),X=e.i(51054),J=e.i(396776),Z=e.i(557862),ee=e.i(940745),et=e.i(978669),en=e.i(796817),er=e.i(703505),ei=e.i(42458);function eo(e){var t=(0,w.useGetWorkflows)(),i=(0,f.usePid2Callback)(function(i){return function(){(0,n.track)(r.events.WORKFLOW_RAN,{source:"workflowsPane"});var o,a=null==(o=t())?void 0:o[e];return!!a&&i.workflows.runWorkflow.rpc({workflowId:a.name})}},[t,e]),o=(0,w.useGetLatestWorkflowState)(e),a=(0,f.usePid2Callback)(function(e){return function(){(0,n.track)(r.events.WORKFLOW_STOPPED,{source:"workflowsPane"});var t,i=null==(t=o())?void 0:t.runId;return!!i&&e.workflows.stopRun.rpc({runId:i})}},[o]),l=(0,w.useObservableIsRunning)(e);return(0,s.useMemo)(function(){return i&&a?{run:i,stop:a,isRunningObservable:l}:null},[i,a,l])}function ea(e){var n=e.index,r=(0,w.useWorkflow)(n),i=eo(n),o=(0,d.default)(null==i?void 0:i.isRunningObservable);return r&&i?(0,t.jsx)(A.View,{row:!0,gap:8,children:(0,t.jsx)(C.Button,{size:"small",iconLeft:o?(0,t.jsx)(en.default,{}):(0,t.jsx)(et.default,{}),text:r.name,onClick:function(){o?i.stop():i.run()}})}):null}function es(){var e=(0,w.useWorkflowIndices)(),n=(0,w.useWorkflows)();return(0,t.jsx)(A.View,{gap:8,children:e.filter(function(e){var t;return!(null==(t=n[e].metadata)?void 0:t.generated)}).map(function(e){return(0,t.jsx)(ea,{index:e},e)})})}var el=(0,_.cssRecord)({wrapper:[S.rcss.borderRadius(4),S.rcss.backgroundColor.backgroundHigher],expandedContent:[S.rcss.border({direction:"top"})]});function eu(e){var n,r=e.index,i=e.readOnly,a=(0,w.useWorkflow)(r),l=(0,w.useWorkflowError)(r),u=eo(r),c=(0,d.default)(null==u?void 0:u.isRunningObservable),f=(0,o._)((0,s.useState)(!1),2),p=f[0],h=f[1],g=(0,w.useDeleteWorkflow)(),m=(0,w.useRunButton)(),x=(0,s.useMemo)(function(){return(null==a?void 0:a.name)===m},[a,m]);return a?(0,t.jsxs)(E.Surface,{children:[(0,t.jsx)(W.AccordionItem,{css:el.wrapper,headerContent:(0,t.jsxs)(A.View,{grow:!0,shrink:!0,row:!0,gap:4,children:[u?(0,t.jsx)(K.IconButton,{alt:c?"Stop workflow":"Run workflow",onClick:function(){c?u.stop():u.run()},children:c?(0,t.jsx)(en.default,{}):(0,t.jsx)(et.default,{})}):null,(0,t.jsx)(A.View,{grow:!0,shrink:!0,row:!0,gap:8,align:"center",justify:"start",children:(0,t.jsx)(R.Text,{multiline:!1,children:a.name})}),(0,t.jsxs)(A.View,{row:!0,gap:4,align:"center",children:[l?(0,t.jsx)(I.Tooltip,{tooltip:l,children:(0,t.jsx)(ei.default,{color:k.tokens.accentNegativeDefault})}):null,x?(0,t.jsx)(I.Tooltip,{tooltip:"Assigned to run button",maxWidth:150,children:(0,t.jsx)(Q.PillButton,{text:"Run Button",colorway:"positive"})}):null,"agent"===a.author||(null==(n=a.metadata)?void 0:n.generated)?(0,t.jsx)(I.Tooltip,{tooltip:"Generated by ".concat(a.author),maxWidth:150,children:(0,t.jsx)(Q.PillButton,{text:"Generated",colorway:"purple"})}):(0,t.jsx)(K.IconButton,{alt:"Delete",onClick:function(){h(!0)},children:(0,t.jsx)(er.default,{})})]})]}),children:(0,t.jsx)(A.View,{css:el.expandedContent,children:(0,t.jsx)(b.Workflow,{index:r,readOnly:i})})}),(0,t.jsx)(Y.Modal,{isOpen:p,onRequestClose:function(){return h(!1)},children:(0,t.jsx)(Z.default,{name:"Workflow",description:a.name,confirmDescription:"workflow",hideModal:function(){return h(!1)},delete:function(){return g(r)}})})]}):null}var ec=(0,_.cssRecord)({generatedList:[{opacity:.7}],loading:[S.rcss.center,S.rcss.p(16)],error:[S.rcss.center,S.rcss.p(16)],divider:[S.rcss.height(2),S.rcss.backgroundColor.accentPrimaryDimmest]});function ed(){var e=(0,o._)((0,s.useState)(""),2),i=e[0],d=e[1],f=(0,o._)((0,s.useState)(!1),2),p=f[0],h=f[1],g=(0,u.useSupportsAgent)(),m=(0,H.useAgentRunState)(),x=(0,o._)((0,s.useState)(!1),2),y=x[0],b=x[1],k=(0,w.useWorkflowIndices)(),_=(0,w.useWorkflows)(),S=(0,w.useWorkflowNames)(),j=(0,w.useAddWorkflow)(),T=(0,w.useIsLoading)(),E=(0,w.useConfigError)(),P=z(),O=!!E||g&&(m===l.AgentRunState.AGENT_STATE_RUNNING||m===l.AgentRunState.AGENT_STATE_PAUSING),N=(0,s.useMemo)(function(){return k.reduce(function(e,t){return S[t].toLowerCase().includes(i.toLowerCase())&&e.push(t),e},[]).sort(function(e,t){var n,r,i,o,a=null!=(i=(null==(n=_[e].metadata)?void 0:n.generated)||"agent"===_[e].author)&&i,s=null!=(o=(null==(r=_[t].metadata)?void 0:r.generated)||"agent"===_[t].author)&&o;return a&&!s?1:!a&&s?-1:0})},[i,k,S,_]),L=(0,s.useMemo)(function(){return N.filter(function(e){var t=_[e];return!(t.metadata&&t.metadata.generated)&&"agent"!==t.author})},[N,_]),B=(0,s.useMemo)(function(){return N.filter(function(e){return"agent"===_[e].author})},[N,_]),V=(0,s.useRef)(),F=function(){clearTimeout(V.current),V.current=setTimeout(function(){(0,n.track)(r.events.WORKFLOWS_SEARCHED)},1e3)};return T?(0,t.jsx)(A.View,{css:ec.loading,children:(0,t.jsx)(ee.default,{})}):(0,t.jsxs)(A.View,{p:8,gap:8,children:[(0,t.jsxs)(A.View,{row:!0,gap:8,children:[(0,t.jsx)(A.View,{grow:!0,shrink:!0,children:(0,t.jsx)(X.SearchBar,{placeholder:"Search for a workflow...",value:i,onChange:function(e){F(),d(e.target.value)},onClear:function(){return d("")}})}),(0,t.jsx)(I.Tooltip,{tooltip:"Workflow editing is disabled while the Agent is running",isDisabled:!O,children:(0,t.jsx)(C.Button,{isDisabled:O,colorway:"primary",iconLeft:(0,t.jsx)(D.default,{}),text:"New Workflow",disabled:p,onClick:function(){h(!0)}})})]}),(0,t.jsx)(q.DividerH,{}),p?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(M,{onCreate:function(e){j(e),h(!1)},onCancel:function(){h(!1)},userId:null==P?void 0:P.id}),(0,t.jsx)(q.DividerH,{css:ec.divider})]}):null,E?(0,t.jsx)(A.View,{css:ec.error,children:(0,t.jsx)(I.Tooltip,{tooltip:E.extras,children:(0,t.jsx)(J.StatusBanner,{icon:(0,t.jsx)(ei.default,{}),colorway:"red",text:E.message})})}):null,(0,t.jsxs)(A.View,{gap:8,children:[L.length||E?null:(0,t.jsx)(A.View,{align:"center",children:(0,t.jsx)(R.Text,{children:(0,t.jsx)(a.default,{target:"_blank",href:c.LINKS_DOCS.WORKFLOWS,children:"Learn more about configuring Workflows"})})}),L.length?L.map(function(e){return(0,t.jsx)(eu,{readOnly:O,index:e},e)}):null,B.length?(0,t.jsx)(A.View,{children:(0,t.jsx)(W.AccordionItem,{headerContent:"Agent Workflows",expanded:y,onClick:function(){return b(!y)},children:(0,t.jsx)(A.View,{css:ec.generatedList,py:8,gap:8,children:B.map(function(e){return(0,t.jsx)(eu,{index:e,readOnly:O},e)})})})}):null]})]})}e.s(["WorkflowsConsoleList",()=>es,"default",()=>ed],999292);var ef=e.i(357399),ep=(0,_.cssRecord)({emptyStateWrapper:[{lineHeight:"32px"}]});function eh(e){var o,a=e.openPane,s=(0,w.useWorkflowsRunner)(),l=(0,w.useIsLoading)(),u=!!(null==s?void 0:s.workflowId),c=function(){if(null==s?void 0:s.run){s.run(i.RunReason.RUN_BUTTON_CLICKED),(0,n.track)(r.events.WORKFLOW_RAN,{source:"console"});return}};return l?(0,t.jsx)(A.View,{css:ep.emptyStateWrapper,p:8,children:"The system is starting up"}):(0,t.jsxs)(A.View,{p:8,gap:8,children:[(0,t.jsx)(R.Text,{children:"Results of your code will appear here when you run"}),(0,t.jsx)(q.DividerH,{}),(0,t.jsxs)(A.View,{pt:4,pb:8,gap:6,align:"start",children:[(0,t.jsx)(R.Text,{variant:"small",color:"dimmer",children:"Default"}),(0,t.jsx)(C.Button,{size:"small",text:null!=(o=null==s?void 0:s.workflowId)?o:i.PID1_RUNNER_NAME,iconLeft:(0,t.jsx)(et.default,{}),colorway:"positive",onClick:function(){(0,n.track)(r.events.WORKSPACE,{action:"run_button_used",usage:"clicked",source:"emptyConsole",runner:u?"workflows":"pid1"}),c()}})]}),(0,t.jsx)(q.DividerH,{}),(0,t.jsxs)(A.View,{gap:6,children:[(0,t.jsxs)(A.View,{row:!0,gap:4,align:"center",children:[(0,t.jsx)(R.Text,{variant:"small",color:"dimmer",children:"Workflows"}),(0,t.jsx)(K.IconButton,{alt:"Configure",onClick:function(){a({type:"workflows"})},children:(0,t.jsx)(ef.default,{size:12})})]}),(0,t.jsx)(es,{})]})]})}e.s(["default",()=>eh],94764);var eg=e.i(119468);function em(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.onlyFirst;return RegExp("[\\u001B\\u009B][[\\]()#;?]*(?:(?:(?:(?:;[-a-zA-Z\\d\\/#&.:=?%@~_]+)*|[a-zA-Z\\d]+(?:;[-a-zA-Z\\d\\/#&.:=?%@~_]*)*)?\\u0007)|(?:(?:\\d{1,4}(?:;\\d{0,4})*)?[\\dA-PR-TZcf-ntqry=><~]))",void 0!==t&&t?void 0:"g")}e.s(["default",()=>em],367024);var ev=em();function ex(e){if("string"!=typeof e)throw TypeError("Expected a `string`, got `".concat(void 0===e?"undefined":(0,eg._)(e),"`"));return e.replace(ev,"")}e.s(["default",()=>ex],301141)},230776,e=>{"use strict";var t=e.i(297083),n=e.i(878420),r=e.i(64386),i=e.i(817556),o=e.i(862927),a=e.i(329252),s=e.i(230153),l=e.i(112942),u=e.i(45442);function c(e){var t=e.text,n=e.attachedFiles,r=e.agentConfig,i=e.targetedElement,a=n.map(function(e){return{path:e.path,mimeType:e.mimeType}}),u=o.Value.Create(s.MessageEventContentsSchema);return u.content=t,u.uploadedFiles=a,r&&(u.agentConfig=o.Value.Create(s.AgentConfigSchema),Object.assign(u.agentConfig,(0,l.convertAgentConfigFromGQLToChort)(r))),i&&(u.targetedElement=i),u}function d(e){return(0,t._)(function(e){var o,s,c,d,f,p;return(0,i._)(this,function(h){switch(h.label){case 0:return o=e.contents,s=e.readFile,c=o.content,[4,Promise.all(o.uploadedFiles.map(function(e){return(0,t._)(function(){var t,o,a;return(0,i._)(this,function(i){switch(i.label){case 0:return t=e.path.split("/").pop()||"attachment",[4,s(e.path)];case 1:return a=new File(null===(o=i.sent()).error&&null!==o.content.asBuffer?[o.content.asBuffer]:[],t,{type:e.mimeType}),[2,(0,r._)((0,n._)({},e),{file:a,isLoading:!1})]}})})()}))];case 1:return d=h.sent(),f=o.agentConfig?(0,a.default)((0,l.convertAgentConfigFromChortToGQL)(o.agentConfig),u.DEFAULT_AGENT_SETTINGS):void 0,p=o.targetedElement,[2,{message:c,attachments:d,agentConfig:f,webviewTargetedElement:p}]}})}).apply(this,arguments)}e.s(["packContentsForQueuedMessage",()=>c,"unpackContentsFromQueuedMessage",()=>d])},978799,e=>{"use strict";var t=e.i(530658),n=e.i(276385),r=e.i(389959),i=e.i(569910),o=e.i(546284),a=e.i(739434),s=e.i(801127),l=e.i(952521),u=e.i(446530),c=e.i(613355),d=e.i(140487),f=e.i(136540),p=e.i(960178),h=e.i(625484),g=e.i(283110),m=e.i(987154),x=e.i(793188),y=e.i(357399),b=(0,u.cssRecord)({wrapper:[c.rcss.py(6),c.rcss.flex.row,c.rcss.align.center,c.rcss.backgroundColor.backgroundHigher],wrapperWarning:[c.rcss.py(6),c.rcss.flex.row,c.rcss.align.center,c.rcss.backgroundColor.orangeDimmest],firstLine:[c.rcss.flex.wrap,c.rcss.maxWidth("100%"),c.rcss.overflow("hidden")],secondLine:[c.rcss.px(6),c.rcss.rowWithGap(2),c.rcss.align.center,c.rcss.flex.wrap,c.rcss.maxWidth("100%"),c.rcss.overflow("hidden"),c.rcss.color.foregroundDimmest],secondLineWarning:[c.rcss.px(6),c.rcss.rowWithGap(2),c.rcss.align.center,c.rcss.flex.wrap,c.rcss.maxWidth("100%"),c.rcss.overflow("hidden"),c.rcss.color.orangeStrongest],verticalDivider:[c.rcss.ml(6),c.rcss.mr(6),c.rcss.height("1em"),c.rcss.width(1),c.rcss.backgroundColor.foregroundDefault]});function w(e){var t=e.openNetworkingTool,r=e.onClose,i=e.onDontExposePort,o=e.onDoExposePort,a=e.firstLine,s=e.secondLine,l=e.renderSecondLine,u=e.renderDontExposeButton,c=e.renderDoExposeButton,d=e.isWarning,p=void 0!==d&&d;return(0,n.jsxs)(h.View,{css:p?b.wrapperWarning:b.wrapper,children:[(0,n.jsxs)(h.View,{grow:!0,shrink:!0,children:[(0,n.jsx)(h.View,{css:b.firstLine,px:6,row:!0,gap:2,align:"center",children:a}),l?(0,n.jsx)(h.View,{css:p?b.secondLineWarning:b.secondLine,children:s}):null]}),(0,n.jsxs)(h.View,{pr:6,row:!0,children:[(0,n.jsx)(f.IconButton,{alt:"Networking tool",onClick:t,children:(0,n.jsx)(y.default,{})}),void 0!==u&&u?(0,n.jsx)(f.IconButton,{alt:"Don't expose this port to the web",onClick:i,children:(0,n.jsx)(x.default,{})}):null,void 0!==c&&c?(0,n.jsx)(f.IconButton,{alt:"Expose this port to the web",onClick:o,children:(0,n.jsx)(m.default,{})}):null,(0,n.jsx)(f.IconButton,{alt:"Close",onClick:r,children:(0,n.jsx)(g.default,{})})]})]})}function k(e){var t=e.configuration,r=e.openWebview,i=e.openNetworkingTool,o=e.onClose,s=e.onDontExposePort,l=e.renderSecondLine,u=(0,a.isDefaultPort)(t.externalPort)?"{...}.replit.dev":"{...}.replit.dev:".concat(t.externalPort);return(0,n.jsx)(w,{openNetworkingTool:i,onClose:o,firstLine:(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(p.Text,{children:["Port :",t.localPort," opened on"]}),(0,n.jsx)(d.Button,{variant:"underlined",text:u,onClick:r})]}),secondLine:(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(p.Text,{children:"You can manage this config in the"}),(0,n.jsx)(d.Button,{variant:"underlined",text:"Networking tool",onClick:i})]}),renderSecondLine:l,renderDontExposeButton:!0,onDontExposePort:s})}function _(e){var t=e.configuration,r=e.openNetworkingTool,i=e.onClose,o=e.renderSecondLine,a=e.onDoExposePort;return(0,n.jsx)(w,{openNetworkingTool:r,onClose:i,firstLine:"Port :".concat(t.localPort," opened, but not exposed to the web."),secondLine:(0,n.jsx)(d.Button,{variant:"underlined",text:"Expose this port?",onClick:r}),renderSecondLine:o,renderDoExposeButton:!0,onDoExposePort:a})}function S(e){var t=e.openNetworkingTool,r=e.configuration,i=e.onClose,o=e.renderSecondLine;return(0,n.jsx)(w,{isWarning:!0,openNetworkingTool:t,onClose:i,firstLine:"Port :".concat(r.localPort," opened, but all available external ports are reserved."),secondLine:(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(p.Text,{children:"Remove an external port in"}),(0,n.jsx)(d.Button,{variant:"underlined",text:"port configuration",onClick:t}),(0,n.jsx)(p.Text,{children:"to open a new port."})]}),renderSecondLine:o})}function C(e){var t=e.openNetworkingTool,r=e.configuration,i=e.onClose,o=e.renderSecondLine;return(0,n.jsx)(w,{isWarning:!0,openNetworkingTool:t,onClose:i,firstLine:"Port :".concat(r.localPort," opened, but is not configured properly."),secondLine:(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(p.Text,{children:"You can fix this in the"}),(0,n.jsx)(d.Button,{variant:"underlined",text:"Networking tool",onClick:t})]}),renderSecondLine:o})}function j(e){var t=e.openNetworkingTool,r=e.configuration,i=e.onClose,o=e.renderSecondLine;return(0,n.jsx)(w,{isWarning:!0,openNetworkingTool:t,onClose:i,firstLine:"Port :".concat(r.localPort," opened, but has missing configuration."),secondLine:(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(p.Text,{children:"You can fix this in the"}),(0,n.jsx)(d.Button,{variant:"underlined",text:"Networking tool",onClick:t})]}),renderSecondLine:o})}function T(e){var t=e.configuration,r=e.openWebview,o=e.openNetworkingTool,a=e.onClose,l=e.onDontExposePort,u=e.onDoExposePort,c=e.renderSecondLine,d=t.type;switch(d){case s.PortConfigurationType.FORWARDED:return(0,n.jsx)(k,{configuration:t,openWebview:r,openNetworkingTool:o,onClose:a,renderSecondLine:c,onDontExposePort:l});case s.PortConfigurationType.INTERNAL_ONLY:return(0,n.jsx)(_,{configuration:t,openNetworkingTool:o,onClose:a,renderSecondLine:c,onDoExposePort:u});case s.PortConfigurationType.NO_MORE_EXTERNAL_PORTS_AVAILABLE:return(0,n.jsx)(S,{configuration:t,openNetworkingTool:o,onClose:a,renderSecondLine:c});case s.PortConfigurationType.MISCONFIGURED:return(0,n.jsx)(C,{configuration:t,openNetworkingTool:o,onClose:a,renderSecondLine:c});case s.PortConfigurationType.CONFIG_MISSING:return(0,n.jsx)(j,{configuration:t,openNetworkingTool:o,onClose:a,renderSecondLine:c});default:(0,i.default)(d)}}function E(e){var t=e.configurations,r=e.openWebview,i=e.openNetworkingTool,a=e.onClose,l=e.renderSecondLine,u=t.filter(function(e){return e.type===s.PortConfigurationType.FORWARDED}),c=t.filter(function(e){return e.type!==s.PortConfigurationType.FORWARDED});return(0,n.jsx)(w,{isWarning:!1,openNetworkingTool:i,onClose:a,firstLine:(0,n.jsxs)(n.Fragment,{children:[u.length>0?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(p.Text,{children:[u.length," ",(0,o.default)("port",u.length)," ","opened on"]}),(0,n.jsx)(d.Button,{variant:"underlined",text:"{...}.replit.dev",onClick:r})]}):null,u.length>0&&c.length>0?(0,n.jsx)(h.View,{css:b.verticalDivider}):null,c.length>0?(0,n.jsxs)(p.Text,{children:[c.length," ",(0,o.default)("port",c.length)," ","did not open"]}):null]}),secondLine:(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(p.Text,{children:"You can manage this config in the"}),(0,n.jsx)(d.Button,{variant:"underlined",text:"Networking tool",onClick:i})]}),renderSecondLine:l})}function R(e){var i=e.configurations,o=e.openWebview,a=e.openNetworkingTool,s=e.onClose,u=e.onDontExposePort,c=e.onDoExposePort,d=(0,l.useMemoedDismissibleElement)("port-nudges"),f=(0,t._)((0,r.useState)(!1),2),p=f[0],h=f[1],g=!d.isDone,m=(0,t._)((0,r.useState)(!0),2),x=m[0],y=m[1];function b(){y(!1),null==s||s()}return((0,r.useEffect)(function(){0===i.length&&y(!0)},[i]),(0,r.useEffect)(function(){if(!d.isDone){if(i.length>0&&!p)return void h(!0);0===i.length&&p&&d.setAsDone()}},[i,d,p]),x&&0!==i.length)?1===i.length?(0,n.jsx)(T,{configuration:i[0],openNetworkingTool:a,openWebview:o,renderSecondLine:g,onClose:b,onDontExposePort:u,onDoExposePort:c}):(0,n.jsx)(E,{configurations:i,openNetworkingTool:a,openWebview:o,renderSecondLine:g,onClose:b}):null}e.s(["PortInfo",()=>R])},319401,646067,926587,337805,73213,389320,831733,e=>{"use strict";var t,n=e.i(937500),r=e.i(394212),i=e.i(297083),o=e.i(721281),a=e.i(878420),s=e.i(64386),l=e.i(530658),u=e.i(817556),c=e.i(276385),d=e.i(389959),f=e.i(301141),p=e.i(877212),h=e.i(924908),g=e.i(346574),m=e.i(569910),x=e.i(162914),y=e.i(649960),b=e.i(664152),w=e.i(315801),k=e.i(670413),_=e.i(546284),S=e.i(299798),C=e.i(927158),j=e.i(801127),T=e.i(909478),E=e.i(982829),R=e.i(230776),I=e.i(417120),A=e.i(762211);e.i(429225);var P=e.i(84396),D=e.i(978799),O=e.i(790155),N=e.i(993796),M=e.i(610357),L=e.i(106020),B=e.i(759025);e.i(32109);var V=e.i(384401),F=e.i(262206),U=e.i(480028),G=e.i(107413),$=e.i(51606),z=e.i(266374),H=e.i(437181),W=e.i(793579),q=e.i(342574),K=e.i(476891);function Y(e){var t,n,r,o,a,s,l,f,p=e.xterm,h=e.openShellSearch,g=e.openSearchAndReplace,m=e.openGeneratePrompt,x=e.isWorkflowsTerminal,y=(t=(0,N.useFlag)({controlName:"flag-killswitch-ghostwriter-chat",logFlagToAnalytics:!1}),n=(0,V.useKeyCombo)(B.generateWithAIInShellCommand.id),(0,d.useMemo)(function(){if(!t){var e=[];if(m&&e.push({match:L.matchLabel,data:{type:"action",label:"Generate command",icon:(0,c.jsx)(H.default,{color:U.tokens.tealStronger}),keyboardShortcut:n,run:function(){m()}}}),0!==e.length)return{data:{type:"context",label:"AI",icon:(0,c.jsx)(z.default,{})},commands:function(){return e}}}},[t,n,m])),b=(o=(r={xterm:p,openShellSearch:h,openSearchAndReplace:g,isWorkflowsTerminal:void 0!==x&&x}).xterm,a=r.openShellSearch,s=r.openSearchAndReplace,l=r.isWorkflowsTerminal,(0,d.useMemo)(function(){var e=[];if(a){var t=l?(0,c.jsx)(K.default,{}):(0,c.jsx)(q.default,{});e.push({match:L.matchLabel,data:{type:"action",label:l?"Find in Console":"Find in Shell",icon:t,run:function(){var e;a(null!=(e=null==o?void 0:o._term.getSelection())?e:"")}}})}if(s&&e.push({match:L.matchLabel,data:{type:"action",label:"Find in Repl",icon:(0,c.jsx)(W.default,{}),run:function(){var e;s(null!=(e=null==o?void 0:o._term.getSelection())?e:"")}}}),0!==e.length)return{data:{type:"context",label:"Search",icon:(0,c.jsx)(W.default,{})},commands:function(){return e}}},[o,a,s,l])),w=(f=function(){return window.navigator.userAgent.includes("Linux")},(0,d.useMemo)(function(){return{data:{type:"context",label:"Clipboard",icon:(0,c.jsx)(G.default,{})},commands:function(){return[{match:L.matchLabel,data:{type:"action",label:"Copy",icon:(0,c.jsx)($.default,{}),keyboardShortcut:(0,F.defaultKeyCombo)({cmdOrCtrl:!0,shift:f(),key:"c"}),run:function(){var e,t=null!=(e=null==p?void 0:p._term.getSelection())?e:"";(0,M.default)(t)}}},{match:L.matchLabel,data:{type:"action",label:"Paste",icon:(0,c.jsx)(G.default,{}),keyboardShortcut:(0,F.defaultKeyCombo)({cmdOrCtrl:!0,shift:f(),key:"v"}),run:function(){return(0,i._)(function(){var e,t;return(0,u._)(this,function(n){switch(n.label){case 0:e="",n.label=1;case 1:return n.trys.push([1,3,,4]),[4,window.navigator.clipboard.readText()];case 2:return e=n.sent(),[3,4];case 3:return t=n.sent(),O.logger.error("Shell context menu paste failed",{message:t.message}),[2];case 4:return null==p||p._term.paste(e),[2]}})})()}}}]}}},[p]));return(0,d.useMemo)(function(){var e=[];return y&&e.push(y),b&&e.push(b),w&&e.push(w),{data:{type:"context",label:"Search actions",icon:(0,c.jsx)(W.default,{})},commands:function(){return e}}},[y,b,w])}e.s(["useGetShellContextMenuCommand",()=>Y],646067);var Q=e.i(967629),X=e.i(613355),J=e.i(140487),Z=(0,Q.css)(X.rcss.display.flex,X.rcss.align.center,X.rcss.height(30),{"input, button":[X.rcss.my(0),X.rcss.mx(4)],input:[X.rcss.py(4),X.rcss.px(8),X.rcss.backgroundColor.backgroundDefault,X.rcss.color.foregroundDefault,X.rcss.height(24),X.rcss.width(85),X.rcss.borderRadius(4),X.rcss.focusRing,{border:"none",boxShadow:"none","&::placeholder":[X.rcss.color.foregroundDefault],"&:focus":[{outline:"none",borderColor:U.tokens.accentPrimaryDefault}]}]});function ee(e){var t=e.searchValue,n=e.setSearchValue,r=e.findNext,i=e.findPrevious,o=e.exit,a=(0,d.useRef)(null);(0,d.useEffect)(function(){a.current&&a.current.focus()},[]);var s=function(e){"Escape"===e.key?o():"Enter"===e.key&&(e.shiftKey?i(t):r(t))};return(0,c.jsxs)("div",{css:Z,children:[(0,c.jsx)("input",{ref:a,placeholder:"Find",value:t,onChange:function(e){return n(e.target.value)},onKeyDown:function(e){return s(e)}}),(0,c.jsx)(J.Button,{size:"small",onClick:function(){return r(t)},text:"Next"}),(0,c.jsx)(J.Button,{size:"small",onClick:function(){return i(t)},text:"Previous"}),(0,c.jsx)(J.Button,{size:"small",onClick:o,text:"Exit"})]})}e.s(["SearchWidget",()=>ee],926587);var et=e.i(262962);e.i(545082);var en=e.i(663762),er=e.i(818976),ei=e.i(358752),eo=e.i(606867);function ea(e){return(0,c.jsxs)(eo.default,(0,s._)((0,a._)({},e),{children:[(0,c.jsx)("path",{d:"M8.09945 1.00012C9.8352 1.00012 11.2423 2.40723 11.2423 4.14298L11.2422 4.16743C11.2554 6.75801 13.358 8.85436 15.951 8.85727L15.9566 8.85726C17.6924 8.85726 19.0995 10.2644 19.0995 12.0001C19.0995 13.7359 17.6924 15.143 15.9566 15.143C13.3611 15.143 11.2554 17.2404 11.2422 19.8328C11.2423 19.841 11.2423 19.8491 11.2423 19.8573C11.2423 21.593 9.8352 23.0001 8.09945 23.0001C6.3637 23.0001 4.9566 21.593 4.9566 19.8573C4.9566 18.1215 6.3637 16.7144 8.09945 16.7144C8.10155 16.7144 8.10365 16.7144 8.10575 16.7144C10.7064 16.7109 12.8136 14.6016 12.8136 12.0001C12.8136 9.39653 10.703 7.2859 8.09939 7.28584C6.36367 7.28581 4.9566 5.87871 4.9566 4.14298C4.9566 2.40723 6.3637 1.00012 8.09945 1.00012Z",fill:"url(#paint0_linear_434_35354)"}),(0,c.jsx)("path",{d:"M11.2423 12.0001C11.2423 10.2644 9.83518 8.85729 8.09943 8.85729C6.36368 8.85729 4.95657 10.2644 4.95657 12.0001C4.95657 13.7359 6.36368 15.143 8.09943 15.143C9.83518 15.143 11.2423 13.7359 11.2423 12.0001Z",fill:"url(#paint1_linear_434_35354)"}),(0,c.jsxs)("defs",{children:[(0,c.jsxs)("linearGradient",{id:"paint0_linear_434_35354",x1:"4.95657",y1:"1.00012",x2:"25.7048",y2:"15.5274",gradientUnits:"userSpaceOnUse",children:[(0,c.jsx)("stop",{stopColor:"#69D9F0"}),(0,c.jsx)("stop",{offset:"1",stopColor:"#0093B0"})]}),(0,c.jsxs)("linearGradient",{id:"paint1_linear_434_35354",x1:"4.95657",y1:"1.00012",x2:"25.7048",y2:"15.5274",gradientUnits:"userSpaceOnUse",children:[(0,c.jsx)("stop",{stopColor:"#69D9F0"}),(0,c.jsx)("stop",{offset:"1",stopColor:"#0093B0"})]})]})]}))}var es=e.i(446530),el=e.i(136540),eu=e.i(929872),ec=e.i(625484),ed=e.i(812432),ef=(0,es.cssRecord)({root:[X.rcss.display.inlineBlock,X.rcss.borderRadius(4),X.rcss.border({color:U.tokens.outlineDefault})],askButton:[X.rcss.border({direction:"right",color:U.tokens.outlineDefault})],askButtonInner:[X.rcss.height(26),X.rcss.borderRadius(4,0,0,4)],copyButton:[{"> button":[X.rcss.width(26),X.rcss.height(26),X.rcss.borderRadius(0,4,4,0)]}]});function ep(e){var t=e.adjustXPosition,n=e.adjustYPosition,r=e.onClickAskAssistant,i=e.onClickAskAgent,o=e.onClickCopy,a=e.supportsAgent,s=e.isAgentBusy;return(0,c.jsx)(eu.Surface,{elevated:!0,css:ef.root,style:{marginLeft:void 0===t?0:t,marginTop:void 0===n?4:n},children:(0,c.jsxs)(ec.View,{row:!0,align:"center",children:[(0,c.jsx)(ec.View,{css:ef.askButton,children:a?(0,c.jsx)(J.Button,{text:void 0!==s&&s?"Add to Queue":"Ask Agent",variant:"nofill",onClick:i,size:"small",iconLeft:(0,c.jsx)(ed.default,{}),css:ef.askButtonInner}):(0,c.jsx)(J.Button,{text:"Ask Assistant",variant:"nofill",onClick:r,size:"small",iconLeft:(0,c.jsx)(ea,{}),css:ef.askButtonInner})}),(0,c.jsx)(ec.View,{css:ef.copyButton,children:(0,c.jsx)(el.IconButton,{alt:"Copy",size:12,onClick:o,children:(0,c.jsx)($.default,{})})})]})})}function eh(e){var t=e.xterm,n=e.onAskAssistant,r=e.onAskAgent,i=e.isAgentBusy,o=void 0!==i&&i,a=(0,d.useMemo)(function(){return null==t?void 0:t._term},[t]),s=(0,d.useRef)(null),l=(0,d.useRef)(null),u=(0,d.useRef)(null),f=(0,p.useSupportsAgent)();(0,d.useEffect)(function(){if(a)return a.onSelectionChange(function(){s.current&&s.current.dispose(),l.current&&l.current.dispose(),u.current&&(u.current.unmount(),u.current=null);var e=a.getSelectionPosition(),t=a.getSelection().trim();if(a.hasSelection()&&e&&t.length>0){var i,d,p,h=a.buffer.active.cursorY,g=e.end.y-h+1,m=null!=(d=null==a?void 0:a._core._renderService.dimensions.css.cell.width)?d:8,x=Math.round(((null==e?void 0:e.end.x)-(null==e?void 0:e.start.x))/2),y=-70,b=4,w=x*m,k=Math.ceil(140/m);w<70?(x=e.start.x,y=0):x>a.cols-k/2&&(x=e.end.x,y=-140),e.end.y>=a.rows-2&&(b=-8,g-=1),s.current=a.registerMarker(g),l.current=null!=(p=a.registerDecoration({marker:s.current,x:x,width:k,layer:"top"}))?p:null,null==(i=l.current)||i.onRender(function(e){u.current||(u.current=(0,ei.createRoot)(e)),u.current.render((0,c.jsx)(ep,{supportsAgent:f,isAgentBusy:o,adjustXPosition:y,adjustYPosition:b,onClickAskAgent:function(){a.clearSelection(),r(t)},onClickAskAssistant:function(){a.clearSelection(),n(t)},onClickCopy:function(){a.clearSelection(),(0,M.default)(t)}}))})}}).dispose},[r,n,f,a,o])}e.s(["useTerminalSelectionPopover",()=>eh],337805);var eg=e.i(453726),em=e.i(6338),ev=(0,es.cssRecord)({terminalLoadingLine:[X.rcss.borderRadius(2),em.loadingStyle.foregroundPulse(),X.rcss.height(16),X.rcss.mb(4)]});function ex(e){var t=e.targetHeight,n=Math.min(Math.floor((t-8)/20),4),r=(0,d.useMemo)(function(){return Array.from({length:n}).map(function(e,t){return(0,c.jsx)(ec.View,{css:ev.terminalLoadingLine,style:{width:100*Math.random()+"%"}},t)})},[n]);return(0,c.jsx)(ec.View,{p:8,style:{height:t+"px"},children:(0,c.jsx)(ec.View,{style:{position:"sticky",top:eg.METADATA_HEIGHT_PX+8},children:r})})}var ey=e.i(343252),eb=((t={}).EXPANDED="EXPANDED",t.COLLAPSED="COLLAPSED",t),ew=e.i(751273),ek=e.i(616278),e_=e.i(283660),eS=e.i(796817),eC=e.i(42458),ej=(0,es.cssRecord)({outputMetadataTooltip:[X.rcss.pl(4),X.rcss.pr(4)]});function eT(e){var t=e.isDone,n=e.hasError,r=e.errorMessage,i=e.finishedMessage,o=e.stopTask;return t?(0,c.jsx)(ew.Tooltip,{css:ej.outputMetadataTooltip,tooltip:n?"Error".concat(r?": ".concat(r):""):"Finished".concat(i?": ".concat(i):""),children:n?(0,c.jsx)(eC.default,{}):(0,c.jsx)(ek.default,{})}):void 0!==o?(0,c.jsx)(el.IconButton,{alt:"Stop",onClick:o,children:(0,c.jsx)(eS.default,{color:U.tokens.accentNegativeDefault})}):(0,c.jsx)(ew.Tooltip,{tooltip:"Running...",children:(0,c.jsx)(e_.default,{color:U.tokens.accentPositiveDefault})})}var eE=e.i(629536),eR=e.i(795903),eI=e.i(604963),eA=e.i(960178),eP=e.i(882027),eD=e.i(461403),eO=(0,es.cssRecord)({askAIButton:[X.rcss.display.flex,X.rcss.flex.row,X.rcss.align.center,X.rcss.m(0),{"@container (max-width: 120px)":[X.rcss.display.none]}],aiButtonWithoutPorts:[{"@container (max-width: 320px)":{padding:"0 4px","& > span":[X.rcss.display.none]}}],aiButtonWithPorts:[{"@container (max-width: 420px)":{padding:"0 4px","& > span":[X.rcss.display.none]}}],verticalDivider:[X.rcss.mx(6),{width:1,height:eg.METADATA_HEIGHT_PX,background:U.tokens.backgroundHigher}]}),eN=[eO.askAIButton,eO.aiButtonWithoutPorts],eM=[eO.askAIButton,eO.aiButtonWithPorts];function eL(e){var t=e.onClick,n=e.showingPorts;return(0,c.jsxs)(ec.View,{css:n?eM:eN,children:[(0,c.jsx)(eA.Text,{color:"dimmer",children:(0,c.jsx)(J.Button,{size:"small",variant:"underlinedOnHover",iconLeft:(0,c.jsx)(eD.default,{}),text:"Ask ".concat(eE.ASSISTANT_NAME),onClick:void 0===t?function(){}:t})}),(0,c.jsx)(ec.View,{css:eO.verticalDivider})]})}function eB(e){var t=e.onClick,n=e.showingPorts,r=(0,l._)((0,d.useState)(!1),2),i=r[0],o=r[1],a="Ask ".concat(eE.AGENT_NAME,"");return(0,c.jsxs)(ec.View,{css:n?eM:eN,children:[(0,c.jsxs)(eI.PopoverTrigger,{isOpen:i,onOpenChange:o,label:a,placement:"bottom end",children:[(0,c.jsx)(eA.Text,{color:"dimmer",children:(0,c.jsx)(J.Button,{size:"small",variant:"underlinedOnHover",iconLeft:(0,c.jsx)(eP.default,{}),text:a,onClick:function(){return o(!0)}})}),(0,c.jsx)(eR.SendAgentMessageMenu,{onClick:t,prefix:"Ask"})]}),(0,c.jsx)(ec.View,{css:eO.verticalDivider})]})}var eV=e.i(257811);function eF(e){var t,n,r,i,o,a,s=e.startTime,u=e.endTime,f=(n=!u,i=(r=(0,l._)((0,d.useState)(function(){return Date.now()}),2))[0],o=r[1],(0,d.useEffect)(function(){if(n){var e=setInterval(function(){o(Date.now())},100);return function(){clearInterval(e)}}},[n]),i);s&&u?a=u-s:u||(a=f-s);var p=a?(0,c.jsx)(ew.Tooltip,{tooltip:"".concat(Math.round(a).toLocaleString(),"ms"),children:(t=a)<1e3?"".concat(Math.floor(t),"ms"):t<6e4?"".concat(Math.floor(t/1e3),"s"):"".concat(Math.floor(t/6e4),"m")}):null,h=(0,c.jsx)(eV.Timestamp,{live:!0,date:s,textVariant:"small",textColor:"dimmer",textTransform:"first-letter-capitalized"});return(0,c.jsx)(c.Fragment,{children:p?(0,c.jsxs)(c.Fragment,{children:[p,eU,h]}):h})}var eU="",eG=e.i(123850),e$=e.i(624782),ez=e.i(714165),eH=(0,es.cssRecord)({default:[],withOnClick:[X.rcss.cursor.pointer,{transition:"all 0.2s ease","&:hover":{filter:"brightness(95%)",boxShadow:U.tokens.shadow1}}]});function eW(e){var t=e.user,n=e.onClick,r=e.size,i=void 0===r?24:r;return(0,c.jsx)(ew.Tooltip,{placement:"bottom",tooltip:n?"Observe ".concat(t.username):t.username,children:function(e,r){return(0,c.jsx)(ec.View,(0,s._)((0,a._)({},e),{innerRef:r,onClick:n,children:(0,c.jsx)(ez.Avatar,{size:i,src:t.image||null,username:t.username,ringColor:t.color,css:n?eH.withOnClick:eH.default})}))}})}e.s(["default",()=>eW],73213);var eq=e.i(346715),eK=e.i(529810);function eY(){var e=(0,eK.default)().secrets,t=(0,l._)((0,d.useState)(null),2),n=t[0],r=t[1],i=(0,d.useMemo)(function(){return!!n&&(0,eq._)(n.values()).some(function(e){return!e})},[n]);return(0,d.useEffect)(function(){return e.watch(r)},[n,e]),i}e.s(["default",()=>eY],389320);var eQ=e.i(552144),eX=e.i(357399),eJ=(0,es.cssRecord)({button:[X.rcss.textAlign.left]});let eZ=function(e){var t=e.onClick;return eY()?(0,c.jsx)(eQ.StatusBannerButton,{text:"Missing required secrets. Click here to add them.",onClick:t,iconRight:(0,c.jsx)(eX.default,{}),colorway:"warning",css:eJ.button}):null};var e0=e.i(576073),e1=e.i(782096),e2=e.i(245225),e3=e.i(634669),e4=(0,eG.createCssVarTokens)(["blockMinHeight","terminalBackgroundColor","previewHeight"]),e8=e4.cssVars,e5=e4.styleTokens,e6=(0,es.cssRecord)({outputBlockMetadataWrapper:[{containerType:"size"},X.rcss.pl(4),X.rcss.pr(8),X.rcss.rowWithGap(4),X.rcss.align.center,X.rcss.justify.spaceBetween,X.rcss.height(eg.METADATA_HEIGHT_PX),X.rcss.backgroundColor.backgroundDefault,X.rcss.border({direction:"bottom",width:1,style:"solid",color:U.tokens.backgroundHigher}),X.rcss.position.sticky,X.rcss.top(0),X.rcss.zIndex(1)],outputBlockMetadataWrapperLeft:[X.rcss.rowWithGap(4),X.rcss.align.center],outputBlockMetadataWrapperRight:[X.rcss.rowWithGap(4),X.rcss.align.center],taskNamePill:[X.rcss.maxWidth(100),X.rcss.flex.shrink(0),X.rcss.display.flex,{"> span":{whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},"@container (max-width: 120px)":[X.rcss.display.none],"&:hover":{maxWidth:"none","> span":{overflow:"visible",textOverflow:"clip"}}}],dateText:[X.rcss.flex.row,X.rcss.align.center,X.rcss.textAlign.right,X.rcss.flex.shrink(1),{marginLeft:"auto",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"}],dateContainer:[X.rcss.overflow("hidden"),X.rcss.width(120),X.rcss.flex.shrink(0),{"@container (max-width: 510px)":[X.rcss.display.none]}],outputBlockClosingBorder:[X.rcss.height(1),X.rcss.zIndex(1),X.rcss.border({direction:"bottom",width:1,style:"solid",color:U.tokens.backgroundHigher}),{marginTop:-1}],outputBlockTerminalWrapper:[X.rcss.minHeight(e5.blockMinHeight)],terminal:{gridRow:1,gridColumn:1,position:"sticky",top:A.styleTokens.topOffset,"& .xterm":[X.rcss.py(A.TERMINAL_PADDING_PX),X.rcss.pl(A.TERMINAL_PADDING_PX),X.rcss.height("100%"),X.rcss.overflow("hidden")],"& .xterm-viewport":[X.rcss.overflow("hidden")],"& .xterm-scroll-area":{height:"0px !important"}},errorMessage:[{gridRow:1,gridColumn:1,position:"sticky",top:A.styleTokens.topOffset},X.rcss.py(A.TERMINAL_PADDING_PX),X.rcss.pl(A.TERMINAL_PADDING_PX),X.rcss.height("100%"),X.rcss.overflow("hidden")],searchWidget:{gridRow:1,gridColumn:1,position:"sticky",top:A.styleTokens.topOffset,height:30,margin:"2px 0 0 auto",zIndex:4},avatarWrapper:[],outputMetadataTooltip:[X.rcss.pl(4),X.rcss.pr(4)],verticalDivider:[X.rcss.mx(6),{width:1,height:eg.METADATA_HEIGHT_PX,background:U.tokens.backgroundHigher}],portInfoDomain:[X.rcss.display.flex,X.rcss.flex.row,X.rcss.align.center,X.rcss.m(0),{"@container (max-width: 400px)":X.rcss.display.none}],portInfoText:[X.rcss.mr(0)],portInfoPorts:[X.rcss.display.flex,X.rcss.flex.row,X.rcss.align.center,X.rcss.m(0),{"@container (max-width: 320px)":X.rcss.display.none}],portTooltipHeader:[X.rcss.color.foregroundDimmer,X.rcss.fontWeight.normal,X.rcss.px(2),X.rcss.pb(2)],portTooltipColumnLeft:[X.rcss.textAlign.right],portTooltipColumnMiddle:[X.rcss.textAlign.center,X.rcss.px(4)]});function e9(e){var t=e.isDone,n=e.hasError,r=e.errorMessage,i=e.finishedMessage,o=e.stopTask;return t?(0,c.jsx)(ew.Tooltip,{css:e6.outputMetadataTooltip,tooltip:n?"Error".concat(r?": ".concat(r):""):"Finished".concat(i?": ".concat(i):""),children:n?(0,c.jsx)(eC.default,{}):(0,c.jsx)(ek.default,{})}):void 0!==o?(0,c.jsx)(el.IconButton,{alt:"Stop",onClick:o,children:(0,c.jsx)(eS.default,{color:U.tokens.accentNegativeDefault})}):(0,c.jsx)(ew.Tooltip,{tooltip:"Running...",children:(0,c.jsx)(e_.default,{color:U.tokens.accentPositiveDefault})})}function e7(e){var t=e.isCollapsed,n=e.setIsCollapsed,r=e.taskName,i=e.isDone,o=e.hasError,a=e.errorMessage,s=e.startTime,l=e.endTime,u=e.activeUsers,f=e.openPane,h=e.openedPorts,g=e.onAskAssistantClick,m=e.onAskAgentClick,x=e.stopTask,y="packager.installForAll"===r||"packager.installForLanguage"===r,b=(0,p.useSupportsAgent)(),w=h.length>0,k=(0,d.useCallback)(function(){f({type:"developer",data:{tab:["dependencies","import"]}})},[f]);return(0,c.jsxs)(ec.View,{css:e6.outputBlockMetadataWrapper,onDoubleClick:function(){return n(!t)},children:[y?(0,c.jsxs)(ec.View,{css:e6.outputBlockMetadataWrapperLeft,children:[(0,c.jsx)(el.IconButton,{alt:"Open Packager",onClick:k,children:(0,c.jsx)(e3.default,{})}),(0,c.jsx)(e$.Pill,{color:"grey",text:"Packager",css:e6.taskNamePill})]}):(0,c.jsxs)(ec.View,{css:e6.outputBlockMetadataWrapperLeft,onDoubleClick:function(e){return e.stopPropagation()},children:[(0,c.jsx)(el.IconButton,{alt:t?"Expand":"Collapse",onClick:function(){return n(!t)},children:t?(0,c.jsx)(e1.default,{}):(0,c.jsx)(e0.default,{})}),(0,c.jsx)(e$.Pill,{color:"grey",text:r,css:e6.taskNamePill})]}),(0,c.jsxs)(ec.View,{css:e6.outputBlockMetadataWrapperRight,onDoubleClick:function(e){return e.stopPropagation()},children:[b?(0,c.jsx)(eB,{showingPorts:w,onClick:m}):(0,c.jsx)(eL,{showingPorts:w,onClick:g}),(0,c.jsx)(ts,{openPane:f,openedPorts:h}),(0,c.jsxs)(ec.View,{css:e6.dateContainer,row:!0,justify:"space-between",children:[(0,c.jsx)(eA.Text,{color:"dimmer",variant:"small",css:e6.dateText,children:(0,c.jsx)(eF,{startTime:s,endTime:l})}),(0,c.jsx)(ec.View,{css:e6.verticalDivider})]}),u.length>0?(0,c.jsx)(ec.View,{grow:0,shrink:0,row:!0,gap:4,align:"center",children:u.map(function(e){return(0,c.jsx)(eW,{user:e,size:16},e.id)})}):null,(0,c.jsx)(e9,{isDone:i,stopTask:x,hasError:o,errorMessage:a})]})]})}function te(){}var tt={noScroll:!0};function tn(e){var t,o,a,s,f=e.taskIdx,p=e.runId,m=e.currentUserId,x=e.maxHeight,y=e.scrollParent,w=e.scrollPosition,_=e.openPane,C=e.openAssistantWithMessage,j=e.openAgentWithMessage,T=(0,A.useAutoGrowingXTerm)({maxHeight:x,openPane:_}),E=T.visibleHeight,D=T.visibleLines,O=T.bufferHeight,N=T.bufferLines,M=T.wrapperResizeRef,L=T.hasScrollback,B=T.xterm,V=T.xtermRef,F=(0,d.useMemo)(function(){return null==B?void 0:B._term},[B]),U=(0,d.useMemo)(function(){var e,t=null==F?void 0:F._core;return null!=(e=null==t?void 0:t._renderService.dimensions.css.cell)?e:{width:0,height:0}},[F]),G=(0,l._)((0,d.useState)(null),2),$=G[0],z=G[1],H=(0,l._)((0,d.useState)(!1),2),W=H[0],q=H[1],K=(0,d.useRef)(null);(0,d.useEffect)(function(){return function(){null!==K.current&&clearTimeout(K.current)}},[K]),(0,d.useEffect)(function(){if(F){if(w<1||!L)return void F.scrollToLine(0);var e=O-E,t=N-D;if(e<1)return void F.scrollToLine(0);var n=Math.round(w/e*t);F.scrollToLine(n)}},[O,N,L,w,F,E,D]);var Q=(0,l._)((0,d.useState)(null),2),X=Q[0],J=Q[1];(0,S.usePid2)(function(e,t){var o=t.signal;return(0,i._)(function(){var t,i,a,s,l,c,d,h,g,x;return(0,u._)(this,function(u){switch(u.label){case 0:if(!B||!$)return[2];i=(t=e.workflows.connectToTask.stream({runId:p,taskIdx:f,userId:m,processViewId:"outputs"},{signal:o})).reqWritable,a=t.resReadable,J({onInput:function(e){if(i.isWritable()){var t=new Uint8Array(n.Buffer.from(e));i.write({$kind:"stdin",stdin:t})}},onResizeTerminal:function(e){i.isWritable()&&i.write({$kind:"resize",size:e})},onFocus:function(){i.isWritable()&&i.write({$kind:"focused"})},onBlur:function(){i.isWritable()&&i.write({$kind:"blurred"})}}),i.write({$kind:"resize",size:B.getSize()}),s=!1,l=!1,u.label=1;case 1:u.trys.push([1,6,7,12]),d=(0,r._)(a),u.label=2;case 2:return[4,d.next()];case 3:if(!(s=!(h=u.sent()).done))return[3,5];if(!(g=h.value).ok){if("UNEXPECTED_DISCONNECT"===g.payload.code||"CANCEL"===g.payload.code||"NO_MATCHING_TASK_STATE"===g.payload.code)return[3,5];if("TASK_ERROR"===g.payload.code)return b.logger.info("[".concat(g.payload.code,"] ").concat(g.payload.message," in workflow outputs")),[3,4];throw Error("[".concat(g.payload.code,"] ").concat(g.payload.message))}"output"===g.payload.$kind&&$(g.payload.chunk),u.label=4;case 4:return s=!1,[3,2];case 5:return[3,12];case 6:return x=u.sent(),l=!0,c=x,[3,12];case 7:if(u.trys.push([7,,10,11]),!(s&&null!=d.return))return[3,9];return[4,d.return()];case 8:u.sent(),u.label=9;case 9:return[3,11];case 10:if(l)throw c;return[7];case 11:return[7];case 12:return J(null),i.close(),[2]}})})()},[p,f,$,B,m]);var Z=(0,d.useCallback)(function(e){return z(function(){return e}),function(){}},[]),et=(0,l._)((0,d.useState)(!1),2),en=et[0],er=et[1],ei=(0,l._)((0,d.useState)(""),2),eo=ei[0],ea=ei[1],es=(0,h.useChatter)(),el=(0,I.useIsAgentOptimisticallyWorking)(),eu=(0,d.useCallback)(function(e){_({type:"searchReplace",data:{initialQuery:e}},!0)},[_]),ed=(0,P.useContextMenu)().onContextMenu,ef=Y({xterm:B,isWorkflowsTerminal:!0,openShellSearch:function(e){er(!0),ea(e)},openSearchAndReplace:eu});eh({xterm:B,onAskAssistant:function(e){C((0,g.terminalMessagePrompt)(e))},onAskAgent:(0,d.useCallback)(function(e){return(0,i._)(function(){var t,n;return(0,u._)(this,function(r){switch(r.label){case 0:if(t=(0,g.terminalMessagePrompt)(e),!el)return[3,2];return n=(0,R.packContentsForQueuedMessage)({text:t,attachedFiles:[]}),[4,es.queue.enqueue({contents:n})];case 1:return r.sent(),[3,3];case 2:j(t,{createNewSession:!1}),r.label=3;case 3:return[2]}})})()},[el,j,es.queue]),isAgentBusy:el});var ep=(0,d.useCallback)(function(){if(F){var e=F.getSelectionPosition();e&&y(e.start.y*U.height-x/2)}},[F,x,y,U.height]);return(0,c.jsxs)(A.AutoGrowingTerminalWrapper,{xterm:B,wrapperResizeRef:M,bufferHeight:O,setOnMessage:Z,onInput:null!=(t=null==X?void 0:X.onInput)?t:te,onResizeTerminal:null!=(o=null==X?void 0:X.onResizeTerminal)?o:te,onFocus:null!=(a=null==X?void 0:X.onFocus)?a:te,onBlur:null!=(s=null==X?void 0:X.onBlur)?s:te,style:{pointerEvents:W?"none":"all"},onWheel:function(){q(!0),K.current&&clearTimeout(K.current),K.current=setTimeout(function(){q(!1)},200)},onKeyDown:function(e){"f"===e.key&&(0,k.getCmdOrCtrl)(e)&&(er(!0),e.preventDefault())},children:[en?(0,c.jsx)(ec.View,{css:e6.searchWidget,children:(0,c.jsx)(ee,{searchValue:eo,setSearchValue:ea,findPrevious:function(e){(null==B?void 0:B.findPrevious(e,tt))&&ep()},findNext:function(e){(null==B?void 0:B.findNext(e,tt))&&ep()},exit:function(){return er(!1)}})}):null,(0,c.jsx)(A.AutoGrowingTerminalInner,{xtermRef:V,visibleHeight:E,maxHeight:x,css:e6.terminal,onContextMenu:function(e){return ed(e,{command:ef})}})]})}function tr(e){var t,n=e.runId,r=e.taskIdx,i=e.task,o=e.config,a=e.isCollapsed,s=e.setIsCollapsed,l=e.openPane,u=e.openedPorts,f=e.onAskAssistantClick,p=e.onAskAgentClick,h="ERROR"===i.state||"FAILED"===i.state,g="ERROR"===i.state||"FAILED"===i.state?null==(t=i.result)?void 0:t.message:void 0,m="RUNNING"!==i.state,x=(0,en.useActiveUsers)(),y=(0,d.useMemo)(function(){return i.userIds.map(function(e){return x.find(function(t){return t.id===e})}).filter(Boolean)},[i,x]),b="shell.exec"===o.task&&"args"in o?(0,E.formatNixStorePath)(o.args):o.task,w=(0,C.usePid2Callback)(function(e){return function(){e.workflows.stopTask.rpc({runId:n,taskIdx:r,graceful:!0})}},[n,r]);return(0,c.jsx)(e7,{isCollapsed:a,setIsCollapsed:s,taskName:b,isDone:m,hasError:h,errorMessage:g,startTime:i.startTime,endTime:m?i.endTime:void 0,activeUsers:y,openPane:l,openedPorts:u,stopTask:null!=w?w:void 0,onAskAssistantClick:f,onAskAgentClick:p})}function ti(e){var t,p,h,m,b,k,_,S,j,E,R,I,P,O,N,M,L,B,V,F,U,G,$,z,H,W,q=e.task,K=e.taskIdx,Y=e.runId,Q=e.config,X=e.maxHeight,J=e.rootRef,Z=e.currentUser,ee=e.ports,et=e.openAssistantWithMessage,en=e.openAgentWithMessage,ei=e.openPane,eo=e.onDoExposePort,ea=e.onDontExposePort,es=(0,d.useRef)(null),el=(0,l._)((0,d.useState)(!0),2),eu=el[0],ed=el[1],ef=(0,l._)((0,d.useState)(!1),2),ep=ef[0],eh=ef[1],em=(0,l._)((0,d.useState)(0),2),ev=em[0],ew=em[1],ek=(0,er.useTerminalTheme)(),e_=(0,x.default)(eu,ep?6e4:500),eS=null!=(H=(null==(G=q.metadata)?void 0:G.task)==="shell.exec"&&q.metadata.isInRecoveryMode)&&H,eC=(0,T.useOpenedPortsMatchingCgroupWithExplicitService)(ee,(null==($=q.metadata)?void 0:$.task)==="shell.exec"?null==(z=q.metadata)?void 0:z.cgroupPath:void 0),ej=(0,l._)((0,d.useState)(eb.EXPANDED),2),eT=(p=(t={maxHeight:X,visualState:ej[0],onSetVisualState:ej[1]}).visualState,h=t.onSetVisualState,m=t.maxHeight,k=(b=(0,l._)((0,d.useState)("EXPANDED"===p?0:void 0),2))[0],_=b[1],S=(0,d.useRef)(null),E=(j=(0,l._)((0,d.useState)("EXPANDED"===p?"expanded":"collapsed"),2))[0],R=j[1],P=(I=(0,l._)((0,d.useState)("COLLAPSED"===p?0:void 0),2))[0],O=I[1],N=(0,d.useCallback)(function(e){e&&_(e.getBoundingClientRect().height)},[]),M=(0,y.default)(function(e){var t=e.height;"expanded"===E&&_(t)},{type:"debounce",wait:200}),(0,d.useEffect)(function(){if(S.current)switch(E){case"start-collapsing":R("is-collapsing");break;case"is-collapsing":O(0);break;case"start-expanding":R("is-expanding");break;case"is-expanding":O(k);break;case"expanded":O(void 0)}},[E,k]),L="expanded"!==E&&"is-expanding"!==E,B=(0,d.useCallback)(function(e){h(e?"COLLAPSED":"EXPANDED")},[h]),V=(0,d.useRef)(p),(0,d.useEffect)(function(){"EXPANDED"===V.current&&"COLLAPSED"===p&&S.current&&(R("start-collapsing"),O(Math.min(S.current.getBoundingClientRect().height,m)),R("start-collapsing")),"COLLAPSED"===V.current&&"EXPANDED"===p&&R("start-expanding"),V.current=p},[m,p]),F=(0,d.useCallback)(function(){"is-collapsing"===E&&R("collapsed"),"is-expanding"===E&&R("expanded")},[E]),U=(0,d.useMemo)(function(){return{style:{height:P,transition:"height 120ms ease-out",overflow:"expanded"===E||"start-collapsing"===E?"visible":"hidden"},onTransitionEnd:F}},[P,E,F]),{collapsedStep:E,isCollapsed:L,setIsCollapsed:B,blockWrapperRef:S,blockWrapperProps:U,blockResizeRef:(0,ey.useMergeRefs)([M,N],{breadcrumb:"client/workspace/components/Outputs/useAnimatedBlockCollapsing.tsx:173"}),measuredBlockHeight:k}),eE=eT.collapsedStep,eR=eT.isCollapsed,eI=eT.setIsCollapsed,eA=eT.blockWrapperRef,eP=eT.blockWrapperProps,eD=eT.blockResizeRef,eO=eT.measuredBlockHeight;(0,d.useEffect)(function(){if(J.current){var e,t=J.current,n=function(){var n,r;ew(Math.max(0,t.scrollTop-(null!=(r=null==(n=es.current)?void 0:n.offsetTop)?r:0))),eh(!0),e&&clearTimeout(e),e=setTimeout(function(){eh(!1)},500)};return t.addEventListener("scroll",n),function(){clearInterval(e),t.removeEventListener("scroll",n)}}},[J,es]),(0,d.useEffect)(function(){if(es.current&&J.current)return(0,w.inView)(es.current,function(){return ed(!0),function(){ed(!1)}},{root:J.current,threshold:0})},[J,es]);var eN=(0,C.usePid2Callback)(function(e){return function(){return(0,i._)(function(){var t,i,o,a,s,l,c,d,p,h;return(0,u._)(this,function(u){switch(u.label){case 0:t=e.workflows.readTaskBuffer.subscribe({runId:Y,taskIdx:K}).resReadable,i=new Uint8Array([]),o=!1,a=!1,u.label=1;case 1:u.trys.push([1,6,7,12]),l=(0,r._)(t),u.label=2;case 2:return[4,l.next()];case 3:if(!(o=!(c=u.sent()).done))return[3,5];if(!(d=c.value).ok)throw Error(d.payload.code+": "+d.payload.message);if("output"===d.payload.$kind&&(i=n.Buffer.concat([i,d.payload.chunk])),"finished"===d.payload.$kind)return p=(0,f.default)(i.toString()),[2,(0,g.terminalMessagePrompt)(p)];u.label=4;case 4:return o=!1,[3,2];case 5:return[3,12];case 6:return h=u.sent(),a=!0,s=h,[3,12];case 7:if(u.trys.push([7,,10,11]),!(o&&null!=l.return))return[3,9];return[4,l.return()];case 8:u.sent(),u.label=9;case 9:return[3,11];case 10:if(a)throw s;return[7];case 11:return[7];case 12:return[2]}})})()}}),eM=(0,d.useCallback)(function(){return(0,i._)(function(){var e;return(0,u._)(this,function(t){switch(t.label){case 0:if(null==eN)return[2];return[4,eN()];case 1:return(e=t.sent())&&et(e),[2]}})})()},[eN,et]),eL=(0,d.useCallback)(function(e){return(0,i._)(function(){var t;return(0,u._)(this,function(n){switch(n.label){case 0:if(null==eN)return[2];return[4,eN()];case 1:return(t=n.sent())&&en(t,e),[2]}})})()},[eN,en]),eB=(0,l._)((0,d.useState)(0),2),eV=eB[0],eF=eB[1],eU=(0,y.default)(function(e){var t=e.height;"expanded"===eE&&eF(t)},{type:"debounce",wait:200}),eG=(0,d.useCallback)(function(){ei({type:"developer",data:{tab:["networking"]}})},[ei]),e$=(0,d.useCallback)(function(e,t){ei({type:"webview",data:{ports:{type:"local",path:e,port:t}}})},[ei]),ez=(0,d.useCallback)(function(){ei({type:"envEditor"})},[ei]),eH="FINISHED"===q.state||"FAILED"===q.state,eW=X-eg.METADATA_HEIGHT_PX-eV,eq=!1;return"collapsed"===eE?eq=!1:(!eH||e_)&&(eq=!0),(0,c.jsxs)(ec.View,{innerRef:es,children:[(0,c.jsx)(tr,{runId:Y,taskIdx:K,task:q,config:Q,isInRecoveryMode:eS,isCollapsed:eR,setIsCollapsed:eI,openPane:ei,openedPorts:eC,onAskAssistantClick:eM,onAskAgentClick:eL}),(0,c.jsxs)(ec.View,{innerRef:eU,style:{position:"sticky",top:eg.METADATA_HEIGHT_PX},children:[(0,c.jsx)(eZ,{onClick:ez}),(0,c.jsx)(D.PortInfo,{configurations:eC.map(function(e){return e.configuration}),openWebview:function(){e$("/",eC[0].configuration.localPort)},openNetworkingTool:eG,onDontExposePort:function(){1===eC.length&&ea(eC[0].configuration.localPort)},onDoExposePort:function(){1===eC.length&&eo(eC[0].configuration.localPort)}})]}),(0,c.jsx)("div",(0,s._)((0,a._)({ref:eA},eP),{children:(0,c.jsx)(ec.View,{css:e6.outputBlockTerminalWrapper,style:(W={},(0,o._)(W,e8.blockMinHeight,eO+"px"),(0,o._)(W,e8.terminalBackgroundColor,null==ek?void 0:ek.background),(0,o._)(W,A.cssVars.topOffset,eg.METADATA_HEIGHT_PX+eV+"px"),W),children:eq?(0,c.jsx)(ec.View,{innerRef:eD,children:(0,c.jsx)(tn,{taskIdx:K,runId:Y,maxHeight:eW,currentUserId:Z.id,scrollParent:function(e){var t,n,r,i=e+(null!=(r=null==(t=es.current)?void 0:t.offsetTop)?r:0);null==(n=J.current)||n.scrollTo({top:i})},scrollPosition:ev,openPane:ei,openAssistantWithMessage:et,openAgentWithMessage:en})}):(0,c.jsx)(ex,{targetHeight:null!=eO?eO:0})})})),(0,c.jsx)(ec.View,{css:e6.outputBlockClosingBorder})]})}function to(e){var t,n,r=(0,d.useCallback)(function(){e.openPane({type:"developer",data:{tab:["dependencies","import"]}})},[e]),i=e.task.metadata;if(((null==i?void 0:i.task)==="packager.installForAll"||(null==i?void 0:i.task)==="packager.installForLanguage")&&(null==i?void 0:i.hasUserFacingOutput)===!0)return(0,c.jsx)(ti,(0,a._)({},e));var o="ERROR"===e.task.state||"FAILED"===e.task.state,s="ERROR"===e.task.state||"FAILED"===e.task.state?null==(t=e.task.result)?void 0:t.message:void 0,l="FINISHED"===e.task.state?null==(n=e.task.result)?void 0:n.message:void 0,u="RUNNING"!==e.task.state;return(0,c.jsxs)(ec.View,{children:[(0,c.jsxs)(ec.View,{css:e6.outputBlockMetadataWrapper,children:[(0,c.jsxs)(ec.View,{css:e6.outputBlockMetadataWrapperLeft,children:[(0,c.jsx)(el.IconButton,{alt:"Open Packager",onClick:r,children:(0,c.jsx)(e3.default,{})}),(0,c.jsx)(e$.Pill,{color:"grey",text:"Packager",css:e6.taskNamePill})]}),(0,c.jsxs)(ec.View,{css:e6.outputBlockMetadataWrapperRight,children:[(0,c.jsx)(eA.Text,{color:"dimmer",variant:"small",css:e6.dateText,children:(0,c.jsx)(eF,{startTime:e.task.startTime,endTime:"RUNNING"!==e.task.state?e.task.endTime:void 0})}),(0,c.jsx)(ec.View,{css:e6.verticalDivider}),(0,c.jsx)(eT,{isDone:u,hasError:o,errorMessage:s,finishedMessage:l})]})]}),(0,c.jsx)(ec.View,{css:e6.outputBlockTerminalWrapper,children:(0,c.jsx)(ec.View,{css:e6.errorMessage,style:{color:U.tokens.accentNegativeStronger},children:s})})]})}function ta(e){var t=(0,et.useCurrentUser)();if(!t)return null;var n=e.config.task;switch(n){case"shell.exec":return(0,c.jsx)(ti,(0,s._)((0,a._)({},e),{currentUser:t}));case"packager.installForLanguage":case"packager.installForAll":return(0,c.jsx)(to,(0,s._)((0,a._)({},e),{currentUser:t}));case"workflow.run":return null;default:(0,m.default)(n)}}function ts(e){var t=e.openPane,n=e.openedPorts,r=void 0!==n&&n.length>0,i=r?"{...}.replit.dev":"",o=(0,d.useMemo)(function(){return r?1===n.length?":".concat(n[0].configuration.localPort):"".concat(n.length," ").concat((0,_.default)("port",n.length)):""},[r,n]),a=(0,d.useCallback)(function(){t({type:"webview",data:{ports:r?{type:"local",port:n[0].configuration.localPort}:void 0}},!0)},[r,t,n]),s=(0,d.useCallback)(function(){t({type:"developer",data:{tab:["networking"]}},!0)},[t]);return r?(0,c.jsxs)(c.Fragment,{children:[(0,c.jsxs)(ec.View,{css:e6.portInfoDomain,children:[(0,c.jsx)(eA.Text,{color:"dimmer",css:e6.portInfoText,children:(0,c.jsx)(ew.Tooltip,{tooltip:"Open Preview",children:(0,c.jsx)(J.Button,{size:"small",variant:"underlinedOnHover",text:i,onClick:a})})}),(0,c.jsx)(ec.View,{css:e6.verticalDivider})]}),(0,c.jsxs)(ec.View,{css:e6.portInfoPorts,children:[(0,c.jsx)(eA.Text,{color:"dimmer",css:e6.portInfoText,children:(0,c.jsx)(ew.Tooltip,{tooltip:(0,c.jsx)(tl,{openedPorts:n}),children:(0,c.jsx)(J.Button,{size:"small",variant:"underlinedOnHover",iconLeft:(0,c.jsx)(e2.default,{color:U.tokens.accentPositiveStronger}),text:o,onClick:s})})}),(0,c.jsx)(ec.View,{css:e6.verticalDivider})]})]}):null}function tl(e){var t=e.openedPorts;return(0,c.jsx)(ec.View,{children:(0,c.jsxs)("table",{children:[(0,c.jsxs)("tr",{children:[(0,c.jsx)("th",{css:e6.portTooltipHeader,children:"Internal"}),(0,c.jsx)("th",{}),(0,c.jsx)("th",{css:e6.portTooltipHeader,children:"External"})]}),(0,c.jsx)("tbody",{children:t.map(function(e){var t=e.configuration,n=!0,r=null;switch(t.type){case j.PortConfigurationType.FORWARDED:n=!0,r=":".concat(t.externalPort);break;case j.PortConfigurationType.INTERNAL_ONLY:n=!1,r=null;break;case j.PortConfigurationType.NO_MORE_EXTERNAL_PORTS_AVAILABLE:case j.PortConfigurationType.MISCONFIGURED:case j.PortConfigurationType.CONFIG_MISSING:n=!0,r=(0,c.jsx)(eC.default,{})}return(0,c.jsxs)("tr",{children:[(0,c.jsxs)("td",{css:e6.portTooltipColumnLeft,children:[":",t.localPort]}),(0,c.jsx)("td",{css:e6.portTooltipColumnMiddle,children:n?"":null}),(0,c.jsx)("td",{children:r})]},t.localPort)})})]})})}e.s(["WorkflowsTaskBlock",()=>ta],319401);var tu=e.i(858248),tc=e.i(709485),td=e.i(729122),tf=e.i(978669);function tp(e){return e[e.length-1]}var th=(0,es.cssRecord)({menuItemSelector:[X.rcss.height(28),X.rcss.pl(4),{flex:1,transition:"none",span:{flex:1,textAlign:"left"}}],iconInvisible:{"& > svg":[X.rcss.visibility.hidden],"&:hover > svg":[X.rcss.visibility.visible]}});function tg(e){var t=e.setDefault,n=e.onAction,r=e.name,i=e.isRunning,o=e.isRunButton?null:th.iconInvisible;return(0,c.jsxs)(ec.View,{row:!0,"aria-label":r,align:"center",children:[(0,c.jsx)(el.IconButton,{onClick:function(){return t(r)},alt:"Make default",css:o,children:(0,c.jsx)(ek.default,{})}),(0,c.jsx)(J.Button,{css:th.menuItemSelector,onClick:n,text:r,variant:"nofill",iconRight:i?(0,c.jsx)(eS.default,{}):(0,c.jsx)(tf.default,{})})]})}function tm(){var e,t,n,r,i,o=(0,td.useWorkflowsRunner)(),a=(0,td.usePersistConfig)(),s=(0,td.useSetRunButton)(),l=(0,td.useWorkflowsConfig)(),u=(0,td.useWorkflowsRunState)(),f=(0,td.useTriggerLocalRun)(),p=null==o?void 0:o.workflowId,h=!!(null==l||null==(n=l.workflow)||null==(t=n.find(function(e){return e.name===p}))||null==(e=t.metadata)?void 0:e.generated),g=null==l||null==(i=l.workflow)||null==(r=i.find(function(e){var t;return null==(t=e.metadata)?void 0:t.dotReplitRun}))?void 0:r.name,m=(0,C.usePid2Callback)(function(e){return function(t){return f(E.RunReason.RUN_BUTTON_CLICKED),(0,tu.track)(tc.events.WORKFLOW_RAN,{source:"dropdownMenu"}),e.workflows.runWorkflow.rpc({workflowId:t})}},[f]),x=(0,C.usePid2Callback)(function(e){return function(t){return(0,tu.track)(tc.events.WORKFLOW_STOPPED,{source:"dropdownMenu"}),e.workflows.stopRun.rpc({runId:t})}},[]),y=function(e){(0,tu.track)(tc.events.WORKSPACE,{action:"run_button_used",usage:"default_changed",runner:e?"workflows":"pid1"}),s(e),a()},b=(0,d.useMemo)(function(){var e;return(null==l?void 0:l.workflow)&&null!=(e=null==l?void 0:l.workflow.filter(function(e){var t,n;return!(null!=(n=null==(t=e.metadata)?void 0:t.generated)&&n)}).map(function(e){var t=Object.values(null!=u?u:{}).filter(function(t){return t.workflow.name===e.name}).sort(function(e,t){return e.startTime-t.startTime});return{workflowConfig:e,workflowRunState:tp(t)}}))?e:[]},[l,u]),w=(0,d.useMemo)(function(){if(g)return tp(Object.values(null!=u?u:{}).filter(function(e){return g===e.workflow.name}).sort(function(e,t){return e.startTime-t.startTime}))},[u,g]);return(0,c.jsx)(ec.View,{"aria-label":"Workflows",gap:4,children:(0,c.jsxs)(ec.View,{children:[g?(0,c.jsx)(tg,{isRunButton:h,isRunning:(null==w?void 0:w.step)==="RUNNING",onAction:function(){(null==w?void 0:w.step)!=="RUNNING"?null==m||m(g):w&&(null==x||x(w.runId))},setDefault:function(e){y()},name:g}):null,b.map(function(e,t){var n,r=e.workflowConfig,i=e.workflowRunState,o=(null==i?void 0:i.step)==="RUNNING";return(0,c.jsx)(tg,{onAction:function(){o?i&&(null==x||x(i.runId)):null==m||m(r.name)},setDefault:y,name:r.name,isRunning:o,isRunButton:r.name===p},r.name+"-"+t+"-"+(null!=(n=null==i?void 0:i.step)?n:"not-started"))})]})})}var tv=e.i(754873),tx=(0,es.cssRecord)({dropDown:[{'&[data-visible="true"]':{visibility:"visible",maxWidth:"100px",transform:"translateX(-4px)",opacity:1},'&[data-visible="false"]':{visibility:"hidden",maxWidth:0,transform:"translateX(-20px)",opacity:0},zIndex:0,transition:"\ntransform 0.2s linear,\nopacity 0.2s linear\n"}],dropDownButton:[X.rcss.reset.button,tv.interactive.filled,X.rcss.color.foregroundDimmer,X.rcss.height(32),X.rcss.minWidth(20),X.rcss.flex.column,X.rcss.justify.center,X.rcss.pr(2),X.rcss.pl(4),X.rcss.borderRadius(0,"default","default",0),{backgroundColor:"transparent"}],popoverWrapper:[X.rcss.minWidth(240)],popoverSection:[X.rcss.p(8),{":not(:last-of-type)":{borderBottom:"1px solid "+U.tokens.outlineDimmest}}]});function ty(e){var t=e.openPane,n=e.isVisible,r=e.triggerElement,i=(0,l._)((0,d.useState)(!1),2),o=i[0],a=i[1],s=(0,d.useCallback)(function(){(0,tu.track)(tc.events.WORKFLOWS_SETTINGS_OPENED,{source:"runButton"}),t({type:"workflows"}),a(!1)},[t]);return(0,c.jsx)(ec.View,{css:tx.dropDown,"data-visible":void 0===n||n?"true":"false",children:(0,c.jsxs)(eI.PopoverTrigger,{isOpen:o,onOpenChange:function(e){(0,tu.track)(tc.events.WORKSPACE,{action:"run_button_used",usage:"dropdown_opened"}),a(e)},label:"Workflows",placement:"bottom start",children:[r||(0,c.jsx)(ec.SpecializedView.button,{css:tx.dropDownButton,children:(0,c.jsx)(ew.Tooltip,{tooltip:"Configure Run Button",children:(0,c.jsx)(e0.default,{})})}),(0,c.jsxs)(ec.View,{css:tx.popoverWrapper,children:[(0,c.jsx)(ec.View,{css:tx.popoverSection,children:(0,c.jsx)(tm,{})}),(0,c.jsx)(ec.View,{css:tx.popoverSection,children:(0,c.jsx)(J.Button,{text:"Manage Workflows",onClick:s,iconLeft:(0,c.jsx)(eX.default,{})})})]})]})})}e.s(["default",()=>ty],831733)},550801,e=>{"use strict";var t=e.i(297083),n=e.i(530658),r=e.i(817556),i=e.i(276385),o=e.i(389959),a=e.i(664152),s=e.i(858248),l=e.i(709485),u=e.i(529810),c=e.i(446530),d=e.i(613355),f=e.i(965153),p=e.i(140487),h=e.i(739521),g=e.i(396776),m=e.i(929872),x=e.i(960178),y=e.i(625484),b=e.i(940745),w=e.i(42458),k=(0,c.cssRecord)({brokenNixErrorWrapper:[d.rcss.maxHeight("300px"),{overflow:"scroll"},d.rcss.p(8)],accordionWrapper:[d.rcss.borderRadius(4)],inlineButton:[{display:"inline-flex"}]});function _(e){var c=e.openFile,d=e.nixError,h=e.handleClose,_=(0,u.default)(),S=_.git,C=_.fs,j=(0,n._)((0,o.useState)(null),2),T=j[0],E=j[1],R=(0,n._)((0,o.useState)(!1),2),I=R[0],A=R[1],P=(0,o.useCallback)(function(){return(0,t._)(function(){var e,t,n,i,o,u,c;return(0,r._)(this,function(r){switch(r.label){case 0:return(0,s.track)(l.events.NIX_MODULE,{action:"recovery",state:"Started"}),a.logger.info("Started Nix Broken State Recovery"),A(!0),S.forceRefresh(),[4,S.status()];case 1:if((e=r.sent()).error)return A(!1),E("git is not accessible"),(0,s.track)(l.events.NIX_MODULE,{action:"recovery",state:"Failed",reason:"Git State Error"}),a.logger.error("Nix Broken State Recovery Failed due to Git",{gitStatusError:e.error}),[2];if(t=e.changes.find(function(e){return".replit"===e.path}),n=e.changes.find(function(e){return"replit.nix"===e.path}),!t)return[3,3];return[4,S.stageFiles({add:[".replit"]})];case 2:r.sent(),r.label=3;case 3:if(!n)return[3,5];return[4,S.stageFiles({add:["replit.nix"]})];case 4:r.sent(),r.label=5;case 5:if(!(t||n))return[3,7];return[4,S.commit({message:"Pre-Recovery checkpoint"})];case 6:r.sent(),r.label=7;case 7:return[4,S.log({path:".replit"})];case 8:var d;if((i=r.sent()).error)return A(!1),E("git log is not accessible"),(0,s.track)(l.events.NIX_MODULE,{action:"recovery",state:"Failed",reason:"Git Log Error"}),a.logger.error("Nix Broken State Recovery Failed due to Git",{gitLogError:i.error}),[2];return o=(d=i.commits)[d.length-1],[4,S.getFileContents({path:".replit",revision:o.hash,convertToBase64:!1})];case 9:if((u=r.sent()).error)return A(!1),E("failed recovering file contents"),(0,s.track)(l.events.NIX_MODULE,{action:"recovery",state:"Failed",reason:"Git File Contents Error"}),a.logger.error("Nix Broken State Recovery Failed due to Git",{gitFileContentError:u.error}),[2];return[4,C.writeFile(".replit",null!=(c=u.content)?c:"")];case 10:return r.sent(),[4,C.deleteFile("replit.nix")];case 11:return r.sent(),[4,S.stageFiles({add:[".replit"]})];case 12:return r.sent(),[4,S.stageFiles({add:["replit.nix"]})];case 13:return r.sent(),[4,S.commit({message:"Post-Recovery checkpoint"})];case 14:return r.sent(),S.forceRefresh(),A(!1),null==h||h(),(0,s.track)(l.events.NIX_MODULE,{action:"recovery",state:"Succeeded"}),a.logger.info("Finished Nix Broken State Recovery"),[2]}})})()},[S,C,h]);return(0,i.jsxs)(y.View,{gap:8,children:[(0,i.jsxs)(y.View,{gap:8,children:[(0,i.jsx)(x.Text,{variant:"subheadDefault",children:"The nix environment failed to build"}),(0,i.jsxs)(x.Text,{children:["Check if your"," ",(0,i.jsx)(p.Button,{css:k.inlineButton,variant:"underlined",onClick:function(){c(".replit"),null==h||h()},text:".replit"})," ","and"," ",(0,i.jsx)(p.Button,{css:k.inlineButton,variant:"underlined",onClick:function(){c("replit.nix"),null==h||h()},text:"replit.nix"})," ","files are configured properly:"]})]}),(0,i.jsx)(m.Surface,{elevated:!0,css:k.accordionWrapper,children:(0,i.jsx)(f.AccordionItem,{headerContent:(0,i.jsx)(y.View,{p:4,children:"Error Message"}),children:"error"===d.status?(0,i.jsx)(y.View,{css:k.brokenNixErrorWrapper,children:(0,i.jsx)(x.Text,{variant:"code",children:d.error})}):null})}),(0,i.jsx)(x.Text,{children:"Optionally, we can back up the broken configuration files and recover the original ones:"}),(0,i.jsx)(p.Button,{text:"Recover original configuration files",colorway:null!==T?"grey":"warning",onClick:P,isDisabled:I||null!==T,iconLeft:I?(0,i.jsx)(b.default,{}):(0,i.jsx)(w.default,{})}),T?(0,i.jsx)(g.StatusBanner,{colorway:"warning",text:(0,i.jsxs)(x.Text,{children:["Recovery failed: ",T]})}):null]})}function S(e){var t=e.isOpen,n=e.setIsOpen,r=e.nixError,o=e.openFile;return(0,i.jsx)(h.Modal,{isOpen:t,onRequestClose:function(){return n(!1)},children:(0,i.jsx)(_,{openFile:o,nixError:r,handleClose:function(){return n(!1)}})})}e.s(["NixIsBrokenModal",()=>S,"NixIsBrokenModalContent",()=>_])},782370,95661,e=>{"use strict";var t=e.i(297083),n=e.i(817556),r=e.i(276385),i=e.i(389959),o=e.i(960933),a=e.i(862927),s=e.i(877212),l=e.i(970187),u=e.i(858248),c=e.i(709485),d=e.i(927158),f=e.i(529810),p=e.i(106020),h=e.i(468095);e.i(32109);var g=e.i(384401);e.i(282890);var m=e.i(716636),x=e.i(259493),y=e.i(530658),b=e.i(642049),w=e.i(180703),k=e.i(649960),_=e.i(917375),S=e.i(86159),C=e.i(406206),j=e.i(782672),T=e.i(729122),E=e.i(94764),R=e.i(319401),I=e.i(831733),A=e.i(480028),P=e.i(446530),D=e.i(754873),O=e.i(123850),N=e.i(613355),M=e.i(960178),L=e.i(625484),B=e.i(550801),V=e.i(576073),F=e.i(703505),U=e.i(42458),G=(0,O.createCssVarTokens)(["blockMinHeight","terminalBackgroundColor"]).styleTokens,$=(0,P.cssRecord)({outputsListParent:[N.rcss.overflow("hidden"),N.rcss.borderRadius(4)],outputsListWrapper:[N.rcss.height("100%")],outputsList:[N.rcss.height("auto"),N.rcss.overflowY("scroll"),N.rcss.flex.growAndShrink(1)],outputsListSnapToBottom:{scrollSnapType:"y mandatory"},scrollSnap:[N.rcss.height(1),{marginTop:-1,pointerEvents:"none",scrollSnapAlign:"end"}],outputBlockCollapsingWrapper:[N.rcss.minHeight(G.blockMinHeight)],outputBlockTerminalWrapper:[N.rcss.minHeight(G.blockMinHeight),{backgroundColor:G.terminalBackgroundColor}],outputBlockClosingBorder:[N.rcss.height(1),N.rcss.zIndex(1),N.rcss.border({direction:"bottom",width:1,style:"solid",color:A.tokens.backgroundHigher}),{marginTop:-1}],workflowsListButton:[N.rcss.viewStyle,N.rcss.reset.button,N.rcss.p(2),N.rcss.height(22),N.rcss.rowWithGap(8),N.rcss.align.center,D.interactive.nofill,{transitionProperty:"background-color, box-shadow, opacity",opacity:.8}],workflowsListButtonText:[{fontSize:A.tokens.fontSizeSmall}]});function z(e){var t=e.openPane,n=e.ports,o=e.openAssistantWithMessage,a=e.openAgentWithMessage,s=e.onClear,l=e.onDontExposePort,u=e.onDoExposePort,c=(0,y._)((0,i.useState)(0),2),d=c[0],f=c[1],p=(0,y._)((0,i.useState)(!0),2),h=p[0],g=p[1],m=(0,i.useRef)(null),x=(0,S.useSetTourStepTarget)(_.newUserTour.id,_.TourStepIds.Output),C=(0,i.useRef)(0),j=(0,y._)((0,w.default)("show-only-latest-console-runs",!0),2),I=j[0],A=j[1],P=(0,T.useWorkflowsTaskFlatMap)(),D=(0,k.default)(function(e){f(e.height)},{type:"throttle",wait:200}),O=(0,i.useMemo)(function(){var e=P.sort(function(e,t){return e.task.startTime-t.task.startTime}),t=e.filter(function(e){var t=e.task;return!I||t.state===b.TaskState.RUNNING});return 0===t.length&&e.length>0?[e[e.length-1]]:t},[I,P]),N=(0,i.useMemo)(function(){return O.some(function(e){return e.task.state!==b.TaskState.RUNNING})},[O]),M=0===O.length;return(0,r.jsx)(L.View,{css:$.outputsListParent,grow:!0,shrink:!0,innerRef:x,"data-cy":"console",children:(0,r.jsxs)(L.View,{css:$.outputsListWrapper,innerRef:D,children:[(0,r.jsx)(W,{onClear:s,showOnlyLatest:I,setShowOnlyLatest:A,hasFinishedRuns:N,openPane:t}),M?(0,r.jsx)(E.default,{openPane:t}):(0,r.jsxs)(L.View,{css:[$.outputsList,h&&$.outputsListSnapToBottom],innerRef:m,onScroll:function(){m.current&&(m.current.scrollTop<C.current?g(!1):g(m.current.scrollHeight-m.current.scrollTop-20<d),C.current=m.current.scrollTop)},children:[O.map(function(e){var i=e.task,s=e.taskIdx,c=e.runId,f=e.config;return(0,r.jsx)(R.WorkflowsTaskBlock,{task:i,taskIdx:s,runId:c,config:f,maxHeight:d,rootRef:m,ports:n,openPane:t,openAssistantWithMessage:o,openAgentWithMessage:a,onDoExposePort:u,onDontExposePort:l},c+"-"+s)}),h?(0,r.jsx)(L.View,{css:$.scrollSnap}):null]})]})})}var H=(0,P.cssRecord)({header:[N.rcss.height(28),N.rcss.width("100%"),N.rcss.pl(8),N.rcss.pr(2),N.rcss.flex.row,{borderBottom:"1px solid ".concat(A.tokens.outlineDimmest),opacity:.8,":hover":{opacity:1}}],headerRecoveryMode:[N.rcss.height(28),N.rcss.width("100%"),N.rcss.backgroundColor.orangeDimmer,{cursor:"pointer",borderBottom:"1px solid ".concat(A.tokens.outlineDimmer),"&:hover":[N.rcss.backgroundColor.orangeDefault]}],groupRight:[N.rcss.height("100%"),N.rcss.rowWithGap(4),N.rcss.px(2)],workflowsDropdownText:[{fontSize:A.tokens.fontSizeSmall}],workflowsDropdownButton:[N.rcss.reset.button,N.rcss.justify.center,N.rcss.p(2),N.rcss.height(22),N.rcss.align.center,D.interactive.nofill,N.rcss.rowWithGap(4)]});function W(e){var t=(0,j.useNixError)(),n=(0,y._)((0,i.useState)(!1),2),o=n[0],a=n[1],s=(0,i.useCallback)(function(t){e.openPane({type:"codeEditor",data:{path:t}})},[e]);return t?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(L.View,{css:H.headerRecoveryMode,justify:"center",align:"center",gap:8,row:!0,onClick:function(){return a(!0)},children:[(0,r.jsx)(U.default,{}),"App is in recovery mode"]}),(0,r.jsx)(B.NixIsBrokenModal,{isOpen:o,setIsOpen:a,nixError:t,openFile:s})]}):(0,r.jsxs)(L.View,{css:H.header,justify:"space-between",align:"center",children:[(0,r.jsx)(L.View,{children:(0,r.jsx)(I.default,{openPane:e.openPane,triggerElement:(0,r.jsxs)(L.SpecializedView.button,{css:H.workflowsDropdownButton,children:[(0,r.jsx)(M.Text,{css:H.workflowsDropdownText,children:"Workflows"}),(0,r.jsx)(V.default,{size:12})]})})}),(0,r.jsxs)(L.View,{css:H.groupRight,align:"center",children:[(0,r.jsx)(C.PaneHeaderSwitch,{text:"Show Only Latest",isSelected:e.showOnlyLatest,onChange:e.setShowOnlyLatest}),(0,r.jsx)(C.PaneHeaderActionButton,{altText:"Clear Past Runs",buttonText:"Clear Past Runs",icon:(0,r.jsx)(F.default,{}),onClick:e.onClear,disabled:!e.hasFinishedRuns})]})]})}var q=e.i(188507),K=e.i(924908);function Y(e){var r,o,a=e.openPane,s=(r=(0,K.useChatter)(),o=(0,l.useAssistantChatMode)().getAssistantMessageIntent,(0,i.useCallback)(function(e){return(0,t._)(function(){var t,i;return(0,n._)(this,function(n){switch(n.label){case 0:return[4,r.sessions.create({sessionType:q.SessionType.CHAT})];case 1:if(!(t=n.sent()).ok)return[2,t];return(i=t.payload).appendEvent({kind:"message",message:e,intent:o()}),[2,{ok:!0,payload:{newSessionId:i.id}}]}})})()},[r.sessions,o]));return(0,i.useCallback)(function(e){return(0,t._)(function(){var t;return(0,n._)(this,function(n){switch(n.label){case 0:return a({type:"ghostwriterChat"}),[4,s(e)];case 1:if(!(t=n.sent()).ok)return[2];return a({type:"ghostwriterChat",data:{sessionId:t.payload.newSessionId}}),[2]}})})()},[a,s])}e.s(["useSendAssistantMessageInNewSessionAndOpenChatPane",()=>Y],95661);var Q=e.i(606867),X=e.i(476891),J=o.Type.Object({type:o.Type.Literal("runnerOutput")}),Z={id:"outputs.clear",name:"Clear console history",default:void 0};function ee(e){var o,a,m,y,b,w,k=e.options,_=(a=(o=(0,f.default)()).fs,m=o.ports,y=(0,d.usePid2Callback)(function(e){return function(){return e.workflows.clearHistory.rpc({})}},[]),b=(0,i.useCallback)(function(){null==y||y()},[y]),(0,x.useSetPaneBindings)(function(){return{commands:[{commands:[{match:p.matchLabel,data:{type:"action",label:"Clear History",icon:(0,r.jsx)(F.default,{}),run:function(){return b()}}}]}]}},[b]),(0,g.useCommandBinding)(function(){return[Z.id,b]},[b]),w=(0,i.useCallback)(function(e){m.updateDotReplitPortsMapping(e,void 0)},[m]),{onClear:b,onDoExposePort:(0,i.useCallback)(function(e){m.tryExposingPortAutomatically(e)},[m]),onDontExposePort:w,ports:m,fs:a}),S=_.ports,C=_.onDontExposePort,j=_.onDoExposePort,T=_.onClear,E=k.performPaneOperation,R=(0,i.useCallback)(function(e){E({operation:"open",secondary:"ghostwriterChat"===e.type,pane:e})},[E]),I=Y({openPane:R}),A=(0,h.useSendAgentMessage)({openPane:R}),P=(0,l.useAssistantChatMode)().assistantMode,D=(0,s.useSupportsAgent)(),O=(0,i.useCallback)(function(e){return(0,t._)(function(){return(0,n._)(this,function(t){return(0,u.track)(c.events.ASSISTANT_USED,{action:"message_sent",assistant_mode:P,message_content:e,message_source:"console",is_agent_repl:D}),I(e),[2]})})()},[D,P,I]),N=(0,i.useCallback)(function(e,r){return(0,t._)(function(){return(0,n._)(this,function(t){switch(t.label){case 0:return(0,u.track)(c.events.AGENT_USED,{action:"message_sent",message_content:e,message_source:"console"}),[4,A(e,r)];case 1:return t.sent(),[2]}})})()},[A]);return(0,r.jsx)(z,{ports:S,openPane:R,openAssistantWithMessage:O,openAgentWithMessage:N,onClear:T,onDontExposePort:C,onDoExposePort:j})}var et={Content:function(e){var t=e.options;return(0,r.jsx)(ee,{options:t})},Icon:function(e){var t=e.size;return(0,r.jsx)(Q.IconContext.Provider,{value:{color:A.tokens.yellowStrongest,size:t},children:(0,r.jsx)(X.default,{})})},getTitle:function(){return"Console"},description:"View the terminal output after running your code",category:m.PaneCategory.WorkspaceFeatures,decode:function(e){return a.Value.Decode(J,e)}};e.s(["clearOutputsHistoryCommand",()=>Z,"runnerOutputUI",()=>et],782370)},200119,e=>{"use strict";var t=e.i(389959),n=e.i(188507),r=e.i(417120);function i(){var e=(0,r.useAgentState)().agentState;return(0,t.useMemo)(function(){return e?e.select(function(e){switch(null==e?void 0:e.state){case n.AgentRunState.AGENT_STATE_RUNNING:case n.AgentRunState.AGENT_STATE_PAUSING:return!0;default:return!1}}):null},[e])}e.s(["useAgentIsWorking",()=>i])},202266,e=>{"use strict";var t=e.i(297083),n=e.i(530658),r=e.i(119468),i=e.i(817556),o=e.i(878420),a=e.i(569384),s=e.i(973245),l=e.i(951262);function u(){var e=(0,a._)(["\n  mutation SetUserKeybindings($input: SetUserKeybindingsInput!) {\n    setUserKeybindings(input: $input) {\n      ... on Keybindings {\n        keybindings\n      }\n    }\n  }\n"]);return u=function(){return e},e}var c={},d=(0,s.gql)(u()),f=e.i(125674),p=e.i(507187),h=e.i(262206),g=e.i(932495);function m(){var e,r=(0,p.useEnvironment)(),a=(0,n._)((e=(0,o._)({},c,void 0),l.useMutation(d,e)),1)[0],s=(0,g.usePlatform)();return(0,f.default)(function(){return function(e){return(0,t._)(function(){var t,o,l,u,c,d,f,p,h;return(0,i._)(this,function(i){switch(i.label){case 0:t=[],o=!0,l=!1,u=void 0;try{for(c=e[Symbol.iterator]();!(o=(d=c.next()).done);o=!0)p=(f=(0,n._)(d.value,2))[0],h=f[1],t.push({commandId:p,keyCombo:h})}catch(e){l=!0,u=e}finally{try{o||null==c.return||c.return()}finally{if(l)throw u}}return[4,a({variables:{input:{environment:r,platform:s,keybindings:t}}})];case 1:return i.sent(),[2]}})})()}},[r,a,s])}function x(e){var t=new Map;if(!Array.isArray(e))return t;var n=!0,i=!1,o=void 0;try{for(var a,s=e[Symbol.iterator]();!(n=(a=s.next()).done);n=!0){var l=a.value,u=function(e){if(e&&(void 0===e?"undefined":(0,r._)(e))==="object"&&"commandId"in e&&"string"==typeof e.commandId&&"keyCombo"in e){if(Array.isArray(e.keyCombo)){var t=(0,h.parseKeyChord)(e.keyCombo);return{commandId:e.commandId,keyCombo:t}}if("string"==typeof e.keyCombo){var n=(0,h.parseKeyCombination)(e.keyCombo);return{commandId:e.commandId,keyCombo:n}}return{commandId:e.commandId,keyCombo:null}}}(l);u&&t.set(u.commandId,u.keyCombo)}}catch(e){i=!0,o=e}finally{try{n||null==s.return||s.return()}finally{if(i)throw o}}return t}e.s(["initKeybindings",()=>x,"useSaveKeybindings",()=>m],202266)},135211,e=>{"use strict";var t=e.i(297083),n=e.i(817556),r=e.i(276385),i=e.i(389959),o=e.i(223808),a=e.i(222342),s=e.i(858248),l=e.i(709485),u=e.i(529810),c=e.i(545453),d=e.i(102905),f=e.i(595974);function p(){var e=(0,u.default)(),r=(0,f.useValue)(f.actionQueueAtom),p=(0,f.useValue)(f.currentActionAtom),h=(0,f.useGet)(f.currentActionAtom),g=(0,f.useSet)(f.currentActionAtom),m=(0,f.useValue)(f.statusAtom),x=(0,f.useSetStatus)(),y=(0,f.useGetStatus)(),b=(0,f.useSetInstalledPackages)(),w=(0,f.useShiftActionQueue)(),k=(0,a.default)(),_=(0,c.usePackagerConfigs)().configs,S=(0,f.useAddErrors)();return(0,i.useEffect)(function(){if(0!==_.length){var t=[],n=!1,r=!0,i=!1,a=void 0;try{for(var s,l=_[Symbol.iterator]();!(r=(s=l.next()).done);r=!0)!function(){var r=s.value,i=Promise.resolve(),a=y(r.id),l=(0,o.default)(function(){var t=y(r.id),o=h();if(t===f.PackagerStatus.Idle||(null==o?void 0:o.id)!==r.id){var a=(0,d.getPackager)(r.id);i=i.then(function(){if(!n)return a.getInstalledPackages({id:r.id,services:e}).then(function(e){n||(b(r.id,e),x(r.id,f.PackagerStatus.Idle))})})}},500);if(r.packagerFiles.length>0){var u=!0,c=!1,p=void 0;try{for(var g,m=r.packagerFiles[Symbol.iterator]();!(u=(g=m.next()).done);u=!0)!function(){var n=g.value;if(!n.endsWith("/")){var r=null!==a&&a!==f.PackagerStatus.Initializing&&a!==f.PackagerStatus.Uninitialized,i=e.fs.watchFilePath(n,{onChange:function(){if(!r){r=!0;return}l()}});t.push(i)}}()}catch(e){c=!0,p=e}finally{try{u||null==m.return||m.return()}finally{if(c)throw p}}}}()}catch(e){i=!0,a=e}finally{try{r||null==l.return||l.return()}finally{if(i)throw a}}return function(){n=!0;var e=!0,r=!1,i=void 0;try{for(var o,a=t[Symbol.iterator]();!(e=(o=a.next()).done);e=!0)(0,o.value)()}catch(e){r=!0,i=e}finally{try{e||null==a.return||a.return()}finally{if(r)throw i}}}}},[_,e.fs]),(0,i.useEffect)(function(){var r=!1;return(0,t._)(function(){var t,i,o,a,s,l;return(0,n._)(this,function(n){t=!0,i=!1,o=void 0;try{for(a=function(){var t=l.value,n=y(t.id);if(n&&n!==f.PackagerStatus.Uninitialized&&n!==f.PackagerStatus.Initializing)return"continue";x(t.id,f.PackagerStatus.Initializing),(0,d.getPackager)(t.id).getInstalledPackages({id:t.id,services:e}).then(function(e){r||(b(t.id,e),x(t.id,f.PackagerStatus.Idle))})},s=_[Symbol.iterator]();!(t=(l=s.next()).done);t=!0)a()}catch(e){i=!0,o=e}finally{try{t||null==s.return||s.return()}finally{if(i)throw o}}return[2]})})(),function(){r=!0}},[_]),(0,i.useEffect)(function(){if(null===p&&0!==r.length){var e=r[0];y(e.id)===f.PackagerStatus.Idle&&w(e)}},[m,p,r]),(0,i.useEffect)(function(){if(null!==p){var r=!1;return(0,t._)(function(){var t,i,o,a,u,c,h,m,y,w,_,C,j,T,E,R,I,A;return(0,n._)(this,function(n){switch(n.label){case 0:switch(t=(0,d.getPackager)(p.id),p.kind){case f.PackagerActionKind.Install:return[3,1];case f.PackagerActionKind.Uninstall:return[3,6]}return[3,11];case 1:x(p.id,f.PackagerStatus.Installing),i=!0,o=!1,a=void 0;try{for(u=p.pkgs[Symbol.iterator]();!(i=(c=u.next()).done);i=!0)h=c.value,(0,s.track)(l.events.PACKAGE_MANAGER_USED,{action:"installed",packageId:h.name})}catch(e){o=!0,a=e}finally{try{i||null==u.return||u.return()}finally{if(o)throw a}}n.label=2;case 2:return n.trys.push([2,4,,5]),[4,t.install({id:p.id,pkgs:p.pkgs,services:e})];case 3:return n.sent(),1===p.pkgs.length?k.showNotice("Installed ".concat(null!=(m=p.pkgs[0].name)?m:"package")):k.showNotice("Installed ".concat(p.pkgs.length," packages")),[3,5];case 4:return n.sent(),1===p.pkgs.length?k.showError("Failed to install ".concat(null!=(y=p.pkgs[0].name)?y:"package")):k.showError("Failed to install ".concat(p.pkgs.length," packages")),S(p.id,p.pkgs),[3,5];case 5:return[3,11];case 6:x(p.id,f.PackagerStatus.Uninstalling),w=!0,_=!1,C=void 0;try{for(j=p.pkgs[Symbol.iterator]();!(w=(T=j.next()).done);w=!0)E=T.value,(0,s.track)(l.events.PACKAGE_MANAGER_USED,{action:"removed",packageId:E.name})}catch(e){_=!0,C=e}finally{try{w||null==j.return||j.return()}finally{if(_)throw C}}n.label=7;case 7:return n.trys.push([7,9,,10]),[4,t.uninstall({id:p.id,pkgs:p.pkgs,services:e})];case 8:return n.sent(),1===p.pkgs.length?k.showNotice("Removed ".concat(null!=(R=p.pkgs[0].name)?R:"package")):k.showNotice("Removed ".concat(p.pkgs.length," packages")),[3,10];case 9:return n.sent(),1===p.pkgs.length?k.showError("Failed to remove ".concat(null!=(I=p.pkgs[0].name)?I:"package")):k.showError("Failed to remove ".concat(p.pkgs.length," packages")),S(p.id,p.pkgs),[3,10];case 10:return[3,11];case 11:if(r)return[2];return[4,t.getInstalledPackages({id:p.id,services:e})];case 12:if(A=n.sent(),r)return[2];return b(p.id,A),x(p.id,f.PackagerStatus.Idle),g(null),[2]}})})(),function(){r=!0}}},[p]),null}function h(e){var t=e.children,n=(0,f.useInitStore)();return(0,r.jsxs)(f.GlobalPackagerContext.Provider,{value:n,children:[(0,r.jsx)(p,{}),t]})}e.s(["default",()=>h])},203594,e=>{"use strict";var t=e.i(530658),n=e.i(389959),r=e.i(903381),i=e.i(529810),o=e.i(341727);function a(){var e=(0,i.default)().fs,a=(0,t._)((0,n.useState)(!1),2),s=a[0],l=a[1],u=(0,o.default)(),c=u.didConnectOnce,d=u.didDisconnect;return((0,n.useEffect)(function(){return l(e.getStatus()===r.FsStatus.Syncing),e.onStatusChange(function(e){l(e===r.FsStatus.Syncing)})},[e]),c)?{isSaving:s,isOffline:d}:{isSaving:!1,isOffline:!1}}e.s(["default",()=>a])},545150,e=>{"use strict";e.i(33699);var t,n,r,i,o=e.i(898740),a=e.i(25195),s=e.i(389959),l=e.i(119468),u="data-focus-lock",c="data-focus-lock-disabled",d="data-no-focus-lock",f="data-autofocus-inside",p="data-no-autofocus";e.s(["FOCUS_ALLOW",()=>d,"FOCUS_AUTO",()=>f,"FOCUS_DISABLED",()=>c,"FOCUS_GROUP",()=>u,"FOCUS_NO_AUTOFOCUS",()=>p],300410);var h={width:"1px",height:"0px",padding:0,overflow:"hidden",position:"fixed",top:"1px",left:"1px"},g=function(e){var t=e.children;return s.createElement(s.Fragment,null,s.createElement("div",{key:"guard-first","data-focus-guard":!0,"data-focus-auto-guard":!0,style:h}),t,t&&s.createElement("div",{key:"guard-last","data-focus-guard":!0,"data-focus-auto-guard":!0,style:h}))};g.propTypes={},g.defaultProps={children:null};var m=e.i(364567);function x(e){return e}function y(e,t){void 0===t&&(t=x);var n=[],r=!1;return{read:function(){if(r)throw Error("Sidecar: could not `read` from an `assigned` medium. `read` could be used only with `useMedium`.");return n.length?n[n.length-1]:e},useMedium:function(e){var i=t(e,r);return n.push(i),function(){n=n.filter(function(e){return e!==i})}},assignSyncMedium:function(e){for(r=!0;n.length;){var t=n;n=[],t.forEach(e)}n={push:function(t){return e(t)},filter:function(){return n}}},assignMedium:function(e){r=!0;var t=[];if(n.length){var i=n;n=[],i.forEach(e),t=n}var o=function(){var n=t;t=[],n.forEach(e)},a=function(){return Promise.resolve().then(o)};a(),n={push:function(e){t.push(e),a()},filter:function(e){return t=t.filter(e),n}}}}}function b(e,t){return void 0===t&&(t=x),y(e,t)}var w=b({},function(e){return{target:e.target,currentTarget:e.currentTarget}}),k=b(),_=b(),S=(t={async:!0},(n=y(null)).options=(0,m.__assign)({async:!0,ssr:!1},t),n),C=[],j=s.forwardRef(function(e,t){var n,r,i,o,d=s.useState(),f=d[0],p=d[1],g=s.useRef(),m=s.useRef(!1),x=s.useRef(null),y=e.children,b=e.disabled,_=e.noFocusGuards,j=e.persistentFocus,T=e.crossFrame,E=e.autoFocus,R=(e.allowTextSelection,e.group),I=e.className,A=e.whiteList,P=e.hasPositiveIndices,D=e.shards,O=e.as,N=e.lockProps,M=e.sideCar,L=e.returnFocus,B=e.focusOptions,V=e.onActivation,F=e.onDeactivation,U=s.useState({})[0],G=s.useCallback(function(){x.current=x.current||document&&document.activeElement,g.current&&V&&V(g.current),m.current=!0},[V]),$=s.useCallback(function(){m.current=!1,F&&F(g.current)},[F]);(0,s.useEffect)(function(){b||(x.current=null)},[]);var z=s.useCallback(function(e){var t=x.current;if(t&&t.focus){var n="function"==typeof L?L(t):L;if(n){var r=(void 0===n?"undefined":(0,l._)(n))==="object"?n:void 0;x.current=null,e?Promise.resolve().then(function(){return t.focus(r)}):t.focus(r)}}},[L]),H=s.useCallback(function(e){m.current&&w.useMedium(e)},[]),W=k.useMedium,q=s.useCallback(function(e){g.current!==e&&(g.current=e,p(e))},[]),K=(0,a.default)(((o={})[c]=b&&"disabled",o[u]=R,o),void 0===N?{}:N),Y=!0!==_,Q=Y&&"tail"!==_,X=(n=[t,q],r=function(e){return n.forEach(function(t){return"function"==typeof t?t(e):t&&(t.current=e),t})},(i=(0,s.useState)(function(){return{value:null,callback:r,facade:{get current(){return i.value},set current(value){var e=i.value;e!==value&&(i.value=value,i.callback(value,e))}}}})[0]).callback=r,i.facade);return s.createElement(s.Fragment,null,Y&&[s.createElement("div",{key:"guard-first","data-focus-guard":!0,tabIndex:b?-1:0,style:h}),P?s.createElement("div",{key:"guard-nearest","data-focus-guard":!0,tabIndex:b?-1:1,style:h}):null],!b&&s.createElement(M,{id:U,sideCar:S,observed:f,disabled:b,persistentFocus:j,crossFrame:T,autoFocus:E,whiteList:A,shards:void 0===D?C:D,onActivation:G,onDeactivation:$,returnFocus:z,focusOptions:B}),s.createElement(void 0===O?"div":O,(0,a.default)({ref:X},K,{className:I,onBlur:W,onFocus:H}),y),Q&&s.createElement("div",{"data-focus-guard":!0,tabIndex:b?-1:0,style:h}))});function T(e,t){return(T=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}j.propTypes={},j.defaultProps={children:void 0,disabled:!1,returnFocus:!1,focusOptions:void 0,noFocusGuards:!1,autoFocus:!0,persistentFocus:!1,crossFrame:!0,hasPositiveIndices:void 0,allowTextSelection:void 0,group:void 0,className:void 0,whiteList:void 0,shards:void 0,as:"div",lockProps:{},onActivation:void 0,onDeactivation:void 0};var E=e.i(913262);e.i(300410);var R=e.i(167626),I=function(e){for(var t=Array(e.length),n=0;n<e.length;++n)t[n]=e[n];return t},A=function(e){return Array.isArray(e)?e:[e]},P=function(e){return Array.isArray(e)?e[0]:e},D=function(e){if(e.nodeType!==Node.ELEMENT_NODE)return!1;var t=window.getComputedStyle(e,null);return!!t&&!!t.getPropertyValue&&("none"===t.getPropertyValue("display")||"hidden"===t.getPropertyValue("visibility"))},O=function(e){return e.parentNode&&e.parentNode.nodeType===Node.DOCUMENT_FRAGMENT_NODE?e.parentNode.host:e.parentNode},N=function(e){return e===document||e&&e.nodeType===Node.DOCUMENT_NODE},M=function(e,t){var n,r=e.get(t);if(void 0!==r)return r;var i=(n=M.bind(void 0,e),!t||N(t)||!D(t)&&n(O(t)));return e.set(t,i),i},L=function(e,t){var n,r=e.get(t);if(void 0!==r)return r;var i=(n=L.bind(void 0,e),!t||!!N(t)||!!U(t)&&n(O(t)));return e.set(t,i),i},B=function(e){return e.dataset},V=function(e){return"INPUT"===e.tagName},F=function(e){return V(e)&&"radio"===e.type},U=function(e){return![!0,"true",""].includes(e.getAttribute(p))},G=function(e){var t;return!!(e&&(null==(t=B(e))?void 0:t.focusGuard))},$=function(e){return!G(e)},z=function(e){return!!e},H=function(e,t){var n=e.tabIndex-t.tabIndex,r=e.index-t.index;if(n){if(!e.tabIndex)return 1;if(!t.tabIndex)return -1}return n||r},W=function(e,t,n){return I(e).map(function(e,t){return{node:e,index:t,tabIndex:n&&-1===e.tabIndex?(e.dataset||{}).focusGuard?0:-1:e.tabIndex}}).filter(function(e){return!t||e.tabIndex>=0}).sort(H)},q="button:enabled,select:enabled,textarea:enabled,input:enabled,a[href],area[href],summary,iframe,object,embed,audio[controls],video[controls],[tabindex],[contenteditable],[autofocus]",K="".concat(q,", [data-focus-guard]"),Y=function(e,t){return I((e.shadowRoot||e).children).reduce(function(e,n){return e.concat(n.matches(t?K:q)?[n]:[],Y(n))},[])},Q=function(e,t){var n;return(0,R._)(e,HTMLIFrameElement)&&(null==(n=e.contentDocument)?void 0:n.body)?X([e.contentDocument.body],t):[e]},X=function(e,t){return e.reduce(function(e,n){var r,i=Y(n,t),o=(r=[]).concat.apply(r,i.map(function(e){return Q(e,t)}));return e.concat(o,n.parentNode?I(n.parentNode.querySelectorAll(q)).filter(function(e){return e===n}):[])},[])},J=function(e,t){return I(e).filter(function(e){return M(t,e)}).filter(function(e){var t;return!((V(t=e)||"BUTTON"===t.tagName)&&("hidden"===t.type||t.disabled))})},Z=function(e,t){return void 0===t&&(t=new Map),I(e).filter(function(e){return L(t,e)})},ee=function(e,t,n){return W(J(X(e,n),t),!0,n)},et=function(e,t){return W(J(X(e),t),!1)},en=function(e,t){return e.shadowRoot?en(e.shadowRoot,t):!!(void 0!==Object.getPrototypeOf(e).contains&&Object.getPrototypeOf(e).contains.call(e,t))||I(e.children).some(function(e){var n;if((0,R._)(e,HTMLIFrameElement)){var r=null==(n=e.contentDocument)?void 0:n.body;return!!r&&en(r,t)}return en(e,t)})},er=function(e){for(var t=new Set,n=e.length,r=0;r<n;r+=1)for(var i=r+1;i<n;i+=1){var o=e[r].compareDocumentPosition(e[i]);(o&Node.DOCUMENT_POSITION_CONTAINED_BY)>0&&t.add(i),(o&Node.DOCUMENT_POSITION_CONTAINS)>0&&t.add(r)}return e.filter(function(e,n){return!t.has(n)})},ei=function(e){return e.parentNode?ei(e.parentNode):e},eo=function(e){return A(e).filter(Boolean).reduce(function(e,t){var n=t.getAttribute(u);return e.push.apply(e,n?er(I(ei(t).querySelectorAll("[".concat(u,'="').concat(n,'"]:not([').concat(c,'="disabled"])')))):[t]),e},[])},ea=function(e){try{return e()}catch(e){return}},es=function(e){if(void 0===e&&(e=document),e&&e.activeElement){var t=e.activeElement;return t.shadowRoot?es(t.shadowRoot):(0,R._)(t,HTMLIFrameElement)&&ea(function(){return t.contentWindow.document})?es(t.contentWindow.document):t}},el=function(e,t){return void 0===t&&(t=es(P(e).ownerDocument)),!!t&&(!t.dataset||!t.dataset.focusGuard)&&eo(e).some(function(e){var n;return en(e,t)||(n=t,!!I(e.querySelectorAll("iframe")).some(function(e){return e===n}))})},eu=function(e){void 0===e&&(e=document);var t=es(e);return!!t&&I(e.querySelectorAll("[".concat(d,"]"))).some(function(e){return en(e,t)})},ec=function(e,t){if(F(e)&&e.name)return t.filter(F).filter(function(t){return t.name===e.name}).filter(function(e){return e.checked})[0]||e;return e},ed=function(e){var t=new Set;return e.forEach(function(n){return t.add(ec(n,e))}),e.filter(function(e){return t.has(e)})},ef=function(e){return e[0]&&e.length>1?ec(e[0],e):e[0]},ep=function(e,t){return e.length>1?e.indexOf(ec(e[t],e)):t},eh="NEW_FOCUS",eg=function(e,t,n,r){var i=e.length,o=e[0],a=e[i-1],s=G(n);if(!(n&&e.indexOf(n)>=0)){var l=void 0!==n?t.indexOf(n):-1,u=r?t.indexOf(r):l,c=r?e.indexOf(r):-1,d=l-u,f=t.indexOf(o),p=t.indexOf(a),h=ed(t),g=(void 0!==n?h.indexOf(n):-1)-(r?h.indexOf(r):l),m=ep(e,0),x=ep(e,i-1);if(-1===l||-1===c)return eh;if(!d&&c>=0)return c;if(l<=f&&s&&Math.abs(d)>1)return x;if(l>=p&&s&&Math.abs(d)>1)return m;if(d&&Math.abs(g)>1)return c;if(l<=f)return x;if(l>p)return m;if(d)return Math.abs(d)>1?c:(i+c+d)%i}},em=function(e,t,n){var r=Z(e.map(function(e){return e.node}).filter(function(e){var t,r=null==(t=B(e))?void 0:t.autofocus;return e.autofocus||void 0!==r&&"false"!==r||n.indexOf(e)>=0}));return r&&r.length?ef(r):ef(Z(t))},ev=function(e,t){return void 0===t&&(t=[]),t.push(e),e.parentNode&&ev(e.parentNode.host||e.parentNode,t),t},ex=function(e,t){for(var n=ev(e),r=ev(t),i=0;i<n.length;i+=1){var o=n[i];if(r.indexOf(o)>=0)return o}return!1},ey=function(e,t,n){var r=A(e),i=A(t),o=r[0],a=!1;return i.filter(Boolean).forEach(function(e){a=ex(a||e,e)||a,n.filter(Boolean).forEach(function(e){var t=ex(o,e);t&&(a=!a||en(t,a)?t:ex(t,a))})}),a},eb=function(e,t){var n=new Map;return t.forEach(function(e){return n.set(e.node,e)}),e.map(function(e){return n.get(e)}).filter(z)},ew=function(e,t){var n=es(A(e).length>0?document:P(e).ownerDocument),r=eo(e).filter($),i=ey(n||e,e,r),o=new Map,a=et(r,o),s=ee(r,o).filter(function(e){return $(e.node)});if(s[0]||(s=a)[0]){var l=et([i],o).map(function(e){return e.node}),u=eb(l,s),c=u.map(function(e){return e.node}),d=eg(c,l,n,t);if(d===eh){var p=em(a,c,r.reduce(function(e,t){var n,r;return e.concat((n=t,r=o,J(I(n.querySelectorAll("[".concat(f,"]"))).map(function(e){return X([e])}).reduce(function(e,t){return e.concat(t)},[]),r)))},[]));return p?{node:p}:void console.warn("focus-lock: cannot find any node to move focus into")}return void 0===d?d:u[d]}},ek=function(e){var t=eo(e).filter($),n=ey(e,e,t),r=new Map,i=ee([n],r,!0),o=ee(t,r).filter(function(e){return $(e.node)}).map(function(e){return e.node});return i.map(function(e){var t=e.node;return{node:t,index:e.index,lockItem:o.indexOf(t)>=0,guard:G(t)}})},e_=function(e,t){"focus"in e&&e.focus(t),"contentWindow"in e&&e.contentWindow&&e.contentWindow.focus()},eS=0,eC=!1;let ej=function(e,t,n){void 0===n&&(n={});var r=ew(e,t);if(!eC&&r){if(eS>2){console.error("FocusLock: focus-fighting detected. Only one focus management system could be active. See https://github.com/theKashey/focus-lock/#focus-fighting"),eC=!0,setTimeout(function(){eC=!1},1);return}eS++,e_(r.node,n.focusOptions),eS--}};function eT(e){var t=window.setImmediate;void 0!==t?t(e):setTimeout(e,1)}var eE=null,eR=null,eI=null,eA=!1,eP=function(e,t){eI={observerNode:e,portaledElement:t}};function eD(e,t,n,r){var i=null,o=e;do{var a=r[o];if(a.guard)a.node.dataset.focusAutoGuard&&(i=a);else if(a.lockItem){if(o!==e)return;i=null}else break}while((o+=n)!==t)i&&(i.node.tabIndex=0)}var eO=function(e){return e&&"current"in e?e.current:e},eN=function(){var e=!1;if(eE){var t=eE,n=t.observed,r=t.persistentFocus,i=t.autoFocus,o=t.shards,a=t.crossFrame,s=t.focusOptions,l=n||eI&&eI.portaledElement,u=document&&document.activeElement;if(l){var c=[l].concat(o.map(eO).filter(Boolean));if((!u||(eE.whiteList||function(){return!0})(u))&&(r||(a?!!eA:"meanwhile"===eA)||!(document&&document.activeElement===document.body||eu())||!eR&&i)&&(l&&!(el(c)||u&&c.some(function(e){return function e(t,n,r){return n&&(n.host===t&&(!n.activeElement||r.contains(n.activeElement))||n.parentNode&&e(t,n.parentNode,r))}(u,e,e)})||eI&&eI.portaledElement===u)&&(document&&!eR&&u&&!i?(u.blur&&u.blur(),document.body.focus()):(e=ej(c,eR,{focusOptions:s}),eI={})),eA=!1,eR=document&&document.activeElement),document){var d=document&&document.activeElement,f=ek(c),p=f.map(function(e){return e.node}).indexOf(d);p>-1&&(f.filter(function(e){var t=e.guard,n=e.node;return t&&n.dataset.focusAutoGuard}).forEach(function(e){return e.node.removeAttribute("tabIndex")}),eD(p,f.length,1,f),eD(p,-1,-1,f))}}}return e},eM=function(e){eN()&&e&&(e.stopPropagation(),e.preventDefault())},eL=function(){return eT(eN)},eB=function(){eA="just",setTimeout(function(){eA="meanwhile"},0)},eV=function(){document.addEventListener("focusin",eM),document.addEventListener("focusout",eL),window.addEventListener("blur",eB)},eF=function(){document.removeEventListener("focusin",eM),document.removeEventListener("focusout",eL),window.removeEventListener("blur",eB)};w.assignSyncMedium(function(e){var t=e.target,n=e.currentTarget;n.contains(t)||eP(n,t)}),k.assignMedium(eL),_.assignMedium(function(e){return e({moveFocusInside:ej,focusInside:el})});let eU=(r=function(e){return e.filter(function(e){return!e.disabled})},i=function(e){var t=e.slice(-1)[0];t&&!eE&&eV();var n=eE,r=n&&t&&t.id===n.id;eE=t,n&&!r&&(n.onDeactivation(),e.filter(function(e){return e.id===n.id}).length||n.returnFocus(!t)),t?(eR=null,r&&n.observed===t.observed||t.onActivation(),eN(!0),eT(eN)):(eF(),eR=null)},function(e){var t,n=[];function o(){i(t=r(n.map(function(e){return e.props})))}var a=function(r){function i(){return r.apply(this,arguments)||this}i.prototype=Object.create(r.prototype),i.prototype.constructor=i,T(i,r),i.peek=function(){return t};var a=i.prototype;return a.componentDidMount=function(){n.push(this),o()},a.componentDidUpdate=function(){o()},a.componentWillUnmount=function(){var e=n.indexOf(this);n.splice(e,1),o()},a.render=function(){return s.default.createElement(e,this.props)},i}(s.PureComponent);return(0,E.default)(a,"displayName","SideEffect("+(e.displayName||e.name||"Component")+")"),a})(function(){return null});var eG=s.forwardRef(function(e,t){return s.createElement(j,(0,a.default)({sideCar:eU,ref:t},e))}),e$=j.propTypes||{};e$.sideCar,(0,o.default)(e$,["sideCar"]),eG.propTypes={},e.s(["default",0,eG],545150)},689100,(e,t,n)=>{var r=e.r(954546),i=e.r(769627),o=e.r(790951),a=e.r(308145),s=a.safeRe,l=a.t;t.exports=function(e,t){if(r._(e,i))return e;if("number"==typeof e&&(e=String(e)),"string"!=typeof e)return null;var n,a=null;if((t=t||{}).rtl){for(;(n=s[l.COERCERTL].exec(e))&&(!a||a.index+a[0].length!==e.length);)a&&n.index+n[0].length===a.index+a[0].length||(a=n),s[l.COERCERTL].lastIndex=n.index+n[1].length+n[2].length;s[l.COERCERTL].lastIndex=-1}else a=e.match(s[l.COERCE]);return null===a?null:o("".concat(a[2],".").concat(a[3]||"0",".").concat(a[4]||"0"),t)}},850270,278505,119322,e=>{"use strict";var t=e.i(297083),n=e.i(530658),r=e.i(817556),i=e.i(399528),o=e.i(389959),a=e.i(906368),s=e.i(169252),l=e.i(395172),u=e.i(188507),c=e.i(19004),d=e.i(391444),f=e.i(968783),p=e.i(222342),h=e.i(207237),g=e.i(664152),m=e.i(956111),x=e.i(858248),y=e.i(709485),b=e.i(608738),w=e.i(529810),k=e.i(112942),_=e.i(45442),S=e.i(993796),C=e.i(689100);e.i(759130);var j=e.i(214007),T=e.i(483776),E={14:"nodejs-14",16:"nodejs-16",18:"nodejs-18",19:"nodejs-19",20:"nodejs-20"},R={bash:"bash",basic:"qbasic",nix:"nix",clojure:"clojure-1.11","c++":"cpp-clang14",c:"c-clang14","c#":"dotnet-7.0",dart:"dart-3.3",deno:"deno-1",elixir:"elixir-1_15","f#":"dotnet-7.0",go:"go-1.21",haskell:"haskell-ghc9.4",html:"web",css:"web",shell:"bash",java:"java-graalvm22.3",lua:"lua-5.2",nodejs:"nodejs-20",php:"php-8.2",python:{"3.8":"python-3.8","3.10":"python-3.10","3.11":"python-3.11","3.12":"python-3.12"},r:"r-4.3",rust:"rust-stable",ruby:"ruby-3.2",swift:"swift-5.8",typescript:E,javascript:E,vue:{18:"vue-node-18",20:"vue-node-20"}};function I(e,t){if(void 0===e)return!1;if(void 0===t)return!0;var n=(0,C.default)(e);if(null===n)return!1;var r=(0,C.default)(t);return null===r||(0,T.default)(n,r)}var A=e.i(394212),P=e.i(119468),D=e.i(825118),O=e.i(569910),N=e.i(240913),M=e.i(927158),L={preparingRepl:"Preparing workspace",gitInit:"Initializing git repository",gitRemoteAdd:"Connecting to remote",checkoutBranch:"Checking out branch",tidyingFiles:"Tidying up files",done:"Import complete"};function B(e){return!!e&&(void 0===e?"undefined":(0,P._)(e))==="object"&&"string"==typeof e.code&&"string"==typeof e.message}function V(e){switch(e.code){case D.GitErrors.UNEXPECTED_DISCONNECT:case D.GitErrors.CHANNEL_CLOSED:case D.GitErrors.TIMEOUT:return"Connection lost. Please try again.";case D.GitErrors.UNAUTHENTICATED:case D.GitErrors.UNKNOWN_REMOTE:return"Could not access repository. Please check your repository and try again.";case D.GitErrors.UNKNOWN_REF:case D.GitErrors.INVALID_REFERENCE:return"Branch not found. Please check your repository and try again.";case D.GitErrors.NO_COMMITS:return"Repository is empty. Please check your repository and try again.";case D.GitErrors.PROTECTED_BRANCH:return"Branch is protected. Please check your repository and try again.";case D.GitErrors.INDEX_LOCKED:case D.GitErrors.CONFIG_LOCKED:case D.GitErrors.INDEX_FILE_CORRUPT:case D.GitErrors.DIRTY_WORKTREE:case D.GitErrors.INVALID_STATE:throw Error("Repository is in an invalid state: ".concat(e.code," - ").concat(e.message));case D.GitErrors.NOT_INITIALIZED:case D.GitErrors.PATH_MATCHED_NO_FILES:case D.GitErrors.USER_NOT_CONFIGURED:case D.GitErrors.BRANCH_ALREADY_EXISTS:case D.GitErrors.MERGE_CONFLICT:case D.GitErrors.UPSTREAM_NOT_SET:case D.GitErrors.HEAD_DETACHED:case D.GitErrors.PUSH_REJECTED:case D.GitErrors.REMOTE_ALREADY_EXISTS:case D.GitErrors.ALREADY_INITIALIZED:case D.GitErrors.NOTE_SUCCESSFULLY_REMOVED:case D.GitErrors.OBJECT_HAS_NO_NOTE:case D.GitErrors.OBJECT_ALREADY_HAS_NOTE:case D.GitErrors.NOTE_SUCCESSFULLY_OVERWRITTEN:case D.GitErrors.PRE_COMMIT_HOOK_FAILED:throw Error("Unexpected git error during import: ".concat(e.code," - ").concat(e.message));case D.GitErrors.UNKNOWN:case D.GitErrors.UNKNOWN_NOT_GIT:throw Error(e.message||"Unknown error occurred: ".concat(e.code));default:(0,O.default)(e.code)}}var F=e.i(468095),U=e.i(878420),G=e.i(569384),$=e.i(973245);e.i(304277);var z=e.i(566901);function H(){var e=(0,G._)(["\n  query WorkspacePatchDotReplitRepl($replId: String!) {\n    getRepl(id: $replId) {\n      ... on Repl {\n        id\n        rootOriginReplUrl\n      }\n    }\n  }\n"]);return H=function(){return e},e}var W={},q=(0,$.gql)(H()),K=function(e,t){return{op:"add",path:e,value:JSON.stringify(t)}},Y=new Map([["hintsList","hints"]]);function Q(e){var T,E,D,O,G,$,H,Q,X,J,Z,ee,et,en,er,ei,eo,ea,es,el=e.setConfigScreenLockIsOpen,eu=e.openPane,ec=e.onStatusChange,ed=(0,i.useRouter)(),ef=(0,h.default)(),ep=(0,n._)((0,l.useWorkspaceDoGitHubImportFlowFinishCloneMutation)(),2),eh=ep[0],eg=ep[1],em=(0,n._)((0,o.useState)(null),2),ev=em[0],ex=em[1],ey=(0,w.default)(),eb=ey.fs,ew=ey.dotReplit,ek=(0,p.default)().showError,e_=(E=(T=(0,w.default)()).dotReplit,D=T.nixService,O=(0,h.default)(),$=(0,n._)((G=(0,U._)({},W,void 0),z.useLazyQuery(q,G)),1)[0],Q=(H=(0,p.default)()).showWarning,X=H.showError,(0,o.useCallback)(function(e){return(0,t._)(function(){var i,o,a,s,l,u,c,d,f,p,h,m;return(0,r._)(this,function(x){switch(x.label){case 0:return[4,E.getConfig()];case 1:if(!(o=x.sent().config)||(null==(i=o.modules)?void 0:i.length))return[2];return[4,$({variables:{replId:O}})];case 2:if(!(null==(s=(null==(a=x.sent().data)?void 0:a.getRepl.__typename)==="Repl"?a.getRepl:null)?void 0:s.rootOriginReplUrl))return[2];try{l=(0,j.parse)(e.toString())}catch(e){return X("Failed to parse template .replit file"),g.logger.error("GitHub Import: Failed to parse template .replit file"),[2]}if(!l)return[2];return[4,function(e){return(0,t._)(function(e){var i,o,a,s,l,u,c,d,f,p,h,g,m,x,y;function b(){return(0,t._)(function(){var e,t,n;return(0,r._)(this,function(r){switch(r.label){case 0:if(!(e="object"===(0,P._)(a.env)?a.env:null)||0===Object.keys(e).length)return[2];return n=(t="object"===(0,P._)(s.env)?s.env:null)?(0,U._)({},e,t):e,[4,i.updateDotReplit([K("env",n)])];case 1:return r.sent(),[2]}})})()}function w(){return(0,t._)(function(){var e,t,n,l;return(0,r._)(this,function(r){switch(r.label){case 0:if(null==(e=s.nix)?void 0:e.channel)return[2];if(null==a||null==(t=a.nix)?void 0:t.channel)return[3,2];return[4,o.getLatestStableChannel()];case 1:if(!(l=r.sent()).channel)return[2];return n=l.channel,[3,3];case 2:n=a.nix.channel,r.label=3;case 3:return[4,i.updateDotReplit([K("nix/channel",n)])];case 4:return r.sent(),[2]}})})()}return(0,r._)(this,function(k){switch(k.label){case 0:i=e.dotReplit,o=e.nixService,a=e.templateConfig,s=e.config,l=[],u={entrypoint:"entrypoint config",hidden:"hidden files config",audio:"audio config",run:"run command",refreshWebViewOnFileChange:"webview refresh config",language:"language config",onBoot:"onBoot command",languages:"languages config",compile:"compile command",debugger:"debugger config",packager:"packager config",interpreter:"interpreter config",unitTest:"unit test config",nix:w,env:b,hosting:"hosting config",gitHubImport:"GitHub import config",auth:"Repl Auth config",hintsList:"Hints config",ports:"Ports config",deployment:"deployment config",orderedEnv:null,modules:"nix modules config",extension:"extension config",rules:"rules config",suggestions:"suggestions config",objectStorage:"object storage config",autoSave:"autosave config"},c=[],d=!0,f=!1,p=void 0;try{for(h=Object.entries(u)[Symbol.iterator]();!(d=(g=h.next()).done);d=!0)x=(m=(0,n._)(g.value,2))[0],y=m[1],null!==y&&("function"==typeof y?c.push(y()):c.push(function(e){return(0,t._)(function(){var t,n,o,l,u;return(0,r._)(this,function(r){switch(r.label){case 0:if(n=!!(t=s[e]),Array.isArray(t)?n=t.length>0:t&&(void 0===t?"undefined":(0,P._)(t))==="object"&&(n=Object.keys(t).length>0),l=null!=(o=Y.get(e))?o:e,n||!a[l])return[2];return u=K(l,a[l]),[4,i.updateDotReplit([u])];case 1:return r.sent(),[2]}})})()}(x)))}catch(e){f=!0,p=e}finally{try{d||null==h.return||h.return()}finally{if(f)throw p}}return[4,Promise.all(c)];case 1:return k.sent(),[2,l]}})}).apply(this,arguments)}({nixService:D,dotReplit:E,config:o,templateConfig:l})];case 3:u=x.sent(),c=!0,d=!1,f=void 0;try{for(p=u[Symbol.iterator]();!(c=(h=p.next()).done);c=!0)m=h.value,Q(m,1e3)}catch(e){d=!0,f=e}finally{try{c||null==p.return||p.return()}finally{if(d)throw f}}return[2]}})})()},[O,Q,X,E,D,$])),eS=(J=(0,m.useQueryParam)("importBranch","string"))?decodeURIComponent(J):null,eC=(0,b.default)(),ej=(0,f.useCurrentUserStoredOrgContext)().orgId,eT=(0,_.useAgentSettings)().settings;(0,o.useEffect)(function(){eg.error&&ek("Failed to finish importing from GitHub - "+eg.error)},[eg.error,ek]),(0,o.useEffect)(function(){ev&&ek("Failed to finish importing from GitHub - "+ev)},[ev,ek]);var eE=(0,l.useWorkspaceDoGitHubImportFlowQuery)({variables:{replId:ef}}).data,eR=(Z=(0,b.default)(),et=(ee=(0,w.default)()).fs,en=ee.dotReplit,er=(0,S.useFlag)({controlName:"flag-agent-everywhere"}),ei=(null==eE?void 0:eE.getRepl.__typename)==="Repl"?eE.getRepl.config.gitRemoteUrl:void 0,ea=(null==(eo=(0,l.useGitHubImportGetTopLanguagesQuery)({skip:!(ei&&Z),variables:ei?{input:{githubRepoUrl:ei}}:void 0}).data)?void 0:eo.githubRepoInfo.__typename)==="GitHubRepoInfoOutput"?eo.githubRepoInfo.topLanguages:void 0,es=(null==eo?void 0:eo.githubRepoInfo.__typename)==="GitHubRepoInfoOutput"?eo.githubRepoInfo.repositorySource:void 0,{addRecommendedModules:(0,o.useCallback)(function(){return(0,t._)(function(){var e,t,i,o,a,l;return(0,r._)(this,function(r){switch(r.label){case 0:if(!(ea&&Z))return[3,4];return e=ea.map(function(e){return{language:e}}),[4,et.readFile("package.json")];case 1:return"content"in(t=r.sent())&&(i=function(e){var t,n,r=null;try{n=JSON.parse(e)}catch(e){return null}if(null==(t=n.engines)?void 0:t.node){var i=(0,C.default)(n.engines.node);i&&(r="".concat(i.major))}return r}(t.content.toString()))&&(e.push({language:"javascript",version:i}),ea.includes("Vue")&&e.push({language:"vue",version:i})),[4,et.readFile("pyproject.toml")];case 2:return"content"in(t=r.sent())&&(o=function(e){var t,n,r,i,o,a=null;try{o=(0,j.parse)(e)}catch(e){return null}var s=(null==(r=o.tool)||null==(n=r.poetry)||null==(t=n.dependencies)?void 0:t.python)||(null==(i=o.project)?void 0:i["requires-python"]);if(s){var l=(0,C.default)(s);l&&(a="".concat(l.major,".").concat(l.minor))}return a}(t.content.toString()))&&e.push({language:"python",version:o}),a=function(e,t){var r=new Map,i=!0,o=!1,a=void 0;try{for(var s,l,u=e[Symbol.iterator]();!(i=(l=u.next()).done);i=!0){var c=l.value,d=R[c.language.toLowerCase()];if(d){var f=r.get(d);(!f||I(c.version,f.version))&&r.set(d,c)}}}catch(e){o=!0,a=e}finally{try{i||null==u.return||u.return()}finally{if(o)throw a}}var p=new Map;null==(s=t.fullModules)||s.forEach(function(e){(null==e?void 0:e.id)&&p.set(e.id,e)});var h=new Set,g=!0,m=!1,x=void 0;try{for(var y,b=r.entries()[Symbol.iterator]();!(g=(y=b.next()).done);g=!0){var w=(0,n._)(y.value,2),k=w[0],_=w[1];if("string"==typeof k){var S=p.get(k);S&&h.add(S)}else{var C=_.version;if(!C||!k[C]){var j=Object.keys(k);j.sort(function(e,t){return I(e,t)?-1:1}),C=j[0]}var T=k[C],E=p.get(T);E&&h.add(E)}}}catch(e){m=!0,x=e}finally{try{g||null==b.return||b.return()}finally{if(m)throw x}}return Array.from(h)}(e,Z),l=[{op:"add",path:"nix/channel",value:'"stable-25_05"'}],a.length>0?(g.logger.info("GitHub Import: recommended modules:",Object.fromEntries(a.map(function(e){return[e.id,e.name]}))),l.push({op:"add",path:"modules",value:JSON.stringify(a.map(function(e){return e.id}))})):g.logger.warn("GitHub Import: no recommended modules found"),es===s.RepositorySource.Github&&er&&l.push({op:"add",path:"agent/expertMode",value:"true"}),[4,en.updateDotReplit(l)];case 3:r.sent(),r.label=4;case 4:return[2]}})})()},[en,et,Z,ea,es,er]),topLanguages:ea,repositorySource:es}),eI=eR.addRecommendedModules,eA=eR.topLanguages,eP=eR.repositorySource,eD=(0,F.useSendAgentMessage)({openPane:eu}),eO=function(e){ex(e),null==ec||ec({status:"error",errorMessage:e}),el(!1)},eN=(0,n._)((0,o.useState)(!1),2),eM=eN[0],eL=eN[1];function eB(){return eb.readFile(c.dotReplitPath)}(0,o.useEffect)(function(){eC&&eE&&"Repl"===eE.getRepl.__typename&&eA&&eL(!0)},[eE,eC,eM,eA]),(0,o.useEffect)(function(){eM&&(0,t._)(function(){var e,t,n,i,o,s,l,u;return(0,r._)(this,function(r){switch(r.label){case 0:if(!eE||"Repl"!==eE.getRepl.__typename||(t=eE.getRepl,n=eE.currentUser,"Repl"!==t.__typename||!n||"CurrentUser"!==n.__typename)||(o=null!=(i=null==(e=n.gitHubInfo)?void 0:e.accessToken)?i:null,!(s=t.config.gitRemoteUrl)||!t.config.doClone||!eA))return[2];r.label=1;case 1:return r.trys.push([1,3,4,5]),el(!0),null==ec||ec({status:"in_progress",text:"Importing"}),[4,eF({remote:s})];case 2:if(!(l=r.sent())||!l.success)return eO((null==l?void 0:l.errorMessage)||"Unknown error occurred. Please check your repository and try again."),[2];return(0,x.track)(y.events.NIX_GH_IMPORT_USED,{action:d.NixGHImportUsedEvents.ImportEnded,replId:t.id,orgContext:(0,f.getOrgTrackingContext)(ej?{id:ej}:void 0),repositorySource:eP}),null==ec||ec({status:"success"}),[3,5];case 3:return u=r.sent(),g.logger.error("GitHub Import: Failed to do GitHub import flow",{originalError:String(u),query:JSON.stringify(ed.query),githubRepo:s,hasAccessToken:!!o}),a.captureException(u,{extra:{query:JSON.stringify(ed.query),githubRepo:s,hasAccessToken:!!o}}),eO(String(u)),[3,5];case 4:return el(!1),[7];case 5:return[2]}})})()},[eM]);var eV=(0,M.usePid2Callback)(function(e){return function(n){var i=n.remote,o=n.checkoutBranch,a=n.onProgress;return(0,t._)(function(){var t,n,s,l,u,c,d,f,p,h,m,x,y,b;return(0,r._)(this,function(r){switch(r.label){case 0:return g.logger.info("Starting PID2 GitHub import flow"),[4,e.git.importFromGitRemote.rpc({cwd:N.ROOT_PATH,remoteUrl:i,checkoutBranch:null!=o?o:void 0})];case 1:if(!(t=r.sent()).ok){if(!B(n=t.payload))throw Error("Unexpected error initializing import: ".concat(n.code," - ").concat(n.message));return[2,{success:!1,errorMessage:V(n)}]}s=e.git.importFromGitRemoteStatus.subscribe({}).resReadable,l=!1,u=!1,c=!1,r.label=2;case 2:r.trys.push([2,7,8,13]),f=(0,A._)(s),r.label=3;case 3:return[4,f.next()];case 4:if(!(u=!(p=r.sent()).done))return[3,6];if(!(h=p.value).ok){if(g.logger.error("PID2 import error",{pid2ImportError:h.payload}),!B(m=h.payload))throw Error(m.message);return[2,{success:!1,errorMessage:V(m)}]}if(y=function(e){var t=L[e];if(void 0===t)throw Error("Unknown import state: ".concat(e));return t}(x=h.payload.state),null==a||a(y),"done"===x)return g.logger.info("Received done state, completing"),l=!0,[3,6];r.label=5;case 5:return u=!1,[3,3];case 6:return[3,13];case 7:return b=r.sent(),c=!0,d=b,[3,13];case 8:if(r.trys.push([8,,11,12]),!(u&&null!=f.return))return[3,10];return[4,f.return()];case 9:r.sent(),r.label=10;case 10:return[3,12];case 11:if(c)throw d;return[7];case 12:return[7];case 13:if(!l)return[2,{success:!1,errorMessage:"Connection lost. Please try again."}];return g.logger.info("PID2 import completed successfully"),[2,{success:!0}]}})})()}}),eF=function(e){var n=e.remote;return(0,t._)(function(){var e,t,i,o;return(0,r._)(this,function(r){switch(r.label){case 0:if(!eC||!(eE&&"Repl"===eE.getRepl.__typename))return[2];return g.logger.info("GitHub Import: Starting client-side GitHub import flow"),[4,eB()];case 1:if(e=r.sent(),!eV)return[2,{success:!1,errorMessage:"GitHub import flow not available"}];return[4,eV({remote:n,checkoutBranch:eS,onProgress:function(e){null==ec||ec({status:"in_progress",text:e})}})];case 2:if(!(t=r.sent()).success)return[2,t];if(g.logger.info("GitHub Import: Cloned repo into Repl"),"NOT_FOUND"!==e.error)return[3,5];return[4,ew.updateDotReplit([])];case 3:return r.sent(),[4,eB()];case 4:e=r.sent(),r.label=5;case 5:if("content"in e)return[3,6];return g.logger.error("GitHub Import: Skipping patching dotReplit because templateDotReplit was an error",{readError:String(e.error)}),[3,11];case 6:return[4,eB()];case 7:return i=r.sent(),o=""!==e.content.toString()&&"content"in i&&i.content.toString()!==e.content.toString(),[4,e_(e.content)];case 8:if(r.sent(),g.logger.info("GitHub Import: Patched dotreplit"),!o)return[3,9];return g.logger.info("GitHub Import: Repo has .replit",{githubURL:n}),[3,11];case 9:return[4,eI()];case 10:r.sent(),g.logger.info("GitHub Import: Added recommended modules"),r.label=11;case 11:return[4,eh({variables:{input:{id:ef,doClone:!1}}})];case 12:if(r.sent(),g.logger.info("GitHub Import: Disabled doClone on Repl."),!eS)return[3,14];return[4,eb.persist()];case 13:r.sent(),(0,m.updatePathWithQueryParams)({router:ed,params:[{mode:"delete",key:"importBranch"}]}),r.label=14;case 14:return g.logger.info("GitHub Import: Repository source is agent supported source",{repositorySource:eP}),[4,eD({kind:"setupImportedProject",importSource:function(e){if(!e)return u.ProjectImportSource.PROJECT_IMPORT_SOURCE_UNKNOWN;switch(e){case s.RepositorySource.Github:return u.ProjectImportSource.PROJECT_IMPORT_SOURCE_OTHER_GITHUB;case s.RepositorySource.Lovable:return u.ProjectImportSource.PROJECT_IMPORT_SOURCE_LOVABLE;case s.RepositorySource.Bolt:return u.ProjectImportSource.PROJECT_IMPORT_SOURCE_BOLT;case s.RepositorySource.Vercel:return u.ProjectImportSource.PROJECT_IMPORT_SOURCE_VERCEL;case s.RepositorySource.ReplitAgent:return u.ProjectImportSource.PROJECT_IMPORT_SOURCE_REPLIT;default:return u.ProjectImportSource.PROJECT_IMPORT_SOURCE_UNKNOWN}}(eP),agentConfig:(0,k.convertAgentSettingsFromGQLToAiChat)(eT)},{createNewSession:!0})];case 15:return r.sent(),[2,{success:!0}]}})})()}}e.s(["useDoGitHubImportFlow",()=>Q],850270);var X=e.i(541793),J=e.i(161322),Z=(0,X.atom)(!1);function ee(){return(0,J.useSetAtom)(Z)}function et(){return(0,J.useAtomValue)(Z)}e.s(["useGitHubImportMode",()=>et,"useSetGitHubImportMode",()=>ee],278505);var en=e.i(276385),er=e.i(545150),ei=e.i(446530),eo=e.i(613355),ea=e.i(660614),es=e.i(399144),el=e.i(960178),eu=e.i(625484),ec=(0,ei.cssRecord)({overlay:[eo.rcss.position.fixed,eo.rcss.flex.row,eo.rcss.align.center,eo.rcss.justify.center,eo.rcss.backgroundColor.backgroundOverlay,{top:0,bottom:0,left:0,right:0,zIndex:eo.DefaultModalZIndex+1,cursor:"not-allowed"}],animationWrapper:[eo.rcss.center,eo.rcss.minWidth(225),eo.rcss.height(225),eo.rcss.p(16),eo.rcss.color.foregroundDefault,eo.rcss.borderRadius(8),eo.rcss.backgroundColor.backgroundOverlay,eo.rcss.zIndex(eo.DefaultModalZIndex+1),{cursor:"not-allowed"}],lockText:eo.rcss.mt(32)});function ed(e){var t=e.reason;return(0,en.jsx)(es.Portal,{children:(0,en.jsx)(eu.View,{css:ec.overlay,children:(0,en.jsx)(er.default,{children:(0,en.jsxs)(eu.View,{css:ec.animationWrapper,tabIndex:-1,children:[(0,en.jsx)(ea.default,{height:80}),(0,en.jsx)(el.Text,{multiline:!1,variant:"subheadBig",css:ec.lockText,dataCy:"lock-screen",children:t})]})})})})}e.s(["default",()=>ed],119322)},659790,394492,e=>{"use strict";var t=e.i(297083),n=e.i(530658),r=e.i(817556),i=e.i(276385),o=e.i(389959),a=e.i(625251),s=e.i(878420),l=e.i(569384),u=e.i(973245);e.i(304277);var c=e.i(566901);function d(){var e=(0,l._)(["\n  query AiSessionDebugInfoCurrentUser($replId: String!) {\n    currentUser {\n      id\n      username\n    }\n    getRepl(id: $replId) {\n      ... on Repl {\n        id\n        url\n        inviteUrl\n      }\n    }\n  }\n"]);return d=function(){return e},e}var f={},p=(0,u.gql)(d());e.i(877212);var h=e.i(805763),g=e.i(58261),m=e.i(222342),x=e.i(207237);function y(e,n){return(0,t._)(function(){var t;return(0,r._)(this,function(r){switch(r.label){case 0:if(!window.navigator.clipboard)return b(n||e),[2];r.label=1;case 1:return r.trys.push([1,3,,4]),t=new ClipboardItem({"text/html":new Blob([e],{type:"text/html"}),"text/plain":new Blob([n||e],{type:"text/plain"})}),[4,window.navigator.clipboard.write([t])];case 2:return r.sent(),[3,4];case 3:return r.sent(),b(n||e),[3,4];case 4:return[2]}})})()}function b(e){var t=document.createElement("textarea");t.value=e,t.style.top="0",t.style.left="0",t.style.position="fixed",document.body.appendChild(t);try{t.focus(),t.select(),document.execCommand("copy")}finally{document.body.removeChild(t)}}function w(e){return e.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}e.s(["default",()=>y],394492);var k=e.i(480028),_=e.i(136540),S=e.i(601059),C=e.i(598160);function j(e){var n=e.sessionId,o=e.sessionType,s=(0,x.default)(),l=(0,m.default)().showConfirm,u=T();return(0,i.jsx)(S.PopupMenu,{trigger:(0,i.jsx)(_.IconButton,{alt:"[Staff] Debug tools",children:(0,i.jsx)(C.default,{color:k.tokens.foregroundDimmer})}),children:(0,i.jsxs)(a.MenuSection,{children:[(0,i.jsx)(S.MenuHeader,{text:"[Staff] Debug tools"}),(0,i.jsx)(S.MenuItem,{label:"Copy debug info",onAction:function(){return(0,t._)(function(){var e;return(0,r._)(this,function(t){switch(t.label){case 0:return[4,u(n,o)];case 1:return y((e=t.sent()).html,e.plainText),l("Copied debug info to clipboard"),[2]}})})()}}),(0,i.jsx)(S.MenuItem,{href:(0,h.generateAiSessionTraceforgeUrl)(n),label:"Go to TraceForge",target:"_blank",rel:"noreferrer noopener"}),(0,i.jsx)(S.MenuItem,{href:(0,h.generateAiSessionBraintrustUrl)(n),label:"Go to Braintrust",target:"_blank",rel:"noreferrer noopener"}),(0,i.jsx)(S.MenuItem,{href:(0,h.generateAiSessionTemporalUrl)(n),label:"Go to Temporal",target:"_blank",rel:"noreferrer noopener"}),(0,i.jsx)(S.MenuItem,{href:"https://us5.datadoghq.com/logs?query=%40replid%3A".concat(s),label:"Go to Datadog logs",target:"_blank"}),(0,i.jsx)(S.MenuItem,{href:(0,h.generateAiSessionDatadogTracesUrl)(s),label:"Go to Datadog traces",target:"_blank",rel:"noreferrer noopener"})]})})}function T(){var e,i,a=(0,x.default)(),l=(0,n._)((e={variables:{replId:a}},i=(0,s._)({},f,e),c.useLazyQuery(p,i)),1)[0],u=(0,g.useConnectorContext)().connections.map(function(e){return e.connectionId}).join(", ");return(0,o.useCallback)(function(e,n){return(0,t._)(function(){var t,n,i,o,s,c,d,f,p,g,m,x,y,b,k,_,S,C,j;return(0,r._)(this,function(r){switch(r.label){case 0:return[4,l()];case 1:if(f=null==(d=null==(c=r.sent())||null==(t=c.data)?void 0:t.currentUser)?void 0:d.id.toString(),p=null==d?void 0:d.username,!e||!d)return[2,{html:"",plainText:""}];return g=(0,h.generateAiSessionBraintrustUrl)(e),m=(0,h.generateAiSessionTraceforgeUrl)(e),x=(0,h.generateAiSessionTemporalUrl)(e),y=(0,h.generateAiSessionDatadogUrl)(a),b=window.location.href,_=(k=(null==c||null==(i=c.data)||null==(n=i.getRepl)?void 0:n.__typename)==="Repl"&&(null==c||null==(s=c.data)||null==(o=s.getRepl)?void 0:o.inviteUrl))?new URL(k,window.location.origin).href:null,j="\n User ID: ".concat(null!=(S=null==d?void 0:d.id)?S:"N/A","\n Username: ").concat(null!=(C=null==d?void 0:d.username)?C:"N/A","\n Repl URL: ").concat(null!=b?b:"N/A","\n Join URL: ").concat(null!=_?_:"N/A","\n Repl ID: ").concat(null!=a?a:"N/A","\n Session ID: ").concat(null!=e?e:"N/A","\n Connection IDs: ").concat(u||"N/A","\n TraceForge URL: ").concat(m,"\n Braintrust URL: ").concat(null!=g?g:"N/A","\n Temporal URL: ").concat(null!=x?x:"N/A","\n Datadog URL: ").concat(null!=y?y:"N/A","\n    ").trim(),[2,{html:"\n<ul>\n  <li>User ID: ".concat(f?w(f):"N/A","</li>\n  <li>Username: ").concat(p?w(p):"N/A","</li>\n  <li>Repl URL: ").concat(b?w(b):"N/A","</li>\n  <li>Join URL: ").concat(_?w(_):"N/A","</li>\n  <li>Repl ID: ").concat(a?w(a):"N/A","</li>\n  <li>Session ID: ").concat(e?w(e):"N/A","</li>\n  <li>Connection IDs: ").concat(u?w(u):"N/A",'</li>\n  <li><a href="').concat(m,'" target="_blank">TraceForge</a></li>\n  <li>').concat(g?'<a href="'.concat(g,'" target="_blank">Braintrust</a>'):"Braintrust: N/A","</li>\n  <li>").concat(x?'<a href="'.concat(x,'" target="_blank">Temporal</a>'):"Temporal: N/A",'</li>\n  <li><a href="').concat(y,'" target="_blank">Datadog</a></li>\n</ul>\n    ').trim(),plainText:j}]}})})()},[u,l,a])}e.s(["AiSessionDebugInfoButton",()=>j,"useGenerateDebugInfo",()=>T],659790)},737362,151902,549194,288645,e=>{"use strict";var t=e.i(878420),n=e.i(569384),r=e.i(973245),i=e.i(304277),o=e.i(566901),a=e.i(951262);function s(){var e=(0,n._)(["\n  fragment ForkContextRepl on Repl {\n    id\n    title\n    description\n    org {\n      id\n    }\n  }\n"]);return s=function(){return e},e}var l=(0,r.gql)(s()),u=e.i(23293);function c(){var e=(0,n._)(["\n  fragment TransferReplReplInfo on Repl {\n    id\n    slug\n    title\n    owner {\n      ... on Team {\n        id\n        username\n      }\n      ... on User {\n        id\n        username\n      }\n    }\n    org {\n      id\n      slug\n    }\n  }\n"]);return c=function(){return e},e}function d(){var e=(0,n._)(["\n  query TransferReplDialog {\n    currentUser {\n      id\n      ...ReplOwnerCurrentUser\n    }\n  }\n  ","\n"]);return d=function(){return e},e}var f={},p=(0,r.gql)(c()),h=(0,r.gql)(d(),u.ReplOwnerCurrentUserFragmentDoc);function g(e){var n=(0,t._)({},f,e);return i.useQuery(h,n)}e.s(["TransferReplReplInfoFragmentDoc",()=>p,"useTransferReplDialogQuery",()=>g],151902);var m=e.i(429190),x=e.i(490048),y=e.i(987860);function b(){var e=(0,n._)(["\n  fragment PublishReleaseFormRepl on Repl {\n    id\n    title\n    description\n    slug\n    user {\n      username\n    }\n    ...PublishedReplShareInfoReplData\n    deployment {\n      id\n      activeRelease {\n        id\n      }\n    }\n    releases {\n      items {\n        id\n        timeCreated\n        description\n        initialLayoutState\n      }\n    }\n  }\n  ","\n"]);return b=function(){return e},e}function w(){var e=(0,n._)(["\n  query PublishReleaseFormCurrentUser {\n    currentUser {\n      id\n      username\n    }\n  }\n"]);return w=function(){return e},e}var k={},_=(0,r.gql)(b(),y.PublishedReplShareInfoReplDataFragmentDoc),S=(0,r.gql)(w());function C(e){var n=(0,t._)({},k,e);return i.useQuery(S,n)}e.s(["PublishReleaseFormReplFragmentDoc",()=>_,"usePublishReleaseFormCurrentUserQuery",()=>C],549194);var j=e.i(781621);function T(){var e=(0,n._)(["\n  fragment CreateProjectBeforeForkReplContext on Repl {\n    id\n    title\n    description\n    publishedAs\n    user {\n      id\n      username\n    }\n    deployment {\n      activeRelease {\n        id\n      }\n    }\n    org {\n      id\n    }\n  }\n"]);return T=function(){return e},e}function E(){var e=(0,n._)(["\n  mutation CreateProjectBeforeFork($input: CreateProjectInput!) {\n    createProject(input: $input) {\n      __typename\n      ... on Error {\n        message\n      }\n      ... on Project {\n        id\n        mainRepl {\n          id\n          project {\n            id\n          }\n        }\n      }\n    }\n  }\n"]);return E=function(){return e},e}function R(){var e=(0,n._)(["\n  query CreateProjectCheckForProject($id: String!) {\n    getRepl(id: $id) {\n      ... on Repl {\n        id\n        project {\n          id\n        }\n      }\n    }\n  }\n"]);return R=function(){return e},e}var I={},A=(0,r.gql)(T()),P=(0,r.gql)(E());function D(e){var n=(0,t._)({},I,e);return a.useMutation(P,n)}var O=(0,r.gql)(R());function N(e){var n=(0,t._)({},I,e);return o.useLazyQuery(O,n)}e.s(["CreateProjectBeforeForkReplContextFragmentDoc",()=>A,"useCreateProjectBeforeForkMutation",()=>D,"useCreateProjectCheckForProjectLazyQuery",()=>N],288645);var M=e.i(279042);function L(){var e=(0,n._)(["\n  fragment ReplInfoDropdownItemsRepl on Repl {\n    id\n    isFeaturedRepl\n    isRenamed\n    isPrivate\n    publishedAs\n    org {\n      id\n      type\n    }\n    authorizations {\n      publish {\n        isAuthorized\n        message\n      }\n      fork {\n        isAuthorized\n        message\n      }\n      deleteRepl {\n        isAuthorized\n        message\n      }\n    }\n  }\n"]);return L=function(){return e},e}var B=(0,r.gql)(L()),V=e.i(239612);function F(){var e=(0,n._)(["\n  fragment HandleRemixRepl on Repl {\n    id\n    org {\n      id\n    }\n    ...CreateProjectForkRepl\n  }\n  ","\n"]);return F=function(){return e},e}var U=(0,r.gql)(F(),V.CreateProjectForkReplFragmentDoc),G=e.i(987143);function $(){var e=(0,n._)(["\n  fragment UserButtonRepl on Repl {\n    id\n    org {\n      id\n      name\n      slug\n      image\n    }\n    user {\n      username\n      image\n      ...UserLinkUser\n    }\n  }\n  ","\n"]);return $=function(){return e},e}var z=(0,r.gql)($(),G.UserLinkUserFragmentDoc);function H(){var e=(0,n._)(["\n  fragment ReplInfoHeaderRepl on Repl {\n    id\n    isPrivate\n    org {\n      id\n      type\n    }\n    config {\n      grabbyExtensionVersion\n    }\n    ...HandleRemixRepl\n    ...UserButtonRepl\n    ...ReplLinkRepl\n    ...CreateProjectBeforeForkReplContext\n    ...ReplInfoDropdownItemsRepl\n  }\n  ","\n  ","\n  ","\n  ","\n  ","\n"]);return H=function(){return e},e}var W=(0,r.gql)(H(),U,z,M.ReplLinkReplFragmentDoc,A,B);function q(){var e=(0,n._)(["\n  fragment WorkspaceHeaderReplInfoRepl on Repl {\n    id\n    title\n    rawTemplateLabel: templateLabel(disableFallbackToTitle: true)\n    description\n    isPrivate\n    isRenamed\n    url\n    imageUrl\n    workspaceCta\n    publishedAs\n    timeUpdated\n    isFeaturedRepl\n    owner {\n      ... on Team {\n        id\n      }\n      ... on User {\n        id\n      }\n    }\n    templateInfo {\n      iconUrl\n      imageUrl\n    }\n    config {\n      isAgentRepl\n    }\n    authorizations {\n      editMetadata {\n        isAuthorized\n        message\n      }\n      editTemplateMetadata {\n        isAuthorized\n      }\n      editVisibility {\n        isAuthorized\n        code\n        message\n      }\n    }\n    ...ForkContextRepl\n    ...PublishReleaseFormRepl\n    ...BulkDeleteConfirmationModalRepl\n    ...CreateProjectBeforeForkReplContext\n    ...TransferReplReplInfo\n    ...ReplInfoHeaderRepl\n    ...FeaturedReplPreviewRepl\n    org {\n      id\n      slug\n      name\n      type\n      image\n    }\n  }\n  ","\n  ","\n  ","\n  ","\n  ","\n  ","\n  ","\n"]);return q=function(){return e},e}function K(){var e=(0,n._)(["\n  query WorkspaceHeaderReplInfo($replId: String!) {\n    getRepl(id: $replId) {\n      ... on Repl {\n        id\n        ...WorkspaceHeaderReplInfoRepl\n      }\n    }\n  }\n  ","\n"]);return K=function(){return e},e}function Y(){var e=(0,n._)(["\n  mutation WorkspaceHeaderReplInfoUnpublishTemplate(\n    $input: DeleteReplDeploymentInput!\n  ) {\n    deleteReplDeployment(input: $input) {\n      ... on Repl {\n        id\n        ...PublishReplData\n      }\n    }\n  }\n  ","\n"]);return Y=function(){return e},e}function Q(){var e=(0,n._)(["\n  mutation WorkspaceHeaderReplInfoUpdateRepl($input: UpdateReplInput!) {\n    updateRepl(input: $input) {\n      repl {\n        id\n        ...WorkspaceHeaderReplInfoRepl\n      }\n    }\n  }\n  ","\n"]);return Q=function(){return e},e}function X(){var e=(0,n._)(["\n  mutation WorkspaceHeaderReplInfoDeleteRepl($id: String!) {\n    deleteRepl(id: $id) {\n      id\n    }\n  }\n"]);return X=function(){return e},e}var J={},Z=(0,r.gql)(q(),l,_,j.BulkDeleteConfirmationModalReplFragmentDoc,A,p,W,m.FeaturedReplPreviewReplFragmentDoc),ee=(0,r.gql)(K(),Z);function et(e){var n=(0,t._)({},J,e);return i.useQuery(ee,n)}var en=(0,r.gql)(Y(),x.PublishReplDataFragmentDoc);function er(e){var n=(0,t._)({},J,e);return a.useMutation(en,n)}var ei=(0,r.gql)(Q(),Z);function eo(e){var n=(0,t._)({},J,e);return a.useMutation(ei,n)}var ea=(0,r.gql)(X());function es(e){var n=(0,t._)({},J,e);return a.useMutation(ea,n)}e.s(["useWorkspaceHeaderReplInfoDeleteReplMutation",()=>es,"useWorkspaceHeaderReplInfoQuery",()=>et,"useWorkspaceHeaderReplInfoUnpublishTemplateMutation",()=>er,"useWorkspaceHeaderReplInfoUpdateReplMutation",()=>eo],737362)},382614,992193,590985,269818,701366,236465,886533,295276,2835,814991,522155,e=>{"use strict";var t,n,r=e.i(276385),i=e.i(480028),o=e.i(754873),a=e.i(613355),s=e.i(960178),l=e.i(625484),u=e.i(616278),c=l.SpecializedView.button,d=function(){return(0,r.jsx)(l.View,{css:[{borderTop:"1px solid ".concat(i.tokens.outlineDimmest)}],grow:!0,row:!0})},f=function(e){var t=e.isActive,n=e.isComplete,l=e.children,d=e.onClick,f=e.disabled;return(0,r.jsxs)(c,{type:"button",css:[a.rcss.reset.button,a.rcss.position.relative,o.interactive.nofill,t&&a.rcss.backgroundColor.backgroundHigher,a.rcss.p(4),a.rcss.borderRadius(4)],onClick:d,disabled:f,children:[(0,r.jsx)(s.Text,{variant:"small",multiline:!1,children:l}),n?(0,r.jsx)(u.default,{size:6,strokeWidth:6,color:i.tokens.foregroundDimmer,css:[a.rcss.position.absolute,{top:2,right:-2}]}):null]})};e.s(["FormHeadingButton",()=>f,"FormHeadingSpacer",()=>d],382614);var p=e.i(297083),h=e.i(399119),g=e.i(904851),m=e.i(445789),x=e.i(463348),y=e.i(817556),b=e.i(389959),w=e.i(368964),k=e.i(878420),_=e.i(569384),S=e.i(973245),C=e.i(304277);e.i(566901);var j=e.i(490048);function T(){var e=(0,_._)(["\n  query ReplPublishInputRepl($id: String!) {\n    getRepl(id: $id) {\n      ... on Repl {\n        id\n        ...PublishReplData\n      }\n    }\n  }\n  ","\n"]);return T=function(){return e},e}var E={},R=(0,S.gql)(T(),j.PublishReplDataFragmentDoc),I=e.i(322823),A=e.i(98816),P=e.i(858248),D=e.i(709485),O=e.i(530658),N=e.i(951262),M=e.i(549194);function L(){var e=(0,_._)(["\n  mutation CreateTemplateReleaseCreateDeployment(\n    $input: CreateReplDeployemntInput!\n  ) {\n    createReplDeployment(input: $input) {\n      ... on Repl {\n        id\n        ...PublishReplData\n        ...PublishReleaseFormRepl\n      }\n      ... on UserError {\n        message\n      }\n      ... on NotFoundError {\n        message\n      }\n      ... on UnauthorizedError {\n        message\n      }\n    }\n  }\n  ","\n  ","\n"]);return L=function(){return e},e}function B(){var e=(0,_._)(["\n  mutation CreateTemplateReleaseCreateRelease($input: CreateReplReleaseInput!) {\n    createReplRelease(input: $input) {\n      ... on Repl {\n        id\n        ...PublishReplData\n        ...PublishReleaseFormRepl\n      }\n      ... on UserError {\n        message\n      }\n      ... on NotFoundError {\n        message\n      }\n      ... on UnauthorizedError {\n        message\n      }\n    }\n  }\n  ","\n  ","\n"]);return B=function(){return e},e}var V={},F=(0,S.gql)(L(),j.PublishReplDataFragmentDoc,M.PublishReleaseFormReplFragmentDoc),U=(0,S.gql)(B(),j.PublishReplDataFragmentDoc,M.PublishReleaseFormReplFragmentDoc),G="Something went wrong publishing your Template";function $(e){if(e.error)return e.error.message||G;if(e.data){if("createReplDeployment"in e.data){if("NotFoundError"===e.data.createReplDeployment.__typename||"UnauthorizedError"===e.data.createReplDeployment.__typename||"UserError"===e.data.createReplDeployment.__typename)return e.data.createReplDeployment.message;else if("Repl"!==e.data.createReplDeployment.__typename)return G}if("createReplRelease"in e.data){if("NotFoundError"===e.data.createReplRelease.__typename||"UnauthorizedError"===e.data.createReplRelease.__typename||"UserError"===e.data.createReplRelease.__typename)return e.data.createReplRelease.message;else if("Repl"!==e.data.createReplRelease.__typename)return G}}}function z(){var e,t,n=(0,O._)((e=(0,k._)({},V,void 0),N.useMutation(F,e)),2),r=n[0],i=n[1],o=(0,O._)((t=(0,k._)({},V,void 0),N.useMutation(U,t)),2),a=o[0],s=o[1];return{createRelease:function(e){var t=e.input;return(0,p._)(function(){var e;return(0,y._)(this,function(n){switch(n.label){case 0:if(i.loading||s.loading)return[2,{data:null,error:null}];n.label=1;case 1:return n.trys.push([1,3,,4]),[4,a({refetchQueries:["ReplEnvironmentHeader"],variables:{input:t}})];case 2:return[2,{data:(e=n.sent()).data,error:$(e)}];case 3:return n.sent(),[2,{data:null,error:G}];case 4:return[2]}})})()},createDeployment:function(e){var t=e.input;return(0,p._)(function(){var e;return(0,y._)(this,function(n){switch(n.label){case 0:if(i.loading||s.loading)return[2,{data:null,error:null}];n.label=1;case 1:return n.trys.push([1,3,,4]),[4,r({variables:{input:t}})];case 2:return[2,{data:(e=n.sent()).data,error:$(e)}];case 3:return n.sent(),[2,{data:null,error:G}];case 4:return[2]}})})()},data:i.data||s.data,loading:i.loading||s.loading,error:$(i||s)}}function H(){var e=(0,_._)(["\n  mutation SetReplViewSettingsSetSettings($input: SetReplViewSettingsInput!) {\n    setReplViewSettings(input: $input) {\n      ... on ReplViewSettings {\n        id\n        repl {\n          id\n          ...PublishReplData\n        }\n      }\n      ... on UserError {\n        message\n      }\n      ... on NotFoundError {\n        message\n      }\n      ... on UnauthorizedError {\n        message\n      }\n    }\n  }\n  ","\n"]);return H=function(){return e},e}e.s(["useCreateTemplateRelease",()=>z],992193);var W={},q=(0,S.gql)(H(),j.PublishReplDataFragmentDoc);function K(e){var t,n,r,i,o,a,s;return e.error?e.error.message||"Something went wrong saving your Cover page":(null==(n=e.data)||null==(t=n.setReplViewSettings)?void 0:t.__typename)==="NotFoundError"||(null==(i=e.data)||null==(r=i.setReplViewSettings)?void 0:r.__typename)==="UnauthorizedError"||(null==(a=e.data)||null==(o=a.setReplViewSettings)?void 0:o.__typename)==="UserError"?e.data.setReplViewSettings.message:(null==(s=e.data)?void 0:s.setReplViewSettings)&&"ReplViewSettings"!==e.data.setReplViewSettings.__typename?"Something went wrong saving your Cover page":void 0}function Y(){var e=(0,_._)(["\n  mutation UpdateReplUpdate($input: UpdateReplInput!) {\n    updateRepl(input: $input) {\n      repl {\n        id\n        ...PublishReplData\n      }\n    }\n  }\n  ","\n"]);return Y=function(){return e},e}var Q={},X=(0,S.gql)(Y(),j.PublishReplDataFragmentDoc);function J(e){return e.message||"Something went wrong saving updates to your App"}var Z=((t={})[t.Default=0]="Default",t[t.Saved=1]="Saved",t[t.Current=2]="Current",t);e.s(["TemplateLayoutKind",()=>Z],590985);var ee=e.i(64386),et=e.i(422025);function en(e){var t=(0,O._)((0,b.useState)(null),2),n=t[0],r=t[1],i=(0,O._)((0,b.useState)(null),2),o=i[0],a=i[1],s=(0,et.default)({onUpload:function(t){var n=t.url;r(null),e(n)},onUploadPreview:function(e){var t=e.dataUrl;a(null),r(t)},onError:function(e){r(null),a(e.message)}}),l=(0,b.useCallback)(function(){return a(null)},[]);return(0,ee._)((0,k._)({},s),{error:o,clearError:l,previewUrl:n})}var er=((n={}).ReplFile="repl_file",n.ReplImage="repl_image",n);function ei(e){return"repl_file"===e||"repl_image"===e}var eo=function(e){function t(){return(0,g._)(this,t),(0,h._)(this,t,arguments)}return(0,m._)(t,e),t}((0,x._)(Error)),ea=function(e){function t(){return(0,g._)(this,t),(0,h._)(this,t,arguments)}return(0,m._)(t,e),t}((0,x._)(Error)),es=function(e){function t(){return(0,g._)(this,t),(0,h._)(this,t,arguments)}return(0,m._)(t,e),t}((0,x._)(Error));function el(e){return e?e.length>60?{message:"Title should not be more than ".concat(60," characters")}:void 0:{message:"Give your App a title"}}function eu(e){return e?e.length>1e3?{message:"Description should not be more than ".concat(1e3," characters")}:void 0:{message:"What does this App do?"}}function ec(e){var t,n,r,i,o,a,s,l,u,c,d,f,h,g,m,x,_=(u={variables:{id:e.replId}},c=(0,k._)({},E,u),C.useQuery(R,c)),S=(null==(d=_.data)?void 0:d.getRepl.__typename)==="Repl"?_.data.getRepl:null,j=!!(null==S?void 0:S.publishedAs),T=(0,I.useFormField)("",el),M=(0,I.useFormField)("",eu),L=(0,I.useFormField)(null,function(){return null}),B=(0,I.useFormField)("repl_image",function(){return null}),V=(0,I.useFormField)(null,function(){return null}),F=(0,I.useFormField)("",e.fileValidator),U=(0,I.useFormField)(Z.Default,function(){}),G=[T,M,L,B,V,F,U],$=(r=(n=(0,O._)((t=(0,k._)({},W,void 0),N.useMutation(q,t)),2))[0],{data:(i=n[1]).data,loading:i.loading,error:K(i),setReplViewSettings:function(e){return(0,p._)(function(){var t;return(0,y._)(this,function(n){switch(n.label){case 0:if(i.loading)return[2,{data:null,error:null}];n.label=1;case 1:return n.trys.push([1,3,,4]),[4,r({variables:{input:e}})];case 2:return[2,{data:(t=n.sent()).data,error:K(t)}];case 3:return n.sent(),[2,{data:null,error:"Something went wrong saving your Cover page"}];case 4:return[2]}})})()}}),H=(s=(a=(0,O._)((o=(0,k._)({},Q,void 0),N.useMutation(X,o)),2))[0],{data:(l=a[1]).data,loading:l.loading,error:l.error&&J(l.error),updateRepl:function(e){return(0,p._)(function(){return(0,y._)(this,function(t){switch(t.label){case 0:if(l.loading)return[2,{data:null,error:null}];t.label=1;case 1:return t.trys.push([1,3,,4]),[4,s({variables:{input:e}})];case 2:return[2,{data:t.sent().data,error:null}];case 3:return[2,{data:null,error:J(t.sent())}];case 4:return[2]}})})()}}),Y=z(),ee=(null==S||null==(f=S.replViewSettings)?void 0:f.defaultView)&&ei(S.replViewSettings.defaultView)?S.replViewSettings.defaultView:"repl_image",et=(0,A.default)(T.setValue),er=(0,A.default)(M.setValue),ec=(0,A.default)(L.setValue),ed=(0,A.default)(V.setValue),ef=(0,A.default)(B.setValue),ep=(0,A.default)(F.setValue);(0,b.useEffect)(function(){var e,t,n,r;S&&(ef.current(ee),ep.current(null!=(t=null==(e=S.replViewSettings)?void 0:e.replFile)?t:""),et.current(S.isRenamed?S.title:"",{preventTouch:!0}),er.current(null!=(n=S.description)?n:"",{preventTouch:!0}),ec.current(S.iconUrl.endsWith(".svg")?null:S.iconUrl),ed.current(null!=(r=S.imageUrl)?r:null))},[S,ed,ec,et,er,ee,ef,ep]);var eh=en(L.setValue),eg=eh.previewUrl||L.value||(null==S?void 0:S.iconUrl)||(null==S?void 0:S.templateInfo.iconUrl),em=null!=(x=null==(m=G.filter(function(e){return(e!==F||"repl_file"===B.value)&&e.error}))||null==(g=m[0])||null==(h=g.error)?void 0:h.message)?x:null,ev=H.loading||$.loading,ex=H.error||$.error,ey=Y.loading,eb=Y.error;return{selectedRepl:S,isReplLoading:_.loading,replLoadingError:_.error,replTitleField:T,replDescriptionField:M,iconUrlField:L,coverDefaultViewField:B,coverUrlField:V,coverFileField:F,layoutField:U,replIconInput:eh,replIconUrl:eg,inputError:em,save:function(){return(0,p._)(function(){var e,t,n,r,i,o,a,s,l;return(0,y._)(this,function(u){switch(u.label){case 0:if(!S)throw new eo("Missing repl");if(t=S.title!==T.value,n=S.description!==M.value,r=S.iconUrl!==L.value,i="repl_image"===B.value&&S.imageUrl!==V.value,o=F.value&&"repl_file"===B.value&&(null==(e=S.replViewSettings)?void 0:e.replFile)!==F.value,a=B.value&&ee!==B.value,!(t||n||r))return[3,2];if(T.error||M.error||L.error)throw new eo;return[4,H.updateRepl({id:S.id,title:t?T.value:void 0,description:n?M.value:void 0,iconUrl:r?L.value:void 0})];case 1:if((s=u.sent()).error)throw new ea(s.error);u.label=2;case 2:if(!(a||i||o))return[3,4];if("repl_image"===B.value&&V.error||"repl_file"===B.value&&F.error)throw new eo;return[4,$.setReplViewSettings({replId:S.id,defaultView:"repl_image"===B.value?w.ReplViewSettingsDefaultView.ReplImage:w.ReplViewSettingsDefaultView.ReplFile,replImage:i?V.value:void 0,replFile:o?F.value:void 0})];case 3:if((l=u.sent()).error)throw new ea(l.error);u.label=4;case 4:return[2]}})})()},isSaving:ev,savingError:ex,publishInitialRelease:function(){return(0,p._)(function(){var t,n,r;return(0,y._)(this,function(i){switch(i.label){case 0:if(!S)throw new eo("Missing repl");if(em)throw new eo(null!=em?em:"Something went wrong");return t=null,e.canAuthorTemplateLayout&&U.value===Z.Current&&(t=null==(n=e.getDesktopLayoutState)?void 0:n.call(e)),[4,Y.createDeployment({input:{replId:S.id,description:M.value,iconUrl:eg||S.iconUrl,initialLayoutState:t}})];case 1:if((r=i.sent()).error)throw new es(r.error);return(0,P.track)(D.events.POST_MADE,{source:e.source,replType:"template_repl",title:T.value,description:M.value,defaultView:B.value}),[2]}})})()},isPublishing:ey,publishingError:eb,isPublished:j}}var ed=(0,b.createContext)(null),ef=function(e){var t=(0,b.useContext)(ed);if(!t)throw Error("usePublishField must be used within a PublishInputContext");return t["".concat(e,"Field")]},ep=function(){var e=(0,b.useContext)(ed);if(!e)throw Error("usePublishForm must be used within a PublishInputContext");return e};e.s(["CoverPageDefaultView",()=>er,"PublishInputContext",()=>ed,"REPL_DESCRIPTION_MAX_LENGTH",()=>1e3,"isCoverPageDefaultView",()=>ei,"usePublishField",()=>ef,"usePublishForm",()=>ep,"useReplPublish",()=>ec],269818);var eh=e.i(721281),eg=e.i(412160),em=e.i(482206),ev=e.i(877249),ex=e.i(446530),ey=e.i(91720),eb=e.i(88619),ew=e.i(929872),ek=e.i(185591),e_=e.i(690472),eS=(0,ex.cssRecord)({truncateText:[a.rcss.flex.growAndShrink(1),{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"}]}),eC=function(e){var t=e.repl,n=(0,ek.replViewLinkProps)(t),i=t.url?(0,ek.replViewFullUrl)(t):"",o=(0,em.default)({text:"Check out what I just made on Replit: ".concat(t.title),url:i});return(0,r.jsxs)(ew.Surface,{background:"default",css:[a.rcss.borderRadius(8),a.rcss.overflow("hidden"),a.rcss.colWithGap(16),a.rcss.width(510),a.rcss.p(16),a.rcss.flex.growAndShrink(1),(0,eh._)({},"@media (max-width: ".concat(ev.BREAKPOINTS.tabletMin,"px)"),[{width:"100%"}])],dataCy:"published-repl-share-info-container",children:[(0,r.jsxs)(l.View,{gap:16,children:[(0,r.jsx)(s.Text,{variant:"subheadBig",multiline:!1,children:"Share your App"})," ",(0,r.jsxs)(l.View,{gap:4,children:[(0,r.jsx)(s.Text,{variant:"small",multiline:!1,color:"dimmer",children:"Cover page link"}),(0,r.jsxs)(l.View,{row:!0,gap:4,align:"center",children:[(0,r.jsx)(eg.default,(0,ee._)((0,k._)({},n),{css:eS.truncateText,children:i})),(0,r.jsx)(eb.CopyIconButton,{tooltipText:"Copy link",textToCopy:i})]})]})]}),(0,r.jsx)(l.View,{css:[(0,eh._)({alignItems:"flex-end"},a.media.max("mobileMax"),[a.rcss.colWithGap(8),{width:"100%",">*":{width:"100%"}}])],row:!0,gap:12,justify:"end",children:(0,r.jsx)(ey.ButtonLink,{prefetch:!1,href:o,iconLeft:(0,r.jsx)(e_.default,{}),text:"Share to X",target:"_blank",css:[(0,eh._)({},a.media.max("mobileMax"),[a.rcss.mr(0)])]})})]})};e.s(["PublishedReplShareInfo",()=>eC],701366);var ej=e.i(42458);function eT(e){var t=e.error,n=e.dataCy;return t?(0,r.jsxs)(l.View,{row:!0,gap:4,align:"center",children:[(0,r.jsx)(ej.default,{css:[a.rcss.color.accentNegativeDefault]}),(0,r.jsx)(s.Text,{css:[a.rcss.flex.growAndShrink(1),a.rcss.color.accentNegativeDefault],dataCy:n,children:t.message})]}):null}var eE=e.i(428596),eR=e.i(607278),eI=l.SpecializedView.label,eA=(0,b.forwardRef)(function(e,t){return(0,r.jsx)(eI,(0,ee._)((0,k._)({},e),{ref:t,css:a.rcss.color.foregroundDimmer}))}),eP=function(){var e=(0,eE.useIdSeed)(),t=e("replName"),n=e("replDescription"),o=ep(),u=o.replTitleField,c=o.replDescriptionField,d=o.isSaving;return(0,r.jsxs)(l.View,{gap:16,grow:!0,shrink:!0,children:[(0,r.jsxs)(l.View,{gap:4,children:[(0,r.jsx)(l.View,{css:[a.rcss.align.baseline,a.rcss.justify.spaceBetween],row:!0,children:(0,r.jsx)(eA,{css:[a.rcss.color.foregroundDimmer,{lineHeight:i.tokens.lineHeightSmall}],htmlFor:t,children:"Repl name"})}),u.value]}),(0,r.jsxs)(l.View,{gap:4,children:[(0,r.jsxs)(l.View,{css:[a.rcss.align.baseline,a.rcss.justify.spaceBetween],row:!0,children:[(0,r.jsx)(eA,{css:[a.rcss.color.foregroundDimmer,{lineHeight:i.tokens.lineHeightSmall}],htmlFor:n,children:"Repl description"}),(0,r.jsxs)(s.Text,{multiline:!1,css:{color:c.value.length>1e3?i.tokens.accentNegativeStronger:i.tokens.foregroundDimmest},children:[c.value.length,"/",1e3]})]}),(0,r.jsx)(eR.MultiLineInput,{id:n,value:c.value,disabled:d,onChange:function(e){c.setValue(e.currentTarget.value)},placeholder:"What does this Repl do?",css:[a.rcss.minHeight(128),a.rcss.maxHeight(256),{resize:"vertical"}],dataCy:"publish-form-repl-description-input"}),c.touched?(0,r.jsx)(eT,{error:c.error,dataCy:"publish-form-repl-description-error"}):null]})]})};e.s(["BasicsSection",()=>eP],236465);var eD=e.i(349597),eO=function(e){var t=e.showPlayButton,n=e.children,o=e.active;return(0,r.jsxs)("div",{css:{position:"relative",aspectRatio:"".concat(268,"/").concat(164),overflow:"hidden"},children:[(0,r.jsx)("div",{css:{position:"absolute",top:"calc(".concat(18," / ").concat(164," * 100%)"),bottom:"calc(".concat(1," / ").concat(164," * 100%)"),left:"calc(".concat(1," / ").concat(268," * 100%)"),right:"calc(".concat(1," / ").concat(268," * 100%)"),borderBottomLeftRadius:4,borderBottomRightRadius:4,overflow:"hidden",backgroundColor:o?i.tokens.accentPrimaryDimmest:void 0},children:n}),(0,r.jsxs)("svg",{viewBox:"0 0 268 164",fill:"none",xmlns:"http://www.w3.org/2000/svg",css:{position:"relative"},children:[(0,r.jsx)("rect",{width:"268",height:"17",fill:i.tokens.backgroundDefault}),(0,r.jsx)("rect",{x:"241.5",y:"4.5",width:"22",height:"10",rx:"2",fill:i.tokens.accentPositiveDimmer}),(0,r.jsx)("rect",{x:"228.5",y:"4.5",width:"10",height:"10",rx:"2",fill:i.tokens.backgroundHighest}),(0,r.jsx)("rect",{x:"4.5",y:"4.5",width:"32",height:"10",rx:"2",fill:i.tokens.backgroundHighest}),(0,r.jsx)("rect",{x:"1",y:"18",width:"266",height:"1",fill:o?i.tokens.accentPrimaryDefault:i.tokens.outlineDimmer}),t?(0,r.jsx)("path",{d:"M142.225 90.5642C142.565 90.7554 142.565 91.2446 142.225 91.4358L127.745 99.5809C127.412 99.7683 127 99.5275 127 99.1451L127 82.8549C127 82.4725 127.412 82.2317 127.745 82.4191L142.225 90.5642Z",fill:i.tokens.white}):null,(0,r.jsx)("rect",{x:"1",y:"1",width:"266",height:"162",rx:"4",stroke:o?i.tokens.accentPrimaryDefault:i.tokens.outlineDimmer,strokeWidth:"1"})]})]})},eN=e.i(888136),eM=e.i(205104),eL=e.i(967629),eB=e.i(51054),eV=l.SpecializedView.ol,eF=l.SpecializedView.li,eU=(0,eL.css)([a.rcss.py(4),a.rcss.borderRadius(8),{border:"1px solid ".concat(i.tokens.outlineDimmest),borderRadius:i.tokens.borderRadius8,backgroundColor:i.tokens.interactiveBackground,zIndex:a.DefaultModalZIndex,maxHeight:300,position:"absolute",overflowY:"auto",width:"100%",left:0,top:i.tokens.space8,listStyle:"none"}]),eG={backgroundColor:i.tokens.interactiveBackgroundActive},e$={backgroundColor:i.tokens.accentPrimaryDimmer},ez=(0,eL.css)([a.rcss.p(8),{":not([disabled])":{cursor:"pointer",":hover":(0,k._)({},eG),":active":(0,k._)({},e$)}}]);function eH(e){var t,n,i,o,u,c,d,f,h,g,m,x,w,_,S,C,j=e.fs,T=e.initiallySelectedFile,E=e.onFileSelect,R=e.onClear,I=(0,b.useRef)(null),P=(n=(t=(0,O._)((0,b.useState)({isLoading:!0,error:null,files:[]}),2))[0],i=t[1],(0,b.useEffect)(function(){(0,p._)(function(){var e,t;return(0,y._)(this,function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,j.listFiles()];case 1:if((e=n.sent()).error)throw Error(e.error);return i({isLoading:!1,error:null,files:(null!=(t=e.files)?t:[]).slice().sort(function(e,t){return e.localeCompare(t)}).map(function(e){return{file:e,pathDepth:(0,eM.getPathDepth)(e)}}).sort(function(e,t){return e.pathDepth-t.pathDepth}).map(function(e){return e.file})}),[3,3];case 2:return n.sent(),i({isLoading:!1,error:"Could not load files",files:[]}),[3,3];case 3:return[2]}})})()},[j]),(0,k._)({},n)),D=P.isLoading,N=P.files,M=P.error,L=(u=(o={files:N,inputRef:I,initiallySelectedFile:T}).files,c=o.inputRef,d=o.initiallySelectedFile,h=(f=(0,O._)((0,b.useState)(!1),2))[0],g=f[1],x=(m=(0,O._)((0,b.useState)(u),2))[0],w=m[1],_=(0,b.useCallback)(function(e){return u.filter(function(t){return t.toLowerCase().includes(e.toLowerCase())})},[u]),S=(0,eN.useCombobox)({items:x,isOpen:h,initialInputValue:d,initialSelectedItem:x.find(function(e){return e===d}),onIsOpenChange:function(e){g(!!e.isOpen)},onInputValueChange:function(e){var t;w(_(null!=(t=e.inputValue)?t:""))}}),C=(0,b.useCallback)(function(){var e;g(!1),null==(e=c.current)||e.blur()},[c]),(0,b.useEffect)(function(){var e;w(_(null!=(e=S.inputValue)?e:""))},[u,_,S.inputValue]),(0,b.useEffect)(function(){S.selectedItem&&C()},[S.selectedItem,C]),(0,ee._)((0,k._)({},S),{closeMenu:C,items:x})),B=(0,A.default)(E);return(0,b.useEffect)(function(){L.selectedItem&&B.current(L.selectedItem)},[L.selectedItem,B]),(0,r.jsxs)(l.View,{children:[(0,r.jsx)(l.View,(0,ee._)((0,k._)({},L.getComboboxProps({refKey:"innerRef"})),{css:[a.rcss.position.relative],children:(0,r.jsx)(eB.SearchBar,(0,ee._)((0,k._)({},L.getInputProps({onFocus:L.openMenu,ref:I,refKey:"inputRef",disabled:D,placeholder:"Search your files"})),{onClear:function(){var e;L.reset(),null==(e=I.current)||e.focus(),R()},loading:D}))})),(0,r.jsxs)(l.View,(0,ee._)((0,k._)({},L.getMenuProps({refKey:"innerRef"})),{css:[a.rcss.position.relative],children:[M?(0,r.jsx)(l.View,{p:8,children:(0,r.jsx)(s.Text,{multiline:!1,children:"Something went wrong loading your files. Please try again."})}):null,!M&&L.isOpen?(0,r.jsx)(eV,{css:[eU],children:L.items.length>0?L.items.map(function(e,t){return(0,r.jsx)(eF,(0,ee._)((0,k._)({css:[ez,L.highlightedIndex===t&&eG,e===L.selectedItem&&e$]},L.getItemProps({item:e,index:t,onClick:function(){L.closeMenu()}})),{children:(0,r.jsx)(s.Text,{multiline:!1,children:e})}),e)}):(0,r.jsx)(eF,{css:[a.rcss.p(8)],children:(0,r.jsxs)(s.Text,{multiline:!1,children:['No files found for "',L.inputValue,'"']})})}):null]}))]})}var eW=e.i(971072),eq=function(e){var t=(0,b.useRef)(null);return{inputProps:{onChange:function(t){var n=t.target,r=n.validity,i=n.files;if(r.valid){var o=i?i[0]:null;o&&e(o)}},"aria-hidden":"true",ref:t,accept:eW.ACCEPTABLE_IMAGE_UPLOAD_TYPES.join(","),type:"file"},buttonProps:{onClick:function(){var e;return null==(e=t.current)?void 0:e.click()}},inputRef:t}},eK=function(e){var t=eq(e.onFile),n=t.inputProps,i=t.buttonProps;return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("input",(0,ee._)((0,k._)({},n),{css:{display:"none"}})),e.children(i)]})},eY=e.i(211397),eQ=(0,eL.css)({position:"absolute",top:0,left:0,width:"100%",height:"100%"});function eX(e){var t=e.src,n=e.alt;return(0,r.jsxs)(l.View,{css:[eQ,{borderBottomLeftRadius:8,borderBottomRightRadius:8,overflow:"hidden"}],children:[(0,r.jsx)(eY.default,{objectFit:"cover",layout:"fill",src:t,alt:n}),(0,r.jsx)(l.View,{css:[eQ,{background:"radial-gradient(rgba(0, 0, 0, 0.3), rgba(0, 0, 0, 0.6))",backgroundRepeat:"no-repeat"}]})]})}var eJ=e.i(140487),eZ=e.i(734882),e0=e.i(396776),e1=e.i(658975),e2=e.i(940745),e3=[{value:er.ReplImage,text:"Photo"},{value:er.ReplFile,text:"File"}],e4=function(e){var t,n,o,u,c,d=e.fs,f=(0,eE.useIdSeed)(),h=f("coverPage"),g=ep(),m=g.selectedRepl,x=g.coverFileField,w=g.coverUrlField,_=g.coverDefaultViewField,S=(0,O._)((t=function(e){return(0,p._)(function(){var t;return(0,y._)(this,function(n){switch(n.label){case 0:if(!(null==e?void 0:e.length)||!(t=e[0]).type.startsWith("image/"))return[2];return[4,T.uploadImage(t,eD.ImageUploadContexts.ReplCoverImage)];case 1:return n.sent(),[2]}})})()},o=(n=(0,O._)((0,b.useState)(!1),2))[0],u=n[1],c=(0,b.useRef)(0),[o,(0,b.useMemo)(function(){return{onDragEnter:function(e){e.preventDefault(),c.current++,u(!0)},onDragLeave:function(e){e.preventDefault(),c.current--,0===c.current&&u(!1)},onDrop:function(e){e.preventDefault(),c.current=0,u(!1),e.persist();var n,r,i=Array.from(null!=(r=null==e||null==(n=e.dataTransfer)?void 0:n.files)?r:[]);0===i.length?t(null):t(i)},onDragOver:function(e){e.preventDefault()}}},[t])]),2),C=S[0],j=S[1],T=en(w.setValue);return(0,r.jsxs)(l.View,(0,ee._)((0,k._)({gap:16},j),{children:[(0,r.jsxs)(l.View,{gap:12,children:[(0,r.jsx)(l.View,{row:!0,gap:8,children:(0,r.jsx)(eZ.RadioGroup,{tag:"fieldset",css:[a.rcss.rowWithGap(24)],name:h,value:_.value,onChange:function(e){ei(e.target.value)&&_.setValue(e.target.value)},children:e3.map(function(e){return(0,r.jsxs)(l.View,{row:!0,gap:8,children:[(0,r.jsx)(eZ.Radio,{id:f(e.value),value:e.value}),(0,r.jsx)("label",{htmlFor:f(e.value),children:e.text})]},e.value)})})}),_.value===er.ReplImage&&(0,r.jsxs)(l.View,{gap:4,align:"center",children:[(0,r.jsx)(eK,{onFile:function(e){return T.uploadImage(e,eD.ImageUploadContexts.ReplCoverImage)},children:function(e){var t=e.onClick;return(0,r.jsx)(eJ.Button,{onClick:t,colorway:C?"primary":void 0,text:"Upload a cover photo",iconLeft:T.isLoading?(0,r.jsx)(e2.default,{}):(0,r.jsx)(e1.default,{}),stretch:!0})}}),T.error?(0,r.jsx)(e0.StatusBanner,{colorway:"negative",icon:(0,r.jsx)(ej.default,{}),text:T.error}):null,(0,r.jsx)(s.Text,{variant:"small",color:"dimmer",children:"or drag and drop a photo here"})]}),_.value===er.ReplFile&&(0,r.jsxs)(l.View,{gap:8,children:[(0,r.jsx)(eH,{fs:d,initiallySelectedFile:x.value,onFileSelect:x.setValue,onClear:function(){return x.setValue("")}},null==m?void 0:m.id),(0,r.jsx)(eT,{error:x.error})]})]}),_.value===er.ReplImage&&(0,r.jsxs)(eO,{active:C,showPlayButton:_.value===er.ReplImage&&!!w.value&&!T.isLoading,children:[_.value===er.ReplImage&&w.value?(0,r.jsx)(eX,{src:w.value,alt:"cover"}):null,T.isLoading?(0,r.jsx)(l.View,{css:[{position:"absolute",inset:0},a.rcss.align.center,a.rcss.justify.center],children:(0,r.jsx)(e2.default,{color:i.tokens.white,size:24})}):null]})]}))};e.s(["CoverPageSection",()=>e4],886533);var e8=e.i(228108);e.i(283110);var e5=function(){ef("iconUrl");var e=ep(),t=e.replIconInput,n=e.replIconUrl;return(0,r.jsxs)(l.View,{gap:16,align:"center",children:[(0,r.jsxs)(l.View,{gap:8,children:[(0,r.jsxs)(l.View,{row:!0,gap:8,children:[(0,r.jsx)(eK,{onFile:function(e){return t.uploadImage(e,eD.ImageUploadContexts.ReplIcon)},css:a.rcss.backgroundColor.accentNegativeDefault,children:function(e){var t=e.onClick;return(0,r.jsx)(eJ.Button,{onClick:t,text:"Upload image",iconLeft:(0,r.jsx)(e1.default,{}),css:[a.rcss.backgroundColor.backgroundHigher],type:"button",stretch:!0})}}),null]}),t.error?(0,r.jsx)(l.View,{children:(0,r.jsx)(e0.StatusBanner,{icon:(0,r.jsx)(ej.default,{}),colorway:"negative",text:t.error,closable:!0,closeAction:t.clearError})}):null]}),(0,r.jsx)(e8.ReplIconWithLoadingState,{alt:"icon",size:84,iconUrl:n,isLoading:!!t.previewUrl,css:[a.rcss.backgroundColor.backgroundHigher]})]})};e.s(["IconUrlSection",()=>e5],295276);var e6=function(){return(0,r.jsx)(l.View,{gap:8,children:(0,r.jsx)(l.View,{children:(0,r.jsxs)(s.Text,{children:["See the"," ",(0,r.jsx)("a",{href:"https://docs.replit.com/replit-workspace/templates",target:"_blank",children:"template docs"})," ","for a guide on what makes a good template. Please make sure your Repl abides by the"," ",(0,r.jsx)("a",{href:"https://blog.replit.com/community-standards",target:"_blank",children:"Replit community rules and guidelines"})," ","before publishing."]})})})};e.s(["PublishingSection",()=>e6],2835);var e9=e.i(992785),e7=e.i(612651),te=e.i(886513);e.i(282890);var tt=e.i(827456),tn=e.i(352701),tr=(0,ex.cssRecord)({container:[a.rcss.maxWidth(100),a.rcss.backgroundColor.backgroundDefault,a.rcss.borderRadius(4),{aspectRatio:"1 / 1"}],stacked:[a.rcss.flex.grow(1),a.rcss.colWithGap(2),a.rcss.justify.spaceEvenly],sideBySide:[a.rcss.flex.grow(1),a.rcss.rowWithGap(2)],paneGroup:[a.rcss.p(2),a.rcss.flex.grow(1),a.rcss.backgroundColor.backgroundHigher,a.rcss.center]});function ti(e){var t=e.layoutState,n=(0,te._)(e,["layoutState"]);return(0,r.jsx)(l.View,(0,ee._)((0,k._)({css:tr.container,p:4,row:!0},n),{children:(0,r.jsx)(to,{root:t.layout,paneData:t.data})}))}function to(e){var t,n=e.root,i=e.paneData;return null==n.tiling?null:(0,r.jsx)(l.View,{grow:!0,row:!0,children:(null==(t=n.tiling)?void 0:t.type)==="split"?(0,r.jsx)(ta,{split:n.tiling,paneData:i,depth:1}):(0,r.jsx)(ts,{group:n.tiling,paneData:i,depth:1})})}function ta(e){var t=e.split,n=e.paneData,i=e.depth;return i>2?(0,r.jsx)(tl,{}):(0,r.jsx)(l.View,{css:t.stacked?tr.stacked:tr.sideBySide,children:t.children.map(function(e){return"split"===e.type?(0,r.jsx)(ta,{split:e,paneData:n,depth:i+1},e.type+i):(0,r.jsx)(ts,{group:e,paneData:n,depth:i+1},e.type+i)})})}function ts(e){var t=e.group,n=e.paneData,i=e.depth,o=n[t.panes[t.activeIndex]],a=(0,tt.usePaneUIContext)(),s=a.Icon({pane:o,size:i>1?12:16}),u=a.getTitle(o);return(0,r.jsx)(l.View,{css:tr.paneGroup,title:u,children:s})}function tl(){return(0,r.jsx)(l.View,{css:tr.paneGroup,children:(0,r.jsx)(tn.default,{})})}var tu=e.i(346715),tc=(0,ex.cssRecord)({layoutButton:[a.rcss.borderRadius(4),a.rcss.p(8),a.rcss.border({width:1,color:i.tokens.greyDimmer}),a.rcss.backgroundColor.backgroundHigher,a.rcss.cursor.pointer,{"&:hover":[a.rcss.backgroundColor.backgroundHighest],'&[data-selected="true"]':[a.rcss.backgroundColor.accentPrimaryDimmest,a.rcss.border({color:i.tokens.blueDimmer})],'&[data-selected="true"]:hover':[a.rcss.backgroundColor.accentPrimaryDimmer],'&[data-disabled="true"]':[a.rcss.backgroundColor.backgroundDefault,a.rcss.border({color:i.tokens.greyDimmest}),a.rcss.color.foregroundDimmer,{"&:hover":{cursor:"not-allowed"}}]}],layoutButtonRow:[a.rcss.rowWithGap(8),a.rcss.justify.spaceBetween,a.rcss.width("100%")],layoutButtonText:[a.rcss.flex.growAndShrink(1),a.rcss.flex.column,a.rcss.justify.center],layoutButtonHeader:[a.rcss.mb(4)],layoutPreview:[a.rcss.width(80),a.rcss.height(80),{alignSelf:"center"}]});function td(e){var t,n=e.getCurrentLayoutState(),i=(0,e9.default)((0,e7.default)(n,"sidebarPercent"),(0,e7.default)(e.savedLayoutState,"sidebarPercent")),o=(t=(0,tt.usePaneUIContext)(),(0,b.useCallback)(function(e){if((null==e?void 0:e.layout.tiling)==null)return"No tiled panes in layout";for(var n=[],r=[e.layout.tiling];r.length>0;){var i=r.pop();(null==i?void 0:i.type)==="paneGroup"?n.push.apply(n,(0,tu._)(i.panes)):(null==i?void 0:i.children)&&r.push.apply(r,(0,tu._)(i.children))}return n.reverse().map(function(n){return t.getTitle(e.data[n])}).join(", ")},[t])),a=(0,b.useMemo)(function(){return o(e.savedLayoutState)},[o,e.savedLayoutState]),u=(0,b.useMemo)(function(){return o(n)},[n,o]);return(0,r.jsxs)(l.View,{gap:8,children:[(0,r.jsx)(s.Text,{variant:"small",children:"Choose an initial workspace layout for new Apps using this template."}),(0,r.jsx)(ew.Surface,{css:tc.layoutButton,"data-selected":e.templateLayout.value===Z.Default,onClick:function(){return e.templateLayout.setValue(Z.Default)},children:(0,r.jsx)(l.View,{css:tc.layoutButtonRow,children:(0,r.jsxs)(l.View,{css:tc.layoutButtonText,children:[(0,r.jsx)(s.Header,{level:3,variant:"text",css:tc.layoutButtonHeader,children:"Default layout"}),(0,r.jsx)(s.Text,{multiline:!0,variant:"small",children:"User's default layout (either side-by-side or stacked)."})]})})}),e.savedLayoutState?(0,r.jsx)(ew.Surface,{css:tc.layoutButton,"data-selected":e.templateLayout.value===Z.Saved,onClick:function(){return e.templateLayout.setValue(Z.Saved)},children:(0,r.jsxs)(l.View,{css:tc.layoutButtonRow,children:[(0,r.jsxs)(l.View,{css:tc.layoutButtonText,children:[(0,r.jsx)(s.Header,{level:3,variant:"text",css:tc.layoutButtonHeader,children:"Saved layout"}),(0,r.jsx)(s.Text,{variant:"small",children:a})]}),(0,r.jsx)(ti,{css:tc.layoutPreview,layoutState:e.savedLayoutState})]})}):null,(0,r.jsx)(ew.Surface,{css:tc.layoutButton,"data-selected":e.templateLayout.value===Z.Current,"data-disabled":i,onClick:i?void 0:function(){return e.templateLayout.setValue(Z.Current)},children:(0,r.jsxs)(l.View,{css:tc.layoutButtonRow,children:[(0,r.jsxs)(l.View,{css:tc.layoutButtonText,children:[(0,r.jsx)(s.Header,{level:3,variant:"text",css:tc.layoutButtonHeader,children:"Current layout"}),(0,r.jsx)(s.Text,{variant:"small",children:i?"Same as saved layout":u})]}),(0,r.jsx)(ti,{css:tc.layoutPreview,layoutState:n})]})})]})}function tf(e){var t=e.getCurrentLayoutState,n=ef("layout");return(0,r.jsx)(l.View,{gap:8,children:null==t?(0,r.jsx)(s.Text,{children:"Initial layouts may only be customized in the desktop environment."}):(0,r.jsx)(td,{templateLayout:n,getCurrentLayoutState:t})})}function tp(e){var t=e.dotReplit,n=(0,O._)((0,b.useState)({isLoading:!0,error:null,entryPoint:null}),2),r=n[0],i=n[1];return(0,b.useEffect)(function(){(0,p._)(function(){var e,n,r;return(0,y._)(this,function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),[4,t.getConfig()];case 1:if((n=o.sent()).error)throw Error(n.errorMessage);return i({isLoading:!1,error:null,entryPoint:null!=(r=null==n||null==(e=n.config)?void 0:e.entrypoint)?r:null}),[3,3];case 2:return o.sent(),i({isLoading:!1,error:"Could not load .replit config",entryPoint:null}),[3,3];case 3:return[2]}})})()},[t]),(0,k._)({},r)}e.s(["TemplateLayoutSection",()=>tf,"TemplateLayoutSelector",()=>td],814991),e.s(["default",()=>tp],522155)},263649,e=>{"use strict";var t=e.i(878420),n=e.i(64386),r=e.i(399528),i=e.i(787182);function o(e){var o=e.throwBsod,a=e.tags,s=e.extras,l=e.origin,u=e.onNonBsodUnrecoverableError;return function(e){var c=(0,i.default)(e);if(c===i.NonBsodErrorType.NotFound)return void r.default.push("/home","~/");if(c===i.NonBsodErrorType.LanguageTokenDenied)return void window.location.reload();if(c===i.NonBsodErrorType.CrosisChannel)a=(0,n._)((0,t._)({},a),{crosis:!0});else if(c){null==u||u(c);return}console.error(e),o({error:e,tags:a,extras:s,origin:l})}}e.s(["default",()=>o])},598801,911489,157584,e=>{"use strict";var t=e.i(721281),n=e.i(276385),r=e.i(490048),i=e.i(297083),o=e.i(878420),a=e.i(64386),s=e.i(530658),l=e.i(817556),u=e.i(389959),c=e.i(903381),d=e.i(993796),f=e.i(650587),p=e.i(98816),h=e.i(858248),g=e.i(709485),m=e.i(382614),x=e.i(269818),y=e.i(701366),b=e.i(465214),w=e.i(236465),k=e.i(886533),_=e.i(295276),S=e.i(2835),C=e.i(814991),j=e.i(522155),T=e.i(19004),E=e.i(792e3),R=e.i(8808),I=e.i(170784),A=e.i(122965),P=e.i(534518),D=e.i(263649),O=e.i(37292);e.i(33699);var N=e.i(633600),M=e.i(346715),L=e.i(569384),B=e.i(973245),V=e.i(304277);function F(){var e=(0,L._)(["\n  query BSODComponent {\n    currentUser {\n      id\n      username\n      image\n      isStaff: hasRole(role: REPLIT_STAFF)\n      isAdmin: hasRole(role: ADMIN)\n    }\n  }\n"]);return F=function(){return e},e}e.i(566901);var U={},G=(0,B.gql)(F()),$=e.i(410721),z=e.i(967629),H=e.i(446530),W=e.i(613355),q=e.i(714165),K=e.i(140487),Y=e.i(739521),Q=e.i(396776),X=e.i(960178),J=e.i(625484),Z=e.i(616278),ee=e.i(42458),et=(0,z.css)({".sentry-error-embed-wrapper":{zIndex:"".concat(W.DefaultModalZIndex," !important")}}),en=(0,H.cssRecord)({errorStack:[W.rcss.p(16),W.rcss.width("100%"),W.rcss.backgroundColor.backgroundHigher,W.rcss.borderRadius(8),W.rcss.overflowY("hidden"),W.rcss.font.code,W.rcss.fontSize(12),{whiteSpace:"pre"}],userAndErrorIdContainer:[W.rcss.width("100%"),W.rcss.backgroundColor.backgroundHigher,W.rcss.borderRadius(8)],error:[W.rcss.font.code]}),er=/at (.+) \((https:\/\/.+\.js):(\d+):(\d+)\)/,ei=/at (https:\/\/.+\.js):(\d+):(\d+)/,eo=function(t){var r=t.bsod,o=(0,s._)((0,u.useState)(null),2),a=o[0],c=o[1];(0,u.useEffect)(function(){(0,i._)(function(){return(0,l._)(this,function(t){switch(t.label){case 0:var n;return t.trys.push([0,2,,3]),[4,(n=r.error,(0,i._)(function(){var t,r,o,a,u,c,d,f;return(0,l._)(this,function(p){switch(p.label){case 0:t=new Map,p.label=1;case 1:return p.trys.push([1,3,,4]),[4,e.A(67826)];case 2:return r=p.sent(),[3,4];case 3:throw p.sent(),Error("source-map not available");case 4:if(!(o=n.stack))throw Error("expected error.stack to be defined");return a=o.split("\n").map(function(e){return e.trim()}).filter(function(e){return!!e}),c=(u=(0,N._)(a))[0],[4,Promise.all(u.slice(1).map(function(e){return(0,i._)(function(){var n,o,a,u,c,d,f,p,h,g;return(0,l._)(this,function(m){switch(m.label){case 0:var x;if(er.test(e)){if(!(c=er.exec(e)))throw Error("expected result");o=(d=(0,s._)(c.slice(2),3))[0],a=d[1],u=d[2]}else{if(!ei.test(e))return[2,e];if(!(f=ei.exec(e)))throw Error("expected result");o=(p=(0,s._)(f.slice(1),3))[0],a=p[1],u=p[2]}return[4,(x="".concat(o,".map"),(0,i._)(function(){var e,n,i;return(0,l._)(this,function(o){switch(o.label){case 0:if(e=t.get(x))return[2,e];o.label=1;case 1:return o.trys.push([1,3,,4]),[4,fetch(x).then(function(e){return e.json()})];case 2:return n=o.sent(),i=new r.SourceMapConsumer(n),t.set(x,i),[2,i];case 3:return o.sent(),[2,null];case 4:return[2]}})})())];case 1:if(!(h=m.sent()))return[2,"    ".concat(e)];if(g=h.originalPositionFor({line:Number(a),column:Number(u)}),n)return[2,"    at ".concat(g.name," (").concat(g.source,":").concat(g.line,":").concat(g.column,")")];return[2,"    at ".concat(g.source,":").concat(g.line,":").concat(g.column)]}})})()}))];case 5:return d=p.sent(),Object.assign(f=Error(),{name:n.name,stack:[c].concat((0,M._)(d)).join("\n"),message:n.message},n),[2,f]}})})())];case 1:return c(t.sent()),[3,3];case 2:return t.sent(),[2];case 3:return[2]}})})()},[r.error]);var d=(0,u.useMemo)(function(){var e,t,n,i;return a?null!=(n=null==(t=a.stack)?void 0:t.split("\n"))?n:[]:null!=(i=null==(e=r.error.stack)?void 0:e.split("\n"))?i:[]},[a,r.error.stack]);return(0,n.jsxs)("div",{css:en.errorStack,children:[(0,n.jsxs)("div",{children:["Origin: ",r.origin]}),null==d?void 0:d.map(function(e,t){var r=e.replace("webpack-internal:///./",""),i=r.includes("node_modules");return(0,n.jsx)("div",{css:i&&W.rcss.color.foregroundDimmest,children:r},t)})]})};let ea=function(){var e,t,r,i,a=(0,s._)((0,O.useBsod)(),1)[0],l=(e={skip:!a},t=(0,o._)({},U,e),V.useQuery(G,t)),u=l.data,c=l.loading,d=(0,$.useReplitStatus)().isOperational;if((0,O.useClearBsod)(),!a)return null;var f=(null==u||null==(r=u.currentUser)?void 0:r.isStaff)||(null==u||null==(i=u.currentUser)?void 0:i.isAdmin);return(0,n.jsxs)(Y.Modal,{isOpen:!0,preventClose:!0,onRequestClose:function(){},maxWidth:872,children:[(0,n.jsxs)(J.View,{gap:16,align:"center",children:[(0,n.jsx)(X.Text,{variant:"headerDefault",children:"Your app is having a bit of trouble"}),(0,n.jsx)(J.View,{row:!0,gap:8,align:"center",children:(0,n.jsx)(Q.StatusBanner,{colorway:d?"positive":"negative",icon:d?(0,n.jsx)(Z.default,{}):(0,n.jsx)(ee.default,{}),text:(0,n.jsxs)(X.Text,{children:["Replit status:"," ",(0,n.jsx)("a",{href:"https://status.replit.com",target:"_blank",rel:"noopener noreferrer",style:{textDecoration:"underline",color:"inherit"},children:d?"operational":"experiencing issues"})]})})}),(0,n.jsx)(X.Text,{variant:"text",multiline:!0,children:"The issue has been logged and the Replit team will look into it. Try reloading the page to get back to building."}),(0,n.jsxs)(J.View,{gap:16,css:en.userAndErrorIdContainer,p:16,children:[!c&&(null==u?void 0:u.currentUser)?(0,n.jsxs)(J.View,{row:!0,gap:16,align:"center",children:[(0,n.jsx)(q.Avatar,{src:u.currentUser.image,username:u.currentUser.username,size:48}),(0,n.jsx)(X.Text,{variant:"text",multiline:!1,children:u.currentUser.username})]}):null,(0,n.jsxs)("div",{css:en.error,children:["Error: ",a.eventId]})]}),f?(0,n.jsx)(eo,{bsod:a}):null,(0,n.jsx)(K.Button,{onClick:function(){return window.location.reload()},colorway:"primary",stretch:!0,text:"Reload"}),!1]}),(0,n.jsx)(z.Global,{styles:[et]})]})};e.s(["default",0,ea],911489);var es=e.i(480028),el=e.i(929872),eu=e.i(751273),ec=e.i(702762),ed=e.i(352767),ef=e.i(369948),ep=e.i(940745),eh=e.i(452814),eg=(0,H.cssRecord)({rootContainer:[(0,t._)({},(0,ec.screenMediaForMinWidth)("tabletMin"),{display:"flex"}),W.rcss.flex.growAndShrink(1),W.rcss.p(16),W.rcss.colWithGap(12),W.rcss.align.center,W.rcss.display.none],heading:[W.rcss.width("100%"),{fontWeight:es.tokens.fontWeightMedium}],contentContainer:[W.rcss.width("100%"),W.rcss.maxWidth(432),W.rcss.position.relative],topShadow:{position:"absolute",zIndex:2,inset:0,boxShadow:"inset 0 48px 24px -24px "+es.tokens.backgroundRoot+", inset 0 -48px 24px -24px "+es.tokens.backgroundRoot},feed:[W.rcss.height(416),W.rcss.colWithGap(24),W.rcss.justify.center,W.rcss.overflow("hidden"),W.rcss.backgroundColor.backgroundRoot]}),em=J.SpecializedView.form,ev=function(e){var t=e.user,r=(0,x.usePublishForm)(),i=r.selectedRepl,s=r.replTitleField,l=r.replDescriptionField,u=r.replIconUrl;return(0,n.jsxs)(el.Surface,{background:"root",css:eg.rootContainer,children:[(0,n.jsx)(X.Text,{multiline:!1,variant:"small",color:"dimmer",css:eg.heading,children:"Preview"}),(0,n.jsxs)(J.View,{css:eg.contentContainer,children:[(0,n.jsx)(J.View,{css:eg.topShadow}),(0,n.jsxs)(J.View,{css:eg.feed,children:[(0,n.jsx)(b.ReplSkeleton,{}),i&&u?(0,n.jsx)(b.default,{post:{user:t,repl:(0,a._)((0,o._)({},i),{title:s.value,iconUrl:u,description:l.value,isTemplate:!0})}}):(0,n.jsx)(J.View,{grow:!0,align:"center",justify:"center",children:(0,n.jsx)(ep.default,{})}),(0,n.jsx)(b.ReplSkeleton,{})]})]})]})},ex=["Basics","Icon","Cover page","Layout","Publishing"],ey=(0,H.cssRecord)({rootContainer:[W.rcss.borderRadius(8),W.rcss.flex.row,W.rcss.overflow("hidden"),(0,t._)({},(0,ec.screenMediaForMinWidth)("tabletMax"),{minWidth:850})],formContainer:[W.rcss.minWidth(320),W.rcss.flex.growAndShrink(1),(0,t._)({},(0,ec.screenMediaForMinWidth)("tabletMin"),{maxWidth:370})],form:[W.rcss.colWithGap(16),W.rcss.flex.growAndShrink(1)],loadingContainer:[W.rcss.color.foregroundDimmer],submitButton:[{boxShadow:"0px 0px 16px 0px ".concat(es.tokens.accentPrimaryDimmer," !important")}]});function eb(e){var t,r,o,a,b,N,M,L,B,V,F,U,G,$,z,H,q,Y=e.replId,Z=e.currentUser,et=e.source,en=e.getDesktopLayoutState,er=(0,f.useIsMobile)({tablet:!0}),ei=(0,d.useFlag)({type:"boolean",controlName:"flag-template-layout-author"}),eo=!er&&ei&&null!=en,es=(0,x.useReplPublish)({replId:Y,fileValidator:function(e){return(0,i._)(function(){var t;return(0,l._)(this,function(n){switch(n.label){case 0:if(!eM)return[2,{message:"Could not get file"}];if(!e)return[2,{message:"File path cannot be blank"}];n.label=1;case 1:return n.trys.push([1,3,,4]),[4,eM.stat(e)];case 2:if(!(t=n.sent()).exists||t.type!==c.FileType.File)return[2,{message:"File does not exist"}];return[3,4];case 3:return n.sent(),[2,{message:"Could not get file"}];case 4:return[2]}})})()},source:et,canAuthorTemplateLayout:eo,getDesktopLayoutState:en}),ec=es.selectedRepl,eg=es.isReplLoading,eb=es.replLoadingError,ew=es.replTitleField,ek=es.replDescriptionField,e_=es.iconUrlField,eS=es.coverDefaultViewField,eC=es.coverUrlField,ej=es.coverFileField,eT=es.layoutField,eE=es.save,eR=es.isSaving,eI=es.savingError,eA=es.publishInitialRelease,eP=es.isPublishing,eD=es.publishingError,eO=es.isPublished,eN=(r=(t={repl:ec,currentUser:Z}).repl,o=t.currentUser,b=(a=(0,s._)((0,O.useBsod)(),2))[0],N=a[1],M=(0,O.useClearBsod)(),B=(L=(0,s._)((0,u.useState)(function(){var e,t,n;return e=(0,E.default)({onUnrecoverableError:(0,D.default)({throwBsod:N,origin:"Publish: services/onUnrecoverableError"})}),t=(0,P.default)({container:e}),n=(0,T.default)({container:e,fs:t}),{container:e,fs:t,dotReplit:n}}),1)[0]).container,V=L.fs,F=L.dotReplit,G=(U=(0,s._)((0,u.useState)(function(){return B.getConnectionState()===R.ConnectionState.CONNECTED}),2))[0],$=U[1],z=(0,I.useMemoizedConnectContext)(r?{repl:r,currentUser:o}:null),H=(0,A.useFlaggedRetrier)(),(0,u.useEffect)(function(){if(r&&z&&B.getConnectionState()===R.ConnectionState.DISCONNECTED)return B.connect({context:z,getMinimumRetryDelayMs:H}),function(){return B.close()}},[r,B,z]),(0,u.useEffect)(function(){return B.onConnectionStateChanged(function(e){$(e===R.ConnectionState.CONNECTED)})},[B]),{isConnected:G,container:B,fs:V,dotReplit:F,bsodId:null==b?void 0:b.eventId,devClearBsod:function(){return M()}}),eM=eN.fs,eL=eN.dotReplit,eB=eN.bsodId,eV=eo&&!eO?[]:["Layout"],eF=(0,s._)((0,u.useState)(0),2),eU=eF[0],eG=eF[1],e$=ex[eU],ez=eU===ex.length-1,eH=(0,s._)((0,u.useState)({show:!1,isUpdate:!1}),2),eW=eH[0],eq=eH[1],eK=(0,s._)((0,u.useState)(function(){return Array(ex.length).fill(!1)}),2),eY=eK[0],eQ=eK[1],eX=(0,u.useCallback)(function(e,t){eY[e]=t,eQ(eY)},[eY]);(0,u.useEffect)(function(){es.replTitleField.value&&es.replDescriptionField.value?eX(0,!0):eX(0,!1),es.iconUrlField.value?eX(2,!0):eX(2,!1),es.coverDefaultViewField.value===x.CoverPageDefaultView.ReplImage&&es.coverUrlField.value||es.coverDefaultViewField.value===x.CoverPageDefaultView.ReplFile&&es.coverFileField.value?eX(3,!0):eX(3,!1)},[eY,es,eX]);var eJ=(0,j.default)({dotReplit:eL});(0,u.useEffect)(function(){eJ.isLoading||!eJ.entryPoint||ej.value||ej.setValue(eJ.entryPoint)},[eJ.isLoading,eJ.entryPoint,ej]);var eZ=(0,s._)((0,u.useState)(!1),2),e0=eZ[0],e1=eZ[1];(0,u.useEffect)(function(){e0||Y&&(eg||eO)||(e1(!0),(0,h.track)(g.events.PUBLISH_SELECTED,{source:et}))},[e0,et,Y,eg,eO]);var e2=(0,p.default)(!!(null==ec?void 0:ec.publishedAs)),e3=(0,p.default)(e$);if((0,u.useEffect)(function(){return function(){e2.current||(0,h.track)(g.events.PUBLISH_FLOW_EXITED,{source:et,lastSectionVisited:e3.current})}},[et,e2,e3]),eB)return(0,n.jsx)(ea,{});if(eW.show&&ec)return(0,n.jsx)(y.PublishedReplShareInfo,{repl:ec});var e4={Basics:{hasError:!!(ew.error||ek.error),isValid:function(){return(0,i._)(function(){return(0,l._)(this,function(e){switch(e.label){case 0:return[4,Promise.all([ew.validate(),ek.validate()])];case 1:return[2,e.sent().every(function(e){return!e})]}})})()}},Icon:{hasError:!!e_.error,isValid:function(){return(0,i._)(function(){return(0,l._)(this,function(e){switch(e.label){case 0:return[4,e_.validate()];case 1:return[2,!e.sent()]}})})()}},"Cover page":{hasError:!!(eS.value===x.CoverPageDefaultView.ReplImage?eC.error:ej.error),isValid:function(){return(0,i._)(function(){var e;return(0,l._)(this,function(t){switch(t.label){case 0:if(eS.value!==x.CoverPageDefaultView.ReplImage)return[3,2];return[4,eC.validate()];case 1:return e=!t.sent(),[3,4];case 2:return[4,ej.validate()];case 3:e=!t.sent(),t.label=4;case 4:return[2,e]}})})()}},Layout:{hasError:!!eT.error,isValid:function(){return(0,i._)(function(){return(0,l._)(this,function(e){switch(e.label){case 0:return[4,eT.validate()];case 1:return[2,!e.sent()]}})})()}},Publishing:{hasError:!1,isValid:function(){return(0,i._)(function(){return(0,l._)(this,function(e){return[2,!0]})})()}}},e8=e4[e$].hasError,e5=e4[e$].isValid,e6=null!=(q=ex.find(function(e){return e4[e].hasError}))?q:null,e9=null;ec?eb||eI||eD?e9="Something went wrong - please try again":e8&&(e9="Please fill out the the form"):e9="Please select a Repl";var e7=!!(!ec||e8||eb||eg||eR||eP),te=function(e){return(0,i._)(function(){var t;return(0,l._)(this,function(n){switch(n.label){case 0:if(t=e7)return[3,2];return[4,e5()];case 1:t=!n.sent(),n.label=2;case 2:if(t)return[2];if(!eV.includes(ex[e]))return[3,4];return[4,te(e+1)];case 3:case 6:return n.sent(),[2];case 4:return n.trys.push([4,6,,7]),eG(e),[4,eE()];case 5:return n.sent(),[3,7];case 7:return[2]}})})()},tt=eU>0;return(0,n.jsx)(x.PublishInputContext.Provider,{value:es,children:(0,n.jsxs)(el.Surface,{css:ey.rootContainer,background:"default",dataCy:"publish-form-container",children:[(0,n.jsxs)(J.View,{css:ey.formContainer,p:16,gap:12,children:[(0,n.jsx)(X.Text,{variant:"subheadBig",multiline:!1,children:eO?"Edit publish settings":"Publish template"}),(0,n.jsxs)(em,{onSubmit:function(e){return(0,i._)(function(){var t,n,r,i,o,a;return(0,l._)(this,function(s){switch(s.label){case 0:if(e.preventDefault(),!ez)return[3,13];t=!0,n=!1,r=void 0,s.label=1;case 1:s.trys.push([1,6,7,8]),i=ex[Symbol.iterator](),s.label=2;case 2:if(t=(o=i.next()).done)return[3,5];return[4,e4[o.value].isValid()];case 3:if(!s.sent())return[2];s.label=4;case 4:return t=!0,[3,2];case 5:return[3,8];case 6:return a=s.sent(),n=!0,r=a,[3,8];case 7:try{t||null==i.return||i.return()}finally{if(n)throw r}return[7];case 8:if(eO)return[3,10];return[4,eA()];case 9:return s.sent(),eq({show:!0,isUpdate:!1}),[3,12];case 10:return[4,eE()];case 11:s.sent(),eq({show:!0,isUpdate:!0}),s.label=12;case 12:return[3,14];case 13:te(eU+1),s.label=14;case 14:return[2]}})})()},css:ey.form,children:[(0,n.jsx)(J.View,{row:!0,gap:4,align:"center",children:ex.map(function(e,t){return eV.includes(e)?null:(0,n.jsxs)(u.Fragment,{children:[0!==t&&(0,n.jsx)(m.FormHeadingSpacer,{}),(0,n.jsx)(m.FormHeadingButton,{isActive:eU===t,isComplete:eY[t],onClick:function(){return te(t)},disabled:e7,children:e})]},e)})}),(0,n.jsxs)(J.View,{grow:!0,shrink:!0,children:["Basics"===e$&&(0,n.jsx)(w.BasicsSection,{}),"Icon"===e$&&(0,n.jsx)(_.IconUrlSection,{}),"Cover page"===e$&&(0,n.jsx)(k.CoverPageSection,{fs:eM}),"Layout"===e$&&(0,n.jsx)(C.TemplateLayoutSection,{getCurrentLayoutState:en}),"Publishing"===e$&&(0,n.jsx)(S.PublishingSection,{})]}),(0,n.jsxs)(J.View,{children:[ez&&e6&&e6!==e$?(0,n.jsx)(Q.StatusBanner,{colorway:"negative",icon:(0,n.jsx)(ee.default,{}),text:"Please fix error in ".concat(e6," section")}):null,eI?(0,n.jsx)(Q.StatusBanner,{colorway:"negative",icon:(0,n.jsx)(ee.default,{}),text:eI}):null,eD?(0,n.jsx)(Q.StatusBanner,{colorway:"negative",icon:(0,n.jsx)(ee.default,{}),text:eD}):null]}),(0,n.jsxs)(J.View,{css:[tt?W.rcss.justify.spaceBetween:W.rcss.justify.end],row:!0,gap:8,align:"center",children:[tt?(0,n.jsx)(K.Button,{type:"button",iconLeft:(0,n.jsx)(ed.default,{}),disabled:e7,onClick:function(){return te(eU-1)},text:"Back"}):null,eR?(0,n.jsx)(J.View,{css:ey.loadingContainer,row:!0,gap:4,children:(0,n.jsx)(ep.default,{})}):null,(0,n.jsxs)(eu.Tooltip,{tooltip:e9,placement:"bottom",isDisabled:!e9,children:[!ez&&(0,n.jsx)(K.Button,{type:"submit",colorway:"primary",iconLeft:(0,n.jsx)(ef.default,{}),disabled:e7,text:"Next",dataCy:"publish-form-next-button"}),ez&&!eO?(0,n.jsx)(K.Button,{type:"submit",colorway:"primary",css:ey.submitButton,iconLeft:eP?(0,n.jsx)(ep.default,{}):(0,n.jsx)(eh.default,{}),disabled:!!(e7||e6),text:"Submit",dataCy:"publish-form-publish-button"}):null,ez&&eO?(0,n.jsx)(K.Button,{type:"submit",colorway:"primary",iconLeft:eP?(0,n.jsx)(ep.default,{}):(0,n.jsx)(eh.default,{}),disabled:!!(e7||e6),text:"Save"}):null]})]})]})]}),(0,n.jsx)(ev,{user:Z})]})})}var ew=e.i(877249),ek=(0,H.cssRecord)({loadingContainer:[W.rcss.center,W.rcss.p(32),W.rcss.width(512),(0,t._)({},"@media (max-width: ".concat(ew.BREAKPOINTS.tabletMin,"px)"),[{width:"100%"}])],errorContainer:[W.rcss.center,W.rcss.p(32)]});function e_(e){var t,i,o=e.replId,a=e.source,s=e.getDesktopLayoutState,l=(0,r.usePublishCurrentUserQuery)(),u=(null==(i=l.data)||null==(t=i.currentUser)?void 0:t.__typename)==="CurrentUser"?l.data.currentUser:null;return l.loading?(0,n.jsx)(J.View,{css:ek.loadingContainer,children:(0,n.jsx)(ep.default,{})}):l.error||!u?(0,n.jsx)(J.View,{css:ek.errorContainer,children:(0,n.jsx)(X.Text,{multiline:!1,children:"Something went wrong, please try again."})}):(0,n.jsx)(eb,{source:a,replId:o,currentUser:u,getDesktopLayoutState:s})}e.s(["default",()=>e_],598801);var eS=e.i(409823),eC=e.i(368964),ej=e.i(549194),eT=e.i(761201),eE=e.i(205104),eR=e.i(322823),eI=e.i(992193),eA=e.i(951262);function eP(){var e=(0,L._)(["\n  mutation RevertTemplateRelease($input: RevertReplReleaseInput!) {\n    revertReplRelease(input: $input) {\n      ... on Repl {\n        id\n      }\n      ... on UserError {\n        message\n      }\n      ... on NotFoundError {\n        message\n      }\n      ... on UnauthorizedError {\n        message\n      }\n    }\n  }\n"]);return eP=function(){return e},e}var eD={},eO=(0,B.gql)(eP()),eN=e.i(590985);function eM(){var e=(0,L._)(["\n  query PendingChanges($replId: String!) {\n    getRepl(id: $replId) {\n      ... on Repl {\n        id\n        deployment {\n          id\n          activeRelease {\n            id\n            pendingChanges {\n              fileName\n              changeType\n            }\n          }\n        }\n      }\n    }\n  }\n"]);return eM=function(){return e},e}var eL={},eB=(0,B.gql)(eM()),eV=e.i(428596),eF=e.i(127227),eU=e.i(607278),eG=e.i(630818),e$=J.SpecializedView.form;function ez(e){if(0===e.length)return{message:"You cannot leave this empty."}}function eH(e){var t,r,i=e.changeType;return i===eC.ReplFileChangeType.NewFile?(t=es.tokens.accentPositiveStronger,r="Added"):i===eC.ReplFileChangeType.DeletedFile?(t=es.tokens.accentNegativeStronger,r="Deleted"):(t=es.tokens.foregroundDefault,r="Changed"),(0,n.jsx)(X.Text,{variant:"small",css:[{color:t}],multiline:!1,children:r})}var eW=(0,H.cssRecord)({loadingContainer:[W.rcss.center],container:[{display:"grid",gridTemplateColumns:"1fr 1fr",gap:es.tokens.space8}]});function eq(e){var t=e.pendingChangesState,r=e.isReplitTemplate;if(t.loading)return(0,n.jsx)(J.View,{css:eW.loadingContainer,children:(0,n.jsx)(ep.default,{})});if(t.error)return(0,n.jsx)(Q.StatusBanner,{icon:(0,n.jsx)(ee.default,{}),text:t.error.message||"Could not load modified files - please try again.",colorway:"negative"});if(!t.pendingChanges||0===t.pendingChanges.length)return r?null:(0,n.jsx)(X.Text,{children:"No file changes to publish."});var i=t.pendingChanges,o=i.slice(0,15);return(0,n.jsxs)(J.View,{css:eW.container,children:[o.map(function(e){return(0,n.jsxs)(u.Fragment,{children:[(0,n.jsxs)(J.View,{row:!0,gap:4,align:"center",children:[(0,n.jsx)(eG.default,{size:12,path:e.fileName}),(0,n.jsx)(X.Text,{multiline:!1,children:e.fileName})]},e.fileName),(0,n.jsx)(eH,{changeType:e.changeType})]},e.fileName)}),i.length>o.length&&(0,n.jsxs)(X.Text,{multiline:!1,children:["And ",i.length-o.length," other files..."]})]})}var eK=(0,H.cssRecord)({header:[W.rcss.mb(16)],grid:[{display:"grid",gridTemplateColumns:"2fr 3fr 1fr",gap:es.tokens.space8}],activeLabel:[W.rcss.p(4),{display:"flex"}]});function eY(e){var t,r,a,c,d=e.repl,f=(c=(a=(0,s._)((t={refetchQueries:["ReplEnvironmentHeader"]},r=(0,o._)({},eD,t),eA.useMutation(eO,r)),2))[0],{revertTemplateRelease:function(e){return(0,i._)(function(e){var t;return(0,l._)(this,function(n){switch(n.label){case 0:return[4,c({variables:{input:e.input}})];case 1:return[2,{data:(t=n.sent()).data,error:function(e){if(!e.data)return null;var t=e.data;if("revertReplRelease"in t){if("NotFoundError"===t.revertReplRelease.__typename||"UnauthorizedError"===t.revertReplRelease.__typename||"UserError"===t.revertReplRelease.__typename)return t.revertReplRelease.message;else if("Repl"!==t.revertReplRelease.__typename)return"Something went wrong reverting your Template"}}(t)}]}})}).apply(this,arguments)},state:a[1]});return(0,n.jsxs)(J.View,{children:[(0,n.jsx)(X.Header,{level:1,variant:"subheadBig",css:eK.header,children:"Existing Releases"}),(0,n.jsx)(J.View,{css:eK.grid,children:d.releases.items.map(function(e){var t,r;return(0,n.jsxs)(u.Fragment,{children:[(0,n.jsx)("span",{children:(0,eS.default)(new Date(e.timeCreated),"do MMM, hh:mm a")}),(0,n.jsx)("span",{children:e.description}),(0,n.jsx)("span",{style:{justifySelf:"end"},children:e.id===(null==(r=d.deployment)||null==(t=r.activeRelease)?void 0:t.id)?(0,n.jsx)("span",{css:eK.activeLabel,children:"(active)"}):(0,n.jsx)(K.Button,{text:"revert",colorway:"primary",size:"small",onClick:function(){var t;t=e.id,(0,i._)(function(){return(0,l._)(this,function(e){switch(e.label){case 0:return[4,f.revertTemplateRelease({input:{replId:d.id,releaseId:t}})];case 1:return e.sent(),[2]}})})()}})})]},e.id)})})]})}var eQ=(0,H.cssRecord)({container:[W.rcss.colWithGap(24),W.rcss.p(16)],descriptionLabel:[W.rcss.color.foregroundDimmer,{fontSize:es.tokens.fontSizeSmall,lineHeight:es.tokens.lineHeightSmall}],descriptionInput:[W.rcss.width("100%"),W.rcss.minHeight(64),W.rcss.maxHeight(128),{resize:"vertical"}]});function eX(e){var r,c,p,h,g,m,x,b,w,k,_,S,j=e.repl,T=e.getDesktopLayoutState,E=(0,eV.useIdSeed)(),R=(0,s._)((0,u.useState)(!1),2),I=R[0],A=R[1],P=(0,s._)((0,u.useState)(!1),2),D=P[0],O=P[1],N=(g=function(e){var t,n,r,i,a=(r={variables:{replId:e.replId},fetchPolicy:"cache-and-network",ssr:!1},i=(0,o._)({},eL,r),V.useQuery(eB,i)),s=a.data,l=a.loading,u=a.error;if(l)return{loading:l,pendingChanges:null,error:null};if(u)return{loading:!1,pendingChanges:null,error:u};var c=(null==s?void 0:s.getRepl.__typename)==="Repl"?s.getRepl:null;return c?{loading:!1,pendingChanges:(null==(n=c.deployment)||null==(t=n.activeRelease)?void 0:t.pendingChanges)||[],error:u}:{loading:!1,pendingChanges:null,error:Error("Repl not found")}}({replId:{replId:j.id}.replId}),m=(0,u.useMemo)(function(){return g.pendingChanges?g.pendingChanges.slice().sort(function(e,t){return e.fileName.localeCompare(t.fileName)}).map(function(e){return{file:e,pathDepth:(0,eE.getPathDepth)(e.fileName)}}).sort(function(e,t){return e.pathDepth-t.pathDepth}).map(function(e){return e.file}):[]},[g.pendingChanges]),(0,a._)((0,o._)({},g),{pendingChanges:m})),M=(0,eI.useCreateTemplateRelease)(),L=(0,eR.useFormField)("",ez),B=(null==(x=N.pendingChanges)?void 0:x.length)!==0,F=(null==(b=j.user)?void 0:b.username)===eT.OFFICIAL_TEMPLATE_USERNAME||(null==(w=j.user)?void 0:w.username)==="templates",U=(0,s._)((0,u.useState)({ran:!1,tested:!1}),2),G=U[0],$=U[1],z=(0,f.useIsMobile)({tablet:!0}),H=(0,d.useFlag)({type:"boolean",controlName:"flag-template-layout-author"}),W=!z&&H&&null!=T,q=(0,s._)((r=j,p=(c=(0,s._)((0,u.useState)(r.releases.items[0]),2))[0],h=c[1],(0,u.useEffect)(function(){r.releases.items.length>0&&h(r.releases.items.slice().sort()[0])},[r.releases.items]),[p,h]),2),Y=q[0],Z=q[1],et=(null==Y?void 0:Y.initialLayoutState)!=null,en=(0,eR.useFormField)(et?eN.TemplateLayoutKind.Saved:eN.TemplateLayoutKind.Default,function(){}),er=et?en.value!==eN.TemplateLayoutKind.Saved:en.value!==eN.TemplateLayoutKind.Default,ei=B||er;(0,u.useEffect)(function(){$({ran:!1,tested:!1})},[$]);var eo=!!(L.error||M.loading||!F&&!ei||F&&(!G.ran||!G.tested)),ea=F&&(null==(_=j.releases)||null==(k=_.items)?void 0:k.length)>1,es="";return(L.error?es="Please fill out the form":F||ei||(es="No file or layout changes to publish in this release"),I)?(0,n.jsx)(y.PublishedReplShareInfo,{repl:j}):D?(0,n.jsx)(J.View,{p:16,gap:16,children:(0,n.jsx)(eY,{repl:j})}):(0,n.jsxs)(e$,{onSubmit:function(e){return(0,i._)(function(){var t,n,r,i;return(0,l._)(this,function(o){switch(o.label){case 0:if(e.preventDefault(),eo||L.validate())return[2];return n=null,W&&(en.value===eN.TemplateLayoutKind.Current?n=T():en.value===eN.TemplateLayoutKind.Saved&&et&&(n=null==Y?void 0:Y.initialLayoutState)),[4,M.createRelease({input:{replId:j.id,description:L.value,initialLayoutState:n}})];case 1:if((r=o.sent()).error)return[2];return A(!0),(null==(t=r.data)?void 0:t.createReplRelease.__typename)==="Repl"&&(Z(i=r.data.createReplRelease.releases.items.slice().sort()[0]),en.setValue((null==i?void 0:i.initialLayoutState)!=null?eN.TemplateLayoutKind.Saved:eN.TemplateLayoutKind.Default)),[2]}})})()},css:eQ.container,children:[(0,n.jsx)(X.Header,{level:1,variant:"headerDefault",children:"Publish template changes"}),(0,n.jsxs)(J.View,{gap:8,children:[(0,n.jsx)(X.Header,{level:2,variant:"subheadDefault",children:"Modified files"}),(0,n.jsx)(eq,{pendingChangesState:N,isReplitTemplate:F})]}),W?(0,n.jsxs)(J.View,{gap:8,children:[(0,n.jsx)(X.Header,{level:2,variant:"subheadDefault",children:"Workspace layout"}),(0,n.jsx)(C.TemplateLayoutSelector,{getCurrentLayoutState:T,savedLayoutState:null==Y?void 0:Y.initialLayoutState,templateLayout:en})]}):null,F||ei?(0,n.jsxs)(J.View,{gap:4,children:[(0,n.jsx)("label",{htmlFor:E("description"),css:eQ.descriptionLabel,children:"Description"}),(0,n.jsx)(eU.MultiLineInput,{id:E("description"),"aria-label":"Description",onChange:function(e){return L.setValue(e.target.value)},css:eQ.descriptionInput,placeholder:"Explain what has changed about your template"}),L.error?(0,n.jsx)(Q.StatusBanner,{icon:(0,n.jsx)(ee.default,{}),text:null==(S=L.error)?void 0:S.message,colorway:"negative"}):null]}):null,F?(0,n.jsx)(eJ,{repl:j,state:G,onChange:function(e,n){return $(function(r){return(0,a._)((0,o._)({},r),(0,t._)({},e,n))})}}):null,(0,n.jsx)(J.View,{children:M.error?(0,n.jsx)(Q.StatusBanner,{icon:(0,n.jsx)(ee.default,{}),text:M.error,colorway:"negative"}):null}),(0,n.jsxs)(J.View,{row:!0,gap:12,justify:"end",children:[ea?(0,n.jsx)(K.Button,{text:"Revert to older",colorway:"negative",onClick:function(){return O(!0)}}):null,(0,n.jsx)(eu.Tooltip,{tooltip:es,placement:"bottom",isDisabled:!es,children:(0,n.jsx)(K.Button,{text:"Publish release",type:"submit",colorway:"primary",iconLeft:(0,n.jsx)(eh.default,{}),disabled:eo})})]})]})}function eJ(e){var t,r,i,o=e.repl,a=e.state,s=e.onChange,l=(0,eV.useIdSeed)(),u=(0,ej.usePublishReleaseFormCurrentUserQuery)(),c=u.data,d=u.loading,f=null==c||null==(t=c.currentUser)?void 0:t.username;return(0,n.jsxs)(J.View,{gap:12,children:[(0,n.jsx)(X.Header,{level:2,children:"Official Replit Template publishing checklist"}),(0,n.jsxs)(J.View,{children:[(0,n.jsxs)(eZ,{children:[(0,n.jsx)(eF.Checkbox,{id:l("ran"),checked:a.ran,onChange:function(e){return s("ran",e)}}),(0,n.jsx)("label",{htmlFor:l("ran"),children:"Ran Repl:"}),(0,n.jsxs)("span",{children:["I ran the Repl to generate and cache package guesser result into"," ",(0,n.jsx)("code",{children:".upm"}),"."]})]}),(0,n.jsxs)(eZ,{children:[(0,n.jsx)(eF.Checkbox,{id:l("tested"),checked:a.tested,onChange:function(e){return s("tested",e)}}),(0,n.jsx)("label",{htmlFor:l("tested"),children:"Ran tests:"}),(0,n.jsxs)("span",{children:['I ran "Test working copy" for @',null==(r=o.user)?void 0:r.username,"/",o.slug," in"," ",(0,n.jsx)("a",{href:"https://template-tester.replit.app/",target:"_blank",children:"template tester"}),". ",(0,n.jsx)("br",{}),"If there are no tests, consider adding one."]})]})]}),d||(null==(i=o.user)?void 0:i.username)!==f?null:(0,n.jsx)(Q.StatusBanner,{text:"You can't publish an update while impersonating. Add yourself as a member of the 'replit' team using CLUI tool 'add-remove-team-member', then open this Repl from your account.",colorway:"negative"})]})}function eZ(e){var t=e.children;return(0,n.jsx)(J.View,{py:2,row:!0,gap:8,children:t})}e.s(["default",()=>eX],157584)},654781,e=>{"use strict";var t=e.i(297083),n=e.i(530658),r=e.i(817556),i=e.i(389959),o=e.i(10581),a=e.i(529810),s=function(e){return e.escapeHatchGitExecWrite("git config --local core.sshCommand replit-git-ssh")};function l(){var e=(0,a.default)(),l=e.container,u=e.fs,c=e.git,d=(0,n._)((0,i.useState)({state:"loading"}),2),f=d[0],p=d[1];return(0,i.useEffect)(function(){(0,t._)(function(){var e;return(0,r._)(this,function(t){switch(t.label){case 0:return p({state:"loading"}),[4,c.getRepositoryState()];case 1:if((e=t.sent()).error&&p({state:"error",error:"Could not get repository status"}),e.error||e.state===o.GitRepositoryState.NOT_INITIALIZED)return p({state:"error",error:"Could not get repository status"}),[2];return[4,s(c)];case 2:if(t.sent().error)return p({state:"error",error:"Could not configure SSH"}),[2];return p({state:"finished",hasInstalled:!0}),[2]}})})()},[l,u,c]),f}e.s(["setGitSshConfigForWrapper",()=>s,"useInitProjectSshConfig",()=>l])},2342,209221,e=>{"use strict";var t,n=e.i(721281),r=e.i(878420),i=e.i(64386),o=e.i(530658),a=e.i(276385),s=e.i(389959),l=e.i(368964),u=e.i(921521),c=e.i(297083),d=e.i(817556),f=e.i(288645),p=e.i(825118),h=e.i(10581),g=e.i(903381),m=e.i(711153),x=e.i(98816),y=e.i(222342),b=e.i(207237),w=e.i(529810),k=e.i(529864),_=e.i(654781),S=e.i(480028),C=e.i(446530),j=e.i(613355),T=e.i(140487),E=e.i(887877),R=e.i(11235),I=e.i(396776),A=e.i(960178),P=e.i(625484),D=e.i(42458),O=(0,C.cssRecord)({dialog:[j.rcss.py(2),j.rcss.colWithGap(16)],reachOut:[j.rcss.border({direction:"top",color:S.tokens.outlineDimmest}),{marginInline:-16}]}),N=function(e){var t,n,r,i,u,S,C,j,N,M,L,B=e.repl,V=e.org,F=e.onRequestClose,U=e.onForkSeparately,G=(0,y.default)().showError,$=V.id,z=(0,o._)((0,m.default)({navigateAfterFork:!0,replLinkOptions:{initialPaneType:"project"},onFork:function(){F()},onError:function(){G("Error creating remixed app - please try again")}}),2),H=z[0],W=z[1].loading,q=(0,o._)((t=function(){var e,t,n;H({originId:B.id,teamId:null,title:null,description:null,isPrivate:!0,forkToPersonal:null,replReleaseId:null!=(n=null==(t=B.deployment)||null==(e=t.activeRelease)?void 0:e.id)?n:void 0,orgId:$,trackingData:{forkSource:"projectDialog",isOnboarding:!1,isApp:B.publishedAs===l.PublishedReplKind.App,isTemplate:B.publishedAs===l.PublishedReplKind.Template}})},r=(n=(0,w.default)()).git,i=n.fs,S=(u=(0,o._)((0,s.useState)({loading:!1,error:null,success:!1}),2))[0],C=u[1],j=(0,b.default)(),N=(0,o._)((0,f.useCreateProjectBeforeForkMutation)({}),1)[0],M=(0,x.default)(t),L=(0,o._)((0,f.useCreateProjectCheckForProjectLazyQuery)(),1)[0],[(0,s.useCallback)(function(e){return(0,c._)(function(){var t,n,o,a,s,l,u,c;return(0,d._)(this,function(d){switch(d.label){case 0:C({loading:!0,error:null,success:!1}),d.label=1;case 1:return d.trys.push([1,3,,4]),[4,L({variables:{id:j},fetchPolicy:"no-cache"})];case 2:if(!(n=d.sent().data)||"Repl"!==n.getRepl.__typename)throw Error("Please try again");if(null==(t=n.getRepl.project)?void 0:t.id)throw Error("This App is already part of a project");return[3,4];case 3:return C({loading:!1,error:"message"in(o=d.sent())?o.message:"Please try again",success:!1}),[2];case 4:return[4,r.init({includeAllInitialFiles:!0,initialCommit:!0})];case 5:if(!(a=d.sent()).error)return[3,11];if(a.error!==p.GitErrors.ALREADY_INITIALIZED)return[3,10];return[4,r.getRepositoryState()];case 6:if((s=d.sent()).error)return C({loading:!1,error:"Could not create Project - please try again",success:!1}),[2];if(s.state===h.GitRepositoryState.CLEAN)return[3,9];return[4,r.stageFiles({all:!0})];case 7:return d.sent(),[4,r.commit({message:"Initial project commit",allowEmpty:!1})];case 8:d.sent().error&&C({loading:!1,error:"Could not generate initial commit to create Project",success:!1}),d.label=9;case 9:return[3,11];case 10:return C({loading:!1,error:"Could not initialize a repository",success:!1}),[2];case 11:return[4,(0,_.setGitSshConfigForWrapper)(r)];case 12:return d.sent().error&&C({loading:!1,error:"Could not create Project, please try again",success:!1}),[4,i.flush()];case 13:return d.sent(),[4,i.persist({skipDebounce:!0})];case 14:if((l=d.sent()).error||!l.success)return C({loading:!1,error:"Could not initialize a repository",success:!1}),[2];return[4,new Promise(function(e){i.getStatus()===g.FsStatus.Clean?e():i.onStatusChange(function(t){if(t===g.FsStatus.Clean)return void e()})})];case 15:d.sent(),d.label=16;case 16:return d.trys.push([16,18,,19]),[4,N({variables:{input:{mainReplId:j,orgId:e}}})];case 17:if((c=d.sent()).errors||!(null==(u=c.data)?void 0:u.createProject))throw Error("Could not create project");if("Project"!==c.data.createProject.__typename)throw Error(c.data.createProject.message);return[3,19];case 18:return C({loading:!1,error:d.sent().message,success:!1}),[2];case 19:return C({loading:!1,error:null,success:!0}),M.current(),[2]}})})()},[r,i,j,N,M,L]),S]),2),K=q[0],Y=q[1];return(0,a.jsxs)(E.Form,{css:O.dialog,onSubmit:function(e){e.preventDefault(),(0,c._)(function(){return(0,d._)(this,function(e){return Y.loading||K($),[2]})})()},children:[(0,a.jsx)(A.Header,{level:1,variant:"subheadDefault",children:"Planning to merge your changes back into this App?"}),(0,a.jsx)(k.CreateProjectIllustration,{}),(0,a.jsxs)(P.View,{gap:8,children:[(0,a.jsx)(A.Text,{children:"Consider starting a Project  a set of connected Apps for better collaborative development and versioning. Within a Project, you can:"}),(0,a.jsx)(R.Prose,{children:(0,a.jsxs)("ul",{children:[(0,a.jsx)("li",{children:"Remix an App to work on a feature in isolation, and merge back when ready"}),(0,a.jsx)("li",{children:"View all ongoing development in one place"}),(0,a.jsxs)("li",{children:["Share secrets and configuration between remixed apps"," ",(0,a.jsx)(A.Text,{color:"dimmest",children:"(coming soon)"})]})]})})]}),Y.error?(0,a.jsx)(I.StatusBanner,{colorway:"negative",icon:(0,a.jsx)(D.default,{}),text:Y.error}):null,(0,a.jsxs)(P.View,{row:!0,gap:8,justify:"end",children:[(0,a.jsx)(T.Button,{loading:Y.loading||W,text:"Remix separately",onClick:function(){F(),U()}}),(0,a.jsx)(T.Button,{loading:Y.loading||W,text:"Remix & start a Project",colorway:"primary",type:"submit"})]}),(0,a.jsx)(P.View,{css:O.reachOut,pt:16,px:16,children:(0,a.jsxs)(A.Text,{color:"dimmest",children:["If you have questions or feedback, reach out to"," ",(0,a.jsx)("a",{href:"mailto:support@replit.com",children:"support@replit.com"})]})})]})},M=((t={}).DeleteRepl="DeleteRepl",t.TransferRepl="TransferRepl",t.PowerUp="PowerUp",t.UnpublishTemplate="UnpublishTemplate",t.EditPublishedTemplateSettings="EditPublishedTemplateSettings",t.PublishTemplate="PublishTemplate",t.UpdatePublishedTemplate="UpdatePublishedTemplate",t.Share="Share",t.FeatureRepl="FeatureRepl",t);e.s(["Dialogs",()=>M],209221);var L=e.i(993796),B=e.i(283023),V=e.i(90102),F=e.i(450565),U=e.i(940745),G=e.i(545124),$=e.i(902846),z=e.i(962008),H=e.i(703505),W=e.i(759097),q=e.i(700582),K=e.i(273042),Y=e.i(464092),Q=e.i(142685),X=e.i(341126),J=e.i(674918),Z=e.i(714165),ee=e.i(91720);function et(e){var t=e.repl,n=(0,u.default)(),o=(0,s.useMemo)(function(){if(t.org){var e;return{text:t.org.name,css:[{"&, & span":j.rcss.flex.shrink(1)}],iconLeft:(0,a.jsx)(Z.Avatar,{src:null!=(e=t.org.image)?e:null,username:t.org.name,fullName:t.org.name,size:24})}}return t.user?{text:t.user.username,css:[{"&, & span":j.rcss.flex.shrink(1)}],iconLeft:(0,a.jsx)(Z.Avatar,{src:t.user.image,username:t.user.username,size:24})}:{text:""}},[t]);if(!t.user||!t.org&&!t.user)return null;var l=t.org?(0,X.orgLinks)(t.org).repls:(0,J.userLinkProps)(t.user),c=t.org?(0,X.orgLinks)(t.org).repls.href.toString():(0,J.userLinkProps)(t.user).as;return n?(0,a.jsx)(T.Button,(0,i._)((0,r._)({},o),{size:"small",onClick:function(){Q.desktopAppApi.openExternalUrl(c)}})):(0,a.jsx)(ee.ButtonLink,(0,i._)((0,r._)({},o),{as:l.as,href:l.href,prefetch:!1,size:"small"}))}var en=e.i(88619),er=e.i(136540),ei=e.i(601059),eo=e.i(739521),ea=e.i(625041),es=e.i(751273),el=e.i(185591),eu=e.i(283110),ec=e.i(243914),ed=e.i(292642),ef=e.i(196353);function ep(e){var t,c,d,f,p,h,g,m,x,b,w,k,_,C=e.setActiveDialog,E=e.repl,R=e.showCloseButton,I=e.setIsEditing,D=e.updateReplInfo,O=(0,o._)((0,s.useState)(!1),2),Q=O[0],X=O[1],J=(0,u.default)(),Z=!!E.org&&E.org.type===l.OrgstypeEnumType.Team,ep=(0,Y.useForkContext)().fork,eh=(c=(t={repl:E,setShowProjectPrompt:X}).repl,d=t.setShowProjectPrompt,f=(0,Y.useForkContext)().fork,p=(0,K.useCheckForProject)(),g=(h=(0,y.default)()).showConfirm,m=h.showError,b=(x=(0,o._)((0,q.useCreateProjectFork)({onFork:function(){g("Repl forked, redirecting...")},onError:function(){m("Error creating fork - please try again")}}),2))[0],w=x[1].loading,{handleRemix:(0,s.useCallback)(function(){var e;(null==(e=c.org)?void 0:e.id)&&!p.loading?p.isEligibleForProject&&!p.hasProject?d(!0):p.hasProject?b({orgId:c.org.id,repl:c,forkSource:"replInfoHeader"}):f():f()},[c,f,p,b,d]),isCreatingProjectFork:w,fork:f}),eg=eh.handleRemix,em=function(e){var t=e.repl,n=e.isCreatingProjectFork,r=!!t.publishedAs,i=t.publishedAs===l.PublishedReplKind.Template,o=(0,u.default)(),s=!!t.org&&t.org.type===l.OrgstypeEnumType.Team,c=(0,L.useFlag)({controlName:"flag-olympic-torch",logFlagToAnalytics:!1}),d=[];t.authorizations.fork.isAuthorized&&d.push({value:"Remix",label:"Remix",icon:n?(0,a.jsx)(U.default,{}):(0,a.jsx)(F.default,{}),isDisabled:n});var f=t.authorizations.publish.isAuthorized;if(!o&&!s){var p=t.isPrivate||!t.isRenamed||!f,h="";t.isPrivate?h="Make App public to publish":t.isRenamed||(h="Rename App to publish"),null==t.publishedAs&&d.push({value:M.PublishTemplate,label:"Publish as Template",icon:(0,a.jsx)(z.default,{}),isDisabled:p,description:h,dataCy:"repl-info-header-settings-publish"}),i&&!p&&(d.push({value:M.UpdatePublishedTemplate,label:"Publish template changes",icon:(0,a.jsx)(W.default,{})}),d.push({value:M.UnpublishTemplate,label:"Unpublish Template",icon:(0,a.jsx)(V.default,{})})),r&&!p&&d.push({value:M.EditPublishedTemplateSettings,label:"Edit Template publish settings",icon:(0,a.jsx)(B.default,{})})}if(s){var g=t.isPrivate;d.push({value:M.FeatureRepl,label:t.isFeaturedRepl?"Remove from Featured Apps":"Feature on Profile",icon:(0,a.jsx)(G.default,{}),description:g?"Make App public to feature":"",isDisabled:g})}return t.authorizations.deleteRepl.isAuthorized&&(c&&d.push({isDestructive:!1,value:M.TransferRepl,label:"Transfer",icon:(0,a.jsx)($.default,{})}),d.push({isDestructive:!0,value:M.DeleteRepl,label:"Delete",icon:(0,a.jsx)(H.default,{})})),d}({repl:E,isCreatingProjectFork:eh.isCreatingProjectFork}),ev=E.publishedAs===l.PublishedReplKind.Template;return(0,a.jsxs)(P.View,{gap:8,p:8,children:[(0,a.jsxs)(P.View,{css:[(0,n._)({},j.media.max("mobileMax"),[j.rcss.flex.columnReverse,j.rcss.align.start,{gap:S.tokens.space8}])],row:!0,gap:8,align:"center",justify:"space-between",children:[(0,a.jsx)(P.View,{row:!0,gap:8,css:[j.rcss.center,j.rcss.flex.shrink(1)],children:(0,a.jsx)(et,{repl:E})}),(0,a.jsxs)(P.View,{css:[(0,n._)({},j.media.max("mobileMax"),{width:"100%",">*:not(div)":{flex:1}})],align:"center",row:!0,gap:8,children:[J?null:(0,a.jsx)(ee.ButtonLink,(0,i._)((0,r._)({size:"small",prefetch:!1},(0,el.replViewLinkProps)(E)),{iconRight:(0,a.jsx)(ec.default,{}),colorway:"primary",text:"Cover page",target:"_blank",style:{pointerEvents:"auto"}})),ev||J||Z?null:(0,a.jsx)(es.Tooltip,{tooltip:"Make Repl public to share",isDisabled:!E.isPrivate,children:(0,a.jsx)(T.Button,{size:"small",type:"button",iconLeft:(0,a.jsx)(W.default,{}),onClick:function(){C(M.Share)},text:"Share",disabled:E.isPrivate})}),J?(0,a.jsx)(en.CopyButton,{textToCopy:window.location.href,tooltipText:"Copy App URL",tooltipSuccessText:"Copied!",iconLeft:(0,a.jsx)(ed.default,{}),text:""}):null,em.length>0&&(0,a.jsx)(ei.PopupMenu,{dataCy:"repl-info-header-settings",trigger:(0,a.jsx)(er.IconButton,{alt:"More options",size:32,children:(0,a.jsx)(ef.default,{size:16})}),"aria-label":"More options",onAction:function(e){switch(e){case"Remix":return void eg();case M.UpdatePublishedTemplate:C(M.UpdatePublishedTemplate);return;case M.UnpublishTemplate:C(M.UnpublishTemplate);return;case M.DeleteRepl:C(M.DeleteRepl);return;case M.TransferRepl:C(M.TransferRepl);return;case M.EditPublishedTemplateSettings:C(M.EditPublishedTemplateSettings);return;case M.PublishTemplate:C(M.PublishTemplate);return;case M.FeatureRepl:C(M.FeatureRepl);return}},children:em.map(function(e){return(0,a.jsx)(ei.MenuItem,{id:e.value,label:e.label,icon:e.icon,isDestructive:e.isDestructive,isDisabled:e.isDisabled,description:e.description,dataCy:e.dataCy},e.value)})}),R?(0,a.jsx)(er.IconButton,{alt:"Close",tooltipBehavior:"hidden",onClick:function(){D(),I(!1)},children:(0,a.jsx)(eu.default,{})}):null]})]}),(null==(k=E.org)?void 0:k.type)===l.OrgstypeEnumType.Team&&(null==(_=E.user)?void 0:_.__typename)==="User"?(0,a.jsxs)(P.View,{gap:8,align:"start",children:[(0,a.jsxs)(A.Text,{variant:"small",color:"dimmest",children:["Created by @",E.user.username]}),E.config.grabbyExtensionVersion?(0,a.jsx)(es.Tooltip,{tooltip:"Imported with Grabby v".concat(E.config.grabbyExtensionVersion),children:(0,a.jsx)(ea.PillLink,{text:"Imported with Grabby",href:"/grab",target:"_blank"})}):null]}):null,Q&&E.org?(0,a.jsx)(eo.Modal,{isOpen:!0,onRequestClose:function(){return X(!1)},children:(0,a.jsx)(N,{repl:E,org:E.org,onRequestClose:function(){return X(!1)},onForkSeparately:ep})}):null]})}e.s(["ReplInfoHeader",()=>ep],2342)},759967,e=>{"use strict";var t=e.i(541793),n=e.i(852819),r=(0,t.atom)(void 0);function i(){return(0,n.useValue)(r)}function o(){return(0,n.useSet)(r)}e.s(["useIsExpertMode",()=>i,"useSetIsExpertMode",()=>o])},740616,e=>{"use strict";var t=e.i(878420),n=e.i(64386),r=e.i(530658),i=e.i(276385),o=e.i(399528),a=e.i(389959),s=e.i(906368),l=e.i(368964),u=e.i(737362),c=e.i(452412),d=e.i(921521),f=e.i(993796),p=e.i(98816),h=e.i(222342),g=e.i(207237),m=e.i(213733),x=e.i(858248),y=e.i(709485),b=e.i(973519),w=e.i(341126),k=e.i(49578),_=e.i(445016),S=e.i(773240),C=e.i(598801),j=e.i(701366),T=e.i(157584),E=e.i(905282),R=e.i(236379),I=e.i(420802),A=e.i(2342),P=e.i(209221),D=e.i(759967),O=e.i(446530),N=e.i(613355),M=e.i(428596),L=e.i(965153),B=e.i(140487),V=e.i(607278),F=e.i(739521),U=e.i(624782),G=e.i(929872),$=e.i(960178),z=e.i(625484),H=e.i(464092),W=e.i(836224),q=e.i(151902),K=e.i(341190),Y=e.i(654647),Q=e.i(569910),X=e.i(714165),J=e.i(85742),Z=e.i(12034),ee=(0,O.cssRecord)({header:[N.rcss.fontWeight.medium,N.rcss.p(4),N.rcss.color.foregroundDimmer]}),et=function(e){var t,n,r,o=e.item;switch(o.__typename){case"CurrentUser":case"Team":t=o.username,n=o.image;break;case"Org":t=o.name,n=null!=(r=o.image)?r:null;break;default:(0,Q.default)(o)}return(0,i.jsx)(J.ListBoxItem,{id:o.id,label:t,icon:(0,i.jsx)(X.Avatar,{src:n,size:16,username:t,isOrg:"Org"===o.__typename})},o.id)};let en=function(e){var t=e.id,n=e.owners,r=e.selectedOwner,o=e.disabled,a=e.setSelectedOwner,s=e.dataCy,l=n.filter(function(e){return"CurrentUser"===e.__typename}),u=n.filter(function(e){return"Org"===e.__typename}),c=n.filter(function(e){return"Team"===e.__typename}),d=(0,f.useFlag)({controlName:"flag-pringle-krew",default:!1});return(0,i.jsxs)(Z.Select,{id:t,dataCy:s,"aria-labelledby":t,defaultSelectedKey:r.id,onSelectionChange:function(e){var t=n.find(function(t){return t.id===e});t&&a(t)},isDisabled:o,children:[l.length>0?(0,i.jsxs)(Y.ListBoxSection,{children:[(0,i.jsx)(K.Header,{css:ee.header,children:"Personal"}),l.map(function(e){return(0,i.jsx)(et,{item:e},e.id)})]}):null,u.length>0?(0,i.jsxs)(Y.ListBoxSection,{children:[(0,i.jsx)(K.Header,{css:ee.header,children:"Organizations"}),u.map(function(e){return(0,i.jsx)(et,{item:e},e.id)})]}):null,d&&c.length>0?(0,i.jsxs)(Y.ListBoxSection,{children:[(0,i.jsx)(K.Header,{css:ee.header,children:"Teams"}),c.map(function(e){return(0,i.jsx)(et,{item:e},e.id)})]}):null]})};var er=e.i(262522),ei=e.i(396776),eo=e.i(552144),ea=e.i(940745),es=e.i(902846),el=e.i(42458),eu=z.SpecializedView.form,ec=(0,O.cssRecord)({form:[N.rcss.colWithGap(24)]}),ed=function(e){var t,n,o,s=e.currentUser,l=e.repl,u=e.onDone,c=e.onCancel,d=l.owner?l.owner:l.org,f=null!=(o=null==(t=l.owner)?void 0:t.username)?o:null==(n=l.org)?void 0:n.slug,p=f?"".concat(f,"/").concat(l.slug):l.slug,h=(0,r._)((0,er.useOwner)(s,null==d?void 0:d.id),3),g=h[0],m=h[1],x=h[2],y=(0,r._)((0,a.useState)(""),2),b=y[0],w=y[1],k=b===p,_=(0,M.useIdSeed)();return(0,i.jsx)(eu,{css:ec.form,onSubmit:function(e){e.preventDefault(),k&&(alert("Beep boop would transfer Repl, redirecting"),u())},children:(0,i.jsxs)(z.View,{gap:16,children:[(0,i.jsx)($.Text,{children:"Transfer this Repl to another account or organization."}),(0,i.jsx)(eo.StatusBannerButton,{colorway:"grey",text:"Transferring ownership might result in losing some features, depending on the subscription status of the selected organization. Click here for more details.",iconLeft:(0,i.jsx)(el.default,{}),href:"https://docs.replit.com/teams/collaboration-on-replit#transferring-repls-to-organizations",target:"_blank"}),(0,i.jsxs)(z.View,{gap:4,children:[(0,i.jsx)("label",{htmlFor:_("owner"),children:(0,i.jsx)($.Text,{color:"dimmer",variant:"small",children:"New Owner"})}),(0,i.jsx)(en,{id:_("owner"),owners:x,selectedOwner:g,setSelectedOwner:m})]}),(0,i.jsx)(ei.StatusBanner,{colorway:"negative",text:"You do not have permission to transfer this Repl."}),(0,i.jsxs)(z.View,{gap:4,children:[(0,i.jsx)("label",{htmlFor:_("confirmName"),children:(0,i.jsxs)($.Text,{color:"dimmer",variant:"small",children:["Type the name ",p," to delete"]})}),(0,i.jsx)(V.Input,{id:_("confirmName"),disabled:!1,autoFocus:!0,value:b,onChange:function(e){return w(e.currentTarget.value)}})]}),(0,i.jsxs)(z.View,{row:!0,gap:12,justify:"end",children:[(0,i.jsx)(B.Button,{type:"button",onClick:c,text:"Cancel"}),(0,i.jsx)(B.Button,{type:"submit",disabled:!k,iconLeft:(0,i.jsx)(es.default,{}),colorway:"negative",text:"Yes, transfer this Repl"})]})]})})},ef=function(e){var t=e.repl,n=e.onDone,r=e.onCancel,o=(0,q.useTransferReplDialogQuery)().data,a=null==o?void 0:o.currentUser;return(0,i.jsxs)(z.View,{gap:24,children:[(0,i.jsxs)($.Header,{variant:"subheadBig",level:2,children:["Transfer ",t.title]}),a?(0,i.jsx)(ed,{currentUser:a,repl:t,onDone:n,onCancel:r}):(0,i.jsx)(z.View,{align:"center",children:(0,i.jsx)(ea.default,{})})]})},ep=(0,O.cssRecord)({loadingRoot:[N.rcss.center,N.rcss.p(16)],root:{overflow:"auto",maxHeight:"80vh"},form:[N.rcss.p(8)]}),eh=function(e){var t=e.isExpertModeAllowed,n=(0,D.useIsExpertMode)(),r=(0,D.useSetIsExpertMode)(),o=(0,b.useGlobalModal)().show,a=(0,h.default)().showConfirm,s=(0,f.useFlag)({controlName:"flag-agent-everywhere"}),l=(0,f.useFlag)({controlName:"flag-toggle-expert"});if(!t||!s||!l)return null;var u=function(e){e?(a("Custom Stack disabled"),r(!n)):o("ExpertModeModal",{onConfirm:function(){a("Custom Stack enabled"),r(!n)}})};return(0,i.jsx)(L.AccordionItem,{headerContent:(0,i.jsxs)(z.View,{p:4,row:!0,justify:"space-between",align:"center",gap:8,children:[(0,i.jsx)($.Text,{children:"Custom Stack"}),(0,i.jsx)(U.Pill,{text:"Advanced"})]}),children:(0,i.jsxs)(z.View,{px:8,pb:8,pt:4,gap:8,children:[(0,i.jsx)($.Text,{variant:"small",children:"With Custom Stack enabled, Agent has fewer restrictions, allowing you to work with any language or framework."}),(0,i.jsx)(B.Button,{text:n?"Disable Custom Stack":"Enable Custom Stack",onClick:function(){return u(null!=n&&n)},stretch:!0,type:"button"})]})})};function eg(e){var t=e.getDesktopLayoutState,n=e.setIsEditing,r=e.showCloseButton,o=(0,g.default)(),a=(0,u.useWorkspaceHeaderReplInfoQuery)({variables:{replId:o}}).data,s=(null==a?void 0:a.getRepl.__typename)==="Repl"?a.getRepl:null;return s?(0,i.jsx)(ev,{getDesktopLayoutState:t,setIsEditing:n,showCloseButton:r,repl:s}):(0,i.jsx)(z.View,{css:ep.loadingRoot,children:(0,i.jsx)(ea.default,{})})}var em=[l.ReplWorkspaceCta.Submit,l.ReplWorkspaceCta.PublishTemplate,l.ReplWorkspaceCta.EditTemplate];function ev(e){var f,g,D,O,L,B,U,q=e.repl,K=e.getDesktopLayoutState,Y=e.showCloseButton,Q=e.setIsEditing,X=(0,o.useRouter)(),J=(0,d.default)(),Z=(0,r._)((0,a.useState)(null),2),ee=Z[0],et=Z[1],en=(0,r._)((0,a.useState)(q.isRenamed?q.title:""),2),er=en[0],ei=en[1],eo=(0,r._)((0,a.useState)(q.description||""),2),ea=eo[0],es=eo[1],el=(0,r._)((0,a.useState)(q.rawTemplateLabel),2),eu=el[0],ec=el[1],ed=(0,b.useGlobalModal)().show,eg=(0,h.default)().showError,ev=q.publishedAs===l.PublishedReplKind.Template,ex=(null==(f=q.org)?void 0:f.type)!=="team"&&(q.authorizations.editVisibility.isAuthorized||q.authorizations.editVisibility.code===l.ReplAuthorizationCode.RequiresActiveSubscription);(0,a.useEffect)(function(){es(q.description||"")},[q.description]);var ey=(0,a.useRef)(q),eb=(0,r._)((0,u.useWorkspaceHeaderReplInfoDeleteReplMutation)({variables:{id:q.id},onCompleted:function(){var e;if(J)return void X.push("/desktopApp/home");if((null==(e=q.org)?void 0:e.type)==="team"){var t=(0,w.orgLinks)(q.org);X.push(t.home.href);return}X.push("/home","/~")},update:function(e,t){var n;(null==(n=t.data)?void 0:n.deleteRepl)&&(e.evict({id:e.identify(t.data.deleteRepl)}),e.gc())},onError:function(e){return eg((0,m.default)(e.message))}}),2),ew=eb[0],ek=eb[1].loading,e_=(0,r._)((0,u.useWorkspaceHeaderReplInfoUpdateReplMutation)({onError:function(e){return eg((0,m.default)(e.message))},onCompleted:function(e){var t=e.updateRepl.repl,n=ey.current,r={};n.description!==t.description&&(r.description=t.description),n.title!==t.title&&(r.title=t.title),n.url!==t.url&&(r.url=t.url,window.history.replaceState(null,"",t.url+window.location.search+window.location.hash)),n.isRenamed!==t.isRenamed&&(r.isRenamed=!!t.isRenamed),ey.current=q,Object.keys(r).length>0&&Q(!1)}}),2),eS=e_[0],eC=e_[1].loading,ej=(0,r._)((0,u.useWorkspaceHeaderReplInfoUnpublishTemplateMutation)({variables:{input:{replId:q.id}},onError:function(e){s.captureException(e),eg((0,m.default)(e.message))}}),2),eT=ej[0],eE=ej[1],eR=(0,a.useMemo)(function(){return!!er&&er!==q.title||eu!==q.rawTemplateLabel||(""!==ea||!!q.description)&&ea!==q.description},[q,er,ea,eu]),eI=(0,p.default)(eR),eA=(0,a.useCallback)(function(){eR&&eS({variables:{input:{id:q.id,title:er.trim()||q.title,description:ea,templateLabel:q.authorizations.editTemplateMetadata.isAuthorized?eu:void 0}}})},[eR,eS,q,er,ea,eu]),eP=(0,p.default)(eA);(0,a.useLayoutEffect)(function(){return function(){eI.current&&eP.current()}},[eP,eI]);var eD=function(){eS({variables:{input:{id:q.id,isPrivate:!q.isPrivate}},optimisticResponse:{__typename:"RootMutationType",updateRepl:{__typename:"UpdateReplPayload",repl:(0,n._)((0,t._)({},q),{isPrivate:!q.isPrivate})}}}),(0,x.track)(y.events.PRIVATE_TOGGLED,{enabled:!q.isPrivate,source:"workspace_info_modal"})},eO=q.isRenamed?"Name your App":"Default name: ".concat(q.title),eN=em.includes(q.workspaceCta),eM=(0,M.useIdSeed)(),eL=(null==(g=q.owner)?void 0:g.__typename)==="Team";return(0,i.jsxs)("div",{css:ep.root,"data-can-change-description":q.authorizations.editMetadata.isAuthorized,children:[(0,i.jsx)(H.ForkContextProvider,{forkParams:{trackingData:{forkSource:"editReplPopoverMenuItem"}},repl:q,children:(0,i.jsx)(A.ReplInfoHeader,{repl:q,showCloseButton:Y,setActiveDialog:et,setIsEditing:Q,updateReplInfo:eA})}),(0,i.jsx)("form",{css:ep.form,onSubmit:function(e){e.preventDefault(),eA()},children:(0,i.jsxs)(z.View,{align:"stretch",gap:16,children:[(0,i.jsxs)(G.Surface,{background:"default",gap:16,children:[(0,i.jsx)(z.View,{children:(0,i.jsxs)(z.View,{gap:4,children:[(0,i.jsxs)(z.View,{row:!0,justify:"space-between",align:"end",children:[(0,i.jsx)("label",{htmlFor:eM("name"),children:(0,i.jsx)($.Text,{variant:"small",color:"dimmer",multiline:!1,children:"Name"})}),(0,i.jsx)(W.default,{maxLength:60,value:er,hideLabel:!0})]}),(0,i.jsx)(V.Input,{style:{cursor:q.authorizations.editMetadata.isAuthorized?"auto":"not-allowed"},disabled:!q.authorizations.editMetadata.isAuthorized,maxLength:60,placeholder:eO,value:er,onChange:function(e){return ei(e.target.value)},spellCheck:!1,id:eM("name"),dataCy:"ws-repl-info-title-input"})]})}),(0,i.jsx)(z.View,{children:(0,i.jsxs)(z.View,{gap:4,children:[(0,i.jsxs)(z.View,{row:!0,justify:"space-between",align:"end",children:[(0,i.jsx)("label",{htmlFor:eM("description"),children:(0,i.jsx)($.Text,{variant:"small",color:"dimmer",multiline:!1,children:"Description"})}),(0,i.jsx)(W.default,{maxLength:I.REPL_DESCRIPTION_MAX_LENGTH,value:ea,hideLabel:!0})]}),(0,i.jsx)(V.MultiLineInput,{disabled:!q.authorizations.editMetadata.isAuthorized,maxLength:I.REPL_DESCRIPTION_MAX_LENGTH,value:ea,onChange:function(e){return es(e.target.value)},placeholder:"What does this App do?",css:[N.rcss.minHeight(96),N.rcss.maxHeight(256),{resize:"vertical"}],id:eM("description")})]})})]}),ev&&q.authorizations.editTemplateMetadata.isAuthorized?(0,i.jsx)(G.Surface,{background:"default",gap:4,children:(0,i.jsxs)(z.View,{gap:4,children:[(0,i.jsx)("label",{htmlFor:eM("template"),children:(0,i.jsx)($.Text,{color:"dimmer",variant:"small",multiline:!1,children:"Template label"})}),(0,i.jsx)(V.Input,{value:eu,maxLength:60,placeholder:"Template label",spellCheck:!1,onChange:function(e){return ec(e.target.value)},id:eM("template")})]})}):null]})}),eN?null:(0,i.jsxs)(z.View,{gap:24,p:8,children:[(0,i.jsxs)(z.View,{gap:24,children:[(0,i.jsx)(_.default,{replId:q.id,authz:q.authorizations.editMetadata,initialIconUrl:q.iconUrl,originIconUrl:null==(D=q.templateInfo)?void 0:D.iconUrl}),(0,i.jsx)(k.default,{replId:q.id,authz:q.authorizations.editMetadata,initialImageUrl:null!=(U=q.imageUrl)?U:null==(O=q.templateInfo)?void 0:O.imageUrl,originImageUrl:null==(L=q.templateInfo)?void 0:L.imageUrl})]}),ex?(0,i.jsx)(R.PrivacyToggle,{isPrivate:q.isPrivate,onChange:function(){if(!eC){(0,x.track)(y.events.POWER_UP_TOGGLE_REQUESTED,{powerUp:"private",setting:!q.isPrivate,source:"workspace_info_modal"});var e,t=!q.isPrivate;if(q.authorizations.editVisibility.isAuthorized||!1===t)return void eD();q.authorizations.editVisibility.code===l.ReplAuthorizationCode.RequiresActiveSubscription&&(null==(e=q.org)?void 0:e.__typename)!=="Org"?ed("MembershipPurchaseModal",{analyticsContext:{upgrade:{context:"workspace_info_modal"}}}):eg(q.authorizations.editVisibility.message)}},isTeam:eL}):null]}),(0,i.jsx)(eh,{isExpertModeAllowed:!0===q.config.isAgentRepl}),(0,i.jsx)(E.default,{isOpen:ee===P.Dialogs.DeleteRepl,onClose:function(){return et(null)},selectedRepls:[q],onDelete:function(){ew()},deleting:ek}),(0,i.jsx)(F.Modal,{isOpen:ee===P.Dialogs.UnpublishTemplate,onRequestClose:function(){return et(null)},children:(0,i.jsx)(c.default,{confirmLabel:"Yes, unpublish this Template",isDestructive:!0,title:"Unpublish Template",onCancel:function(){return et(null)},onConfirm:function(){eE.loading||(eT(),et(null))},children:"Your App will no longer be discoverable on Templates. You can republish again at any time, and all of your comments or reactions will stick around."})}),(0,i.jsx)(F.Modal,{isOpen:ee===P.Dialogs.EditPublishedTemplateSettings,onRequestClose:function(){return et(null)},noPadding:!0,maxWidth:872,fitContent:!0,children:(0,i.jsx)(C.default,{source:"replEnvironment",replId:q.id,getDesktopLayoutState:K})}),(0,i.jsx)(F.Modal,{isOpen:ee===P.Dialogs.PublishTemplate,onRequestClose:function(){return et(null)},noPadding:!0,maxWidth:872,fitContent:!0,children:(0,i.jsx)(C.default,{source:"replEnvironment",replId:q.id,getDesktopLayoutState:K})}),(0,i.jsx)(F.Modal,{isOpen:ee===P.Dialogs.UpdatePublishedTemplate,onRequestClose:function(){return et(null)},noPadding:!0,children:(0,i.jsx)(T.default,{repl:q,getDesktopLayoutState:K})}),(0,i.jsx)(F.Modal,{isOpen:ee===P.Dialogs.Share,onRequestClose:function(){return et(null)},noPadding:!0,children:(0,i.jsx)(j.PublishedReplShareInfo,{repl:q})}),(0,i.jsx)(F.Modal,{isOpen:ee===P.Dialogs.TransferRepl,onRequestClose:function(){return et(null)},children:(0,i.jsx)(ef,{repl:q,onDone:function(){return et(null)},onCancel:function(){return et(null)}})}),(0,i.jsx)(F.Modal,{isOpen:ee===P.Dialogs.FeatureRepl,onRequestClose:function(){return et(null)},centered:!0,maxWidth:650,children:(0,i.jsx)(S.default,{isFeatured:q.isFeaturedRepl,repl:q,orgId:null==(B=q.org)?void 0:B.id,onCompleted:function(){return et(null)}})})]})}e.s(["default",()=>eg],740616)},472883,e=>{"use strict";var t=e.i(878420),n=e.i(569384),r=e.i(973245),i=e.i(304277);function o(){var e=(0,n._)(["\n  query GetReplIcon($replId: String!) {\n    getRepl(id: $replId) {\n      ... on Repl {\n        id\n        iconUrl\n      }\n    }\n  }\n"]);return o=function(){return e},e}e.i(566901);var a={},s=(0,r.gql)(o());function l(e){var n=(0,t._)({},a,e);return i.useQuery(s,n)}e.s(["useGetReplIconQuery",()=>l])},406802,e=>{"use strict";var t=e.i(389959),n=e.i(98816);function r(e,r){var i=(0,n.default)(e);(0,t.useEffect)(function(){if(null!==r){var e=setTimeout(function(){null!==i.current&&i.current()},r);return function(){return clearTimeout(e)}}},[r,i])}e.s(["useTimeout",()=>r])},629756,e=>{"use strict";var t=e.i(530658),n=e.i(389959),r=e.i(472883),i=e.i(349597),o=e.i(406802),a=e.i(529810);function s(e){var s=e.replId,l=e.replIconUrl,u=(0,t._)((0,n.useState)(null),2),c=u[0],d=u[1],f=(0,t._)((0,n.useState)(!1),2),p=f[0],h=f[1],g=(0,a.default)().container,m=l===i.DEFAULT_REPL_ICON&&null===c&&!p;(0,o.useTimeout)(function(){m&&h(!0)},m?3e4:null);var x=(0,r.useGetReplIconQuery)({variables:{replId:s},pollInterval:2e3*!!m,onCompleted:function(e){var t,n=(null==e||null==(t=e.getRepl)?void 0:t.__typename)==="Repl"?e.getRepl.iconUrl:null;l===i.DEFAULT_REPL_ICON&&n&&n!==i.DEFAULT_REPL_ICON&&(g.exec("sh","-c","curl -o generated-icon.png ".concat(n)),d(n))}}).error;return{loading:m,error:x,generatedIconUrl:c}}e.s(["usePollForGeneratedReplIcon",()=>s])},552488,e=>{"use strict";var t=e.i(389959),n=2/3*100;function r(e){var n=e.usage,r=e.limit,i=e.percentThreshold,o=e.onHitThreshold,a=(0,t.useRef)(void 0);(0,t.useEffect)(function(){if(void 0!==n&&void 0!==r){var e=n/r*100;void 0!==a.current&&a.current/r*100<i&&e>=i&&o(),a.current=n}},[n,r,i,o])}e.s(["FREEMIUM_POPUP_ALERT_THRESHOLD",()=>50,"FREEMIUM_POPUP_NEAR_LIMIT_ALERT_THRESHOLD",()=>85,"FREEMIUM_POPUP_REACHED_ALERT_THRESHOLD",()=>100,"FREEMIUM_POPUP_WARNING_ALERT_THRESHOLD",()=>n,"useOnHitFreemiumAlertThreshold",()=>r])},500736,e=>{"use strict";var t=e.i(878420),n=e.i(569384),r=e.i(973245),i=e.i(304277);function o(){var e=(0,n._)(["\n  query UseReplUrl($replId: String!) {\n    getRepl(id: $replId) {\n      ... on Repl {\n        id\n        url\n      }\n    }\n  }\n"]);return o=function(){return e},e}e.i(566901);var a={},s=(0,r.gql)(o()),l=e.i(207237);function u(){var e,n,r,o=(0,l.default)(),u=(e={variables:{replId:o},skip:!o},n=(0,t._)({},a,e),i.useQuery(s,n)).data;return(null==u||null==(r=u.getRepl)?void 0:r.__typename)==="Repl"?u.getRepl.url:void 0}e.s(["useReplUrl",()=>u],500736)},344677,e=>{"use strict";var t=e.i(265957);function n(){var e=(0,t.usePrepareDatabaseState)().state,n=(0,t.getStageByType)(e.stages,t.PrepareDatabaseStageType.ValidatingDiffStatements),r=(0,t.getStageByType)(e.stages,t.PrepareDatabaseStageType.GeneratingDiffStatements),i=r&&r.status===t.PrepareDatabaseBaseStageStateStatus.Paused,o=n&&(n.status===t.PrepareDatabaseBaseStageStateStatus.Completed&&!n.approved||n.status===t.PrepareDatabaseBaseStageStateStatus.Paused&&!n.approved);return i||o}e.s(["usePauseProvisionStage",()=>n])},522821,e=>{"use strict";e.i(877212);var t=e.i(924908);e.i(925218);var n=e.i(641555);function r(){var e=(0,t.useChatter)();return(0,n.useObservableMemo)(function(){return e.sessions.agent.current.select(function(e){return null==e?void 0:e.id})},[e])}e.s(["useActiveAgentSessionId",()=>r])},537548,e=>{"use strict";var t,n=((t={}).Welcome="Welcome",t.Forks="Forks",t.ProjectPane="ProjectPane",t),r={id:"workspace-repo-projects-tour",steps:[{title:"Welcome to your Project",id:"Welcome",content:"Click here to see all forks inside this Project and navigate between them.",hideOverlay:!0},{title:"Project Forks",id:"Forks",content:"Move to a different Repl within this Project, or create a new one",hideTooltip:!0,hideOverlay:!0},{title:"Project Pane",id:"ProjectPane",content:"View your changes, and merge them back into the main Repl when you're ready.",hideOverlay:!0}]};e.s(["StepIds",()=>n,"projectsTour",()=>r])},690821,e=>{"use strict";var t=e.i(721281),n=e.i(878420),r=e.i(276385),i=e.i(330666),o=e.i(480028),a=e.i(446530),s=e.i(123850),l=e.i(613355),u=e.i(140487),c=e.i(136540),d=e.i(960178),f=e.i(625484),p=e.i(616278),h=e.i(549762),g=e.i(782096),m=e.i(283110),x=(0,s.createCssVarTokens)(["padding","backgroundColor","borderColor"]),y=x.cssVars,b=x.styleTokens,w=(0,a.cssRecord)({root:[l.rcss.position.relative,l.rcss.border({width:1,style:"solid",color:b.borderColor}),l.rcss.pb(12),l.rcss.borderRadius(),l.rcss.shadow(2),l.rcss.flex.column,{padding:b.padding,backgroundColor:b.backgroundColor,gap:b.padding}],closeIconButton:[l.rcss.position.absolute,l.rcss.top(b.padding),l.rcss.right(b.padding)],dot:[l.rcss.borderRadius("full"),l.rcss.width(o.tokens.space8),l.rcss.height(o.tokens.space8)]});function k(e){var i,a=e.title,s=e.subtitle,l=e.icon,x=e.content,b=e.containerStyle,k=e.colorway,S=void 0===k?"primary":k,C=e.totalSteps,j=void 0===C?1:C,T=e.currentStepIndex,E=void 0===T?0:T,R=e.onDismiss,I=e.onCurrentStepChange,A=e.cypressCloseData,P=e.compact,D=e.hideCloseButton,O=void 0!==D&&D,N=e.hideNavigation,M=e.doneText,L=!1===S?void 0:S,B=E>=j-1;return(0,r.jsxs)(f.View,{css:w.root,style:(0,n._)((i={},(0,t._)(i,y.padding,void 0===P||P?o.tokens.space8:o.tokens.space16),(0,t._)(i,y.backgroundColor,L?o.colormap[L].dimmest:o.tokens.backgroundDefault),(0,t._)(i,y.borderColor,L?o.colormap[L].dimmer:o.tokens.backgroundHighest),(0,t._)(i,"paddingRight",a||O?void 0:o.tokens.space32),i),b),children:[O?null:(0,r.jsx)(c.IconButton,{alt:"Close",colorway:L,css:w.closeIconButton,onClick:R,dataCy:A,children:(0,r.jsx)(m.default,{})}),a?(0,r.jsxs)(f.View,{row:!0,gap:8,align:"center",children:[l?(0,r.jsx)(l,{}):null,(0,r.jsxs)(f.View,{row:!0,gap:8,align:"end",children:[(0,r.jsx)(d.Text,{variant:"subheadDefault",multiline:!1,children:a}),s?(0,r.jsx)(d.Text,{variant:"text",color:"dimmest",multiline:!1,css:{transform:"translateY(1.5px)"},children:s}):null]})]}):null,(0,r.jsx)(f.View,{children:"function"==typeof x?(0,r.jsx)(x,{}):(0,r.jsx)(d.Text,{children:x})}),j>1&&I&&!(void 0!==N&&N)?(0,r.jsxs)(f.View,{row:!0,align:"center",justify:"space-between",children:[(0,r.jsx)(u.Button,{css:{visibility:E<=0?"hidden":void 0},colorway:L,text:"Back",iconLeft:(0,r.jsx)(h.default,{}),onClick:function(){return I(E-1)}}),(0,r.jsx)(_,{colorway:L,total:j,current:E}),(0,r.jsx)(u.Button,{"data-autofocus":!0,colorway:B?"primary":L,text:B?void 0===M?"Done":M:"Next",iconLeft:B?(0,r.jsx)(p.default,{}):(0,r.jsx)(g.default,{}),onClick:function(){return B?R():I(E+1)}})]}):null]})}function _(e){var t=e.total,n=e.current,a=e.colorway;return(0,r.jsxs)(f.View,{children:[(0,r.jsx)(i.VisuallyHidden,{children:(0,r.jsx)("progress",{value:n+1,max:t,"aria-label":"Step"})}),(0,r.jsx)(f.View,{"aria-hidden":!0,row:!0,gap:8,children:Array(t).fill(0).map(function(e,t){return(0,r.jsx)(f.View,{style:{backgroundColor:t===n?a?o.colormap[a].stronger:o.tokens.foregroundDimmest:a?o.colormap[a].dimmer:o.tokens.outlineDimmest},css:w.dot},t)})})]})}e.s(["Tour",()=>k])},353583,e=>{"use strict";var t=e.i(389959),n=e.i(877212),r=e.i(149818),i=e.i(529131),o=e.i(374106),a=e.i(924908);e.i(925218);var s=e.i(267103),l=e.i(641555),u=e.i(759967),c=e.i(729122);function d(){var e,d,f=(0,n.useSupportsAgent)(),p=(e=(0,a.useChatter)(),d=(0,s.useObservable)(e.sessions.agent.current),(0,l.useObservableMemo)(function(){var e;return null==d?void 0:d.reduce((e=d.created,{direction:"forward",state:{inRapidBuild:!1},map:function(e){return e.inRapidBuild},reducer:function(t,n){if(function(e,t){(0,i.default)(2,arguments);var n=(0,r.default)(e),o=(0,r.default)(t);return n.getTime()<o.getTime()}(e,o.RAPID_BUILD_CONCLUDED_EVENT_CREATED_AT))return n.inRapidBuild=!1,!1;if(n.inRapidBuild){if((0,o.isEventContentsKind)(t,"rapidBuildConcluded"))return n.inRapidBuild=!1,!1}else e>o.RAPID_BUILD_STARTED_EVENT_CREATED_AT?(0,o.isEventContentsKind)(t,"rapidBuildStarted")&&(n.inRapidBuild=!0):(0,o.isEventContentsKind)(t,"agentPlanEventContents")&&!t.contents.contents.agentPlanEventContents.requiresApproval&&(n.inRapidBuild=!0)}}),"global")},[d])),h=(0,c.useHasAgentConfiguredWorkflows)(),g=(0,c.useHasNonGeneratedWorkflowSet)(),m=(0,u.useIsExpertMode)();return(0,t.useMemo)(function(){return!m&&!!f&&(!!p||!h&&!g)},[m,f,p,h,g])}e.s(["useIsAgentRunButtonNotConfigured",()=>d],353583)},923893,635925,849004,e=>{"use strict";var t=e.i(530658),n=e.i(276385),r=e.i(878420),i=e.i(569384),o=e.i(973245),a=e.i(304277);e.i(566901);var s=e.i(951262);function l(){var e=(0,i._)(["\n  query MultiplayerInviteUrl($replId: String!) {\n    getRepl(id: $replId) {\n      ... on Repl {\n        id\n        inviteUrl\n        owner {\n          ... on User {\n            id\n          }\n          ... on Team {\n            id\n            capabilities {\n              isBusinessPlan\n              hasValidSubscription\n            }\n          }\n        }\n      }\n    }\n  }\n"]);return l=function(){return e},e}function u(){var e=(0,i._)(["\n  mutation MultiplayerRefreshInviteUrl($replId: String!) {\n    refreshMultiplayerInviteLink(replId: $replId) {\n      id\n      ... on Repl {\n        id\n        inviteUrl\n      }\n    }\n  }\n"]);return u=function(){return e},e}function c(){var e=(0,i._)(["\n  mutation DeleteMultiplayerInviteUrl($replId: String!) {\n    deleteMultiplayerInviteLink(replId: $replId) {\n      ... on Repl {\n        id\n        inviteUrl\n      }\n      ... on UserError {\n        message\n      }\n    }\n  }\n"]);return c=function(){return e},e}var d={},f=(0,o.gql)(l()),p=(0,o.gql)(u()),h=(0,o.gql)(c()),g=e.i(222342),m=e.i(610357),x=e.i(858248),y=e.i(709485),b=e.i(480028),w=e.i(446530),k=e.i(613355),_=e.i(88619),S=e.i(607278),C=e.i(552144),j=e.i(929872),T=e.i(112767),E=e.i(960178),R=e.i(625484),I=e.i(987154),A=e.i(292642),P=e.i(940745),D=e.i(42458),O=(0,w.cssRecord)({container:[k.rcss.colWithGap(12),k.rcss.px(12)],header:[k.rcss.flex.row,k.rcss.justify.spaceBetween],globeIconContainer:[k.rcss.width(40),k.rcss.height(40),k.rcss.backgroundColor.accentPrimaryDimmer,k.rcss.borderRadius("full"),k.rcss.align.center,k.rcss.justify.center],title:[k.rcss.fontWeight.medium],inviteUrlContainer:[k.rcss.borderRadius(8),k.rcss.flex.row],input:[k.rcss.borderRadius(8,0,0,8),k.rcss.color.foregroundDimmer],copyToClipboard:[k.rcss.borderRadius(0,8,8,0)]}),N=function(){return(0,n.jsxs)(R.View,{row:!0,gap:12,children:[(0,n.jsx)(R.View,{css:O.globeIconContainer,children:(0,n.jsx)(I.default,{color:b.tokens.accentPrimaryStrongest,size:20})}),(0,n.jsxs)(R.View,{children:[(0,n.jsx)(E.Text,{css:O.title,id:"link-switch-label",multiline:!1,children:"Private join link"}),(0,n.jsx)(E.Text,{variant:"small",color:"dimmest",multiline:!1,children:"Anyone with this link can edit files"})]})]})};function M(e){var i,o,l,u,c,w,I,M,L,B,V,F,U,G,$=e.replId,z=(0,g.default)(),H=z.showConfirm,W=z.showError,q=(i={variables:{replId:$}},o=(0,r._)({},d,i),a.useQuery(f,o)),K=q.data,Y=q.loading,Q=q.error,X=q.refetch,J=(0,t._)((l={variables:{replId:$},onError:function(e){return W(e.message)},onCompleted:function(){return H("Join link created")}},u=(0,r._)({},d,l),s.useMutation(p,u)),2),Z=J[0],ee=J[1],et=(0,t._)((c={variables:{replId:$},onError:function(e){return W(e.message)},onCompleted:function(e){"UserError"===e.deleteMultiplayerInviteLink.__typename?W(e.deleteMultiplayerInviteLink.message):"Repl"===e.deleteMultiplayerInviteLink.__typename&&H("Join link deleted")}},w=(0,r._)({},d,c),s.useMutation(h,w)),2),en=et[0],er=et[1],ei=(null==K||null==(I=K.getRepl)?void 0:I.__typename)==="Repl"?K.getRepl:null,eo=ee.loading||er.loading,ea=(null==K||null==(M=K.getRepl)?void 0:M.__typename)==="Repl"&&(null==ei||null==(L=ei.owner)?void 0:L.__typename)==="Team",es=(null==K||null==(B=K.getRepl)?void 0:B.__typename)==="Repl"&&(null==ei||null==(V=ei.owner)?void 0:V.__typename)==="Team"&&(null==ei||null==(F=ei.owner.capabilities)?void 0:F.isBusinessPlan)&&(null==ei||null==(U=ei.owner.capabilities)?void 0:U.hasValidSubscription),el=(null==K||null==(G=K.getRepl)?void 0:G.__typename)==="Repl"&&(null==ei?void 0:ei.inviteUrl)&&1?window.location.origin+(null==ei?void 0:ei.inviteUrl):null;return Y||ea&&!es?null:Q?(0,n.jsxs)(R.View,{css:O.container,children:[(0,n.jsxs)(R.View,{css:O.header,children:[(0,n.jsx)(N,{}),(0,n.jsx)(T.Switch,{isSelected:!1,isDisabled:!0,"aria-labelledby":"link-switch-label"})]}),(0,n.jsx)(C.StatusBannerButton,{css:[k.rcss.textAlign.left],iconLeft:(0,n.jsx)(D.default,{color:b.tokens.accentNegativeStrongest}),colorway:"negative",text:"Error loading join link. Click here to try again, or contact support.",onClick:function(){return X({replId:$})}})]}):(0,n.jsxs)(R.View,{css:O.container,children:[(0,n.jsxs)(R.View,{css:O.header,children:[(0,n.jsx)(N,{}),Y?(0,n.jsxs)(R.View,{row:!0,gap:4,align:"center",children:[(0,n.jsx)(P.default,{color:b.tokens.foregroundDimmer}),(0,n.jsx)(E.Text,{color:"dimmer",multiline:!1,children:"Loading..."})]}):(0,n.jsx)(T.Switch,{isSelected:!!el,isDisabled:eo,onChange:function(e){eo||(e?Z():en())},"aria-labelledby":"link-switch-label"})]}),!Y&&el?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(j.Surface,{css:O.inviteUrlContainer,children:[(0,n.jsx)(S.Input,{type:"url",readOnly:!0,disabled:!0,value:eo?"Loading...":el,css:O.input}),(0,n.jsx)(_.CopyButton,{textToCopy:el,onClick:function(){el?((0,m.default)(el),(0,x.track)(y.events.JOIN_LINK_COPIED,{replId:null==ei?void 0:ei.id,isTeamRepl:ea,source:"replEnvironment"}),H("Link copied")):W("Could not copy link")},tooltipSuccessText:"Copied to clipboard",text:"Copy join link",iconLeft:(0,n.jsx)(A.default,{}),css:O.copyToClipboard,colorway:"primary",disabled:eo})]}),(0,n.jsx)(R.View,{children:(0,n.jsxs)(E.Text,{color:"dimmer",variant:"small",multiline:!1,children:["Want to revoke access to this link?"," ",(0,n.jsx)("a",{css:k.rcss.linkStyle,role:"button",tabIndex:0,onKeyDown:function(e){"Enter"===e.key&&(e.preventDefault(),eo||Z())},onClick:function(e){e.preventDefault(),eo||Z()},children:"Generate a new link"})]})})]}):null]})}function L(){var e=(0,i._)(["\n  fragment MultiplayerUser on User {\n    id\n    image\n    username\n    url\n  }\n"]);return L=function(){return e},e}function B(){var e=(0,i._)(["\n  fragment MultiplayerRepl on Repl {\n    id\n    collaborators {\n      user {\n        ...MultiplayerUser\n      }\n    }\n    multiplayerInvites {\n      email\n      type\n    }\n  }\n  ","\n"]);return B=function(){return e},e}function V(){var e=(0,i._)(["\n  fragment MultiplayerReplInvite on MultiplayerInvite {\n    email\n    repl {\n      ...MultiplayerRepl\n    }\n    invitePermissionType: type\n  }\n  ","\n"]);return V=function(){return e},e}function F(){var e=(0,i._)(["\n  mutation AddOrInviteReplMultiplayer(\n    $input: AddOrInviteReplMultiplayerInput!\n  ) {\n    addOrInviteReplMultiplayer(input: $input) {\n      __typename\n      ... on AddOrInviteReplMultiplayerOuput {\n        result {\n          ... on MultiplayerInvite {\n            ...MultiplayerReplInvite\n          }\n          ... on ReplPermission {\n            id\n            repl {\n              ...MultiplayerRepl\n            }\n            user {\n              ...MultiplayerUser\n            }\n            replPermissionType: type\n          }\n        }\n      }\n      ... on UnauthorizedError {\n        message\n      }\n      ... on NotFoundError {\n        message\n      }\n      ... on UserError {\n        message\n      }\n    }\n  }\n  ","\n  ","\n  ","\n"]);return F=function(){return e},e}e.s(["default",()=>M],923893);var U={},G=(0,o.gql)(L()),$=(0,o.gql)(B(),G),z=(0,o.gql)(V(),$),H=(0,o.gql)(F(),z,$,G);function W(e){var t=(0,r._)({},U,e);return s.useMutation(H,t)}function q(){var e=(0,i._)(["\n  query MultiplayerManager($replId: String!) {\n    getRepl(id: $replId) {\n      ... on Repl {\n        id\n        isOwner\n        collaborators {\n          user {\n            ...MultiplayerUser\n          }\n        }\n        authorizations {\n          editPermissions {\n            isAuthorized\n          }\n        }\n        multiplayerInvites {\n          email\n          type\n        }\n      }\n    }\n    currentUser {\n      id\n      isSubscribed\n    }\n  }\n  ","\n"]);return q=function(){return e},e}e.s(["MultiplayerUserFragmentDoc",()=>G,"useAddOrInviteReplMultiplayerMutation",()=>W],635925);var K={},Y=(0,o.gql)(q(),G);function Q(e){var t=(0,r._)({},K,e);return a.useQuery(Y,t)}e.s(["useMultiplayerManagerQuery",()=>Q],849004)},810394,e=>{"use strict";e.s(["CORE_MULTIPLAYER_LIMIT",()=>3,"LEGACY_STARTER_MULTIPLAYER_LIMIT",()=>100,"USER_LOOKUP_LIMIT",()=>250])},433788,204070,802482,613349,e=>{"use strict";var t=e.i(530658),n=e.i(346715),r=e.i(276385),i=e.i(399528),o=e.i(389959),a=e.i(294784),s=e.i(368964),l=e.i(849004),u=e.i(810394),c=e.i(548733),d=e.i(297083),f=e.i(817556),p=e.i(596139),h=e.i(973519),g=e.i(490314);e.i(653863);var m=e.i(480028),x=e.i(446530),y=e.i(613355),b=e.i(27820),w=e.i(624782),k=e.i(960178),_=e.i(751273),S=e.i(625484),C=e.i(940745),j=function(e){var t=e.modalState,n=(0,g.useCollaboratorLimit)(),i=(0,h.useGlobalModal)().show,a=function(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).onPurchaseComplete,t=(0,h.useGlobalModal)().show;return{showUpgradeModal:function(){return(0,d._)(function(){return(0,f._)(this,function(n){switch(n.label){case 0:return[4,t("MembershipPurchaseModal",{headingText:"Upgrade for more collaborators",subHeadingText:"Share your Apps with up to ".concat(u.CORE_MULTIPLAYER_LIMIT," collaborators with Replit ").concat(p.corePlanName),onPurchaseComplete:e,analyticsContext:{upgrade:{context:"workspace_multiplayer_header"}}})];case 1:return n.sent(),[2]}})})()}}}({onPurchaseComplete:(0,o.useCallback)(function(){"data"===n.type&&n.refetch(),"open"===t.type&&t.onUpgradeSuccess()},[n,t])}).showUpgradeModal,s=(0,o.useCallback)(function(){return(0,d._)(function(){return(0,f._)(this,function(e){switch(e.label){case 0:if("data"!==n.type)return[2];if(!n.isStarterUser)return[3,2];return[4,a()];case 1:return e.sent(),[3,4];case 2:return[4,i("TeamUpgradeModal")];case 3:e.sent(),e.label=4;case 4:return[2]}})})()},[n,a,i]);if((0,o.useEffect)(function(){(null==t?void 0:t.type)==="open"&&"data"===n.type&&s()},[null==t?void 0:t.type,n.type,s]),"loading"===n.type)return(0,r.jsxs)(S.View,{grow:!0,justify:"center",row:!0,gap:4,align:"center",children:[(0,r.jsx)(C.default,{color:m.tokens.foregroundDimmer}),(0,r.jsx)(k.Text,{color:"dimmer",multiline:!1,children:"Loading..."})]});if("data"!==n.type)return null;var l=n.collaboratorCount,c=n.collaboratorLimit,x=Math.max(0,c-l);return(0,r.jsx)(S.View,{row:!0,gap:8,children:(0,r.jsxs)(S.View,{css:T.limitsContainer,align:"center",row:!0,gap:8,children:[(0,r.jsx)(_.Tooltip,{tooltip:"Your account is limited to ".concat(c," collaborators. Manage your collaborators on the Usage page."),children:(0,r.jsx)(w.Pill,{colorway:"yellow",css:T.pill,text:"".concat(l," / ").concat(c),onClick:s})}),(0,r.jsx)(S.View,{css:T.measureBarWrapper,onClick:s,children:(0,r.jsx)(b.MeasureBar,{css:T.measureBar,total:c,current:l,tooltip:"".concat(x," account collaborators remaining"),backgroundColor:m.tokens.yellowDimmer,color:m.tokens.yellowDefault})})]})})},T=(0,x.cssRecord)({pill:[y.rcss.cursor.pointer,y.rcss.borderRadius(4),y.rcss.pr(0)],measureBar:[y.rcss.height(8),y.rcss.width(60)],measureBarWrapper:[y.rcss.cursor.default],limitsContainer:[y.rcss.borderRadius(4),y.rcss.backgroundColor.yellowDimmest,y.rcss.pr(8)]}),E=e.i(906368),R=e.i(635925),I=e.i(709485),A=e.i(222342),P=e.i(858248);let D=function(e){var n=e.isMobileApp,r=e.isTeam,i=e.handleUpgradeTriggered,o=e.replId,a=(0,A.default)(),l=a.showConfirm,u=a.showError,c=(0,g.useCollaboratorLimit)(),d=function(e,t){E.addBreadcrumb({message:t}),E.captureException(Error(e.message)),u("Something unexpected happened, please try again.")},f=(0,t._)((0,R.useAddOrInviteReplMultiplayerMutation)({onError:function(e){return d(e,"useAddOrInviteReplMultiplayerMutation")},onCompleted:function(e){var t,a,d,f=e.addOrInviteReplMultiplayer;switch(f.__typename){case"NotFoundError":case"UnauthorizedError":u(f.message);return;case"UserError":if(f.message.includes("reached the limit")){if(n&&!r)return void u("You have reached the invite limit for a free account. Please upgrade to add more collaborators.");else if(!n&&i)return void i(!0)}u(f.message);return;case"AddOrInviteReplMultiplayerOuput":"MultiplayerInvite"===f.result.__typename?(t=s.MultiplayerInviteMethod.Email,a=f.result.email):(t=s.MultiplayerInviteMethod.Username,a=(null==(d=f.result.user)?void 0:d.username)?"@".concat(f.result.user.username):"user")}"data"===c.type&&c.refetch(),(0,P.track)(I.events.MULTIPLAYER_INVITED,{replId:o,inviteMethod:t}),l("Added ".concat(a))}}),2);return{addOrInviteReplMultiplayer:f[0],loadingAddMutation:f[1].loading}};e.s(["default",0,D],204070);var O=e.i(441329),N=e.i(412160),M=e.i(878420),L=e.i(569384),B=e.i(973245),V=e.i(951262);function F(){var e=(0,L._)(["\n  mutation RemoveMultiplayerUser($replId: String!, $username: String!) {\n    removeMultiplayerUser(replId: $replId, username: $username) {\n      id\n      user {\n        id\n        ...MultiplayerUser\n      }\n      repl {\n        id\n        collaborators {\n          user {\n            ...MultiplayerUser\n          }\n        }\n      }\n    }\n  }\n  ","\n"]);return F=function(){return e},e}function U(){var e=(0,L._)(["\n  mutation DeleteMultiplayerInvite($replId: String!, $email: String!) {\n    deleteMultiplayerInvite(replId: $replId, email: $email) {\n      ... on MultiplayerInvite {\n        email\n        type\n        repl {\n          id\n          collaborators {\n            user {\n              ...MultiplayerUser\n            }\n          }\n          multiplayerInvites {\n            email\n            type\n          }\n        }\n      }\n      ... on UserError {\n        message\n      }\n    }\n  }\n  ","\n"]);return U=function(){return e},e}var G={},$=(0,B.gql)(F(),R.MultiplayerUserFragmentDoc),z=(0,B.gql)(U(),R.MultiplayerUserFragmentDoc);let H=function(){var e,n,r,i,o=(0,A.default)(),a=o.showConfirm,s=o.showError,l=(0,g.useCollaboratorLimit)(),u=function(e,t){E.addBreadcrumb({message:t}),E.captureException(Error(e.message)),s("Something unexpected happened, please try again.")},c=(0,t._)((e={onError:function(e){return u(e,"useRemoveMultiplayerUser")},onCompleted:function(e){var t,n=null==(t=e.removeMultiplayerUser.user)?void 0:t.username;n?a("@".concat(n," removed")):a("User removed"),"data"===l.type&&l.refetch()}},n=(0,M._)({},G,e),V.useMutation($,n)),2),d=c[0],f=c[1].loading,p=(0,t._)((r={onError:function(e){return u(e,"useDeleteMultiplayerInviteMutation")},onCompleted:function(e){if("UserError"===e.deleteMultiplayerInvite.__typename)return void s(e.deleteMultiplayerInvite.message);if("MultiplayerInvite"===e.deleteMultiplayerInvite.__typename){var t=e.deleteMultiplayerInvite.email;a("Invite canceled for ".concat(t))}}},i=(0,M._)({},G,r),V.useMutation(z,i)),2);return{removeMultiplayerUser:d,loadingRemoveUser:f,deleteMultiplayerInvite:p[0],loadingDeleteInvite:p[1].loading}};var W=e.i(136540),q=e.i(367861),K=e.i(345904),Y=e.i(245225),Q=e.i(283110),X=(0,x.cssRecord)({root:[y.rcss.cursor.default,y.rcss.justify.spaceBetween],userContainer:[y.rcss.viewStyle,y.rcss.color.foregroundDefault],userContainer_pending:[y.rcss.flex.grow(1),y.rcss.flex.row,y.rcss.rowWithGap(8),y.rcss.align.center,{fontStyle:"italic"}]});let J=function(e){var t,n=e.isPendingInvitation,i=e.canEditMultiplayers,o=e.replId,a=H(),s=a.removeMultiplayerUser,l=a.loadingRemoveUser,u=a.deleteMultiplayerInvite,c=a.loadingDeleteInvite,d=!n,f=d?(0,r.jsx)(K.default,{size:"m",url:e.user.image,username:e.user.username,fullName:e.user.fullName}):(0,r.jsx)(Y.default,{color:m.tokens.outlineDefault,size:32}),p=d?e.user.username:e.email;return(0,r.jsxs)(S.View,{css:X.root,px:16,py:4,row:!0,gap:8,align:"center",children:[d?(0,r.jsx)(N.default,{href:"/@".concat(e.user.username),css:X.userContainer,children:(0,r.jsx)(q.User,{username:e.user.username,src:null!=(t=e.user.image)?t:null})}):(0,r.jsxs)(S.View,{css:[X.userContainer_pending],children:[f,(0,r.jsx)(k.Text,{color:d?"default":"dimmest",multiline:!1,children:p})]}),(0,r.jsxs)(S.View,{row:!0,gap:8,align:"center",children:[(0,r.jsx)(k.Text,{color:"dimmest",variant:"small",multiline:!1,children:e.isPendingInvitation?"Invited":"Can edit"}),i?(0,r.jsx)(W.IconButton,{alt:d?"Remove member":"Cancel invitation",onClick:function(){!i||l||c||(d?s({variables:{replId:o,username:e.user.username}}):u({variables:{replId:o,email:e.email}}))},children:(0,r.jsx)(Q.default,{size:12})}):null]})]})};e.s(["default",0,J],802482);var Z=e.i(64386),ee=e.i(888136),et=e.i(538157),en=e.i(162914),er=e.i(428596),ei=e.i(140487),eo=e.i(607278),ea=e.i(929872),es=e.i(616278),el=(0,x.cssRecord)({form:[y.rcss.align.start,y.rcss.display.flex,y.rcss.rowWithGap(8),y.rcss.width("100%")],searchContainer:[y.rcss.position.relative,y.rcss.flex.growAndShrink(1)],dropdownMenu:[y.rcss.borderRadius(8),y.rcss.overflow("hidden"),y.rcss.mt(2),y.rcss.zIndex(2),y.rcss.border({color:m.tokens.outlineDimmer,width:1,style:"solid"}),y.rcss.maxHeight(280),y.rcss.overflowY("auto"),y.rcss.scrollbar.thin,{scrollbarColor:m.tokens.backgroundHigher+" "+m.tokens.backgroundHighest,"&::-webkit-scrollbar-thumb":{backgroundColor:m.tokens.backgroundHighest}}],result:[y.rcss.p(8),y.rcss.rowWithGap(8),y.rcss.justify.spaceBetween,y.rcss.align.center,y.rcss.cursor.pointer],result_active:[y.rcss.backgroundColor.accentPrimaryDimmer],loadingContainer:[y.rcss.m(8),y.rcss.rowWithGap(8),y.rcss.align.center],emptyText:[y.rcss.m(8)]});function eu(e){var n=e.onSubmit,i=e.existingUsernames,s=e.isDisabled,l=e.onChange,u=e.placeholder,c=(0,t._)((0,o.useState)(""),2),d=c[0],f=c[1],p=(0,er.useIdSeed)(),h=(0,en.default)(d.trim().replace(/^@/,""),250),g=(0,et.useMultiplayerUsernameSearchQuery)({skip:!h||(0,a.default)(d),variables:{query:h,limit:6}}),x=g.data,y=g.loading,b=g.error,w=(0,A.default)().showError;(0,o.useEffect)(function(){b&&w(b.message)},[b,w]);var _=null==x?void 0:x.usernameSearch,j=function(e){f(e.currentTarget.value),null==l||l(e.currentTarget.value)},T=function(e){"Enter"===e.key&&d.match(/.+@.+/)&&(n(d),f(""),e.currentTarget.blur())};return(0,r.jsxs)("form",{onSubmit:function(e){e.preventDefault(),n(d),f("")},css:el.form,children:[(0,r.jsx)(ee.default,{onChange:function(e){e&&f(e.username)},itemToString:function(e){return(null==e?void 0:e.username)||""},initialHighlightedIndex:0,defaultHighlightedIndex:0,children:function(e){var t=e.getInputProps,n=e.getItemProps,o=e.getMenuProps,a=e.isOpen,s=e.highlightedIndex,l=e.getRootProps;return(0,r.jsxs)(S.View,(0,Z._)((0,M._)({css:el.searchContainer},l({refKey:"innerRef"})),{children:[(0,r.jsx)(eo.Input,(0,M._)({id:p("username-search")},t({ref:null,value:d,onChange:j,placeholder:null!=u?u:"Add people by username or email",autoComplete:"off",onKeyDown:T}))),a?(0,r.jsxs)(S.View,{children:[_&&_.length?(0,r.jsx)(ea.Surface,(0,Z._)((0,M._)({elevated:!0,css:el.dropdownMenu,tag:"ul"},o({refKey:"innerRef"})),{children:_.map(function(e,t){return(0,r.jsxs)(S.View,(0,Z._)((0,M._)({tag:"li"},n({item:e,index:t})),{css:[el.result,t===s&&el.result_active],children:[(0,r.jsxs)(S.View,{row:!0,gap:8,align:"center",children:[(0,r.jsx)(K.default,{size:"m",url:e.image,username:e.username,fullName:e.fullName}),(0,r.jsx)(k.Text,{multiline:!1,children:e.username})]}),i.includes(e.username)?(0,r.jsx)(S.View,{children:(0,r.jsx)(es.default,{color:m.tokens.accentPositiveStronger})}):null]}),t)})})):null,y?(0,r.jsx)(ea.Surface,{elevated:!0,css:el.dropdownMenu,children:(0,r.jsxs)(S.View,{css:el.loadingContainer,align:"center",children:[(0,r.jsx)(C.default,{}),(0,r.jsx)(k.Text,{color:"dimmer",multiline:!1,children:"Loading"})]})}):null,_&&0===_.length?(0,r.jsx)(ea.Surface,{elevated:!0,css:el.dropdownMenu,children:(0,r.jsxs)(k.Text,{css:el.emptyText,color:"dimmer",multiline:!1,children:['No results found for "',d,'"']})}):null]}):null]}))}}),(0,r.jsx)(S.View,{children:(0,r.jsx)(ei.Button,{colorway:"primary",type:"submit",disabled:s||!d,text:"Invite"})})]})}e.s(["default",()=>eu],613349);var ec=e.i(418725);e.i(545082);var ed=e.i(663762),ef=e.i(283660),ep=e.i(571073),eh=e.i(363201);function eg(e,t){return t.some(function(t){return t.id===e})}var em={root:[y.rcss.color.foregroundDefault,y.rcss.colWithGap(12),y.rcss.align.stretch,y.rcss.flex.growAndShrink(1),y.rcss.px(12)],header:[y.rcss.flex.row,y.rcss.justify.spaceBetween,y.rcss.align.center],header_mobile:[y.rcss.px(0)],titleContainer:[y.rcss.flex.row,y.rcss.rowWithGap(4),y.rcss.align.center],limitsContainer:[y.rcss.align.center,y.rcss.rowWithGap(8)],loading:[y.rcss.rowWithGap(4),y.rcss.align.center,y.rcss.flex.grow(1),y.rcss.justify.center],measureBar:[y.rcss.height(8),y.rcss.width(60)],searchContainer:[y.rcss.position.relative,y.rcss.maxHeight(32)],userList:[y.rcss.flex.column,y.rcss.colWithGap(16),y.rcss.scrollbar.thin,y.rcss.position.relative,y.rcss.overflowY("auto"),y.rcss.flex.growAndShrink(1),{maxHeight:300,"::-webkit-scrollbar-thumb":[y.rcss.backgroundColor.backgroundHighest,y.rcss.borderRadius(4)],scrollbarColor:"".concat(m.tokens.backgroundDefault," ").concat(m.tokens.backgroundHighest)}],userGroup:{root:[y.rcss.colWithGap(8)],titleContainer:[y.rcss.rowWithGap(4),y.rcss.align.center],title:[y.rcss.fontWeight.medium]},emptyContainer:[y.rcss.position.relative,y.rcss.colWithGap(16),y.rcss.py(16),y.rcss.justify.start,{maxHeight:220}]},ev=function(e){var t=e.title,n=e.count,i=e.color,o=e.tooltip;return(0,r.jsxs)(S.View,{css:em.userGroup.titleContainer,children:[(0,r.jsx)(ef.default,{color:i,size:6}),(0,r.jsx)(k.Text,{variant:"small",css:em.userGroup.title,multiline:!1,children:t}),(0,r.jsx)(k.Text,{multiline:!1,variant:"small",color:"dimmest",css:em.userGroup.title,children:n}),o?(0,r.jsx)(_.Tooltip,{tooltip:o,children:(0,r.jsx)(eh.default,{})}):null]})};e.s(["MultiplayerControlCSS",()=>em,"UserGroupTitle",()=>ev,"default",0,function(e){var d,f=e.replId,p=e.handleUpgradeTriggered,h=(0,i.useRouter)(),x=(0,O.isInBonsaiWebview)(h),y=(0,g.useCollaboratorLimit)(),w=D({isMobileApp:x,isTeam:!1,handleUpgradeTriggered:p,replId:f}),_=w.addOrInviteReplMultiplayer,T=w.loadingAddMutation,E=(0,ed.useActiveUsers)(),R=(0,t._)((0,o.useState)({type:"closed"}),2),I=R[0],A=R[1],P=(0,t._)((0,o.useState)(!1),2),N=P[0],M=P[1],L=(0,l.useMultiplayerManagerQuery)({variables:{replId:f},pollInterval:8e3}),B=L.data,V=L.loading,F=(null==B?void 0:B.getRepl.__typename)==="Repl"?B.getRepl:null,U=null==B?void 0:B.currentUser,G=(null!=(d=null==F?void 0:F.collaborators)?d:[]).reduce(function(e,t){var r=t.user;return(0,n._)(e).concat([r.username])},[]),$=(null==F?void 0:F.authorizations.editPermissions.isAuthorized)||!1,z=!!(F&&!G.length&&!F.multiplayerInvites.length),H=null==F?void 0:F.collaborators.map(function(e){return e.user}).filter(function(e){return e.id!==(null==U?void 0:U.id)}),W=null==H?void 0:H.filter(function(e){return e&&eg(e.id,E)}),q=null==H?void 0:H.filter(function(e){return e&&!eg(e.id,E)}),K=H?H.length:null,Y=(0,r.jsxs)(r.Fragment,{children:[null===K||(null==U?void 0:U.isSubscribed)?null:(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(k.Text,{variant:"small",color:"dimmest","aria-hidden":!0,multiline:!1,children:[K," / ",u.LEGACY_STARTER_MULTIPLAYER_LIMIT]}),(0,r.jsx)(b.MeasureBar,{css:em.measureBar,total:u.LEGACY_STARTER_MULTIPLAYER_LIMIT,current:K,tooltip:"".concat(u.LEGACY_STARTER_MULTIPLAYER_LIMIT-K," free editors remaining")})]}),V||(null==U?void 0:U.isSubscribed)||x?null:(0,r.jsx)(ec.default,{size:"small",context:"workspace_multiplayer_header",onClickCallback:function(){p&&p(!0)},onCancel:function(){p&&p(!1)}})]});return(0,r.jsxs)(ea.Surface,{background:"default",css:em.root,children:[(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(S.View,{css:[em.header,x&&em.header_mobile],children:[(0,r.jsx)(S.View,{css:em.titleContainer,children:(0,r.jsx)(k.Text,{variant:"subheadDefault",multiline:!1,children:"Multiplayers"})}),(0,r.jsxs)(S.View,{css:em.limitsContainer,children:[V?(0,r.jsxs)(S.View,{css:em.loading,children:[(0,r.jsx)(C.default,{color:m.tokens.foregroundDimmer}),(0,r.jsx)(k.Text,{color:"dimmer",multiline:!1,children:"Loading..."})]}):null,"data"===y.type&&y.shouldEnforceMultiplayerLimit?(0,r.jsx)(j,{modalState:I}):Y]})]}),$&&G&&F?(0,r.jsx)(S.View,{css:em.searchContainer,children:(0,r.jsx)(eu,{existingUsernames:G,onSubmit:function(e){if(!V||(null==U?void 0:U.isSubscribed)){if(!T){var t=new Set(("data"===y.type?(0,n._)(y.collaboratorsByRepl.values()).map(function(e){return e.users}).flat():[]).map(function(e){return e.username})),r="data"===y.type&&y.shouldEnforceMultiplayerLimit&&y.collaboratorCount>=y.collaboratorLimit&&!t.has(e),i={method:(0,a.default)(e)?s.MultiplayerInviteMethod.Email:s.MultiplayerInviteMethod.Username,value:e},o=function(){return _({variables:{input:{replId:f,target:i,level:s.ReplPermissionLevel.Rw}}})};r?A({type:"open",onUpgradeSuccess:o}):o()}}}})}):null,z?(0,r.jsx)(S.View,{css:em.emptyContainer,children:(0,r.jsx)(S.View,{children:(0,r.jsx)(k.Text,{color:"dimmest",multiline:!1,children:"No one else is here"})})}):(0,r.jsxs)(ea.Surface,{css:em.userList,children:[(null==W?void 0:W.length)?(0,r.jsxs)(S.View,{css:em.userGroup.root,children:[(0,r.jsx)(ev,{title:"Online",count:W.length||0,color:m.tokens.greenStrongest}),W.map(function(e){return e?(0,r.jsx)(J,{isPendingInvitation:!1,replId:f,canEditMultiplayers:$,user:e},e.id):null})]}):null,(null==q?void 0:q.length)?(0,r.jsxs)(S.View,{css:em.userGroup.root,children:[(0,r.jsx)(ev,{title:"Offline",count:q.length||0,color:m.tokens.outlineStrongest}),null==q?void 0:q.map(function(e){return e?(0,r.jsx)(J,{canEditMultiplayers:$,isPendingInvitation:!1,user:e,replId:f},e.id):null})]}):null,(null==F?void 0:F.multiplayerInvites.length)?(0,r.jsxs)(S.View,{css:em.userGroup.root,children:[(0,r.jsx)(ev,{title:"Pending Invitations",count:(null==F?void 0:F.multiplayerInvites.length)||0,color:m.tokens.outlineStrongest}),F.multiplayerInvites.map(function(e){return(0,r.jsx)(J,{canEditMultiplayers:$,replId:f,isPendingInvitation:!0,email:e.email},e.email)})]}):null]})]}),(null==U?void 0:U.isSubscribed)?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(S.View,{children:(0,r.jsx)(ei.Button,{text:"Refer a friend and earn more credits",iconLeft:(0,r.jsx)(ep.default,{}),onClick:function(){return M(!0)}})}),(0,r.jsx)(c.ReferralLinkModal,{isOpen:N,onClose:function(){return M(!1)},trackingContext:"workspace-invite-dialog"})]}):null]})}],433788)},429878,33681,955665,e=>{"use strict";var t=e.i(297083),n=e.i(817556),r=e.i(276385),i=e.i(188507),o=e.i(993796),a=e.i(222342),s=e.i(530658),l=e.i(389959),u=e.i(140487),c=e.i(887877),d=e.i(607278),f=e.i(960178),p=e.i(625484);function h(e){var t=e.showHeading,n=e.onSubmit,i=(0,s._)((0,l.useState)(""),2),o=i[0],a=i[1];return(0,r.jsx)(c.Form,{onSubmit:function(e){e.preventDefault(),n(o)},children:(0,r.jsxs)(p.View,{gap:8,children:[void 0===t||t?(0,r.jsxs)(p.View,{gap:2,children:[(0,r.jsx)(f.Header,{variant:"subheadDefault",level:1,children:"Feedback"}),(0,r.jsx)(f.Text,{color:"dimmer",children:"All feedback is reviewed by the Replit team."})]}):null,(0,r.jsxs)(p.View,{gap:8,style:{minHeight:120},children:[(0,r.jsx)(d.MultiLineInput,{placeholder:"Please share bugs, feature requests, and anything else related to your experience...",autoSize:!0,value:o,onChange:function(e){return a(e.currentTarget.value)},autoFocus:!0}),(0,r.jsx)(u.Button,{colorway:"primary",text:"Send feedback",type:"submit"})]})]})})}e.s(["AIFeedbackForm",()=>h],33681);var g=e.i(346715),m=e.i(480028),x=e.i(446530),y=e.i(754873),b=e.i(613355),w=e.i(91720),k=e.i(624782),_=e.i(548635),S=e.i(144459),C=e.i(147043),j=[b.rcss.borderRadius(),b.rcss.px(12),b.rcss.py(16),y.interactive.filled,b.rcss.hover({backgroundColor:m.tokens.accentPrimaryDimmer}),b.rcss.width("50%"),b.rcss.justify.center,b.rcss.flex.column],T=(0,x.cssRecord)({container:j,containerActive:(0,g._)(j).concat([b.rcss.backgroundColor.accentPrimaryDimmest,b.rcss.border({color:m.tokens.accentPrimaryDimmer})]),headline:[b.rcss.fontWeight.medium],premiumPill:[b.rcss.display.inlineBlock,b.rcss.height("20px"),{verticalAlign:"middle"}],text:[b.rcss.width("100%")]});function E(e){var t=e.optionKey,n=e.icon,i=e.headline,o=e.description,a=e.isPremium,s=e.isActive,l=e.setSelectedOption;return(0,r.jsxs)(p.View,{css:s?T.containerActive:T.container,gap:6,onClick:function(){l(t)},children:[(0,r.jsxs)(p.View,{row:!0,gap:4,align:"center",children:[n,(0,r.jsx)(f.Text,{variant:"subheadDefault",css:T.headline,children:i}),a?(0,r.jsx)(k.Pill,{colorway:"green",text:"Premium",css:T.premiumPill}):null]}),(0,r.jsx)(p.View,{row:!0,gap:4,align:"center",children:(0,r.jsx)(f.Text,{variant:"small",color:"dimmer",css:T.text,children:o})})]})}var R=(0,x.cssRecord)({callOptionContainer:[b.rcss.width("100%"),b.rcss.flex.column,b.rcss.align.center,b.rcss.justify.center,b.rcss.height("100px"),b.rcss.border({color:m.tokens.outlineDimmer}),b.rcss.borderRadius()],helpButtonContainer:[{"@media (max-width: 600px)":{flexDirection:"column"}}]});function I(e){var t=e.onSubmit,n=(0,s._)((0,l.useState)(null),2),i=n[0],o=n[1],a=[{optionKey:"call",icon:(0,r.jsx)(C.default,{size:20}),headline:"Schedule a call",description:"Have a discussion with a Replit employee over a video call.",isPremium:!0},{optionKey:"feedback",icon:(0,r.jsx)(S.default,{size:20}),headline:"Share feedback & bugs",description:"Tell us about your experience. Feedback is reviewed by the Replit team."}];return(0,r.jsxs)(p.View,{gap:8,children:[(0,r.jsx)(f.Text,{variant:"headerDefault",children:"Talk to us"}),(0,r.jsx)(p.View,{row:!0,gap:8,css:R.helpButtonContainer,pr:6,children:a.map(function(e){return(0,r.jsx)(E,{icon:e.icon,headline:e.headline,description:e.description,isPremium:e.isPremium,optionKey:e.optionKey,isActive:i===e.optionKey,setSelectedOption:o},e.optionKey)})}),"call"===i?(0,r.jsx)(p.View,{css:R.callOptionContainer,children:(0,r.jsx)(w.ButtonLink,{iconLeft:(0,r.jsx)(_.default,{}),text:"Select a time to chat",colorway:"blue",target:"_blank",href:"https://calendly.com/kody-low-repl/replit-support"})}):null,"feedback"===i?(0,r.jsx)(h,{showHeading:!1,onSubmit:function(e){t(e),o(null)}}):null]})}function A(e){var s=e.session,l=e.onClose,u=(0,a.default)(),c=u.showConfirm,d=u.showError,f=function(e){return(0,t._)(function(){return(0,n._)(this,function(t){switch(t.label){case 0:return[4,s.submitUserFeedback({type:i.AgentUserFeedbackType.AGENT_FEEDBACK_UNKNOWN,comment:e})];case 1:if(!t.sent().ok)return d("Failed to send feedback. Please try again."),[2];return c("Feedback received."),l(),[2]}})})()};return(0,o.useFlag)({controlName:"flag-top-ai-spenders",type:"boolean"})?(0,r.jsx)(I,{onSubmit:f}):(0,r.jsx)(h,{onSubmit:f})}e.s(["AISupportFeedbackForm",()=>I],955665),e.s(["AIFeedback",()=>A],429878)},516351,e=>{"use strict";var t=e.i(530658),n=e.i(389959),r=e.i(529810);function i(){var e=(0,r.default)().presence,i=(0,t._)((0,n.useState)(e.getFollowedUser()),2),o=i[0],a=i[1];return(0,n.useEffect)(function(){return a(e.getFollowedUser()),e.onFollowedUserChanged(a)},[e]),o}e.s(["default",()=>i])},259475,e=>{"use strict";var t,n=((t={}).FileNode="FILE_NODE",t.FileHeaderTab="FILE_HEADER_TAB",t.Code="CODE",t.Pane="PANE",t.NewPane="NEW_PANE",t);e.s(["DragItems",()=>n])},794149,e=>{e.v({errorMessage:"ErrorBoundary-module__cE2Qsa__errorMessage"})},57613,e=>{"use strict";var t=e.i(399119),n=e.i(904851),r=e.i(90659),i=e.i(721281),o=e.i(445789),a=e.i(878420),s=e.i(64386),l=e.i(276385),u=e.i(389959),c=e.i(906368),d=e.i(37292),f=e.i(625484),p=e.i(794149),h=function(e){function a(){var e;return(0,n._)(this,a),e=(0,t._)(this,a,arguments),(0,i._)(e,"state",{hasErrored:!1,error:null,errorInfo:null}),e}return(0,o._)(a,e),(0,r._)(a,[{key:"componentDidCatch",value:function(e,t){this.setState({hasErrored:!0,error:e,errorInfo:t}),this.props.handleError(e,t),console.error(e)}},{key:"render",value:function(){if(this.state.hasErrored){var e,t;return this.props.fallback&&this.state.error&&this.state.errorInfo?this.props.fallback(this.state.error):(0,l.jsx)(f.View,{clsx:p.default.errorMessage,children:null!=(t=null==(e=this.state.error)?void 0:e.stack)?t:"An unknown error occurred."})}return this.props.children}}]),a}(u.Component);function g(e){var t=e.bsod,n=void 0!==t&&t,r=e.reportToSentry,i=void 0===r||r,o=e.handleError,u=e.children,f=e.origin,p=void 0===f?"ErrorBoundary: (no origin provided)":f,g=e.tags,m=void 0===g?{}:g,x=e.extras,y=void 0===x?{}:x,b=e.fallback,w=(0,d.useThrowBsod)();return(0,l.jsx)(h,{fallback:b,handleError:function(e,t){n?w({error:e,extras:(0,s._)((0,a._)({},y),{errorInfo:t}),componentStack:t.componentStack||void 0,tags:(0,s._)((0,a._)({},m),{errorBoundary:!0}),origin:p}):i&&c.withScope(function(n){n.setTag("errorBoundary",!0),n.setTags(m),n.setExtra("errorInfo",t),n.setExtras(y),n.setContext("react",{componentStack:t.componentStack}),c.captureException(e)}),o&&o(e,t)},children:u})}e.s(["default",()=>g])},391119,241939,243202,608572,133930,681128,153277,e=>{"use strict";var t=e.i(530658),n=e.i(389959);e.i(877212);var r=e.i(924908);e.i(925218);var i=e.i(802088);function o(e){var o=(0,t._)((0,n.useState)(null!=e?e:null),2),a=o[0],s=o[1],l=(0,t._)((0,n.useState)(),2),u=l[0],c=l[1],d=(0,r.useChatter)(),f=a?d.sessions.get(a):d.sessions.agent.current;return(0,i.useObserver)(f,{next:function(e){c(e)}}),{session:u,setSession:c,setSessionId:s}}e.s(["useCurrentSession",()=>o],391119);var a=e.i(878420),s=e.i(569384),l=e.i(973245),u=e.i(304277);e.i(566901);var c=e.i(951262);function d(){var e=(0,s._)(["\n  query AgentMainReplConfig($replId: String!) {\n    getRepl(id: $replId) {\n      ... on Repl {\n        id\n        origin {\n          id\n        }\n      }\n    }\n  }\n"]);return d=function(){return e},e}function f(){var e=(0,s._)(["\n  mutation UpdateReplConfig($input: UpdateReplInput!) {\n    updateRepl(input: $input) {\n      repl {\n        id\n        config {\n          isInPlanningPhase\n        }\n      }\n    }\n  }\n"]);return f=function(){return e},e}var p={},h=(0,l.gql)(d());function g(e){var t=(0,a._)({},p,e);return u.useQuery(h,t)}var m=(0,l.gql)(f());function x(e){var t=(0,a._)({},p,e);return c.useMutation(m,t)}function y(){var e=(0,s._)(["\n  fragment CurrentUserTipState on UserTipState {\n    id\n    title\n    description\n    content\n    tags\n    priority\n    timeRecommended\n    timeCompleted\n    timeDismissed\n    timeInteracted\n    externalUrl\n    ctaLabel\n    ctaTrigger\n  }\n"]);return y=function(){return e},e}e.s(["useAgentMainReplConfigQuery",()=>g,"useUpdateReplConfigMutation",()=>x],241939);var b=(0,l.gql)(y());function w(){var e=(0,s._)(["\n  query CurrentUserTips {\n    currentUser {\n      id\n      tips {\n        ... on UserTipsList {\n          tips {\n            ...CurrentUserTipState\n          }\n        }\n      }\n    }\n  }\n  ","\n"]);return w=function(){return e},e}var k={},_=(0,l.gql)(w(),b);function S(e){var t=(0,a._)({},k,e);return u.useQuery(_,t)}e.s(["useCurrentUserTipsQuery",()=>S],243202);var C=e.i(131141),j=e.i(541793),T=(0,j.atom)(new Map),E=(0,j.atom)(null,function(e,t,n,r){return t(T,function(e){return(0,C.produce)(e,function(e){null===r?e.delete(n):e.set(n,r)})})}),R=(0,j.atom)(null,function(e,t,n){return t(T,function(e){return(0,C.produce)(e,function(e){var t=!0,r=!1,i=void 0;try{for(var o,a=n[Symbol.iterator]();!(t=(o=a.next()).done);t=!0){var s=o.value;e.set(s,"exclude")}}catch(e){r=!0,i=e}finally{try{t||null==a.return||a.return()}finally{if(r)throw i}}})})});function I(){return(0,r.useSet)(R)}function A(){return(0,r.useSet)(E)}function P(){return(0,r.useValue)(T)}function D(){return(0,r.useGet)(T)}e.s(["useExcludeAllFileContextPreferences",()=>I,"useFileContextPreferences",()=>P,"useGetFileContextPreferences",()=>D,"useUpdateFileContextPreferences",()=>A],608572);var O={direction:"forward",state:{sessionCreatedAt:null,numPlansProposed:0},reducer:function(e,t){var n=e.contents.contents;switch(null==n?void 0:n.$kind){case"sessionCreationEventContents":t.sessionCreatedAt=new Date(e.created);return;case"agentPlanEventContents":if(!n.agentPlanEventContents.requiresApproval)return;t.numPlansProposed++}}},N={direction:"forward",state:{sessionCreatedAt:null,numPlansProposed:0},reducer:function(){return!1}};e.s(["NoOpPlanProposalReducer",()=>N,"PlanProposalReducer",()=>O],133930);var M=e.i(188507),L=e.i(374106),B=e.i(986194),V=e.i(641555),F=e.i(166876),U=e.i(231346),G={direction:"reverse",state:{taskListEventId:null,taskListData:null,approvedTaskListEventIds:new Set},map:function(e){return e.taskListData&&e.taskListEventId?{data:e.taskListData,eventId:e.taskListEventId}:void 0},reducer:function(e,t){if((0,L.isEventContentsKind)(e,"agentAskUserForActionResponse")){var n=(0,B.unkind)(e.contents.contents).response;if(n&&(0,B.isKind)(n,"approveTaskListResponse")&&t.approvedTaskListEventIds.add((0,B.unkind)(n).taskListEventId),n&&(0,B.isKind)(n,"approveInitialBuildMvpResponse"))return!1}var r=(0,L.getEventAgentToolDataFor)(e,"taskListData");if(null!=r)return!t.approvedTaskListEventIds.has(e.id)&&((0,F.isPlanModeProposedTaskList)(r)&&(t.taskListData=r,t.taskListEventId=e.id),!1)}};function $(e){return(0,V.useObservableMemo)(function(){return null==e?void 0:e.reduce(G,100)},[e],{default:void 0})}var z={direction:"reverse",state:{taskListEventId:null,taskListData:null,approvedTaskListEventIds:new Set},map:function(e){var t;return null!=(t=e.taskListData)?t:void 0},reducer:function(e,t){if((0,L.isEventContentsKind)(e,"agentAskUserForActionResponse")){var n=(0,B.unkind)(e.contents.contents).response;if(n&&((0,B.isKind)(n,"approveInitialBuildVisualPhaseResponse")||(0,B.isKind)(n,"approveInitialBuildMvpResponse")))return!1}var r=(0,L.getEventAgentToolDataFor)(e,"taskListData");if(null!=r)return r.agentMode===M.AgentMode.AGENT_MODE_GENERAL&&(t.taskListData=r),!1}};function H(e){var t,n=(0,U.useIsInitialAgentSession)(null!=(t=null==e?void 0:e.id)?t:null);return(0,V.useObservableMemo)(function(){return n?null==e?void 0:e.reduce(z,100):void 0},[e,n],{default:void 0})}e.s(["useInitialBuildProposedTaskList",()=>H,"usePlanModeProposedTaskList",()=>$],681128);var W=e.i(297083),q=e.i(346715),K=e.i(817556),Y=e.i(644920),Q=e.i(98816);function X(e){var r=e.recentFilesObservable,i=e.getFileContext,o=e.assistantMode,a=void 0===o?"advanced":o,s=(0,Q.default)(i),l=D(),u=P(),c=(0,t._)((0,n.useState)([]),2),d=c[0],f=c[1];return(0,n.useEffect)(function(){var e=function(e){return(0,W._)(function(){var n,r;return(0,K._)(this,function(i){switch(i.label){case 0:return[4,null==(n=s.current)?void 0:n.call(s,{modelType:"advanced"===a?M.ModelType.ADVANCED:M.ModelType.BASIC,filePreferences:u,recentFiles:e})];case 1:if(!(r=i.sent()))return[2];return f(function(e){var n=e.filePreferences,r=e.fileContextState,i=new Map(r.fileContext.map(function(e){return[e.filePath,"included"]})),o=!0,a=!1,s=void 0;try{for(var l,u=n[Symbol.iterator]();!(o=(l=u.next()).done);o=!0){var c=(0,t._)(l.value,2),d=c[0],f=c[1];if("exclude"===f){i.delete(d);continue}if(r.unsupportedPreferredFiles.has(d)){i.set(d,"unsupported");continue}i.set(d,"included"===i.get(d)?"included":"overflowing")}}catch(e){a=!0,s=e}finally{try{o||null==u.return||u.return()}finally{if(a)throw s}}return(0,q._)(i.entries()).map(function(e){var n=(0,t._)(e,2);return{path:n[0],inclusionStatus:n[1]}})}({fileContextState:r,filePreferences:u})),[2]}})})()};return e(r.current),r.subscribe((0,Y.default)(e,{wait:2e3}))},[r,u,a,s]),{fileContextInclusions:d,getFileContext:(0,n.useMemo)(function(){return function(){return i({modelType:"advanced"===a?M.ModelType.ADVANCED:M.ModelType.BASIC,filePreferences:l(),recentFiles:r.current})}},[i,l,a,r])}}e.s(["useFileContext",()=>X],153277)},212596,779056,331148,940177,490338,390027,e=>{"use strict";var t=e.i(297083),n=e.i(817556),r=e.i(389959),i=e.i(568817),o=e.i(292849),a=e.i(1736),s=e.i(965863);function l(e){var l=(0,s.useGetRecentFiles)(),u=(0,a.useShouldHideFileInWorkspace)();return(0,r.useCallback)(function(r){return(0,t._)(function(){var t,a,s,c,d;return(0,n._)(this,function(n){switch(n.label){case 0:return[4,e.listFiles()];case 1:if((t=n.sent()).error||!t.files)return[2,{error:null!=(a=t.error)?a:"Something went wrong",files:null}];if(s=t.files.filter(function(e){return!u(e)}),!r)return[3,3];return[4,(0,o.filterFiles)(r,s)];case 2:return d=n.sent(),[3,4];case 3:d=(0,i.default)(s,{existing:l(),getKey:function(e){return e}}).map(function(e){return{path:e}}),n.label=4;case 4:return c=d,[2,{total:s.length,files:c,error:null}]}})})()},[e,u,l])}e.s(["useFindFiles",()=>l],212596);var u=e.i(167626);e.i(242933);var c=new(e.i(790164)).ObservableState(new Map);function d(e){var t=e.type,n=e.position,i=void 0===n?"bottom":n,o=(0,r.useRef)(null);return(0,r.useEffect)(function(){var e=o.current;if((0,u._)(e,HTMLElement))return c.update(function(n){var r=new Map(n);return r.set(t,{element:e,position:i}),r}),function(){c.update(function(n){var r,i=new Map(n);return(null==(r=i.get(t))?void 0:r.element)===e&&i.delete(t),i})}},[t,i]),o}function f(e){var t=c.current.get(e);return null!=t?t:null}e.s(["getAnchorInfo",()=>f,"useRegisterPipAnchor",()=>d],779056);var p=e.i(886513),h=e.i(530658),g=e.i(346715),m=e.i(862927),x=e.i(188507),y=["package-lock.json","yarn.lock","poetry.lock","replit.nix",".breakpoints"],b=[".out",".pkl",".bin",".csv",".log",".zip",".tar",".gz"],w=["node_modules",".config","venv",".next",".git"];e.i(694906);var k=e.i(446692),_=e.i(205104),S=e.i(240913),C=e.i(664152);function j(e){var t=e.length;if(0===t)return!1;var n=0,r=Math.min(t,512);if(t>=3&&239===e[0]&&187===e[1]&&191===e[2]||t>=4&&0===e[0]&&0===e[1]&&254===e[2]&&255===e[3]||t>=4&&255===e[0]&&254===e[1]&&0===e[2]&&0===e[3]||t>=4&&132===e[0]&&49===e[1]&&149===e[2]&&51===e[3])return!1;if(r>=5&&"%PDF-"===e.slice(0,5).toString())return!0;if(t>=2&&254===e[0]&&255===e[1]||t>=2&&255===e[0]&&254===e[1])return!1;for(var i=0;i<r;i++)if(0===e[i])return!0;else if((e[i]<7||e[i]>14)&&(e[i]<32||e[i]>127)){if(e[i]>193&&e[i]<224&&i+1<r){if(e[++i]>127&&e[i]<192)continue}else if(e[i]>223&&e[i]<240&&i+2<r&&e[++i]>127&&e[i]<192&&e[i+1]>127&&e[i+1]<192){i++;continue}if(n++,i>=32&&100*n/r>10)return!0}return 100*n/r>10}e.s(["default",()=>j],331148);var T=m.Value.Create(x.RangeSchema);function E(e){return!(!(0,_.isOTFile)(e)||function(e){if("Dockerfile"===e.split("/").pop())return!1;var t=(0,_.getExt)(e),n=y.some(function(t){return e.endsWith(t)}),r=b.some(function(t){return e.endsWith(t)}),i=w.some(function(t){return e.split("/").some(function(e){return e===t})});return!t||n||r||i}(e))}function R(e){return(0,t._)(function(){var r,i,o,a,s,l,u,c,d,f,m,y,b,w,R,I,A,P,D,O,N,M,L,B,V,F,U,G,$,z,H,W,q,K,Y,Q,X,J,Z,ee,et,en,er,ei,eo,ea,es,el,eu,ec,ed,ef,ep,eh,eg,em;return(0,n._)(this,function(ev){switch(ev.label){case 0:r=e.filter,i=e.filePreferences,o=e.entrypoint,a=e.model,s=e.fs,l=e.targetedElementFile,u=(0,p._)(e,["filter","filePreferences","entrypoint","model","fs","targetedElementFile"]),c=a.limits.fileContextCharacters,d=[],f=[],m=new Set,y=!0,b=!1,w=void 0;try{for(R=i[Symbol.iterator]();!(y=(I=R.next()).done);y=!0){if(P=(A=(0,h._)(I.value,2))[0],D=A[1],"exclude"===D){d.push(P);continue}if(!E(P)){m.add(P);continue}f.push(P)}}catch(e){b=!0,w=e}finally{try{y||null==R.return||R.return()}finally{if(b)throw w}}O=[],N=!0,M=!1,L=void 0;try{for(B=u.recentFiles[Symbol.iterator]();!(N=(V=B.next()).done)&&((F=V.value,!(!d.includes(F)&&E(F)&&r(F)))||f.includes(F)||(O.push(F),3!==O.length));N=!0);}catch(e){M=!0,L=e}finally{try{N||null==B.return||B.return()}finally{if(M)throw L}}if(U=(0,g._)(f).concat((0,g._)(O)),l&&E(l)&&U.unshift(l),!(o&&U.length<10))return[3,2];return $=""===(G=(0,_.getParentPath)(o))?S.ROOT_PATH:G,[4,s.readDir($)];case 1:if(!(z=ev.sent()).error){H=0,W=!0,q=!1,K=void 0;try{for(Y=z.children[Symbol.iterator]();!(W=(Q=Y.next()).done)&&((X=Q.value,J=$===S.ROOT_PATH?X.filename:$+X.filename,!(!d.includes(J)&&E(J)&&r(J)))||U.includes(J)||(U.push(J),1!=++H));W=!0);}catch(e){q=!0,K=e}finally{try{W||null==Y.return||Y.return()}finally{if(q)throw K}}}ev.label=2;case 2:return C.logger.info("AI got file context",{numRecentFiles:O.length,numPreferredFiles:f.length,maxFiles:10}),Z=U.slice(0,10),ee=U.slice(10),[4,Promise.all(Z.map(function(e){return(0,t._)(function(){var t;return(0,n._)(this,function(n){return t=new Promise(function(e){return setTimeout(e,5e3)}),[2,Promise.race([Promise.all([s.readFile(e),function(){try{return s.getOTVersion(e)}catch(e){}return 0}()]),t])]})})()}))];case 3:for(eo=0,et=ev.sent(),en=c,er=[],ei=[];eo<Z.length;eo++){if(ea=Z[eo],!(es=et[eo])){C.logger.info("AI file read timeout",{filePath:ea});continue}if(eu=(el=(0,h._)(es,2))[0],ec=el[1],eu.error){C.logger.info("AI failed to read file",{filePath:ea});continue}if(j(eu.content.toBuffer())){C.logger.info("GhostwriterChat filtered out binary file",{filePath:ea});continue}if(en<=0){ee.push(ea);continue}if(ef=(ed=eu.content.toString()).slice(0,en),ep=ed.length>ef.length,em=null!=(eg=null==(eh=k.FileTypeRepository.from(ea))?void 0:eh.id)?eg:(0,_.getExt)(ea),ep){er.push(ea);continue}en-=ef.length,ei.push({filePath:ea,fileContent:ef,fileVersion:ec,language:em,referenceType:x.CodeReferenceType.FILE,code:"",range:T})}return[2,{fileContext:ei,preferredFiles:f,mostRecentFile:O.length?O[0]:void 0,truncatedFiles:er,overflowingFiles:ee,unsupportedPreferredFiles:m}]}})})()}e.s(["getFileContext",()=>R],940177);var I=e.i(906368),A=e.i(161322),P=e.i(709485),D=e.i(993796),O=e.i(222342),N=e.i(858248),M=e.i(69470),L=e.i(559491);function B(e){var t=e.context,n=(0,O.default)().showError,i=(0,A.useAtomValue)(M.visualSelectorIsActiveAtom),o=(0,A.useAtomValue)(M.selectorScriptLoadedAtom),a=(0,A.useAtomValue)(M.versionAtom),s=(0,A.useSetAtom)(M.setVisualSelectorElement),l=(0,A.useAtomValue)(M.visualSelectorElementAtom),u=(0,A.useAtomValue)(M.screenshotBlobAtom),c=(0,A.useSetAtom)(M.clearVisualSelectorElementAtom),d=(0,D.useFlag)({type:"string",controlName:"flag-cartographer-edits-version",default:"0.2.0"}),f=!!(null==a?void 0:a.includes("standalone")),p=!!(a&&a.localeCompare(d,void 0,{numeric:!0})>-1),h=!f&&p&&"agent"===t,g=(0,r.useCallback)(function(){try{c(),(0,L.sendClearSelectionMessage)()}catch(e){n("Failed to clear visual selection"),I.captureException(e)}},[n,c]),m=(0,r.useCallback)(function(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=r.isEditingEnabled,s=r.shouldClearSelection;try{if(!o){e&&n("Error loading visual selector");return}(void 0===s||s)&&g(),(0,L.sendToggleVisualEditorMessage)(e,h&&(void 0===i||i)),e&&(0,N.track)(P.events.VISUAL_SELECTOR,{action:"enabled",context:t,beaconVersion:a})}catch(e){n("Failed to enable visual selector"),I.captureException(e)}},[h,o,n,g,t,a]);return{isActive:i,isSelectorScriptLoaded:o,isEditingSupported:h,element:l,setElement:s,screenshotBlob:u,setVisualSelectorEnabled:m,clearSelection:g}}e.s(["useVisualSelector",()=>B],490338);var V=e.i(943565);function F(){}function U(){var e=(0,V.useFeatureGate)("agent_quick_edit_mode",!1),t=(0,A.useAtomValue)(M.isEditModeActiveAtom),n=(0,A.useSetAtom)(M.setIsEditModeActiveAtom);return e?{isEditModeActive:!1,setIsEditModeActive:F}:{isEditModeActive:t,setIsEditModeActive:n}}e.s(["useEditModeState",()=>U],390027)},811358,e=>{e.v({bordered:"TargetedElementEditor-module__DPqI0q__bordered",editor:"TargetedElementEditor-module__DPqI0q__editor",editorContainer:"TargetedElementEditor-module__DPqI0q__editorContainer",formField:"TargetedElementEditor-module__DPqI0q__formField",formRow:"TargetedElementEditor-module__DPqI0q__formRow",placeholder:"TargetedElementEditor-module__DPqI0q__placeholder",placeholderContainer:"TargetedElementEditor-module__DPqI0q__placeholderContainer",sectionTitle:"TargetedElementEditor-module__DPqI0q__sectionTitle"})},571821,831243,562994,470075,298643,405787,723100,78514,269815,177366,163945,e=>{"use strict";var t=e.i(530658),n=e.i(276385),r=e.i(161322),i=e.i(5561),o=e.i(140487),a=e.i(818503),s=e.i(625484),l=e.i(715664),u=e.i(95073),c=e.i(944583),d=e.i(220855);function f(){var e=(0,t._)((0,r.useAtom)(i.textAlignInputAtom),2),f=e[0],p=e[1];return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(a.Label,{color:"dimmer",children:"Alignment"}),(0,n.jsxs)(s.View,{gap:8,row:!0,children:[(0,n.jsx)(o.Button,{iconLeft:(0,n.jsx)(c.default,{}),text:"",variant:"left"===f?"default":"nofill",onClick:function(){return p("left")}}),(0,n.jsx)(o.Button,{iconLeft:(0,n.jsx)(l.default,{}),text:"",variant:"center"===f?"default":"nofill",onClick:function(){return p("center")}}),(0,n.jsx)(o.Button,{iconLeft:(0,n.jsx)(d.default,{}),text:"",variant:"right"===f?"default":"nofill",onClick:function(){return p("right")}}),(0,n.jsx)(o.Button,{iconLeft:(0,n.jsx)(u.default,{}),text:"",variant:"justify"===f?"default":"nofill",onClick:function(){return p("justify")}})]})]})}e.s(["AlignmentControls",()=>f],831243);var p=e.i(648788);function h(){var e=(0,t._)((0,r.useAtom)(i.backgroundColorInputAtom),2),o=e[0],a=e[1];return(0,n.jsx)(p.BaseColorInput,{label:"Background Color",color:o,setColor:a})}function g(){var e=(0,t._)((0,r.useAtom)(i.colorInputAtom),2),o=e[0],a=e[1];return(0,n.jsx)(p.BaseColorInput,{label:"Text Color",color:o,setColor:a})}e.s(["BackgroundColorInput",()=>h],562994),e.s(["TextColorInput",()=>g],470075);var m=e.i(607278);function x(){var e=(0,t._)((0,r.useAtom)(i.textContentInputAtom),2),o=e[0],l=e[1];return(0,n.jsxs)(s.View,{gap:4,children:[(0,n.jsx)(a.Label,{color:"dimmer",children:"Content"}),(0,n.jsx)(m.Input,{id:"content",value:null!=o?o:"",onChange:function(e){return l(e.target.value)}})]})}e.s(["ContentInput",()=>x],298643);var y=e.i(85742),b=e.i(12034),w=Array.from({length:85},function(e,t){return{id:t+12,name:"".concat(t+12,"px")}});function k(){var e=(0,t._)((0,r.useAtom)(i.fontSizeInpAtom),2),o=e[0],s=e[1];return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(a.Label,{color:"dimmer",children:"Font size"}),(0,n.jsx)(b.Select,{selectedKey:o,onSelectionChange:function(e){return s(Number(e))},"aria-label":"Font size",children:w.map(function(e){return(0,n.jsx)(y.ListBoxItem,{id:e.id,label:e.name},e.id)})})]})}e.s(["FontSizeInput",()=>k],405787);var _={100:"thin",200:"extralight",300:"light",400:"normal",500:"medium",600:"semibold",700:"bold",800:"extrabold",900:"black",normal:"normal",bold:"bold"},S=[{id:"normal",name:"Normal"},{id:"bold",name:"Bold"},{id:"100",name:"Thin"},{id:"200",name:"Extra Light"},{id:"300",name:"Light"},{id:"400",name:"Regular"},{id:"500",name:"Medium"},{id:"600",name:"Semi Bold"},{id:"700",name:"Bold"},{id:"800",name:"Extra Bold"},{id:"900",name:"Black"}];function C(e){return"font-".concat(_[e]||"normal")}function j(){var e=(0,t._)((0,r.useAtom)(i.fontWeightInputAtom),2),o=e[0],s=e[1];return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(a.Label,{color:"dimmer",children:"Font weight"}),(0,n.jsx)(b.Select,{selectedKey:o,onSelectionChange:function(e){return s(e)},"aria-label":"Font weight",children:S.map(function(e){return(0,n.jsx)(y.ListBoxItem,{id:e.id,label:e.name},e.id)})})]})}e.s(["fontWeights",()=>S,"getFontWeightTailwindClass",()=>C],723100),e.s(["FontStyleInput",()=>j],78514);var T=e.i(297083),E=e.i(817556),R=e.i(623474),I=e.i(389959),A=e.i(222342),P=e.i(971072),D=e.i(399978),O=e.i(529810),N=e.i(445059),M=e.i(759097),L=e.i(811358);function B(){var e=(0,t._)((0,r.useAtom)(i.imageSourceInputAtom),2),l=e[0],u=e[1],c=(0,A.default)().showError,d=(0,t._)((0,I.useState)(!1),2),f=d[0],p=d[1],h=(0,I.useRef)(null),g=(0,O.default)().fs;return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(a.Label,{color:"dimmer",children:"Source"}),(0,n.jsxs)(s.View,{className:L.default.formRow,children:[(0,n.jsx)(m.Input,{type:"url",value:l||"",onChange:function(e){u(e.target.value)},placeholder:"Enter image URL or upload..."}),(0,n.jsx)(o.Button,{variant:"outlined",stretch:!0,onClick:function(){var e;null==(e=h.current)||e.click()},disabled:f,iconLeft:(0,n.jsx)(M.default,{}),text:f?"Uploading...":"Upload Image"})]}),(0,n.jsx)("input",{style:{display:"none"},ref:h,accept:P.ACCEPTABLE_IMAGE_UPLOAD_TYPES.join(","),type:"file",onChange:function(e){var t=e.target,n=t.validity,r=t.files;return(0,T._)(function(){var e,t;return(0,E._)(this,function(i){switch(i.label){case 0:if(!n.valid||!r||0===(e=Array.from(r)).length||0===(t=e.filter(function(e){return P.ACCEPTABLE_IMAGE_UPLOAD_TYPES.includes(e.type)})).length)return[2];p(!0),i.label=1;case 1:return i.trys.push([1,3,4,5]),[4,new Promise(function(e,n){(0,D.uploadFiles)({files:t,fs:g,overwrite:!0,parentPath:N.ATTACHED_ASSETS_PATH,onError:function(e){return n(Error(e.error))},onDone:function(t){var r=t.uploads,i=t.errors;if(i.length>0)return void n(Error("Upload failed: ".concat(i[0].error)));if(r.length>0){var o=r[0].path;u(R.default.join(N.ATTACHED_ASSETS_PATH,R.default.basename(o)))}e(void 0)}})})];case 2:return i.sent(),[3,5];case 3:return i.sent(),c("Failed to upload image"),[3,5];case 4:return p(!1),[7];case 5:return[2]}})})()}})]})}e.s(["ImageInput",()=>B],269815);var V=e.i(3e5),F=e.i(941998);function U(){var e=(0,t._)((0,r.useAtom)(i.marginXInputAtom),2),o=e[0],l=e[1],u=(0,t._)((0,r.useAtom)(i.marginYInputAtom),2),c=u[0],d=u[1];return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(a.Label,{color:"dimmer",children:"Margin"}),(0,n.jsxs)(s.View,{className:L.default.formRow,children:[(0,n.jsx)(m.DecoratedInput,{iconLeft:(0,n.jsx)(V.default,{}),type:"number",value:null==o?void 0:o.toString(),onChange:function(e){return l(Number(e.target.value))}}),(0,n.jsx)(m.DecoratedInput,{iconLeft:(0,n.jsx)(F.default,{}),type:"number",value:null==c?void 0:c.toString(),onChange:function(e){return d(Number(e.target.value))}})]})]})}e.s(["MarginInput",()=>U],177366);var G=e.i(131940),$=e.i(363079);function z(){var e=(0,t._)((0,r.useAtom)(i.paddingXInputAtom),2),o=e[0],l=e[1],u=(0,t._)((0,r.useAtom)(i.paddingYInputAtom),2),c=u[0],d=u[1];return(0,n.jsxs)(s.View,{className:L.default.formField,children:[(0,n.jsx)(a.Label,{color:"dimmer",children:"Padding"}),(0,n.jsxs)(s.View,{className:L.default.formRow,children:[(0,n.jsx)(m.DecoratedInput,{iconLeft:(0,n.jsx)(G.default,{}),type:"number",value:null==o?void 0:o.toString(),onChange:function(e){return l(Number(e.target.value))}}),(0,n.jsx)(m.DecoratedInput,{iconLeft:(0,n.jsx)($.default,{}),type:"number",value:null==c?void 0:c.toString(),onChange:function(e){return d(Number(e.target.value))}})]})]})}e.s(["PaddingInput",()=>z],163945),e.s([],571821)},939652,691626,619231,445735,921760,274808,357993,603969,808547,e=>{"use strict";var t,n=e.i(297083),r=e.i(817556),i=e.i(389959),o=e.i(188507),a=e.i(877212),s=e.i(970187),l=e.i(765695),u=e.i(940177),c=e.i(608572);e.i(312917);var d=e.i(619319),f=e.i(487824),p=e.i(529810),h=e.i(69470),g=e.i(490338),m=e.i(559491),x=e.i(530658),y=e.i(276385),b=e.i(161322),w=e.i(390027),k=e.i(165579),_=e.i(5561);e.i(571821);var S=e.i(831243),C=e.i(562994),j=e.i(298643),T=e.i(405787),E=e.i(78514),R=e.i(269815),I=e.i(177366),A=e.i(163945),P=e.i(470075),D=e.i(414699),O=e.i(878420),N=e.i(346715),M=function(e){var t=F(e),n=e.conflictingClassGroups,r=e.conflictingClassGroupModifiers;return{getClassGroupId:function(e){var n=e.split("-");return""===n[0]&&1!==n.length&&n.shift(),L(n,t)||V(e)},getConflictingClassGroupIds:function(e,t){var i=n[e]||[];return t&&r[e]?(0,N._)(i).concat((0,N._)(r[e])):i}}},L=function(e,t){if(0===e.length)return t.classGroupId;var n,r=e[0],i=t.nextPart.get(r),o=i?L(e.slice(1),i):void 0;if(o)return o;if(0!==t.validators.length){var a=e.join("-");return null==(n=t.validators.find(function(e){return(0,e.validator)(a)}))?void 0:n.classGroupId}},B=/^\[(.+)\]$/,V=function(e){if(B.test(e)){var t=B.exec(e)[1],n=null==t?void 0:t.substring(0,t.indexOf(":"));if(n)return"arbitrary.."+n}},F=function(e){var t=e.theme,n=e.classGroups,r={nextPart:new Map,validators:[]};for(var i in n)U(n[i],r,i,t);return r},U=function(e,t,n,r){e.forEach(function(e){if("string"==typeof e){(""===e?t:G(t,e)).classGroupId=n;return}"function"==typeof e?$(e)?U(e(r),t,n,r):t.validators.push({validator:e,classGroupId:n}):Object.entries(e).forEach(function(e){var i=(0,x._)(e,2),o=i[0];U(i[1],G(t,o),n,r)})})},G=function(e,t){var n=e;return t.split("-").forEach(function(e){n.nextPart.has(e)||n.nextPart.set(e,{nextPart:new Map,validators:[]}),n=n.nextPart.get(e)}),n},$=function(e){return e.isThemeGetter},z=function(e){if(e<1)return{get:function(){},set:function(){}};var t=0,n=new Map,r=new Map,i=function(i,o){n.set(i,o),++t>e&&(t=0,r=n,n=new Map)};return{get:function(e){var t=n.get(e);return void 0!==t?t:void 0!==(t=r.get(e))?(i(e,t),t):void 0},set:function(e,t){n.has(e)?n.set(e,t):i(e,t)}}},H=function(e){var t=e.prefix,n=e.experimentalParseClassName,r=function(e){for(var t,n=[],r=0,i=0,o=0,a=0;a<e.length;a++){var s=e[a];if(0===r&&0===i){if(":"===s){n.push(e.slice(o,a)),o=a+1;continue}if("/"===s){t=a;continue}}"["===s?r++:"]"===s?r--:"("===s?i++:")"===s&&i--}var l=0===n.length?e:e.substring(o),u=W(l);return{modifiers:n,hasImportantModifier:u!==l,baseClassName:u,maybePostfixModifierPosition:t&&t>o?t-o:void 0}};if(t){var i=t+":",o=r;r=function(e){return e.startsWith(i)?o(e.substring(i.length)):{isExternal:!0,modifiers:[],hasImportantModifier:!1,baseClassName:e,maybePostfixModifierPosition:void 0}}}if(n){var a=r;r=function(e){return n({className:e,parseClassName:a})}}return r},W=function(e){return e.endsWith("!")?e.substring(0,e.length-1):e.startsWith("!")?e.substring(1):e},q=function(e){var t=Object.fromEntries(e.orderSensitiveModifiers.map(function(e){return[e,!0]}));return function(e){if(e.length<=1)return e;var n=[],r=[];return e.forEach(function(e){"["===e[0]||t[e]?(n.push.apply(n,(0,N._)(r.sort()).concat([e])),r=[]):r.push(e)}),n.push.apply(n,(0,N._)(r.sort())),n}},K=/\s+/,Y=function(e,t){for(var n=t.parseClassName,r=t.getClassGroupId,i=t.getConflictingClassGroupIds,o=t.sortModifiers,a=[],s=e.trim().split(K),l="",u=s.length-1;u>=0;u-=1){var c=s[u],d=n(c),f=d.isExternal,p=d.modifiers,h=d.hasImportantModifier,g=d.baseClassName,m=d.maybePostfixModifierPosition;if(f){l=c+(l.length>0?" "+l:l);continue}var x=!!m,y=r(x?g.substring(0,m):g);if(!y){if(!x||!(y=r(g))){l=c+(l.length>0?" "+l:l);continue}x=!1}var b=o(p).join(":"),w=h?b+"!":b,k=w+y;if(!a.includes(k)){a.push(k);for(var _=i(y,x),S=0;S<_.length;++S){var C=_[S];a.push(w+C)}l=c+(l.length>0?" "+l:l)}}return l};function Q(){for(var e,t,n=0,r="";n<arguments.length;)(e=arguments[n++])&&(t=X(e))&&(r&&(r+=" "),r+=t);return r}var X=function(e){if("string"==typeof e)return e;for(var t,n="",r=0;r<e.length;r++)e[r]&&(t=X(e[r]))&&(n&&(n+=" "),n+=t);return n},J=function(e){var t=function(t){return t[e]||[]};return t.isThemeGetter=!0,t},Z=/^\[(?:(\w[\w-]*):)?(.+)\]$/i,ee=/^\((?:(\w[\w-]*):)?(.+)\)$/i,et=/^\d+\/\d+$/,en=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,er=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,ei=/^(rgba?|hsla?|hwb|(ok)?(lab|lch))\(.+\)$/,eo=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,ea=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,es=function(e){return et.test(e)},el=function(e){return!!e&&!Number.isNaN(Number(e))},eu=function(e){return!!e&&Number.isInteger(Number(e))},ec=function(e){return e.endsWith("%")&&el(e.slice(0,-1))},ed=function(e){return en.test(e)},ef=function(){return!0},ep=function(e){return er.test(e)&&!ei.test(e)},eh=function(){return!1},eg=function(e){return eo.test(e)},em=function(e){return ea.test(e)},ev=function(e){return!ey(e)&&!eC(e)},ex=function(e){return eP(e,eM,eh)},ey=function(e){return Z.test(e)},eb=function(e){return eP(e,eL,ep)},ew=function(e){return eP(e,eB,el)},ek=function(e){return eP(e,eO,eh)},e_=function(e){return eP(e,eN,em)},eS=function(e){return eP(e,eF,eg)},eC=function(e){return ee.test(e)},ej=function(e){return eD(e,eL)},eT=function(e){return eD(e,eV)},eE=function(e){return eD(e,eO)},eR=function(e){return eD(e,eM)},eI=function(e){return eD(e,eN)},eA=function(e){return eD(e,eF,!0)},eP=function(e,t,n){var r=Z.exec(e);return!!r&&(r[1]?t(r[1]):n(r[2]))},eD=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=ee.exec(e);return!!r&&(r[1]?t(r[1]):n)},eO=function(e){return"position"===e||"percentage"===e},eN=function(e){return"image"===e||"url"===e},eM=function(e){return"length"===e||"size"===e||"bg-size"===e},eL=function(e){return"length"===e},eB=function(e){return"number"===e},eV=function(e){return"family-name"===e},eF=function(e){return"shadow"===e},eU=function(e){for(var t,n,r,i=arguments.length,o=Array(i>1?i-1:0),a=1;a<i;a++)o[a-1]=arguments[a];var s=function(i){var a;return a=o.reduce(function(e,t){return t(e)},e()),n=(t=(0,O._)({cache:z(a.cacheSize),parseClassName:H(a),sortModifiers:q(a)},M(a))).cache.get,r=t.cache.set,s=l,l(i)};function l(e){var i=n(e);if(i)return i;var o=Y(e,t);return r(e,o),o}return function(){return s(Q.apply(null,arguments))}}(function(){var e=J("color"),t=J("font"),n=J("text"),r=J("font-weight"),i=J("tracking"),o=J("leading"),a=J("breakpoint"),s=J("container"),l=J("spacing"),u=J("radius"),c=J("shadow"),d=J("inset-shadow"),f=J("text-shadow"),p=J("drop-shadow"),h=J("blur"),g=J("perspective"),m=J("aspect"),x=J("ease"),y=J("animate"),b=function(){return["auto","avoid","all","avoid-page","page","left","right","column"]},w=function(){return["center","top","bottom","left","right","top-left","left-top","top-right","right-top","bottom-right","right-bottom","bottom-left","left-bottom"]},k=function(){return(0,N._)(w()).concat([eC,ey])},_=function(){return["auto","hidden","clip","visible","scroll"]},S=function(){return["auto","contain","none"]},C=function(){return[eC,ey,l]},j=function(){return[es,"full","auto"].concat((0,N._)(C()))},T=function(){return[eu,"none","subgrid",eC,ey]},E=function(){return["auto",{span:["full",eu,eC,ey]},eu,eC,ey]},R=function(){return[eu,"auto",eC,ey]},I=function(){return["auto","min","max","fr",eC,ey]},A=function(){return["start","end","center","between","around","evenly","stretch","baseline","center-safe","end-safe"]},P=function(){return["start","end","center","stretch","center-safe","end-safe"]},D=function(){return["auto"].concat((0,N._)(C()))},O=function(){return[es,"auto","full","dvw","dvh","lvw","lvh","svw","svh","min","max","fit"].concat((0,N._)(C()))},M=function(){return[e,eC,ey]},L=function(){return(0,N._)(w()).concat([eE,ek,{position:[eC,ey]}])},B=function(){return["no-repeat",{repeat:["","x","y","space","round"]}]},V=function(){return["auto","cover","contain",eR,ex,{size:[eC,ey]}]},F=function(){return[ec,ej,eb]},U=function(){return["","none","full",u,eC,ey]},G=function(){return["",el,ej,eb]},$=function(){return["solid","dashed","dotted","double"]},z=function(){return["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"]},H=function(){return[el,ec,eE,ek]},W=function(){return["","none",h,eC,ey]},q=function(){return["none",el,eC,ey]},K=function(){return["none",el,eC,ey]},Y=function(){return[el,eC,ey]},Q=function(){return[es,"full"].concat((0,N._)(C()))};return{cacheSize:500,theme:{animate:["spin","ping","pulse","bounce"],aspect:["video"],blur:[ed],breakpoint:[ed],color:[ef],container:[ed],"drop-shadow":[ed],ease:["in","out","in-out"],font:[ev],"font-weight":["thin","extralight","light","normal","medium","semibold","bold","extrabold","black"],"inset-shadow":[ed],leading:["none","tight","snug","normal","relaxed","loose"],perspective:["dramatic","near","normal","midrange","distant","none"],radius:[ed],shadow:[ed],spacing:["px",el],text:[ed],"text-shadow":[ed],tracking:["tighter","tight","normal","wide","wider","widest"]},classGroups:{aspect:[{aspect:["auto","square",es,ey,eC,m]}],container:["container"],columns:[{columns:[el,ey,eC,s]}],"break-after":[{"break-after":b()}],"break-before":[{"break-before":b()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],sr:["sr-only","not-sr-only"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:k()}],overflow:[{overflow:_()}],"overflow-x":[{"overflow-x":_()}],"overflow-y":[{"overflow-y":_()}],overscroll:[{overscroll:S()}],"overscroll-x":[{"overscroll-x":S()}],"overscroll-y":[{"overscroll-y":S()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:j()}],"inset-x":[{"inset-x":j()}],"inset-y":[{"inset-y":j()}],start:[{start:j()}],end:[{end:j()}],top:[{top:j()}],right:[{right:j()}],bottom:[{bottom:j()}],left:[{left:j()}],visibility:["visible","invisible","collapse"],z:[{z:[eu,"auto",eC,ey]}],basis:[{basis:[es,"full","auto",s].concat((0,N._)(C()))}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["nowrap","wrap","wrap-reverse"]}],flex:[{flex:[el,es,"auto","initial","none",ey]}],grow:[{grow:["",el,eC,ey]}],shrink:[{shrink:["",el,eC,ey]}],order:[{order:[eu,"first","last","none",eC,ey]}],"grid-cols":[{"grid-cols":T()}],"col-start-end":[{col:E()}],"col-start":[{"col-start":R()}],"col-end":[{"col-end":R()}],"grid-rows":[{"grid-rows":T()}],"row-start-end":[{row:E()}],"row-start":[{"row-start":R()}],"row-end":[{"row-end":R()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":I()}],"auto-rows":[{"auto-rows":I()}],gap:[{gap:C()}],"gap-x":[{"gap-x":C()}],"gap-y":[{"gap-y":C()}],"justify-content":[{justify:(0,N._)(A()).concat(["normal"])}],"justify-items":[{"justify-items":(0,N._)(P()).concat(["normal"])}],"justify-self":[{"justify-self":["auto"].concat((0,N._)(P()))}],"align-content":[{content:["normal"].concat((0,N._)(A()))}],"align-items":[{items:(0,N._)(P()).concat([{baseline:["","last"]}])}],"align-self":[{self:["auto"].concat((0,N._)(P()),[{baseline:["","last"]}])}],"place-content":[{"place-content":A()}],"place-items":[{"place-items":(0,N._)(P()).concat(["baseline"])}],"place-self":[{"place-self":["auto"].concat((0,N._)(P()))}],p:[{p:C()}],px:[{px:C()}],py:[{py:C()}],ps:[{ps:C()}],pe:[{pe:C()}],pt:[{pt:C()}],pr:[{pr:C()}],pb:[{pb:C()}],pl:[{pl:C()}],m:[{m:D()}],mx:[{mx:D()}],my:[{my:D()}],ms:[{ms:D()}],me:[{me:D()}],mt:[{mt:D()}],mr:[{mr:D()}],mb:[{mb:D()}],ml:[{ml:D()}],"space-x":[{"space-x":C()}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":C()}],"space-y-reverse":["space-y-reverse"],size:[{size:O()}],w:[{w:[s,"screen"].concat((0,N._)(O()))}],"min-w":[{"min-w":[s,"screen","none"].concat((0,N._)(O()))}],"max-w":[{"max-w":[s,"screen","none","prose",{screen:[a]}].concat((0,N._)(O()))}],h:[{h:["screen"].concat((0,N._)(O()))}],"min-h":[{"min-h":["screen","none"].concat((0,N._)(O()))}],"max-h":[{"max-h":["screen"].concat((0,N._)(O()))}],"font-size":[{text:["base",n,ej,eb]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:[r,eC,ew]}],"font-stretch":[{"font-stretch":["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded",ec,ey]}],"font-family":[{font:[eT,ey,t]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractions"],tracking:[{tracking:[i,eC,ey]}],"line-clamp":[{"line-clamp":[el,"none",eC,ew]}],leading:[{leading:[o].concat((0,N._)(C()))}],"list-image":[{"list-image":["none",eC,ey]}],"list-style-position":[{list:["inside","outside"]}],"list-style-type":[{list:["disc","decimal","none",eC,ey]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"placeholder-color":[{placeholder:M()}],"text-color":[{text:M()}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:(0,N._)($()).concat(["wavy"])}],"text-decoration-thickness":[{decoration:[el,"from-font","auto",eC,eb]}],"text-decoration-color":[{decoration:M()}],"underline-offset":[{"underline-offset":[el,"auto",eC,ey]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:C()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",eC,ey]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],wrap:[{wrap:["break-word","anywhere","normal"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",eC,ey]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:L()}],"bg-repeat":[{bg:B()}],"bg-size":[{bg:V()}],"bg-image":[{bg:["none",{linear:[{to:["t","tr","r","br","b","bl","l","tl"]},eu,eC,ey],radial:["",eC,ey],conic:[eu,eC,ey]},eI,e_]}],"bg-color":[{bg:M()}],"gradient-from-pos":[{from:F()}],"gradient-via-pos":[{via:F()}],"gradient-to-pos":[{to:F()}],"gradient-from":[{from:M()}],"gradient-via":[{via:M()}],"gradient-to":[{to:M()}],rounded:[{rounded:U()}],"rounded-s":[{"rounded-s":U()}],"rounded-e":[{"rounded-e":U()}],"rounded-t":[{"rounded-t":U()}],"rounded-r":[{"rounded-r":U()}],"rounded-b":[{"rounded-b":U()}],"rounded-l":[{"rounded-l":U()}],"rounded-ss":[{"rounded-ss":U()}],"rounded-se":[{"rounded-se":U()}],"rounded-ee":[{"rounded-ee":U()}],"rounded-es":[{"rounded-es":U()}],"rounded-tl":[{"rounded-tl":U()}],"rounded-tr":[{"rounded-tr":U()}],"rounded-br":[{"rounded-br":U()}],"rounded-bl":[{"rounded-bl":U()}],"border-w":[{border:G()}],"border-w-x":[{"border-x":G()}],"border-w-y":[{"border-y":G()}],"border-w-s":[{"border-s":G()}],"border-w-e":[{"border-e":G()}],"border-w-t":[{"border-t":G()}],"border-w-r":[{"border-r":G()}],"border-w-b":[{"border-b":G()}],"border-w-l":[{"border-l":G()}],"divide-x":[{"divide-x":G()}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":G()}],"divide-y-reverse":["divide-y-reverse"],"border-style":[{border:(0,N._)($()).concat(["hidden","none"])}],"divide-style":[{divide:(0,N._)($()).concat(["hidden","none"])}],"border-color":[{border:M()}],"border-color-x":[{"border-x":M()}],"border-color-y":[{"border-y":M()}],"border-color-s":[{"border-s":M()}],"border-color-e":[{"border-e":M()}],"border-color-t":[{"border-t":M()}],"border-color-r":[{"border-r":M()}],"border-color-b":[{"border-b":M()}],"border-color-l":[{"border-l":M()}],"divide-color":[{divide:M()}],"outline-style":[{outline:(0,N._)($()).concat(["none","hidden"])}],"outline-offset":[{"outline-offset":[el,eC,ey]}],"outline-w":[{outline:["",el,ej,eb]}],"outline-color":[{outline:M()}],shadow:[{shadow:["","none",c,eA,eS]}],"shadow-color":[{shadow:M()}],"inset-shadow":[{"inset-shadow":["none",d,eA,eS]}],"inset-shadow-color":[{"inset-shadow":M()}],"ring-w":[{ring:G()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:M()}],"ring-offset-w":[{"ring-offset":[el,eb]}],"ring-offset-color":[{"ring-offset":M()}],"inset-ring-w":[{"inset-ring":G()}],"inset-ring-color":[{"inset-ring":M()}],"text-shadow":[{"text-shadow":["none",f,eA,eS]}],"text-shadow-color":[{"text-shadow":M()}],opacity:[{opacity:[el,eC,ey]}],"mix-blend":[{"mix-blend":(0,N._)(z()).concat(["plus-darker","plus-lighter"])}],"bg-blend":[{"bg-blend":z()}],"mask-clip":[{"mask-clip":["border","padding","content","fill","stroke","view"]},"mask-no-clip"],"mask-composite":[{mask:["add","subtract","intersect","exclude"]}],"mask-image-linear-pos":[{"mask-linear":[el]}],"mask-image-linear-from-pos":[{"mask-linear-from":H()}],"mask-image-linear-to-pos":[{"mask-linear-to":H()}],"mask-image-linear-from-color":[{"mask-linear-from":M()}],"mask-image-linear-to-color":[{"mask-linear-to":M()}],"mask-image-t-from-pos":[{"mask-t-from":H()}],"mask-image-t-to-pos":[{"mask-t-to":H()}],"mask-image-t-from-color":[{"mask-t-from":M()}],"mask-image-t-to-color":[{"mask-t-to":M()}],"mask-image-r-from-pos":[{"mask-r-from":H()}],"mask-image-r-to-pos":[{"mask-r-to":H()}],"mask-image-r-from-color":[{"mask-r-from":M()}],"mask-image-r-to-color":[{"mask-r-to":M()}],"mask-image-b-from-pos":[{"mask-b-from":H()}],"mask-image-b-to-pos":[{"mask-b-to":H()}],"mask-image-b-from-color":[{"mask-b-from":M()}],"mask-image-b-to-color":[{"mask-b-to":M()}],"mask-image-l-from-pos":[{"mask-l-from":H()}],"mask-image-l-to-pos":[{"mask-l-to":H()}],"mask-image-l-from-color":[{"mask-l-from":M()}],"mask-image-l-to-color":[{"mask-l-to":M()}],"mask-image-x-from-pos":[{"mask-x-from":H()}],"mask-image-x-to-pos":[{"mask-x-to":H()}],"mask-image-x-from-color":[{"mask-x-from":M()}],"mask-image-x-to-color":[{"mask-x-to":M()}],"mask-image-y-from-pos":[{"mask-y-from":H()}],"mask-image-y-to-pos":[{"mask-y-to":H()}],"mask-image-y-from-color":[{"mask-y-from":M()}],"mask-image-y-to-color":[{"mask-y-to":M()}],"mask-image-radial":[{"mask-radial":[eC,ey]}],"mask-image-radial-from-pos":[{"mask-radial-from":H()}],"mask-image-radial-to-pos":[{"mask-radial-to":H()}],"mask-image-radial-from-color":[{"mask-radial-from":M()}],"mask-image-radial-to-color":[{"mask-radial-to":M()}],"mask-image-radial-shape":[{"mask-radial":["circle","ellipse"]}],"mask-image-radial-size":[{"mask-radial":[{closest:["side","corner"],farthest:["side","corner"]}]}],"mask-image-radial-pos":[{"mask-radial-at":w()}],"mask-image-conic-pos":[{"mask-conic":[el]}],"mask-image-conic-from-pos":[{"mask-conic-from":H()}],"mask-image-conic-to-pos":[{"mask-conic-to":H()}],"mask-image-conic-from-color":[{"mask-conic-from":M()}],"mask-image-conic-to-color":[{"mask-conic-to":M()}],"mask-mode":[{mask:["alpha","luminance","match"]}],"mask-origin":[{"mask-origin":["border","padding","content","fill","stroke","view"]}],"mask-position":[{mask:L()}],"mask-repeat":[{mask:B()}],"mask-size":[{mask:V()}],"mask-type":[{"mask-type":["alpha","luminance"]}],"mask-image":[{mask:["none",eC,ey]}],filter:[{filter:["","none",eC,ey]}],blur:[{blur:W()}],brightness:[{brightness:[el,eC,ey]}],contrast:[{contrast:[el,eC,ey]}],"drop-shadow":[{"drop-shadow":["","none",p,eA,eS]}],"drop-shadow-color":[{"drop-shadow":M()}],grayscale:[{grayscale:["",el,eC,ey]}],"hue-rotate":[{"hue-rotate":[el,eC,ey]}],invert:[{invert:["",el,eC,ey]}],saturate:[{saturate:[el,eC,ey]}],sepia:[{sepia:["",el,eC,ey]}],"backdrop-filter":[{"backdrop-filter":["","none",eC,ey]}],"backdrop-blur":[{"backdrop-blur":W()}],"backdrop-brightness":[{"backdrop-brightness":[el,eC,ey]}],"backdrop-contrast":[{"backdrop-contrast":[el,eC,ey]}],"backdrop-grayscale":[{"backdrop-grayscale":["",el,eC,ey]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[el,eC,ey]}],"backdrop-invert":[{"backdrop-invert":["",el,eC,ey]}],"backdrop-opacity":[{"backdrop-opacity":[el,eC,ey]}],"backdrop-saturate":[{"backdrop-saturate":[el,eC,ey]}],"backdrop-sepia":[{"backdrop-sepia":["",el,eC,ey]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":C()}],"border-spacing-x":[{"border-spacing-x":C()}],"border-spacing-y":[{"border-spacing-y":C()}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["","all","colors","opacity","shadow","transform","none",eC,ey]}],"transition-behavior":[{transition:["normal","discrete"]}],duration:[{duration:[el,"initial",eC,ey]}],ease:[{ease:["linear","initial",x,eC,ey]}],delay:[{delay:[el,eC,ey]}],animate:[{animate:["none",y,eC,ey]}],backface:[{backface:["hidden","visible"]}],perspective:[{perspective:[g,eC,ey]}],"perspective-origin":[{"perspective-origin":k()}],rotate:[{rotate:q()}],"rotate-x":[{"rotate-x":q()}],"rotate-y":[{"rotate-y":q()}],"rotate-z":[{"rotate-z":q()}],scale:[{scale:K()}],"scale-x":[{"scale-x":K()}],"scale-y":[{"scale-y":K()}],"scale-z":[{"scale-z":K()}],"scale-3d":["scale-3d"],skew:[{skew:Y()}],"skew-x":[{"skew-x":Y()}],"skew-y":[{"skew-y":Y()}],transform:[{transform:[eC,ey,"","none","gpu","cpu"]}],"transform-origin":[{origin:k()}],"transform-style":[{transform:["3d","flat"]}],translate:[{translate:Q()}],"translate-x":[{"translate-x":Q()}],"translate-y":[{"translate-y":Q()}],"translate-z":[{"translate-z":Q()}],"translate-none":["translate-none"],accent:[{accent:M()}],appearance:[{appearance:["none","auto"]}],"caret-color":[{caret:M()}],"color-scheme":[{scheme:["normal","dark","light","light-dark","only-dark","only-light"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",eC,ey]}],"field-sizing":[{"field-sizing":["fixed","content"]}],"pointer-events":[{"pointer-events":["auto","none"]}],resize:[{resize:["none","","y","x"]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":C()}],"scroll-mx":[{"scroll-mx":C()}],"scroll-my":[{"scroll-my":C()}],"scroll-ms":[{"scroll-ms":C()}],"scroll-me":[{"scroll-me":C()}],"scroll-mt":[{"scroll-mt":C()}],"scroll-mr":[{"scroll-mr":C()}],"scroll-mb":[{"scroll-mb":C()}],"scroll-ml":[{"scroll-ml":C()}],"scroll-p":[{"scroll-p":C()}],"scroll-px":[{"scroll-px":C()}],"scroll-py":[{"scroll-py":C()}],"scroll-ps":[{"scroll-ps":C()}],"scroll-pe":[{"scroll-pe":C()}],"scroll-pt":[{"scroll-pt":C()}],"scroll-pr":[{"scroll-pr":C()}],"scroll-pb":[{"scroll-pb":C()}],"scroll-pl":[{"scroll-pl":C()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",eC,ey]}],fill:[{fill:["none"].concat((0,N._)(M()))}],"stroke-w":[{stroke:[el,ej,eb,ew]}],stroke:[{stroke:["none"].concat((0,N._)(M()))}],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-x","border-w-y","border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-x","border-color-y","border-color-s","border-color-e","border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],translate:["translate-x","translate-y","translate-none"],"translate-none":["translate","translate-x","translate-y","translate-z"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]},orderSensitiveModifiers:["*","**","after","backdrop","before","details-content","file","first-letter","first-line","marker","placeholder","selection"]}}),eG=e.i(709485),e$=e.i(664152),ez=e.i(858248),eH=e.i(445059),eW=e.i(723100),eq=e.i(924908);e.i(925218);var eK=e.i(267103),eY=e.i(993796),eQ=e.i(222342);function eX(){var e=(0,eq.useChatter)(),t=(0,eQ.default)().showError,a=(0,eK.useObservable)(e.sessions.agent.current),s=(0,eY.useFlag)({controlName:"flag-visual-editor-quick-edits",default:!1});return{handlePrompt:(0,i.useCallback)(function(e,i){return(0,n._)(function(){return(0,r._)(this,function(n){switch(n.label){case 0:if(n.trys.push([0,2,,3]),!a)throw Error("No agent session found");return[4,a.appendEvent({kind:"message",intent:o.MessageAction.AGENT,message:e,webviewTargetedElement:i,quickEdit:s})];case 1:return n.sent(),[3,3];case 2:return n.sent(),t("Failed to send editor message"),[3,3];case 3:return[2]}})})()},[a,t,s])}}var eJ=e.i(927158),eZ=e.i(140487),e0=e.i(258941),e1=e.i(739521),e2=e.i(929872),e3=e.i(960178),e4=e.i(751273),e8=e.i(625484),e5=e.i(283110),e6=e.i(703505),e9=e.i(811358);function e7(e){var t,a,s,l,u,c,d,f,p,O,N,M,L,B,V,F,U=e.hasQuickEditFeature,G=e.openPane,$=(0,w.useEditModeState)().isEditModeActive,z=!U,H=(0,g.useVisualSelector)({context:"agent"}),W=H.isEditingSupported,q=H.element,K=H.setElement,Y=(0,b.useAtomValue)(h.selectedElementMetadataAtom),Q=(0,x._)((0,i.useState)(!1),2),X=Q[0],J=Q[1],Z=eX().handlePrompt,ee=(t=(0,b.useAtomValue)(h.visualSelectorStateAtom),a=(0,b.useSetAtom)(h.setVisualSelectorElement),s=(0,b.useAtomValue)(_.editorStateAtom),l=(0,b.useAtomValue)(_.styleAttributesAtom),O=(u=(0,eQ.default)().showError,c=(0,eJ.usePid2Callback)(function(e,t){return function(t,i,o){return(0,n._)(function(){var n;return(0,r._)(this,function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,e.visualEditor.updateClassName.rpc({elementMetadata:t,newClassName:i,originalClassName:o})];case 1:if(!r.sent().ok)return u("Failed to update class name"),[2,!1];return[2,!0];case 2:return n=r.sent(),e$.logger.error("[Visual Editor] Failed to update class name",n),u("Failed to update class name"),[2,!1];case 3:return[2]}})})()}},[u]),d=(0,eJ.usePid2Callback)(function(e,t){return function(t,i,o){return(0,n._)(function(){var n;return(0,r._)(this,function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,e.visualEditor.updateTextContent.rpc({elementMetadata:t,newText:i,originalText:o})];case 1:if(!r.sent().ok)return u("Failed to update text content"),[2,!1];return[2,!0];case 2:return n=r.sent(),e$.logger.error("[Visual Editor] Failed to update text content",n),u("Failed to update text content"),[2,!1];case 3:return[2]}})})()}},[u]),f=(0,eJ.usePid2Callback)(function(e,t){return function(t,i,o,a){return(0,n._)(function(){var n;return(0,r._)(this,function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,e.visualEditor.updateImageSrc.rpc({elementMetadata:t,newImagePath:i,originalSrc:o,isUrl:a})];case 1:if(!r.sent().ok)return u("Failed to update image source"),[2,!1];return[2,!0];case 2:return n=r.sent(),e$.logger.error("[Visual Editor] Failed to update image source",n),u("Failed to update image source"),[2,!1];case 3:return[2]}})})()}},[u]),p={updateClassName:function(e,t,i){return(0,n._)(function(){return(0,r._)(this,function(n){return c?[2,c(e,t,i)]:[2,!1]})})()},updateTextContent:function(e,t,i){return(0,n._)(function(){return(0,r._)(this,function(n){return d?[2,d(e,t,i)]:[2,!1]})})()},updateImageSrc:function(e,t,i,o){return(0,n._)(function(){return(0,r._)(this,function(n){return f?[2,f(e,t,i,o)]:[2,!1]})})()}}).updateClassName,N=p.updateTextContent,M=p.updateImageSrc,L=eX().handlePrompt,F=(B=(0,eq.useChatter)(),V=(0,eK.useObservable)(B.sessions.agent.current),{sendCheckpointEvent:(0,i.useCallback)(function(){return(0,n._)(function(){var e;return(0,r._)(this,function(t){switch(t.label){case 0:if(!V)return[2];t.label=1;case 1:return t.trys.push([1,3,,4]),[4,V.appendEvent({kind:"triggerCheckpoint",description:"Visual edit",onlyIfDiff:!0,author:o.CommitAuthor.COMMIT_AUTHOR_AGENT})];case 2:return t.sent(),[3,4];case 3:return e=t.sent(),e$.logger.warn("Failed to send checkpoint event:",e),[3,4];case 4:return[2]}})})()},[V])}).sendCheckpointEvent,{saveChanges:function(){return(0,n._)(function(){var e,n,i,o,u,c,d,f,p,h,g,y,b,w,k,_,S,C,j,T;return(0,r._)(this,function(r){switch(r.label){case 0:e=[],r.label=1;case 1:if(r.trys.push([1,15,16,17]),(null==t||null==(n=t.metadata)?void 0:n.textContent)===s.textContent)return[3,4];if(!((null==t||null==(d=t.metadata)?void 0:d.elementPath)&&s.textContent))return[3,3];return[4,N(t.metadata.elementPath,s.textContent,t.metadata.textContent)];case 2:return r.sent()?(0,ez.track)(eG.events.VISUAL_SELECTOR,{action:"edit",editType:"text",method:"deterministic"}):((0,ez.track)(eG.events.VISUAL_SELECTOR,{action:"edit",editType:"text",method:"fallback"}),e.push({type:"text",oldText:t.metadata.textContent,newText:s.textContent})),[3,4];case 3:s.textContent&&((0,ez.track)(eG.events.VISUAL_SELECTOR,{action:"edit",editType:"text",method:"fallback",reason:"missing_path"}),e.push({type:"text",oldText:null==t||null==(f=t.metadata)?void 0:f.textContent,newText:s.textContent})),r.label=4;case 4:if((h=Object.entries(l).reduce(function(e,t){var n=(0,x._)(t,2),r=n[0],i=n[1];switch(r){case"font-size":case"color":return eU(e,"text-[".concat(i,"]"));case"font-weight":return eU(e,(0,eW.getFontWeightTailwindClass)(i));case"text-align":return eU(e,"text-".concat(i));case"background-color":return eU(e,"bg-[".concat(i,"]"));case"margin-left":return eU(e,"ml-[".concat(i,"]"));case"margin-right":return eU(e,"mr-[".concat(i,"]"));case"margin-top":return eU(e,"mt-[".concat(i,"]"));case"margin-bottom":return eU(e,"mb-[".concat(i,"]"));case"padding-left":return eU(e,"pl-[".concat(i,"]"));case"padding-right":return eU(e,"pr-[".concat(i,"]"));case"padding-top":return eU(e,"pt-[".concat(i,"]"));case"padding-bottom":return eU(e,"pb-[".concat(i,"]"));default:return e}},null!=(p=null==t||null==(i=t.metadata)?void 0:i.className)?p:""))===(null==t||null==(o=t.metadata)?void 0:o.className))return[3,7];if(!(null==t||null==(g=t.metadata)?void 0:g.elementPath))return[3,6];return[4,O(t.metadata.elementPath,h,t.metadata.className)];case 5:return r.sent()?(0,ez.track)(eG.events.VISUAL_SELECTOR,{action:"edit",editType:"style",method:"deterministic"}):((0,ez.track)(eG.events.VISUAL_SELECTOR,{action:"edit",editType:"style",method:"fallback"}),e.push({type:"style",oldClassName:t.metadata.className,newClassName:h})),[3,7];case 6:(0,ez.track)(eG.events.VISUAL_SELECTOR,{action:"edit",editType:"style",method:"fallback",reason:"missing_path"}),e.push({type:"style",oldClassName:null!=(b=null==t||null==(y=t.metadata)?void 0:y.className)?b:"Unknown",newClassName:h}),r.label=7;case 7:if(!((null==t||null==(u=t.metadata)?void 0:u.srcAttribute)!==s.imageSrc&&s.imageSrc&&(null==t||null==(c=t.metadata)?void 0:c.elementPath)))return[3,9];return k=!(null==(w=s.imageSrc)?void 0:w.startsWith(eH.ATTACHED_ASSETS_PATH)),[4,M(t.metadata.elementPath,s.imageSrc,t.metadata.srcAttribute,k)];case 8:r.sent()?(0,ez.track)(eG.events.VISUAL_SELECTOR,{action:"edit",editType:"image",method:"deterministic"}):((0,ez.track)(eG.events.VISUAL_SELECTOR,{action:"edit",editType:"image",method:"fallback"}),e.push({type:"image",newSrc:s.imageSrc})),r.label=9;case 9:if(!(e.length>0&&t))return[3,13];if(_="Please update this element with the following changes:\n\n",(S=e.filter(function(e){return"text"===e.type})).length>0&&(_+="Text Content Changes:\n",S.forEach(function(e){_+='- Change text from "'.concat(e.oldText,'" to "').concat(e.newText,'"\n')}),_+="\n"),(C=e.filter(function(e){return"style"===e.type})).length>0&&(_+="Style Changes:\n",C.forEach(function(e){_+='- Update classes from "'.concat(e.oldClassName,'" to "').concat(e.newClassName,'"\n')}),_+="\n"),(j=e.filter(function(e){return"image"===e.type})).length>0&&(_+="Image Source Changes:\n",j.forEach(function(e){_+='- Update image source to "'.concat(e.newSrc,'"\n')}),_+="\n"),!t.element)return[3,11];return[4,L(_,t.element)];case 10:return r.sent(),[3,12];case 11:throw Error("Selected element is missing");case 12:return[3,14];case 13:F().catch(function(e){e$.logger.warn("Failed to create checkpoint:",e)}),r.label=14;case 14:return[3,17];case 15:return T=r.sent(),e$.logger.error("[Visual Editor] Failed to apply changes:",T),[3,17];case 16:return(0,m.clearElementDirtyState)(),setTimeout(function(){(0,m.sendClearSelectionMessage)()},50),a(null),[7];case 17:return[2]}})})()}}).saveChanges,et=(0,b.useAtomValue)(_.isEditorStateDirtyAtom),en=(0,D.useComponentVisibility)(Y),er=(0,i.useMemo)(function(){return Object.values(en).every(function(e){return!1===e})},[en]),ei=function(){J(!1)};return z&&$&&!q?(0,y.jsx)(e2.Surface,{clsx:e9.default.placeholderContainer,elevated:!0,children:(0,y.jsx)(e8.View,{clsx:e9.default.placeholder,align:"center",justify:"center",children:(0,y.jsx)(e3.Text,{color:"dimmer",children:"No element selected"})})}):q&&W&&q.filePath&&(!z||$)?(0,y.jsx)(e2.Surface,{clsx:[e9.default.editorContainer,e9.default.bordered],align:"center",elevated:!0,children:(0,y.jsxs)(e8.View,{clsx:e9.default.editor,p:12,children:[(0,y.jsxs)(e8.View,{row:!0,justify:"space-between",children:[(0,y.jsx)(e8.View,{children:(0,y.jsx)(k.TargetedElement,{targetedElement:q,openPane:G})}),(0,y.jsx)(eZ.Button,{text:"",iconLeft:(0,y.jsx)(e5.default,{}),variant:"nofill",onClick:function(){((0,m.sendClearSelectionMessage)(),z&&$)?K(null):(0,m.sendToggleVisualEditorMessage)(!1,!1)}})]}),er?(0,y.jsx)(e8.View,{p:8,children:(0,y.jsx)(e3.Text,{color:"dimmer",children:"You can modify this element by describing the change in the chat. No deterministic edits are supported for this element."})}):null,en.textSectionHeader?(0,y.jsx)(e3.Text,{className:e9.default.sectionTitle,children:"Text"}):null,en.content?(0,y.jsx)(e8.View,{className:e9.default.formRow,children:(0,y.jsx)(j.ContentInput,{})}):null,en.imageSectionHeader?(0,y.jsx)(e3.Text,{className:e9.default.sectionTitle,children:"Image"}):null,en.imageSource?(0,y.jsx)(e8.View,{className:e9.default.formRow,children:(0,y.jsx)(e8.View,{className:e9.default.formField,children:(0,y.jsx)(R.ImageInput,{})})}):null,en.fontSize||en.fontStyle?(0,y.jsxs)(e8.View,{className:e9.default.formRow,children:[en.fontSize?(0,y.jsx)(e8.View,{className:e9.default.formField,children:(0,y.jsx)(T.FontSizeInput,{})}):null,en.fontStyle?(0,y.jsx)(e8.View,{className:e9.default.formField,children:(0,y.jsx)(E.FontStyleInput,{})}):null]}):null,en.alignment?(0,y.jsx)(e8.View,{className:e9.default.formRow,children:(0,y.jsx)(e8.View,{className:e9.default.formField,children:(0,y.jsx)(S.AlignmentControls,{})})}):null,en.appearanceSectionHeader?(0,y.jsx)(e3.Text,{className:e9.default.sectionTitle,children:"Appearance"}):null,en.textColor||en.backgroundColor?(0,y.jsxs)(e8.View,{className:e9.default.formRow,children:[en.textColor?(0,y.jsx)(e8.View,{className:e9.default.formField,children:(0,y.jsx)(P.TextColorInput,{})}):null,en.backgroundColor?(0,y.jsx)(e8.View,{className:e9.default.formField,children:(0,y.jsx)(C.BackgroundColorInput,{})}):null]}):null,en.layoutSectionHeader?(0,y.jsx)(e3.Text,{className:e9.default.sectionTitle,children:"Layout"}):null,en.margin?(0,y.jsx)(e8.View,{className:e9.default.formRow,children:(0,y.jsx)(e8.View,{className:e9.default.formField,children:(0,y.jsx)(I.MarginInput,{})})}):null,en.padding?(0,y.jsx)(e8.View,{className:e9.default.formRow,children:(0,y.jsx)(e8.View,{className:e9.default.formField,children:(0,y.jsx)(A.PaddingInput,{})})}):null,(0,y.jsx)(e8.View,{row:!0,justify:"space-between",align:"center",gap:8,pt:8,children:er?null:(0,y.jsxs)(y.Fragment,{children:[(0,y.jsx)(eZ.Button,{text:"Delete",iconLeft:(0,y.jsx)(e6.default,{}),variant:"outlined",colorway:"negative",onClick:function(){J(!0)}}),(0,y.jsx)(e4.Tooltip,{tooltip:"No changes to save",isDisabled:et,placement:"top",children:(0,y.jsx)(eZ.Button,{text:"Save changes",onClick:function(){return(0,n._)(function(){return(0,r._)(this,function(e){switch(e.label){case 0:if(!q)return[2];return[4,ee()];case 1:return e.sent(),[2]}})})()},colorway:"primary",isDisabled:!et})})]})}),(0,y.jsx)(e1.Modal,{isOpen:X,onRequestClose:ei,children:(0,y.jsx)(e0.default,{prompt:"Delete Element",desc:"Are you sure you want to delete this element?",confirmText:"Yes, delete this element",danger:!0,onCancel:ei,onConfirm:function(){return(0,n._)(function(){return(0,r._)(this,function(e){switch(e.label){case 0:if(!q)return[2];return(0,m.updateSelectedElementInWebview)({style:"display: none;"}),ei(),[4,Z("Delete Element",q)];case 1:return e.sent(),(0,m.sendToggleVisualEditorMessage)(!1,!1),[2]}})})()},icon:(0,y.jsx)(e6.default,{})})})]})}):null}e.s(["TargetedElementEditor",()=>e7],691626),e.i(755323),e.s([],619231);var te=e.i(965863);function tt(e,t){var a,s,c,p,h=(s=(a=(0,l.useChatEngineModels)()).basicModel,c=a.advancedModel,p=a.overrideModel,(0,i.useCallback)(function(e){var t=e.modelType,n=s;return p?n=p:t===o.ModelType.ADVANCED&&(n=c),n},[c,s,p])),m=(0,g.useVisualSelector)({context:"agent"}).element,x=null==m?void 0:m.filePath;return(0,i.useCallback)(function(i){var o=i.modelType,a=i.filePreferences,s=i.recentFiles;return(0,n._)(function(){var n,i;return(0,r._)(this,function(r){switch(r.label){case 0:return[4,t.getConfig()];case 1:return i=((null==(n=r.sent().config)?void 0:n.hidden)||[]).map(function(e){return(0,d.globToRegExp)(e)}).filter(Boolean),[2,(0,u.getFileContext)({model:h({modelType:o}),filePreferences:a,filter:function(e){return!(0,f.isPathHiddenByDotReplit)(e,i)},recentFiles:s,targetedElementFile:x,entrypoint:(null==n?void 0:n.entrypoint)||void 0,fs:e})]}})})()},[e,t,h,x])}function tn(){var e=(0,p.default)(),t=e.fs,n=e.dotReplit,r="advanced"===(0,s.useAssistantInlineMode)().assistantInlineMode?o.ModelType.ADVANCED:o.ModelType.BASIC,a=(0,c.useGetFileContextPreferences)(),l=tt(t,n),u=(0,te.useGetRecentFiles)();return(0,i.useCallback)(function(){return l({modelType:r,filePreferences:a(),recentFiles:u()})},[a,u,l,r])}e.s(["useGetFileContext",()=>tt,"useGetSessionFileContext",()=>tn],939652),e.i(508987);var tr=e.i(457103),ti=e.i(399119),to=e.i(904851),ta=e.i(90659),ts=e.i(721281),tl=e.i(445789),tu=e.i(167626),tc=e.i(992785),td=e.i(753950),tf=e.i(179302),tp=[{"Anthropic API Key":/(sk-ant-api03-[\w-]{93}AA)/g,"AWS API Key":/AKIA[0-9A-Z]{16}/g,"AWS AppSync GraphQL Key":/da2-[a-z0-9]{26}/g,"AWS MWS ID":/mzn\.mws\.[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}/g,"AWS client ID":/(A3T[A-Z0-9]|AKIA|AGPA|AIDA|AROA|AIPA|ANPA|ANVA|ASIA)[A-Z0-9]{16}/g,"Discord Bot Token":/(?:N|M|O)[a-zA-Z0-9]{23}\\.[a-zA-Z0-9-_]{6}\\.[a-zA-Z0-9-_]{27}/g,"Discord Webhook Url":/https?:\/\/(?:ptb\.|canary\.)?discord\.com\/api(?:\/v\d{1,2})?\/webhooks\/(\d{17,19})\/([\w-]{68})/gi,"Dynatrace Token":/dt0[a-zA-Z]{1}[0-9]{2}\\.[A-Z0-9]{24}\\.[A-Z0-9]{64}/gi,"Facebook Access Token":/EAACEdEose0cBA[0-9A-Za-z]+/g,"Facebook OAuth":/[fF][aA][cC][eE][bB][oO][oO][kK].*['|"][0-9a-f]{32}['|"]/g,"Github Personal Access Token":/ghp_[0-9a-zA-Z]{36}/g,"Github OAuth Access Token":/gho_[0-9a-zA-Z]{36}/g,"Github App Installation Access Token":/(ghu|ghs)_[0-9a-zA-Z]{36}/g,"Github App Refresh Token":/ghr_[0-9a-zA-Z]{76}/g,"Generic API Key":/[aA][pP][iI]_?[kK][eE][yY].*['|"][0-9a-zA-Z]{32,45}['|"]/g,"Generic Secret":/[sS][eE][cC][rR][eE][tT].*['|"][0-9a-zA-Z]{32,45}['|"]/g,"Google API Key":/AIza[0-9A-Za-z\\-_]{35}/g,"Google Gmail API Key":/AIza[0-9A-Za-z\\-_]{35}/g,"Google OAuth Access Token":/ya29\\.[0-9A-Za-z\\-_]+/g,"Google YouTube API Key":/AIza[0-9A-Za-z\\-_]{35}/g,"Heroku API Key":/[hH][eE][rR][oO][kK][uU].*[0-9A-F]{8}-[0-9A-F]{4}-[0-9A-F]{4}-[0-9A-F]{4}-[0-9A-F]{12}/g,"MailChimp API Key":/[0-9a-f]{32}-us[0-9]{1,2}/g,"Mailgun API Key":/key-[0-9a-zA-Z]{32}/g,"Mapbox, Public Key":/([s,p]k.eyJ1Ijoi[\w.-]+)/g,"Mapbox, Secret Key":/([s,p]k.eyJ1Ijoi[\w.-]+)/g,"npm Access Token":/npm_[0-9a-zA-Z]{36}/g,"NuGet API Key":/oy2[a-z0-9]{43}/g,"OpenAI API Key":/sk-[a-zA-Z0-9_-]+/g,"PGP private key block":/-----BEGIN PGP PRIVATE KEY BLOCK-----/g,"Picatic API Key":/sk_live_[0-9a-z]{32}/g,"PyPI API Token":/pypi-AgEIcHlwaS5vcmc[A-Za-z0-9-_]{50,1000}/g,"SSH (DSA) private key":/-----BEGIN DSA PRIVATE KEY-----/g,"SSH (EC) private key":/-----BEGIN EC PRIVATE KEY-----/g,"SSH (RSA) private key":/-----BEGIN RSA PRIVATE KEY-----/g,"SendGrid API Key":/SG\.[0-9A-Za-z\-_]{22}\.[0-9A-Za-z\-_]{43}/g,"Shopify Access Token":/shpat_[a-fA-F0-9]{32}/g,"Shopify App Shared Secret":/shpss_[a-fA-F0-9]{32}/g,"Shopify Custom App Access Token":/shpca_[a-fA-F0-9]{32}/g,"Shopify Private App Password":/shppa_[a-fA-F0-9]{32}/g,"Slack Token":/(xox[pborsa]-[0-9]{12}-[0-9]{12}-[0-9]{12}-[a-z0-9]{32})/g,"Slack API Token":/xox[baprs]-([0-9a-zA-Z]{10,48})?/g,"Slack Live API Key":/(?:r|s)k_live_[0-9a-zA-Z]{24}/g,"Slack Test API Key":/(?:r|s)k_test_[0-9a-zA-Z]{24}/g,"Slack, OAuth v2 Bot Access Token":/xoxb-[0-9]{11}-[0-9]{11}-[0-9a-zA-Z]{24}/g,"Slack, OAuth v2 Configuration Token":/xoxe.xoxp-1-[0-9a-zA-Z]{166}/g,"Slack, OAuth v2 Refresh Token":/xoxe-1-[0-9a-zA-Z]{147}/g,"Slack, OAuth v2 User Access Token":/xoxp-[0-9]{11}-[0-9]{11}-[0-9a-zA-Z]{24}/g,"Slack Webhook":/https:\/\/hooks.slack.com\/services\/T[a-zA-Z0-9_]{10}\/B[a-zA-Z0-9_]{10}\/[a-zA-Z0-9_]{24}/g,"Square Access Token":/sq0atp-[0-9A-Za-z\\-_]{22}/g,"Square OAuth Secret":/sq0csp-[0-9A-Za-z\\-_]{43}/g,"Stripe API Key":/sk_live_[0-9a-zA-Z]{24}/g,"Stripe Restricted API Key":/rk_live_[0-9a-zA-Z]{24}/g,"Twilio API Key":/SK[0-9a-fA-F]{32}/g,"Twitter Access Token":/[tT][wW][iI][tT][tT][eE][rR].*[1-9][0-9]+-[0-9a-zA-Z]{40}/g,"Twitter OAuth":/[tT][wW][iI][tT][tT][eE][rR].*['|"][0-9a-zA-Z]{35,44}['|"]/g},{"Instagram oauth":/[0-9a-fA-F]{7}\.[0-9a-fA-F]{32}/g}];function th(e){if(e.length>2e3)return!1;var t=!0,n=!1,r=void 0;try{for(var i,o=tp[Symbol.iterator]();!(t=(i=o.next()).done);t=!0){var a=i.value,s=!0,l=!1,u=void 0;try{for(var c,d=Object.entries(a)[Symbol.iterator]();!(s=(c=d.next()).done);s=!0){var f=(0,x._)(c.value,2),p=f[0],h=f[1],g=e.search(h);if(!(g<0)){var m=e.match(h);if(m){var y=g+m[0].length;return{start:g,end:y,secret:e.slice(g,y),provider:p}}}}}catch(e){l=!0,u=e}finally{try{s||null==d.return||d.return()}finally{if(l)throw u}}}}catch(e){n=!0,r=e}finally{try{t||null==o.return||o.return()}finally{if(n)throw r}}return!1}function tg(e){for(var t=null,n="",r=0,i=0;i<e.length;i++){var o=e[i],a=" "===o||"\n"===o||"	"===o||"\r"===o;if(a||(r=n?r:i,n+=o),n&&(a||i===e.length-1)){if(n.length<16){n="",r=0;continue}e:for(;n;){var s=!0,l=!1,u=void 0;try{for(var c,d=tp[Symbol.iterator]();!(s=(c=d.next()).done);s=!0){var f=c.value,p=!0,h=!1,g=void 0;try{for(var m,y=Object.entries(f)[Symbol.iterator]();!(p=(m=y.next()).done);p=!0){var b=(0,x._)(m.value,2),w=b[0],k=b[1];k.lastIndex=0;var _=k.exec(n);if(_){var S=_[0].length,C=_.index,j=C+S;null!=t||(t=[]),t.push({start:r+C,end:r+j,secret:_[0],provider:w}),n=n.slice(S),r+=S;continue e}}}catch(e){h=!0,g=e}finally{try{p||null==y.return||y.return()}finally{if(h)throw g}}}}catch(e){l=!0,u=e}finally{try{s||null==d.return||d.return()}finally{if(l)throw u}}n="",r=0}}}return t}e.s(["scan",()=>th,"scanMany",()=>tg],445735);var tm=e.i(480028),tv="cm-active-in-message-secret";function tx(e,t){for(var n=[],r=e.state.field(t_).iter(),i=new Set;r.value;){if(!r.value.dismissed&&t[r.value.id]){var o="`".concat(t[r.value.id],"`");n.push({from:r.from,to:r.to,insert:o}),i.add(r.value.provider)}r.next()}n.length&&e.dispatch({changes:n,annotations:tk.of({providers:Array.from(i)})})}var ty=tf.EditorView.theme((0,ts._)({},".".concat(tv),{display:"inline-block",color:tm.tokens.foregroundDimmer,backgroundColor:tm.tokens.orangeDimmer,"&::selection":{color:tm.tokens.foregroundDefault}})),tb=function(e){function t(e){var n,r=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=arguments.length>2?arguments[2]:void 0;return(0,to._)(this,t),n=(0,ti._)(this,t),(0,ts._)(n,"provider",void 0),(0,ts._)(n,"dismissed",void 0),(0,ts._)(n,"id",void 0),n.provider=e,n.dismissed=r,n.id=null!=i?i:"secret-".concat(t.counter++),n}return(0,tl._)(t,e),(0,ta._)(t,[{key:"eq",value:function(e){return(0,tu._)(e,t)&&this.id===e.id}},{key:"dismiss",value:function(){return new t(this.provider,!0,this.id)}}],[{key:"range",value:function(e,t,n){return new this(e).range(t,n)}}]),t}(td.RangeValue);(0,ts._)(tb,"counter",0),tb.prototype.startSide=1,tb.prototype.endSide=-1;var tw=td.StateEffect.define(),tk=td.Annotation.define(),t_=td.StateField.define({create:function(){return td.RangeSet.empty},update:function(e,t){var n=null;t.changes.empty||(e.size&&(e=(e=e.map(t.changes)).update({filter:function(e,t){return e!==t}})),t.changes.iterChangedRanges(function(e,r,i,o){var a=t.startState.doc.lineAt(e).from,s=t.startState.doc.lineAt(r).to,l=t.state.doc.lineAt(i).from,u=t.state.doc.lineAt(o).to,c=function(e,t,n,r,i,o){function a(e){return" "===e||"	"===e||"\n"===e||"\r"===e}function s(e){return 0===e.length||0===e.trim().length}var l=e.slice(n,r),u=t.slice(i,o);if(s(l)&&s(u))return null;for(var c=i;c>0&&!a(t[c-1]);)c--;for(var d=o;d<t.length&&!a(t[d]);)d++;if(i===o&&n<r){if(n>0&&!a(e[n-1])){var f=!s(l),p=r<e.length&&!a(e[r]);if(f||!p)return{fromB:c,toB:d}}if(r<e.length&&!a(e[r])){var h=!s(l),g=n>0&&!a(e[n-1]);if(h||!g)return{fromB:c,toB:d}}if(s(l))return null}for(;c<d&&a(t[c]);)c++;for(;d>c&&a(t[d-1]);)d--;return c>=d?null:{fromB:c,toB:d}}(t.startState.sliceDoc(a,s),t.state.sliceDoc(l,u),e-a,r-a,i-l,o-l);c&&(null!=n||(n=[]),n.push({from:c.fromB+l,to:c.toB+l}))}));var r=!0,i=!1,o=void 0;try{for(var a,s=t.effects[Symbol.iterator]();!(r=(a=s.next()).done);r=!0)if(a.value.is(tw)){for(var l=new td.RangeSetBuilder,u=e.iter();u.value;)l.add(u.from,u.to,u.value.dismiss()),u.next();e=l.finish();continue}}catch(e){i=!0,o=e}finally{try{r||null==s.return||s.return()}finally{if(i)throw o}}if(n){var c=!0,d=!1,f=void 0;try{for(var p,h=n[Symbol.iterator]();!(c=(p=h.next()).done);c=!0)!function(){var n=p.value;e=e.update({filter:function(e,t){return e<n.from||t>n.to}});var r=tg(t.state.sliceDoc(n.from,n.to));if(r){var i=r.map(function(e){return tb.range(e.provider,n.from+e.start,n.from+e.end)});e=e.update({add:i,sort:!0})}}()}catch(e){d=!0,f=e}finally{try{c||null==h.return||h.return()}finally{if(d)throw f}}}return e}}),tS=td.StateField.define({create:function(){return[]},compare:function(e,t){return(0,tc.default)(e,t)},update:function(e,t){if(!(0,tr.hasChanged)(t,t_))return e;for(var n=[],r=t.state.field(t_).iter();r.value;)r.value.dismissed||n.push({id:r.value.id,provider:r.value.provider,key:t.state.sliceDoc(r.from,r.to)}),r.next();return n}}),tC=td.StateField.define({create:function(){return!1},update:function(e,t){return(0,tr.hasChanged)(t,tS)?t.state.field(tS).length>0:e}}),tj=tf.Decoration.mark({class:tv,inclusiveStart:!0,inclusiveEnd:!0}),tT=td.StateField.define({create:function(){return tf.Decoration.none},update:function(e,t){if(!(0,tr.hasChanged)(t,t_))return e;for(var n=new td.RangeSetBuilder,r=t.state.field(t_).iter();r.value;)r.value.dismissed||n.add(r.from,r.to,tj),r.next();return n.finish()},provide:function(e){return tf.EditorView.decorations.from(e)}}),tE=tf.EditorView.updateListener.of(function(e){if((0,tr.hasChanged)(e,t_)){var t=null!=(a=e.startState.field(tS,!1))?a:[],n=e.state.field(tS).filter(function(e){return!t.some(function(t){return t.id===e.id})});n.length&&(0,ez.track)(eG.events.IN_MESSAGE_SCANNER_USED,{action:"secrets_detected",providers:n.map(function(e){return e.provider})});var r=!0,i=!1,o=void 0;try{for(var a,s,l=e.transactions[Symbol.iterator]();!(r=(s=l.next()).done);r=!0){var u=s.value,c=!0,d=!1,f=void 0;try{for(var p,h=u.effects[Symbol.iterator]();!(c=(p=h.next()).done);c=!0)if(p.value.is(tw)){var g=u.startState.field(t_,!1);if(g){for(var m=new Set,x=g.iter();x.value;)x.value.dismissed||m.add(x.value.provider),x.next();m.size&&(0,ez.track)(eG.events.IN_MESSAGE_SCANNER_USED,{action:"secrets_dismissed",providers:Array.from(m)})}}}catch(e){d=!0,f=e}finally{try{c||null==h.return||h.return()}finally{if(d)throw f}}var y=u.annotation(tk);y&&(0,ez.track)(eG.events.IN_MESSAGE_SCANNER_USED,{action:"secrets_replaced",providers:y.providers})}}catch(e){i=!0,o=e}finally{try{r||null==l.return||l.return()}finally{if(i)throw o}}}}),tR=[t_,ty,td.Prec.highest(tT),tS,tC,tE];e.s(["ActiveInMessageSecrets",()=>tS,"DismissActiveInMessageSecrets",()=>tw,"HasActiveInMessageSecrets",()=>tC,"InMessageSecretScanner",()=>tR,"replaceActiveSecrets",()=>tx],921760);var tI=e.i(703613);e.i(242933);var tA=e.i(99145),tP=e.i(790164),tD=(0,i.createContext)(null);function tO(e){var t=e.children,n=(0,eY.useFlag)({type:"boolean",controlName:"flag-scan-in-message-secrets"}),r=(0,i.useMemo)(function(){return{secrets:new tP.ObservableState([]),replaceListeners:new tA.ListenerList,dismissListeners:new tA.ListenerList}},[]);return n?(0,y.jsx)(tD.Provider,{value:r,children:t}):(0,y.jsx)(y.Fragment,{children:t})}function tN(){return!!(0,i.useContext)(tD)}function tM(){var e=(0,i.useContext)(tD);return{inMessageSecrets:(0,eK.useObservable)(null==e?void 0:e.secrets,[]),replaceInMessageSecrets:(0,i.useCallback)(function(t){null==e||e.replaceListeners.notify(t)},[e]),dismissInMessageSecrets:(0,i.useCallback)(function(){null==e||e.dismissListeners.notify()},[e])}}function tL(e){var t=(0,i.useContext)(tD);(0,i.useEffect)(function(){var n=null==e?void 0:e.plugin(tI.StateListenerPlugin);if(t&&e&&n&&!n.destroyed){var r=n.bind({changed:function(e){return(0,tr.hasChanged)(e,tS)},callback:function(e){t.secrets.set(e.state.field(tS))},destroy:function(){t.secrets.set([])}}),i=t.replaceListeners.add(function(t){tx(e,t)}),o=t.dismissListeners.add(function(){e.dispatch({effects:tw.of(!0)})});return function(){r(),i(),o()}}},[e,t])}e.s(["InMessageSecretsProvider",()=>tO,"useBindViewToInMessageSecrets",()=>tL,"useHasInMessageSecretsContext",()=>tN,"useInMessageSecrets",()=>tM],274808);var tB=e.i(64386),tV=e.i(629536),tF=e.i(641555);e.i(33699);var tU=e.i(711223),tG=e.i(63846);e.i(416143);var t$=e.i(446530),tz=e.i(613355),tH=tz.container.min(400),tW=(0,t$.cssRecord)({root:[tz.rcss.width("100%")],narrowContainer:[tz.rcss.flex.column,tz.rcss.gap(8),tz.rcss.width("100%"),tz.rcss.overflowX("auto"),tz.rcss.scrollbar.hidden,(0,ts._)({margin:"0 auto"},tH,{display:"none"})],narrowRow:[tz.rcss.flex.row,tz.rcss.gap(8),tz.rcss.width("100%"),{display:"flex",flexWrap:"nowrap",paddingLeft:16,"&::after":{content:'""',width:8,flexShrink:0}}],wideContainer:[tz.rcss.gap(8),tz.rcss.width("100%"),(0,ts._)({display:"none"},tH,{display:"flex",maxWidth:500,flexWrap:"wrap",alignSelf:"center",justifyContent:"center",width:"fit-content"})],button:[tz.rcss.maxWidth(350),(0,ts._)({justifyContent:"flex-start",fontSize:tm.tokens.fontSizeDefault,color:tm.tokens.foregroundDimmer,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},tH,{width:"auto",justifyContent:"center"})]});function tq(e){var t=e.prompts,n=e.onClick,r=(0,i.useMemo)(function(){var e=Math.ceil(t.length/2);return{halfLength:e,firstRow:t.slice(0,e),secondRow:t.slice(e)}},[t]),o=r.halfLength,a=r.firstRow,s=r.secondRow,l=(0,i.useMemo)(function(){return t.slice(0,6)},[t]);return(0,y.jsxs)(e8.View,{css:tW.root,children:[(0,y.jsxs)(e8.View,{css:tW.narrowContainer,children:[(0,y.jsx)(e8.View,{css:tW.narrowRow,children:a.map(function(e,t){return(0,tU.createElement)(tK,(0,tB._)((0,O._)({},e),{index:t,key:e.description,onClick:function(){return n(e)}}))})}),(0,y.jsx)(e8.View,{css:tW.narrowRow,children:s.map(function(e,t){return(0,tU.createElement)(tK,(0,tB._)((0,O._)({},e),{index:t+o,key:e.description,onClick:function(){return n(e)}}))})})]}),(0,y.jsx)(e8.View,{css:tW.wideContainer,row:!0,children:l.map(function(e,t){return(0,tU.createElement)(tK,(0,tB._)((0,O._)({},e),{index:t,key:e.description,onClick:function(){return n(e)}}))})})]})}function tK(e){(0,tG.getAiEndpoint)();var t=void 0,n=null!=t?t:e.description;return(0,y.jsx)(eZ.Button,{css:tW.button,text:n,onClick:function(t){e.onClick()},"aria-label":n})}var tY=e.i(903283),tQ=e.i(602213),tX=e.i(717368),tJ=e.i(42458),tZ=(0,t$.cssRecord)({root:[tz.rcss.overflowY("auto"),tz.rcss.flex.growAndShrink(1),tz.rcss.flex.column,tz.rcss.align.center,tz.rcss.width("100%"),{margin:"0 auto",containerType:"inline-size"}],content:[tz.rcss.flex.column,tz.rcss.gap(24),tz.rcss.py(32),tz.rcss.align.center,tz.rcss.justify.center,tz.rcss.width("100%"),tz.rcss.minHeight("100%"),tz.rcss.overflowX("auto")],headerSection:[tz.rcss.maxWidth(320),tz.rcss.px(8),{textAlign:"center"}],promptSuggestionsContainer:[tz.rcss.width("100%"),tz.rcss.overflowX("auto"),tz.rcss.scrollbar.hidden,tz.rcss.pb(8)],promptSuggestionsContent:[tz.rcss.flex.column,tz.rcss.align.center,tz.rcss.width("100%"),{maxWidth:"100%"}],headerIcon:[{color:tm.tokens.outlineStronger}],footerContainer:[tz.rcss.maxWidth("100%"),tz.rcss.px(8),{textAlign:"center"}],warning:[tz.rcss.m(8),tz.rcss.maxWidth(400),{textAlign:"center"}],warningBox:[tz.rcss.border({color:tm.tokens.orangeDimmer}),tz.rcss.borderRadius(),{backgroundColor:tm.tokens.orangeDimmest}],warningIconText:[{color:tm.tokens.orangeStrongest}]});function t0(e){var t,n,r,s,l,u=(l=({sessionType:e.sessionType}).sessionType,(0,i.useMemo)(function(){return l===o.SessionType.CHAT?[{icon:(0,y.jsx)(tY.default,{}),description:"Inspect for errors"},{icon:(0,y.jsx)(tY.default,{}),description:"Improve the visual design"},{icon:(0,y.jsx)(tY.default,{}),description:"Brainstorm new features"},{icon:(0,y.jsx)(tY.default,{}),description:"Add dark mode toggle"},{icon:(0,y.jsx)(tY.default,{}),description:"Optimize for mobile"},{icon:(0,y.jsx)(tY.default,{}),description:"Explain this code"}]:[{icon:(0,y.jsx)(tY.default,{}),description:"Check my app for bugs"},{icon:(0,y.jsx)(tY.default,{}),description:"Add payment processing"},{icon:(0,y.jsx)(tY.default,{}),description:"Connect with an AI Assistant"},{icon:(0,y.jsx)(tY.default,{}),description:"Add SMS message sending"},{icon:(0,y.jsx)(tY.default,{}),description:"Add a database"},{icon:(0,y.jsx)(tY.default,{}),description:"Add authenticated user login"}]},[l])),c=(t=e.sessionType,n=(0,a.useSupportsAgent)(),r=(0,eq.useChatter)(),s=(0,tF.useObservableMemo)(function(){return r.sessions.query({types:[o.SessionType.CHAT]}).map.select(function(e){return e.size>0})},[r],{default:!0}),t===o.SessionType.CHAT&&!!n&&!s);return(0,y.jsx)(t2,(0,tB._)((0,O._)({},e),{showAssistantWarning:c,promptSuggestions:u}))}function t1(e){return(0,y.jsxs)(e8.View,{align:"center",gap:8,css:tZ.warning,children:[(0,y.jsxs)(e8.View,{css:tZ.warningBox,p:8,children:[(0,y.jsxs)(e8.View,{css:tZ.warningIconText,row:!0,gap:6,justify:"center",align:"center",children:[(0,y.jsx)(tJ.default,{}),(0,y.jsx)(e3.Text,{children:"Warning"})]}),(0,y.jsx)(e3.Text,{children:"Assistant works best for users comfortable with file management and basic troubleshooting."})]}),(0,y.jsx)(e3.Text,{color:"dimmer",children:"Use Agent for the safest app building experience."}),(0,y.jsx)(eZ.Button,{onClick:e.onSwitchToAgent,iconLeft:(0,y.jsx)(tQ.AgentAvatar,{size:16}),text:"Switch to Agent"})]})}function t2(e){var t=e.titleContent,n=e.showPromptSuggestions,r=e.sessionType,i=e.onPromptSuggestionClick,a=e.promptSuggestions,s=e.footerContent,l=e.onSwitchToAgent,u=e.showAssistantWarning,c=r===o.SessionType.CHAT,d=c?tV.ASSISTANT_NAME:tV.AGENT_NAME;return(0,y.jsx)(e8.View,{css:tZ.root,children:(0,y.jsxs)(e8.View,{css:tZ.content,children:[(0,y.jsxs)(e8.View,{css:tZ.headerSection,gap:16,children:[(0,y.jsx)(e8.View,{gap:8,align:"center",children:(0,y.jsxs)(y.Fragment,{children:[(0,y.jsx)(tX.default,{size:48,css:tZ.headerIcon,style:{transform:"scale(1.33)"}}),null!=t?t:(0,y.jsx)(e8.View,{row:!0,gap:4,align:"center",children:(0,y.jsx)(e3.Header,{level:1,variant:"subheadBig",children:"New chat with ".concat(d)})})]})}),u?null:(0,y.jsx)(e3.Text,{color:"dimmest",children:c?tV.ASSISTANT_DESCRIPTION:tV.AGENT_DESCRIPTION})]}),u&&l?(0,y.jsx)(t1,{onSwitchToAgent:l}):null,(void 0===n||n)&&!u?(0,y.jsx)(e8.View,{css:tZ.promptSuggestionsContainer,pb:8,children:(0,y.jsx)(e8.View,{css:tZ.promptSuggestionsContent,children:(0,y.jsx)(tq,{onClick:function(e){var t,n=null!=(t=e.promptToFill)?t:e.description;(0,ez.track)(eG.events.ASSISTANT_USED,{action:"prompt_suggestion_clicked",title:e.title}),null==i||i({intent:e.intent,text:n})},prompts:a})})}):null,s?(0,y.jsx)(e8.View,{css:tZ.footerContainer,children:s}):null]})})}function t3(e){var t=(0,eq.useChatter)();return(0,tF.useObservableMemo)(function(){return e?t.sessions.agent.all.latest.select(function(t){return(null==t?void 0:t.id)!==e}):null},[t,e],{default:!1})}e.s(["SessionEmptyState",()=>t0],357993),e.s(["useIsAgentSessionReadOnly",()=>t3],603969);var t4=e.i(541793),t8=((t={}).Minimized="minimized",t.Tasks="tasks",t.Log="log",t),t5=(0,t4.atom)(new Map);function t6(){var e=(0,eq.useSet)(t5);return(0,i.useCallback)(function(t,n){e(function(e){var r=new Map(e);return r.set(t,n),r})},[e])}function t9(){var e=(0,eq.useValue)(t5);return(0,i.useCallback)(function(t){return e.has(t)?e.get(t):"tasks"},[e])}e.s(["RunGranularity",()=>t8,"useGetRunGroupGranularity",()=>t9,"useSetRunGranularity",()=>t6],808547)},695926,646136,e=>{"use strict";var t=e.i(530658),n=e.i(389959),r=e.i(188507),i=e.i(374106);e.i(925218);var o=e.i(267103),a=e.i(200119),s=e.i(149448);function l(e){var l=(0,a.useAgentIsWorking)(),u=(0,o.useObservable)(l),c=(0,s.useLastEvent)(e),d=(null==c?void 0:c.event)&&(0,i.isEventAgentToolNamed)(c.event,"user_response")&&c.state===r.EventState.IN_PROGRESS,f=(0,t._)((0,n.useState)(!1),2),p=f[0],h=f[1],g=(0,n.useRef)(d),m=(0,n.useRef)(null);return(0,n.useEffect)(function(){var e=g.current;if(m.current&&(clearTimeout(m.current),m.current=null),e&&!d){var t="";if((null==c?void 0:c.event)&&(0,i.isEventAgentToolNamed)(c.event,"user_response")){var n,r=(0,i.getEventAgentToolDataFor)(c.event,"messageData");t=null!=(n=null==r?void 0:r.content)?n:""}var o=t?t.split("\n").length:1;h(!0),m.current=setTimeout(function(){h(!1),m.current=null},600*o)}else!e&&d&&h(!1);return g.current=d,function(){m.current&&clearTimeout(m.current)}},[d,c]),!!u&&!d&&!p}e.s(["useShouldShowFloatingStatusRow",()=>l],695926);var u=e.i(276385),c=e.i(546284),d=e.i(754873),f=e.i(960178),p=e.i(625484),h=e.i(576073);function g(e){var t=e.count,n=e.collapsed,r=e.onToggle,i=e.className;return(0,u.jsxs)(p.View,{grow:!0,shrink:!0,row:!0,align:"center",clsx:i,gap:6,justify:"space-between",tag:"button",css:d.interactive.nofill,onClick:r,children:[(0,u.jsxs)(f.Text,{color:"dimmest",children:[t," ",(0,c.default)("checkpoints",t)," that"," ",1===t?"was":"were"," rolled back"]}),(0,u.jsx)(h.default,{rotate:180*!n})]})}e.s(["CollapsedCheckpointsToggle",()=>g],646136)},194004,e=>{e.v({emptyStateOverlay:"ContentEmptyState-module__Rm4_Wq__emptyStateOverlay",emptyStateOverlayAnimating:"ContentEmptyState-module__Rm4_Wq__emptyStateOverlayAnimating","pulse-gray":"ContentEmptyState-module__Rm4_Wq__pulse-gray"})},300378,e=>{e.v({"fade-in":"Narration-module__MhV6MG__fade-in",fadeIn:"Narration-module__MhV6MG__fadeIn",large:"Narration-module__MhV6MG__large",preserveNewlines:"Narration-module__MhV6MG__preserveNewlines",small:"Narration-module__MhV6MG__small"})},942163,e=>{e.v({liveIndicator:"LiveContent-module__XBs0iG__liveIndicator",liveIndicatorDot:"LiveContent-module__XBs0iG__liveIndicatorDot","pulse-blurple-border":"LiveContent-module__XBs0iG__pulse-blurple-border",pulseBorderAnimation:"LiveContent-module__XBs0iG__pulseBorderAnimation",rotation:"LiveContent-module__XBs0iG__rotation",rotationAnimation:"LiveContent-module__XBs0iG__rotationAnimation",vncInner:"LiveContent-module__XBs0iG__vncInner",vncInnerReadOnly:"LiveContent-module__XBs0iG__vncInnerReadOnly",vncNovnc:"LiveContent-module__XBs0iG__vncNovnc",vncNovncHidden:"LiveContent-module__XBs0iG__vncNovncHidden",vncWrapper:"LiveContent-module__XBs0iG__vncWrapper"})},838379,e=>{e.v({history:"ReplayContent-module__tEod5G__history",historyElement:"ReplayContent-module__tEod5G__historyElement",historyElementButton:"ReplayContent-module__tEod5G__historyElementButton",isActive:"ReplayContent-module__tEod5G__isActive",isBlurred:"ReplayContent-module__tEod5G__isBlurred",playIcon:"ReplayContent-module__tEod5G__playIcon",playbackElement:"ReplayContent-module__tEod5G__playbackElement",playbackElementInner:"ReplayContent-module__tEod5G__playbackElementInner",previewWrapper:"ReplayContent-module__tEod5G__previewWrapper"})},858501,e=>{e.v({iconAndSummary:"AgentTestingUI-module__Bg2oqW__iconAndSummary"})},151474,e=>{e.v({chevron:"GeneralSubagentShared-module__KL4q0a__chevron",expandableButton:"GeneralSubagentShared-module__KL4q0a__expandableButton"})},725352,e=>{e.v({expandable:"GeneralSubagentEvents-module__igR2_a__expandable",expandableHeader:"GeneralSubagentEvents-module__igR2_a__expandableHeader",isExpanded:"GeneralSubagentEvents-module__igR2_a__isExpanded",root:"GeneralSubagentEvents-module__igR2_a__root",subSurface:"GeneralSubagentEvents-module__igR2_a__subSurface"})},401732,e=>{e.v({root:"AutoscrollMaxHeightContainer-module__ZgdpGW__root",scroll:"AutoscrollMaxHeightContainer-module__ZgdpGW__scroll",topGradient:"AutoscrollMaxHeightContainer-module__ZgdpGW__topGradient"})},279714,e=>{e.v({isExpanded:"GeneralSubagentThinking-module__xglSIq__isExpanded",root:"GeneralSubagentThinking-module__xglSIq__root",subSurface:"GeneralSubagentThinking-module__xglSIq__subSurface"})},626926,e=>{e.v({expandButton:"Progress-module__bN3QUa__expandButton"})},590829,e=>{e.v({item:"RunGroupGranularityControl-module__cbE2rq__item",listbox:"RunGroupGranularityControl-module__cbE2rq__listbox"})},854976,e=>{e.v({activitySurface:"RunGroupCard-module__e7hFIG__activitySurface",card:"RunGroupCard-module__e7hFIG__card"})},831498,e=>{e.v({card:"MinimizedRunGroupCard-module__WjSQxq__card"})},382222,e=>{e.v({expandButton:"Feed-module__lsKhoG__expandButton",expandableGroup:"Feed-module__lsKhoG__expandableGroup",feed:"Feed-module__lsKhoG__feed","highlight-bg":"Feed-module__lsKhoG__highlight-bg",sessionSeparator:"Feed-module__lsKhoG__sessionSeparator",sessionStitchingToggle:"Feed-module__lsKhoG__sessionStitchingToggle",summary:"Feed-module__lsKhoG__summary"})},624768,e=>{e.v({button:"AgentQueryResponseDialog-module__kRDpsq__button",multilineInput:"AgentQueryResponseDialog-module__kRDpsq__multilineInput",radioOption:"AgentQueryResponseDialog-module__kRDpsq__radioOption",reasonField:"AgentQueryResponseDialog-module__kRDpsq__reasonField",responseSubmissionRow:"AgentQueryResponseDialog-module__kRDpsq__responseSubmissionRow",root:"AgentQueryResponseDialog-module__kRDpsq__root"})},826630,e=>{e.v({banner:"AgentRequestBanner-module__0KFzQG__banner",button:"AgentRequestBanner-module__0KFzQG__button",text:"AgentRequestBanner-module__0KFzQG__text",textContainer:"AgentRequestBanner-module__0KFzQG__textContainer"})},298122,e=>{e.v({budgetButton:"BudgetExceededMessage-module__hpXgQq__budgetButton",buttonContainer:"BudgetExceededMessage-module__hpXgQq__buttonContainer",root:"BudgetExceededMessage-module__hpXgQq__root",text:"BudgetExceededMessage-module__hpXgQq__text"})},811029,e=>{e.v({button:"BuildScoreSurveyDialog-module__5JMOga__button",closeIcon:"BuildScoreSurveyDialog-module__5JMOga__closeIcon",headerRow:"BuildScoreSurveyDialog-module__5JMOga__headerRow",responseSubmissionRow:"BuildScoreSurveyDialog-module__5JMOga__responseSubmissionRow",root:"BuildScoreSurveyDialog-module__5JMOga__root",satisfactionLevelText:"BuildScoreSurveyDialog-module__5JMOga__satisfactionLevelText",starButton:"BuildScoreSurveyDialog-module__5JMOga__starButton",starIcon:"BuildScoreSurveyDialog-module__5JMOga__starIcon"})},483730,e=>{e.v({dialog:"AddingIntegrationDialog-module__pgpjZW__dialog",grow1:"AddingIntegrationDialog-module__pgpjZW__grow1",grow3:"AddingIntegrationDialog-module__pgpjZW__grow3"})},590986,e=>{e.v({container:"AccordionGroup-module__VPmG_G__container",item:"AccordionGroup-module__VPmG_G__item"})},260328,e=>{e.v({accordionContainer:"MultiIntegrationDialog-module__U7u0oG__accordionContainer",accordionHeader:"MultiIntegrationDialog-module__U7u0oG__accordionHeader",connectedBadge:"MultiIntegrationDialog-module__U7u0oG__connectedBadge",dialog:"MultiIntegrationDialog-module__U7u0oG__dialog",grow1:"MultiIntegrationDialog-module__U7u0oG__grow1",grow3:"MultiIntegrationDialog-module__U7u0oG__grow3"})},347748,e=>{e.v({benefitIcon:"FreemiumQuotaExceeded-module__yYQXSW__benefitIcon",benefitItem:"FreemiumQuotaExceeded-module__yYQXSW__benefitItem",header:"FreemiumQuotaExceeded-module__yYQXSW__header",longMessage:"FreemiumQuotaExceeded-module__yYQXSW__longMessage",messageContainer:"FreemiumQuotaExceeded-module__yYQXSW__messageContainer",root:"FreemiumQuotaExceeded-module__yYQXSW__root",shortMessage:"FreemiumQuotaExceeded-module__yYQXSW__shortMessage",textContainer:"FreemiumQuotaExceeded-module__yYQXSW__textContainer",title:"FreemiumQuotaExceeded-module__yYQXSW__title",upgradeButton:"FreemiumQuotaExceeded-module__yYQXSW__upgradeButton"})},755867,848327,836140,331151,851480,702069,946223,225637,59730,579048,18056,492008,e=>{"use strict";var t,n,r=e.i(297083),i=e.i(878420),o=e.i(886513),a=e.i(530658),s=e.i(346715),l=e.i(817556),u=e.i(276385),c=e.i(389959),d=e.i(243202);e.i(877212);var f=e.i(924908),p=e.i(808547);e.i(925218);var h=e.i(267103),g=e.i(641555),m=e.i(993796),x=e.i(98816),y=e.i(441329),b=e.i(546284),w=e.i(134663),k=e.i(695926),_=e.i(231346),S=e.i(436725),C=e.i(190120),j=e.i(287999),T=e.i(646136),E=e.i(849954),R=e.i(170710),I=e.i(526962),A=e.i(417120),P=e.i(535076),D=e.i(117328),O=e.i(188507),N=e.i(569910),M=e.i(909478),L=e.i(906368);e.i(312917);var B=e.i(265872),V=e.i(207237),F=e.i(858248),U=e.i(709485),G=e.i(635984),$=e.i(668106),z=e.i(116680),H=e.i(529810),W=e.i(282332),q=e.i(8808),K=e.i(475032),Y=e.i(739434),Q=((t={}).Connecting="Connecting",t.Connected="Connected",t.Disconnected="Disconnected",t.Errored="Errored",t);function X(t){var n,i,o,s,u,d=t.vncOptions,f=t.password,p=t.setPassword,h=t.handlePromptForPassword,g=(0,c.useRef)(null),m=(0,a._)((0,c.useState)("Disconnected"),2),y=m[0],b=m[1],w=(0,a._)((0,c.useState)(null),2),k=w[0],_=w[1],S=(0,c.useRef)(null),C=(0,c.useRef)(null),j=(0,c.useRef)(0),T=(0,x.default)(d),E=(0,H.default)().secrets,R=(0,V.default)(),I=(n=(0,H.default)().container,o=(i=(0,a._)((0,c.useState)(null),2))[0],s=i[1],u=(0,K.default)(n).url,(0,c.useEffect)(function(){if(!o){if(n.getConnectionState()===q.ConnectionState.CONNECTED){if(!u)return;s((0,Y.addPortToUrl)(u.replace("http","ws"),W.VNC_PORT).toString());return}return n.onConnectionStateChanged(function(e){e!==q.ConnectionState.CONNECTED||u&&s((0,Y.addPortToUrl)(u.replace("http","ws"),W.VNC_PORT).toString())})}},[u,o,n]),o),A=(0,x.default)(h),P=(0,x.default)(p);(0,c.useEffect)(function(){(0,B.lazyLoad)(function(){return e.A(964854).then(function(e){return e.default})}).then(function(e){_(function(){return e})})},[]);var D=(0,c.useCallback)(function(){if(j.current=0,b("Connected"),k&&S.current){var e,t=S.current;k.messages.pointerEvent(t._sock,t._display.absX(0),t._display.absY(0),0),(null==(e=T.current)?void 0:e.desktopSize)&&k.messages.setDesktopSize(t._sock,T.current.desktopSize.width,T.current.desktopSize.height,t._screenID,t._screenFlags)}},[k,T]),O=(0,c.useCallback)(function(e){if(S.current=null,!e.detail.clean){var t;L.withScope(function(t){t.setTag("vnc",!0),t.setExtras({vncUrl:I,replId:R,clean:e.detail.clean}),L.captureException(Error("VNC connection failed"))}),(null==(t=T.current)?void 0:t.reconnectOnError)&&(j.current=1),b("Errored");return}b("Disconnected")},[I,R,T]),N=(0,c.useCallback)(function(){(0,r._)(function(){var e;return(0,l._)(this,function(t){switch(t.label){case 0:return[4,E.read()];case 1:if(!(e=t.sent().get("VNC_PASSWORD")))return A.current(),[2];return P.current(e),[2]}})})().catch(function(e){return L.captureException(e)})},[E,P,A]),M=(0,c.useCallback)(function(){var e;null==(e=C.current)||e.abort(),C.current=null,S.current&&(S.current.removeEventListener("connect",D),S.current.removeEventListener("disconnect",O),S.current.removeEventListener("securityfailure",N),S.current.disconnect(),S.current=null)},[D,O,N]),Q=(0,c.useCallback)(function(){return(0,r._)(function(){var e,t,n,r,i,o,a,s,u;return(0,l._)(this,function(l){switch(l.label){case 0:if(!k||!g.current||!I)return[2];return M(),b("Connecting"),j.current++,C.current=new AbortController,r=C.current.signal,o={replId:R,isLoggedIn:!0},[4,(0,G.getPid2Version)()];case 1:return o.requestedPid2Version=l.sent(),[4,(0,z.default)()];case 2:return[4,$.default.apply(void 0,[(o.overrideClusterMetadata=l.sent(),o)])];case 3:if(i=l.sent(),r.aborted)return[2];return s={credentials:{username:null!=(a=null==i?void 0:i.token)?a:"",password:null!=f?f:"",target:""}},(0,F.track)(U.events.VNC_CONNECTED),S.current=u=new k(g.current,I,s),u.background="black",(null==(e=T.current)?void 0:e.scaleViewport)!==void 0&&(u.scaleViewport=T.current.scaleViewport),(null==(t=T.current)?void 0:t.resizeSession)!==void 0&&(u.resizeSession=T.current.resizeSession),(null==(n=T.current)?void 0:n.viewOnly)!==void 0&&(u.viewOnly=T.current.viewOnly),u.addEventListener("connect",D),u.addEventListener("disconnect",O),u.addEventListener("securityfailure",N),[2]}})})()},[R,k,M,T,f,I,D,O,N]);return(0,c.useEffect)(function(){S.current&&((null==d?void 0:d.scaleViewport)!==void 0&&(S.current.scaleViewport=d.scaleViewport),(null==d?void 0:d.resizeSession)!==void 0&&(S.current.resizeSession=d.resizeSession),(null==d?void 0:d.viewOnly)!==void 0&&(S.current.viewOnly=d.viewOnly))},[d]),(0,c.useEffect)(function(){k&&Q()},[k,Q]),(0,c.useEffect)(function(){k&&void 0!==f&&Q()},[k,f,Q]),(0,c.useEffect)(function(){if("Disconnected"===y||"Errored"===y&&(null==d?void 0:d.reconnectOnError)){var e=setTimeout(Q,100*Math.pow(2,j.current));return function(){clearTimeout(e)}}},[y,Q,null==d?void 0:d.reconnectOnError]),(0,c.useEffect)(function(){return function(){M()}},[M]),{status:y,vncUrl:I,vncEl:g,connect:Q,disconnect:M}}e.s(["Status",()=>Q,"useNoVNC",()=>X],848327);var J=e.i(625484),Z=e.i(194004);function ee(e){var t=e.animating,n=e.children;return(0,u.jsx)(J.View,{clsx:t?Z.default.emptyStateOverlayAnimating:Z.default.emptyStateOverlay,align:"center",justify:"center",gap:4,children:n})}var et=e.i(435281),en=e.i(653412),er=e.i(136540),ei=e.i(739521),eo=e.i(940745),ea=e.i(792774),es=e.i(292944);function el(e){var t=e.children,n=e.left,r=e.title,i=e.isOpen,o=e.disableClose,a=e.onRequestClose,s=e.onSkipTest,l=e.skipping,d=(0,et.useViewportSize)(),f=(0,c.useMemo)(function(){if(!d.height||!d.width)return{modalMaxWidth:"min(1320px, 80vw)",paddingTop:64};var e=Math.min((d.width-32)/1288,(d.height-160)/804,1),t=Math.floor(1288*e),n=Math.floor(804*e),r=Math.max(16,Math.floor((d.height-(n+160))/2));return{modalMaxWidth:"min(".concat(t,"px, 90vw)"),paddingTop:r}},[d.height,d.width]),p=f.modalMaxWidth,h=f.paddingTop;return(0,u.jsx)(ei.Modal,{isOpen:i,maxWidth:p,topPadding:h,hideCloseButton:!0,onRequestClose:function(){o||a()},noPadding:!0,children:(0,u.jsx)(en.EventPane,{left:n,title:r,right:(0,u.jsxs)(J.View,{row:!0,gap:4,children:[void 0!==s?(0,u.jsx)(er.IconButton,{alt:"Skip test",onClick:s,children:l?(0,u.jsx)(eo.default,{size:12}):(0,u.jsx)(es.default,{size:12})}):null,o?null:(0,u.jsx)(er.IconButton,{alt:"Minimize",onClick:a,children:(0,u.jsx)(ea.default,{size:12})})]}),bordered:!1,children:t})})}var eu=e.i(960178),ec=e.i(300378);function ed(e){var t=e.text,n=e.large,r=e.live;return(0,u.jsx)(J.View,{clsx:[n?ec.default.large:ec.default.small,r&&ec.default.fadeIn],children:(0,u.jsx)(eu.Text,{clsx:[ec.default.preserveNewlines],color:r?"dimmest":"default",children:t})},t)}function ef(e){var t=e.instructions,n=e.overview;return t?(0,u.jsxs)(J.View,{gap:4,children:[(0,u.jsx)(eu.Text,{color:"dimmer",children:void 0!==n&&n?"Agent needs your help doing the following tasks:":"I need your help with the following tasks:"}),(0,u.jsx)(eu.Text,{clsx:ec.default.preserveNewlines,children:t})]}):null}function ep(e){var t=e.notes,n=e.live;return t?(0,u.jsxs)(J.View,{clsx:n&&ec.default.fadeIn,gap:4,children:[(0,u.jsx)(eu.Text,{color:"dimmer",children:"The following notes were left:"}),(0,u.jsx)(eu.Text,{clsx:ec.default.preserveNewlines,color:n?"dimmest":"default",children:t})]},t):null}var eh=e.i(480028),eg=e.i(140487),em=e.i(91720),ev=e.i(607278),ex=e.i(396776),ey=e.i(616278),eb=e.i(243914),ew=e.i(90102),ek=e.i(353384),e_=e.i(42458);function eS(e){var t=e.instructions,n=e.deadline,i=e.disabled,o=e.onReject,s=e.onAccept,d=(0,a._)((0,c.useState)(!1),2),f=d[0],p=d[1],h=(0,a._)((0,c.useState)(!1),2),g=h[0],m=h[1],x=(0,a._)((0,c.useState)(!1),2),y=x[0],b=x[1];return(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)(eE,{isOpen:f,instructions:t,loading:y,disabled:i,onClose:function(){return p(!1)},onAccept:function(){return(0,r._)(function(){return(0,l._)(this,function(e){switch(e.label){case 0:return b(!0),[4,s()];case 1:return e.sent(),b(!1),[2]}})})()}}),(0,u.jsxs)(J.View,{gap:4,row:!0,children:[(0,u.jsx)(eI,{deadline:n,loading:g,disabled:i||y,onReject:function(){return(0,r._)(function(){return(0,l._)(this,function(e){switch(e.label){case 0:return m(!0),[4,o()];case 1:return e.sent(),m(!1),[2]}})})()}}),(0,u.jsx)(J.View,{grow:!0,children:(0,u.jsx)(eg.Button,{colorway:"blurple",text:"Begin take over",iconLeft:(0,u.jsx)(ek.default,{}),loading:f,disabled:i||g,onClick:function(){return p(!0)}})})]})]})}function eC(e){var t=e.instructions,n=e.disabled,i=e.onComplete,o=(0,a._)((0,c.useState)(!1),2),s=o[0],d=o[1],f=(0,a._)((0,c.useState)(!1),2),p=f[0],h=f[1];return(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)(eT,{isOpen:s,instructions:t,loading:p,onClose:function(){return d(!1)},onComplete:function(e){return(0,r._)(function(){return(0,l._)(this,function(t){switch(t.label){case 0:return h(!0),[4,i(e)];case 1:return t.sent(),h(!1),[2]}})})()}}),(0,u.jsxs)(J.View,{align:"center",gap:4,children:[(0,u.jsx)(eg.Button,{stretch:!0,colorway:"green",text:"Mark take over complete",iconRight:(0,u.jsx)(ey.default,{}),disabled:n,onClick:function(){return d(!0)}}),(0,u.jsx)(eu.Text,{color:"dimmest",children:"Make sure youve completed the above tasks before marking complete"})]})]})}function ej(e){var t=e.instructions,n=e.deadline,i=e.accepted,o=e.disabled,s=e.onReject,d=e.onAccept,f=(0,a._)((0,c.useState)(!1),2),p=f[0],h=f[1],g=(0,a._)((0,c.useState)(!1),2),m=g[0],x=g[1],b=(0,a._)((0,c.useState)(!1),2),w=b[0],k=b[1],_=(0,y.useIsInMobileWorkspace)();return(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)(eE,{isOpen:p,instructions:t,loading:w,disabled:o||i||_,onClose:function(){return h(!1)},onAccept:function(){return(0,r._)(function(){return(0,l._)(this,function(e){switch(e.label){case 0:return k(!0),[4,d()];case 1:return e.sent(),k(!1),[2]}})})()}}),(0,u.jsxs)(J.View,{gap:8,children:[(0,u.jsxs)(J.View,{gap:4,row:!0,children:[i?null:(0,u.jsx)(eI,{deadline:n,loading:m,disabled:o||w,onReject:function(){return(0,r._)(function(){return(0,l._)(this,function(e){switch(e.label){case 0:return x(!0),[4,s()];case 1:return e.sent(),x(!1),[2]}})})()}}),(0,u.jsx)(J.View,{grow:!0,children:(0,u.jsx)(eg.Button,{colorway:"blurple",text:i?"Take over in progress...":"Begin take over",iconLeft:i?(0,u.jsx)(eo.default,{}):(0,u.jsx)(ek.default,{}),loading:w||i,disabled:o||_||m,onClick:function(){return h(!0)}})})]}),_?(0,u.jsx)(ex.StatusBanner,{colorway:"warning",text:"App testing take over is not currently supported on mobile. You can continue on desktop."}):null]})]})}function eT(e){var t=e.isOpen,n=e.instructions,r=e.loading,i=e.onClose,o=e.onComplete,s=(0,a._)((0,c.useState)(""),2),l=s[0],d=s[1];return(0,u.jsx)(ei.Modal,{isOpen:t,onRequestClose:i,hideCloseButton:!0,centered:!0,children:(0,u.jsxs)(J.View,{gap:8,children:[(0,u.jsx)(eu.Text,{variant:"subheadDefault",children:"Did you complete all the tasks at hand?"}),(0,u.jsx)(ef,{instructions:n,overview:!0}),(0,u.jsxs)(J.View,{justify:"space-between",row:!0,children:[(0,u.jsx)(eu.Text,{color:"dimmer",children:"Add additional context"}),(0,u.jsx)(eu.Text,{color:"dimmest",children:"Optional"})]}),(0,u.jsx)(ev.MultiLineInput,{placeholder:"Type here",rows:4,value:l,onChange:function(e){return d(e.target.value)}}),(0,u.jsxs)(J.View,{row:!0,gap:4,children:[(0,u.jsx)(eg.Button,{text:"Go back",onClick:i}),(0,u.jsx)(J.View,{grow:!0,children:(0,u.jsx)(eg.Button,{text:"Mark take over complete",iconRight:(0,u.jsx)(ey.default,{}),colorway:"green",loading:r,onClick:function(){return o(l)}})})]})]})})}function eE(e){var t=e.isOpen,n=e.instructions,r=e.loading,i=e.disabled,o=e.onClose,a=e.onAccept;return(0,u.jsx)(ei.Modal,{isOpen:t,onRequestClose:o,hideCloseButton:!0,centered:!0,children:(0,u.jsxs)(J.View,{gap:20,children:[(0,u.jsx)(eu.Text,{variant:"subheadDefault",children:"Youre about to take over Agents browser"}),(0,u.jsx)(ef,{instructions:n,overview:!0}),(0,u.jsxs)(J.View,{gap:12,children:[(0,u.jsx)(eu.Text,{color:"dimmest",children:"Things to acknowledge:"}),(0,u.jsxs)(J.View,{gap:8,children:[(0,u.jsxs)(J.View,{align:"center",gap:8,row:!0,children:[(0,u.jsx)(ew.default,{size:16,color:eh.tokens.foregroundDimmest}),"Only you can see the info you enter (like passwords) during takeover"]}),(0,u.jsxs)(J.View,{align:"center",gap:8,row:!0,children:[(0,u.jsx)(e_.default,{size:16,color:eh.tokens.foregroundDimmest}),"Signing Agent into a website could put your data at risk"]})]})]}),(0,u.jsxs)(J.View,{gap:4,justify:"space-between",row:!0,children:[(0,u.jsx)(em.ButtonLink,{href:"/",variant:"nofill",text:(0,u.jsx)(eu.Text,{color:"dimmest",children:"Learn more about Agent Testing"}),iconRight:(0,u.jsx)(eb.default,{color:eh.tokens.foregroundDimmest})}),(0,u.jsx)(eg.Button,{colorway:"blurple",text:"Acknowledge & begin",iconRight:(0,u.jsx)(ey.default,{}),loading:r,disabled:i,onClick:function(){return a()}})]})]})})}function eR(e){return Math.ceil(Math.max(0,e.getTime()-Date.now())/1e3)}function eI(e){var t,n,r=e.deadline,i=e.loading,o=e.disabled,s=e.onReject,l=(0,a._)((0,c.useState)(function(){return eR(r)}),2),d=l[0],f=l[1];return(0,c.useEffect)(function(){f(eR(r));var e=setInterval(function(){f(eR(r))},1e3);return function(){return clearInterval(e)}},[r]),(0,u.jsx)(eg.Button,{text:(0,u.jsxs)(J.View,{gap:4,align:"center",row:!0,children:[(0,u.jsx)(eu.Text,{children:"Skip"}),0===d||i?(0,u.jsx)(eo.default,{}):(0,u.jsx)(eu.Text,{color:"dimmest",children:" ".concat((t="".concat(Math.floor(d/60),"m"),n="".concat(d%60,"s"),d>=60&&"0s"===n?t:d<60?n:"".concat(t," ").concat(n)))})]}),loading:i,disabled:o||0===d,onClick:function(){return null==s?void 0:s()}})}function eA(e){var t=e.status,n=e.instructions,r=e.deadline,i=e.inline,o=e.disabled,a=e.onAccept,s=e.onComplete,l=e.onReject;return i?(0,u.jsx)(ej,{instructions:n,deadline:r,accepted:"accepted"===t,disabled:o,onReject:l,onAccept:a}):"accepted"===t?(0,u.jsx)(eC,{instructions:n,disabled:o,onComplete:s}):(0,u.jsx)(eS,{instructions:n,deadline:r,disabled:o,onReject:l,onAccept:a})}var eP=e.i(245225),eD=e.i(417095),eO=e.i(942163);function eN(){return(0,u.jsx)(J.View,{clsx:eO.default.liveIndicator,children:(0,u.jsx)(J.View,{clsx:eO.default.liveIndicatorDot})})}function eM(e){var t=e.status;switch(t){case Q.Connected:return null;case Q.Connecting:case Q.Disconnected:return(0,u.jsx)(ee,{});case Q.Errored:return(0,u.jsx)(ee,{children:(0,u.jsx)(eu.Text,{children:"There was an error connecting to the browser"})});default:(0,N.default)(t)}}function eL(e){var t=e.isReadWrite,n=void 0!==t&&t,r=(0,a._)((0,c.useState)(void 0),2),i=X({password:r[0],setPassword:r[1],handlePromptForPassword:function(){},vncOptions:{scaleViewport:!0,resizeSession:!1,viewOnly:!n,reconnectOnError:!0,desktopSize:{width:1288,height:804}}}),o=i.vncEl,s=i.status;return(0,u.jsxs)(J.View,{clsx:[eO.default.vncInner,!n&&eO.default.vncInnerReadOnly],children:[(0,u.jsx)(J.SpecializedView.div,{ref:o,clsx:[eO.default.vncNovnc,s!==Q.Connected&&eO.default.vncNovncHidden]}),(0,u.jsx)(eM,{status:s}),n?null:(0,u.jsx)(eN,{})]})}function eB(e){var t=e.takeover,n=e.narration,r=e.inline,i=void 0!==r&&r,o=e.disabled,a=(0,M.useIsVNCPortOpened)(),s=(0,y.useIsInMobileWorkspace)(),l=(0,h.useObservable)(n),c=(null==l?void 0:l.full)||"I'm starting up a browser to begin testing. My thoughts will show up here.";return(0,u.jsxs)(J.View,{p:8,gap:8,children:[(0,u.jsx)(J.View,{clsx:[eO.default.vncWrapper,a&&eO.default.pulseBorderAnimation],children:a?(0,u.jsx)(eL,{isReadWrite:!i&&!s&&(null==t?void 0:t.request.status)==="accepted"}):(0,u.jsx)(ee,{animating:!0})}),t?null:(0,u.jsx)(ed,{text:c,large:!i,live:!0}),t?(0,u.jsx)(ef,{instructions:t.request.instructions}):null,t&&(i||!s)?(0,u.jsx)(eA,{status:t.request.status,instructions:t.request.instructions,deadline:t.request.deadline,inline:i,disabled:o,onAccept:function(){return t.accept()},onComplete:function(e){return t.complete(e)},onReject:function(){return t.reject()}},t.request.sessionId):null]})}function eV(e){var t=e.title,n=e.takeover,r=e.narration,i=e.onSkipTest,o=e.skipping,s=(0,a._)((0,c.useState)(!1),2),l=s[0],d=s[1],f=(0,y.useIsInMobileWorkspace)();(0,c.useEffect)(function(){(null==n?void 0:n.request.status)==="accepted"&&d(!0)},[null==n?void 0:n.request.status]);var p=(0,c.useCallback)(function(){d(!0)},[]),h=(0,c.useCallback)(function(){d(!1)},[]);return(0,u.jsxs)(en.EventPane,{left:(null==n?void 0:n.request.status)==="accepted"?(0,u.jsx)(ek.default,{size:16}):(0,u.jsx)(eP.default,{clsx:eO.default.rotationAnimation,size:16}),title:(null==n?void 0:n.request.status)==="accepted"?"Take over in progress...":t,right:(0,u.jsxs)(J.View,{row:!0,gap:4,children:[(0,u.jsx)(er.IconButton,{alt:"Skip test",disabled:o,onClick:i,children:o?(0,u.jsx)(eo.default,{size:12}):(0,u.jsx)(es.default,{size:12})}),f?null:(0,u.jsx)(er.IconButton,{alt:"Maximize",onClick:p,children:(0,u.jsx)(eD.default,{size:12})})]}),children:[(0,u.jsx)(eB,{narration:r,takeover:n,disabled:o,inline:!0}),(0,u.jsx)(el,{isOpen:!f&&l,onRequestClose:h,disableClose:(null==n?void 0:n.request.status)==="accepted",left:(0,u.jsx)(eP.default,{clsx:eO.default.rotationAnimation,size:16}),title:t,onSkipTest:i,skipping:o,children:(0,u.jsx)(eB,{narration:r,takeover:n,disabled:o})})]})}var eF=e.i(904851),eU=e.i(90659),eG=e.i(721281),e$=e.i(992785);e.i(242933);var ez=e.i(424360),eH=e.i(167690),eW=e.i(906204),eq=e.i(838379),eK=function(){function e(){var t=this;(0,eF._)(this,e),(0,eG._)(this,"timeline",void 0),(0,eG._)(this,"status",void 0),(0,eG._)(this,"index",void 0),(0,eG._)(this,"length",void 0),(0,eG._)(this,"video",void 0),(0,eG._)(this,"listener",void 0),(0,eG._)(this,"timer",void 0),(0,eG._)(this,"startTime",void 0),(0,eG._)(this,"cleanups",void 0),(0,eG._)(this,"state",new ez.Multicast(function(e){var n=null;return t.listener=function(){var r,i,o={status:t.status,current:null!=(r=t.timeline[t.index])?r:null,final:null!=(i=t.timeline[t.timeline.length-1])?i:null,length:t.length,index:t.index};(0,e$.default)(n,o)||(n=o,e.next(o))},t.listener(),function(){t.listener=null}})),this.timeline=[],this.status="stopped",this.index=0,this.length=0,this.video=null,this.listener=null,this.timer=null,this.startTime=null,this.cleanups=[]}return(0,eU._)(e,[{key:"getCurrentMinimumEventTime",value:function(){var e,t=this.timeline[this.index];return t&&(null==(e=t.narration)?void 0:e.full)?Math.max(2e3,(t.narration.full||"").trim().split(/\s+/).filter(function(e){return e.length>0}).length/7*1e3):2e3}},{key:"update",value:function(e){var t,n,r,i=this.video;this.timeline=null!=(n=e.timeline)?n:this.timeline,this.video=null!=(r=e.video)?r:this.video,e.timeline&&(this.length=e.timeline.length,this.index>=this.length&&(this.index=Math.max(0,this.length-1))),void 0!==e.video&&i!==e.video&&this.cleanupTimers(),"playing"===this.status&&this.startTimers(),null==(t=this.listener)||t.call(this)}},{key:"play",value:function(){if(0!==this.length){this.status="playing";var e,t=this.timeline[this.index];this.video&&this.video.paused&&(null==t?void 0:t.kind)==="live"&&this.video.src===t.video&&(this.video.currentTime=0,this.video.play().catch(function(){})),this.startTimers(),null==(e=this.listener)||e.call(this)}}},{key:"stop",value:function(){var e;this.status="stopped",this.index=0,this.cleanupTimers(),this.video&&!this.video.paused&&this.video.pause(),null==(e=this.listener)||e.call(this)}},{key:"toggle",value:function(){"playing"===this.status?this.stop():this.play()}},{key:"goto",value:function(e){e<0||e>=this.length?this.stop():(this.index=e,this.play())}},{key:"next",value:function(){this.index>=this.length-1?this.stop():this.goto(this.index+1)}},{key:"previous",value:function(){this.index>0&&this.goto(this.index-1)}},{key:"startTimers",value:function(){this.cleanupTimers();var e=this.timeline[this.index];(this.startTime=Date.now(),this.video)?"live"===e.kind?this.setupVideoHandlers():(this.startMinimumTimer(),this.video.src===e.video&&(this.video.currentTime=9999)):this.startMinimumTimer()}},{key:"startMinimumTimer",value:function(){var e,t=this,n=Date.now(),r=null!=(e=this.startTime)?e:n,i=this.getCurrentMinimumEventTime()-(n-r);i<=0?this.next():this.timer=setTimeout(function(){return t.next()},i)}},{key:"setupVideoHandlers",value:function(){var e=this;if(this.video){var t=this.video,n=null,r=function(){e.startTime=Date.now(),e.startMinimumTimer()},i=function(){n&&(clearTimeout(n),n=null),e.startTime=Date.now(),t.addEventListener("ended",r),t.addEventListener("error",r),e.cleanups.push(function(){t.removeEventListener("ended",r),t.removeEventListener("error",r)})};if(!t.paused&&t.readyState>=HTMLMediaElement.HAVE_CURRENT_DATA)i();else{t.paused&&t.src===(null==(o=this.timeline[this.index])?void 0:o.video)&&(t.currentTime=0,t.play().catch(function(){}));var o,a=function(){t.removeEventListener("playing",a),t.removeEventListener("error",a),i()};t.addEventListener("playing",a),t.addEventListener("error",a),this.cleanups.push(function(){t.removeEventListener("playing",a),t.removeEventListener("error",a),n&&clearTimeout(n)}),n=setTimeout(function(){t.removeEventListener("playing",a),t.removeEventListener("error",a),e.next()},this.getCurrentMinimumEventTime())}}}},{key:"cleanupTimers",value:function(){this.timer&&(clearTimeout(this.timer),this.timer=null);var e=[];if(this.cleanups.forEach(function(t){try{t()}catch(t){e.push(t)}}),this.cleanups=[],this.startTime=null,e.length)throw AggregateError(e)}},{key:"destroy",value:function(){this.cleanupTimers(),this.listener=null}}]),e}();function eY(e){var t=e.innerRef,n=e.url,r=e.paused,i=e.blurred;return(0,u.jsx)(J.View,{clsx:eq.default.playbackElement,children:(0,u.jsx)("video",{ref:t,clsx:[eq.default.playbackElementInner,i&&eq.default.isBlurred],src:n,autoPlay:!r,disablePictureInPicture:!0,playsInline:!0,muted:!0})})}function eQ(e){var t=e.videoRef,n=e.url,r=(0,c.useRef)({current:n,previous:null,seq:0});r.current.current!==n&&(r.current.previous=r.current.current,r.current.current=n,r.current.seq++);var i=r.current,o=i.current,a=i.previous,s=i.seq;return(0,u.jsxs)(u.Fragment,{children:[a?(0,u.jsx)(eY,{url:a},"".concat(a,"-").concat(s-1)):null,o?(0,u.jsx)(eY,{innerRef:t,url:o},"".concat(o,"-").concat(s)):null]})}function eX(e){var t=e.video,n=(0,c.useCallback)(function(e){e&&(e.currentTime=9999)},[]);return(0,u.jsxs)(u.Fragment,{children:[t?(0,u.jsx)(eY,{innerRef:n,url:t,paused:!0,blurred:!0}):null,(0,u.jsxs)(ee,{children:[(0,u.jsx)(eW.default,{size:24}),(0,u.jsx)(eu.Text,{children:"Watch replay"})]})]})}function eJ(){return(0,u.jsx)(ee,{children:(0,u.jsx)(eu.Text,{children:"The user took over the browser"})})}function eZ(e){var t,n,r,i,o,a,s,l,c=e.videoRef,d=e.manager,f=e.state,p=e.finalSummary,h=e.isEnlarged,g="playing"===f.status;return(0,u.jsxs)(J.View,{p:8,gap:8,children:[(0,u.jsx)(J.View,{clsx:eq.default.previewWrapper,onClick:function(){return d.toggle()},children:g?(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)(eQ,{videoRef:c,url:null!=(s=null==(t=f.current)?void 0:t.video)?s:null}),(null==(n=f.current)?void 0:n.takeover)?(0,u.jsx)(eJ,{}):null]}):(0,u.jsx)(eX,{video:null!=(l=null==(r=f.final)?void 0:r.video)?l:null})}),(0,u.jsx)(e0,{manager:d,state:f}),(0,u.jsx)(ed,{text:g?null==(i=f.current)?void 0:i.narration.full:p,large:void 0!==h&&h||(null==(o=f.current)?void 0:o.takeover)!==void 0,live:g}),g&&(null==(a=f.current)?void 0:a.takeover)?(0,u.jsx)(ep,{notes:f.current.takeover.notes,live:!0}):null]})}function e0(e){var t=e.manager,n=e.state,r="playing"===n.status?n.index:n.length;return(0,u.jsx)(J.View,{clsx:eq.default.history,children:Array.from({length:n.length+1}).map(function(e,n){return(0,u.jsx)(J.SpecializedView.button,{clsx:eq.default.historyElementButton,onClick:function(){return t.goto(n)},children:(0,u.jsx)(J.View,{clsx:[eq.default.historyElement,r===n?eq.default.isActive:null]})},n)})})}function e1(e){var t,n,r,i,o=e.timeline,s=e.title,l=e.finalSummary,d=e.resultType,f=(0,a._)((0,c.useState)(!1),2),p=f[0],g=f[1],m=(0,y.useIsInMobileWorkspace)(),x=(n=(t=(0,a._)((0,c.useState)(null),2))[0],r=t[1],i=(0,h.useObservable)(null==n?void 0:n.state,{status:"stopped",current:null,final:null,length:0,index:0}),(0,c.useEffect)(function(){var e=new eK;r(e);var t=null==o?void 0:o.subscribe(function(t){e.update({timeline:t})});return function(){null==t||t.unsubscribe(),r(function(e){return null==e||e.destroy(),null})}},[o]),{videoRef:(0,c.useCallback)(function(e){null==n||n.update({video:e})},[n]),manager:n,state:i}),b=x.videoRef,w=x.manager,k=x.state,_=(0,c.useCallback)(function(){g(!0)},[]),S=(0,c.useCallback)(function(){g(!1)},[]);if(!w)return null;var C=(0,u.jsx)(J.View,{clsx:eq.default.playIcon,children:(0,u.jsx)(er.IconButton,{alt:"playing"===k.status?"Stop":"Play",onClick:function(){return w.toggle()},children:d!==O.UITestingSubagentResultType.SUCCESS?(0,u.jsx)(eH.default,{size:12}):(0,u.jsx)(ey.default,{size:12})})});return(0,u.jsxs)(en.EventPane,{left:C,title:s,right:m?null:(0,u.jsx)(er.IconButton,{alt:"Maximize",onClick:_,children:(0,u.jsx)(eD.default,{size:12})}),children:[(0,u.jsx)(eZ,{videoRef:p?void 0:b,manager:w,state:k,finalSummary:l}),(0,u.jsx)(el,{isOpen:p,onRequestClose:S,left:C,title:s,children:(0,u.jsx)(eZ,{videoRef:b,manager:w,state:k,finalSummary:l,isEnlarged:!0})})]})}var e2=e.i(374106),e3={direction:"forward",state:{video:null,narration:{full:"",mini:""}},transformer:function(e,t){var n=(0,e2.getEventAgentToolDataFor)(e,"uiTestingSubagentTakeOverData");if(n){var r,i=n.userInstructions,o="rejected",a=null;return(null==(r=n.result)?void 0:r.$kind)==="success"&&(o="accepted",a=n.result.success.userNotes),{kind:"static",video:t.video,narration:t.narration,takeover:{status:o,instructions:i,notes:a}}}var s=(0,e2.getEventContentsFor)(e,"uiTestingSubagentExecutionEventContents");if(s){var l="static";return s.mimeType.startsWith("video/")&&(l="live",t.video=s.gcsDownloadUrl),s.narration&&(t.narration.full=s.narration),s.miniNarration&&(t.narration.mini=s.miniNarration),{kind:l,video:t.video,narration:t.narration}}}},e4={direction:"reverse",state:{full:"",mini:""},reducer:function(e,t){var n=(0,e2.getEventContentsFor)(e,"uiTestingSubagentExecutionEventContents");if(n&&n.narration)return t.full=n.narration,t.mini=n.miniNarration,!1}},e8=e.i(389503);e.i(545082);var e5=e.i(584647),e6=e.i(754873),e9=e.i(576073),e7=e.i(858501);function te(e){var t=e.timeline,n=e.narration,i=e.takeover,o=e.expandByDefault,s=e.isInProgress,d=e.title,f=e.finalSummary,p=e.resultType,h=e.onSkipTest,m=(0,a._)((0,c.useState)(void 0!==o&&o),2),x=m[0],y=m[1],b=(0,a._)((0,c.useState)(!1),2),w=b[0],k=b[1],_=(0,a._)((0,c.useState)(!1),2),S=_[0],C=_[1],j=(0,g.useObservableMemo)(function(){return t.select(function(e){return 0===e.length})},[t],{default:!1}),T=!S&&s,E=T||!j,R=(0,c.useCallback)(function(){E&&y(function(e){return!e})},[E]),I=(0,c.useCallback)(function(){return(0,r._)(function(){return(0,l._)(this,function(e){switch(e.label){case 0:k(!0),y(!1),C(!0),e.label=1;case 1:return e.trys.push([1,3,,4]),[4,h()];case 2:return e.sent(),[3,4];case 3:return e.sent(),k(!1),C(!1),[3,4];case 4:return[2]}})})()},[h]),A="Testing your app";return T||(A=p===O.UITestingSubagentResultType.SUCCESS?"Tested your app successfully":"Tested your app and sent results to Agent"),(0,u.jsxs)(J.View,{gap:6,children:[(0,u.jsxs)(J.View,{css:e6.interactive.nofill,px:4,tag:"button",row:!0,gap:6,align:"center",justify:"space-between",onClick:R,disabled:!E,children:[(0,u.jsxs)(J.View,{row:!0,align:"center",gap:6,clsx:e7.default.iconAndSummary,children:[(0,u.jsx)(eW.default,{color:eh.tokens.foregroundDimmer}),(0,u.jsx)(e8.Summary,{summary:A,color:"dimmer"})]}),E?(0,u.jsx)(e9.default,{color:eh.tokens.foregroundDimmer,rotate:180*!!x}):null]}),E&&x&&T?(0,u.jsx)(eV,{title:d,takeover:i,narration:n,onSkipTest:I,skipping:w}):null,E&&x&&!T?(0,u.jsx)(e1,{timeline:t,title:d,finalSummary:f,resultType:p}):null]})}function tt(e){var t=e.subagent,n=(0,h.useObservable)(t.running,!1),i=(0,g.useObservableMemo)(function(){return t.contents("uiTestingSubagentEventContents")},[t]),o=(0,c.useMemo)(function(){return t.session.transform(e3,500).flat},[t]),a=(0,c.useMemo)(function(){return t.session.reduce(e4,"global")},[t]),s=(0,e5.useCurrentAgentTestingTakeover)({sessionId:t.session.id}),d=(0,c.useCallback)(function(){return(0,r._)(function(){return(0,l._)(this,function(e){switch(e.label){case 0:return[4,null==s?void 0:s.reject()];case 1:return e.sent(),[4,t.abort()];case 2:return e.sent(),[2]}})})()},[t,s]);if(!i||!o||!a)return null;var f=i.title,p=i.finalSummary,m=i.resultType;return(0,u.jsx)(te,{timeline:o,narration:a,takeover:s,title:f,isInProgress:n,finalSummary:p,resultType:m,expandByDefault:!0,onSkipTest:d})}var tn=e.i(279606),tr=e.i(659131),ti=e.i(64386),to=e.i(633600),ta=e.i(986194),ts=e.i(166876),tl=e.i(876216),tu=new Set(["agentPlanStepBegin","alertData","blueprintsSetup","createFileData","createPostgresqlDatabaseData","deployConfigData","designGuidelinesData","fileEditData","imageGenerationData","mcpToolData","memoryCompressionData","packagerInstallData","packagerUninstallData","readDirData","readFileData","samplingEvent","screenshotData","searchFileData","searchFilesystemData","searchIntegrationsData","setupModelfarmData","setupObjectStorageData","shellExecutionData","sqlExecutionData","stockImageData","systemDependencyInstallData","systemDependencyUninstallData","taskListData","thoughts","toolchainInstallData","viewIntegrationData","viewLogsData","viewSpecialFiles","webPageVisitData","webSearchData","workflowsRemoveRunConfigToolData","workflowsRestartToolData","workflowsSetRunConfigToolData","workflowsStartToolData","workflowsStopToolData"]),tc=new Set(["programming_language_install_tool"]);function td(e){var t,n=(null==(t=e.optionType)?void 0:t.$kind)==="secretRequestAction"?e.optionType.secretRequestAction.secrets:void 0;return(null==n?void 0:n.length)?n:void 0}function tf(e){if(e.state===O.EventState.IN_PROGRESS)return!1;var t=e.contents.contents;if(!(0,ta.isKind)(t,"agentTimelineEventContents"))return!1;var n=t.agentTimelineEventContents,r=n.toolData;return"user_response"===n.toolName&&(null==r?void 0:r.$kind)==="messageData"}var tp=function(e){var t=e.shouldRenderToolCallsWithoutData,n=void 0!==t&&t,r=e.shouldPassThroughTaskListUpdates,o=void 0!==r&&r;return{direction:"reverse",state:{revert:null,acknowledged:new Set,approvedPlanId:null,approvedPlanEventId:null,didSeeRenderedEvent:!1,selectedFeatureIds:new Set,latestPlanId:null,secretResponses:new Set,environmentConfigResponses:new Set,approvedTaskListEventIds:new Set,taskListApprovalRequestEvents:new Map,latestInitialBuildApprovalRequestEventId:null,respondedQueryRequestEventIds:new Set,queryResponses:new Map,hasFurtherNonSummaryEvents:!1},transformer:function(e,t){var r=t.revert;(null==(w=t.revert)?void 0:w.eventIdBeforeRevert)===e.id&&(t.revert=null);var a=e.contents.contents,s=null;switch(null==a?void 0:a.$kind){case"sessionCreationEventContents":case"contextComplexityEventContents":return;case"requestFeatureAddData":a.requestFeatureAddData.type===O.RequestFeatureAddType.REQUEST_FEATURE_ADD_TYPE_NEON_DATABASE&&(s={type:"userMessage",id:e.id,message:"Please help me add a database to my app.",acknowledged:!0,created:e.created,attachedUrls:[],uploadedFiles:[],userId:Number(e.sender.id)});break;case"agentPlanEventContents":if(e.error.message){s={type:"error",id:e.id,message:e.error.message,shortMessage:e.error.shortMessage};break}var l=a.agentPlanEventContents,u=!1;null==t.latestPlanId&&(u=!0,t.latestPlanId=l.planId);var c=[],d="",f=[];if(l.step.subSteps.length>0){var p=(0,to._)(l.step.subSteps),h=p[0],g=p.slice(1);d=h.name,f=h.blueprintData,c=g,h.subSteps.length>1&&(c=h.subSteps.map(function(e){return{id:e.id,name:e.name}}))}if(l.requiresApproval&&t.approvedPlanId===l.planId)return;l.requiresApproval||(t.approvedPlanId=l.planId),s={type:"planProposal",id:e.id,features:c,objective:d,stackBlueprint:l.stackBlueprint,blueprints:f,planId:l.planId,sessionId:e.sessionId,eventState:e.state,eventCreated:e.created,eventUpdated:e.updated,isLatestPlan:u,approved:t.approvedPlanEventId===e.id||!l.requiresApproval};break;case"approvePlanEventContents":var m=a.approvePlanEventContents,x=m.agentConfig,y=m.planEventId,b=m.initialBuildMode;t.approvedPlanEventId=y,s={type:"planApproval",id:e.id,userId:Number(e.sender.id),created:e.created,planId:y,initialBuildMode:b,agentConfig:x};break;case"revertEventContents":var w,k,_=a.revertEventContents.eventIdBeforeRevert;if((null==(k=t.revert)?void 0:k.eventIdBeforeRevert)===_){t.revert.reverterId=e.sender.id,t.revert.commitId=a.revertEventContents.commitId;return}t.revert={eventIdBeforeRevert:_,hiddenEvents:0,status:"inflight",reverterId:e.sender.id};return;case"messageEventContents":if(e.sender.type===O.UserType.USER)s={type:"userMessage",id:e.id,userId:Number(e.sender.id),message:a.messageEventContents.content,uploadedFiles:a.messageEventContents.uploadedFiles,attachedUrls:a.messageEventContents.attachedUrls,created:null!=(S=e.created)?S:null,acknowledged:t.acknowledged.has(e.id),targetedElement:a.messageEventContents.targetedElement,agentConfig:a.messageEventContents.agentConfig};else{var S,C,j,T=td(a.messageEventContents.agentAction),E=!t.didSeeRenderedEvent&&(tf(e)||!!T);s={type:"agentMessage",id:e.id,message:null!=(j=null==a||null==(C=a.messageEventContents)?void 0:C.content)?j:"",requestedSecrets:T,sessionId:e.sessionId,state:e.state,waitingOnUser:E}}break;case"agentAskUserForActionRequest":var R=a.agentAskUserForActionRequest.request;if((0,ta.isKind)(R,"userSecretsRequest")){var I=(0,ta.unkind)(R),A=I.secrets,P=I.message,D=!0;t.secretResponses.has(e.id)&&(D=!1,t.secretResponses.delete(e.id)),s={type:"agentMessage",id:e.id,message:P,requestedSecrets:(null==A?void 0:A.length)?A:void 0,sessionId:e.sessionId,state:e.state,waitingOnUser:D};break}if((0,ta.isKind)(R,"environmentConfigRequest")){var N=(0,ta.unkind)(R),M=N.envVars,L=N.message,B=!0;t.environmentConfigResponses.has(e.id)&&(B=!1,t.environmentConfigResponses.delete(e.id)),s={type:"agentMessage",id:e.id,message:L,requestedEnvVars:(null==M?void 0:M.length)?M:void 0,sessionId:e.sessionId,state:e.state,waitingOnUser:B};break}if((0,ta.isKind)(R,"approveTaskListRequest")){var V=(0,ta.unkind)(R).taskListEventId;t.taskListApprovalRequestEvents.set(V,e.id);break}if((0,ta.isKind)(R,"approveInitialBuildMvpRequest")||(0,ta.isKind)(R,"approveInitialBuildVisualPhaseRequest")){var F=!1;null==t.latestInitialBuildApprovalRequestEventId&&(t.latestInitialBuildApprovalRequestEventId=e.id,F=!0);var U=(0,ta.unkind)(R),G=U.userSecretsRequest,$=U.addingIntegrationRequest;G&&G.secrets.length>0&&F&&(s={type:"askUserForAction",id:e.id,sessionId:e.sessionId,message:null==G?void 0:G.message,state:e.state,secretsRequest:G,isSecretsRequestFulfilled:t.secretResponses.has(e.id)}),(null==$?void 0:$.connectionIds.length)>0&&F&&(s={type:"askUserForAction",id:e.id,sessionId:e.sessionId,message:"",state:e.state,addingIntegrationRequest:$});break}if((0,ta.isKind)(R,"queryRequest")){if(!t.respondedQueryRequestEventIds.has(e.id))break;var z=R.queryRequest.queries;if(0===z.length||z.every(function(e){return null==e.queryType}))break;var H=t.queryResponses.get(e.id);H&&t.queryResponses.delete(e.id),s={type:"queryRequest",id:e.id,created:e.created,queries:R.queryRequest.queries,responses:H};break}if((0,ta.isKind)(R,"convertMockupToAppRequest")){s={type:"convertMockupToAppRequest",id:e.id,created:e.created};break}var W=(0,ta.isKind)(R,"nextStepRequest")?R.nextStepRequest.newFeatureRequests:void 0;W&&(W=W.map(function(e){return(0,ti._)((0,i._)({},e),{isSelected:t.selectedFeatureIds.has(e.id)})})),s={type:"askUserForAction",id:e.id,sessionId:e.sessionId,message:a.agentAskUserForActionRequest.message,state:e.state,newFeatureRequests:W};break;case"agentAskUserForActionResponse":var q,K=a.agentAskUserForActionResponse,Y=K.response,Q=K.requestEventId,X=Number(e.sender.id),J=(null==Y?void 0:Y.$kind)==="nextStepResponse"&&(null==(q=Y.nextStepResponse.response)?void 0:q.$kind)==="newFeatureResponse"?Y.nextStepResponse.response.newFeatureResponse:null;if(J)return t.selectedFeatureIds.add(J.selectedFeatureId),{type:"userMessage",id:e.id,userId:X,message:J.featureName,uploadedFiles:[],attachedUrls:[],created:e.created,acknowledged:!0};if((null==Y?void 0:Y.$kind)==="userSecretsResponse")t.secretResponses.add(Q);else if((null==Y?void 0:Y.$kind)==="envVarsResponse")t.environmentConfigResponses.add(Q);else if((null==Y?void 0:Y.$kind)==="approveTaskListResponse"){if(Y.approveTaskListResponse.approved){var Z=Y.approveTaskListResponse,ee=Z.taskListEventId,et=Z.agentConfig;return t.approvedTaskListEventIds.add(ee),{type:"taskListApproval",id:e.id,state:e.state,userId:X,created:e.created,taskListEventId:ee,agentConfig:(0,ti._)((0,i._)({},et),{agentMode:O.AgentMode.AGENT_MODE_GENERAL})}}}else if((null==Y?void 0:Y.$kind)==="approveInitialBuildMvpResponse"&&Y.approveInitialBuildMvpResponse.approved){var en=Y.approveInitialBuildMvpResponse.agentConfig;s={type:"initialBuildPhaseApproval",id:e.id,userId:X,created:e.created,initialBuildPhase:O.InitialBuildPhase.INITIAL_BUILD_PHASE_MVP_COMPLETE_PENDING_REVIEW,agentConfig:en}}else if((null==Y?void 0:Y.$kind)==="approveInitialBuildVisualPhaseResponse"&&Y.approveInitialBuildVisualPhaseResponse.approved){var er=Y.approveInitialBuildVisualPhaseResponse.agentConfig;Y.approveInitialBuildVisualPhaseResponse.userSecretsResponse.providedSecrets.length>0&&t.secretResponses.add(Q),s={type:"initialBuildPhaseApproval",id:e.id,userId:X,created:e.created,initialBuildPhase:O.InitialBuildPhase.INITIAL_BUILD_PHASE_VISUAL_COMPLETE_PENDING_REVIEW,agentConfig:er}}else(null==Y?void 0:Y.$kind)==="convertMockupToAppResponse"?s={type:"convertMockupToAppResponse",id:e.id,created:e.created,additionalComments:Y.convertMockupToAppResponse.additionalComments,approved:Y.convertMockupToAppResponse.approved}:(null==Y?void 0:Y.$kind)==="queryResponse"&&(t.respondedQueryRequestEventIds.add(Q),t.queryResponses.set(Q,Y.queryResponse.responses));break;case"setupImportedProjectEventContents":var ei=t.didSeeRenderedEvent;s={type:"setupImport",id:e.id,sessionId:e.sessionId,importSource:a.setupImportedProjectEventContents.importSource,state:ei?O.EventState.COMPLETE:O.EventState.IN_PROGRESS};break;case"tipRecommendation":var eo=a.tipRecommendation;s={type:"tipRecommendation",id:e.id,sessionId:e.sessionId,created:e.created,tip:{id:eo.tipId,title:eo.title,recommendedReason:eo.recommendedReason}};break;case"subagentRunning":if((null==(em=e.contents.contents)?void 0:em.$kind)==="subagentRunning"){var ea=e.contents.contents.subagentRunning;s={type:"subagent",id:ea.subagentId,eventId:e.id,parentId:e.sessionId,sessionId:ea.childSessionId,created:e.created}}break;case"agentTimelineEventContents":if(e.error.message){s={type:"error",id:e.id,message:e.error.message,shortMessage:e.error.shortMessage};break}var es=a.agentTimelineEventContents,el=es.toolName,eu=es.toolData;switch(null==eu?void 0:eu.$kind){case"messageData":var ec=td(eu.messageData.agentAction),ed=!t.didSeeRenderedEvent&&(tf(e)||!!ec);s={type:"agentMessage",id:e.id,message:eu.messageData.content,requestedSecrets:ec,sessionId:e.sessionId,state:e.state,waitingOnUser:ed};break;case"acknowledgeUserMessage":var ef=eu.acknowledgeUserMessage.eventIds,ep=!0,eh=!1,eg=void 0;try{for(var em,ev,ex=ef[Symbol.iterator]();!(ep=(ev=ex.next()).done);ep=!0){var ey=ev.value;t.acknowledged.add(ey)}}catch(e){eh=!0,eg=e}finally{try{ep||null==ex.return||ex.return()}finally{if(eh)throw eg}}break;case"commitData":s=(0,ti._)((0,i._)({type:"checkpoint"},eu.commitData),{id:e.id,parentEventId:e.parentEventId,title:eu.commitData.description.split("\n")[0],isPaid:eu.commitData.billingRate===O.CommitBillingRate.NORMAL,created:e.created,sessionId:e.sessionId,state:e.state,revert:null!=r?r:void 0,hasFurtherNonSummaryEvents:t.hasFurtherNonSummaryEvents});break;case"endOfRunSummaryData":var eb=eu.endOfRunSummaryData;if(0===eb.usageCents&&0===eb.toolCalls)break;return(0,ti._)((0,i._)({type:"endOfRunSummary"},eu.endOfRunSummaryData),{id:e.id});case"revertData":return t.revert={eventIdBeforeRevert:eu.revertData.eventIdBeforeRevert,hiddenEvents:0,revertedAt:e.created,status:eu.revertData.status===O.RevertStatus.REVERT_DATA_STAGE_COMPLETE?"completed":"inflight"},s={type:"revert",id:e.id,status:eu.revertData.status,revertedAt:e.created,originalSessionId:eu.revertData.originalSessionId,checkpointTitle:eu.revertData.checkpointTitle};case"deployData":s={type:"suggestDeploy",id:e.id};break;case"suggestRollbackData":s={type:"suggestRollback",id:e.id,suggestRollbackReason:eu.suggestRollbackData.suggestRollbackReason};break;case"taskListData":var ew,ek=t.approvedTaskListEventIds.has(e.id),e_=eu.taskListData.agentMode===O.AgentMode.AGENT_MODE_DISCUSSION;if((0,ts.isFirstInstanceOfTaskList)(eu.taskListData)&&(ek||e_)){s={type:"taskList",subType:"creation",id:e.id,sessionId:e.sessionId,eventState:e.state,eventCreated:e.created,tasks:eu.taskListData.tasks,agentMode:eu.taskListData.agentMode,approved:ek,approvalRequestEventId:null!=(ew=t.taskListApprovalRequestEvents.get(e.id))?ew:null};break}var eS=(0,ts.getCompletedTasks)(eu.taskListData);if(eS.length>0){s={type:"taskList",subType:"itemsCompleted",id:e.id,sessionId:e.sessionId,eventState:e.state,eventCreated:e.created,completedTasks:eS,tasks:eu.taskListData.tasks,commitData:eu.taskListData.commitData,estimatedUsageCents:eu.taskListData.estimatedUsageCents};break}o&&(s={type:"taskList",subType:"update",id:e.id,sessionId:e.sessionId,eventState:e.state,eventCreated:e.created,tasks:eu.taskListData.tasks});break;default:var eC=n&&tc.has(el),ej=!!(null==eu?void 0:eu.$kind)&&tu.has(eu.$kind);if(!eC&&!ej||e.state===O.EventState.IN_PROGRESS)break;var eT=(0,tl.getToolUseSummary)(e);if(!eT)break;var eE=function(e){if(!e)return null;if(e.error.type!==O.EventErrorType.EVENT_ERROR_TYPE_UNKNOWN)return{$kind:"error",error:e.error};var t=e.contents.contents;if((null==t?void 0:t.$kind)!=="agentTimelineEventContents")return null;var n=t.agentTimelineEventContents.toolData,r=(0,tl.getToolUseSummary)(e),i={$kind:null,summary:r,state:e.state};switch(null==n?void 0:n.$kind){case"fileEditData":var o=null==n?void 0:n.fileEditData,a=null==o?void 0:o.filePath,s=null==o?void 0:o.diff;if(void 0===a||void 0===s)return i;return{$kind:"fileEditData",state:e.state,path:a,diff:s,summary:r};case"createFileData":var l=null==n?void 0:n.createFileData,u=null==l?void 0:l.filePath,c=null==l?void 0:l.content;if(void 0===u||void 0===c)return i;return{$kind:"createFileData",content:c,path:u,summary:r};case"shellExecutionData":return{$kind:"shellExecutionData",data:n.shellExecutionData,summary:r};case"readFileData":return{$kind:"readFileData",data:n.readFileData,summary:r};case"readDirData":return{$kind:"readDirData",data:n.readDirData,summary:r};case"packagerInstallData":var d=n.packagerInstallData,f=d.inputLanguage,p=d.inputPackages,h=d.output,g=d.isExecuting,m=d.processId;if(void 0===f||void 0===p)return i;return{$kind:"packagerInstallData",state:e.state,language:f,installed:p,output:void 0===h?void 0:h,isExecuting:void 0!==g&&g,processId:void 0===m?void 0:m,summary:r};case"packagerUninstallData":var x=n.packagerUninstallData;return{$kind:"packagerUninstallData",language:x.inputLanguage,uninstalled:x.inputPackages,summary:r};case"systemDependencyInstallData":var y=n.systemDependencyInstallData.deps;if(void 0===y)return i;return{$kind:"systemDependencyInstallData",deps:y,summary:r};case"systemDependencyUninstallData":var b=n.systemDependencyUninstallData.deps;if(void 0===b)return i;return{$kind:"systemDependencyUninstallData",deps:b,summary:r};case"toolchainInstallData":return{$kind:"toolchainInstallData",modules:n.toolchainInstallData.modules,summary:r};case"screenshotData":return{$kind:"screenshotData",imageUrl:n.screenshotData.imageUrl,summary:r};case"planProgressData":case"agentPlanStepBegin":case"workflowsStopToolData":case"workflowsGetOutputToolData":case"workflowsRemoveRunConfigToolData":return null;case"workflowsStartToolData":return{$kind:n.$kind,workflowName:n.workflowsStartToolData.name,state:e.state,summary:r};case"workflowsRestartToolData":return{$kind:n.$kind,workflowName:n.workflowsRestartToolData.name,state:e.state,restart:!0,summary:r};case"workflowsSetRunConfigToolData":return{$kind:n.$kind,workflowName:n.workflowsSetRunConfigToolData.name,state:e.state,summary:r};case"deployData":return{$kind:n.$kind,summary:r,result:n.deployData};case"presentResultsToolData":return{$kind:n.$kind,summary:r,result:n.presentResultsToolData};case"createPostgresqlDatabaseData":case"memoryCompressionData":return{$kind:n.$kind,summary:r};case"sqlExecutionData":return{$kind:n.$kind,data:n.sqlExecutionData,summary:r};case"webSearchData":return{$kind:n.$kind,data:n.webSearchData,summary:r};case"webPageVisitData":return{$kind:n.$kind,data:n.webPageVisitData,summary:r};case"imageGenerationData":return{$kind:n.$kind,data:n.imageGenerationData,summary:r};case"stockImageData":return{$kind:n.$kind,data:n.stockImageData,summary:r};case"searchFilesystemData":var w=n.searchFilesystemData.resultFileNames;return w.length?{$kind:n.$kind,resultFileNames:w,summary:r}:null;case"taskListData":return{$kind:n.$kind,data:n.taskListData,summary:r};case"samplingEvent":return{$kind:n.$kind,data:n.samplingEvent,summary:r};case"thoughts":return{$kind:n.$kind,thoughts:n.thoughts.thoughts};case"setupObjectStorageData":return{$kind:n.$kind,summary:r,bucketId:n.setupObjectStorageData.bucketId,bucketName:n.setupObjectStorageData.bucketName};case"blueprintsSetup":return{$kind:n.$kind,summary:r,blueprintData:n.blueprintsSetup.blueprintData};case"setupModelfarmData":return{$kind:n.$kind};case"viewLogsData":return{$kind:n.$kind,data:n.viewLogsData,summary:r};case"viewSpecialFiles":return{$kind:n.$kind,data:n.viewSpecialFiles,summary:r};case"designGuidelinesData":return{$kind:n.$kind,data:n.designGuidelinesData,summary:r};case"searchIntegrationsData":return{$kind:n.$kind,data:n.searchIntegrationsData};case"viewIntegrationData":return{$kind:n.$kind,data:n.viewIntegrationData};case"mcpToolData":return{$kind:n.$kind,data:n.mcpToolData};default:return i}}(e);s={type:"agentToolUse",id:e.id,sessionId:e.sessionId,toolDataKind:null==eu?void 0:eu.$kind,toolName:el,summary:eT,data:eE}}}if(s)return t.didSeeRenderedEvent=!0,t.hasFurtherNonSummaryEvents=!0,s}}};e.s(["getAgentEventsTransformer",()=>tp],836140);var th=e.i(462995),tg=e.i(929872),tm=e.i(462783),tv=e.i(349556),tx=e.i(151474);function ty(e){var t=e.expanded,n=e.onClick,r=e.title,i=e.children,o=e.icon;return(0,u.jsxs)(J.View,{children:[(0,u.jsxs)(J.View,{css:e6.interactive.nofill,clsx:tx.default.expandableButton,px:4,tag:"button",row:!0,gap:6,align:"center",justify:"space-between",onClick:n,children:[(0,u.jsxs)(J.View,{row:!0,align:"center",gap:6,grow:!0,shrink:!0,children:[null!=o?o:(0,u.jsx)(tv.default,{color:eh.tokens.foregroundDimmer}),(0,u.jsx)(e8.Summary,{summary:r,color:"dimmer"})]}),t?(0,u.jsx)(tm.default,{color:eh.tokens.foregroundDimmer,clsx:tx.default.chevron}):(0,u.jsx)(e9.default,{color:eh.tokens.foregroundDimmer,clsx:tx.default.chevron})]}),t?(0,u.jsx)(tg.Surface,{children:(0,u.jsx)(J.View,{py:8,children:i})}):null]})}var tb=(0,c.memo)(function(e){var t=e.data,n=(0,o._)(e,["data"]);return(0,u.jsx)(D.EventRenderer,(0,i._)({data:t},n))}),tw=e.i(254806),tk=e.i(15260),t_=e.i(725352);function tS(e){var t=e.event,n=(0,o._)(e,["event"]),r=tn.Observable.of(t);return(0,u.jsx)(tb,(0,i._)({data:r},n))}function tC(e){var t=e.events,n=e.eventProps,r=e.isInProgress,o=e.thoughtSeconds,s=(0,a._)((0,c.useState)(!1),2),l=s[0],d=s[1],f="Show more";f=r?l?"Show less":"Show more":l?"Hide work done":"Show work done";var p=(0,c.useCallback)(function(){d(function(e){return!e})},[]),h=o?(0,tr.humanizeDuration)(o):void 0,g=r?t.length>=3:t.length>0,m=(0,c.useMemo)(function(){var e=t.filter(function(e){return null!=e});return r?e.length<3||l?e:e.slice(-2):l?e:[]},[t,r,l]),x=m.length>0;return(0,u.jsxs)(tg.Surface,{gap:4,clsx:[t_.default.subSurface,(0,eG._)({},t_.default.expandable,g)],children:[g?(0,u.jsxs)(tg.Surface,{elevated:!0,clsx:[t_.default.expandableHeader,(0,eG._)({},t_.default.expanded,l)],tag:"button",row:!0,gap:6,px:4,align:"center",justify:"space-between",onClick:p,children:[(0,u.jsxs)(J.View,{align:"center",row:!0,gap:4,children:[l?(0,u.jsx)(tw.default,{color:eh.tokens.foregroundDimmer}):(0,u.jsx)(tk.default,{color:eh.tokens.foregroundDimmer}),(0,u.jsx)(eu.Text,{color:"dimmer",children:f})]}),h?(0,u.jsx)(eu.Text,{color:"dimmer",children:h}):null]}):null,x?(0,u.jsx)(J.View,{children:m.map(function(e){return(0,u.jsx)(tS,(0,i._)({event:e},n),e.id)})}):null]})}function tj(e){var t=e.taskText,n=e.events,r=e.eventProps,i=e.isExpanded,o=e.onClickExpandCollapse;return(0,u.jsxs)(tg.Surface,{elevated:!0,clsx:[t_.default.root,(0,eG._)({},t_.default.isExpanded,i)],children:[(0,u.jsxs)(J.View,{row:!0,justify:"space-between",align:"baseline",children:[(0,u.jsx)(eu.Text,{variant:"small",color:"dimmer",children:"Task"}),(0,u.jsx)(er.IconButton,{alt:"Maximize",onClick:o,children:i?(0,u.jsx)(ea.default,{size:12}):(0,u.jsx)(eD.default,{size:12})})]}),(0,u.jsx)(eu.Text,{children:t}),n.length>0?(0,u.jsx)(tC,{events:n,eventProps:r,isInProgress:!0}):null]})}function tT(e){var t=e.task,n=e.taskSummary,r=e.events,i=e.eventProps,o=(0,a._)((0,c.useState)(!1),2),s=o[0],l=o[1],d=(0,c.useCallback)(function(){l(function(e){return!e})},[]),f=(0,c.useCallback)(function(){l(!1)},[]);return(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)(tj,{taskText:n,events:r,eventProps:i,isExpanded:!1,onClickExpandCollapse:d}),(0,u.jsx)(ei.Modal,{maxWidth:872,isOpen:s,hideCloseButton:!0,onRequestClose:f,noPadding:!0,children:(0,u.jsx)(tj,{taskText:t,events:r,eventProps:i,isExpanded:!1,onClickExpandCollapse:d})})]})}function tE(e){var t=e.taskText,n=e.resultText,r=e.thoughtSeconds,i=e.events,o=e.eventProps,a=e.isExpanded,s=e.onClickExpandCollapse;return(0,u.jsxs)(tg.Surface,{elevated:!0,clsx:[t_.default.root,(0,eG._)({},t_.default.isExpanded,a)],children:[(0,u.jsxs)(J.View,{row:!0,justify:"space-between",align:"baseline",children:[(0,u.jsx)(eu.Text,{variant:"small",color:"dimmer",children:"Task"}),(0,u.jsx)(er.IconButton,{alt:"Maximize",onClick:s,children:a?(0,u.jsx)(ea.default,{size:12}):(0,u.jsx)(eD.default,{size:12})})]}),(0,u.jsx)(th.MessageMarkdown,{text:t}),i.length>0?(0,u.jsx)(tC,{events:i,eventProps:o,isInProgress:!1,thoughtSeconds:r}):null,n?(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)(eu.Text,{variant:"small",color:"dimmer",children:"Result"}),(0,u.jsx)(th.MessageMarkdown,{text:n})]}):null]})}function tR(e){var t=e.task,n=e.taskSummary,r=e.result,i=e.resultSummary,o=e.thoughtSeconds,s=e.events,l=e.eventProps,d=(0,a._)((0,c.useState)(!1),2),f=d[0],p=d[1],h=(0,c.useCallback)(function(){p(function(e){return!e})},[]),g=(0,c.useCallback)(function(){p(!1)},[]);return(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)(tE,{taskText:n,resultText:i,thoughtSeconds:o,events:s,eventProps:l,isExpanded:!1,onClickExpandCollapse:h}),(0,u.jsx)(ei.Modal,{maxWidth:872,isOpen:f,hideCloseButton:!0,onRequestClose:g,noPadding:!0,children:(0,u.jsx)(tE,{taskText:t,resultText:r,thoughtSeconds:o,events:s,eventProps:l,isExpanded:!0,onClickExpandCollapse:h})})]})}function tI(e){var t=e.expandByDefault,n=e.isInProgress,r=e.title,i=e.task,s=e.taskSummary,l=e.result,d=e.resultSummary,f=e.thoughtSeconds,p=e.subagent,g=(0,o._)(e,["expandByDefault","isInProgress","title","task","taskSummary","result","resultSummary","thoughtSeconds","subagent"]),m=(0,a._)((0,c.useState)(null!=t?t:!!n),2),x=m[0],y=m[1],b=(0,c.useCallback)(function(){y(function(e){return!e})},[]);(0,c.useEffect)(function(){n||t||y(!1)},[t,n]);var w=(0,c.useMemo)(function(){var e=tp({});return p.session.transform(e,500)},[p]),k=(0,h.useObservable)(w.flat);return(0,u.jsx)(ty,{expanded:x,onClick:b,title:r,children:n?(0,u.jsx)(tT,{task:i,taskSummary:s,events:null!=k?k:[],eventProps:g}):(0,u.jsx)(tR,{task:i,taskSummary:s,result:l,resultSummary:d,thoughtSeconds:f,events:null!=k?k:[],eventProps:g})})}function tA(e){var t=e.subagent,n=(0,o._)(e,["subagent"]),r=(0,g.useObservableMemo)(function(){return t.contents("generalSubagentEventContents")},[t]),a=(0,h.useObservable)(t.running,!1),s=(0,h.useObservable)(t.totalExecutionTimeSeconds,0);if(!r)return null;var l=r.task,c=r.taskSummary,d=r.result,f=r.resultSummary,p=r.taskTitle;return(0,u.jsx)(tI,(0,i._)({isInProgress:a,title:p,task:l,taskSummary:c,result:d,resultSummary:f,thoughtSeconds:a?void 0:s,subagent:t},n))}var tP={direction:"reverse",state:{latestThoughtSummary:void 0,allThoughts:void 0},reducer:function(e,t){var n,r,i;if((null==(r=e.contents)||null==(n=r.contents)?void 0:n.$kind)==="agentTimelineEventContents"&&(null==(i=e.contents.contents.agentTimelineEventContents.toolData)?void 0:i.$kind)==="thoughts"){var o,a=e.contents.contents.agentTimelineEventContents.toolData.thoughts;a.thoughts&&(t.allThoughts=[a.thoughts].concat((0,s._)(null!=(o=t.allThoughts)?o:[]))),a.summary&&!t.latestThoughtSummary&&(t.latestThoughtSummary=a.summary)}}},tD=e.i(675186),tO=e.i(112077),tN=e.i(387491),tM=e.i(869226),tL=e.i(401732),tB=(0,eh.cvarsFrom)("AutoscrollMaxHeightContainer.module.css",["--max-height","--top-gradient-visibility"]);function tV(e){var t=e.children,n=e.maxHeight,r=e.onClick,a=(0,o._)(e,["children","maxHeight","onClick"]),s=(0,c.useRef)(null),l=(0,c.useRef)(null),d=(0,c.useRef)(null),f=(0,tO.useCreateObservable)(!0);return(0,c.useEffect)(function(){var e=l.current,t=d.current;if(e&&t){var n=0,r=new tD.AnimationLoop(function(t,r){n+=t;var i=e.scrollTop,o=e.scrollHeight-e.clientHeight,a=(0,tN.damp)({current:i,target:o,elapsed:n,delta:t});a===o?(n=0,r()):(e.scrollTop=a,f.set(i<5))}),i=new ResizeObserver(function(){return r.start()});return i.observe(t),function(){r.stop(),i.disconnect()}}},[f]),(0,tM.useStyleSet)(s,f,function(e){return(0,eG._)({},tB.topGradientVisibility,e?"hidden":"visible")}),(0,u.jsxs)(J.View,{clsx:tL.default.root,innerRef:s,children:[(0,u.jsx)(tg.Surface,(0,ti._)((0,i._)({innerRef:l,style:(0,eG._)({},tB.maxHeight,(void 0===n?129.92:n)+"px"),onClick:r,clsx:tL.default.scroll,role:"button"},a),{children:(0,u.jsx)(J.View,{innerRef:d,children:t})})),(0,u.jsx)(J.View,{clsx:tL.default.topGradient})]})}var tF=e.i(65704),tU=e.i(14007),tG=e.i(279714);function t$(e){var t=e.taskText,n=e.thoughtSummary,r=e.allThoughts,i=e.isExpanded,o=e.onClickExpandCollapse;return(0,u.jsxs)(tg.Surface,{elevated:!0,clsx:[tG.default.root,(0,eG._)({},tG.default.isExpanded,i)],children:[(0,u.jsxs)(J.View,{row:!0,justify:"space-between",align:"baseline",children:[(0,u.jsx)(eu.Text,{variant:"small",color:"dimmer",children:"Task"}),(0,u.jsx)(er.IconButton,{alt:"Maximize",onClick:o,children:i?(0,u.jsx)(ea.default,{size:12}):(0,u.jsx)(eD.default,{size:12})})]}),(0,u.jsx)(eu.Text,{children:t}),(0,u.jsxs)(tg.Surface,{clsx:tG.default.subSurface,gap:8,children:[(0,u.jsxs)(J.View,{align:"center",row:!0,gap:4,children:[(0,u.jsx)(tU.default,{color:eh.tokens.foregroundDimmer}),(0,u.jsxs)(eu.Text,{color:"dimmest",children:[n||"Thinking",""]})]}),i?(0,u.jsx)(tg.Surface,{elevated:!0,px:8,gap:16,py:6,children:null==r?void 0:r.map(function(e,t){return(0,u.jsx)(th.MessageMarkdown,{textColor:"dimmest",text:e},t)})}):(0,u.jsx)(tV,{maxHeight:129.92,elevated:!0,px:8,onClick:o,children:(0,u.jsx)(J.View,{gap:16,py:6,children:null==r?void 0:r.map(function(e,t){return(0,u.jsx)(th.MessageMarkdown,{textColor:"dimmest",text:e},t)})})})]})]})}function tz(e){var t=e.taskText,n=e.resultText,r=e.thoughtSeconds,i=e.thoughtSummary,o=e.isExpanded,a=e.onClickExpandCollapse,s=null;return void 0!==r?s=(0,u.jsxs)(J.View,{align:"center",row:!0,gap:4,children:[(0,u.jsx)(tU.default,{color:eh.tokens.foregroundDimmer}),(0,u.jsxs)(eu.Text,{color:"dimmer",children:["Thought for ",(0,tr.humanizeDuration)(r)]})]}):i&&(s=(0,u.jsxs)(J.View,{align:"center",row:!0,gap:4,children:[(0,u.jsx)(tU.default,{color:eh.tokens.foregroundDimmer}),(0,u.jsx)(e8.Summary,{summary:i,color:"dimmer"})]})),(0,u.jsxs)(tg.Surface,{elevated:!0,clsx:[tG.default.root,(0,eG._)({},tG.default.isExpanded,o)],children:[(0,u.jsxs)(J.View,{row:!0,justify:"space-between",align:"baseline",children:[(0,u.jsx)(eu.Text,{variant:"small",color:"dimmer",children:"Task"}),(0,u.jsx)(er.IconButton,{alt:"Maximize",onClick:a,children:o?(0,u.jsx)(ea.default,{size:12}):(0,u.jsx)(eD.default,{size:12})})]}),(0,u.jsx)(th.MessageMarkdown,{text:t}),s?(0,u.jsx)(tg.Surface,{elevated:!0,clsx:tG.default.subSurface,px:8,children:s}):null,n?(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)(eu.Text,{variant:"small",color:"dimmer",children:"Result"}),(0,u.jsx)(th.MessageMarkdown,{text:n})]}):null]})}function tH(e){var t=e.task,n=e.taskSummary,r=e.thoughtSummary,i=e.allThoughts,o=(0,a._)((0,c.useState)(!1),2),s=o[0],l=o[1],d=(0,c.useCallback)(function(){l(function(e){return!e})},[]),f=(0,c.useCallback)(function(){l(!1)},[]);return(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)(t$,{taskText:n,thoughtSummary:r,allThoughts:i,isExpanded:!1,onClickExpandCollapse:d}),(0,u.jsx)(ei.Modal,{maxWidth:872,isOpen:s,hideCloseButton:!0,onRequestClose:f,noPadding:!0,children:(0,u.jsx)(t$,{taskText:t,thoughtSummary:r,allThoughts:i,isExpanded:!0,onClickExpandCollapse:d})})]})}function tW(e){var t=e.task,n=e.taskSummary,r=e.result,i=e.resultSummary,o=e.thoughtSeconds,s=e.thoughtSummary,l=(0,a._)((0,c.useState)(!1),2),d=l[0],f=l[1],p=(0,c.useCallback)(function(){f(function(e){return!e})},[]),h=(0,c.useCallback)(function(){f(!1)},[]);return(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)(tz,{taskText:n,resultText:i,thoughtSeconds:o,thoughtSummary:s,isExpanded:!1,onClickExpandCollapse:p}),(0,u.jsx)(ei.Modal,{maxWidth:872,isOpen:d,hideCloseButton:!0,onRequestClose:h,noPadding:!0,children:(0,u.jsx)(tz,{taskText:t,resultText:r,thoughtSeconds:o,thoughtSummary:s,isExpanded:!0,onClickExpandCollapse:p})})]})}function tq(e){var t=e.isInProgress,n=e.title,r=e.task,i=e.taskSummary,o=e.result,s=e.resultSummary,l=e.thoughtSeconds,d=e.thoughtSummary,f=e.allThoughts,p=e.expandByDefault,h=(0,a._)((0,c.useState)(null!=p?p:!!t),2),g=h[0],m=h[1],x=(0,c.useCallback)(function(){m(function(e){return!e})},[]);return(0,c.useEffect)(function(){t||p||m(!1)},[p,t]),(0,u.jsx)(ty,{expanded:g,onClick:x,title:n,icon:(0,u.jsx)(tF.default,{color:eh.tokens.foregroundDimmer}),children:t?(0,u.jsx)(tH,{task:r,taskSummary:i,thoughtSummary:d,allThoughts:f}):(0,u.jsx)(tW,{task:r,taskSummary:i,result:o,resultSummary:s,thoughtSeconds:l,thoughtSummary:d})})}function tK(e){var t=e.subagent,n=(0,g.useObservableMemo)(function(){return t.contents("generalSubagentEventContents")},[t]),r=(0,h.useObservable)(t.running,!1),i=(0,h.useObservable)(t.totalExecutionTimeSeconds,0),o=(0,g.useObservableMemo)(function(){return t.session.reduce(tP,"global")},[t],{default:{latestThoughtSummary:void 0,allThoughts:void 0}}),a=o.latestThoughtSummary,s=o.allThoughts;if(!n)return null;var l=n.task,c=n.taskSummary,d=n.result,f=n.resultSummary,p=n.taskTitle;return(0,u.jsx)(tq,{isInProgress:r,title:p,task:l,taskSummary:c,result:d,resultSummary:f,thoughtSeconds:r?void 0:i,thoughtSummary:a,allThoughts:s})}var tY=(0,c.memo)(function(e){var t=e.data,n=(0,o._)(e,["data"]),r=(0,f.useChatter)(),a=(0,g.useObservableMemo)(function(){return r.sessions.get(t.parentId).select(function(e){return null==e?void 0:e.subagent(t.id,t.eventId,t.sessionId,t.created)})},[r,t]),s=(0,h.useObservable)(null==a?void 0:a.kind),l=(0,g.useObservableMemo)(function(){return null==a?void 0:a.contents("generalSubagentEventContents")},[a]);if(!a||!s)return null;switch(s){case"uiTestingSubagentEventContents":return(0,u.jsx)(tt,{subagent:a});case"generalSubagentEventContents":if((null==l?void 0:l.eventFilter)===O.GeneralSubagentEventFilter.GENERAL_SUBAGENT_EVENT_FILTER_ALL_EVENTS)return(0,u.jsx)(tA,(0,i._)({subagent:a},n));return(0,u.jsx)(tK,{subagent:a})}}),tQ=(0,c.memo)(function(e){var t=e.data,n=(0,o._)(e,["data"]);return(0,u.jsx)(D.EventRenderer,(0,i._)({data:t,subagentRenderer:tY},n))}),tX=e.i(626926);function tJ(e){return(0,u.jsx)(eg.Button,{className:tX.default.expandButton,variant:"nofill",alignment:"start",onClick:e.onClick,iconLeft:e.isExpanded?(0,u.jsx)(tw.default,{}):(0,u.jsx)(tk.default,{}),text:e.isExpanded?"Show less":"Show ".concat(e.hiddenItemsCount," more")})}var tZ=function(e){var t=[],n=!e.some(function(e){return"planProposal"===e.value.type}),r=null,o=null,a=null,l=-1,u=!0,c=!1,d=void 0;try{for(var f,p=e[Symbol.iterator]();!(u=(f=p.next()).done);u=!0){var h=f.value;if("planProposal"!==h.value.type||n||(n=h.value.approved),"agentToolUse"===h.value.type&&(null!=a||(a=[]),a.push(h)),"userMessage"===h.value.type&&r&&(o&&(t3(r,o,a),a=null,o=null),t.push.apply(t,(0,s._)(r)),r=null),!r){if(r=[],!n||t0(h.value)){"userMessage"===h.value.type&&(l=t.length),r.push({type:"event",id:h.id,observable:h.observable});continue}o=t1(h.id);var g={id:h.id,observable:h.observable};o.items.push("agentToolUse"===h.value.type?{type:"toolUseGroup",events:[g]}:(0,i._)({type:"event"},g)),t2(o,h.value);continue}if(!n||t0(h.value)){o&&(t3(r,o,a),a=null,o=null),r.push({type:"event",id:h.id,observable:h.observable});continue}o||(o=t1(h.id));var m={id:h.id,observable:h.observable};if("agentToolUse"===h.value.type){var x=o.items[o.items.length-1];(null==x?void 0:x.type)==="toolUseGroup"?x.events.push(m):o.items.push({type:"toolUseGroup",events:[m]}),t2(o,h.value);continue}t2(o,h.value),o.items.push((0,i._)({type:"event"},m))}}catch(e){c=!0,d=e}finally{try{u||null==p.return||p.return()}finally{if(c)throw d}}return r&&(o&&(t3(r,o,a),a=null,o=null),t.push.apply(t,(0,s._)(r))),{result:t,lastUserMessageIndex:l}};function t0(e){switch(e.type){case"userMessage":case"checkpoint":case"planProposal":case"suggestDeploy":case"tipRecommendation":case"taskListApproval":case"initialBuildPhaseApproval":case"queryRequest":return!0;default:return!1}}function t1(e){return{type:"activityGroup",id:e,items:[],count:{message:0,toolUse:0}}}function t2(e,t){var n=e.count;switch(t.type){case"agentMessage":n.message++,e.summary||(e.summary=t.message);break;case"agentToolUse":n.toolUse++}}function t3(e,t,n){var r,i=(r=t.items).some(function(e){return"toolUseGroup"===e.type})?null:r;i?e.push.apply(e,(0,s._)(i)):(null==n?void 0:n.length)===1&&1===t.items.length?e.push.apply(e,(0,s._)(n.map(function(e){return{type:"event",id:e.id,observable:e.observable}}))):(!t.summary&&n&&(t.summary=function(e){var t=[],n=new Map,r=new Map,i=!0,o=!1,s=void 0;try{for(var l,u=e[Symbol.iterator]();!(i=(l=u.next()).done);i=!0){var c=l.value;if("agentToolUse"===c.type)if(c.toolDataKind){var d=n.get(c.toolDataKind);d?d.push(c):n.set(c.toolDataKind,[c])}else{var f=r.get(c.toolName);f?f.push(c):r.set(c.toolName,[c])}}}catch(e){o=!0,s=e}finally{try{i||null==u.return||u.return()}finally{if(o)throw s}}var p=!0,h=!1,g=void 0;try{for(var m,x=n.entries()[Symbol.iterator]();!(p=(m=x.next()).done);p=!0){var y=(0,a._)(m.value,2),w=y[0],k=y[1];switch(w){case"createFileData":t.push("created ".concat((0,b.default)("file",k.length,!0)));break;case"fileEditData":t.push("edited ".concat((0,b.default)("file",k.length,!0)));break;case"packagerInstallData":var _=0,S=!0,C=!1,j=void 0;try{for(var T,E=k[Symbol.iterator]();!(S=(T=E.next()).done);S=!0){var R=T.value.data;(null==R?void 0:R.$kind)==="packagerInstallData"&&(_+=R.installed.length)}}catch(e){C=!0,j=e}finally{try{S||null==E.return||E.return()}finally{if(C)throw j}}t.push("installed ".concat((0,b.default)("package",_,!0)));break;case"createPostgresqlDatabaseData":t.push("created a database");break;case"setupObjectStorageData":t.push("set up Object Storage");break;case"setupModelfarmData":t.push("set up Replit AI Integrations");break;case"screenshotData":t.push("took ".concat((0,b.default)("screenshot",k.length,!0)))}}}catch(e){h=!0,g=e}finally{try{p||null==x.return||x.return()}finally{if(h)throw g}}var I=!0,A=!1,P=void 0;try{for(var D,O=r.entries()[Symbol.iterator]();!(I=(D=O.next()).done);I=!0){var N=(0,a._)(D.value,2),M=N[0],L=N[1];"programming_language_install_tool"===M&&t.push("configured ".concat((0,b.default)("programming environment",L.length,!0)))}}catch(e){A=!0,P=e}finally{try{I||null==O.return||O.return()}finally{if(A)throw P}}return t.length?t.join(", "):void 0}(n.map(function(e){return e.value}))),e.push(t))}var t4=e.i(596139),t8=e.i(973519),t5=e.i(115820),t6=e.i(374358),t9=e.i(1074),t7=e.i(690767),ne=e.i(85742),nt=e.i(559482),nn=e.i(585124),nr=e.i(590829);function ni(e){var t=e.granularity,n=e.onSetGranularity;return(0,u.jsxs)(ne.ListBox,{"aria-label":"Feed view granularity",selectionMode:"single",selectedKeys:new Set([t]),onSelectionChange:function(e){var t=(0,a._)(Array.from(e),1)[0];t&&n(t)},clsx:nr.default.listbox,children:[(0,u.jsx)(ne.ListBoxItem,{id:p.RunGranularity.Tasks,label:"Tasks",showLabelAsTooltip:!0,icon:(0,u.jsx)(nt.default,{}),clsx:nr.default.item}),(0,u.jsx)(ne.ListBoxItem,{id:p.RunGranularity.Log,label:"Work log",icon:(0,u.jsx)(nn.default,{}),showLabelAsTooltip:!0,clsx:nr.default.item})]})}var no=e.i(601059),na=e.i(753007),ns=e.i(993134),nl=e.i(718610),nu=e.i(196353),nc=e.i(486672),nd=e.i(245150),nf=e.i(854976),np=(0,c.memo)(function(e){var t,n,r,a,s=e.group,l=e.onSessionChange,c=e.openPane,d=e.granularity,f=e.onSetGranularity,g=(0,o._)(e,["group","onSessionChange","openPane","granularity","onSetGranularity"]),m=(0,h.useObservable)(null!=(t=s.checkpoint)?t:null),x=(0,h.useObservable)(null!=(n=s.latestTaskList)?n:null),y=(0,h.useObservable)(null!=(r=s.endOfRunSummary)?r:null),b=null!=(a=null==x?void 0:x.tasks)?a:[];return(0,u.jsx)(tg.Surface,{elevated:!0,clsx:nf.default.card,children:(0,u.jsxs)(J.View,{gap:4,p:4,children:[(0,u.jsx)(nh,{checkpoint:m,granularity:d,onSetGranularity:f}),d===p.RunGranularity.Log?s.items.length>0?(0,u.jsx)(tg.Surface,{clsx:nf.default.activitySurface,children:(0,u.jsx)(nv,(0,i._)({items:s.items,onSessionChange:l,openPane:c},g))}):null:b.length>0?(0,u.jsx)(tg.Surface,{clsx:nf.default.activitySurface,py:4,children:(0,u.jsx)(t7.TaskListItems,{tasks:b,approvalStatus:"approved",areTaskDetailsExpandable:!1})}):null,(0,u.jsx)(ng,{checkpoint:m,endOfRunSummary:y,onOpenCommit:function(e){return c({type:"git",data:{mode:{type:I.GitPaneModeType.COMMIT,hash:e}}})},onSessionChange:l})]})})});function nh(e){var t=e.checkpoint,n=e.granularity,r=e.onSetGranularity,i=t&&""===t.commitId&&t.state!==O.EventState.IN_PROGRESS;return(0,u.jsxs)(J.View,{row:!0,align:"center",justify:"space-between",children:[t?(0,u.jsxs)(J.View,{row:!0,align:"center",gap:8,pl:4,grow:!0,children:[(0,u.jsx)(J.View,{justify:"center",align:"center",shrink:0,children:i?(0,u.jsx)(eP.default,{color:eh.tokens.accentNegativeStronger}):(0,u.jsx)(na.default,{color:eh.tokens.foregroundDimmest})}),(0,u.jsx)(eu.Text,{color:"dimmer",children:t.title})]}):(0,u.jsx)(J.View,{grow:!0}),n&&r?(0,u.jsx)(ni,{granularity:n,onSetGranularity:r}):null]})}function ng(e){var t=e.checkpoint,n=e.endOfRunSummary,r=e.onOpenCommit,i=e.onSessionChange;return(0,u.jsxs)(J.View,{row:!0,justify:"space-between",align:"center",children:[(0,u.jsx)(J.View,{row:!0,align:"center",gap:8,pl:4,children:n?(0,u.jsx)(t6.WorkMetricsSummary,{workDurationSeconds:n.workDurationSeconds,usageCents:n.usageCents}):(null==t?void 0:t.workDurationSeconds)?(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)(ns.default,{color:eh.tokens.foregroundDimmest,size:16}),(0,u.jsxs)(eu.Text,{variant:"small",color:"dimmer",children:["Worked for ",function(e){if(null==e)return"";var t=Math.floor(e/60),n=e%60;return 0===t?"".concat(n,"s"):0===n?"".concat(t,"m"):"".concat(t,"m ").concat(n,"s")}(null==t?void 0:t.workDurationSeconds)]})]}):null}),t?(0,u.jsx)(nm,{checkpoint:t,onOpenCommit:r,onSessionChange:i}):null]})}function nm(e){var t=e.checkpoint,n=e.onOpenCommit,r=e.onSessionChange,i=(0,t8.useGlobalModal)().show,o=(0,a._)((0,c.useState)(!1),2),s=o[0],l=o[1],d=(0,E.default)({checkpoint:t,onSessionChange:r}).onRevert,f=(0,t5.useAgentCheckpointPreview)({commitId:t.commitId,date:t.created}),p=f.loadPreview,h=f.loading,g=f.error,m=f.previewUrl,x=f.validPreview,y=f.showUpgradeModal,b=f.setShowUpgradeModal;(0,c.useEffect)(function(){y&&i("MembershipPurchaseModal",{headingText:"Upgrade to preview past checkpoints",subHeadingText:"Upgrade to Replit ".concat(t4.corePlanName," to preview past checkpoints"),analyticsContext:{upgrade:{context:"checkpoint_preview"}},onPurchaseComplete:function(){p()}}).then(function(){b(!1)})},[y,i,p,b]);var w=(0,c.useCallback)(function(){l(!0)},[]),k=(0,c.useCallback)(function(){n(t.commitId)},[t.commitId,n]),_=null!==m,S=""===t.commitId&&t.state!==O.EventState.IN_PROGRESS,C="Preview",T=(0,u.jsx)(nc.default,{});h?(C="Loading",T=(0,u.jsx)(eo.default,{})):_?(C="View preview",T=(0,u.jsx)(eb.default,{})):x?g&&(C="Failed to load",T=(0,u.jsx)(e_.default,{})):(C="Preview expired",T=(0,u.jsx)(eP.default,{}));var R=(0,c.useCallback)(function(){x&&(_?window.open(m,"_blank","noopener"):p())},[_,m,x,p]);return(0,u.jsxs)(u.Fragment,{children:[(0,u.jsxs)(no.PopupMenu,{label:"Checkpoint actions",trigger:(0,u.jsx)(er.IconButton,{alt:"Checkpoint actions",children:(0,u.jsx)(nu.default,{})}),children:[(0,u.jsx)(no.MenuItem,{onAction:w,label:"Rollback",icon:(0,u.jsx)(nd.default,{})}),(0,u.jsx)(no.MenuItem,{onAction:k,label:"Changes",icon:(0,u.jsx)(nl.default,{})}),(0,u.jsx)(no.MenuItem,{onAction:R,isDisabled:S||!x,label:C,icon:T})]}),s?(0,u.jsx)(ei.Modal,{isOpen:s,onRequestClose:function(){return l(!1)},centered:!0,children:(0,u.jsx)(t9.ConfirmRollbackModal,{author:(0,j.commitAuthorToCheckpointAuthor)(t.author),setShowConfirmModal:l,deploymentBuildId:void 0,onRevert:d,commitId:t.commitId,screenshot:t.screenshotUrl,date:t.created})}):null]})}function nv(e){var t=e.items,n=e.onSessionChange,r=e.openPane,a=(0,o._)(e,["items","onSessionChange","openPane"]);return(0,u.jsx)(J.View,{p:2,children:t.map(function(e){return(0,u.jsx)(tQ,(0,i._)({data:e.observable,onSessionChange:n,openPane:r},a),e.id)})})}var nx=e.i(907371),ny=e.i(831498),nb=(0,c.memo)(function(e){var t,n,r=e.group,i=e.openPane,o=e.onSessionChange,a=e.onSetGranularity,s=e.isInteractive,l=void 0!==s&&s,c=(0,h.useObservable)(null!=(t=r.checkpoint)?t:null),d=(0,h.useObservable)(null!=(n=r.endOfRunSummary)?n:null),f=(0,nx.useCreateInteractive)({variant:"filled"});return(0,u.jsx)(tg.Surface,{elevated:!0,clsx:[l?f.clsx:void 0,ny.default.card],style:l?f.style:void 0,onClick:l?function(){null==a||a(p.RunGranularity.Tasks)}:void 0,children:(0,u.jsxs)(J.View,{gap:4,p:4,children:[(0,u.jsx)(nh,{checkpoint:c}),(0,u.jsx)(ng,{checkpoint:c,endOfRunSummary:d,onOpenCommit:function(e){return i({type:"git",data:{mode:{type:I.GitPaneModeType.COMMIT,hash:e}}})},onSessionChange:o})]})})}),nw=e.i(731532),nk=e.i(26857),n_=e.i(901708),nS=e.i(608263),nC=e.i(382222),nj=(0,c.memo)(function(e){var t=e.sessionEntry,n=e.onFeedStateChange,r=e.transformer,a=e.feedMapperFn,s=e.shouldAutoScrollRef,l=(0,o._)(e,["sessionEntry","onFeedStateChange","transformer","feedMapperFn","shouldAutoScrollRef"]),d=(0,f.useChatter)(),p=(0,g.useObservableMemo)(function(){return d.sessions.get(t.sessionId)},[d,t.sessionId]),h=(0,c.useMemo)(function(){if(p)return t.tipEventId?p.from(t.tipEventId):p},[p,t.tipEventId]);return h?(0,u.jsx)(nR,(0,i._)({scopedSession:h,sessionEntry:t,onFeedStateChange:n,transformer:r,feedMapperFn:a,shouldAutoScrollRef:s},l)):(0,u.jsx)(S.LoadingState,{})}),nT=(0,c.memo)(function(e){var t,n,r,o=e.runGroup,a=e.granularity,s=e.handleSetGranularity,l=e.itemProps,c=(0,h.useObservable)(null!=(t=o.latestTaskList)?t:null),d=null!=(n=null==c?void 0:c.tasks)?n:[],f=null!=(r=o.items)?r:[],p=d.length>0||f.length>0;return o.supportsViewGranularity?(0,u.jsx)(np,(0,i._)({group:o},p?{granularity:a,onSetGranularity:s}:{},l)):(0,u.jsxs)(J.View,{children:[(0,u.jsx)(nv,(0,i._)({items:f},l)),o.endOfRunSummary?(0,u.jsx)(tQ,(0,i._)({data:o.endOfRunSummary},l)):null]})}),nE=(0,c.memo)(function(e){var t=e.runGroup,n=e.runId,r=e.isLatestRunGroup,i=e.granularity,o=e.setRunGranularity,a=e.itemProps,s=e.shouldAutoScrollRef,l=(0,c.useDeferredValue)(i),d=(0,c.useCallback)(function(e){s.current=!1,o(n,e)},[n,o,s]);return l!==p.RunGranularity.Minimized||r?(0,u.jsx)(nT,{runGroup:t,granularity:l,handleSetGranularity:d,itemProps:a}):(0,u.jsx)(nb,{group:t,openPane:a.openPane,onSessionChange:a.onSessionChange,isInteractive:!0,onSetGranularity:d})}),nR=(0,c.memo)(function(e){var t,n,r,a,s,l,d,f=e.scopedSession,x=e.sessionEntry,y=e.onFeedStateChange,b=e.transformer,w=e.feedMapperFn,k=e.shouldAutoScrollRef,_=(0,o._)(e,["scopedSession","sessionEntry","onFeedStateChange","transformer","feedMapperFn","shouldAutoScrollRef"]),C=(t=f,n=b,r=w,a=(0,m.useFlag)({controlName:"flag-agent-feed-per-page",type:"number",default:200}),s=(0,m.useFlag)({controlName:"flag-render-tool-calls-without-data"}),l=(0,c.useMemo)(function(){var e=tp({shouldRenderToolCallsWithoutData:s}),r=null!=n?n:e;return t.transform(r,Math.min(a,1e3))},[t,a,n,s]),d=null!=r?r:tZ,{feed:(0,g.useObservableMemo)(function(){return l.map(d)},[l,d]),isFullyLoaded:(0,h.useObservable)(l.exhaustive),loadMore:(0,c.useCallback)(function(){return l.size.set(l.size.current+100)},[l])}),j=C.feed,T=C.isFullyLoaded,E=C.loadMore,R=(0,p.useSetRunGranularity)(),I=(0,p.useGetRunGroupGranularity)();(0,c.useEffect)(function(){y(x.sessionId,{isFullyLoaded:T,loadMore:E,hasAnyItemsToRender:(null==j?void 0:j.result)!=null&&j.result.length>0})},[x.sessionId,T,E,y,j]);var A=(0,c.useMemo)(function(){if(j&&j.result){var e=j.result.filter(function(e){return"runGroup"===e.type});if(0!==e.length)return e[e.length-1].id}},[j]);return j?(0,u.jsx)(u.Fragment,{children:j.result.map(function(e,t){if("preRunGroup"===e.type)return(0,u.jsx)(nb,{group:e,openPane:_.openPane,onSessionChange:_.onSessionChange},"".concat(x.sessionId,"-").concat(e.id));if("runGroup"===e.type){var n,r=e.id,o=r===A;return n=e.supportsViewGranularity?I(r):p.RunGranularity.Log,(0,u.jsx)(nE,{runGroup:e,runId:r,isLatestRunGroup:o,granularity:n,setRunGranularity:R,itemProps:_,shouldAutoScrollRef:k},"".concat(x.sessionId,"-").concat(e.id))}return"activityGroup"===e.type?(0,u.jsx)(nD,(0,i._)({activityGroup:e,isInLastGroup:t>=j.lastUserMessageIndex},_),"".concat(x.sessionId,"-").concat(e.id)):(0,u.jsx)(tQ,(0,i._)({data:e.observable},_),"".concat(x.sessionId,"-").concat(e.id))})}):(0,u.jsx)(S.LoadingState,{})}),nI=(0,c.memo)(function(e){var t=e.entry,n=e.index,r=e.visibleSessions,a=e.checkpointsValue,s=e.expandedSeparators,l=e.onToggleSeparator,d=e.revertToCommit,f=e.renameCommit,p=e.openCommit,h=e.onFeedStateChange,g=e.shouldAutoScrollRef,m=e.transformer,x=e.feedMapperFn,y=(0,o._)(e,["entry","index","visibleSessions","checkpointsValue","expandedSeparators","onToggleSeparator","revertToCommit","renameCommit","openCommit","onFeedStateChange","shouldAutoScrollRef","transformer","feedMapperFn"]),b=n>0?r[n-1]:null,w=(0,c.useMemo)(function(){return b&&(null==a?void 0:a.ok)?function(e,t,n){if(!t||!n)return[];var r=n.find(function(t){var n;return(null==(n=t.session)?void 0:n.id)===e});if(!r)return[];var i=r.commitRanges.flatMap(function(e){return e.commitRange}),o=i.findIndex(function(e){return e.eventId===t});return -1===o?[]:i.slice(o+1)}(b.sessionId,b.tipEventId,a.value):[]},[b,a]),k="".concat(null==b?void 0:b.sessionId,"-").concat(t.sessionId),_=s.has(k),S=n>0&&w.length>0;return(0,u.jsxs)(u.Fragment,{children:[n>0?(0,u.jsx)(J.View,{clsx:nC.default.sessionSeparator}):null,S?(0,u.jsxs)(J.View,{children:[(0,u.jsx)(T.CollapsedCheckpointsToggle,{count:w.length,collapsed:!_,onToggle:function(){l(k)},className:nC.default.sessionStitchingToggle}),_?(0,u.jsx)(J.View,{pl:8,py:8,gap:12,children:w.map(function(e){var t;return(0,u.jsx)(C.CheckpointCard,{author:e.authoredBy,variant:C.CheckpointCardVariant.SessionList,title:null!=(t=e.customSubject)?t:e.subject,date:new Date(e.committer.date),commitId:e.hash,onRevert:function(t){var n;return d({commitId:e.hash,title:null!=(n=e.customSubject)?n:e.subject,eventId:e.eventId,sessionId:e.sessionId,args:t})},onRenameTitle:f?function(t){return f(e.hash,t||e.subject)}:void 0,screenshot:e.screenshotUrl,onOpenCommit:function(){return p(e.hash)},isReverted:!0},e.hash)})}):null]}):null,(0,u.jsx)(nj,(0,i._)({sessionEntry:t,onFeedStateChange:h,shouldAutoScrollRef:g,transformer:m,feedMapperFn:x},y))]})}),nA=(0,c.memo)(function(e){var t,n,p,g,b,S,C,T,O,N,M,L=e.session,B=e.shouldAutoScrollRef,V=e.scrollerTopPadding,F=e.scrollerBottomPadding,U=e.transformer,G=e.feedMapperFn,$=(0,o._)(e,["session","shouldAutoScrollRef","scrollerTopPadding","scrollerBottomPadding","transformer","feedMapperFn"]),z=(0,A.useAgentState)().agentState,H=(0,y.useIsInMobileWorkspace)(),W=(0,f.useChatter)(),q=(0,h.useObservable)(W.sessions.agent.current),K=(0,j.useCheckpoints)(),Y=K.checkpoints,Q=K.renameCommit,X=(0,h.useObservable)(Y),Z=(0,a._)((0,c.useState)(new Set),2),ee=Z[0],et=Z[1],en=(0,c.useCallback)(function(e){et(function(t){var n=new Set(t);return n.has(e)?n.delete(e):n.add(e),n})},[]),er=(0,nk.useSendAskUserForActionResponse)(L),ei=(0,_.useIsInitialAgentSession)(L.id),eo=(0,R.useWorkspaceLoadingState)(),ea=(n=(t=(0,a._)((0,c.useState)([]),2))[0],p=t[1],b=(g=(0,a._)((0,c.useState)(!1),2))[0],S=g[1],C=(0,x.default)(n),T=(0,m.useFlag)({controlName:"flag-session-pedigree"}),O=(0,c.useRef)(!1),N=(0,c.useCallback)(function(){return(0,r._)(function(){var e,t,n,r,i,o;return(0,l._)(this,function(a){switch(a.label){case 0:if(!T||!(e=C.current[0])||O.current)return[2];O.current=!0,t=L.api.getSessionObservableById(e.sessionId),a.label=1;case 1:return a.trys.push([1,4,,5]),[4,t.once()];case 2:return[4,a.sent().data.once()];case 3:return n=a.sent(),[3,5];case 4:return a.sent(),O.current=!1,[2];case 5:if(!n.revertedToSessionId)return S(!1),O.current=!1,[2];r={sessionId:n.revertedToSessionId,tipEventId:n.revertedToEventId},p(function(e){return[r].concat((0,s._)(e))}),i=L.api.getSessionObservableById(n.revertedToSessionId),a.label=6;case 6:return a.trys.push([6,9,,10]),[4,i.once()];case 7:return[4,a.sent().data.once()];case 8:return o=a.sent(),[3,10];case 9:return a.sent(),O.current=!1,[2];case 10:return S(!!o.revertedToSessionId),O.current=!1,[2]}})})()},[C,L.api,T]),(0,c.useEffect)(function(){var e=!1;return(p([]),S(!1),T)?((0,r._)(function(){var t,n,r,i,o;return(0,l._)(this,function(a){switch(a.label){case 0:return a.trys.push([0,2,,3]),[4,L.data.once()];case 1:return t=a.sent(),[3,3];case 2:return a.sent(),[2];case 3:if(e)return[2];if(!t.revertedToSessionId)return p([{sessionId:L.id}]),[2];n={sessionId:t.revertedToSessionId,tipEventId:t.revertedToEventId},r=L.api.getSessionObservableById(t.revertedToSessionId),a.label=4;case 4:return a.trys.push([4,6,,7]),[4,r.once()];case 5:return i=a.sent(),[3,7];case 6:case 9:return a.sent(),[2];case 7:return a.trys.push([7,9,,10]),[4,i.data.once()];case 8:return o=a.sent(),[3,10];case 10:if(e)return[2];return p([n,{sessionId:L.id}]),S(!!o.revertedToSessionId),[2]}})})(),function(){e=!0}):void p([{sessionId:L.id}])},[L,T]),{ancestry:n,hasMore:b,loadMore:N}),es=ea.ancestry,el=ea.hasMore,eu=ea.loadMore,ec=(0,c.useRef)(new Map),ed=(0,c.useCallback)(function(e,t){ec.current.set(e,t),ei&&t.hasAnyItemsToRender&&(null==eo||eo.remove())},[ei,eo]),ef=(0,c.useRef)(null),ep=(0,d.useCurrentUserTipsQuery)({fetchPolicy:"cache-first",ssr:!1}).data,eh=(0,c.useMemo)(function(){var e,t,n,r=(null==ep||null==(t=ep.currentUser)||null==(e=t.tips)?void 0:e.tips)||[],i=new Map(r.map(function(e){return[e.id,e]})),o=r.filter(function(e){return e.timeRecommended}),a=(0,s._)(o).sort(function(e,t){var n=e.timeRecommended?new Date(e.timeRecommended).getTime():0;return(t.timeRecommended?new Date(t.timeRecommended).getTime():0)-n}),l=(null==(n=a[0])?void 0:n.id)||null;return{recommendedTips:new Set(a.map(function(e){return e.id})),latestTipId:l,allTipsById:i,anyLatestFiveInteracted:a.slice(0,5).some(function(e){return e.timeCompleted||e.timeInteracted||e.timeDismissed}),hasInteractedBefore:a.some(function(e){return e.timeInteracted})}},[ep]),em=(0,y.useIsInBonsaiWebview)(),ev=(0,c.useMemo)(function(){if(!em)return null;var e,t,n=((null==ep||null==(t=ep.currentUser)||null==(e=t.tips)?void 0:e.tips)||[]).find(function(e){return"bonsai_tour"===e.ctaTrigger});return n?{tip:n,isInBonsaiWebview:em}:null},[em,ep]),ex=(0,c.useRef)(new Map),ey=(0,i._)({sendAskUserForActionResponse:er,isInitialSession:ei,agentState:z,tipData:eh,bonsaiTourTipInfo:ev},$),eb=null==(M=es[0])?void 0:M.sessionId,ew=eb?ec.current.get(eb):void 0,ek=(null==ew?void 0:ew.isFullyLoaded)===!1||el,e_=(0,c.useCallback)(function(){(null==ew?void 0:ew.isFullyLoaded)===!1?ew.loadMore():el&&eu()},[ew,el,eu]),eS=(0,c.useCallback)(function(e){return $.openPane({type:"git",data:{mode:{type:I.GitPaneModeType.COMMIT,hash:e}}})},[$]),eC=(0,c.useCallback)(function(e){var t=e.commitId,n=e.title,o=e.eventId,a=e.sessionId,s=e.args;return(0,r._)(function(){return(0,l._)(this,function(e){switch(e.label){case 0:if(!q)return[2];return[4,(0,E.revert)((0,i._)({chatter:W,commitId:t,title:n,onSessionChange:$.onSessionChange,currentSession:q,revertedToEventId:o,revertedToSessionId:a},s))];case 1:return e.sent(),[2]}})})()},[W,$.onSessionChange,q]),ej=(0,k.useShouldShowFloatingStatusRow)(L),eT=!$.isReadOnly&&ej;return(0,u.jsx)(J.View,{clsx:nC.default.feed,grow:1,shrink:1,align:"center",children:(0,u.jsxs)(n_.AutoScroller,{pt:P.FEED_PADDING_TOP+V,pb:F+P.FEED_PADDING_BOTTOM+8,px:H?P.FEED_PADDING_INLINE_MOBILE:P.FEED_PADDING_INLINE_DESKTOP,scrollCacheKey:L.id,scrollCache:ex.current,shouldAutoScrollRef:B,autoScrollBehavior:"smooth",buttonOffset:F+8,scrollerRef:ef,children:[ek?(0,u.jsx)(eg.Button,{variant:"outlined",iconLeft:(0,u.jsx)(nS.default,{}),text:"Show previous events",onClick:e_}):null,es.map(function(e,t){return(0,u.jsx)(nI,(0,i._)({entry:e,index:t,visibleSessions:es,checkpointsValue:X,expandedSeparators:ee,onToggleSeparator:en,revertToCommit:eC,renameCommit:Q,openCommit:eS,onFeedStateChange:ed,shouldAutoScrollRef:B,transformer:U,feedMapperFn:G},ey),e.sessionId)}),eT?(0,u.jsx)(D.EventContainer,{py:2,children:(0,u.jsx)(w.FeedStatusRow,{session:L})}):null]})})});function nP(e){var t,n=e.expanded,r=e.onClick,i=e.activityGroup,o=e.innerRef,a=e.children;return(0,u.jsx)(J.View,{innerRef:o,children:(0,u.jsxs)(D.EventContainer,{clsx:nC.default.expandableGroup,children:[(0,u.jsxs)(J.View,{grow:!0,shrink:!0,tag:"button",css:e6.interactive.nofill,onClick:r,p:8,gap:4,clsx:nC.default.expandButton,children:[(0,u.jsxs)(J.View,{row:!0,grow:!0,shrink:!0,align:"center",justify:"space-between",children:[(0,u.jsx)(eu.Text,{multiline:!1,variant:"small",children:n?"Show less":(t=i.count).message>0&&t.toolUse>0?(0,b.default)("messages",t.message,!0)+" & "+(0,b.default)("actions",t.toolUse,!0):t.message>0?(0,b.default)("message",t.message,!0):t.toolUse>0?(0,b.default)("action",t.toolUse,!0):"Show activity"}),n?(0,u.jsx)(tm.default,{}):(0,u.jsx)(e9.default,{})]}),n||!i.summary?null:(0,u.jsx)(J.View,{row:!0,children:(0,u.jsx)(eu.Text,{multiline:!1,clsx:nC.default.summary,children:i.summary})})]}),n?(0,u.jsx)(J.View,{pb:8,children:a}):null]})})}var nD=(0,c.memo)(function(e){var t=e.activityGroup,n=e.isInLastGroup,r=void 0!==n&&n,s=(0,o._)(e,["activityGroup","isInLastGroup"]),l=(0,a._)((0,c.useState)(!1),2),d=l[0],f=l[1],p=(0,c.useRef)(null);if(0===t.items.length)return null;var h=r&&!s.isReadOnly||d?t.items.map(function(e){var t;return"event"===e.type?(0,u.jsx)(tQ,(0,i._)({data:e.observable},s),e.id):(0,u.jsx)(nO,(0,i._)({events:e.events},s),null==(t=e.events[0])?void 0:t.id)}):null;return(0,u.jsx)(u.Fragment,{children:r&&!s.isReadOnly?h:(0,u.jsx)(nP,{innerRef:p,activityGroup:t,expanded:d,onClick:function(){f(!d)},children:h})})}),nO=(0,c.memo)(function(e){var t=e.events,n=(0,o._)(e,["events"]),r=(0,nw.useExpandableItems)({items:t,maxVisibleItems:1}),a=r.isExpanded,s=r.setIsExpanded,l=r.maxItemsReached,c=r.visibleItems,d=r.hiddenItemsCount;return(0,u.jsxs)(u.Fragment,{children:[l?(0,u.jsx)(D.EventContainer,{py:2,children:(0,u.jsx)(tJ,{isExpanded:a,onClick:function(){return s(!a)},hiddenItemsCount:d})}):null,c.map(function(e){var t=e.id,r=e.observable;return(0,u.jsx)(tQ,(0,i._)({data:r},n),t)})]})});e.s(["Feed",()=>nA],755867);var nN=(0,e.i(541793).atom)(new Map),nM=e.i(142365),nL=e.i(887877),nB=e.i(734882),nV=e.i(916271),nF=e.i(352767),nU=e.i(369948),nG=e.i(624768);function n$(e){var t,n,r,i=e.queries,o=e.sessionId,l=e.requestEventId,d=e.onSendResponse,p=e.onCancel,h=e.isResponseInProgress,g=(0,f.useValue)(nN).get(l),m=(t=(0,f.useSet)(nN),(0,c.useCallback)(function(e,n){t(function(t){if(t.has(e))return t;var r=new Map(t),i=Array.from({length:n},function(){return{responseType:{$kind:"noResponse",noResponse:{}}}});return r.set(e,i),r})},[t])),x=(n=(0,f.useSet)(nN),(0,c.useCallback)(function(e,t,r){n(function(n){var i=new Map(n),o=i.get(e)||[],a=(0,s._)(o);return a[t]=r,i.set(e,a),i})},[n])),y=(r=(0,f.useSet)(nN),(0,c.useCallback)(function(e){r(function(t){if(!t.has(e))return t;var n=new Map(t);return n.delete(e),n})},[r])),b=i.length;(0,nM.useTrackEffect)(U.events.AGENT_USED,{action:"query_request_viewed",query_request_id:l,num_total_queries:b,session_id:o}),(0,c.useEffect)(function(){b>1&&m(l,b)},[b,l,m]);var w=(0,a._)((0,c.useState)(0),2),k=w[0],_=w[1],S=Math.min(k,b-1),C=i[S],j=S===b-1,T=0===S,E=(0,c.useCallback)(function(e){if(1===b)return void d({responses:[e]});if(x(l,S,e),S<b-1)_(S+1);else{var t=g||[],n=(0,s._)(t);n[S]=e,d({responses:n}),y(l)}},[b,S,g,d,x,y,l]),R=(0,c.useCallback)(function(){y(l),_(0),p()},[y,l,p]),I=(0,c.useCallback)(function(){_(function(e){return Math.max(0,e-1)})},[]);if(!C)return null;var A=null==g?void 0:g[S],P=null;(0,ta.isKind)(C.queryType,"booleanQuery")&&(P=(0,u.jsx)(nz,{query:C.queryType.booleanQuery,onSubmit:E,onCancel:R,onNavigateBack:I,isResponseInProgress:h,isLastQuestion:j,isFirstQuestion:T,savedResponse:A,onUpdateResponse:function(e){return x(l,S,e)}},S)),(0,ta.isKind)(C.queryType,"choiceQuery")&&(P=(0,u.jsx)(nH,{query:C.queryType.choiceQuery,onSubmit:E,onCancel:R,onNavigateBack:I,isResponseInProgress:h,isLastQuestion:j,isFirstQuestion:T,savedResponse:A,onUpdateResponse:function(e){return x(l,S,e)}},S)),(0,ta.isKind)(C.queryType,"textQuery")&&(P=(0,u.jsx)(nW,{query:C.queryType.textQuery,onSubmit:E,onCancel:R,onNavigateBack:I,isResponseInProgress:h,isLastQuestion:j,isFirstQuestion:T,savedResponse:A,onUpdateResponse:function(e){return x(l,S,e)}},S));var D=1===b?"Agent has a question for you":"Agent has questions for you";return h&&b>1?(0,u.jsxs)(tg.Surface,{clsx:nG.default.root,gap:6,elevated:!0,children:[(0,u.jsxs)(J.View,{row:!0,justify:"space-between",align:"center",children:[(0,u.jsx)(eu.Text,{children:(0,u.jsx)("strong",{children:D})}),b>1&&(0,u.jsx)(J.View,{row:!0,gap:4,align:"center",shrink:0,children:(0,u.jsxs)(eu.Text,{color:"dimmer",children:[S+1,"/",b]})})]}),(0,u.jsx)(eu.Text,{color:"dimmer",children:"Collecting your responses"}),(0,u.jsx)(nK,{onCancel:R,onNavigateBack:I,isLoading:!0,isLastQuestion:!0,isFirstQuestion:T,hasResponse:!0})]}):P?(0,u.jsxs)(tg.Surface,{clsx:nG.default.root,gap:6,elevated:!0,children:[(0,u.jsxs)(J.View,{row:!0,justify:"space-between",align:"center",children:[(0,u.jsx)(eu.Text,{children:(0,u.jsx)("strong",{children:D})}),b>1&&(0,u.jsx)(J.View,{row:!0,gap:4,align:"center",shrink:0,children:(0,u.jsxs)(eu.Text,{color:"dimmer",children:[S+1,"/",b]})})]}),P]}):null}function nz(e){var t=e.query,n=e.onSubmit,r=e.onCancel,i=e.onNavigateBack,o=e.isResponseInProgress,s=e.isLastQuestion,l=e.isFirstQuestion,d=e.savedResponse,f=e.onUpdateResponse,p=t.question,h=t.confirmText,g=t.rejectText,m=(0,c.useRef)(null),x=(0,c.useId)(),y="boolean-response-".concat(x),b="boolean-reason-".concat(x),w="",k="";d&&(0,ta.isKind)(d.responseType,"booleanResponse")&&(w=d.responseType.booleanResponse.response?"true":"false",k=d.responseType.booleanResponse.reason);var _=(0,a._)((0,c.useState)(""!==w),2),S=_[0],C=_[1],j=(0,a._)((0,c.useState)(w),2),T=j[0],E=j[1],R=(0,c.useCallback)(function(){if(!m.current)return{responseType:{$kind:"noResponse",noResponse:{}}};var e,t,n=new FormData(m.current),r=n.get(y);return"true"!==r&&"false"!==r?{responseType:{$kind:"noResponse",noResponse:{}}}:{responseType:{$kind:"booleanResponse",booleanResponse:{response:"true"===r,reason:null!=(t=null==(e=n.get(b))?void 0:e.toString())?t:""}}}},[y,b]),I=function(e){E(e);var t="true"===e||"false"===e;C(t),t?f({responseType:{$kind:"booleanResponse",booleanResponse:{response:"true"===e,reason:d&&(0,ta.isKind)(d.responseType,"booleanResponse")?d.responseType.booleanResponse.reason:""}}}):f({responseType:{$kind:"noResponse",noResponse:{}}})};return(0,u.jsx)(nL.Form,{ref:m,onSubmit:function(e){e.preventDefault(),n(R())},children:(0,u.jsxs)(J.View,{gap:6,children:[(0,u.jsx)(nV.default,{children:p}),(0,u.jsx)(nB.RadioGroup,{name:y,value:T,onChange:function(e){return I(e.target.value)},disabled:o,children:(0,u.jsxs)(J.View,{gap:6,children:[(0,u.jsxs)("label",{className:nG.default.radioOption,children:[(0,u.jsx)(J.View,{pt:2,children:(0,u.jsx)(nB.Radio,{id:"".concat(y,"-true"),name:y,value:"true"})}),(0,u.jsx)(eu.Text,{children:h||"Yes"})]}),(0,u.jsxs)("label",{className:nG.default.radioOption,children:[(0,u.jsx)(J.View,{pt:2,children:(0,u.jsx)(nB.Radio,{id:"".concat(y,"-false"),name:y,value:"false"})}),(0,u.jsx)(eu.Text,{children:g||"No"})]})]})}),(0,u.jsx)(nq,{id:b,disabled:o,defaultValue:k,onChange:function(e){("true"===T||"false"===T)&&f({responseType:{$kind:"booleanResponse",booleanResponse:{response:"true"===T,reason:e}}})}}),(0,u.jsx)(nK,{onCancel:function(){var e;r(),null==(e=m.current)||e.reset(),C(!1),E("")},onNavigateBack:i,isLoading:o,isLastQuestion:s,isFirstQuestion:l,hasResponse:S})]})})}function nH(e){var t=e.query,n=e.onSubmit,r=e.onCancel,i=e.onNavigateBack,o=e.isResponseInProgress,s=e.isLastQuestion,l=e.isFirstQuestion,d=e.savedResponse,f=e.onUpdateResponse,p=(0,c.useRef)(null),h=(0,c.useId)(),g="multiple-choice-response-".concat(h),m="multiple-choice-reason-".concat(h),x=d&&(0,ta.isKind)(d.responseType,"choiceResponse")?d.responseType.choiceResponse.response:"",y=d&&(0,ta.isKind)(d.responseType,"choiceResponse")?d.responseType.choiceResponse.reason:"",b=(0,a._)((0,c.useState)(""!==x),2),w=b[0],k=b[1],_=(0,a._)((0,c.useState)(x),2),S=_[0],C=_[1],j=(0,a._)((0,c.useState)(y),2),T=j[0],E=j[1],R=(0,c.useCallback)(function(){if(!p.current)return{responseType:{$kind:"noResponse",noResponse:{}}};var e,t,n=new FormData(p.current),r=n.get(g);return r&&"string"==typeof r&&""!==r.trim()?{responseType:{$kind:"choiceResponse",choiceResponse:{response:r,reason:null!=(t=null==(e=n.get(m))?void 0:e.toString())?t:""}}}:{responseType:{$kind:"noResponse",noResponse:{}}}},[g,m]),I=function(e){C(e);var t=!!e;k(t),t?f({responseType:{$kind:"choiceResponse",choiceResponse:{response:e,reason:T}}}):f({responseType:{$kind:"noResponse",noResponse:{}}})};return(0,u.jsx)(nL.Form,{ref:p,onSubmit:function(e){e.preventDefault(),n(R())},children:(0,u.jsxs)(J.View,{gap:6,children:[(0,u.jsx)(nV.default,{children:t.question}),(0,u.jsx)(nB.RadioGroup,{name:g,value:S,onChange:function(e){return I(e.target.value)},disabled:o,children:(0,u.jsx)(J.View,{gap:6,children:t.options.map(function(e,t){return(0,u.jsxs)("label",{className:nG.default.radioOption,children:[(0,u.jsx)(J.View,{pt:2,children:(0,u.jsx)(nB.Radio,{id:"".concat(g,"-").concat(t),name:g,value:e})}),(0,u.jsx)(eu.Text,{shrink:!0,children:e})]},e)})})}),(0,u.jsx)(nq,{id:m,disabled:o,defaultValue:y,onChange:function(e){E(e),S&&f({responseType:{$kind:"choiceResponse",choiceResponse:{response:S,reason:e}}})}}),(0,u.jsx)(nK,{onCancel:function(){var e;r(),null==(e=p.current)||e.reset(),k(!1),C(""),E("")},onNavigateBack:i,isLoading:o,isLastQuestion:s,isFirstQuestion:l,hasResponse:w})]})})}function nW(e){var t=e.query,n=e.onSubmit,r=e.onCancel,i=e.onNavigateBack,o=e.isResponseInProgress,s=e.isLastQuestion,l=e.isFirstQuestion,d=e.savedResponse,f=e.onUpdateResponse,p=(0,c.useRef)(null),h=(0,c.useId)(),g="text-response-".concat(h),m=d&&(0,ta.isKind)(d.responseType,"textResponse")?d.responseType.textResponse.response:"",x=(0,a._)((0,c.useState)(""!==m.trim()),2),y=x[0],b=x[1],w=(0,c.useCallback)(function(){if(!p.current)return{responseType:{$kind:"noResponse",noResponse:{}}};var e=new FormData(p.current).get(g);return e&&"string"==typeof e&&""!==e.trim()?{responseType:{$kind:"textResponse",textResponse:{response:e}}}:{responseType:{$kind:"noResponse",noResponse:{}}}},[g]);return(0,u.jsx)(nL.Form,{ref:p,onSubmit:function(e){e.preventDefault(),n(w())},children:(0,u.jsxs)(J.View,{gap:8,children:[(0,u.jsx)(nV.default,{children:t.question}),(0,u.jsx)(ev.MultiLineInput,{clsx:nG.default.multilineInput,autoSize:!0,name:g,placeholder:t.responsePlaceholderText||"Type here",disabled:o,defaultValue:m,onChange:function(e){var t=e.target.value,n=!!(t&&t.trim().length>0);b(n),n?f({responseType:{$kind:"textResponse",textResponse:{response:t}}}):f({responseType:{$kind:"noResponse",noResponse:{}}})}}),(0,u.jsx)(nK,{onCancel:function(){var e;r(),null==(e=p.current)||e.reset(),b(!1)},onNavigateBack:i,isLoading:o,isLastQuestion:s,isFirstQuestion:l,hasResponse:y})]})})}function nq(e){var t=e.id,n=e.disabled,r=e.defaultValue,i=e.onChange;return(0,u.jsxs)("label",{clsx:nG.default.reasonField,htmlFor:t,children:[(0,u.jsxs)(J.View,{gap:4,row:!0,align:"center",justify:"space-between",children:[(0,u.jsx)(eu.Text,{color:"dimmer",children:"Additional comments"}),(0,u.jsx)(eu.Text,{color:"dimmest",children:"Optional"})]}),(0,u.jsx)(ev.MultiLineInput,{clsx:nG.default.multilineInput,autoSize:!0,name:t,placeholder:"Type here",rows:1,disabled:n,defaultValue:r,onChange:i?function(e){return i(e.target.value)}:void 0})]})}function nK(e){var t=e.onCancel,n=e.onNavigateBack,r=e.isLoading,i=e.isLastQuestion,o=e.isFirstQuestion,a=e.hasResponse,s=o?void 0:(0,u.jsx)(nF.default,{}),l="Skip";r?l="Sending to Agent":i?l="Send to Agent":a&&(l="Next");var c=i?(0,u.jsx)(nS.default,{}):(0,u.jsx)(nU.default,{});return(0,u.jsxs)(J.View,{clsx:nG.default.responseSubmissionRow,row:!0,gap:8,justify:"end",children:[(0,u.jsx)(eg.Button,{clsx:nG.default.button,text:o?"Dismiss":"Back",onClick:o?t:n,disabled:r,iconLeft:s}),(0,u.jsx)(eg.Button,{clsx:nG.default.button,text:r?"Sending to Agent":l,type:"submit",disabled:r,colorway:i||a?"primary":void 0,iconRight:r?void 0:c,loading:r})]})}e.s(["AgentQueryResponseDialog",()=>n$],331151);var nY=e.i(658886),nQ=e.i(826630);function nX(e){var t=e.requestType,n=e.context,r=e.onAnswerNow,i=e.onDismiss,o=function(e,t){switch(e){case"queryRequest":var n=null!=(r=null==t?void 0:t.numQueries)?r:1;if(1===n){var r,i,o=null==t||null==(i=t.queries)?void 0:i[0];if(o){if((0,ta.isKind)(o.queryType,"booleanQuery")){var a=o.queryType.booleanQuery.question,s=a.length>60?a.substring(0,60)+"":a;return"Agent asks: ".concat(s)}if((0,ta.isKind)(o.queryType,"choiceQuery")){var l=o.queryType.choiceQuery.question,u=l.length>60?l.substring(0,60)+"":l;return"Agent asks: ".concat(u)}if((0,ta.isKind)(o.queryType,"textQuery")){var c=o.queryType.textQuery.question,d=c.length>60?c.substring(0,60)+"":c;return"Agent asks: ".concat(d)}}return"Agent has a question for you"}return"Agent has ".concat(n," questions for you");case"approveTaskListRequest":return"Agent has a task list ready for approval";case"approveBlueprintRequest":return"Agent has a blueprint ready for approval";default:return"Agent has a request for you"}}(t,n),a=function(e){switch(e){case"queryRequest":default:return"Answer now";case"approveTaskListRequest":case"approveBlueprintRequest":return"Review now"}}(t);return(0,u.jsx)(tg.Surface,{clsx:nQ.default.banner,elevated:!0,p:6,gap:6,children:(0,u.jsxs)(J.View,{row:!0,gap:8,align:"center",justify:"space-between",children:[(0,u.jsxs)(J.View,{row:!0,gap:8,align:"center",grow:!0,shrink:!0,clsx:nQ.default.textContainer,children:[(0,u.jsx)(nY.default,{size:20}),(0,u.jsx)(eu.Text,{clsx:nQ.default.text,children:o})]}),(0,u.jsxs)(J.View,{row:!0,gap:4,shrink:0,children:[(0,u.jsx)(eg.Button,{clsx:nQ.default.button,text:"Dismiss",size:"small",onClick:i}),(0,u.jsx)(eg.Button,{clsx:nQ.default.button,text:a,size:"small",colorway:"primary",onClick:r})]})]})})}e.s(["AgentRequestBanner",()=>nX],851480);var nJ=e.i(569384),nZ=e.i(973245),n0=e.i(304277);e.i(566901);var n1=e.i(696683);function n2(){var e=(0,nJ._)(["\n  query WorkspaceUsageBudget($replId: String!) {\n    getRepl(id: $replId) {\n      __typename\n      ... on Repl {\n        id\n        org {\n          ... on Org {\n            id\n            authorizations {\n              editUsageLimit {\n                isAuthorized\n                message\n              }\n            }\n          }\n        }\n      }\n    }\n  }\n"]);return n2=function(){return e},e}function n3(){var e=(0,nJ._)(["\n  query WorkspaceUsageBasedBillingAlerts($orgId: String) {\n    currentUser {\n      id\n      usageBasedBillingAlerts {\n        ...EditUsageBasedBillingAlertsFormInitialConfig\n      }\n      org(orgId: $orgId) {\n        ... on Org {\n          id\n          name\n          usageBasedBillingAlerts {\n            ...EditUsageBasedBillingAlertsFormInitialConfig\n          }\n        }\n      }\n    }\n  }\n  ","\n"]);return n3=function(){return e},e}var n4={},n8=(0,nZ.gql)(n2()),n5=(0,nZ.gql)(n3(),n1.EditUsageBasedBillingAlertsFormInitialConfigFragmentDoc),n6=e.i(605526),n9=e.i(201411),n7=e.i(446530),re=e.i(613355),rt=e.i(938024),rn=(0,n7.cssRecord)({budgetContainer:[re.rcss.colWithGap(8),re.rcss.border(),re.rcss.borderRadius(8),re.rcss.p(8)],budgetContainerBorderless:[re.rcss.colWithGap(8),re.rcss.p(8)],bannerText:[re.rcss.textAlign.left]});function rr(e){var t,n,r,o,a,s,l,c,d,f,p=e.replId,h=e.onUpdateSuccess,g=e.style,m=(t={variables:{replId:p}},n=(0,i._)({},n4,t),n0.useQuery(n8,n)),x=m.data,y=m.loading,b=m.error,w=(0,n6.useOrgId)(p).orgId,k=(r={variables:{orgId:w}},o=(0,i._)({},n4,r),n0.useQuery(n5,o)),_=k.data,S=k.loading,C=k.error;if(!x||!_||y||S)return null;if(w?(s=(null==(l=_.currentUser)?void 0:l.org.__typename)==="Org"?null==(c=_.currentUser)?void 0:c.org:void 0,a=(null==(d=_.currentUser)?void 0:d.org.__typename)==="Org"&&"UsageBasedBillingAlertsConfig"===_.currentUser.org.usageBasedBillingAlerts.__typename?_.currentUser.org.usageBasedBillingAlerts:void 0):a=(null==(f=_.currentUser)?void 0:f.usageBasedBillingAlerts.__typename)==="UsageBasedBillingAlertsConfig"?_.currentUser.usageBasedBillingAlerts:void 0,b)return(0,u.jsx)(ex.StatusBanner,{css:rn.bannerText,colorway:"red",text:b.message,icon:(0,u.jsx)(rt.default,{})});if(C)return(0,u.jsx)(ex.StatusBanner,{css:rn.bannerText,colorway:"red",text:C.message,icon:(0,u.jsx)(rt.default,{})});var j="Repl"===x.getRepl.__typename&&x.getRepl.org?x.getRepl.org:void 0,T=(null==j?void 0:j.authorizations.editUsageLimit.isAuthorized)===!1?j.authorizations.editUsageLimit.message:void 0;return T?(0,u.jsx)(ex.StatusBanner,{css:rn.bannerText,colorway:"red",text:"".concat(T," Reach out to an org admin to update your usage budget."),icon:(0,u.jsx)(rt.default,{})}):(0,u.jsx)(J.View,{css:"outlined"===(void 0===g?"outlined":g)?rn.budgetContainer:rn.budgetContainerBorderless,children:(0,u.jsx)(n9.EditUsageBasedBillingAlertsForm,{org:s,initialSettings:a,onDone:function(){return h}})})}e.s(["UsageBudget",()=>rr],702069);var ri=e.i(952030),ro=e.i(298122);function ra(e){var t=e.runAgent,n=(0,V.default)(),r=(0,a._)((0,c.useState)(!1),2),i=r[0],o=r[1];return(0,u.jsxs)(u.Fragment,{children:[(0,u.jsxs)(tg.Surface,{clsx:ro.default.root,gap:4,p:8,elevated:!0,children:[(0,u.jsxs)(eu.Text,{clsx:ro.default.text,children:["You've hit the monthly budget. Increase your usage budget to continue using the Agent."," "]}),(0,u.jsx)(J.View,{clsx:ro.default.buttonContainer,row:!0,children:(0,u.jsx)(eg.Button,{clsx:ro.default.budgetButton,iconLeft:(0,u.jsx)(ri.default,{}),text:"Increase budget",onClick:function(){return o(!0)},variant:void 0})})]}),(0,u.jsx)(ei.Modal,{isOpen:i,onRequestClose:function(){return o(!1)},children:(0,u.jsx)(rr,{style:"borderless",replId:n,onUpdateSuccess:function(){o(!1),t()}})})]})}e.s(["BudgetExceededMessage",()=>ra],946223);var rs=e.i(368964),rl=e.i(951262);function ru(){var e=(0,nJ._)(["\n  mutation BuildScoreSurvey($input: BuildScoreSurveyResponseInput!) {\n    buildScoreSurvey(input: $input) {\n      __typename\n      ... on CurrentUser {\n        id\n      }\n      ... on UserError {\n        message\n      }\n      ... on UnauthorizedError {\n        message\n      }\n    }\n  }\n"]);return ru=function(){return e},e}function rc(){var e=(0,nJ._)(["\n  query hasCompletedBuildScoreSurveyForTrigger(\n    $trigger: BuildScoreSurveyTriggerPoint!\n  ) {\n    currentUser {\n      id\n      hasCompletedBuildScoreSurveyForTrigger(trigger: $trigger)\n    }\n  }\n"]);return rc=function(){return e},e}var rd={},rf=(0,nZ.gql)(ru()),rp=(0,nZ.gql)(rc()),rh=e.i(58261),rg=e.i(222342),rm=e.i(664152),rv={direction:"reverse",state:{latestUserMessageText:void 0,currentSessionId:void 0},map:function(e){return{latestUserMessageText:e.latestUserMessageText,currentSessionId:e.currentSessionId}},reducer:function(e,t){if(t.currentSessionId||(t.currentSessionId=e.sessionId),(0,e2.isEventContentsKind)(e,"messageEventContents")&&e.sender.type===O.UserType.USER){var n=e.contents.contents;return t.latestUserMessageText=(0,ta.unkind)(n).content,!1}}},rx={direction:"forward",state:{initialPromptText:void 0,latestPlanContents:void 0,approvedPlanContents:void 0,initialSessionId:void 0},map:function(e){var t,n;return{initialPromptText:e.initialPromptText,stackBlueprintUsed:null==(t=e.latestPlanContents)?void 0:t.stackBlueprint,blueprintsUsed:null==(n=e.latestPlanContents)?void 0:n.step.blueprintData,initialSessionId:e.initialSessionId}},reducer:function(e,t){if(t.initialSessionId||(t.initialSessionId=e.sessionId),(0,e2.isEventContentsKind)(e,"messageEventContents")&&e.sender.type===O.UserType.USER){var n=e.contents.contents,r=(0,ta.unkind)(n);t.initialPromptText||(t.initialPromptText=r.content)}if((0,e2.isEventContentsKind)(e,"agentPlanEventContents")&&(t.latestPlanContents=e.contents.contents.agentPlanEventContents),(0,e2.isEventContentsKind)(e,"approvePlanEventContents")&&(t.approvedPlanContents=t.latestPlanContents),(0,e2.isEventAgentToolDataKind)(e,"commitData"))return!1}},ry=e.i(423111);function rb(e){var t,n,o,s,u,d,p,h,m,x=(0,rg.default)(),y=x.showError,b=x.showConfirm,w=(t=(0,f.useChatter)(),n=(0,g.useObservableMemo)(function(){return t.sessions.agent.all.list.select(function(e){return e[e.length-1]})},[t.sessions],{default:void 0}),(0,g.useObservableMemo)(function(){return null==n?void 0:n.reduce(rx,100)},[n],{default:void 0})),k=(o=(0,f.useChatter)(),s=(0,g.useObservableMemo)(function(){return o.sessions.agent.current},[o]),(0,g.useObservableMemo)(function(){return null==s?void 0:s.reduce(rv,100)},[s])),_=(0,V.default)(),S=(0,rh.useConnectorContext)().connections.filter(function(e){var t;return null==(t=e.repls)?void 0:t.some(function(e){return e.id===_})}).map(function(e){return e.connectorName}),C=(u={skip:void 0===e,variables:{trigger:e}},d=(0,i._)({},rd,u),n0.useQuery(rp,d)),j=C.data,T=C.loading,E=(0,a._)((p={refetchQueries:[{query:rp,variables:{trigger:e}}]},h=(0,i._)({},rd,p),rl.useMutation(rf,h)),2),R=E[0],I=E[1].loading,A=!!(null==j||null==(m=j.currentUser)?void 0:m.hasCompletedBuildScoreSurveyForTrigger),P=(0,c.useCallback)(function(t){return(0,r._)(function(){var n;return(0,l._)(this,function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,R({variables:{input:{replId:t.replId||null,responseScore:t.score,trigger:e,headerText:t.headerText,questionText:t.questionText,context:(0,ti._)((0,i._)({},null!=w?w:{},null!=k?k:{}),{connectorsUsed:S,numCheckpointsCompleted:t.numCheckpointsCompleted,followUpHeader:t.followUpHeader,followUpQuestion:t.followUpQuestion,followUpAnswer:t.followUpAnswer}),agentSettings:t.agentSettings}}})];case 1:return r.sent(),null!==t.score&&b("Survey submitted successfully"),[3,3];case 2:throw n=r.sent(),rm.logger.error("Failed to submit build score survey",{error:n}),y("Failed to submit survey."),n;case 3:return[2]}})})()},[R,e,b,y,w,k,S]);return(0,c.useMemo)(function(){return{isLoading:T,isCompleted:A,submitSurvey:P,isSubmitting:I}},[T,A,P,I])}function rw(){var e=(0,ry.useIsPublishClickedCompleted)(),t=(0,ry.useShouldShowRandomCheckpointSurvey)(),n=(0,j.useNumCheckpointsCompleted)();return e?rs.BuildScoreSurveyTriggerPoint.PublishClicked:t?rs.BuildScoreSurveyTriggerPoint.RandomCheckpoint:1===n?rs.BuildScoreSurveyTriggerPoint.FirstCheckpoint:void 0}e.s(["useBuildScoreSurvey",()=>rb,"useCurrentSurveyTrigger",()=>rw],225637);var rk=e.i(45442),r_=e.i(509908),rS=e.i(943565),rC=e.i(283110),rj=e.i(431601),rT=e.i(498710),rE=e.i(811029),rR=function(e){return"followUp"===e?"Help us make Replit better for you":"How did Agent do?"},rI=function(e,t){return"followUp"===t?"Could you share your thoughts on what could have been better?":e===rs.BuildScoreSurveyTriggerPoint.PublishClicked?"How would you rate your experience with Agent?":e===rs.BuildScoreSurveyTriggerPoint.FirstCheckpoint||e===rs.BuildScoreSurveyTriggerPoint.RandomCheckpoint?"How would you rate the agent's performance on the last task?":""},rA=((n=rA||{}).VeryDissatisfied="Very Dissatisfied",n.Dissatisfied="Dissatisfied",n.SomewhatSatisfied="Somewhat Satisfied",n.Satisfied="Satisfied",n.VerySatisfied="Very Satisfied",n),rP={1:"Very Dissatisfied",2:"Dissatisfied",3:"Somewhat Satisfied",4:"Satisfied",5:"Very Satisfied"};function rD(e){var t=e.score,n=e.isFilled,r=e.onClick,i=e.onMouseEnter,o=e.onMouseLeave,a=e.disabled;return(0,u.jsx)("button",{type:"button",className:rE.default.starButton,onClick:function(){return r(t)},onMouseEnter:function(){return i(t)},onMouseLeave:o,disabled:void 0!==a&&a,"aria-label":"Rate ".concat(t," out of 5"),children:n?(0,u.jsx)(rT.default,{className:rE.default.starIcon,size:24}):(0,u.jsx)(rj.default,{className:rE.default.starIcon,size:24})})}function rO(e){var t=e.activeScore,n=e.onClick,r=e.onMouseEnter,i=e.onMouseLeave,o=e.disabled,a=void 0!==o&&o;return(0,u.jsx)(J.View,{row:!0,gap:20,align:"center",justify:"center",children:[1,2,3,4,5].map(function(e){var o=null!==t&&e<=t;return(0,u.jsx)(rD,{score:e,isFilled:o,onClick:n,onMouseEnter:r,onMouseLeave:i,disabled:a},e)})})}function rN(e){var t=e.activeScore;return(0,u.jsx)(J.View,{row:!0,justify:"center",clsx:rE.default.satisfactionLevelText,children:t?(0,u.jsx)(eu.Text,{children:rP[t]}):null})}function rM(){var e=(0,a._)((0,c.useState)(null),2),t=e[0],n=e[1],r=(0,a._)((0,c.useState)(null),2),i=r[0],o=r[1],s=(0,a._)((0,c.useState)(!1),2),l=s[0],d=s[1],f=(0,a._)((0,c.useState)("rating"),2),p=f[0],h=f[1],g=(0,a._)((0,c.useState)(""),2),m=g[0],x=g[1],y=(0,r_.getAnalyticsMetadata)(),b=y.isMobile,w=y.isBonsai,k=y.replId,_=(0,rk.useAgentSettings)(),S=_.settings,C=_.loading,T=(0,j.useNumCheckpointsCompleted)(),E=(0,rS.useGetExperiment)("build_score_survey_v2"),R=rw(),I=rb(R),A=I.isLoading,P=I.isCompleted,D=I.submitSurvey,O=I.isSubmitting,N=!!R&&!P&&!A,M=(0,c.useMemo)(function(){if(N){var e=E();if(e&&(R===rs.BuildScoreSurveyTriggerPoint.FirstCheckpoint&&e.get("should_show_dialog_on_first_checkpoint",!1)||R===rs.BuildScoreSurveyTriggerPoint.RandomCheckpoint&&e.get("should_show_dialog_on_random_checkpoint",!1)||R===rs.BuildScoreSurveyTriggerPoint.PublishClicked&&e.get("should_show_dialog_on_publish",!1)))return!0}return!1},[N,E,R]);if((0,nM.useTrackEffectWithPredicate)(U.events.BUILD_SCORE_SURVEY,{action:"viewed",repl_id:k,trigger:R,is_mobile:b,is_bonsai:w},function(){return M},[k,b,w,R,M]),(0,c.useEffect)(function(){M||(n(null),o(null),d(!1),h("rating"),x(""))},[M]),!M)return null;var L=function(){if(!C){if("followUp"===p)return void D({replId:k,score:t,headerText:rR("rating"),questionText:rI(R,"rating"),agentSettings:S});D({replId:k,score:null,headerText:rR("rating"),questionText:rI(R,"rating"),numCheckpointsCompleted:T,agentSettings:S})}},B=null!=i?i:t;return(0,u.jsxs)(tg.Surface,{clsx:rE.default.root,gap:18,elevated:!0,children:[(0,u.jsx)(J.View,{row:!0,justify:"space-between",align:"start",children:(0,u.jsxs)(J.View,{gap:6,clsx:rE.default.headerRow,children:[(0,u.jsxs)(J.View,{row:!0,justify:"space-between",align:"center",children:[(0,u.jsx)(eu.Text,{children:(0,u.jsx)("strong",{children:rR(p)})}),(0,u.jsx)(rC.default,{onClick:L,"aria-label":"Close",clsx:rE.default.closeIcon})]}),(0,u.jsx)(eu.Text,{children:rI(R,p)})]})}),"rating"===p?(0,u.jsxs)(J.View,{gap:6,children:[(0,u.jsx)(rO,{activeScore:B,onClick:function(e){n(e)},onMouseEnter:function(e){o(e)},onMouseLeave:function(){o(null)},disabled:O||l}),(0,u.jsx)(rN,{activeScore:B})]}):(0,u.jsx)(J.View,{gap:6,children:(0,u.jsx)(ev.MultiLineInput,{value:m,onChange:function(e){return x(e.target.value)},placeholder:"Share your thoughts...",disabled:O||l,autoSize:!0})}),(0,u.jsx)(J.View,{clsx:rE.default.responseSubmissionRow,row:!0,gap:8,justify:"center",children:l?(0,u.jsx)(J.View,{row:!0,justify:"center",clsx:rE.default.thankYouMessage,children:(0,u.jsx)(eu.Text,{color:"dimmest",children:"Thank you for your feedback!"})}):(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)(eg.Button,{clsx:rE.default.button,text:"Cancel",onClick:L,disabled:O}),(0,u.jsx)(eg.Button,{clsx:rE.default.button,text:"Confirm",type:"submit",onClick:function(){if(!C)if("rating"===p&&t){if(t<=3)return void h("followUp");d(!0),D({replId:k,score:t,headerText:rR("rating"),questionText:rI(R,"rating"),agentSettings:S})}else"followUp"===p&&(d(!0),D({replId:k,score:t,headerText:rR("rating"),questionText:rI(R,"rating"),followUpHeader:rR("followUp"),followUpQuestion:rI(R,"followUp"),followUpAnswer:m,numCheckpointsCompleted:T,agentSettings:S}))},colorway:"primary",disabled:"rating"===p?!t||O:!m.trim()||O})]})})]})}e.s(["BuildScoreSurveyDialog",()=>rM],59730);var rL=e.i(968783);e.i(653863);var rB=e.i(492267),rV=e.i(624782),rF=e.i(211397),rU=e.i(357399),rG=e.i(488014),r$=e.i(483730);let rz=function(e){var t,n,i,o=e.onDismiss,a=e.onConnect,s=e.requestedConnectorIds,d=e.existingConnectorConfigs,f=e.requestedConnections,p=e.existingConnections,h=e.replId,g=e.showBetaBadge,m=e.isLoading,x=void 0!==m&&m,y=(0,rB.useIsAgentStackRepl)(),b=f.length>0,w=d.find(function(e){return e.id===s[0]}),k=p.find(function(e){return e.connectionId===f[0]}),_=b?null==k?void 0:k.displayName:null==w?void 0:w.displayName,S=b?null==k?void 0:k.iconPath:null==w?void 0:w.iconPath,C=b?null==k?void 0:k.connectorName:null==w?void 0:w.connectorName,j=C===rs.ConnectorName.Stripe&&b,T=(t=C,n=_,i=b,j?t===rs.ConnectorName.Stripe?"You already have a Stripe connection for this app. Manage your development and production connections, check connection health, and update settings.":"You already have a".concat(n?" ".concat(n):""," connection for this app. Manage your connection settings and check connection health."):i?"I see you have the".concat(n?" ".concat(n):""," connection active on your account. Would you like to use this connection?"):t===rs.ConnectorName.Stripe?"Get started with a Stripe sandbox to test your payments functionality. Create products and test transactions directly from Replit.":"".concat(n?"Let's connect to ".concat(n,". "):"","Set up the connection now? You can also configure this later by asking Replit Agent or using the integrations pane."));(0,c.useEffect)(function(){C&&b?(0,F.track)(U.events.CONNECTION_CREATION_SUGGESTED,{connectorName:C}):C&&!b&&(0,F.track)(U.events.CONNECTION_SUGGESTED,{connectorName:C})},[C,b]);var E=function(){if(!h||!C)return null;var e=C.toLowerCase();return"/integrations/".concat(e,"/apps/").concat(h)};return(0,u.jsxs)(tg.Surface,{clsx:r$.default.dialog,gap:8,elevated:!0,children:[(0,u.jsxs)(J.View,{row:!0,justify:"space-between",align:"center",children:[(0,u.jsxs)(J.View,{row:!0,gap:8,align:"center",children:[S?(0,u.jsx)(rF.default,{src:null!=S?S:"",alt:null!=_?_:"",width:24,height:24}):null,(0,u.jsxs)(eu.Text,{children:["Connect"," ",_?"to ".concat(_):"with integration"]})]}),void 0!==g&&g?(0,u.jsx)(rV.Pill,{text:"Beta",colorway:"primary",compact:!0}):null]}),(0,u.jsx)(J.View,{pb:4,pl:2,children:(0,u.jsx)(eu.Text,{children:T})}),(0,u.jsxs)(J.View,{row:!0,gap:8,children:[(0,u.jsx)(eg.Button,{className:r$.default.grow1,text:"Dismiss",disabled:x,onClick:function(){C&&(b?(0,F.track)(U.events.CONNECTION_SUGGESTION_RESPONDED,{connectorName:C,didAccept:!1,isAgentStackRepl:y}):(0,F.track)(U.events.CONNECTION_CREATION_SUGGESTION_RESPONDED,{connectorName:C,didAccept:!1,isAgentStackRepl:y})),o(s)}}),j?(0,u.jsx)(eg.Button,{className:r$.default.grow3,colorway:"primary",text:"Manage connection",iconLeft:(0,u.jsx)(rU.default,{}),disabled:x||!h,onClick:function(){var e=E();e&&(C&&(0,F.track)(U.events.CONNECTION_SUGGESTION_RESPONDED,{connectorName:C,didAccept:!0,isAgentStackRepl:y}),window.open(e,"_blank"))}}):(0,u.jsx)(eg.Button,{className:r$.default.grow3,colorway:"primary",text:b?"Continue with connection":"Connect".concat(_?" ".concat(_):""),iconLeft:b?(0,u.jsx)(ey.default,{}):(0,u.jsx)(rG.default,{}),loading:x,disabled:x,onClick:function(){return(0,r._)(function(){return(0,l._)(this,function(e){switch(e.label){case 0:return[4,a()];case 1:return e.sent(),[2]}})})()}})]})]})};function rH(e){var t=e.session,n=e.addingIntegrationsRequest,i=(0,rL.useCurrentUserStoredOrgContext)().orgId,o=(0,nk.useSendAskUserForActionResponse)(t),s=(0,t8.useGlobalModal)().show,d=(0,rh.useConnectorContext)(),f=d.token,p=d.connectorConfigs,h=d.connections,g=d.createConnection,m=d.createConnectionLoading,x=d.refetch,y=(0,V.default)(),b=(0,rB.useIsAgentStackRepl)(),w=(0,a._)((0,c.useState)(!1),2),k=w[0],_=w[1],S=(0,c.useCallback)(function(e,t){(null==n?void 0:n.eventId)&&(o({type:"addingIntegrationsResponse",requestEventId:n.eventId,rejectedConnectorIds:e,connectionIds:[]}),(0,F.track)(U.events.CONNECTION_CREATION_SUGGESTION_RESPONDED,{connectorName:null!=t?t:void 0,didAccept:!1,isAgentStackRepl:b}),_(!1))},[o,n,b]),C=(null==n?void 0:n.content)||{},j=C.connectorIds,T=void 0===j?[]:j,E=C.connectionIds,R=void 0===E?[]:E,I=(0,c.useCallback)(function(e){(null==n?void 0:n.eventId)&&(o({type:"addingIntegrationsResponse",requestEventId:n.eventId,connectionIds:[e.connectionId],rejectedConnectorIds:[]}),(0,F.track)(U.events.CONNECTION_SUGGESTION_RESPONDED,{connectorName:e.connectorName,didAccept:!0,isAgentStackRepl:b}),_(!1))},[n,o,b]),A=(0,c.useCallback)(function(e,t,a,u){return(0,r._)(function(){var c,d,p,h;return(0,l._)(this,function(m){switch(m.label){case 0:if(!(null==n?void 0:n.eventId))return[2];if((0,F.track)(U.events.CONNECTION_SETUP_STARTED,{surface:"chat",connectorName:t}),"STRIPE"!==t)return[3,3];return[4,g({variables:{input:{connectorConfigId:e,settings:{},replId:y,orgId:i,environment:"development"}}})];case 1:return d=m.sent(),[4,x()];case 2:return m.sent(),(h=(null==(p=null==(c=d.data)?void 0:c.createConnection)?void 0:p.__typename)==="CreateConnection"?p.connectionId:null)&&(o({type:"addingIntegrationsResponse",requestEventId:n.eventId,connectionIds:[h],rejectedConnectorIds:[]}),(0,F.track)(U.events.CONNECTION_CREATION_SUGGESTION_RESPONDED,{connectorName:t,didAccept:!0,isAgentStackRepl:b})),_(!1),[2];case 3:if(!("api_key"===a&&u))return[3,5];return[4,s("ConnectorApiKeySetupModal",{connector:u,onComplete:function(){return(0,r._)(function(){var e,r,a,s,c;return(0,l._)(this,function(l){switch(l.label){case 0:return[4,x()];case 1:if(!(r=l.sent()).data||!(null==n?void 0:n.eventId))return[2];if(a=[],(null==(e=r.data.currentUser)?void 0:e.__typename)==="CurrentUser"){if("connectorContext"in r.data.currentUser&&"CurrentUserConnectorContext"===r.data.currentUser.connectorContext.__typename)a=null!=(s=r.data.currentUser.connectorContext.connections)?s:[];else if("org"in r.data.currentUser&&"Org"===r.data.currentUser.org.__typename)return rm.logger.error("Org connection config suggested in workspace",{connectorConfig:u,orgId:i,connectorName:t}),S([u.id],u.connectorName),[2]}return(c=a.find(function(e){return e.connectorName===u.connectorName}))&&(o({type:"addingIntegrationsResponse",requestEventId:n.eventId,connectionIds:[c.connectionId],rejectedConnectorIds:[]}),u.connectorName&&(0,F.track)(U.events.CONNECTION_CREATION_SUGGESTION_RESPONDED,{connectorName:u.connectorName,didAccept:!0,isAgentStackRepl:b}),_(!1)),[2]}})})()},onCancel:function(){u.connectorName&&S([u.id],u.connectorName)}})];case 4:case 6:return m.sent(),[2];case 5:return[4,s("ConnectionEmbedModal",{token:f,connectorId:e,connectorName:t,onEvent:function(e){return(0,r._)(function(){return(0,l._)(this,function(r){switch(r.label){case 0:if("connect.connection-connected"!==e.name)return[3,3];return[4,g({variables:{input:{connectionId:e.data.connection_id,orgId:null!=i?i:null}}})];case 1:return r.sent(),[4,x()];case 2:r.sent(),e.data.connection_id&&n.eventId&&(o({type:"addingIntegrationsResponse",requestEventId:n.eventId,connectionIds:[e.data.connection_id],rejectedConnectorIds:[]}),t&&(0,F.track)(U.events.CONNECTION_CREATION_SUGGESTION_RESPONDED,{connectorName:t,didAccept:!0,isAgentStackRepl:b}),_(!1)),r.label=3;case 3:return[2]}})})()}})]}})})()},[n,g,i,s,f,x,o,b,y,S]),P=(0,c.useCallback)(function(){return(0,r._)(function(){var e,t,r,i,o,a,s,u,c,d,f,p,h,g,m;return(0,l._)(this,function(l){switch(l.label){case 0:if(!(null==n?void 0:n.eventId))return[2];return _(!0),[4,x()];case 1:if(!(t=l.sent()).data)return _(!1),[2];if(r=[],i=[],(null==(e=t.data.currentUser)?void 0:e.__typename)==="CurrentUser"&&("connectorContext"in t.data.currentUser&&"CurrentUserConnectorContext"===t.data.currentUser.connectorContext.__typename?(r=null!=(o=t.data.currentUser.connectorContext.connectorConfigs)?o:[],i=null!=(a=t.data.currentUser.connectorContext.connections)?a:[]):"org"in t.data.currentUser&&"Org"===t.data.currentUser.org.__typename&&"OrgConnectorContext"===t.data.currentUser.org.connectorContext.__typename&&(r=null!=(s=t.data.currentUser.org.connectorContext.connectorConfigs)?s:[],i=null!=(u=t.data.currentUser.org.connectorContext.connections)?u:[])),R.length>0){if(f=R[0],p=i.find(function(e){return e.connectionId===f}))return I(p),[2];if(h=null==(d=f.split("_")[1])?void 0:d.toUpperCase(),!(c=r.find(function(e){return e.connectorName===h})))return S([f],h),[2]}else if(!(T.length>0))return S([]),[2];else if(g=T[0],!(c=r.find(function(e){return e.id===g})))return S([g]),[2];if((null==(m=i.find(function(e){return e.connectorName===c.connectorName}))?void 0:m.connectorName)!=="STRIPE"&&m)return I(m),[2];return[4,A(c.id,c.connectorName,c.type,c)];case 2:return l.sent(),[2]}})})()},[n,x,T,R,S,I,A]);return(0,u.jsx)(rz,{onDismiss:S,onConnect:P,existingConnections:h,requestedConnectorIds:T,requestedConnections:R,existingConnectorConfigs:p,replId:y,isLoading:m||k})}e.s(["FooterAddIntegration",()=>rH],579048);var rW=e.i(717215),rq=e.i(882793),rK=e.i(590986),rY=(0,c.createContext)(null);function rQ(e){var t=e.allowMultipleExpanded,n=void 0!==t&&t,r=e.children,i=e.className,o=e.defaultExpandedKeys,l=void 0===o?[]:o,d=e.expandedKeys,f=e.onExpandedChange,p=void 0!==d,h=(0,a._)((0,c.useState)(function(){return n||l.length<=1?l:[l[0]]}),2),g=h[0],m=h[1],x=p?d:g,y=(0,c.useMemo)(function(){return n||x.length<=1?x:[x[0]]},[x,n]),b=(0,c.useCallback)(function(e){var t;t=y.includes(e)?y.filter(function(t){return t!==e}):n?(0,s._)(y).concat([e]):[e],p||m(t),null==f||f(t)},[y,n,p,f]),w=(0,c.useMemo)(function(){return{allowMultipleExpanded:n,expandedKeys:y,toggleKey:b}},[n,y,b]);return(0,u.jsx)(rY.Provider,{value:w,children:(0,u.jsx)(tg.Surface,{elevated:!0,className:i,clsx:rK.default.container,children:r})})}rQ.Item=function(e){var t=e.id,n=e.header,r=e.children,o=e.className,a=function(){var e=(0,c.useContext)(rY);if(!e)throw Error("AccordionGroup compound components must be used within AccordionGroup");return e}(),s=a.expandedKeys,l=a.toggleKey,d=s.includes(t),f=(0,nx.useCreateInteractive)({variant:"nofill"});return(0,u.jsxs)(J.View,{className:o,clsx:rK.default.item,children:[(0,u.jsx)(J.View,(0,ti._)((0,i._)({role:"button",tabIndex:0},f),{onClick:function(){return l(t)},onKeyDown:function(e){("Enter"===e.key||" "===e.key)&&(e.preventDefault(),l(t))},"aria-expanded":d,"aria-controls":"accordion-panel-".concat(t),id:"accordion-header-".concat(t),children:"function"==typeof n?n({isExpanded:d}):n})),d?(0,u.jsx)(J.View,{id:"accordion-panel-".concat(t),role:"region","aria-labelledby":"accordion-header-".concat(t),children:r}):null]})};var rX=e.i(406345),rJ=e.i(260328);let rZ=function(e){var t=e.items,n=e.onApproveAll,i=e.onDismissAll,o=e.onApproveSingle,s=e.onDismissSingle,d=e.onComplete,f=e.showApproveAll,p=(0,rg.default)().showError,h=(0,a._)((0,c.useState)(function(){var e=new Map;return t.forEach(function(t){e.set(t.id,{status:"pending",isLoading:!1})}),e}),2),g=h[0],m=h[1],x=t.filter(function(e){var t;return(null==(t=g.get(e.id))?void 0:t.status)!=="dismissed"}),y=(0,c.useCallback)(function(e,t){return(0,r._)(function(){var n;return(0,l._)(this,function(r){switch(r.label){case 0:m(function(t){var n=new Map(t);return n.set(e,{status:"pending",isLoading:!0}),n}),r.label=1;case 1:return r.trys.push([1,3,,4]),[4,o(t)];case 2:return"success"===(n=r.sent()).status?m(function(t){var n=new Map(t);return n.set(e,{status:"approved",isLoading:!1}),n}):"cancelled"===n.status?m(function(t){var n=new Map(t);return n.set(e,{status:"pending",isLoading:!1}),n}):(p("Failed to connect to integration."),m(function(t){var n=new Map(t);return n.set(e,{status:"dismissed",isLoading:!1}),n})),[3,4];case 3:return r.sent(),p("Failed to connect to integration."),m(function(t){var n=new Map(t);return n.set(e,{status:"dismissed",isLoading:!1}),n}),[3,4];case 4:return[2]}})})()},[o,p]),b=(0,c.useCallback)(function(e){m(function(t){var n=new Map(t);return n.set(e,{status:"dismissed",isLoading:!1}),n}),s()},[s]);(0,c.useEffect)(function(){0!==t.length&&t.every(function(e){var t=g.get(e.id);return t&&("approved"===t.status||"dismissed"===t.status)})&&d(t.filter(function(e){var t;return(null==(t=g.get(e.id))?void 0:t.status)==="approved"}).map(function(e){return e.id}),t.filter(function(e){var t;return(null==(t=g.get(e.id))?void 0:t.status)==="dismissed"}).map(function(e){return e.id}))},[g,t,d]);var w=(0,c.useMemo)(function(){if(1===x.length)return[x[0].id];var e=x.find(function(e){return"connectorConfig"===e.itemType});return e?[e.id]:[]},[x]);return(0,u.jsx)(J.View,{gap:12,children:(0,u.jsxs)(tg.Surface,{clsx:rJ.default.dialog,gap:12,children:[(0,u.jsxs)(J.View,{gap:8,children:[(0,u.jsxs)(J.View,{row:!0,gap:8,align:"center",children:[(0,u.jsx)(rX.default,{size:16}),(0,u.jsx)(eu.Text,{children:"Integrations"})]}),(0,u.jsx)(eu.Text,{textWrap:"pretty",variant:"small",color:"dimmer",children:"To connect your App to these external services, you need to set up or approve the following integrations."})]}),(0,u.jsx)(J.View,{clsx:rJ.default.accordionContainer,children:(0,u.jsx)(rQ,{allowMultipleExpanded:!1,defaultExpandedKeys:w,children:x.map(function(e){var t,n=g.get(e.id),r=(null==n?void 0:n.status)==="approved",i=null!=(t=null==n?void 0:n.isLoading)&&t,o=null;return r?o="Approved":"connection"===e.itemType&&(o="Connected"),(0,u.jsx)(rQ.Item,{id:e.id,header:function(t){var n=t.isExpanded;return(0,u.jsxs)(J.View,{clsx:rJ.default.accordionHeader,gap:12,p:8,children:[(0,u.jsxs)(J.View,{row:!0,gap:8,align:"center",children:[e.iconPath?(0,u.jsx)(rW.default,{src:e.iconPath,alt:e.displayName,width:20,height:20}):null,(0,u.jsx)(eu.Text,{multiline:!1,children:e.displayName})]}),(0,u.jsxs)(J.View,{row:!0,gap:8,align:"center",children:[o?(0,u.jsxs)(J.View,{row:!0,gap:6,align:"center",clsx:rJ.default.connectedBadge,children:[r?(0,u.jsx)(ey.default,{size:16,color:"green"}):null,(0,u.jsx)(eu.Text,{variant:"small",color:"dimmer",children:o})]}):null,n?(0,u.jsx)(tw.default,{size:16}):(0,u.jsx)(tk.default,{size:16})]})]})},children:(0,u.jsxs)(J.View,{gap:4,px:8,pb:8,children:[(0,u.jsx)(eu.Text,{color:"dimmer",textWrap:"pretty",children:rq.CONNECTOR_DESCRIPTIONS[e.connectorName]||"Approve to integrate ".concat(e.displayName," into your App.")}),r?null:(0,u.jsxs)(J.View,{row:!0,gap:8,justify:"end",children:[(0,u.jsx)(J.View,{clsx:rJ.default.grow1,children:(0,u.jsx)(eg.Button,{text:"Dismiss",variant:"nofill",onClick:function(){return b(e.id)},disabled:i,stretch:!0})}),(0,u.jsx)(J.View,{clsx:rJ.default.grow3,children:(0,u.jsx)(eg.Button,{text:"Approve",colorway:"primary",onClick:function(){return y(e.id,e)},iconLeft:i?(0,u.jsx)(eo.default,{}):(0,u.jsx)(ey.default,{}),disabled:i,stretch:!0})})]})]})},e.id)})})}),x.length>1?(0,u.jsxs)(J.View,{row:!0,gap:8,justify:"end",align:"center",children:[(0,u.jsx)(eg.Button,{text:"Dismiss all",size:"small",variant:"nofill",onClick:i}),f?(0,u.jsx)(eg.Button,{text:"Approve all",colorway:"primary",iconLeft:(0,u.jsx)(ey.default,{}),onClick:n}):null]}):null]})})};function r0(e){var t=e.session,n=e.addingIntegrationsRequest,i=(0,rL.useCurrentUserStoredOrgContext)().orgId,o=(0,nk.useSendAskUserForActionResponse)(t),a=(0,t8.useGlobalModal)().show,s=(0,rh.useConnectorContext)(),d=s.token,f=s.connectorConfigs,p=s.connections,h=s.createConnection,g=s.refetch,m=(0,V.default)(),x=(0,rB.useIsAgentStackRepl)(),y=(null==n?void 0:n.content)||{},b=y.connectorIds,w=void 0===b?[]:b,k=y.connectionIds,_=void 0===k?[]:k,S=(0,c.useMemo)(function(){var e=[];return w.forEach(function(t){var n,r,i,o,a=f.find(function(e){return e.id===t});a&&e.push({id:a.id,displayName:null!=(r=null!=(n=a.displayName)?n:a.connectorName)?r:"",iconPath:null!=(i=a.iconPath)?i:null,connectorName:null!=(o=a.connectorName)?o:"",itemType:"connectorConfig",type:a.type,connectorConfig:a})}),_.forEach(function(t){var n,r,i=p.find(function(e){return e.connectionId===t});i&&e.push({id:i.connectionId,displayName:i.displayName,iconPath:null!=(n=i.iconPath)?n:null,connectorName:i.connectorName,itemType:"connection",type:null!=(r=i.type)?r:null})}),e},[w,_,f,p]),C=(0,c.useMemo)(function(){return S.every(function(e){return"connection"===e.itemType})},[S]),j=(0,c.useCallback)(function(e,t,o,s){return(0,r._)(function(){var u,c,f,p;return(0,l._)(this,function(y){switch(y.label){case 0:if(!(null==n?void 0:n.eventId))return[2,{status:"failed"}];if((0,F.track)(U.events.CONNECTION_SETUP_STARTED,{surface:"chat",connectorName:t}),"STRIPE"!==t)return[3,3];if(!m)throw Error("replId is required for Stripe Sandbox connection");return[4,h({variables:{input:{connectorConfigId:e,settings:{},replId:m,orgId:i,environment:"development"}}})];case 1:return c=y.sent(),[4,g()];case 2:if(y.sent(),p=(null==(f=null==(u=c.data)?void 0:u.createConnection)?void 0:f.__typename)==="CreateConnection"?f.connectionId:null)return(0,F.track)(U.events.CONNECTION_CREATION_SUGGESTION_RESPONDED,{connectorName:t,didAccept:!0,isAgentStackRepl:x}),[2,{status:"success",connectionId:p}];return[2,{status:"failed"}];case 3:if("api_key"===o&&s)return[2,new Promise(function(e){a("ConnectorApiKeySetupModal",{connector:s,onComplete:function(){return(0,r._)(function(){var r,o,a,u,c;return(0,l._)(this,function(l){switch(l.label){case 0:return[4,g()];case 1:if(!(o=l.sent()).data||!(null==n?void 0:n.eventId))return e({status:"failed"}),[2];if(a=[],(null==(r=o.data.currentUser)?void 0:r.__typename)==="CurrentUser"){if("connectorContext"in o.data.currentUser&&"CurrentUserConnectorContext"===o.data.currentUser.connectorContext.__typename)a=null!=(u=o.data.currentUser.connectorContext.connections)?u:[];else if("org"in o.data.currentUser&&"Org"===o.data.currentUser.org.__typename)return rm.logger.error("Org connection config suggested in workspace",{connectorConfig:s,orgId:i,connectorName:t}),e({status:"failed"}),[2]}return(c=a.find(function(e){return e.connectorName===s.connectorName}))?((0,F.track)(U.events.CONNECTION_CREATION_SUGGESTION_RESPONDED,{connectorName:s.connectorName,didAccept:!0,isAgentStackRepl:x}),e({status:"success",connectionId:c.connectionId})):e({status:"failed"}),[2]}})})()},onCancel:function(){e({status:"cancelled"})}})})];return[2,new Promise(function(n){a("ConnectionEmbedModal",{token:d,connectorId:e,connectorName:t,onEvent:function(e){return(0,r._)(function(){return(0,l._)(this,function(r){switch(r.label){case 0:if("connect.connection-connected"!==e.name)return[3,3];return[4,h({variables:{input:{connectionId:e.data.connection_id,orgId:null!=i?i:null}}})];case 1:return r.sent(),[4,g()];case 2:r.sent(),e.data.connection_id?((0,F.track)(U.events.CONNECTION_CREATION_SUGGESTION_RESPONDED,{connectorName:null!=t?t:void 0,didAccept:!0,isAgentStackRepl:x}),n({status:"success",connectionId:e.data.connection_id})):n({status:"cancelled"}),r.label=3;case 3:return[2]}})})()},onCancel:function(){n({status:"cancelled"})}})})]}})})()},[n,h,i,a,d,g,x,m]),T=(0,c.useCallback)(function(){if(null==n?void 0:n.eventId){var e=S.map(function(e){return e.id});o({type:"addingIntegrationsResponse",requestEventId:n.eventId,rejectedConnectorIds:e,connectionIds:[]}),(0,F.track)(U.events.CONNECTION_CREATION_SUGGESTION_RESPONDED,{didAccept:!1,isAgentStackRepl:x})}},[n,S,o,x]),E=(0,c.useCallback)(function(){if(null==n?void 0:n.eventId){var e=S.map(function(e){return e.id});o({type:"addingIntegrationsResponse",requestEventId:n.eventId,rejectedConnectorIds:[],connectionIds:e}),(0,F.track)(U.events.CONNECTION_CREATION_SUGGESTION_RESPONDED,{didAccept:!0,isAgentStackRepl:x})}},[n,S,o,x]),R=(0,c.useCallback)(function(e){return(0,r._)(function(){var t;return(0,l._)(this,function(n){switch(n.label){case 0:if(n.trys.push([0,3,,4]),"connection"===e.itemType)return[2,{status:"success"}];if(!("connectorConfig"===e.itemType&&e.connectorConfig))return[3,2];return[4,j(e.connectorConfig.id,e.connectorConfig.connectorName,e.connectorConfig.type,e.connectorConfig)];case 1:return[2,{status:n.sent().status}];case 2:return[2,{status:"failed"}];case 3:return t=n.sent(),L.captureException(t,{tags:{component:"FooterAddMultiIntegrations",action:"onApproveSingle"},extra:{itemId:e.id,itemType:e.itemType,connectorName:e.connectorName}}),[2,{status:"failed"}];case 4:return[2]}})})()},[j]),I=(0,c.useCallback)(function(){(0,F.track)(U.events.CONNECTION_CREATION_SUGGESTION_RESPONDED,{didAccept:!1,isAgentStackRepl:x})},[x]),A=(0,c.useCallback)(function(e,t){(null==n?void 0:n.eventId)&&(o({type:"addingIntegrationsResponse",requestEventId:n.eventId,rejectedConnectorIds:t,connectionIds:e}),(0,F.track)(U.events.CONNECTION_CREATION_SUGGESTION_RESPONDED,{didAccept:e.length>0,isAgentStackRepl:x}))},[n,o,x]);return(0,u.jsx)(rZ,{items:S,onApproveAll:E,onDismissAll:T,onApproveSingle:R,onDismissSingle:I,onComplete:A,showApproveAll:C})}e.s(["FooterAddMultiIntegrations",()=>r0],18056);var r1=e.i(319855),r2=e.i(51389),r3=e.i(128258),r4=e.i(425283),r8=e.i(645632),r5=e.i(693188),r6=e.i(821488),r9=e.i(618497),r7=e.i(347748);function ie(){var e=(0,t8.useGlobalModal)().show,t=(0,y.useIsInBonsaiWebview)(),n=(0,r3.default)(),i=(0,r4.useCouponOfferDetails)(),o=(0,r2.useSubscriptionPlanInfo)({planPrefix:"hacker_pro",planPeriod:"monthly"}).costInUsdCents,a=(0,r2.useSubscriptionPlanInfo)({planPrefix:"hacker_pro",planPeriod:"yearly"}).costInUsdCents,s=(null==i?void 0:i.monthlyPrice)!=null&&null!=o?Math.max(0,o-i.monthlyPrice):null,c=(null==i?void 0:i.yearlyPrice)!=null&&null!=a?Math.max(0,a-i.yearlyPrice):null,d=null!=s?s:c,f=d&&!t?"Upgrade now (".concat((0,r1.displayCentsAsDollars)(d)," off)"):"Upgrade now";return(0,u.jsxs)(tg.Surface,{elevated:!0,clsx:r7.default.root,children:[(0,u.jsxs)(J.View,{clsx:r7.default.header,row:!0,align:"center",gap:8,pt:8,pb:8,pl:8,children:[(0,u.jsx)(r5.default,{size:20}),(0,u.jsx)(eu.Text,{clsx:r7.default.title,children:"Upgrade to continue building"})]}),(0,u.jsxs)(J.View,{clsx:r7.default.textContainer,gap:8,pt:16,pb:24,px:24,children:[(0,u.jsx)(J.View,{clsx:r7.default.messageContainer,children:(0,u.jsx)(J.View,{clsx:r7.default.longMessage,children:(0,u.jsxs)(eu.Text,{children:["You've reached your ",t4.freePlanName," usage limit. Upgrade to make, launch, and scale your apps."]})})}),(0,u.jsx)(J.View,{clsx:r7.default.shortMessage,children:(0,u.jsx)(eu.Text,{children:"You've reached your usage limit."})}),(0,u.jsxs)(J.View,{clsx:r7.default.benefitItem,row:!0,gap:8,children:[(0,u.jsx)(r6.default,{clsx:r7.default.benefitIcon}),(0,u.jsx)(eu.Text,{children:"$25 Monthly credits for Replit Agent"})]}),(0,u.jsxs)(J.View,{clsx:r7.default.benefitItem,row:!0,gap:8,children:[(0,u.jsx)(r9.default,{clsx:r7.default.benefitIcon}),(0,u.jsx)(eu.Text,{children:"Publish and host your apps"})]}),(0,u.jsxs)(J.View,{clsx:r7.default.benefitItem,row:!0,gap:8,children:[(0,u.jsx)(r8.default,{clsx:r7.default.benefitIcon}),(0,u.jsx)(eu.Text,{children:"Access more powerful models"})]})]}),(0,u.jsx)(eg.Button,{text:f,onClick:function(){return(0,r._)(function(){return(0,l._)(this,function(t){switch(t.label){case 0:return[4,e("MembershipPurchaseModal",{analyticsContext:{upgrade:{context:"agent_freemium_quota_v2"}},onPurchaseComplete:function(){return n()}})];case 1:return t.sent(),[2]}})})()},colorway:"primary",variant:"default",clsx:r7.default.upgradeButton})]})}e.s(["FreemiumQuotaExceeded",()=>ie],492008)},132694,e=>{e.v({root:"RecoveryModeFooterDialog-module__grO4Qa__root"})},20399,130764,225500,913811,e=>{"use strict";var t=e.i(276385),n=e.i(389959),r=e.i(929872),i=e.i(960178),o=e.i(550801),a=e.i(132694);function s(e){var s=e.nixError,l=e.openPane,u=(0,n.useCallback)(function(e){l({type:"codeEditor",data:{path:e}})},[l]);return"rebuilding-after-error"===s.status?(0,t.jsx)(r.Surface,{elevated:!0,clsx:a.default.root,p:8,gap:6,children:(0,t.jsx)(i.Header,{variant:"subheadDefault",level:3,children:"The nix environment is rebuilding"})}):(0,t.jsx)(r.Surface,{elevated:!0,clsx:a.default.root,p:8,gap:6,children:(0,t.jsx)(o.NixIsBrokenModalContent,{openFile:u,nixError:s})})}e.s(["RecoveryModeFooterDialog",()=>s],20399);var l=e.i(374106),u=e.i(986194);e.i(925218);var c=e.i(641555),d={direction:"reverse",state:{eventId:null,content:null},map:function(e){return e.content?{eventId:e.eventId,content:e.content}:null},reducer:function(e,t){if((0,l.isEventContentsKind)(e,"agentAskUserForActionResponse")){var n=(0,u.unkind)(e.contents.contents).response;if(n&&(0,u.isKind)(n,"addingIntegrationsResponse"))return!1}if((0,l.isEventContentsKind)(e,"agentAskUserForActionRequest")){var r=(0,u.unkind)(e.contents.contents).request;if(r&&(0,u.isKind)(r,"addingIntegrationRequest")){var i=r.addingIntegrationRequest;return t.eventId=e.id,t.content={connectorIds:i.connectorIds||[],connectionIds:i.connectionIds||[]},!1}}}};function f(e){return(0,c.useObservableMemo)(function(){return null==e?void 0:e.reduce(d,50)},[e],{default:null})}e.s(["useAddingIntegrationsRequest",()=>f],130764);var p=e.i(368964),h=e.i(878420),g=e.i(569384),m=e.i(973245),x=e.i(304277);function y(){var e=(0,g._)(["\n  fragment AgentAuthorizations on OrgAuthorizations {\n    paidAgent: useAiAgent(tier: paid) {\n      __typename\n      isAuthorized\n      message\n      code\n    }\n    freeAgent: useAiAgent(tier: free) {\n      __typename\n      isAuthorized\n      message\n      code\n    }\n  }\n"]);return y=function(){return e},e}function b(){var e=(0,g._)(["\n  query GetAgentRepl($replId: String!) {\n    getRepl(id: $replId) {\n      __typename\n      ... on Repl {\n        id\n        org {\n          id\n        }\n        user {\n          id\n        }\n      }\n      ... on Error {\n        message\n      }\n    }\n  }\n"]);return b=function(){return e},e}function w(){var e=(0,g._)(["\n  query GetAgentReplAuthorizations(\n    $orgId: String\n    $ownerUserId: Int!\n    $replId: String!\n  ) {\n    currentUser {\n      id\n      personalOrgAuthorizations {\n        ... on OrgAuthorizations {\n          ...AgentAuthorizations\n        }\n        ... on Error {\n          message\n        }\n      }\n      org(orgId: $orgId) {\n        ... on Org {\n          id\n          authorizations {\n            ... on OrgAuthorizations {\n              ...AgentAuthorizations\n            }\n          }\n        }\n        ... on Error {\n          message\n        }\n      }\n    }\n    replOwner: user(id: $ownerUserId) {\n      id\n      paidAgentAuthorization(replId: $replId) {\n        ... on OrgAuthorization {\n          isAuthorized\n          message\n          code\n        }\n        ... on Error {\n          message\n        }\n      }\n    }\n  }\n  ","\n"]);return w=function(){return e},e}e.i(566901);var k={},_=(0,m.gql)(y()),S=(0,m.gql)(b()),C=(0,m.gql)(w(),_),j=e.i(207237),T={__typename:"OrgAuthorization",isAuthorized:!1,message:"Free agent is not available in personal repls for guests",code:p.OrgAuthorizationCode.InsufficientPermissions};function E(){var e=(0,j.default)(),t=(w=(m={variables:{replId:(0,j.default)()}},y=(0,h._)({},k,m),b=x.useQuery(S,y)).data,_=b.loading,E=b.error,{orgId:(null==w?void 0:w.getRepl.__typename)==="Repl"?null==(p=w.getRepl.org)?void 0:p.id:void 0,ownerUserId:(null==w?void 0:w.getRepl.__typename)==="Repl"?null==(g=w.getRepl.user)?void 0:g.id:void 0,loading:_,error:E}),n=t.orgId,r=t.ownerUserId,i=t.loading,o=t.error,a=(R={variables:{orgId:n,ownerUserId:null!=r?r:0,replId:e},skip:!r},I=(0,h._)({},k,R),x.useQuery(C,I)),s=a.data,l=a.loading,u=a.error,c=a.refetch,d=null==s||null==(A=s.currentUser)?void 0:A.id,f=!!d&&!!r&&d===r;if(i||l)return{loading:!0,refetch:c};if(o||u)return{loading:!1,refetch:c};if(n)return{authorizations:(null==s||null==(D=s.currentUser)?void 0:D.org.__typename)==="Org"?s.currentUser.org.authorizations:void 0,loading:!1,refetch:c,isOwner:f,isOrgRepl:!0};if(!r)return{authorizations:void 0,loading:!1,refetch:c,isOwner:f,isOrgRepl:!1};if(f){var p,g,m,y,b,w,_,E,R,I,A,P,D,O,N=null==s||null==(O=s.currentUser)?void 0:O.personalOrgAuthorizations;return{authorizations:(null==N?void 0:N.__typename)==="OrgAuthorizations"?N:void 0,loading:!1,refetch:c,isOwner:f,isOrgRepl:!1}}var M=null==s||null==(P=s.replOwner)?void 0:P.paidAgentAuthorization;return(null==M?void 0:M.__typename)==="OrgAuthorization"?{authorizations:{__typename:"OrgAuthorizations",paidAgent:M,freeAgent:T},loading:!1,refetch:c,isOwner:f,isOrgRepl:!1}:{authorizations:void 0,loading:!1,refetch:c,isOwner:f,isOrgRepl:!1}}e.s(["useAgentAuthorization",()=>E],225500);var R=e.i(541793),I=e.i(924908),A=(0,R.atom)(!1),P=function(){return(0,I.useValue)(A)},D=function(){return(0,I.useSet)(A)},O=(0,R.atom)(null),N=function(){return(0,I.useValue)(O)},M=function(){return(0,I.useSet)(O)},L=function(){return null!==(0,I.useValue)(O)};(0,R.atom)(new Set),e.s(["useEditingQueueItemId",()=>N,"useIsEditingQueueItem",()=>L,"useQueueIsOpen",()=>P,"useSetEditingQueueItemId",()=>M,"useSetQueueIsOpen",()=>D],913811)},960791,e=>{e.v({root:"GuestUnauthorizedDialogs-module__cfXoWq__root"})},267473,53617,398462,644881,547450,e=>{"use strict";var t=e.i(297083),n=e.i(817556),r=e.i(276385),i=e.i(596139),o=e.i(973519),a=e.i(500736),s=e.i(128258),l=e.i(446530),u=e.i(613355),c=e.i(140487),d=e.i(929872),f=e.i(960178),p=e.i(625484),h=e.i(693188),g=(0,l.cssRecord)({root:[u.rcss.borderRadius()],buttonContainer:[u.rcss.width("100%"),u.rcss.justify.center],upgradeButton:[u.rcss.width("60%")]});function m(e){var l=e.aiName,u=(0,o.useGlobalModal)().show,m=(0,s.default)(),x=(0,a.useReplUrl)();return(0,r.jsxs)(d.Surface,{elevated:!0,css:g.root,py:8,px:12,gap:8,align:"center",children:[(0,r.jsxs)(f.Text,{children:[l," is currently experiencing high demand and is temporarily unavailable for ",i.freePlanName," plan users."]}),(0,r.jsxs)(f.Text,{children:["Please try again later, or upgrade to ",i.corePlanName," for immediate access."]}),(0,r.jsx)(p.View,{css:g.buttonContainer,row:!0,gap:6,children:(0,r.jsx)(c.Button,{text:"Upgrade to ".concat(i.corePlanName),iconLeft:(0,r.jsx)(h.default,{}),onClick:function(){return(0,t._)(function(){return(0,n._)(this,function(e){switch(e.label){case 0:return[4,u("MembershipPurchaseModal",{analyticsContext:{upgrade:{context:"agent_freemium_quota"}},onPurchaseComplete:function(){return m()},redirectPath:x})];case 1:return e.sent(),[2]}})})()},colorway:"brand",css:g.upgradeButton})})]})}e.s(["FreemiumTemporarilyUnavailable",()=>m],267473);var x=e.i(629536),y=e.i(960791);function b(e){var t=e.aiName;return(0,r.jsx)(d.Surface,{elevated:!0,css:y.default.root,py:8,px:12,gap:8,align:"center",children:(0,r.jsxs)(f.Text,{children:["Guests are not allowed to use ",t," in ",i.freePlanName," Plan user's repls."]})})}function w(){return(0,r.jsx)(d.Surface,{elevated:!0,css:y.default.root,py:8,px:12,gap:8,align:"center",children:(0,r.jsx)(f.Text,{children:"The owner of this app has exceeded their usage limit."})})}function k(){return(0,r.jsx)(d.Surface,{elevated:!0,css:y.default.root,py:8,px:12,gap:8,align:"center",children:(0,r.jsxs)(f.Text,{children:["Your access to ",x.AGENT_NAME," is restricted in this organization."]})})}e.s(["GuestsNotAllowedToUseAgentWhenOrgAuthzFailed",()=>k,"GuestsNotAllowedToUseAgentWhenOwnerAuthzFailed",()=>w,"GuestsNotAllowedToUseAiInStarterPlanRepls",()=>b],53617),e.i(33699);var _=e.i(530658),S=e.i(389959),C=e.i(188507);e.i(877212);var j=e.i(924908);function T(){var e=(0,_._)((0,S.useState)(null),2),t=e[0],n=e[1];return(0,j.useChatHook)("received-completed-event",function(e){var t=e.event;switch(t.error.type){case C.EventErrorType.AI_QUOTA_INSUFFICIENT_BUDGET:case C.EventErrorType.AI_QUOTA_REQUIRES_PAYMENT_METHOD:case C.EventErrorType.AI_QUOTA_REQUIRES_ACTIVE_SUBSCRIPTION:n(t.error);break;default:t.error.type===C.EventErrorType.EVENT_ERROR_TYPE_UNKNOWN&&t.error.message}}),t}e.s(["useSessionError",()=>T],398462);var E=e.i(878420),R=e.i(569384),I=e.i(973245),A=e.i(304277);e.i(566901);var P=e.i(696683);function D(){var e=(0,R._)(["\n  fragment AgentSessionErrorUsageInterval on UsageInterval {\n    endDate\n  }\n"]);return D=function(){return e},e}function O(){var e=(0,R._)(["\n  query AgentSessionError($orgId: String) {\n    currentUser {\n      id\n      usageInterval {\n        ... on UsageInterval {\n          ...AgentSessionErrorUsageInterval\n        }\n        ... on Error {\n          message\n        }\n      }\n      usageBasedBillingAlerts {\n        ...EditUsageBasedBillingAlertsFormInitialConfig\n      }\n      org(orgId: $orgId) {\n        ... on Org {\n          id\n          name\n          usageInterval {\n            ... on UsageInterval {\n              ...AgentSessionErrorUsageInterval\n            }\n            ... on Error {\n              message\n            }\n          }\n          usageBasedBillingAlerts {\n            ...EditUsageBasedBillingAlertsFormInitialConfig\n          }\n        }\n        ... on Error {\n          message\n        }\n      }\n    }\n  }\n  ","\n  ","\n"]);return O=function(){return e},e}var N={},M=(0,I.gql)(D()),L=(0,I.gql)(O(),M,P.EditUsageBasedBillingAlertsFormInitialConfigFragmentDoc),B=e.i(605526),V=e.i(207237),F=e.i(681953),U=e.i(201411),G=e.i(409823),$=e.i(602213),z=e.i(480028),H=e.i(91720),W=e.i(369948),q=e.i(774792),K=e.i(651499),Y=(0,l.cssRecord)({root:[u.rcss.position.relative,u.rcss.p(8),u.rcss.borderRadius(),u.rcss.border({color:z.tokens.outlineDimmest}),u.rcss.colWithGap(4),{containerType:"inline-size"}]});function Q(e){return(0,r.jsxs)(p.View,{row:!0,gap:6,align:"center",children:[(0,r.jsx)($.AgentAvatar,{size:16}),(0,r.jsx)(f.Text,{variant:"subheadDefault",children:e.children})]})}function X(e){return(0,r.jsxs)(d.Surface,{elevated:!0,css:Y.root,children:[(0,r.jsx)(Q,{children:"Youve hit your usage budget"}),(0,r.jsxs)(f.Text,{"data-chromatic":"ignore",children:["Increase your usage budget to continue using Agent now. Otherwise, your usage will reset"," ",e.creditsResetDate?(0,r.jsxs)(r.Fragment,{children:["on ",(0,G.default)(e.creditsResetDate,"MMM do, HH:mm aaa")," "]}):null,"when the next billing period begins."]}),(0,r.jsx)(c.Button,{iconLeft:(0,r.jsx)(K.default,{}),text:"Increase usage budget",colorway:"primary",onClick:e.onIncreaseBudget})]})}function J(e){return(0,r.jsxs)(d.Surface,{css:Y.root,elevated:!0,children:[(0,r.jsx)(Q,{children:"Add a billing method to continue using Agent"}),(0,r.jsx)(f.Text,{children:"Youve used all your monthly creditsyoull need to to add a billing method to pay for additional Agent usage."}),(0,r.jsx)(c.Button,{iconLeft:(0,r.jsx)(q.default,{}),text:"Add billing method",colorway:"primary",onClick:e.onAddBillingMethod})]})}function Z(){return(0,r.jsxs)(d.Surface,{css:Y.root,elevated:!0,children:[(0,r.jsx)(Q,{children:"Your subscription is not active anymore"}),(0,r.jsx)(f.Text,{children:"Your subscription has expired or been canceled. To continue using Agent, make sure your subscription is active."}),(0,r.jsx)(H.ButtonLink,{href:"/pricing",iconRight:(0,r.jsx)(W.default,{}),text:"See pricing",colorway:"primary"})]})}function ee(e){var t=e.error;return(0,r.jsxs)(d.Surface,{css:Y.root,elevated:!0,children:[(0,r.jsx)(Q,{children:"Dev only error"}),(0,r.jsxs)(f.Text,{children:[t.type," - ",t.message]})]})}var et=e.i(739521);function en(e){var t=(0,V.default)(),n=(0,B.useOrgId)(t),i=n.hasError,o=n.orgId,a=(c={variables:{orgId:o},skip:void 0===o||i},d=(0,E._)({},N,c),A.useQuery(L,d)).data;h=o?(null==a||null==(g=a.currentUser)?void 0:g.org.__typename)==="Org"&&"UsageBasedBillingAlertsConfig"===a.currentUser.org.usageBasedBillingAlerts.__typename?a.currentUser.org.usageBasedBillingAlerts:void 0:(null==a||null==(m=a.currentUser)?void 0:m.usageBasedBillingAlerts.__typename)==="UsageBasedBillingAlertsConfig"?a.currentUser.usageBasedBillingAlerts:void 0;var s=(0,_._)((0,S.useState)(null),2),l=s[0],u=s[1];switch(e.error.type){case C.EventErrorType.AI_QUOTA_INSUFFICIENT_BUDGET:var c,d,h,g,m,x,y,b=null==a?void 0:a.currentUser,w=(null==b?void 0:b.org.__typename)==="Org"?b.org:void 0;return(null==w?void 0:w.usageInterval.__typename)==="UsageInterval"?y=new Date(w.usageInterval.endDate):(null==b||null==(x=b.usageInterval)?void 0:x.__typename)==="UsageInterval"&&(y=new Date(b.usageInterval.endDate)),(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(X,{creditsResetDate:y,onIncreaseBudget:function(){return u(C.EventErrorType.AI_QUOTA_INSUFFICIENT_BUDGET)}}),(0,r.jsx)(et.Modal,{isOpen:l===C.EventErrorType.AI_QUOTA_INSUFFICIENT_BUDGET,onRequestClose:function(){return u(null)},children:(0,r.jsx)(U.EditUsageBasedBillingAlertsForm,{org:w,initialSettings:h,onDone:function(){return window.location.reload()}})})]});case C.EventErrorType.AI_QUOTA_REQUIRES_PAYMENT_METHOD:return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(J,{onAddBillingMethod:function(){u(C.EventErrorType.AI_QUOTA_REQUIRES_PAYMENT_METHOD)}}),(0,r.jsx)(et.Modal,{isOpen:l===C.EventErrorType.AI_QUOTA_REQUIRES_PAYMENT_METHOD,onRequestClose:function(){return u(null)},children:(0,r.jsxs)(p.View,{gap:16,children:[(0,r.jsx)(f.Header,{variant:"headerDefault",level:1,children:"Manage Payment"}),(0,r.jsx)(F.AccountPaymentMethodFlow,{})]})})]});case C.EventErrorType.AI_QUOTA_REQUIRES_ACTIVE_SUBSCRIPTION:return(0,r.jsx)(Z,{});default:return(0,r.jsx)(ee,{error:e.error})}}function er(){var e=(0,R._)(["\n  query GetIsGuestInStarterPlanUserRepl($replId: String!) {\n    getRepl(id: $replId) {\n      __typename\n      ... on Repl {\n        id\n        org {\n          __typename\n          id\n        }\n        owner {\n          __typename\n          ... on User {\n            id\n            isSubscribed\n          }\n        }\n        isOwner\n      }\n      ... on Error {\n        message\n      }\n    }\n  }\n"]);return er=function(){return e},e}e.s(["SessionError",()=>en],644881);var ei={},eo=(0,I.gql)(er());function ea(){var e,t,n,r,i=(n={variables:{replId:(0,V.default)()}},r=(0,E._)({},ei,n),A.useQuery(eo,r)).data,o=(null==i?void 0:i.getRepl.__typename)==="Repl"&&null!=(e=i.getRepl.org)&&!!e.id;return(null==i?void 0:i.getRepl.__typename)==="Repl"&&(null==(t=i.getRepl.owner)?void 0:t.__typename)==="User"&&!i.getRepl.owner.isSubscribed&&!i.getRepl.isOwner&&!o}e.s(["useIsGuestInStarterPlanUserRepl",()=>ea],547450)},773403,e=>{e.v({button:"ToggleButton-module__BC3XSG__button"})},754042,e=>{e.v({dragPreview:"QueueItemDragPreview-module__W-UyjW__dragPreview",dragPreviewContent:"QueueItemDragPreview-module__W-UyjW__dragPreviewContent",dragPreviewText:"QueueItemDragPreview-module__W-UyjW__dragPreviewText"})},712709,e=>{e.v({bannerContainer:"QueueDrawer-module__u3MuBG__bannerContainer",compactButton:"QueueDrawer-module__u3MuBG__compactButton",disabled:"QueueDrawer-module__u3MuBG__disabled",dragHandle:"QueueDrawer-module__u3MuBG__dragHandle",dragging:"QueueDrawer-module__u3MuBG__dragging",drawerItems:"QueueDrawer-module__u3MuBG__drawerItems",drawerSurface:"QueueDrawer-module__u3MuBG__drawerSurface",dropIndicatorAbove:"QueueDrawer-module__u3MuBG__dropIndicatorAbove",dropIndicatorBelow:"QueueDrawer-module__u3MuBG__dropIndicatorBelow",expanded:"QueueDrawer-module__u3MuBG__expanded",isDragInteractionDisabled:"QueueDrawer-module__u3MuBG__isDragInteractionDisabled",itemActions:"QueueDrawer-module__u3MuBG__itemActions",itemActionsOverlay:"QueueDrawer-module__u3MuBG__itemActionsOverlay",nonEditedItemInEditMode:"QueueDrawer-module__u3MuBG__nonEditedItemInEditMode",preserveNewlines:"QueueDrawer-module__u3MuBG__preserveNewlines",queueItem:"QueueDrawer-module__u3MuBG__queueItem",queueItemMetadata:"QueueDrawer-module__u3MuBG__queueItemMetadata",queueItemSurface:"QueueDrawer-module__u3MuBG__queueItemSurface",queueItemText:"QueueDrawer-module__u3MuBG__queueItemText",rightText:"QueueDrawer-module__u3MuBG__rightText",titleContainer:"QueueDrawer-module__u3MuBG__titleContainer"})},791378,555829,446152,633975,468142,e=>{"use strict";var t=e.i(276385),n=e.i(389959),r=e.i(629536),i=e.i(140487),o=e.i(929872),a=e.i(960178),s=e.i(625484),l=e.i(616278),u=e.i(483730);function c(e){var c=e.request,d=(e.eventId,e.isResponseInProgress),f=e.onApprove,p=e.onReject,h=(0,n.useCallback)(function(){d||f()},[f,d]),g=(0,n.useCallback)(function(){d||p()},[p,d]),m=r.BLUEPRINT_CONFIGS[c.blueprintName],x=(null==m?void 0:m.displayName)||c.blueprintDisplayName,y=(null==m?void 0:m.description)||"This integration requires confirmation before setup.";return(0,t.jsxs)(o.Surface,{clsx:u.default.dialog,gap:8,elevated:!0,children:[(0,t.jsx)(s.View,{row:!0,justify:"space-between",align:"center",children:(0,t.jsxs)(s.View,{row:!0,gap:8,align:"center",children:[(null==m?void 0:m.icon)?m.icon:null,(0,t.jsxs)(a.Text,{children:["Confirm ",x," Integration"]})]})}),(0,t.jsx)(s.View,{pb:4,pl:2,children:(0,t.jsx)(a.Text,{children:y})}),(0,t.jsxs)(s.View,{row:!0,gap:8,children:[(0,t.jsx)(i.Button,{className:u.default.grow1,text:"Dismiss",disabled:d,onClick:g}),(0,t.jsx)(i.Button,{className:u.default.grow3,colorway:"primary",text:"Approve",iconLeft:(0,t.jsx)(l.default,{}),loading:d,disabled:d,onClick:h})]})]})}e.s(["AgentBlueprintApprovalDialog",()=>c],791378);var d=e.i(297083),f=e.i(721281),p=e.i(878420),h=e.i(64386),g=e.i(530658),m=e.i(817556),x=e.i(546284),y=e.i(529810),b=e.i(274808),w=e.i(480028),k=e.i(446530),_=e.i(613355),S=e.i(136540),C=e.i(607278),j=e.i(739521),T=e.i(283110),E=e.i(841691),R=e.i(90102),I=e.i(530310),A=e.i(42458),P=(0,k.cssRecord)({container:[{animation:"slideUp 0.2s ease-out"},{"@keyframes slideUp":{from:{opacity:0,transform:"scale(0.95)"},to:{opacity:1,transform:"scale(1)"}}},_.rcss.p(8),_.rcss.borderRadius(),_.rcss.backgroundColor.orangeDimmest,_.rcss.border({color:w.tokens.orangeDimmer})],buttons:[_.rcss.flex.wrap],header:[_.rcss.color.orangeStrongest],column:[_.rcss.width("50%")],warning:[_.rcss.color.redStronger],secretsButton:[_.rcss.display.inlineFlex]});function D(e){var r=e.openSecrets,l=(0,g._)((0,n.useState)(!1),2),u=l[0],c=l[1],d=(0,b.useInMessageSecrets)(),f=d.inMessageSecrets,p=d.replaceInMessageSecrets,h=d.dismissInMessageSecrets;return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(o.Surface,{css:P.container,background:"higher",children:(0,t.jsxs)(s.View,{gap:8,children:[(0,t.jsxs)(s.View,{row:!0,gap:4,align:"center",children:[(0,t.jsx)(A.default,{css:P.header,size:16}),(0,t.jsx)(a.Text,{css:P.header,variant:"small",color:"dimmer",children:"Security Warning"})]}),(0,t.jsxs)(a.Text,{variant:"small",children:["The ",(0,x.default)("values",f.length)," you added look like ",f.length>1?"secrets":"a secret",". Store"," ",f.length>1?"them":"it"," securely using our"," ",(0,t.jsx)(i.Button,{css:P.secretsButton,text:"Secrets",colorway:"primary",variant:"underlinedOnHover",size:"small",onClick:r})," ","feature."]}),(0,t.jsxs)(s.View,{css:P.buttons,row:!0,gap:8,align:"center",children:[(0,t.jsx)(i.Button,{text:"Add ".concat((0,x.default)("secret",f.length)),iconLeft:(0,t.jsx)(I.default,{}),loading:u,colorway:"warning",size:"small",onClick:function(){return c(!0)}}),(0,t.jsx)(i.Button,{text:"Dismiss",iconLeft:(0,t.jsx)(T.default,{}),variant:"outlined",colorway:"warning",size:"small",onClick:h})]})]})}),u?(0,t.jsx)(O,{inMessageSecrets:f,onReplace:p,onClose:function(){return c(!1)}}):null]})}function O(e){var r=e.inMessageSecrets,o=e.onReplace,l=e.onClose,u=(0,y.default)().secrets,c=(0,g._)((0,n.useState)(null),2),x=c[0],b=c[1],w=(0,g._)((0,n.useState)(!1),2),k=w[0],_=w[1],C=(0,g._)((0,n.useState)(!1),2),T=C[0],D=C[1],O=(0,g._)((0,n.useState)({}),2),L=O[0],B=O[1];if((0,n.useEffect)(function(){var e=!1;return u.read().then(function(t){e||b(t)}),function(){e=!0}},[u]),r.some(function(e){return!(e.id in L)})){var V={},F=!0,U=!1,G=void 0;try{for(var $,z=r[Symbol.iterator]();!(F=($=z.next()).done);F=!0){var H,W=$.value;V[W.id]={key:(H=W.provider,("Generic API Key"===H||"Generic Secret"===H?null:M(H))||""),value:W.key}}}catch(e){U=!0,G=e}finally{try{F||null==z.return||z.return()}finally{if(U)throw G}}Object.assign(L,(0,p._)({},V,L))}var q=new Set(Object.values(L).map(function(e){return e.key})),K=[];if(Object.values(L).some(function(e){return 0===e.key.length})&&K.push("Key name cannot be empty."),Object.values(L).some(function(e){return 0===e.value.length})&&K.push("Secret value cannot be empty."),q.size!==Object.values(L).length&&K.push("Some key names are duplicates."),x){var Y=!0,Q=!1,X=void 0;try{for(var J,Z=x.keys()[Symbol.iterator]();!(Y=(J=Z.next()).done);Y=!0){var ee=J.value;q.has(ee)&&K.push('Key name "'.concat(ee,'" already exists. Please choose a different name.'))}}catch(e){Q=!0,X=e}finally{try{Y||null==Z.return||Z.return()}finally{if(Q)throw X}}}var et=null===x||K.length>0,en=null===x||T;return(0,t.jsx)(j.Modal,{isOpen:!0,preventClose:!0,onRequestClose:l,children:(0,t.jsxs)(s.View,{gap:12,children:[(0,t.jsxs)(s.View,{gap:8,children:[(0,t.jsxs)(s.View,{row:!0,align:"center",gap:8,children:[(0,t.jsx)(I.default,{}),(0,t.jsx)(a.Text,{children:"Store secret securely"})]}),(0,t.jsx)(a.Text,{color:"dimmer",children:r.length>1?"Add key names for your values.":"Add a key name for your value."})]}),(0,t.jsxs)(s.View,{gap:4,children:[(0,t.jsxs)(s.View,{row:!0,align:"center",children:[(0,t.jsx)(a.Text,{css:P.column,variant:"small",color:"dimmer",children:"Key"}),(0,t.jsxs)(s.View,{css:P.column,row:!0,align:"center",gap:4,pl:4,children:[(0,t.jsx)(a.Text,{variant:"small",color:"dimmer",children:"Value"}),(0,t.jsx)(S.IconButton,{size:18,alt:"Toggle Secret",onClick:function(){return _(function(e){return!e})},tooltipPlacement:"top",children:k?(0,t.jsx)(R.default,{}):(0,t.jsx)(E.default,{})})]})]}),(0,t.jsx)(s.View,{gap:12,children:r.map(function(e){return(0,t.jsx)(N,{name:L[e.id].key,value:L[e.id].value,showContents:k,onChange:function(t,n){B(function(r){return(0,h._)((0,p._)({},r),(0,f._)({},e.id,{key:t,value:n}))})}},e.id)})})]}),K.length?(0,t.jsx)(s.View,{gap:8,children:K.map(function(e,n){return(0,t.jsxs)(s.View,{row:!0,gap:8,align:"center",children:[(0,t.jsx)(A.default,{css:P.warning,size:16}),(0,t.jsx)(a.Text,{css:P.warning,variant:"small",children:e})]},n)})}):null,(0,t.jsxs)(s.View,{row:!0,gap:8,align:"center",justify:"end",children:[(0,t.jsx)(i.Button,{text:"Cancel",onClick:l}),(0,t.jsx)(i.Button,{text:r.length>1?"Add secrets":"Add secret",disabled:et,loading:en,colorway:"primary",onClick:function(){return(0,d._)(function(){var e;return(0,m._)(this,function(t){switch(t.label){case 0:return D(!0),[4,u.addEntries(Array.from(Object.values(L)))];case 1:for(var n in t.sent(),e={},L)e[n]=L[n].key;return D(!1),o(e),l(),[2]}})})()}})]})]})})}function N(e){var n=e.name,r=e.value,i=e.showContents,o=e.onChange;return(0,t.jsxs)(s.View,{row:!0,align:"center",gap:8,children:[(0,t.jsx)(C.Input,{css:P.column,value:n,placeholder:"Enter a key name","aria-label":"Secret key name",onChange:function(e){o(M(e.target.value),r)}}),(0,t.jsx)(C.Input,{css:P.column,style:!r||i?{}:{fontFamily:"text-security-disc"},value:r,placeholder:"Enter a secret value","aria-label":"Secret value",onChange:function(e){o(n,e.target.value)}})]})}function M(e){return e.toUpperCase().replaceAll(/[[,()]/g,"").replaceAll(/\s+/g,"_").replaceAll(/[^A-Z0-9_]/g,"")}e.s(["InMessageSecretsWarning",()=>D],555829);var L=e.i(179302),B=new(e.i(700170)).ReactCompartment(function(e){if(e)return L.EditorView.updateListener.of(function(t){if(t.docChanged&&t.transactions.some(function(e){return e.isUserEvent("input")})){var n=0===t.startState.doc.length,r=0===t.view.state.doc.length;n&&!r&&e.agent.warmup()}})});e.s(["AgentWarmupCompartment",()=>B],446152);var V=e.i(751273),F=e.i(773403);function U(e){var n=e.icon,r=e.tooltip,i=e.onClick,o=e.selected;return(0,t.jsx)(V.Tooltip,{tooltip:r,children:(0,t.jsx)(S.IconButton,{alt:r,tooltipBehavior:"hidden",size:24,onClick:i,filled:!0,colorway:void 0!==o&&o?"yellow":void 0,clsx:F.default.button,children:n})})}e.s(["ToggleButton",()=>U],633975);var G=e.i(822243),$=e.i(848415);e.i(877212);var z=e.i(924908);e.i(84680);var H=e.i(806240);e.i(925218);var W=e.i(267103),q=e.i(641365),K=e.i(222342),Y=e.i(441329),Q=e.i(417120),X=e.i(509908),J=e.i(498596),Z=e.i(971131),ee=e.i(754042),et=(0,n.memo)(function(){var e=(0,J.useDragLayer)(function(e){return{item:e.getItem(),currentOffset:e.getSourceClientOffset(),isDragging:e.isDragging()}}),n=e.isDragging,r=e.item,i=e.currentOffset;if(!n||!r||!i)return null;var o={"--drag-preview-x":i.x+"px","--drag-preview-y":i.y+"px"};return(0,Z.createPortal)((0,t.jsx)(s.View,{clsx:ee.default.dragPreview,style:o,children:(0,t.jsx)(s.View,{align:"center",clsx:ee.default.dragPreviewContent,px:8,py:4,children:(0,t.jsx)(a.Text,{clsx:ee.default.dragPreviewText,color:"default",children:r.content})})}),document.body)}),en=e.i(913811),er=e.i(188507),ei=e.i(165680),eo=e.i(802088),ea=e.i(788124),es=e.i(608263),el=e.i(14007),eu=e.i(576073),ec=e.i(462783),ed=e.i(744895),ef=e.i(906204),ep=e.i(45262),eh=e.i(283023),eg=e.i(861594),em=e.i(363201),ev=e.i(108428),ex=e.i(249622),ey=e.i(140161),eb=e.i(703505),ew=e.i(712709),ek="QueueItem";function e_(e){var r,i,l,u,c=e.isNextInQueue,d=e.item,p=e.index,h=e.onEdit,m=e.onDelete,y=e.onReorder,b=e.onSend,k=e.editingQueueItemId,_=e.isQueueDisabled,C=e.queueHasMultipleItems,j=e.sendIconVariant,E=(0,n.useRef)(null),R=(0,n.useRef)(null),I=(0,n.useRef)(null),A=(0,g._)((0,G.useDrag)({type:ek,item:{type:ek,id:d.id,index:p,content:null==(r=d.contents)?void 0:r.content},collect:function(e){return{isDragging:e.isDragging()}}}),3),P=A[0].isDragging,D=A[1],O=A[2],N=(0,g._)((0,$.useDrop)({accept:ek,drop:function(e){e.index!==p&&y(e.index,p)},collect:function(e){var t=e.getItem(),n=e.isOver();return{isAbove:n&&t&&t.index>p,isBelow:n&&t&&t.index<p}},canDrop:function(){return!0}}),2),M=N[0],L=M.isAbove,B=M.isBelow,F=N[1];if((0,q.useDisableNativeDragPreview)(O),D(R),F(I),!d.contents)return null;var U=null!=(l=null==(i=d.contents.uploadedFiles)?void 0:i.length)?l:0,z=d.contents.targetedElement,W=d.contents.agentConfig,K=!_&&null===k,Y=k===d.id,Q=U>0||z||(null==W?void 0:W.thinkingEnabled)===!0||(null==W?void 0:W.modelProfile)===H.ModelProfile.ADVANCED||(null==W?void 0:W.enableAutomatedTesting)===!0||(null==W?void 0:W.autonomyLevel)===H.AutonomyLevel.MAX;return(0,t.jsxs)(s.View,{py:2,pl:8,pr:8,innerRef:E,align:"center",row:!0,gap:8,clsx:[ew.default.queueItem,(0,f._)({},ew.default.isDragInteractionDisabled,_||!!k||!C)],children:[(0,t.jsx)(s.View,{innerRef:R,clsx:ew.default.dragHandle,children:(0,t.jsx)(ep.default,{})}),(0,t.jsxs)(o.Surface,{elevated:!0,px:8,py:6,clsx:[ew.default.queueItemSurface,(u={},(0,f._)(u,ew.default.dragging,P),(0,f._)(u,ew.default.dropIndicatorAbove,L),(0,f._)(u,ew.default.dropIndicatorBelow,B),(0,f._)(u,ew.default.nonEditedItemInEditMode,k!==d.id&&null!=k),u)],grow:1,shrink:1,row:!0,justify:"space-between",gap:4,innerRef:I,children:[(0,t.jsxs)(s.View,{row:!0,justify:"space-between",align:"start",gap:4,shrink:!0,grow:!0,children:[(0,t.jsxs)(s.View,{clsx:ew.default.queueItemText,gap:4,shrink:!0,children:[(0,t.jsx)(a.Text,{color:"default",clsx:ew.default.preserveNewlines,children:d.contents.content}),Q?(0,t.jsxs)(s.View,{clsx:ew.default.queueItemMetadata,row:!0,gap:8,align:"center",children:[U>0?(0,t.jsx)(V.Tooltip,{tooltip:"".concat(U," file ").concat((0,x.default)("attachment",U)),placement:"bottom-start",children:(0,t.jsxs)(s.View,{row:!0,gap:4,align:"center",children:[(0,t.jsx)(ev.default,{color:w.tokens.foregroundDimmest}),(0,t.jsx)(a.Text,{color:"dimmest",children:U})]})}):null,z?(0,t.jsx)(V.Tooltip,{tooltip:"Selected element",placement:"bottom-start",children:(0,t.jsx)(ey.default,{color:w.tokens.foregroundDimmest,size:16})}):null,(null==W?void 0:W.thinkingEnabled)?(0,t.jsx)(V.Tooltip,{tooltip:"Extended thinking",placement:"bottom-start",children:(0,t.jsx)(el.default,{color:w.tokens.foregroundDimmest,size:16})}):null,(null==W?void 0:W.modelProfile)===H.ModelProfile.ADVANCED?(0,t.jsx)(V.Tooltip,{tooltip:"High power model",placement:"bottom-start",children:(0,t.jsx)(ed.default,{color:w.tokens.foregroundDimmest,size:16})}):null,(null==W?void 0:W.enableAutomatedTesting)?(0,t.jsx)(V.Tooltip,{tooltip:"App testing enabled",placement:"bottom-start",children:(0,t.jsx)(ef.default,{color:w.tokens.foregroundDimmest,size:16})}):null,(null==W?void 0:W.autonomyLevel)===H.AutonomyLevel.MAX?(0,t.jsx)(V.Tooltip,{tooltip:"Max autonomy enabled",placement:"bottom-start",children:(0,t.jsx)(eg.default,{color:w.tokens.foregroundDimmest,size:16})}):null]}):null]}),(0,t.jsxs)(s.View,{clsx:ew.default.rightText,justify:"center",children:[c&&!Y?(0,t.jsx)(a.Text,{variant:"small",color:"dimmest",children:"Next"}):null,Y?(0,t.jsx)(a.Text,{variant:"small",color:"dimmest",children:"Editing"}):null]})]}),K?(0,t.jsx)(s.View,{clsx:ew.default.itemActionsOverlay}):null,K?(0,t.jsxs)(s.View,{clsx:ew.default.itemActions,row:!0,gap:4,children:[(0,t.jsx)(S.IconButton,{alt:"Send message",size:24,onClick:function(){return b(d)},children:"send"===(void 0===j?"send":j)?(0,t.jsx)(ex.default,{color:w.tokens.foregroundDimmer}):(0,t.jsx)(es.default,{color:w.tokens.foregroundDimmer})}),(0,t.jsx)(S.IconButton,{alt:"Edit message",size:24,onClick:function(){return h(d)},children:(0,t.jsx)(eh.default,{color:w.tokens.foregroundDimmer})}),(0,t.jsx)(S.IconButton,{alt:"Delete message",size:24,onClick:function(){return m(d)},children:(0,t.jsx)(T.default,{color:w.tokens.foregroundDimmer})})]}):null]})]})}function eS(e){var l,u=e.items,c=e.editingQueueItemId,d=e.isDisabled,p=e.isOpen,h=e.isAgentWorking,m=e.isInMobileWorkspace,x=e.onEditItem,y=e.onDeleteItem,b=e.onReorderItems,k=e.onSendItem,_=e.onClearQueue,C=e.onClose,j=e.banner,T=(0,g._)((0,n.useState)(!1),2),E=T[0],R=T[1],I=(0,g._)((0,n.useState)(!1),2),A=I[0],P=I[1],D=(0,n.useCallback)(function(){_(),R(!1)},[_]),O=(0,n.useCallback)(function(){P(!A)},[A]);return((0,n.useEffect)(function(){if(p){var e=function(e){"Escape"===e.key&&C()};return document.addEventListener("keydown",e),function(){document.removeEventListener("keydown",e)}}},[p,C]),p)?(0,t.jsx)(t.Fragment,{children:(0,t.jsxs)(o.Surface,{elevated:!0,clsx:[ew.default.drawerSurface,(l={},(0,f._)(l,ew.default.expanded,!A),(0,f._)(l,ew.default.disabled,d),l)],gap:4,pt:8,pb:8*!j,grow:1,shrink:1,children:[(0,t.jsxs)(s.View,{clsx:ew.default.titleContainer,row:!0,gap:4,align:"center",justify:"space-between",pl:4,pr:8,children:[(0,t.jsxs)(s.View,{row:!0,gap:8,align:"center",children:[(0,t.jsx)(V.Tooltip,{tooltip:A?"Expand":"Collapse",children:(0,t.jsx)(S.IconButton,{alt:A?"Expand":"Collapse",size:24,onClick:O,children:A?(0,t.jsx)(ec.default,{}):(0,t.jsx)(eu.default,{})})}),(0,t.jsx)(a.Text,{color:"dimmer",children:r.QUEUE_NAME}),A?(0,t.jsxs)(a.Text,{color:"dimmest",children:["(",u.length," messages)"]}):null,m?null:(0,t.jsx)(V.Tooltip,{tooltip:(0,t.jsxs)("span",{children:["Queued messages will be sent ",(0,t.jsx)("br",{}),"when ",(0,r.getAgentName)()," ",h?"is done working":"resumes work"]}),maxWidth:300,placement:"right",children:(0,t.jsx)(em.default,{size:16,color:w.tokens.foregroundDimmest})})]}),(0,t.jsxs)(s.View,{row:!0,gap:4,pr:4,children:[!A&&E?(0,t.jsxs)(s.View,{row:!0,gap:4,children:[(0,t.jsx)(i.Button,{size:"small",clsx:ew.default.compactButton,text:"Cancel",onClick:function(){return R(!1)}}),(0,t.jsx)(i.Button,{size:"small",clsx:ew.default.compactButton,text:"Clear queue",colorway:"negative",onClick:D})]}):null,!(u.length>0)||A||E?null:(0,t.jsx)(S.IconButton,{alt:"Clear all",size:24,onClick:function(){return R(!0)},tooltipContents:"Clear all",colorway:E?"negative":void 0,children:(0,t.jsx)(eb.default,{color:w.tokens.foregroundDimmer})})]})]}),A?null:(0,t.jsxs)(ea.default,{children:[(0,t.jsx)(et,{}),(0,t.jsx)(s.View,{clsx:ew.default.drawerItems,shrink:!0,gap:4,children:u.map(function(e,n){return(0,t.jsx)(e_,{editingQueueItemId:c,isNextInQueue:0===n,item:e,index:n,onEdit:x,onDelete:y,onReorder:b,onSend:k,isQueueDisabled:d,queueHasMultipleItems:u.length>1,sendIconVariant:"arrow-up"},e.id)})})]}),!A&&j?(0,t.jsx)(s.View,{clsx:ew.default.bannerContainer,children:j}):null]})}):null}function eC(e){var r,i,o,a,s=e.isDisabled,l=e.onEnterEditMode,u=e.sendQueuedMessage,c=e.banner,f=(0,z.useChatter)(),p=(0,W.useObservable)(f.sessions.agent.current),h=null==p?void 0:p.id,g=(0,W.useObservable)(f.queue.state,[]),x=(0,en.useQueueIsOpen)(),y=(0,en.useSetQueueIsOpen)(),b=(0,Y.useIsInMobileWorkspace)(),w=(0,Q.useIsAgentOptimisticallyWorking)(),k=(0,K.default)().showError,_=(0,en.useEditingQueueItemId)();r=(0,Q.useAgentState)().agentState,i=(0,en.useIsEditingQueueItem)(),o=(0,ei.useSetAgentPausedByUser)(),a=(0,n.useRef)(null),(0,eo.useObserver)(r,{next:function(e){if(e){var t=e.state;a.current===er.AgentRunState.AGENT_STATE_RUNNING&&(t===er.AgentRunState.AGENT_STATE_PAUSED||t===er.AgentRunState.AGENT_STATE_NOT_STARTED)&&i&&o(!0),a.current=t}}});var S=(0,n.useCallback)(function(){return(0,d._)(function(){return(0,m._)(this,function(e){switch(e.label){case 0:return[4,f.queue.delete({ids:g.map(function(e){return e.id})})];case 1:return e.sent(),[2]}})})()},[g,f.queue]),C=(0,n.useCallback)(function(e){return(0,d._)(function(){return(0,m._)(this,function(t){switch(t.label){case 0:if(!e.contents)return[2];return[4,f.queue.delete({ids:[e.id]})];case 1:return t.sent().ok?(0,X.trackAgentQueueAnalyticsEvent)({action:"queue_message_deleted",sessionId:h}):k("Failed to delete queued message"),[2]}})})()},[f.queue,k,h]),j=(0,n.useCallback)(function(e,t){return(0,d._)(function(){var n,r,i,o,a;return(0,m._)(this,function(s){switch(s.label){case 0:if(e===t||!(i=g[e]))return[2];return o=t<e,[4,f.queue.reorder({id:i.id,after:null!=(a=o?null==(n=g[t-1])?void 0:n.id:null==(r=g[t])?void 0:r.id)?a:null})];case 1:return s.sent().ok||k("Failed to reorder queued messages"),[2]}})})()},[g,f.queue,k]);return(0,n.useEffect)(function(){g.length>0?y(!0):x&&y(!1)},[g.length,y,x]),(0,n.useEffect)(function(){return function(){y(!1)}},[y]),(0,t.jsx)(eS,{items:g,isDisabled:s,isOpen:x,isAgentWorking:w,isInMobileWorkspace:b,editingQueueItemId:_,onEditItem:l,onDeleteItem:C,onReorderItems:j,onSendItem:u,onClearQueue:S,onClose:function(){return y(!1)},banner:c})}e.s(["QueueDrawer",()=>eC],468142)},506410,(e,t,n)=>{"use strict";var r,i=e.r(365738),o=Symbol.for("react.element"),a=Symbol.for("react.portal"),s=Symbol.for("react.fragment"),l=Symbol.for("react.strict_mode"),u=Symbol.for("react.profiler"),c=Symbol.for("react.provider"),d=Symbol.for("react.context"),f=Symbol.for("react.server_context"),p=Symbol.for("react.forward_ref"),h=Symbol.for("react.suspense"),g=Symbol.for("react.suspense_list"),m=Symbol.for("react.memo"),x=Symbol.for("react.lazy"),y=Symbol.for("react.offscreen");function b(e){if("object"===(void 0===e?"undefined":i._(e))&&null!==e){var t=e.$$typeof;switch(t){case o:switch(e=e.type){case s:case u:case l:case h:case g:return e;default:switch(e=e&&e.$$typeof){case f:case d:case p:case x:case m:case c:return e;default:return t}}case a:return t}}}r=Symbol.for("react.module.reference"),n.ContextConsumer=d,n.ContextProvider=c,n.Element=o,n.ForwardRef=p,n.Fragment=s,n.Lazy=x,n.Memo=m,n.Portal=a,n.Profiler=u,n.StrictMode=l,n.Suspense=h,n.SuspenseList=g,n.isAsyncMode=function(){return!1},n.isConcurrentMode=function(){return!1},n.isContextConsumer=function(e){return b(e)===d},n.isContextProvider=function(e){return b(e)===c},n.isElement=function(e){return"object"===(void 0===e?"undefined":i._(e))&&null!==e&&e.$$typeof===o},n.isForwardRef=function(e){return b(e)===p},n.isFragment=function(e){return b(e)===s},n.isLazy=function(e){return b(e)===x},n.isMemo=function(e){return b(e)===m},n.isPortal=function(e){return b(e)===a},n.isProfiler=function(e){return b(e)===u},n.isStrictMode=function(e){return b(e)===l},n.isSuspense=function(e){return b(e)===h},n.isSuspenseList=function(e){return b(e)===g},n.isValidElementType=function(e){return"string"==typeof e||"function"==typeof e||e===s||e===u||e===l||e===h||e===g||e===y||"object"===(void 0===e?"undefined":i._(e))&&null!==e&&(e.$$typeof===x||e.$$typeof===m||e.$$typeof===c||e.$$typeof===d||e.$$typeof===p||e.$$typeof===r||void 0!==e.getModuleId)||!1},n.typeOf=b},57116,(e,t,n)=>{"use strict";t.exports=e.r(506410)},754686,(e,t,n)=>{var r=e.r(365738),i=1/0,o=/[\\^$.*+?()[\]{}|]/g,a=RegExp(o.source),s="object"==r._(e.g)&&e.g&&e.g.Object===Object&&e.g,l=("undefined"==typeof self?"undefined":r._(self))=="object"&&self&&self.Object===Object&&self,u=s||l||Function("return this")(),c=Object.prototype.toString,d=u.Symbol,f=d?d.prototype:void 0,p=f?f.toString:void 0;t.exports=function(e){var t;return(e=null==(t=e)?"":function(e){if("string"==typeof e)return e;if(function(e){return(void 0===e?"undefined":r._(e))=="symbol"||!!e&&(void 0===e?"undefined":r._(e))=="object"&&"[object Symbol]"==c.call(e)}(e))return p?p.call(e):"";var t=e+"";return"0"==t&&1/e==-i?"-0":t}(t))&&a.test(e)?e.replace(o,"\\$&"):e}},231895,183112,69686,69731,e=>{"use strict";var t,n,r=e.i(297083),i=e.i(904851),o=e.i(90659),a=e.i(817556),s=e.i(276385),l=e.i(72158),u=e.i(179302),c=e.i(928353),d=e.i(700170),f=e.i(992785),p=e.i(753950).Facet.define({combine:function(e){var t;return null!=(t=e[0])?t:[]},compare:f.default}),h=new d.ReactCompartment(function(e){return p.of(e)});e.s(["FileContext",()=>h,"fileContext",()=>p],183112);var g=e.i(721281),m=e.i(167626),x=e.i(878420),y=e.i(64386),b=e.i(530658),w=e.i(389959),k=e.i(790486),_=e.i(625251),S=e.i(413309),C=e.i(32988);function j(e,t){if(null==e)return{};var n,r,i={},o=Object.keys(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||(i[n]=e[n]);return i}function T(){return(T=Object.assign.bind()).apply(this,arguments)}e.i(33699);var E=e.i(203537);e.i(57116);var R=e.i(119468),I=function(e){return"object"==(void 0===e?"undefined":(0,R._)(e))&&null!=e&&1===e.nodeType},A=function(e,t){return(!t||"hidden"!==e)&&"visible"!==e&&"clip"!==e},P=function(e,t){if(e.clientHeight<e.scrollHeight||e.clientWidth<e.scrollWidth){var n,r=getComputedStyle(e,null);return A(r.overflowY,t)||A(r.overflowX,t)||!!(n=function(e){if(!e.ownerDocument||!e.ownerDocument.defaultView)return null;try{return e.ownerDocument.defaultView.frameElement}catch(e){return null}}(e))&&(n.clientHeight<e.scrollHeight||n.clientWidth<e.scrollWidth)}return!1},D=function(e,t,n,r,i,o,a,s){return o<e&&a>t||o>e&&a<t?0:o<=e&&s<=n||a>=t&&s>=n?o-e-r:a>t&&s<n||o<e&&s>n?a-t+i:0},O=function(e){var t=e.parentElement;return null==t?e.getRootNode().host||null:t},N=function(e,t){if("undefined"==typeof document)return[];var n,r,i,o,a,s=t.scrollMode,l=t.block,u=t.inline,c=t.boundary,d=t.skipOverflowHiddenElements,f="function"==typeof c?c:function(e){return e!==c};if(!I(e))throw TypeError("Invalid target");for(var p=document.scrollingElement||document.documentElement,h=[],g=e;I(g)&&f(g);){if((g=O(g))===p){h.push(g);break}null!=g&&g===document.body&&P(g)&&!P(document.documentElement)||null!=g&&P(g,d)&&h.push(g)}for(var m=null!=(i=null==(r=window.visualViewport)?void 0:r.width)?i:innerWidth,x=null!=(a=null==(o=window.visualViewport)?void 0:o.height)?a:innerHeight,y=window.scrollX,b=window.scrollY,w=e.getBoundingClientRect(),k=w.height,_=w.width,S=w.top,C=w.right,j=w.bottom,T=w.left,E={top:parseFloat((n=window.getComputedStyle(e)).scrollMarginTop)||0,right:parseFloat(n.scrollMarginRight)||0,bottom:parseFloat(n.scrollMarginBottom)||0,left:parseFloat(n.scrollMarginLeft)||0},R=E.top,A=E.right,N=E.bottom,M=E.left,L="start"===l||"nearest"===l?S-R:"end"===l?j+N:S+k/2-R+N,B="center"===u?T+_/2-M+A:"end"===u?C+A:T-M,V=[],F=0;F<h.length;F++){var U=h[F],G=U.getBoundingClientRect(),$=G.height,z=G.width,H=G.top,W=G.right,q=G.bottom,K=G.left;if("if-needed"===s&&S>=0&&T>=0&&j<=x&&C<=m&&S>=H&&j<=q&&T>=K&&C<=W)break;var Y=getComputedStyle(U),Q=parseInt(Y.borderLeftWidth,10),X=parseInt(Y.borderTopWidth,10),J=parseInt(Y.borderRightWidth,10),Z=parseInt(Y.borderBottomWidth,10),ee=0,et=0,en="offsetWidth"in U?U.offsetWidth-U.clientWidth-Q-J:0,er="offsetHeight"in U?U.offsetHeight-U.clientHeight-X-Z:0,ei="offsetWidth"in U?0===U.offsetWidth?0:z/U.offsetWidth:0,eo="offsetHeight"in U?0===U.offsetHeight?0:$/U.offsetHeight:0;if(p===U)ee="start"===l?L:"end"===l?L-x:"nearest"===l?D(b,b+x,x,X,Z,b+L,b+L+k,k):L-x/2,et="start"===u?B:"center"===u?B-m/2:"end"===u?B-m:D(y,y+m,m,Q,J,y+B,y+B+_,_),ee=Math.max(0,ee+b),et=Math.max(0,et+y);else{ee="start"===l?L-H-X:"end"===l?L-q+Z+er:"nearest"===l?D(H,q,$,X,Z+er,L,L+k,k):L-(H+$/2)+er/2,et="start"===u?B-K-Q:"center"===u?B-(K+z/2)+en/2:"end"===u?B-W+J+en:D(K,W,z,Q,J+en,B,B+_,_);var ea=U.scrollLeft,es=U.scrollTop;ee=0===eo?0:Math.max(0,Math.min(es+ee/eo,U.scrollHeight-$/eo+er)),et=0===ei?0:Math.max(0,Math.min(ea+et/ei,U.scrollWidth-z/ei+en)),L+=es-ee,B+=ea-et}V.push({el:U,top:ee,left:et})}return V},M=function(){return(M=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};"function"==typeof SuppressedError&&SuppressedError;var L=0;function B(){}function V(e,t,n){return e===t||(0,m._)(t,n.Node)&&e.contains&&e.contains(t)}function F(e,t){var n;function r(){n&&clearTimeout(n)}function i(){for(var i=arguments.length,o=Array(i),a=0;a<i;a++)o[a]=arguments[a];r(),n=setTimeout(function(){n=null,e.apply(void 0,o)},t)}return i.cancel=r,i}function U(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return function(e){for(var n=arguments.length,r=Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];return t.some(function(t){return t&&t.apply(void 0,[e].concat(r)),e.preventDownshiftDefault||e.hasOwnProperty("nativeEvent")&&e.nativeEvent.preventDownshiftDefault})}}function G(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return function(e){t.forEach(function(t){"function"==typeof t?t(e):t&&(t.current=e)})}}function $(e,t){return Object.keys(e).reduce(function(n,r){return n[r]=void 0!==t[r]?t[r]:e[r],n},{})}function z(e){var t=e.key,n=e.keyCode;return n>=37&&n<=40&&0!==t.indexOf("Arrow")?"Arrow"+t:t}function H(e,t,n,r,i){void 0===i&&(i=!1);var o=n.length;if(0===o)return -1;var a=o-1;("number"!=typeof e||e<0||e>a)&&(e=t>0?-1:a+1);var s=e+t;s<0?s=i?a:0:s>a&&(s=i?0:a);var l=W(s,t<0,n,r,i);return -1===l?e>=o?-1:e:l}function W(e,t,n,r,i){void 0===i&&(i=!1);var o=n.length;if(t){for(var a=e;a>=0;a--)if(!r(n[a],a))return a}else for(var s=e;s<o;s++)if(!r(n[s],s))return s;return i?W(t?o-1:0,t,n,r):-1}function q(e,t,n,r){return void 0===r&&(r=!0),n&&t.some(function(t){return t&&(V(t,e,n)||r&&V(t,n.document.activeElement,n))})}var K=F(function(e){Y(e).textContent=""},500);function Y(e){var t=e.getElementById("a11y-status-message");return t||((t=e.createElement("div")).setAttribute("id","a11y-status-message"),t.setAttribute("role","status"),t.setAttribute("aria-live","polite"),t.setAttribute("aria-relevant","additions text"),Object.assign(t.style,{border:"0",clip:"rect(0 0 0 0)",height:"1px",margin:"-1px",overflow:"hidden",padding:"0",position:"absolute",width:"1px"}),e.body.appendChild(t)),t}function Q(e,t){e&&t&&(Y(t).textContent=e,K(t))}var X=["isInitialMount","highlightedIndex","items","environment"],J={highlightedIndex:-1,isOpen:!1,selectedItem:null,inputValue:""},Z=F(function(e,t){Q(e(),t)},200),ee="undefined"!=typeof window&&void 0!==window.document&&void 0!==window.document.createElement?w.useLayoutEffect:w.useEffect,et="useId"in w.default?function(e){var t=e.id,n=e.labelId,r=e.menuId,i=e.getItemId,o=e.toggleButtonId,a=e.inputId,s="downshift-"+w.default.useId();return t||(t=s),(0,w.useRef)({labelId:n||t+"-label",menuId:r||t+"-menu",getItemId:i||function(e){return t+"-item-"+e},toggleButtonId:o||t+"-toggle-button",inputId:a||t+"-input"}).current}:function(e){var t=e.id,n=void 0===t?"downshift-"+String(L++):t,r=e.labelId,i=e.menuId,o=e.getItemId,a=e.toggleButtonId,s=e.inputId;return(0,w.useRef)({labelId:r||n+"-label",menuId:i||n+"-menu",getItemId:o||function(e){return n+"-item-"+e},toggleButtonId:a||n+"-toggle-button",inputId:s||n+"-input"}).current};function en(e,t,n,r){var i,o;if(void 0===e){if(void 0===t)throw Error(r);i=n[t],o=t}else o=void 0===t?n.indexOf(e):t,i=e;return[i,o]}function er(e){return""+e.slice(0,1).toUpperCase()+e.slice(1)}function ei(e){var t=(0,w.useRef)(e);return t.current=e,t}function eo(e,t,n){var r=(0,w.useRef)(),i=(0,w.useRef)(),o=(0,w.useCallback)(function(t,n){i.current=n;var r=e(t=$(t,n.props),n);return n.props.stateReducer(t,T({},n,{changes:r}))},[e]),a=(0,w.useReducer)(o,t,n),s=a[0],l=a[1],u=ei(t),c=(0,w.useCallback)(function(e){return l(T({props:u.current},e))},[u]),d=i.current;return(0,w.useEffect)(function(){var e,t,n,i;d&&r.current&&r.current!==s&&(e=$(r.current,d.props),t=d.props,n=d.type,i={},Object.keys(e).forEach(function(t){var n,r,o,a,l,u,c;n=t,r=d,o=e,a=s,l=r.props,u=r.type,l[c="on"+er(n)+"Change"]&&void 0!==a[n]&&a[n]!==o[n]&&l[c](T({type:u},a)),s[t]!==e[t]&&(i[t]=s[t])}),t.onStateChange&&Object.keys(i).length&&t.onStateChange(T({type:n},i))),r.current=s},[s,t,d]),[s,c]}function ea(e,t,n){var r=eo(e,t,n),i=r[0],o=r[1];return[$(i,t),o]}var es={itemToString:function(e){return e?String(e):""},stateReducer:function(e,t){return t.changes},getA11ySelectionMessage:function(e){var t=e.selectedItem,n=e.itemToString;return t?n(t)+" has been selected.":""},scrollIntoView:function(e,t){e&&N(e,{boundary:t,block:"nearest",scrollMode:"if-needed"}).forEach(function(e){var t=e.el,n=e.top,r=e.left;t.scrollTop=n,t.scrollLeft=r})},environment:"undefined"==typeof window?void 0:window};function el(e,t,n){void 0===n&&(n=J);var r=e["default"+er(t)];return void 0!==r?r:n[t]}function eu(e,t,n){void 0===n&&(n=J);var r=e[t];if(void 0!==r)return r;var i=e["initial"+er(t)];return void 0!==i?i:el(e,t,n)}function ec(e){var t=eu(e,"selectedItem"),n=eu(e,"isOpen"),r=eu(e,"highlightedIndex"),i=eu(e,"inputValue");return{highlightedIndex:r<0&&t&&n?e.items.indexOf(t):r,isOpen:n,selectedItem:t,inputValue:i}}function ed(e,t,n){var r=e.items,i=e.initialHighlightedIndex,o=e.defaultHighlightedIndex,a=t.selectedItem,s=t.highlightedIndex;return 0===r.length?-1:void 0!==i&&s===i?i:void 0!==o?o:a?r.indexOf(a):0===n?-1:n<0?r.length-1:0}function ef(e,t,n,r){var i=(0,w.useRef)({isMouseDown:!1,isTouchMove:!1});return(0,w.useEffect)(function(){if(n){var o=function(){i.current.isMouseDown=!0},a=function(o){i.current.isMouseDown=!1,e&&!q(o.target,t.map(function(e){return e.current}),n)&&r()},s=function(){i.current.isTouchMove=!1},l=function(){i.current.isTouchMove=!0},u=function(o){!e||i.current.isTouchMove||q(o.target,t.map(function(e){return e.current}),n,!1)||r()};return n.addEventListener("mousedown",o),n.addEventListener("mouseup",a),n.addEventListener("touchstart",s),n.addEventListener("touchmove",l),n.addEventListener("touchend",u),function(){n.removeEventListener("mousedown",o),n.removeEventListener("mouseup",a),n.removeEventListener("touchstart",s),n.removeEventListener("touchmove",l),n.removeEventListener("touchend",u)}}},[e,n]),i}var ep=function(){return B};function eh(e,t,n){var r=n.isInitialMount,i=n.highlightedIndex,o=n.items,a=n.environment,s=j(n,X);(0,w.useEffect)(function(){!r&&null!=a&&a.document&&Z(function(){return e(T({highlightedIndex:i,highlightedItem:o[i],resultCount:o.length},s))},a.document)},t)}function eg(e){var t=e.highlightedIndex,n=e.isOpen,r=e.itemRefs,i=e.getItemNodeFromIndex,o=e.menuElement,a=e.scrollIntoView,s=(0,w.useRef)(!0);return ee(function(){!(t<0)&&n&&Object.keys(r.current).length&&(!1===s.current?s.current=!0:a(i(t),o))},[t]),s}function em(e,t,n){void 0===n&&(n=!0);var r,i=(null==(r=e.items)?void 0:r.length)&&t>=0;return T({isOpen:!1,highlightedIndex:-1},i&&T({selectedItem:e.items[t],isOpen:el(e,"isOpen"),highlightedIndex:el(e,"highlightedIndex")},n&&{inputValue:e.itemToString(e.items[t])}))}var ev={environment:E.default.shape({addEventListener:E.default.func.isRequired,removeEventListener:E.default.func.isRequired,document:E.default.shape({createElement:E.default.func.isRequired,getElementById:E.default.func.isRequired,activeElement:E.default.any.isRequired,body:E.default.any.isRequired}).isRequired,Node:E.default.func.isRequired}),itemToString:E.default.func,stateReducer:E.default.func},ex=T({},ev,{getA11yStatusMessage:E.default.func,highlightedIndex:E.default.number,defaultHighlightedIndex:E.default.number,initialHighlightedIndex:E.default.number,isOpen:E.default.bool,defaultIsOpen:E.default.bool,initialIsOpen:E.default.bool,selectedItem:E.default.any,initialSelectedItem:E.default.any,defaultSelectedItem:E.default.any,id:E.default.string,labelId:E.default.string,menuId:E.default.string,getItemId:E.default.func,toggleButtonId:E.default.string,onSelectedItemChange:E.default.func,onHighlightedIndexChange:E.default.func,onStateChange:E.default.func,onIsOpenChange:E.default.func,scrollIntoView:E.default.func});function ey(e,t,n){var r,i=t.type,o=t.props;switch(i){case n.ItemMouseMove:r={highlightedIndex:t.disabled?-1:t.index};break;case n.MenuMouseLeave:r={highlightedIndex:-1};break;case n.ToggleButtonClick:case n.FunctionToggleMenu:r={isOpen:!e.isOpen,highlightedIndex:e.isOpen?-1:ed(o,e,0)};break;case n.FunctionOpenMenu:r={isOpen:!0,highlightedIndex:ed(o,e,0)};break;case n.FunctionCloseMenu:r={isOpen:!1};break;case n.FunctionSetHighlightedIndex:r={highlightedIndex:t.highlightedIndex};break;case n.FunctionSetInputValue:r={inputValue:t.inputValue};break;case n.FunctionReset:r={highlightedIndex:el(o,"highlightedIndex"),isOpen:el(o,"isOpen"),selectedItem:el(o,"selectedItem"),inputValue:el(o,"inputValue")};break;default:throw Error("Reducer called without proper action type.")}return T({},e,r)}M(M({},ex),{items:E.default.array.isRequired,isItemDisabled:E.default.func,getA11ySelectionMessage:E.default.func});var eb=M(M({},es),{getA11yStatusMessage:function(e){var t=e.isOpen,n=e.resultCount,r=e.previousResultCount;return t?n?n!==r?"".concat(n," result").concat(1===n?" is":"s are"," available, use up and down arrow keys to navigate. Press Enter or Space Bar keys to select."):"":"No results are available.":""},isItemDisabled:function(){return!1}}),ew=Object.freeze({__proto__:null,ToggleButtonClick:0,ToggleButtonKeyDownArrowDown:1,ToggleButtonKeyDownArrowUp:2,ToggleButtonKeyDownCharacter:3,ToggleButtonKeyDownEscape:4,ToggleButtonKeyDownHome:5,ToggleButtonKeyDownEnd:6,ToggleButtonKeyDownEnter:7,ToggleButtonKeyDownSpaceButton:8,ToggleButtonKeyDownPageUp:9,ToggleButtonKeyDownPageDown:10,ToggleButtonBlur:11,MenuMouseLeave:12,ItemMouseMove:13,ItemClick:14,FunctionToggleMenu:15,FunctionOpenMenu:16,FunctionCloseMenu:17,FunctionSetHighlightedIndex:18,FunctionSelectItem:19,FunctionSetInputValue:20,FunctionReset:21});function ek(e,t){var n,r,i=t.type,o=t.props,a=t.altKey;switch(i){case 14:r={isOpen:el(o,"isOpen"),highlightedIndex:el(o,"highlightedIndex"),selectedItem:o.items[t.index]};break;case 3:var s=t.key,l=""+e.inputValue+s,u=function(e){for(var t=e.keysSoFar,n=e.highlightedIndex,r=e.items,i=e.itemToString,o=e.isItemDisabled,a=t.toLowerCase(),s=0;s<r.length;s++){var l=(s+n+ +(t.length<2))%r.length,u=r[l];if(void 0!==u&&i(u).toLowerCase().startsWith(a)&&!o(u,l))return l}return n}({keysSoFar:l,highlightedIndex:!e.isOpen&&e.selectedItem?o.items.indexOf(e.selectedItem):e.highlightedIndex,items:o.items,itemToString:o.itemToString,isItemDisabled:o.isItemDisabled});r={inputValue:l,highlightedIndex:u,isOpen:!0};break;case 1:r={highlightedIndex:e.isOpen?H(e.highlightedIndex,1,o.items,o.isItemDisabled):a&&null==e.selectedItem?-1:ed(o,e,1),isOpen:!0};break;case 2:r=e.isOpen&&a?em(o,e.highlightedIndex,!1):{highlightedIndex:e.isOpen?H(e.highlightedIndex,-1,o.items,o.isItemDisabled):ed(o,e,-1),isOpen:!0};break;case 7:case 8:r=em(o,e.highlightedIndex,!1);break;case 5:r={highlightedIndex:W(0,!1,o.items,o.isItemDisabled),isOpen:!0};break;case 6:r={highlightedIndex:W(o.items.length-1,!0,o.items,o.isItemDisabled),isOpen:!0};break;case 9:r={highlightedIndex:H(e.highlightedIndex,-10,o.items,o.isItemDisabled)};break;case 10:r={highlightedIndex:H(e.highlightedIndex,10,o.items,o.isItemDisabled)};break;case 4:r={isOpen:!1,highlightedIndex:-1};break;case 11:r=T({isOpen:!1,highlightedIndex:-1},e.highlightedIndex>=0&&(null==(n=o.items)?void 0:n.length)&&{selectedItem:o.items[e.highlightedIndex]});break;case 19:r={selectedItem:t.selectedItem};break;default:return ey(e,t,ew)}return T({},e,r)}var e_=["onMouseLeave","refKey","ref"],eS=["onBlur","onClick","onPress","onKeyDown","refKey","ref"],eC=["item","index","onMouseMove","onClick","onMouseDown","onPress","refKey","disabled","ref"];function ej(e){void 0===e&&(e={}),B(e,ej);var t=T({},eb,e),n=t.items,r=t.scrollIntoView,i=t.environment,o=t.itemToString,a=t.getA11ySelectionMessage,s=t.getA11yStatusMessage,l=ea(ek,t,ec),u=l[0],c=l[1],d=u.isOpen,f=u.highlightedIndex,p=u.selectedItem,h=u.inputValue,g=(0,w.useRef)(null),m=(0,w.useRef)(null),x=(0,w.useRef)({}),y=(0,w.useRef)(null),b=et(t),k=(0,w.useRef)(),_=(0,w.useRef)(!0),S=ei({state:u,props:t}),C=(0,w.useCallback)(function(e){return x.current[b.getItemId(e)]},[b]);eh(s,[d,f,h,n],T({isInitialMount:_.current,previousResultCount:k.current,items:n,environment:i,itemToString:o},u)),eh(a,[p],T({isInitialMount:_.current,previousResultCount:k.current,items:n,environment:i,itemToString:o},u));var E=eg({menuElement:m.current,highlightedIndex:f,isOpen:d,itemRefs:x,scrollIntoView:r,getItemNodeFromIndex:C});(0,w.useEffect)(function(){return y.current=F(function(e){e({type:20,inputValue:""})},500),function(){y.current.cancel()}},[]),(0,w.useEffect)(function(){h&&y.current(c)},[c,h]),B({isInitialMount:_.current,props:t,state:u}),(0,w.useEffect)(function(){_.current||(k.current=n.length)}),(0,w.useEffect)(function(){eu(t,"isOpen")&&g.current&&g.current.focus()},[]);var R=ef(d,[m,g],i,function(){c({type:11})}),I=ep("getMenuProps","getToggleButtonProps");(0,w.useEffect)(function(){return _.current=!1,function(){_.current=!0}},[]),(0,w.useEffect)(function(){d||(x.current={})},[d]);var A=(0,w.useMemo)(function(){return{ArrowDown:function(e){e.preventDefault(),c({type:1,altKey:e.altKey})},ArrowUp:function(e){e.preventDefault(),c({type:2,altKey:e.altKey})},Home:function(e){e.preventDefault(),c({type:5})},End:function(e){e.preventDefault(),c({type:6})},Escape:function(){S.current.state.isOpen&&c({type:4})},Enter:function(e){e.preventDefault(),c({type:7*!!S.current.state.isOpen})},PageUp:function(e){S.current.state.isOpen&&(e.preventDefault(),c({type:9}))},PageDown:function(e){S.current.state.isOpen&&(e.preventDefault(),c({type:10}))}," ":function(e){e.preventDefault();var t=S.current.state;t.isOpen?t.inputValue?c({type:3,key:" "}):c({type:8}):c({type:0})}}},[c,S]),P=(0,w.useCallback)(function(){c({type:15})},[c]),D=(0,w.useCallback)(function(){c({type:17})},[c]),O=(0,w.useCallback)(function(){c({type:16})},[c]),N=(0,w.useCallback)(function(e){c({type:18,highlightedIndex:e})},[c]),M=(0,w.useCallback)(function(e){c({type:19,selectedItem:e})},[c]),L=(0,w.useCallback)(function(){c({type:21})},[c]),V=(0,w.useCallback)(function(e){c({type:20,inputValue:e})},[c]),$=(0,w.useCallback)(function(e){return T({id:b.labelId,htmlFor:b.toggleButtonId},e)},[b]),H=(0,w.useCallback)(function(e,t){var n,r=void 0===e?{}:e,i=r.onMouseLeave,o=r.refKey,a=void 0===o?"ref":o,s=r.ref,l=j(r,e_),u=(void 0===t?{}:t).suppressRefError;return I("getMenuProps",void 0!==u&&u,a,m),T(((n={})[a]=G(s,function(e){m.current=e}),n.id=b.menuId,n.role="listbox",n["aria-labelledby"]=l&&l["aria-label"]?void 0:""+b.labelId,n.onMouseLeave=U(i,function(){c({type:12})}),n),l)},[c,I,b]);return{getToggleButtonProps:(0,w.useCallback)(function(e,t){var n,r=void 0===e?{}:e,i=r.onBlur,o=r.onClick;r.onPress;var a=r.onKeyDown,s=r.refKey,l=void 0===s?"ref":s,u=r.ref,d=j(r,eS),f=(void 0===t?{}:t).suppressRefError,p=S.current.state,h=T(((n={})[l]=G(u,function(e){g.current=e}),n["aria-activedescendant"]=p.isOpen&&p.highlightedIndex>-1?b.getItemId(p.highlightedIndex):"",n["aria-controls"]=b.menuId,n["aria-expanded"]=S.current.state.isOpen,n["aria-haspopup"]="listbox",n["aria-labelledby"]=d&&d["aria-label"]?void 0:""+b.labelId,n.id=b.toggleButtonId,n.role="combobox",n.tabIndex=0,n.onBlur=U(i,function(){p.isOpen&&!R.current.isMouseDown&&c({type:11})}),n),d);return d.disabled||(h.onClick=U(o,function(){c({type:0})}),h.onKeyDown=U(a,function(e){var t=z(e);t&&A[t]?A[t](e):/^\S{1}$/.test(t)&&c({type:3,key:t})})),I("getToggleButtonProps",void 0!==f&&f,l,g),h},[S,b,I,c,R,A]),getLabelProps:$,getMenuProps:H,getItemProps:(0,w.useCallback)(function(e){var t,n=void 0===e?{}:e,r=n.item,i=n.index,o=n.onMouseMove,a=n.onClick,s=n.onMouseDown;n.onPress;var l=n.refKey,u=n.disabled,d=n.ref,f=j(n,eC);void 0!==u&&console.warn('Passing "disabled" as an argument to getItemProps is not supported anymore. Please use the isItemDisabled prop from useSelect.');var p=S.current,h=p.state,g=p.props,m=en(r,i,g.items,"Pass either item or index to getItemProps!"),y=m[0],w=m[1],k=g.isItemDisabled(y,w),_=T(((t={})[void 0===l?"ref":l]=G(d,function(e){e&&(x.current[b.getItemId(w)]=e)}),t["aria-disabled"]=k,t["aria-selected"]=""+(y===h.selectedItem),t.id=b.getItemId(w),t.role="option",t),f);return k||(_.onClick=U(a,function(){c({type:14,index:w})})),_.onMouseMove=U(o,function(){w!==h.highlightedIndex&&(E.current=!1,c({type:13,index:w,disabled:k}))}),_.onMouseDown=U(s,function(e){return e.preventDefault()}),_},[S,b,E,c]),toggleMenu:P,openMenu:O,closeMenu:D,setHighlightedIndex:N,selectItem:M,reset:L,setInputValue:V,highlightedIndex:f,isOpen:d,selectedItem:p,inputValue:h}}ej.stateChangeTypes=ew;var eT=Object.freeze({__proto__:null,InputKeyDownArrowDown:0,InputKeyDownArrowUp:1,InputKeyDownEscape:2,InputKeyDownHome:3,InputKeyDownEnd:4,InputKeyDownPageUp:5,InputKeyDownPageDown:6,InputKeyDownEnter:7,InputChange:8,InputBlur:9,InputClick:10,MenuMouseLeave:11,ItemMouseMove:12,ItemClick:13,ToggleButtonClick:14,FunctionToggleMenu:15,FunctionOpenMenu:16,FunctionCloseMenu:17,FunctionSetHighlightedIndex:18,FunctionSelectItem:19,FunctionSetInputValue:20,FunctionReset:21,ControlledPropUpdatedSelectedItem:22});function eE(e){var t=ec(e),n=t.selectedItem,r=t.inputValue;return""===r&&n&&void 0===e.defaultInputValue&&void 0===e.initialInputValue&&void 0===e.inputValue&&(r=e.itemToString(n)),T({},t,{inputValue:r})}T({},ex,{items:E.default.array.isRequired,isItemDisabled:E.default.func,selectedItemChanged:E.default.func,getA11ySelectionMessage:E.default.func,inputValue:E.default.string,defaultInputValue:E.default.string,initialInputValue:E.default.string,inputId:E.default.string,onInputValueChange:E.default.func});var eR=T({},es,{selectedItemChanged:function(e,t){return e!==t},getA11yStatusMessage:function(e){var t=e.isOpen,n=e.resultCount,r=e.previousResultCount;return t?n?n!==r?n+" result"+(1===n?" is":"s are")+" available, use up and down arrow keys to navigate. Press Enter key to select.":"":"No results are available.":""},isItemDisabled:function(){return!1}});function eI(e,t){var n,r,i=t.type,o=t.props,a=t.altKey;switch(i){case 13:r={isOpen:el(o,"isOpen"),highlightedIndex:el(o,"highlightedIndex"),selectedItem:o.items[t.index],inputValue:o.itemToString(o.items[t.index])};break;case 0:r=e.isOpen?{highlightedIndex:H(e.highlightedIndex,1,o.items,o.isItemDisabled,!0)}:{highlightedIndex:a&&null==e.selectedItem?-1:ed(o,e,1),isOpen:o.items.length>=0};break;case 1:r=e.isOpen?a?em(o,e.highlightedIndex):{highlightedIndex:H(e.highlightedIndex,-1,o.items,o.isItemDisabled,!0)}:{highlightedIndex:ed(o,e,-1),isOpen:o.items.length>=0};break;case 7:r=em(o,e.highlightedIndex);break;case 2:r=T({isOpen:!1,highlightedIndex:-1},!e.isOpen&&{selectedItem:null,inputValue:""});break;case 5:r={highlightedIndex:H(e.highlightedIndex,-10,o.items,o.isItemDisabled,!0)};break;case 6:r={highlightedIndex:H(e.highlightedIndex,10,o.items,o.isItemDisabled,!0)};break;case 3:r={highlightedIndex:W(0,!1,o.items,o.isItemDisabled)};break;case 4:r={highlightedIndex:W(o.items.length-1,!0,o.items,o.isItemDisabled)};break;case 9:r=T({isOpen:!1,highlightedIndex:-1},e.highlightedIndex>=0&&(null==(n=o.items)?void 0:n.length)&&t.selectItem&&{selectedItem:o.items[e.highlightedIndex],inputValue:o.itemToString(o.items[e.highlightedIndex])});break;case 8:r={isOpen:!0,highlightedIndex:el(o,"highlightedIndex"),inputValue:t.inputValue};break;case 10:r={isOpen:!e.isOpen,highlightedIndex:e.isOpen?-1:ed(o,e,0)};break;case 19:r={selectedItem:t.selectedItem,inputValue:o.itemToString(t.selectedItem)};break;case 22:r={inputValue:t.inputValue};break;default:return ey(e,t,eT)}return T({},e,r)}var eA=["onMouseLeave","refKey","ref"],eP=["item","index","refKey","ref","onMouseMove","onMouseDown","onClick","onPress","disabled"],eD=["onClick","onPress","refKey","ref"],eO=["onKeyDown","onChange","onInput","onBlur","onChangeText","onClick","refKey","ref"];function eN(e){void 0===e&&(e={}),B(e,eN);var t,n,r,i,o=T({},eR,e),a=o.items,s=o.scrollIntoView,l=o.environment,u=o.getA11yStatusMessage,c=o.getA11ySelectionMessage,d=o.itemToString,f=(t=(0,w.useRef)(),r=(n=eo(eI,o,eE))[0],i=n[1],(0,w.useEffect)(function(){void 0!==o.selectedItem&&(o.selectedItemChanged(t.current,o.selectedItem)&&i({type:22,inputValue:o.itemToString(o.selectedItem)}),t.current=r.selectedItem===t.current?o.selectedItem:r.selectedItem)},[r.selectedItem,o.selectedItem]),[$(r,o),i]),p=f[0],h=f[1],g=p.isOpen,m=p.highlightedIndex,x=p.selectedItem,y=p.inputValue,b=(0,w.useRef)(null),k=(0,w.useRef)({}),_=(0,w.useRef)(null),S=(0,w.useRef)(null),C=(0,w.useRef)(!0),E=et(o),R=(0,w.useRef)(),I=ei({state:p,props:o}),A=(0,w.useCallback)(function(e){return k.current[E.getItemId(e)]},[E]);eh(u,[g,m,y,a],T({isInitialMount:C.current,previousResultCount:R.current,items:a,environment:l,itemToString:d},p)),eh(c,[x],T({isInitialMount:C.current,previousResultCount:R.current,items:a,environment:l,itemToString:d},p));var P=eg({menuElement:b.current,highlightedIndex:m,isOpen:g,itemRefs:k,scrollIntoView:s,getItemNodeFromIndex:A});B({isInitialMount:C.current,props:o,state:p}),(0,w.useEffect)(function(){eu(o,"isOpen")&&_.current&&_.current.focus()},[]),(0,w.useEffect)(function(){C.current||(R.current=a.length)});var D=ef(g,[_,b,S],l,function(){h({type:9,selectItem:!1})}),O=ep("getInputProps","getMenuProps");(0,w.useEffect)(function(){return C.current=!1,function(){C.current=!0}},[]),(0,w.useEffect)(function(){g||(k.current={})},[g]),(0,w.useEffect)(function(){var e;g&&null!=l&&l.document&&null!=_&&null!=(e=_.current)&&e.focus&&l.document.activeElement!==_.current&&_.current.focus()},[g,l]);var N=(0,w.useMemo)(function(){return{ArrowDown:function(e){e.preventDefault(),h({type:0,altKey:e.altKey})},ArrowUp:function(e){e.preventDefault(),h({type:1,altKey:e.altKey})},Home:function(e){I.current.state.isOpen&&(e.preventDefault(),h({type:3}))},End:function(e){I.current.state.isOpen&&(e.preventDefault(),h({type:4}))},Escape:function(e){var t=I.current.state;(t.isOpen||t.inputValue||t.selectedItem||t.highlightedIndex>-1)&&(e.preventDefault(),h({type:2}))},Enter:function(e){I.current.state.isOpen&&229!==e.which&&(e.preventDefault(),h({type:7}))},PageUp:function(e){I.current.state.isOpen&&(e.preventDefault(),h({type:5}))},PageDown:function(e){I.current.state.isOpen&&(e.preventDefault(),h({type:6}))}}},[h,I]),M=(0,w.useCallback)(function(e){return T({id:E.labelId,htmlFor:E.inputId},e)},[E]),L=(0,w.useCallback)(function(e,t){var n,r=void 0===e?{}:e,i=r.onMouseLeave,o=r.refKey,a=void 0===o?"ref":o,s=r.ref,l=j(r,eA),u=(void 0===t?{}:t).suppressRefError;return O("getMenuProps",void 0!==u&&u,a,b),T(((n={})[a]=G(s,function(e){b.current=e}),n.id=E.menuId,n.role="listbox",n["aria-labelledby"]=l&&l["aria-label"]?void 0:""+E.labelId,n.onMouseLeave=U(i,function(){h({type:11})}),n),l)},[h,O,E]),V=(0,w.useCallback)(function(e){var t,n,r=void 0===e?{}:e,i=r.item,o=r.index,a=r.refKey,s=r.ref,l=r.onMouseMove,u=r.onMouseDown,c=r.onClick;r.onPress;var d=r.disabled,f=j(r,eP);void 0!==d&&console.warn('Passing "disabled" as an argument to getItemProps is not supported anymore. Please use the isItemDisabled prop from useCombobox.');var p=I.current,g=p.props,m=p.state,x=en(i,o,g.items,"Pass either item or index to getItemProps!"),y=x[0],b=x[1],w=g.isItemDisabled(y,b);return T(((t={})[void 0===a?"ref":a]=G(s,function(e){e&&(k.current[E.getItemId(b)]=e)}),t["aria-disabled"]=w,t["aria-selected"]=""+(b===m.highlightedIndex),t.id=E.getItemId(b),t.role="option",t),!w&&((n={}).onClick=U(c,function(){h({type:13,index:b})}),n),{onMouseMove:U(l,function(){b!==m.highlightedIndex&&(P.current=!1,h({type:12,index:b,disabled:w}))}),onMouseDown:U(u,function(e){return e.preventDefault()})},f)},[h,I,P,E]),F=(0,w.useCallback)(function(e){var t,n=void 0===e?{}:e,r=n.onClick;n.onPress;var i=n.refKey,o=n.ref,a=j(n,eD),s=I.current.state;return T(((t={})[void 0===i?"ref":i]=G(o,function(e){S.current=e}),t["aria-controls"]=E.menuId,t["aria-expanded"]=s.isOpen,t.id=E.toggleButtonId,t.tabIndex=-1,t),!a.disabled&&T({},{onClick:U(r,function(){h({type:14})})}),a)},[h,I,E]),H=(0,w.useCallback)(function(e,t){var n,r,i=void 0===e?{}:e,o=i.onKeyDown,a=i.onChange,s=i.onInput,u=i.onBlur;i.onChangeText;var c=i.onClick,d=i.refKey,f=void 0===d?"ref":d,p=i.ref,g=j(i,eO),m=(void 0===t?{}:t).suppressRefError;O("getInputProps",void 0!==m&&m,f,_);var x=I.current.state,y={};return g.disabled||((r={}).onChange=U(a,s,function(e){h({type:8,inputValue:e.target.value})}),r.onKeyDown=U(o,function(e){var t=z(e);t&&N[t]&&N[t](e)}),r.onBlur=U(u,function(e){null!=l&&l.document&&x.isOpen&&!D.current.isMouseDown&&h({type:9,selectItem:null!==e.relatedTarget||l.document.activeElement===l.document.body})}),r.onClick=U(c,function(){h({type:10})}),y=r),T(((n={})[f]=G(p,function(e){_.current=e}),n["aria-activedescendant"]=x.isOpen&&x.highlightedIndex>-1?E.getItemId(x.highlightedIndex):"",n["aria-autocomplete"]="list",n["aria-controls"]=E.menuId,n["aria-expanded"]=x.isOpen,n["aria-labelledby"]=g&&g["aria-label"]?void 0:E.labelId,n.autoComplete="off",n.id=E.inputId,n.role="combobox",n.value=x.inputValue,n),y,g)},[O,I,E,N,h,D,l]),W=(0,w.useCallback)(function(){h({type:15})},[h]),q=(0,w.useCallback)(function(){h({type:17})},[h]),K=(0,w.useCallback)(function(){h({type:16})},[h]),Y=(0,w.useCallback)(function(e){h({type:18,highlightedIndex:e})},[h]),Q=(0,w.useCallback)(function(e){h({type:19,selectedItem:e})},[h]);return{getItemProps:V,getLabelProps:M,getMenuProps:L,getInputProps:H,getToggleButtonProps:F,toggleMenu:W,openMenu:K,closeMenu:q,setHighlightedIndex:Y,setInputValue:(0,w.useCallback)(function(e){h({type:20,inputValue:e})},[h]),selectItem:Q,reset:(0,w.useCallback)(function(){h({type:21})},[h]),highlightedIndex:m,isOpen:g,selectedItem:x,inputValue:y}}eN.stateChangeTypes=eT;var eM={activeIndex:-1,selectedItems:[]};function eL(e){return{activeIndex:eu(e,"activeIndex",eM),selectedItems:eu(e,"selectedItems",eM)}}function eB(e){if(e.shiftKey||e.metaKey||e.ctrlKey||e.altKey)return!1;var t=e.target;return!(0,m._)(t,HTMLInputElement)||""===t.value||0===t.selectionStart&&0===t.selectionEnd}T({},ev,{selectedItems:E.default.array,initialSelectedItems:E.default.array,defaultSelectedItems:E.default.array,getA11yRemovalMessage:E.default.func,activeIndex:E.default.number,initialActiveIndex:E.default.number,defaultActiveIndex:E.default.number,onActiveIndexChange:E.default.func,onSelectedItemsChange:E.default.func,keyNavigationNext:E.default.string,keyNavigationPrevious:E.default.string});var eV={itemToString:es.itemToString,stateReducer:es.stateReducer,environment:es.environment,getA11yRemovalMessage:function(e){var t=e.removedSelectedItem;return(0,e.itemToString)(t)+" has been removed."},keyNavigationNext:"ArrowRight",keyNavigationPrevious:"ArrowLeft"},eF=Object.freeze({__proto__:null,SelectedItemClick:0,SelectedItemKeyDownDelete:1,SelectedItemKeyDownBackspace:2,SelectedItemKeyDownNavigationNext:3,SelectedItemKeyDownNavigationPrevious:4,DropdownKeyDownNavigationPrevious:5,DropdownKeyDownBackspace:6,DropdownClick:7,FunctionAddSelectedItem:8,FunctionRemoveSelectedItem:9,FunctionSetSelectedItems:10,FunctionSetActiveIndex:11,FunctionReset:12});function eU(e,t){var n,r=t.type,i=t.index,o=t.props,a=t.selectedItem,s=e.activeIndex,l=e.selectedItems;switch(r){case 0:n={activeIndex:i};break;case 4:n={activeIndex:s-1<0?0:s-1};break;case 3:n={activeIndex:s+1>=l.length?-1:s+1};break;case 2:case 1:if(s<0)break;var u=s;1===l.length?u=-1:s===l.length-1&&(u=l.length-2),n=T({selectedItems:[].concat(l.slice(0,s),l.slice(s+1))},{activeIndex:u});break;case 5:n={activeIndex:l.length-1};break;case 6:n={selectedItems:l.slice(0,l.length-1)};break;case 8:n={selectedItems:[].concat(l,[a])};break;case 7:n={activeIndex:-1};break;case 9:var c=s,d=l.indexOf(a);if(d<0)break;1===l.length?c=-1:d===l.length-1&&(c=l.length-2),n={selectedItems:[].concat(l.slice(0,d),l.slice(d+1)),activeIndex:c};break;case 10:n={selectedItems:t.selectedItems};break;case 11:n={activeIndex:t.activeIndex};break;case 12:n={activeIndex:el(o,"activeIndex",eM),selectedItems:el(o,"selectedItems",eM)};break;default:throw Error("Reducer called without proper action type.")}return T({},e,n)}var eG=["refKey","ref","onClick","onKeyDown","selectedItem","index"],e$=["refKey","ref","onKeyDown","onClick","preventKeyAction"];function ez(e){void 0===e&&(e={}),B(e,ez);var t=T({},eV,e),n=t.getA11yRemovalMessage,r=t.itemToString,i=t.environment,o=t.keyNavigationNext,a=t.keyNavigationPrevious,s=ea(eU,t,eL),l=s[0],u=s[1],c=l.activeIndex,d=l.selectedItems,f=(0,w.useRef)(!0),p=(0,w.useRef)(null),h=(0,w.useRef)(d),g=(0,w.useRef)();g.current=[];var m=ei({state:l,props:t});(0,w.useEffect)(function(){if(!f.current&&null!=i&&i.document){if(d.length<h.current.length){var e=h.current.find(function(e){return 0>d.indexOf(e)});Q(n({itemToString:r,resultCount:d.length,removedSelectedItem:e,activeIndex:c,activeSelectedItem:d[c]}),i.document)}h.current=d}},[d.length]),(0,w.useEffect)(function(){!f.current&&(-1===c&&p.current?p.current.focus():g.current[c]&&g.current[c].focus())},[c]),B({isInitialMount:f.current,props:t,state:l});var x=ep("getDropdownProps");(0,w.useEffect)(function(){return f.current=!1,function(){f.current=!0}},[]);var y=(0,w.useMemo)(function(){var e;return(e={})[a]=function(){u({type:4})},e[o]=function(){u({type:3})},e.Delete=function(){u({type:1})},e.Backspace=function(){u({type:2})},e},[u,o,a]),b=(0,w.useMemo)(function(){var e;return(e={})[a]=function(e){eB(e)&&u({type:5})},e.Backspace=function(e){eB(e)&&u({type:6})},e},[u,a]);return{getSelectedItemProps:(0,w.useCallback)(function(e){var t,n=void 0===e?{}:e,r=n.refKey,i=n.ref,o=n.onClick,a=n.onKeyDown,s=n.selectedItem,l=n.index,c=j(n,eG),d=m.current.state,f=en(s,l,d.selectedItems,"Pass either item or index to getSelectedItemProps!")[1],p=f>-1&&f===d.activeIndex;return T(((t={})[void 0===r?"ref":r]=G(i,function(e){e&&g.current.push(e)}),t.tabIndex=p?0:-1,t.onClick=U(o,function(){u({type:0,index:f})}),t.onKeyDown=U(a,function(e){var t=z(e);t&&y[t]&&y[t](e)}),t),c)},[u,m,y]),getDropdownProps:(0,w.useCallback)(function(e,t){var n,r=void 0===e?{}:e,i=r.refKey,o=void 0===i?"ref":i,a=r.ref,s=r.onKeyDown,l=r.onClick,c=r.preventKeyAction,d=j(r,e$),f=(void 0===t?{}:t).suppressRefError;return x("getDropdownProps",void 0!==f&&f,o,p),T(((n={})[o]=G(a,function(e){e&&(p.current=e)}),n),!(void 0!==c&&c)&&{onKeyDown:U(s,function(e){var t=z(e);t&&b[t]&&b[t](e)}),onClick:U(l,function(){u({type:7})})},d)},[u,b,x]),addSelectedItem:(0,w.useCallback)(function(e){u({type:8,selectedItem:e})},[u]),removeSelectedItem:(0,w.useCallback)(function(e){u({type:9,selectedItem:e})},[u]),setSelectedItems:(0,w.useCallback)(function(e){u({type:10,selectedItems:e})},[u]),setActiveIndex:(0,w.useCallback)(function(e){u({type:11,activeIndex:e})},[u]),reset:(0,w.useCallback)(function(){u({type:12})},[u]),selectedItems:d,activeIndex:c}}ez.stateChangeTypes=eF;var eH=e.i(131141),eW=e.i(629536),eq=e.i(644920),eK=e.i(205104),eY=e.i(98816),eQ=e.i(568817),eX=e.i(973519),eJ=e.i(480028),eZ=e.i(446530),e0=e.i(613355),e1=(0,eZ.cssRecord)({popover:[e0.rcss.borderRadius(4),e0.rcss.border({color:eJ.tokens.outlineDefault}),e0.rcss.overflow("hidden"),e0.rcss.maxWidth(290)]}),e2=e.i(292849),e3=e.i(754873),e4=e.i(123850),e8=e.i(140487),e5=e.i(607278),e6=e.i(630818),e9=e.i(396776),e7=e.i(552144),te=e.i(929872),tt=e.i(960178),tn=e.i(751273),tr=e.i(625484),ti=e.i(290446),to=e.i(616278),ta=e.i(243074),ts=e.i(504940),tl=e.i(940745),tu=e.i(793579),tc=e.i(212042),td=e.i(467185),tf=e.i(42458),tp=(0,eZ.cssRecord)({root:[e3.interactive.listItem,e0.rcss.p(4),e0.rcss.colWithGap(2)],left:[{fontSize:eJ.tokens.fontSizeSmall}],warning:[{color:eJ.tokens.accentNegativeDefault}],dir:[{opacity:.6},e0.rcss.flex.shrink(100)]});function th(e){var t=e.path,n=e.highlighted,r=e.ranges,i=e.status,o=n?{backgroundColor:eJ.tokens.interactiveBackgroundActive}:void 0,a=i?({included:(0,s.jsx)(to.default,{}),overflowing:(0,s.jsx)(tf.default,{}),truncated:(0,s.jsx)(tf.default,{}),unsupported:(0,s.jsx)(tf.default,{})})[i]:null,l=(0,e2.matchFilepath)({path:t,ranges:null!=r?r:[]}),u=l.directory,c=l.filename,d=u&&u.text.split("/"),f=d&&d.length>2?"".concat(d[0],"/.../").concat(d[d.length-1],"/"):u&&u.text+"/";return(0,s.jsx)(tn.Tooltip,{maxWidth:600,closeDelay:"none",tooltip:t,children:(0,s.jsxs)(tr.View,{css:tp.root,style:o,children:[(0,s.jsxs)(tr.View,{row:!0,gap:8,align:"center",style:o,children:[(0,s.jsxs)(tr.View,{css:tp.left,grow:!0,shrink:!0,row:!0,gap:4,align:"center",style:o,children:[(0,s.jsx)(e6.default,{path:t,size:16}),(0,s.jsx)(ti.HighlightMatches,{text:c.text,highlight:c.ranges,dimmed:!n}),u?(0,s.jsx)(tr.View,{color:"dimmest",css:tp.dir,children:(0,s.jsx)(ti.HighlightMatches,{text:f||"",highlight:u.ranges,dimmed:!n})}):null]}),(0,s.jsx)(tn.Tooltip,{tooltip:"File not supported",isDisabled:"unsupported"!==i,children:a})]}),"overflowing"===i||"truncated"===i?(0,s.jsx)(tt.Text,{css:tp.warning,variant:"small",children:"Exceeds file memory"}):null]})})}var tg=(0,e4.createCssVarTokens)(["iconColor","placeholderColor","itemTransform","inputBorderRadius","inputBorder"]),tm=tg.cssVars,tv=tg.styleTokens,tx=(0,eZ.cssRecord)({root:[e0.rcss.width(290),e0.rcss.maxHeight(300),e0.rcss.display.flex],inputRow:[e0.rcss.position.relative,(n={},(0,g._)(n,tm.iconColor,eJ.tokens.foregroundDimmest),(0,g._)(n,tm.placeholderColor,eJ.tokens.foregroundDimmer),(0,g._)(n,":focus-within, :hover",(t={},(0,g._)(t,tm.iconColor,eJ.tokens.foregroundDimmer),(0,g._)(t,tm.placeholderColor,eJ.tokens.foregroundDimmest),t)),n)],searchIcon:[e0.rcss.coverContainer,e0.rcss.align.start,e0.rcss.justify.center,{color:tv.iconColor,pointerEvents:"none"}],input:[e0.rcss.p(4),e0.rcss.pl(24)],header:[e0.rcss.height(24),e0.rcss.align.center,e0.rcss.display.flex,e0.rcss.justify.spaceBetween],selectionButton:[e0.rcss.reset.button,e3.interactive.nofill,e0.rcss.p(2),{fontSize:eJ.tokens.fontSizeSmall}],menu:[e0.rcss.flex.growAndShrink(1),{overflow:"auto",borderBottom:"1px solid "+eJ.tokens.outlineDimmer}],item:[{transform:tv.itemTransform,position:"absolute",top:0,left:0,width:"100%"}]});function ty(e,t){return t.status&&!e.status?1:e.status&&!t.status?-1:"included"===t.status&&"included"!==e.status?1:"included"===e.status&&"included"!==t.status?-1:0}function tb(e){var t,n,i,o,l,u,c=e.fileContextInclusions,d=e.findFiles,f=e.overscan,p=e.onChange,h=e.unSelectAllFiles,m=e.isRagAuthorized,_=e.ragState,S=e.updatePopperPositionRef,C=(0,w.useRef)(null),j=(0,b._)((0,w.useState)(""),2),T=j[0],E=j[1],R=(0,eX.useGlobalModal)().show,I=(n=(t=(0,b._)((0,w.useState)({loading:!0,error:null,items:null}),2))[0],i=t[1],(o=(0,w.useRef)(null)).current||(o.current=(0,eq.default)(function(e){return(0,r._)(function(){var t;return(0,a._)(this,function(n){switch(n.label){case 0:return[4,d(e)];case 1:return t=n.sent(),(0,w.startTransition)(function(){i(null!==t.error?{error:t.error,loading:!1,items:null}:{items:t.files,total:t.total,error:null,loading:!1})}),[2]}})})()},{wait:40})),l=(0,w.useCallback)(function(e){var t;return null==(t=o.current)?void 0:t.call(o,e).catch(function(){})},[]),(0,w.useEffect)(function(){return l(""),function(){try{var e;null==(e=o.current)||e.cancel()}catch(e){}}},[l]),{files:n.items,loading:n.loading,error:n.error,total:n.total,update:l}),A=I.files,P=I.total,D=I.loading,O=I.error,N=I.update,M=(0,w.useRef)(null),L=(0,eY.default)(T),B=(0,w.useMemo)(function(){var e=new Map(c.map(function(e){return[e.path,e.inclusionStatus]})),t=null==A?void 0:A.map(function(t){var n=t.path;return{path:n,ranges:t.ranges,status:e.get(n)}});if(!t)return null;if(M.current&&!L.current)return(0,eQ.default)(t,{existing:M.current,getKey:function(e){return e.path}});if(L.current)return t;var n=t.sort(ty);return M.current=n,n},[A,c,L]),V=(0,w.useMemo)(function(){var e;return null!=(e=null==B?void 0:B.filter(function(e){return e.status}))?e:[]},[B]);(0,w.useEffect)(function(){if(!D){var e;null==(e=S.current)||e.call(S)}},[D,S]);var F=eN({inputValue:T,items:null!=B?B:[],isOpen:!0,defaultHighlightedIndex:0,stateReducer:function(e,t){var n=t.changes;switch(t.type){case eN.stateChangeTypes.InputKeyDownEnter:case eN.stateChangeTypes.ItemClick:return(0,eH.produce)(n,function(t){t.highlightedIndex=e.highlightedIndex});default:return n}},onHighlightedIndexChange:function(e){void 0===e.highlightedIndex||-1===e.highlightedIndex||G.getVirtualItems()[e.highlightedIndex]&&G.scrollToIndex(e.highlightedIndex)},onStateChange:function(e){switch(e.type){case eN.stateChangeTypes.InputKeyDownEnter:case eN.stateChangeTypes.ItemClick:if(!e.selectedItem)break;var t,n,r,i=V.includes(e.selectedItem)?"exclude":"include";p({path:e.selectedItem.path,preference:i}),null==(r=C.current)||r.select();break;case eN.stateChangeTypes.InputChange:E(null!=(t=e.inputValue)?t:""),N(null!=(n=e.inputValue)?n:"")}}}),U=(0,w.useRef)(null),G=(0,k.useVirtualizer)({count:null!=(u=null==B?void 0:B.length)?u:0,getScrollElement:function(){return U.current},estimateSize:function(){return 32},getItemKey:function(e){var t,n;return null!=(n=null==B||null==(t=B[e])?void 0:t.path)?n:""},overscan:void 0===f?4:f}),$="".concat(eJ.tokens.space4," ").concat(eJ.tokens.space4," 0 0");return!D||(null==B?void 0:B.length)||($=eJ.tokens.space4),(0,s.jsxs)(tr.View,{css:tx.root,style:(0,g._)({},tm.inputBorderRadius,$),children:[(0,s.jsxs)(tr.View,{px:6,py:2,align:"center",row:!0,gap:6,children:[(0,s.jsx)(tt.Text,{css:e0.rcss.fontWeight.medium,children:"Context"}),m?(0,s.jsx)(tr.View,{children:(0,s.jsx)(tc.default,{color:eJ.tokens.tealDefault,size:12})}):null]}),(0,s.jsxs)(tr.View,{px:6,children:[m?(0,s.jsx)(e9.StatusBanner,{colorway:"teal",text:(0,s.jsxs)(tr.View,{children:[(0,s.jsxs)(tr.View,{row:!0,gap:4,css:e0.rcss.align.center,children:[(0,s.jsxs)(tt.Text,{variant:"small",children:[eW.ASSISTANT_NAME," will automatically decide context."]}),(null==_?void 0:_.remainingFilesToIndex)?(0,s.jsx)(tn.Tooltip,{maxWidth:300,tooltip:(0,s.jsxs)(tr.View,{css:e0.rcss.textAlign.center,children:[(0,s.jsxs)(tt.Text,{children:[eW.ASSISTANT_NAME," is getting to know your code"]}),(0,s.jsx)(tt.Text,{color:"dimmer",children:"(".concat(_.remainingFilesToIndex," files remaining)")})]}),children:(0,s.jsx)(tl.default,{size:12})}):null]}),(0,s.jsx)(tt.Text,{variant:"small",children:"You may highlight specific files if you'd like."})]})}):null,m?null:(0,s.jsx)(e7.StatusBannerButton,{iconLeft:(0,s.jsx)(td.default,{}),onClick:function(){return(0,r._)(function(){return(0,a._)(this,function(e){switch(e.label){case 0:return[4,R("MembershipPurchaseModal",{analyticsContext:{upgrade:{context:"ai_context_menu",surface:"ghostwriter_power_up_dialog"}}})];case 1:return e.sent(),[2]}})})()},colorway:"yellow",text:"Have ".concat(eW.ASSISTANT_NAME," decide context automatically")})]}),(0,s.jsxs)(tr.View,{css:tx.inputRow,p:4,children:[(0,s.jsx)(tr.View,{css:tx.searchIcon,pl:12,children:D?(0,s.jsx)(tl.default,{size:12}):(0,s.jsx)(tu.default,{size:12})}),(0,s.jsx)(e5.Input,(0,x._)({autoFocus:!0,placeholder:"Search files",css:tx.input},F.getInputProps({ref:C})))]}),O?(0,s.jsx)(e9.StatusBanner,{icon:(0,s.jsx)(tf.default,{}),text:O}):null,void 0!==P?(0,s.jsxs)(tr.View,{css:tx.header,px:4,row:!0,gap:2,children:[(0,s.jsx)(tt.Text,{variant:"small",color:"dimmest",children:"".concat(c.length,"/").concat(P," selected")}),c.length?(0,s.jsx)(tr.View,{tag:"button",css:tx.selectionButton,onClick:function(){return function(){var e=[],t=!0,n=!1,r=void 0;try{for(var i,o=(null!=A?A:[])[Symbol.iterator]();!(t=(i=o.next()).done);t=!0){var a=i.value;e.push(a.path)}}catch(e){n=!0,r=e}finally{try{t||null==o.return||o.return()}finally{if(n)throw r}}h({paths:e})}()},children:"Unselect All"}):null]}):null,(0,s.jsx)("div",(0,y._)((0,x._)({css:tx.menu},F.getMenuProps({ref:U})),{children:(0,s.jsx)("div",{style:{height:"".concat(G.getTotalSize(),"px"),width:"100%",position:"relative"},children:G.getVirtualItems().map(function(e){var t=e.index,n=e.key,r=e.start,i=null==B?void 0:B[t];return i?(0,s.jsx)(tr.View,(0,y._)((0,x._)({"data-index":t,css:tx.item,style:(0,g._)({},tm.itemTransform,"translateY(".concat(r,"px)"))},F.getItemProps({item:i,index:t,refKey:"innerRef",ref:G.measureElement})),{"aria-selected":void 0!==i.status,children:(0,s.jsx)(th,{highlighted:t===F.highlightedIndex,path:i.path,ranges:i.ranges,status:i.status})}),n.toString()):null})})}))]})}var tw=(0,eZ.cssRecord)({button:[e0.rcss.height(24),e0.rcss.reset.button,e0.rcss.align.center,e0.rcss.cursor.pointer,e0.rcss.px(4),e0.rcss.py(2),e0.rcss.rowWithGap(4),e3.interactive.nofill,e0.rcss.color.foregroundDimmer,{"&:hover":e0.rcss.color.foregroundDefault,"@container (max-width: 400px)":{"> div > span":e0.rcss.display.none}}]});function tk(e){var t,n=(0,b._)((0,w.useState)(!1),2),r=n[0],i=n[1],o=(0,b._)((0,w.useState)(null),2),a=o[0],l=o[1],u=(0,b._)((0,w.useState)(null),2),c=u[0],d=u[1];(0,w.useEffect)(function(){var e=function(e){"Escape"===e.key&&i(!1)};if(r)return document.addEventListener("keydown",e),function(){document.removeEventListener("keydown",e)}},[r]);var f=(0,C.usePopper)(a,c,{modifiers:[{name:"offset",options:{offset:[0,4]}},{name:"preventOverflow",options:{padding:16}}],placement:"top-start"}),p=(0,w.useCallback)(function(){f.update&&f.update()},[f]),h=(0,w.useRef)(p);(0,w.useEffect)(function(){h.current=p},[p]);var g=e.fileContextInclusions,k=e.findFiles,j="Add file context",T=g.filter(function(e){return"included"===e.inclusionStatus});T.length&&(j=1===T.length?(t=(0,eK.getFileName)(T[0].path)).length>20?t.slice(0,10)+"..."+t.slice(-10):t:T.length+" files");var E=(0,w.useId)();return(0,s.jsxs)(_.MenuTrigger,{children:[(0,s.jsx)(e8.Button,{iconLeft:e.isRagAuthorized?(0,s.jsx)(ts.default,{}):(0,s.jsx)(ta.default,{}),text:j,css:tw.button,ref:l,onClick:function(){return i(function(e){return!e})},"aria-label":"Select files","aria-haspopup":!0,"aria-expanded":r,"aria-controls":E}),(0,s.jsx)(S.Popover,{isOpen:r,shouldCloseOnInteractOutside:function(e){var t;return t=[c,a],!((0,m._)(e,Node)&&t.some(function(t){return null==t?void 0:t.contains(e)}))&&(i(!1),!0)},isKeyboardDismissDisabled:!0,children:(0,s.jsx)(te.Surface,(0,y._)((0,x._)({id:E,elevated:!0,style:f.styles.popper,innerRef:d,css:e1.popover},f.attributes.popper),{children:(0,s.jsx)(tb,{overscan:e.overscan,onChange:e.onChange,unSelectAllFiles:e.unSelectAll,findFiles:k,fileContextInclusions:g,isRagAuthorized:e.isRagAuthorized,updatePopperPositionRef:h,ragState:e.ragState})}))})]})}e.s(["FileContextButton",()=>tk,"fileItemCss",()=>tp],69686);var t_={render:function(e){var t=e.file,n=t.path,r=t.match,i=(0,c.createCodeMirrorElement)((0,s.jsx)(tr.View,{css:tp.root,style:{width:"100%"},className:"option",children:(0,s.jsxs)(tr.View,{row:!0,justify:"space-between",align:"center",children:[(0,s.jsxs)(tr.View,{css:tp.left,row:!0,gap:4,align:"center",children:[(0,s.jsx)(e6.default,{path:n,size:16}),(0,s.jsx)(ti.HighlightMatches,{text:r.filename.text,highlight:r.filename.ranges,dimmed:!0}),r.directory?(0,s.jsx)(tr.View,{color:"dimmest",css:tp.dir,children:(0,s.jsx)(ti.HighlightMatches,{text:r.directory.text+"/",highlight:r.directory.ranges,dimmed:!0})}):null]}),"included"===t.inclusionStatus?(0,s.jsx)(to.default,{}):null]})}));return i.style.display="flex",i.style.width="100%",i},position:81},tS=u.EditorView.theme({"@keyframes slide-fade-in":{"0%":{opacity:"0",transform:"translateY(-8px) scale(0.96)"},"100%":{opacity:"1",transform:"translateY(0) scale(1)"}},".cm-tooltip.cm-tooltip-autocomplete":{opacity:"0",transformOrigin:"top center",animation:"slide-fade-in 100ms ease-out 16ms forwards","& > ul":{fontFamily:eJ.tokens.fontFamilyDefault,fontSize:eJ.tokens.fontSizeSmall,transition:"scrollbar-color 0.3s ease",scrollbarColor:"".concat(eJ.tokens.interactiveBorder," transparent"),scrollbarWidth:"thin","&::-webkit-scrollbar":{width:"6px"},"&::-webkit-scrollbar-track":{background:"transparent"},"&::-webkit-scrollbar-thumb":{transition:"background-color 0.3s ease",borderRadius:"3px",backgroundColor:"transparent"},"&:hover::-webkit-scrollbar-thumb":{backgroundColor:eJ.tokens.outlineDimmest},"&::-webkit-scrollbar-thumb:hover":{backgroundColor:eJ.tokens.outlineDefault}},"& > ul > li":{padding:"0px",display:"flex",alignItems:"center"},"& > ul > li[aria-selected] .option":{backgroundColor:eJ.tokens.interactiveBackground}},".cm-completionLabel":{width:0}}),tC=new d.ReactCompartment(function(e){return e?[tS,(0,l.autocompletion)({defaultKeymap:!0,icons:!1,aboveCursor:!0,addToOptions:[t_],override:[function(t){return(0,r._)(function(){var n,r,i,o,s,l,u,c;return(0,a._)(this,function(a){switch(a.label){case 0:if(!e||!(n=t.matchBefore(/@(\S*)/g))||(r=n.from)>0&&" "!==(i=t.state.doc.sliceString(r-1,r))&&"\n"!==i&&"	"!==i||null===(o=t.matchBefore(/\w*/)))return[2,null];return[4,e(o.text)];case 1:return l=null!=(s=a.sent().files)?s:[],u=new Map(t.state.facet(p).map(function(e){return[e.path,e.inclusionStatus]})),c=l.map(function(e){var t=e.path,n=e.ranges;return{label:t,displayLabel:" ",apply:t+" ",file:{path:t,inclusionStatus:u.get(t),match:(0,e2.matchFilepath)({path:t,ranges:null!=n?n:[]})}}}),[2,{from:n.from+1,filter:!1,options:c}]}})})()}],maxRenderedOptions:100})]:[]}),tj=new d.ReactCompartment(function(e){return u.EditorView.updateListener.of(function(t){var n=!0,r=!1,i=void 0;try{for(var o,a=t.transactions[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var s=o.value.annotation(l.pickedCompletion);s&&e(s.label)}}catch(e){r=!0,i=e}finally{try{n||null==a.return||a.return()}finally{if(r)throw i}}})}),tT=new d.ReactCompartment(function(e){return e?u.ViewPlugin.fromClass(function(){function t(){(0,i._)(this,t)}return(0,o._)(t,[{key:"update",value:function(t){if(t.docChanged){var n=t.state.facet(p),r=t.state.doc.toString(),i=!0,o=!1,a=void 0;try{for(var s,l=n[Symbol.iterator]();!(i=(s=l.next()).done);i=!0){var u=s.value;r.includes("@".concat(u.path))||e(u.path)}}catch(e){o=!0,a=e}finally{try{i||null==l.return||l.return()}finally{if(o)throw a}}}}}]),t}()):[]});e.s(["FileCompletion",()=>tC,"FileCompletionAccepted",()=>tj,"FileCompletionRemoval",()=>tT],231895);var tE=e.i(399119),tR=e.i(445789),tI=e.i(754686);e.i(508987);var tA=e.i(457103),tP=(0,eZ.cssRecord)({root:[e0.rcss.display.inlineFlex,{verticalAlign:"middle"}],button:[e0.rcss.reset.button,e0.rcss.display.inlineFlex,e0.rcss.py(2),e0.rcss.px(4),e0.rcss.cursor.pointer,e0.rcss.backgroundColor.interactiveBackground,e0.rcss.border({color:eJ.tokens.interactiveBorder}),e0.rcss.borderRadius(4),e0.rcss.rowWithGap(4),e0.rcss.align.center,e0.rcss.hover([e0.rcss.backgroundColor.interactiveBackgroundActive])],warning:{color:eJ.tokens.redDefault}}),tD=new c.CodeMirrorComponent(function(e){var t=(0,eK.getFileName)(e.path),n=(0,eK.getParentPath)(e.path);return(0,s.jsx)(tn.Tooltip,{isDisabled:!n&&!e.warning,tooltip:(0,s.jsxs)(tr.View,{children:[e.warning?(0,s.jsx)(tt.Text,{variant:"small",css:tP.warning,children:e.warning}):null,n?(0,s.jsxs)(tt.Text,{variant:"small",color:"dimmest",children:[n,"/"]}):null]}),children:function(n,r){return(0,s.jsx)(tr.View,(0,y._)((0,x._)({css:tP.root,innerRef:r},n),{children:(0,s.jsxs)(tr.View,{tag:"button",css:tP.button,onClick:function(){return e.onClick()},children:[(0,s.jsx)(e6.default,{size:12,path:e.path}),(0,s.jsx)(tt.Text,{variant:"small",children:t}),e.warning?(0,s.jsx)(tf.default,{size:12}):null]})}))}})}),tO=function(e){function t(e,n){var r;return(0,i._)(this,t),r=(0,tE._)(this,t),(0,g._)(r,"file",void 0),(0,g._)(r,"onClick",void 0),r.file=e,r.onClick=n,r}return(0,tR._)(t,e),(0,o._)(t,[{key:"eq",value:function(e){return this.file.path===e.file.path&&this.file.inclusionStatus===e.file.inclusionStatus}},{key:"toDOM",value:function(){var e=this.file,t=e.path,n=e.inclusionStatus,r=null;switch(n){case"included":break;case"unsupported":r="File not supported";break;case"truncated":case"overflowing":r="Exceedes memory limit"}var i=tD.create({path:t,onClick:this.onClick,warning:r});return i.style.display="inline-flex",i.style.verticalAlign="middle",i.style.lineHeight="1",i.style.userSelect="none",i.style.pointerEvents="auto",i}}]),t}(u.WidgetType),tN=function(e,t){return new u.MatchDecorator({regexp:RegExp("".concat(e.map(function(e){var t=e.path;return"@".concat((0,tI.default)(t))}).join("|")),"g"),decoration:function(n,r){var i,o=n[0].substring(1,null==(i=n[0])?void 0:i.length),a=e.find(function(e){return e.path===o});return a?u.Decoration.replace({widget:new tO(a,function(){return t(o)}),inclusive:!0}):null}})},tM=new d.ReactCompartment(function(e){return e?u.ViewPlugin.fromClass(function(){function t(n){(0,i._)(this,t),(0,g._)(this,"placeholders",void 0),(0,g._)(this,"match",void 0);var r=n.state.facet(p);this.match=r.length&&e?tN(r,e):null,this.placeholders=this.match?this.match.createDeco(n):u.Decoration.none}return(0,o._)(t,[{key:"update",value:function(t){var n=t.state.facet(p);if(0===n.length){this.match=null,this.placeholders=u.Decoration.none;return}if((0,tA.hasChanged)(t,p)){this.match=tN(n,e),this.placeholders=this.match.createDeco(t.view);return}if((0,tA.hasChanged)(t,"doc")){if(!this.match){this.match=tN(n,e),this.placeholders=this.match.createDeco(t.view);return}this.placeholders=this.match.updateDeco(t,this.placeholders)}}}]),t}(),{decorations:function(e){return e.placeholders},provide:function(e){return u.EditorView.atomicRanges.of(function(t){var n;return(null==(n=t.plugin(e))?void 0:n.placeholders)||u.Decoration.none})}}):[]});e.s(["FileDecorations",()=>tM],69731)},261585,e=>{"use strict";var t=e.i(389959),n=e.i(161322),r=e.i(69470);function i(e){var i=(0,n.useAtomValue)(r.shouldFocusAgentInputAtom);(0,t.useEffect)(function(){i&&e&&e.focus()},[i,e])}e.s(["useAgentInputFocus",()=>i])},127154,410926,e=>{"use strict";var t=e.i(761732),n=e.i(389959),r=e.i(801127),i=e.i(909478),o=e.i(529810);function a(){var e=(0,o.default)().ports,t=(0,i.useOpenedAndForwardedPorts)(e);return(0,n.useMemo)(function(){return t.some(function(e){return(0,r.isGalleryPreviewPort)(e.configuration.localPort)})},[t])}e.s(["useIsGalleryPreviewPortForwarded",()=>a],410926);var s=e.i(423111);function l(){var e,n=(0,s.useWebviewPortOpenedObservable)(),r=null!=(e=(0,t.default)(n))&&e,i=a();return r&&!i}e.s(["useIsVisualSelectorCompatibleWebviewAvailable",()=>l],127154)},854551,e=>{e.v({disabledWithReason:"SendButton-module__4GVtAq__disabledWithReason",root:"SendButton-module__4GVtAq__root"})},732362,e=>{e.v({compactButton:"DynamicPrimaryButton-module__OohzbG__compactButton",iconButton:"DynamicPrimaryButton-module__OohzbG__iconButton",root:"DynamicPrimaryButton-module__OohzbG__root"})},369068,e=>{e.v({closeButton:"EnabledTogglePill-module__cHTKvW__closeButton",container:"EnabledTogglePill-module__cHTKvW__container",iconClickable:"EnabledTogglePill-module__cHTKvW__iconClickable"})},137930,e=>{e.v({fullWidth:"ReadOnlySession-module__fR598W__fullWidth",root:"ReadOnlySession-module__fR598W__root"})},822106,e=>{e.v({isRevising:"FooterRevisionMessages-module__I6It8W__isRevising",revisionFeedbackMessage:"FooterRevisionMessages-module__I6It8W__revisionFeedbackMessage",root:"FooterRevisionMessages-module__I6It8W__root"})},972963,e=>{e.v({drawerContainer:"InitialBuildFooter-module__Mc2-mq__drawerContainer"})},59,e=>{e.v({drawerContainer:"index-module__i6dsBG__drawerContainer",guestUnauthorizedContainer:"index-module__i6dsBG__guestUnauthorizedContainer",hiddenInputBoxContainer:"index-module__i6dsBG__hiddenInputBoxContainer",requiresPaymentContainer:"index-module__i6dsBG__requiresPaymentContainer"})},646983,e=>{e.v({centeredVisualPlanner:"index-module__OxCPea__centeredVisualPlanner",emptyState:"index-module__OxCPea__emptyState",footerContainer:"index-module__OxCPea__footerContainer",footerRow:"index-module__OxCPea__footerRow",isDesktop:"index-module__OxCPea__isDesktop",isMobile:"index-module__OxCPea__isMobile",root:"index-module__OxCPea__root"})},509661,e=>{e.v({divider:"index-module__H41IaW__divider",overlayContainer:"index-module__H41IaW__overlayContainer",scrollArea:"index-module__H41IaW__scrollArea"})},126445,177160,533742,298900,382671,59540,93094,193292,542635,286645,833887,e=>{"use strict";var t,n,r,i=e.i(721281),o=e.i(530658),a=e.i(276385),s=e.i(389959),l=e.i(243202),u=e.i(188507),c=e.i(608572);e.i(925218);var d=e.i(641555),f=e.i(802088),p=e.i(222342),h=e.i(649960),g=e.i(343252),m=e.i(441329),x=e.i(529810),y=e.i(133930),b=e.i(45442),w=e.i(681128),k=e.i(153277),_=e.i(212596),S=e.i(779056),C=e.i(231346),j=e.i(939652),T=e.i(965863),E=e.i(274808),R=e.i(436725),I=e.i(357993),A=e.i(603969),P=e.i(755867),D=e.i(297083),O=e.i(878420),N=e.i(64386),M=e.i(886513),L=e.i(817556),B=e.i(368964),V=e.i(986194),F=e.i(629536),U=e.i(613909),G=e.i(968783),$=e.i(993796),z=e.i(761273),H=e.i(858248),W=e.i(709485),q=e.i(884151),K=e.i(331151),Y=e.i(851480),Q=e.i(946223),X=e.i(59730),J=e.i(579048),Z=e.i(18056),ee=e.i(492008),et=e.i(20399),en=e.i(130764),er=e.i(39411),ei=e.i(225500),eo=e.i(727894),ea=e.i(913811),es=e.i(690767),el=e.i(26857),eu=e.i(267473),ec=e.i(53617),ed=e.i(417120),ef=e.i(398462),ep=e.i(644881),eh=e.i(509908),eg=e.i(573605),em=e.i(248011),ev=e.i(547450),ex=e.i(782672),ey=e.i(791378),eb=e.i(129928),ew=e.i(98816),ek=e.i(112942),e_=e.i(555829),eS=e.i(346715),eC=e.i(604671),ej=e.i(906368);e.i(877212);var eT=e.i(145864),eE=e.i(924908),eR=e.i(72158),eI=e.i(179302),eA=e.i(656381),eP=e.i(921760),eD=e.i(825423),eO=e.i(257378),eN=e.i(703613),eM=e.i(564416),eL=e.i(542101),eB=e.i(808032),eV=e.i(700170),eF=e.i(267103),eU=e.i(631936),eG=e.i(600572),e$=e.i(363605),ez=e.i(58261),eH=e.i(164410),eW=e.i(446152),eq=e.i(633975),eK=e.i(468142),eY=e.i(230776),eQ=e.i(43986),eX=e.i(215969),eJ=e.i(66830),eZ=e.i(900433),e0=e.i(559099),e1=e.i(231895),e2=e.i(183112),e3=e.i(69731),e4=e.i(179549);e.i(619231);var e8=e.i(559491),e5=e.i(691626),e6=e.i(490338),e9=e.i(448534),e7=e.i(261585),te=e.i(98791),tt=e.i(127154),tn=e.i(117807),tr=e.i(17519),ti=e.i(971465),to=e.i(709867),ta=e.i(131614),ts=e.i(956515),tl=e.i(266645),tu=e.i(628576),tc=e.i(200260),td=e.i(255615),tf=e.i(480028),tp=e.i(751273),th=e.i(625484),tg=e.i(940745),tm=e.i(249622),tv=e.i(854551),tx=(0,tf.cvarsFrom)("SendButton.module.css",["--background-color","--background-color-hover","--size"]);function ty(e){var t,n,r=e.loading,l=e.variant,u=e.iconOverride,c=e.size,d=e.colorway,f=e.disabled,p=e.disabledReason,h=e.planModeStyle,g=(0,M._)(e,["loading","variant","iconOverride","size","colorway","disabled","disabledReason","planModeStyle"]),m=null!=d?d:"agent"===l?"blue":"teal",x=null!=f?f:r,y=!!(f&&p),b=(0,o._)((0,s.useState)(!1),2),w=b[0],k=b[1],_=function(){k(!0),setTimeout(function(){k(!1)},3e3)};return(0,a.jsx)(tp.Tooltip,{tooltip:p,isDisabled:!y,isOpen:y?w:void 0,placement:"top-start",hideWhenOutOfBounds:!1,children:(0,a.jsx)(th.View,(0,N._)((0,O._)({align:"center",justify:"center",clsx:[tv.default.root,y&&tv.default.disabledWithReason],style:(n={},(0,i._)(n,tx.backgroundColor,h?tf.tokens.backgroundHighest:tf.colormap[m].dimmer),(0,i._)(n,tx.backgroundColorHover,h?tf.tokens.outlineDimmer:tf.colormap[m].default),(0,i._)(n,tx.size,"".concat(null!=c?c:24,"px")),n),tag:"button",alt:null!=(t=g.alt)?t:"Send",disabled:!y&&x,onMouseDown:function(e){y&&(e.preventDefault(),_())}},g),{children:u||(0,a.jsx)(a.Fragment,{children:r?(0,a.jsx)(tg.default,{}):(0,a.jsx)(tm.default,{})})}))})}e.s(["SendButton",()=>ty],177160);var tb=e.i(907371),tw=e.i(140487),tk=e.i(608263),t_=e.i(616278),tS=e.i(796817),tC=e.i(732362);function tj(e){var t=e.primaryAction,n=e.status,r=e.disabled,i=e.disabledReason,o=e.isInMobileWorkspace,s=e.onClick,l=e.isPlanModeEnabled,u="loading"===n,c={submit:{icon:u?(0,a.jsx)(tg.default,{}):(0,a.jsx)(tk.default,{}),alt:u?"Loading":"Send",tooltip:i,dataCy:"ai-prompt-submit",colorway:l?void 0:"primary"},queue:{icon:u?(0,a.jsx)(tg.default,{}):(0,a.jsx)(tk.default,{}),alt:u?"Loading":"Add to ".concat(F.QUEUE_NAME),tooltip:i||"Add to ".concat(F.QUEUE_NAME),dataCy:"ai-prompt-add-to-queue",colorway:"blurple"},save:{icon:u?(0,a.jsx)(tg.default,{}):(0,a.jsx)(t_.default,{}),alt:u?"Loading":"Save",tooltip:i,dataCy:"ai-prompt-save",colorway:"primary"},stop:{icon:(0,a.jsx)(tS.default,{}),alt:"Stop",tooltip:"Stop",dataCy:"ai-prompt-stop",colorway:void 0}},d=(0,N._)((0,O._)({},c[t]),{disabled:r,loading:u}),f=l&&"submit"===t,p=(0,tb.useCreateInteractive)({colorway:d.colorway,disabled:d.disabled});if(o)return(0,a.jsx)(ty,{loading:d.loading,variant:"agent",alt:d.alt,disabled:d.disabled,disabledReason:i,onClick:s,dataCy:d.dataCy,iconOverride:d.icon,colorway:d.colorway,planModeStyle:f});var h=(0,a.jsx)(td.Button,{isDisabled:d.disabled,onPress:s,"data-cy":d.dataCy,"data-disabled":d.disabled,"data-action":t,clsx:[p.clsx,tC.default.iconButton,tC.default.root],style:p.style,children:d.icon}),g="save"===t;return g&&(h=(0,a.jsx)(tw.Button,{clsx:[tC.default.compactButton,tC.default.root],size:"small","data-disabled":d.disabled,disabled:d.disabled,onClick:s,dataCy:d.dataCy,text:d.alt,iconRight:d.icon,colorway:d.colorway})),(0,a.jsx)(tp.Tooltip,{isDisabled:!d.tooltip||g,tooltip:d.tooltip,placement:"top-end",children:h})}var tT=e.i(136540),tE=e.i(929872),tR=e.i(283110),tI=e.i(369068);function tA(e){var t=e.className,n=e.icon,r=e.onRemove,i=e.tooltip,o=e.pillType,s=void 0===o?"unknown":o,l=e.onIconClick;return(0,a.jsx)(tE.Surface,{elevated:!0,clsx:[tI.default.container,t],children:(0,a.jsxs)(th.View,{row:!0,align:"center",pl:2,children:[(0,a.jsx)(tp.Tooltip,{tooltip:i,children:(0,a.jsx)(tT.IconButton,{alt:"Open agent settings",onClick:l,tooltipBehavior:"hidden",clsx:tI.default.iconClickable,size:24,children:n})}),r?(0,a.jsx)(tT.IconButton,{alt:"Remove",onClick:function(){(0,H.track)(W.events.AGENT_MODEL_SELECTOR_PILL_REMOVED,{pill_type:s}),null==r||r()},tooltipBehavior:"hidden",clsx:tI.default.closeButton,children:(0,a.jsx)(tR.default,{size:12})}):null]})})}var tP=e.i(624714),tD=e.i(670413),tO=e.i(140161);function tN(e){var t,n=e.onClick;return t=n,(0,s.useEffect)(function(){var e=function(e){"u"===e.key&&(0,tD.getCmdOrCtrl)(e)&&(e.preventDefault(),t())};return window.addEventListener("keydown",e),function(){window.removeEventListener("keydown",e)}},[t]),(0,a.jsx)(tT.IconButton,{alt:"Select element",size:24,onClick:n,children:(0,a.jsx)(tO.default,{})})}var tM=e.i(709696),tL=[],tB=e.i(390027),tV=e.i(777110),tF=e.i(61511),tU=e.i(245218),tG=e.i(64256),t$=e.i(399119),tz=e.i(904851),tH=e.i(90659),tW=e.i(445789),tq=e.i(753950);e.i(508987);var tK=e.i(457103),tY=e.i(969932),tQ="cm-pill-prefix",tX="cm-placeholder-layer",tJ="cm-placeholder-dom",tZ=eI.EditorView.theme((t={},(0,i._)(t,".".concat(tQ),{display:"inline-flex",alignItems:"center",padding:"".concat(tf.tokens.space4),paddingLeft:tf.tokens.space8,marginLeft:"calc(".concat(tf.tokens.space4," * -1)"),borderRadius:tf.tokens.borderRadiusDefault,backgroundColor:tf.tokens.accentPrimaryDimmest,color:tf.tokens.accentPrimaryStronger,fontSize:tf.tokens.fontSizeSmall,height:"20px",minWidth:"max-content",verticalAlign:"middle"}),(0,i._)(t,".".concat(tX),{width:"100%",height:"100%",pointerEvents:"none"}),(0,i._)(t,".".concat(tJ),{position:"absolute",width:"100%",pointerEvents:"none",fontFamily:tf.tokens.fontFamilyDefault,color:tf.tokens.foregroundDimmest}),t)),t0=function(e){return 0===e.doc.toString().trim().length},t1=tq.StateField.define({create:t0,update:function(e,t){return t0(t.state)}}),t2=tq.StateEffect.define(),t3=function(e){function t(e,n,r,o,a){var s;return(0,tz._)(this,t),s=(0,t$._)(this,t),(0,i._)(s,"text",void 0),(0,i._)(s,"pillTextColor",void 0),(0,i._)(s,"hasVisualSelectorElement",void 0),(0,i._)(s,"isEditModeActive",void 0),(0,i._)(s,"onRemove",void 0),s.text=e,s.pillTextColor=n,s.hasVisualSelectorElement=r,s.isEditModeActive=o,s.onRemove=a,s}return(0,tW._)(t,e),(0,tH._)(t,[{key:"toDOM",value:function(){var e=this,t=document.createElement("span");t.style.display="inline-flex",t.style.alignItems="center";var n=document.createElement("span");n.className=tQ,n.style.display="inline-flex",n.style.alignItems="center",n.style.gap=tf.tokens.space4,n.style.color=this.pillTextColor;var r=document.createElement("span");if(r.textContent=this.text,n.appendChild(r),(this.hasVisualSelectorElement||!this.isEditModeActive)&&this.onRemove){var i=document.createElement("button");i.style.display="inline-flex",i.style.alignItems="center",i.style.justifyContent="center",i.style.background="none",i.style.border="none",i.style.cursor="pointer",i.style.padding="0",i.style.width="16px",i.style.height="16px",i.style.borderRadius="2px",i.style.color=this.pillTextColor,i.addEventListener("mouseenter",function(){i.style.backgroundColor=tf.tokens.accentPrimaryDimmer}),i.addEventListener("mouseleave",function(){i.style.backgroundColor="transparent"});var o=document.createElementNS("http://www.w3.org/2000/svg","svg");o.setAttribute("width","12"),o.setAttribute("height","12"),o.setAttribute("viewBox","0 0 24 24"),o.setAttribute("fill","currentColor");var a=document.createElementNS("http://www.w3.org/2000/svg","path");a.setAttribute("fill-rule","evenodd"),a.setAttribute("d","M5.47 5.47a.75.75 0 0 1 1.06 0L12 10.94l5.47-5.47a.75.75 0 1 1 1.06 1.06L13.06 12l5.47 5.47a.75.75 0 1 1-1.06 1.06L12 13.06l-5.47 5.47a.75.75 0 0 1-1.06-1.06L10.94 12 5.47 6.53a.75.75 0 0 1 0-1.06Z"),a.setAttribute("clip-rule","evenodd"),o.appendChild(a),i.appendChild(o),i.addEventListener("click",function(t){var n;t.preventDefault(),t.stopPropagation(),null==(n=e.onRemove)||n.call(e)}),n.appendChild(i)}var s=document.createElement("span");return s.style.width=tf.tokens.space8,s.style.display="inline-block",t.appendChild(n),t.appendChild(s),t}},{key:"eq",value:function(e){return e.text===this.text&&e.hasVisualSelectorElement===this.hasVisualSelectorElement&&e.onRemove===this.onRemove}}]),t}(eI.WidgetType),t4=e.i(943565),t8=e.i(33914),t5=e.i(744895),t6=e.i(861594),t9=e.i(986212),t7=eI.EditorView.theme((n={"&":{flexGrow:1},"& .cm-content":{fontFamily:tf.tokens.fontFamilyDefault}},(0,i._)(n,"& .".concat(eB.ACTIVE_LINE_LAYER_CLASS),{display:"none"}),(0,i._)(n,"& .cm-cursor",{borderLeftColor:tf.tokens.foregroundDefault,borderLeftWidth:"1px"}),n));function ne(e){var t,n,r,l,u,c,f,h,y,b,w,k,_,S,C,j,T,R=(0,eE.useChatter)(),I=(0,ed.useIsAgentWorking)(),A=(0,ed.usePauseAgent)(),P=(0,eL.default)(),M=P.ref,V=P.view,U=(0,m.useIsInMobileWorkspace)();(0,e7.useAgentInputFocus)(V);var G=(0,o._)((0,s.useState)(!1),2),z=G[0],H=G[1],W=e.agentSettings,q=e.proposedTaskList,K=e.shouldShowChatModeControl,Y=W.settings.chatMode===B.AgentChatMode.Discussion,Q=W.settings.chatMode===B.AgentChatMode.QuickEdit,X=Y&&I,J=(0,tB.useEditModeState)(),Z=J.isEditModeActive,ee=J.setIsEditModeActive,et=(0,t4.useFeatureGate)("agent_quick_edit_mode",!1),en=(0,s.useMemo)(function(){return Z?"edit":Q?"quick-edit":Y?"plan":"build"},[Y,Z,Q]),er=(0,ea.useQueueIsOpen)(),ei=(0,ea.useEditingQueueItemId)(),eo=(0,ea.useSetEditingQueueItemId)(),es=(0,eT.useAgentPlanApprovalState)(),el=(0,$.useFlag)({controlName:"flag-floating-status-row"});(0,ez.useConnectorContext)(),(0,eH.useIsModelfarmEnabled)();var eu=null!=(w=e.status)?w:"composing",ec=(0,p.default)().showError,ef=e0.MaxLength.use(2e3),ep=(0,tV.usePersistPromptDraft)(e.persistenceKey,V),eg=ep.persistPromptDraftCompartment,em=ep.clearPersistedPromptDraft,ev=(0,tU.useUrlContextFeatureKillswitch)(),ex=(0,eJ.useAiChatAttachments)(),ey=ex.attachments,eb=ex.urlAttachments,ek=ex.removeAttachment,e_=ex.addAttachments,eR=ex.addUrlAttachment,eB=ex.removeUrlAttachment,eV=ex.clearAttachments,eq=ex.isLoading,tr=null!=(n=(0,eN.useCodeMirrorValue)(V,tM.detectedUrlsState))?n:tL,ta=(0,eU.useAgentInputFigmaContextProviderState)({source:"workspace",detectedLinks:tr}),td=(0,ew.default)(ta),tp=(0,s.useCallback)(function(){return td.current.getFigmaTelemetryData()},[td]),tg=(0,E.useHasInMessageSecretsContext)(),tm=null!=(k=(0,eN.useCodeMirrorValue)(V,eP.HasActiveInMessageSecrets))&&k;(0,E.useBindViewToInMessageSecrets)(V);var tv=(0,s.useCallback)(function(e){V&&V.dispatch(V.state.update({changes:{from:0,to:V.state.doc.length,insert:e}}))},[V]),tx=(0,eZ.useDropTarget)({addAttachments:e_}),ty=tx.isDraggedOver,tb=tx.drop,tw=(0,eF.useObservable)(eq,!1),tk=(0,d.useObservableMemo)(function(){return ey.map(function(e){return e.length>0})},[ey]),t_=(0,s.useCallback)(function(){H(!0)},[]),tS=(0,s.useCallback)(function(){H(!1)},[]),tC=(0,s.useCallback)(function(e){if(V){var t=V.state.doc.toString(),n=t?"".concat(t,"\n\n").concat(e):e;V.dispatch(V.state.update({changes:{from:0,to:V.state.doc.length,insert:n}})),H(!1),V.focus()}},[V]),tT=(0,eF.useObservable)(ey),tR=(0,e6.useVisualSelector)({context:"agent"}),tI=tR.element,tA=tR.setElement,tD=tR.clearSelection,tO=tR.isActive,t$=tR.isEditingSupported,tW=tR.isSelectorScriptLoaded,tq=tR.setVisualSelectorEnabled,tQ=(0,te.usePackageVersionCheck)(),t0=tQ.shouldShowUpgradeModal,t8=tQ.isUpgrading,t5=tQ.checkVersionAndProceed,t6=tQ.handleUpgradeConfirm,ne=tQ.handleUpgradeCancel,ni=tQ.handleModalClose,no=e.isVisualSelectorDisabled,na=void 0!==no&&no,ns=(0,eN.useCodeMirrorValue)(V,tO?t1:e4.isEmpty),nl=(0,ew.default)(e.onInputEmptyChange);(0,s.useEffect)(function(){if(null!=ns){var e;null==(e=nl.current)||e.call(nl,ns)}},[ns,nl]);var nu=!!tI,nc=null!=(_=e.placeholderText)?_:(t={agentMode:en,isVisualSelectorActive:tO,hasVisualSelectorElement:nu,hasInitialPlanningLayout:e.hasInitialPlanningLayout,isAwaitingTaskListApproval:e.isAwaitingTaskListApproval}).hasInitialPlanningLayout||t.isAwaitingTaskListApproval?nr:"edit"===t.agentMode?"Edit element":t.isVisualSelectorActive?"":"plan"===t.agentMode?"".concat(to.PLAN_MODE_DESCRIPTION,""):"quick-edit"===t.agentMode?"".concat(to.QUICK_EDIT_MODE_DESCRIPTION,""):"".concat(to.BUILD_MODE_DESCRIPTION,""),nd=(0,e4.usePlaceholder)({text:nc,disableAnimation:e.disablePlaceholderTextAnimation}),nf=(0,s.useCallback)(function(){Z?nu&&tA(null):tq(!1,{shouldClearSelection:!0})},[tA,nu,Z,tq]),np=(0,s.useRef)(null),nh=(r={pillText:tI?tI.componentName:to.VISUAL_SELECTOR_PILL_PLACEHOLDER,hasVisualSelectorElement:nu,placeholderText:nc,disableAnimation:e.disablePlaceholderTextAnimation,onPillRemove:nf},l=(0,tB.useEditModeState)().isEditModeActive,u=r.pillText,c=r.hasVisualSelectorElement,f=r.placeholderText,y=void 0!==(h=r.disableAnimation)&&h,b=r.onPillRemove,(0,s.useMemo)(function(){var e;return[t1,tZ,eI.ViewPlugin.fromClass(function(){function e(t){(0,tz._)(this,e),(0,i._)(this,"decorations",void 0),this.decorations=this.buildDecorations(t)}return(0,tH._)(e,[{key:"update",value:function(e){(e.docChanged||e.viewportChanged)&&(this.decorations=this.buildDecorations(e.view))}},{key:"buildDecorations",value:function(e){var t=[],n=c?tf.tokens.foregroundDefault:tf.tokens.accentPrimaryStronger,r=eI.Decoration.widget({widget:new t3(u,n,c,l,b),side:-1});return t.push(r.range(0)),eI.Decoration.set(t)}}]),e}(),{decorations:function(e){return e.decorations}}),(0,eI.layer)((e=Date.now(),{above:!1,class:tX,update:function(t){var n=!1;return(0,tY.forEachEffect)(t,t2,function(){n=!0,e=Date.now()}),n||(0,tK.hasChanged)(t,t1)},markers:function(t){if(!t.state.field(t1,!1))return[];var n,r,i,o,a,s,l,u=t.coordsAtPos(0);if(!u)return[];var c=t.dom.getBoundingClientRect(),d=u.left-c.left;return[(r=(n={top:u.top-c.top,left:d,height:u.bottom-u.top,placeholderText:f,animateTimestamp:e,disableAnimation:y}).top,i=n.left,o=n.height,a=n.placeholderText,s=n.animateTimestamp,l=n.disableAnimation,{draw:function(){var e=document.createElement("div");if(e.className=tJ,e.style.paddingTop=r+"px",e.style.paddingLeft=i+"px",e.style.height=o+"px",l)e.textContent=a;else{var t=a.length,n=function(){var r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;requestAnimationFrame(function(){e.textContent=a.slice(0,r),r<t&&n(r+1)})};n()}return e},placeholderText:a,animateTimestamp:s,eq:function(e){return this.placeholderText===e.placeholderText&&this.animateTimestamp===e.animateTimestamp}})]}}))]},[u,c,f,y,l,b])),ng=(0,tn.useAgentStackBlueprint)(),nm=(0,tt.useIsVisualSelectorCompatibleWebviewAvailable)(),nv=(0,m.useIsInMobileWorkspace)(),nx=nm&&tW&&!nv,ny=ns&&el&&I,nb=ns&&!tk&&"composing"===eu||"loading"===eu||e.isSubmitDisabled||!!e.disabled||tw||tm||X,nw=e.submitDisabledReason;tm?nw="Please add secret or dismiss the warning":tw?nw="Please wait for files to finish uploading":X&&(nw="Please wait for the agent to finish working or turn off ".concat(to.PLAN_MODE_LABEL," mode"));var nk=ny?!I:nb,n_=ny?null:nw,nS=(0,s.useMemo)(function(){return et?"hidden":!t$||(0,e8.isVisualSelectorIncompatibleStack)(ng)?"disabled":!na&&nx&&t$?"visible":"loading"},[et,t$,nx,na,ng]),nC=e.onSubmit,nj=e.ensureSession,nT=e.sessionId,nE=(0,x.default)().fs,nR=(0,$.useFlag)({controlName:"flag-queue-royal-flush",default:!1}),nI=(0,s.useCallback)(function(e){return(0,D._)(function(){var t,n;return(0,L._)(this,function(r){switch(r.label){case 0:if(!V)return[2];return[4,(0,eY.unpackContentsFromQueuedMessage)({contents:e.contents,readFile:nE.readFile})];case 1:return t=r.sent(),V.dispatch({changes:{from:0,to:V.state.doc.length,insert:t.message},selection:{anchor:t.message.length,head:t.message.length}}),ey.set(t.attachments),t.webviewTargetedElement&&tA(null!=(n=(0,e8.normalizeTargetedElement)(t.webviewTargetedElement))?n:null),t.agentConfig&&W.updateSettings(t.agentConfig),eo(e.id),V.focus(),[2]}})})()},[V,ey,tA,eo,nE.readFile,W]),nA=(0,s.useCallback)(function(e){return(0,D._)(function(){var t,n,r;return(0,L._)(this,function(i){switch(i.label){case 0:return[4,nj()];case 1:if(!(t=i.sent()))return[2];if((0,eh.trackAgentQueueAnalyticsEvent)({action:"queue_message_sent_manually",messageText:e.contents.content,sessionId:t.id}),!nR)return[3,3];return[4,R.queue.flush({ids:[e.id],session:t.id})];case 2:case 5:return i.sent(),[2];case 3:return[4,(0,eY.unpackContentsFromQueuedMessage)({contents:e.contents,readFile:nE.readFile})];case 4:return n=i.sent(),r=(0,e8.normalizeTargetedElement)(n.webviewTargetedElement),nC((0,N._)((0,O._)({},n),{webviewTargetedElement:r,figma:tp()})),[4,R.queue.flush({ids:[e.id]})]}})})()},[R,nE.readFile,tp,nC,nj,nR]),nP=(0,s.useCallback)(function(){return(0,D._)(function(){var e;return(0,L._)(this,function(t){return nb||!V||(e=V.state.doc.toString(),em(),nC({message:e,attachments:(0,eS._)(ey.current).concat((0,eS._)(eb.current.map(function(e){return e.file}))),agentSettings:W.settings,figma:tp()}),eV(),V.dispatch({effects:tM.clearDetectedUrlsEffect.of(null)}),V.dispatch({changes:{from:0,to:V.state.doc.length}})),[2]})})()},[nb,V,em,nC,ey,eb,W.settings,tp,eV]),nD=(0,tF.useSetPromptEditor)({view:V,setPromptEditor:e.inputRef}),nO=tP.HandlePasteCompartment.use({addAttachments:e_,onAutoAttachedLargePaste:function(e){(0,eh.trackAgentAnalyticsEvent)({action:"auto_attached_large_paste",fileSize:e,sessionId:nT})}}),nN=e1.FileCompletion.use(e.findFiles),nM=e.openPane,nL=(0,s.useCallback)(function(e){null==nM||nM({type:"file",data:{path:e}})},[nM]),nB=e3.FileDecorations.use(nL),nV=e2.FileContext.use(e.fileContextInclusions),nF=e.updateFileContext,nU=e1.FileCompletionAccepted.use((0,s.useCallback)(function(e){return null==nF?void 0:nF({path:e,preference:"include"})},[nF])),nG=e1.FileCompletionRemoval.use((0,s.useCallback)(function(e){return null==nF?void 0:nF({path:e,preference:"exclude"})},[nF])),n$=(0,g.useMergeRefs)([tb,nD],{breadcrumb:"client/workspace/components/Agent/Chat/InputBox/index.tsx"}),nz=(0,eX.useIsUserMessageMostRecentEvent)({sessionId:nT}),nH=I||nz,nW=(0,ea.useSetQueueIsOpen)(),nq=(0,s.useCallback)(function(){return(0,D._)(function(){var e,t,n,r;return(0,L._)(this,function(i){switch(i.label){case 0:if(t=(null!=(e=null==V?void 0:V.state.doc.toString())?e:"").trim(),n=(0,eY.packContentsForQueuedMessage)({text:t,attachedFiles:(0,eS._)(ey.current).concat((0,eS._)(eb.current.map(function(e){return e.file}))),agentConfig:W.settings,targetedElement:tI}),!t)return[2];i.label=1;case 1:return i.trys.push([1,3,,4]),[4,R.queue.enqueue({contents:n})];case 2:return i.sent(),(0,eh.trackAgentQueueAnalyticsEvent)({action:"queue_message_added",messageText:t,sessionId:nT}),[3,4];case 3:return r=i.sent(),ec("Failed to add message to queue"),ej.captureException(r),[2];case 4:return V&&V.dispatch({changes:{from:0,to:V.state.doc.length},effects:tM.clearDetectedUrlsEffect.of(null)}),eV(),Z?tD():tq(!1,{shouldClearSelection:!0}),nW(!0),[2]}})})()},[V,ey,eb,W.settings,tI,eV,tq,tD,nW,R,ec,nT,Z]),nK=(0,s.useCallback)(function(){return(0,D._)(function(){var e,t,n;return(0,L._)(this,function(r){switch(r.label){case 0:if(!ei)return[2];return t=(null!=(e=null==V?void 0:V.state.doc.toString())?e:"").trim(),n=(0,eY.packContentsForQueuedMessage)({text:t,attachedFiles:(0,eS._)(ey.current).concat((0,eS._)(eb.current.map(function(e){return e.file}))),agentConfig:W.settings,targetedElement:tI}),[4,R.queue.update({id:ei,contents:n})];case 1:return r.sent().ok?((0,eh.trackAgentQueueAnalyticsEvent)({action:"queue_message_edited",messageText:t,sessionId:nT}),null==V||V.dispatch({changes:{from:0,to:V.state.doc.length,insert:""},effects:tM.clearDetectedUrlsEffect.of(null)}),eV(),tD(),eo(null),tM.clearDetectedUrlsEffect.of(null)):ec("Failed to save queued message"),[2]}})})()},[ei,V,ey,eb,W,tI,R,eV,tD,eo,ec,nT]),nY=(0,s.useMemo)(function(){return"approved"!==es?"submit":ei?"save":ny?"stop":nH&&!Y?"queue":"submit"},[es,ei,nH,Y,ny]),nQ=(0,s.useCallback)(function(){switch(nY){case"submit":nP();break;case"queue":nq();break;case"save":nK();break;case"stop":A()}},[nY,nP,nq,nK,A]),nX=(0,ew.default)(nQ),nJ=(0,s.useCallback)(function(){ei&&V&&(V.dispatch({changes:{from:0,to:V.state.doc.length},effects:tM.clearDetectedUrlsEffect.of(null)}),eV(),tD(),eo(null))},[ei,V,eV,tD,eo]),nZ=nn.use({onPrimaryAction:(0,s.useCallback)(function(){nX.current()},[nX]),onCancelEdit:nJ,isEditingQueueItem:!!ei,isVisualSelectorActive:tO,onCancelVisualSelector:(0,s.useCallback)(function(){tO&&tq(!1,{shouldClearSelection:!0})},[tO,tq])}),n0=(0,s.useCallback)(function(){!V||(tO?tq(!1,{isEditingEnabled:!1}):t5()&&tq(!0,{isEditingEnabled:!1}))},[V,tq,tO,t5]),n1=(0,s.useCallback)(function(){!V||(tO?tq(!1,{isEditingEnabled:!1}):t5()&&tq(!0,{isEditingEnabled:!0}))},[V,tq,tO,t5]),n2=(0,d.useObservableMemo)(function(){return nT?R.sessions.get(nT):null},[R,nT],{default:null}),n3=eW.AgentWarmupCompartment.use(n2),n4=(0,a.jsx)(tl.default,{clsx:t9.default.attachments,detectedUrls:tr.map(function(e){return(0,a.jsx)(tu.default,{source:"workspace",url:e,addUrlAttachment:eR,removeUrlAttachment:eB,onError:ec},e)}),fileAttachments:tT.map(function(e){return(0,a.jsx)(tc.FileAttachment,{attachment:e,removeAttachment:ek,getAttachmentTypeDisclaimer:(0,tG.getAttachmentTypeDisclaimer)({aiName:(0,F.getAgentName)({capitalizeFirstChar:!0})})},e.path)})});return(0,a.jsx)(eU.AgentInputFigmaContext.Provider,{value:ta,children:(0,a.jsxs)(th.View,{clsx:[t9.default.outer,(0,i._)({},t9.default.autoHeight,e.hasInitialPlanningLayout||e.isAwaitingTaskListApproval)],innerRef:np,children:[(0,a.jsx)(e5.TargetedElementEditor,{hasQuickEditFeature:et,openPane:e.openPane}),q?null:(0,a.jsx)(eK.QueueDrawer,{isDisabled:null!=(S=e.disabled||Y)&&S,onEnterEditMode:nI,sendQueuedMessage:nA,banner:e.queueBanner}),(0,a.jsx)(th.View,{clsx:t9.default.wrapper,children:(0,a.jsx)(th.View,{gap:4,children:(0,a.jsxs)(tE.Surface,{elevated:!0,p:4,gap:4,grow:!0,shrink:!0,clsx:[t9.default.surface,(0,i._)({},t9.default.withDrawer,Z||e.isAwaitingTaskListApproval||et&&nu)],innerRef:n$,style:{borderColor:ty?tf.tokens.accentPrimaryDefault:void 0},"aria-disabled":!!e.disabled||void 0,"data-queue-connected":er,onClick:function(e){e.target===e.currentTarget&&(null==V||V.focus())},children:[null!=(C=e.header)?C:null,z?(0,a.jsx)(eG.FigmaUrlInput,{source:"workspace",onCancel:tS,onSubmit:tC}):null,(0,a.jsxs)(th.View,{grow:!0,shrink:!0,gap:4,style:{display:z?"none":"flex"},children:[(0,a.jsx)(eM.default,{"data-chromatic":"ignore",ref:M,clsx:t9.default.codemirror,style:{cursor:e.disabled?"default":void 0},fontSize:14,readOnly:e.disabled,extensions:[t7,nZ,nO,tO?nh:nd,e0.characterLimit,ef,eg,eO.autocorrectExtension,eD.autocapitalizeExtension,tg?eP.InMessageSecretScanner:[],ev?[]:tM.UrlAttachmentExtensions,eA.slashCommandExtension,n3,e.hasInitialPlanningLayout?[]:[nV,nB,nN,nU,nG]],id:"ai-prompt-input","data-cy":"ai-prompt-input"}),n4]}),(0,a.jsx)(eC.UNSTABLE_PortalProvider,{getContainer:function(){return nv?np.current:document.body},children:z?null:(0,a.jsxs)(th.View,{row:!0,gap:4,clsx:t9.default.primaryButtonGroup,pb:2,justify:"space-between",align:"end",onClick:function(e){e.target===e.currentTarget&&(null==V||V.focus())},children:[(0,a.jsxs)(th.View,{row:!0,gap:U?12:4,align:"center",children:[(void 0===K||K)&&!ei&&W?(0,a.jsx)(th.View,{pl:2,children:(0,a.jsx)(ti.AgentChatModeDropdown,{disabled:null!=(j=e.disabled)&&j,agentSettings:W.settings,updateAgentSettings:W.updateSettings,selectedModeId:en,editModeVisibility:nS,setIsEditModeActive:ee,setVisualSelectorEnabled:tq,keyboardShortcutEnabled:!nv,onModeSwitchFocusInput:function(){!U&&V&&queueMicrotask(function(){V.focus()})}})}):null,et||!nx||Z?null:(0,a.jsx)(tN,{onClick:n0}),et&&nx?(0,a.jsx)(tN,{onClick:n1}):null,(0,a.jsx)(ts.AttachmentButton,{source:"workspace",disabled:e.disabled,status:eu,addAttachments:e_,onFigmaImportClick:t_}),(0,a.jsx)(eQ.default,{getCurrentText:function(){var e;return null!=(e=null==V?void 0:V.state.doc.toString())?e:""},onUpdateText:tv})]}),(0,a.jsxs)(th.View,{pr:2,align:"center",row:!0,gap:8,children:[(0,a.jsx)(nt,{agentSettings:W,disabled:null!=(T=e.disabled)&&T}),(0,a.jsx)(tj,{primaryAction:nY,status:eu,disabledReason:n_,disabled:nk,isInMobileWorkspace:U,onClick:nQ,isPlanModeEnabled:Y})]})]})})]})})}),(0,a.jsx)(e$.FigmaAuthModal,{}),(0,a.jsx)(e9.UpgradeModal,{shouldShowUpgradeModal:t0,isUpgrading:t8,onUpgradeConfirm:t6,onUpgradeCancel:ne,onClose:ni})]})})}function nt(e){var t=e.agentSettings,n=e.disabled,r=(0,t4.useFeatureGate)("agent_quick_edit_mode",!1),i=(0,o._)((0,s.useState)(!1),2),l=i[0],u=i[1];if(!t.settings||t.loading)return null;var c=t.settings,d=c.autonomyLevel,f=c.chatMode,p=c.modelProfile===B.ModelProfile.ModelProfileAdvanced,h=f===B.AgentChatMode.QuickEdit,g=r&&(f===B.AgentChatMode.General||h);return(0,a.jsxs)(th.View,{row:!0,gap:4,align:"center",children:[p?(0,a.jsx)(tA,{icon:(0,a.jsx)(t5.default,{size:16}),onRemove:function(){return t.updateSettings({modelProfile:B.ModelProfile.ModelProfileStandard})},tooltip:(0,a.jsx)(tr.DynamicIntelligenceTooltip,{type:"highPowerModel"}),pillType:"high_power_model",onIconClick:function(){return u(!0)}}):null,h||d!==B.AutonomyLevel.Max?null:(0,a.jsx)(tA,{className:t9.default.maxAutonomyPill,icon:(0,a.jsx)(t6.default,{size:16}),tooltip:"Max autonomy enabled",pillType:"max_autonomy",onIconClick:function(){return u(!0)}}),g?(0,a.jsx)(eq.ToggleButton,{icon:(0,a.jsx)(t8.default,{size:16}),tooltip:"Quick edit ".concat(h?"enabled":"disabled"),selected:h,onClick:function(){h?t.updateSettings({chatMode:B.AgentChatMode.General}):t.updateSettings({chatMode:B.AgentChatMode.QuickEdit})}}):null,(0,a.jsx)(ta.AgentSettingsDropdown,{disabled:n||t.loading,settings:t.settings,update:t.updateSettings,isOpen:l,onOpenChange:u})]})}var nn=new eV.ReactCompartment(function(e){var t=e.onPrimaryAction,n=e.preventSubmitOnEnter,r=e.onCancelEdit,i=e.isEditingQueueItem,o=e.isVisualSelectorActive,a=e.onCancelVisualSelector;return eI.EditorView.domEventHandlers({keydown:function(e,s){if("Escape"===e.key){if(i&&r){e.preventDefault(),r();return}if(o&&a){e.preventDefault(),a();return}}if("Backspace"===e.key&&o&&a){var l=s.state.doc,u=s.state.selection.main;if(0===l.length&&0===u.head){e.preventDefault(),a();return}}(0,eR.currentCompletions)(s.state).length>0||!n&&("Enter"===e.key&&e.metaKey&&e.stopPropagation(),"Enter"!==e.key||e.shiftKey||(e.preventDefault(),t()))}})}),nr="Message ".concat(F.AGENT_NAME,""),ni=e.i(602213),no=e.i(960178),na=e.i(137930);function ns(e){var t=e.onNewSession,n=e.shouldUseFullWidth;return(0,a.jsxs)(th.View,{clsx:[na.default.root,(0,i._)({},na.default.fullWidth,n)],gap:8,p:8,justify:"center",align:"center",children:[(0,a.jsx)(no.Text,{variant:"small",color:"dimmer",children:"This chat has ended"}),(0,a.jsx)(tw.Button,{iconLeft:(0,a.jsx)(ni.AgentAvatar,{size:16}),onClick:t,text:"Start a new ".concat(F.AGENT_NAME," chat")})]})}function nl(e){var t,n,r=e.isLoadingUsageOrAuthorization,i=e.sendMessage,o=e.ensureSession,l=e.session,c=e.inputRef,f=e.onNewSession,p=e.openPane,h=e.shouldInterruptAgentOnSubmit,g=void 0!==h&&h,m=e.onSubmit,x=e.hasInitialPlanningLayout,y=(0,M._)(e,["isLoadingUsageOrAuthorization","sendMessage","ensureSession","session","inputRef","onNewSession","openPane","shouldInterruptAgentOnSubmit","onSubmit","hasInitialPlanningLayout"]),b=(0,ed.useAgentState)(),w=b.agentState,k=b.updateAgentState,_=(0,d.useObservableMemo)(function(){return null==w?void 0:w.map(function(e){return(null==e?void 0:e.state)===u.AgentRunState.AGENT_STATE_RUNNING})},[w]),S=(0,E.useInMessageSecrets)().inMessageSecrets.length>0,C=(0,ex.useNixError)(),j=(0,ew.default)(m),T=(0,s.useCallback)(function(e){g&&_&&k(u.AgentRunState.AGENT_STATE_PAUSED),null==(t=j.current)||t.call(j);var t,n=e.agentSettings?(0,ek.convertAgentSettingsFromGQLToAiChat)(e.agentSettings,{agentMode:x?u.AgentMode.AGENT_MODE_INITIAL_PLANNING:void 0}):void 0;i((0,N._)((0,O._)({},e),{agentConfig:n}))},[i,g,k,_,j,x]);if((0,A.useIsAgentSessionReadOnly)(null!=(t=null==l?void 0:l.id)?t:null))return(0,a.jsx)(ns,{onNewSession:f,shouldUseFullWidth:!0});var R=null;r?R="Loading":C&&(n=!0,R="App is in recovery mode");var I=void 0;return S&&(I=(0,a.jsx)(e_.InMessageSecretsWarning,{openSecrets:function(){return p({type:"envEditor"})}})),(0,a.jsx)(ne,(0,N._)((0,O._)({},y),{header:I,inputRef:c,sessionId:(null==l?void 0:l.id)||void 0,hasInitialPlanningLayout:x,disabled:null!=n?n:y.disabled,isSubmitDisabled:null!==R,submitDisabledReason:R,onSubmit:T,ensureSession:o,openPane:p,onInputEmptyChange:y.onInputEmptyChange,queueBanner:y.queueBanner}))}var nu=e.i(624782),nc=e.i(352767),nd=e.i(822106);function nf(e){var t=e.isRevising,n=e.isAgentRunning,r=e.isNarrowViewport,o=e.handleBackButtonClick,s=e.children;return(0,a.jsxs)(th.View,{clsx:[nd.default.root,(0,i._)({},nd.default.isRevising,t)],children:[t?(0,a.jsxs)(th.View,{row:!0,align:"center",py:8,gap:8,children:[(0,a.jsx)(tw.Button,{onClick:o,text:n?"Resume":"Back",colorway:"primary",iconLeft:(0,a.jsx)(nc.default,{}),size:"small"}),(0,a.jsx)(nu.Pill,{clsx:nd.default.revisionFeedbackMessage,text:n?r?"Requesting edits will cancel in-progress work.":"".concat(F.AGENT_NAME," is working. Requesting edits will cancel in-progress work."):"What would you like to change about the plan?"})]}):null,s]})}function np(e){var t=e.isRevising,n=e.isNarrowViewport,r=e.handleBackButtonClick,i=e.children;return(0,a.jsxs)(th.View,{children:[t?(0,a.jsxs)(th.View,{row:!0,align:"center",py:8,gap:8,children:[(0,a.jsx)(tw.Button,{onClick:r,text:"Back",colorway:"primary",iconLeft:(0,a.jsx)(nc.default,{}),size:"small"}),(0,a.jsx)(nu.Pill,{clsx:nd.default.revisionFeedbackMessage,colorway:"blurple",text:n?"What would you like to change?":"What would you like to change about the task list?"})]}):null,i]})}var nh=e.i(167626),ng=e.i(593366),nm=e.i(169252),nv=e.i(569384),nx=e.i(973245),ny=e.i(951262);function nb(){var e=(0,nv._)(["\n  mutation InitializeAgentStackReplConfig($input: UpdateReplInput!) {\n    updateRepl(input: $input) {\n      repl {\n        id\n        config {\n          isAgentStack\n          agentStackPlatformType\n        }\n      }\n    }\n  }\n"]);return nb=function(){return e},e}var nw={},nk=(0,nx.gql)(nb()),n_=e.i(207237),nS=e.i(492267),nC=e.i(293265),nj=(r={},(0,i._)(r,u.AgentStackTriggerType.SLACK_MESSAGE,nm.AgentStackPlatformType.Slack),(0,i._)(r,u.AgentStackTriggerType.TELEGRAM_MESSAGE,nm.AgentStackPlatformType.Telegram),(0,i._)(r,u.AgentStackTriggerType.TIME_BASED,nm.AgentStackPlatformType.TimeBased),(0,i._)(r,u.AgentStackTriggerType.CONNECTOR_TRIGGER,nm.AgentStackPlatformType.ConnectorTrigger),r),nT=e.i(374106),nE=e.i(149448),nR={direction:"forward",state:{visualPhaseRequestCount:0},map:function(e){return e.visualPhaseRequestCount},reducer:function(e,t){if((0,nT.isEventContentsKind)(e,"agentAskUserForActionRequest")){var n=e.contents.contents,r=(0,V.unkind)(n).request;r&&(0,V.isKind)(r,"approveInitialBuildVisualPhaseRequest")&&t.visualPhaseRequestCount++}}},nI=e.i(972963);function nA(e){var t,n,r,i,l,c,f,h,g,x,y,w,k,_,S,C,j,T,E,R,I,A=e.session,P=(0,M._)(e,["session"]),B=(0,m.useIsInMobileWorkspace)(),V=(E=(0,nE.useLastEvent)(null!=A?A:null),R=(0,ed.useIsAgentWorking)(),(0,s.useMemo)(function(){if(!(null==E?void 0:E.event))return{isAgentAwaitingUserResponse:!1,needsAgentAckForUserMessage:!1,isGeneratingInitialPlanSteps:!1};var e=(0,nT.isEventContentsKind)(E.event,"agentPlanEventContents")&&E.event.contents.contents.agentPlanEventContents.requiresApproval;return{isAgentAwaitingUserResponse:!R&&(null==E?void 0:E.senderType)===u.UserType.AI&&!e,needsAgentAckForUserMessage:(null==E?void 0:E.senderType)===u.UserType.USER&&E.event.state===u.EventState.COMPLETE,isGeneratingInitialPlanSteps:(0,nT.isEventContentsKind)(E.event,"agentPlanEventContents")&&E.event.state===u.EventState.IN_PROGRESS&&0===E.event.contents.contents.agentPlanEventContents.step.subSteps.length}},[E,R])),F=V.isAgentAwaitingUserResponse,U=V.needsAgentAckForUserMessage,G=(0,z.useBreakpoint)("mobileMax"),$=(0,eT.useAgentPlanApprovalState)(),H=(t=A,n=P.numPlansProposed,x=(0,eE.useYapper)(),y=(0,eF.useObservable)(x.user),w=(0,eT.useGetAgentPlanApprovalState)(),k=(0,eT.useSetAgentPlanApprovalState)(),_=(0,eT.useProposedPlan)(),S=(r=null!=t?t:void 0,i=(0,b.useAgentSettings)(),(0,s.useCallback)(function(e){var t,n=(0,ek.convertAgentSettingsFromGQLToAiChat)(i.settings);return null==r?void 0:r.appendEvent({kind:"approvePlan",planEventId:e.planEventId,approver:e.approver,initialBuildMode:e.initialBuildMode,userSecretsResponse:null!=(t=e.userSecretsResponse)?t:{providedSecrets:[]},agentConfig:n})},[r,i.settings])),C=(0,p.default)().showError,j=null==t?void 0:t.id,T=(c=(0,o._)((l=(0,O._)({},nw,void 0),ny.useMutation(nk,l)),1)[0],f=(0,n_.default)(),h=(0,nS.useIsAgentStackRepl)().refetch,g=(0,nC.useAgentStackPlatformType)().refetch,(0,s.useCallback)(function(e){return(0,D._)(function(){return(0,L._)(this,function(t){switch(t.label){case 0:return[4,c({variables:{input:{id:f,isAgentStack:!0,agentStackPlatformType:nj[e||u.AgentStackTriggerType.TIME_BASED]}}})];case 1:return t.sent(),[4,h()];case 2:return t.sent(),[4,g()];case 3:return t.sent(),[2]}})})()},[c,f,h,g])),(0,s.useCallback)(function(e){return(0,D._)(function(){var t,r;return(0,L._)(this,function(i){switch(i.label){case 0:t=w(),i.label=1;case 1:if(i.trys.push([1,5,,6]),!_)throw Error("No plan to approve");if("approved"===t)throw Error("Plan already approved");if(_.stackBlueprint!==u.StackBlueprint.STACK_BLUEPRINT_AGENT)return[3,3];return[4,T(_.agentStackTriggerType)];case 2:i.sent(),i.label=3;case 3:return k("approved"),(0,eh.trackAgentPlanningAnalyticsEvent)({action:"plan_approved",sessionId:j,planBlueprints:_.step.blueprints,agentStackTriggerType:_.agentStackTriggerType,numPlansProposed:n,skipRapidBuild:!0,initialBuildMode:e.initialBuildMode,stackBlueprint:_.stackBlueprint}),[4,S({planEventId:_.eventId,approver:y,initialBuildMode:e.initialBuildMode})];case 4:return i.sent(),[3,6];case 5:return r=i.sent(),C((0,nh._)(r,Error)?r.message:"Failed to approve plan"),k(t),[3,6];case 6:return[2]}})})()},[S,_,C,j,n,w,k,T,y])),W=P.numPlansProposed>0,q=(0,eT.useSetAgentPlanApprovalState)(),K=(0,ed.useAgentState)().agentState,Y=(0,d.useObservableMemo)(function(){return null==K?void 0:K.map(function(e){return(null==e?void 0:e.state)===u.AgentRunState.AGENT_STATE_RUNNING})},[K]),Q=(0,eT.useProposedPlan)();switch($){case null:if(F)break;return null;case"generating":case"approved":return null;case"iterating":if(F&&!W)break;if(U||Y)return null;I=(0,a.jsx)(eb.AgentPlanApprovalDialog,{isInMobileWorkspace:B,onStartBuilding:H,stackBlueprint:null==Q?void 0:Q.stackBlueprint,sessionId:null==A?void 0:A.id});break;case"awaiting-approval":I=(0,a.jsx)(eb.AgentPlanApprovalDialog,{isInMobileWorkspace:B,onStartBuilding:H,stackBlueprint:null==Q?void 0:Q.stackBlueprint,sessionId:null==A?void 0:A.id})}return I?(0,a.jsx)(th.View,{children:I}):(0,a.jsx)(nf,{isRevising:"revising"===$,isAgentRunning:Y,isNarrowViewport:G,handleBackButtonClick:function(){q("awaiting-approval")},children:(0,a.jsx)(nl,(0,N._)((0,O._)({},P),{session:A,isVisualSelectorDisabled:"revising"===$,placeholderText:"revising"===$?nr:void 0,shouldInterruptAgentOnSubmit:!1,shouldShowChatModeControl:!1,onSubmit:function(){"revising"===$&&(0,eh.trackAgentPlanningAnalyticsEvent)({action:"plan_revision_message_sent",sessionId:null==A?void 0:A.id,skipRapidBuild:!0,stackBlueprint:null==Q?void 0:Q.stackBlueprint}),q("iterating")}}))})}function nP(e){var t,n,r,i,o=e.session,l=e.initialBuildPhase,c=(0,M._)(e,["session","initialBuildPhase"]),f=(0,m.useIsInMobileWorkspace)(),p=(0,w.useInitialBuildProposedTaskList)(o),h=(0,er.useAgentAskUserForActionRequest)(o),g=(0,d.useObservableMemo)(function(){return null==o?void 0:o.reduce(nR,100)},[o],{default:0}),x=(0,U.useDismissActionRequest)(),y=(0,U.useIsActionRequestDismissed)(),k=(0,ng.useGetInitialBuildApprovalUserSecretsResponse)(),_=(0,ng.useClearInitialBuildApprovalUserSecretsResponse)(),S=(t=(0,el.useSendAskUserForActionResponse)(o),n=(0,b.useAgentSettings)(),(0,s.useCallback)(function(e){var r=e.phase,i=e.approved,o=e.userSecretsResponse,a=e.addingIntegrationsResponse,s=e.requestEventId,l=(0,ek.convertAgentSettingsFromGQLToAiChat)(n.settings);return"visual"===r?t({type:"approveInitialBuildVisualPhaseResponse",data:{approved:i,userSecretsResponse:o,addingIntegrationsResponse:a,agentConfig:l},requestEventId:s}):t({type:"approveInitialBuildMvpResponse",data:{approved:i,userSecretsResponse:o,addingIntegrationsResponse:a,agentConfig:l},requestEventId:s})},[t,n.settings])),C=(0,s.useCallback)(function(e,t){if(null==h?void 0:h.eventId){var n,r=null!=(n=k())?n:{providedSecrets:[]};S({phase:e,approved:t.approved,userSecretsResponse:r,addingIntegrationsResponse:{connectionIds:[],rejectedConnectionIds:[],rejectedConnectorIds:[]},requestEventId:h.eventId}),x(h.eventId),_(),t.approved&&(0,eh.trackAgentAnalyticsEvent)({action:"initial_build_approved",sessionId:null==o?void 0:o.id,initialBuildMode:"visual"===e?"design":"full_build"})}},[S,h,k,x,_,null==o?void 0:o.id]),j=(0,s.useCallback)(function(e){(null==h?void 0:h.eventId)&&(e?C("visual",{approved:!1}):x(h.eventId))},[C,x,null==h?void 0:h.eventId]),T=(0,s.useCallback)(function(){(null==h?void 0:h.eventId)&&x(h.eventId)},[x,null==h?void 0:h.eventId]),E=y(null==h?void 0:h.eventId);return(l===u.InitialBuildPhase.INITIAL_BUILD_PHASE_VISUAL_COMPLETE_PENDING_REVIEW&&h&&(0,V.isKind)(h.content,"approveInitialBuildVisualPhaseRequest")&&!E&&(r=(0,a.jsx)(eb.AgentInitialBuildVisualReviewDialog,{onStart:function(){return C("visual",{approved:!0})},onDismiss:j,isInMobileWorkspace:f,visualPhaseRequestCount:g,isApprovalResponseInProgress:h.isResponseInProgress})),l===u.InitialBuildPhase.INITIAL_BUILD_PHASE_MVP_COMPLETE_PENDING_REVIEW&&h&&(0,V.isKind)(h.content,"approveInitialBuildMvpRequest")&&!E&&(p&&(i=(0,a.jsx)(es.TaskListDrawer,(0,N._)((0,O._)({},p),{approvalStatus:"proposed",placement:"bottom"}))),r=(0,a.jsx)(eb.AgentInitialBuildMVPReviewDialog,{onStart:function(){return C("mvp",{approved:!0})},onDismiss:T,isInMobileWorkspace:f,hasDrawerAbove:!!i})),r)?(0,a.jsxs)(th.View,{children:[i?(0,a.jsx)(th.View,{clsx:nI.default.drawerContainer,children:i}):null,r]}):(0,a.jsx)(nl,(0,N._)((0,O._)({},c),{session:o}))}var nD=e.i(871318),nO=e.i(59);function nN(e){var t=(0,G.useCurrentUserStoredOrgContext)(),n=t.orgId,r=t.orgSlug,i=(0,ef.useSessionError)(),o=(0,ex.useNixError)(),s=(0,ed.useAgentState)(),l=s.agentState,c=s.updateAgentState,f=(0,d.useObservableMemo)(function(){return null==l?void 0:l.map(function(e){return null==e?void 0:e.reason})},[l],{default:null}),p=(0,ei.useAgentAuthorization)(),h=p.authorizations,g=p.loading,m=p.refetch,x=p.isOwner,y=p.isOrgRepl,b=(0,eg.useGetAgentFreeUsage)(),w=b.agentUsage,k=b.loading,_=b.refetch,S=(0,ev.useIsGuestInStarterPlanUserRepl)(),C=(0,em.useIsFreemiumStarterPlanUsersOwnRepl)(),j=C.isFreemiumStarterPlanUsersOwnRepl,T=C.refetch,E=(0,$.useFlag)({controlName:"flag-freemium-ai-load-shedder"});if((0,q.default)({onChange:function(){return(0,D._)(function(){return(0,L._)(this,function(e){switch(e.label){case 0:return[4,Promise.all([_(),m(),T()])];case 1:return e.sent(),[2]}})})()}}),o)return(0,a.jsx)(et.RecoveryModeFooterDialog,{nixError:o,openPane:e.openPane});if(i)return(0,a.jsx)(ep.SessionError,{error:i});var R=!(null==h?void 0:h.paidAgent.isAuthorized)&&(null==h?void 0:h.paidAgent.code)===B.OrgAuthorizationCode.InsufficientBudget,I=(null==f?void 0:f.$kind)==="authorizationFailed"&&f.code===u.AgentAuthorizationFailedCode.INSUFFICIENT_BUDGET;if(R||I)return(0,a.jsx)(Q.BudgetExceededMessage,{runAgent:function(){return c(u.AgentRunState.AGENT_STATE_RUNNING)}});if(!k&&j&&!(null==w?void 0:w.isUnderQuota))return(0,a.jsx)(ee.FreemiumQuotaExceeded,{});if(j&&E)return(0,a.jsx)(eu.FreemiumTemporarilyUnavailable,{aiName:F.AGENT_NAME});if(S)return(0,a.jsx)(tE.Surface,{elevated:!0,children:(0,a.jsx)(ec.GuestsNotAllowedToUseAiInStarterPlanRepls,{aiName:F.AGENT_NAME})});if(!g&&!(null==h?void 0:h.paidAgent.isAuthorized)&&!(null==h?void 0:h.freeAgent.isAuthorized))if(x)return(0,a.jsx)(tE.Surface,{elevated:!0,clsx:nO.default.requiresPaymentContainer,p:8,children:(0,a.jsx)(nD.default,{owner:n&&r?{type:"org",slug:r}:void 0})});else if(y)return(0,a.jsx)(tE.Surface,{elevated:!0,css:nO.default.guestUnauthorizedContainer,children:(0,a.jsx)(ec.GuestsNotAllowedToUseAgentWhenOrgAuthzFailed,{})});else return(0,a.jsx)(tE.Surface,{elevated:!0,css:nO.default.guestUnauthorizedContainer,children:(0,a.jsx)(ec.GuestsNotAllowedToUseAgentWhenOwnerAuthzFailed,{})});return(0,a.jsx)(nM,(0,N._)((0,O._)({},e),{isLoadingUsageOrAuthorization:g||k}))}function nM(e){var t=e.numPlansProposed,n=(0,M._)(e,["numPlansProposed"]),r=(0,en.useAddingIntegrationsRequest)(n.session),i=(0,er.useAgentAskUserForActionRequest)(n.session),o=(0,eo.useInitialBuildState)(n.session),s=(0,$.useFlag)({controlName:"flag-multiple-universe",default:!1});return r&&r.eventId?s?(0,a.jsx)(Z.FooterAddMultiIntegrations,{session:n.session,addingIntegrationsRequest:r}):(0,a.jsx)(J.FooterAddIntegration,{session:n.session,addingIntegrationsRequest:r}):i&&(0,V.isKind)(i.content,"approveBlueprintRequest")?(0,a.jsx)(nL,(0,O._)({},n)):n.hasInitialPlanningLayout?(0,a.jsx)(nA,(0,N._)((0,O._)({},n),{numPlansProposed:t})):(0,eo.isInitialBuildStarted)(null==o?void 0:o.phase)?(0,a.jsx)(nP,(0,N._)((0,O._)({},n),{initialBuildPhase:null==o?void 0:o.phase})):(0,a.jsx)(nL,(0,O._)({},n))}function nL(e){var t,n,r,l,u=e.session,c=e.proposedTaskList,d=e.agentSettings,f=e.inputRef,p=(0,M._)(e,["session","proposedTaskList","agentSettings","inputRef"]),h=(0,$.useFlag)({controlName:"flag-task-list-details",default:!1}),g=(0,$.useFlag)({controlName:"flag-build-score-survey"}),x=(0,m.useIsInMobileWorkspace)(),y=(0,z.useBreakpoint)("mobileMax"),b=(0,o._)((0,s.useState)(!1),2),w=b[0],k=b[1],_=(0,ea.useQueueIsOpen)(),S=(0,o._)((0,s.useState)(!0),2),C=S[0],j=S[1],T=(0,o._)((0,s.useState)(null),2),E=T[0],R=T[1],I=(0,s.useRef)(null),A=(0,s.useCallback)(function(e){I.current=e,f&&f(e)},[f]),P=(0,er.useAgentAskUserForActionRequest)(u),D=(0,el.useSendAskUserForActionResponse)(u),L=(0,U.useDismissActionRequest)(),F=(0,U.useIsActionRequestDismissed)()(null==P?void 0:P.eventId),G=(0,s.useCallback)(function(){(null==P?void 0:P.eventId)&&(L(P.eventId),(0,H.track)(W.events.AGENT_USED,{action:"task_list_dismissed",session_id:null==u?void 0:u.id}))},[L,null==P?void 0:P.eventId,null==u?void 0:u.id]),q=(0,s.useCallback)(function(){(null==P?void 0:P.eventId)&&(L(P.eventId),(0,H.track)(W.events.AGENT_USED,{action:"query_request_dismissed",query_request_id:P.eventId,session_id:null==u?void 0:u.id}))},[L,null==P?void 0:P.eventId,null==u?void 0:u.id]),Q=(0,s.useCallback)(function(){E&&(I.current&&I.current.setValue(""),R(null))},[E]),J=(0,s.useCallback)(function(){(null==E?void 0:E.eventId)&&(L(E.eventId),"queryRequest"===E.type?(0,H.track)(W.events.AGENT_USED,{action:"query_request_dismissed",query_request_id:E.eventId,session_id:null==u?void 0:u.id}):"approveTaskListRequest"===E.type&&(0,H.track)(W.events.AGENT_USED,{action:"task_list_dismissed",session_id:null==u?void 0:u.id})),R(null)},[E,L,null==u?void 0:u.id]),Z=(0,s.useCallback)(function(e){(null==P?void 0:P.eventId)&&(d.updateSettings({chatMode:B.AgentChatMode.General}),D({type:"approveTaskListResponse",taskListEventId:e,requestEventId:P.eventId}),(0,H.track)(W.events.AGENT_USED,{action:"task_list_approved"}))},[D,P,d]),ee=(0,s.useCallback)(function(e){if(null==P?void 0:P.eventId){var t=(0,V.isKind)(P.content,"approveBlueprintRequest")?P.content.approveBlueprintRequest.blueprintName:"";D({type:"approveBlueprintResponse",blueprintEventId:P.eventId,approved:e,blueprintName:t,requestEventId:P.eventId}),L(P.eventId),(0,eh.trackAgentAnalyticsEvent)({action:"user_message_sent",sessionId:null==u?void 0:u.id,messageText:e?"Blueprint approved":"Blueprint rejected"})}},[D,P,null==u?void 0:u.id,L]),et=(0,s.useCallback)(function(e){if(null==P?void 0:P.eventId){D({type:"queryResponse",data:e,requestEventId:null==P?void 0:P.eventId});var t=e.responses,n=t.length,r=t.filter(function(e){return!(0,V.isKind)(e.responseType,"noResponse")}).length;(0,H.track)(W.events.AGENT_USED,{action:"query_response_sent",session_id:null==u?void 0:u.id,query_request_id:P.eventId,num_total_queries:n,num_queries_responded_to:r,did_respond_to_all_queries:r===n})}},[D,null==P?void 0:P.eventId,null==u?void 0:u.id]);if((0,s.useEffect)(function(){if(!C&&!E){if(c&&!F)return void R({type:"approveTaskListRequest",eventId:c.eventId});(null==P?void 0:P.content)&&!F&&R({type:P.content.$kind,eventId:P.eventId||""})}},[C,E,c,P,F]),E){if(r=(0,a.jsx)(Y.AgentRequestBanner,{requestType:E.type,onAnswerNow:Q,onDismiss:J}),"approveTaskListRequest"===E.type&&c)n=(0,a.jsx)(es.TaskListDrawer,(0,N._)((0,O._)({},c.data),{approvalStatus:"proposed",placement:"bottom",areTaskDetailsExpandable:h}));else if("queryRequest"===E.type&&(0,V.isKind)(null==P?void 0:P.content,"queryRequest")){var en=P.content.queryRequest.queries;r=(0,a.jsx)(Y.AgentRequestBanner,{requestType:"queryRequest",context:{numQueries:en.length,queries:en},onAnswerNow:Q,onDismiss:J})}}else if(c&&!F&&C)n=(0,a.jsx)(es.TaskListDrawer,(0,N._)((0,O._)({},c.data),{approvalStatus:"proposed",areTaskDetailsExpandable:h})),t=(0,a.jsx)(eb.AgentTaskListApprovalDialog,{onStart:function(){return Z(c.eventId)},onRevise:function(){return k(!0)},onCancel:G,isInMobileWorkspace:x,hasDrawerAbove:!!n});else if((0,V.isKind)(null==P?void 0:P.content,"approveBlueprintRequest")&&!F&&C)t=(0,a.jsx)(ey.AgentBlueprintApprovalDialog,{request:P.content.approveBlueprintRequest,eventId:P.eventId||"",isResponseInProgress:P.isResponseInProgress,onApprove:function(){return ee(!0)},onReject:function(){return ee(!1)}});else if((0,V.isKind)(null==P?void 0:P.content,"queryRequest")&&!F&&C){var ei=P.content.queryRequest.queries;t=(0,a.jsx)(K.AgentQueryResponseDialog,{sessionId:null==u?void 0:u.id,queries:ei,requestEventId:P.eventId||"",onSendResponse:et,onCancel:q,isResponseInProgress:P.isResponseInProgress})}var eo=t&&!w;return!w&&g&&(l=(0,a.jsx)(X.BuildScoreSurveyDialog,{})),(0,a.jsxs)(np,{isRevising:w,isNarrowViewport:y,handleBackButtonClick:function(){return k(!1)},children:[n?(0,a.jsx)(th.View,{clsx:nO.default.drawerContainer,children:n}):null,eo?t:null,(0,a.jsxs)(th.View,{clsx:(0,i._)({},nO.default.hiddenInputBoxContainer,eo),gap:8,children:[l,!r||_||n?null:(0,a.jsx)(th.View,{children:r},"banner-container"),(0,a.jsx)(nl,(0,N._)((0,O._)({},p),{session:u,proposedTaskList:c,isAwaitingTaskListApproval:w,shouldShowChatModeControl:!w,agentSettings:d,inputRef:A,onSubmit:function(){k(!1),R(null)},onInputEmptyChange:function(e){return j(e)},queueBanner:r&&_?r:void 0}),"footer-input-box")]})]})}var nB=e.i(165680),nV=e.i(112077),nF=e.i(399978),nU=e.i(445059),nG=e.i(755323);function n$(e,t){var n=(0,ew.default)(t),r=(0,eE.useChatter)(),i=(0,x.default)().fs,o=(0,tB.useEditModeState)().isEditModeActive,a=(0,e6.useVisualSelector)({context:"agent"}),l=a.clearSelection,c=a.setVisualSelectorEnabled,d=a.element,f=a.screenshotBlob,p=(0,nV.useCreateObservable)(null),h=(0,nV.useCreateObservable)(!1),g=(0,nB.useSetAgentPausedByUser)(),m=(0,s.useCallback)(function(){return(0,D._)(function(){var t,i;return(0,L._)(this,function(o){switch(o.label){case 0:if(h.current)return[2,null];if(e)return[2,e];return h.set(!0),[4,r.sessions.create({sessionType:u.SessionType.AGENT_SESSION})];case 1:if(!(i=o.sent()).ok)return p.set(i),h.set(!1),[2,null];return h.set(!1),null==(t=n.current)||t.call(n,i.payload),[2,i.payload]}})})()},[r,p,h,n,e]);return{sendMessage:(0,s.useCallback)(function(t){return(0,D._)(function(){var a,s,m,x,y,b,w,k,_,S,C,j,T;return(0,L._)(this,function(E){switch(E.label){case 0:if(h.current)return[2];if(h.set(!0),s=e)return[3,2];return[4,r.sessions.create({sessionType:u.SessionType.AGENT_SESSION})];case 1:if(!(x=E.sent()).ok)return p.set(x),h.set(!1),[2];s=x.payload,null==(m=n.current)||m.call(n,s),E.label=2;case 2:if(y=t.message,b=(0,eS._)(t.attachments),!(f&&!(null==d?void 0:d.filePath)))return[3,7];E.label=3;case 3:if(E.trys.push([3,6,,7]),w=Date.now(),k="".concat(nG.TARGETED_ELEMENT_SCREENSHOT_PREFIX).concat(w,".png"),!(_=(0,e8.blobToFile)(f,k)))return[3,5];return[4,(0,nF.uploadFiles)({parentPath:nU.ATTACHED_ASSETS_PATH,files:_?[_]:[],fs:i,onError:function(e){throw e}})];case 4:E.sent(),b.push({path:"".concat(nU.ATTACHED_ASSETS_PATH,"/").concat(k),mimeType:_.type,file:_,isLoading:!1}),E.label=5;case 5:return[3,7];case 6:return S=E.sent(),ej.captureException(S,{extra:{message:"[VisualSelector] Error processing screenshot",sessionId:s.id}}),[3,7];case 7:return C=b.map(function(e){return{path:e.path,mimeType:e.file.type}}),[4,s.appendEvent({intent:u.MessageAction.AGENT,message:y,uploadedFiles:C,kind:"message",webviewTargetedElement:null!=(T=null!=(j=t.webviewTargetedElement)?j:d)?T:void 0,agentConfig:t.agentConfig})];case 8:return E.sent(),h.set(!1),g(!1),(0,eh.trackAgentAnalyticsEvent)((0,O._)({action:"user_message_sent",messageText:t.message,sessionId:s.id,agentChatMode:(0,to.getAgentChatModeId)(t.agentConfig),autonomyLevel:(null==(a=t.agentConfig)?void 0:a.autonomyLevel)?ek.autonomyLevelMapFromAiChatEnum[t.agentConfig.autonomyLevel]:void 0},t.figma)),d&&(o?l():c(!1,{shouldClearSelection:!1})),[2]}})})()},[h,e,f,d,r.sessions,n,p,i,o,c,l,g]),ensureSession:m,error:p,loading:h}}e.s(["useSendMessage",()=>n$],533742);var nz=e.i(703774),nH=e.i(901708),nW=e.i(646983),nq=(0,s.memo)(function(e){var t,n,r,D=e.session,O=e.readFile,N=e.openPane,M=e.openPip,L=e.inputRef,B=e.secrets,V=e.onPromptSuggestionClick,F=e.onNewSession,U=e.openSession,G=e.showCheckpoints,$=e.hasInitialPlanningLayout,z=e.workspaceTourStepRef,H=e.scrollerTopPadding,W=n$(null!=D?D:null,U),q=W.sendMessage,K=W.ensureSession,Y=W.error,Q=(0,p.default)().showError;(0,l.useCurrentUserTipsQuery)(),(0,f.useObserver)(Y,{next:function(e){e&&Q("Something went wrong. Please try again.")}});var X=(0,s.useRef)(!0),J=(0,s.useRef)(new Map),Z=(0,o._)((0,s.useState)(0),2),ee=Z[0],et=Z[1],en=(0,A.useIsAgentSessionReadOnly)(null!=(t=null==D?void 0:D.id)?t:null),er=(0,C.useIsInitialAgentSession)(null!=(n=null==D?void 0:D.id)?n:null),ei=(0,m.useIsInMobileWorkspace)(),eo=(0,s.useRef)("instant");(0,s.useEffect)(function(){eo.current="smooth"},[]);var ea=$?ee:0,es=(0,h.default)(function(e){et(e.height)}),el=(0,S.useRegisterPipAnchor)({type:"agent"}),eu=(0,g.useMergeRefs)([es,el]),ec=(0,d.useObservableMemo)(function(){return null==D?void 0:D.reduce(er?y.PlanProposalReducer:y.NoOpPlanProposalReducer,"global")},[D,er],{default:{numPlansProposed:0}}).numPlansProposed,ed=D?{type:"session",session:D}:{type:void 0===D?"loading":"newSession"},ef=(0,b.useAgentSettings)(),ep=(0,w.usePlanModeProposedTaskList)(D),eh=(0,x.default)(),eg=eh.fs,em=eh.dotReplit,ev=(0,_.useFindFiles)(eg),ex=(0,k.useFileContext)({recentFilesObservable:(0,T.useRecentFilesObservable)(),getFileContext:(0,j.useGetFileContext)(eg,em)}).fileContextInclusions,ey=(0,c.useUpdateFileContextPreferences)(),eb=(0,nz.useTheme)().isDarkColorScheme;return(0,a.jsxs)(th.View,{clsx:nW.default.root,children:[ed.session?(0,a.jsx)(P.Feed,{session:ed.session,isReadOnly:en,readFile:O,sendMessage:q,openPane:N,openPip:M,secrets:B,onNewSession:F,shouldAutoScrollRef:X,scrollerTopPadding:void 0===H?0:H,scrollerBottomPadding:ea,onSessionChange:U,onShowCheckpoints:G,isAwaitingTaskListApproval:null!=ep}):null,"loading"===ed.type?(0,a.jsx)(R.LoadingState,{}):null,"newSession"===ed.type?(0,a.jsx)(nH.AutoScroller,{clsx:nW.default.emptyState,py:tf.tokens.space6,px:tf.tokens.space4,scrollCacheKey:"new-session",scrollCache:J.current,shouldAutoScrollRef:X,autoScrollBehavior:eo.current,buttonOffset:ea,children:(0,a.jsx)(I.SessionEmptyState,{sessionType:u.SessionType.AGENT_SESSION,onPromptSuggestionClick:V})}):null,(0,a.jsx)(th.View,{innerRef:z,row:!0,justify:"center",clsx:[nW.default.footerRow,(0,i._)({},nW.default.centeredVisualPlanner,$)],pb:6,children:(0,a.jsx)(tE.Surface,{background:eb?void 0:"root",clsx:[nW.default.footerContainer,(r={},(0,i._)(r,nW.default.isMobile,ei),(0,i._)(r,nW.default.isDesktop,!ei),r)],innerRef:eu,children:"loading"===ed.type?null:(0,a.jsx)(E.InMessageSecretsProvider,{children:(0,a.jsx)(nN,{onNewSession:F,inputRef:L,session:null!=D?D:null,sendMessage:q,ensureSession:K,openPane:N,hasInitialPlanningLayout:$,proposedTaskList:ep,agentSettings:ef,numPlansProposed:ec,findFiles:ev,fileContextInclusions:ex,updateFileContext:function(e){return ey(e.path,e.preference)}})})})})]})});e.s(["AgentChatSession",()=>nq],126445);var nK=["initialBuildPhaseApproval","planApproval","planProposal","queryRequest","suggestDeploy","taskListApproval","tipRecommendation","userMessage"],nY=["initialBuildPhaseApproval","planApproval","taskListApproval","userMessage"];function nQ(e){return nK.includes(e.type)}var nX=function(e){var t=[],n=null,r=-1,i=null,o=function(){if(n){var e=!!n.checkpoint||!!n.latestTaskList,r=("checkpoint"===n.firstEventType||"endOfRunSummary"===n.firstEventType)&&(n.firstCheckpoint||n.firstEndOfRunSummary),i=new Set;n.checkpointEventId&&i.add(n.checkpointEventId),n.endOfRunSummaryEventId&&i.add(n.endOfRunSummaryEventId),r&&(n.firstCheckpointEventId&&i.add(n.firstCheckpointEventId),n.firstEndOfRunSummaryEventId&&i.add(n.firstEndOfRunSummaryEventId));var o=n.allEvents.filter(function(e){return!i.has(e.id)}),a=n.allEvents.length>0?n.allEvents[0].id:n.id,s=o.length>0||!!n.checkpoint||!!n.latestTaskList||!!n.endOfRunSummary;if(n.triggerEventId&&s){if(n.triggerEventId&&r){var l=n.firstCheckpointEventId||n.firstEndOfRunSummaryEventId||n.id;t.push({type:"preRunGroup",id:l,triggerEventId:n.triggerEventId,checkpoint:n.firstCheckpoint,endOfRunSummary:n.firstEndOfRunSummary})}t.push({type:"runGroup",id:a,triggerEventId:n.triggerEventId,latestTaskList:n.latestTaskList,checkpoint:n.checkpoint,endOfRunSummary:n.endOfRunSummary,items:o,supportsViewGranularity:e})}n=null}},a=!0,s=!1,l=void 0;try{for(var u,c=e[Symbol.iterator]();!(a=(u=c.next()).done);a=!0){var d=u.value,f=d.value,p=d.id,h=d.observable;if(nQ(f)){o(),"userMessage"===f.type&&(r=t.length),t.push({type:"event",id:p,observable:h}),nQ(f)&&nY.includes(f.type)&&(i=p,n={id:p,triggerEventId:p,userMessage:"userMessage"===f.type?h:void 0,allEvents:[]});continue}switch(!n&&(n={id:p,triggerEventId:null!=i?i:void 0,allEvents:[]}),n.allEvents.push({type:"event",id:p,observable:h}),!n.firstEventType&&(n.firstEventType=f.type),f.type){case"agentToolUse":break;case"taskList":n.latestTaskList=h;break;case"checkpoint":n.firstCheckpoint||(n.firstCheckpoint=h,n.firstCheckpointEventId=p),n.checkpoint=h,n.checkpointEventId=p;break;case"endOfRunSummary":n.firstEndOfRunSummary||(n.firstEndOfRunSummary=h,n.firstEndOfRunSummaryEventId=p),n.endOfRunSummary=h,n.endOfRunSummaryEventId=p}}}catch(e){s=!0,l=e}finally{try{a||null==c.return||c.return()}finally{if(s)throw l}}return o(),{result:t,lastUserMessageIndex:r}};e.s(["mapToFeed2",()=>nX],298900);var nJ=e.i(836140),nZ=["agentMessage","agentToolUse","checkpoint","endOfRunSummary","error","planApproval","planProposal","queryRequest","revert","subagent","taskListApproval","taskList","tipRecommendation","userMessage"],n0=function(){var e=(0,nJ.getAgentEventsTransformer)({});return{direction:"reverse",state:e.state,transformer:function(t,n){var r=e.transformer(t,n);if(r&&nZ.includes(r.type))return r}}},n1=function(){return(0,nJ.getAgentEventsTransformer)({})};e.s(["getLogsViewTransformer",()=>n1,"getTasksViewTransformer",()=>n0],382671);var n2=(0,s.memo)(function(e){var t,n,r,c=e.session,x=e.readFile,k=e.openPane,_=e.openPip,j=e.inputRef,T=e.secrets,D=e.onPromptSuggestionClick,O=e.onNewSession,N=e.openSession,M=e.showCheckpoints,L=e.hasInitialPlanningLayout,B=e.workspaceTourStepRef,V=e.scrollerTopPadding,F=e.selectedView,U=n$(null!=c?c:null,N),G=U.sendMessage,$=U.ensureSession,z=U.error,H=(0,p.default)().showError;(0,l.useCurrentUserTipsQuery)(),(0,f.useObserver)(z,{next:function(e){e&&H("Something went wrong. Please try again.")}});var W=(0,s.useRef)(!0),q=(0,s.useRef)(new Map),K=(0,o._)((0,s.useState)(0),2),Y=K[0],Q=K[1],X=(0,A.useIsAgentSessionReadOnly)(null!=(t=null==c?void 0:c.id)?t:null),J=(0,C.useIsInitialAgentSession)(null!=(n=null==c?void 0:c.id)?n:null),Z=(0,m.useIsInMobileWorkspace)(),ee=(0,s.useRef)("instant");(0,s.useEffect)(function(){ee.current="smooth"},[]);var et=L?Y:0,en=(0,h.default)(function(e){Q(e.height)}),er=(0,S.useRegisterPipAnchor)({type:"agent"}),ei=(0,g.useMergeRefs)([en,er]),eo=(0,d.useObservableMemo)(function(){return null==c?void 0:c.reduce(J?y.PlanProposalReducer:y.NoOpPlanProposalReducer,"global")},[c,J],{default:{numPlansProposed:0}}).numPlansProposed,ea=c?{type:"session",session:c}:{type:void 0===c?"loading":"newSession"},es=(0,b.useAgentSettings)(),el=(0,w.usePlanModeProposedTaskList)(c),eu=(0,nz.useTheme)().isDarkColorScheme,ec=(0,s.useMemo)(function(){return"tasks"===F?n0():n1()},[F]),ed="tasks"===F?nX:void 0;return(0,a.jsxs)(th.View,{clsx:nW.default.root,children:[ea.session?(0,a.jsx)(P.Feed,{session:ea.session,isReadOnly:X,readFile:x,sendMessage:G,openPane:k,openPip:_,secrets:T,onNewSession:O,shouldAutoScrollRef:W,scrollerTopPadding:void 0===V?0:V,scrollerBottomPadding:et,onSessionChange:N,onShowCheckpoints:M,isAwaitingTaskListApproval:null!=el,transformer:ec,feedMapperFn:ed}):null,"loading"===ea.type?(0,a.jsx)(R.LoadingState,{}):null,"newSession"===ea.type?(0,a.jsx)(nH.AutoScroller,{clsx:nW.default.emptyState,py:tf.tokens.space6,px:tf.tokens.space4,scrollCacheKey:"new-session",scrollCache:q.current,shouldAutoScrollRef:W,autoScrollBehavior:ee.current,buttonOffset:et,children:(0,a.jsx)(I.SessionEmptyState,{sessionType:u.SessionType.AGENT_SESSION,onPromptSuggestionClick:D})}):null,(0,a.jsx)(th.View,{innerRef:B,row:!0,justify:"center",clsx:[nW.default.footerRow,(0,i._)({},nW.default.centeredVisualPlanner,L)],pb:6,children:(0,a.jsx)(tE.Surface,{background:eu?void 0:"root",clsx:[nW.default.footerContainer,(r={},(0,i._)(r,nW.default.isMobile,Z),(0,i._)(r,nW.default.isDesktop,!Z),r)],innerRef:ei,children:"loading"===ea.type?null:(0,a.jsx)(E.InMessageSecretsProvider,{children:(0,a.jsx)(nN,{onNewSession:O,inputRef:j,session:null!=c?c:null,sendMessage:G,ensureSession:$,openPane:k,hasInitialPlanningLayout:L,proposedTaskList:el,agentSettings:es,numPlansProposed:eo})})})})]})});e.s(["AgentChatSession2",()=>n2],59540);var n3=e.i(166876),n4={direction:"reverse",state:{data:null,hasUserMessage:!1},map:function(e){return e.data},reducer:function(e,t){if((0,nT.isEventContentsKind)(e,"messageEventContents")&&e.sender.type===u.UserType.USER){t.hasUserMessage=!0;return}var n=(0,nT.getEventAgentToolDataFor)(e,"taskListData");if(null!=n)return!((0,n3.isPlanModeProposedTaskList)(n)||(0,n3.isFullyCompletedTaskList)(n.tasks)&&t.hasUserMessage)&&(t.data=n,!1)}};function n8(e){var t=(0,eo.useInitialBuildState)(e),n=(0,d.useObservableMemo)(function(){return null==e?void 0:e.reduce(n4,100)},[e],{default:void 0});if((null==t?void 0:t.phase)!==u.InitialBuildPhase.INITIAL_BUILD_PHASE_MVP_COMPLETE_PENDING_REVIEW)return n}e.s(["useActiveTaskList",()=>n8],93094);var n5=e.i(990313),n6=e.i(279659),n9=e.i(802297),n7=e.i(235381),re=e.i(541793),rt=e.i(304277);function rn(){var e=(0,nv._)(["\n  query ThemeOverlayAvailability($replId: String!) {\n    getRepl(id: $replId) {\n      ... on Repl {\n        id\n        timeCreated\n      }\n    }\n  }\n"]);return rn=function(){return e},e}e.i(566901);var rr={},ri=(0,nx.gql)(rn()),ro=e.i(33864),ra=new Set(["background","foreground","card","card-foreground","popover","popover-foreground","primary","primary-foreground","secondary","secondary-foreground","muted","muted-foreground","accent","accent-foreground","destructive","destructive-foreground","border","input","ring","font-sans","font-serif","font-mono","radius"]),rs=new Date("2024-08-15T00:00:00.000Z"),rl=(0,re.atom)(!1);(0,re.atom)(null,function(e,t){t(rl,!0)});var ru=(0,re.atom)(null,function(e,t){t(rl,!1)}),rc=(0,re.atom)(null,function(e,t){t(rl,function(e){return!e})});function rd(){return(0,eE.useSet)(ru)}function rf(){var e,t,n=(0,n_.default)(),r=(0,ro.useCartographerSupportsThemes)(),i=(0,$.useFlag)({controlName:"flag-app-themes"}),o=(e={variables:{replId:n},skip:!i},t=(0,O._)({},rr,e),rt.useQuery(ri,t)).data,a=(0,n6.useThemeFile)(),l=a.theme,u=a.error,c=(0,s.useMemo)(function(){if(!(null==o?void 0:o.getRepl))return!1;var e=o.getRepl;return"Repl"===e.__typename&&new Date(e.timeCreated)>=rs},[o]),d=(0,s.useMemo)(function(){if(u||!l)return!1;var e=l[":root"];if(!e)return!1;var t=new Set(Object.keys(e));if(t.size<ra.size)return!1;var n=!0,r=!1,i=void 0;try{for(var o,a=ra[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var s=o.value;if(!t.has(s))return!1}}catch(e){r=!0,i=e}finally{try{n||null==a.return||a.return()}finally{if(r)throw i}}return!0},[l,u]);return(0,s.useMemo)(function(){return!!r&&!!i&&!!c&&!!d},[i,c,d,r])}function rp(){return{isThemeOverlayVisible:(0,eE.useValue)(rl),toggleThemeOverlay:(0,eE.useSet)(rc)}}e.s(["useHideThemeOverlay",()=>rd,"useThemeOverlay",()=>rp,"useThemeOverlayAvailability",()=>rf],193292);var rh=e.i(765665),rg=e.i(721321),rm=e.i(929417),rv=e.i(842530),rx=e.i(549762),ry=e.i(900876),rb=e.i(347647),rw=e.i(509661);function rk(){var e,t=(0,n5.useAppThemeTracking)().trackAppTheme,n=rd(),r=(0,n7.useThemeData)(),i=r.theme,o=r.loading,l=r.error,u=r.currentMode,c=r.setCurrentMode,d=r.save,f=r.discard,p=r.applyTheme,h=r.hasUnsavedChanges,g=r.hasUnpublishedChanges,m=r.selectedDatabaseTheme,x=r.setSelectedDatabaseTheme,y=r.publish,b=(0,n9.useWorkspaceThemePreview)().applyThemePreview,w=(0,$.useFlag)({controlName:"flag-app-themes-dark-mode"});return e=function(e){c(e),i&&b(i,e),t(W.events.APP_THEME,{action:"dark_mode_toggled",mode:e})},(0,s.useEffect)(function(){var t=function(t){var n;if(null==(n=t.data)?void 0:n.type)switch(t.data.type){case"DARK_MODE_USED":e("dark");break;case"LIGHT_MODE_USED":e("light")}};return window.addEventListener("message",t),function(){window.removeEventListener("message",t)}},[e]),(0,a.jsxs)(th.View,{p:8,className:rw.default.overlayContainer,children:[(0,a.jsxs)(tE.Surface,{row:!0,align:"center",justify:"center",p:8,children:[(0,a.jsx)(tT.IconButton,{alt:"Back",onClick:n,style:{position:"absolute",left:8},children:(0,a.jsx)(rx.default,{})}),(0,a.jsxs)(th.View,{row:!0,align:"center",justify:"space-between",gap:4,children:[(0,a.jsx)(no.Text,{children:"App Theme"}),(0,a.jsx)(nu.Pill,{colorway:"primary",text:"Beta"})]})]}),(0,a.jsxs)(th.View,{className:rw.default.scrollArea,children:[l?(0,a.jsx)(rm.TopBanner,{text:"Error loading theme",colorway:"negative"}):null,o&&!i?(0,a.jsx)(tE.Surface,{p:16,style:{borderRadius:"8px"},children:(0,a.jsx)(no.Text,{variant:"text",children:"Loading theme..."})}):null,i?(0,a.jsxs)(th.View,{gap:16,px:8,children:[(0,a.jsx)(rv.ThemeSelect,{state:{theme:i,loading:o,hasUnsavedChanges:h,hasUnpublishedChanges:g,selectedDatabaseTheme:m,setSelectedDatabaseTheme:x},operations:{applyTheme:p,save:d,discard:f,publish:y,onComplete:function(){}}}),w?(0,a.jsxs)(th.View,{gap:8,children:[(0,a.jsx)(no.Text,{variant:"small",color:"dimmest",children:"Your app supports both light and dark mode. Use this toggle to edit the style variables used in each mode."}),(0,a.jsxs)(rg.ButtonGroup,{name:"theme-mode",value:u,onChange:function(e){c(e),b(i,e),t(W.events.APP_THEME,{action:"dark_mode_toggled",mode:e})},row:!0,stretch:!0,primary:!0,children:[(0,a.jsx)(rg.ButtonGroupItem,{id:"light-mode",value:"light",text:"Light mode",icon:(0,a.jsx)(rb.default,{})}),(0,a.jsx)(rg.ButtonGroupItem,{id:"dark-mode",value:"dark",text:"Dark mode",icon:(0,a.jsx)(ry.default,{})})]})]}):null,(0,a.jsx)(tE.Surface,{className:rw.default.divider}),(0,a.jsx)(rh.ThemeControls,{})]}):null]})]})}function r_(){(0,nz.useTheme)();var e=(0,n6.useThemeFile)(),t=e.theme,n=e.loading,r=e.error,i=e.saveSchema,o=e.setTheme;return(0,a.jsx)(n7.ThemeDataProvider,{theme:t,setTheme:o,loading:n,error:r,saveSchema:i,children:(0,a.jsx)(rk,{})})}e.s(["ThemeOverlay",()=>r_],542635);var rS=e.i(446530),rC=e.i(613355),rj=e.i(761922),rT=e.i(658975),rE=e.i(515313),rR=(0,rS.cssRecord)({wrapper:[rC.rcss.position.absolute,{top:0,right:0,bottom:0,left:0,zIndex:999,display:"flex",alignItems:"center",justifyContent:"center",borderBottomLeftRadius:8,borderBottomRightRadius:8,overflow:"hidden"}],overlay:[rC.rcss.position.absolute,{top:0,right:0,bottom:0,left:0,backgroundColor:tf.tokens.blueDimmer,opacity:.8}],content:[rC.rcss.center,{position:"relative",zIndex:1}]});function rI(){return(0,a.jsxs)(th.View,{css:rR.wrapper,children:[(0,a.jsx)(th.View,{css:rR.overlay}),(0,a.jsxs)(th.View,{css:rR.content,gap:12,children:[(0,a.jsxs)(th.View,{row:!0,gap:8,align:"center",children:[(0,a.jsx)(rT.default,{size:32}),(0,a.jsx)(rj.default,{size:32}),(0,a.jsx)(rE.default,{size:32})]}),(0,a.jsx)(no.Text,{variant:"subheadDefault",children:"Drop files here to add to conversation"})]})]})}function rA(){var e=(0,x.default)().fs;return(0,s.useCallback)(function(t){var n=t.files,r=t.onError;return(0,D._)(function(){return(0,L._)(this,function(t){switch(t.label){case 0:return[4,(0,nF.uploadFiles)({parentPath:nU.ATTACHED_ASSETS_PATH,files:n,fs:e,overwrite:!0,onError:function(e){return r(e.error)}})];case 1:return t.sent(),[2]}})})()},[e])}e.s(["default",()=>rI],286645),e.s(["useUploadFilesHandler",()=>rA],833887)},334878,897676,e=>{"use strict";var t=e.i(389959),n=e.i(986194);e.i(877212);var r=e.i(924908),i=e.i(145864);function o(e){var o=(0,t.useRef)(!1),a=(0,i.useProposedPlan)();(0,r.useChatHook)("received-completed-event",function(t){if(!o.current){var r=t.event.contents.contents;if((0,n.isKind)(r,"agentPlanEventContents")){if(!(null==(i=r.agentPlanEventContents.Approver)?void 0:i.approver.id))return;var i,s=r.agentPlanEventContents.stackBlueprint;o.current=!0,e(s)}(0,n.isKind)(r,"approvePlanEventContents")&&(o.current=!0,e(null==a?void 0:a.stackBlueprint))}})}e.s(["useOnInitialPlanApproval",()=>o],334878);var a=e.i(814563),s=e.i(282453),l=e.i(852819),u=(0,a.createJSONStorage)(function(){return{getItem:function(e){return s.default.get(e,"string")},setItem:function(e,t){return s.default.set(e,t)},removeItem:function(e){return s.default.remove(e)}}}),c=(0,a.atomWithStorage)("selectedAgentFeedView","logs",u);function d(){return[(0,l.useValue)(c),(0,l.useSet)(c)]}e.s(["useSelectedFeedViewState",()=>d],897676)},461062,e=>{e.v({futureCheckpoint:"Session-module__tv_2Ea__futureCheckpoint",isDesktop:"Session-module__tv_2Ea__isDesktop"})},925410,e=>{e.v({checkpoint:"Checkpoints-module__PUDBBa__checkpoint",checkpointLine:"Checkpoints-module__PUDBBa__checkpointLine",dashed:"Checkpoints-module__PUDBBa__dashed",highlight:"Checkpoints-module__PUDBBa__highlight","highlight-bg":"Checkpoints-module__PUDBBa__highlight-bg",scroll:"Checkpoints-module__PUDBBa__scroll",session:"Checkpoints-module__PUDBBa__session",sessionCheckpoint:"Checkpoints-module__PUDBBa__sessionCheckpoint",toggleCollapsedButton:"Checkpoints-module__PUDBBa__toggleCollapsedButton"})},623129,e=>{"use strict";var t=e.i(297083),n=e.i(721281),r=e.i(878420),i=e.i(64386),o=e.i(530658),a=e.i(346715),s=e.i(817556),l=e.i(276385),u=e.i(389959),c=e.i(338188);e.i(877212);var d=e.i(924908);e.i(925218);var f=e.i(112077),p=e.i(267103),h=e.i(849954),g=e.i(436725),m=e.i(190120),x=e.i(287999),y=e.i(646136),b=e.i(188507),w=e.i(641555),k=e.i(441329),_=e.i(480028),S=e.i(140487),C=e.i(960178),j=e.i(257811),T=e.i(625484),E=e.i(654521),R=e.i(782096),I=e.i(461062);function A(e){var t=e.session,n=e.openSession,r=e.isActiveSession,i=e.hideTitle,o=(0,w.useObservableMemo)(function(){return null==t?void 0:t.data.select(function(e){return{title:e.title,created:e.created,taskId:e.taskId}})},[t]);return t?(0,l.jsxs)(T.View,{row:!0,justify:"space-between",px:8,gap:12,children:[(0,l.jsxs)(T.View,{grow:!0,shrink:!0,children:[i?null:(0,l.jsx)(C.Text,{color:(null==o?void 0:o.title)?void 0:"dimmest",children:(null==o?void 0:o.title)||"Thinking"}),(0,l.jsx)(T.View,{children:(0,l.jsxs)(T.View,{row:!0,py:4,gap:4,align:"center",children:[(0,l.jsx)(C.Text,{color:"dimmest",variant:"small",children:"Chat started"}),o?(0,l.jsx)(j.Timestamp,{date:o.created,textColor:"dimmest",textVariant:"small",live:!0}):null]})})]}),t?(0,l.jsx)(S.Button,{text:r?"Continue chat":"View chat",size:"small",variant:"default",iconRight:(0,l.jsx)(R.default,{}),colorway:r?"blurple":void 0,onClick:function(){return n(t)}}):null]}):(0,l.jsx)(T.View,{row:!0,justify:"space-between",px:8,gap:12,children:(0,l.jsxs)(T.View,{grow:!0,shrink:!0,children:[(0,l.jsx)(C.Text,{children:"History from source app"}),(0,l.jsx)(T.View,{row:!0,py:4,gap:4,align:"center",children:(0,l.jsx)(C.Text,{color:"dimmest",variant:"small",children:"Checkpoints inherited from the app you remixed"})})]})})}function P(e){var t=(0,p.useObservable)(e.agentState),r="",i=_.tokens.foregroundDimmer;switch(null==t?void 0:t.state){case b.AgentRunState.AGENT_STATE_RUNNING:i=_.tokens.blurpleStronger,r="Agent is running";break;case b.AgentRunState.AGENT_STATE_PAUSING:r="Agent is pausing";break;default:r="Agent is waiting for your response"}var o=(0,k.useIsInMobileWorkspace)();return r?(0,l.jsx)(T.View,{py:6,px:8,row:!0,align:"center",gap:8,justify:"space-between",clsx:[I.default.futureCheckpoint,(0,n._)({},I.default.isDesktop,!o)],children:(0,l.jsxs)(T.View,{row:!0,align:"center",gap:8,children:[(0,l.jsx)(E.default,{color:i}),(0,l.jsx)(T.View,{children:(0,l.jsx)(C.Text,{color:"dimmer",children:r})})]})}):null}var D=e.i(526962),O=e.i(417120),N=e.i(281128),M=e.i(929872),L=e.i(608434),B=e.i(925410),V=new Set,F=(0,u.createContext)(null),U=(0,u.forwardRef)(function(e,t){var n=e.children,r=e.style;return(0,l.jsx)(T.View,{innerRef:t,style:r,children:n})});U.displayName="NonStickyItem";var G=(0,u.forwardRef)(function(e,t){var n=e.children,o=e.style,a=e.index,s=(0,u.useContext)(F);if(!s)throw Error("StickyItem must be used within StickyIndexContext");var c=(0,p.useObservable)(s.activeIndex),d=(0,p.useObservable)(s.scrollProgress),f=c===a;return(0,l.jsx)(T.View,{innerRef:t,style:(0,r._)((0,i._)((0,r._)({},o),{zIndex:1}),f&&{position:"sticky",top:0,transform:f?"translateY(".concat(-(100*d),"%)"):void 0}),children:n})});G.displayName="StickyItemInner";var $=(0,u.forwardRef)(function(e,t){var n=e.children,r=e.style,i=e.index;return V.has(i)?(0,l.jsx)(G,{style:r,index:i,ref:t,children:n}):(0,l.jsx)(U,{style:r,index:i,ref:t,children:n})});$.displayName="StickyItem";var z=(0,u.memo)(function(e){var t=e.index,i=e.row,o=e.openSession,a=e.stickyHeaderRef,s=(0,u.useContext)(F);if(!s)throw Error("SessionItem must be used within StickyIndexContext");var c=t===(0,p.useObservable)(s.activeIndex);return(0,l.jsx)(M.Surface,{py:12,clsx:[B.default.session,(0,n._)({},B.default.sessionCheckpoint,i.hasCheckpoint)],style:(0,r._)({},!c&&{backgroundColor:_.tokens.backgroundDefault}),innerRef:c?a:void 0,children:(0,l.jsx)(A,{session:i.session,openSession:o,isActiveSession:i.isActive,hideTitle:i.hasCheckpoint})})}),H=(0,u.memo)(function(e){var n,i,b,w,k,_,S,C,j,E,R,I,A,M,U,G,H,K,Y,Q,X,J=(0,O.useAgentState)().agentState,Z=e.openPane,ee=e.openSession,et=e.navigatingFromSessionId,en=e.scrollPosition,er=e.onScrollPositionChange,ei=e.saveScrollPositionRef,eo=(0,x.useCheckpoints)(),ea=eo.checkpoints,es=eo.loading,el=eo.renameCommit,eu=(0,p.useObservable)(ea),ec=(M=(null==eu?void 0:eu.ok)?eu.value:null,U=(0,d.useChatter)(),H=null==(G=(0,p.useObservable)(U.sessions.agent.current))?void 0:G.id,Y=(K=(0,o._)((0,u.useState)(new Set),2))[0],Q=K[1],{list:(0,u.useMemo)(function(){if(!M)return null;var e=[],t=!0,n=!1,r=void 0;try{for(var i,o=M[Symbol.iterator]();!(t=(i=o.next()).done);t=!0){var a=i.value;a.session&&e.push({type:"session",session:a.session,hasCheckpoint:a.commitRanges.length>0,isActive:a.session.id===H});var s=!0,l=!1,u=void 0;try{for(var c,d,f=a.commitRanges[Symbol.iterator]();!(s=(d=f.next()).done);s=!0){var p=d.value,h=null==(b=p.commitRange[0])?void 0:b.hash;if(p.collapsed){var g=!Y.has(h);if(e.push({type:"collapsed",count:p.commitRange.length,id:h,collapsed:g}),g)continue}var m=!0,x=!1,y=void 0;try{for(var b,w,k=p.commitRange[Symbol.iterator]();!(m=(w=k.next()).done);m=!0){var _,S=w.value;e.push({type:"commit",commit:S,sessionId:null==(_=a.session)?void 0:_.id,isReverted:p.collapsed})}}catch(e){x=!0,y=e}finally{try{m||null==k.return||k.return()}finally{if(x)throw y}}}}catch(e){l=!0,u=e}finally{try{s||null==f.return||f.return()}finally{if(l)throw u}}a.session&&(null==(c=a.session)?void 0:c.id)===H&&e.push({type:"future",session:a.session})}}catch(e){n=!0,r=e}finally{try{t||null==o.return||o.return()}finally{if(n)throw r}}return e},[M,Y,H]),toggleCommitRange:(0,u.useCallback)(function(e){Q(function(t){return(0,N.create)(t,function(t){t.has(e)?t.delete(e):t.add(e)})})},[])}),ed=(0,u.useCallback)(function(e){return Z({type:"git",data:{mode:{type:D.GitPaneModeType.COMMIT,hash:e}}})},[Z]),ef=(0,d.useChatter)(),ep=(0,p.useObservable)(ef.sessions.agent.current),eh=(0,u.useCallback)(function(e){var n=e.commitId,i=e.title,o=e.eventId,a=e.sessionId,l=e.args;return(0,t._)(function(){return(0,s._)(this,function(e){switch(e.label){case 0:if(!ep)return[2];return[4,(0,h.revert)((0,r._)({chatter:ef,commitId:n,title:i,onSessionChange:ee,currentSession:ep,revertedToEventId:o,revertedToSessionId:a},l))];case 1:return e.sent(),[2]}})})()},[ef,ee,ep]),eg=!eu,em=(null==eu?void 0:eu.ok)&&0===eu.value.length,ev=(0,u.useRef)(null),ex=(0,f.useCreateObservable)(0),ey=(0,f.useCreateObservable)(0),eb=(0,u.useRef)(null),ew=(0,o._)((0,u.useState)(0),2),ek=ew[0],e_=ew[1],eS=ec.list,eC=(0,u.useMemo)(function(){if(!eS)return new Set;var e=new Set;return eS.forEach(function(t,n){"session"===t.type&&e.add(n)}),e},[eS]);(0,u.useEffect)(function(){V.clear(),eC.forEach(function(e){return V.add(e)})},[eC]),(0,u.useEffect)(function(){eb.current&&e_(eb.current.getBoundingClientRect().height)},[eS]),(0,u.useEffect)(function(){ev.current&&void 0!==en?ev.current.scrollTo(en):ev.current&&eS&&eS.length>0&&ev.current.scrollToIndex(eS.length-1,{align:"end"})},[eS,en,er]);var ej=(i=(n={list:eS,navigatingFromSessionId:et,vListRef:ev}).list,b=n.navigatingFromSessionId,w=n.vListRef,k=(0,u.useRef)(new Map),_=(0,u.useRef)(!1),S=(0,u.useRef)(!1),C=(0,u.useMemo)(function(){return(null==i?void 0:i.length)&&b?function(e,t){for(var n=t.findIndex(function(t){return"session"===t.type&&t.session.id===e}),r=-1===n?t.length-1:n,i=t.length-1,o=r+1;o<t.length;o++)if("session"===t[o].type){i=o-1;break}return{start:r,end:i}}(b,i):null},[i,b]),(0,u.useEffect)(function(){var e=w.current;C&&e&&!_.current&&(_.current=!0,w.current.scrollToIndex(C.start,{align:"center",smooth:!1}))},[w,C]),{onScrollEnd:(0,u.useCallback)(function(){if(!S.current&&C){S.current=!0;for(var e,t=C.start;t<=C.end;t++)null==(e=k.current.get(t))||e()}},[C]),setRowRef:(0,u.useCallback)(function(e){null===e.highlight?k.current.delete(e.index):k.current.set(e.index,e.highlight)},[])}),eT=ej.onScrollEnd,eE=ej.setRowRef,eR=(j=ev,E=null!=(X=null==eS?void 0:eS.length)?X:0,R=(0,f.useCreateObservable)(!1),I=(0,u.useCallback)(function(){var e;null==(e=j.current)||e.scrollToIndex(E,{smooth:!0,align:"end"})},[j,E]),A=(0,u.useCallback)(function(){var e=j.current;if(e){var t=Math.round(e.scrollSize-e.viewportSize-e.scrollOffset);R.set(t>36)}},[R,j]),{show:R,onScroll:A,onClick:I});(0,u.useEffect)(function(){eS&&ev.current&&setTimeout(function(){eR.onScroll()},0)},[eS,en,eR]);var eI=(0,u.useCallback)(function(){if(ev.current){var e,t,n=ev.current.findStartIndex(),r=null!=(t=(0,a._)(V).reverse().find(function(e){return n>=e}))?t:(e=Math).min.apply(e,(0,a._)(V));if(void 0!==r){ex.set(r);var i=(0,a._)(V).sort(function(e,t){return e-t}),o=i.indexOf(r),s=i[o+1];if(void 0!==s){var l=ev.current.getItemOffset(s)-ev.current.scrollOffset;if(l<=ek&&l>=0){var u=(ek-l)/ek;ey.set(u)}else ey.set(0)}else ey.set(0)}eR.onScroll()}},[eR,ek,ex,ey]);if((0,u.useEffect)(function(){ei&&(ei.current=function(){ev.current&&er&&er(ev.current.scrollOffset)})},[ei,er]),es&&(eg||em))return(0,l.jsx)(g.LoadingState,{});var eA=eC.size>0?(0,a._)(eC):void 0;return(0,l.jsxs)(T.View,{grow:!0,shrink:!0,children:[(0,l.jsx)(F.Provider,{value:{activeIndex:ex,scrollProgress:ey},children:(0,l.jsx)(c.VList,{clsx:B.default.scroll,ref:ev,item:$,keepMounted:eA,onScrollEnd:eT,onScroll:eI,children:null==eS?void 0:eS.map(function(t,n){switch(t.type){case"session":return(0,l.jsx)(W,{index:n,highlightRef:eE,children:(0,l.jsx)(z,{index:n,row:t,openSession:e.openSession,stickyHeaderRef:eb})},t.session.id);case"commit":var r,i,o,a=t.commit,s=t.isReverted;switch(null==(r=eS[n+1])?void 0:r.type){case"commit":i="solid";break;case"future":i="dashed"}return(0,l.jsx)(W,{index:n,highlightRef:eE,children:(0,l.jsx)(q,{line:i,children:(0,l.jsx)(m.CheckpointCard,{isTimelineListItem:!0,author:a.authoredBy,variant:m.CheckpointCardVariant.SessionList,title:null!=(o=a.customSubject)?o:a.subject,date:new Date(a.committer.date),commitId:a.hash,onRevert:function(e){var t;return null==eh?void 0:eh({commitId:a.hash,title:null!=(t=a.customSubject)?t:a.subject,eventId:a.eventId,sessionId:a.sessionId,args:e})},onRenameTitle:function(e){return null==el?void 0:el(a.hash,e||a.subject)},screenshot:a.screenshotUrl,onOpenCommit:function(){return ed(a.hash)},isReverted:s},a.hash)},t.commit.hash)},t.commit.hash);case"collapsed":return(0,l.jsx)(W,{index:n,highlightRef:eE,children:(0,l.jsx)(y.CollapsedCheckpointsToggle,{onToggle:function(){return ec.toggleCommitRange(t.id)},count:t.count,collapsed:t.collapsed,className:B.default.toggleCollapsedButton})},"toggle"+t.id);case"future":return J?(0,l.jsx)(P,{agentState:J},t.session.id+"future"):null}})})}),(0,l.jsx)(L.ScrollToLatestButton,{show:eR.show,onClick:eR.onClick})]})});function W(e){var t=e.children,n=e.index,r=e.highlightRef,i=(0,u.useRef)(null);return(0,u.useEffect)(function(){return r({index:n,highlight:function(){var e;null==(e=i.current)||e.classList.add(B.default.highlight)}}),function(){r({index:n,highlight:null})}},[r,n]),(0,l.jsx)(T.View,{innerRef:i,children:t})}function q(e){return(0,l.jsxs)(T.View,{px:8,py:12,clsx:B.default.checkpoint,children:[e.line?(0,l.jsx)("div",{clsx:[B.default.checkpointLine,"dashed"===e.line&&B.default.dashed]}):null,e.children]})}e.s(["CheckpointsScreen",()=>H],623129)},832074,e=>{e.v({agentBadge:"Header-module__IC53hG__agentBadge",checkpointMade:"Header-module__IC53hG__checkpointMade",checkpointMadeIcon:"Header-module__IC53hG__checkpointMadeIcon",checkpointMadeText:"Header-module__IC53hG__checkpointMadeText","icon-animate":"Header-module__IC53hG__icon-animate",root:"Header-module__IC53hG__root",surface:"Header-module__IC53hG__surface","text-animate":"Header-module__IC53hG__text-animate"})},205413,e=>{e.v({content:"index-module__-XHOOa__content",enter:"index-module__-XHOOa__enter",enterActive:"index-module__-XHOOa__enterActive",exit:"index-module__-XHOOa__exit",exitActive:"index-module__-XHOOa__exitActive",isInMobileWorkspace:"index-module__-XHOOa__isInMobileWorkspace",root:"index-module__-XHOOa__root",taskListDrawerContainer:"index-module__-XHOOa__taskListDrawerContainer"})},700966,728821,84104,698053,602399,108232,953299,398014,e=>{"use strict";var t=e.i(297083),n=e.i(721281),r=e.i(878420),i=e.i(64386),o=e.i(530658),a=e.i(817556),s=e.i(276385),l=e.i(389959),u=e.i(401262),c=e.i(977268),d=e.i(241939);e.i(877212);var f=e.i(145864),p=e.i(204203);e.i(925218);var h=e.i(267103),g=e.i(993796),m=e.i(98816),x=e.i(222342),y=e.i(207237),b=e.i(441329),w=e.i(126445),k=e.i(59540),_=e.i(690767),S=e.i(93094),C=e.i(542635),j=e.i(193292),T=e.i(66830),E=e.i(286645),R=e.i(900433),I=e.i(833887),A=e.i(287999),P=e.i(376847),D=e.i(231346),O=e.i(759967),N=e.i(200119),M=e.i(334878),L=e.i(897676),B=e.i(623129),V=e.i(188507),F=e.i(924908),U=e.i(641555),G=e.i(802088),$=e.i(659790),z=e.i(429878),H=e.i(721321),W=e.i(751273),q=e.i(559482),K=e.i(585124);function Y(e){var t=e.selectedView,n=e.onViewChange;return(0,s.jsxs)(H.ButtonGroup,{name:"agent-view-selector",value:t,onChange:n,row:!0,children:[(0,s.jsx)(W.Tooltip,{tooltip:"Show feed as run groups (new)",children:(0,s.jsx)(H.ButtonGroupItem,{id:"view-tasks",value:"tasks",icon:(0,s.jsx)(q.default,{})})}),(0,s.jsx)(W.Tooltip,{tooltip:"Show feed as full work log",children:(0,s.jsx)(H.ButtonGroupItem,{id:"view-logs",value:"logs",icon:(0,s.jsx)(K.default,{})})})]})}var Q=e.i(140487),X=e.i(136540),J=e.i(739521),Z=e.i(929872),ee=e.i(960178),et=e.i(625484),en=e.i(352767),er=e.i(717368),ei=e.i(753007),eo=e.i(961864),ea=e.i(144459),es=e.i(832074);function el(e){var t=(0,g.useFlag)({controlName:"flag-agent-debug-info-button"}),n=(0,g.useFlag)({controlName:"flag-agent-pane-rework",default:!1})&&"session"===e.screen;return(0,s.jsx)(Z.Surface,{row:!0,align:"end",clsx:[es.default.root],children:(0,s.jsxs)(Z.Surface,{row:!0,gap:12,clsx:es.default.surface,align:"center",justify:"space-between",children:["checkpoints"===e.screen?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(X.IconButton,{size:32,alt:"Back",onClick:function(){return e.onAction("goBack")},children:(0,s.jsx)(en.default,{})}),(0,s.jsx)(et.View,{grow:!0,shrink:!0,align:"center",justify:"center",children:(0,s.jsx)(ed,{})}),(0,s.jsx)(X.IconButton,{size:32,disabled:e.disableNewSessionButton,alt:"New chat",onClick:function(){return e.onAction("newChat")},children:(0,s.jsx)(er.default,{})})]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(X.IconButton,{size:32,alt:"History",onClick:function(){return e.onAction("showCheckpoints")},children:(0,s.jsx)(eo.default,{})}),(0,s.jsxs)(et.View,{row:!0,gap:4,grow:!0,shrink:!0,justify:"center",align:"center",children:[(0,s.jsx)(ec,{sessionId:e.sessionId,sessionTitle:e.sessionTitle,viewSelector:n&&e.selectedFeedView&&e.onFeedViewChange?(0,s.jsx)(Y,{selectedView:e.selectedFeedView,onViewChange:e.onFeedViewChange}):null}),t&&e.sessionId?(0,s.jsx)($.AiSessionDebugInfoButton,{sessionId:e.sessionId,sessionType:V.SessionType.AGENT_SESSION}):null]}),(0,s.jsx)(W.Tooltip,{isDisabled:!e.disableNewSessionButton,tooltip:"Cannot create a new chat while one is in progress",children:(0,s.jsx)(X.IconButton,{size:32,disabled:e.disableNewSessionButton,alt:e.disableNewSessionButton?"Cannot create a new chat while one is in progress":"New chat",onClick:function(){return e.onAction("newChat")},children:(0,s.jsx)(er.default,{})})})]}),(0,s.jsx)(eu,{checkpointMade:e.checkpointMade})]})})}function eu(e){var t=e.checkpointMade,n=(0,o._)((0,l.useState)(!1),2),r=n[0],i=n[1],a=(0,l.useRef)(null),u=(0,l.useCallback)(function(){a.current&&clearTimeout(a.current),i(!0),a.current=setTimeout(function(){i(!1)},4e3)},[]);return(0,G.useObserver)(t,{next:u}),r?(0,s.jsxs)(et.View,{row:!0,align:"center",clsx:es.default.checkpointMade,gap:4,children:[(0,s.jsx)(Z.Surface,{clsx:es.default.checkpointMadeIcon,children:(0,s.jsx)(ei.default,{size:12})}),(0,s.jsx)(Z.Surface,{clsx:es.default.checkpointMadeText,grow:!0,shrink:!0,children:(0,s.jsx)(ee.Text,{variant:"small",children:"Checkpoint made"})})]}):null}function ec(e){var t=e.sessionTitle,n=e.sessionId,r=e.viewSelector;return(0,s.jsxs)(et.View,{row:!0,pl:18,pr:4,gap:4,align:"center",justify:"center",grow:!0,shrink:!0,children:[(0,s.jsx)(ee.Text,{multiline:!1,shrink:!0,color:t?"default":"dimmest",children:null!=t?t:"New chat"}),null!=r?r:(0,s.jsx)(ef,{sessionId:n})]})}function ed(){return(0,s.jsxs)(et.View,{row:!0,gap:6,align:"center",children:[(0,s.jsx)(eo.default,{}),(0,s.jsx)(ee.Text,{multiline:!1,children:"History"})]})}function ef(e){var t=(0,o._)((0,l.useState)(!1),2),n=t[0],r=t[1],i=(0,F.useChatter)(),a=(0,U.useObservableMemo)(function(){return e.sessionId?i.sessions.get(e.sessionId):null},[i,e.sessionId]);return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(et.View,{shrink:0,children:(0,s.jsx)(W.Tooltip,{isDisabled:!a,tooltip:"Send feedback",children:(0,s.jsx)(Q.Button,{disabled:!a,clsx:es.default.agentBadge,iconLeft:a?(0,s.jsx)(ea.default,{}):void 0,size:"small",text:"Agent 3",colorway:"orange",onClick:function(){return r(!0)}})})}),a?(0,s.jsx)(J.Modal,{isOpen:n,onRequestClose:function(){return r(!1)},children:(0,s.jsx)(z.AIFeedback,{session:a,onClose:function(){return r(!1)}})}):null]})}e.s(["AgentBadge",()=>ef,"Header",()=>el],728821);var ep=e.i(971131),eh=(0,l.createContext)({left:null,right:null,setLeft:function(){},setRight:function(){},setHasBackButtonOverride:function(){},hasBackButtonOverride:!1});function eg(e){var t=e.children,n=e.side,r=(0,l.useContext)(eh);if(!r)return null;var i=r[n];return i?ep.default.createPortal(t,i):null}function em(){var e=(0,l.useContext)(eh);return(0,l.useCallback)(function(t){e.backButtonOverrideRef&&(e.backButtonOverrideRef.current=t,e.setHasBackButtonOverride(!!t))},[e])}function ev(e){var t,n,r,i,a,u,c,d,f,p,h=e.children,g=(n=(t=(0,o._)((0,l.useState)(null),2))[0],r=t[1],a=(i=(0,o._)((0,l.useState)(null),2))[0],u=i[1],c=(0,l.useRef)(null),f=(d=(0,o._)((0,l.useState)(!1),2))[0],p=d[1],(0,l.useMemo)(function(){return{left:n,right:a,setLeft:r,setRight:u,backButtonOverrideRef:c,setHasBackButtonOverride:p,hasBackButtonOverride:f}},[n,a,f]));return(0,s.jsx)(eh.Provider,{value:g,children:h})}function ex(){return(0,l.useContext)(eh)}function ey(e){var t=e.screen,n=e.onAction,r=e.hasInitialPlanningLayout,i=em();(0,l.useEffect)(function(){if("checkpoints"===t)return i(function(){return n("goBack")}),function(){i(null)}},[i,t,n]);var o="checkpoints"!==t&&!r;return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(eg,{side:"left",children:o?(0,s.jsx)(X.IconButton,{size:36,alt:"Chats",onClick:function(){n("showCheckpoints")},children:(0,s.jsx)(eo.default,{})}):null}),(0,s.jsx)(eg,{side:"right",children:r?null:(0,s.jsx)(X.IconButton,{size:36,alt:"New chat",onClick:function(){n("newChat")},children:(0,s.jsx)(er.default,{})})})]})}e.s(["MobilePaneHeader",()=>eg,"MobilePaneHeaderProvider",()=>ev,"useMobilePaneHeaderContext",()=>ex,"useSetMobilePaneHeaderBackButtonOverride",()=>em],84104);var eb=e.i(346715),ew=e.i(394492),ek=e.i(509908),e_=e.i(33681),eS=e.i(955665),eC=e.i(446530),ej=e.i(613355),eT=e.i(16499);function eE(){var e=(0,l.useRef)(0),t=(0,o._)((0,l.useState)(!1),2),n=t[0],r=t[1],i=(0,b.useIsInMobileWorkspace)(),a=(0,b.useIsInBonsaiWebview)(),s=(0,eT.useAppKeyboardState)();return(0,l.useEffect)(function(){var t,n=window.visualViewport;if(n){if(a)return void r(null!=(t=null==s?void 0:s.isShown)&&t);if(i){var o=function(){r(eR({current:n.height,initial:e.current}))};return e.current=n.height,n.addEventListener("resize",o),function(){n.removeEventListener("resize",o)}}}},[i,a,null==s?void 0:s.isShown]),n}function eR(e){return e.current<.8*e.initial}function eI(e){var t=(0,m.default)(e),n=(0,l.useRef)(0),r=(0,b.useIsInBonsaiWebview)();(0,l.useEffect)(function(){if(!r){var e=window.visualViewport;if(e){var i=function(){t.current(eR({current:e.height,initial:n.current}))};return n.current=e.height,e.addEventListener("resize",i),function(){e.removeEventListener("resize",i)}}}},[t,r])}e.s(["default",()=>eE,"useOnWebVirtualKeyboard",()=>eI],698053);var eA=e.i(332441);function eP(e){var t=eE(),n=(0,eA.useIsIOS)(),a=(0,o._)((0,l.useState)(0),2),u=a[0],c=a[1],d=(0,l.useRef)(null),f="visualViewport"in window;(0,l.useEffect)(function(){if(!t)return void c(0);if(n&&f){var e=window.visualViewport;if(!e)return;var r=function(){c(window.innerHeight-e.height-e.offsetTop)};return r(),e.addEventListener("resize",r),e.addEventListener("scroll",r),function(){e.removeEventListener("resize",r),e.removeEventListener("scroll",r)}}t&&c(20)},[t,n,f]);var p=(0,l.useMemo)(function(){var n;return(0,i._)((0,r._)({},e.underlayProps||{}),{style:(0,i._)((0,r._)({},(null==(n=e.underlayProps)?void 0:n.style)||{}),{paddingBottom:t?u:void 0})})},[e.underlayProps,t,u]);return(0,s.jsx)(J.Modal,(0,i._)((0,r._)({},e),{underlayProps:p,className:e.className,children:(0,s.jsx)("div",{ref:d,children:e.children})}))}var eD=(0,eC.cssRecord)({container:[ej.rcss.minWidth("300px"),{maxWidth:"90vw","@media (max-width: 600px)":{minWidth:"90vw"}}]});function eO(e){var n=e.isOpen,r=e.onClose,i=e.onSubmit,o=e.session,u=e.source,c=void 0===u?"header":u,d=(0,x.default)(),f=d.showConfirm,p=d.showError,h=function(e){return(0,t._)(function(){var t;return(0,a._)(this,function(n){switch(n.label){case 0:if(!o)return[2];return[4,o.submitUserFeedback({type:V.AgentUserFeedbackType.AGENT_FEEDBACK_UNKNOWN,comment:e})];case 1:return(null==(t=n.sent())?void 0:t.ok)?f("Feedback received."):p("Failed to send feedback. Please try again."),null==i||i(e),r(),[2]}})})()},m=(0,g.useFlag)({controlName:"flag-top-ai-spenders",type:"boolean"});return(0,l.useEffect)(function(){n&&o&&(0,ek.trackAgentAnalyticsEvent)({action:"open_feedback_modal_from_".concat(c),sessionId:o.id})},[n,o,c]),(0,s.jsx)(eP,{isOpen:n,onRequestClose:r,centered:!0,css:eD.container,children:m?(0,s.jsx)(eS.AISupportFeedbackForm,{onSubmit:h}):(0,s.jsx)(e_.AIFeedbackForm,{onSubmit:h})})}function eN(e,t,n){var r=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"command",n=arguments.length>2?arguments[2]:void 0,r=(0,o._)((0,l.useState)(!1),2),i=r[0],a=r[1],u=(0,l.useCallback)(function(){a(!0)},[]),c=(0,l.useCallback)(function(){a(!1)},[]),d=(0,l.useCallback)(function(){return e?(0,s.jsx)(eO,{isOpen:i,onClose:c,session:e,source:t,onSubmit:n}):null},[i,e,c,t,n]);return{openFeedbackModal:u,closeFeedbackModal:c,FeedbackModal:d}}(e,n,t),i=r.openFeedbackModal,a=r.FeedbackModal,u=(0,l.useMemo)(function(){return e?{data:{type:"action",icon:(0,s.jsx)(ea.default,{}),label:"Share feedback",run:i}}:null},[i,e]),c=(0,l.useMemo)(function(){return{name:"Feedback",commands:u?[u]:[]}},[u]);return{FeedbackModal:a,feedbackCommand:u,feedbackCommandGroup:c}}e.s(["useAIFeedbackCommand",()=>eN],602399);var eM=e.i(968783),eL=e.i(858248),eB=e.i(709485),eV=e.i(341126),eF=e.i(374106),eU=e.i(845822);function eG(e){var t=(0,F.useChatter)(),n=(0,U.useObservableMemo)(function(){return e?t.sessions.get(e):null},[t,e]);return(0,U.useObservableMemo)(function(){return null==n?void 0:n.reduce(e$,"global").result.map(function(e){return e.cents})},[n])}var e$={direction:"forward",state:{cents:0},reducer:function(e,t){(0,eF.isEventAssistantEditRequest)(e)&&(t.cents+=eU.ASSISTANT_UNIT_PRICE_IN_CENTS)}};e.s(["useAssistantSessionCostInCents",()=>eG],108232);var ez=e.i(651499),eH=function(e){var t=e.sessionId,n=e.type,r=void 0===n?"assistant":n,i=(0,eM.useCurrentUserStoredOrgContext)(),o=i.orgId,a=i.orgSlug,u=eG(null!=t?t:null),c="assistant"===r?u:null,d=o&&a?"".concat((0,eV.orgLinks)({slug:a}).usage.href,"#").concat(r):"/usage#".concat(r),f=(0,l.useCallback)(function(){(0,eL.track)("assistant"===r?eB.events.ASSISTANT_USED:eB.events.AGENT_USED,{action:"opened_usage_link",intent_type:null,model:null,user_model_selection:null,message_content:null,message_source:"chat_pane",message_surface:"workspace_ai_pane"}),window.open(d,"_blank")},[d,r]),p=(0,l.useMemo)(function(){return{data:{type:"action",icon:(0,s.jsx)(ez.default,{}),label:c?"Usage (this chat: $".concat((c/100).toFixed(2),")"):"Usage",run:f}}},[c,f]),h=(0,l.useMemo)(function(){return{name:"Usage",commands:[p]}},[p]);return{handleUsageClick:f,usageCommand:p,usageCommandGroup:h,cents:c,usageHref:d}};e.s(["useUsageCommand",()=>eH],953299);var eW=e.i(259493),eq=e.i(598160);function eK(e){var n=e.session,r=e.onNewSession,i=e.onHistory,o=e.hasInitialPlanningLayout,u=eH({sessionId:n.id,type:"agent"}).usageCommandGroup,c=(0,g.useFlag)({controlName:"flag-agent-debug-info-button"}),d=(0,x.default)().showConfirm,f=(0,$.useGenerateDebugInfo)(),p=eN(n,function(e){(0,ek.trackAgentAnalyticsEvent)({action:"submitted_feedback",sessionId:n.id,feedbackText:e})},"agent_chat"),h=p.FeedbackModal,m=p.feedbackCommandGroup,y=(0,l.useMemo)(function(){return{name:"Chat",commands:[{data:{type:"action",icon:(0,s.jsx)(er.default,{}),label:"New chat",run:function(){r()}}},{data:{type:"action",icon:(0,s.jsx)(eo.default,{}),label:"History",run:function(){i()}}}]}},[r,i]);return(0,eW.useSetPaneBindings)(function(){return{type:"agentChat",focusInput:function(){},commands:(0,eb._)(o?[]:[y]).concat([{commands:c?[{data:{type:"action",icon:(0,s.jsx)(eq.default,{}),label:"Copy debug info",run:function(){return(0,t._)(function(){var e,t,r;return(0,a._)(this,function(i){switch(i.label){case 0:return[4,f(n.id,V.SessionType.CHAT)];case 1:return t=(e=i.sent()).html,r=e.plainText,[4,(0,ew.default)(t,r)];case 2:return i.sent(),d("Copied debug info to clipboard"),[2]}})})()}}}]:[]},u,m])}},[u,m,c,n.id,f,d,y,o]),(0,s.jsx)(h,{})}var eY=e.i(480028),eQ=e.i(782514),eX=e.i(205413),eJ=(0,eY.cvarsFrom)("index.module.css",["--transition-duration"]),eZ=(0,l.memo)(function(e){var t,n=(0,x.default)().showError,i=(0,I.useUploadFilesHandler)();return(0,s.jsx)(eQ.TrackingHierarchyProvider,{hierarchy:{surface:"agent"},children:(0,s.jsx)(T.AiChatAttachmentsProvider,{sessionId:null==(t=e.session)?void 0:t.id,uploadFiles:i,onError:n,children:(0,s.jsx)(A.CheckpointProvider,{children:(0,s.jsx)(e0,(0,r._)({},e))})})})});function e0(e){var x,I,V,F,U,G,$,z,H=e.session,W=e.setSession,q=e.onPlanApproval,K=e.inputRef,Y=e.openPane,Q=e.openPip,X=e.secrets,J=e.readFile,Z=e.isDesktopOrTabletAgentPresentationCentered,ee=e.isDesktopLayoutAgentPresentationTransitionInProgress,en=e.workspaceTourStepRef,er=(0,o._)((0,l.useState)("session"),2),ei=er[0],eo=er[1],ea=(0,o._)((0,L.useSelectedFeedViewState)(),2),es=ea[0],eu=ea[1],ec=(0,o._)((0,l.useState)(!1),2),ed=ec[0],ef=ec[1],ep=(0,o._)((0,l.useState)(void 0),2),eh=ep[0],eg=ep[1],em=(0,o._)((0,l.useState)(!1),2),ev=em[0],ex=em[1],eb=(0,b.useIsInMobileWorkspace)(),ew=(0,l.useRef)(null),ek=(0,g.useFlag)({controlName:"flag-agent-pane-rework",default:!1}),e_=(0,y.default)(),eS=(0,d.useAgentMainReplConfigQuery)({variables:{replId:e_}}).data,eC=(null==eS||null==(x=eS.getRepl)?void 0:x.__typename)==="Repl"&&!!(null==(I=eS.getRepl.origin)?void 0:I.id),ej=(0,o._)((0,d.useUpdateReplConfigMutation)(),1)[0];(0,M.useOnInitialPlanApproval)(function(e){return(0,t._)(function(){return(0,a._)(this,function(t){switch(t.label){case 0:return null==q||q(e),[4,ej({variables:{input:{id:e_,isInPlanningPhase:!1}}})];case 1:return t.sent(),[2]}})})()});var eT=(0,T.useAiChatAttachments)().addAttachments,eE=(0,R.useDropTarget)({addAttachments:eT}),eR=eE.isDraggedOver,eI=eE.drop,eA=(0,o._)((0,l.useState)(null),2),eP=eA[0],eD=eA[1];(0,l.useEffect)(function(){null==K||K(eP)},[eP,K]),(0,l.useEffect)(function(){eb||null==eP||eP.focus()},[eP,eb]);var eO=(0,m.default)(eP),eN=(0,l.useCallback)(function(){setTimeout(function(){var e;null==(e=eO.current)||e.animatePlaceholder()})},[eO]),eM=(0,l.useCallback)(function(){eo("session"),ef(!0),eN()},[eN]),eL=(0,l.useRef)(null),eB=(0,l.useCallback)(function(){"checkpoints"===ei&&eL.current&&eL.current()},[ei]),eV=(0,l.useCallback)(function(e){"checkpoints"===ei&&eB(),W(e),eo("session"),ef(!1),eN()},[W,eN,ei,eB]),eF=(0,l.useCallback)(function(e){var t;null==eP||null==(t=eP.setValue)||t.call(eP,e.text),null==eP||eP.focus()},[eP]),eU=!!(0,h.useObservable)((0,N.useAgentIsWorking)()),eG=(0,A.useCheckpoints)().checkpointMade,e$=(0,A.useCheckpointBasedSessionTitle)(H),ez=function(e){switch("checkpoints"===ei&&eB(),e){case"goBack":eo("session"),ef(!1),eN();break;case"showCheckpoints":eo("checkpoints");break;case"newChat":eo("session"),ef(!0),eN()}},eH=(0,p.useIsRiverRetryBudgetExceeded)(),eW=(0,l.useRef)();(0,l.useEffect)(function(){eW.current=ed||null==H?void 0:H.id},[ed,H]);var eq=(0,O.useIsExpertMode)(),eY=(0,D.useIsInitialAgentSession)(null!=(G=null==H?void 0:H.id)?G:null),eQ=(0,f.useAgentPlanApprovalState)(),eZ=eY&&!eq&&!eC&&(eb?"approved"!==eQ:Z||ee),e0=(0,j.useThemeOverlay)().isThemeOverlayVisible;(0,l.useEffect)(function(){e0&&"theme"!==ei?eo("theme"):e0||"theme"!==ei||eo("session")},[e0,ei]);var e1=(0,S.useActiveTaskList)(H),e2=(0,g.useFlag)({controlName:"flag-task-list-details",default:!1}),e3=(0,g.useFlag)({controlName:"flag-task-list-usage-cost",default:!1}),e4=eZ||eb||"theme"===ei,e8=(0,l.useRef)(null),e5=(0,l.useRef)(null);return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(et.View,{innerRef:"session"===ei?eI:void 0,clsx:eX.default.root,grow:!0,shrink:!0,style:(0,n._)({},eJ.transitionDuration,"".concat(180,"ms")),children:[(0,s.jsxs)(et.View,{innerRef:e8,children:[!H||e4?null:(0,s.jsx)(el,{sessionId:H.id,sessionTitle:e$,screen:ei,disableNewSessionButton:eU,onAction:ez,checkpointMade:eG,selectedFeedView:ek?es:void 0,onFeedViewChange:ek?eu:void 0}),(0,s.jsx)(ey,{screen:ei,onAction:ez,hasInitialPlanningLayout:eZ})]}),null==e1||"session"!==ei||ed||ek?null:(0,s.jsx)(et.View,{clsx:[eX.default.taskListDrawerContainer,(0,n._)({},eX.default.isInMobileWorkspace,eb)],style:{top:null==(V=e8.current)?void 0:V.offsetHeight},children:(0,s.jsx)(_.TaskListDrawer,(0,i._)((0,r._)({},e1),{approvalStatus:"approved",placement:"top",areTaskDetailsExpandable:e2,isCostInfoAvailable:e3,innerRef:e5}))}),(0,s.jsx)(c.SwitchTransition,{children:(0,s.jsx)(u.CSSTransition,{timeout:180,nodeRef:ew,classNames:{enter:eX.default.enter,enterActive:eX.default.enterActive,exit:eX.default.exit,exitActive:eX.default.exitActive},children:(0,s.jsxs)(et.View,{innerRef:ew,clsx:eX.default.content,grow:!0,shrink:!0,children:["theme"===ei?(0,s.jsx)(C.ThemeOverlay,{}):null,"checkpoints"===ei?(0,s.jsx)(B.CheckpointsScreen,{openSession:eV,openPane:Y,navigatingFromSessionId:eW.current,scrollPosition:eh,onScrollPositionChange:eg,saveScrollPositionRef:eL}):null,"session"===ei?(0,s.jsx)(s.Fragment,{children:ek?(0,s.jsx)(k.AgentChatSession2,{onNewSession:eM,inputRef:eD,openPane:Y,openPip:Q,session:ed?null:H,openSession:eV,showCheckpoints:function(){return ez("showCheckpoints")},secrets:X,readFile:J,onPromptSuggestionClick:eF,hasInitialPlanningLayout:eZ,workspaceTourStepRef:en,scrollerTopPadding:null!=($=null==(F=e5.current)?void 0:F.offsetHeight)?$:0,selectedView:es}):(0,s.jsx)(w.AgentChatSession,{onNewSession:eM,inputRef:eD,openPane:Y,openPip:Q,session:ed?null:H,openSession:eV,showCheckpoints:function(){return ez("showCheckpoints")},secrets:X,readFile:J,onPromptSuggestionClick:eF,hasInitialPlanningLayout:eZ,workspaceTourStepRef:en,scrollerTopPadding:null!=(z=null==(U=e5.current)?void 0:U.offsetHeight)?z:0})}):null]})},ei)}),eR?(0,s.jsx)(E.default,{}):null]}),(0,s.jsx)(P.default,{isOpen:eH&&!ev,text:"We've encountered an issue and can't reconnect to the AI service. Please refresh the page to continue.",onDismiss:function(){return ex(!0)}}),eb&&H?(0,s.jsx)(eK,{onNewSession:eM,onHistory:function(){return eo("checkpoints")},session:H,hasInitialPlanningLayout:eZ}):null]})}e.s(["AgentMain",()=>eZ],700966);var e1=e.i(960933),e2=e1.Type.Object({type:e1.Type.Literal("agentChat"),data:e1.Type.Optional(e1.Type.Object({sessionId:e1.Type.Optional(e1.Type.String())}))});e.s(["AgentChatPaneSchema",()=>e2],398014)},795564,827836,e=>{"use strict";var t=e.i(960933),n=e.i(862927),r=t.Type.Object({type:t.Type.Literal("commands"),data:t.Type.Object({autoFocus:t.Type.Boolean()})}),i=function(e){return n.Value.Decode(r,e)};e.s(["decode",()=>i],795564);var o=e.i(530658),a=e.i(389959);function s(e,t){var n=(0,o._)((0,a.useState)(null),2),r=n[0],i=n[1];return(0,a.useEffect)(function(){var n=!1;return e.readFile(t).then(function(e){n||i(e)}),function(){n=!0}},[e,t]),r}e.s(["default",()=>s],827836)},655774,594949,e=>{"use strict";var t,n=e.i(297083),r=e.i(530658),i=e.i(817556),o=e.i(276385),a=e.i(389959),s=e.i(678317),l=e.i(391444),u=e.i(207237),c=e.i(664152),d=e.i(956111),f=e.i(858248),p=e.i(709485),h=e.i(529810),g=e.i(255444);function m(e,t){var n=[];return n.push((0,g.removeFieldOp)("interpreter")),n.push((0,g.removeFieldOp)("entrypoint")),e&&(n.push((0,g.createRunCommandOp)(e)),n.push((0,g.createDeploymentsRunCommandOp)(e))),t?(n.push((0,g.createCompileCommandOp)(t)),n.push((0,g.createDeploymentsBuildCommandOp)(t))):(n.push((0,g.removeFieldOp)("compile")),n.push((0,g.removeFieldOp)("deployment/build"))),n}var x=e.i(205104),y=((t={}).Unknown="UNKNOWN",t.Npm="NPM",t.Django="DJANGO",t.Flask="FLASK",t.FastAPI="FASTAPI",t.Pyramid="PYRAMID",t.Starlette="STARLETTE",t.Streamlit="STREAMLIT",t.Rails="RAILS",t.DotNet="DOTNET",t.Cargo="CARGO",t.Make="MAKE",t.RegularRun="REGULAR_RUN",t),b="package.json",w="requirements.txt",k=RegExp("((index)|(main)|(app)|(run)|(start)|(server))\\..+","i"),_=RegExp("((node_modules)|(venv)|(bower_components)|(vendor)|(build)|(dist)|(target)|(\\.git)|(\\.vscode)|(\\.idea)).+$","i");function S(e,t,r,o){return(0,n._)(function(){var a,s,l;return(0,i._)(this,function(u){switch(u.label){case 0:if(0===r.length)return[2,{projType:"UNKNOWN",runCommand:null,compileCommand:null}];return[4,function(e,t){return(0,n._)(function(e,t){var n,r,o,a,s,l;return(0,i._)(this,function(i){switch(i.label){case 0:if(n=e.initRunCommand,r=e.isCompiled,!((a=new Set(o=e.allFiles)).has("Makefile")||a.has("makefile")))return[3,1];return[2,"MAKE"];case 1:if(!a.has(b))return[3,2];return[2,"NPM"];case 2:if(!a.has("Cargo.toml"))return[3,3];return[2,"CARGO"];case 3:if(!r)return[3,4];return[2,"UNKNOWN"];case 4:if(!a.has("config/application.rb"))return[3,5];return[2,"RAILS"];case 5:if(!o.some(function(e){return"csproj"===(0,x.getExt)(e)}))return[3,6];return[2,"DOTNET"];case 6:if(!a.has(w))return[3,8];return[4,t.readFile(w)];case 7:if(!(s=i.sent()).error){if((l=s.content.toString()).includes("django"))return[2,"DJANGO"];if(l.includes("flask"))return[2,"FLASK"];if(l.includes("fastapi"))return[2,"FASTAPI"];else if(l.includes("pyramid"))return[2,"PYRAMID"];else if(l.includes("starlette"))return[2,"STARLETTE"];else if(l.includes("streamlit"))return[2,"STREAMLIT"]}return[3,9];case 8:if(k.test(n))return[2,"REGULAR_RUN"];i.label=9;case 9:return[2,"UNKNOWN"]}})}).apply(this,arguments)}(a={initRunCommand:e,isCompiled:t,allFiles:r},o)];case 1:return l={projType:s=u.sent()},[4,function(e,t,r){return(0,n._)(function(e,t,r){var o,a,s,l;return(0,i._)(this,function(u){var c;switch(o=t.initRunCommand,s=(a=t.allFiles).find(function(e){return["main.py","app.py"].includes(e)}),e){case"NPM":return[2,(0,n._)(function(){var e,t,n,o;return(0,i._)(this,function(i){switch(i.label){case 0:return[4,r.readFile(b)];case 1:e=i.sent();try{if(!e.error&&(n=null==(t=JSON.parse(e.content.toString()))?void 0:t.scripts,o=["dev","serve","watch","start:dev","start"].find(function(e){return null==n?void 0:n[e]})))return[2,"npm run ".concat(o)]}catch(e){}return[2,"node index.js"]}})})()];case"REGULAR_RUN":if(null==(l=null!=(c=a.filter(function(e){return!_.test(e)}).find(function(e){return k.test(e)}))?c:null))return[2,null];return[2,o.replace(k,l)];case"DJANGO":return[2,"python3 manage.py runserver 0.0.0.0:3000"];case"FLASK":return[2,"python ".concat(s)];case"FASTAPI":case"STARLETTE":return[2,"uvicorn ".concat(null==s?void 0:s.replace(".py",""),":app --host 0.0.0.0 --port 3000")];case"PYRAMID":return[2,"pserve development.ini"];case"STREAMLIT":return[2,"streamlit run ".concat(s)];case"RAILS":return[2,"bundle exec rails server --binding=0.0.0.0"];case"DOTNET":return[2,"dotnet run"];case"CARGO":return[2,"cargo run"];default:return[2,null]}})}).apply(this,arguments)}(s,a,o)];case 2:return[2,(l.runCommand=u.sent(),l.compileCommand=function(e){switch(e){case"MAKE":return"make";case"CARGO":case"DOTNET":case"NPM":return"";default:return null}}(s),l)]}})})()}e.s(["ProjectType",()=>y,"default",()=>S],594949);var C=e.i(480028),j=e.i(613355),T=e.i(929872),E=e.i(625484),R=e.i(87328),I=e.i(634191),A=e.i(878420),P=e.i(64386),D=e.i(967629),O=e.i(446530),N=(0,D.keyframes)({"0%":{opacity:.1},"50%":{opacity:1},"100%":{opacity:.1}}),M=(0,O.cssRecord)({one:{opacity:.1,animation:"".concat(N," 1.5s ease-in-out infinite"),animationDelay:"0s"},two:{opacity:.1,animation:"".concat(N," 1.5s ease-in-out infinite"),animationDelay:"0.1s"},three:{opacity:"0.1",animation:"".concat(N," 1.5s ease-in-out infinite"),animationDelay:"0.2s"}});let L=function(e){var t=(0,R._)({},(0,I._)(e));return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("span",(0,P._)((0,A._)({},t),{css:M.one,children:"."})),(0,o.jsx)("span",(0,P._)((0,A._)({},t),{css:M.two,children:"."})),(0,o.jsx)("span",(0,P._)((0,A._)({},t),{css:M.three,children:"."}))]})};function B(e){var t=e.children;return(0,o.jsx)(T.Surface,{background:"default",css:[j.rcss.borderRadius(8),{width:"100%",height:"calc(100% - ".concat(C.tokens.space2,")"),backgroundColor:C.tokens.backgroundDefault,overflowY:"auto",marginTop:"0px"}],children:(0,o.jsx)(E.View,{css:[{flex:"1 1 auto"}],p:16,justify:"center",align:"center",children:t})})}function V(){return(0,o.jsx)(B,{children:(0,o.jsxs)(E.View,{children:[(0,o.jsx)(E.View,{children:"We couldn't read your .replit file"}),(0,o.jsx)("a",{css:[j.rcss.pt(8),{fontSize:C.tokens.fontSizeSmall}],target:"_blank",href:"https://docs.replit.com/replit-workspace/configuring-repl",children:"View docs"})]})})}function F(){return(0,o.jsx)(B,{children:(0,o.jsx)(E.View,{children:(0,o.jsxs)("p",{children:["Importing from GitHub",(0,o.jsx)(L,{style:{color:C.tokens.foregroundDefault}})]})})})}function U(e){var t=e.closeConfigPane,o=e.openSidebar,g=e.onNewPaneSelected,x=e.openConsole,b=(0,d.useQueryParam)("gitImport","boolean"),w=(0,u.default)(),k=(0,h.default)(),_=k.fs,C=k.dotReplit,j=(0,r._)((0,a.useState)(null),2),T=j[0],E=j[1],R=(0,r._)((0,a.useState)(null),2),I=R[0],A=R[1],P=(0,a.useCallback)(function(){g({type:"codeEditor",data:{path:".replit"}})},[g]);(0,a.useEffect)(function(){if(!T)return C.watch(function(e){E(e.config),"NOT_FOUND"!==e.error&&A(e.error)})},[C,T]);var D=(0,r._)((0,a.useState)(!1),2),O=D[0],N=D[1],M=(0,r._)((0,a.useState)(""),2),L=M[0],B=M[1],V=(0,r._)((0,a.useState)(""),2),F=V[0],U=V[1],G=(0,r._)((0,a.useState)(!1),2),$=G[0],z=G[1],H=(0,r._)((0,a.useState)(y.Unknown),2),W=H[0],q=H[1],K=(0,r._)((0,a.useState)(!1),2),Y=K[0],Q=K[1];(0,a.useEffect)(function(){if(!Y)return _.watchDir(".git",{onChange:function(e){Q(e.length>0)},onMoveOrDelete:function(){Q(!0)},onError:function(){Q(!1)}})}),(0,a.useEffect)(function(){(Y||!b)&&(0,n._)(function(){var e,t,n,r,o,a,l,u,d,f,p,h,g,x,w,k,j;return(0,i._)(this,function(i){switch(i.label){case 0:if(!T)return[2];return t=(0,s.execToString)(null!=(e=T.run)?e:void 0),r=(0,s.execToString)(null!=(n=T.compile)?n:void 0),o=!!T.compile,[4,_.listFiles()];case 1:return a=i.sent(),[4,_.readDir(".git")];case 2:if(l=i.sent(),a.error||null==a.files||b&&l.error)return[2];return u=a.files,[4,S(t,o,u,_)];case 3:if(f=(d=i.sent()).projType,p=d.runCommand,h=d.compileCommand,g=u.includes("Procfile"),x=function(e,t){return e||t},w=g?x(t,p):x(p,t),k=h||r,B(w||""),U(k),z(f!==y.Unknown&&f!==y.RegularRun),q(f),!b)return[3,6];return w||c.logger.warn("Failed to autosuggest run command"),f===y.Unknown&&c.logger.warn("Failed to detect project type"),j=m(w||"",k),[4,C.updateDotReplit(j)];case 4:return i.sent(),[4,_.flush()];case 5:i.sent(),_.persist({skipDebounce:!0}),i.label=6;case 6:return[2]}})})()},[C,T,_,Y,b]);var X=(0,a.useCallback)(function(e){var t=e.run,r=e.compile,o=e.runChanged,a=e.compileChanged,s=e.projType;return(0,n._)(function(){var e;return(0,i._)(this,function(n){switch(n.label){case 0:return(0,f.track)(p.events.NIX_GH_IMPORT_USED,{action:l.NixGHImportUsedEvents.ConfigDone,isCompiled:""!==r,runChanged:o,compileChanged:a,projType:s,replId:w}),e=m(t,r),[4,C.updateDotReplit(e)];case 1:return n.sent(),_.flush().then(function(){_.persist({skipDebounce:!0})}),[2]}})})()},[C,_,w]);return{fs:_,applyConfig:X,closeConfigPane:t,dotReplitConfig:T,dotReplitError:I,isApplyingConfig:O,setIsApplyingConfig:N,initialBuild:F,initialRun:L,isFrameworkRecommended:$,projType:W,openDotReplit:P,openSidebar:o,openConsole:x}}e.s(["ErrorMessage",()=>V,"ImportingMessage",()=>F,"useConfigFormState",()=>U],655774)},818283,999519,e=>{"use strict";var t=e.i(297083),n=e.i(886513),r=e.i(530658),i=e.i(817556),o=e.i(276385),a=e.i(389959),s=e.i(322823),l=e.i(241828),u=e.i(608738),c=e.i(655774),d=e.i(594949),f=e.i(363966),p=e.i(271112),h=e.i(480028),g=e.i(446530),m=e.i(613355),x=e.i(140487),y=e.i(607278),b=e.i(11235),w=e.i(960178),k=e.i(625484),_=e.i(940745),S=e.i(42458),C=k.SpecializedView.a,j=(0,g.cssRecord)({root:[m.rcss.maxWidth(420),m.rcss.display.flex,m.rcss.gap(12),m.rcss.py(4),{margin:"0 auto"}],section:[m.rcss.display.flex,m.rcss.p(12),m.rcss.gap(12)],loading:[m.rcss.center,m.rcss.flex.growAndShrink(1)],multiParagraph:[m.rcss.flex.column,m.rcss.gap(8),{a:[m.rcss.display.inline]}]});e.s(["default",0,function(e){var g=e.flow,T=(0,n._)(e,["flow"]),E=(0,c.useConfigFormState)(T),R=(0,l.useNixModules)(),I=R.modules,A=R.configs,P=(0,u.default)(),D=(0,r._)((0,a.useState)("Overview"),2),O=D[0],N=D[1],M=(0,a.useMemo)(function(){return null==I?void 0:I.filter(function(e){return"replit"!==e.id})},[I]),L=E.dotReplitConfig,B=E.dotReplitError,V=E.initialRun,F=E.initialBuild,U=void 0===F?"":F,G=E.openConsole,$=E.openDotReplit,z=E.applyConfig,H=E.isApplyingConfig,W=E.setIsApplyingConfig,q=E.closeConfigPane,K=E.openSidebar,Y=E.projType,Q=!!Y&&Y===d.ProjectType.Rails,X=(0,s.useFormField)(V,function(e){if(!e)return{message:"Add a run command"}}),J=(0,r._)((0,a.useState)(U),2),Z=J[0],ee=J[1];if((0,a.useEffect)(function(){X.setValue(V)},[V]),(0,a.useEffect)(function(){ee(null!=U?U:"")},[U]),B)return(0,o.jsx)(c.ErrorMessage,{});if(!L&&"githubImport"===g)return(0,o.jsx)(c.ImportingMessage,{});if(!I||!M||!A||!P)return(0,o.jsx)(k.View,{css:j.loading,children:(0,o.jsx)(_.default,{})});switch(O){case"ModuleSearch":return(0,o.jsx)(p.NixSearch,{onBack:function(){return N("Overview")},disableCategorySelection:!0,initialCategory:"Modules",openConsole:G});case"Overview":return(0,o.jsxs)(k.View,{css:j.root,children:[(0,o.jsxs)(k.View,{css:j.section,children:[(0,o.jsx)(w.Header,{variant:"headerDefault",level:1,children:"Configure your App"}),(0,o.jsx)(b.Prose,{color:"dimmer",css:j.multiParagraph,children:"githubImport"===g?(0,o.jsxs)(o.Fragment,{children:[(0,o.jsxs)("p",{children:["Your code was successfully imported from GitHub. We've created a"," ",(0,o.jsx)("a",{href:"",onClick:function(e){e.preventDefault(),$()},children:".replit file"}),", which configures your App's behavior."," ",(0,o.jsx)("a",{href:"https://docs.replit.com/replit-workspace/configuring-repl#replit-configuration-file",target:"_blank",rel:"noopener noreferrer",children:"Learn more about .replit files."})]}),(0,o.jsxs)("p",{children:["To get started, verify our recommended platform dependencies and commands. If you're still deciding, try"," ",(0,o.jsx)(C,{onClick:function(){return null==T?void 0:T.onNewPaneSelected({type:"ghostwriterChat"})},children:"asking AI"}),"."]})]}):(0,o.jsx)(o.Fragment,{children:(0,o.jsxs)("p",{children:["Before configuring your Run command, make sure you've installed any"," ",(0,o.jsx)(C,{onClick:function(){return null==T?void 0:T.onNewPaneSelected({type:"developer",data:{tab:["dependencies","import"]}})},children:"languages and packages"})," ","necessary for your project. If you're still deciding, try"," ",(0,o.jsx)(C,{onClick:function(){return null==T?void 0:T.onNewPaneSelected({type:"ghostwriterChat"})},children:"asking AI"}),"."]})})})]}),"githubImport"===g?(0,o.jsxs)(k.View,{css:j.section,children:[(0,o.jsx)(w.Header,{variant:"subheadDefault",level:2,children:"Modules"}),(0,o.jsx)(w.Text,{color:"dimmer",children:"Modules combine support for programming languages, formatters, and packagers."}),(0,o.jsx)(f.default,{modules:M}),(0,o.jsx)(x.Button,{stretch:!0,colorway:"primary",variant:"outlined",type:"submit",text:"Add more modules",onClick:function(){N("ModuleSearch")}})]}):null,(0,o.jsxs)(k.View,{css:j.section,children:[(0,o.jsx)(k.View,{row:!0,justify:"space-between",children:(0,o.jsx)(w.Header,{variant:"subheadDefault",level:2,children:"Commands"})}),(0,o.jsx)("form",{onSubmit:function(e){return(0,t._)(function(){return(0,i._)(this,function(t){switch(t.label){case 0:if(e.preventDefault(),W(!0),!X.value)return X.validate(),[2];return[4,z({run:X.value,compile:null!=Z?Z:"",runChanged:X.value!==V,compileChanged:Z!==U,projType:Y})];case 1:return t.sent(),"githubImport"===g&&(q(),null==K||K()),W(!1),[2]}})})()},css:[{width:"100%"}],children:(0,o.jsx)(k.View,{gap:8,children:(0,o.jsxs)(k.View,{gap:8,children:[(0,o.jsxs)(k.View,{gap:8,children:[U?(0,o.jsxs)(k.View,{gap:4,children:[(0,o.jsx)("label",{htmlFor:"compile-sel",children:"Compile command"}),(0,o.jsx)(w.Text,{variant:"small",color:"dimmest",children:"This is optional, and is executed before your run command."}),(0,o.jsx)(y.Input,{disabled:H,id:"compile-sel",type:"text",value:Z,placeholder:"Enter a command to compile the program",onChange:function(e){ee(e.currentTarget.value)},css:{"&:disabled":{color:h.tokens.foregroundDimmer}}})]}):null,(0,o.jsx)("label",{htmlFor:"run-sel",css:[m.rcss.mt(4)],"data-cy":"import-config-run-command",children:"Run command"}),(0,o.jsx)(y.Input,{disabled:H,id:"run-sel",dataCy:"import-config-run-command-input",type:"text",value:X.value,placeholder:"Enter a command to run the program",onChange:function(e){X.setValue(e.currentTarget.value)},css:[{"&:disabled":{color:h.tokens.foregroundDimmer,cursor:"auto"},cursor:"text"}]}),X.error||!X.value?(0,o.jsxs)(k.View,{css:[m.rcss.color.accentNegativeDefault,m.rcss.rowWithGap(4),m.rcss.align.center],children:[(0,o.jsx)(S.default,{size:12}),(0,o.jsx)(k.View,{children:X.error?X.error.message:"Add a run command"})]}):null]}),(0,o.jsxs)(w.Text,{color:"dimmer",variant:"small",children:["Use either a dev server or start command.",(0,o.jsx)(C,{css:m.rcss.color.accentPrimaryStronger,target:"_blank",href:"https://docs.replit.com/replit-workspace/configuring-repl#run-command",rel:"noopener noreferrer",children:"Not sure what to use or running multiple apps?"})]}),Q?(0,o.jsx)(k.View,{children:(0,o.jsxs)(w.Text,{variant:"small",color:"dimmest",children:["We detected this is a Rails project. You will need",(0,o.jsxs)("a",{target:"_blank",rel:"noopener noreferrer",href:"https://docs.replit.com/additional-resources/rails-on-replit",children:[" ","additional changes"," "]}),"to your config files to use all of Replits features."]})}):null,(0,o.jsx)(k.View,{css:[m.rcss.flex.column,m.rcss.pt(16)],children:(0,o.jsx)(x.Button,{stretch:!0,colorway:"primary",type:"submit",text:H?"Saving...":"githubImport"===g?"Confirm and close":"Save",loading:H,disabled:H||!!X.error||!X.value,dataCy:"import-config-done"})})]})})})]})]})}}],818283);var T=e.i(960933),E=e.i(862927),R=T.Type.Object({type:T.Type.Literal("config"),flow:T.Type.Union([T.Type.Literal("githubImport"),T.Type.Literal("incompleteConfig")])}),I=function(e){return E.Value.Decode(R,e)};e.s(["decode",()=>I],999519)},109853,e=>{"use strict";var t=e.i(967629),n=e.i(480028),r=(0,t.css)({position:"relative",overflowY:"auto",width:"100%",height:"100%",zIndex:3}),i=(0,t.css)({position:"relative",overflowY:"auto",width:"100%",height:"100%",fontSize:"14px",backgroundColor:n.tokens.backgroundDefault}),o=(0,t.css)({display:"flex",alignItems:"stretch",width:"100%",height:"100%","& > .cm-editor":{flex:"1 1 auto",width:"100%"}});e.s(["CodeMirrorEditorStyleEditor",()=>i,"CodeMirrorEditorStyleEditorContainer",()=>o,"CodeMirrorEditorStyleRoot",()=>r])},551959,294751,e=>{"use strict";var t=e.i(878420),n=e.i(64386),r=e.i(276385),i=e.i(389959),o=e.i(125674),a=e.i(670413),s=e.i(131141),l=e.i(541793),u=e.i(530658),c=e.i(161322);function d(){return(0,u._)((0,i.useState)(function(){return(0,l.createStore)()}),1)[0]}e.i(719518);var f=(0,i.createContext)(null),p=function(e){return(0,c.useSetAtom)(e,{store:function(){var e=(0,i.useContext)(f);if(!e)throw Error("Expected store in context");return e}()})},h=(0,l.atom)(-1),g=(0,l.atom)([]),m=(0,l.atom)(void 0),x=(0,l.atom)(null,function(e,t,n){var r=e(m);switch(r&&(clearTimeout(r.id),r.cb()),n){case"forward":t(h,function(t){return Math.min(e(g).length,t+1)});break;case"backward":t(h,function(e){return Math.max(0,e-1)})}var i=e(g),o=e(h);return o>=i.length?"":i[o]}),y=(0,l.atom)(null,function(e,t,n){clearTimeout(null==(r=e(m))?void 0:r.id);var r,i=function(){if(n.length>0){var r=!1;t(g,function(t){return(0,s.produce)(t,function(t){if(n!==t[e(h)])for(r=!0,t.push(n);t.length>20;)t.shift()})}),r&&t(h,e(g).length-1)}t(m,void 0)};t(m,{id:setTimeout(i,2e3),cb:i})}),b=e.i(607278);function w(e){var r,s=p(y),l=(r=p(x),{forward:(0,o.default)(function(){return function(){return r("forward")}},[r]),backward:(0,o.default)(function(){return function(){return r("backward")}},[r])}),u=l.forward,c=l.backward,d=(0,i.useRef)(e.value);return(0,i.useEffect)(function(){e.value!==(null==d?void 0:d.current)&&(e.value&&s(e.value),d.current=e.value)},[s,e.value]),(0,n._)((0,t._)({},e),{onKeyDown:(0,o.default)(function(){return function(t){if(t.shiftKey||(0,a.getCmdOrCtrl)(t)){null==(r=e.onKeyDown)||r.call(e,t);return}var n,r,i=t.currentTarget,o=!!i.value.match(/\n/);if("ArrowUp"===t.key){if(o&&i.selectionStart&&i.selectionStart>0)return;e.onChange(c()),t.preventDefault(),t.stopPropagation();return}if("ArrowDown"===t.key){if(o&&i.selectionEnd&&i.selectionEnd<i.value.length)return;e.onChange(u()),t.preventDefault(),t.stopPropagation();return}null==(n=e.onKeyDown)||n.call(e,t)}},[c,u,e]),onChange:(0,o.default)(function(){return function(t){e.onChange(t.target.value)}},[e])})}var k=(0,i.forwardRef)(function(e,n){var i=w(e);return(0,r.jsx)(b.MultiLineInput,(0,t._)({ref:n},i))}),_=(0,i.forwardRef)(function(e,n){var i=d();return(0,r.jsx)(f.Provider,{value:i,children:(0,r.jsx)(k,(0,t._)({ref:n},e))})}),S=(0,i.forwardRef)(function(e,n){var i=w(e);return(0,r.jsx)(b.Input,(0,t._)({ref:n},e,i))}),C=(0,i.forwardRef)(function(e,n){var i=d();return(0,r.jsx)(f.Provider,{value:i,children:(0,r.jsx)(S,(0,t._)({ref:n},e))})});e.s(["InputWithHistory",()=>C,"MultiLineInputWithHistory",()=>_],551959);var j=e.i(886513),T=e.i(446530),E=e.i(613355),R=e.i(136540),I=(0,T.cssRecord)({checked:[E.rcss.backgroundColor.backgroundHigher],unchecked:[E.rcss.color.foregroundDimmest]});function A(e){var i=e.alt,o=e.icon,a=e.checked,s=e.onClick,l=(0,j._)(e,["alt","icon","checked","onClick"]);return(0,r.jsx)(R.IconButton,(0,n._)((0,t._)({},l),{css:a?I.checked:I.unchecked,alt:"".concat(a?"Disable":"Enable"," ").concat(i),onClick:s,children:o}))}e.s(["default",()=>A],294751)},615166,e=>{"use strict";function t(e){var t,n;return!!e&&!(e.length<2)&&null!=(n=null==(t=e[1])?void 0:t.endsWith(".bin/expo"))&&n}function n(e){var n;return!!e.isOpen&&t(null==(n=e.processInfo)?void 0:n.cmdline)}e.s(["isProbablyExpoCmdline",()=>t,"isProbablyExpoPort",()=>n])},639610,e=>{e.v({errorLog:"WebviewLogs-module__E_NGZq__errorLog",header:"WebviewLogs-module__E_NGZq__header",logRow:"WebviewLogs-module__E_NGZq__logRow",logsContainer:"WebviewLogs-module__E_NGZq__logsContainer",nowrap:"WebviewLogs-module__E_NGZq__nowrap",resizeGrip:"WebviewLogs-module__E_NGZq__resizeGrip",resizeHandle:"WebviewLogs-module__E_NGZq__resizeHandle",resizeHandleRight:"WebviewLogs-module__E_NGZq__resizeHandleRight",resizing:"WebviewLogs-module__E_NGZq__resizing",scrollSnap:"WebviewLogs-module__E_NGZq__scrollSnap",snapToBottom:"WebviewLogs-module__E_NGZq__snapToBottom",tabsWrapper:"WebviewLogs-module__E_NGZq__tabsWrapper",warningLog:"WebviewLogs-module__E_NGZq__warningLog",wrapper:"WebviewLogs-module__E_NGZq__wrapper",wrapperRight:"WebviewLogs-module__E_NGZq__wrapperRight",xtermInner:"WebviewLogs-module__E_NGZq__xtermInner",xtermWrapper:"WebviewLogs-module__E_NGZq__xtermWrapper"})},474880,e=>{e.v({desktopAppWebview:"index-module__FnOQ5W__desktopAppWebview",expoQrCode:"index-module__FnOQ5W__expoQrCode",iframe:"index-module__FnOQ5W__iframe",iframeInner:"index-module__FnOQ5W__iframeInner",iframeMiddle:"index-module__FnOQ5W__iframeMiddle",iframeWrapper:"index-module__FnOQ5W__iframeWrapper",root:"index-module__FnOQ5W__root",scalingFactor:"index-module__FnOQ5W__scalingFactor",screenshotWrapper:"index-module__FnOQ5W__screenshotWrapper",webContentAndLogsWrapper:"index-module__FnOQ5W__webContentAndLogsWrapper",webContentWrapper:"index-module__FnOQ5W__webContentWrapper"})},378042,154703,157648,813453,e=>{"use strict";var t,n=e.i(297083),r=e.i(721281),i=e.i(167626),o=e.i(878420),a=e.i(64386),s=e.i(530658),l=e.i(346715),u=e.i(817556),c=e.i(276385),d=e.i(412160),f=e.i(389959),p=e.i(754458);e.i(877212);var h=e.i(145864),g=e.i(644920),m=e.i(921521),x=e.i(993796),y=e.i(98816),b=e.i(207237),w=e.i(649960),k=e.i(615166),_=e.i(409792),S=e.i(441329),C=e.i(927158),j=e.i(739434),T=e.i(801127),E=e.i(909478),R=e.i(952521),I=e.i(904851),A=e.i(711300),P=e.i(634203),D=e.i(35877);function O(e,t,n){if(!t.has(e))throw TypeError("attempted to get private field on non-instance");return n}var N=e.i(209268),M=e.i(90659),L=e.i(908410);e.i(242933);var B=e.i(424360),V=e.i(134628),F=e.i(479407),U=new WeakMap,G=new WeakMap,$=new WeakMap,z=new WeakSet,H=function(){function e(t){var r=this,i=t.navigateIframeRef,o=t.onReceiveWebviewLog,a=t.onReceiveWebviewScreenshot;(0,I._)(this,e),(0,N._)(this,z),z.add(this),(0,P._)(this,U,{writable:!0,value:void 0}),(0,P._)(this,G,{writable:!0,value:[]}),(0,P._)(this,$,{writable:!0,value:void 0}),(0,D._)(this,U,new B.Multicast(function(e){var t=function(t){return(0,F.paneResponseBridgeMessageHandler)(t,function(t){return e.next(t.paneResponse)})};return window.addEventListener("message",t),function(){window.removeEventListener("message",t)}})),(0,A._)(this,G).push((0,A._)(this,U).subscribe(function(e){return(0,n._)(function(){var t,n,r;return(0,u._)(this,function(o){switch(o.label){case 0:if("webview"!==e.paneType||"navigation"!==e.response.type)return[3,4];if("base"in e.response&&"path"in e.response&&"port"in e.response||(null==(t=(0,A._)(this,$))?void 0:t.path)===e.response.path)return[3,2];return(0,D._)(this,$,{base:"",path:e.response.path,port:80}),[4,null==(n=i.current)?void 0:n.call(i,(0,A._)(this,$).path,(0,A._)(this,$).port)];case 1:return o.sent(),[2];case 2:var a,s;if(a=(0,A._)(this,$),s=e.response,a&&s&&a.base===s.base&&a.path===s.path&&a.port===s.port)return[3,4];return(0,D._)(this,$,e.response),[4,null==(r=i.current)?void 0:r.call(i,(0,A._)(this,$).path,(0,A._)(this,$).port)];case 3:o.sent(),o.label=4;case 4:return[2]}})}).call(r)})),(0,A._)(this,G).push((0,A._)(this,U).subscribe(function(e){"webview"===e.paneType&&"logs"===e.response.type&&o(e.response.method,e.response.message.map(function(e){try{return JSON.stringify(e,null,0)}catch(e){return"Devtools error: console message could not be stringified"}}).join(" "))})),(0,A._)(this,G).push((0,A._)(this,U).subscribe(function(e){"webview"===e.paneType&&"screenshot"===e.response.type&&a(e.response.dataUri)}))}return(0,M._)(e,[{key:"dispose",value:function(){(0,A._)(this,G).forEach(function(e){return e()})}},{key:"path",get:function(){return(0,A._)(this,U).filter(function(e){return"webview"===e.paneType&&"navigation"===e.response.type}).select(function(e){return e.response.path})}},{key:"refresh",value:function(){O(this,z,W).call(this,{type:"refresh"})}},{key:"setInsets",value:function(e){O(this,z,W).call(this,{type:"setInsets",insets:e})}},{key:"handleNavigateTo",value:function(e){var t,n,r,i,s,l,u,c,d;e.base===(null==(t=(0,A._)(this,$))?void 0:t.base)&&e.port===(null==(n=(0,A._)(this,$))?void 0:n.port)&&e.path===(null==(r=(0,A._)(this,$))?void 0:r.path)?this.refresh():O(this,z,W).call(this,(0,a._)((0,o._)({type:"navigate"},e),{url:(l=e.base,u=null!=(i=e.path)?i:"/",c=null!=(s=e.port)?s:80,d=new URL(u.startsWith("/")?u:"/".concat(u),l),80!==c&&(d.port=c.toString()),d.toString())}))}}]),e}();function W(e){var t={messageType:V.BridgeMessageType.REQUEST_PANE_ACTION,paneAction:{paneType:"webview",action:e}};(0,F.sendMessage)(t,(0,L.nanoid)())}function q(){var e=(0,S.useDoesBonsaiWebviewSupportFeature)("webviewBridge"),t=(0,S.useDoesBonsaiWebviewSupportFeature)("workspace2");return(0,f.useMemo)(function(){return e&&t},[e,t])}function K(e){var t=e.initialPort,n=e.initialPath,r=e.baseUrl,i=e.isSupported,o=e.navigateIframeRef,a=e.onReceiveWebviewLog,l=e.onReceiveWebviewScreenshot,u=(0,s._)((0,f.useState)(null),2),c=u[0],d=u[1];(0,f.useEffect)(function(){if(i){var e=new H({navigateIframeRef:o,onReceiveWebviewLog:a,onReceiveWebviewScreenshot:l});return d(e),function(){e.dispose()}}},[i,o,a,l]);var p=(0,f.useRef)(void 0);return(0,f.useEffect)(function(){i&&c&&r&&p.current!==t&&(p.current=t,c.handleNavigateTo({base:r,port:t,path:n}))},[r,c,n,t,i]),c}function Y(e){var t=e.isVisible,n=q();(0,f.useEffect)(function(){n&&((0,F.sendMessage)({messageType:V.BridgeMessageType.REQUEST_PANE_ACTION,paneAction:{paneType:"webview",action:{type:"setVisibility",isVisible:t}}},(0,L.nanoid)()),t||(0,F.sendMessage)({messageType:V.BridgeMessageType.REQUEST_PANE_ACTION,paneAction:{paneType:"webview",action:{type:"navigate",base:"",url:"INVALID_URL_TO_HIDE_NATIVE_WEBVIEW"}}},(0,L.nanoid)()))},[n,t])}e.s(["useIsBonsaiWebviewBridgeSupported",()=>q,"useNativeWebviewVisibilityState",()=>Y,"useWebviewPaneBridge",()=>K],154703);var Q=e.i(492267),X=e.i(569910),J=e.i(417120),Z=e.i(446530),ee=e.i(613355),et=e.i(396776),en=e.i(363201),er=(0,Z.cssRecord)({root:[ee.rcss.zIndex(1),ee.rcss.flex.grow(0)]});function ei(e){var t=e.readonlyBannerVariant,n=(0,J.useIsAgentWorking)(),r="";switch(t){case"html-stream":r="This is a visual preview of your app.";break;case"gallery":r="This is a visual preview of your application's building blocks.";break;case"none":return null;default:(0,X.default)(t)}return n?r+=" The agent is currently creating a fully interactive version.":r+=" The agent is currently paused.",(0,c.jsx)(et.StatusBanner,{css:er.root,text:r,icon:(0,c.jsx)(en.default,{}),colorway:"blue",variant:"flush"})}var eo=e.i(332441),ea=e.i(886513),es=e.i(858248),el=e.i(709485);function eu(e){var t=e.actionType,n=(0,ea._)(e,["actionType"]);(0,es.track)(el.events.WORKSPACE,(0,o._)({action:"webview_used",type:t},n))}function ec(){eu({actionType:"open_new_window"})}e.i(32109);var ed=e.i(926118),ef=e.i(384401),ep=e.i(967629),eh=e.i(480028),eg=e.i(91720),em=e.i(136540),ev=e.i(607278),ex=e.i(929872),ey=e.i(960178),eb=e.i(751273),ew=e.i(625484),ek=e.i(352767),e_=e.i(369948),eS=e.i(243914),eC=e.i(940745),ej=e.i(644171),eT=(0,ep.css)([ee.rcss.borderRadius(6),ee.rcss.color.foregroundDimmer,ee.rcss.height(24),{borderColor:eh.tokens.outlineDimmer}]),eE=(0,Z.cssRecord)({root:[ee.rcss.border({color:eh.tokens.outlineDimmest,direction:"bottom"}),ee.rcss.p(2),ee.rcss.container("root"),ee.rcss.zIndex(1),ee.rcss.p(4),ee.rcss.gap(4),ee.rcss.height(40)],devControls:[ee.rcss.gap(4)],navControls:[ee.rcss.flex.growAndShrink(1)],navButton:[ee.rcss.p(6),ee.rcss.borderRadius(4),ee.rcss.flex.shrink(0),{border:"none"}],urlWrapper:[ee.rcss.position.relative,ee.rcss.flex.row,ee.rcss.flex.growAndShrink(1)],urlPath2:[ee.rcss.py(0),ee.rcss.fontSize(12),ee.rcss.flex.grow(1),ee.rcss.borderRadius(8)],goButton:[ee.rcss.position.absolute,ee.rcss.right(4),ee.rcss.top("50%"),{transform:"translateY(-50%)"}],buttons:[(0,r._)({},ee.container.max(300,"root"),{"svg + span":{display:"none"},svg:{marginRight:0}})],fakeUrl:[ee.rcss.fontSize(12),ee.rcss.border(),{boxSizing:"content-box"},ee.rcss.borderRadius(6),ee.rcss.px(8),ee.rcss.py(2),ee.rcss.flex.grow(1),ee.rcss.rowWithGap(4),ee.rcss.align.center]});function eR(e){var t=e.webviewPageState,n=e.navigationState,r=e.expoUrl;return(0,c.jsxs)(ex.Surface,{css:eE.root,row:!0,align:"center",justify:"space-between",children:["active"===t.state?(0,c.jsx)(eI,{navigationState:n}):(0,c.jsx)(eA,{}),(0,c.jsx)(ew.View,{row:!0,children:(0,c.jsx)(ew.View,{css:eE.buttons,row:!0,align:"center",children:(0,c.jsx)(ew.View,{css:eE.devControls,row:!0,children:(0,c.jsx)(eg.ButtonLink,{size:"small",variant:"outlined",css:eT,href:null!=r?r:n.getExternalUrl(),target:"_blank",iconLeft:(0,c.jsx)(eS.default,{}),text:"Open in ".concat(r?"Expo Go":"browser"),onClick:function(){ec()},noNextLink:!0})})})})]})}function eI(e){var t=e.navigationState,n=t.canNavigateBack,r=t.navigateBack,i=t.canNavigateForward,o=t.navigateForward,a=t.canNavigateToInputRelativeUrl,s=t.navigateToInputRelativeUrl,l=t.inputRelativeUrl,u=t.setInputRelativeUrl,d=t.refresh,f=(0,eo.useIsMac)(),p=(0,ef.useKeyCombo)("webviewpane.reload");return(0,c.jsxs)(ew.View,{css:eE.navControls,row:!0,gap:4,children:[(0,c.jsx)(em.IconButton,{alt:"Back",onClick:r,disabled:!n,css:eE.navButton,children:(0,c.jsx)(ek.default,{})}),(0,c.jsx)(em.IconButton,{alt:"Forward",onClick:o,disabled:!i,css:eE.navButton,children:(0,c.jsx)(e_.default,{})}),(0,c.jsx)(em.IconButton,{alt:"Refresh".concat(p?" (".concat((0,ed.keyComboText)(p,f),")"):""),onClick:d,css:eE.navButton,children:t.isRefreshing?(0,c.jsx)(eC.default,{}):(0,c.jsx)(ej.default,{})}),(0,c.jsxs)(ew.View,{css:eE.urlWrapper,row:!0,children:[(0,c.jsx)(ev.Input,{css:eE.urlPath2,value:l,onKeyDown:function(e){"Enter"===e.key&&a&&s()},onChange:function(e){""===e.currentTarget.value?u("/"):u(e.target.value)}}),(0,c.jsx)(ex.Surface,{elevated:!0,css:eE.goButton,children:(0,c.jsx)(em.IconButton,{alt:"Go to URL",disabled:!a,onClick:s,size:18,tooltipContents:(0,c.jsx)(ed.KeyComboBlocks,{keyCombo:"Enter"}),children:(0,c.jsx)(e_.default,{})})})]})]})}function eA(){return(0,c.jsx)(ew.View,{css:eE.navControls,align:"center",row:!0,gap:4,children:(0,c.jsxs)(ex.Surface,{elevated:!0,css:eE.fakeUrl,children:[(0,c.jsx)(eb.Tooltip,{tooltip:"Page is loading, please wait.",delay:"none",placement:"auto",children:(0,c.jsx)(eC.default,{})}),(0,c.jsx)(ey.Text,{variant:"small",color:"dimmer",children:"Loading your page"})]})})}var eP=e.i(739521),eD=(0,Z.cssRecord)({modalContent:[ee.rcss.flex.column,ee.rcss.gap(16)],modalTitle:[ee.rcss.fontWeight.bold],modalSection:[ee.rcss.flex.column,ee.rcss.gap(8)],modalSectionTitle:[ee.rcss.fontWeight.medium,{fontSize:eh.tokens.fontSizeSubheadDefault}],modalText:[{fontSize:eh.tokens.fontSizeDefault,lineHeight:1.5}],bulletList:[ee.rcss.flex.column,ee.rcss.gap(8),{paddingLeft:eh.tokens.space16}],bulletItem:[{position:"relative",paddingLeft:eh.tokens.space8,"&::before":{content:'""',position:"absolute",left:"-12px",color:eh.tokens.yellowStrongest}}]});function eO(e){var t=e.isOpen,n=e.onRequestClose;return(0,c.jsx)(eP.Modal,{isOpen:t,onRequestClose:n,centered:!0,maxWidth:500,children:(0,c.jsxs)(ew.View,{css:eD.modalContent,p:16,children:[(0,c.jsx)(ey.Text,{variant:"headerDefault",css:eD.modalTitle,children:"Cookie Restrictions in Preview"}),(0,c.jsxs)(ew.View,{css:eD.modalSection,children:[(0,c.jsx)(ey.Text,{css:eD.modalSectionTitle,children:"Why are cookies restricted?"}),(0,c.jsx)(ey.Text,{css:eD.modalText,multiline:!0,children:"Browser security policies limit cookie access in iframes like Preview to protect user privacy and prevent cross-site tracking."})]}),(0,c.jsxs)(ew.View,{css:eD.modalSection,children:[(0,c.jsx)(ey.Text,{css:eD.modalSectionTitle,children:"How does this affect my app?"}),(0,c.jsx)(ey.Text,{css:eD.modalText,multiline:!0,children:"In Preview, your app may not be able to set or read cookies, affecting authentication, sessions, and user preferences. Your app works normally in a regular browser tab."})]}),(0,c.jsxs)(ew.View,{css:eD.modalSection,children:[(0,c.jsx)(ey.Text,{css:eD.modalSectionTitle,children:"What can I do?"}),(0,c.jsxs)(ew.View,{css:eD.bulletList,children:[(0,c.jsx)(ew.View,{css:eD.bulletItem,children:(0,c.jsx)(ey.Text,{css:eD.modalText,children:'Use "New tab" to test cookie functionality in a regular browser environment.'})}),(0,c.jsx)(ew.View,{css:eD.bulletItem,children:(0,c.jsx)(ey.Text,{css:eD.modalText,children:"Try Chrome browser."})}),(0,c.jsx)(ew.View,{css:eD.bulletItem,children:(0,c.jsxs)(ey.Text,{css:eD.modalText,children:["Try"," ",(0,c.jsx)("a",{href:"https://replit.com/desktop",target:"_blank",rel:"noopener noreferrer",style:{color:eh.tokens.accentPrimaryStronger,textDecoration:"none"},children:"Replit Desktop App"}),"."]})}),(0,c.jsx)(ew.View,{css:eD.bulletItem,children:(0,c.jsx)(ey.Text,{css:eD.modalText,children:"Adjust your browser settings to allow cross-site tracking cookies (could be risky)."})})]})]})]})})}var eN=e.i(283110),eM=e.i(42458),eL=(0,Z.cssRecord)({root:[ee.rcss.border({width:0}),{color:eh.tokens.orangeStrongest,backgroundColor:eh.tokens.orangeDimmest,containerType:"inline-size"}],content:[ee.rcss.width("100%")],closeButton:[{color:eh.tokens.orangeStrongest},ee.rcss.hover({backgroundColor:eh.tokens.orangeDimmer})],tooltipText:[ee.rcss.flex.shrink(1)],newTabButton:[{color:eh.tokens.orangeStrongest,backgroundColor:eh.tokens.orangeDimmest,borderColor:eh.tokens.orangeStrongest,borderWidth:1,marginLeft:"8px"},ee.rcss.borderRadius(6),ee.rcss.height(24),ee.rcss.hover({backgroundColor:eh.tokens.orangeDimmer})],learnMoreButton:[{color:eh.tokens.orangeStrongest,backgroundColor:"transparent",marginLeft:"8px",padding:0,border:"none",textDecoration:"underline"},ee.rcss.hover({fontWeight:"bolder",backgroundColor:"transparent"})]});function eB(e){var t=e.navigationState,n=e.onDismiss,r=(0,s._)((0,f.useState)(!1),2),i=r[0],o=r[1],a=function(){o(!0)};return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(ew.View,{css:eL.root,grow:0,shrink:0,p:4,pl:8,gap:4,align:"start",children:(0,c.jsxs)(ew.View,{css:eL.content,row:!0,gap:6,align:"center",justify:"space-between",children:[(0,c.jsx)(eM.default,{}),(0,c.jsxs)(ew.View,{row:!0,gap:4,align:"center",grow:!0,shrink:!0,children:[(0,c.jsx)(ey.Text,{css:eL.tooltipText,variant:"small",children:"Open a new tab to test authentication and file uploads."}),(0,c.jsx)(eg.ButtonLink,{size:"small",variant:"outlined",css:eL.newTabButton,href:t.getExternalUrl(),target:"_blank",iconLeft:(0,c.jsx)(eS.default,{}),text:"New tab",onClick:function(){ec()},noNextLink:!0}),(0,c.jsx)(eg.ButtonLink,{size:"small",variant:"outlined",css:eL.learnMoreButton,href:"#",onClick:function(e){e.preventDefault(),a()},text:"Learn more"})]}),(0,c.jsx)(em.IconButton,{onClick:n,alt:"Dismiss",css:eL.closeButton,children:(0,c.jsx)(eN.default,{})})]})}),(0,c.jsx)(eO,{isOpen:i,onRequestClose:function(){return o(!1)}})]})}var eV=e.i(761201),eF=e.i(11235),eU=(0,Z.cssRecord)({modalText:[ee.rcss.pl(8),ee.rcss.display.block],subHeadingText:[ee.rcss.display.block,ee.rcss.mb(8)],bulletList:[ee.rcss.flex.column,ee.rcss.gap(8),ee.rcss.pl(24)],statusItem:[ee.rcss.flex.row,ee.rcss.gap(8),ee.rcss.p(8),ee.rcss.borderRadius(8),ee.rcss.align.center,ee.rcss.backgroundColor.backgroundRoot],statusCircle:[{width:"10px",height:"10px",borderRadius:"50%",flexShrink:0,'&[data-reachable="true"]':{backgroundColor:eh.tokens.accentPrimaryDefault},'&[data-reachable="false"]':{backgroundColor:eh.tokens.accentNegativeDefault}}]});function eG(e){var t=e.isOpen,n=e.onRequestClose,r=e.reachability;return(0,c.jsx)(eP.Modal,{isOpen:t,onRequestClose:n,centered:!0,maxWidth:500,children:(0,c.jsxs)(ew.View,{gap:16,children:[(0,c.jsx)(ey.Text,{variant:"headerDefault",children:"App Reachability Status"}),(0,c.jsxs)("ul",{css:eU.bulletList,children:[(0,c.jsxs)("li",{css:eU.statusItem,children:[(0,c.jsx)(ew.View,{css:eU.statusCircle,"data-reachable":r.dotdev}),(0,c.jsxs)(ey.Text,{css:eU.modalText,children:["replit.dev domain:"," ",r.dotdev?"Reachable":"Unreachable"]})]}),(0,c.jsxs)("li",{css:eU.statusItem,children:[(0,c.jsx)(ew.View,{css:eU.statusCircle,"data-reachable":r.replCo}),(0,c.jsxs)(ey.Text,{css:eU.modalText,children:["repl.co domain:"," ",r.replCo?"Reachable":"Unreachable"]})]})]}),(0,c.jsxs)(eF.Prose,{children:[(0,c.jsx)(ey.Text,{css:eU.subHeadingText,variant:"subheadDefault",children:"Why might my app be unreachable?"}),(0,c.jsx)(ey.Text,{css:eU.modalText,multiline:!0,children:"Your browser may be unable to access your app's development domains (replit.dev and repl.co). This can happen due to:"}),(0,c.jsxs)("ul",{css:eU.bulletList,children:[(0,c.jsx)("li",{children:(0,c.jsx)(ey.Text,{css:eU.modalText,children:"Internet service provider blocking requests"})}),(0,c.jsx)("li",{children:(0,c.jsx)(ey.Text,{css:eU.modalText,children:"Router firewall rules"})}),(0,c.jsx)("li",{children:(0,c.jsx)(ey.Text,{css:eU.modalText,children:"Browser or extension blocking requests"})})]})]}),(0,c.jsxs)(eF.Prose,{children:[(0,c.jsx)(ey.Text,{css:eU.subHeadingText,variant:"subheadDefault",children:"What can I do?"}),(0,c.jsxs)("ul",{css:eU.bulletList,children:[(0,c.jsx)("li",{children:(0,c.jsx)(ey.Text,{css:eU.modalText,children:"Connect to a different network if possible (e.g. mobile data)"})}),(0,c.jsx)("li",{children:(0,c.jsx)(ey.Text,{css:eU.modalText,children:"Check with your network administrator if you're on a restricted network (e.g. corporate or school WIFI)"})}),(0,c.jsx)("li",{children:(0,c.jsxs)(ey.Text,{css:eU.modalText,children:["See our"," ",(0,c.jsx)("a",{href:eV.LINKS_DOCS.TROUBLESHOOTING_REACHABILITY,target:"_blank",rel:"noopener noreferrer",style:{color:eh.tokens.accentPrimaryStronger,textDecoration:"none"},children:"FAQ"})," ","for more troubleshooting steps"]})})]})]})]})})}var e$=e.i(140487),ez=(0,Z.cssRecord)({root:[ee.rcss.border({width:0}),{color:eh.tokens.orangeStrongest,backgroundColor:eh.tokens.orangeDimmest,containerType:"inline-size"}],content:[ee.rcss.width("100%")],closeButton:[{color:eh.tokens.orangeStrongest},ee.rcss.hover({backgroundColor:eh.tokens.orangeDimmer})],tooltipText:[ee.rcss.flex.shrink(1)],learnMoreButton:[{color:eh.tokens.orangeStrongest,backgroundColor:"transparent",marginLeft:"8px",padding:0,border:"none",textDecoration:"underline"},ee.rcss.hover({fontWeight:"bolder",backgroundColor:"transparent"})]});function eH(e){var t=e.onDismiss,n=e.reachability,r=(0,s._)((0,f.useState)(!1),2),i=r[0],o=r[1];return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(ew.View,{css:ez.root,grow:0,shrink:0,p:4,pl:8,align:"start",children:(0,c.jsxs)(ew.View,{css:ez.content,row:!0,gap:6,align:"center",justify:"space-between",children:[(0,c.jsx)(eM.default,{}),(0,c.jsxs)(ew.View,{row:!0,gap:4,align:"center",grow:!0,shrink:!0,children:[(0,c.jsx)(ey.Text,{css:ez.tooltipText,variant:"small",children:n.dotdev&&n.replCo?"There may be connectivity issues with your app.":"Your app might not be reachable from this network."}),(0,c.jsx)(e$.Button,{size:"small",variant:"outlined",css:ez.learnMoreButton,onClick:function(){return o(!0)},text:"Learn more"})]}),(0,c.jsx)(em.IconButton,{onClick:t,alt:"Dismiss",css:ez.closeButton,children:(0,c.jsx)(eN.default,{})})]})}),(0,c.jsx)(eG,{isOpen:i,onRequestClose:function(){return o(!1)},reachability:n})]})}var eW=e.i(569384),eq=e.i(973245),eK=e.i(304277);function eY(){var e=(0,eW._)(["\n  query StripeSandboxBanner($replId: String!) {\n    stripeClaimableSandbox(replId: $replId) {\n      id\n      claimUrl\n      claimedAt\n    }\n  }\n"]);return eY=function(){return e},e}e.i(566901);var eQ={},eX=(0,eq.gql)(eY()),eJ=(0,Z.cssRecord)({root:[{color:eh.tokens.accentPrimaryStrongest,backgroundColor:eh.tokens.accentPrimaryDimmest,containerType:"inline-size"}],content:[ee.rcss.width("100%")],closeButton:[{marginLeft:"auto"}],tooltipText:[ee.rcss.flex.growAndShrink(1)]});function eZ(e){var t,n,r=e.replId,i=(t={variables:{replId:r}},n=(0,o._)({},eQ,t),eK.useQuery(eX,n)).data,a=(0,s._)((0,f.useState)(!1),2),l=a[0],u=a[1],d=function(){u(!0)},p=null==i?void 0:i.stripeClaimableSandbox,h=null==p?void 0:p.claimUrl,g=null==p?void 0:p.claimedAt;return!h||g||l?null:(0,c.jsx)(ew.View,{css:eJ.root,px:6,py:4,gap:4,align:"start",children:(0,c.jsxs)(ew.View,{css:eJ.content,row:!0,gap:6,align:"center",justify:"space-between",children:[(0,c.jsxs)(ew.View,{row:!0,gap:8,align:"center",children:[(0,c.jsx)(en.default,{}),(0,c.jsx)(ey.Text,{variant:"small",css:eJ.tooltipText,children:"Complete your Stripe setup by claiming your sandbox account."})]}),(0,c.jsx)(eg.ButtonLink,{size:"small",colorway:"primary",iconLeft:(0,c.jsx)(eS.default,{}),text:"Claim",href:h||"#",target:"_blank",onClick:function(){(0,es.track)(el.events.STRIPE_SANDBOX_CLAIM_CLICKED,{source:"workspace_webview_stripe_banner",replId:r}),d()}}),(0,c.jsx)(ew.View,{css:eJ.closeButton,children:(0,c.jsx)(em.IconButton,{alt:"Dismiss",onClick:d,children:(0,c.jsx)(eN.default,{})})})]})})}var e0=e.i(990313),e1=e.i(650587),e2=e.i(546284),e3=e.i(193292),e4=e.i(886977),e8=e.i(531875),e5=e.i(960933),e6=e5.Type.Object({title:e5.Type.String(),screen:e5.Type.Object({height:e5.Type.Number(),width:e5.Type.Number()})}),e9="iPhone 17",e7=[{title:"iPhone SE",screen:{height:667,width:375}},{title:"iPhone Air",screen:{height:912,width:420}},{title:e9,screen:{height:874,width:402}},{title:"iPhone 17 Pro",screen:{height:874,width:402}},{title:"iPhone 17 Pro Max",screen:{height:956,width:440}},{title:"Pixel 10",screen:{height:924,width:412}},{title:"Pixel 10 Pro",screen:{height:924,width:412}},{title:"Pixel 10 Pro XL",screen:{height:996,width:448}},{title:"Samsung Galaxy S25",screen:{height:882,width:406}},{title:"Samsung Galaxy S25+",screen:{height:954,width:439}},{title:"Samsung Galaxy S25 Ultra",screen:{height:980,width:451}}],te=e7.find(function(e){return e.title===e9});e.s(["DEFAULT_MOBILE_SCREEN_SIZE",()=>te,"SCREEN_SIZES",()=>e7,"ScreenSizeSchema",()=>e6],157648);var tt=e.i(754873),tn=e.i(428596),tr=e.i(848969),ti=e.i(601059),to=e.i(604963),ta=e.i(734882),ts=e.i(616278),tl=e.i(292642),tu=e.i(360877),tc=e.i(357399),td=e.i(957798),tf=e.i(44239),tp=e.i(657007),th=[ee.rcss.reset.button,tt.interactive.nofill,ee.rcss.color.foregroundDimmest,ee.rcss.fontSize("small"),{border:"0 none !important","&:hover":[ee.rcss.color.foregroundDefault,{backgroundColor:"transparent !important"}],"&:active":[ee.rcss.color.foregroundDimmer,{backgroundColor:"transparent !important"}]},{borderTopRightRadius:0,borderBottomRightRadius:0,borderRight:0},ee.rcss.align.center,ee.rcss.pr(0),ee.rcss.pl(4)],tg=(0,Z.cssRecord)({themeButton:[ee.rcss.height(24),ee.rcss.p(4)],root:[ee.rcss.container("root"),ee.rcss.zIndex(1),{height:36}],devControls:[{"button:not(:hover)":{color:eh.tokens.foregroundDimmest},"a:not(:hover)":{color:eh.tokens.foregroundDimmest}}],urlWrapper:[ee.rcss.position.relative,ee.rcss.height(24)],urlOptionsRoot:[ee.rcss.overflow("hidden"),ee.rcss.borderRadius(4),{":hover":{boxShadow:"0 0 0 1px "+eh.tokens.outlineDimmer},":focus-within":{outline:"2px solid ".concat(eh.tokens.accentPrimaryDefault)}}],urlOptions:[ee.rcss.borderRadius(4)],urlOptionsSection:[ee.rcss.border({direction:"bottom"}),{":last-child":{paddingBottom:0,borderBottom:0}}],portRadioGroup:[ee.rcss.colWithGap(8)],portOption:[ee.rcss.rowWithGap(8),ee.rcss.color.foregroundDimmer],portOptionSelected:[ee.rcss.rowWithGap(8),ee.rcss.color.foregroundDefault],portOptionLabel:[{"&:hover":[ee.rcss.cursor.pointer,ee.rcss.color.foregroundDefault]}],url:th,urlPath2:[ee.rcss.p(0),ee.rcss.fontSize(12),ee.rcss.flex.grow(1),{backgroundColor:"transparent",borderTopLeftRadius:0,borderBottomLeftRadius:0,border:"0 none !important",outline:"none !important"}],fakeUrl:[ee.rcss.borderRadius(4),ee.rcss.height(24)],screenSizeMenuWrapper:[ee.rcss.p(4)]}),tm="Dev URLs are only active when someone is in the workspace. The dev URL is also subject to change. For production hosting, use Deployments.";function tv(e){var t=e.isInDesktopApp;return(0,c.jsxs)(ew.View,{grow:!0,shrink:!0,children:[(0,c.jsx)(ey.Text,{children:t?"Open in web browser":"Open in a new tab"}),(0,c.jsx)(ey.Text,{variant:"small",color:"dimmer",children:tm})]})}function tx(e){var t=e.navigationState,n=e.loading,r=e.isInDesktopApp,i=e.expoUrl,o=(0,s._)((0,f.useState)(!1),2),a=o[0],l=o[1];return i?(0,c.jsxs)(to.PopoverTrigger,{isOpen:a,onOpenChange:l,label:"Open dev URL",background:"higher",children:[(0,c.jsx)(em.IconButton,{disabled:n,alt:"Open in",children:(0,c.jsx)(eS.default,{})}),(0,c.jsx)(ew.View,{p:8,children:(0,c.jsx)(e8.default,{url:t.getExternalUrl(),expoUrl:i})})]}):(0,c.jsx)(tr.IconButtonLink,{disabled:n,tooltipContents:(0,c.jsx)(tv,{isInDesktopApp:r}),href:t.getExternalUrl(),target:"_blank",alt:r?"Open in web browser":"New tab",onClick:function(){ec()},children:(0,c.jsx)(eS.default,{})})}function ty(e){var t=e.url,n=e.webviewPageState,r=e.navigationState,i=e.forwardedPorts,o=e.onToggleWebviewLogs,a=e.onOpenPortSettings,l=e.screenSize,u=e.setScreenSize,d=e.replShield,p=e.openPane,h=e.expoUrl,g=(0,m.default)(),x=(0,s._)((0,f.useState)(!1),2),y=x[0],b=x[1],w=(0,e3.useThemeOverlay)(),k=w.toggleThemeOverlay,_=w.isThemeOverlayVisible,S="active"!==n.state&&"external-page"!==n.state,C=(0,e1.useIsMobile)(),j=(0,e3.useThemeOverlayAvailability)(),T=(0,e0.useAppThemeTracking)().trackAppTheme;return(0,c.jsxs)(ex.Surface,{px:4,py:6,gap:4,css:tg.root,row:!0,align:"center",justify:"space-between",children:["external-page"===n.state?(0,c.jsx)(t_,{backToLocal:function(){return r.refresh()}}):(0,c.jsx)(tk,{loading:S,url:t,navigationState:r,forwardedPorts:i,onOpenPortSettings:a,replShield:d,expoUrl:h}),(0,c.jsxs)(ew.View,{row:!0,align:"center",gap:2,css:tg.devControls,children:["external-page"!==n.state?(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(em.IconButton,{onClick:o,alt:"Webview logs",disabled:S,children:(0,c.jsx)(tf.default,{})}),C?null:(0,c.jsxs)(to.PopoverTrigger,{isOpen:y,onOpenChange:function(e){b(e)},label:"Screen size",background:"higher",children:[(0,c.jsx)(em.IconButton,{alt:"Screen size",disabled:S,children:(0,c.jsx)(tp.default,{})}),(0,c.jsx)(tC,{screenSize:l,setScreenSize:u})]}),j?(0,c.jsx)(eb.Tooltip,{tooltip:"Themes are currently unavailable",isDisabled:!S,placement:"auto",children:(0,c.jsx)(e$.Button,{disabled:S,onClick:function(){T(el.events.APP_THEME,{action:"overlay_toggled"}),_||p({type:"agentChat"}),k()},text:"Theme",iconLeft:(0,c.jsx)(tu.default,{size:16}),variant:"nofill",css:tg.themeButton})}):null]}):null,(0,c.jsx)(tx,{navigationState:r,loading:S,isInDesktopApp:g,expoUrl:h})]})]})}var tb=ew.SpecializedView.button;function tw(e){var t=e.url,n=e.navigationState,r=e.forwardedPorts,i=e.onOpenPortSettings,o=e.replShield,a=e.expoUrl,l=n.canNavigateToInputRelativeUrl,u=n.navigateToInputRelativeUrl,d=n.inputRelativeUrl,p=n.setInputRelativeUrl,h=n.selectedPort,g=n.setPort,m=(0,s._)((0,f.useState)(!1),2),y=m[0],b=m[1],w=(0,tn.useIdSeed)(),k=w("radioGroup"),_=(0,x.useFlag)({controlName:"flag-repl-shield-toggle"});return(0,c.jsxs)(ex.Surface,{elevated:!0,css:tg.urlOptionsRoot,grow:!0,shrink:!0,row:!0,children:[(0,c.jsxs)(to.PopoverTrigger,{isOpen:y,onOpenChange:b,label:"Show URL Options",background:"higher",children:[(0,c.jsxs)(tb,{row:!0,gap:2,css:tg.url,children:[(0,c.jsx)(eb.Tooltip,{tooltip:tm,children:o?(0,c.jsx)(td.default,{size:12}):(0,c.jsx)(tl.default,{size:12})}),".".concat(t.includes("replit.dev")?"replit.dev":"repl.co").concat((0,j.isDefaultPort)(h)?"":":"+h)]}),(0,c.jsxs)(ex.Surface,{css:tg.urlOptions,p:8,gap:6,children:[_?(0,c.jsx)(ew.View,{css:tg.urlOptionsSection,pb:8,gap:4,children:(0,c.jsx)(e4.default,{})}):null,(0,c.jsxs)(ew.View,{css:tg.urlOptionsSection,pb:8,gap:4,children:[(0,c.jsxs)(ew.View,{grow:!0,row:!0,gap:0,justify:"space-between",children:[(0,c.jsxs)(ey.Text,{children:["Listening on ",(0,e2.default)("port",r.length),":"]}),i?(0,c.jsx)(em.IconButton,{alt:"Networking tool",onClick:i,children:(0,c.jsx)(tc.default,{})}):null]}),(0,c.jsx)(ta.RadioGroup,{tag:"fieldset",css:tg.portRadioGroup,name:k,value:h.toString(),onChange:function(e){g(parseInt(e.target.value,10)),b(!1)},children:r.map(function(e,t){return(0,c.jsxs)(ew.View,{css:h===e.configuration.externalPort?tg.portOptionSelected:tg.portOption,children:[(0,c.jsx)(ta.Radio,{id:w(e.configuration.externalPort),value:e.configuration.externalPort.toString()}),(0,c.jsx)("label",{htmlFor:w(e.configuration.externalPort),css:tg.portOptionLabel,children:":".concat(e.configuration.localPort,"  :").concat(e.configuration.externalPort)})]},"".concat(t,"-").concat(e.configuration.externalPort,":").concat(e.configuration.localPort))})})]}),(0,c.jsx)(e8.default,{url:t,expoUrl:a})]})]}),(0,c.jsx)(ev.Input,{css:tg.urlPath2,value:d,onKeyDown:function(e){"Enter"===e.key&&l&&u()},onChange:function(e){""===e.currentTarget.value?p("/"):p(e.target.value)}})]})}function tk(e){var t=e.url,n=e.navigationState,r=e.forwardedPorts,i=e.onOpenPortSettings,o=e.replShield,a=e.loading,s=e.expoUrl,l=n.canNavigateBack,u=n.navigateBack,d=n.canNavigateForward,f=n.navigateForward,p=n.refresh,h=(0,eo.useIsMac)(),g=(0,ef.useKeyCombo)("webviewpane.reload");return(0,c.jsxs)(ew.View,{row:!0,gap:4,align:"center",grow:!0,shrink:!0,children:[(0,c.jsx)(em.IconButton,{alt:"Back",onClick:u,disabled:!l,children:(0,c.jsx)(ek.default,{})}),(0,c.jsx)(em.IconButton,{alt:"Forward",onClick:f,disabled:!d,children:(0,c.jsx)(e_.default,{})}),(0,c.jsx)(em.IconButton,{alt:"Refresh".concat(g?" (".concat((0,ed.keyComboText)(g,h),")"):""),onClick:p,disabled:a,children:n.isRefreshing?(0,c.jsx)(eC.default,{}):(0,c.jsx)(ej.default,{})}),(0,c.jsx)(ew.View,{css:tg.urlWrapper,grow:!0,shrink:!0,children:a?(0,c.jsx)(tS,{}):(0,c.jsx)(tw,{url:t,navigationState:n,forwardedPorts:r,onOpenPortSettings:i,replShield:o,expoUrl:s})})]})}function t_(e){var t=e.backToLocal,n=(0,s._)((0,f.useState)(!1),2),r=n[0],i=n[1];return(0,c.jsxs)(ew.View,{row:!0,gap:4,align:"center",grow:!0,shrink:!0,children:[(0,c.jsx)(e$.Button,{size:"small",variant:"nofill",onClick:function(){t(),i(!0)},loading:r,text:"Back to my page",iconLeft:r?(0,c.jsx)(eC.default,{}):(0,c.jsx)(ek.default,{})}),(0,c.jsxs)(ex.Surface,{row:!0,grow:!0,shrink:!0,elevated:!0,gap:4,align:"center",css:tg.fakeUrl,children:[(0,c.jsx)(eb.Tooltip,{tooltip:"The URL bar is not supported when navigating to external pages. You can open in a new tab to use your browser instead.",delay:"none",placement:"auto",children:(0,c.jsx)(eM.default,{size:12})}),(0,c.jsx)(ey.Text,{variant:"small",color:"dimmer",children:"External page"})]})]})}function tS(){return(0,c.jsxs)(ex.Surface,{row:!0,grow:!0,shrink:!0,gap:4,align:"center",elevated:!0,css:tg.fakeUrl,px:4,children:[(0,c.jsx)(eb.Tooltip,{tooltip:"Page is loading, please wait.",delay:"none",placement:"auto",children:(0,c.jsx)(eC.default,{size:12})}),(0,c.jsx)(ey.Text,{variant:"small",color:"dimmer",children:"Loading your page"})]})}function tC(e){var t=e.screenSize,n=e.setScreenSize;return(0,c.jsxs)(ti.Menu,{"aria-label":"Screen size menu",onAction:function(e){if("Full size"===e)null==n||n(void 0);else{var t=e7.find(function(t){return t.title===e});if(!t)return;null==n||n(t)}},css:tg.screenSizeMenuWrapper,children:[(0,c.jsx)(tj,{isSelected:void 0===t,title:"Full size"}),(0,c.jsx)(ti.Separator,{}),e7.map(function(e){return(0,c.jsx)(tj,{isSelected:(null==t?void 0:t.title)===e.title,title:e.title},e.title)})]})}function tj(e){var t=e.isSelected,n=e.title;return(0,c.jsxs)(ti.BaseMenuItem,{id:n,textValue:n,children:[(0,c.jsx)(ey.Text,{children:n}),t?(0,c.jsx)(ts.default,{}):null]})}var tT=e.i(460513),tE=e.i(119468),tR=e.i(906368),tI=e.i(125674),tA=function e(t){var n=this,i=t.initialRelativeUrl,o=t.initialPort,a=t.onChange,s=t.navigateTo;(0,I._)(this,e),(0,r._)(this,"history",[]),(0,r._)(this,"historyIndex",-1),(0,r._)(this,"onChange",void 0),(0,r._)(this,"navigateTo",void 0),(0,r._)(this,"isRefreshing",void 0),(0,r._)(this,"init",function(e,t){n.history.push({relativeUrl:e,port:t}),n.historyIndex=n.history.length-1,n.notifyChanges()}),(0,r._)(this,"notifyChanges",function(){n.onChange(n.canGoBack(),n.canGoForward(),n.getCurrentRelativeUrl(),n.getCurrentPort(),n.isRefreshing)}),(0,r._)(this,"canGoBack",function(){return n.historyIndex>0}),(0,r._)(this,"canGoForward",function(){return n.historyIndex<n.history.length-1}),(0,r._)(this,"getCurrentRelativeUrl",function(){return n.history[n.historyIndex].relativeUrl}),(0,r._)(this,"getCurrentPort",function(){return n.history[n.historyIndex].port}),(0,r._)(this,"push",function(e,t){(e!==n.getCurrentRelativeUrl()||t!==n.getCurrentPort())&&(n.history=n.history.slice(0,n.historyIndex+1),n.history.push({relativeUrl:e,port:t}),n.historyIndex=n.history.length-1),n.notifyChanges()}),(0,r._)(this,"relativeUrlUpdate",function(e){n.push(e,n.getCurrentPort())}),(0,r._)(this,"back",function(){eu({actionType:"history_back"}),n.canGoBack()&&(n.historyIndex-=1,n.navigate(n.getCurrentRelativeUrl(),n.getCurrentPort()))}),(0,r._)(this,"forward",function(){eu({actionType:"history_forward"}),n.canGoForward()&&(n.historyIndex+=1,n.navigate(n.getCurrentRelativeUrl(),n.getCurrentPort()))}),(0,r._)(this,"navigate",function(e,t){var r=null!=t?t:n.getCurrentPort();n.navigateTo.current(e,r),n.push(e,r)}),(0,r._)(this,"refresh",function(){var e,t;eu({actionType:"refresh"}),n.isRefreshing=!0,n.notifyChanges(),n.navigateTo.current(null!=(e=n.getCurrentRelativeUrl())?e:"/",null!=(t=n.getCurrentPort())?t:80).finally(function(){n.isRefreshing=!1,n.notifyChanges()})}),(0,r._)(this,"setPort",function(e){var t=n.getCurrentRelativeUrl();n.navigate(t,e)}),this.onChange=a,this.isRefreshing=!1,this.navigateTo=s,this.init(i,o)};function tP(e){var t,n=e.iframeSrc,r=e.port,i=e.path,o=e.navigateThroughWorkspaceDevtools,a=e.mintReplShieldToken,s=(0,ea._)(e,["iframeSrc","port","path","navigateThroughWorkspaceDevtools","mintReplShieldToken"]);if(o&&"id"in s){var l=(0,j.addPortToUrl)(n,r);l.searchParams.set("initialPath",i),l.searchParams.set("id",s.id),a&&l.searchParams.set("replShieldMintedToken",a),t=l.href}else{var u=new URL(i,n);r&&(u=(0,j.addPortToUrl)(u.toString(),r)),a&&u.searchParams.set("replShieldMintedToken",a),t=u.toString()}return t}var tD=e.i(387710);function tO(e){var t=e.openPane;return(0,c.jsxs)(ew.View,{align:"center",justify:"center",p:48,gap:24,grow:!0,children:[(0,c.jsxs)(ew.View,{align:"center",gap:12,children:[(0,c.jsx)(tD.default,{size:48}),(0,c.jsx)(ey.Text,{variant:"headerDefault",children:"Preview"})]}),(0,c.jsx)(ew.View,{align:"center",gap:16,children:(0,c.jsxs)(ew.View,{align:"center",gap:8,children:[(0,c.jsx)(ey.Text,{textAlign:"center",color:"dimmer",children:"Preview is not available in this type of app."}),(0,c.jsxs)(ew.View,{row:!0,gap:4,align:"center",justify:"center",style:{flexWrap:"wrap"},children:[(0,c.jsx)(ey.Text,{textAlign:"center",color:"dimmer",children:"Use the"}),(0,c.jsx)(e$.Button,{variant:"underlined",text:"Playground",onClick:function(){return t({type:"automations"})}}),(0,c.jsx)(ey.Text,{textAlign:"center",color:"dimmer",children:"to test your agents and automations."})]})]})})]})}e.s(["WebviewDisabledForAgentStack",()=>tO],813453);var tN=e.i(423111),tM=e.i(394212),tL=Object.create,tB=Object.defineProperty,tV=Object.getOwnPropertyDescriptor,tF=Object.getOwnPropertyNames,tU=Object.getPrototypeOf,tG=Object.prototype.hasOwnProperty,t$=function(e,t){return function(){return t||(0,e[tF(e)[0]])((t={exports:{}}).exports,t),t.exports}},tz=t$({"node_modules/is-object/index.js":function(e,t){t.exports=function(e){return(void 0===e?"undefined":(0,tE._)(e))==="object"&&null!==e}}}),tH=t$({"node_modules/is-window/index.js":function(e,t){t.exports=function(e){if(null==e)return!1;var t=Object(e);return t===t.window}}}),tW=t$({"node_modules/is-dom/index.js":function(e,t){var n=tz(),r=tH();t.exports=function(e){return!!n(e)&&!!r(window)&&"function"==typeof window.Node&&"number"==typeof e.nodeType&&"string"==typeof e.nodeName}}}),tq={},tK={chromeDark:function(){return tQ},chromeLight:function(){return tX}};for(var tY in tK)tB(tq,tY,{get:tK[tY],enumerable:!0});var tQ={BASE_FONT_FAMILY:"Menlo, monospace",BASE_FONT_SIZE:"11px",BASE_LINE_HEIGHT:1.2,BASE_BACKGROUND_COLOR:"rgb(36, 36, 36)",BASE_COLOR:"rgb(213, 213, 213)",OBJECT_PREVIEW_ARRAY_MAX_PROPERTIES:10,OBJECT_PREVIEW_OBJECT_MAX_PROPERTIES:5,OBJECT_NAME_COLOR:"rgb(227, 110, 236)",OBJECT_VALUE_NULL_COLOR:"rgb(127, 127, 127)",OBJECT_VALUE_UNDEFINED_COLOR:"rgb(127, 127, 127)",OBJECT_VALUE_REGEXP_COLOR:"rgb(233, 63, 59)",OBJECT_VALUE_STRING_COLOR:"rgb(233, 63, 59)",OBJECT_VALUE_SYMBOL_COLOR:"rgb(233, 63, 59)",OBJECT_VALUE_NUMBER_COLOR:"hsl(252, 100%, 75%)",OBJECT_VALUE_BOOLEAN_COLOR:"hsl(252, 100%, 75%)",OBJECT_VALUE_FUNCTION_PREFIX_COLOR:"rgb(85, 106, 242)",HTML_TAG_COLOR:"rgb(93, 176, 215)",HTML_TAGNAME_COLOR:"rgb(93, 176, 215)",HTML_TAGNAME_TEXT_TRANSFORM:"lowercase",HTML_ATTRIBUTE_NAME_COLOR:"rgb(155, 187, 220)",HTML_ATTRIBUTE_VALUE_COLOR:"rgb(242, 151, 102)",HTML_COMMENT_COLOR:"rgb(137, 137, 137)",HTML_DOCTYPE_COLOR:"rgb(192, 192, 192)",ARROW_COLOR:"rgb(145, 145, 145)",ARROW_MARGIN_RIGHT:3,ARROW_FONT_SIZE:12,ARROW_ANIMATION_DURATION:"0",TREENODE_FONT_FAMILY:"Menlo, monospace",TREENODE_FONT_SIZE:"11px",TREENODE_LINE_HEIGHT:1.2,TREENODE_PADDING_LEFT:12,TABLE_BORDER_COLOR:"rgb(85, 85, 85)",TABLE_TH_BACKGROUND_COLOR:"rgb(44, 44, 44)",TABLE_TH_HOVER_COLOR:"rgb(48, 48, 48)",TABLE_SORT_ICON_COLOR:"black",TABLE_DATA_BACKGROUND_IMAGE:"linear-gradient(rgba(255, 255, 255, 0), rgba(255, 255, 255, 0) 50%, rgba(51, 139, 255, 0.0980392) 50%, rgba(51, 139, 255, 0.0980392))",TABLE_DATA_BACKGROUND_SIZE:"128px 32px"},tX={BASE_FONT_FAMILY:"Menlo, monospace",BASE_FONT_SIZE:"11px",BASE_LINE_HEIGHT:1.2,BASE_BACKGROUND_COLOR:"white",BASE_COLOR:"black",OBJECT_PREVIEW_ARRAY_MAX_PROPERTIES:10,OBJECT_PREVIEW_OBJECT_MAX_PROPERTIES:5,OBJECT_NAME_COLOR:"rgb(136, 19, 145)",OBJECT_VALUE_NULL_COLOR:"rgb(128, 128, 128)",OBJECT_VALUE_UNDEFINED_COLOR:"rgb(128, 128, 128)",OBJECT_VALUE_REGEXP_COLOR:"rgb(196, 26, 22)",OBJECT_VALUE_STRING_COLOR:"rgb(196, 26, 22)",OBJECT_VALUE_SYMBOL_COLOR:"rgb(196, 26, 22)",OBJECT_VALUE_NUMBER_COLOR:"rgb(28, 0, 207)",OBJECT_VALUE_BOOLEAN_COLOR:"rgb(28, 0, 207)",OBJECT_VALUE_FUNCTION_PREFIX_COLOR:"rgb(13, 34, 170)",HTML_TAG_COLOR:"rgb(168, 148, 166)",HTML_TAGNAME_COLOR:"rgb(136, 18, 128)",HTML_TAGNAME_TEXT_TRANSFORM:"lowercase",HTML_ATTRIBUTE_NAME_COLOR:"rgb(153, 69, 0)",HTML_ATTRIBUTE_VALUE_COLOR:"rgb(26, 26, 166)",HTML_COMMENT_COLOR:"rgb(35, 110, 37)",HTML_DOCTYPE_COLOR:"rgb(192, 192, 192)",ARROW_COLOR:"#6e6e6e",ARROW_MARGIN_RIGHT:3,ARROW_FONT_SIZE:12,ARROW_ANIMATION_DURATION:"0",TREENODE_FONT_FAMILY:"Menlo, monospace",TREENODE_FONT_SIZE:"11px",TREENODE_LINE_HEIGHT:1.2,TREENODE_PADDING_LEFT:12,TABLE_BORDER_COLOR:"#aaa",TABLE_TH_BACKGROUND_COLOR:"#eee",TABLE_TH_HOVER_COLOR:"hsla(0, 0%, 90%, 1)",TABLE_SORT_ICON_COLOR:"#6e6e6e",TABLE_DATA_BACKGROUND_IMAGE:"linear-gradient(to bottom, white, white 50%, rgb(234, 243, 255) 50%, rgb(234, 243, 255))",TABLE_DATA_BACKGROUND_SIZE:"128px 32px"},tJ=(0,f.createContext)([{},function(){}]),tZ={WebkitTouchCallout:"none",WebkitUserSelect:"none",KhtmlUserSelect:"none",MozUserSelect:"none",msUserSelect:"none",OUserSelect:"none",userSelect:"none"},t0=function(e){return{DOMNodePreview:{htmlOpenTag:{base:{color:e.HTML_TAG_COLOR},tagName:{color:e.HTML_TAGNAME_COLOR,textTransform:e.HTML_TAGNAME_TEXT_TRANSFORM},htmlAttributeName:{color:e.HTML_ATTRIBUTE_NAME_COLOR},htmlAttributeValue:{color:e.HTML_ATTRIBUTE_VALUE_COLOR}},htmlCloseTag:{base:{color:e.HTML_TAG_COLOR},offsetLeft:{marginLeft:-e.TREENODE_PADDING_LEFT},tagName:{color:e.HTML_TAGNAME_COLOR,textTransform:e.HTML_TAGNAME_TEXT_TRANSFORM}},htmlComment:{color:e.HTML_COMMENT_COLOR},htmlDoctype:{color:e.HTML_DOCTYPE_COLOR}},ObjectPreview:{objectDescription:{fontStyle:"italic"},preview:{fontStyle:"italic"},arrayMaxProperties:e.OBJECT_PREVIEW_ARRAY_MAX_PROPERTIES,objectMaxProperties:e.OBJECT_PREVIEW_OBJECT_MAX_PROPERTIES},ObjectName:{base:{color:e.OBJECT_NAME_COLOR},dimmed:{opacity:.6}},ObjectValue:{objectValueNull:{color:e.OBJECT_VALUE_NULL_COLOR},objectValueUndefined:{color:e.OBJECT_VALUE_UNDEFINED_COLOR},objectValueRegExp:{color:e.OBJECT_VALUE_REGEXP_COLOR},objectValueString:{color:e.OBJECT_VALUE_STRING_COLOR},objectValueSymbol:{color:e.OBJECT_VALUE_SYMBOL_COLOR},objectValueNumber:{color:e.OBJECT_VALUE_NUMBER_COLOR},objectValueBoolean:{color:e.OBJECT_VALUE_BOOLEAN_COLOR},objectValueFunctionPrefix:{color:e.OBJECT_VALUE_FUNCTION_PREFIX_COLOR,fontStyle:"italic"},objectValueFunctionName:{fontStyle:"italic"}},TreeView:{treeViewOutline:{padding:0,margin:0,listStyleType:"none"}},TreeNode:{treeNodeBase:{color:e.BASE_COLOR,backgroundColor:e.BASE_BACKGROUND_COLOR,lineHeight:e.TREENODE_LINE_HEIGHT,cursor:"default",boxSizing:"border-box",listStyle:"none",fontFamily:e.TREENODE_FONT_FAMILY,fontSize:e.TREENODE_FONT_SIZE},treeNodePreviewContainer:{},treeNodePlaceholder:(0,o._)({whiteSpace:"pre",fontSize:e.ARROW_FONT_SIZE,marginRight:e.ARROW_MARGIN_RIGHT},tZ),treeNodeArrow:{base:(0,o._)({color:e.ARROW_COLOR,display:"inline-block",fontSize:e.ARROW_FONT_SIZE,marginRight:e.ARROW_MARGIN_RIGHT},parseFloat(e.ARROW_ANIMATION_DURATION)>0?{transition:"transform ".concat(e.ARROW_ANIMATION_DURATION," ease 0s")}:{},tZ),expanded:{WebkitTransform:"rotateZ(90deg)",MozTransform:"rotateZ(90deg)",transform:"rotateZ(90deg)"},collapsed:{WebkitTransform:"rotateZ(0deg)",MozTransform:"rotateZ(0deg)",transform:"rotateZ(0deg)"}},treeNodeChildNodesContainer:{margin:0,paddingLeft:e.TREENODE_PADDING_LEFT}},TableInspector:{base:{color:e.BASE_COLOR,position:"relative",border:"1px solid ".concat(e.TABLE_BORDER_COLOR),fontFamily:e.BASE_FONT_FAMILY,fontSize:e.BASE_FONT_SIZE,lineHeight:"120%",boxSizing:"border-box",cursor:"default"}},TableInspectorHeaderContainer:{base:{top:0,height:"17px",left:0,right:0,overflowX:"hidden"},table:{tableLayout:"fixed",borderSpacing:0,borderCollapse:"separate",height:"100%",width:"100%",margin:0}},TableInspectorDataContainer:{tr:{display:"table-row"},td:{boxSizing:"border-box",border:"none",height:"16px",verticalAlign:"top",padding:"1px 4px",WebkitUserSelect:"text",whiteSpace:"nowrap",textOverflow:"ellipsis",overflow:"hidden",lineHeight:"14px"},div:{position:"static",top:"17px",bottom:0,overflowY:"overlay",transform:"translateZ(0)",left:0,right:0,overflowX:"hidden"},table:{positon:"static",left:0,top:0,right:0,bottom:0,borderTop:"0 none transparent",margin:0,backgroundImage:e.TABLE_DATA_BACKGROUND_IMAGE,backgroundSize:e.TABLE_DATA_BACKGROUND_SIZE,tableLayout:"fixed",borderSpacing:0,borderCollapse:"separate",width:"100%",fontSize:e.BASE_FONT_SIZE,lineHeight:"120%"}},TableInspectorTH:{base:{position:"relative",height:"auto",textAlign:"left",backgroundColor:e.TABLE_TH_BACKGROUND_COLOR,borderBottom:"1px solid ".concat(e.TABLE_BORDER_COLOR),fontWeight:"normal",verticalAlign:"middle",padding:"0 4px",whiteSpace:"nowrap",textOverflow:"ellipsis",overflow:"hidden",lineHeight:"14px",":hover":{backgroundColor:e.TABLE_TH_HOVER_COLOR}},div:{whiteSpace:"nowrap",textOverflow:"ellipsis",overflow:"hidden",fontSize:e.BASE_FONT_SIZE,lineHeight:"120%"}},TableInspectorLeftBorder:{none:{borderLeft:"none"},solid:{borderLeft:"1px solid ".concat(e.TABLE_BORDER_COLOR)}},TableInspectorSortIcon:(0,o._)({display:"block",marginRight:3,width:8,height:7,marginTop:-7,color:e.TABLE_SORT_ICON_COLOR,fontSize:12},tZ)}},t1="chromeLight",t2=(0,f.createContext)(t0(tq[t1])),t3=function(e){return(0,f.useContext)(t2)[e]},t4=function(e){return function(t){var n=t.theme,r=void 0===n?t1:n,i=(0,ea._)(t,["theme"]),a=(0,f.useMemo)(function(){switch(Object.prototype.toString.call(r)){case"[object String]":return t0(tq[r]);case"[object Object]":return t0(r);default:return t0(tq[t1])}},[r]);return f.default.createElement(t2.Provider,{value:a},f.default.createElement(e,(0,o._)({},i)))}},t8=function(e){var t=e.expanded,n=e.styles;return f.default.createElement("span",{style:(0,o._)({},n.base,t?n.expanded:n.collapsed)},"")},t5=(0,f.memo)(function(e){var t=(e=(0,o._)({expanded:!0,nodeRenderer:function(e){var t=e.name;return f.default.createElement("span",null,t)},onClick:function(){},shouldShowArrow:!1,shouldShowPlaceholder:!0},e)).expanded,n=e.onClick,r=e.children,i=e.nodeRenderer,a=e.title,s=e.shouldShowArrow,l=e.shouldShowPlaceholder,u=t3("TreeNode");return f.default.createElement("li",{"aria-expanded":t,role:"treeitem",style:u.treeNodeBase,title:a},f.default.createElement("div",{style:u.treeNodePreviewContainer,onClick:n},s||f.Children.count(r)>0?f.default.createElement(t8,{expanded:t,styles:u.treeNodeArrow}):l&&f.default.createElement("span",{style:u.treeNodePlaceholder},""),f.default.createElement(i,(0,o._)({},e))),f.default.createElement("ol",{role:"group",style:u.treeNodeChildNodesContainer},t?r:void 0))});function t6(e,t){return!t(e).next().done}var t9=function(e,t,n,r,i){var a=[].concat(Array.from({length:r},function(e,t){return["$"].concat(Array.from({length:t},function(){return"*"})).join(".")})).concat(n).filter(function(e){return"string"==typeof e}),s=[];return a.forEach(function(n){var r=n.split("."),i=function(e,n,o){if(o===r.length)return void s.push(n);var a=r[o];if(0===o)t6(e,t)&&("$"===a||"*"===a)&&i(e,"$",o+1);else if("*"===a){var l=!0,u=!1,c=void 0;try{for(var d,f=t(e)[Symbol.iterator]();!(l=(d=f.next()).done);l=!0){var p=d.value,h=p.name,g=p.data;t6(g,t)&&i(g,"".concat(n,".").concat(h),o+1)}}catch(e){u=!0,c=e}finally{try{l||null==f.return||f.return()}finally{if(u)throw c}}}else{var m=e[a];t6(m,t)&&i(m,"".concat(n,".").concat(a),o+1)}};i(e,"",0)}),s.reduce(function(e,t){return e[t]=!0,e},(0,o._)({},i))},t7=(0,f.memo)(function(e){var t=e.data,n=e.dataIterator,i=e.path,u=e.depth,c=e.nodeRenderer,d=(0,s._)((0,f.useContext)(tJ),2),p=d[0],h=d[1],g=t6(t,n),m=!!p[i],x=(0,f.useCallback)(function(){return g&&h(function(e){return(0,a._)((0,o._)({},e),(0,r._)({},i,!m))})},[g,h,i,m]);return f.default.createElement(t5,(0,o._)({expanded:m,onClick:x,shouldShowArrow:g,shouldShowPlaceholder:u>0,nodeRenderer:c},e),m?(0,l._)(n(t)).map(function(e){var t=e.name,r=e.data,a=(0,ea._)(e,["name","data"]);return f.default.createElement(t7,(0,o._)({name:t,data:r,depth:u+1,path:"".concat(i,".").concat(t),key:t,dataIterator:n,nodeRenderer:c},a))}):null)}),ne=(0,f.memo)(function(e){var t=e.name,n=e.data,r=e.dataIterator,i=e.nodeRenderer,o=e.expandPaths,a=e.expandLevel,l=t3("TreeView"),u=(0,f.useState)({}),c=(0,s._)(u,2)[1];return(0,f.useLayoutEffect)(function(){return c(function(e){return t9(n,r,o,a,e)})},[n,r,o,a]),f.default.createElement(tJ.Provider,{value:u},f.default.createElement("ol",{role:"tree",style:l.treeViewOutline},f.default.createElement(t7,{name:t,data:n,dataIterator:r,depth:0,path:"$",nodeRenderer:i})))}),nt=function(e){var t=e.name,n=e.dimmed,r=e.styles,i=t3("ObjectName"),a=(0,o._)({},i.base,void 0!==n&&n?i.dimmed:{},void 0===r?{}:r);return f.default.createElement("span",{style:a},t)},nn=function(e){var t=e.object,n=e.styles,r=t3("ObjectValue"),a=function(e){return(0,o._)({},r[e],n)};switch(void 0===t?"undefined":(0,tE._)(t)){case"bigint":return f.default.createElement("span",{style:a("objectValueNumber")},String(t),"n");case"number":return f.default.createElement("span",{style:a("objectValueNumber")},String(t));case"string":return f.default.createElement("span",{style:a("objectValueString")},'"',t,'"');case"boolean":return f.default.createElement("span",{style:a("objectValueBoolean")},String(t));case"undefined":return f.default.createElement("span",{style:a("objectValueUndefined")},"undefined");case"object":if(null===t)return f.default.createElement("span",{style:a("objectValueNull")},"null");if((0,i._)(t,Date))return f.default.createElement("span",null,t.toString());if((0,i._)(t,RegExp))return f.default.createElement("span",{style:a("objectValueRegExp")},t.toString());if(Array.isArray(t))return f.default.createElement("span",null,"Array(".concat(t.length,")"));if(!t.constructor)return f.default.createElement("span",null,"Object");if("function"==typeof t.constructor.isBuffer&&t.constructor.isBuffer(t))return f.default.createElement("span",null,"Buffer[".concat(t.length,"]"));return f.default.createElement("span",null,t.constructor.name);case"function":return f.default.createElement("span",null,f.default.createElement("span",{style:a("objectValueFunctionPrefix")},""),f.default.createElement("span",{style:a("objectValueFunctionName")},t.name,"()"));case"symbol":return f.default.createElement("span",{style:a("objectValueSymbol")},t.toString());default:return f.default.createElement("span",null)}},nr=Object.prototype.hasOwnProperty,ni=Object.prototype.propertyIsEnumerable;function no(e,t){var n=Object.getOwnPropertyDescriptor(e,t);if(n.get)try{return n.get()}catch(e){return n.get}return e[t]}function na(e,t){return 0===e.length?[]:e.slice(1).reduce(function(e,n){return e.concat([t,n])},[e[0]])}var ns=function(e){var t=e.data,n=t3("ObjectPreview");if((void 0===t?"undefined":(0,tE._)(t))!=="object"||null===t||(0,i._)(t,Date)||(0,i._)(t,RegExp))return f.default.createElement(nn,{object:t});if(Array.isArray(t)){var r=n.arrayMaxProperties,o=t.slice(0,r).map(function(e,t){return f.default.createElement(nn,{key:t,object:e})});t.length>r&&o.push(f.default.createElement("span",{key:"ellipsis"},""));var a=t.length;return f.default.createElement(f.default.Fragment,null,f.default.createElement("span",{style:n.objectDescription},0===a?"":"(".concat(a,")")),f.default.createElement("span",{style:n.preview},"[",na(o,", "),"]"))}var s=n.objectMaxProperties,l=[];for(var u in t)if(nr.call(t,u)){var c=void 0;l.length===s-1&&Object.keys(t).length>s&&(c=f.default.createElement("span",{key:"ellipsis"},""));var d=no(t,u);if(l.push(f.default.createElement("span",{key:u},f.default.createElement(nt,{name:u||'""'}),":",f.default.createElement(nn,{object:d}),c)),c)break}var p=t.constructor?t.constructor.name:"Object";return f.default.createElement(f.default.Fragment,null,f.default.createElement("span",{style:n.objectDescription},"Object"===p?"":"".concat(p," ")),f.default.createElement("span",{style:n.preview},"{",na(l,", "),"}"))},nl=function(e){var t=e.name,n=e.data;return"string"==typeof t?f.default.createElement("span",null,f.default.createElement(nt,{name:t}),f.default.createElement("span",null,": "),f.default.createElement(ns,{data:n})):f.default.createElement(ns,{data:n})},nu=function(e){var t=e.name,n=e.data,r=e.isNonenumerable;return f.default.createElement("span",null,"string"==typeof t?f.default.createElement(nt,{name:t,dimmed:void 0!==r&&r}):f.default.createElement(ns,{data:t}),f.default.createElement("span",null,": "),f.default.createElement(nn,{object:n}))},nc=function(e){var t=e.depth,n=e.name,r=e.data,i=e.isNonenumerable;return 0===t?f.default.createElement(nl,{name:n,data:r}):f.default.createElement(nu,{name:n,data:r,isNonenumerable:i})},nd=t4(function(e){var t,n=e.showNonenumerable,r=e.sortObjectKeys,i=e.nodeRenderer,a=(0,ea._)(e,["showNonenumerable","sortObjectKeys","nodeRenderer"]),l=(t=void 0!==n&&n,function(e){var n,i,o,a,l,c,d,f,p,h,g,m,x,y,b,w,k,_,S;return(0,u._)(this,function(u){switch(u.label){case 0:if(((void 0===e?"undefined":(0,tE._)(e))!=="object"||null===e)&&"function"!=typeof e)return[2];if(!(!(n=Array.isArray(e))&&e[Symbol.iterator]))return[3,12];i=0,o=!0,a=!1,l=void 0,u.label=1;case 1:u.trys.push([1,9,10,11]),c=e[Symbol.iterator](),u.label=2;case 2:if(o=(d=c.next()).done)return[3,8];if(!(Array.isArray(f=d.value)&&2===f.length))return[3,4];return[4,{name:(p=(0,s._)(f,2))[0],data:p[1]}];case 3:return u.sent(),[3,6];case 4:return[4,{name:i.toString(),data:f}];case 5:u.sent(),u.label=6;case 6:i++,u.label=7;case 7:return o=!0,[3,2];case 8:return[3,11];case 9:return h=u.sent(),a=!0,l=h,[3,11];case 10:try{o||null==c.return||c.return()}finally{if(a)throw l}return[7];case 11:return[3,24];case 12:g=Object.getOwnPropertyNames(e),!0!==r||n?"function"==typeof r&&g.sort(r):g.sort(),m=!0,x=!1,y=void 0,u.label=13;case 13:u.trys.push([13,20,21,22]),b=g[Symbol.iterator](),u.label=14;case 14:if(m=(w=b.next()).done)return[3,19];if(k=w.value,!ni.call(e,k))return[3,16];return _=no(e,k),[4,{name:k||'""',data:_}];case 15:return u.sent(),[3,18];case 16:if(!t)return[3,18];S=void 0;try{S=no(e,k)}catch(e){}if(void 0===S)return[3,18];return[4,{name:k,data:S,isNonenumerable:!0}];case 17:u.sent(),u.label=18;case 18:return m=!0,[3,14];case 19:return[3,22];case 20:return h=u.sent(),x=!0,y=h,[3,22];case 21:try{m||null==b.return||b.return()}finally{if(x)throw y}return[7];case 22:if(!(t&&e!==Object.prototype))return[3,24];return[4,{name:"__proto__",data:Object.getPrototypeOf(e),isNonenumerable:!0}];case 23:u.sent(),u.label=24;case 24:return[2]}})});return f.default.createElement(ne,(0,o._)({nodeRenderer:i||nc,dataIterator:l},a))}),nf=function(e){var t=e.rows,n=e.columns,r=e.rowsData,i=t3("TableInspectorDataContainer"),a=t3("TableInspectorLeftBorder");return f.default.createElement("div",{style:i.div},f.default.createElement("table",{style:i.table},f.default.createElement("colgroup",null),f.default.createElement("tbody",null,t.map(function(e,t){return f.default.createElement("tr",{key:e,style:i.tr},f.default.createElement("td",{style:(0,o._)({},i.td,a.none)},e),n.map(function(e){var n=r[t];return(void 0===n?"undefined":(0,tE._)(n))==="object"&&null!==n&&nr.call(n,e)?f.default.createElement("td",{key:e,style:(0,o._)({},i.td,a.solid)},f.default.createElement(nn,{object:n[e]})):f.default.createElement("td",{key:e,style:(0,o._)({},i.td,a.solid)})}))}))))},np=function(e){return f.default.createElement("div",{style:{position:"absolute",top:1,right:0,bottom:1,display:"flex",alignItems:"center"}},e.children)},nh=function(e){var t=e.sortAscending,n=t3("TableInspectorSortIcon");return f.default.createElement("div",{style:n},t?"":"")},ng=function(e){var t=e.sortAscending,n=e.sorted,r=e.onClick,i=e.borderStyle,l=e.children,u=(0,ea._)(e,["sortAscending","sorted","onClick","borderStyle","children"]),c=t3("TableInspectorTH"),d=(0,s._)((0,f.useState)(!1),2),p=d[0],h=d[1],g=(0,f.useCallback)(function(){return h(!0)},[]),m=(0,f.useCallback)(function(){return h(!1)},[]);return f.default.createElement("th",(0,a._)((0,o._)({},u),{style:(0,o._)({},c.base,void 0===i?{}:i,p?c.base[":hover"]:{}),onMouseEnter:g,onMouseLeave:m,onClick:void 0===r?void 0:r}),f.default.createElement("div",{style:c.div},l),void 0!==n&&n&&f.default.createElement(np,null,f.default.createElement(nh,{sortAscending:void 0!==t&&t})))},nm=function(e){var t=e.indexColumnText,n=e.columns,r=e.sorted,i=e.sortIndexColumn,o=e.sortColumn,a=e.sortAscending,s=e.onTHClick,l=e.onIndexTHClick,u=t3("TableInspectorHeaderContainer"),c=t3("TableInspectorLeftBorder");return f.default.createElement("div",{style:u.base},f.default.createElement("table",{style:u.table},f.default.createElement("tbody",null,f.default.createElement("tr",null,f.default.createElement(ng,{borderStyle:c.none,sorted:r&&i,sortAscending:a,onClick:l},void 0===t?"(index)":t),(void 0===n?[]:n).map(function(e){return f.default.createElement(ng,{borderStyle:c.solid,key:e,sorted:r&&o===e,sortAscending:a,onClick:s.bind(null,e)},e)})))))},nv=t4(function(e){var t,n=e.data,r=e.columns,i=t3("TableInspector"),o=(0,s._)((0,f.useState)({sorted:!1,sortIndexColumn:!1,sortColumn:void 0,sortAscending:!1}),2),a=o[0],u=a.sorted,c=a.sortIndexColumn,d=a.sortColumn,p=a.sortAscending,h=o[1],g=(0,f.useCallback)(function(){h(function(e){var t=e.sortIndexColumn,n=e.sortAscending;return{sorted:!0,sortIndexColumn:!0,sortColumn:void 0,sortAscending:!t||!n}})},[]),m=(0,f.useCallback)(function(e){h(function(t){var n=t.sortColumn,r=t.sortAscending;return{sorted:!0,sortIndexColumn:!1,sortColumn:e,sortAscending:e!==n||!r}})},[]);if((void 0===n?"undefined":(0,tE._)(n))!=="object"||null===n)return f.default.createElement("div",null);var x=function(e){if((void 0===e?"undefined":(0,tE._)(e))==="object"){var t=[];if(Array.isArray(e)){var n=e.length;t=(0,l._)(Array(n).keys())}else null!==e&&(t=Object.keys(e));var r=t.reduce(function(t,n){var r=e[n];return(void 0===r?"undefined":(0,tE._)(r))==="object"&&null!==r&&Object.keys(r).reduce(function(e,t){return e.includes(t)||e.push(t),e},t),t},[]);return{rowHeaders:t,colHeaders:r}}}(n),y=x.rowHeaders,b=x.colHeaders;void 0!==r&&(b=r);var w=y.map(function(e){return n[e]});if(void 0!==d?t=w.map(function(e,t){return(void 0===e?"undefined":(0,tE._)(e))==="object"&&null!==e?[e[d],t]:[void 0,t]}):c&&(t=y.map(function(e,t){return[y[t],t]})),void 0!==t){var k,_=t.sort((k=function(e){return e[0]},function(e,t){var n,r=k(e),i=k(t),o=void 0===r?"undefined":(0,tE._)(r),a=void 0===i?"undefined":(0,tE._)(i),s=function(e,t){return e<t?-1:+(e>t)};if(o===a)n=s(r,i);else{var l={string:0,number:1,object:2,symbol:3,boolean:4,undefined:5,function:6};n=s(l[o],l[a])}return p||(n=-n),n})).map(function(e){return e[1]});y=_.map(function(e){return y[e]}),w=_.map(function(e){return w[e]})}return f.default.createElement("div",{style:i.base},f.default.createElement(nm,{columns:b,sorted:u,sortIndexColumn:c,sortColumn:d,sortAscending:p,onTHClick:m,onIndexTHClick:g}),f.default.createElement(nf,{rows:y,columns:b,rowsData:w}))}),nx=function(e){return 0===e.childNodes.length||1===e.childNodes.length&&e.childNodes[0].nodeType===Node.TEXT_NODE&&e.textContent.length<80},ny=function(e){var t=e.tagName,n=e.attributes,r=e.styles;return f.default.createElement("span",{style:r.base},"<",f.default.createElement("span",{style:r.tagName},t),function(){if(n){for(var e=[],t=0;t<n.length;t++){var i=n[t];e.push(f.default.createElement("span",{key:t}," ",f.default.createElement("span",{style:r.htmlAttributeName},i.name),'="',f.default.createElement("span",{style:r.htmlAttributeValue},i.value),'"'))}return e}}(),">")},nb=function(e){var t=e.tagName,n=e.isChildNode,r=e.styles;return f.default.createElement("span",{style:Object.assign({},r.base,void 0!==n&&n&&r.offsetLeft)},"</",f.default.createElement("span",{style:r.tagName},t),">")},nw={1:"ELEMENT_NODE",3:"TEXT_NODE",7:"PROCESSING_INSTRUCTION_NODE",8:"COMMENT_NODE",9:"DOCUMENT_NODE",10:"DOCUMENT_TYPE_NODE",11:"DOCUMENT_FRAGMENT_NODE"},nk=function(e){var t=e.isCloseTag,n=e.data,r=e.expanded,i=t3("DOMNodePreview");if(t)return f.default.createElement(nb,{styles:i.htmlCloseTag,isChildNode:!0,tagName:n.tagName});switch(n.nodeType){case Node.ELEMENT_NODE:return f.default.createElement("span",null,f.default.createElement(ny,{tagName:n.tagName,attributes:n.attributes,styles:i.htmlOpenTag}),nx(n)?n.textContent:!r&&"",!r&&f.default.createElement(nb,{tagName:n.tagName,styles:i.htmlCloseTag}));case Node.TEXT_NODE:return f.default.createElement("span",null,n.textContent);case Node.CDATA_SECTION_NODE:return f.default.createElement("span",null,"<![CDATA["+n.textContent+"]]>");case Node.COMMENT_NODE:return f.default.createElement("span",{style:i.htmlComment},"<!--",n.textContent,"-->");case Node.PROCESSING_INSTRUCTION_NODE:return f.default.createElement("span",null,n.nodeName);case Node.DOCUMENT_TYPE_NODE:return f.default.createElement("span",{style:i.htmlDoctype},"<!DOCTYPE ",n.name,n.publicId?' PUBLIC "'.concat(n.publicId,'"'):"",!n.publicId&&n.systemId?" SYSTEM":"",n.systemId?' "'.concat(n.systemId,'"'):"",">");case Node.DOCUMENT_NODE:case Node.DOCUMENT_FRAGMENT_NODE:return f.default.createElement("span",null,n.nodeName);default:return f.default.createElement("span",null,nw[n.nodeType])}},n_=function(e){var t,n;return(0,u._)(this,function(r){switch(r.label){case 0:if(!(e&&e.childNodes))return[3,6];if(nx(e))return[2];t=0,r.label=1;case 1:if(!(t<e.childNodes.length))return[3,4];if((n=e.childNodes[t]).nodeType===Node.TEXT_NODE&&0===n.textContent.trim().length)return[3,3];return[4,{name:"".concat(n.tagName,"[").concat(t,"]"),data:n}];case 2:r.sent(),r.label=3;case 3:return t++,[3,1];case 4:if(!e.tagName)return[3,6];return[4,{name:"CLOSE_TAG",data:{tagName:e.tagName},isCloseTag:!0}];case 5:r.sent(),r.label=6;case 6:return[2]}})},nS=t4(function(e){return f.default.createElement(ne,(0,o._)({nodeRenderer:nk,dataIterator:n_},e))}),nC=function(e,t,n,r){if(t&&(void 0===t?"undefined":(0,tE._)(t))==="object"||"function"==typeof t){var i=!0,o=!1,a=void 0;try{for(var s,l=tF(t)[Symbol.iterator]();!(i=(s=l.next()).done);i=!0)!function(){var n=s.value;tG.call(e,n)||void 0===n||tB(e,n,{get:function(){return t[n]},enumerable:!(r=tV(t,n))||r.enumerable})}()}catch(e){o=!0,a=e}finally{try{i||null==l.return||l.return()}finally{if(o)throw a}}}return e}(tB(null!=(t=tW())?tL(tU(t)):{},"default",{value:t,enumerable:!0}),t),nj=function(e){var t=e.table,n=e.data,r=(0,ea._)(e,["table","data"]);return void 0!==t&&t?f.default.createElement(nv,(0,o._)({data:n},r)):(0,nC.default)(n)?f.default.createElement(nS,(0,o._)({data:n},r)):f.default.createElement(nd,(0,o._)({data:n},r))},nT=e.i(417751),nE=e.i(642049);e.i(925218);var nR=e.i(112077),nI=e.i(47503),nA=e.i(869226),nP=e.i(299798),nD=e.i(529810);e.i(282890);var nO=e.i(66718),nN=e.i(729122),nM=e.i(210481),nL=e.i(545969),nB=e.i(987154),nV=e.i(559073),nF=e.i(221121),nU=e.i(918208),nG=e.i(639610),n$=(0,eh.cvarsFrom)("WebviewLogs.module.css",["--drawer-height","--drawer-width"]),nz=(0,Z.cssRecord)({tab:[ee.rcss.borderRadius(0)],tabList:[ee.rcss.overflow("scroll"),ee.rcss.mr(4)],tabsContainer:[ee.rcss.height("100%"),{display:"grid",gridTemplateRows:"32px 1fr"}],tabPanel:[ee.rcss.height("100%"),ee.rcss.overflow("hidden")]});function nH(e){return e[e.length-1]}var nW=(0,a._)((0,o._)({},tX),{BASE_FONT_FAMILY:eh.tokens.fontFamilyCode,BASE_FONT_SIZE:eh.tokens.fontSizeSmall,BASE_LINE_HEIGHT:eh.tokens.lineHeightSmall,BASE_BACKGROUND_COLOR:"transparent",BASE_COLOR:eh.tokens.foregroundDefault,OBJECT_PREVIEW_ARRAY_MAX_PROPERTIES:10,OBJECT_PREVIEW_OBJECT_MAX_PROPERTIES:5,OBJECT_NAME_COLOR:eh.tokens.purpleStronger,OBJECT_VALUE_NULL_COLOR:eh.tokens.greyStronger,OBJECT_VALUE_UNDEFINED_COLOR:eh.tokens.greyStronger,OBJECT_VALUE_REGEXP_COLOR:eh.tokens.redStronger,OBJECT_VALUE_STRING_COLOR:eh.tokens.redStronger,OBJECT_VALUE_SYMBOL_COLOR:eh.tokens.redStronger,OBJECT_VALUE_NUMBER_COLOR:eh.tokens.blueStronger,OBJECT_VALUE_BOOLEAN_COLOR:eh.tokens.blueStronger,OBJECT_VALUE_FUNCTION_PREFIX_COLOR:eh.tokens.blueStronger,ARROW_COLOR:eh.tokens.foregroundDimmest,ARROW_MARGIN_RIGHT:6,ARROW_FONT_SIZE:eh.tokens.fontSizeSmall,ARROW_ANIMATION_DURATION:"0",TREENODE_FONT_FAMILY:eh.tokens.fontFamilyCode,TREENODE_FONT_SIZE:eh.tokens.fontSizeSmall,TREENODE_LINE_HEIGHT:eh.tokens.lineHeightSmall,TREENODE_PADDING_LEFT:12});function nq(e){var t=e.logs,n=(0,s._)((0,f.useState)(!0),2),r=n[0],i=n[1],o=(0,f.useRef)(null),a=(0,f.useRef)(0),l=(0,f.useCallback)(function(){if(o.current){var e=o.current,t=e.scrollTop,n=e.scrollHeight,r=e.clientHeight;t<a.current?i(!1):n-t-r<=20&&i(!0),a.current=t}},[]);return(0,f.useEffect)(function(){if(r&&o.current&&t.length>0){var e=o.current;e.scrollTop=e.scrollHeight}},[t,r]),(0,c.jsxs)(ew.View,{clsx:[nG.default.logsContainer,r&&nG.default.snapToBottom],innerRef:o,onScroll:l,children:[0===t.length?(0,c.jsx)(ew.View,{p:8,children:(0,c.jsx)(ey.Text,{color:"dimmest",children:"No logs received yet"})}):null,t.map(function(e,t){return(0,c.jsx)(nK,{log:e},"".concat(e.timestamp,"-").concat(t))}),r?(0,c.jsx)(ew.View,{clsx:nG.default.scrollSnap}):null]})}function nK(e){var t=e.log,n=t.method.toLowerCase().includes("error"),r=t.method.toLowerCase().includes("warn"),i=(0,nT.format)(t.timestamp,"yyyy-MM-dd HH:mm:ss.SS");return(0,c.jsxs)(ew.View,{p:4,clsx:[nG.default.logRow,n&&nG.default.errorLog,r&&nG.default.warningLog],row:!0,gap:8,align:"start",children:[(0,c.jsx)(ey.Text,{color:"dimmest",variant:"codeSmall",children:i}),(0,c.jsx)(ew.View,{row:!0,align:"start",gap:8,shrink:1,children:t.parsed.map(function(e,t){return"string"==typeof e?(0,c.jsx)(ew.View,{shrink:1,children:(0,c.jsx)(ey.Text,{variant:"codeSmall",children:e})},t):(0,c.jsx)(nj,{theme:nW,data:e},t)})})]})}function nY(e){if("shell.exec"!==e.config.task)return!1;var t=e.task.metadata;return!!(null==t?void 0:t.openPorts)&&t.openPorts.some(function(e){return(0,k.isProbablyExpoCmdline)(e.cmdline)})}function nQ(e){var t=e.paneId,i=e.openPane,d=e.onClose,p=e.wrapperRef,h=e.dockPosition,g=e.onToggleDock,m=(0,s._)((0,f.useState)([]),2),x=m[0],y=m[1],b=(0,s._)((0,f.useState)(!1),2),w=b[0],k=b[1],_=(0,nR.useCreateObservable)({width:300,height:200});(0,nP.usePid2)(function(e,r){var i=r.signal;return(0,n._)(function(){var n,r,s,c,d,f,p,h,g;return(0,u._)(this,function(u){switch(u.label){case 0:n=e.agentToolWebviewLogs.stream.subscribe({paneId:t},{signal:i}).resReadable,r=!1,s=!1,u.label=1;case 1:u.trys.push([1,6,7,12]),d=function(){var e=p.value;if(!e.ok)return{v:void 0};var t=e.payload.map(function(e){var t;try{t=JSON.parse(e.message)}catch(e){return null}return Array.isArray(t)||(t=[t]),(0,a._)((0,o._)({},e),{parsed:t})}).filter(function(e){return null!==e});y(function(e){var n=(0,l._)(e).concat((0,l._)(t));return n.length>100?n.slice(-100):n})},f=(0,tM._)(n),u.label=2;case 2:return[4,f.next()];case 3:if(!(r=!(p=u.sent()).done))return[3,5];if(h=d(),"object"===(0,tE._)(h))return[2,h.v];u.label=4;case 4:return r=!1,[3,2];case 5:return[3,12];case 6:return g=u.sent(),s=!0,c=g,[3,12];case 7:if(u.trys.push([7,,10,11]),!(r&&null!=f.return))return[3,9];return[4,f.return()];case 8:u.sent(),u.label=9;case 9:return[3,11];case 10:if(s)throw c;return[7];case 11:return[7];case 12:return[2]}})})()},[t]);var S=(0,nN.useWorkflowsTaskFlatMap)(),C=(0,f.useMemo)(function(){var e=new Map,t=!0,n=!1,r=void 0;try{for(var i,o=S[Symbol.iterator]();!(t=(i=o.next()).done);t=!0){var a=i.value;if("shell.exec"===a.config.task){var l=e.get(a.workflowId)||new Map,u=l.get(a.taskIdx)||[];u.push(a),l.set(a.taskIdx,u),e.set(a.workflowId,l)}}}catch(e){n=!0,r=e}finally{try{t||null==o.return||o.return()}finally{if(n)throw r}}return Array.from(e.values()).flatMap(function(e){return function(e){var t=[],n=[],r=[],i=!0,o=!1,a=void 0;try{for(var l,u=e[Symbol.iterator]();!(i=(l=u.next()).done);i=!0){var c=l.value,d=(0,s._)(c,2),f=(d[0],d[1]),p=f.some(nY),h=f.some(function(e){return"waitForPort"in e.config&&null!=e.config.waitForPort});p?t.push(c):h?n.push(c):r.push(c)}}catch(e){o=!0,a=e}finally{try{i||null==u.return||u.return()}finally{if(o)throw a}}var g=[],m=!0,x=!1,y=void 0;try{for(var b,w=e[Symbol.iterator]();!(m=(b=w.next()).done);m=!0)!function(){var e=b.value,i=(0,s._)(e,2),o=i[0],a=i[1],l=a.some(nY),u=a.some(function(e){return"waitForPort"in e.config&&null!=e.config.waitForPort}),c=void 0;if(l){var d=t.findIndex(function(e){return(0,s._)(e,1)[0]===o});c=t.length>1?"Expo ".concat(d+1):"Expo"}else if(u){var f=n.findIndex(function(e){return(0,s._)(e,1)[0]===o});c=n.length>1?"Server Logs ".concat(f+1):"Server Logs"}else{var p=r.findIndex(function(e){return(0,s._)(e,1)[0]===o}),h=a[0].workflowId;c=r.length>1?"".concat(h," Logs ").concat(p+1):"".concat(h," Logs")}g.push({name:c,tasks:a})}()}catch(e){x=!0,y=e}finally{try{m||null==w.return||w.return()}finally{if(x)throw y}}return g}(Array.from(e.entries()))})},[S]),j=(0,f.useCallback)(function(e){if(e.preventDefault(),k(!0),"bottom"===h){var t=e.clientY,n=_.current.height,r=function(e){var r,i=Math.min(Math.max(n+(t-e.clientY),200),((null==(r=p.current)?void 0:r.clientHeight)||0)-200);_.set((0,a._)((0,o._)({},_.current),{height:i}))},i=function(){k(!1),window.removeEventListener("mousemove",r),window.removeEventListener("mouseup",i)};window.addEventListener("mousemove",r),window.addEventListener("mouseup",i)}else{var s=e.clientX,l=_.current.width,u=function(e){var t,n=Math.min(Math.max(l+(s-e.clientX),200),((null==(t=p.current)?void 0:t.clientWidth)||0)-200);_.set((0,a._)((0,o._)({},_.current),{width:n}))},c=function(){k(!1),window.removeEventListener("mousemove",u),window.removeEventListener("mouseup",c)};window.addEventListener("mousemove",u),window.addEventListener("mouseup",c)}},[h,_,p]),T=(0,f.useRef)(null),E=(0,f.useMemo)(function(){return _.map(function(e){var t;return t={},(0,r._)(t,n$.drawerHeight,"".concat(e.height,"px")),(0,r._)(t,n$.drawerWidth,"".concat(e.width,"px")),t})},[_]);return(0,nA.useStyleSet)(T,E),(0,c.jsxs)(ew.View,{clsx:[nG.default.wrapper,"right"===h&&nG.default.wrapperRight],innerRef:T,children:[(0,c.jsx)(ew.View,{clsx:[nG.default.resizeHandle,"right"===h&&nG.default.resizeHandleRight,w&&nG.default.resizing],onMouseDown:j,children:(0,c.jsx)(ew.View,{clsx:nG.default.resizeGrip})}),(0,c.jsx)(ew.View,{clsx:nG.default.tabsWrapper,children:(0,c.jsxs)(nL.Tabs,{css:nz.tabsContainer,children:[(0,c.jsxs)(ew.View,{row:!0,align:"center",justify:"space-between",pl:2,pr:4,clsx:nG.default.header,children:[(0,c.jsxs)(nL.TabList,{withUnderline:!1,css:nz.tabList,children:[(0,c.jsx)(nL.Tab,{id:"webview",css:nz.tab,children:(0,c.jsxs)(ew.View,{row:!0,gap:4,align:"center",children:[(0,c.jsx)(ew.View,{clsx:nG.default.nowrap,children:"Webview Logs"}),(0,c.jsx)(nB.default,{})]})}),C.map(function(e,t){var n=e.name,r=nH(e.tasks),i=null;switch(r.task.state){case nE.TaskState.RUNNING:i=(0,c.jsx)(nV.default,{});break;case nE.TaskState.FINISHED:i=(0,c.jsx)(ts.default,{});break;case nE.TaskState.FAILED:case nE.TaskState.ERROR:i=(0,c.jsx)(eM.default,{})}return(0,c.jsx)(nL.Tab,{id:n,css:nz.tab,children:(0,c.jsxs)(ew.View,{row:!0,gap:4,align:"center",children:[(0,c.jsx)(ew.View,{clsx:nG.default.nowrap,children:n}),i]})},"".concat(n,"-").concat(t))})]}),(0,c.jsxs)(ew.View,{row:!0,gap:2,children:[(0,c.jsx)(em.IconButton,{alt:"bottom"===h?"Dock to right":"Dock to bottom",onClick:g,children:"bottom"===h?(0,c.jsx)(nU.default,{size:12}):(0,c.jsx)(nF.default,{size:12})}),(0,c.jsx)(em.IconButton,{alt:"Close",onClick:d,children:(0,c.jsx)(eN.default,{size:12})})]})]}),(0,c.jsxs)(nL.TabPanels,{children:[(0,c.jsx)(nL.TabPanel,{id:"webview",css:nz.tabPanel,children:(0,c.jsx)(nq,{logs:x})}),C.map(function(e){var n=e.name,r=nH(e.tasks);return(0,c.jsx)(nL.TabPanel,{id:n,css:nz.tabPanel,children:(0,c.jsx)(nX,{runId:r.runId,taskIdx:r.taskIdx,paneId:t,openPane:i})},n)})]})]})})]})}function nX(e){var t=e.runId,r=e.taskIdx,i=e.paneId,o=e.openPane,a=(0,nD.default)().fs,l=(0,nI.useCurrentUserId)(),d=(0,f.useCallback)(function(e){o({type:(0,nO.getPaneTypeForFile)(e),data:e})},[o]),p=(0,f.useCallback)(function(e,t){o({type:"webview",data:{ports:{type:"local",port:t,path:e}}})},[o]),h=(0,s._)((0,nM.default)({listFiles:a.listFiles,openFile:d,openWebview:p,openPane:o}),2),g=h[0],m=h[1],x=(0,f.useRef)(!1);return(0,nP.usePid2)(function(e,o){var a=o.signal;return(0,n._)(function(){var n,o,s,c,d,f,p,h,m,y;return(0,u._)(this,function(u){switch(u.label){case 0:if(x.current||!g||!l)return[2];o=(n=e.workflows.connectToTask.stream({runId:t,taskIdx:r,userId:l,processViewId:i},{signal:a})).resReadable,s=n.reqWritable,x.current=!0,s.write({$kind:"resize",size:g.getSize()}),c=!1,d=!1,u.label=1;case 1:u.trys.push([1,6,7,12]),p=(0,tM._)(o),u.label=2;case 2:return[4,p.next()];case 3:if(!(c=!(h=u.sent()).done))return[3,5];if(!(m=h.value).ok){if("UNEXPECTED_DISCONNECT"===m.payload.code||"CANCEL"===m.payload.code||"NO_MATCHING_TASK_STATE"===m.payload.code)return[3,5];throw Error("[".concat(m.payload.code,"] ").concat(m.payload.message))}"output"===m.payload.$kind&&g.write(m.payload.chunk),u.label=4;case 4:return c=!1,[3,2];case 5:return[3,12];case 6:return y=u.sent(),d=!0,f=y,[3,12];case 7:if(u.trys.push([7,,10,11]),!(c&&null!=p.return))return[3,9];return[4,p.return()];case 8:u.sent(),u.label=9;case 9:return[3,11];case 10:if(d)throw f;return[7];case 11:return[7];case 12:return s.close(),[2]}})})()},[t,r,g,l,i]),(0,c.jsx)(ew.View,{clsx:nG.default.xtermWrapper,children:(0,c.jsx)(ew.View,{clsx:nG.default.xtermInner,innerRef:m})})}var nJ=e.i(703774),nZ=e.i(988676),n0=e.i(26995),n1=e.i(474880),n2=(0,eh.cvarsFrom)("index.module.css",["--width","--height","--transform","--border-radius","--border","--color-scheme","--logs-grid-rows","--logs-grid-columns"]);function n3(e,t){var n=function(e,t){var n,r,i,o=void 0;if((null==e||null==(n=e.ports)?void 0:n.type)==="external")o=null==e||null==(i=e.ports)?void 0:i.port;else if((null==e||null==(r=e.ports)?void 0:r.type)==="local"){var a=t.find(function(t){var n;return t.configuration.localPort===(null==(n=e.ports)?void 0:n.port)});o=null==a?void 0:a.configuration.externalPort}return o}(e,t);return n?n:t.length>0?t.find(function(e){return 80===e.configuration.externalPort})?80:t[0].configuration.externalPort:void 0}var n4=(0,f.forwardRef)(function(e,t){var g,I,A,P,D,O,N,M,L,B,V,F,U,G,$,z,H,W,Y,X,J,Z,ee,et,en,er,eo,ea,el,ec,ed,ef,ep,eg,em,ev,ex,eb,ek,e_,eS,eC,ej,eT,eE,eI,eA,eP,eD,eO,eN,eM,eL,eV,eF,eU,eG,ez,eW,eq,eK=e.initialPort,eY=e.initialPath,eQ=void 0===eY?"/":eY,eX=e.openPane,eJ=e.ports,e0=e.container,e1=e.previewScreenSize,e2=e.setPreviewScreenSize,e3=e.isMobilePIP,e4=e.readonlyBannerVariant,e8=e.paneId,e5=(0,s._)((0,f.useState)(!0),2),e6=e5[0],e9=e5[1],e7=(0,s._)((0,f.useState)(!1),2),tt=e7[0],tn=e7[1],tr=(0,tN.useCookieWarningBannerDismissed)(),ti=(0,tN.useSetCookieWarningBannerDismissed)(),ta=(0,f.useId)(),ts=(0,b.default)(),tl=(0,Q.useIsAgentStackRepl)().isAgentStackRepl,tu=(0,m.default)(),tc=q(),td=(0,T.isGalleryPreviewPort)(eK),tf=(0,f.useRef)(null),tp=(0,f.useRef)(null),th=(0,f.useRef)(!1),tg=(0,s._)((0,f.useState)(!1),2),tm=tg[0],tv=tg[1],tx=(0,s._)((0,f.useState)(!1),2),tb=tx[0],tw=tx[1],tk=(0,f.useRef)(!1),t_=(g=({desiredScreenSize:e1}).desiredScreenSize,A=(I=(0,s._)((0,f.useState)(void 0),2))[0],P=I[1],{resizeRef:(0,w.default)(function(e){P(e)}),screenSize:(0,f.useMemo)(function(){if(g&&A){var e=A.width-80,t=A.height-80,n=g.screen,r=n.width,i=n.height,o=r/i,a=t*o,s=e,l=e/o;a<=e&&(s=a,l=t);var u=Math.min(1,s/r,l/i);return s=1===u?r:s,l=1===u?i:l,{width:r,height:i,scaledWidth:s,scaledHeight:l,scale:u}}},[g,A])}),tS=t_.resizeRef,tC=t_.screenSize,tj=(0,tT.useReplShieldToken)().token,tD=(0,f.useMemo)(function(){return!tu&&!tc&&!td&&!e3},[tu,tc,td,e3]),tM=(0,j.useUrls)({ports:eJ,container:e0,addDevToolsSuffix:tD}),tL=(0,f.useMemo)(function(){return!(null==tM?void 0:tM.reachability.dotdev)&&!(null==tM?void 0:tM.reachability.replCo)&&!tt},[tM,tt]),tB=null!=tM,tV=(0,E.useOpenedAndForwardedPorts)(eJ),tF=(D=e8,O=(0,f.useRef)([]),N=n8((0,C.usePid2Callback)(function(e){return function(){return(0,n._)(function(){var t;return(0,u._)(this,function(n){return(t=(0,l._)(O.current),O.current=[],t&&t.length)?[2,e.agentToolWebviewLogs.store.rpc({logs:t,paneId:D})]:[2]})})()}},[D]),O,100),(0,f.useCallback)(function(e,t){O.current.push({method:e,message:t}),N()},[N])),tU=(M=(0,f.useRef)([]),L=n8((0,C.usePid2Callback)(function(e){return function(){return(0,n._)(function(){var t;return(0,u._)(this,function(n){return(t=(0,l._)(M.current),M.current=[],t.length)?[2,e.agentToolWebviewNetworkRequests.store.rpc(t)]:[2]})})()}},[]),M,500),(0,f.useCallback)(function(e){var t=(0,a._)((0,o._)({},e),{requestBody:"string"==typeof e.requestBody?new TextEncoder().encode(e.requestBody):e.requestBody,responseBody:null==e.responseBody||(0,i._)(e.responseBody,Uint8Array)?e.responseBody:new TextEncoder().encode("string"==typeof e.responseBody?e.responseBody:JSON.stringify(e.responseBody))});M.current.push(t),L()},[L]));(0,f.useEffect)(function(){!tu||tB&&tp.current.addEventListener("dom-ready",function(){th.current=!0})},[tu,tB]);var tG=(0,f.useCallback)(function(e,t){return(0,n._)(function(){var n,r;return(0,u._)(this,function(i){return tp.current&&(null==(n=tp.current)?void 0:n.contentWindow)&&(null==tM?void 0:tM.iframeSrc)?(r=tP({id:ta,iframeSrc:tM.iframeSrc,port:t,path:e,mintReplShieldToken:tj||void 0,navigateThroughWorkspaceDevtools:tD}),tp.current.src=r,[2,new Promise(function(e){var t,n,r=function(){var e,t;clearTimeout(a),null==(e=tp.current)||e.removeEventListener("load",i),null==(t=tp.current)||t.removeEventListener("error",o)},i=function(){r(),e()},o=function(){r(),e()},a=setTimeout(function(){r(),e()},1e4);null==(t=tp.current)||t.addEventListener("load",i),null==(n=tp.current)||n.addEventListener("error",o)})]):[2]})})()},[ta,tD,tM,tj]),t$=(0,y.default)(tG),tz=(0,s._)((0,f.useState)(null),2),tH=tz[0],tW=tz[1],tq=(0,f.useCallback)(function(e){return tW(e)},[tW]),tK=(0,S.useIsInMobileWorkspace)(),tY=K({isSupported:!e3&&tc,navigateIframeRef:t$,onReceiveWebviewLog:tF,onReceiveWebviewScreenshot:tq,initialPort:eK,initialPath:eQ,baseUrl:null==tM?void 0:tM.baseUrl}),tQ=(V=(B={replId:ts,webviewId:ta,iframeOrWebviewRef:tp,iframeSrc:null==tM?void 0:tM.iframeSrc,onReceiveWebviewLog:tF,onReceiveNetworkRequest:tU,bonsaiWebviewBridge:tY,onThirdPartyCookieCheck:function(e){e||e9(!1)}}).replId,F=B.webviewId,U=B.iframeOrWebviewRef,G=B.iframeSrc,$=B.onReceiveWebviewLog,z=B.onReceiveNetworkRequest,H=B.bonsaiWebviewBridge,W=B.onThirdPartyCookieCheck,X=(Y=(0,s._)((0,f.useState)({state:"loading",relativeUrl:null}),2))[0],J=Y[1],Z=(0,m.default)(),(0,f.useEffect)(function(){if(Z&&G){if(!U.current)throw Error("Expected iframe to be defined when iframerc exists");var e=U.current,t=new URL(G);return e.addEventListener("did-navigate",n),e.addEventListener("did-navigate-in-page",n),function(){e.removeEventListener("did-navigate",n),e.removeEventListener("did-navigate-in-page",n)}}function n(e){var n=new URL(e.url),r=n.pathname+n.search+n.hash;n.hostname!==t.hostname?J(function(e){return"external-page"===e.state?e:{state:"external-page",relativeUrl:null}}):J(function(e){return"active"===e.state&&e.relativeUrl===r?e:{state:"active",relativeUrl:r}})}},[Z,G,U]),(0,f.useEffect)(function(){if(H)return H.path.subscribe(function(e){J(function(t){return"active"===t.state&&"path"===t.relativeUrl?t:{state:"active",relativeUrl:e}})})},[H]),(0,f.useEffect)(function(){if(!Z&&!H&&G){var e=new URL(G);return window.addEventListener("message",t),function(){window.removeEventListener("message",t)}}function t(t){if(t.origin&&"null"!==t.origin){if(new URL(t.origin).hostname===e.hostname&&"object"===(0,tE._)(t.data)&&(null==(n=t.data)?void 0:n.type)){var n,r=t.data;if(null==r||!r.id||r.id===F)switch(r.type){case"event":var i=t.data,s=i.event,l=i.payload;"error"===s?tR.captureException(l):(0,es.track)(s,(0,a._)((0,o._)({},l),{replId:V}));break;case"forward-log":$(r.method,r.message);break;case"forward-network-request":z(r.message);break;case"third-party-cookie-check":W(r.payload.enabled);break;case"page-navigation":if(r.payload.isExternal)return void J(function(e){return"external-page"===e.state?e:{state:"external-page",relativeUrl:null}});var u=r.payload.relativeUrl;J(function(e){return"active"===e.state&&e.relativeUrl===u?e:{state:"active",relativeUrl:u}})}}}}},[V,F,Z,G,U,$,z,H,W]),{webviewPageState:X}).webviewPageState,tX=(0,f.useCallback)(function(e,t){return(0,n._)(function(){var n;return(0,u._)(this,function(r){return tM?tu?th.current?(n=tP({id:ta,iframeSrc:tM.iframeSrc,port:t,path:e,mintReplShieldToken:tj||void 0,navigateThroughWorkspaceDevtools:tD}),[2,tp.current.loadURL(n)]):[2]:(tY&&tY.handleNavigateTo({port:null!=t?t:80,path:e,base:tM.baseUrl}),[2,tG(e,t)]):[2]})})()},[tM,tu,tY,tG,ta,tD,tj]),tJ=(et=(ee={initialPort:eK,initialPath:eQ,presentationalUrl:null==tM?void 0:tM.presentationUrl,webviewPageState:tQ,navigateTo:function(e,t){return tX(e,t)}}).initialPort,en=ee.initialPath,er=ee.presentationalUrl,eo=ee.webviewPageState,ea=ee.navigateTo,ec=(el=(0,s._)((0,f.useState)(!1),2))[0],ed=el[1],ep=(ef=(0,s._)((0,f.useState)(!1),2))[0],eg=ef[1],ev=(em=(0,s._)((0,f.useState)("Loading..."),2))[0],ex=em[1],ek=(eb=(0,s._)((0,f.useState)(80),2))[0],e_=eb[1],eC=(eS=(0,s._)((0,f.useState)(!1),2))[0],ej=eS[1],eT=(0,f.useCallback)(function(e,t,n,r,i){ed(e),eg(t),ex(n),e_(r),ej(i)},[]),eE=(0,y.default)(ea),eI=(0,y.default)(et),eA=(0,y.default)(en),eP=(0,tI.default)(function(){return new tA({initialRelativeUrl:eA.current,initialPort:eI.current,onChange:eT,navigateTo:eE})},[eA,eI,eT,eE]),(0,f.useEffect)(function(){"loading"!==eo.state||eI.current!==ek&&eP.setPort(eI.current)},[et,eI,eP,ek,eo]),(0,f.useEffect)(function(){"active"===eo.state&&eP.relativeUrlUpdate(eo.relativeUrl)},[eo.state,eo.relativeUrl,eP]),(0,f.useEffect)(function(){eP.navigate(eA.current,et)},[et,eA,eP]),eD=(0,f.useCallback)(function(){eu({actionType:"navigated_to",path:ev}),eP.navigate(ev)},[ev,eP]),eO=(0,f.useCallback)(function(){var e=(0,j.addPortToUrl)(er||"",ek);return ev&&(e.pathname=ev),e.toString()},[ev,er,ek]),eN=(0,f.useCallback)(function(){return eP.back()},[eP]),eM=(0,f.useCallback)(function(){return eP.forward()},[eP]),eL=(0,f.useCallback)(function(){return eP.refresh()},[eP]),eV=(0,f.useCallback)(function(e){return eP.setPort(e)},[eP]),{canNavigateBack:ec,canNavigateForward:ep,navigateBack:eN,navigateForward:eM,canNavigateToInputRelativeUrl:(0,f.useMemo)(function(){return ev!==eo.relativeUrl},[ev,eo.relativeUrl]),navigateToInputRelativeUrl:eD,inputRelativeUrl:ev,setInputRelativeUrl:ex,refresh:eL,setPort:eV,selectedPort:ek,getExternalUrl:eO,isRefreshing:eC}),tZ=(0,y.default)(tJ),t0=(0,E.useOpenedPortMatchingExternalPort)(tJ.selectedPort);(0,f.useEffect)(function(){t0&&t0.configuration.isLocalhost&&"loading"===tQ.state&&tZ.current.refresh()},[tZ,t0,tQ.state]);var t1=(0,h.useProposedPlan)();(0,f.useEffect)(function(){td&&tK&&(null==t1?void 0:t1.planId)&&tZ.current.refresh()},[tK,td,tZ,t1]),(0,f.useImperativeHandle)(t,function(){return{refresh:function(){return tZ.current.refresh()},navigateTo:tX,getCurrentPath:function(){return tQ.relativeUrl}}},[tX,tZ,tQ.relativeUrl]);var t2=(0,nJ.useTheme)().isDarkColorScheme,t3=!e3,t4=(0,x.useFlag)({controlName:"flag-make-more-money"})&&!tY&&t3;(0,f.useEffect)(function(){tY&&tY.setInsets({top:td?48:40})},[tY,td]);var t8=(0,f.useCallback)(function(){return eX({type:"developer",data:{tab:["networking"]}})},[eX]),t5=(0,f.useMemo)(function(){var e=tV.find(function(e){return e.configuration.externalPort===tJ.selectedPort});return!!e&&(0,k.isProbablyExpoCmdline)(e.processInfo.cmdline)},[tV,tJ.selectedPort]),t6=(0,s._)((0,f.useState)(function(){return t5?"right":"bottom"}),2),t9=t6[0],t7=t6[1],ne=(0,f.useMemo)(function(){if(t5)try{var e=new URL(tJ.getExternalUrl());return"exp://".concat(e.host)}catch(e){return}},[t5,tJ]),nt=(0,R.useMemoedDismissibleElement)("expo-qr-preview-pane"),nn=nt.isDone,nr=nt.setAsDone;if((0,f.useEffect)(function(){void 0!==e1&&(tk.current=!0)},[e1]),(0,f.useEffect)(function(){!t5||!e2||tK||e1||tk.current||(e2(te),tk.current=!0)},[t5,e1,e2,tK]),tl)return(0,c.jsx)(tO,{openPane:eX});if(!tM)return null;var ni="0 0 ".concat(eh.tokens.space4," ").concat(eh.tokens.space4);return(tC?ni=eh.tokens.space4:tK?ni="0":tm&&(ni="0"),eF=e3||td||!tH?(0,c.jsxs)(ew.View,{clsx:n1.default.iframeWrapper,grow:!0,shrink:!0,"data-is-readonly-preview":td,innerRef:tS,align:"center",justify:"center",gap:4,children:[(0,c.jsx)(ew.View,{style:(eG={overflow:"hidden"},(0,r._)(eG,n2.width,tC?"".concat(tC.scaledWidth,"px"):"100%"),(0,r._)(eG,n2.height,tC?"".concat(tC.scaledHeight,"px"):"100%"),(0,r._)(eG,n2.borderRadius,ni),(0,r._)(eG,n2.border,tC?"1px solid ".concat(eh.tokens.outlineDefault):"none"),eG),clsx:n1.default.iframeMiddle,children:(0,c.jsx)(ew.View,{style:(ez={},(0,r._)(ez,n2.width,tC?"".concat(tC.width,"px"):"100%"),(0,r._)(ez,n2.height,tC?"".concat(tC.height,"px"):"100%"),(0,r._)(ez,n2.transform,"scale(".concat(null!=(eU=null==tC?void 0:tC.scale)?eU:1,")")),ez),clsx:n1.default.iframeInner,children:tu?(0,c.jsx)("webview",(0,o._)({"data-cy":"ws-webview",ref:tp,src:tP({iframeSrc:tM.iframeSrc,port:eK,path:eQ,id:ta,mintReplShieldToken:tj||void 0,navigateThroughWorkspaceDevtools:tD}),style:(0,r._)({},n2.colorScheme,t2?"dark":"light"),className:n1.default.desktopAppWebview},_.default)):(0,c.jsx)("iframe",(0,o._)({title:"webview","data-cy":"ws-webview",ref:tp,src:tP({iframeSrc:tM.iframeSrc,port:eK,path:eQ,id:ta,mintReplShieldToken:tj||void 0,navigateThroughWorkspaceDevtools:tD}),style:(0,r._)({},n2.colorScheme,t2?"dark":"light"),className:n1.default.iframe},_.default))})}),ne&&!tc&&tC?(0,c.jsxs)(to.PopoverTrigger,{isOpen:tb,onOpenChange:function(e){tw(e),e&&!nn&&nr()},label:"Show Expo Go QR code",background:"higher",children:[(0,c.jsx)(e$.Button,{style:{width:"".concat(tC.scaledWidth,"px")},iconRight:(0,c.jsx)(n0.default,{}),text:"Preview on mobile device",variant:nn?"outlined":void 0,colorway:nn?void 0:"primary"}),(0,c.jsxs)(ew.View,{p:8,gap:8,align:"center",children:[(0,c.jsx)(p.default,{bgColor:eh.tokens.backgroundHigher,fgColor:eh.tokens.foregroundDefault,clsx:n1.default.expoQrCode,size:196,value:ne}),(0,c.jsxs)(ey.Text,{variant:"small",color:"dimmer",children:["Install"," ",(0,c.jsx)(d.default,{href:"https://expo.dev/go",target:"_blank",rel:"noopener noreferrer",style:{textDecoration:"underline"},children:"Expo Go"})," ","to scan and preview"]})]})]}):null]}):(0,c.jsx)(ew.View,{clsx:n1.default.screenshotWrapper,style:{backgroundImage:"url(".concat(tH,")")}}),td)?(0,c.jsxs)(ew.View,{clsx:n1.default.root,children:[t3?(0,c.jsx)(ei,{readonlyBannerVariant:null!=e4?e4:"none"}):null,eF]}):(eW=e3?null:tc?(0,c.jsx)(eR,{webviewPageState:tQ,navigationState:tJ,bonsaiWebviewBridge:tY,expoUrl:ne}):(0,c.jsx)(ty,{replId:ts,url:tM.presentationUrl,webviewPageState:tQ,navigationState:tJ,forwardedPorts:tV,onToggleWebviewLogs:function(){tv(function(e){return!e})},onOpenPortSettings:t8,screenSize:e1,setScreenSize:e2,replShield:!!tj,openPane:eX,expoUrl:ne}),(0,c.jsxs)(ew.View,{clsx:n1.default.root,innerRef:tf,children:[eW,(0,c.jsx)(nZ.DividerH,{}),t4?(0,c.jsx)(eZ,{replId:ts}):null,tL?(0,c.jsx)(eH,{reachability:tM.reachability,navigationState:tJ,onDismiss:function(){return tn(!0)}}):null,tL||e6||tr?null:(0,c.jsx)(eB,{navigationState:tJ,onDismiss:function(){return ti(!0)}}),(0,c.jsxs)(ew.View,{grow:!0,shrink:!0,clsx:n1.default.webContentAndLogsWrapper,style:(eq={},(0,r._)(eq,n2.logsGridRows,tm&&"bottom"===t9?"1fr auto":"1fr"),(0,r._)(eq,n2.logsGridColumns,tm&&"right"===t9?"1fr auto":"1fr"),eq),children:[(0,c.jsxs)(ew.View,{clsx:n1.default.webContentWrapper,children:[eF,tC?(0,c.jsxs)(ew.View,{clsx:n1.default.scalingFactor,children:[Math.round(100*tC.scale),"%"]}):null]}),tm&&e8?(0,c.jsx)(nQ,{paneId:e8,openPane:eX,wrapperRef:tf,onClose:function(){return tv(!1)},dockPosition:t9,onToggleDock:function(){return t7(function(e){return"bottom"===e?"right":"bottom"})}}):null]})]}))});function n8(e,t,r){var i=(0,f.useMemo)(function(){return(0,g.default)(function(){return(0,n._)(function(){return(0,u._)(this,function(t){return[2,null==e?void 0:e()]})})()},{wait:r})},[e,r]);return(0,f.useEffect)(function(){e&&t.current.length>0&&i()},[e,i,t]),i}e.s(["WebviewBrowser",()=>n4,"getInitialPort",()=>n3],378042)},908197,e=>{"use strict";var t=e.i(276385),n=e.i(282332),r=e.i(529810),i=e.i(378042),o=e.i(446530),a=e.i(613355),s=(0,o.cssRecord)({webview:[a.rcss.height("auto"),a.rcss.flex.grow(1),a.rcss.position.relative]});function l(e){var o=e.openPane,a=(0,r.default)(),l=a.container,u=a.ports;return(0,t.jsx)(i.WebviewBrowser,{css:s.webview,container:l,ports:u,initialPort:n.GALLERY_PREVIEW_PORT,readonlyBannerVariant:"gallery",openPane:o})}e.s(["AgentGalleryPreview",()=>l])},779154,e=>{"use strict";var t=e.i(721281),n=e.i(276385),r=e.i(389959),i=e.i(709485),o=e.i(858248),a=e.i(729122),s=e.i(480028),l=e.i(446530),u=e.i(123850),c=e.i(613355),d=e.i(960178),f=e.i(625484),p=e.i(978669),h=(0,u.createCssVarTokens)(["backgroundColor","color","hoverColor","hoverBackgroundColor"]),g=h.cssVars,m=h.styleTokens,x=(0,l.cssRecord)({wrapper:[c.rcss.display.inlineFlex,{backgroundColor:m.backgroundColor,color:m.color,"&:hover":{color:m.hoverColor,backgroundColor:m.hoverBackgroundColor}},c.rcss.align.center,c.rcss.borderRadius(),c.rcss.py(2),c.rcss.px(6),c.rcss.cursor.pointer]});function y(e){var l,u=e.trackSource,c=void 0===u?"unknown":u,h=(0,a.useRunInfo)(),m=h.isOffline,y=h.isWorkflowsLoading,b=h.isDisabled,w=(0,a.useOnStartRun)(),k=(0,r.useMemo)(function(){return m||y},[m,y]);return(0,n.jsxs)(f.View,{tag:"button",onClick:function(){(0,o.track)(i.events.WORKFLOW_RAN,{source:c,runner:"workflows"}),w()},css:x.wrapper,row:!0,gap:6,disabled:k||b,style:(l={},(0,t._)(l,g.backgroundColor,k?s.tokens.backgroundHighest:s.tokens.accentPositiveDimmer),(0,t._)(l,g.color,k?s.tokens.foregroundDimmer:s.tokens.accentPositiveStrongest),(0,t._)(l,g.hoverColor,k?s.tokens.foregroundDefault:s.tokens.white),(0,t._)(l,g.hoverBackgroundColor,k?s.tokens.greyDimmest:s.tokens.accentPositiveDefault),l),children:[(0,n.jsx)(p.default,{size:12}),(0,n.jsx)(d.Text,{children:"Run"})]})}e.s(["InlineRunButton",()=>y])},84134,e=>{e.v({capabilityContainer:"DynamicReplitCapabilities-module__YMIwsq__capabilityContainer"})},808053,e=>{"use strict";var t=e.i(530658),n=e.i(346715),r=e.i(276385),i=e.i(389959),o=e.i(480028),a=e.i(960178),s=e.i(625484),l=e.i(598160),u=e.i(658886),c=e.i(717368),d=e.i(788331),f=e.i(744895),p=e.i(906204),h=e.i(292297),g=e.i(503536),m=e.i(283023),x=e.i(987154),y=e.i(961864),b=e.i(292642),w=e.i(452814),k=e.i(373764),_=e.i(527225),S=e.i(467185),C=e.i(781478),j=e.i(652219),T=e.i(84134),E=[{text:"Built-in database (just ask Agent!)",icon:"Database"},{text:"Develop on the go with the mobile app",icon:"Smartphone"},{text:'Press "Publish" to put your app online',icon:"Deploy"},{text:"Use Plan Mode to chat without code changes",icon:"Chat"},{text:"Use Edit Mode to change individual elements",icon:"Edit"},{text:"Use App Storage for images/videos",icon:"Cloud"},{text:"Invite collaborators in real-time",icon:"UserAdd"},{text:"Use Rollbacks to undo changes",icon:"History"},{text:"Turn on Dynamic Intelligence for more power",icon:"Cpu"},{text:"Send message while Agent is working to add to queue",icon:"ChatAdd"},{text:"Seamless integrations with 3rd party tools",icon:"Puzzle"}],R=[{text:"Generate images with AI, automatically",icon:"Sparkle"},{text:"Agent checks its work with App Testing",icon:"Cursor"},{text:"Custom domains for professional apps",icon:"Globe"}],I=[{text:"Connect your agent or automation to external services",icon:"Link"}];function A(e){var A,P,D=e.isAgentStackRepl,O=(0,t._)((0,i.useState)(0),2),N=O[0],M=O[1],L=(0,t._)((0,i.useState)(!0),2),B=L[0],V=L[1],F=(0,i.useRef)(null),U=D?(0,n._)(E).concat((0,n._)(I)):(0,n._)(E).concat((0,n._)(R));(0,i.useEffect)(function(){var e=setInterval(function(){V(!1),F.current=window.setTimeout(function(){M(function(e){return(e+1)%U.length}),V(!0)},300)},3500);return function(){clearInterval(e),F.current&&clearTimeout(F.current)}},[U.length]);var G=U[N];return(0,r.jsxs)(s.View,{row:!0,align:"center",gap:12,py:4,className:T.default.capabilityContainer,style:{opacity:+!!B,transform:B?"translateY(0)":"translateY(4px)"},children:[(0,r.jsx)(s.View,{children:(A=G.icon,(P=({Deploy:g.default,Sparkle:S.default,Database:h.default,Cloud:d.default,Smartphone:_.default,UserAdd:C.default,Cursor:p.default,History:y.default,Chat:u.default,Edit:m.default,Cpu:f.default,ChatAdd:c.default,Puzzle:k.default,Globe:x.default,Link:b.default,Publish:w.default,UserMultiplayer:j.default,Bug:l.default})[A])?(0,r.jsx)(P,{size:20,color:o.tokens.foregroundDimmer}):null)}),(0,r.jsx)(a.Text,{color:"dimmer",children:G.text})]})}e.s(["DynamicReplitCapabilities",()=>A])},471934,e=>{e.v({borderWrapper:"AgentAwareWebviewEmptyStates-module__IjFd0a__borderWrapper",crashedBodyWrapper:"AgentAwareWebviewEmptyStates-module__IjFd0a__crashedBodyWrapper"})},561132,e=>{"use strict";var t=e.i(276385),n=e.i(389959),r=e.i(629536),i=e.i(47503),o=e.i(712516),a=e.i(468095),s=e.i(729122),l=e.i(252788),u=e.i(779154),c=e.i(765890),d=e.i(808053),f=e.i(960178),p=e.i(625484),h=e.i(550801),g=e.i(179140),m=e.i(940745);e.i(115357);var x=e.i(387710),y=e.i(42458),b=e.i(497627),w=e.i(471934);function k(){return(0,t.jsx)(o.default,{pane:{type:"webview"},headerText:"Preview will be available soon",icon:(0,t.jsx)(g.default,{size:48,variant:"minimal"}),body:(0,t.jsx)(p.View,{align:"center",children:(0,t.jsx)(d.DynamicReplitCapabilities,{})})})}function _(){return(0,t.jsx)(o.default,{pane:{type:"webview"},icon:(0,t.jsx)(x.default,{size:48}),headerText:"Your app is not running",body:(0,t.jsxs)(p.View,{align:"center",row:!0,gap:4,children:[(0,t.jsx)(u.InlineRunButton,{})," to preview your app."]})})}function S(){return(0,t.jsx)(o.default,{pane:{type:"webview"},icon:(0,t.jsx)(m.default,{size:48}),headerText:"Your app is starting",bodyText:null})}function C(){return(0,t.jsx)(o.default,{pane:{type:"webview"},headerText:"The workspace is loading",bodyText:null})}function j(){return(0,t.jsx)(o.default,{pane:{type:"webview"},icon:(0,t.jsx)(b.default,{size:48}),headerText:"The workspace is reconnecting",bodyText:null})}function T(){return(0,t.jsx)(o.default,{pane:{type:"webview"},icon:(0,t.jsx)(m.default,{size:48}),headerText:"Your app is not ready yet",body:(0,t.jsx)(p.View,{align:"center",children:(0,t.jsxs)(f.Text,{children:[(0,r.getAgentName)({capitalizeFirstChar:!0})," is working on it"]})})})}function E(e){var n=e.openPane,r=e.crashedRunId,a=(0,s.useWorkflowsRunState)(),u=null==a?void 0:a[r],c=(0,i.useCurrentUserId)();return(0,t.jsx)(o.default,{pane:{type:"webview"},icon:(0,t.jsx)(x.default,{size:48}),headerText:"Your app crashed",body:(0,t.jsxs)(p.View,{clsx:w.default.crashedBodyWrapper,gap:16,children:[c&&u?(0,t.jsx)(p.View,{clsx:w.default.borderWrapper,children:(0,t.jsx)(l.default,{workflowRunState:u,currentUserId:c,openPane:n})}):null,(0,t.jsx)(p.View,{align:"center",children:(0,t.jsx)(R,{openPane:n})})]})})}function R(e){var i=e.openPane,o=(0,a.useSendAgentMessage)({openPane:i}),s=(0,n.useCallback)(function(e){o("The app failed to run, please debug and fix it.",e)},[o]);return(0,t.jsx)(c.SendAgentMessageButtonGroup,{onSendAgentMessage:s,buttonText:"Debug with ".concat(r.AGENT_NAME),menuPrefix:"Debug",colorway:"blurple"})}function I(e){var r=e.openPane,i=e.nixError,a=(0,n.useCallback)(function(e){r({type:"codeEditor",data:{path:e}})},[r]);return(0,t.jsx)(o.default,{pane:{type:"webview"},icon:(0,t.jsx)(y.default,{size:48}),headerText:"App is in recovery mode",body:(0,t.jsx)(p.View,{clsx:w.default.borderWrapper,children:(0,t.jsx)(p.View,{p:16,children:(0,t.jsx)(h.NixIsBrokenModalContent,{openFile:a,nixError:i})})})})}e.s(["AgentAwareWebviewAppCrashedAgentNotWorkingEmptyState",()=>E,"AgentAwareWebviewAppCrashedAgentWorkingEmptyState",()=>T,"AgentAwareWebviewAppNotRunningEmptyState",()=>_,"AgentAwareWebviewAppStartingEmptyState",()=>S,"AgentAwareWebviewConnectingEmptyState",()=>C,"AgentAwareWebviewNixIsBrokenEmptyState",()=>I,"AgentAwareWebviewPreviewSoonEmptyStateV2",()=>k,"AgentAwareWebviewReconnectingEmptyState",()=>j])},134405,57527,e=>{"use strict";var t,n,r=e.i(642049);e.i(877212);var i=e.i(924908);e.i(925218);var o=e.i(641555),a=e.i(761732),s=e.i(529810),l=e.i(410926),u=e.i(727894),c=e.i(341727),d=e.i(782672),f=e.i(729122),p=e.i(389959),h=e.i(188507),g=e.i(267103),m=e.i(802088);function x(){var e=(0,i.useChatter)(),t=(0,g.useObservable)(e.sessions.agent.current);return(0,p.useMemo)(function(){return null==t?void 0:t.reduce(b,1).result},[t])}function y(e){var t=x();(0,m.useObserver)(t,{next:function(t){t.toPresent&&e(t.toPresent.toolData,t.toPresent.eventId)}})}var b={direction:"reverse",state:{toPresent:void 0},reducer:function(e,t){if(e.sender.type!==h.UserType.AI)return!1;var n=e.contents.contents;if((null==n?void 0:n.$kind)==="agentTimelineEventContents"){var r=n.agentTimelineEventContents.toolData;switch(null==r?void 0:r.$kind){case"presentResultsToolData":return t.toPresent={toolData:{$kind:"presentResultsToolData",data:r.presentResultsToolData},eventId:e.id},!1;case"deployData":return t.toPresent={toolData:{$kind:"deployData",data:r.deployData},eventId:e.id},!1}}}};e.s(["useOnPresentToUser",()=>y,"usePresentToUserEvents",()=>x],57527);var w=e.i(417120);function k(e){return e[e.length-1]}(t={}).NONE="NONE",t.GALLERY_PREVIEW="GALLERY_PREVIEW";var _=((n={}).WORKSPACE_CONNECTING="WORKSPACE_CONNECTING",n.WORKSPACE_RECONNECTING="WORKSPACE_RECONNECTING",n.NIX_IS_BROKEN="NIX_IS_BROKEN",n.SERVICES_LOADING="SERVICES_LOADING",n.GALLERY_PREVIEW="GALLERY_PREVIEW",n.APP_CRASHED_AGENT_WORKING="APP_CRASHED_AGENT_WORKING",n.APP_CRASHED_AGENT_IDLE="APP_CRASHED_AGENT_IDLE",n.APP_NOT_RUNNING_AGENT_WORKING="APP_NOT_RUNNING_AGENT_WORKING",n.APP_NOT_RUNNING_AGENT_IDLE="APP_NOT_RUNNING_AGENT_IDLE",n.APP_STARTING_AGENT_WORKING="APP_STARTING_AGENT_WORKING",n.APP_STARTING_AGENT_IDLE="APP_STARTING_AGENT_IDLE",n.READY="READY",n.LAST_RESORT_RUNNING_NO_PORT="LAST_RESORT_RUNNING_NO_PORT",n.LAST_RESORT_READY="LAST_RESORT_READY",n);function S(){return{hasGalleryPreviewPortAvailable:(0,l.useIsGalleryPreviewPortForwarded)()}}function C(){return S().hasGalleryPreviewPortAvailable?{type:"GALLERY_PREVIEW"}:{type:"NONE"}}function j(){var e=(0,c.default)(),t=e.didConnectOnce,n=e.didDisconnect,l=(0,d.useNixError)(),p=(0,f.useRunInfo)(),h=(0,f.useWorkflowsRunState)(),g=(0,s.default)().ports,m=(0,a.default)(g.portsState),y=(0,w.useIsAgentWorking)(),b=(0,i.useChatter)(),_=(0,o.useObservableMemo)(function(){return b.sessions.agent.current},[b.sessions],{default:void 0}),S=(0,u.useInitialBuildState)(_),C=(0,u.isInitialBuildStarted)(null==S?void 0:S.phase),j=null!==m&&!1===p.isWorkflowsLoading,T=Object.values(null!=h?h:{}).filter(function(e){return"agent"===e.workflow.author&&e.tasks.some(function(e){return"shell.exec"===e.config.task})}).sort(function(e,t){return e.startTime-t.startTime}),E=T.filter(function(e){return e.step===r.WorkflowStateStep.RUNNING}),R=E.length>0?E:T,I=R.flatMap(function(e){return e.tasks.map(function(t){return{task:t,runId:e.runId}})}).filter(function(e){return"shell.exec"===e.task.config.task}).filter(function(e){var t,n;return null==(n=e.task.metadata)||null==(t=n.openPorts)?void 0:t.some(function(e){return e.forwarded})}),A=I.length>0,P=A?null==h?void 0:h[I[0].runId]:k(R),D=k(Object.values(null!=h?h:{}).filter(function(e){return"agent"!==e.workflow.author&&e.step===r.WorkflowStateStep.RUNNING&&e.tasks.some(function(e){var t;return(null==(t=e.metadata)?void 0:t.task)==="shell.exec"})}).sort(function(e,t){return e.startTime-t.startTime})),O=x();return{areNecessaryServicesReady:j,didConnectOnce:t,didDisconnect:n,hasAgentWorkflowOpenedAPort:A,isAgentWorking:y,isInInitialBuild:C,lastResortWorkflowThatRuns:D,latestWorkflowRunStateForAgentTask:P,nixError:l,presentWebsiteResultEvent:(0,o.useObservableMemo)(function(){return null==O?void 0:O.scan(function(e,t){var n,r;return(null==(n=t.toPresent)?void 0:n.toolData.$kind)==="presentResultsToolData"&&"website"===t.toPresent.toolData.data.resultType?null==(r=t.toPresent)?void 0:r.toolData.data:e},void 0)},[O])}}function T(){var e=C(),t=j(),n=t.areNecessaryServicesReady,i=t.didConnectOnce,o=t.didDisconnect,a=t.hasAgentWorkflowOpenedAPort,s=t.isAgentWorking,l=t.isInInitialBuild,u=t.lastResortWorkflowThatRuns,c=t.latestWorkflowRunStateForAgentTask,d=t.nixError,f=t.presentWebsiteResultEvent;if(!i)return{state:"WORKSPACE_CONNECTING"};if(o)return{state:"WORKSPACE_RECONNECTING"};if((null==d?void 0:d.status)==="error"||(null==d?void 0:d.status)==="rebuilding-after-error")return{state:"NIX_IS_BROKEN",nixError:d};if(!n)return{state:"SERVICES_LOADING"};if("GALLERY_PREVIEW"===e.type)return{state:"GALLERY_PREVIEW"};if(void 0!==u&&void 0===c){var p,h,g,m=null==(p=u.tasks)?void 0:p.find(function(e){var t,n,r;return!!((null==(t=e.metadata)?void 0:t.task)==="shell.exec"&&(null==(r=e.metadata)||null==(n=r.openPorts)?void 0:n.some(function(e){return e.forwarded})))}),x=null==m||null==(g=m.metadata.openPorts)||null==(h=g.find(function(e){return e.forwarded}))?void 0:h.externalPort;return x?{state:"LAST_RESORT_READY",externalPort:x}:{state:"LAST_RESORT_RUNNING_NO_PORT"}}if((null==c?void 0:c.step)===r.WorkflowStateStep.FAILED){var y=c.runId;return s?{state:"APP_CRASHED_AGENT_WORKING",crashedRunId:y}:{state:"APP_CRASHED_AGENT_IDLE",crashedRunId:y}}if((null==c?void 0:c.step)!==r.WorkflowStateStep.RUNNING)if(s||l)return{state:"APP_NOT_RUNNING_AGENT_WORKING"};else return{state:"APP_NOT_RUNNING_AGENT_IDLE"};if(c.step===r.WorkflowStateStep.RUNNING&&!a)if(s)return{state:"APP_STARTING_AGENT_WORKING"};else return{state:"APP_STARTING_AGENT_IDLE"};return{state:"READY",presentPort:null==f?void 0:f.websitePort,presentRoute:null==f?void 0:f.websiteRoute}}e.s(["WebviewState",()=>_,"useAgentAwareWebviewState",()=>T,"useAgentAwareWebviewStateInputs",()=>j,"useVisualPreviewState",()=>C,"useVisualPreviewStateInputs",()=>S],134405)},137218,e=>{"use strict";var t=e.i(276385),n=e.i(569910),r=e.i(712516),i=e.i(908197),o=e.i(561132),a=e.i(134405),s=e.i(387710);function l(){return(0,t.jsx)(r.default,{pane:{type:"webview"},icon:(0,t.jsx)(s.default,{size:48}),headerText:"The app is running, but the preview isn't ready",bodyText:null})}function u(e){var r=e.webviewState,s=e.openPane;switch(r.state){case a.WebviewState.WORKSPACE_CONNECTING:case a.WebviewState.SERVICES_LOADING:return(0,t.jsx)(o.AgentAwareWebviewConnectingEmptyState,{});case a.WebviewState.WORKSPACE_RECONNECTING:return(0,t.jsx)(o.AgentAwareWebviewReconnectingEmptyState,{});case a.WebviewState.GALLERY_PREVIEW:return(0,t.jsx)(i.AgentGalleryPreview,{openPane:s});case a.WebviewState.APP_CRASHED_AGENT_WORKING:return(0,t.jsx)(o.AgentAwareWebviewAppCrashedAgentWorkingEmptyState,{});case a.WebviewState.APP_CRASHED_AGENT_IDLE:return(0,t.jsx)(o.AgentAwareWebviewAppCrashedAgentNotWorkingEmptyState,{openPane:s,crashedRunId:r.crashedRunId});case a.WebviewState.APP_NOT_RUNNING_AGENT_WORKING:case a.WebviewState.APP_STARTING_AGENT_WORKING:return(0,t.jsx)(o.AgentAwareWebviewPreviewSoonEmptyStateV2,{});case a.WebviewState.APP_NOT_RUNNING_AGENT_IDLE:return(0,t.jsx)(o.AgentAwareWebviewAppNotRunningEmptyState,{});case a.WebviewState.APP_STARTING_AGENT_IDLE:return(0,t.jsx)(o.AgentAwareWebviewAppStartingEmptyState,{});case a.WebviewState.LAST_RESORT_RUNNING_NO_PORT:return(0,t.jsx)(l,{});case a.WebviewState.NIX_IS_BROKEN:return(0,t.jsx)(o.AgentAwareWebviewNixIsBrokenEmptyState,{openPane:s,nixError:r.nixError});default:(0,n.default)(r)}}e.s(["AgentAwareWebviewNonReadyStates",()=>u])},401135,e=>{"use strict";var t=e.i(389959),n=e.i(909478),r=e.i(529810);function i(e){var i=(0,r.default)().ports,o=(0,n.useOpenedAndForwardedPorts)(i);return(0,t.useMemo)(function(){return 0===o.length||void 0===e},[o.length,e])}e.s(["useShowEmptyState",()=>i])},942314,e=>{"use strict";var t=e.i(276385),n=e.i(389959),r=e.i(761732),i=e.i(529810),o=e.i(712516),a=e.i(729122),s=e.i(779154),l=e.i(140487),u=e.i(960178),c=e.i(625484),d=e.i(940745),f=e.i(115357),p=e.i(88358),h=e.i(497627);function g(e){var n=e.children,r=e.action;return(0,t.jsxs)(c.View,{align:"center",children:[(0,t.jsx)(u.Text,{children:n}),r?(0,t.jsx)(c.View,{row:!0,align:"center",gap:4,children:r}):null]})}function m(e){var o=e.openNetworkingTool,u=(0,a.useRunInfo)().isRunning,c=(0,i.default)().ports,d=(0,r.default)(c.portsState),f=(0,n.useMemo)(function(){return null==d?void 0:d.some(function(e){return e.isOpen})},[d]);return u?f?(0,t.jsx)(g,{action:(0,t.jsxs)(t.Fragment,{children:["Use"," ",(0,t.jsx)(l.Button,{onClick:o,size:"small",text:"Networking",iconLeft:(0,t.jsx)(p.default,{size:12})})," ","tool to configure them."]}),children:"The app is running, but has no external ports configured."}):(0,t.jsx)(g,{children:"The app is running, but there's no webpage to preview right now."}):(0,t.jsx)(g,{action:(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(s.InlineRunButton,{})," to see the results of your app."]}),children:"The app is currently not running."})}function x(e){var n=e.openNetworkingTool,r=e.didConnectOnce,i=e.didDisconnect;return!r||i?(0,t.jsx)(o.default,{pane:{type:"webview"},icon:r?(0,t.jsx)(h.default,{size:48}):(0,t.jsx)(d.default,{size:48}),headerText:r?"The workspace is reconnecting":"The workspace is loading",bodyText:null}):(0,t.jsx)(o.default,{pane:{type:"webview"},icon:(0,t.jsx)(f.default,{size:48}),headerText:"Preview your app here",bodyText:(0,t.jsx)(m,{openNetworkingTool:n})})}e.s(["default",()=>x])},236906,e=>{"use strict";var t=e.i(878420),n=e.i(64386),r=e.i(276385),i=e.i(389959),o=e.i(960933),a=e.i(862927),s=e.i(877212),l=e.i(909478),u=e.i(529810),c=e.i(84104),d=e.i(378042),f=e.i(157648),p=e.i(401135),h=e.i(813453),g=e.i(942314),m=e.i(341727);e.i(282890);var x=e.i(716636),y=e.i(548364),b=e.i(154703),w=e.i(137218),k=e.i(134405),_=e.i(492267),S=e.i(759967),C=e.i(259493),j=e.i(480028),T=e.i(136540),E=e.i(606867),R=e.i(115357),I=e.i(428070),A=o.Type.Union([o.Type.Object({type:o.Type.Literal("local"),port:o.Type.Number(),path:o.Type.Optional(o.Type.String())}),o.Type.Object({type:o.Type.Literal("external"),port:o.Type.Number(),path:o.Type.Optional(o.Type.String())})]),P=o.Type.Object({type:o.Type.Literal("webview"),data:o.Type.Optional(o.Type.Object({previewScreenSize:o.Type.Optional(f.ScreenSizeSchema),ports:o.Type.Optional(A),sessionId:o.Type.Optional(o.Type.String())}))}),D=function(e){return a.Value.Decode(P,e)},O={Content:function(e){var o,a=e.pane.data,c=e.options,f=c.performPaneOperation,p=c.isActive,g=c.paneId,m=(0,i.useRef)(null),x=(0,s.useSupportsAgent)(),b=(0,S.useIsExpertMode)(),w=(0,_.useIsAgentStackRepl)().isAgentStackRepl,k=(0,u.default)().ports,j=(0,l.useOpenedAndForwardedPorts)(k),T=(0,i.useMemo)(function(){var e;return null!=(e=(0,d.getInitialPort)(a,j))?e:80},[a,j]),E=null==a||null==(o=a.ports)?void 0:o.path,R=(0,i.useCallback)(function(e){f({operation:"open",pane:e})},[f]),I=(0,i.useCallback)(function(){return R({type:"deployments"})},[R]),A=null==a?void 0:a.previewScreenSize,P=(0,i.useCallback)(function(e){f({operation:"replace",pane:{type:"webview",data:(0,n._)((0,t._)({},a),{previewScreenSize:e})}})},[a,f]),D=(0,i.useCallback)(function(){var e,t;f({operation:"openPip",data:{type:"webview",port:T,path:null!=(t=null==(e=m.current)?void 0:e.getCurrentPath())?t:"/"}})},[T,f]),O=(0,y.useDeploymentCommands)({openDeploymentsPane:I,includeSharing:!0}).getCommandGroups;return((0,C.useSetPaneBindings)(function(){var e={type:"webview",refresh:function(){var e;null==(e=m.current)||e.refresh()},navigate:function(e,t){var n;null==(n=m.current)||n.navigateTo(e,t)}},r=O();return r.length>0?(0,n._)((0,t._)({},e),{commands:r}):e},[O]),w)?(0,r.jsx)(h.WebviewDisabledForAgentStack,{openPane:R}):!x||b||w?(0,r.jsx)(N,{ref:m,isActive:p,initialPort:T,initialPath:E,openPane:R,handlePipClick:D,previewScreenSize:A,setPreviewScreenSize:P,paneId:g}):(0,r.jsx)(M,{ref:m,isActive:p,initialPort:T,initialPath:E,openPane:R,handlePipClick:D,previewScreenSize:A,setPreviewScreenSize:P,openDeploymentsPane:I,paneId:g})},Icon:function(e){var t=e.size;return(0,r.jsx)(E.IconContext.Provider,{value:{color:j.tokens.foregroundDimmer,size:t},children:(0,r.jsx)(R.default,{})})},getTitle:function(){return"Preview"},description:"Preview your App",category:x.PaneCategory.WorkspaceFeatures,decode:D},N=(0,i.forwardRef)(function(e,t){var n=e.isActive,o=e.initialPort,a=e.initialPath,s=e.openPane,l=e.handlePipClick,c=e.previewScreenSize,f=e.setPreviewScreenSize,h=e.paneId,x=(0,p.useShowEmptyState)(o),y=(0,m.default)(),w=y.didConnectOnce,k=y.didDisconnect,_=(0,u.default)(),S=_.container,C=_.ports,j=(0,i.useCallback)(function(){return s({type:"developer",data:{tab:["networking"]}})},[s]),T=(0,i.useCallback)(function(){return s({type:"deployments"})},[s]);return((0,b.useNativeWebviewVisibilityState)({isVisible:n&&!x}),x)?(0,r.jsx)(g.default,{openNetworkingTool:j,didConnectOnce:w,didDisconnect:k}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(L,{openDeploymentsPane:T,handlePipClick:l}),(0,r.jsx)(d.WebviewBrowser,{ref:t,initialPort:o,initialPath:a,ports:C,container:S,openPane:s,previewScreenSize:c,setPreviewScreenSize:f,paneId:h})]})}),M=(0,i.forwardRef)(function(e,t){var n=e.isActive,i=e.initialPort,o=e.initialPath,a=e.openPane,s=e.handlePipClick,l=e.previewScreenSize,c=e.setPreviewScreenSize,f=e.openDeploymentsPane,p=e.paneId,h=(0,k.useAgentAwareWebviewState)(),g=(0,u.default)(),m=g.container,x=g.ports,y=h.state===k.WebviewState.READY||h.state===k.WebviewState.LAST_RESORT_READY;if((0,b.useNativeWebviewVisibilityState)({isVisible:n&&y}),!y)return(0,r.jsx)(w.AgentAwareWebviewNonReadyStates,{webviewState:h,openPane:a});var _=h.state===k.WebviewState.READY?h.presentPort:h.externalPort,S=h.state===k.WebviewState.READY?h.presentRoute:o;return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(L,{openDeploymentsPane:f,handlePipClick:s}),(0,r.jsx)(d.WebviewBrowser,{ref:t,initialPort:null!=_?_:i,initialPath:null!=S?S:o,ports:x,container:m,openPane:a,previewScreenSize:l,setPreviewScreenSize:c,paneId:p})]})});function L(e){var t=e.openDeploymentsPane,n=e.handlePipClick;return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(c.MobilePaneHeader,{side:"left",children:(0,r.jsx)(y.DeployButton,{openDeploymentsPane:t})}),(0,r.jsx)(c.MobilePaneHeader,{side:"right",children:(0,r.jsx)(T.IconButton,{size:36,alt:"Picture in Picture",onClick:n,children:(0,r.jsx)(I.default,{})})})]})}e.s(["decode",()=>D,"webviewUI",()=>O])},670161,724001,e=>{"use strict";var t,n=e.i(297083),r=e.i(721281),i=e.i(530658),o=e.i(817556),a=e.i(276385),s=e.i(389959);e.i(877212);var l=e.i(970187),u=e.i(608572),c=e.i(243073),d=e.i(529810),f=e.i(939652),p=e.i(965863),h=e.i(409146);e.i(925218);var g=e.i(267103),m=e.i(417120),x=e.i(188507),y=e.i(924908),b=e.i(808547),w=e.i(641555),k=e.i(610357),_=e.i(298900),S=e.i(382671),C=e.i(965153),j=e.i(140487),T=e.i(88619),E=e.i(607278),R=e.i(85742),I=e.i(624782),A=e.i(12034),P=e.i(960178),D=e.i(625484),O=e.i(107413),N=new Map([[x.SessionType.SESSION_TYPE_UNKNOWN,"unknown"],[x.SessionType.CHAT,"chat"],[x.SessionType.INLINE_CHAT,"inline chat"],[x.SessionType.SINGLE_USE_SESSION,"single use session"],[x.SessionType.REPL_CREATION,"repl creation"],[x.SessionType.AGENT_SESSION,"agent"],[x.SessionType.HOSTING_DEBUG_SUMMARY,"hosting debug"],[x.SessionType.REPL_CREATION_V2,"repl creation v2"],[x.SessionType.REPL_CREATION_V3,"repl creation v3"],[x.SessionType.AGENT_REPLAY_SESSION,"agent replay"],[x.SessionType.SAMPLING_SESSION,"sampling"],[x.SessionType.SUB_AGENT,"subagent"]]);function M(e){var t=e.session,n=(0,g.useObservable)(t.data),r="";return(null==n?void 0:n.sessionType)!=null&&(r+="[".concat(N.get(n.sessionType),"] ")),r+=(null==n?void 0:n.title)||t.id,(0,a.jsx)(R.ListBoxItem,{id:t.id,label:r})}function L(e){var t,n,r=e.group,i=e.index,o=(0,g.useObservable)(null!=(t=r.checkpoint)?t:null),s=(0,g.useObservable)(null!=(n=r.endOfRunSummary)?n:null);return(0,a.jsx)(D.View,{children:(0,a.jsx)(C.AccordionItem,{headerContent:(0,a.jsxs)(D.View,{row:!0,gap:8,align:"center",grow:!0,shrink:!0,children:[(0,a.jsx)(I.Pill,{variant:"outline",colorway:"green",text:"PRE-RUN"}),(0,a.jsxs)(P.Text,{variant:"small",color:"dimmer",children:["[",i,"]"]}),(0,a.jsx)(I.Pill,{variant:"filled",text:"minimized"}),(0,a.jsx)(D.View,{grow:!0,shrink:!0,children:(0,a.jsxs)(P.Text,{variant:"small",multiline:!1,children:["ID: ",r.id]})}),(0,a.jsx)(T.CopyIconButton,{size:24,textToCopy:r.id,tooltipSuccessText:"Copied to clipboard"})]}),children:(0,a.jsxs)(D.View,{gap:8,p:8,children:[o?(0,a.jsx)(C.AccordionItem,{headerContent:(0,a.jsxs)(D.View,{row:!0,gap:8,align:"center",grow:!0,shrink:!0,children:[(0,a.jsx)(P.Text,{variant:"small",color:"dimmest",children:"checkpoint"}),(0,a.jsx)(D.View,{grow:!0,shrink:!0,children:(0,a.jsx)(P.Text,{variant:"small",multiline:!1,children:o.title})}),(0,a.jsx)(T.CopyIconButton,{textToCopy:o.id,tooltipSuccessText:"Copied"})]}),children:(0,a.jsx)(D.View,{p:8,children:(0,a.jsx)(h.default,{code:JSON.stringify(o,null,2),language:"json"})})}):null,s?(0,a.jsx)(C.AccordionItem,{headerContent:(0,a.jsxs)(D.View,{row:!0,gap:8,align:"center",grow:!0,shrink:!0,children:[(0,a.jsx)(P.Text,{variant:"small",color:"dimmest",children:"endOfRunSummary"}),(0,a.jsx)(D.View,{grow:!0,shrink:!0}),(0,a.jsx)(T.CopyIconButton,{textToCopy:s.id,tooltipSuccessText:"Copied"})]}),children:(0,a.jsx)(D.View,{p:8,children:(0,a.jsx)(h.default,{code:JSON.stringify(s,null,2),language:"json"})})}):null]})})})}function B(e){var t,n,r,i=e.runGroup,o=e.granularity,s=e.index,l=(0,g.useObservable)(null!=(t=i.checkpoint)?t:null),u=(0,g.useObservable)(null!=(n=i.endOfRunSummary)?n:null),c=(0,g.useObservable)(null!=(r=i.latestTaskList)?r:null);return(0,a.jsx)(D.View,{children:(0,a.jsx)(C.AccordionItem,{headerContent:(0,a.jsxs)(D.View,{row:!0,gap:8,align:"center",grow:!0,shrink:!0,children:[(0,a.jsx)(I.Pill,{variant:"outline",colorway:"blurple",text:"RUN"}),(0,a.jsxs)(P.Text,{variant:"small",color:"dimmer",children:["[",s,"]"]}),(0,a.jsx)(I.Pill,{variant:"filled",text:o}),(0,a.jsx)(D.View,{grow:!0,shrink:!0,children:(0,a.jsxs)(P.Text,{variant:"small",multiline:!1,children:["ID: ",i.id]})}),(0,a.jsx)(T.CopyIconButton,{size:24,textToCopy:i.id,tooltipSuccessText:"Copied to clipboard"})]}),children:(0,a.jsxs)(D.View,{gap:8,p:8,children:[l?(0,a.jsx)(C.AccordionItem,{headerContent:(0,a.jsxs)(D.View,{row:!0,gap:8,align:"center",grow:!0,shrink:!0,children:[(0,a.jsx)(P.Text,{variant:"small",color:"dimmest",children:"checkpoint"}),(0,a.jsx)(D.View,{grow:!0,shrink:!0,children:(0,a.jsx)(P.Text,{variant:"small",multiline:!1,children:l.title})}),(0,a.jsx)(T.CopyIconButton,{textToCopy:l.id,tooltipSuccessText:"Copied"})]}),children:(0,a.jsx)(D.View,{p:8,children:(0,a.jsx)(h.default,{code:JSON.stringify(l,null,2),language:"json"})})}):null,u?(0,a.jsx)(C.AccordionItem,{headerContent:(0,a.jsxs)(D.View,{row:!0,gap:8,align:"center",grow:!0,shrink:!0,children:[(0,a.jsx)(P.Text,{variant:"small",color:"dimmest",children:"endOfRunSummary"}),(0,a.jsx)(D.View,{grow:!0,shrink:!0}),(0,a.jsx)(T.CopyIconButton,{textToCopy:u.id,tooltipSuccessText:"Copied"})]}),children:(0,a.jsx)(D.View,{p:8,children:(0,a.jsx)(h.default,{code:JSON.stringify(u,null,2),language:"json"})})}):null,c?(0,a.jsx)(C.AccordionItem,{headerContent:(0,a.jsxs)(D.View,{row:!0,gap:8,align:"center",grow:!0,shrink:!0,children:[(0,a.jsx)(P.Text,{variant:"small",color:"dimmest",children:"taskListUpdate"}),(0,a.jsx)(D.View,{grow:!0,shrink:!0,children:(0,a.jsxs)(P.Text,{variant:"small",multiline:!1,children:[c.tasks.length," tasks"]})}),(0,a.jsx)(T.CopyIconButton,{textToCopy:c.id,tooltipSuccessText:"Copied"})]}),children:(0,a.jsx)(D.View,{p:8,children:(0,a.jsx)(h.default,{code:JSON.stringify(c,null,2),language:"json"})})}):null,(0,a.jsxs)(D.View,{gap:4,children:[(0,a.jsxs)(P.Text,{variant:"small",color:"dimmer",children:["Items (",i.items.length,"):"]}),(0,a.jsx)(D.View,{gap:4,children:i.items.map(function(e,t){return(0,a.jsx)(F,{item:e,index:t},e.id)})})]})]})})})}function V(e){var t=e.eventItem,n=e.index,r=(0,g.useObservable)(t.observable),i=(0,s.useMemo)(function(){return r?"userMessage"===r.type?"User: ".concat(r.message):"".concat(r.type,"  ").concat(t.id):"loading..."},[r,t.id]);return(0,a.jsx)(D.View,{children:(0,a.jsx)(C.AccordionItem,{headerContent:(0,a.jsxs)(D.View,{row:!0,gap:8,align:"center",grow:!0,shrink:!0,children:[(0,a.jsx)(I.Pill,{variant:"outline",colorway:"orange",text:"EVENT"}),(0,a.jsxs)(P.Text,{variant:"small",color:"dimmer",children:["[",n,"]"]}),(0,a.jsx)(D.View,{grow:!0,shrink:!0,children:(0,a.jsx)(P.Text,{variant:"small",multiline:!1,children:i})}),(0,a.jsx)(T.CopyIconButton,{textToCopy:t.id,tooltipSuccessText:"Copied to clipboard"})]}),children:(0,a.jsx)(D.View,{p:8,children:r?(0,a.jsx)(h.default,{code:JSON.stringify(r,null,2),language:"json"}):(0,a.jsx)(P.Text,{color:"dimmer",children:"Loading..."})})})})}function F(e){var t,n=e.item,r=e.index,i=(0,g.useObservable)(n.observable);return(0,a.jsx)(C.AccordionItem,{headerContent:(0,a.jsxs)(D.View,{row:!0,gap:8,align:"center",grow:!0,shrink:!0,children:[(0,a.jsxs)(P.Text,{variant:"small",color:"dimmest",children:["[",r,"]"]}),(0,a.jsx)(D.View,{grow:!0,shrink:!0,children:(0,a.jsxs)(P.Text,{variant:"small",multiline:!1,children:[null!=(t=null==i?void 0:i.type)?t:"loading...","  ",n.id]})}),(0,a.jsx)(T.CopyIconButton,{textToCopy:n.id,tooltipSuccessText:"Copied"})]}),children:(0,a.jsx)(D.View,{p:8,children:i?(0,a.jsx)(h.default,{code:JSON.stringify(i,null,2),language:"json"}):(0,a.jsx)(P.Text,{color:"dimmer",children:"Loading..."})})})}var U=e.i(394212),G=e.i(374106),$=e.i(986194),z=e.i(805763),H=e.i(207237),W=e.i(178815),q=e.i(480028),K=e.i(751273),Y=e.i(292642),Q=e.i(467185),X=e.i(353384);function J(e){var t=e.sessionType,r=(0,y.useChatter)(),l=(0,H.default)(),u=(0,g.useObservable)(r.sessions.agent.current),c=(0,w.useObservableMemo)(function(){return r.sessions.query({types:t?[t]:[]}).list},[r,t],{default:[]}),d=(0,i._)((0,s.useState)(function(){var e,t,n;return null!=(n=null!=(t=null==u?void 0:u.id)?t:null==(e=c[0])?void 0:e.id)?n:null}),2),f=d[0],p=d[1],h=(0,w.useObservableMemo)(function(){return f?r.sessions.get(f):null},[f,r]),m=(0,w.useObservableMemo)(function(){return null==h?void 0:h.transform({direction:"reverse",state:{},transformer:function(e){return e}},1e3)},[h]),x=(0,i._)((0,s.useState)(void 0),2),b=x[0],_=x[1],S=(0,s.useCallback)(function(){return(0,n._)(function(){var e,t,n,r,i,a,s,l,u;return(0,o._)(this,function(o){switch(o.label){case 0:if(!m||!h)return[2];return e=[],[4,h.data.once()];case 1:t=o.sent(),n=!1,r=!1,o.label=2;case 2:o.trys.push([2,8,9,14]),a=(0,U._)(m),o.label=3;case 3:return[4,a.next()];case 4:if(!(n=!(s=o.sent()).done))return[3,7];return[4,s.value[1].once()];case 5:l=o.sent(),e.push(l),o.label=6;case 6:return n=!1,[3,3];case 7:return[3,14];case 8:return u=o.sent(),r=!0,i=u,[3,14];case 9:if(o.trys.push([9,,12,13]),!(n&&null!=a.return))return[3,11];return[4,a.return()];case 10:o.sent(),o.label=11;case 11:return[3,13];case 12:if(r)throw i;return[7];case 13:return[7];case 14:return(0,k.default)(JSON.stringify({session:t,events:e},null,2)),[2]}})})()},[m,h]),C=(0,s.useCallback)(function(){if(f&&l){var e=(0,z.generateAiSessionTraceforgeUrl)(f);(0,k.default)(e)}},[f,l]);return(0,a.jsx)(a.Fragment,{children:(0,a.jsxs)(D.View,{gap:8,py:8,children:[(0,a.jsx)(A.Select,{"aria-label":"Select a session",placeholder:"Select a session",selectedKey:f,onSelectionChange:function(e){"string"==typeof e&&p(e)},children:c.map(function(e){return(0,a.jsx)(et,{session:e},e.id)})}),h?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(Z,{session:h}),(0,a.jsx)(D.View,{children:(0,a.jsx)(E.Input,{placeholder:"Filter events by kind, tool, etc.",value:b,onChange:function(e){return _(e.target.value)}})}),(0,a.jsxs)(D.View,{row:!0,gap:8,children:[(0,a.jsx)(j.Button,{text:"Copy as JSON",onClick:S,iconLeft:(0,a.jsx)(O.default,{})}),(0,a.jsx)(j.Button,{text:"Copy traceforge link",onClick:C,iconLeft:(0,a.jsx)(Y.default,{})})]})]}):null,(0,a.jsx)(D.View,{children:null==m?void 0:m.map(function(e){var t=(0,i._)(e,2),n=t[0],r=t[1];return(0,a.jsx)(en,{event:r,eventKindFilter:b},n)})})]})})}function Z(e){var t=(0,g.useObservable)(e.session.data);return(0,a.jsx)(C.AccordionItem,{headerContent:(0,a.jsx)(P.Text,{children:"Session data"}),children:(0,a.jsx)(h.default,{code:JSON.stringify(t,null,2),language:"json"})})}var ee=new Map([[x.SessionType.SESSION_TYPE_UNKNOWN,"unknown"],[x.SessionType.CHAT,"chat"],[x.SessionType.INLINE_CHAT,"inline chat"],[x.SessionType.SINGLE_USE_SESSION,"single use session"],[x.SessionType.REPL_CREATION,"repl creation"],[x.SessionType.AGENT_SESSION,"agent"],[x.SessionType.HOSTING_DEBUG_SUMMARY,"hosting debug"],[x.SessionType.REPL_CREATION_V2,"repl creation v2"],[x.SessionType.REPL_CREATION_V3,"repl creation v3"],[x.SessionType.AGENT_REPLAY_SESSION,"agent replay"],[x.SessionType.SAMPLING_SESSION,"sampling"],[x.SessionType.SUB_AGENT,"subagent"]]);function et(e){var t=(0,g.useObservable)(e.session.data),n="";return(null==t?void 0:t.sessionType)&&(n+="[".concat(ee.get(t.sessionType),"] ")),n+=(null==t?void 0:t.title)||e.session.id,(0,a.jsx)(R.ListBoxItem,{id:e.session.id,label:n})}function en(e){var t=(0,g.useObservable)(e.event);return t?!function(e,t){if(!t)return!0;var n=t.toLowerCase(),r=!1,i=null==e||null==(a=e.contents)||null==(o=a.contents)?void 0:o.$kind.toLowerCase();if(i&&(r=r||i.includes(n)),(0,G.isEventContentsKind)(e,"agentTimelineEventContents")){var o,a,s,l,u,c=(0,$.unkind)(e.contents.contents),d=null==(s=c.toolName)?void 0:s.toLowerCase(),f=null==(u=c.toolData)||null==(l=u.$kind)?void 0:l.toLowerCase();d&&(r=r||d.includes(n)),f&&(r=r||f.includes(n))}return r}(t,e.eventKindFilter)?null:(0,a.jsx)(D.View,{children:(0,a.jsx)(C.AccordionItem,{headerContent:(0,a.jsxs)(D.View,{row:!0,gap:8,align:"center",grow:!0,shrink:!0,children:[(0,a.jsx)(ei,{sender:t.sender.type}),(0,a.jsx)(er,{event:t}),(0,a.jsxs)(D.View,{row:!0,gap:8,align:"center",justify:"space-between",grow:!0,shrink:!0,children:[(0,a.jsx)(P.Text,{children:function(e){var t=null==(r=e.contents)||null==(n=r.contents)?void 0:n.$kind;if(!t)return"Unknown event";if("agentTimelineEventContents"===t){var n,r,i,o=(0,$.unkind)(e.contents.contents),a=o.toolName;return a?a:null==(i=o.toolData)?void 0:i.$kind}return t.replace("Contents","").replace("Event","")}(t)}),(0,a.jsxs)(D.View,{row:!0,gap:4,align:"center",shrink:!0,children:[(0,a.jsx)(D.View,{shrink:!0,children:(0,a.jsx)(P.Text,{variant:"small",color:"dimmer",multiline:!1,children:t.id})}),(0,a.jsx)(T.CopyIconButton,{size:24,textToCopy:t.id,tooltipSuccessText:"Copied to clipboard"})]})]})]}),children:(0,a.jsx)(h.default,{code:JSON.stringify(t,null,2),language:"json"})})}):(0,a.jsx)(D.View,{children:"No data found for event"})}function er(e){var t=e.event;if((0,G.isEventContentsKind)(t,"agentTimelineEventContents")){var n,r=null==(n=(0,$.unkind)(t.contents.contents).toolData)?void 0:n.$kind;return(0,a.jsx)(W.ToolDataIcon,{color:q.tokens.foregroundDimmer,kind:r})}return null}function ei(e){return(0,a.jsx)(K.Tooltip,{tooltip:e.sender===x.UserType.AI?"Sent by AI":"Sent by user",children:(0,a.jsx)(I.Pill,{variant:"filled",colorway:e.sender===x.UserType.AI?"blurple":"green",text:e.sender===x.UserType.AI?(0,a.jsx)(Q.default,{color:q.tokens.blurpleStrongest}):(0,a.jsx)(X.default,{color:q.tokens.greenStrongest})})})}var eo=e.i(446530),ea=e.i(613355),es=e.i(545969),el={"Session Events":J,"Agent State":function(){var e=(0,m.useAgentState)().agentState,t=(0,g.useObservable)(e);return(0,a.jsx)(h.default,{code:JSON.stringify(t,null,2),language:"json"})},"Assistant Events":function(){return(0,a.jsx)(J,{sessionType:x.SessionType.CHAT})},"File Context":function(){var e=(0,u.useFileContextPreferences)(),t=(0,p.useGetRecentFiles)(),r=(0,(0,l.useAssistantChatMode)().getAssistantMessageModel)({isAuthorized:!0}),h=(0,d.default)(),g=h.fs,m=h.dotReplit,x=(0,f.useGetFileContext)(g,m),y=(0,i._)((0,s.useState)(null),2),b=y[0],w=y[1];return(0,s.useEffect)(function(){var i=!1;return(0,n._)(function(){var n;return(0,o._)(this,function(o){switch(o.label){case 0:return[4,x({modelType:r,filePreferences:e,recentFiles:t()})];case 1:if(n=o.sent(),i)return[2];return w(n),[2]}})})(),function(){i=!0}},[t,e,r,x]),(0,a.jsx)(c.default,{json:b})},"Feed Groups":function(){var e=(0,y.useChatter)(),t=(0,g.useObservable)(e.sessions.agent.current),r=(0,w.useObservableMemo)(function(){return e.sessions.query({types:[x.SessionType.AGENT_SESSION]}).list},[e],{default:[]}),l=(0,i._)((0,s.useState)(function(){var e,n,i;return null!=(i=null!=(n=null==t?void 0:t.id)?n:null==(e=r[0])?void 0:e.id)?i:null}),2),u=l[0],c=l[1],d=(0,i._)((0,s.useState)(""),2),f=d[0],p=d[1],h=(0,w.useObservableMemo)(function(){return u?e.sessions.get(u):null},[u,e]),m=(0,b.useGetRunGroupGranularity)(),C=(0,s.useMemo)(function(){return(0,S.getTasksViewTransformer)()},[]),T=(0,s.useMemo)(function(){return h?h.transform(C,200):null},[h,C]),R=(0,w.useObservableMemo)(function(){return T?T.map(_.mapToFeed2):null},[T],{default:null}),N=(0,s.useCallback)(function(){return(0,n._)(function(){var e,t,r,i,a,s,l,u,c,d,f,p,g,x,y,w,_,S,C,j,T,E,I;return(0,o._)(this,function(A){switch(A.label){case 0:if(!R||!h)return[2];e={result:[],lastUserMessageIndex:R.lastUserMessageIndex},t=!0,r=!1,i=void 0,A.label=1;case 1:A.trys.push([1,19,20,21]),a=R.result[Symbol.iterator](),A.label=2;case 2:if(t=(s=a.next()).done)return[3,18];if("runGroup"!==(l=s.value).type)return[3,10];if(d=null!=(c=(u=l).triggerEventId)?c:u.id,f=u.supportsViewGranularity?m(d):b.RunGranularity.Log,p={type:"runGroup",id:u.id,granularity:f,triggerEventId:u.triggerEventId,itemsCount:u.items.length,items:[]},!u.checkpoint)return[3,4];return[4,u.checkpoint.once()];case 3:g=A.sent(),p.checkpoint={id:g.id,type:g.type,title:g.title},A.label=4;case 4:if(!u.endOfRunSummary)return[3,6];return[4,u.endOfRunSummary.once()];case 5:x=A.sent(),p.endOfRunSummary={id:x.id,type:x.type},A.label=6;case 6:if(!u.latestTaskList)return[3,8];return[4,u.latestTaskList.once()];case 7:y=A.sent(),p.latestTaskList={id:y.id,type:y.type,tasksCount:y.tasks.length},A.label=8;case 8:return[4,Promise.all(u.items.map(function(e){return(0,n._)(function(){var t;return(0,o._)(this,function(n){switch(n.label){case 0:return[4,e.observable.once()];case 1:return t=n.sent(),[2,{id:e.id,type:t.type}]}})})()}))];case 9:return p.items=A.sent(),e.result.push(p),[3,17];case 10:if("preRunGroup"!==l.type)return[3,15];if(_={type:"preRunGroup",id:(w=l).id,triggerEventId:w.triggerEventId},!w.checkpoint)return[3,12];return[4,w.checkpoint.once()];case 11:S=A.sent(),_.checkpoint={id:S.id,type:S.type,title:S.title},A.label=12;case 12:if(!w.endOfRunSummary)return[3,14];return[4,w.endOfRunSummary.once()];case 13:C=A.sent(),_.endOfRunSummary={id:C.id,type:C.type},A.label=14;case 14:return e.result.push(_),[3,17];case 15:if("event"!==l.type)return[3,17];return[4,(j=l).observable.once()];case 16:T=A.sent(),E={type:"event",id:j.id,eventType:T.type},e.result.push(E),A.label=17;case 17:return t=!0,[3,2];case 18:return[3,21];case 19:return I=A.sent(),r=!0,i=I,[3,21];case 20:try{t||null==a.return||a.return()}finally{if(r)throw i}return[7];case 21:return(0,k.default)(JSON.stringify(e,null,2)),[2]}})})()},[R,h,m]),F=(0,s.useMemo)(function(){if(!R||!f){var e;return null!=(e=null==R?void 0:R.result)?e:[]}var t=f.toLowerCase();return R.result.filter(function(e){if("runGroup"===e.type){var n,r,i=null!=(r=e.triggerEventId)?r:e.id,o=e.supportsViewGranularity?m(i):b.RunGranularity.Log;return e.id.toLowerCase().includes(t)||(null==(n=e.triggerEventId)?void 0:n.toLowerCase().includes(t))||o.includes(t)}return"preRunGroup"===e.type?e.id.toLowerCase().includes(t)||e.triggerEventId.toLowerCase().includes(t):e.id.toLowerCase().includes(t)})},[R,f,m]),U=(0,s.useMemo)(function(){if(!R)return null;var e=0,t=0,n=0,r=!0,i=!1,o=void 0;try{for(var a,s=R.result[Symbol.iterator]();!(r=(a=s.next()).done);r=!0){var l=a.value;"runGroup"===l.type?e++:"preRunGroup"===l.type?t++:n++}}catch(e){i=!0,o=e}finally{try{r||null==s.return||s.return()}finally{if(i)throw o}}return{total:R.result.length,runGroupCount:e,introGroupCount:t,eventCount:n,lastUserMessageIndex:R.lastUserMessageIndex}},[R]);return(0,a.jsxs)(D.View,{gap:8,py:8,children:[(0,a.jsx)(A.Select,{"aria-label":"Select a session",placeholder:"Select a session",selectedKey:u,onSelectionChange:function(e){"string"==typeof e&&c(e)},children:r.map(function(e){return(0,a.jsx)(M,{session:e},e.id)})}),h?(0,a.jsxs)(a.Fragment,{children:[U?(0,a.jsxs)(D.View,{row:!0,gap:8,align:"center",children:[(0,a.jsx)(I.Pill,{variant:"filled",text:"Total: ".concat(U.total)}),(0,a.jsx)(I.Pill,{variant:"filled",colorway:"blurple",text:"Run groups: ".concat(U.runGroupCount)}),(0,a.jsx)(I.Pill,{variant:"filled",colorway:"green",text:"Intro groups: ".concat(U.introGroupCount)}),(0,a.jsx)(I.Pill,{variant:"filled",colorway:"orange",text:"Events: ".concat(U.eventCount)}),(0,a.jsxs)(P.Text,{variant:"small",color:"dimmer",children:["Last user message index: ",U.lastUserMessageIndex]})]}):null,(0,a.jsxs)(D.View,{row:!0,gap:8,children:[(0,a.jsx)(D.View,{grow:!0,children:(0,a.jsx)(E.Input,{placeholder:"Filter by ID, event type, granularity...",value:f,onChange:function(e){return p(e.target.value)}})}),(0,a.jsx)(j.Button,{text:"Copy as JSON",onClick:N,iconLeft:(0,a.jsx)(O.default,{})})]}),(0,a.jsx)(D.View,{gap:8,children:F.map(function(e,t){if("runGroup"===e.type){var n,r=null!=(n=e.triggerEventId)?n:e.id,i=e.supportsViewGranularity?m(r):b.RunGranularity.Log;return(0,a.jsx)(B,{runGroup:e,granularity:i,index:t},e.id)}return"preRunGroup"===e.type?(0,a.jsx)(L,{group:e,index:t},e.id):"event"===e.type?(0,a.jsx)(V,{eventItem:e,index:t},e.id):null})})]}):(0,a.jsx)(P.Text,{color:"dimmer",children:"No session selected"})]})}},eu=(0,eo.cssRecord)({wrapper:[(t={},(0,r._)(t,"& > div",[ea.rcss.flex.growAndShrink(1),ea.rcss.overflowY("auto"),ea.rcss.colWithGap(4)]),(0,r._)(t,"& > div > div:first-of-type",[ea.rcss.flex.shrink(1),ea.rcss.overflowY("auto")]),(0,r._)(t,"& > div > div:last-of-type",[ea.rcss.flex.growAndShrink(1),ea.rcss.overflowY("auto")]),t)]});function ec(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).isHidden;return e?null:(0,a.jsx)(D.View,{css:eu.wrapper,grow:!0,shrink:!0,children:(0,a.jsxs)(es.Tabs,{children:[(0,a.jsx)(es.TabList,{"aria-label":"Tabs",children:Object.keys(el).map(function(e){return(0,a.jsx)(es.Tab,{id:e,children:e},e)})}),(0,a.jsx)(es.TabPanels,{children:Object.entries(el).map(function(e){var t=(0,i._)(e,2),n=t[0],r=t[1];return(0,a.jsx)(es.TabPanel,{id:n,children:(0,a.jsx)(r,{})},n)})})]})})}e.s(["AiChatDebug",()=>ec],670161);var ed=e.i(102225),ef=e.i(112767);function ep(){var e=(0,ed.useIsCommandBarMatchScoreVisible)(),t=(0,ed.useToggleIsCommandBarMatchScoreVisible)();return(0,a.jsx)(D.View,{py:8,px:12,gap:12,children:(0,a.jsx)(ef.Switch,{isSelected:e,onChange:t,children:"Show match scores in Command Bar"})})}e.s(["CommandBarDebug",()=>ep],724001)},577811,e=>{"use strict";var t,n,r=((t={}).NOT_READY="NOT_READY",t.READY="READY",t.STALLED="STALLED",t.BROKEN="BROKEN",t),i=((n={}).OFFLINE="OFFLINE",n.INITIALIZING="INITIALIZING",n.INITIALIZED="INITIALIZED",n.EXITING="EXITING",n.EXITED="EXITED",n);e.s(["ServerHealth",()=>r,"ServerState",()=>i])},306911,e=>{"use strict";var t=e.i(878420),n=e.i(64386),r=e.i(88125),i=e.i(522682),o=e.i(664152),a=e.i(577811);function s(e){return Math.floor(performance.now()-e.startTime)}var l=new WeakSet;function u(e){var u=e.client,c=e.replId,d=e.language,f=e.debug;if(!l.has(u)){l.add(u);var p=new Map,h=function(e){var t,n=u.getServerState(),r=null!=(t=u.getServerInfo())?t:{name:"unknown",version:"none"},i=n===a.ServerState.INITIALIZED?"".concat(null==r?void 0:r.name,"@").concat(null==r?void 0:r.version):"not_ready: server is ".concat(n);return{method:e.method,replid:c,language:d,startTime:Math.floor(e.startTime),languageServerInfo:i,lspId:u.clientId}},g=(0,r.default)(function(e,t){var n=s(t);n>1e4&&o.logger.time("LSP unresponsive request",n,h(t))}),m=setInterval(function(){p.forEach(function(e){g(e.id,e)})},2e3);return(0,i.combineDisposables)([u.onRequest(function(e){var t=e.id,n=e.data;(f||.01>Math.random())&&p.set(t,{id:t,method:n.method,startTime:performance.now()})}),u.onResponse(function(e){var r=e.id,i=e.error,a=p.get(r);null!=a&&(p.delete(r),o.logger.time("LSP request",s(a),(0,n._)((0,t._)({},h(a)),{result:null==i?"ok":"error"})))}),u.onCancelRequest(function(e){var r=p.get(e);null!=r&&(p.delete(e),o.logger.time("LSP request",s(r),(0,n._)((0,t._)({},h(r)),{result:"cancelled"})))}),function(){return clearInterval(m)},function(){return l.delete(u)}])}}e.s(["trackPerformance",()=>u])},485237,e=>{"use strict";var t=e.i(530658),n=e.i(389959),r=e.i(522682),i=e.i(207237),o=e.i(306911),a=e.i(529810),s=e.i(725182);function l(e){var l=(0,i.default)(),u=(0,a.default)().lspnix,c=(0,t._)((0,n.useState)([]),2),d=c[0],f=c[1],p=(0,s.useShowAdmin)();return(0,n.useEffect)(function(){if(e){var t=u.onClient(e,f);return function(){t(),f([])}}},[u,e]),(0,n.useEffect)(function(){return(0,r.combineDisposables)(d.map(function(t){return(0,o.trackPerformance)({client:t,replId:l,language:t.getLanguageId(e),debug:p})}))},[d,l,e,p]),d}e.s(["default",()=>l])},791247,592063,904002,e=>{"use strict";var t,n=e.i(904851),r=e.i(90659),i=e.i(721281),o=e.i(878420),a=e.i(64386),s=e.i(530658),l=e.i(276385),u=e.i(389959),c=e.i(826771),d=e.i(761732),f=e.i(346715),p=e.i(243073),h=e.i(522682),g=e.i(485237);function m(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=(0,s._)((0,u.useState)(e),2),n=t[0],r=t[1];return[n,(0,u.useCallback)(function(){return r(function(e){return!e})},[])]}e.s(["default",()=>m],592063);var x=e.i(967629),y=e.i(613355),b=e.i(751273),w=e.i(703505),k=(0,x.css)([y.rcss.focusRing,y.rcss.display.flex,y.rcss.center,y.rcss.borderRadius(4),y.rcss.backgroundColor.backgroundRoot,y.rcss.color.foregroundDefault,y.rcss.cursor.pointer,y.rcss.p(4),(t={transition:"background-color 0.2s",border:"none"},(0,i._)(t,y.selectors.hover,[y.rcss.backgroundColor.backgroundHigher]),(0,i._)(t,":focus",{outline:"none"}),t)]),_=function(e){var t=e.onClick;return(0,l.jsx)(b.Tooltip,{tooltip:"Clear",placement:"bottom-start",children:(0,l.jsx)("button",{"aria-label":"Clear",onClick:t,css:k,children:(0,l.jsx)(w.default,{size:16})})})};e.i(545082);var S=e.i(91442),C=e.i(480028),j=e.i(428596),T=e.i(721321),E=e.i(127227),R=e.i(136540),I=e.i(607278),A=e.i(112767),P=e.i(960178),D=e.i(625484),O=e.i(598160),N=e.i(616278),M=e.i(283110),L=e.i(744895),B=e.i(841691),V=e.i(709263),F=e.i(923409),U=e.i(363201),G=e.i(940745),$=function(e){var t,n,r,c,d,p,x=e.isHidden,b=(n=(t=(0,s._)((0,u.useState)(null),2))[0],r=t[1],c=(0,S.useCursorFilepath)(),(0,u.useEffect)(function(){c===n||null!=c&&r(c)},[c,n]),n),w=(0,g.default)(b||""),k=(0,s._)((0,u.useState)(null==(d=w[0])?void 0:d.clientId),2),C=k[0],O=k[1];C&&!w.find(function(e){return C===e.clientId})&&O(null==(p=w[0])?void 0:p.clientId),!C&&w.length&&O(w[0].clientId);var N=(0,j.useIdSeed)(),M=(0,s._)(m(!0),2),L=M[0],F=M[1],U=(0,s._)((0,u.useState)(""),2),G=U[0],$=U[1],H=(0,s._)((0,u.useState)(function(){return{}}),2),q=H[0],K=H[1],Y=(0,s._)(m(!0),2),Q=Y[0],X=Y[1],J=(0,s._)(m(!0),2),Z=J[0],ee=J[1],et=(0,u.useCallback)(function(e,t){K(function(n){var r;return(0,a._)((0,o._)({},n),(0,i._)({},e,[t].concat((0,f._)(null!=(r=n[e])?r:[])).slice(0,100)))})},[]),en=(0,u.useCallback)(function(e,t,n){K(function(r){if(r[e]){for(var i=0;i<r[e].length;i++)if(r[e][i].id===t){r[e][i]=n(r[e][i]);break}r[e]=r[e].slice(0,100)}return(0,o._)({},r)})},[]),er=(0,u.useCallback)(function(){C&&K(function(e){return(0,a._)((0,o._)({},e),(0,i._)({},C,[]))})},[C]),ei=(0,u.useMemo)(function(){return w.find(function(e){return e.clientId===C})},[w,C]),eo=null==ei?void 0:ei.isOpen(b||""),ea=(0,u.useCallback)(function(){var e=null==ei?void 0:ei.clientId;e&&et(e,{canceled:!1,notification:{method:"probe",params:{filePath:b,state:null==ei?void 0:ei.getServerState(),capabilities:null==ei?void 0:ei.getServerCapabilities(),diagnostics:eo?null==ei?void 0:ei.getDiagnostics(b||""):[],isOpen:eo,isSupportedFile:null==ei?void 0:ei.isSupportedFile(b||"")}},requestTime:new Date,type:"probe"})},[et,b,ei,eo]),es=(0,u.useMemo)(function(){if(!C)return[];var e,t,n=G.split(",").map(function(e){return e.trim()}).filter(Boolean);if(!n.length)return null!=(e=q[C])?e:[];var r=null!=(t=q[C])?t:[];return Q||(r=r.filter(function(e){return null==e.notification})),Z||(r=r.filter(function(e){return null==e.request})),G&&(r=r.filter(function(e){return n.some(function(t){var n;return null==(n=e.request||e.notification)?void 0:n.method.toLowerCase().includes(t.toLowerCase())})})),r},[G,q,C,Q,Z]);return((0,u.useEffect)(function(){return(0,h.combineDisposables)(w.flatMap(function(e){return[e.onRequest(function(t){L&&et(e.clientId,{id:t.id,canceled:!1,request:t.data,requestTime:new Date})}),e.onResponse(function(t){L&&en(e.clientId,t.id,function(e){return(0,o._)((0,a._)((0,o._)({},e),{responseTime:new Date}),void 0!==t.result?{response:t.result}:{error:t.error})})}),e.onCancelRequest(function(t){L&&en(e.clientId,t,function(e){return(0,a._)((0,o._)({},e),{canceled:!0})})}),e.onDiagnostics(function(t){var n=t.path,r=t.diagnostics;L&&et(e.clientId,{canceled:!1,notification:{method:"textDocument/publishDiagnostics for "+n,params:r},requestTime:new Date,type:"diagnostics"})}),e.onServerStateChange(function(t){L&&et(e.clientId,{canceled:!1,notification:{method:"state",params:{serverState:t}},requestTime:new Date,type:"state"})}),e.onServerCapabilitiesChange(function(t){L&&et(e.clientId,{canceled:!1,notification:{method:"capabilities",params:{serverCapabilities:t}},requestTime:new Date,type:"capabilities"})}),e.onSendNotification(function(t){L&&et(e.clientId,{canceled:!1,notification:t,requestTime:new Date})}),e.onReceiveNotification(function(t){L&&et(e.clientId,{canceled:!1,notification:t,requestTime:new Date})})]}))},[et,en,L,w]),x)?null:(0,l.jsxs)(D.View,{css:[y.rcss.flex.column],children:[(0,l.jsxs)(D.View,{css:[y.rcss.m(4),y.rcss.position.sticky,y.rcss.top(0),y.rcss.backgroundColor.backgroundDefault,y.rcss.zIndex(1)],row:!0,align:"center",children:[(0,l.jsx)(P.Text,{multiline:!1,children:C?(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(W,{})," logs for ",(0,l.jsx)("code",{children:b})]}):"No LSP client available"}),(0,l.jsx)(R.IconButton,{alt:"Probe LSP",onClick:ea,children:(0,l.jsx)(B.default,{})}),(0,l.jsx)(D.View,{grow:!0}),(0,l.jsx)(A.Switch,{"aria-label":"Enable LSP Logs",isSelected:L,onChange:F})]}),(0,l.jsx)(D.View,{children:(0,l.jsx)(T.ButtonGroup,{name:"Visible LSP Client",value:C,onChange:O,row:!0,children:w.map(function(e){return(0,l.jsx)(T.ButtonGroupItem,{id:e.clientId,text:e.clientName,value:e.clientId},e.clientId)})})}),(0,l.jsxs)(D.View,{row:!0,gap:8,css:[y.rcss.m(4),y.rcss.mb(8)],children:[(0,l.jsxs)(D.View,{row:!0,gap:4,children:[(0,l.jsx)(V.default,{}),(0,l.jsx)(P.Text,{multiline:!1,children:"Show"})]}),(0,l.jsxs)(D.View,{row:!0,gap:4,children:[(0,l.jsx)(E.Checkbox,{name:"showNotifications",id:N("showNotifications"),checked:Q,onChange:X}),(0,l.jsx)("label",{htmlFor:N("showNotifications"),children:" Notifications"})]}),(0,l.jsxs)(D.View,{row:!0,gap:4,children:[(0,l.jsx)(E.Checkbox,{name:"showRequests",id:N("showRequests"),checked:Z,onChange:ee}),(0,l.jsx)("label",{htmlFor:N("showRequests"),children:" Requests"})]}),(0,l.jsx)(D.View,{grow:!0,shrink:!0}),(0,l.jsx)(D.View,{row:!0,gap:4,children:(0,l.jsx)(_,{onClick:er})})]}),(0,l.jsx)(D.View,{row:!0,gap:4,children:(0,l.jsx)(I.Input,{id:N("filterLsp"),placeholder:"Filter by method (Separate by ,)",onChange:function(e){return $(e.target.value)},value:G})}),(0,l.jsxs)(D.View,{css:[y.rcss.flex.column,y.rcss.overflow("auto")],grow:!0,children:[es.map(function(e,t){var n;return(0,l.jsx)(z,{log:e},null!=(n=e.id)?n:e.requestTime.valueOf()+""+t)}),!es.length&&(0,l.jsx)(D.View,{css:y.rcss.m(4),children:" No logs yet..."})]})]})},z=(0,u.memo)(function(e){var t,n,r,i,o,a,u=e.log,c=u.requestTime,d=u.responseTime,f=u.request,p=u.response,h=u.notification,g=u.id,x=(0,s._)(m(!0),2),b=x[0],w=x[1];return(0,l.jsxs)(D.View,{css:[y.rcss.my(4),y.rcss.mx(4)],children:[(0,l.jsxs)(D.View,{role:"button",onClick:w,onKeyDown:w,tabIndex:0,css:[{"&:hover":{cursor:"pointer",".lspLog-requestMethod":{textDecoration:"underline"}}}],row:!0,gap:4,children:[(0,l.jsxs)(D.View,{grow:!0,row:!0,gap:2,children:[(0,l.jsx)(P.Text,{className:"lspLog-emoji",multiline:!1,children:(n=(t=u).type,r=t.canceled,i=t.response,o=t.notification,"state"===n?(0,l.jsx)(L.default,{}):"diagnostics"===n?(0,l.jsx)(O.default,{}):"capabilities"===n?(0,l.jsx)(F.default,{}):"probe"===n?(0,l.jsx)(B.default,{}):r?(0,l.jsx)(M.default,{}):o?(0,l.jsx)(U.default,{}):void 0!==i?(0,l.jsx)(N.default,{}):(0,l.jsx)(G.default,{}))}),(0,l.jsxs)(P.Text,{className:"lspLog-requestMethod",multiline:!1,children:[(0,l.jsx)("code",{children:null==(a=f||h)?void 0:a.method}),null!=g&&(0,l.jsxs)("code",{className:"lspLog-logId",css:{opacity:.5},children:["#",g]})]})]}),(0,l.jsx)(D.View,{css:{opacity:.5},children:null!=d&&(0,l.jsxs)(P.Text,{css:y.rcss.fontSize(13),multiline:!1,children:[d.valueOf()-c.valueOf(),"ms"]})})]}),!b&&(0,l.jsxs)(l.Fragment,{children:[void 0!==f&&(0,l.jsx)(H,{name:"request.params",src:f.params}),void 0!==h&&(0,l.jsx)(H,{name:"notification.params",src:h.params}),void 0!==p&&(0,l.jsx)(H,{name:"response",src:p})]})]})}),H=(0,u.memo)(function(e){var t=e.name,n=e.src;return(0,l.jsx)(D.View,{css:{marginTop:5,".node-ellipsis":{letterSpacing:-2},".object-key span":{letterSpacing:0},".object-key-val":{paddingBottom:"0 !important"},'.object-key + span[style*="margin"], .array-key + span[style*="margin"]':{marginLeft:"0 !important"},".variable-row, .pushed-content .object-key-val":{paddingLeft:"10px !important",paddingBottom:"0 !important"}},children:(0,l.jsx)(p.default,{json:(0,i._)({},t,n)})})}),W=function(){return(0,l.jsx)(P.Text,{multiline:!1,css:{display:"inline",fontStyle:"italic",fontWeight:600,textShadow:"".concat(C.tokens.redDimmer," 2px 2px")},children:"LSP"})};e.s(["JsonView",()=>H,"LSPLog",()=>$],904002);var q=e.i(768280),K=new(function(){function e(){var t=this;(0,n._)(this,e),(0,i._)(this,"counter",0),(0,i._)(this,"enabled",!1),(0,i._)(this,"maxEntries",10),(0,i._)(this,"logs",(0,c.observableValue)([])),(0,i._)(this,"clear",function(){t.logs.current=[]})}return(0,r._)(e,[{key:"toggle",value:function(e){this.enabled=e}},{key:"add",value:function(e){var t=this,n=this.counter++;if(!this.enabled)return{id:n};var r={id:n,request:e,requestTime:Date.now()};return this.logs.update(function(e){return[r].concat(e).slice(0,t.maxEntries)}),{id:n}}},{key:"update",value:function(e,t){this.enabled&&this.logs.update(function(n){var r=n.findIndex(function(t){return t.id===e.id});if(-1===r)return n;var i=n.slice();return i[r]=t(i[r]),i})}},{key:"complete",value:function(e,t){this.update(e,function(e){return(0,a._)((0,o._)({},e),{response:t,responseTime:Date.now()})})}},{key:"abort",value:function(e){this.logs.update(function(t){return t.filter(function(t){return t.id!==e.id||null!=t.responseTime})})}}]),e}()),Y=function(e){var t=e.isHidden,n=(0,d.default)(K.logs);return t?null:(0,l.jsxs)(D.View,{css:[y.rcss.flex.column],children:[(0,l.jsxs)(D.View,{css:[y.rcss.m(4),y.rcss.position.sticky,y.rcss.top(0),y.rcss.backgroundColor.backgroundDefault,y.rcss.zIndex(1)],row:!0,align:"center",children:[(0,l.jsx)(P.Text,{css:y.rcss.flex.grow(1),multiline:!1,children:"Requests"}),(0,l.jsx)(_,{onClick:K.clear})]}),(0,l.jsxs)(D.View,{css:[y.rcss.flex.column,y.rcss.overflow("auto")],grow:!0,children:[n.map(function(e){var t;return(0,l.jsx)(Q,{log:e},null!=(t=e.id)?t:e.requestTime.valueOf())}),!n.length&&(0,l.jsx)(D.View,{css:y.rcss.m(4),children:" No logs yet..."})]})]})},Q=(0,u.memo)(function(e){var t,n=e.log,r=n.requestTime,i=n.responseTime,o=n.request,a=n.response,u=(0,s._)(m(!0),2),c=u[0],d=u[1],f=o.prefix.length>20?"...".concat(o.prefix.slice(-20)):o.prefix;return(0,l.jsxs)(D.View,{css:[y.rcss.my(4),y.rcss.mx(4)],children:[(0,l.jsxs)(D.View,{role:"button",onClick:d,onKeyDown:d,tabIndex:0,css:[{"&:hover":{cursor:"pointer",".lspLog-requestMethod":{textDecoration:"underline"}}}],row:!0,gap:4,children:[(0,l.jsxs)(D.View,{grow:!0,row:!0,gap:2,children:[(0,l.jsx)(P.Text,{multiline:!1,children:(t=n.response)?"CompleteCodeResult"===t.__typename?(0,l.jsx)(N.default,{}):(0,l.jsx)(q.default,{}):(0,l.jsx)(G.default,{})}),(0,l.jsx)(P.Text,{multiline:!1,children:(0,l.jsx)("code",{children:f})})]}),(0,l.jsx)(D.View,{css:{opacity:.5},children:null!=i&&(0,l.jsxs)(P.Text,{css:y.rcss.fontSize(13),multiline:!1,children:[i.valueOf()-r.valueOf(),"ms"]})})]}),!c&&(0,l.jsxs)(l.Fragment,{children:[void 0!==o&&(0,l.jsx)(H,{name:"request",src:o}),void 0!==a&&("CompleteCodeResult"===a.__typename?(0,l.jsxs)("details",{children:[(0,l.jsx)("summary",{children:"Response"}),(0,l.jsx)("pre",{css:[y.rcss.overflow("scroll"),y.rcss.borderRadius(4),y.rcss.p(4),{border:"1px solid ".concat(C.tokens.outlineDimmest)}],children:a.code})]}):(0,l.jsx)(H,{name:"response",src:a}))]})]})});e.s(["GhostwriterLogs",()=>Y,"ghostwriterLogs",()=>K],791247)},620228,e=>{"use strict";var t=e.i(878420),n=e.i(569384),r=e.i(973245),i=e.i(304277);function o(){var e=(0,n._)(["\n  query AdminPanelGitView {\n    currentUser {\n      id\n      gitHubInfo {\n        accessToken\n        installations {\n          id\n          type\n          avatarUrl\n          name\n        }\n        userInfo {\n          name\n          email\n          avatarUrl\n        }\n      }\n      bitbucketInfo {\n        accessToken\n        workspacesToProjects {\n          uuid\n          name\n          slug\n          projects {\n            uuid\n            name\n          }\n        }\n      }\n    }\n  }\n"]);return o=function(){return e},e}e.i(566901);var a={},s=(0,r.gql)(o());function l(e){var n=(0,t._)({},a,e);return i.useQuery(s,n)}e.s(["useAdminPanelGitViewQuery",()=>l])},322606,e=>{"use strict";var t=(0,e.i(826771).observableValue)(null);function n(e,n,r){var i,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:Date.now();Array.isArray(e)||(e=[e]);var a=null!=(i=n.output)?i:"",s=n.error,l=r?o:Date.now(),u="".concat(o,"-").concat(Math.random());t.set({input:e,output:a,error:s,start:o,end:l,cached:r,key:u})}e.s(["emitGitDebugEvent",()=>n,"gitServiceDebugObservable",()=>t])},258092,e=>{"use strict";var t=e.i(297083),n=e.i(878420),r=e.i(64386),i=e.i(530658),o=e.i(346715),a=e.i(817556),s=e.i(276385),l=e.i(389959),u=e.i(620228),c=e.i(409146),d=e.i(761732),f=e.i(927158),p=e.i(322606),h=e.i(907371),g=e.i(613355),m=e.i(140487),x=e.i(929872),y=e.i(625484),b=e.i(448600);function w(){var e,n=(0,i._)((0,l.useState)([]),2),r=n[0],c=n[1],h=(0,u.useAdminPanelGitViewQuery)().data,w=(0,d.default)(p.gitServiceDebugObservable),_=(0,l.useRef)(null),S=(0,i._)((0,l.useState)(!1),2),C=S[0],j=S[1],T=(0,i._)((0,l.useState)("unknown"),2),E=T[0],R=T[1],I=(0,i._)((0,l.useState)(null),2),A=I[0],P=I[1],D=(0,f.usePid2Callback)(function(e){return function(n){return(0,t._)(function(){var t;return(0,a._)(this,function(r){switch(r.label){case 0:return R("restoring"),[4,e.git.restore.rpc({before:n})];case 1:return P((t=r.sent()).payload),t.ok?R("ok"):R("failed"),[2]}})})()}});return e="ok"===E?"green":"failed"===E?"red":"grey",(0,l.useEffect)(function(){w&&c(function(e){return e.length&&e[0].key===w.key?e:[w].concat((0,o._)(e)).slice(0,100)})},[w]),(0,s.jsxs)(y.View,{p:8,children:[(0,s.jsxs)(x.Surface,{elevated:!0,css:[g.rcss.borderRadius(8),g.rcss.p(8),g.rcss.mb(8)],children:[(0,s.jsx)("span",{children:"Git Service Connection Info"}),(0,s.jsx)("pre",{children:(null==h?void 0:h.currentUser)?JSON.stringify(h,function(e,t){return"accessToken"===e?"censored":t},2):"No gitHubInfo"})]}),(0,s.jsx)(b.default,{ref:_,label:"last known good timestamp",onChange:function(e){return j(""!==e.currentTarget.value.trim())}}),(0,s.jsx)(m.Button,{text:"Restore git from timestamp",colorway:e,disabled:!C||!D,onClick:function(){return(0,t._)(function(){var e,t;return(0,a._)(this,function(n){return t=(null==(e=_.current)?void 0:e.value)||"",null==D||D(t),[2]})})()}}),A?(0,s.jsx)("code",{children:JSON.stringify(A,null,2)}):null,(0,s.jsx)(y.View,{gap:4,children:r.length?r.map(function(e){return(0,s.jsx)(k,{event:e},e.key)}):"No events yet..."})]})}function k(e){var t=e.event,o=t.input,a=t.output,u=t.error,d=t.start,f=t.end,p=t.cached,m=(0,i._)((0,l.useState)(!0),2),b=m[0],w=m[1],k=(0,l.useCallback)(function(){return w(function(e){return!e})},[]),_="bash"===o[0]&&"-c"===o[1]?o.slice(2).join(" "):o.join(" "),S=a.trimEnd(),C=(0,h.useCreateInteractive)({colorway:u?"negative":"positive"});return(0,s.jsxs)(y.View,{clsx:C.clsx,style:(0,n._)((0,r._)((0,n._)({},p?{opacity:.75}:{}),{borderRadius:8}),C.style),children:[(0,s.jsxs)(y.View,{onClick:k,onKeyDown:function(e){("Enter"===e.key||" "===e.key)&&k()},tabIndex:0,css:[g.rcss.font.code,g.rcss.cursor.pointer],py:4,px:8,row:!0,gap:4,justify:"space-between",children:[(0,s.jsxs)("span",{css:{whiteSpace:"pre-wrap",wordBreak:"break-word"},children:["$ ",_]}),(0,s.jsxs)("span",{css:[g.rcss.color.foregroundDimmer,g.rcss.flex.shrink(0)],children:[u?(0,s.jsx)("span",{css:[g.rcss.mr(16)],children:u}):null,p?(0,s.jsx)("span",{children:"CACHED"}):(0,s.jsxs)("span",{children:[f-d," ms"]})]})]}),b?null:(0,s.jsx)(y.View,{css:[g.rcss.borderRadius(0,0,8,8)],px:2,pb:2,children:(0,s.jsx)(x.Surface,{elevated:!0,css:[g.rcss.borderRadius(8)],p:8,children:(0,s.jsx)(c.default,{code:S})})})]})}e.s(["default",()=>w])},181227,e=>{"use strict";var t=e.i(878420),n=e.i(64386),r=e.i(389959),i=e.i(541793),o=e.i(161322),a=e.i(826771),s=e.i(125674),l=(0,a.observableValue)(function(){return null}),u=(0,a.observableValue)(function(){return null});function c(e){var t=u.current();(0,r.useEffect)(function(){e!==t&&u.set(function(){return e})},[e,t])}var d=(0,i.atom)(null),f=(0,i.atom)(null,function(e,r,i){var o,a,s=e(d),u=s?(0,t._)({},s,i):(0,t._)({},i),c=null==u?void 0:u.changes,f=null==u?void 0:u.filePath;if(!f||!c)throw Error('"filePath", "changes", "users" required when initializing history state');var p=(a=(o=(0,n._)((0,t._)({},u),{changes:c,filePath:f})).changes.length,(0,t._)({users:{},count:a,version:Math.max(0,a-1),playing:!1,comparing:!1},o));l.set(function(){return p});var h=p.changes.length;0===h||((null==s?void 0:s.changes)&&p.changes!==s.changes&&(p.count=h,p.version=Math.min(p.version,h-1),p.playing=!1,p.comparing=!1),p.version===h-1&&(p.playing=!1)),r(d,p)});function p(){return(0,o.useAtomValue)(d,{store:x()})}function h(){return(0,o.useSetAtom)(f,{store:x()})}function g(){return(0,o.useSetAtom)((0,s.default)(function(){return(0,i.atom)(null,function(e,t){t(d,null)})},[]),{store:x()})}var m=(0,r.createContext)(null);function x(){var e=(0,r.useContext)(m);if(!e)throw Error("Expected store in context");return e}e.s(["HistoryPaneContext",()=>m,"historyStateDebug",()=>l,"historyStateDebugView",()=>u,"useClearHistoryState",()=>g,"useHistoryState",()=>p,"useSetHistoryDebugView",()=>c,"useSetHistoryState",()=>h])},789036,696800,302861,407967,924004,198690,63379,e=>{"use strict";var t=e.i(530658),n=e.i(276385),r=e.i(798680),i=e.i(761732),o=e.i(592063),a=e.i(181227),s=e.i(613355),l=e.i(746382),u=e.i(112767),c=e.i(960178),d=e.i(257811),f=e.i(625484);function p(){var e=(0,i.default)(a.historyStateDebug)(),c=(0,i.default)(a.historyStateDebugView)(),p=(0,t._)((0,o.default)(!1),2),g=p[0],m=p[1];if(!e)return null;var x=e.filePath,y=e.changes,b=e.users,w=e.version,k=e.playing,_=e.count,S=y[w];if(!S)return(0,n.jsxs)(f.View,{children:[(0,n.jsxs)("div",{children:["Change at ",w," not found. Here's the state"]}),(0,n.jsx)("pre",{children:JSON.stringify(e,null,2)})]});var C=null==b?void 0:b[S.userId],j=S.timestamp,T=g&&c?function(e,t){try{return(0,r.changeSetToOp)(e,t).op}catch(e){return e}}(S.changes,c.state.doc.sliceString(0)):null;return(0,n.jsxs)(f.View,{gap:16,p:4,children:[(0,n.jsxs)(f.View,{gap:4,children:[(0,n.jsx)(h,{t:"File",children:(0,n.jsx)("pre",{children:x})}),(0,n.jsxs)(h,{t:"Version",children:[w," / ",_-1]}),(0,n.jsx)(h,{t:"Playing",children:(0,n.jsx)(l.InlineCode,{children:k?"true":"false"})}),(0,n.jsx)(h,{t:"Date",children:(0,n.jsx)(d.Timestamp,{date:j})})]}),C?(0,n.jsxs)(f.View,{children:[(0,n.jsx)(h,{t:"Author",children:C.username}),(0,n.jsxs)(f.View,{pl:8,gap:4,children:[(0,n.jsx)(h,{t:"ID",children:C.id}),(0,n.jsx)(h,{t:"Name",children:C.username}),(0,n.jsx)(h,{t:"Image",children:(0,n.jsx)("a",{href:C.image,children:C.image})})]})]}):null,(0,n.jsx)(u.Switch,{isSelected:g,onChange:m,children:"Changes"}),S?null:"No changes",g&&S?(0,n.jsx)(n.Fragment,{children:(0,n.jsxs)(f.View,{children:[(0,n.jsx)(h,{t:"Changeset",children:(0,n.jsx)("pre",{children:JSON.stringify(S,null,2)})}),c?(0,n.jsx)(n.Fragment,{children:(0,n.jsxs)(f.View,{css:[s.rcss.mt(4)],children:[(0,n.jsx)(h,{t:"OT",children:(0,n.jsx)("pre",{children:JSON.stringify(T,null,2)})}),(0,n.jsx)("p",{children:(0,n.jsxs)("small",{children:["Note that the OT value is translated ",(0,n.jsx)("em",{children:"back"})," to an operational transformation from the CodeMirror changeset."]})})]})}):null]})}):null]})}function h(e){var t=e.t,r=e.children;return(0,n.jsxs)("span",{css:{display:"flex",alignItems:"flex-start",columnGap:"0.5rem"},children:[(0,n.jsxs)(c.Text,{css:{minWidth:"8em"},multiline:!1,children:[t,":"," "]}),(0,n.jsx)("span",{children:r})]})}e.s(["default",()=>p],789036);var g=e.i(297083),m=e.i(346715),x=e.i(817556),y=e.i(389959),b=e.i(878420),w=e.i(569384),k=e.i(973245),_=e.i(304277);function S(){var e=(0,w._)(["\n  query AdminPanelInngestEvents($replId: String!) {\n    fetchDeploymentInngestEvents(input: { replId: $replId }) {\n      name\n      timestamp\n    }\n  }\n"]);return S=function(){return e},e}e.i(566901);var C={},j=(0,k.gql)(S()),T=e.i(207237),E=e.i(446530),R=e.i(140487),I=(0,E.cssRecord)({root:{height:"100%",overflow:"auto",padding:16},header:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:16},eventItem:{marginBottom:8,fontFamily:"monospace",fontSize:14},timestamp:{color:"#666",marginRight:16},eventName:{fontWeight:"bold"}}),A=function(){var e,r,i=(0,T.default)(),o=(e={variables:{replId:i}},r=(0,b._)({},C,e),_.useQuery(j,r)),a=o.data,s=o.loading,l=o.error,u=o.refetch,d=(0,y.useRef)(null),p=(0,t._)((0,y.useState)(!1),2),h=p[0],w=p[1],k=(0,y.useCallback)(function(){return(0,g._)(function(){return(0,x._)(this,function(e){switch(e.label){case 0:if(!i)return[2];w(!0),e.label=1;case 1:return e.trys.push([1,,3,4]),[4,u()];case 2:return e.sent(),[3,4];case 3:return w(!1),[7];case 4:return[2]}})})()},[u,i]);if((0,y.useEffect)(function(){return d.current&&clearInterval(d.current),d.current=setInterval(function(){k()},3e5),function(){d.current&&clearInterval(d.current)}},[k]),s&&!a)return(0,n.jsx)("div",{css:I.root,children:(0,n.jsxs)("div",{css:I.header,children:[(0,n.jsx)(c.Text,{children:"Loading Inngest events..."}),(0,n.jsx)(R.Button,{variant:"outlined",size:"small",disabled:!0,text:"Refresh"})]})});if(l&&!a)return(0,n.jsx)("div",{css:I.root,children:(0,n.jsxs)("div",{css:I.header,children:[(0,n.jsxs)(c.Text,{style:{color:"#e74c3c"},children:["Error loading Inngest events: ",l.message]}),(0,n.jsx)(R.Button,{variant:"outlined",size:"small",onClick:k,disabled:h,text:h?"Refreshing...":"Refresh"})]})});var S=(null==a?void 0:a.fetchDeploymentInngestEvents)||[];if(0===S.length)return(0,n.jsx)("div",{css:I.root,children:(0,n.jsxs)("div",{css:I.header,children:[(0,n.jsx)(c.Text,{children:"No Inngest events found for this repl."}),(0,n.jsx)(R.Button,{variant:"outlined",size:"small",onClick:k,disabled:h,text:h?"Refreshing...":"Refresh"})]})});var E=(0,m._)(S).sort(function(e,t){return new Date(t.timestamp).getTime()-new Date(e.timestamp).getTime()});return(0,n.jsxs)("div",{css:I.root,children:[(0,n.jsxs)("div",{css:I.header,children:[(0,n.jsxs)(c.Text,{style:{fontWeight:"bold"},children:["Inngest Events Timeline (",S.length," total)"]}),(0,n.jsx)(R.Button,{variant:"outlined",size:"small",onClick:k,disabled:h,text:h?"Refreshing...":"Refresh"})]}),(0,n.jsx)(f.View,{gap:4,children:E.map(function(e,t){var r=new Date(e.timestamp).toLocaleString();return(0,n.jsxs)("div",{css:I.eventItem,children:[(0,n.jsx)("span",{css:I.timestamp,children:r}),(0,n.jsx)("span",{css:I.eventName,children:e.name})]},"".concat(e.timestamp,"-").concat(e.name,"-").concat(t))})})]})};e.s(["InngestEvents",()=>A],696800);var P=e.i(790486),D=e.i(541793),O=e.i(161322),N=function(e,t){var n=e.dir,r=e.channel,i=e.stringifiedCmd,o=e.cmd;return(!t.direction||n===t.direction)&&(!t.channels.length||!!t.channels.includes(o.channel))&&(!!(!t.regexp||!t.regexp.test||r.name&&t.regexp.test(r.name)||r.service&&t.regexp.test(r.service))||t.regexp.test(i))},M=(0,D.atom)([]),L=(0,D.atom)([]);function B(){return(0,y.useDeferredValue)((0,O.useAtomValue)(L))}var V=(0,D.atom)(null,function(e,t,n){N(n,e($))&&t(L,function(e){return e.concat(n)}),t(M,function(e){return e.concat(n)})});function F(){return(0,O.useSetAtom)(V)}var U=(0,D.atom)(null,function(e,t){t(M,[]),t(L,[])});function G(){return(0,O.useSetAtom)(U)}var $=(0,D.atom)({regexp:null,direction:"",highlightOnly:!1,channels:[]});function z(){return(0,O.useAtomValue)($)}var H=(0,D.atom)(null,function(e,t,n){var r;t($,n),t(L,(r=e(M),(n.regexp||n.direction||n.channels.length)&&!n.highlightOnly?r.filter(function(e){return N(e,n)}):r))});function W(){return(0,O.useSetAtom)(H)}var q=(0,D.atom)(!1);function K(){return(0,O.useAtomValue)(q)}function Y(){return(0,O.useSetAtom)((0,y.useMemo)(function(){return(0,D.atom)(null,function(e,t,n){return t(q,n)})},[]))}function Q(){return(0,O.useSetAtom)((0,y.useMemo)(function(){return(0,D.atom)(null,function(e,t){return t(q,function(e){return!e})})},[]))}e.s(["filterLog",()=>N,"useAddLog",()=>F,"useClearLogs",()=>G,"useFilters",()=>z,"useIsLogging",()=>K,"useLogs",()=>B,"useSetIsLogging",()=>Y,"useToggleIsLogging",()=>Q,"useUpdateFilters",()=>W],302861);var X=e.i(904002),J=e.i(136540),Z=e.i(607278),ee=e.i(734882),et=e.i(757390),en=(0,E.cssRecord)({container:[s.rcss.height("100%"),s.rcss.position.relative],controls:[s.rcss.backgroundColor.backgroundDefault]});function er(e){var r=e.isHidden,i=(0,t._)((0,o.default)(!1),2),a=i[0],s=i[1],l=(0,t._)((0,y.useState)(null),2),u=l[0],c=l[1],d=B(),p=K(),h=Q(),g=z(),m=W(),x=G();return r?null:(0,n.jsxs)(f.View,{css:en.container,gap:8,children:[(0,n.jsxs)(f.View,{css:en.controls,px:4,pb:8,gap:8,children:[(0,n.jsx)(R.Button,{colorway:p?void 0:"positive",onClick:h,text:p?"Stop logging goval":"Start logging goval"}),(0,n.jsxs)(f.View,{row:!0,gap:4,justify:"space-between",children:[(0,n.jsx)(R.Button,{onClick:s,text:a?"Hide filters":"Show filters"}),u?(0,n.jsx)(R.Button,{onClick:function(){return c(null)},text:"Reset Time Ref"}):null,(0,n.jsx)(J.IconButton,{alt:"Download as JSON",onClick:function(){var e="data:text/json;charset=utf-8,"+encodeURIComponent(JSON.stringify(d)),t=document.createElement("a");t.setAttribute("href",e);var n=new Date().toISOString();t.setAttribute("download","logs-".concat(n.slice(0,n.indexOf(".")).replaceAll("-","").replaceAll(":",""),".json")),t.click()},size:32,children:(0,n.jsx)(et.default,{})}),(0,n.jsx)(R.Button,{colorway:"negative",onClick:function(){return x()},text:"Clear logs"})]}),a?(0,n.jsx)(ec,{filters:g,updateFilters:function(e){m((0,b._)({},g,e))}}):null]}),(0,n.jsx)(eu,{logs:d,filters:g,timeRef:u,setTimeRef:c})]})}var ei=(0,E.cssRecord)({in:[s.rcss.color.greenStrongest],out:[s.rcss.color.redStrongest],error:[s.rcss.color.magentaStrongest]}),eo=[s.rcss.flex.row,s.rcss.rowWithGap(4),{"&:hover":{cursor:"pointer",".link":{textDecoration:"underline"}}}],ea=(0,E.cssRecord)({clickable:(0,m._)(eo),clickableHighlighted:(0,m._)(eo).concat([s.rcss.backgroundColor.accentPositiveDimmer]),inner:[s.rcss.maxWidth("100%")],log:[s.rcss.flex.growAndShrink(1),{opacity:.5}],row:[s.rcss.my(4),s.rcss.mx(4)],timestamp:[s.rcss.fontSize(13),{cursor:"pointer"}]});function es(e){var r,i=e.log,a=e.filters,s=e.timeRef,l=e.setTimeRef,u=(0,y.useMemo)(function(){return a.highlightOnly&&N(i,a)},[a,i]),d=null!=(r=i.cmd.channel)?r:0,p=(0,y.useMemo)(function(){var e=(0,b._)({},i.cmd);return delete e.channel,{cleaned:e,formatted:JSON.stringify(e,null,2)}},[i]),h=s?i.timestamp-s:i.timestamp,g=(0,t._)((0,o.default)(!0),2),m=g[0],x=g[1];return(0,n.jsxs)(f.View,{css:ea.row,children:[(0,n.jsx)(f.View,{role:"button",onClick:x,onKeyDown:x,tabIndex:0,css:u?ea.clickableHighlighted:ea.clickable,children:(0,n.jsxs)(f.View,{css:ea.inner,grow:!0,row:!0,gap:4,children:[(0,n.jsx)(c.Text,{className:"icon",multiline:!1,children:"in"===i.dir?(0,n.jsx)(f.View,{css:ei.in,children:""}):"out"===i.dir?(0,n.jsx)(f.View,{css:ei.out,children:""}):(0,n.jsx)(f.View,{css:ei.error,children:""})}),(0,n.jsx)(c.Text,{className:"link",multiline:!1,children:(0,n.jsxs)("code",{children:["#",d," - ",i.channel.service,i.channel.name?"::".concat(i.channel.name):""]})}),(0,n.jsx)(c.Text,{css:ea.log,multiline:!1,children:(0,n.jsx)("code",{style:{overflow:"hidden",textOverflow:"ellipsis"},children:p.formatted})}),null!=h&&(0,n.jsx)(f.View,{style:{opacity:.5},onClick:function(){l(i.timestamp)},children:(0,n.jsx)(c.Text,{css:ea.timestamp,multiline:!1,children:i.timestamp===s?"(reference)":(0,n.jsxs)(n.Fragment,{children:[h.toFixed(0)," ms"]})})})]})}),!m&&(0,n.jsx)(n.Fragment,{children:void 0!==p.cleaned&&(0,n.jsx)(X.JsonView,{name:"cmd",src:p.cleaned})})]})}var el=(0,E.cssRecord)({listContainer:[s.rcss.position.relative,s.rcss.height("100%")],listScroller:[s.rcss.overflow("auto"),s.rcss.coverContainer],listBox:[s.rcss.width("100%"),s.rcss.position.relative],listItem:[s.rcss.position.absolute,s.rcss.top(0),s.rcss.left(0),s.rcss.width("100%")]}),eu=(0,y.memo)(function(e){var t=e.logs,r=e.filters,i=e.timeRef,o=e.setTimeRef,a=(0,y.useRef)(null),s=(0,P.useVirtualizer)({count:t.length,getScrollElement:function(){return a.current},getItemKey:function(e){return t[e].id},estimateSize:function(){return 30},overscan:10});return(0,n.jsx)("div",{css:el.listContainer,children:(0,n.jsxs)("div",{ref:a,css:el.listScroller,children:[(0,n.jsx)("div",{css:el.listBox,style:{height:"".concat(s.getTotalSize(),"px")},children:s.getVirtualItems().map(function(e){var a=e.index,l=e.key,u=e.start,c=t[a];return c?(0,n.jsx)("div",{"data-index":a,ref:s.measureElement,css:el.listItem,style:{transform:"translateY(".concat(u,"px)")},children:(0,n.jsx)(es,{log:c,filters:r,timeRef:i,setTimeRef:o})},l.toString()):null})}),(0,n.jsx)("div",{className:"bottom-anchor"})]})})}),ec=function(e){var r=e.filters,i=e.updateFilters;return(0,n.jsxs)(f.View,{gap:4,children:[(0,n.jsx)(c.Text,{variant:"subheadDefault",multiline:!1,children:"Regex (regex,flags):"}),(0,n.jsx)(Z.Input,{id:"regex",onChange:function(e){var n=null;if(e.currentTarget.value){var r=(0,t._)(e.currentTarget.value.split(","),2),o=r[0],a=r[1];try{n=new RegExp(o,a)}catch(e){}}i({regexp:n})},placeholder:"\\w+,gi"}),(0,n.jsx)(c.Text,{variant:"subheadDefault",multiline:!1,children:"Channel (comma separated ids, clear to reset)"}),(0,n.jsx)(Z.Input,{id:"channels",onChange:function(e){i({channels:e.currentTarget.value.split(",").map(function(e){return e.trim()}).map(Number).filter(function(e){return!isNaN(e)})})},placeholder:"1,2,3"}),(0,n.jsx)(c.Text,{variant:"subheadDefault",multiline:!1,children:"Directions:"}),(0,n.jsx)(ee.RadioGroup,{css:s.rcss.rowWithGap(16),name:"direction",value:r.direction,onChange:function(e){var t=e.target.value;i({direction:"in"===t||"out"===t||""===t?t:""})},children:[{val:"",text:"Both"},{val:"in",text:"In"},{val:"out",text:"Out"}].map(function(e){return(0,n.jsxs)(f.View,{row:!0,gap:8,children:[(0,n.jsx)(ee.Radio,{id:e.val,value:e.val}),(0,n.jsx)("label",{htmlFor:e.val,children:e.text})]},e.val)})}),(0,n.jsx)(c.Text,{variant:"subheadDefault",multiline:!1,children:"Filter style:"}),(0,n.jsx)(ee.RadioGroup,{css:s.rcss.rowWithGap(16),name:"filter-style",value:r.highlightOnly?"highlight":"filter",onChange:function(e){return i({highlightOnly:"highlight"===e.target.value})},children:[{val:"highlight",text:"Highlight"},{val:"filter",text:"Filter"}].map(function(e){return(0,n.jsxs)(f.View,{row:!0,gap:8,children:[(0,n.jsx)(ee.Radio,{id:e.val,value:e.val}),(0,n.jsx)("label",{htmlFor:e.val,children:e.text})]},e.val)})})]})};e.s(["default",()=>er],407967);var ed=e.i(610357),ef=e.i(33699),ep=e.i(937500),eh=e.i(626430);function eg(e){var t=e.split(".");if(4!==t.length)throw Error("Invalid token: should have exactly 4 parts: "+e);for(var n=t[2].replace(/-/g,"+").replace(/_/g,"/");n.length%4;)n+="=";var r=window.atob(n);if(r.length<64)throw Error("Invalid token: signed part is too short: "+r.length);var i=r.substring(0,r.length-64);return eh.api.token.ReplToken.decode(new ep.Buffer(i,"base64"))}ef.default.env.PROXY_SUFFIX,e.s(["parseToken",()=>eg],924004);var em=e.i(873379),ev=e.i(529810),ex=e.i(107413),ey=(0,E.cssRecord)({root:{height:"100%",overflow:"auto",padding:10,pre:{whiteSpace:"pre-wrap",wordWrap:"break-word"}},command:[s.rcss.flex.shrink(1)]}),eb=function(){var e=(0,ev.default)().container;(0,em.default)(e);var t=e.getConnectionMetadata();if(!t)return(0,n.jsx)("div",{children:"no token yet, wait for connection"});var r=t.token,i=new URL(t.conmanURL).host,o='./conman-repl -t "'.concat(r,'" -u ').concat(i);return(0,n.jsxs)("div",{css:ey.root,children:[(0,n.jsxs)(f.View,{row:!0,gap:2,children:[(0,n.jsxs)(c.Text,{css:ey.command,multiline:!1,children:["conman Repl command: ",(0,n.jsx)(l.InlineCode,{children:o})]}),(0,n.jsx)(J.IconButton,{alt:"Copy to clipboard",onClick:function(){return(0,ed.default)(o)},children:(0,n.jsx)(ex.default,{})})]}),(0,n.jsxs)("div",{children:["metadata:",(0,n.jsx)("pre",{children:JSON.stringify(t,null,2)})]}),(0,n.jsx)("br",{}),(0,n.jsx)("br",{}),(0,n.jsxs)("div",{children:["parsed token:",(0,n.jsx)("pre",{children:JSON.stringify(eg(t.token),null,2)})]}),(0,n.jsx)("br",{}),(0,n.jsx)("br",{})]})};e.s(["Metadata",()=>eb],198690);var ew=e.i(775973),ek=e.i(282453),e_=e.i(116680),eS=e.i(480028),eC=e.i(448600),ej=function(){var e=(0,t._)((0,y.useState)(ek.default.get("gurl","string")||""),2),r=e[0],i=e[1],o=(0,ew.useLDClient)(),a=""===r?"null":JSON.stringify((0,e_.gurlToOverrideClusterMetadata)(r),null,2);return(0,n.jsxs)(f.View,{pt:16,px:12,gap:12,children:[(0,n.jsxs)(f.View,{gap:12,children:[(0,n.jsx)(eC.default,{label:"Custom gurl",placeholder:"ws://localhost:".concat(4560),value:r,onChange:function(e){return i(e.currentTarget.value)}}),(0,n.jsxs)("pre",{children:["metadata override preview:",a]}),(0,n.jsxs)(f.View,{row:!0,gap:12,children:[(0,n.jsx)(R.Button,{colorway:"positive",onClick:function(){ek.default.set("gurl",r),window.location.reload()},text:"Set gurl and reload"}),(0,n.jsx)(R.Button,{colorway:"yellow",onClick:function(){ek.default.set("gurl","wss://eval.canary.replit.com"),window.location.reload()},text:"Switch to canary & reload"}),(0,n.jsx)(R.Button,{colorway:"orange",onClick:function(){ek.default.remove("gurl"),window.location.reload()},text:"Unset gurl and reload"}),(0,n.jsx)(R.Button,{colorway:"red",onClick:function(){ek.default.set("gurl","ws://localhost:4560"),window.location.reload()},text:"Switch to localhost & reload"})]}),(0,n.jsx)("div",{children:ek.default.get("gurl","string")?"currently in localStorage: ".concat(ek.default.get("gurl","string")):'No gurl set in local storage, using default gurl for this user, check "Token" tab for details'}),(0,n.jsx)("p",{children:"Gurl order of precedence:"}),(0,n.jsxs)("ol",{style:{margin:12},children:[(0,n.jsx)("li",{children:"gurl in localStorage (set above)"}),(0,n.jsxs)("li",{children:["If in development webapp and a theres a response from",(0,n.jsx)("code",{children:"https://localhost:4563"})," or",(0,n.jsxs)("code",{children:["http://localhost:",4560]}),", then it will use that."]}),(0,n.jsxs)("li",{children:["default is ",(0,n.jsx)("code",{children:"wss://eval.<usercluster>.replit.com"})]})]})]}),(0,n.jsx)("hr",{css:[s.rcss.my(16),{borderColor:eS.tokens.outlineDefault}]}),(0,n.jsx)(R.Button,{onClick:function(){window.ldClient=o,console.log("window.ldClient: ",o)},text:"Assign LD client to window for testing"})]})};e.s(["OverrideGurl",()=>ej],63379)},779827,e=>{e.v({container:"survey-module__YMPlta__container",debugInfoSection:"survey-module__YMPlta__debugInfoSection",deletedText:"survey-module__YMPlta__deletedText",errorText:"survey-module__YMPlta__errorText"})},309968,660081,67870,102570,345863,94063,e=>{"use strict";var t,n,r,i=e.i(276385),o=e.i(960933),a=e.i(862927),s=e.i(721281),l=e.i(530658),u=e.i(389959),c=e.i(670161),d=e.i(724001),f=e.i(791247),p=e.i(258092),h=e.i(789036),g=e.i(696800),m=e.i(407967),x=e.i(904002),y=e.i(198690),b=e.i(63379),w=e.i(297083),k=e.i(817556),_=e.i(41e4),S=e.i(400081),C=e.i(927158),j=e.i(529810),T=e.i(446530),E=e.i(613355),R=e.i(140487),I=e.i(960178),A=e.i(625484),P=(0,T.cssRecord)({uploadMessage:[E.rcss.flex.growAndShrink(1),E.rcss.width("100%"),E.rcss.font.code]}),D=e.i(394212),O=e.i(167626),N=e.i(878420),M=e.i(64386),L=e.i(346715),B=e.i(119468),V=e.i(753950),F=e.i(179302);e.i(508987);var U=e.i(457103),G=e.i(242131),$=e.i(221250),z=e.i(928353),H=e.i(542101),W=e.i(700170);e.i(242933);var q=e.i(790164);e.i(925218);var K=e.i(267103),Y=e.i(299798),Q=e.i(480028);function X(e){var t=(0,l._)((0,u.useState)(null),2),n=t[0],r=t[1],o=(0,K.useObservable)(e.logs),a=null!==n?o[o.length-n-1]:null,s=(0,H.default)(),c=s.ref,d=s.view;(0,u.useEffect)(function(){d&&d.dispatch({changes:{from:0,to:d.state.doc.length,insert:a?a.data:""}})},[a,d]);var f=(0,u.useRef)(n);return(0,u.useEffect)(function(){f.current=n},[n]),(0,u.useEffect)(function(){return e.logs.subscribe(function(e){var t=f.current;(null===t||e.length-2===t)&&r(e.length-1)})},[e.logs]),(0,i.jsxs)(A.View,{css:ea.response,grow:!0,shrink:!0,row:!0,gap:0,children:[(0,i.jsxs)(A.View,{css:ea.responseL,children:[(0,i.jsx)(A.View,{css:ea.logHeader,align:"start",justify:"center",children:a?null==a?void 0:a.name:null}),(0,i.jsx)(A.View,{css:ea.logData,children:(0,i.jsx)($.default,{ref:c,language:"json",readOnly:!0})})]}),(0,i.jsxs)(A.View,{css:ea.responseR,children:[(0,i.jsx)(A.View,{css:ea.logsHeader,children:(0,i.jsx)(R.Button,{size:"small",text:"Clear",disabled:!o.length,onClick:e.onClear})}),(0,i.jsx)(A.View,{css:ea.logsList,children:o.map(function(e,t){var a=o.length-t-1;return(0,i.jsx)("code",{role:"button",tabIndex:0,className:n===a?"selected":void 0,onClick:function(){r(a)},onKeyDown:function(e){"Enter"===e.key&&r(a)},children:e.name},a)})})]})]})}var J=V.StateEffect.define(),Z=V.StateEffect.define(),ee=V.StateEffect.define(),et=F.EditorView.theme({"&":{border:"1px solid ".concat(Q.tokens.outlineDefault),height:"225px"},"& .cm-panels":{backgroundColor:"unset"},"& .cm-panels.cm-panels-bottom":{borderTop:"1px solid ".concat(Q.tokens.outlineDefault)}}),en=new W.ReactCompartment(function(e,t){return[et,V.StateField.define({create:function(){return null},update:function(e,t){var n=!0,r=!1,i=void 0;try{for(var o,a=t.effects[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var s=o.value;s.is(J)&&(e=s.value),s.is(ee)&&(e=null)}}catch(e){r=!0,i=e}finally{try{n||null==a.return||a.return()}finally{if(r)throw i}}return e},provide:function(n){return[F.ViewPlugin.define(function(){var n,r=new AbortController;return{update:function(i){return(0,w._)(function(){var o,a,s,l,u,c,d,f,p,h,g,m,x,y,b,w,_,S,C,j,T,E,R,I,A,P,O,N,M,L,V,F,U,G;return(0,k._)(this,function(k){switch(k.label){case 0:if(!e)return[2];o=void 0,a=!0,s=!1,l=void 0;try{for(u=i.transactions[Symbol.iterator]();!(a=(c=u.next()).done);a=!0){d=c.value,f=!0,p=!1,h=void 0;try{for(g=d.effects[Symbol.iterator]();!(f=(m=g.next()).done);f=!0){var $;(x=m.value).is(J)&&x.value&&(o=x.value),x.is(Z)&&(null==n||n.write(($=x.value,JSON.parse($,function(e,t){return(void 0===t?"undefined":(0,B._)(t))==="object"&&"Uint8Array"===t.type&&void 0!==t.data?new Uint8Array(t.data):t})))),x.is(ee)&&r.abort()}}catch(e){p=!0,h=e}finally{try{f||null==g.return||g.return()}finally{if(p)throw h}}}}catch(e){s=!0,l=e}finally{try{a||null==u.return||u.return()}finally{if(s)throw l}}if(!o)return[2];switch(y=o.service,b=o.procedure,w=o.type,_=e.client[y][b][w],S=void 0,C=1,o.type){case"rpc":return[3,1];case"stream":return[3,3];case"subscribe":return[3,5];case"upload":return[3,7]}return[3,9];case 1:case 5:return[4,_(o.input,{signal:r.signal})];case 2:return j=k.sent(),t({name:"".concat(y,".").concat(b,".").concat(w,".").concat(C),data:er(j)}),i.view.dispatch({effects:ee.of(null)}),[3,9];case 3:return[4,_(null!=(T=o.input)?T:void 0,{signal:r.signal})];case 4:return R=(E=k.sent()).reqWritable,I=E.resReadable,n=R,S=I,[3,9];case 6:return S=k.sent().resReadable,[3,9];case 7:return[4,_(null!=(A=o.input)?A:void 0,{signal:r.signal})];case 8:return O=(P=k.sent()).reqWritable,P.finalize,n=O,[3,9];case 9:if(!S)return[3,22];N=!1,M=!1,k.label=10;case 10:k.trys.push([10,15,16,21]),V=(0,D._)(S),k.label=11;case 11:return[4,V.next()];case 12:if(!(N=!(F=k.sent()).done))return[3,14];U=F.value,t({name:"".concat(y,".").concat(b,".").concat(w,".").concat(C),data:er(U)}),C++,k.label=13;case 13:return N=!1,[3,11];case 14:return[3,21];case 15:return G=k.sent(),M=!0,L=G,[3,21];case 16:if(k.trys.push([16,,19,20]),!(N&&null!=V.return))return[3,18];return[4,V.return()];case 17:k.sent(),k.label=18;case 18:return[3,20];case 19:if(M)throw L;return[7];case 20:return[7];case 21:i.view.dispatch({effects:ee.of(null)}),k.label=22;case 22:return[2]}})})()}}}),F.EditorView.editable.from(n,function(e){return(null==e?void 0:e.type)!=="rpc"&&(null==e?void 0:e.type)!=="subscribe"}),G.GhostText.compute([n,"doc"],function(e){var t,r;return e.doc.length?null:(null==(t=e.field(n))?void 0:t.type)==="stream"||(null==(r=e.field(n))?void 0:r.type)==="upload"?{from:0,insert:"{\n   # ... input data\n}"}:{from:0,insert:'{\n  "service_name": {\n    "procedure_name": {\n      "rpc" | "stream" | "subscribe" | "upload": {\n        # ... init/input data\n      }\n    }\n  }\n}'}}),F.keymap.of([{key:"Tab",run:function(e){var t;return!e.state.doc.length&&(e.dispatch({changes:null!=(t=e.state.facet(G.GhostText)[0])?t:void 0}),!0)}}]),F.showPanel.of(function(t){var r=function(){if(e){var n=eo(t.state.doc.toString());if(n){var r=n.type,i=n.service,o=n.procedure,a=n.input;r&&i&&o&&t.dispatch({effects:J.of({type:r,service:i,procedure:o,input:a}),changes:"stream"===r||"upload"===r?{from:0,to:t.state.doc.length,insert:""}:void 0})}}},i=function(){t.dispatch({effects:Z.of(t.state.doc.toString()),changes:{from:0,to:t.state.doc.length,insert:""}})},o=function(){var r,i=t.state.field(n),o=new Set,a=t.state.doc.toString();return e&&i&&"rpc"!==i.type&&(o.add("Close"),("stream"===i.type||"upload"===i.type)&&a.startsWith("{")&&a.endsWith("}")&&o.add("Send")),e&&!i&&a.length&&(o.add("Clear"),(null==(r=eo(a))?void 0:r.type)&&o.add("Send")),o},a=el.create({enabled:o(),onSend:function(){null==t.state.field(n)?r():i(),t.focus()},onClose:function(){t.dispatch({effects:[ee.of(null),J.of(null)],changes:{from:0,to:t.state.doc.length,insert:""}})},onClear:function(){t.dispatch({changes:{from:0,to:t.state.doc.length,insert:""}}),t.focus()}});return{dom:a,top:!1,update:function(e){if((0,U.hasChanged)(e,n,"doc")){var t=e.state.field(n);el.update(a,function(e){return(0,M._)((0,N._)({},e),{enabled:o(),inProgress:t?"".concat(t.type,": ").concat(t.service,".").concat(t.procedure):void 0})})}}}})]}})]});function er(e){return JSON.stringify(e,function(e,t){return(0,O._)(t,Uint8Array)?Array.from(t):t},2)}var ei=["rpc","stream","subscribe","upload"];function eo(e){try{t=JSON.parse(e)}catch(e){return null}var t,n=0,r=null,i=null,o=null;try{for(;n<3;){var a=Object.keys(t)[0];if(void 0===a)throw Error("expected key");if(0===n&&(r=a),1===n&&(i=a),2===n)if(ei.includes(a))o=a;else throw Error("expected procedure type");t=t[a],n++}return{type:o,service:r,procedure:i,input:t}}catch(e){return{type:o,service:r,procedure:i,input:null}}}var ea=(0,T.cssRecord)({response:[E.rcss.border({width:1,color:Q.tokens.outlineDefault}),{marginTop:"4px"}],logHeader:[E.rcss.height("37px"),E.rcss.display.flex,E.rcss.p(4),E.rcss.border({width:1,color:Q.tokens.outlineDefault,direction:"bottom"})],logData:[E.rcss.display.block,E.rcss.flex.growAndShrink(1),{overflowY:"auto"}],logsHeader:[E.rcss.display.flex,E.rcss.align.end,E.rcss.p(4),E.rcss.border({width:1,color:Q.tokens.outlineDefault,direction:"bottom"})],logsList:[E.rcss.display.block,E.rcss.flex.growAndShrink(1),{overflowY:"auto"}],responseL:[E.rcss.display.flex,E.rcss.flex.growAndShrink(1),{overflowY:"auto"}],responseR:[E.rcss.display.flex,E.rcss.border({width:1,color:Q.tokens.outlineDefault,direction:"left"}),E.rcss.width("40%"),E.rcss.maxWidth("250px"),{overflowY:"auto","& code":{display:"block",cursor:"pointer",padding:"4px",borderBottom:"1px solid ".concat(Q.tokens.outlineDimmer),overflowX:"hidden",textOverflow:"ellipsis"},"& code.selected":{backgroundColor:Q.tokens.accentPrimaryDimmer},"& code:last-of-type":{borderBottom:"unset"}}]}),es=["Send","Close","Clear"],el=new z.CodeMirrorComponent(function(e){return(0,i.jsxs)(A.View,{children:[(0,i.jsx)(A.View,{p:4,pb:0,children:(0,i.jsxs)(I.Text,{variant:"small",color:"dimmer",children:["Status:"," ",e.inProgress?(0,i.jsxs)(i.Fragment,{children:["In progress - ",e.inProgress]}):null]})}),(0,i.jsx)(A.View,{p:4,row:!0,gap:4,children:Object.values(es).map(function(t){return(0,i.jsx)(R.Button,{size:"small",disabled:!e.enabled.has(t),text:t,onClick:function(){switch(t){case"Send":e.onSend();break;case"Close":e.onClose();break;case"Clear":e.onClear()}}},t)})})]})}),eu=e.i(569384),ec=e.i(973245),ed=e.i(304277);function ef(){var e=(0,eu._)(["\n  fragment AdminPanelRepl on Repl {\n    id\n    title\n    description\n    isPrivate\n    timeCreated\n    timeUpdated\n    slug\n    url\n    language\n    user {\n      id\n    }\n    config {\n      isServer\n      isVnc\n      isAgentRepl\n      visualSelectorUpgradeRefused\n    }\n    isRenamed\n    folderId\n    isOwner\n    isReplShieldEnabled\n    origin {\n      id\n    }\n    source {\n      release {\n        id\n        repl {\n          id\n          url\n          templateLabel\n        }\n      }\n    }\n  }\n"]);return ef=function(){return e},e}function ep(){var e=(0,eu._)(["\n  query AdminPanelReplView($replId: String!) {\n    getRepl(id: $replId) {\n      ... on Repl {\n        ...AdminPanelRepl\n      }\n    }\n  }\n  ","\n"]);return ep=function(){return e},e}e.i(566901);var eh={},eg=(0,ec.gql)(ef()),em=(0,ec.gql)(ep(),eg),ev=e.i(243073),ex=e.i(207237),ey=e.i(967629),eb=e.i(210975),ew=(0,ey.css)([E.rcss.colWithGap(16),E.rcss.p(4),{pre:{whiteSpace:"pre-wrap",wordWrap:"break-word"}}]),ek=e.i(561979),e_=e.i(15053),eS=e.i(222342),eC=e.i(664152),ej=e.i(6338),eT=e.i(428596),eE=e.i(127227),eR=e.i(607278);function eI(e){var t=e.sessionId,n=(0,l._)((0,u.useState)(!1),2),r=n[0],o=n[1],a=(0,l._)((0,u.useState)(""),2),s=a[0],c=a[1],d=(0,l._)((0,u.useState)(!1),2),f=d[0],p=d[1],h=(0,eS.default)().showConfirm,g=(0,eT.useIdSeed)();return null==t?(0,i.jsx)(A.View,{children:(0,i.jsx)(I.Text,{multiline:!1,children:"Something went wrong... no RUM session found... Try refreshing the page"})}):(0,i.jsxs)(A.View,{gap:8,children:[(0,i.jsxs)(I.Text,{variant:"small",multiline:!1,children:["RUM Session ID: ",t]}),(0,i.jsx)(I.Text,{variant:"headerDefault",multiline:!1,children:"Submit an Issue"}),(0,i.jsxs)(A.View,{gap:16,children:[(0,i.jsx)(eR.MultiLineInput,{id:g("message"),placeholder:"What can we do better?",value:s,onChange:function(e){return c(e.target.value)},disabled:r}),(0,i.jsxs)(A.View,{row:!0,gap:8,children:[(0,i.jsx)(eE.Checkbox,{id:g("issueInRecording"),checked:f,onChange:function(e){return p(e)}}),(0,i.jsx)("label",{htmlFor:g("issueInRecording"),children:(0,i.jsx)(I.Text,{multiline:!1,children:"Issue is demoed in recording"})})]}),(0,i.jsx)(R.Button,{onClick:function(){var e=(0,e_.v4)();o(!0),(0,eC.datadogRumCustomAction)({name:"replitOnReplit:issue",context:{message:s,issueInRecording:f,customEventId:e}}),h("Issue submitted! Have a cookie ",5e3),setTimeout(function(){o(!1),c(""),p(!1)},5e3)},text:"Submit",disabled:r||0===s.trim().length,colorway:"primary"})]})]})}var eA=e.i(412160),eP=e.i(951262);function eD(){var e=(0,eu._)(["\n  query AdminPanelBuildScoreSurveys($limit: Int) {\n    currentUser {\n      id\n    }\n    buildScoreSurveyResponses(limit: $limit) {\n      id\n      trigger\n      responseScore\n      questionText\n      headerText\n      context\n      timeCreated\n      timeUpdated\n      timeDeleted\n      replId\n    }\n  }\n"]);return eD=function(){return e},e}function eO(){var e=(0,eu._)(["\n  query HasCompletedCurrentTrigger($trigger: BuildScoreSurveyTriggerPoint!) {\n    currentUser {\n      id\n      hasCompletedBuildScoreSurveyForTrigger(trigger: $trigger)\n    }\n  }\n"]);return eO=function(){return e},e}function eN(){var e=(0,eu._)(["\n  mutation DeleteBuildScoreSurveyResponses($surveyResponseId: String!) {\n    deleteBuildScoreSurveyResponses(surveyResponseId: $surveyResponseId) {\n      __typename\n      ... on CurrentUser {\n        id\n      }\n      ... on NotFoundError {\n        message\n      }\n    }\n  }\n"]);return eN=function(){return e},e}var eM={},eL=(0,ec.gql)(eD()),eB=(0,ec.gql)(eO()),eV=(0,ec.gql)(eN()),eF=e.i(225637),eU=e.i(287999),eG=e.i(374106),e$=e.i(877212),ez=e.i(924908),eH=e.i(641555),eW={direction:"forward",state:{count:0},map:function(e){return e.count},reducer:function(e,t){(0,eG.isEventAgentToolDataKind)(e,"commitData")&&(t.count+=1)}},eq=e.i(423111),eK=1/6;function eY(){var e,t,n,r,i,o=(0,eq.useSetShouldShowRandomCheckpointSurvey)();return e=function(e){e>2&&Math.random()<eK&&o(!0)},t=(0,ez.useChatter)(),n=(0,eH.useObservableMemo)(function(){return t.sessions.agent.current},[t]),r=(0,eH.useObservableMemo)(function(){return null==n?void 0:n.reduce(eW,"global")},[n]),i=(0,u.useRef)(0),(0,u.useEffect)(function(){var t=null!=r?r:0;if(t>i.current)try{e(t)}finally{i.current=t}else t<i.current&&(i.current=t)},[r,e]),null}e.s(["BuildScoreSurveyTopLevelHook",()=>eY,"RANDOM_CHECKPOINT_OCCURRENCE_THRESHOLD",()=>2,"RANDOM_CHECKPOINT_SURVEY_PROBABILITY",()=>eK],660081);var eQ=e.i(136540),eX=e.i(734582),eJ=e.i(624782),eZ=e.i(272119),e0=e.i(423828),e1=e.i(121817),e2=e.i(703505),e3=e.i(779827),e4=e.i(37292),e8=e.i(642049),e5=e.i(729122),e6=e.i(85742),e9=e.i(12034),e7=e.i(610357),te=e.i(409823),tt=e.i(965153);function tn(e){var t=e.entry,n=e.isExpanded,r=e.onToggleExpanded,o=(0,te.default)(new Date(t.timestamp),"yyyy-MM-dd HH:mm:ss"),a=t.state.playgroundState.state;return(0,i.jsx)(tt.AccordionItem,{expanded:n,onClick:r,headerContent:(0,i.jsxs)(A.View,{row:!0,align:"center",gap:8,children:[(0,i.jsx)(I.Text,{variant:"code",color:"dimmer",children:o}),(0,i.jsx)(I.Text,{variant:"code",children:a})]}),children:(0,i.jsx)(ev.default,{json:t.state})})}var tr=e.i(612651),ti=e.i(909478);e.s(["INNGEST_API_PORT",()=>3e3,"MASTRA_API_PORT",()=>5e3],67870);var to=e.i(761732),ta=e.i(417120),ts=e.i(492267),tl=e.i(341727),tu=e.i(782672),tc=((t={}).WORKSPACE_CONNECTING="WORKSPACE_CONNECTING",t.WORKSPACE_RECONNECTING="WORKSPACE_RECONNECTING",t.NIX_IS_BROKEN="NIX_IS_BROKEN",t.SERVICES_LOADING="SERVICES_LOADING",t.APP_NOT_RUNNING_AGENT_WORKING="APP_NOT_RUNNING_AGENT_WORKING",t.APP_NOT_RUNNING_AGENT_IDLE="APP_NOT_RUNNING_AGENT_IDLE",t.APP_STARTING_AGENT_WORKING="APP_STARTING_AGENT_WORKING",t.APP_STARTING_AGENT_IDLE="APP_STARTING_AGENT_IDLE",t.MASTRA_API_NOT_READY="MASTRA_API_NOT_READY",t.INNGEST_API_NOT_READY="INNGEST_API_NOT_READY",t.READY="READY",t);function td(){var e,t,n,r,i,o,a,s,c,d,f,p,h=(0,tl.default)(),g=h.didConnectOnce,m=h.didDisconnect,x=(0,tu.useNixError)(),y=(0,e5.useRunInfo)(),b=(0,e5.useWorkflowsRunState)(),_=(t=(e=(0,l._)((0,u.useState)(!1),2))[0],n=e[1],i=(r=(0,ts.useIsAgentStackRepl)()).isAgentStackRepl,o=r.loading,(0,Y.usePid2)(function(e,t){var r=t.signal;return(0,w._)(function(){var t,a,s,l,u,c,d,f;return(0,k._)(this,function(p){switch(p.label){case 0:if(o||!i)return[2];t=e.mastraApi.subscribeToReadiness.subscribe({},{signal:r}).resReadable,a=!1,s=!1,p.label=1;case 1:p.trys.push([1,6,7,12]),u=(0,D._)(t),p.label=2;case 2:return[4,u.next()];case 3:if(!(a=!(c=p.sent()).done))return[3,5];(d=c.value).ok?n(d.payload.ready):n(!1),p.label=4;case 4:return a=!1,[3,2];case 5:return[3,12];case 6:return f=p.sent(),s=!0,l=f,[3,12];case 7:if(p.trys.push([7,,10,11]),!(a&&null!=u.return))return[3,9];return[4,u.return()];case 8:p.sent(),p.label=9;case 9:return[3,11];case 10:if(s)throw l;return[7];case 11:return[7];case 12:return[2]}})})()},[i,o]),t),S=(s=(a=(0,l._)((0,u.useState)(!1),2))[0],c=a[1],f=(d=(0,ts.useIsAgentStackRepl)()).isAgentStackRepl,p=d.loading,(0,Y.usePid2)(function(e,t){var n=t.signal;return(0,w._)(function(){var t,r,i,o,a,s,l,u;return(0,k._)(this,function(d){switch(d.label){case 0:if(p||!f)return[2];t=e.mastraApi.subscribeToInngestReadiness.subscribe({},{signal:n}).resReadable,r=!1,i=!1,d.label=1;case 1:d.trys.push([1,6,7,12]),a=(0,D._)(t),d.label=2;case 2:return[4,a.next()];case 3:if(!(r=!(s=d.sent()).done))return[3,5];(l=s.value).ok?c(l.payload.ready):c(!1),d.label=4;case 4:return r=!1,[3,2];case 5:return[3,12];case 6:return u=d.sent(),i=!0,o=u,[3,12];case 7:if(d.trys.push([7,,10,11]),!(r&&null!=a.return))return[3,9];return[4,a.return()];case 8:d.sent(),d.label=9;case 9:return[3,11];case 10:if(i)throw o;return[7];case 11:return[7];case 12:return[2]}})})()},[f,p]),s),C=(0,j.default)().ports,T=(0,to.default)(C.portsState),E=(0,ta.useIsAgentWorking)(),R=null!==T&&!1===y.isWorkflowsLoading,I=Object.values(null!=b?b:{}).filter(function(e){return"agent"===e.workflow.author&&e.tasks.some(function(e){return"shell.exec"===e.config.task})}).sort(function(e,t){return e.startTime-t.startTime}),A=I.filter(function(e){return e.step===e8.WorkflowStateStep.RUNNING}),P=(A.length>0?A:I).flatMap(function(e){return e.tasks.map(function(t){return{task:t,runId:e.runId}})}).filter(function(e){return"shell.exec"===e.task.config.task}),O=function(e){var t=P.filter(function(t){return t.task.config.waitForPort===e}),n=t.filter(function(t){var n,r;return null==(r=t.task.metadata)||null==(n=r.openPorts)?void 0:n.some(function(t){return t.port===e&&t.forwarded})}),r=t.map(function(e){var t=e.runId;return null==b?void 0:b[t]}).filter(Boolean);return{hasWorkflowStarting:r.some(function(e){return(null==e?void 0:e.step)===e8.WorkflowStateStep.RUNNING})&&0===n.length,hasWorkflowNotRunning:0===r.length||r.every(function(e){return(null==e?void 0:e.step)!==e8.WorkflowStateStep.RUNNING})}},N=O(3e3),M=O(5e3);return{areNecessaryServicesReady:R,didConnectOnce:g,didDisconnect:m,isAgentWorking:E,nixError:x,isMastraApiReady:_,isInngestApiReady:S,isAnyWorkflowStarting:N.hasWorkflowStarting||M.hasWorkflowStarting,isAnyWorkflowNotRunning:N.hasWorkflowNotRunning||M.hasWorkflowNotRunning}}function tf(){var e=td(),t=e.areNecessaryServicesReady,n=e.didConnectOnce,r=e.didDisconnect,i=e.isAgentWorking,o=e.nixError,a=e.isMastraApiReady,s=e.isInngestApiReady,l=e.isAnyWorkflowStarting,u=e.isAnyWorkflowNotRunning;if(!n)return{state:"WORKSPACE_CONNECTING"};if(r)return{state:"WORKSPACE_RECONNECTING"};if((null==o?void 0:o.status)==="error"||(null==o?void 0:o.status)==="rebuilding-after-error")return{state:"NIX_IS_BROKEN",nixError:o};if(!t)return{state:"SERVICES_LOADING"};if(u)if(i)return{state:"APP_NOT_RUNNING_AGENT_WORKING"};else return{state:"APP_NOT_RUNNING_AGENT_IDLE"};if(l)if(i)return{state:"APP_STARTING_AGENT_WORKING"};else return{state:"APP_STARTING_AGENT_IDLE"};return a?s?{state:"READY"}:{state:"INNGEST_API_NOT_READY"}:{state:"MASTRA_API_NOT_READY"}}e.s(["PlaygroundState",()=>tc,"usePlaygroundState",()=>tf,"usePlaygroundStateInputs",()=>td],102570),e.i(33699);var tp=e.i(399528),th=e.i(541793),tg=e.i(198822),tm=e.i(852819),tv=(0,th.atom)([]);function tx(){var e,t=(0,ex.default)(),n=(0,tg.useWorkspaceToolPanesQuery)({variables:{replId:t}}).data,r=(0,tp.useRouter)();return(0,e$.useSupportsAgent)()&&((null==n||null==(e=n.currentUser)?void 0:e.isAdmin)||!!r.query.debug)}var ty=e.i(107413);function tb(e){var t=e.stateHistory,n=(0,l._)((0,u.useState)(new Set([0])),2),r=n[0],o=n[1],a=function(e){o(function(t){var n=new Set(t);return n.has(e)?n.delete(e):n.add(e),n})};return(0,i.jsx)(A.View,{children:t.map(function(e,t){return(0,i.jsx)(tn,{entry:e,isExpanded:r.has(t),onToggleExpanded:function(){return a(t)}},e.timestamp)})})}var tw=(0,th.atom)([]);function tk(){return(0,tm.useValue)(tw)}function t_(){var e,t=(0,ex.default)(),n=(0,tg.useWorkspaceToolPanesQuery)({variables:{replId:t}}).data,r=(0,tp.useRouter)();return(0,e$.useSupportsAgent)()&&((null==n||null==(e=n.currentUser)?void 0:e.isAdmin)||!!r.query.debug)}function tS(e){var t=t_(),n=(0,tm.useSet)(tw),r=(0,u.useRef)();(0,u.useEffect)(function(){if(t){var i=JSON.stringify(e);if(r.current!==i){r.current=i;var o={timestamp:Date.now(),state:e};n(function(e){return[o].concat((0,L._)(e)).slice(0,100)})}}},[e,t,n])}function tC(e){var t=e.entry,n=e.isExpanded,r=e.onToggleExpanded,o=(0,te.default)(new Date(t.timestamp),"yyyy-MM-dd HH:mm:ss"),a=t.state.agentAwareWebviewState.state;return(0,i.jsx)(tt.AccordionItem,{expanded:n,onClick:r,headerContent:(0,i.jsxs)(A.View,{row:!0,align:"center",gap:8,children:[(0,i.jsx)(I.Text,{variant:"code",color:"dimmer",children:o}),(0,i.jsx)(I.Text,{variant:"code",children:a})]}),children:(0,i.jsx)(ev.default,{json:t.state})})}function tj(e){var t=e.stateHistory,n=(0,l._)((0,u.useState)(new Set([0])),2),r=n[0],o=n[1],a=function(e){o(function(t){var n=new Set(t);return n.has(e)?n.delete(e):n.add(e),n})};return(0,i.jsx)(A.View,{children:t.map(function(e,t){return(0,i.jsx)(tC,{entry:e,isExpanded:r.has(t),onToggleExpanded:function(){return a(t)}},e.timestamp)})})}e.s(["usePreviewStateHistory",()=>tk,"usePreviewStateTracker",()=>tS,"useShouldTrackPreviewStateHistory",()=>t_],345863);var tT=e.i(929872),tE=((n=tE||{}).Repl="repl",n.Pid2="pid2",n.Pid2Repl="pid2Repl",n.MuxedShell="pid2MuxedShell",n.Logs="logs",n.LSP="lsp",n.Ai="ai",n.AiChat="aiChat",n.Survey="survey",n.Git="git",n.History2="history2",n.InngestEvents="inngestEvents",n.Metadata="metadata",n.Override="override",n.DDRum="rum",n.CommandBar="commandBar",n.Workflows="workflows",n.TriggerBSOD="triggerBSOD",n.PreviewState="previewState",n.PlaygroundState="playgroundState",n),tR=(r={},(0,s._)(r,"repl",function(){var e,t,n,r,o,a,s,l,u,c,d=(0,ex.default)(),f=(e={variables:{replId:d}},t=(0,N._)({},eh,e),ed.useQuery(em,t)).data,p=(null==f?void 0:f.getRepl.__typename)==="Repl"?JSON.parse(JSON.stringify(f.getRepl)):void 0;return p&&(delete p.__typename,null==(n=p.user)||delete n.__typename,null==(r=p.origin)||delete r.__typename,delete p.config.__typename,null==(o=p.source)||delete o.__typename,null==(s=p.source)||null==(a=s.release)||delete a.__typename,null==(c=p.source)||null==(u=c.release)||null==(l=u.repl)||delete l.__typename),(0,i.jsxs)(A.View,{css:ew,children:[(0,i.jsx)(eb.default,{replId:d}),(0,i.jsx)("div",{children:p?(0,i.jsx)(ev.default,{json:p}):null})]})}),(0,s._)(r,"pid2",function(){var e,t,n=(0,j.default)().container,r=null==(e=n.getContext())?void 0:e.repl,o=(0,S.usePid2InternalsContextDoNotUseOrYouWillBeFired)(),a=(0,l._)((0,u.useState)("unknown"),2),s=a[0],c=a[1],d=(0,l._)((0,u.useState)(null),2),f=d[0],p=d[1],h=(0,l._)((0,u.useState)(null),2),g=h[0],m=h[1],x=(0,l._)((0,u.useState)(null),2),y=x[0],b=x[1],T=(0,_.useUploadPid2)(),E=(0,l._)((0,_.usePid2UploadState)(),2),D=E[0],O=E[1],N=(0,C.usePid2Callback)(function(e){return function(){return(0,w._)(function(){var t,r,i;return(0,k._)(this,function(o){switch(o.label){case 0:return c("loading"),t=setTimeout(function(){c("unhealthy")},5e3),[4,(0,_.getPid2Paths)(n,p)];case 1:if(!(r=o.sent()))return c("unhealthy"),[2];return[4,n.exec("stat","-c","%N",r.pid2BinDst2)];case 2:return(i=o.sent()).error?p("LocalPid2 not installed: ".concat(i.output)):p("LocalPid2 installed: ".concat(i.output)),e.healthCheck.ping.rpc({}).then(function(e){m(e.payload),clearTimeout(t),e.ok?c("ok"):c("unhealthy")}).catch(function(){clearTimeout(t),c("unhealthy")}),[2]}})})()}});return t="ok"===s?"green":"unhealthy"===s?"red":"grey",(0,i.jsxs)(A.View,{pt:16,px:12,gap:12,children:[(0,i.jsxs)(I.Header,{level:3,children:["Is pid2 enabled? ",o?"Yes":"No"]}),(0,i.jsx)(R.Button,{text:"Ping pid2 (state: ".concat(s,")"),colorway:t,disabled:!N,onClick:function(){null==N||N()}}),g?(0,i.jsx)("code",{children:JSON.stringify(g,null,2)}):null,f?(0,i.jsx)("code",{children:f}):null,(0,i.jsx)(R.Button,{colorway:"purple",text:"Upload pid2 to Repl",onClick:function(){return(0,w._)(function(){return(0,k._)(this,function(e){return r&&T(),[2]})})()}}),(0,i.jsxs)(I.Text,{css:P.uploadMessage,children:["[",D,"] ",O]}),(0,i.jsx)(R.Button,{colorway:"red",text:"Delete uploaded pid2",onClick:function(){return(0,w._)(function(){var e,t,i;return(0,k._)(this,function(o){switch(o.label){case 0:if(!r)return[2];return[4,(0,_.getPid2Paths)(n,b)];case 1:if(!(e=o.sent()))return[2];return[4,n.exec("rm","-f",e.pid2BinDst)];case 2:return t=o.sent(),[4,n.exec("rm","-f",e.pid2BinDst2)];case 3:if(i=o.sent(),t.error)return b("".concat(t.error,": ").concat(t.output)),[2];if(i.error)return b("".concat(i.error,": ").concat(i.output)),[2];return b("uploaded pid2 deleted"),[2]}})})()}}),y?(0,i.jsx)(I.Text,{css:P.uploadMessage,children:y}):null,(0,i.jsx)(R.Button,{text:"Assign pid2 client to window for testing",onClick:function(){window.pid2=o,console.log("window.pid2: ",o)}})]})}),(0,s._)(r,"pid2Repl",function(){var e=(0,l._)((0,u.useState)(function(){return new q.ObservableState([])}),1)[0],t=(0,u.useCallback)(function(t){return e.update(function(e){return[t].concat((0,L._)(e))})},[e]),n=(0,l._)((0,u.useState)(null),2),r=n[0],o=n[1];(0,Y.usePid2)(function(e){return o({client:e}),function(){return o(null)}},[]);var a=en.use(r,t);return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)($.default,{language:"json",hideGutter:!0,extensions:a}),(0,i.jsx)(X,{logs:e,onClear:function(){return e.set([])}})]})}),(0,s._)(r,"pid2MuxedShell",function(){var e=(0,l._)((0,u.useState)([]),2),t=e[0],n=e[1];return(0,Y.usePid2)(function(e,t){var r=t.signal;return(0,w._)(function(){var t,i,o,a,s,l,u,c;return(0,k._)(this,function(d){switch(d.label){case 0:t=e.shellExec.monitorAll.subscribe({},{signal:r}).resReadable,i=!1,o=!1,d.label=1;case 1:d.trys.push([1,6,7,12]),s=(0,D._)(t),d.label=2;case 2:return[4,s.next()];case 3:if(!(i=!(l=d.sent()).done))return[3,5];if(!(u=l.value).ok)return[2];n(u.payload.processes),d.label=4;case 4:return i=!1,[3,2];case 5:return[3,12];case 6:return c=d.sent(),o=!0,a=c,[3,12];case 7:if(d.trys.push([7,,10,11]),!(i&&null!=s.return))return[3,9];return[4,s.return()];case 8:d.sent(),d.label=9;case 9:return[3,11];case 10:if(o)throw a;return[7];case 11:return[7];case 12:return[2]}})})()},[]),(0,i.jsx)(A.View,{children:(0,i.jsx)(ev.default,{json:t})})}),(0,s._)(r,"logs",m.default),(0,s._)(r,"lsp",x.LSPLog),(0,s._)(r,"ai",f.GhostwriterLogs),(0,s._)(r,"aiChat",c.AiChatDebug),(0,s._)(r,"survey",function(e){e.isHidden,e.performPaneOperation;var t,n,r,o,a,s,c,d,f=(0,l._)((0,u.useState)(null),2),p=f[0],h=f[1],g=(0,eq.useShouldShowRandomCheckpointSurvey)(),m=(0,eq.useIsPublishClickedCompleted)(),x=(0,eU.useNumCheckpointsCompleted)(),y=(t={variables:{limit:100}},n=(0,N._)({},eM,t),ed.useQuery(eL,n)),b=y.data,_=y.loading,S=y.error,C=y.refetch,j=(0,l._)((r=(0,N._)({},eM,void 0),eP.useMutation(eV,r)),1)[0],T=(0,eF.useCurrentSurveyTrigger)(),E=(o={skip:!T,variables:{trigger:T}},a=(0,N._)({},eM,o),ed.useQuery(eB,a)).data,P=!!(null==E||null==(s=E.currentUser)?void 0:s.hasCompletedBuildScoreSurveyForTrigger),D=null==b||null==(d=b.currentUser)||null==(c=d.id)?void 0:c.toString();if(_)return(0,i.jsx)(A.View,{className:e3.default.container,children:(0,i.jsx)(I.Text,{children:"Loading survey responses..."})});if(S)return(0,i.jsx)(A.View,{className:e3.default.container,children:(0,i.jsxs)(I.Text,{className:e3.default.errorText,children:["Error loading survey responses: ",S.message]})});var O=(null==b?void 0:b.buildScoreSurveyResponses)||[];return(0,i.jsxs)(A.View,{clsx:e3.default.container,p:16,gap:16,children:[(0,i.jsxs)(A.View,{gap:8,p:12,clsx:e3.default.debugInfoSection,children:[(0,i.jsx)(I.Text,{variant:"subheadDefault",children:(0,i.jsx)("strong",{children:"Survey Trigger Debug Info"})}),(0,i.jsxs)(A.View,{gap:4,children:[(0,i.jsxs)(I.Text,{variant:"small",children:["Current trigger: ",null!=T?T:"undefined"]}),(0,i.jsxs)(I.Text,{variant:"small",children:["Current trigger completed:"," ",T?String(P):"N/A"]}),(0,i.jsxs)(I.Text,{variant:"small",children:["Checkpoints completed: ",x]}),(0,i.jsxs)(I.Text,{variant:"small",children:["Should show random checkpoint survey:"," ",String(g)]}),(0,i.jsxs)(I.Text,{variant:"small",color:"dimmer",children:["Random checkpoint threshold:"," ",2]}),(0,i.jsxs)(I.Text,{variant:"small",color:"dimmer",children:["Random checkpoint probability:"," ","1 in ".concat(Math.round(1/eK))]}),(0,i.jsxs)(I.Text,{variant:"small",children:["Has completed publish clicked: ",String(m)]})]})]}),(0,i.jsx)(R.Button,{text:"Refresh responses",onClick:function(){return C()},size:"small",iconLeft:(0,i.jsx)(e1.default,{})}),(0,i.jsx)(eX.IndexTable,{autoLayout:!0,title:"Build Score Survey Responses",loading:_,columns:[{key:"trigger",label:"Trigger",isRowHeader:!0},{key:"score",label:"Score"},{key:"question",label:"Question"},{key:"repl",label:"Repl"},{key:"created",label:"Created"},{key:"status",label:"Status"},{key:"actions",label:"Actions",alignment:"end"}],items:O,emptyState:(0,i.jsx)(A.View,{row:!0,align:"center",gap:12,p:16,children:(0,i.jsx)(I.Text,{children:"No survey responses found for this user."})}),children:function(e){return(0,i.jsxs)(e0.TableRow,{children:[(0,i.jsx)(eZ.TableCell,{children:(0,i.jsx)(I.Text,{clsx:e.timeDeleted&&e3.default.deletedText,children:e.trigger})}),(0,i.jsx)(eZ.TableCell,{children:(0,i.jsx)(I.Text,{clsx:e.timeDeleted&&e3.default.deletedText,children:null!==e.responseScore?e.responseScore:"Skipped"})}),(0,i.jsx)(eZ.TableCell,{children:(0,i.jsx)(I.Text,{clsx:e.timeDeleted&&e3.default.deletedText,multiline:!0,children:e.questionText})}),(0,i.jsx)(eZ.TableCell,{children:e.replId?(0,i.jsx)(eA.default,{href:"/@".concat(e.replId),clsx:e.timeDeleted&&e3.default.deletedText,children:e.replId}):(0,i.jsx)(I.Text,{color:"dimmer",children:"-"})}),(0,i.jsx)(eZ.TableCell,{children:(0,i.jsx)(I.Text,{clsx:e.timeDeleted&&e3.default.deletedText,children:new Date(e.timeCreated).toLocaleString()})}),(0,i.jsx)(eZ.TableCell,{children:e.timeDeleted?(0,i.jsx)(eJ.Pill,{colorway:"negative",children:"Deleted"}):(0,i.jsx)(eJ.Pill,{colorway:"positive",children:"Active"})}),(0,i.jsx)(eZ.TableCell,{children:!e.timeDeleted&&(0,i.jsx)(eQ.IconButton,{alt:"Delete survey response",onClick:function(){var t;return t=e.id,(0,w._)(function(){return(0,k._)(this,function(e){switch(e.label){case 0:if(!D)return[2];h(t),e.label=1;case 1:return e.trys.push([1,4,5,6]),[4,j({variables:{surveyResponseId:t}})];case 2:return e.sent(),[4,C()];case 3:case 4:return e.sent(),[3,6];case 5:return h(null),[7];case 6:return[2]}})})()},disabled:p===e.id,children:(0,i.jsx)(e2.default,{})})})]},e.id)}})]})}),(0,s._)(r,"git",p.default),(0,s._)(r,"history2",h.default),(0,s._)(r,"inngestEvents",g.InngestEvents),(0,s._)(r,"metadata",y.Metadata),(0,s._)(r,"override",b.OverrideGurl),(0,s._)(r,"rum",function(){var e,t=null==(e=ek.datadogRum.getInternalContext())?void 0:e.session_id,n=ek.datadogRum.getInitConfiguration(),r=null!=n&&100===n.sampleRate,o=(0,l._)((0,u.useState)(null!=t),2),a=o[0],s=o[1];return(0,i.jsx)(A.View,{gap:16,p:4,children:r?(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(R.Button,{onClick:a?function(){ek.datadogRum.stopSessionReplayRecording(),document.cookie="_dd_s=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=/;",window.location.href=window.location.href.split("?")[0]}:function(){(0,eC.datadogRumStartView)({name:"replitOnReplit"}),setTimeout(function(){s(!0)},1e3)},text:a?" Recording... Click to stop and reload page":"Start Recording",colorway:a?void 0:"primary",css:(0,N._)({},a&&ej.loadingStyle.backgroundPulse(Q.tokens.redDimmest,Q.tokens.redDimmer))}),a?(0,i.jsx)(eI,{sessionId:t}):null]}):(0,i.jsx)(R.Button,{onClick:function(){window.location.href=window.location.href.split("?")[0].split("#")[0]+"?rum=1"},text:"Click to reload and start recording",colorway:"primary"})})}),(0,s._)(r,"commandBar",d.CommandBarDebug),(0,s._)(r,"workflows",function(){var e=(0,l._)((0,u.useState)([]),2),t=e[0],n=e[1],r=(0,l._)((0,u.useState)(void 0),2),o=r[0],a=r[1],s=(0,e5.useWorkflowsConfig)(),c=(0,e5.useWorkflows)(),d=(0,e5.useWorkflowsRunState)();(0,u.useEffect)(function(){var e,t,r=null!=(t=null==c?void 0:c.map(function(e){return{id:e.name}}))?t:[];n(r),a(null==(e=r[0])?void 0:e.id)},[c]);var f=(0,C.usePid2Callback)(function(e){return function(t){var n=t.workflowId;return e.workflows.runWorkflow.rpc({workflowId:n})}},[]),p=(0,C.usePid2Callback)(function(e){return function(t){var n=t.runId;e.workflows.stopRun.rpc({runId:n})}},[]);return(0,i.jsxs)(A.View,{p:4,children:[(0,i.jsxs)(A.View,{children:[o?(0,i.jsx)(e9.Select,{"aria-label":"Workflow",onSelectionChange:function(e){a(e)},selectedKey:o,items:t,children:function(e){return(0,i.jsx)(e6.ListBoxItem,{label:e.id},e.id)}}):(0,i.jsx)(A.View,{row:!0,align:"center",justify:"center",grow:!0,shrink:!0,p:4,children:(0,i.jsx)(I.Text,{children:"No workflow selected"})}),(0,i.jsx)(R.Button,{onClick:function(){return(0,w._)(function(){return(0,k._)(this,function(e){switch(e.label){case 0:if(!o||!f)return[2];return[4,f({workflowId:o})];case 1:return e.sent(),[2]}})})()},text:"Run",disabled:!o})]}),d?(0,i.jsx)(A.View,{children:Object.entries(d).map(function(e){var t=(0,l._)(e,2),n=t[0],r=t[1];return(0,i.jsxs)(A.View,{row:!0,gap:4,align:"center",children:[n," step: ",r.step,r.step===e8.WorkflowStateStep.RUNNING?(0,i.jsx)(R.Button,{text:"Stop",onClick:function(){null==p||p({runId:n})}}):null]},n)})}):null,(0,i.jsxs)(A.View,{children:[(0,i.jsx)(I.Text,{children:"Run State"}),(0,i.jsx)(ev.default,{json:d})]}),(0,i.jsxs)(A.View,{children:[(0,i.jsx)(I.Text,{children:"Config"}),(0,i.jsx)(ev.default,{json:s})]})]})}),(0,s._)(r,"triggerBSOD",function(){var e=(0,e4.useThrowBsod)();return(0,i.jsx)(A.View,{gap:16,children:(0,i.jsx)(R.Button,{text:"Throw BSOD",onClick:function(){return e({error:Error("[DEBUG] TriggerBSOD"),origin:"debug: Debug"})}})})}),(0,s._)(r,"previewState",function(){var e=t_(),t=tk();return e?(0,i.jsxs)(A.View,{gap:16,children:[(0,i.jsx)(R.Button,{text:"Copy as JSON",onClick:function(){(0,e7.default)(JSON.stringify(t,null,2))},iconLeft:(0,i.jsx)(ty.default,{})}),(0,i.jsx)(tj,{stateHistory:t})]}):(0,i.jsxs)(A.View,{gap:8,children:[(0,i.jsx)(I.Text,{variant:"small",color:"dimmer",children:"Preview state tracking is not enabled."}),(0,i.jsx)(I.Text,{variant:"small",color:"dimmer",children:"This feature is only available in agent repls for developers, admins, or when using ?debug=true."})]})}),(0,s._)(r,"playgroundState",function(){e=td(),t=tf(),n=(0,e5.useRunInfo)(),r=(0,j.default)().ports,o={playgroundState:t,playgroundStateInputs:e,runInfo:n,openedAndForwardedPorts:(0,ti.useOpenedAndForwardedPorts)(r).map(function(e){return(0,tr.default)(e,["processInfo"])})},a=tx(),s=(0,tm.useSet)(tv),l=(0,u.useRef)(),(0,u.useEffect)(function(){if(a){var e=JSON.stringify(o);if(l.current!==e){l.current=e;var t={timestamp:Date.now(),state:o};s(function(e){return[t].concat((0,L._)(e)).slice(0,100)})}}},[o,a,s]);var e,t,n,r,o,a,s,l,c=tx(),d=(0,tm.useValue)(tv);return c?(0,i.jsxs)(A.View,{gap:16,children:[(0,i.jsx)(R.Button,{text:"Copy as JSON",onClick:function(){(0,e7.default)(JSON.stringify(d,null,2))},iconLeft:(0,i.jsx)(ty.default,{})}),(0,i.jsx)(tb,{stateHistory:d})]}):(0,i.jsxs)(A.View,{gap:8,children:[(0,i.jsx)(I.Text,{variant:"small",color:"dimmer",children:"Playground state tracking is not enabled."}),(0,i.jsx)(I.Text,{variant:"small",color:"dimmer",children:"This feature is only available in agent repls for developers, admins, or when using ?debug=true."})]})}),r),tI=Object.values(tE),tA=(0,T.cssRecord)({surface:[E.rcss.height("100%")],tabs:[{flexWrap:"wrap",flexDirection:"row",gap:"4px"}],tab:[E.rcss.overflow("auto")],content:[E.rcss.height("100%")]});function tP(e){var t=e.paneOptions,n=(0,l._)((0,u.useState)("repl"),2),r=n[0],o=n[1],a=tI.map(function(e){return(0,i.jsx)(R.Button,{colorway:e===r?"primary":void 0,onClick:function(){return o(e)},text:e},e)});return(0,i.jsx)(eU.CheckpointProvider,{children:(0,i.jsxs)(tT.Surface,{background:"default",css:tA.surface,p:4,gap:8,children:[(0,i.jsx)(A.View,{css:tA.tabs,children:a}),(0,i.jsx)(A.View,{css:tA.tab,grow:!0,shrink:!0,children:Object.entries(tR).map(function(e){var n=(0,l._)(e,2),o=n[0],a=n[1];return(0,i.jsx)(A.View,{css:tA.content,grow:!0,shrink:!0,style:{display:o!==r?"none":"inherit"},children:"override"===o&&"override"!==r?null:(0,i.jsx)(a,{isHidden:t.isHidden||r!==o,performPaneOperation:t.performPaneOperation})},o)})})]})})}e.i(282890);var tD=e.i(716636),tO=e.i(598160),tN=e.i(606867),tM=o.Type.Object({type:o.Type.Literal("adminPanel")}),tL={Content:function(e){var t=e.options;return(0,i.jsx)(tP,{paneOptions:t})},Icon:function(e){var t=e.size;return(0,i.jsx)(tN.IconContext.Provider,{value:{color:Q.tokens.redStronger,size:t},children:(0,i.jsx)(tO.default,{})})},getTitle:function(){return"Debug"},getTitlePill:function(){return{text:"Staff-only",colorway:"warning"}},description:"Replit developer debugging tools",category:tD.PaneCategory.Other,decode:function(e){return a.Value.Decode(tM,e)}};e.s(["adminPanelUI",()=>tL],309968);var tB=e.i(61524),tV=e.i(160290),tF=e.i(1736),tU=e.i(959406),tG=(0,T.cssRecord)({container:[E.rcss.coverContainer,E.rcss.py(4),E.rcss.px(8)]});function t$(e){var t=e.performPaneOperation,n=(0,j.default)().fs,r="cmdOrCtrlKey"===(0,tB.usePreferences)("multiselectModifierKey").preferences.multiselectModifierKey?"cmdOrCtrlKey":"altKey",o=(0,tF.useShouldHideFileInWorkspace)(!0),a=(0,u.useCallback)(function(e){return!o(e.filename)},[o]),s=(0,tV.useFiletree)({fs:n,filter:a,multiselectModifierKey:r,readOnly:!0,fontSize:13,manageWidth:!0,onFileSelect:function(e){var n=e.path;t({operation:"replace",pane:(0,tU.getPaneForFile)(n)})}});return(0,i.jsx)(A.View,{css:tG.container,children:(0,i.jsx)(tV.Filetree,{store:s.store})})}var tz=e.i(641536),tH=o.Type.Object({type:o.Type.Literal("agentFiles")}),tW={Content:function(e){return(0,i.jsx)(t$,{performPaneOperation:e.options.performPaneOperation})},Icon:function(e){var t=e.size;return(0,i.jsx)(tN.IconContext.Provider,{value:{color:Q.tokens.blurpleStrongest,size:t},children:(0,i.jsx)(tz.default,{})})},getTitle:function(){return"Files"},category:tD.PaneCategory.WorkspaceFeatures,decode:function(e){return a.Value.Decode(tH,e)}};e.s(["agentFilesUI",()=>tW],94063)},141532,e=>{e.v({abbreviatedBetaText:"BetaDisclaimer-module__DnN4UG__abbreviatedBetaText",fullBetaText:"BetaDisclaimer-module__DnN4UG__fullBetaText"})},762258,e=>{"use strict";var t=e.i(530658),n=e.i(276385),r=e.i(389959),i=e.i(140487),o=e.i(91720),a=e.i(739521),s=e.i(396776),l=e.i(960178),u=e.i(625484),c=e.i(531603),d=e.i(141532);function f(){var e=(0,t._)((0,r.useState)(!1),2),f=e[0],p=e[1];return(0,n.jsxs)(u.View,{children:[(0,n.jsx)(s.StatusBanner,{variant:"flush",text:(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(l.Text,{clsx:d.default.fullBetaText,children:"Agents and Automations are currently in beta"}),(0,n.jsx)(l.Text,{clsx:d.default.abbreviatedBetaText,multiline:!1,children:"Beta"})]}),colorway:"orange",clsx:d.default.betaBanner,action:(0,n.jsxs)(u.View,{row:!0,children:[(0,n.jsxs)(u.View,{row:!0,gap:8,align:"center",children:[(0,n.jsx)(l.Text,{children:"Having trouble?"}),(0,n.jsx)(i.Button,{text:"Get help",variant:"underlined",onClick:function(){p(!0)}}),(0,n.jsx)(l.Text,{children:"or"})]}),(0,n.jsx)(o.ButtonLink,{href:"https://docs.replit.com/replitai/agents-and-automations",text:"read the docs",variant:"underlined",target:"_blank"})]})}),(0,n.jsx)(a.Modal,{isOpen:f,onRequestClose:function(){return p(!1)},children:(0,n.jsx)(c.default,{onRequestClose:function(){return p(!1)}})})]})}e.s(["default",()=>f])},973502,e=>{e.v({popoverContent:"HeaderMenu-module__6tza3a__popoverContent",popoverContentText:"HeaderMenu-module__6tza3a__popoverContentText"})},878129,e=>{e.v({canvasAreaWrapper:"index-module__gbtx1a__canvasAreaWrapper",headerWrapper:"index-module__gbtx1a__headerWrapper",overlayContainer:"index-module__gbtx1a__overlayContainer",textContainerMaxWidth:"index-module__gbtx1a__textContainerMaxWidth"})},79998,294468,e=>{"use strict";var t=e.i(276385),n=e.i(389959),r=e.i(960933),i=e.i(862927),o=e.i(629536),a=e.i(368964),s=e.i(188507),l=e.i(808053),u=e.i(492267),c=e.i(820219),d=e.i(762258),f=e.i(617628),p=e.i(530658),h=e.i(67870),g=e.i(475032),m=e.i(739434),x=e.i(529810),y=e.i(134405),b=e.i(140487),w=e.i(91720),k=e.i(604963),_=e.i(929872),S=e.i(960178),C=e.i(625484),j=e.i(576073),T=e.i(243914),E=e.i(973502),R=function(){var e=(0,p._)((0,n.useState)(!1),2),r=e[0],i=e[1],o=(0,x.default)().container,a=(0,g.default)(o).url,s=(0,y.useAgentAwareWebviewState)(),l=a?(0,m.addPortToUrl)(a,h.INNGEST_API_PORT).toString():null;return(0,t.jsxs)(k.PopoverTrigger,{label:"Header Menu",isOpen:r,onOpenChange:i,children:[(0,t.jsx)(b.Button,{size:"small",variant:"default",text:"Debug",iconRight:(0,t.jsx)(j.default,{}),onClick:function(){return i(!r)}}),(0,t.jsx)(_.Surface,{elevated:!0,p:8,gap:20,clsx:E.default.popoverContent,children:s.state===y.WebviewState.READY?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(S.Text,{clsx:E.default.popoverContentText,color:"dimmer",children:"Replit Agent uses the Mastra and Inngest frameworks to build your agents and automations. Visit your Mastra dashboard for more details about your app, and Inngest traces to view your test runs."}),(0,t.jsxs)(C.View,{gap:8,row:!1,children:[(0,t.jsx)(w.ButtonLink,{size:"small",variant:"outlined",text:"Mastra dashboard",iconRight:(0,t.jsx)(T.default,{}),href:null!=a?a:"",target:"_blank"}),(0,t.jsx)(w.ButtonLink,{size:"small",variant:"outlined",text:"Inngest traces",iconRight:(0,t.jsx)(T.default,{}),href:null!=l?l:"",target:"_blank"})]})]}):(0,t.jsx)(S.Text,{clsx:E.default.popoverContentText,color:"dimmer",children:"Replit Agent uses the Mastra and Inngest frameworks to build your agents and automations. You can open the Mastra playground and Inngest traces from here once your app is running."})})]})},I=e.i(297083),A=e.i(817556),P=e.i(299798),D=e.i(927158),O=e.i(394212),N=e.i(878420);e.i(925218);var M=e.i(112077),L=e.i(222342),B=e.i(102570),V=(0,e.i(864558).default)(function(){return e.A(207544).then(function(e){return{default:e.WorkflowCanvasImpl}})},{loadableGenerated:{modules:[355221]},ssr:!1,loading:function(){return null}}),F=e.i(712516),U=e.i(293265),G=e.i(721281),$=e.i(642049),z=e.i(709485),H=e.i(858248),W=e.i(982829),q=e.i(729122),K=e.i(480028),Y=e.i(446530),Q=e.i(123850),X=e.i(613355),J=e.i(978669),Z=(0,Q.createCssVarTokens)(["backgroundColor","color","hoverColor","hoverBackgroundColor"]),ee=Z.cssVars,et=Z.styleTokens,en=(0,Y.cssRecord)({wrapper:[X.rcss.display.inlineFlex,{backgroundColor:et.backgroundColor,color:et.color,"&:hover":{color:et.hoverColor,backgroundColor:et.hoverBackgroundColor}},X.rcss.align.center,X.rcss.borderRadius(),X.rcss.py(2),X.rcss.px(6),X.rcss.cursor.pointer]});function er(e){var r,i=e.isDisabled,o=void 0!==i&&i,a=(0,x.default)().fs,s=(0,q.useTriggerLocalRun)(),l=(0,q.useWorkflows)(),u=(0,q.useWorkflowsRunState)(),c=(0,n.useMemo)(function(){var e=l.filter(function(e){return"agent"===e.author&&"parallel"!==e.mode});if(!u)return e;var t=new Set;return Object.values(u).forEach(function(e){e.step===$.WorkflowStateStep.RUNNING&&t.add(e.workflow.name)}),e.filter(function(e){return!t.has(e.name)})},[l,u]),d=(0,D.usePid2Callback)(function(e){return function(){return(0,I._)(function(){return(0,A._)(this,function(t){switch(t.label){case 0:return[4,a.flush()];case 1:return t.sent(),s(W.RunReason.RUN_BUTTON_CLICKED),[4,Promise.allSettled(c.map(function(e){return e.name}).map(function(t){return e.workflows.runWorkflow.rpc({workflowId:t})}))];case 2:return[2,t.sent().every(function(e){return"fulfilled"===e.status&&e.value.ok})]}})})()}},[a,s,c]),f=(0,n.useCallback)(function(){!o&&d&&((0,H.track)(z.events.WORKFLOW_RAN,{source:"playgroundPane",runner:"workflows"}),d())},[o,d]);return(0,t.jsxs)(C.View,{tag:"button",onClick:f,css:en.wrapper,row:!0,gap:6,disabled:o||!d,style:(r={},(0,G._)(r,ee.backgroundColor,o?K.tokens.backgroundHighest:K.tokens.accentPositiveDimmer),(0,G._)(r,ee.color,o?K.tokens.foregroundDimmer:K.tokens.accentPositiveStrongest),(0,G._)(r,ee.hoverColor,o?K.tokens.foregroundDefault:K.tokens.white),(0,G._)(r,ee.hoverBackgroundColor,o?K.tokens.greyDimmest:K.tokens.accentPositiveDefault),r),children:[(0,t.jsx)(J.default,{size:12}),(0,t.jsx)(S.Text,{children:"Run"})]})}var ei=e.i(396776),eo=e.i(751273),ea=e.i(179140),es=e.i(387710),el=e.i(313025),eu=e.i(42458),ec=e.i(878129);function ed(e){var n=e.entityName;return(0,t.jsx)(F.default,{pane:{type:"automations"},icon:(0,t.jsx)(es.default,{size:48}),headerText:"Your app is not running",body:(0,t.jsxs)(C.View,{align:"center",row:!0,gap:4,children:[(0,t.jsx)(er,{})," to see your ",n," in action."]})})}function ef(){var e=o.stackBlueprintDetails[s.StackBlueprint.STACK_BLUEPRINT_AGENT].displayName;return(0,t.jsxs)(C.View,{align:"center",justify:"center",p:48,gap:24,grow:!0,children:[(0,t.jsxs)(C.View,{align:"center",gap:12,children:[(0,t.jsx)(el.default,{size:48}),(0,t.jsx)(S.Text,{variant:"headerDefault",children:o.AUTOMATIONS_PANE_NAME})]}),(0,t.jsx)(C.View,{align:"center",gap:16,clsx:ec.default.textContainerMaxWidth,children:(0,t.jsxs)(S.Text,{textAlign:"center",color:"dimmer",children:['This tool is used to visualize and test your agents and automations created using the "',e,'" app type.']})})]})}function ep(e){var n=e.state,r=e.agentStackPlatformType;if("none"===n.type)return null;var i=r===a.AgentStackPlatformType.TimeBased?"automation":"agent",o=function(){switch(n.type){case"loading":return(0,t.jsxs)(C.View,{gap:16,align:"center",children:[(0,t.jsx)(ea.default,{size:48,variant:"minimal"}),(0,t.jsx)(S.Text,{children:"Your ".concat(i," will be ready soon")}),(0,t.jsx)(C.View,{align:"center",children:(0,t.jsx)(l.DynamicReplitCapabilities,{isAgentStackRepl:!0})})]});case"error":return(0,t.jsx)(ei.StatusBanner,{icon:(0,t.jsx)(eu.default,{}),text:n.message,colorway:"negative",action:n.onRetry?(0,t.jsx)(b.Button,{text:"Retry",onClick:n.onRetry}):void 0});case"empty-state":return(0,t.jsxs)(C.View,{align:"center",gap:12,children:[(0,t.jsx)(S.Text,{variant:"headerDefault",children:"No ".concat(i," found")}),(0,t.jsx)(S.Text,{variant:"small",color:"dimmer",children:"They will appear here once Replit Agent has built them."})]});case"app-not-running":return(0,t.jsx)(ed,{entityName:i})}}();return(0,t.jsx)(C.View,{clsx:ec.default.overlayContainer,children:o})}function eh(e){var r,i,o,s,l,h,g,m,x,y,b,w=e.openPane,k=(0,U.useAgentStackPlatformType)().agentStackPlatformType,_=(0,B.usePlaygroundState)(),j=(0,u.useIsAgentStackRepl)().isAgentStackRepl,T=(r=_.state===B.PlaygroundState.READY,o=(i=(0,p._)((0,n.useState)({status:"loading"}),2))[0],s=i[1],l=(0,n.useRef)(null),h=(0,n.useCallback)(function(e){return(0,I._)(function(){var t,n;return(0,A._)(this,function(i){switch(i.label){case 0:if(!r)return[2];return l.current&&(clearTimeout(l.current),l.current=null),s({status:"loading"}),[4,e.mastraApi.getPrimaryWorkflowDetails.rpc({})];case 1:return(t=i.sent()).ok?s({status:"success",workflow:null!=(n=t.payload.workflow)?n:null}):"MASTRA_API_NOT_READY"===t.payload.code?l.current=setTimeout(function(){h(e)},1e3):s({status:"error",message:t.payload.message}),[2]}})})()},[r]),(0,P.usePid2)(h,[h]),g=(0,D.usePid2Callback)(function(e){return function(){return h(e)}},[h]),(0,n.useEffect)(function(){return function(){l.current&&clearTimeout(l.current)}},[]),{primaryWorkflowDetailState:o,handleRefresh:g}),E=T.primaryWorkflowDetailState,F=T.handleRefresh,G=(m="success"===E.status?E.workflow:null,x=(0,M.useCreateObservable)({type:"idle"}),y=(0,n.useRef)(null),b=(0,L.default)().showError,{executeWorkflow:(0,D.usePid2Callback)(function(e){return function(t,n){return(0,I._)(function(){var r,i,o,a,s,l,u,c,d;return(0,A._)(this,function(f){switch(f.label){case 0:if(!m)return[2];y.current&&y.current.abort(),y.current=new AbortController,r=y.current.signal,x.set({type:"idle"}),t&&(console.warn("-----DEV TRIGGER LOG----- useWorkflowExecution: Executing workflow with trigger payload"),console.warn("-----DEV TRIGGER LOG----- Workflow ID:",m.id),console.warn("-----DEV TRIGGER LOG----- Payload:",t),console.warn("-----DEV TRIGGER LOG----- Headers:",n)),i=e.mastraApi.streamWorkflowRun2.subscribe((0,N._)({workflowId:m.id},t&&{eventPayload:t},n&&{eventHeaders:n}),{signal:r}).resReadable,o=!1,a=!1,f.label=1;case 1:f.trys.push([1,6,7,12]),l=function(){var e=c.value;if(!e.ok)return"CANCEL"===e.payload.code?x.set({type:"idle"}):(b(e.payload.message),x.update(function(t){return{type:"completed",status:"failed",errorMessage:e.payload.message,stepsRunData:"idle"!==t.type?t.stepsRunData:void 0}})),"break";var t=e.payload,n=t.status&&["success","failed","canceled"].includes(t.status);x.update(function(e){return{type:n?"completed":"executing",status:t.status||("idle"!==e.type?e.status:"running"),stepsRunData:t.stepsRunData||("idle"!==e.type?e.stepsRunData:void 0)}})},u=(0,O._)(i),f.label=2;case 2:return[4,u.next()];case 3:if(!(o=!(c=f.sent()).done)||"break"===l())return[3,5];f.label=4;case 4:return o=!1,[3,2];case 5:return[3,12];case 6:return d=f.sent(),a=!0,s=d,[3,12];case 7:if(f.trys.push([7,,10,11]),!(o&&null!=u.return))return[3,9];return[4,u.return()];case 8:f.sent(),f.label=9;case 9:return[3,11];case 10:if(a)throw s;return[7];case 11:return[7];case 12:return[2]}})})()}},[m,x,b]),resetWorkflow:(0,n.useCallback)(function(){var e;null==(e=y.current)||e.abort(),x.set({type:"idle"})},[x]),state:x}),$=G.executeWorkflow,z=G.state,H=G.resetWorkflow,W="success"===E.status&&null!==E.workflow,q=(0,n.useMemo)(function(){return _.state===B.PlaygroundState.APP_NOT_RUNNING_AGENT_IDLE?{type:"app-not-running"}:_.state!==B.PlaygroundState.READY||"loading"===E.status?{type:"loading"}:"error"===E.status?{type:"error",message:"Failed to load workflows",onRetry:F}:"success"!==E.status||W?{type:"none"}:{type:"empty-state"}},[_.state,E.status,W,F]),K=f.PLATFORM_TYPE_TO_CONFIG[k||a.AgentStackPlatformType.TimeBased],Y="none"!==q.type;return j&&k?(0,t.jsx)(c.AutomationProvider,{workflowDetail:"success"===E.status?E.workflow:null,triggerType:k,workflowExecutionState:z,executeWorkflow:$,resetWorkflow:H,openPane:w,children:(0,t.jsxs)(C.View,{grow:!0,shrink:!0,children:[(0,t.jsxs)(C.View,{clsx:ec.default.canvasAreaWrapper,grow:!0,children:[(0,t.jsx)(V,{disableMovingCanvas:Y,hideNodes:Y}),Y?(0,t.jsx)(ep,{state:q,agentStackPlatformType:k||a.AgentStackPlatformType.TimeBased}):null,(0,t.jsxs)(C.View,{row:!0,align:"center",justify:"space-between",px:12,py:8,clsx:ec.default.headerWrapper,children:[(0,t.jsxs)(C.View,{row:!0,align:"center",gap:8,children:[(0,t.jsx)(eo.Tooltip,{tooltip:K.description,placement:"bottom",children:K.icon}),(0,t.jsx)(S.Text,{children:"".concat(K.entityName," testing environment")})]}),(0,t.jsx)(R,{})]})]}),(0,t.jsx)(d.default,{})]})}):(0,t.jsx)(ef,{})}e.i(282890);var eg=e.i(716636),em=e.i(606867),ev=r.Type.Object({type:r.Type.Literal("automations")}),ex={Content:function(e){var r=e.options.performPaneOperation,i=(0,n.useCallback)(function(e){return r({operation:"open",secondary:!0,pane:e})},[r]);return(0,t.jsx)(eh,{openPane:i})},Icon:function(e){var n=e.size;return(0,t.jsx)(em.IconContext.Provider,{value:{color:K.tokens.foregroundDefault,size:n},children:(0,t.jsx)(el.default,{})})},getTitle:function(){return o.AUTOMATIONS_PANE_NAME},description:"View and test agents and automations created by Replit Agent.",category:eg.PaneCategory.WorkspaceFeatures,decode:function(e){return i.Value.Decode(ev,e)}};e.s(["automationsUI",()=>ex],79998);var ey=(0,e.i(967629).css)([X.rcss.flex.growAndShrink(1),X.rcss.position.relative,X.rcss.overflow("hidden"),X.rcss.borderRadius(0,0,8,8)]);function eb(e){return(0,t.jsx)(C.View,{css:[ey,e.children?X.rcss.center:null],children:e.children})}e.s(["Content",()=>eb],294468)},827759,e=>{"use strict";var t=e.i(276385),n=e.i(399528),r=e.i(389959),i=e.i(144619),o=e.i(959406),a=e.i(967629),s=e.i(480028),l=e.i(613355),u=e.i(625484),c=(0,a.css)([l.rcss.height(28),l.rcss.flex.row,l.rcss.align.center,{borderBottom:"1px solid ".concat(s.tokens.backgroundHigher),opacity:.8,":hover":{opacity:1}}]);function d(e){return"/replEnvironmentDesktop"!==n.default.pathname?null:(0,t.jsx)(u.View,{css:c,children:e.children})}var f=(0,a.css)([l.rcss.flex.row,l.rcss.align.center,l.rcss.flex.growAndShrink(1),l.rcss.overflowX("auto"),l.rcss.height("100%"),{"&::-webkit-scrollbar":{height:0},scrollbarWidth:"none"}]);function p(e){return(0,t.jsx)(u.View,{pl:e.noPadding?void 0:4,css:f,children:e.children})}var h=(0,a.css)([l.rcss.flex.row,l.rcss.align.center,l.rcss.height("100%")]),g=(0,a.css)([l.rcss.flex.row,l.rcss.align.center,l.rcss.height("100%"),l.rcss.px(2)]);function m(e){return(0,t.jsx)(u.View,{css:h,children:(0,t.jsx)(u.View,{css:g,children:e.children})})}function x(e){var n=e.path,a=e.performPaneOperation,s=e.children,l=(0,r.useCallback)(function(e){a({operation:"replace",pane:(0,o.getPaneForFile)(e)})},[a]);return(0,t.jsxs)(d,{children:[(0,t.jsx)(p,{children:(0,t.jsx)(i.FileBreadcrumbs,{path:n,onFileClick:l})}),s?(0,t.jsx)(m,{children:s}):null]})}e.s(["FileHeader",()=>x,"Header",()=>d,"HeaderLeft",()=>p,"HeaderRight",()=>m])},880569,e=>{"use strict";var t=e.i(530658),n=e.i(346715),r=e.i(276385),i=e.i(389959),o=e.i(960933),a=e.i(862927),s=e.i(205104),l=e.i(529810),u=e.i(185511),c=e.i(294468),d=e.i(827759);e.i(282890);var f=e.i(716636),p=e.i(259493),h=e.i(446530),g=e.i(613355),m=e.i(136540),x=e.i(630818),y=e.i(960178),b=e.i(625484),w=e.i(757390),k=e.i(940745),_=(0,h.cssRecord)({text:{width:"100%",textAlign:"center"},loaderContainer:[g.rcss.display.flex,g.rcss.center,g.rcss.height("100%")]}),S=o.Type.Object({type:o.Type.Literal("binary"),data:o.Type.Object({path:o.Type.String()})}),C={Content:function(e){var t=e.pane,n=e.options;return(0,r.jsx)(j,{path:t.data.path,performPaneOperation:n.performPaneOperation})},Icon:function(e){var t=e.pane,n=e.size;return(0,r.jsx)(x.default,{path:t.data.path,size:n})},getTitle:function(e){return(0,s.getFileName)(e.data.path)},category:f.PaneCategory.WorkspaceFeatures,decode:function(e){return a.Value.Decode(S,e)}};function j(e){var o=e.path,a=e.performPaneOperation,s=(0,l.default)().fs,c=(0,u.useFileCommands)({path:o,performPaneOperation:a});(0,p.useSetPaneBindings)(function(){if(c)return{commands:[{commands:c?(0,n._)(c):[]}]}},[c]);var f=(0,t._)((0,i.useState)(null),2),h=f[0],g=f[1],m=(0,t._)((0,i.useState)(!0),2),x=m[0],w=m[1];return((0,i.useEffect)(function(){var e=s.watchFile(o,{onChange:function(e){g(e.toString("base64")),w(!1)},onError:function(){g(null),w(!1)},onMoveOrDelete:function(){g(null),w(!1)}});return function(){e(),w(!0),g(null)}},[s,o]),x)?(0,r.jsx)(b.View,{css:_.loaderContainer,children:(0,r.jsx)(k.default,{})}):null===h?(0,r.jsx)(y.Text,{multiline:!1,children:"Failed to load binary file"}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(d.FileHeader,{path:o,performPaneOperation:a}),(0,r.jsx)(T,{path:o})]})}function T(e){var n=e.path,o=(0,l.default)().fs,a=(0,t._)((0,i.useState)(null),2),u=a[0],d=a[1],f=(0,t._)((0,i.useState)(!0),2),p=f[0],h=f[1];return((0,i.useEffect)(function(){var e=o.watchFile(n,{onChange:function(e){d(e.toString("base64")),h(!1)},onError:function(){d(null),h(!1)},onMoveOrDelete:function(){d(null),h(!1)}});return function(){e(),h(!0),d(null)}},[o,n]),p)?(0,r.jsx)(b.View,{css:_.loaderContainer,children:(0,r.jsx)(k.default,{})}):null===u?(0,r.jsx)(y.Text,{multiline:!1,children:"Failed to load binary file"}):(0,r.jsx)(r.Fragment,{children:(0,r.jsxs)(c.Content,{centered:!0,children:[(0,r.jsx)(y.Text,{css:_.text,children:"The file is not displayed in the text editor because it is either binary or uses an unsupported text encoding."}),(0,r.jsx)(m.IconButton,{alt:"Download",css:[g.rcss.position.absolute,g.rcss.bottom(8),g.rcss.right(8),g.rcss.p(16)],children:(0,r.jsx)("a",{href:"data:text/plain;base64,".concat(u),download:(0,s.getFileName)(n),css:[g.rcss.color.foregroundDimmer],children:(0,r.jsx)(w.default,{})})})]})})}e.s(["BinaryPaneContent",()=>T,"binaryUI",()=>C])},122947,564169,10681,197565,e=>{"use strict";var t=e.i(906368),n=e.i(753950),r=e.i(938668),i=n.StateEffect.define(),o=n.StateEffect.define(),a=function(e){var t=e.view,n=e.insert,o=e.scrollIntoView,a=e.overwrite,s=e.insertAt;if(a)t.dispatch({changes:{from:0,to:t.state.doc.length,insert:n},effects:i.of(null),scrollIntoView:o,annotations:r.default.of(!0)});else{var l=null!=s?s:t.state.selection.main.head,u=null!=s?s:t.state.selection.main.from;t.dispatch({changes:{from:u,insert:n},selection:{anchor:l+n.length},effects:i.of(null),scrollIntoView:o,annotations:r.default.of(!0)})}},s=function(e){var n=e.state.field(l,!1);n?e.dispatch({changes:n,effects:o.of(null)}):t.captureException(Error("RevetGhostwriterCodeInsertState not found when trying to revert"))},l=n.StateField.define({create:function(){return null},update:function(e,t){e&&(e=e.map(t.changes));var n=!0,r=!1,a=void 0;try{for(var s,l=t.effects[Symbol.iterator]();!(n=(s=l.next()).done);n=!0){var u=s.value;u.is(i)&&(e=t.changes.invert(t.startState.doc)),u.is(o)&&(e=null)}}catch(e){r=!0,a=e}finally{try{n||null==l.return||l.return()}finally{if(r)throw a}}return e}});e.s(["RevetGhostwriterCodeInsertState",()=>l,"insertGhostwriterCode",()=>a,"revertGhostwriterCode",()=>s],122947);var u=e.i(530658),c=e.i(346715),d=e.i(276385),f=e.i(389959),p=e.i(223808),h=e.i(488566),g=e.i(650587),m=e.i(698053),x=e.i(332441),y=e.i(541793),b=e.i(161322),w=(0,f.createContext)(null),k=(0,y.atom)(null),_=(0,y.atom)(null,function(e,t,n){t(k,n)});function S(){var e=(0,f.useContext)(w);if(!e)throw Error("Expected store in context");return e}function C(){return(0,b.useAtomValue)(k,{store:S()})}function j(e){var t=(0,b.useAtomValue)(k,{store:S()}),n=(0,b.useSetAtom)(_,{store:S()});(0,f.useEffect)(function(){t!==e&&n(e)},[e,t,n])}e.s(["CodeEditorViewContext",()=>w,"useCodeEditorView",()=>C,"useSetCodeEditorView",()=>j],564169);var T=e.i(446530),E=e.i(613355),R=e.i(625484),I=e.i(193836),A=e.i(953764),P=(0,T.cssRecord)({root:[E.rcss.height(48),E.rcss.backgroundColor.backgroundRoot,E.rcss.display.flex,E.rcss.justify.spaceBetween,E.rcss.align.stretch,{fontFamily:"Monaco, Menlo, 'Ubuntu Mono', Consolas, source-code-pro, monospace",button:[E.rcss.color.foregroundDefault,E.rcss.fontSize(16),E.rcss.flex.growAndShrink(1),{padding:"10px",fontFamily:"inherit",backgroundColor:"transparent",border:"0 none",flexBasis:"auto"}]}],fixedContainer:[E.rcss.position.fixed,E.rcss.width("100%"),E.rcss.zIndex(100),E.rcss.left(0)]}),D=function(e){var t=e.buttons,n=e.onClick,r=e.onUndo,i=e.onRedo;return(0,d.jsxs)("nav",{css:P.root,children:[t.map(function(e){return(0,d.jsx)("button",{onClick:function(t){t.stopPropagation(),t.preventDefault(),n(e)},children:void 0!==e.label?e.label:e.value},e.value)}),(0,d.jsx)("button",{onClick:function(e){e.stopPropagation(),e.preventDefault(),r()},children:(0,d.jsx)(I.default,{})}),(0,d.jsx)("button",{onClick:function(e){e.stopPropagation(),e.preventDefault(),i()},children:(0,d.jsx)(A.default,{})})]})},O=[{value:"{}",cursorOffset:1},{value:"()",cursorOffset:1},{value:'""',cursorOffset:1}],N=function(e){var t=e.path,n=(0,c._)(O).concat([{value:"= ",cursorOffset:2}]);return t.endsWith(".html")&&(n.unshift({value:"<>",cursorOffset:1}),n.unshift({label:"div",value:"<div></div>",cursorOffset:5})),n},M="visualViewport"in window;function L(e){var t=e.filePath,n=e.isLoading,r=C(),i=(0,g.useIsMobile)({tablet:!1}),o=(0,x.useIsIOS)(),a=(0,m.default)();(0,f.useEffect)(function(){a&&r&&r.requestMeasure({read:function(){return{cursor:r.coordsAtPos(r.state.selection.main.head),scroller:r.scrollDOM.getBoundingClientRect()}},write:function(e){var t=e.cursor,n=e.scroller;if(t){var i=(t.top+t.bottom)/2,a=(n.top+n.bottom)/2;Math.abs(i-a)>5&&(r.scrollDOM.scrollTop+=i-a+50*!!o)}}})},[a,r,o]);var s=(0,u._)((0,f.useState)(0),2),l=s[0],c=s[1];if((0,f.useEffect)(function(){if(o){var e=window.visualViewport;if(M&&e){var t=(0,p.default)(function(){c(window.innerHeight-e.height-e.offsetTop)},100);return e.addEventListener("scroll",t),e.addEventListener("resize",t),function(){e.removeEventListener("scroll",t),e.removeEventListener("resize",t)}}}},[o]),!a||n||!i)return null;var y=(0,d.jsx)(D,{onUndo:function(){r&&((0,h.undo)(r),r.focus())},onRedo:function(){r&&((0,h.redo)(r),r.focus())},onClick:function(e){if(r){var t,n=null!=(t=r.state.selection.ranges[0].from)?t:0;r.dispatch({changes:{from:n,insert:e.value},selection:{anchor:n+e.cursorOffset}}),r.focus()}},buttons:N({path:t})});return!o||M?(0,d.jsx)(R.View,{css:P.fixedContainer,style:{bottom:l},children:y}):y}e.s(["default",()=>L],10681);var B=e.i(297083),V=e.i(904851),F=e.i(90659),U=e.i(721281),G=e.i(817556),$=e.i(992785),z=e.i(179302);e.i(508987);var H=e.i(457103),W=e.i(736097),q=e.i(828767),K=e.i(969932),Y=e.i(502379),Q=e.i(644920),X=e.i(256969);function J(e){var t,n;return null!=(n=null==(t=e.facet(q.LSPCapabilities))?void 0:t.isDocumentSymbolSupported)&&n}var Z=n.StateEffect.define(),ee=n.StateField.define({create:function(){return null},update:function(e,t){var n=e;return(0,K.forEachEffect)(t,Z,function(e){n=e.value}),n}});function et(e){if("Debounced function cancelled"!==e.message)throw e}var en=n.StateField.define({create:function(){return[]},update:function(e,t){if(!(0,H.hasChanged)(t,ee,"selection"))return e;var n=t.state.field(ee);return n?function e(t,n,r){var i=r.find(function(e){var r=e.range;return(0,Y.posToOffset)(t,r.end)>=n&&(0,Y.posToOffset)(t,r.start)<=n});return null==i?[]:i.children?[i].concat(e(t,n,i.children)):[i]}(t.state.doc,t.state.selection.main.head,n):[]},compare:$.default});function er(e){return[ee,en,z.ViewPlugin.fromClass(function(){function t(n){var r=this;(0,V._)(this,t),(0,U._)(this,"getSymbolMap",void 0),(0,U._)(this,"abortControllers",[]),this.getSymbolMap=(0,Q.default)(function(){return(0,B._)(function(){var t,r,i,o;return(0,G._)(this,function(a){switch(a.label){case 0:if(t=this,!(r=n.state.facet(W.fileName)))return[2];return this.abortControllers=[],[4,Promise.all(e.map(function(e){if(!(0,X.default)(e).isDocumentSymbolSupported)return null;var n,i=new AbortController;return t.abortControllers.push(i),n=i.signal,(0,B._)(function(){var t,i,o,a,s,l,u,c,d;return(0,G._)(this,function(f){switch(f.label){case 0:return[4,e.request.documentSymbol(r,{signal:n})];case 1:if(!(t=f.sent())||t.cancelled||!(i="result"in t&&!t.cancelled?t.result:null))return[2,null];o=[],a=!0,s=!1,l=void 0;try{for(u=i[Symbol.iterator]();!(a=(c=u.next()).done);a=!0)(d=c.value)&&"range"in d&&o.push(d)}catch(e){s=!0,l=e}finally{try{a||null==u.return||u.return()}finally{if(s)throw l}}return[2,o.length?o:null]}})})()}))];case 1:return i=a.sent(),n.dispatch({effects:Z.of(null!=(o=i.find(Boolean))?o:null)}),[2]}})}).call(r)},{wait:200}),J(n.state)&&this.getSymbolMap().catch(et)}return(0,F._)(t,[{key:"update",value:function(e){!(0,H.hasChanged)(e,"doc",q.LSPCapabilities)||J(e.state)&&(this.abortControllers.forEach(function(e){return e.abort()}),this.getSymbolMap().catch(et))}},{key:"destroy",value:function(){this.abortControllers.forEach(function(e){return e.abort()}),this.getSymbolMap.isScheduled()&&this.getSymbolMap.cancel()}}]),t}())]}e.s(["createDocumentSymbolsExtenstion",()=>er,"documentSymbols",()=>ee,"symbolsPath",()=>en],197565)},817221,e=>{"use strict";var t=e.i(333859);let n=[t.SymbolKind.Array,t.SymbolKind.Boolean,t.SymbolKind.Class,t.SymbolKind.Constant,t.SymbolKind.Constructor,t.SymbolKind.Enum,t.SymbolKind.EnumMember,t.SymbolKind.Event,t.SymbolKind.Field,t.SymbolKind.File,t.SymbolKind.Function,t.SymbolKind.Interface,t.SymbolKind.Key,t.SymbolKind.Method,t.SymbolKind.Module,t.SymbolKind.Namespace,t.SymbolKind.Object,t.SymbolKind.Operator,t.SymbolKind.Package,t.SymbolKind.Property,t.SymbolKind.String,t.SymbolKind.Struct,t.SymbolKind.TypeParameter,t.SymbolKind.Variable];e.s(["default",0,n])},484035,e=>{"use strict";var t=e.i(276385),n=e.i(389959),r=e.i(753950),i=e.i(197565),o=e.i(703613),a=e.i(502379),s=e.i(923563),l=e.i(2497),u=e.i(269774),c=e.i(530658),d=e.i(333859),f=e.i(817221),p=e.i(480028),h=e.i(555765),g=e.i(727903),m=e.i(751405),x=e.i(368357),y=e.i(609671),b=e.i(761922),w=e.i(578858),k=e.i(991552),_=e.i(216373),S=e.i(260310),C=e.i(805938),j=e.i(883002),T=e.i(634669),E=e.i(44239),R=e.i(973580),I=function(e){var t=new Set(f.default),n=new Map,r=!0,i=!1,o=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done);r=!0){var l=(0,c._)(a.value,3),u=l[0],d=l[1],h=l[2];if(!t.has(u))throw Error("Symbol not supported by LSP client. Please add to the supported symbol icons array");n.set(u,[d,null!=h?h:p.tokens.foregroundDefault])}}catch(e){i=!0,o=e}finally{try{r||null==s.return||s.return()}finally{if(i)throw o}}return n}([[d.SymbolKind.Array,j.default],[d.SymbolKind.Boolean,S.default],[d.SymbolKind.Class,g.default,p.tokens.yellowDefault],[d.SymbolKind.Constant,m.default,p.tokens.blueStronger],[d.SymbolKind.Constructor,w.default,p.tokens.blurpleDefault],[d.SymbolKind.Enum,y.default,p.tokens.orangeDefault],[d.SymbolKind.EnumMember,R.default,p.tokens.blueStronger],[d.SymbolKind.Event,h.default],[d.SymbolKind.Field,E.default],[d.SymbolKind.File,b.default],[d.SymbolKind.Function,w.default,p.tokens.blurpleStronger],[d.SymbolKind.Interface,k.default,p.tokens.blueStronger],[d.SymbolKind.Key,_.default],[d.SymbolKind.Method,w.default,p.tokens.blurpleDefault],[d.SymbolKind.Module,T.default,p.tokens.purpleDefault],[d.SymbolKind.Namespace,x.default],[d.SymbolKind.Object,S.default,p.tokens.blueDimmer],[d.SymbolKind.Operator,S.default],[d.SymbolKind.Package,T.default,p.tokens.purpleDefault],[d.SymbolKind.Property,E.default],[d.SymbolKind.String,C.default],[d.SymbolKind.Struct,x.default],[d.SymbolKind.TypeParameter,R.default],[d.SymbolKind.Variable,R.default,p.tokens.blueStronger]]);function A(e){var n,r=e.kind,i=e.size,o=(0,c._)(null!=(n=I.get(r))?n:[S.default,p.tokens.foregroundDefault],2),a=o[0],s=o[1];return(0,t.jsx)(a,{color:s,size:void 0===i?16:i})}var P=e.i(858248),D=e.i(709485),O=e.i(878420),N=e.i(64386),M=e.i(674310),L=e.i(167768),B=e.i(483443),V=e.i(967629),F=e.i(754873),U=e.i(613355),G=e.i(625484),$=(0,V.css)([F.interactive.nofill,{transitionProperty:"background-color, box-shadow, opacity",opacity:.8,":focus":{zIndex:1,opacity:1}}]),z={button:(0,V.css)([U.rcss.reset.button,U.rcss.p(2),U.rcss.rowWithGap(4),U.rcss.align.center,$]),text:(0,V.css)({fontSize:p.tokens.fontSizeSmall})},H={opacity:1};function W(e){var r=e.icon,i=e.text,o=e.innerRef,a=e.ariaProps,s=e.active,l=(0,L.useButton)(a,o).buttonProps,u=(0,B.useHover)({}),c=u.hoverProps,d=u.isHovered;return(0,t.jsxs)(G.View,(0,N._)((0,O._)({tag:"button",css:z.button,style:d||s?H:void 0,innerRef:o},(0,M.mergeProps)(l,c)),{children:[r?(0,n.cloneElement)(r,{size:12}):null,(0,t.jsx)(G.View,{css:z.text,children:i})]}))}var q={root:(0,V.css)([U.rcss.p(4),U.rcss.rowWithGap(4),U.rcss.align.center]),text:(0,V.css)([U.rcss.truncate,U.rcss.flex.growAndShrink(1),{fontSize:p.tokens.fontSizeDefault}])};function K(e){return(0,t.jsxs)(G.View,{css:[q.root],children:[e.icon?(0,n.cloneElement)(e.icon,{size:16}):null,(0,t.jsx)(G.View,{css:q.text,children:e.text})]})}var Y=e.i(346715),Q=e.i(643694),X=e.i(624549),J=e.i(580347),Z=(0,V.css)([U.rcss.p(4)]);function ee(e){var r=e.items,i=e.children,o=e.menuProps,a=e.selectedKeys,s=e.onAction,l=(0,Q.useTreeState)({items:r,children:i,selectedKeys:a,selectionMode:"single"}),u=(0,n.useRef)(null),c=(0,X.useMenu)((0,O._)({items:r,onAction:s},o),l,u);return(0,t.jsx)(G.View,(0,N._)((0,O._)({},c.menuProps),{innerRef:u,css:Z,children:(0,Y._)(l.collection).map(function(e){return(0,t.jsx)(er,{item:e,state:l},e.key)})}))}var et={root:(0,V.css)([U.rcss.flex.row,U.rcss.align.center,U.rcss.position.relative,$]),selected:(0,V.css)([{opacity:1,backgroundColor:p.tokens.interactiveBackground}])},en={opacity:1};function er(e){var r=e.item,i=e.state,o=(0,n.useRef)(null),a=(0,J.useMenuItem)({key:r.key},i,o),s=a.menuItemProps,l=a.isSelected,u=(0,B.useHover)({}),c=u.hoverProps,d=u.isHovered;return(0,t.jsx)(G.View,(0,N._)((0,O._)({innerRef:o,css:[et.root,l&&et.selected],style:d||l?en:void 0},(0,M.mergeProps)(s,c)),{children:r.rendered}))}var ei=e.i(178085),eo=e.i(342942),ea=e.i(771397),es=e.i(600962),el=e.i(929872),eu={underlay:(0,V.css)([U.rcss.coverContainer,U.rcss.position.fixed]),surface:(0,V.css)([U.rcss.borderRadius(8),{boxShadow:p.tokens.shadow2,border:"1px solid",borderColor:p.tokens.backgroundHighest}])};function ec(e){var n=e.state,r=e.triggerRef,i=e.placement,o=e.children,a=(0,c._)((0,es.default)("Popover"),2),s=a[0],l=a[1],u=(0,ea.usePopover)({placement:i,triggerRef:r,popoverRef:s,offset:8},n),d=u.popoverProps,f=u.underlayProps;return(0,t.jsxs)(eo.Overlay,{children:[(0,t.jsx)(G.View,(0,N._)((0,O._)({},f),{css:eu.underlay})),(0,t.jsxs)(el.Surface,(0,N._)((0,O._)({elevated:!0,css:eu.surface,innerRef:l},d),{children:[(0,t.jsx)(ei.DismissButton,{onDismiss:n.close}),o,(0,t.jsx)(ei.DismissButton,{onDismiss:n.close})]}))]})}var ed=e.i(782096);function ef(e){return CSS.escape(e.name)}function ep(e){var r=e.selectedSymbol,i=e.symbols,o=e.moveCursor,a=e.icon,c=e.text,d=(0,l.useMenuTriggerState)({onOpenChange:function(e){e&&(0,P.track)(D.events.CODE_NAVIGATION_USED,{action:"opened"})}}),f=(0,n.useRef)(null),p=(0,u.useMenuTrigger)({},d,f),h=p.menuTriggerProps,g=p.menuProps,m=r?new Set([r.name]):void 0;return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(W,{text:c,icon:a,innerRef:f,ariaProps:h,active:d.isOpen}),d.isOpen?(0,t.jsx)(ec,{triggerRef:f,state:d,placement:"bottom left",children:(0,t.jsx)(ee,{menuProps:g,items:i,selectedKeys:m,onAction:function(e){var t=i.find(function(t){return ef(t)===e});t&&(o(t.selectionRange.start),(0,P.track)(D.events.CODE_NAVIGATION_USED,{action:"jumped"}))},children:function(e){return(0,t.jsx)(s.Item,{children:(0,t.jsx)(K,{icon:(0,t.jsx)(A,{kind:e.kind}),text:e.name})},ef(e))}})}):null]})}var eh=(0,n.memo)(function(e){var r=e.symbols,i=e.symbolsPath,o=e.moveCursor,a=i.length?i[i.length-1]:null,s=a?a.children:r;return(0,t.jsxs)(t.Fragment,{children:[i.map(function(e,a){var s=0===a?r:i[a-1].children;return s?(0,t.jsxs)(n.Fragment,{children:[(0,t.jsx)(ed.default,{size:12}),(0,t.jsx)(ep,{symbols:s,icon:(0,t.jsx)(A,{size:12,kind:e.kind}),text:e.name,selectedSymbol:e,moveCursor:o})]},ef(e)):null}),(null==s?void 0:s.length)?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(ed.default,{size:12}),(0,t.jsx)(ep,{symbols:s,text:"...",moveCursor:o})]}):null]})}),eg=(0,n.memo)(function(e){var s,l=e.view,u=(0,n.useCallback)(function(e){null==l||l.dispatch({scrollIntoView:!0,selection:r.EditorSelection.cursor((0,a.posToOffset)(l.state.doc,e))}),null==l||l.focus()},[l]),c=(0,n.useDeferredValue)({symbols:(0,o.useCodeMirrorValue)(l,i.documentSymbols),symbolsPath:(0,o.useCodeMirrorValue)(l,i.symbolsPath)});return(null==(s=c.symbols)?void 0:s.length)?(0,t.jsx)(eh,{symbols:c.symbols,symbolsPath:c.symbolsPath||[],moveCursor:u}):null});e.s(["CodeNav",()=>eg],484035)},62424,440416,406948,394205,e=>{"use strict";var t=e.i(878420),n=e.i(886513),r=e.i(276385),i=e.i(389959);e.i(440545);var o=e.i(214705),a=e.i(915599),s=e.i(484035),l=e.i(703613),u=e.i(205104),c=e.i(144619),d=e.i(827759),f=e.i(406206),p=e.i(564169);e.i(545082);var h=e.i(91442),g=e.i(959406),m=e.i(841691),x=e.i(525212),y=e.i(940745),b=(0,i.memo)(function(e){var t=e.path,n=e.performPaneOperation,o=e.isReadOnly,a=(0,p.useCodeEditorView)(),l=(0,i.useCallback)(function(e){n({operation:"open",pane:(0,g.getPaneForFile)(e)})},[n]);return(0,r.jsxs)(d.Header,{children:[(0,r.jsx)(d.HeaderLeft,{children:(0,r.jsx)(c.FileBreadcrumbs,{path:t,onFileClick:l,children:(0,r.jsx)(s.CodeNav,{view:a})})}),(0,r.jsx)(d.HeaderRight,{children:(0,r.jsx)(w,{path:t,performPaneOperation:n,isReadOnly:o})})]})});function w(e){return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(k,(0,t._)({},e)),(0,r.jsx)(_,(0,t._)({},e)),(0,r.jsx)(S,(0,t._)({},e)),(0,r.jsx)(C,(0,t._)({},e))]})}function k(e){var t=e.path,i=(0,n._)(e,["path"]),s=(0,p.useCodeEditorView)(),c=(0,l.useCodeMirrorValue)(s,a.IsFormatting),d=(0,l.useCodeMirrorValue)(s,a.HasFormatter),h=c||i.isReadOnly,g=i.isReadOnly?"This action is disabled while the agent is working":void 0;return d&&s?(0,r.jsx)(f.PaneHeaderActionButton,{dataCy:"ws-format-btn",altText:"Format "+(0,u.getFileName)(t),buttonText:"Format",disabled:h,disabledTooltip:g,"aria-disabled":!!h||void 0,icon:c?(0,r.jsx)(y.default,{}):(0,r.jsx)(x.default,{}),onClick:function(){c||(0,o.FormatCommand)(s)}}):null}function _(e){var t=e.path,n=e.performPaneOperation;return(0,u.isMarkdownFile)(t)?(0,r.jsx)(f.PaneHeaderActionButton,{altText:"Preview "+(0,u.getFileName)(t),buttonText:"Preview",icon:(0,r.jsx)(m.default,{}),onClick:function(){n({operation:"replace",pane:{type:"markdown",data:{path:t}}})}}):null}function S(e){var t=e.path,n=e.performPaneOperation;return(0,u.isSVGFile)(t)?(0,r.jsx)(f.PaneHeaderActionButton,{altText:"Preview "+(0,u.getFileName)(t),buttonText:"Preview",icon:(0,r.jsx)(m.default,{}),onClick:function(){n({operation:"replace",pane:{type:"media",data:{path:t}}})}}):null}function C(e){var t=e.path,n=e.performPaneOperation,i=(0,h.useGetCursorState)();return(0,u.isCsvFile)(t)?(0,r.jsx)(f.PaneHeaderActionButton,{altText:"Toggle Preview",buttonText:"Preview",icon:(0,r.jsx)(m.default,{}),onClick:function(){var e=i();n({operation:"replace",pane:{type:"csvPreview",data:{path:t,line:null==e?void 0:e.position.line}}})}}):null}e.s(["CodeEditorHeader",()=>b,"FileActions",()=>w],62424);var j=e.i(179302),T=e.i(446749),E=e.i(700170),R=new E.ReactCompartment(function(e){return e?j.EditorView.domEventObservers({keydown:function(e,t){(0,T.showMessageTooltip)(t,{message:"Editing is disabled while the agent is working",offset:t.state.selection.main.from,ignoreKeydown:!0})}}):null});e.s(["DisabledWhileAgentWorking",()=>R],440416);var I=e.i(858248),A=e.i(709485),P=e.i(541793),D=e.i(852819),O=(0,P.atom)(!1),N=new E.ReactCompartment(function(e){var t=e.analyticsSurface,n=e.shouldTrack,r=e.onPaste;return j.EditorView.domEventHandlers({paste:function(){n&&(0,I.track)(A.events.TEXT_PASTED,{surface:t}),null==r||r()}})});function M(e){var t=e.analyticsSurface,n=(0,D.useValue)(O),r=(0,D.useSet)(O);return N.use({analyticsSurface:t,shouldTrack:!n,onPaste:function(){return r(!0)}})}e.s(["TrackPasteCompartment",()=>N,"useTrackFirstPasteExtension",()=>M],406948);var L=e.i(904851),B=e.i(90659),V=e.i(721281),F=e.i(346715),U=e.i(88125),G=e.i(753950);e.i(508987);var $=e.i(457103),z=e.i(480028),H="".concat('url(\'data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20"><circle cx="10" cy="10" r="10" fill="black" /></svg>\')',", linear-gradient(transparent, transparent)"),W="".concat('url(\'data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20"><path stroke="black" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" fill="none" d="M2.5 10H15.5M15.5 10L9.5 5M15.5 10L9.5 15M18 4V16"/></svg>\')',", linear-gradient(transparent, transparent)"),q=j.EditorView.theme({".cm-vws-space":{backgroundColor:z.tokens.foregroundDimmest,maskImage:H,maskSize:"0.375ch",maskPosition:"center",maskRepeat:"no-repeat","-webkit-mask-image":H,"-webkit-mask-size":"0.375ch","-webkit-mask-position":"center","-webkit-mask-repeat":"no-repeat","&.cm-vws-leading":{opacity:.325},"&.cm-vws-enclosed":{opacity:.5},"&.cm-vws-trailing":{opacity:.5},"&.cm-vws-selected":{opacity:.75}},".cm-vws-tab":{backgroundColor:z.tokens.foregroundDimmest,maskImage:W,maskSize:"1.75ch 1.75ch",maskPosition:"center",maskRepeat:"no-repeat","-webkit-mask-image":W,"-webkit-mask-size":"1.75ch 1.75ch","-webkit-mask-position":"center","-webkit-mask-repeat":"no-repeat","&.cm-vws-leading":{opacity:.325,maskPosition:"left min(95%, 0.25ch) top 50%","-webkit-mask-position":"left min(95%, 0.25ch) top 50%"},"&.cm-vws-enclosed, &.cm-vws-trailing":{opacity:.5,maskPosition:"calc(50% - 0.25ch) 50%","-webkit-mask-position":"calc(50% - 0.25ch) 50%"},"&.cm-vws-selected":{opacity:.75}}}),K=(0,U.default)(function(e,t,n){var r="cm-vws-".concat(" "===e?"space":"tab"," cm-vws-").concat(t).concat(n?" cm-vws-selected":"");return j.Decoration.mark({class:r})},function(e,t,n){return"".concat(e,"-").concat(t,"-").concat(n)});function Y(e,t,n){var r=e.facet(J);if(!r.leading&&!r.enclosed&&!r.trailing&&!r.selected)return[];for(var i=[],o=e.doc.lineAt(t),a=e.doc.lineAt(n),s=o.number;s<=a.number;s++)!function(o){var a=e.doc.line(o),s=a.text.length;if(0===s)return;var l=0===a.text.trim().length,u=!!r.selected&&e.selection.ranges.some(function(e){return!e.empty&&e.from<a.to&&e.to>=a.from});if(r.leading||r.enclosed||r.trailing||u){if(l){if(r.leading||r.trailing||u)for(var c=0;c<s;c++)!function(o){var s=a.text[o],l=a.from+o;if(!(l<t)&&!(l>=n)&&(" "===s||"	"===s)){var c=u&&e.selection.ranges.some(function(e){return e.from<=l&&e.to>l});(r.leading||r.trailing||c)&&i.push(K(s,"trailing",c).range(l,l+1))}}(c);return}for(var d=s-a.text.trimStart().length,f=a.text.trim().length,p=0;p<s;p++)!function(o){var s=a.text[o],l=a.from+o;if(!(l<t)&&!(l>=n)&&(" "===s||"	"===s)){var c=void 0;c=o>=d+f?"trailing":o>d?"enclosed":"leading";var p=u&&e.selection.ranges.some(function(e){return e.from<=l&&e.to>l});(r[c]||p)&&i.push(K(s,c,p).range(l,l+1))}}(p)}}(s);return i}var Q=function(){function e(t){(0,L._)(this,e),(0,V._)(this,"decorations",void 0),this.decorations=j.Decoration.set(Y(t.state,0,t.state.doc.length))}return(0,B._)(e,[{key:"update",value:function(e){if((0,$.hasChanged)(e,J)){this.decorations=j.Decoration.set(Y(e.state,0,e.state.doc.length));return}var t=e.state.facet(J);if(e.docChanged||e.selectionSet&&t.selected){var n=this.decorations,r=null,i=null;if(e.selectionSet&&t.selected){var o=e.startState.selection.ranges.filter(function(e){return!e.empty}),a=(0,F._)(e.state.selection.ranges).concat((0,F._)(e.startState.selection.map(e.changes).ranges)).filter(function(e){return!e.empty});o.length&&(r=G.EditorSelection.create(o)),a.length&&(i=G.EditorSelection.create(a))}if(e.docChanged&&e.changes.iterChangedRanges(function(t,n,o,a){var s=G.EditorSelection.range(e.startState.doc.lineAt(t).from,e.startState.doc.lineAt(n).to);r=r?r.addRange(s):G.EditorSelection.create([s]);var l=G.EditorSelection.range(e.state.doc.lineAt(o).from,e.state.doc.lineAt(a).to);i=i?i.addRange(l):G.EditorSelection.create([l])}),r){var s=r.ranges;n=n.update({filter:function(e,t){return!s.some(function(n){return n.from<=e&&n.to>=t})},filterFrom:s[0].from,filterTo:s[s.length-1].to})}e.docChanged&&(n=n.map(e.changes)),i&&(n=n.update({add:i.ranges.map(function(t){return Y(e.state,t.from,t.to)}).flat()})),this.decorations=n}}}]),e}(),X=j.ViewPlugin.fromClass(Q,{decorations:function(e){return e.decorations}}),J=G.Facet.define({combine:function(e){var t;return null!=(t=e[0])?t:{}},enables:[q,G.Prec.highest(X)]}),Z=new E.ReactCompartment(function(e,t,n,r){return e||t||n||r?J.of({leading:e,enclosed:t,trailing:n,selected:r}):null});e.s(["VisibleWhitespaceCompartment",()=>Z],394205)},654360,179147,424719,288209,385164,166978,211664,180182,260171,588561,378294,425807,977200,801573,61211,e=>{"use strict";var t,n=e.i(297083),r=e.i(878420),i=e.i(64386),o=e.i(346715),a=e.i(817556),s=e.i(753950),l=e.i(204179),u=e.i(502379),c=e.i(700170);e.i(694906);var d=e.i(627720),f=e.i(626430),p=e.i(843754),h=e.i(61524),g=e.i(570271),m=e.i(256969),x=e.i(141665),y=e.i(485237),b=e.i(530658),w=e.i(389959),k=e.i(522682);function _(e){var t=(0,b._)((0,w.useState)(null),2),n=t[0],r=t[1];return(0,w.useEffect)(function(){var t=function(){r((0,m.mergeLSPServerCapabilities)(e.map(function(e){return(0,m.default)(e)})))};return t(),(0,k.combineDisposables)(e.map(function(e){return e.onServerCapabilitiesChange(function(){return t()})}))},[e]),n}e.s(["default",()=>_],179147);var S=e.i(529810);function C(e){var t=(0,S.default)().container,n=(0,g.useToolchainConfigs)(),r=(0,h.usePreferences)("codeIntelligence").preferences,i=(0,y.default)(e.filePath),o=_(i);return j.use(n,t,i,o,r.codeIntelligence,e.filePath)}var j=new c.ReactCompartment(function(e,t,c,h,g,y){return e?e.formatters.map(function(e){var b;if(2===(b=e.id.split("/")).length&&b[1].includes("languageServer")){var w,k,_,S,C=c.find(function(t){return t.clientId===e.id});return C?(w=y,k=C,_=h,S=g,k&&k.isSupportedFile(w)&&_&&_.isFormatSupported&&(0,m.default)(k).isFormatSupported&&S?l.FormatProvider.of({format:function(e,t,r){return(0,n._)(function(){return(0,a._)(this,function(n){return[2,(t?k.request.formatRange(w,(0,u.selectionToRange)(e,t),r):k.request.format(w,r)).then(function(t){return"error"in t||t.cancelled?{error:!0}:t.result?{result:(0,x.default)(t.result,e.toString())}:{result:s.ChangeSet.empty(e.length)}})]})})()},supportsRangeFormatting:(0,m.default)(k).isFormatRangeSupported,identifier:k.clientId,name:k.clientName}):[]):[]}return(0,d.isFileSupported)(y,e)?l.FormatProvider.of({format:function(s,l,u){return(0,n._)(function(){var n,c,d,h,g;return(0,a._)(this,function(a){switch(a.label){case 0:if(!e.startCommand)throw Error("Expected formatter command");return n=(0,p.default)({container:t}),(c=(0,o._)(e.startCommand.args)).push("-f",y),l&&(c.push("--range-start",String(l.main.from)),c.push("--range-end",String(l.main.to))),c.push("--tab-size",String(u.tabSize)),u.insertSpaces&&c.push("--insert-spaces"),u.trimFinalNewlines&&c.push("--trim-final-newlines"),u.trimTrailingWhitespace&&c.push("--trim-trailing-whitespace"),u.insertFinalNewline&&c.push("--insert-final-newline"),e.startCommand.lifecycle===f.api.Exec.Lifecycle.STDIN&&c.push("--stdin"),d="",h="",g=[n.onOutput(function(e){return d+=e}),n.onStderr(function(e){return h+=e}),n.dispose],[4,n.request((0,i._)((0,r._)({},e.startCommand),{args:c,lifecycle:f.api.Exec.Lifecycle.STDIN,stdin:s.toString()})).then(function(e){var t=e.error;return g.forEach(function(e){return e()}),t?{error:!0,message:h}:{result:d}})];case 1:return[2,a.sent()]}})})()},supportsRangeFormatting:e.supportsRangeFormatting,identifier:e.id,name:e.name}):null}).filter(Boolean):null});e.s(["useFormattingProviders",()=>C],654360);var T=e.i(904851),E=e.i(90659),R=e.i(721281);function I(e){return JSON.stringify({text:e})+"\n"}var A=function(){function e(){(0,T._)(this,e),(0,R._)(this,"list",[])}return(0,E._)(e,[{key:"add",value:function(e,t,n){this.list.push({prefix:e,suggestion:t,tokens:n}),this.list.length>25&&this.list.pop(),this.list.sort(function(e,t){return t.suggestion.length-e.suggestion.length})}},{key:"retrieve",value:function(e,t){for(var n=0;n<this.list.length;n++){var r=this.list[n],i=r.prefix,o=r.suggestion,a=r.tokens;if(2*a<t)continue;if(e===i)return I(o);if(i.length>e.length||i.length+o.length<=e.length||2*Math.floor((i.length+o.length-e.length)/(o.length/a))<t)continue;var s=o.lastIndexOf("\n");if(-1===s||!(s<=e.length-i.length)){var l=i+o;if(l.startsWith(e)){var u=l.slice(e.length);if(u.trim().length)return I(u)}}}return null}}]),e}();e.s(["SuggestionCache",()=>A],424719);var P=e.i(179302),D=e.i(167626),O=e.i(72158),N=e.i(488566),M=s.Facet.define({combine:function(e){var t=e.filter(Boolean);return{onDismiss:function(e){return t.forEach(function(t){var n;return null==(n=t.onDismiss)?void 0:n.call(t,e)})},onRequestIgnoredBackendOnly:function(e){return t.forEach(function(t){var n;return null==(n=t.onRequestIgnoredBackendOnly)?void 0:n.call(t,e)})},onRequestFirstEmit:function(e){return t.forEach(function(t){var n;return null==(n=t.onRequestFirstEmit)?void 0:n.call(t,e)})},onRequestEndedWithNoSuggestion:function(e){return t.forEach(function(t){var n;return null==(n=t.onRequestEndedWithNoSuggestion)?void 0:n.call(t,e)})},onRequestCompletelyPresented:function(e){return t.forEach(function(t){var n;return null==(n=t.onRequestCompletelyPresented)?void 0:n.call(t,e)})},onSuggestionExplicitlyDismissed:function(e,n){return t.forEach(function(t){var r;return null==(r=t.onSuggestionExplicitlyDismissed)?void 0:r.call(t,e,n)})},onSuggestionAccepted:function(e,n){return t.forEach(function(t){var r;return null==(r=t.onSuggestionAccepted)?void 0:r.call(t,e,n)})}}}});e.s(["CompleteCodeListeners",()=>M],288209);var L=e.i(240849),B=e.i(938668),V=e.i(430636),F=e.i(963323),U=function(e){var t=e.state.field(L.CompleteCodeSuggestion,!1),n=e.state.facet(M);if(!(null==t?void 0:t.presented)||Date.now()-t.timestamp<150)return!1;var r=e.state.selection.main.head,i=e.state.doc.lineAt(r);if(r<=i.from+i.length-i.text.trimStart().length){var o=t.changes.closestRange(r);if((0,D._)(o.value,V.ProposedInsertion)){var a=o.value.unfulfilled.toString(),s=(0,F.numColumns)(a,e.state.tabSize);if(s>0&&s>=e.state.tabSize)return!1}}var l=t.changes.asChangeSpec(),u=e.state.changes(l),c=t.changes.extendSelection(e.state.selection);return(0,O.closeCompletion)(e),e.dispatch({changes:u,selection:c,scrollIntoView:!0,effects:L.setCompleteCodeSuggestion.of(t.dismiss(L.DismissalReason.ACCEPTED_BY_USER)),annotations:[B.default.of(!0),N.isolateHistory.of("full")]}),n.onSuggestionAccepted(e,t),!0},G=function(e){var t=e.state.field(L.CompleteCodeSuggestion,!1),n=e.state.facet(M);return!!(null==t?void 0:t.presented)&&(e.dispatch({effects:L.setCompleteCodeSuggestion.of(t.dismiss(L.DismissalReason.DISMISSED_BY_USER))}),n.onSuggestionExplicitlyDismissed(e,t),!0)};e.s(["acceptCompleteCodeSuggestion",()=>U,"dismissCompleteCodeSuggestion",()=>G],385164);var $=s.Facet.define({combine:function(e){var t;return null!=(t=e.filter(Boolean)[0])?t:null}}),z=e.i(895477),H=e.i(305027),W=s.StateField.define({create:function(){return null},update:function(e,t){if(t.annotation(B.default)||!t.state.field(L.CompleteCodeSuggestion).stopped)return null;if(!t.docChanged&&!t.selection)return e;var n=t.newDoc,r=t.newSelection.main.head;return t.annotation(s.Transaction.remote)?null!==e&&(0,z.isValidRequestPosition)(n,r)&&(0,z.isOnEmptyLine)(n,r)?e:null:t.selection&&t.isUserEvent("select")?(0,z.isValidRequestPosition)(n,r)&&(0,z.isOnEmptyLine)(n,r)?Date.now():null:t.docChanged&&null!==e?(0,z.isValidRequestPosition)(n,r)&&(0,z.isOnEmptyLine)(n,r)?e:null:e}}),q=function(){function e(t){(0,T._)(this,e),(0,R._)(this,"view",void 0),(0,R._)(this,"timeout",void 0),this.view=t,this.timeout=null}return(0,E._)(e,[{key:"update",value:function(e){var t=this,n=e.startState.field(W),r=e.state.field(W);n!==r&&(null!==this.timeout&&(clearTimeout(this.timeout),this.timeout=null),null!==r&&(this.timeout=setTimeout(function(){t.timeout=null,t.view.dispatch({effects:[H.setCompleteCodeTrigger.of(H.Trigger.NOW)]})},2500)))}},{key:"destroy",value:function(){null!==this.timeout&&(clearTimeout(this.timeout),this.timeout=null)}}]),e}(),K=P.ViewPlugin.fromClass(q,{provide:function(){return W}}),Y=e.i(906368),Q=e.i(486701);e.i(508987);var X=e.i(457103),J=e.i(42512),Z=((t={})[t.SUFFIX=2]="SUFFIX",t[t.HIGH=1]="HIGH",t[t.NORMAL=0]="NORMAL",t[t.LOW=-1]="LOW",t),ee=s.Facet.define({combine:function(e){var t=e.filter(Boolean);return function(e){return t.map(function(t){return"function"==typeof t?t(e):t}).filter(Boolean).flat()}}}),et=function(){function e(t){if((0,T._)(this,e),(0,R._)(this,"priority",void 0),(0,R._)(this,"header",void 0),(0,R._)(this,"segments",void 0),(0,R._)(this,"accepted",void 0),(0,R._)(this,"curLength",void 0),(0,R._)(this,"maxLength",void 0),(0,R._)(this,"minLength",void 0),this.priority=null!=(n=t.priority)?n:Z.NORMAL,this.header=null!=(r=t.header)?r:"",this.segments=t.segments,this.accepted=0,this.curLength=0,this.segments.length){var n,r,i=this.header?this.header.length+1:0;this.maxLength=i+this.segments.reduce(function(e,t){return e+t.length},0),this.minLength=this.isSuffix?i+this.segments[0].length:i+this.segments[this.segments.length-1].length}else this.maxLength=0,this.minLength=0}return(0,E._)(e,[{key:"isSuffix",get:function(){return this.priority===Z.SUFFIX}},{key:"acceptSegment",value:function(e){if(this.accepted===this.segments.length)return 0;var t=this.isSuffix?this.segments[this.accepted]:this.segments[this.segments.length-this.accepted-1],n=0===this.accepted&&this.header?this.header.length+t.length+1:t.length;return n>e?0:(this.accepted++,this.curLength+=n,n)}},{key:"acceptAll",value:function(){this.accepted=this.segments.length,this.curLength=this.maxLength}},{key:"finalize",value:function(){return 0===this.accepted?null:(this.header?this.header+"\n":"")+(this.isSuffix?this.segments.slice(0,this.accepted).join("").trimEnd():this.segments.slice(this.segments.length-this.accepted).join("").trimEnd())}}],[{key:"acceptSegments",value:function(e,t){for(var n=t;t>0;){var r=!1,i=!0,o=!1,a=void 0;try{for(var s,l=e[Symbol.iterator]();!(i=(s=l.next()).done);i=!0){var u=s.value.acceptSegment(t);u&&(t-=u,r=!0)}}catch(e){o=!0,a=e}finally{try{i||null==l.return||l.return()}finally{if(o)throw a}}if(!r)break}return n-t}}]),e}(),en=function(){function e(t){(0,T._)(this,e),(0,R._)(this,"priority",void 0),(0,R._)(this,"chunks",void 0),(0,R._)(this,"size",void 0),this.priority=t,this.chunks=[],this.size=0}return(0,E._)(e,[{key:"accepted",get:function(){return this.chunks.reduce(function(e,t){return e+t.curLength},0)}},{key:"empty",get:function(){return 0===this.size}},{key:"add",value:function(e){this.chunks.push(e),this.size+=e.maxLength}},{key:"resize",value:function(e){if(e<this.accepted)throw Error("Cannot resize below already accepted");this.size=e}},{key:"accept",value:function(){et.acceptSegments(this.chunks,this.size-this.accepted)}}],[{key:"fromChunkViews",value:function(t){var n=[],r=new Map,i=!0,o=!1,a=void 0;try{for(var s,l=t[Symbol.iterator]();!(i=(s=l.next()).done);i=!0){var u=s.value,c=r.get(u.priority);c||(c=new e(u.priority),n.push(c),r.set(u.priority,c)),c.add(u)}}catch(e){o=!0,a=e}finally{try{i||null==l.return||l.return()}finally{if(o)throw a}}return n}}]),e}(),er=function(){function e(t,n){(0,T._)(this,e),(0,R._)(this,"cooldown",void 0),(0,R._)(this,"ignored",void 0),this.cooldown=t,this.ignored=n}return(0,E._)(e,[{key:"delay",value:function(t){return new e(Date.now()+t,this.ignored)}},{key:"ignore",value:function(t){return this.ignored!==t?new e(this.cooldown,t):this}},{key:"vent",value:function(){return null!==this.cooldown?new e(null,this.ignored):this}},{key:"clear",value:function(){return null!==this.cooldown||null!==this.ignored?new e(null,null):this}},{key:"cooling",get:function(){return null!==this.cooldown&&Date.now()<this.cooldown}},{key:"remaining",get:function(){return null!==this.cooldown?Math.max(0,this.cooldown-Date.now()):0}},{key:"tick",value:function(){return null!==this.cooldown&&Date.now()>this.cooldown?this.vent():this}},{key:"handle",value:function(e,t){switch(t.reason){case L.DismissalReason.FULLY_TYPED_INTO:case L.DismissalReason.ACCEPTED_BY_USER:return this.clear();case L.DismissalReason.DISMISSED_BY_USER:return this.delay(5e3).ignore(e.suggestion.content);case L.DismissalReason.INCOMPATIBLE_DOCUMENT_CHANGE:case L.DismissalReason.INCOMPATIBLE_CURSOR_CHANGE:return e.suggestion.ctx.onEmptyLine?this.delay(5e3):this.delay(1e3)}return this}},{key:"isIgnored",value:function(e){return null!==this.ignored&&function(e,t){for(var n=Math.max(e.length,t.length),r=0,i=0;i<n;i++)e[i]!==t[i]&&r++;return 1-r/n}(this.ignored,e)>=.8}}]),e}(),ei=s.Facet.define({combine:function(e){return!e.length||e[0]}}),eo=s.StateField.define({create:function(){return new er(null,null)},update:function(e,t){if(!t.state.facet(ei)||(e=e.tick()).cooling)return e;var n=t.startState.field(L.CompleteCodeSuggestion,!1),r=t.state.field(L.CompleteCodeSuggestion,!1);return n&&r&&n.presented&&r.stopped?e.handle(n,r):e}});e.s(["CompleteCodeRegulator",()=>eo,"CompleteCodeRegulatorEnabled",()=>ei],166978);var ea=e.i(394212);e.i(33699);var es=e.i(754686),el=["o17pu","o1gpu","ovgpu","ovgpure","ovgpuref","ovgpurf","ovgpuva","ovgpuvat","o!gpu","pnzfyhg","pnzjuber","puvap","puvax","pbba","pbbaf","phaavr","phag","phagsnpr","phagubyr","phagyvpx","phagyvpx","phagyvpxre","phagyvpxre","phagyvpxvat","phagyvpxvat","phagent","phagf","qnexvr","qngr encr","qngrencr","snt","sntont","sntt","snttvat","snttvg","snttvgg","snttbg","snttf","sntbg","sntbgf","sntf","sntgneq","sngnff","shpxgneq","shpxgneqf","tnat onat","tnatonat","tnatonatrq","tnatonatrq","tnatonatf","tnlgneq","tnljnq","tbngpk","tbngfr","tevatb","ubne","ubner","ubre","ubbxre","wnvy onvg","wnvyonvg","wnc","wvtnobb","wvttnobb","wvttreobb","xhag","y3v+pu","y3vgpu","yrzba cnegl","ybyvgn","a1ttn","a1ttre","anzoyn","arteb","avtt3e","avtt4u","avttn","avttnu","avttnf","avttnm","avttre","avttref","avtyrg","avt abt","dhrreonvg","dhrreubyr","encr","encvat","encvfg","ergneq","ehfxv","furznyr","fubgn","fxnax","fyhg","fyhgont","fyhgf","jrgonpx","juvgr cbjre","juber"],eu=el.reduce(function(e,t){return Math.max(e,t.length)},0),ec=new RegExp("(?:\\w+[^\\S\\n]*)?\\w*[^]{".concat(eu,"}$")),ed=null,ef=function(){function e(t){var n=this;(0,T._)(this,e),(0,R._)(this,"finished",void 0),(0,R._)(this,"config",void 0),(0,R._)(this,"abortController",void 0),(0,R._)(this,"suggestion",void 0),(0,R._)(this,"promise",void 0),this.config=t,this.finished=!1,this.abortController=new AbortController,this.suggestion="",this.promise=this.start(),this.abortController.signal.addEventListener("abort",function(){if(!n.finished){var e,t;n.finished=!0,null==(e=(t=n.config).onFinished)||e.call(t,null)}})}return(0,E._)(e,[{key:"start",value:function(){return(0,n._)(function(){var e,t,n,r,i,o,s,l,u,c,d,f,p,h,g,m,x,y,b;return(0,a._)(this,function(a){switch(a.label){case 0:a.trys.push([0,13,,14]),n=this.config.prefix.toString(),o=this.config.request({prefix:n,suffix:null!=(r=this.config.suffix)?r:void 0,header:null!=(i=this.config.header)?i:void 0,language:this.config.language,maxTokens:this.config.maxTokens,signal:this.abortController.signal}),s=!0,l=!1,u=!1,a.label=1;case 1:a.trys.push([1,6,7,12]),d=(0,ea._)(o),a.label=2;case 2:return[4,d.next()];case 3:if(!(l=!(f=a.sent()).done))return[3,5];if(function(e,t){if(t){var n,r;"string"!=typeof t&&(t=t.sliceString(Math.max(0,t.length-2*eu))),e=(null!=(r=null==(n=t.match(ec))?void 0:n[0])?r:t)+e}if(null===ed){var i=el.map(function(e){return e.replace(/[a-zA-Z]/g,function(e){return String.fromCharCode(e.charCodeAt(0)+("n">e.toLowerCase()?13:-13))})}).map(function(e){return(0,es.default)(e.toLowerCase().trim())}).sort(function(e,t){return t.length-e.length}).join("|"),o="\\b|\\d|_";ed=RegExp("(?:".concat(o,")(?:").concat(i,")(?:").concat(o,")"),"i")}return ed.test(e)}(p=f.value,s?n:this.suggestion))return this.abort(),null==(h=(g=this.config).onError)||h.call(g,Error("Slur detected in output")),[3,5];if(this.suggestion+=p,this.config.onTextReceived&&!1===this.config.onTextReceived(this.suggestion,s))return this.abort(),[3,5];s=!1,a.label=4;case 4:return l=!1,[3,2];case 5:return[3,12];case 6:return m=a.sent(),u=!0,c=m,[3,12];case 7:if(a.trys.push([7,,10,11]),!(l&&null!=d.return))return[3,9];return[4,d.return()];case 8:a.sent(),a.label=9;case 9:return[3,11];case 10:if(u)throw c;return[7];case 11:return[7];case 12:return[3,14];case 13:return x=a.sent(),this.aborted||this.abort(),(0,D._)(x,DOMException)&&"AbortError"===x.name||null==(y=(b=this.config).onError)||y.call(b,x),[3,14];case 14:if(this.aborted)return[2,null];return this.finished=!0,null==(e=(t=this.config).onFinished)||e.call(t,this.suggestion),[2,this.suggestion]}})}).call(this)}},{key:"aborted",get:function(){return this.abortController.signal.aborted}},{key:"abort",value:function(){this.aborted||this.abortController.abort()}},{key:"then",value:function(e,t){return this.promise.then(e,t)}}]),e}(),ep=e.i(537804),eh=e.i(680118),eg=e.i(328751),em=function(){function e(t,n,r,i,o){(0,T._)(this,e),(0,R._)(this,"text",void 0),(0,R._)(this,"pos",void 0),(0,R._)(this,"docA",void 0),(0,R._)(this,"treeA",void 0),(0,R._)(this,"parser",void 0),(0,R._)(this,"reuseData",void 0),(0,R._)(this,"_line",void 0),(0,R._)(this,"_onEmptyLine",void 0),(0,R._)(this,"_changesAtoB",void 0),(0,R._)(this,"_docB",void 0),(0,R._)(this,"_treeB",void 0),(0,R._)(this,"_blockA",void 0),(0,R._)(this,"_blockB",void 0),(0,R._)(this,"_inEmptyBlock",void 0),this.text=t,this.pos=n,this.docA=r,this.treeA=i,this.parser=o}return(0,E._)(e,[{key:"line",get:function(){return void 0===this._line&&(this._line=this.docA.lineAt(this.pos)),this._line}},{key:"onEmptyLine",get:function(){return void 0===this._onEmptyLine&&(this._onEmptyLine=(0,z.isEmpty)(this.line)),this._onEmptyLine}},{key:"changesAtoB",get:function(){return void 0===this._changesAtoB&&(this._changesAtoB=s.ChangeSet.of({from:this.pos,to:this.docA.length,insert:this.text},this.docA.length)),this._changesAtoB}},{key:"docB",get:function(){return void 0===this._docB&&(this._docB=this.reuseData?this.reuseData.diff.apply(this.reuseData.docB):this.changesAtoB.apply(this.docA)),this._docB}},{key:"treeB",get:function(){return void 0===this._treeB&&(this.treeA&&this.parser?this.reuseData?this._treeB=(0,eh.getIncrementallyParsedTree)({parser:this.parser,changes:this.reuseData.diff,text:this.docB,base:this.reuseData.treeB}):this._treeB=(0,eh.getIncrementallyParsedTree)({parser:this.parser,changes:this.changesAtoB,text:this.docB,base:this.treeA}):this._treeB=null),this._treeB}},{key:"inEmptyBlock",get:function(){return void 0===this._inEmptyBlock&&(this._inEmptyBlock=!!this.treeA&&(0,ep.isInEmptyBlock)(this.docA,this.treeA,this.pos)),this._inEmptyBlock}},{key:"blockA",get:function(){return void 0===this._blockA&&(this._blockA=this.treeA?(0,ep.getContainingBlock)(this.treeA,this.pos):null),this._blockA}},{key:"blockB",get:function(){return void 0===this._blockB&&(this._blockB=this.treeB?(0,ep.getContainingBlock)(this.treeB,this.pos):null),this._blockB}},{key:"hasTree",value:function(){return null!==this.parser&&null!==this.treeA}},{key:"update",value:function(t){var n=this,r=new e(t,this.pos,this.docA,this.treeA,this.parser);if(r._line=this._line,r._onEmptyLine=this._onEmptyLine,r._inEmptyBlock=this._inEmptyBlock,r._blockA=this._blockA,this.parser&&this.treeA&&(this.reuseData||this._treeB)){var i=(0,eg.changeSetFromDiff)(this.text,t),o=[];i.iterChanges(function(e,t,r,i,a){o.push({from:n.pos+e,to:n.pos+t,insert:a})});var a=s.ChangeSet.of(o,this.docB.length);this.reuseData&&!this._treeB?r.reuseData={diff:this.reuseData.diff.compose(a),docB:this.reuseData.docB,treeB:this.reuseData.treeB}:this._treeB&&(r.reuseData={diff:a,docB:this.docB,treeB:this._treeB})}return r}}]),e}(),ev=e.i(873753);function ex(e,t,n){var r,i=null!=(r=e.prop(t<0?ev.NodeProp.openedBy:ev.NodeProp.closedBy))?r:null;if(null===i||n&&!i.includes(n.name))if(!n)return null;else i=i?(0,o._)(i).concat([n.name]):[n.name];return i}function ey(e,t,n){var r=ex(e.type,t,n);if(null===r)return null;for(var i=e.cursor(),o=0;t<0?i.prevSibling():i.nextSibling();){if(0===o&&i.from!==i.to&&r.includes(i.name))return i.node;if(null!==ex(i.type,t)){o++;continue}if(null!==ex(i.type,-t)){if(0===o)return null;o--}}return null}var eb=/[([{]+(?=\s*$)/,ew=function(){function e(t,n,r,i,o){(0,T._)(this,e),(0,R._)(this,"source",void 0),(0,R._)(this,"pos",void 0),(0,R._)(this,"newlines",void 0),(0,R._)(this,"content",void 0),(0,R._)(this,"ctx",void 0),(0,R._)(this,"empty",void 0),(0,R._)(this,"text",void 0),(0,R._)(this,"lines",void 0),(0,R._)(this,"_segments",void 0),(0,R._)(this,"_insertions",void 0),this.source=t,this.pos=n,this.newlines=r,this.content=i,this.ctx=o,this.empty=(0,z.isEmpty)(i),this.text=this.empty?"":r+i,this.lines=(0,z.splitLines)(i)}return(0,E._)(e,[{key:"segments",get:function(){if(void 0===this._segments){if(this.ctx.hasTree()){var e=function(e){var t=function(e){var t,n,r,i,o=e.insertion,a=e.pos;if("doc"in e){var l=e.parser;t=e.doc,n=e.tree;var u=s.ChangeSet.of({from:a,to:t.length,insert:o},t.length);r=u.apply(t),i=(0,eh.getIncrementallyParsedTree)({parser:l,changes:u,text:r,base:n})}else t=e.docA,n=e.treeA,r=e.docB,i=e.treeB;return{insertion:o,pos:a,docA:t,treeA:n,docB:r,treeB:i}}(e),n=t.insertion,r=t.pos,i=t.docA,o=t.treeA,a=t.docB,l=t.treeB,u=[],c=[],d=l.cursor();do{if(null===ex(d.type,-1))continue;var f=d.node,p=ey(f,-1);if(p&&p.to<=r){var h=function(e,t){for(var n=t.resolveInner(e.from,1).node;n&&n.from===e.from;){if(n.type===e.type)return n;n=n.parent}return null}(p,o);if(h){u.push({openA:h,closeB:f});var g=ey(h,1,f.type);g&&g.from>=r&&c.push(g)}}}while(d.prev()&&d.to>r)if(0===u.length||0===c.length)return null;var m=[],x=!0,y=!1,b=void 0;try{for(var w,k=u[Symbol.iterator]();!(x=(w=k.next()).done);x=!0){var _=w.value,S=_.openA,C=_.closeB,j=a.sliceString(C.from,C.to),T=ex(S.type,1,C.type);if(null===T)throw Error("Unexpected null matching types");for(var E=0;E<c.length;E++){var R=c[E];if(T.includes(R.name)&&i.sliceString(R.from,R.to)===j){c.splice(0,E+1),m.unshift({closeA:R,closeB:C});break}}}}catch(e){y=!0,b=e}finally{try{x||null==k.return||k.return()}finally{if(y)throw b}}if(0===m.length)return null;var I=[{text:n,pos:r,index:0,offset:0}],A=0,P=!0,D=!1,O=void 0;try{for(var N,M=m[Symbol.iterator]();!(P=(N=M.next()).done);P=!0){var L=N.value,B=L.closeA,V=L.closeB,F=I.pop();if(!F)throw Error("Unexpected empty split");var U=V.from-r,G=0;if(F.pos<B.from){for(var $=1;function(e,t,n,r){var i=e.sliceString(n,n+1);return i===t.sliceString(r,r+1)&&""===i.trim()}(i,a,B.from-$,V.from-$)&&B.from-$>=F.pos&&V.from-$>=r;)$++;G=$-1}U-=G;var z={text:n.slice(A,U),pos:F.pos,index:F.index,offset:F.offset},H={text:n.slice(U),pos:B.to,index:U,offset:B.to-B.from+G};A=U,I.push(z,H)}}catch(e){D=!0,O=e}finally{try{P||null==M.return||M.return()}finally{if(D)throw O}}return""===I[I.length-1].text&&I.pop(),I}({insertion:this.text,pos:this.pos,docA:this.ctx.docA,treeA:this.ctx.treeA,docB:this.ctx.docB,treeB:this.ctx.treeB});e&&(this._segments=e)}null!=this._segments||(this._segments=[{text:this.text,index:0,pos:this.pos,offset:0}])}return this._segments}},{key:"insertions",get:function(){if(void 0===this._insertions){var e=new s.RangeSetBuilder,t=!0,n=!1,r=void 0;try{for(var i,o=this.segments[Symbol.iterator]();!(t=(i=o.next()).done);t=!0){var a=i.value,l=s.Text.of((0,z.splitLines)(a.text)),u=new V.ProposedInsertion(l,a.offset);e.add(a.pos,a.pos,u)}}catch(e){n=!0,r=e}finally{try{t||null==o.return||o.return()}finally{if(n)throw r}}this._insertions=e.finish()}return this._insertions}},{key:"with",value:function(t){var n=this.source,r=this.content,i=this.newlines;if("source"in t&&void 0!==t.source){n=t.source;var o=(0,z.splitLeadingWhitespaceFiltered)(n);r=o.indentation+o.content,i=o.newlines}if("text"in t&&void 0!==t.text){var a=(0,z.splitLeadingWhitespaceFiltered)(t.text);r=a.indentation+a.content,i=a.newlines}"content"in t&&void 0!==t.content&&(r=t.content),"newlines"in t&&void 0!==t.newlines&&(i=t.newlines);var s=this;if(n!==this.source||r!==this.content||i!==this.newlines){var l=this.ctx.update((0,z.isEmpty)(r)?"":i+r);s=new e(n,this.pos,i,r,l)}return!s.empty&&t.process&&(s="boolean"==typeof t.process?s.process():s.process(t.process)),s}},{key:"slice",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return n?this.with({text:this.text.slice(e,t)}):this.with({content:this.content.slice(e,t)})}},{key:"splice",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=r?this.text:this.content,o=i.slice(0,e),a=i.slice(e+t);return r?this.with({text:o+n+a}):this.with({content:o+n+a})}},{key:"clip",value:function(e){var t=!0,n=!1,r=void 0;try{for(var i,o=this.segments[Symbol.iterator]();!(t=(i=o.next()).done);t=!0){var a=i.value;if(a.pos>=e)return this.slice(0,a.index+a.offset,!0)}}catch(e){n=!0,r=e}finally{try{t||null==o.return||o.return()}finally{if(n)throw r}}return this}},{key:"stopAtLine",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=t?this.newlines.length:0;if(e<0||e>this.lines.length+n)throw Error("Index out of range: "+e);if(t&&e<n)return this.with({text:this.newlines.slice(0,e)});for(var r=e-n;r<this.lines.length&&(0,z.isEndBracketGroup)(this.lines[r]);)r++;var i=this.lines.slice(0,r).join("\n");return this.with({content:i})}},{key:"trimEnd",value:function(){return this.with({content:this.content.trimEnd()})}},{key:"removeNewlinesIfOnEmptyLine",value:function(){return this.newlines&&this.ctx.onEmptyLine?this.with({newlines:""}):this}},{key:"cutSuggestion",value:function(){if(this.empty)return this;if((0,z.isEndBracketGroup)(this.lines[0])||!this.ctx.hasTree())return this.stopAtLine(1);var e=(0,ep.depthSplit)(this.ctx.treeB,this.pos);if(!e.length)return this.stopAtLine(1);var t=this.pos+this.lines[0].length,n=this.ctx.inEmptyBlock?e:e.filter(function(e){return e.from<=t}),r=n.length?n[n.length-1].to-this.pos:null;return(null!==r&&r<0&&(r=null),this.ctx.blockB&&this.ctx.blockB.node.from<this.pos&&(null===r||r>this.ctx.blockB.node.to-this.pos)&&(this.ctx.inEmptyBlock||!this.ctx.blockA||this.ctx.blockA.node.from<this.ctx.blockB.node.from)&&(r=this.ctx.blockB.node.to-this.pos),null===r)?this.ctx.inEmptyBlock?this.ctx.blockA?this.clip(this.ctx.blockA.node.to):this:this.ctx.blockA?this.stopAtLine(1).clip(this.ctx.blockA.node.to):this.stopAtLine(1):this.ctx.blockA&&(this.ctx.inEmptyBlock||!this.ctx.onEmptyLine)?this.slice(0,r,!0).clip(this.ctx.blockA.node.to):this.slice(0,r,!0)}},{key:"clearIfContentIsIsolated",value:function(){if(!this.ctx.onEmptyLine)return this;if(this.newlines)return this.with({content:""});if(1===this.segments.length&&0===this.segments[0].offset)return this;var e=this.segments.find(function(e){return!(0,z.isEmpty)(e.text.slice(e.offset))});return e&&this.ctx.docA.lineAt(e.pos).number!==this.ctx.line.number?this.with({content:""}):this}},{key:"removeDuplicateLastLine",value:function(){if(!this.newlines&&1===this.lines.length&&!this.ctx.onEmptyLine)return this;var e=this.segments[this.segments.length-1];if(e.offset===e.text.length-1)return this;var t=this.ctx.docA.lineAt(e.pos);if(t.number===this.ctx.docA.lines)return this;var n=e.text.slice(e.offset),r=n.lastIndexOf("\n"),i=-1!==r,o=i?e.index+e.offset+r:e.index+e.offset,a=i?n.slice(r+1):n;return(0,z.isEmpty)(a)?this:(!i&&(0,z.isEmpty)(t)&&(a=t.text+a),a===this.ctx.docA.line(t.number+1).text)?this.slice(0,o,!0):this}},{key:"removeTrailingOpenBrackets",value:function(){var e=eb.exec(this.content);return e?this.splice(e.index,e.length):this}},{key:"process",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return e.skipComplexProcessing?this.trimEnd().removeNewlinesIfOnEmptyLine():this.removeNewlinesIfOnEmptyLine().cutSuggestion().trimEnd().removeDuplicateLastLine().removeTrailingOpenBrackets().trimEnd().clearIfContentIsIsolated()}}],[{key:"create",value:function(t,n,r){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,a=(0,z.splitLeadingWhitespaceFiltered)(t),s=a.indentation+a.content,l=a.newlines,u=new em((0,z.isEmpty)(s)?"":l+s,n,r,i,o);return new e(t,n,l,s,u)}}]),e}(),ek=e.i(736097),e_=function(){function e(t){(0,T._)(this,e),(0,R._)(this,"view",void 0),(0,R._)(this,"destroyed",void 0),(0,R._)(this,"stream",void 0),(0,R._)(this,"debounceTimeout",void 0),(0,R._)(this,"queued",void 0),(0,R._)(this,"lastPrefixLength",void 0),this.view=t,this.destroyed=!1,this.stream=null,this.debounceTimeout=null,this.queued=!1,this.lastPrefixLength=0}return(0,E._)(e,[{key:"config",get:function(){return this.view.state.facet($)}},{key:"listeners",get:function(){return this.view.state.facet(M)}},{key:"suggestion",get:function(){return this.view.state.field(L.CompleteCodeSuggestion)}},{key:"regulator",get:function(){return this.view.state.field(eo)}},{key:"fileTypeConfig",get:function(){var e,t=this.view.state.facet(ek.fileName),n=this.view.state.facet(ek.EditorFileType),o=null==n||null==(e=n.getFeature("ai"))?void 0:e.complete;return t&&n&&(null==o?void 0:o.enabled)?(0,i._)((0,r._)({},o),{id:n.id,path:t}):null}},{key:"streaming",get:function(){return null!==this.debounceTimeout||null!==this.stream&&!this.stream.finished}},{key:"active",get:function(){return this.streaming||!this.suggestion.stopped}},{key:"dispatchSuggestion",value:function(e){this.view.dispatch({effects:L.setCompleteCodeSuggestion.of(e)})}},{key:"dismiss",value:function(e){this.queued=!1,null!==this.debounceTimeout&&(clearTimeout(this.debounceTimeout),this.debounceTimeout=null),!this.stream||this.stream.finished||this.stream.aborted||this.stream.abort(),this.destroyed||this.suggestion.stopped||this.dispatchSuggestion(this.suggestion.dismiss(e)),this.listeners.onDismiss(this.view)}},{key:"requestSuggestion",value:function(e){var t,n,r=this;if(null!==this.config&&null!==this.fileTypeConfig){if(null!==this.debounceTimeout&&(clearTimeout(this.debounceTimeout),this.debounceTimeout=null),!this.config.debounceAlways&&!this.regulator.cooling&&e===H.Trigger.NOW)return void this.requestSuggestionImmediately();var i=this.view.state.selection.main.head,o=this.view.state.wordAt(i),a=o&&o.from!==i?null!=(n=this.config.debounceTimeInsideWord)?n:0:null!=(t=this.config.debounceTimeOutsideWord)?t:0;this.regulator.cooling&&(a=Math.max(a,this.regulator.remaining)),0===a?this.requestSuggestionImmediately():this.debounceTimeout=setTimeout(function(){r.debounceTimeout=null,r.requestSuggestionImmediately()},a)}}},{key:"requestSuggestionImmediately",value:function(){var e,t,n,r=this;if(this.dismiss(),!this.suggestion.stopped)throw Error("dismiss should have stopped the suggestion");if(null!==this.config&&null!==this.fileTypeConfig&&!this.destroyed&&this.view.hasFocus&&(0,z.isValidRequestPosition)(this.view.state.doc,this.view.state.selection.main.head)){var i=this.config,o=this.view.state,a=o.selection.main.head,s=o.doc,l=(0,Q.syntaxTree)(o),u=null!=(t=null==(e=o.facet(Q.language))?void 0:e.parser)?t:null,c=this.fileTypeConfig,d={skipComplexProcessing:null!=(n=c.skipComplexProcessing)&&n},f=o.facet(ee),p=function(e){var t=e.doc,n=e.pos,r=e.path,i=e.context,o=e.limit,a=void 0===o?J.MAX_PROMPT_CHARACTERS:o,s=e.reserved,l=void 0===s?J.RESERVED_CONTEXT_CHARACTERS:s,u="-- ".concat(r,"\n");if(u.length>a)throw Error("Cannot fit required header parts in prompt");var c="";if(null==i?void 0:i.length){var d=function(e,t){if((t-=2*e.length)<=0)return null;var n=e.map(function(e){return new et(e)}).filter(function(e){return e.maxLength>0&&e.minLength<=t}).sort(function(e,t){return e.priority===t.priority?e.minLength-t.minLength:t.priority-e.priority});if(!n.length)return null;var r=en.fromChunkViews(n),i=r.reduce(function(e,t){return e+t.size},0);if(i>t){var o=!0,a=!1,s=void 0;try{for(var l,u=r[Symbol.iterator]();!(o=(l=u.next()).done);o=!0){var c=l.value;c.size>t&&(i-=c.size-t,c.resize(t))}}catch(e){a=!0,s=e}finally{try{o||null==u.return||u.return()}finally{if(a)throw s}}for(var d=r.find(function(e){return e.priority===Z.SUFFIX}),f=d?t-d.size:0;i>t;){var p=1,h=!0,g=!1,m=void 0;try{for(var x,y=r[Symbol.iterator]();!(h=(x=y.next()).done);h=!0){var b=x.value;if(f&&b.priority===Z.SUFFIX){f--;continue}if(!b.empty){var w=Math.max(0,b.size-p);i-=b.size-w,b.resize(w),p++}}}catch(e){g=!0,m=e}finally{try{h||null==y.return||y.return()}finally{if(g)throw m}}}var k=!0,_=!1,S=void 0;try{for(var C,j=r[Symbol.iterator]();!(k=(C=j.next()).done);k=!0){var T=C.value;T.empty||T.accept()}}catch(e){_=!0,S=e}finally{try{k||null==j.return||j.return()}finally{if(_)throw S}}var E=r.reduce(function(e,t){return e+t.accepted},0);E<t&&et.acceptSegments(n,t-E)}else n.forEach(function(e){return e.acceptAll()});var R=n.filter(function(e){return e.priority===Z.SUFFIX}).map(function(e){return e.finalize()}).filter(Boolean).join("")||null,I=n.filter(function(e){return e.priority!==Z.SUFFIX}).map(function(e){return e.finalize()}).filter(Boolean).reverse().join("\n\n")||null;return I||R?{context:I,suffix:R}:null}(i,Math.max(l-u.length-2,a-n-u.length-2));(null==d?void 0:d.context)&&(u=(null==d?void 0:d.context)+"\n\n"+u),(null==d?void 0:d.suffix)&&(c=null==d?void 0:d.suffix)}var f=function(e,t,n){for(var r=e.slice(0,t);r.length>n;)r=r.lines>1?r.slice(r.line(1).to+1):r.slice(r.length-n);return r}(t,n,a-u.length-c.length);if(u.length+f.length+c.length>a)throw Error("Prompt is over the maximum length");return{prefix:f,suffix:c,header:u}}({doc:s,pos:a,path:c.path,context:f(this.view)}),h=p.prefix,g=p.suffix,m=p.header,x=(0,ep.isInEmptyBlock)(s,l,a)?J.MaxTokens.EMPTY_BLOCK:J.MaxTokens.DEFAULT;this.lastPrefixLength=h.length,i.backendOnly||this.dispatchSuggestion(this.suggestion.start()),this.stream=new ef({request:i.request,language:c.id,maxTokens:x,prefix:h,suffix:g,header:m,onTextReceived:function(e,t){if(t&&r.listeners.onRequestFirstEmit(r.view),i.backendOnly)return void r.listeners.onRequestIgnoredBackendOnly(r.view);if(r.suggestion.stopped||!t&&r.suggestion.slotted)return!1;var n=r.suggestion.slotted?r.suggestion.upgrade(ew.create(e,a,s,l,u).process(d)):r.suggestion.with({source:e,process:d});if(n.stopped||n.suggestion.empty)return!1;r.dispatchSuggestion(n)},onFinished:function(e){var t=r.queued;if(r.queued=!1,!i.backendOnly){if(e&&r.suggestion.active){var n=r.suggestion.suggestion.source!==e?r.suggestion.with({source:e,process:d}):r.suggestion;if(!n.stopped&&!n.suggestion.empty&&!r.regulator.isIgnored(n.suggestion.content)){r.dispatchSuggestion(n.presented?n:n.present()),r.listeners.onRequestCompletelyPresented(r.view);return}}r.dismiss(L.DismissalReason.INCOMPATIBLE_SUGGESTION),t&&r.requestSuggestion(H.Trigger.ENQUEUE),""===e&&r.listeners.onRequestEndedWithNoSuggestion(r.view)}},onError:function(e){Y.withScope(function(t){t.setExtra("prefix",h.toString()),t.setExtra("suffix",null==g?void 0:g.toString()),t.setExtra("header",m),t.setExtra("maxTokens",x),t.setExtra("filePath",c.path),t.setExtra("language",c.id),t.setExtra("selection-head",a),t.setExtra("previous-character",s.sliceString(a-1,a)),t.setTag("ghostwriter",!0),Y.captureException(e)})}})}}},{key:"postUpdate",value:function(e){var t=e.startState.field(L.CompleteCodeSuggestion,!1),n=e.state.field(L.CompleteCodeSuggestion,!1);t&&n&&t.presented&&n.stopped&&n.reason===L.DismissalReason.FULLY_TYPED_INTO&&this.listeners.onSuggestionAccepted(this.view,t),(0,X.hasChanged)(e,$,ek.fileName,ek.EditorFileType)&&this.dismiss(),(0,X.hasChanged)(e,L.CompleteCodeSuggestion)&&this.suggestion.stopped&&this.streaming&&this.dismiss();var r=(0,H.resolveTriggerFromTransactions)(e.transactions);switch(r){case H.Trigger.STOP:this.active&&this.dismiss();break;case H.Trigger.ENQUEUE:case H.Trigger.NOW:this.active?this.queued=!0:this.requestSuggestion(r)}}},{key:"destroy",value:function(){this.destroyed=!0,this.dismiss()}}]),e}(),eS=P.ViewPlugin.fromClass(e_,{provide:function(e){return P.EditorView.updateListener.of(function(t){var n;null==(n=t.view.plugin(e))||n.postUpdate(t)})}});e.s(["CompleteCodePlugin",()=>eS],211664);var eC=function(){function e(t){(0,T._)(this,e),(0,R._)(this,"view",void 0),(0,R._)(this,"gesture",void 0),this.view=t,this.gesture=null,this.touchstart=this.touchstart.bind(this),this.touchmove=this.touchmove.bind(this),this.touchend=this.touchend.bind(this),this.touchcancel=this.touchcancel.bind(this),t.dom.addEventListener("touchstart",this.touchstart)}return(0,E._)(e,[{key:"shouldAllowSwiping",value:function(){if(!this.view.hasFocus)return!1;var e=this.view.state.selection.main.head,t=this.view.viewport;if(t.from>e||t.to<e)return!1;var n=this.view.state.field(L.CompleteCodeSuggestion,!1);return!!(null==n?void 0:n.presented)}},{key:"stop",value:function(){this.gesture&&(this.gesture=null,document.removeEventListener("touchmove",this.touchmove),document.removeEventListener("touchend",this.touchend),document.removeEventListener("touchcancel",this.touchcancel))}},{key:"touchFor",value:function(e){if(!this.gesture)return null;var t=!0,n=!1,r=void 0;try{for(var i,o=e.changedTouches[Symbol.iterator]();!(t=(i=o.next()).done);t=!0){var a=i.value;if(a.identifier===this.gesture.id)return a}}catch(e){n=!0,r=e}finally{try{t||null==o.return||o.return()}finally{if(n)throw r}}return null}},{key:"touchstart",value:function(e){if(this.gesture&&!this.gesture.time)return this.stop();if(!this.gesture&&this.shouldAllowSwiping()&&1===e.changedTouches.length){var t=e.changedTouches[0];this.gesture={id:t.identifier,start:{x:t.clientX,y:t.clientY},end:{x:t.clientX,y:t.clientY},time:null},document.addEventListener("touchmove",this.touchmove,{passive:!1}),document.addEventListener("touchend",this.touchend,{passive:!1}),document.addEventListener("touchcancel",this.touchcancel)}}},{key:"touchmove",value:function(e){var t=this.touchFor(e);if(this.gesture&&t){if(this.gesture.end.x=t.clientX,this.gesture.end.y=t.clientY,this.gesture.time&&Date.now()-this.gesture.time>500)return this.stop();var n=Math.abs(this.gesture.start.y-this.gesture.end.y),r=Math.abs(this.gesture.start.x-this.gesture.end.x);if(n>20)return this.stop();if(r>10){if(this.gesture.start.x>this.gesture.end.x)return this.stop();this.gesture.time||(this.gesture.time=Date.now()),e.preventDefault()}}}},{key:"touchend",value:function(e){var t=this.touchFor(e);if(this.gesture&&t){this.gesture.end.x=t.clientX,this.gesture.end.y=t.clientY;var n=Math.abs(this.gesture.start.y-this.gesture.end.y),r=Math.abs(this.gesture.start.x-this.gesture.end.x);n<=20&&r>75&&this.gesture.start.x<this.gesture.end.x&&(!this.gesture.time||Date.now()-this.gesture.time<500)&&(U(this.view),e.preventDefault()),this.stop()}}},{key:"touchcancel",value:function(e){this.touchFor(e)&&this.stop()}},{key:"update",value:function(){this.gesture&&!this.shouldAllowSwiping()&&this.stop()}},{key:"destroy",value:function(){this.view.dom.removeEventListener("touchstart",this.touchstart),document.removeEventListener("touchmove",this.touchmove),document.removeEventListener("touchend",this.touchend),document.removeEventListener("touchcancel",this.touchcancel)}}]),e}(),ej=P.ViewPlugin.fromClass(eC),eT=e.i(262206),eE=s.Facet.define({combine:function(e){var t;return null!=(t=e.filter(Boolean)[0])?t:null},enables:function(e){return[$.compute([e],function(t){return t.facet(e)}),L.CompleteCodeSuggestion,H.CompleteCodeTrigger,eS,ej,K,eo,s.Prec.high(P.keymap.compute([e],function(t){var n=t.facet(e),r=[];return(null==n?void 0:n.keyAcceptSuggestion)&&r.push({key:(0,eT.normalizeKeyCombo)(n.keyAcceptSuggestion),run:U}),(null==n?void 0:n.keyDismissSuggestion)&&r.push({key:(0,eT.normalizeKeyCombo)(n.keyDismissSuggestion),run:G}),r}))]}});e.s(["CompleteCode",()=>eE],180182);var eR=e.i(633600);function eI(e){var t=[],n=[],r=!1,i=!0,o=!1,a=void 0;try{for(var s,l=e.selection.ranges[Symbol.iterator]();!(i=(s=l.next()).done);i=!0){var u=s.value;u.empty||(t.push(e.sliceDoc(u.from,u.to)),n.push(u))}}catch(e){o=!0,a=e}finally{try{i||null==l.return||l.return()}finally{if(o)throw a}}if(!t.length){var c=-1,d=!0,f=!1,p=void 0;try{for(var h,g=e.selection.ranges[Symbol.iterator]();!(d=(h=g.next()).done);d=!0){var m=h.value.from,x=e.doc.lineAt(m);x.number>c&&(t.push(x.text),n.push({from:x.from,to:Math.min(e.doc.length,x.to+1)})),c=x.number}}catch(e){f=!0,p=e}finally{try{d||null==g.return||g.return()}finally{if(f)throw p}}r=!0}return{text:t.join(e.lineBreak),ranges:n,linewise:r}}e.s(["copiedRange",()=>eI],260171);var eA=[];function eP(e){if(!(e.length>800)){var t=eA.indexOf(e);-1!==t&&eA.splice(t,1),eA.unshift(e),eA.length>10&&eA.pop()}}var eD=!1;function eO(e,t){var n=eI(t.state),r=n.text,i=n.linewise;if(r&&r.trim())if(i){var o=r.split(t.state.lineBreak).filter(function(e){return e.trim()}),a=!0,s=!1,l=void 0;try{for(var u,c=o[Symbol.iterator]();!(a=(u=c.next()).done);a=!0){var d=u.value;eP(d)}}catch(e){s=!0,l=e}finally{try{a||null==c.return||c.return()}finally{if(s)throw l}}}else eP(r)}var eN=[P.ViewPlugin.define(function(){if(!eD){eD=!0;var e=function(e){var t,n=null==(t=document.getSelection())?void 0:t.toString();n&&n.trim()&&Promise.resolve().then(function(){e.defaultPrevented||eP(n)})};document.addEventListener("copy",e),document.addEventListener("cut",e)}return{}}),s.Prec.highest(P.EditorView.domEventObservers({copy:function(e,t){return eO(e,t)},cut:function(e,t){return eO(e,t)}})),ee.of(function(e){if(!eA.length||!e.state.facet(ek.EditorFileType))return null;var t=(0,eR._)(eA),n=t[0],r=t.slice(1),i=[];if(n&&n.trim()){var o=n.trimEnd();i.push({header:"-- Current Clipboard",segments:[o],priority:Z.HIGH})}var a=r.filter(function(e){return e&&e.trim()});if(a.length){var s=a.map(function(e){return e.trimEnd().split("\n").map(function(e,t){return 0===t?"- ".concat(e):"  ".concat(e)}).join("\n")}).reverse();i.push({header:"-- Clipboard History",segments:s})}return i.length?i:null})];e.s(["CompleteCodeClipboardContextProvider",()=>eN],588561);var eM=e.i(346574),eL=e.i(446692),eB=e.i(205104),eV=/\n\n(?![^\S\n])/g,eF=new(function(){function e(){(0,T._)(this,e),(0,R._)(this,"map",new Map)}return(0,E._)(e,[{key:"removeExpired",value:function(){if(this.map.size){var e=Date.now(),t=!0,n=!1,r=void 0;try{for(var i,o=this.map.entries()[Symbol.iterator]();!(t=(i=o.next()).done);t=!0){var a=(0,b._)(i.value,2),s=a[0],l=a[1];e-l.timestamp>6e4&&this.map.delete(s)}}catch(e){n=!0,r=e}finally{try{t||null==o.return||o.return()}finally{if(n)throw r}}}}},{key:"get",value:function(e){return this.removeExpired(),this.map.get(e)}},{key:"add",value:function(e,t,n){if(this.removeExpired(),!this.map.has(e)&&10===this.map.size){var r=null,i=!0,o=!1,a=void 0;try{for(var s,l=this.map.values()[Symbol.iterator]();!(i=(s=l.next()).done);i=!0){var u=s.value;(!r||u.timestamp<r.timestamp)&&(r=u)}}catch(e){o=!0,a=e}finally{try{i||null==l.return||l.return()}finally{if(o)throw a}}if(!r)throw Error("Expected to find entry to remove from file cache");this.map.delete(r.path)}this.map.set(e,{path:e,type:t,content:n,timestamp:Date.now()})}},{key:"clear",value:function(){this.map.clear()}}]),e}()),eU=function(){function e(t,n,r){var i=this;(0,T._)(this,e),(0,R._)(this,"view",void 0),(0,R._)(this,"readFile",void 0),(0,R._)(this,"recentFiles",void 0),(0,R._)(this,"dispose",void 0),(0,R._)(this,"destroyed",void 0),(0,R._)(this,"chunks",void 0),this.view=t,this.readFile=n,this.recentFiles=r,this.destroyed=!1,this.chunks=[],this.dispose=r.subscribe(function(){return i.updateChunks()}),r.current.length&&this.updateChunks()}return(0,E._)(e,[{key:"updateChunks",value:function(){return(0,n._)(function(){var e,t,n,r,i,o,s,l,u,c,d,f,p,h,g,m,x,y,b,w,k,_,S,C,j,T,E,R;return(0,a._)(this,function(a){switch(a.label){case 0:if(n=[],this.chunks=n,r=this.view.state.facet(ek.fileName),i=this.view.state.facet(ek.EditorFileType),!r||!i)return[2];"all"===(s=null!=(o=null==(t=i.features.ai)||null==(e=t.complete)?void 0:e.groups)?o:[])&&(s=[]),l=this.recentFiles.current.filter(function(e){return e!==r&&(0,eB.isOTFile)(e)}),u=!0,c=!1,d=void 0,a.label=1;case 1:a.trys.push([1,7,8,9]),f=l[Symbol.iterator](),a.label=2;case 2:if(u=(p=f.next()).done)return[3,6];if(h=p.value,w=null==(b=null!=(y=null==(x=eF.get(h))?void 0:x.type)?y:eL.FileTypeRepository.from(h))||null==(g=b.features.ai)?void 0:g.complete,!b||!(null==w?void 0:w.enabled)||!(b.id===i.id||"all"===w.groups||(null==(m=w.groups)?void 0:m.some(function(e){return s.includes(e)}))))return[3,5];if(void 0!==(k=null==x?void 0:x.content))return[3,4];return[4,this.readFile(h)];case 3:if(_=a.sent(),this.destroyed||this.chunks!==n)return[2];if(null===_)return[3,5];k=_,eF.add(h,b,k),a.label=4;case 4:var I;if(!(S=!(I=(I=k).trim())?[]:I.split(eV).map(function(e){return e.trim()}).filter(Boolean)).length)return[3,5];if(C="-- ".concat((0,eM.getRelativePath)(h,r)),j=S.map(function(e){return(0,z.splitLines)(e).join("\n")+"\n\n"}),T=n.length,E=Z.NORMAL,T<2?E=Z.HIGH:T>=5&&(E=Z.LOW),n.push({header:C,segments:j,priority:E}),n.length>=10)return[3,6];a.label=5;case 5:return u=!0,[3,2];case 6:return[3,9];case 7:return R=a.sent(),c=!0,d=R,[3,9];case 8:try{u||null==f.return||f.return()}finally{if(c)throw d}return[7];case 9:return[2]}})}).call(this)}},{key:"update",value:function(e){(0,X.hasChanged)(e,ek.fileName,ek.EditorFileType)&&this.updateChunks()}},{key:"destroy",value:function(){this.destroyed=!0,this.dispose()}}]),e}(),eG=new c.ReactCompartment(function(e,t){return e&&t?P.ViewPlugin.define(function(n){return new eU(n,e,t)},{provide:function(e){return ee.of(function(t){var n,r;return null!=(r=null==(n=t.plugin(e))?void 0:n.chunks)?r:null})}}):null});e.s(["CompleteCodeFileContextProviderCompartment",()=>eG],378294);var e$=ee.of(function(e){var t=e.state.selection.main.head,n=e.state.doc.slice(t);if(0===n.length)return null;if(1===n.lines){var r=n.toString();return""===r.trim()?null:{segments:[r],priority:Z.SUFFIX}}for(var i=[],o=1;o<=n.lines;o++)i.push(n.line(o).text+"\n");for(;i.length&&""===i[i.length-1].trim();)i.pop();return 0===i.length?null:{segments:i,priority:Z.SUFFIX}});e.s(["CompleteCodeSuffixContextProvider",()=>e$],425807);var ez=e.i(693482),eH=e.i(452723);function eW(e){var t=e.replId,n=e.provider,r=e.cache,i=e.hooks;return(0,w.useCallback)(function(e){return(0,eH._)(function(){var o,s,l,u,c,d,f,p,h,g,m,x,y,b,w,k,_,S,C,j,T,E,R,I,A;return(0,a._)(this,function(P){switch(P.label){case 0:if(o=e.prefix,s=e.suffix,l=e.header,u=e.language,c=e.maxTokens,d=e.signal,!o)return[2];if(f={prefix:o,suffix:s,header:l,maxTokens:c,replId:t,stop:["\n\n","```"]},"markdown"===u&&(f.maxTokens=75,f.stop=[]),p=null==i?void 0:i.beforeCompletion(f),null===(g=r.retrieve(o,c)))return[3,1];return h=function(){return(0,eH._)(function(){return(0,a._)(this,function(e){switch(e.label){case 0:return[4,g];case 1:return e.sent(),[2]}})})()},[3,4];case 1:return P.trys.push([1,3,,4]),[4,(0,ez._)(n(f,d))];case 2:return h=P.sent(),[3,4];case 3:if((null==(x=m=P.sent())?void 0:x.name)==="AbortError")return[2];return null==i||i.erroredCompletion((0,D._)(m,Error)?m:Error("Unknown error"),p),[2];case 4:y="",b="",w=!0,k=!1,d.addEventListener("abort",function(){p&&(null==i||i.afterCompletion("aborted",f,{},p)),k=!0}),_=!1,S=!1,P.label=5;case 5:P.trys.push([5,13,14,19]),j=(0,ea._)(h()),P.label=6;case 6:return[4,(0,ez._)(j.next())];case 7:if(!(_=!(T=P.sent()).done))return[3,12];E=T.value,b+=E,R=void 0,P.label=8;case 8:if(-1===(R=b.indexOf("\n")))return[3,11];if(I=JSON.parse(b.substring(0,R)).text,b=b.substring(R+1),y+=I,k)return[3,10];return[4,I];case 9:P.sent(),P.label=10;case 10:return!k&&w&&p&&(null==i||i.afterCompletion("success",f,{fromCache:!!g,partialSuggestion:I},p)),w=!1,[3,8];case 11:return _=!1,[3,6];case 12:return[3,19];case 13:return A=P.sent(),S=!0,C=A,[3,19];case 14:if(P.trys.push([14,,17,18]),!(_&&null!=j.return))return[3,16];return[4,(0,ez._)(j.return())];case 15:P.sent(),P.label=16;case 16:return[3,18];case 17:if(S)throw C;return[7];case 18:return[7];case 19:if(null===g&&y.trim().length&&r.add(o,y,c),!(!k&&b))return[3,21];return[4,b];case 20:P.sent(),P.label=21;case 21:return p&&(null==i||i.afterCompletion("finished",f,{completeSuggestion:y,fromCache:!!g},p)),[2]}})})()},[t,r,i,n])}e.s(["useCompletion",()=>eW],977200),e.i(877212);var eq=e.i(267710),eK=e.i(17886);function eY(e){if("codestral-2"!==e&&"codestral-2501"!==e)throw Error("Model ".concat(e," is not supported"));return function(t,r){return(0,n._)(function(){var n,i,o,s,l,u,c,d,f;return(0,a._)(this,function(p){switch(p.label){case 0:return n=(0,eK.isEnvProduction)()?"https://production-ai-modelservice.replit.com":"https://staging-ai-modelservice.replit.com",[4,(0,eq.auth)(t.replId,"completions-1")];case 1:return i=p.sent(),o={model:e,context:t.header?t.header+t.prefix:t.prefix,suffix:t.suffix,max_tokens:t.maxTokens,stop_words:t.stop},[4,fetch("".concat(n,"/completions"),{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(i)},signal:r,body:JSON.stringify(o)})];case 2:if(l=(s=p.sent()).body,200===(u=s.status))return[3,4];return c=Error.bind,f=(d="Error (".concat(u,") response from /ai/complete: ")).concat,[4,s.text()];case 3:throw new(c.apply(Error,[void 0,f.apply(d,[p.sent()])]));case 4:if(!l)throw Error("No body in response");return[2,function(){var e;return e=l,(0,eH._)(function(){var t,n,r,i,o,s,l,u,c,d,f,p,h,g;return(0,a._)(this,function(m){switch(m.label){case 0:t=new TextDecoder("utf-8"),n="",r=!1,i=!1,m.label=1;case 1:m.trys.push([1,11,12,17]),s=(0,ea._)((0,eH._)(function(){var t,n,r,i;return(0,a._)(this,function(o){switch(o.label){case 0:t=e.getReader(),o.label=1;case 1:return[4,(0,ez._)(t.read())];case 2:if(r=(n=o.sent()).done,i=n.value,r)return[3,4];return[4,i];case 3:return o.sent(),[3,1];case 4:return t.releaseLock(),[2]}})})()),m.label=2;case 2:return[4,(0,ez._)(s.next())];case 3:if(!(r=!(l=m.sent()).done))return[3,10];u=l.value,c=t.decode(u,{stream:!0}),n+=c,d=void 0,m.label=4;case 4:if(-1===(d=n.indexOf("\n\n")))return[3,9];if(!n.startsWith("data: ")||!("text"in(f=JSON.parse(n.slice(6,d)))))return[3,8];p=f.text.split("\n"),h=0,m.label=5;case 5:if(!(h<p.length))return[3,8];return[4,JSON.stringify({text:p[h]+"\n"})+"\n"];case 6:m.sent(),m.label=7;case 7:return h++,[3,5];case 8:return n=n.substring(d+1),[3,4];case 9:return r=!1,[3,2];case 10:return[3,17];case 11:return g=m.sent(),i=!0,o=g,[3,17];case 12:if(m.trys.push([12,,15,16]),!(r&&null!=s.return))return[3,14];return[4,(0,ez._)(s.return())];case 13:m.sent(),m.label=14;case 14:return[3,16];case 15:if(i)throw o;return[7];case 16:return[7];case 17:return[2]}})})()}]}})})()}}e.s(["default",()=>eY],801573);var eQ=e.i(569384),eX=e.i(973245),eJ=e.i(304277);function eZ(){var e=(0,eQ._)(["\n  fragment CompleteCodeAuthorization on OrgAuthorizations {\n    useAdvancedModel: useAiModel(model: advanced) {\n      isAuthorized\n      code\n      message\n    }\n  }\n"]);return eZ=function(){return e},e}function e0(){var e=(0,eQ._)(['\n  query CompleteCode($orgId: String) {\n    currentUser {\n      id\n      hasKillswitch: gate(feature: "flag-killswitch-ghostwriter")\n      personalOrgAuthorizations {\n        ... on OrgAuthorizations {\n          ...CompleteCodeAuthorization\n        }\n      }\n      org(orgId: $orgId) {\n        ... on Org {\n          id\n          authorizations {\n            ...CompleteCodeAuthorization\n          }\n        }\n        ... on Error {\n          message\n        }\n      }\n    }\n  }\n  ',"\n"]);return e0=function(){return e},e}e.i(566901);var e1={},e2=(0,eX.gql)(eZ()),e3=(0,eX.gql)(e0(),e2);function e4(e){var t=(0,r._)({},e1,e);return eJ.useQuery(e3,t)}e.s(["useCompleteCodeQuery",()=>e4],61211)},513705,e=>{"use strict";var t,n=e.i(61211),r=e.i(807290),i=e.i(605526),o=e.i(207237),a=((t={}).None="None",t.Basic="Basic",t.Pro="Pro",t.BackendOnly="BackendOnly",t);function s(e){return"None"!==e&&"BackendOnly"!==e}function l(){var e,t,a,s,l=(0,o.default)(),u=(0,i.useOrgId)(l),c=u.orgId,d=u.loading,f=(0,n.useCompleteCodeQuery)({variables:{orgId:c},skip:d}),p=f.data,h=f.loading,g=(0,r.useIsTeamWithAiDisabled)().isTeamWithAiDisabled,m=null==p?void 0:p.currentUser;return!m||m.hasKillswitch||g||h||d?"None":c?(null==(e=p.currentUser)?void 0:e.org.__typename)==="Org"&&(null==(t=p.currentUser)?void 0:t.org.authorizations.useAdvancedModel.isAuthorized)?"Pro":"Basic":(null==(a=p.currentUser)?void 0:a.personalOrgAuthorizations.__typename)==="OrgAuthorizations"&&(null==(s=p.currentUser)?void 0:s.personalOrgAuthorizations.useAdvancedModel.isAuthorized)?"Pro":"Basic"}e.s(["CompleteCodeAccessLevel",()=>a,"default",()=>l,"isCodeCompleteFrontendEnabled",()=>s])},204219,463930,441072,525476,598986,e=>{"use strict";var t,n=e.i(297083),r=e.i(817556),i=e.i(389959),o=e.i(906368),a=e.i(424719),s=e.i(42512),l=e.i(180182),u=e.i(288209),c=e.i(211664),d=e.i(588561),f=e.i(378294),p=e.i(425807),h=e.i(166978),g=e.i(977200),m=e.i(801573),x=e.i(513705),y=e.i(664152),b=e.i(791247),w=new Map,k={beforeCompletion:function(e){o.addBreadcrumb({category:"ghostwriter",message:"Called completeCode",level:"debug"});var t=b.ghostwriterLogs.add(e),n=y.logger.timeStart({replid:e.replId,codeLength:e.header?e.header.length+e.prefix.length:e.prefix.length});return w.set(t,n),t},afterCompletion:function(e,t,n,r){switch(e){case"aborted":b.ghostwriterLogs.abort(r),w.delete(r);break;case"success":o.addBreadcrumb({category:"ghostwriter",message:"Suggestion emitted: "+n.partialSuggestion,level:"debug"});var i,a=w.get(r);if(!a)throw Error("No latency logger found for handle: "+JSON.stringify(r));a("code suggestion",{type:"success",fromCache:n.fromCache,length:null==(i=n.partialSuggestion)?void 0:i.length}),w.delete(r);break;case"finished":b.ghostwriterLogs.complete(r,{__typename:"CompleteCodeResult",id:Date.now().toString(),code:n.completeSuggestion});break;default:throw Error("Unknown completion kind: "+e)}},erroredCompletion:function(e,t){t&&(b.ghostwriterLogs.abort(t),w.delete(t)),y.logger.error("CompleteCode: error in completion provider",{err:String(e)})}},_=e.i(878420),S=e.i(64386),C=e.i(530658),j=e.i(541793),T=e.i(161322),E=e.i(993796),R=e.i(282453),I="ai.codecomplete.lastTooltipHintTimestamp",A=(0,j.atom)({tooltipOpen:!1,consecutiveRejections:0}),P=e.i(858248),D=e.i(709485),O=e.i(703916),N=e.i(700170),M=e.i(61524),L=e.i(207237),B=e.i(125674),V=e.i(529810),F=e.i(384401),U=e.i(965863),G=new N.ReactCompartment(function(e,t,n,r,i,o,a,u){var c,f;return e?(t===x.CompleteCodeAccessLevel.Pro?(c=s.DEBOUNCE_TRIGGER_CHARACTERS,f=s.DEBOUNCE_TRIGGER_CHARACTERS):(c=o,f=o),[l.CompleteCode.of({request:i,backendOnly:t===x.CompleteCodeAccessLevel.BackendOnly,debounceTimeOutsideWord:c,debounceTimeInsideWord:f,debounceAlways:t!==x.CompleteCodeAccessLevel.Pro,keyAcceptSuggestion:n,keyDismissSuggestion:r}),a?d.CompleteCodeClipboardContextProvider:[],u?[]:h.CompleteCodeRegulatorEnabled.of(!1),p.CompleteCodeSuffixContextProvider]):null}),$=new N.ReactCompartment(function(e,t,n){if(!e)return null;var r,i,a=(r=null,i=function(){},{queue:function(e){if(!(Math.random()>.1)){r&&clearTimeout(r);var t=function(){(0,P.track)(D.events.CODE_SUGGESTION_USED,(0,_._)({type:"suggestionPresented"},e))};r=setTimeout(t,500),i=t}},flush:function(){r&&clearTimeout(r),i()},cancel:function(){r&&clearTimeout(r)}});return u.CompleteCodeListeners.of({onDismiss:function(){a.cancel()},onRequestIgnoredBackendOnly:function(){o.addBreadcrumb({category:"ghostwriter",message:"called completeCode for free user but did not show the ghost text.",level:"info"}),(0,P.track)(D.events.CODE_SUGGESTION_USED,{type:"suggestionNotPresented",filePath:t,reason:"ghostTextNotEnabledForFreeUser"})},onRequestFirstEmit:function(e){var n=e.plugin(c.CompleteCodePlugin);n&&(o.addBreadcrumb({category:"ghostwriter",message:"Suggestion presented",level:"debug"}),a.queue({filePath:t,prefixLength:n.lastPrefixLength}))},onRequestEndedWithNoSuggestion:function(){o.addBreadcrumb({category:"ghostwriter",message:"Exited completeCode iteration with no suggestion.",level:"info"}),(0,P.track)(D.events.CODE_SUGGESTION_USED,{type:"suggestionNotPresented",filePath:t,reason:"noSuggestion"})},onSuggestionAccepted:function(e,r){var i=e.plugin(c.CompleteCodePlugin);i&&(a.flush(),(0,P.track)(D.events.CODE_SUGGESTION_USED,{type:"suggestionAccepted",filePath:t,prefixLength:i.lastPrefixLength,suggestionLength:r.suggestion.content.length}),o.addBreadcrumb({category:"ghostwriter",message:"Suggestion accepted",level:"info"}),null==n||n.recordAccept())},onSuggestionExplicitlyDismissed:function(e){var r=e.plugin(c.CompleteCodePlugin);r&&(a.flush(),(0,P.track)(D.events.CODE_SUGGESTION_USED,{type:"suggestionDismissed",filePath:t,prefixLength:r.lastPrefixLength}),o.addBreadcrumb({category:"ghostwriter",message:"Suggestion explicitly dismissed",level:"info"}),null==n||n.recordReject())}})});function z(e){var t,o,l,u,c=e.filePath,d=(0,V.default)().fs,p=(0,L.default)(),h=(0,M.usePreferences)("codeSuggestion").preferences,y=(0,x.default)(),w=h.codeSuggestion&&y!==x.CompleteCodeAccessLevel.None;(0,i.useEffect)(function(){b.ghostwriterLogs.toggle(w)},[w]);var j=(0,F.useKeyCombo)(O.commands.acceptPrimaryCompletion.id),P=(0,F.useKeyCombo)(O.commands.cancelCompletion.id),D=(0,B.default)(function(){return new a.SuggestionCache},[c,p]),N=(0,E.useFlag)({controlName:"flag-code-complete-codestral-2508",default:!1}),z=(0,B.default)(function(){return(0,m.default)(N?"codestral-2":"codestral-2501")},[N]),H=(0,g.useCompletion)({replId:p,provider:z,cache:D,hooks:k}),W=(o=(t=(0,C._)((0,T.useAtom)(A),2))[0],l=t[1],u=(0,E.useFlag)({controlName:"flag-killswitch-pichu",logFlagToAnalytics:!1}),(0,i.useEffect)(function(){if(u&&o.tooltipOpen){var e=setTimeout(function(){return l(function(e){return(0,S._)((0,_._)({},e),{tooltipOpen:!1})})},2500);return function(){return clearTimeout(e)}}},[u,o.tooltipOpen,l]),(0,i.useMemo)(function(){return u?{recordAccept:function(){l(function(e){return(0,S._)((0,_._)({},e),{consecutiveRejections:0})})},recordReject:function(){l(function(e){var t=e.consecutiveRejections+1;if(t>=5){var n=R.default.get(I,"number");if(!n||Date.now()-n>=432e6)return R.default.set(I,Date.now()),(0,S._)((0,_._)({},e),{consecutiveRejections:t,tooltipOpen:!0})}return(0,S._)((0,_._)({},e),{consecutiveRejections:t})})}}:null},[u,l])),q=(0,i.useCallback)(function(e){return(0,n._)(function(){var t;return(0,r._)(this,function(n){switch(n.label){case 0:return[4,d.readFile(e)];case 1:if(null!==(t=n.sent()).error)return[2,null];return[2,t.content.toString()]}})})()},[d]),K=(0,U.useRecentFilesObservable)(),Y=(0,E.useFlag)({controlName:"flag-gw-magikarp-bounce-time",logFlagToAnalytics:!1,default:s.DEBOUNCE_TRIGGER_CHARACTERS_LONG,type:"number"}),Q=(0,E.useFlag)({controlName:"flag-completely-different-clipboard",logFlagToAnalytics:!0}),X=(0,E.useFlag)({controlName:"flag-completely-different-regulator"}),J=[G.use(w,y,j,P,H,Y,Q,X),$.use(w,c,W),f.CompleteCodeFileContextProviderCompartment.use(q,K)];return(0,i.useMemo)(function(){return J},J)}e.s(["default",()=>z],204219);var H=e.i(753950),W=e.i(399119),q=e.i(904851),K=e.i(90659),Y=e.i(721281),Q=e.i(445789),X=e.i(167626),J=e.i(992785),Z=e.i(179302),ee=e.i(486701),et=e.i(873753),en=e.i(88892),er=function(){function e(t,n,r,i){(0,q._)(this,e),(0,Y._)(this,"a",void 0),(0,Y._)(this,"b",void 0),(0,Y._)(this,"chunks",void 0),(0,Y._)(this,"map",void 0),this.a=t,this.b=n,this.chunks=r,this.map=i}return(0,K._)(e,[{key:"line",value:function(e,t){return t===en.Side.A?this.a.line(e):this.b.line(e)}},{key:"bounds",value:function(e){if(0===this.chunks.length)return null;var t=(0,en.pickSide)(this.chunks[0],e),n=(0,en.pickSide)(this.chunks[this.chunks.length-1],e),r=e===en.Side.A?this.a.length:this.b.length,i=Math.min(n.to,r);return{from:t.from,to:i}}},{key:"hasChanges",value:function(){return this.chunks.length>0}},{key:"updateA",value:function(t,n,r){var i=this.b,o=(0,en.buildChunks)(t,i,{chunks:this.chunks,changesA:n},r),a=(0,en.getDiffLineMap)(t,i,o);return new e(t,i,o,a)}},{key:"updateB",value:function(t,n,r){var i=this.a,o=(0,en.buildChunks)(i,t,{chunks:this.chunks,changesB:n},r),a=(0,en.getDiffLineMap)(i,t,o);return new e(i,t,o,a)}},{key:"getContainingChunk",value:function(e,t){for(var n=0,r=this.chunks.length-1;n<=r;){var i=n+r>>>1,o=this.chunks[i],a=(0,en.pickSide)(o,t);if(e>=a.from&&e<=a.to)return o;e<a.from?r=i-1:e>a.to&&(n=i+1)}return null}},{key:"getCorrespondingLine",value:function(e,t){var n=this.map.get(t===en.Side.A?-e:e);return n?this.line(n,(0,en.oppositeSide)(t)):null}},{key:"getLineChangeType",value:function(e,t){if(this.map.get(t===en.Side.A?-e:e))return en.LineChangeType.UNCHANGED;var n=this.line(e,t),r=this.getContainingChunk(n.from,t);return r?(0,en.getLineChangeType)(this.a,this.b,n,t,r.changes,r):en.LineChangeType.UNCHANGED}},{key:"getLineStats",value:function(){for(var e={added:0,removed:0},t=1;t<=this.a.lines;t++)this.getLineChangeType(t,en.Side.A)!==en.LineChangeType.UNCHANGED&&e.removed++;for(var n=1;n<=this.b.lines;n++)this.getLineChangeType(n,en.Side.B)!==en.LineChangeType.UNCHANGED&&e.added++;return e}},{key:"iterLines",value:function(e){var t,n,i,o;return(0,r._)(this,function(r){switch(r.label){case 0:t=e===en.Side.A?this.a:this.b,n=1,r.label=1;case 1:if(!(n<=t.lines))return[3,4];return i=t.line(n),o=this.getCorrespondingLine(i.number,e),[4,{line:i,correspondingLine:o}];case 2:r.sent(),r.label=3;case 3:return n++,[3,1];case 4:return[2]}})}},{key:"iterRanges",value:function(){var e,t,n,i,o;return(0,r._)(this,function(r){switch(r.label){case 0:e=0,r.label=1;case 1:if(!(e<this.chunks.length))return[3,6];t=this.chunks[e].fromA,n=this.chunks[e].fromB,i=0,r.label=2;case 2:if(!(i<this.chunks[e].changes.length))return[3,5];return o=this.chunks[e].changes[i],[4,{fromA:t+o.fromA,toA:t+o.toA,fromB:n+o.fromB,toB:n+o.toB}];case 3:r.sent(),r.label=4;case 4:return i++,[3,2];case 5:return e++,[3,1];case 6:return[2]}})}}],[{key:"create",value:function(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:en.DEFAULT_DIFF_CONFIG,i=(0,en.buildChunks)(t,n,void 0,r),o=(0,en.getDiffLineMap)(t,n,i);return new e(t,n,i,o)}}]),e}();e.s(["Diff",()=>er],463930);var ei=e.i(680118),eo=H.Facet.define({combine:function(e){var t;return null!=(t=e.filter(Boolean)[0])?t:null}}),ea=H.StateField.define({create:function(){return{diff:null,tree:et.Tree.empty}},update:function(e,t){var n,r,i=t.state.facet(eo),o=null==(n=t.state.facet(ee.language))?void 0:n.parser;if(!i)return null===e.diff&&e.tree===et.Tree.empty?e:{diff:null,tree:et.Tree.empty};var a=e.diff,s=e.tree;return(a&&a.b.eq(i)?t.docChanged&&(a=a.updateA(t.newDoc,t.changes)):(a=er.create(t.newDoc,i),s=et.Tree.empty),(null==(r=t.startState.facet(ee.language))?void 0:r.parser)!==o&&(s=et.Tree.empty),o&&s.length!==a.b.length)?(s=(0,ei.getIncrementallyParsedTree)({parser:o,text:a.b,maxTime:16,base:s}),{diff:a,tree:s}):e.diff===a&&e.tree===s?e:{diff:a,tree:s}}});e.s(["TransformDiffInternalFacet",()=>eo,"TransformDiffState",()=>ea],441072);var es=e.i(480028),el="cm-transform-diff-line-deletion-base",eu="cm-transform-diff-line-deletion",ec="cm-transform-diff-text-deletion",ed="cm-transform-diff-line-insertion-base",ef="cm-transform-diff-line-insertion",ep="cm-transform-diff-text-insertion",eh="cm-transform-diff-number-marker",eg="rgba(180, 0, 0, 0.1)",em="rgba(180, 0, 0, 0.125)",ev="rgba(0, 180, 0, 0.1)",ex="rgba(0, 180, 0, 0.125)";function ey(e,t){var n="linear-gradient(to right, ".concat(e,", ").concat(e,")");return t&&(n+=", linear-gradient(to right, ".concat(t,", ").concat(t,")")),n}var eb=Z.EditorView.theme((t={},(0,Y._)(t,".".concat(ed,", .").concat(ef),{cursor:"text","&.cm-line ::selection":{backgroundColor:"".concat(es.tokens.accentPrimaryDimmest," !important")}}),(0,Y._)(t,".".concat(el),{background:ey(eg),backgroundClip:"content-box"}),(0,Y._)(t,".".concat(eu),{background:ey(eg,em),backgroundClip:"content-box"}),(0,Y._)(t,".".concat(ed),{background:ey(ev),backgroundClip:"content-box"}),(0,Y._)(t,".".concat(ef),{background:ey(ev,ex),backgroundClip:"content-box"}),(0,Y._)(t,".".concat(ep),{display:"inline-block",background:ex}),(0,Y._)(t,".".concat(ec),{display:"inline-block",background:em}),(0,Y._)(t,".".concat(eh),{opacity:.5}),t)),ew=e.i(731291),ek=function(e){function t(e,n,r){var i;return(0,q._)(this,t),i=(0,W._)(this,t),(0,Y._)(i,"line",void 0),(0,Y._)(i,"index",void 0),(0,Y._)(i,"changed",void 0),i.line=e,i.index=n,i.changed=r,i}return(0,Q._)(t,e),(0,K._)(t,[{key:"estimatedHeight",get:function(){return 21}},{key:"toDOM",value:function(){var e=this,t=document.createElement("div");if(t.className=this.changed?"cm-line ".concat(ed):"cm-line ".concat(ef),!this.changed||!this.changed.length){var n=!0,r=!1,i=void 0;try{for(var o,a=this.line[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var s=o.value,l=s.text,u=s.tags,c=document.createElement("span");c.textContent=l||"",c.className=null!=u?u:"",t.appendChild(c)}}catch(e){r=!0,i=e}finally{try{n||null==a.return||a.return()}finally{if(r)throw i}}return t}for(var d=0,f=0,p=null,h=null,g=function(t,n){if(!p)throw Error("range is null");var r=e.line[f],i=r.text,o=r.tags,a=i.slice(d-p.from,n-p.from),s=document.createElement("span");s.textContent=a||"",s.className=null!=o?o:"",t.appendChild(s),d+=a.length};f<this.line.length;){if(!p){var m=this.line[f].text;p={from:d,to:d+m.length}}if(!h){var x=!0,y=!1,b=void 0;try{for(var w,k=this.changed[Symbol.iterator]();!(x=(w=k.next()).done);x=!0){var _=w.value;if(!(_.from>=p.to)&&!(_.to<=d)){var S=document.createElement("span");S.className=ep,h={from:_.from,to:_.to,dom:S},d<h.from&&g(t,h.from),t.appendChild(S);break}}}catch(e){y=!0,b=e}finally{try{x||null==k.return||k.return()}finally{if(y)throw b}}}h?(d<h.to&&g(h.dom,h.to),d>=h.to&&(h=null)):g(t,p.to),d>=p.to&&(p=null,f++)}return t}},{key:"eq",value:function(e){var n,r;return(0,X._)(e,t)&&this.index===e.index&&this.line.length===e.line.length&&(null==(n=this.changed)?void 0:n.length)===(null==(r=e.changed)?void 0:r.length)&&(0,J.default)(this.line,e.line)&&(0,J.default)(this.changed,e.changed)}},{key:"ignoreEvent",value:function(e){return e.stopImmediatePropagation(),!0}}]),t}(Z.WidgetType),e_=Z.Decoration.line({class:el}),eS=Z.Decoration.line({class:eu}),eC=Z.Decoration.mark({class:ec}),ej=Z.EditorView.decorations.compute([ea],function(e){var t=function(e,t){if(r.getLineChangeType(e.number,en.Side.A)===en.LineChangeType.COVERED)o.push(eS.range(e.from));else{o.push(e_.range(e.from));var n=!0,i=!1,a=void 0;try{for(var s,l=(0,en.changedRangesForLine)(e,t,en.Side.A,!1)[Symbol.iterator]();!(n=(s=l.next()).done);n=!0){var u=s.value;o.push(eC.range(u.from,u.to))}}catch(e){i=!0,a=e}finally{try{n||null==l.return||l.return()}finally{if(i)throw a}}}},n=e.field(ea,!1);if(!n||!n.diff)return Z.Decoration.none;var r=n.diff,i=n.tree,o=[],a=!0,s=!1,l=void 0;try{for(var u,c=r.chunks[Symbol.iterator]();!(a=(u=c.next()).done);a=!0){var d=u.value;if(d.fromA!==d.endA)for(var f=r.a.lineAt(d.fromA),p=r.a.lineAt(d.endA),h=f.number;h<=p.number;h++)t(r.a.line(h),d);else d.fromB===d.endB&&t(r.a.lineAt(d.fromA),d);if(d.fromB!==d.toB)for(var g=r.b.lineAt(d.fromB),m=(0,ew.treeToHighlightedLines)(i,r.b,e,d.fromB,d.endB),x=0;x<m.length;x++){var y=m[x],b=r.b.line(g.number+x),w=r.getLineChangeType(b.number,en.Side.B)===en.LineChangeType.COVERED?null:(0,en.changedRangesForLine)(b,d,en.Side.B,!0),k=Z.Decoration.widget({widget:new ek(y,b.number,w),block:!0,side:x+1}),_=Math.min(d.endA,r.a.length);o.push(k.range(_))}}}catch(e){s=!0,l=e}finally{try{a||null==c.return||c.return()}finally{if(s)throw l}}return Z.Decoration.set(o,!0)}),eT=e.i(495970),eE=function(e){function t(e){var n;return(0,q._)(this,t),n=(0,W._)(this,t),(0,Y._)(n,"index",void 0),n.index=e,n}return(0,Q._)(t,e),(0,K._)(t,[{key:"toDOM",value:function(){var e=document.createElement("span");return e.className=eh,e.textContent=String(this.index),e}},{key:"eq",value:function(e){return this.index===e.index}}]),t}(Z.GutterMarker),eR=eT.LineNumberWidgetHandlers.of(function(e,t){if((0,X._)(t,ek))return new eE(t.index)}),eI=H.Facet.define({enables:function(e){return[eo.computeN([e],function(t){return t.facet(e)}),ea,eb,ej,eR]}});e.s(["TransformDiff",()=>eI],525476);var eA=e.i(119468),eP=function(){function e(){(0,q._)(this,e)}return(0,K._)(e,null,[{key:"get",value:function(e,t){var n,r;try{n=sessionStorage.getItem(e)}catch(e){}if(null==n)return null;try{r=JSON.parse(n)}catch(e){}return null==r||"array"===t&&!Array.isArray(r)||t&&(void 0===r?"undefined":(0,eA._)(r))!==t?null:r}},{key:"set",value:function(e,t){try{sessionStorage.setItem(e,JSON.stringify(t))}catch(e){}}},{key:"remove",value:function(e){try{sessionStorage.removeItem(e)}catch(e){}}},{key:"keys",value:function(){try{return Object.keys(sessionStorage)}catch(e){return[]}}}]),e}();e.s(["default",()=>eP],598986)},291607,e=>{"use strict";var t=e.i(878420),n=e.i(64386),r=e.i(530658),i=e.i(276385),o=e.i(389959),a=e.i(629536),s=e.i(598986),l=e.i(479491),u=e.i(649960),c=e.i(57613),d=e.i(480028),f=e.i(446530),p=e.i(754873),h=e.i(613355),g=e.i(136540),m=e.i(396776),x=e.i(960178),y=e.i(751273),b=e.i(625484),w=e.i(819700),k=e.i(940745),_=e.i(249622),S=e.i(796817),C=e.i(42458);function j(e){var r={size:24,dataCy:"ghostwriter-inline-submit",alt:"Send",filled:!0};return e.disabled||e.connecting?(0,i.jsx)(g.IconButton,(0,n._)((0,t._)({disabled:!0},r),{children:e.connecting?(0,i.jsx)(k.default,{}):(0,i.jsx)(_.default,{})})):(0,i.jsx)(g.IconButton,(0,n._)((0,t._)({onClick:e.onClick,disabled:e.disabled,colorway:"teal"},r),{children:e.loading?(0,i.jsx)(S.default,{}):(0,i.jsx)(_.default,{})}))}var T=(0,f.cssRecord)({root:[h.rcss.minWidth(300),h.rcss.maxWidth(800),h.rcss.position.relative,{fontFamily:d.tokens.fontFamilyDefault}],container:[h.rcss.position.relative,h.rcss.backgroundColor.backgroundDefault],input:[p.interactive.outlined,h.rcss.borderRadius(4),{paddingBottom:36,"@media (hover: hover)":{":not([disabled]):hover":{backgroundColor:"transparent"}}}],textarea:[h.rcss.p(8),h.rcss.pb(0),{caretColor:"initial",fontFamily:d.tokens.fontFamilyDefault,border:"0 none",resize:"none",height:"1em",backgroundColor:"transparent","@media (hover: hover)":{":not([disabled]):focus":{outline:"0 none"}},"::placeholder":{color:d.tokens.foregroundDimmest}}],footer:[h.rcss.position.absolute,h.rcss.bottom(0),h.rcss.left(0),h.rcss.width("100%"),{height:36}],error:[h.rcss.color.accentNegativeStronger]}),E=function(e){var t=e.requestMeasure,n=e.type,r=e.children,o=e.isCodeMirrorPocket,a=(0,u.default)(t);return(0,i.jsx)(c.default,{bsod:!0,tags:{ai:!0},extras:{type:n},origin:"ErrorBoundary: InlineAiWidget",children:(0,i.jsx)(b.View,{css:T.root,py:8,pr:8,gap:4,innerRef:a,className:void 0===o||o?"cm-pocket-widget":void 0,children:r})})},R=function(e){var t=e.requestMeasure,n=e.type,r=e.children,o=e.isCodeMirrorPocket,a=e.error,s=e.clearError,l=e.innerRef;return(0,i.jsxs)(E,{type:n,requestMeasure:t,isCodeMirrorPocket:void 0===o||o,children:[(0,i.jsx)(b.View,{css:T.container,innerRef:l,children:r}),a?(0,i.jsx)(m.StatusBanner,{icon:(0,i.jsx)(C.default,{color:d.tokens.accentNegativeDefault}),text:a,closable:!0,closeAction:s}):null]})};function I(e){var t=(0,l.default)();return(0,i.jsx)(b.View,{css:T.input,children:(0,i.jsx)("textarea",{value:e.value,onChange:e.onChange,placeholder:e.placeholder,css:T.textarea,ref:function(n){e.inputRef.current=n,t.ref(n)},onKeyDown:e.onKeyDown,autoFocus:e.autoFocus,"data-cy":"ghostwriter-inline-input",disabled:e.disabled})})}function A(e){var t=e.readableModelName,n=e.type;return(0,i.jsx)(y.Tooltip,{tooltip:"generateCode"===n?"Generate new code based on this file".concat(t?" using ".concat(t,"."):"."):"Modify selected code based on the context of this file".concat(t?" using ".concat(t,"."):"."),children:(0,i.jsxs)(b.View,{row:!0,gap:4,align:"center",children:[(0,i.jsx)(w.default,{}),(0,i.jsx)(x.Text,{variant:"small",color:"dimmest",children:"transformCode"===n?"Modify with ".concat(a.ASSISTANT_NAME):"Generate with ".concat(a.ASSISTANT_NAME)})]})})}function P(e){var t=e.loading,n=e.disabled,r=e.promptPresentation,o=e.onClick,a=e.connecting,s=e.escPressed,l=e.codeLengthExceeded;return(0,i.jsxs)(i.Fragment,{children:[t?(0,i.jsxs)(b.View,{row:!0,gap:4,align:"center",children:[(0,i.jsx)(k.default,{size:12,color:d.tokens.blurpleDefault}),r?(0,i.jsx)(x.Text,{variant:"small",color:"dimmest",children:"AI is writing"}):null]}):(0,i.jsx)(i.Fragment,{children:r?(0,i.jsx)(x.Text,{variant:"small",color:"dimmest",children:l?"Code length exceeded":s?"Press Esc again to dismiss":"Esc to close, Enter to submit"}):null}),(0,i.jsx)(j,{connecting:a,loading:t,disabled:n,onClick:o})]})}function D(e){var t=e.id,n=e.inputRef,i=e.onClose,a=e.loading,l=e.onSubmit,u=(0,r._)((0,o.useState)(""),2),c=u[0],d=u[1],f=(0,r._)((0,o.useState)(!1),2),p=f[0],h=f[1];return(0,o.useEffect)(function(){var e="inline-ai/input-state/".concat(t),r=s.default.get(e,"string");r&&d(r);var i=n.current;return function(){if(i){var t=i.value;if(0===t.length)return void s.default.remove(e);s.default.set(e,t)}}},[t,n]),{value:c,setValue:d,onKeyDown:function(e){switch(e.key){case"Escape":e.preventDefault(),c.length?p?i():h(!0):i();break;case"Enter":if(e.preventDefault(),a)break;e.shiftKey?d(function(e){return e+"\n"}):!e.metaKey&&c.length&&c.trim()&&l();break;default:h(!1)}},escPressed:p}}var O=function(e){var t=(0,r._)(e.children,2),n=t[0],o=t[1];return(0,i.jsxs)(b.View,{css:T.footer,px:8,pr:6,row:!0,gap:8,align:"center",children:[(0,i.jsx)(b.View,{grow:!0,shrink:!0,align:"center",row:!0,gap:8,children:n}),(0,i.jsx)(b.View,{row:!0,gap:4,align:"center",children:o})]})},N=(0,f.cssRecord)({default:[h.rcss.width("90%")]}),M=function(e){var t=e.inlineActionType,n=e.closeAction;return(0,i.jsx)(b.View,{css:N.default,children:(0,i.jsx)(m.StatusBanner,{icon:(0,i.jsx)(C.default,{}),colorway:"red",text:"".concat(t," with AI is currently unavailable. Try again later."),closable:!0,closeAction:n})})},L=function(e){var t=e.inlineActionType,n=e.closeAction;return(0,i.jsx)(b.View,{css:N.default,children:(0,i.jsx)(m.StatusBanner,{icon:(0,i.jsx)(C.default,{}),colorway:"blurple",text:"".concat(t," with AI is unavailable while ").concat((0,a.getAgentName)({variant:"casual"})," is running."),closable:!0,closeAction:n})})};e.s(["AgentActiveBanner",()=>L,"COMPACT_WIDTH",()=>400,"ConnectionError",()=>M,"Footer",()=>O,"Input",()=>I,"ModeLabel",()=>A,"PocketBoundary",()=>E,"PocketContainer",()=>R,"Submit",()=>P,"useInputState",()=>D])},111084,743347,e=>{"use strict";var t=e.i(399119),n=e.i(904851),r=e.i(90659),i=e.i(721281),o=e.i(445789),a=e.i(276385),s=e.i(179302),l=e.i(291607),u=e.i(488566),c=e.i(122947),d=e.i(936381),f=e.i(938668);function p(e,t){e.dispatch({effects:d.inlinePocketEffect.of(null),selection:{anchor:t.range.indexTo,head:t.range.indexTo}}),e.hasFocus||e.focus()}function h(e,t,n){(0,c.insertGhostwriterCode)({view:e,insert:t,scrollIntoView:!0,insertAt:n}),e.dispatch({effects:d.inlinePocketEffect.of(null)}),e.hasFocus||e.focus()}function g(e,t){e.dispatch({effects:d.setInlinePocketCodeBlock.of(t)})}function m(e,t,n){e.dispatch({changes:{from:n.range.indexFrom,to:n.range.indexTo,insert:t},scrollIntoView:!0,effects:d.inlinePocketEffect.of(null),annotations:[f.default.of(!0),u.isolateHistory.of("full")]}),e.hasFocus||e.focus()}function x(e,t){return e.range.indexFrom===t.range.indexFrom&&e.range.indexTo===t.range.indexTo&&e.filePath===t.filePath&&e.fileVersion===t.fileVersion&&e.referenceType===t.referenceType}e.s(["closePocket",()=>p,"codeReferenceIsEqual",()=>x,"insertCode",()=>h,"replaceHighlightedAreaWithCode",()=>m,"updateCodeBlock",()=>g],743347);var y=e.i(928353),b=e.i(480028),w=e.i(446530),k=e.i(613355),_=e.i(136540),S=e.i(960178),C=e.i(625484),j=e.i(283110),T=(0,w.cssRecord)({root:[k.rcss.border({color:b.tokens.outlineDimmest}),k.rcss.p(8),k.rcss.borderRadius(4)]}),E=new y.CodeMirrorComponent(function(e){var t=e.onClose,n=e.requestMeasure;return(0,a.jsx)(l.PocketBoundary,{requestMeasure:n,type:"ghostwriterKillswitch",children:(0,a.jsxs)(C.View,{css:T.root,row:!0,gap:8,children:[(0,a.jsx)(C.View,{grow:!0,shrink:!0,children:(0,a.jsx)(S.Text,{children:"Code length exceeded. Please select a smaller code block."})}),(0,a.jsx)(_.IconButton,{alt:"Close",onClick:t,type:"button",children:(0,a.jsx)(j.default,{})})]})})}),R=function(e){function a(e){var r,o=e.codeReference;return(0,n._)(this,a),r=(0,t._)(this,a),(0,i._)(r,"codeReference",void 0),r.codeReference=o,r}return(0,o._)(a,e),(0,r._)(a,[{key:"toDOM",value:function(e){var t=this;return E.create({onClose:function(){return p(e,t.codeReference)},requestMeasure:function(){return e.requestMeasure()}})}}]),a}(s.WidgetType);e.s(["CodeLengthExceededWidget",()=>R],111084)},624859,444573,473041,692910,232557,160727,e=>{"use strict";var t,n=e.i(753950),r=e.i(936381),i=e.i(468345),o=((t={})[t.Compare=0]="Compare",t[t.Original=1]="Original",t[t.Suggestion=2]="Suggestion",t);e.s(["DiffSelection",()=>o],444573);var a=n.StateEffect.define(),s=n.StateField.define({create:function(){return o.Suggestion},update:function(e,t){var n=!0,s=!1,l=void 0;try{for(var u,c=t.effects[Symbol.iterator]();!(n=(u=c.next()).done);n=!0){var d=u.value;if(d.is(a))e=d.value;else if(d.is(r.inlinePocketEffect))e=null;else if(d.is(r.setInlinePocketCodeBlock)){var f=t.state.field(i.InlinePocketState);if((null==f?void 0:f.type)==="transformCode"&&d.value){var p=t.startState.field(i.InlinePocketCodeBlock),h=d.value;!p&&h&&(e=o.Suggestion)}}}}catch(e){s=!0,l=e}finally{try{n||null==c.return||c.return()}finally{if(s)throw l}}return e}});e.s(["DiffSelectionState",()=>s,"ShowDiffSelection",()=>a],624859);var l=e.i(399119),u=e.i(904851),c=e.i(90659),d=e.i(721281),f=e.i(445789),p=e.i(167626),h=e.i(486701),g=e.i(179302);e.i(508987);var m=e.i(457103),x=e.i(441072),y=e.i(736097),b=e.i(495970),w=e.i(731291),k=e.i(680118),_=n.StateField.define({create:function(){return null},update:function(e,t){if(!(0,m.hasChanged)(t,"doc",i.InlinePocketState,y.fileName,s,i.InlinePocketCodeBlock))return e;var n,r=t.state.field(i.InlinePocketState),a=t.state.facet(y.fileName),l=t.state.field(s);if(!r||!a||r.codeReference.filePath!==a||l!==o.Suggestion)return null;var u=r.codeReference.range.indexFrom,c=r.codeReference.range.indexTo,d=t.state.doc.slice(u,c),f=null!=(n=t.state.field(i.InlinePocketCodeBlock))?n:"",p=d.lines,h=f.split(t.state.lineBreak).length-p;return e&&e.after===u&&e.offset===h?e:{after:u,offset:h}}}),S=b.LineNumberLineHandlers.of(function(e,t){var n=e.state.doc.lineAt(t.from),r=e.state.field(_);if(r&&!(n.from<=r.after))return new b.NumberMarker(n.number+r.offset)}),C=b.LineNumberWidgetHandlers.of(function(e,t){if((0,p._)(t,j))return new b.NumberMarker(t.index)}),j=function(e){function t(e,n,r){var i;return(0,u._)(this,t),i=(0,l._)(this,t),(0,d._)(i,"line",void 0),(0,d._)(i,"block",void 0),(0,d._)(i,"index",void 0),i.line=e,i.block=n,i.index=r,i}return(0,f._)(t,e),(0,c._)(t,[{key:"estimatedHeight",get:function(){return 21}},{key:"toDOM",value:function(){var e=document.createElement(this.block?"div":"span");e.className=this.block?"cm-line":"";var t=!0,n=!1,r=void 0;try{for(var i,o=this.line[Symbol.iterator]();!(t=(i=o.next()).done);t=!0){var a=i.value,s=a.text,l=a.tags,u=document.createElement("span");u.textContent=s||"",l&&(u.className=l),e.appendChild(u)}}catch(e){n=!0,r=e}finally{try{t||null==o.return||o.return()}finally{if(n)throw r}}return e}},{key:"eq",value:function(e){return this.index===e.index&&(0,w.highlightedLinesEqual)(this.line,e.line)}},{key:"ignoreEvent",value:function(){return!1}}]),t}(g.WidgetType),T=[_,S,C,g.EditorView.decorations.compute([h.language,i.InlinePocketState,i.InlinePocketCodeBlock,s,x.TransformDiffState,y.fileName,n.EditorState.lineSeparator],function(e){var t=e.field(i.InlinePocketState),n=e.facet(y.fileName),r=e.field(s);if(!t||"transformCode"!==t.type||!n||t.codeReference.filePath!==n||r!==o.Suggestion)return g.Decoration.none;var a=t.codeReference.range.indexFrom,l=t.codeReference.range.indexTo,u=e.doc.lineAt(a),c=e.doc.lineAt(l),d=e.toText(null!=(E=e.field(i.InlinePocketCodeBlock))?E:""),f=e.changes({from:a,to:l,insert:d}),p=f.apply(e.doc),m=a+d.length,x=null==(T=e.facet(h.language))?void 0:T.parser,b=null;if(x)b=(0,k.getIncrementallyParsedTree)({parser:x,text:p,changes:f,base:e,upTo:m}),R=(0,w.treeToHighlightedLines)(b,p,e,a,m);else{R=[];var _=!0,S=!1,C=void 0;try{for(var T,E,R,I,A=d.iterLines()[Symbol.iterator]();!(_=(I=A.next()).done);_=!0){var P=I.value;R.push([{text:P}])}}catch(e){S=!0,C=e}finally{try{_||null==A.return||A.return()}finally{if(S)throw C}}}var D=[];R.length>1&&a!==l&&0!==c.length&&l===c.to&&l<e.doc.length?D.push(g.Decoration.replace({inclusive:!1,block:!0}).range(a,l)):D.push(g.Decoration.replace({inclusiveStart:!1,block:!0}).range(a,l));for(var O=0;O<R.length;O++){var N=R[O],M=u.number+O,L=g.Decoration.widget({widget:new j(N,O>0,M),inlineOrder:!0,side:O+1,block:O>0});D.push(L.range(a))}return g.Decoration.set(D,!0)})];e.s(["RenderSuggestionForInlinePocket",()=>T],473041);var E=e.i(297083),R=e.i(530658),I=e.i(817556),A=e.i(276385),P=e.i(389959),D=e.i(131141),O=e.i(188507);e.i(877212);var N=e.i(970187),M=e.i(924908),L=e.i(51553),B=e.i(291607),V=e.i(743347),F=e.i(928353),U=e.i(700170);e.i(925218);var G=e.i(641555),$=e.i(98816),z=e.i(858248),H=e.i(709485),W=e.i(878420),q=e.i(64386),K=e.i(886513),Y=e.i(446530),Q=e.i(613355),X=e.i(960178),J=e.i(625484),Z=e.i(33914),ee=e.i(693188),et=e.i(239337),en=e.i(770257),er=new Map([[O.ModelType.BASIC,Z.default],[O.ModelType.ADVANCED,ee.default]]);function ei(e){var t=e.model,n=(0,K._)(e,["model"]),r=er.get(t);return r?(0,A.jsx)(r,(0,W._)({},n)):null}O.ModelType.BASIC,O.ModelType.ADVANCED;var eo=new Map([[O.MessageAction.GENERATE,en.default],[O.MessageAction.TRANSFORM,en.default],[O.MessageAction.EXPLAIN,et.default],[O.MessageAction.REPLIT_DOCS,et.default]]),ea=new Map([[O.MessageAction.GENERATE,"Generate"],[O.MessageAction.TRANSFORM,"Modify"],[O.MessageAction.EXPLAIN,"Explain"],[O.MessageAction.REPLIT_DOCS,"Ask replit.com"]]),es=new Map([[O.InlineMessageType.GENERATE_CODE,en.default],[O.InlineMessageType.TRANSFORM_CODE,en.default],[O.InlineMessageType.EXPLAIN_CODE,et.default],[O.InlineMessageType.DEBUGGER,et.default]]),el=new Map([[O.InlineMessageType.GENERATE_CODE,"Generate"],[O.InlineMessageType.TRANSFORM_CODE,"Modify"],[O.InlineMessageType.EXPLAIN_CODE,"Explain"],[O.InlineMessageType.DEBUGGER,"Debug"]]),eu=(0,Y.cssRecord)({iconLabel:[Q.rcss.rowWithGap(4),Q.rcss.align.center]});function ec(e){var t=e.intent,n=e.icon,r=e.text,i=eo.get(t),o=ea.get(t);return i&&o?(0,A.jsxs)(J.View,{css:eu.iconLabel,children:[(0,A.jsx)(i,(0,W._)({},n)),(0,A.jsx)(X.Text,(0,q._)((0,W._)({},r),{children:o}))]}):null}function ed(e){var t=e.type,n=e.icon,r=e.text,i=es.get(t),o=el.get(t);return i&&o?(0,A.jsxs)(J.View,{css:eu.iconLabel,children:[(0,A.jsx)(i,(0,W._)({},n)),(0,A.jsx)(X.Text,(0,q._)((0,W._)({},r),{children:o}))]}):null}e.s(["InlineActionIconLabel",()=>ed,"IntentIconLabel",()=>ec,"ModelIcon",()=>ei],692910);var ef=e.i(462995),ep=e.i(242719),eh=e.i(939652),eg=e.i(480028),em=e.i(140487),ev=e.i(136540),ex=e.i(819700),ey=e.i(658886),eb=e.i(283110),ew=e.i(940745),ek=e.i(566818),e_=n.Facet.define({combine:function(e){var t;return null!=(t=e[0])?t:function(){}}});new U.ReactCompartment(function(e){return e_.of(e)});var eS=(0,Y.cssRecord)({root:[Q.rcss.border({color:eg.tokens.outlineDimmest}),Q.rcss.p(8),Q.rcss.borderRadius(4)],header:[Q.rcss.minHeight(28)]}),eC={direction:"reverse",state:{message:"",completed:!1},reducer:function(e,t){var n;(null==(n=e.contents.contents)?void 0:n.$kind)==="inlineActionEventContents"&&e.contents.contents.inlineActionEventContents.content&&(t.message=e.contents.contents.inlineActionEventContents.content,t.completed=e.state===O.EventState.COMPLETE)}},ej=new F.CodeMirrorComponent(function(e){var t,n,r,i,o,a,s,l,u,c,d,f,p,h,g=e.requestMeasure,m=e.codeReference,x=e.onClose,y=e.openAiChatPane,b=e.source,w=(t=({getFileContext:(0,eh.useGetSessionFileContext)()}).getFileContext,n=(0,M.useChatter)(),i=(r=(0,R._)((0,P.useState)(null),2))[0],o=r[1],s=(a=(0,R._)((0,P.useState)(!1),2))[0],l=a[1],u=(0,N.useAssistantInlineMode)().assistantInlineMode,c=(0,P.useCallback)(function(e){var r=e.codeReference;return(0,E._)(function(){var e,i,a,s,c;return(0,I._)(this,function(d){switch(d.label){case 0:return l(!0),[4,n.sessions.create({sessionType:O.SessionType.CHAT})];case 1:if(!(e=d.sent()).ok)return l(!1),[2];return o(i=e.payload),[4,t()];case 2:return s=(a=d.sent()).fileContext,c=a.mostRecentFile,[4,i.appendEvent({kind:"inlineAction",message:"",messageType:O.InlineMessageType.EXPLAIN_CODE,modelType:"advanced"===u?O.ModelType.ADVANCED:O.ModelType.BASIC,codeReference:r,fileContext:s,mostRecentFile:c,useRag:!0})];case 3:return d.sent(),[2]}})})()},[n.sessions,t,u]),d=(0,P.useCallback)(function(){return(0,E._)(function(){return(0,I._)(this,function(e){switch(e.label){case 0:if(!i)return[3,2];return[4,i.abortLastEvent()];case 1:e.sent(),l(!1),e.label=2;case 2:return[2]}})})()},[i]),p=(f=(0,G.useObservableMemo)(function(){return null==i?void 0:i.reduce(eC,1)},[i],{default:{message:"",completed:!1}})).message,h=f.completed,{sessionId:null==i?void 0:i.id,sendMessage:c,stopMessage:d,loading:s,message:p,completed:h}),k=w.sessionId,_=w.sendMessage,S=w.stopMessage,C=w.loading,j=w.completed,T=w.message,D=(0,P.useCallback)(function(){var e,t;(0,z.track)(H.events.AI_INLINE_EVENT,{action:"message_sent",intent_type:"explain",source:b,message_content:m.code}),_({codeReference:{code:m.code,range:m.range,filePath:m.filePath,fileContent:null!=(e=m.fileContent)?e:"",fileVersion:m.fileVersion,language:null!=(t=m.language)?t:"",referenceType:O.CodeReferenceType.INLINE}})},[_,m,b]),V=(0,$.default)(D),F=(0,$.default)(S);(0,P.useEffect)(function(){V.current();var e=F.current;return function(){e()}},[V,F]);var U=(0,L.useIsAiClientConnected)();return(0,L.useIsRiverProtocolError)()?(0,A.jsx)(B.ConnectionError,{inlineActionType:"Explain",closeAction:x}):(0,A.jsx)(B.PocketBoundary,{requestMeasure:g,type:"explainCode",children:(0,A.jsxs)(J.View,{css:eS.root,gap:8,dataCy:"ghostwriter-inline-explain-content",children:[T||C?(0,A.jsxs)(J.View,{css:eS.header,row:!0,gap:8,align:"center",justify:"space-between",children:[(0,A.jsxs)(J.View,{grow:!0,shrink:!0,row:!0,gap:8,align:"center",children:[(0,A.jsx)(ex.default,{}),(0,A.jsx)(ec,{intent:O.MessageAction.EXPLAIN,text:{color:"dimmest",variant:"small"},icon:{color:eg.tokens.foregroundDimmest}})]}),j?(0,A.jsx)(ev.IconButton,{alt:"Close",dataCy:"ghostwriter-inline-close",children:(0,A.jsx)(eb.default,{onClick:function(){x(),(0,z.track)(H.events.AI_INLINE_EVENT,{action:"inline_textbox_closed",intent_type:"explain",source:b})}})}):(0,A.jsx)(em.Button,{iconLeft:(0,A.jsx)(ek.default,{}),size:"small",text:"Stop",onClick:function(){S(),(0,z.track)(H.events.AI_INLINE_EVENT,{action:"generation_stopped",intent_type:"explain",source:b,message_content:m.code})}})]}):null,C&&!T?(0,A.jsx)(ew.default,{}):null,T?(0,A.jsx)(ef.MessageMarkdown,{text:T,codeComponent:ef.MarkdownCode,messageState:j?O.EventState.COMPLETE:void 0}):null,j?(0,A.jsxs)(J.View,{row:!0,gap:8,align:"center",justify:"end",children:[(0,A.jsx)(X.Text,{variant:"small",color:"dimmer",children:"Esc to close"}),k?(0,A.jsx)(em.Button,{dataCy:"ghostwriter-inline-reply-in-chat",iconLeft:U?(0,A.jsx)(ey.default,{}):(0,A.jsx)(ew.default,{}),disabled:!U,size:"small",text:"Reply in Chat",colorway:U?"blurple":void 0,onClick:function(){(0,z.track)(H.events.AI_INLINE_EVENT,{action:"reply_in_chat",intent_type:"explain",source:b,message_content:m.code}),y(k),x()}}):null]}):null]})})}),eT=function(e){function t(e){var n,r=e.codeReference,i=e.source;return(0,u._)(this,t),n=(0,l._)(this,t),(0,d._)(n,"codeReference",void 0),(0,d._)(n,"source",void 0),n.codeReference=r,n.source=i,n}return(0,f._)(t,e),(0,c._)(t,[{key:"toDOM",value:function(e){var t=this.codeReference,n=this.source;return ej.create({requestMeasure:function(){return e.requestMeasure()},codeReference:t,onClose:function(){return(0,V.closePocket)(e,t)},openAiChatPane:function(t){return(0,ep.openPane)(e.state,{pane:{type:"ghostwriterChat",data:{sessionId:t}}})},source:n})}},{key:"updateDOM",value:function(e,t){var n=this.codeReference;return ej.update(e,function(e){return(0,D.produce)(e,function(e){e.requestMeasure=function(){return t.requestMeasure()},e.codeReference=n,e.onClose=function(){return(0,V.closePocket)(t,n)}})}),!0}},{key:"eq",value:function(e){return(0,V.codeReferenceIsEqual)(this.codeReference,e.codeReference)}}]),t}(g.WidgetType);e.s(["ExplainCodeWidget",()=>eT],232557);var eE=e.i(128068),eR=e.i(802088),eI={direction:"reverse",state:{code:void 0,completed:!1,error:null},reducer:function(e,t){var n;if((null==(n=e.contents.contents)?void 0:n.$kind)==="inlineActionEventContents"&&e.contents.contents.inlineActionEventContents){var r=e.contents.contents.inlineActionEventContents;if(r.content&&r.content.includes("```")){var i=r.content.match(/```(?:\w+)?\n([\s\S]+?)\n```/);i&&i[1]&&(t.code=i[1])}t.completed=e.state===O.EventState.COMPLETE&&!!t.code,e.state!==O.EventState.COMPLETE&&e.state!==O.EventState.IN_PROGRESS&&(t.error="Failed to generate code")}}};function eA(e){var t,n=e.onCode,r=e.getFileContext,i=e.assistantMode,o=(0,M.useChatter)(),a=(0,R._)((0,P.useState)(null),2),s=a[0],l=a[1],u=(0,R._)((0,P.useState)(!1),2),c=u[0],d=u[1],f=(0,R._)((0,P.useState)(null),2),p=f[0],h=f[1],g=(0,P.useCallback)(function(e){return(0,E._)(function(){var t,n,a,u;return(0,I._)(this,function(c){switch(c.label){case 0:if(d(!0),h(null),t=s)return[3,2];return[4,o.sessions.create({sessionType:O.SessionType.INLINE_CHAT})];case 1:if(!(n=c.sent()).ok)return d(!1),h("Failed to create session"),[2];l(t=n.payload),c.label=2;case 2:if(!r)return[3,6];c.label=3;case 3:return c.trys.push([3,5,,6]),[4,r()];case 4:return a=c.sent(),[3,6];case 5:return c.sent(),d(!1),h("Failed to get file context"),[2];case 6:u="advanced"===i?O.ModelType.ADVANCED:O.ModelType.BASIC,c.label=7;case 7:return c.trys.push([7,9,,10]),[4,t.appendEvent({kind:"inlineAction",message:e.message,messageType:e.type,modelType:u,codeReference:e.codeReference,fileContext:null==a?void 0:a.fileContext,mostRecentFile:null==a?void 0:a.mostRecentFile,useRag:!0})];case 8:return c.sent(),[3,10];case 9:return c.sent(),d(!1),h("Failed to send message"),[3,10];case 10:return[2]}})})()},[o.sessions,s,r,i]),m=(0,P.useCallback)(function(){return(0,E._)(function(){return(0,I._)(this,function(e){switch(e.label){case 0:if(!s)return[3,2];return[4,s.abortLastEvent()];case 1:e.sent(),d(!1),e.label=2;case 2:return[2]}})})()},[s]),x=(0,P.useCallback)(function(){return h(null)},[]),y=(0,P.useMemo)(function(){return null==s?void 0:s.reduce(eI,1).result},[s]),b=(0,eE.useObservableRef)(y);return(0,eR.useObserver)(y,{next:function(e){(null==e?void 0:e.completed)&&c&&d(!1),(null==e?void 0:e.error)&&!p&&h(e.error),(null==e?void 0:e.code)&&n(e.code)}}),{sendMessage:g,stopMessage:m,getCode:function(){return b.current},loading:c,completed:null==(t=b.current)?void 0:t.completed,error:p,clearError:x}}e.s(["useInlineMessage",()=>eA],160727)},182116,e=>{"use strict";var t=e.i(399119),n=e.i(904851),r=e.i(90659),i=e.i(721281),o=e.i(445789),a=e.i(530658),s=e.i(276385),l=e.i(389959),u=e.i(131141),c=e.i(541793),d=e.i(161322),f=e.i(188507);e.i(877212);var p=e.i(970187),h=e.i(51553),g=e.i(334712),m=e.i(179302),x=e.i(291607),y=e.i(160727),b=e.i(743347),w=e.i(928353),k=e.i(649960),_=e.i(858248),S=e.i(709485),C=e.i(323049),j=e.i(417120),T=e.i(939652),E=e.i(140487),R=e.i(136540),I=e.i(121817),A=(0,c.atom)(0),P=(0,c.atom)(function(e){return e(A)<=x.COMPACT_WIDTH?"compact":"normal"}),D=new w.CodeMirrorComponent(function(e){var t=e.id,n=e.requestMeasure,r=e.codeReference,i=e.updateCodeBlock,o=e.acceptSuggestion,u=e.onClose,m=e.autoFocus,b=e.source,w=function(){var e=F();(null==e?void 0:e.code)?(o(e.code),(0,_.track)(S.events.AI_INLINE_EVENT,{action:"suggestion_accepted",intent_type:"generate",message_content:e.code,source:b})):H()},C=function(){var e,t;q.current=Q,(0,_.track)(S.events.AI_INLINE_EVENT,{action:"message_sent",intent_type:"generate",message_content:Q,source:b}),B({message:Q,type:f.InlineMessageType.GENERATE_CODE,codeReference:{code:r.code,range:r.range,filePath:r.filePath,fileContent:null!=(e=r.fileContent)?e:"",fileVersion:r.fileVersion,language:null!=(t=r.language)?t:"",referenceType:f.CodeReferenceType.INLINE}})},D=(0,p.useAssistantInlineMode)().assistantInlineMode,O=(0,h.useConfig)().hasAccessToAdvancedModel,N=(0,g.useInlineActionModels)(),M=(0,T.useGetSessionFileContext)(),L=(0,y.useInlineMessage)({onCode:i,getFileContext:M,assistantMode:D}),B=L.sendMessage,V=L.stopMessage,F=L.getCode,U=L.loading,G=L.completed,$=L.error,z=L.clearError,H=(0,l.useCallback)(function(){V(),u()},[V,u]),W=(0,l.useCallback)(function(){(0,_.track)(S.events.AI_INLINE_EVENT,{action:"inline_textbox_closed",intent_type:"generate",source:b}),H()},[H,b]),q=(0,l.useRef)(null),K=(0,l.useRef)(null),Y=(0,x.useInputState)({id:t,inputRef:K,loading:U,onSubmit:function(){er?w():C()},onClose:W}),Q=Y.value,X=Y.setValue,J=Y.onKeyDown,Z=Y.escPressed,ee=function(){(0,_.track)(S.events.AI_INLINE_EVENT,{action:"generation_stopped",intent_type:"generate",message_content:Q,source:b}),V()},et=(0,h.useIsAiClientConnected)(),en=(0,h.useIsRiverProtocolError)(),er=et&&G&&q.current===Q,ei=(0,a._)((0,l.useState)(function(){return(0,c.createStore)()}),1)[0],eo=(0,d.useSetAtom)(A,{store:ei}),ea=(0,d.useAtomValue)(P,{store:ei}),es=(0,k.default)(function(e){return eo(e.width)}),el=(0,j.useAgentRunState)(),eu=el===f.AgentRunState.AGENT_STATE_RUNNING||el===f.AgentRunState.AGENT_STATE_PAUSING;return en?(0,s.jsx)(x.ConnectionError,{inlineActionType:"Generate",closeAction:H}):eu?(0,s.jsx)(x.AgentActiveBanner,{inlineActionType:"Generate",closeAction:H}):(0,s.jsx)(s.Fragment,{children:(0,s.jsxs)(x.PocketContainer,{requestMeasure:n,type:"generateCode",error:$,clearError:z,innerRef:es,children:[(0,s.jsx)(x.Input,{value:Q,inputRef:K,onChange:function(e){return X(e.currentTarget.value)},placeholder:"Enter a prompt to generate new code",onKeyDown:J,autoFocus:m}),(0,s.jsxs)(x.Footer,{children:[(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(x.ModeLabel,{type:"generateCode",readableModelName:O?N.advancedModel.name.readable:N.basicModel.name.readable}),G?(0,s.jsx)(R.IconButton,{disabled:!et,alt:"Rerun the same prompt",onClick:function(){return C()},size:12,colorway:"grey",children:(0,s.jsx)(I.default,{})}):null]}),er?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(E.Button,{variant:"outlined",size:"small",text:"Reject",onClick:function(){var e=F();(0,_.track)(S.events.AI_INLINE_EVENT,{action:"suggestion_rejected",intent_type:"generate",message_content:(null==e?void 0:e.code)?e.code:"",source:b}),W()}}),(0,s.jsx)(E.Button,{size:"small",text:"Accept",colorway:"blurple",onClick:w,dataCy:"ghostwriter-inline-accept-suggestion"})]}):(0,s.jsx)(x.Submit,{escPressed:Z,connecting:!et,loading:U,disabled:!Q||!Q.trim(),promptPresentation:"normal"===ea,onClick:function(){U?ee():C()}})]})]})})}),O=function(e){function a(e){var r,o=e.id,s=e.codeReference,l=e.source;return(0,n._)(this,a),r=(0,t._)(this,a),(0,i._)(r,"id",void 0),(0,i._)(r,"codeReference",void 0),(0,i._)(r,"source",void 0),r.id=o,r.codeReference=s,r.source=l,r}return(0,o._)(a,e),(0,r._)(a,[{key:"toDOM",value:function(e){var t=this.id,n=this.codeReference,r=this.source,i=D.create({id:t,requestMeasure:function(){return e.requestMeasure()},codeReference:n,onClose:function(){return(0,b.closePocket)(e,n)},acceptSuggestion:function(t){return(0,b.insertCode)(e,t,n.range.indexFrom)},updateCodeBlock:function(t){return(0,b.updateCodeBlock)(e,t)},autoFocus:!0,source:r});return i.style.position="sticky",i.style.top="0px",i.style.zIndex=String(C.zIndexLevels.floatingHeaderActive),i}},{key:"updateDOM",value:function(e,t){var n=this.codeReference;return D.update(e,function(e){return(0,u.produce)(e,function(e){e.requestMeasure=function(){return t.requestMeasure()},e.codeReference=n,e.onClose=function(){return(0,b.closePocket)(t,n)},e.acceptSuggestion=function(e){return(0,b.insertCode)(t,e,n.range.indexFrom)},e.updateCodeBlock=function(e){return(0,b.updateCodeBlock)(t,e)},e.autoFocus=!1})}),!0}},{key:"eq",value:function(e){return(0,b.codeReferenceIsEqual)(this.codeReference,e.codeReference)}}]),a}(m.WidgetType);e.s(["GenerateCodeWidget",()=>O])},930623,(e,t,n)=>{"use strict";var r=e.r(954546);function i(e){return"string"==typeof e||r._(e,String)}function o(e){return Array.isArray(e)}Object.defineProperty(n,"__esModule",{value:!0}),n.stringArray=n.array=n.func=n.error=n.number=n.string=n.boolean=void 0,n.boolean=function(e){return!0===e||!1===e},n.string=i,n.number=function(e){return"number"==typeof e||r._(e,Number)},n.error=function(e){return r._(e,Error)},n.func=function(e){return"function"==typeof e},n.array=o,n.stringArray=function(e){return o(e)&&e.every(function(e){return i(e)})}},995606,(e,t,n)=>{"use strict";var r,i,o,a=e.r(772929),s=e.r(883735),l=e.r(619314),u=e.r(559542),c=e.r(873719);Object.defineProperty(n,"__esModule",{value:!0}),n.Message=n.NotificationType9=n.NotificationType8=n.NotificationType7=n.NotificationType6=n.NotificationType5=n.NotificationType4=n.NotificationType3=n.NotificationType2=n.NotificationType1=n.NotificationType0=n.NotificationType=n.RequestType9=n.RequestType8=n.RequestType7=n.RequestType6=n.RequestType5=n.RequestType4=n.RequestType3=n.RequestType2=n.RequestType1=n.RequestType=n.RequestType0=n.AbstractMessageSignature=n.ParameterStructures=n.ResponseError=n.ErrorCodes=void 0;var d=e.r(930623);(r=o=n.ErrorCodes||(n.ErrorCodes={})).ParseError=-32700,r.InvalidRequest=-32600,r.MethodNotFound=-32601,r.InvalidParams=-32602,r.InternalError=-32603,r.jsonrpcReservedErrorRangeStart=-32099,r.serverErrorStart=-32099,r.MessageWriteError=-32099,r.MessageReadError=-32098,r.PendingResponseRejected=-32097,r.ConnectionInactive=-32096,r.ServerNotInitialized=-32002,r.UnknownErrorCode=-32001,r.jsonrpcReservedErrorRangeEnd=-32e3,r.serverErrorEnd=-32e3,n.ResponseError=function(e){function t(e,n,r){var i;return s._(this,t),(i=a._(this,t,[n])).code=d.number(e)?e:o.UnknownErrorCode,i.data=r,Object.setPrototypeOf(i,t.prototype),i}return u._(t,e),l._(t,[{key:"toJson",value:function(){var e={code:this.code,message:this.message};return void 0!==this.data&&(e.data=this.data),e}}]),t}(c._(Error));var f=function(){function e(t){s._(this,e),this.kind=t}return l._(e,[{key:"toString",value:function(){return this.kind}}],[{key:"is",value:function(t){return t===e.auto||t===e.byName||t===e.byPosition}}]),e}();n.ParameterStructures=f,f.auto=new f("auto"),f.byPosition=new f("byPosition"),f.byName=new f("byName");var p=function(){function e(t,n){s._(this,e),this.method=t,this.numberOfParams=n}return l._(e,[{key:"parameterStructures",get:function(){return f.auto}}]),e}();n.AbstractMessageSignature=p,n.RequestType0=function(e){function t(e){return s._(this,t),a._(this,t,[e,0])}return u._(t,e),t}(p),n.RequestType=function(e){function t(e){var n,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:f.auto;return s._(this,t),(n=a._(this,t,[e,1]))._parameterStructures=r,n}return u._(t,e),l._(t,[{key:"parameterStructures",get:function(){return this._parameterStructures}}]),t}(p),n.RequestType1=function(e){function t(e){var n,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:f.auto;return s._(this,t),(n=a._(this,t,[e,1]))._parameterStructures=r,n}return u._(t,e),l._(t,[{key:"parameterStructures",get:function(){return this._parameterStructures}}]),t}(p),n.RequestType2=function(e){function t(e){return s._(this,t),a._(this,t,[e,2])}return u._(t,e),t}(p),n.RequestType3=function(e){function t(e){return s._(this,t),a._(this,t,[e,3])}return u._(t,e),t}(p),n.RequestType4=function(e){function t(e){return s._(this,t),a._(this,t,[e,4])}return u._(t,e),t}(p),n.RequestType5=function(e){function t(e){return s._(this,t),a._(this,t,[e,5])}return u._(t,e),t}(p),n.RequestType6=function(e){function t(e){return s._(this,t),a._(this,t,[e,6])}return u._(t,e),t}(p),n.RequestType7=function(e){function t(e){return s._(this,t),a._(this,t,[e,7])}return u._(t,e),t}(p),n.RequestType8=function(e){function t(e){return s._(this,t),a._(this,t,[e,8])}return u._(t,e),t}(p),n.RequestType9=function(e){function t(e){return s._(this,t),a._(this,t,[e,9])}return u._(t,e),t}(p),n.NotificationType=function(e){function t(e){var n,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:f.auto;return s._(this,t),(n=a._(this,t,[e,1]))._parameterStructures=r,n}return u._(t,e),l._(t,[{key:"parameterStructures",get:function(){return this._parameterStructures}}]),t}(p),n.NotificationType0=function(e){function t(e){return s._(this,t),a._(this,t,[e,0])}return u._(t,e),t}(p),n.NotificationType1=function(e){function t(e){var n,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:f.auto;return s._(this,t),(n=a._(this,t,[e,1]))._parameterStructures=r,n}return u._(t,e),l._(t,[{key:"parameterStructures",get:function(){return this._parameterStructures}}]),t}(p),n.NotificationType2=function(e){function t(e){return s._(this,t),a._(this,t,[e,2])}return u._(t,e),t}(p),n.NotificationType3=function(e){function t(e){return s._(this,t),a._(this,t,[e,3])}return u._(t,e),t}(p),n.NotificationType4=function(e){function t(e){return s._(this,t),a._(this,t,[e,4])}return u._(t,e),t}(p),n.NotificationType5=function(e){function t(e){return s._(this,t),a._(this,t,[e,5])}return u._(t,e),t}(p),n.NotificationType6=function(e){function t(e){return s._(this,t),a._(this,t,[e,6])}return u._(t,e),t}(p),n.NotificationType7=function(e){function t(e){return s._(this,t),a._(this,t,[e,7])}return u._(t,e),t}(p),n.NotificationType8=function(e){function t(e){return s._(this,t),a._(this,t,[e,8])}return u._(t,e),t}(p),n.NotificationType9=function(e){function t(e){return s._(this,t),a._(this,t,[e,9])}return u._(t,e),t}(p),(i=n.Message||(n.Message={})).isRequest=function(e){return e&&d.string(e.method)&&(d.string(e.id)||d.number(e.id))},i.isNotification=function(e){return e&&d.string(e.method)&&void 0===e.id},i.isResponse=function(e){return e&&(void 0!==e.result||!!e.error)&&(d.string(e.id)||d.number(e.id)||null===e.id)}},97504,(e,t,n)=>{"use strict";var r,i,o,a=e.r(772929),s=e.r(883735),l=e.r(619314),u=e.r(109133),c=e.r(940193),d=e.r(879617),f=e.r(559542),p=e.r(316330);Object.defineProperty(n,"__esModule",{value:!0}),n.LRUCache=n.LinkedMap=n.Touch=void 0,(r=o=n.Touch||(n.Touch={})).None=0,r.First=1,r.AsOld=r.First,r.Last=2,r.AsNew=r.Last;var h=function(){function e(){s._(this,e),this[i]="LinkedMap",this._map=new Map,this._head=void 0,this._tail=void 0,this._size=0,this._state=0}return l._(e,[{key:"clear",value:function(){this._map.clear(),this._head=void 0,this._tail=void 0,this._size=0,this._state++}},{key:"isEmpty",value:function(){return!this._head&&!this._tail}},{key:"size",get:function(){return this._size}},{key:"first",get:function(){var e;return null==(e=this._head)?void 0:e.value}},{key:"last",get:function(){var e;return null==(e=this._tail)?void 0:e.value}},{key:"has",value:function(e){return this._map.has(e)}},{key:"get",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:o.None,n=this._map.get(e);if(n)return t!==o.None&&this.touch(n,t),n.value}},{key:"set",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:o.None,r=this._map.get(e);if(r)r.value=t,n!==o.None&&this.touch(r,n);else{switch(r={key:e,value:t,next:void 0,previous:void 0},n){case o.None:this.addItemLast(r);break;case o.First:this.addItemFirst(r);break;case o.Last:default:this.addItemLast(r)}this._map.set(e,r),this._size++}return this}},{key:"delete",value:function(e){return!!this.remove(e)}},{key:"remove",value:function(e){var t=this._map.get(e);if(t)return this._map.delete(e),this.removeItem(t),this._size--,t.value}},{key:"shift",value:function(){if(this._head||this._tail){if(!this._head||!this._tail)throw Error("Invalid list");var e=this._head;return this._map.delete(e.key),this.removeItem(e),this._size--,e.value}}},{key:"forEach",value:function(e,t){for(var n=this._state,r=this._head;r;){if(t?e.bind(t)(r.value,r.key,this):e(r.value,r.key,this),this._state!==n)throw Error("LinkedMap got modified during iteration.");r=r.next}}},{key:"keys",value:function(){var e,t=this,n=this._state,r=this._head,i=(e={},u._(e,Symbol.iterator,function(){return i}),u._(e,"next",function(){if(t._state!==n)throw Error("LinkedMap got modified during iteration.");if(!r)return{value:void 0,done:!0};var e={value:r.key,done:!1};return r=r.next,e}),e);return i}},{key:"values",value:function(){var e,t=this,n=this._state,r=this._head,i=(e={},u._(e,Symbol.iterator,function(){return i}),u._(e,"next",function(){if(t._state!==n)throw Error("LinkedMap got modified during iteration.");if(!r)return{value:void 0,done:!0};var e={value:r.value,done:!1};return r=r.next,e}),e);return i}},{key:"entries",value:function(){var e,t=this,n=this._state,r=this._head,i=(e={},u._(e,Symbol.iterator,function(){return i}),u._(e,"next",function(){if(t._state!==n)throw Error("LinkedMap got modified during iteration.");if(!r)return{value:void 0,done:!0};var e={value:[r.key,r.value],done:!1};return r=r.next,e}),e);return i}},{key:(i=Symbol.toStringTag,Symbol.iterator),value:function(){return this.entries()}},{key:"trimOld",value:function(e){if(!(e>=this.size)){if(0===e)return void this.clear();for(var t=this._head,n=this.size;t&&n>e;)this._map.delete(t.key),t=t.next,n--;this._head=t,this._size=n,t&&(t.previous=void 0),this._state++}}},{key:"addItemFirst",value:function(e){if(this._head||this._tail)if(this._head)e.next=this._head,this._head.previous=e;else throw Error("Invalid list");else this._tail=e;this._head=e,this._state++}},{key:"addItemLast",value:function(e){if(this._head||this._tail)if(this._tail)e.previous=this._tail,this._tail.next=e;else throw Error("Invalid list");else this._head=e;this._tail=e,this._state++}},{key:"removeItem",value:function(e){if(e===this._head&&e===this._tail)this._head=void 0,this._tail=void 0;else if(e===this._head){if(!e.next)throw Error("Invalid list");e.next.previous=void 0,this._head=e.next}else if(e===this._tail){if(!e.previous)throw Error("Invalid list");e.previous.next=void 0,this._tail=e.previous}else{var t=e.next,n=e.previous;if(!t||!n)throw Error("Invalid list");t.previous=n,n.next=t}e.next=void 0,e.previous=void 0,this._state++}},{key:"touch",value:function(e,t){if(!this._head||!this._tail)throw Error("Invalid list");if(t===o.First||t===o.Last){if(t===o.First){if(e===this._head)return;var n=e.next,r=e.previous;e===this._tail?(r.next=void 0,this._tail=r):(n.previous=r,r.next=n),e.previous=void 0,e.next=this._head,this._head.previous=e,this._head=e,this._state++}else if(t===o.Last){if(e===this._tail)return;var i=e.next,a=e.previous;e===this._head?(i.previous=void 0,this._head=i):(i.previous=a,a.next=i),e.next=void 0,e.previous=this._tail,this._tail.next=e,this._tail=e,this._state++}}}},{key:"toJSON",value:function(){var e=[];return this.forEach(function(t,n){e.push([n,t])}),e}},{key:"fromJSON",value:function(e){this.clear();var t=!0,n=!1,r=void 0;try{for(var i,o=e[Symbol.iterator]();!(t=(i=o.next()).done);t=!0){var a=p._(i.value,2),s=a[0],l=a[1];this.set(s,l)}}catch(e){n=!0,r=e}finally{try{t||null==o.return||o.return()}finally{if(n)throw r}}}}]),e}();n.LinkedMap=h,n.LRUCache=function(e){function t(e){var n,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return s._(this,t),(n=a._(this,t))._limit=e,n._ratio=Math.min(Math.max(0,r),1),n}return f._(t,e),l._(t,[{key:"limit",get:function(){return this._limit},set:function(e){this._limit=e,this.checkTrim()}},{key:"ratio",get:function(){return this._ratio},set:function(e){this._ratio=Math.min(Math.max(0,e),1),this.checkTrim()}},{key:"get",value:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:o.AsNew;return c._(d._(t.prototype),"get",this).call(this,e,n)}},{key:"peek",value:function(e){return c._(d._(t.prototype),"get",this).call(this,e,o.None)}},{key:"set",value:function(e,n){return c._(d._(t.prototype),"set",this).call(this,e,n,o.Last),this.checkTrim(),this}},{key:"checkTrim",value:function(){this.size>this._limit&&this.trimOld(Math.round(this._limit*this._ratio))}}]),t}(h)},303372,(e,t,n)=>{"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.Disposable=void 0,(n.Disposable||(n.Disposable={})).create=function(e){return{dispose:e}}},537398,(e,t,n)=>{"use strict";var r;function i(){if(void 0===r)throw Error("No runtime abstraction layer installed");return r}Object.defineProperty(n,"__esModule",{value:!0}),(i||(i={})).install=function(e){if(void 0===e)throw Error("No runtime abstraction layer provided");r=e},n.default=i},561827,(e,t,n)=>{"use strict";var r,i,o=e.r(883735),a=e.r(619314);Object.defineProperty(n,"__esModule",{value:!0}),n.Emitter=n.Event=void 0;var s=e.r(537398);r=n.Event||(n.Event={}),i={dispose:function(){}},r.None=function(){return i};var l=function(){function e(){o._(this,e)}return a._(e,[{key:"add",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=arguments.length>2?arguments[2]:void 0;this._callbacks||(this._callbacks=[],this._contexts=[]),this._callbacks.push(e),this._contexts.push(n),Array.isArray(r)&&r.push({dispose:function(){return t.remove(e,n)}})}},{key:"remove",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(this._callbacks){for(var n=!1,r=0,i=this._callbacks.length;r<i;r++)if(this._callbacks[r]===e)if(this._contexts[r]===t){this._callbacks.splice(r,1),this._contexts.splice(r,1);return}else n=!0;if(n)throw Error("When adding a listener with a context, you should remove it with the same context")}}},{key:"invoke",value:function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];if(!this._callbacks)return[];for(var r=[],i=this._callbacks.slice(0),o=this._contexts.slice(0),a=0,l=i.length;a<l;a++)try{r.push(i[a].apply(o[a],t))}catch(e){(0,s.default)().console.error(e)}return r}},{key:"isEmpty",value:function(){return!this._callbacks||0===this._callbacks.length}},{key:"dispose",value:function(){this._callbacks=void 0,this._contexts=void 0}}]),e}(),u=function(){function e(t){o._(this,e),this._options=t}return a._(e,[{key:"event",get:function(){var t=this;return this._event||(this._event=function(n,r,i){t._callbacks||(t._callbacks=new l),t._options&&t._options.onFirstListenerAdd&&t._callbacks.isEmpty()&&t._options.onFirstListenerAdd(t),t._callbacks.add(n,r);var o={dispose:function(){t._callbacks&&(t._callbacks.remove(n,r),o.dispose=e._noop,t._options&&t._options.onLastListenerRemove&&t._callbacks.isEmpty()&&t._options.onLastListenerRemove(t))}};return Array.isArray(i)&&i.push(o),o}),this._event}},{key:"fire",value:function(e){this._callbacks&&this._callbacks.invoke.call(this._callbacks,e)}},{key:"dispose",value:function(){this._callbacks&&(this._callbacks.dispose(),this._callbacks=void 0)}}]),e}();n.Emitter=u,u._noop=function(){}},812321,(e,t,n)=>{"use strict";var r,i,o=e.r(883735),a=e.r(619314),s=e.r(954546);Object.defineProperty(n,"__esModule",{value:!0}),n.CancellationTokenSource=n.CancellationToken=void 0;var l=e.r(537398),u=e.r(930623),c=e.r(561827);(r=i=n.CancellationToken||(n.CancellationToken={})).None=Object.freeze({isCancellationRequested:!1,onCancellationRequested:c.Event.None}),r.Cancelled=Object.freeze({isCancellationRequested:!0,onCancellationRequested:c.Event.None}),r.is=function(e){return e&&(e===r.None||e===r.Cancelled||u.boolean(e.isCancellationRequested)&&!!e.onCancellationRequested)};var d=Object.freeze(function(e,t){var n=(0,l.default)().timer.setTimeout(e.bind(t),0);return{dispose:function(){n.dispose()}}}),f=function(){function e(){o._(this,e),this._isCancelled=!1}return a._(e,[{key:"cancel",value:function(){!this._isCancelled&&(this._isCancelled=!0,this._emitter&&(this._emitter.fire(void 0),this.dispose()))}},{key:"isCancellationRequested",get:function(){return this._isCancelled}},{key:"onCancellationRequested",get:function(){return this._isCancelled?d:(this._emitter||(this._emitter=new c.Emitter),this._emitter.event)}},{key:"dispose",value:function(){this._emitter&&(this._emitter.dispose(),this._emitter=void 0)}}]),e}();n.CancellationTokenSource=function(){function e(){o._(this,e)}return a._(e,[{key:"token",get:function(){return this._token||(this._token=new f),this._token}},{key:"cancel",value:function(){this._token?this._token.cancel():this._token=i.Cancelled}},{key:"dispose",value:function(){this._token?s._(this._token,f)&&this._token.dispose():this._token=i.None}}]),e}()},34553,(e,t,n)=>{"use strict";var r,i,o=e.r(529405),a=e.r(883735),s=e.r(619314),l=e.r(745291);Object.defineProperty(n,"__esModule",{value:!0}),n.SharedArrayReceiverStrategy=n.SharedArraySenderStrategy=void 0;var u=e.r(812321);(r=i||(i={})).Continue=0,r.Cancelled=1,n.SharedArraySenderStrategy=function(){function e(){a._(this,e),this.buffers=new Map}return s._(e,[{key:"enableCancellation",value:function(e){if(null!==e.id){var t=new SharedArrayBuffer(4);new Int32Array(t,0,1)[0]=i.Continue,this.buffers.set(e.id,t),e.$cancellationData=t}}},{key:"sendCancellation",value:function(e,t){return o._(function(){var e,n;return l._(this,function(r){return void 0===(e=this.buffers.get(t))||(n=new Int32Array(e,0,1),Atomics.store(n,0,i.Cancelled)),[2]})}).call(this)}},{key:"cleanup",value:function(e){this.buffers.delete(e)}},{key:"dispose",value:function(){this.buffers.clear()}}]),e}();var c=function(){function e(t){a._(this,e),this.data=new Int32Array(t,0,1)}return s._(e,[{key:"isCancellationRequested",get:function(){return Atomics.load(this.data,0)===i.Cancelled}},{key:"onCancellationRequested",get:function(){throw Error("Cancellation over SharedArrayBuffer doesn't support cancellation events")}}]),e}(),d=function(){function e(t){a._(this,e),this.token=new c(t)}return s._(e,[{key:"cancel",value:function(){}},{key:"dispose",value:function(){}}]),e}();n.SharedArrayReceiverStrategy=function(){function e(){a._(this,e),this.kind="request"}return s._(e,[{key:"createCancellationTokenSource",value:function(e){var t=e.$cancellationData;return void 0===t?new u.CancellationTokenSource:new d(t)}}]),e}()},271590,(e,t,n)=>{"use strict";var r=e.r(883735),i=e.r(619314),o=e.r(954546);Object.defineProperty(n,"__esModule",{value:!0}),n.Semaphore=void 0;var a=e.r(537398);n.Semaphore=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;if(r._(this,e),t<=0)throw Error("Capacity must be greater than 0");this._capacity=t,this._active=0,this._waiting=[]}return i._(e,[{key:"lock",value:function(e){var t=this;return new Promise(function(n,r){t._waiting.push({thunk:e,resolve:n,reject:r}),t.runNext()})}},{key:"active",get:function(){return this._active}},{key:"runNext",value:function(){var e=this;0!==this._waiting.length&&this._active!==this._capacity&&(0,a.default)().timer.setImmediate(function(){return e.doRunNext()})}},{key:"doRunNext",value:function(){var e=this;if(0!==this._waiting.length&&this._active!==this._capacity){var t=this._waiting.shift();if(this._active++,this._active>this._capacity)throw Error("To many thunks active");try{var n=t.thunk();o._(n,Promise)?n.then(function(n){e._active--,t.resolve(n),e.runNext()},function(n){e._active--,t.reject(n),e.runNext()}):(this._active--,t.resolve(n),this.runNext())}catch(e){this._active--,t.reject(e),this.runNext()}}}}]),e}()},761904,(e,t,n)=>{"use strict";var r,i=e.r(529405),o=e.r(772929),a=e.r(883735),s=e.r(619314),l=e.r(559542),u=e.r(954546),c=e.r(365738),d=e.r(745291);Object.defineProperty(n,"__esModule",{value:!0}),n.ReadableStreamMessageReader=n.AbstractMessageReader=n.MessageReader=void 0;var f=e.r(537398),p=e.r(930623),h=e.r(561827),g=e.r(271590);(n.MessageReader||(n.MessageReader={})).is=function(e){return e&&p.func(e.listen)&&p.func(e.dispose)&&p.func(e.onError)&&p.func(e.onClose)&&p.func(e.onPartialMessage)};var m=function(){function e(){a._(this,e),this.errorEmitter=new h.Emitter,this.closeEmitter=new h.Emitter,this.partialMessageEmitter=new h.Emitter}return s._(e,[{key:"dispose",value:function(){this.errorEmitter.dispose(),this.closeEmitter.dispose()}},{key:"onError",get:function(){return this.errorEmitter.event}},{key:"fireError",value:function(e){this.errorEmitter.fire(this.asError(e))}},{key:"onClose",get:function(){return this.closeEmitter.event}},{key:"fireClose",value:function(){this.closeEmitter.fire(void 0)}},{key:"onPartialMessage",get:function(){return this.partialMessageEmitter.event}},{key:"firePartialMessage",value:function(e){this.partialMessageEmitter.fire(e)}},{key:"asError",value:function(e){return u._(e,Error)?e:Error("Reader received error. Reason: ".concat(p.string(e.message)?e.message:"unknown"))}}]),e}();n.AbstractMessageReader=m,(r||(r={})).fromOptions=function(e){var t=new Map,n=new Map;if(void 0===e||"string"==typeof e)a=null!=e?e:"utf-8";else{if(a=null!=(u=e.charset)?u:"utf-8",void 0!==e.contentDecoder&&(s=e.contentDecoder,t.set(s.name,s)),void 0!==e.contentDecoders){var r=!0,i=!1,o=void 0;try{for(var a,s,l,u,c,d=e.contentDecoders[Symbol.iterator]();!(r=(c=d.next()).done);r=!0){var p=c.value;t.set(p.name,p)}}catch(e){i=!0,o=e}finally{try{r||null==d.return||d.return()}finally{if(i)throw o}}}if(void 0!==e.contentTypeDecoder&&(l=e.contentTypeDecoder,n.set(l.name,l)),void 0!==e.contentTypeDecoders){var h=!0,g=!1,m=void 0;try{for(var x,y=e.contentTypeDecoders[Symbol.iterator]();!(h=(x=y.next()).done);h=!0){var b=x.value;n.set(b.name,b)}}catch(e){g=!0,m=e}finally{try{h||null==y.return||y.return()}finally{if(g)throw m}}}}return void 0===l&&(l=(0,f.default)().applicationJson.decoder,n.set(l.name,l)),{charset:a,contentDecoder:s,contentDecoders:t,contentTypeDecoder:l,contentTypeDecoders:n}},n.ReadableStreamMessageReader=function(e){function t(e,n){var i;return a._(this,t),(i=o._(this,t)).readable=e,i.options=r.fromOptions(n),i.buffer=(0,f.default)().messageBuffer.create(i.options.charset),i._partialMessageTimeout=1e4,i.nextMessageLength=-1,i.messageToken=0,i.readSemaphore=new g.Semaphore(1),i}return l._(t,e),s._(t,[{key:"partialMessageTimeout",get:function(){return this._partialMessageTimeout},set:function(e){this._partialMessageTimeout=e}},{key:"listen",value:function(e){var t=this;this.nextMessageLength=-1,this.messageToken=0,this.partialMessageTimer=void 0,this.callback=e;var n=this.readable.onData(function(e){t.onData(e)});return this.readable.onError(function(e){return t.fireError(e)}),this.readable.onClose(function(){return t.fireClose()}),n}},{key:"onData",value:function(e){var t,n=this;for(this.buffer.append(e);;){var r=(t=this,function(){if(-1===t.nextMessageLength){var e=t.buffer.tryReadHeaders(!0);if(!e)return{v:void 0};var r=e.get("content-length");if(!r)return t.fireError(Error("Header must provide a Content-Length property.")),{v:void 0};var o=parseInt(r);if(isNaN(o))return t.fireError(Error("Content-Length value must be a number.")),{v:void 0};t.nextMessageLength=o}var a=t.buffer.tryReadBody(t.nextMessageLength);if(void 0===a)return t.setPartialMessageTimer(),{v:void 0};t.clearPartialMessageTimer(),t.nextMessageLength=-1,t.readSemaphore.lock(function(){return i._(function(){var e,t,n;return d._(this,function(r){switch(r.label){case 0:if(void 0===this.options.contentDecoder)return[3,2];return[4,this.options.contentDecoder.decode(a)];case 1:return t=r.sent(),[3,3];case 2:t=a,r.label=3;case 3:return e=t,[4,this.options.contentTypeDecoder.decode(e,this.options)];case 4:return n=r.sent(),this.callback(n),[2]}})}).call(n)}).catch(function(e){n.fireError(e)})}());if("object"===c._(r))return r.v}}},{key:"clearPartialMessageTimer",value:function(){this.partialMessageTimer&&(this.partialMessageTimer.dispose(),this.partialMessageTimer=void 0)}},{key:"setPartialMessageTimer",value:function(){var e=this;this.clearPartialMessageTimer(),this._partialMessageTimeout<=0||(this.partialMessageTimer=(0,f.default)().timer.setTimeout(function(t,n){e.partialMessageTimer=void 0,t===e.messageToken&&(e.firePartialMessage({messageToken:t,waitingTime:n}),e.setPartialMessageTimer())},this._partialMessageTimeout,this.messageToken,this._partialMessageTimeout))}}]),t}(m)},781124,(e,t,n)=>{"use strict";var r,i=e.r(529405),o=e.r(772929),a=e.r(883735),s=e.r(619314),l=e.r(559542),u=e.r(954546),c=e.r(745291);Object.defineProperty(n,"__esModule",{value:!0}),n.WriteableStreamMessageWriter=n.AbstractMessageWriter=n.MessageWriter=void 0;var d=e.r(537398),f=e.r(930623),p=e.r(271590),h=e.r(561827);(n.MessageWriter||(n.MessageWriter={})).is=function(e){return e&&f.func(e.dispose)&&f.func(e.onClose)&&f.func(e.onError)&&f.func(e.write)};var g=function(){function e(){a._(this,e),this.errorEmitter=new h.Emitter,this.closeEmitter=new h.Emitter}return s._(e,[{key:"dispose",value:function(){this.errorEmitter.dispose(),this.closeEmitter.dispose()}},{key:"onError",get:function(){return this.errorEmitter.event}},{key:"fireError",value:function(e,t,n){this.errorEmitter.fire([this.asError(e),t,n])}},{key:"onClose",get:function(){return this.closeEmitter.event}},{key:"fireClose",value:function(){this.closeEmitter.fire(void 0)}},{key:"asError",value:function(e){return u._(e,Error)?e:Error("Writer received error. Reason: ".concat(f.string(e.message)?e.message:"unknown"))}}]),e}();n.AbstractMessageWriter=g,(r||(r={})).fromOptions=function(e){var t,n;return void 0===e||"string"==typeof e?{charset:null!=e?e:"utf-8",contentTypeEncoder:(0,d.default)().applicationJson.encoder}:{charset:null!=(t=e.charset)?t:"utf-8",contentEncoder:e.contentEncoder,contentTypeEncoder:null!=(n=e.contentTypeEncoder)?n:(0,d.default)().applicationJson.encoder}},n.WriteableStreamMessageWriter=function(e){function t(e,n){var i;return a._(this,t),(i=o._(this,t)).writable=e,i.options=r.fromOptions(n),i.errorCount=0,i.writeSemaphore=new p.Semaphore(1),i.writable.onError(function(e){return i.fireError(e)}),i.writable.onClose(function(){return i.fireClose()}),i}return l._(t,e),s._(t,[{key:"write",value:function(e){return i._(function(){var t;return c._(this,function(n){return t=this,[2,this.writeSemaphore.lock(function(){return i._(function(){var t;return c._(this,function(n){return t=this,[2,this.options.contentTypeEncoder.encode(e,this.options).then(function(e){return void 0!==t.options.contentEncoder?t.options.contentEncoder.encode(e):e}).then(function(n){var r=[];return r.push("Content-Length: ",n.byteLength.toString(),"\r\n"),r.push("\r\n"),t.doWrite(e,r,n)},function(e){throw t.fireError(e),e})]})}).call(t)})]})}).call(this)}},{key:"doWrite",value:function(e,t,n){return i._(function(){var r;return c._(this,function(i){switch(i.label){case 0:return i.trys.push([0,2,,3]),[4,this.writable.write(t.join(""),"ascii")];case 1:return i.sent(),[2,this.writable.write(n)];case 2:return r=i.sent(),this.handleError(r,e),[2,Promise.reject(r)];case 3:return[2]}})}).call(this)}},{key:"handleError",value:function(e,t){this.errorCount++,this.fireError(e,t,this.errorCount)}},{key:"end",value:function(){this.writable.end()}}]),t}(g)},427882,(e,t,n)=>{"use strict";var r=e.r(883735),i=e.r(619314);Object.defineProperty(n,"__esModule",{value:!0}),n.AbstractMessageBuffer=void 0,n.AbstractMessageBuffer=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"utf-8";r._(this,e),this._encoding=t,this._chunks=[],this._totalLength=0}return i._(e,[{key:"encoding",get:function(){return this._encoding}},{key:"append",value:function(e){var t="string"==typeof e?this.fromString(e,this._encoding):e;this._chunks.push(t),this._totalLength+=t.byteLength}},{key:"tryReadHeaders",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(0!==this._chunks.length){var t=0,n=0,r=0,i=0;t:for(;n<this._chunks.length;){var o=this._chunks[n];for(r=0;r<o.length;){switch(o[r]){case 13:switch(t){case 0:t=1;break;case 2:t=3;break;default:t=0}break;case 10:switch(t){case 1:t=2;break;case 3:t=4,r++;break t;default:t=0}break;default:t=0}r++}i+=o.byteLength,n++}if(4===t){var a=this._read(i+r),s=new Map,l=this.toString(a,"ascii").split("\r\n");if(l.length<2)return s;for(var u=0;u<l.length-2;u++){var c=l[u],d=c.indexOf(":");if(-1===d)throw Error("Message header must separate key and value using :");var f=c.substr(0,d),p=c.substr(d+1).trim();s.set(e?f.toLowerCase():f,p)}return s}}}},{key:"tryReadBody",value:function(e){if(!(this._totalLength<e))return this._read(e)}},{key:"numberOfBytes",get:function(){return this._totalLength}},{key:"_read",value:function(e){if(0===e)return this.emptyBuffer();if(e>this._totalLength)throw Error("Cannot read so many bytes!");if(this._chunks[0].byteLength===e){var t=this._chunks[0];return this._chunks.shift(),this._totalLength-=e,this.asNative(t)}if(this._chunks[0].byteLength>e){var n=this._chunks[0],r=this.asNative(n,e);return this._chunks[0]=n.slice(e),this._totalLength-=e,r}for(var i=this.allocNative(e),o=0;e>0;){var a=this._chunks[0];if(a.byteLength>e){var s=a.slice(0,e);i.set(s,o),o+=e,this._chunks[0]=a.slice(e),this._totalLength-=e,e-=e}else i.set(a,o),o+=a.byteLength,this._chunks.shift(),this._totalLength-=a.byteLength,e-=a.byteLength}return i}}]),e}()},524217,(e,t,n)=>{"use strict";var r,i,o,a,s,l,u,c,d,f,p,h,g,m,x,y,b,w,k,_,S,C,j,T,E,R,I,A=e.r(529405),P=e.r(772929),D=e.r(883735),O=e.r(559542),N=e.r(954546),M=e.r(561584),L=e.r(365738),B=e.r(873719),V=e.r(745291);Object.defineProperty(n,"__esModule",{value:!0}),n.createMessageConnection=n.ConnectionOptions=n.MessageStrategy=n.CancellationStrategy=n.CancellationSenderStrategy=n.CancellationReceiverStrategy=n.RequestCancellationReceiverStrategy=n.IdCancellationReceiverStrategy=n.ConnectionStrategy=n.ConnectionError=n.ConnectionErrors=n.LogTraceNotification=n.SetTraceNotification=n.TraceFormat=n.TraceValues=n.Trace=n.NullLogger=n.ProgressType=n.ProgressToken=void 0;var F=e.r(537398),U=e.r(930623),G=e.r(995606),$=e.r(97504),z=e.r(561827),H=e.r(812321);(p||(p={})).type=new G.NotificationType("$/cancelRequest"),(h=n.ProgressToken||(n.ProgressToken={})).is=function(e){return"string"==typeof e||"number"==typeof e},(g||(g={})).type=new G.NotificationType("$/progress"),n.ProgressType=function e(){D._(this,e)},(m||(m={})).is=function(e){return U.func(e)},n.NullLogger=Object.freeze({error:function(){},warn:function(){},info:function(){},log:function(){}}),(r=x=n.Trace||(n.Trace={}))[r.Off=0]="Off",r[r.Messages=1]="Messages",r[r.Compact=2]="Compact",r[r.Verbose=3]="Verbose",(i=n.TraceValues||(n.TraceValues={})).Off="off",i.Messages="messages",i.Compact="compact",i.Verbose="verbose",(o=x=n.Trace||(n.Trace={})).fromString=function(e){if(!U.string(e))return o.Off;switch(e=e.toLowerCase()){case"off":default:return o.Off;case"messages":return o.Messages;case"compact":return o.Compact;case"verbose":return o.Verbose}},o.toString=function(e){switch(e){case o.Off:return"off";case o.Messages:return"messages";case o.Compact:return"compact";case o.Verbose:return"verbose";default:return"off"}},(a=y=n.TraceFormat||(n.TraceFormat={})).Text="text",a.JSON="json",(s=y=n.TraceFormat||(n.TraceFormat={})).fromString=function(e){return U.string(e)&&"json"===(e=e.toLowerCase())?s.JSON:s.Text},(b=n.SetTraceNotification||(n.SetTraceNotification={})).type=new G.NotificationType("$/setTrace"),(w=n.LogTraceNotification||(n.LogTraceNotification={})).type=new G.NotificationType("$/logTrace"),(l=k=n.ConnectionErrors||(n.ConnectionErrors={}))[l.Closed=1]="Closed",l[l.Disposed=2]="Disposed",l[l.AlreadyListening=3]="AlreadyListening";var W=function(e){function t(e,n){var r;return D._(this,t),(r=P._(this,t,[n])).code=e,Object.setPrototypeOf(r,t.prototype),r}return O._(t,e),t}(B._(Error));n.ConnectionError=W,(_=n.ConnectionStrategy||(n.ConnectionStrategy={})).is=function(e){return e&&U.func(e.cancelUndispatched)},(S=n.IdCancellationReceiverStrategy||(n.IdCancellationReceiverStrategy={})).is=function(e){return e&&(void 0===e.kind||"id"===e.kind)&&U.func(e.createCancellationTokenSource)&&(void 0===e.dispose||U.func(e.dispose))},(C=n.RequestCancellationReceiverStrategy||(n.RequestCancellationReceiverStrategy={})).is=function(e){return e&&"request"===e.kind&&U.func(e.createCancellationTokenSource)&&(void 0===e.dispose||U.func(e.dispose))},(u=j=n.CancellationReceiverStrategy||(n.CancellationReceiverStrategy={})).Message=Object.freeze({createCancellationTokenSource:function(e){return new H.CancellationTokenSource}}),u.is=function(e){return S.is(e)||C.is(e)},(c=T=n.CancellationSenderStrategy||(n.CancellationSenderStrategy={})).Message=Object.freeze({sendCancellation:function(e,t){return e.sendNotification(p.type,{id:t})},cleanup:function(e){}}),c.is=function(e){return e&&U.func(e.sendCancellation)&&U.func(e.cleanup)},(d=E=n.CancellationStrategy||(n.CancellationStrategy={})).Message=Object.freeze({receiver:j.Message,sender:T.Message}),d.is=function(e){return e&&j.is(e.receiver)&&T.is(e.sender)},(R=n.MessageStrategy||(n.MessageStrategy={})).is=function(e){return e&&U.func(e.handleMessage)},(n.ConnectionOptions||(n.ConnectionOptions={})).is=function(e){return e&&(E.is(e.cancellationStrategy)||_.is(e.connectionStrategy)||R.is(e.messageStrategy))},(f=I||(I={}))[f.New=1]="New",f[f.Listening=2]="Listening",f[f.Closed=3]="Closed",f[f.Disposed=4]="Disposed",n.createMessageConnection=function(e,t,r,i){var o,a,s=void 0!==r?r:n.NullLogger,l=0,u=0,c=0,d=void 0,f=new Map,_=void 0,C=new Map,j=new Map,T=new $.LinkedMap,P=new Map,D=new Set,O=new Map,B=x.Off,q=y.Text,K=I.New,Y=new z.Emitter,Q=new z.Emitter,X=new z.Emitter,J=new z.Emitter,Z=new z.Emitter,ee=i&&i.cancellationStrategy?i.cancellationStrategy:E.Message;function et(e){if(null===e)throw Error("Can't send requests with id null since the response can't be correlated.");return"req-"+e.toString()}function en(e){}function er(){return K===I.Listening}function ei(){return K===I.Closed}function eo(){return K===I.Disposed}function ea(){(K===I.New||K===I.Listening)&&(K=I.Closed,Q.fire(void 0))}function es(e){G.Message.isRequest(e)?function(e){if(!eo()){var n=e;if(B!==x.Off&&a)if(q===y.Text){var r=void 0;(B===x.Verbose||B===x.Compact)&&n.params&&(r="Params: ".concat(eu(n.params),"\n\n")),a.log("Received request '".concat(n.method," - (").concat(n.id,")'."),r)}else ef("receive-request",n);var i=f.get(e.method);i&&(m=i.type,b=i.handler);var o=Date.now();if(b||d){var l=null!=(w=e.id)?w:String(Date.now()),u=S.is(ee.receiver)?ee.receiver.createCancellationTokenSource(l):ee.receiver.createCancellationTokenSource(e);null!==e.id&&D.has(e.id)&&u.cancel(),null!==e.id&&O.set(l,u);try{if(b)if(void 0===e.params){if(void 0!==m&&0!==m.numberOfParams)return void j(new G.ResponseError(G.ErrorCodes.InvalidParams,"Request ".concat(e.method," defines ").concat(m.numberOfParams," params but received none.")),e.method,o);k=b(u.token)}else if(Array.isArray(e.params)){if(void 0!==m&&m.parameterStructures===G.ParameterStructures.byName)return void j(new G.ResponseError(G.ErrorCodes.InvalidParams,"Request ".concat(e.method," defines parameters by name but received parameters by position")),e.method,o);k=b.apply(void 0,M._(e.params).concat([u.token]))}else{if(void 0!==m&&m.parameterStructures===G.ParameterStructures.byPosition)return void j(new G.ResponseError(G.ErrorCodes.InvalidParams,"Request ".concat(e.method," defines parameters by position but received parameters by name")),e.method,o);k=b(e.params,u.token)}else d&&(k=d(e.method,e.params,u.token));var c,p,h,g,m,b,w,k,_=k;k?_.then?_.then(function(t){O.delete(l),C(t,e.method,o)},function(t){O.delete(l),N._(t,G.ResponseError)?j(t,e.method,o):t&&U.string(t.message)?j(new G.ResponseError(G.ErrorCodes.InternalError,"Request ".concat(e.method," failed with message: ").concat(t.message)),e.method,o):j(new G.ResponseError(G.ErrorCodes.InternalError,"Request ".concat(e.method," failed unexpectedly without providing any details.")),e.method,o)}):(O.delete(l),C(k,e.method,o)):(O.delete(l),c=k,p=e.method,h=o,void 0===c&&(c=null),g={jsonrpc:"2.0",id:e.id,result:c},ec(g,p,h),t.write(g).catch(function(){return s.error("Sending response failed.")}))}catch(t){O.delete(l),N._(t,G.ResponseError)?C(t,e.method,o):t&&U.string(t.message)?j(new G.ResponseError(G.ErrorCodes.InternalError,"Request ".concat(e.method," failed with message: ").concat(t.message)),e.method,o):j(new G.ResponseError(G.ErrorCodes.InternalError,"Request ".concat(e.method," failed unexpectedly without providing any details.")),e.method,o)}}else j(new G.ResponseError(G.ErrorCodes.MethodNotFound,"Unhandled method ".concat(e.method)),e.method,o)}function C(n,r,i){var o={jsonrpc:"2.0",id:e.id};N._(n,G.ResponseError)?o.error=n.toJson():o.result=void 0===n?null:n,ec(o,r,i),t.write(o).catch(function(){return s.error("Sending response failed.")})}function j(n,r,i){var o={jsonrpc:"2.0",id:e.id,error:n.toJson()};ec(o,r,i),t.write(o).catch(function(){return s.error("Sending response failed.")})}}(e):G.Message.isNotification(e)?function(e){if(!eo()){var t,n=void 0;if(e.method===p.type.method){var r=e.params.id;D.delete(r),ed(e);return}var i=C.get(e.method);if(i&&(t=i.handler,n=i.type),t||_)try{if(ed(e),t)if(void 0===e.params)void 0!==n&&0!==n.numberOfParams&&n.parameterStructures!==G.ParameterStructures.byName&&s.error("Notification ".concat(e.method," defines ").concat(n.numberOfParams," params but received none.")),t();else if(Array.isArray(e.params)){var o=e.params;e.method===g.type.method&&2===o.length&&h.is(o[0])?t({token:o[0],value:o[1]}):(void 0!==n&&(n.parameterStructures===G.ParameterStructures.byName&&s.error("Notification ".concat(e.method," defines parameters by name but received parameters by position")),n.numberOfParams!==e.params.length&&s.error("Notification ".concat(e.method," defines ").concat(n.numberOfParams," params but received ").concat(o.length," arguments"))),t.apply(void 0,M._(o)))}else void 0!==n&&n.parameterStructures===G.ParameterStructures.byPosition&&s.error("Notification ".concat(e.method," defines parameters by position but received parameters by name")),t(e.params);else _&&_(e.method,e.params)}catch(t){t.message?s.error("Notification handler '".concat(e.method,"' failed with message: ").concat(t.message)):s.error("Notification handler '".concat(e.method,"' failed unexpectedly."))}else X.fire(e)}}(e):G.Message.isResponse(e)?function(e){if(!eo())if(null===e.id)e.error?s.error("Received response message without id: Error is: \n".concat(JSON.stringify(e.error,void 0,4))):s.error("Received response message without id. No further error information provided.");else{var t=e.id,n=P.get(t);if(function(e,t){if(B!==x.Off&&a)if(q===y.Text){var n=void 0;if((B===x.Verbose||B===x.Compact)&&(e.error&&e.error.data?n="Error data: ".concat(eu(e.error.data),"\n\n"):e.result?n="Result: ".concat(eu(e.result),"\n\n"):void 0===e.error&&(n="No result returned.\n\n")),t){var r=e.error?" Request failed: ".concat(e.error.message," (").concat(e.error.code,")."):"";a.log("Received response '".concat(t.method," - (").concat(e.id,")' in ").concat(Date.now()-t.timerStart,"ms.").concat(r),n)}else a.log("Received response ".concat(e.id," without active response promise."),n)}else ef("receive-response",e)}(e,n),void 0!==n){P.delete(t);try{if(e.error){var r=e.error;n.reject(new G.ResponseError(r.code,r.message,r.data))}else if(void 0!==e.result)n.resolve(e.result);else throw Error("Should never happen.")}catch(e){e.message?s.error("Response handler '".concat(n.method,"' failed with message: ").concat(e.message)):s.error("Response handler '".concat(n.method,"' failed unexpectedly."))}}}}(e):function(e){if(!e)return s.error("Received empty message.");if(s.error("Received message which is neither a response nor a notification message:\n".concat(JSON.stringify(e,null,4))),U.string(e.id)||U.number(e.id)){var t=e.id,n=P.get(t);n&&n.reject(Error("The received response has neither a result nor an error property."))}}(e)}e.onClose(ea),e.onError(function(e){Y.fire([e,void 0,void 0])}),t.onClose(ea),t.onError(function(e){Y.fire(e)});var el=function(e){try{if(G.Message.isNotification(e)&&e.method===p.type.method){var n,r=e.params.id,a=et(r),l=T.get(a);if(G.Message.isRequest(l)){var d=null==i?void 0:i.connectionStrategy,f=d&&d.cancelUndispatched?d.cancelUndispatched(l,en):en(l);if(f&&(void 0!==f.error||void 0!==f.result)){T.delete(a),O.delete(r),f.id=l.id,ec(f,e.method,Date.now()),t.write(f).catch(function(){return s.error("Sending response for canceled message failed.")});return}}var h=O.get(r);if(void 0!==h){h.cancel(),ed(e);return}D.add(r)}var g=T;G.Message.isRequest(e)?g.set(et(e.id),e):G.Message.isResponse(e)?g.set(null===(n=e.id)?"res-unknown-"+(++c).toString():"res-"+n.toString(),e):g.set("not-"+(++u).toString(),e)}finally{!function e(){o||0===T.size||(o=(0,F.default)().timer.setImmediate(function(){o=void 0,function(){if(0!==T.size){var t=T.shift();try{var n=null==i?void 0:i.messageStrategy;R.is(n)?n.handleMessage(t,es):es(t)}finally{e()}}}()}))}()}};function eu(e){if(null!=e)switch(B){case x.Verbose:return JSON.stringify(e,null,4);case x.Compact:return JSON.stringify(e);default:return}}function ec(e,t,n){if(B!==x.Off&&a)if(q===y.Text){var r=void 0;(B===x.Verbose||B===x.Compact)&&(e.error&&e.error.data?r="Error data: ".concat(eu(e.error.data),"\n\n"):e.result?r="Result: ".concat(eu(e.result),"\n\n"):void 0===e.error&&(r="No result returned.\n\n")),a.log("Sending response '".concat(t," - (").concat(e.id,")'. Processing request took ").concat(Date.now()-n,"ms"),r)}else ef("send-response",e)}function ed(e){if(B!==x.Off&&a&&e.method!==w.type.method)if(q===y.Text){var t=void 0;(B===x.Verbose||B===x.Compact)&&(t=e.params?"Params: ".concat(eu(e.params),"\n\n"):"No parameters provided.\n\n"),a.log("Received notification '".concat(e.method,"'."),t)}else ef("receive-notification",e)}function ef(e,t){if(a&&B!==x.Off){var n={isLSPMessage:!0,type:e,message:t,timestamp:Date.now()};a.log(n)}}function ep(){if(ei())throw new W(k.Closed,"Connection is closed.");if(eo())throw new W(k.Disposed,"Connection is disposed.")}function eh(e){return void 0===e?null:e}function eg(e){if(null!==e)return e}function em(e){return null!=e&&!Array.isArray(e)&&(void 0===e?"undefined":L._(e))==="object"}function ev(e,t){switch(e){case G.ParameterStructures.auto:if(em(t))return eg(t);return[eh(t)];case G.ParameterStructures.byName:if(!em(t))throw Error("Received parameters by name but param is not an object literal.");return eg(t);case G.ParameterStructures.byPosition:return[eh(t)];default:throw Error("Unknown parameter structure ".concat(e.toString()))}}function ex(e,t){var n,r=e.numberOfParams;switch(r){case 0:n=void 0;break;case 1:n=ev(e.parameterStructures,t[0]);break;default:n=[];for(var i=0;i<t.length&&i<r;i++)n.push(eh(t[i]));if(t.length<r)for(var o=t.length;o<r;o++)n.push(null)}return n}var ey={sendNotification:function(e){for(var n,r,i=arguments.length,o=Array(i>1?i-1:0),l=1;l<i;l++)o[l-1]=arguments[l];if(ep(),U.string(e)){n=e;var u=o[0],c=0,d=G.ParameterStructures.auto;G.ParameterStructures.is(u)&&(c=1,d=u);var f=o.length,p=f-c;switch(p){case 0:r=void 0;break;case 1:r=ev(d,o[c]);break;default:if(d===G.ParameterStructures.byName)throw Error("Received ".concat(p," parameters for 'by Name' notification parameter structure."));r=o.slice(c,f).map(function(e){return eh(e)})}}else n=e.method,r=ex(e,o);var h={jsonrpc:"2.0",method:n,params:r};if(B!==x.Off&&a)if(q===y.Text){var g=void 0;(B===x.Verbose||B===x.Compact)&&(g=h.params?"Params: ".concat(eu(h.params),"\n\n"):"No parameters provided.\n\n"),a.log("Sending notification '".concat(h.method,"'."),g)}else ef("send-notification",h);return t.write(h).catch(function(e){throw s.error("Sending notification failed."),e})},onNotification:function(e,t){var n;return ep(),U.func(e)?_=e:t&&(U.string(e)?(n=e,C.set(e,{type:void 0,handler:t})):(n=e.method,C.set(e.method,{type:e,handler:t}))),{dispose:function(){void 0!==n?C.delete(n):_=void 0}}},onProgress:function(e,t,n){if(j.has(t))throw Error("Progress handler for token ".concat(t," already registered"));return j.set(t,n),{dispose:function(){j.delete(t)}}},sendProgress:function(e,t,n){return ey.sendNotification(g.type,{token:t,value:n})},onUnhandledProgress:J.event,sendRequest:function(e){for(var n,r,i,o=arguments.length,u=Array(o>1?o-1:0),c=1;c<o;c++)u[c-1]=arguments[c];if(ep(),!er())throw Error("Call listen() first.");var d=void 0;if(U.string(e)){n=e;var f=u[0],p=u[u.length-1],h=0,g=G.ParameterStructures.auto;G.ParameterStructures.is(f)&&(h=1,g=f);var m=u.length;H.CancellationToken.is(p)&&(m-=1,d=p);var b=m-h;switch(b){case 0:r=void 0;break;case 1:r=ev(g,u[h]);break;default:if(g===G.ParameterStructures.byName)throw Error("Received ".concat(b," parameters for 'by Name' request parameter structure."));r=u.slice(h,m).map(function(e){return eh(e)})}}else{n=e.method,r=ex(e,u);var w=e.numberOfParams;d=H.CancellationToken.is(u[w])?u[w]:void 0}var k=l++;d&&(i=d.onCancellationRequested(function(){var e=ee.sender.sendCancellation(ey,k);return void 0===e?(s.log("Received no promise from cancellation strategy when cancelling id ".concat(k)),Promise.resolve()):e.catch(function(){s.log("Sending cancellation messages for id ".concat(k," failed"))})}));var _={jsonrpc:"2.0",id:k,method:n,params:r};if(B!==x.Off&&a)if(q===y.Text){var S=void 0;(B===x.Verbose||B===x.Compact)&&_.params&&(S="Params: ".concat(eu(_.params),"\n\n")),a.log("Sending request '".concat(_.method," - (").concat(_.id,")'."),S)}else ef("send-request",_);return"function"==typeof ee.sender.enableCancellation&&ee.sender.enableCancellation(_),new Promise(function(e,r){return A._(function(){var o,a,l,u;return V._(this,function(c){switch(c.label){case 0:o=function(t){e(t),ee.sender.cleanup(k),null==i||i.dispose()},a=function(e){r(e),ee.sender.cleanup(k),null==i||i.dispose()},l={method:n,timerStart:Date.now(),resolve:o,reject:a},c.label=1;case 1:return c.trys.push([1,3,,4]),[4,t.write(_)];case 2:return c.sent(),P.set(k,l),[3,4];case 3:throw u=c.sent(),s.error("Sending request failed."),l.reject(new G.ResponseError(G.ErrorCodes.MessageWriteError,u.message?u.message:"Unknown reason")),u;case 4:return[2]}})})()})},onRequest:function(e,t){ep();var n=null;return m.is(e)?(n=void 0,d=e):U.string(e)?(n=null,void 0!==t&&(n=e,f.set(e,{handler:t,type:void 0}))):void 0!==t&&(n=e.method,f.set(e.method,{type:e,handler:t})),{dispose:function(){null!==n&&(void 0!==n?f.delete(n):d=void 0)}}},hasPendingResponse:function(){return P.size>0},trace:function(e,t,n){return A._(function(){var r,i;return V._(this,function(o){switch(o.label){case 0:if(r=!1,i=y.Text,void 0!==n&&(U.boolean(n)?r=n:(r=n.sendNotification||!1,i=n.traceFormat||y.Text)),B=e,q=i,a=B===x.Off?void 0:t,!(r&&!ei()&&!eo()))return[3,2];return[4,ey.sendNotification(b.type,{value:x.toString(e)})];case 1:o.sent(),o.label=2;case 2:return[2]}})})()},onError:Y.event,onClose:Q.event,onUnhandledNotification:X.event,onDispose:Z.event,end:function(){t.end()},dispose:function(){if(!eo()){K=I.Disposed,Z.fire(void 0);var n=new G.ResponseError(G.ErrorCodes.PendingResponseRejected,"Pending response rejected since connection got disposed"),r=!0,i=!1,o=void 0;try{for(var a,s=P.values()[Symbol.iterator]();!(r=(a=s.next()).done);r=!0)a.value.reject(n)}catch(e){i=!0,o=e}finally{try{r||null==s.return||s.return()}finally{if(i)throw o}}P=new Map,O=new Map,D=new Set,T=new $.LinkedMap,U.func(t.dispose)&&t.dispose(),U.func(e.dispose)&&e.dispose()}},listen:function(){if(ep(),er())throw new W(k.AlreadyListening,"Connection is already listening");K=I.Listening,e.listen(el)},inspect:function(){(0,F.default)().console.log("inspect")}};return ey.onNotification(w.type,function(e){if(B!==x.Off&&a){var t=B===x.Verbose||B===x.Compact;a.log(e.message,t?e.verbose:void 0)}}),ey.onNotification(g.type,function(e){var t=j.get(e.token);t?t(e.value):J.fire(e)}),ey}},127673,(e,t,n)=>{"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.ProgressType=n.ProgressToken=n.createMessageConnection=n.NullLogger=n.ConnectionOptions=n.ConnectionStrategy=n.AbstractMessageBuffer=n.WriteableStreamMessageWriter=n.AbstractMessageWriter=n.MessageWriter=n.ReadableStreamMessageReader=n.AbstractMessageReader=n.MessageReader=n.SharedArrayReceiverStrategy=n.SharedArraySenderStrategy=n.CancellationToken=n.CancellationTokenSource=n.Emitter=n.Event=n.Disposable=n.LRUCache=n.Touch=n.LinkedMap=n.ParameterStructures=n.NotificationType9=n.NotificationType8=n.NotificationType7=n.NotificationType6=n.NotificationType5=n.NotificationType4=n.NotificationType3=n.NotificationType2=n.NotificationType1=n.NotificationType0=n.NotificationType=n.ErrorCodes=n.ResponseError=n.RequestType9=n.RequestType8=n.RequestType7=n.RequestType6=n.RequestType5=n.RequestType4=n.RequestType3=n.RequestType2=n.RequestType1=n.RequestType0=n.RequestType=n.Message=n.RAL=void 0,n.MessageStrategy=n.CancellationStrategy=n.CancellationSenderStrategy=n.CancellationReceiverStrategy=n.ConnectionError=n.ConnectionErrors=n.LogTraceNotification=n.SetTraceNotification=n.TraceFormat=n.TraceValues=n.Trace=void 0;var r=e.r(995606);Object.defineProperty(n,"Message",{enumerable:!0,get:function(){return r.Message}}),Object.defineProperty(n,"RequestType",{enumerable:!0,get:function(){return r.RequestType}}),Object.defineProperty(n,"RequestType0",{enumerable:!0,get:function(){return r.RequestType0}}),Object.defineProperty(n,"RequestType1",{enumerable:!0,get:function(){return r.RequestType1}}),Object.defineProperty(n,"RequestType2",{enumerable:!0,get:function(){return r.RequestType2}}),Object.defineProperty(n,"RequestType3",{enumerable:!0,get:function(){return r.RequestType3}}),Object.defineProperty(n,"RequestType4",{enumerable:!0,get:function(){return r.RequestType4}}),Object.defineProperty(n,"RequestType5",{enumerable:!0,get:function(){return r.RequestType5}}),Object.defineProperty(n,"RequestType6",{enumerable:!0,get:function(){return r.RequestType6}}),Object.defineProperty(n,"RequestType7",{enumerable:!0,get:function(){return r.RequestType7}}),Object.defineProperty(n,"RequestType8",{enumerable:!0,get:function(){return r.RequestType8}}),Object.defineProperty(n,"RequestType9",{enumerable:!0,get:function(){return r.RequestType9}}),Object.defineProperty(n,"ResponseError",{enumerable:!0,get:function(){return r.ResponseError}}),Object.defineProperty(n,"ErrorCodes",{enumerable:!0,get:function(){return r.ErrorCodes}}),Object.defineProperty(n,"NotificationType",{enumerable:!0,get:function(){return r.NotificationType}}),Object.defineProperty(n,"NotificationType0",{enumerable:!0,get:function(){return r.NotificationType0}}),Object.defineProperty(n,"NotificationType1",{enumerable:!0,get:function(){return r.NotificationType1}}),Object.defineProperty(n,"NotificationType2",{enumerable:!0,get:function(){return r.NotificationType2}}),Object.defineProperty(n,"NotificationType3",{enumerable:!0,get:function(){return r.NotificationType3}}),Object.defineProperty(n,"NotificationType4",{enumerable:!0,get:function(){return r.NotificationType4}}),Object.defineProperty(n,"NotificationType5",{enumerable:!0,get:function(){return r.NotificationType5}}),Object.defineProperty(n,"NotificationType6",{enumerable:!0,get:function(){return r.NotificationType6}}),Object.defineProperty(n,"NotificationType7",{enumerable:!0,get:function(){return r.NotificationType7}}),Object.defineProperty(n,"NotificationType8",{enumerable:!0,get:function(){return r.NotificationType8}}),Object.defineProperty(n,"NotificationType9",{enumerable:!0,get:function(){return r.NotificationType9}}),Object.defineProperty(n,"ParameterStructures",{enumerable:!0,get:function(){return r.ParameterStructures}});var i=e.r(97504);Object.defineProperty(n,"LinkedMap",{enumerable:!0,get:function(){return i.LinkedMap}}),Object.defineProperty(n,"LRUCache",{enumerable:!0,get:function(){return i.LRUCache}}),Object.defineProperty(n,"Touch",{enumerable:!0,get:function(){return i.Touch}});var o=e.r(303372);Object.defineProperty(n,"Disposable",{enumerable:!0,get:function(){return o.Disposable}});var a=e.r(561827);Object.defineProperty(n,"Event",{enumerable:!0,get:function(){return a.Event}}),Object.defineProperty(n,"Emitter",{enumerable:!0,get:function(){return a.Emitter}});var s=e.r(812321);Object.defineProperty(n,"CancellationTokenSource",{enumerable:!0,get:function(){return s.CancellationTokenSource}}),Object.defineProperty(n,"CancellationToken",{enumerable:!0,get:function(){return s.CancellationToken}});var l=e.r(34553);Object.defineProperty(n,"SharedArraySenderStrategy",{enumerable:!0,get:function(){return l.SharedArraySenderStrategy}}),Object.defineProperty(n,"SharedArrayReceiverStrategy",{enumerable:!0,get:function(){return l.SharedArrayReceiverStrategy}});var u=e.r(761904);Object.defineProperty(n,"MessageReader",{enumerable:!0,get:function(){return u.MessageReader}}),Object.defineProperty(n,"AbstractMessageReader",{enumerable:!0,get:function(){return u.AbstractMessageReader}}),Object.defineProperty(n,"ReadableStreamMessageReader",{enumerable:!0,get:function(){return u.ReadableStreamMessageReader}});var c=e.r(781124);Object.defineProperty(n,"MessageWriter",{enumerable:!0,get:function(){return c.MessageWriter}}),Object.defineProperty(n,"AbstractMessageWriter",{enumerable:!0,get:function(){return c.AbstractMessageWriter}}),Object.defineProperty(n,"WriteableStreamMessageWriter",{enumerable:!0,get:function(){return c.WriteableStreamMessageWriter}});var d=e.r(427882);Object.defineProperty(n,"AbstractMessageBuffer",{enumerable:!0,get:function(){return d.AbstractMessageBuffer}});var f=e.r(524217);Object.defineProperty(n,"ConnectionStrategy",{enumerable:!0,get:function(){return f.ConnectionStrategy}}),Object.defineProperty(n,"ConnectionOptions",{enumerable:!0,get:function(){return f.ConnectionOptions}}),Object.defineProperty(n,"NullLogger",{enumerable:!0,get:function(){return f.NullLogger}}),Object.defineProperty(n,"createMessageConnection",{enumerable:!0,get:function(){return f.createMessageConnection}}),Object.defineProperty(n,"ProgressToken",{enumerable:!0,get:function(){return f.ProgressToken}}),Object.defineProperty(n,"ProgressType",{enumerable:!0,get:function(){return f.ProgressType}}),Object.defineProperty(n,"Trace",{enumerable:!0,get:function(){return f.Trace}}),Object.defineProperty(n,"TraceValues",{enumerable:!0,get:function(){return f.TraceValues}}),Object.defineProperty(n,"TraceFormat",{enumerable:!0,get:function(){return f.TraceFormat}}),Object.defineProperty(n,"SetTraceNotification",{enumerable:!0,get:function(){return f.SetTraceNotification}}),Object.defineProperty(n,"LogTraceNotification",{enumerable:!0,get:function(){return f.LogTraceNotification}}),Object.defineProperty(n,"ConnectionErrors",{enumerable:!0,get:function(){return f.ConnectionErrors}}),Object.defineProperty(n,"ConnectionError",{enumerable:!0,get:function(){return f.ConnectionError}}),Object.defineProperty(n,"CancellationReceiverStrategy",{enumerable:!0,get:function(){return f.CancellationReceiverStrategy}}),Object.defineProperty(n,"CancellationSenderStrategy",{enumerable:!0,get:function(){return f.CancellationSenderStrategy}}),Object.defineProperty(n,"CancellationStrategy",{enumerable:!0,get:function(){return f.CancellationStrategy}}),Object.defineProperty(n,"MessageStrategy",{enumerable:!0,get:function(){return f.MessageStrategy}}),n.RAL=e.r(537398).default},166064,(e,t,n)=>{"use strict";var r=e.r(772929),i=e.r(883735),o=e.r(619314),a=e.r(559542),s=e.r(954546),l=e.r(561584);Object.defineProperty(n,"__esModule",{value:!0});var u=e.r(127673),c=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"utf-8";return i._(this,t),(e=r._(this,t,[n])).asciiDecoder=new TextDecoder("ascii"),e}return a._(t,e),o._(t,[{key:"emptyBuffer",value:function(){return t.emptyBuffer}},{key:"fromString",value:function(e,t){return new TextEncoder().encode(e)}},{key:"toString",value:function(e,t){return"ascii"===t?this.asciiDecoder.decode(e):new TextDecoder(t).decode(e)}},{key:"asNative",value:function(e,t){return void 0===t?e:e.slice(0,t)}},{key:"allocNative",value:function(e){return new Uint8Array(e)}}]),t}(u.AbstractMessageBuffer);c.emptyBuffer=new Uint8Array(0);var d=function(){function e(t){var n=this;i._(this,e),this.socket=t,this._onData=new u.Emitter,this._messageListener=function(e){e.data.arrayBuffer().then(function(e){n._onData.fire(new Uint8Array(e))},function(){(0,u.RAL)().console.error("Converting blob to array buffer failed.")})},this.socket.addEventListener("message",this._messageListener)}return o._(e,[{key:"onClose",value:function(e){var t=this;return this.socket.addEventListener("close",e),u.Disposable.create(function(){return t.socket.removeEventListener("close",e)})}},{key:"onError",value:function(e){var t=this;return this.socket.addEventListener("error",e),u.Disposable.create(function(){return t.socket.removeEventListener("error",e)})}},{key:"onEnd",value:function(e){var t=this;return this.socket.addEventListener("end",e),u.Disposable.create(function(){return t.socket.removeEventListener("end",e)})}},{key:"onData",value:function(e){return this._onData.event(e)}}]),e}(),f=function(){function e(t){i._(this,e),this.socket=t}return o._(e,[{key:"onClose",value:function(e){var t=this;return this.socket.addEventListener("close",e),u.Disposable.create(function(){return t.socket.removeEventListener("close",e)})}},{key:"onError",value:function(e){var t=this;return this.socket.addEventListener("error",e),u.Disposable.create(function(){return t.socket.removeEventListener("error",e)})}},{key:"onEnd",value:function(e){var t=this;return this.socket.addEventListener("end",e),u.Disposable.create(function(){return t.socket.removeEventListener("end",e)})}},{key:"write",value:function(e,t){if("string"==typeof e){if(void 0!==t&&"utf-8"!==t)throw Error("In a Browser environments only utf-8 text encoding is supported. But got encoding: ".concat(t));this.socket.send(e)}else this.socket.send(e);return Promise.resolve()}},{key:"end",value:function(){this.socket.close()}}]),e}(),p=new TextEncoder,h=Object.freeze({messageBuffer:Object.freeze({create:function(e){return new c(e)}}),applicationJson:Object.freeze({encoder:Object.freeze({name:"application/json",encode:function(e,t){if("utf-8"!==t.charset)throw Error("In a Browser environments only utf-8 text encoding is supported. But got encoding: ".concat(t.charset));return Promise.resolve(p.encode(JSON.stringify(e,void 0,0)))}}),decoder:Object.freeze({name:"application/json",decode:function(e,t){if(!s._(e,Uint8Array))throw Error("In a Browser environments only Uint8Arrays are supported.");return Promise.resolve(JSON.parse(new TextDecoder(t.charset).decode(e)))}})}),stream:Object.freeze({asReadableStream:function(e){return new d(e)},asWritableStream:function(e){return new f(e)}}),console:console,timer:Object.freeze({setTimeout:function(e,t){for(var n=arguments.length,r=Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];var o=setTimeout.apply(void 0,[e,t].concat(l._(r)));return{dispose:function(){return clearTimeout(o)}}},setImmediate:function(e){for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];var i=setTimeout.apply(void 0,[e,0].concat(l._(n)));return{dispose:function(){return clearTimeout(i)}}},setInterval:function(e,t){for(var n=arguments.length,r=Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];var o=setInterval.apply(void 0,[e,t].concat(l._(r)));return{dispose:function(){return clearInterval(o)}}}})});function g(){return h}(g||(g={})).install=function(){u.RAL.install(h)},n.default=g},134892,(e,t,n)=>{"use strict";var r=e.r(772929),i=e.r(883735),o=e.r(619314),a=e.r(559542),s=e.e&&e.e.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),l=e.e&&e.e.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||s(t,e,n)};Object.defineProperty(n,"__esModule",{value:!0}),n.createMessageConnection=n.BrowserMessageWriter=n.BrowserMessageReader=void 0,e.r(166064).default.install();var u=e.r(127673);l(e.r(127673),n),n.BrowserMessageReader=function(e){function t(e){var n;return i._(this,t),(n=r._(this,t))._onData=new u.Emitter,n._messageListener=function(e){n._onData.fire(e.data)},e.addEventListener("error",function(e){return n.fireError(e)}),e.onmessage=n._messageListener,n}return a._(t,e),o._(t,[{key:"listen",value:function(e){return this._onData.event(e)}}]),t}(u.AbstractMessageReader),n.BrowserMessageWriter=function(e){function t(e){var n;return i._(this,t),(n=r._(this,t)).port=e,n.errorCount=0,e.addEventListener("error",function(e){return n.fireError(e)}),n}return a._(t,e),o._(t,[{key:"write",value:function(e){try{return this.port.postMessage(e),Promise.resolve()}catch(t){return this.handleError(t,e),Promise.reject(t)}}},{key:"handleError",value:function(e,t){this.errorCount++,this.fireError(e,t,this.errorCount)}},{key:"end",value:function(){}}]),t}(u.AbstractMessageWriter),n.createMessageConnection=function(e,t,n,r){return void 0===n&&(n=u.NullLogger),u.ConnectionStrategy.is(r)&&(r={connectionStrategy:r}),(0,u.createMessageConnection)(e,t,n,r)}},829130,(e,t,n)=>{"use strict";t.exports=e.r(134892)},447677,(e,t,n)=>{"use strict";var r,i=e.r(772929),o=e.r(883735),a=e.r(559542);Object.defineProperty(n,"__esModule",{value:!0}),n.ProtocolNotificationType=n.ProtocolNotificationType0=n.ProtocolRequestType=n.ProtocolRequestType0=n.RegistrationType=n.MessageDirection=void 0;var s=e.r(134892);(r=n.MessageDirection||(n.MessageDirection={})).clientToServer="clientToServer",r.serverToClient="serverToClient",r.both="both",n.RegistrationType=function e(t){o._(this,e),this.method=t},n.ProtocolRequestType0=function(e){function t(e){return o._(this,t),i._(this,t,[e])}return a._(t,e),t}(s.RequestType0),n.ProtocolRequestType=function(e){function t(e){return o._(this,t),i._(this,t,[e,s.ParameterStructures.byName])}return a._(t,e),t}(s.RequestType),n.ProtocolNotificationType0=function(e){function t(e){return o._(this,t),i._(this,t,[e])}return a._(t,e),t}(s.NotificationType0),n.ProtocolNotificationType=function(e){function t(e){return o._(this,t),i._(this,t,[e,s.ParameterStructures.byName])}return a._(t,e),t}(s.NotificationType)},630794,(e,t,n)=>{"use strict";var r=e.r(954546),i=e.r(365738);function o(e){return"string"==typeof e||r._(e,String)}function a(e){return Array.isArray(e)}Object.defineProperty(n,"__esModule",{value:!0}),n.objectLiteral=n.typedArray=n.stringArray=n.array=n.func=n.error=n.number=n.string=n.boolean=void 0,n.boolean=function(e){return!0===e||!1===e},n.string=o,n.number=function(e){return"number"==typeof e||r._(e,Number)},n.error=function(e){return r._(e,Error)},n.func=function(e){return"function"==typeof e},n.array=a,n.stringArray=function(e){return a(e)&&e.every(function(e){return o(e)})},n.typedArray=function(e,t){return Array.isArray(e)&&e.every(t)},n.objectLiteral=function(e){return null!==e&&(void 0===e?"undefined":i._(e))==="object"}},54411,(e,t,n)=>{"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.ImplementationRequest=void 0;var r,i=e.r(447677);(r=n.ImplementationRequest||(n.ImplementationRequest={})).method="textDocument/implementation",r.messageDirection=i.MessageDirection.clientToServer,r.type=new i.ProtocolRequestType(r.method)},988115,(e,t,n)=>{"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.TypeDefinitionRequest=void 0;var r,i=e.r(447677);(r=n.TypeDefinitionRequest||(n.TypeDefinitionRequest={})).method="textDocument/typeDefinition",r.messageDirection=i.MessageDirection.clientToServer,r.type=new i.ProtocolRequestType(r.method)},342835,(e,t,n)=>{"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.DidChangeWorkspaceFoldersNotification=n.WorkspaceFoldersRequest=void 0;var r,i,o=e.r(447677);(r=n.WorkspaceFoldersRequest||(n.WorkspaceFoldersRequest={})).method="workspace/workspaceFolders",r.messageDirection=o.MessageDirection.serverToClient,r.type=new o.ProtocolRequestType0(r.method),(i=n.DidChangeWorkspaceFoldersNotification||(n.DidChangeWorkspaceFoldersNotification={})).method="workspace/didChangeWorkspaceFolders",i.messageDirection=o.MessageDirection.clientToServer,i.type=new o.ProtocolNotificationType(i.method)},707767,(e,t,n)=>{"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.ConfigurationRequest=void 0;var r,i=e.r(447677);(r=n.ConfigurationRequest||(n.ConfigurationRequest={})).method="workspace/configuration",r.messageDirection=i.MessageDirection.serverToClient,r.type=new i.ProtocolRequestType(r.method)},364024,(e,t,n)=>{"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.ColorPresentationRequest=n.DocumentColorRequest=void 0;var r,i,o=e.r(447677);(r=n.DocumentColorRequest||(n.DocumentColorRequest={})).method="textDocument/documentColor",r.messageDirection=o.MessageDirection.clientToServer,r.type=new o.ProtocolRequestType(r.method),(i=n.ColorPresentationRequest||(n.ColorPresentationRequest={})).method="textDocument/colorPresentation",i.messageDirection=o.MessageDirection.clientToServer,i.type=new o.ProtocolRequestType(i.method)},710112,(e,t,n)=>{"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.FoldingRangeRequest=void 0;var r,i=e.r(447677);(r=n.FoldingRangeRequest||(n.FoldingRangeRequest={})).method="textDocument/foldingRange",r.messageDirection=i.MessageDirection.clientToServer,r.type=new i.ProtocolRequestType(r.method)},840465,(e,t,n)=>{"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.DeclarationRequest=void 0;var r,i=e.r(447677);(r=n.DeclarationRequest||(n.DeclarationRequest={})).method="textDocument/declaration",r.messageDirection=i.MessageDirection.clientToServer,r.type=new i.ProtocolRequestType(r.method)},492665,(e,t,n)=>{"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.SelectionRangeRequest=void 0;var r,i=e.r(447677);(r=n.SelectionRangeRequest||(n.SelectionRangeRequest={})).method="textDocument/selectionRange",r.messageDirection=i.MessageDirection.clientToServer,r.type=new i.ProtocolRequestType(r.method)},374513,(e,t,n)=>{"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.WorkDoneProgressCancelNotification=n.WorkDoneProgressCreateRequest=n.WorkDoneProgress=void 0;var r,i,o,a=e.r(134892),s=e.r(447677);(r=n.WorkDoneProgress||(n.WorkDoneProgress={})).type=new a.ProgressType,r.is=function(e){return e===r.type},(i=n.WorkDoneProgressCreateRequest||(n.WorkDoneProgressCreateRequest={})).method="window/workDoneProgress/create",i.messageDirection=s.MessageDirection.serverToClient,i.type=new s.ProtocolRequestType(i.method),(o=n.WorkDoneProgressCancelNotification||(n.WorkDoneProgressCancelNotification={})).method="window/workDoneProgress/cancel",o.messageDirection=s.MessageDirection.clientToServer,o.type=new s.ProtocolNotificationType(o.method)},397675,(e,t,n)=>{"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.CallHierarchyOutgoingCallsRequest=n.CallHierarchyIncomingCallsRequest=n.CallHierarchyPrepareRequest=void 0;var r,i,o,a=e.r(447677);(r=n.CallHierarchyPrepareRequest||(n.CallHierarchyPrepareRequest={})).method="textDocument/prepareCallHierarchy",r.messageDirection=a.MessageDirection.clientToServer,r.type=new a.ProtocolRequestType(r.method),(i=n.CallHierarchyIncomingCallsRequest||(n.CallHierarchyIncomingCallsRequest={})).method="callHierarchy/incomingCalls",i.messageDirection=a.MessageDirection.clientToServer,i.type=new a.ProtocolRequestType(i.method),(o=n.CallHierarchyOutgoingCallsRequest||(n.CallHierarchyOutgoingCallsRequest={})).method="callHierarchy/outgoingCalls",o.messageDirection=a.MessageDirection.clientToServer,o.type=new a.ProtocolRequestType(o.method)},707923,(e,t,n)=>{"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.SemanticTokensRefreshRequest=n.SemanticTokensRangeRequest=n.SemanticTokensDeltaRequest=n.SemanticTokensRequest=n.SemanticTokensRegistrationType=n.TokenFormat=void 0;var r,i,o,a,s,l,u=e.r(447677);(n.TokenFormat||(n.TokenFormat={})).Relative="relative",(r=l=n.SemanticTokensRegistrationType||(n.SemanticTokensRegistrationType={})).method="textDocument/semanticTokens",r.type=new u.RegistrationType(r.method),(i=n.SemanticTokensRequest||(n.SemanticTokensRequest={})).method="textDocument/semanticTokens/full",i.messageDirection=u.MessageDirection.clientToServer,i.type=new u.ProtocolRequestType(i.method),i.registrationMethod=l.method,(o=n.SemanticTokensDeltaRequest||(n.SemanticTokensDeltaRequest={})).method="textDocument/semanticTokens/full/delta",o.messageDirection=u.MessageDirection.clientToServer,o.type=new u.ProtocolRequestType(o.method),o.registrationMethod=l.method,(a=n.SemanticTokensRangeRequest||(n.SemanticTokensRangeRequest={})).method="textDocument/semanticTokens/range",a.messageDirection=u.MessageDirection.clientToServer,a.type=new u.ProtocolRequestType(a.method),a.registrationMethod=l.method,(s=n.SemanticTokensRefreshRequest||(n.SemanticTokensRefreshRequest={})).method="workspace/semanticTokens/refresh",s.messageDirection=u.MessageDirection.serverToClient,s.type=new u.ProtocolRequestType0(s.method)},224336,(e,t,n)=>{"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.ShowDocumentRequest=void 0;var r,i=e.r(447677);(r=n.ShowDocumentRequest||(n.ShowDocumentRequest={})).method="window/showDocument",r.messageDirection=i.MessageDirection.serverToClient,r.type=new i.ProtocolRequestType(r.method)},526344,(e,t,n)=>{"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.LinkedEditingRangeRequest=void 0;var r,i=e.r(447677);(r=n.LinkedEditingRangeRequest||(n.LinkedEditingRangeRequest={})).method="textDocument/linkedEditingRange",r.messageDirection=i.MessageDirection.clientToServer,r.type=new i.ProtocolRequestType(r.method)},180912,(e,t,n)=>{"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.WillDeleteFilesRequest=n.DidDeleteFilesNotification=n.DidRenameFilesNotification=n.WillRenameFilesRequest=n.DidCreateFilesNotification=n.WillCreateFilesRequest=n.FileOperationPatternKind=void 0;var r,i,o,a,s,l,u,c=e.r(447677);(r=n.FileOperationPatternKind||(n.FileOperationPatternKind={})).file="file",r.folder="folder",(i=n.WillCreateFilesRequest||(n.WillCreateFilesRequest={})).method="workspace/willCreateFiles",i.messageDirection=c.MessageDirection.clientToServer,i.type=new c.ProtocolRequestType(i.method),(o=n.DidCreateFilesNotification||(n.DidCreateFilesNotification={})).method="workspace/didCreateFiles",o.messageDirection=c.MessageDirection.clientToServer,o.type=new c.ProtocolNotificationType(o.method),(a=n.WillRenameFilesRequest||(n.WillRenameFilesRequest={})).method="workspace/willRenameFiles",a.messageDirection=c.MessageDirection.clientToServer,a.type=new c.ProtocolRequestType(a.method),(s=n.DidRenameFilesNotification||(n.DidRenameFilesNotification={})).method="workspace/didRenameFiles",s.messageDirection=c.MessageDirection.clientToServer,s.type=new c.ProtocolNotificationType(s.method),(l=n.DidDeleteFilesNotification||(n.DidDeleteFilesNotification={})).method="workspace/didDeleteFiles",l.messageDirection=c.MessageDirection.clientToServer,l.type=new c.ProtocolNotificationType(l.method),(u=n.WillDeleteFilesRequest||(n.WillDeleteFilesRequest={})).method="workspace/willDeleteFiles",u.messageDirection=c.MessageDirection.clientToServer,u.type=new c.ProtocolRequestType(u.method)},913963,(e,t,n)=>{"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.MonikerRequest=n.MonikerKind=n.UniquenessLevel=void 0;var r,i,o,a=e.r(447677);(r=n.UniquenessLevel||(n.UniquenessLevel={})).document="document",r.project="project",r.group="group",r.scheme="scheme",r.global="global",(i=n.MonikerKind||(n.MonikerKind={})).$import="import",i.$export="export",i.local="local",(o=n.MonikerRequest||(n.MonikerRequest={})).method="textDocument/moniker",o.messageDirection=a.MessageDirection.clientToServer,o.type=new a.ProtocolRequestType(o.method)},882591,(e,t,n)=>{"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.TypeHierarchySubtypesRequest=n.TypeHierarchySupertypesRequest=n.TypeHierarchyPrepareRequest=void 0;var r,i,o,a=e.r(447677);(r=n.TypeHierarchyPrepareRequest||(n.TypeHierarchyPrepareRequest={})).method="textDocument/prepareTypeHierarchy",r.messageDirection=a.MessageDirection.clientToServer,r.type=new a.ProtocolRequestType(r.method),(i=n.TypeHierarchySupertypesRequest||(n.TypeHierarchySupertypesRequest={})).method="typeHierarchy/supertypes",i.messageDirection=a.MessageDirection.clientToServer,i.type=new a.ProtocolRequestType(i.method),(o=n.TypeHierarchySubtypesRequest||(n.TypeHierarchySubtypesRequest={})).method="typeHierarchy/subtypes",o.messageDirection=a.MessageDirection.clientToServer,o.type=new a.ProtocolRequestType(o.method)},562440,(e,t,n)=>{"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.InlineValueRefreshRequest=n.InlineValueRequest=void 0;var r,i,o=e.r(447677);(r=n.InlineValueRequest||(n.InlineValueRequest={})).method="textDocument/inlineValue",r.messageDirection=o.MessageDirection.clientToServer,r.type=new o.ProtocolRequestType(r.method),(i=n.InlineValueRefreshRequest||(n.InlineValueRefreshRequest={})).method="workspace/inlineValue/refresh",i.messageDirection=o.MessageDirection.serverToClient,i.type=new o.ProtocolRequestType0(i.method)},816872,(e,t,n)=>{"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.InlayHintRefreshRequest=n.InlayHintResolveRequest=n.InlayHintRequest=void 0;var r,i,o,a=e.r(447677);(r=n.InlayHintRequest||(n.InlayHintRequest={})).method="textDocument/inlayHint",r.messageDirection=a.MessageDirection.clientToServer,r.type=new a.ProtocolRequestType(r.method),(i=n.InlayHintResolveRequest||(n.InlayHintResolveRequest={})).method="inlayHint/resolve",i.messageDirection=a.MessageDirection.clientToServer,i.type=new a.ProtocolRequestType(i.method),(o=n.InlayHintRefreshRequest||(n.InlayHintRefreshRequest={})).method="workspace/inlayHint/refresh",o.messageDirection=a.MessageDirection.serverToClient,o.type=new a.ProtocolRequestType0(o.method)},482196,(e,t,n)=>{"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.DiagnosticRefreshRequest=n.WorkspaceDiagnosticRequest=n.DocumentDiagnosticRequest=n.DocumentDiagnosticReportKind=n.DiagnosticServerCancellationData=void 0;var r,i,o,a,s=e.r(134892),l=e.r(630794),u=e.r(447677);(n.DiagnosticServerCancellationData||(n.DiagnosticServerCancellationData={})).is=function(e){return e&&l.boolean(e.retriggerRequest)},(r=n.DocumentDiagnosticReportKind||(n.DocumentDiagnosticReportKind={})).Full="full",r.Unchanged="unchanged",(i=n.DocumentDiagnosticRequest||(n.DocumentDiagnosticRequest={})).method="textDocument/diagnostic",i.messageDirection=u.MessageDirection.clientToServer,i.type=new u.ProtocolRequestType(i.method),i.partialResult=new s.ProgressType,(o=n.WorkspaceDiagnosticRequest||(n.WorkspaceDiagnosticRequest={})).method="workspace/diagnostic",o.messageDirection=u.MessageDirection.clientToServer,o.type=new u.ProtocolRequestType(o.method),o.partialResult=new s.ProgressType,(a=n.DiagnosticRefreshRequest||(n.DiagnosticRefreshRequest={})).method="workspace/diagnostic/refresh",a.messageDirection=u.MessageDirection.serverToClient,a.type=new u.ProtocolRequestType0(a.method)},381611,(e,t,n)=>{"use strict";var r,i,o,a,s,l,u,c,d,f,p,h,g,m,x=e.r(365738);Object.defineProperty(n,"__esModule",{value:!0}),n.DidCloseNotebookDocumentNotification=n.DidSaveNotebookDocumentNotification=n.DidChangeNotebookDocumentNotification=n.NotebookCellArrayChange=n.DidOpenNotebookDocumentNotification=n.NotebookDocumentSyncRegistrationType=n.NotebookDocument=n.NotebookCell=n.ExecutionSummary=n.NotebookCellKind=void 0;var y=e.r(333859),b=e.r(630794),w=e.r(447677);(r=p=n.NotebookCellKind||(n.NotebookCellKind={})).Markup=1,r.Code=2,r.is=function(e){return 1===e||2===e},(i=h=n.ExecutionSummary||(n.ExecutionSummary={})).create=function(e,t){var n={executionOrder:e};return(!0===t||!1===t)&&(n.success=t),n},i.is=function(e){return b.objectLiteral(e)&&y.uinteger.is(e.executionOrder)&&(void 0===e.success||b.boolean(e.success))},i.equals=function(e,t){return e===t||null!=e&&null!=t&&e.executionOrder===t.executionOrder&&e.success===t.success},(o=g=n.NotebookCell||(n.NotebookCell={})).create=function(e,t){return{kind:e,document:t}},o.is=function(e){return b.objectLiteral(e)&&p.is(e.kind)&&y.DocumentUri.is(e.document)&&(void 0===e.metadata||b.objectLiteral(e.metadata))},o.diff=function(e,t){var n=new Set;return e.document!==t.document&&n.add("document"),e.kind!==t.kind&&n.add("kind"),e.executionSummary!==t.executionSummary&&n.add("executionSummary"),(void 0!==e.metadata||void 0!==t.metadata)&&!function e(t,n){if(t===n)return!0;if(null==t||null==n||(void 0===t?"undefined":x._(t))!==(void 0===n?"undefined":x._(n))||(void 0===t?"undefined":x._(t))!=="object")return!1;var r=Array.isArray(t),i=Array.isArray(n);if(r!==i)return!1;if(r&&i){if(t.length!==n.length)return!1;for(var o=0;o<t.length;o++)if(!e(t[o],n[o]))return!1}if(b.objectLiteral(t)&&b.objectLiteral(n)){var a=Object.keys(t),s=Object.keys(n);if(a.length!==s.length||(a.sort(),s.sort(),!e(a,s)))return!1;for(var l=0;l<a.length;l++){var u=a[l];if(!e(t[u],n[u]))return!1}}return!0}(e.metadata,t.metadata)&&n.add("metadata"),void 0===e.executionSummary&&void 0===t.executionSummary||h.equals(e.executionSummary,t.executionSummary)||n.add("executionSummary"),n},(a=n.NotebookDocument||(n.NotebookDocument={})).create=function(e,t,n,r){return{uri:e,notebookType:t,version:n,cells:r}},a.is=function(e){return b.objectLiteral(e)&&b.string(e.uri)&&y.integer.is(e.version)&&b.typedArray(e.cells,g.is)},(s=m=n.NotebookDocumentSyncRegistrationType||(n.NotebookDocumentSyncRegistrationType={})).method="notebookDocument/sync",s.messageDirection=w.MessageDirection.clientToServer,s.type=new w.RegistrationType(s.method),(l=n.DidOpenNotebookDocumentNotification||(n.DidOpenNotebookDocumentNotification={})).method="notebookDocument/didOpen",l.messageDirection=w.MessageDirection.clientToServer,l.type=new w.ProtocolNotificationType(l.method),l.registrationMethod=m.method,(u=n.NotebookCellArrayChange||(n.NotebookCellArrayChange={})).is=function(e){return b.objectLiteral(e)&&y.uinteger.is(e.start)&&y.uinteger.is(e.deleteCount)&&(void 0===e.cells||b.typedArray(e.cells,g.is))},u.create=function(e,t,n){var r={start:e,deleteCount:t};return void 0!==n&&(r.cells=n),r},(c=n.DidChangeNotebookDocumentNotification||(n.DidChangeNotebookDocumentNotification={})).method="notebookDocument/didChange",c.messageDirection=w.MessageDirection.clientToServer,c.type=new w.ProtocolNotificationType(c.method),c.registrationMethod=m.method,(d=n.DidSaveNotebookDocumentNotification||(n.DidSaveNotebookDocumentNotification={})).method="notebookDocument/didSave",d.messageDirection=w.MessageDirection.clientToServer,d.type=new w.ProtocolNotificationType(d.method),d.registrationMethod=m.method,(f=n.DidCloseNotebookDocumentNotification||(n.DidCloseNotebookDocumentNotification={})).method="notebookDocument/didClose",f.messageDirection=w.MessageDirection.clientToServer,f.type=new w.ProtocolNotificationType(f.method),f.registrationMethod=m.method},901241,(e,t,n)=>{"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.WorkspaceSymbolRequest=n.CodeActionResolveRequest=n.CodeActionRequest=n.DocumentSymbolRequest=n.DocumentHighlightRequest=n.ReferencesRequest=n.DefinitionRequest=n.SignatureHelpRequest=n.SignatureHelpTriggerKind=n.HoverRequest=n.CompletionResolveRequest=n.CompletionRequest=n.CompletionTriggerKind=n.PublishDiagnosticsNotification=n.WatchKind=n.RelativePattern=n.FileChangeType=n.DidChangeWatchedFilesNotification=n.WillSaveTextDocumentWaitUntilRequest=n.WillSaveTextDocumentNotification=n.TextDocumentSaveReason=n.DidSaveTextDocumentNotification=n.DidCloseTextDocumentNotification=n.DidChangeTextDocumentNotification=n.TextDocumentContentChangeEvent=n.DidOpenTextDocumentNotification=n.TextDocumentSyncKind=n.TelemetryEventNotification=n.LogMessageNotification=n.ShowMessageRequest=n.ShowMessageNotification=n.MessageType=n.DidChangeConfigurationNotification=n.ExitNotification=n.ShutdownRequest=n.InitializedNotification=n.InitializeErrorCodes=n.InitializeRequest=n.WorkDoneProgressOptions=n.TextDocumentRegistrationOptions=n.StaticRegistrationOptions=n.PositionEncodingKind=n.FailureHandlingKind=n.ResourceOperationKind=n.UnregistrationRequest=n.RegistrationRequest=n.DocumentSelector=n.NotebookCellTextDocumentFilter=n.NotebookDocumentFilter=n.TextDocumentFilter=void 0,n.TypeHierarchySubtypesRequest=n.TypeHierarchyPrepareRequest=n.MonikerRequest=n.MonikerKind=n.UniquenessLevel=n.WillDeleteFilesRequest=n.DidDeleteFilesNotification=n.WillRenameFilesRequest=n.DidRenameFilesNotification=n.WillCreateFilesRequest=n.DidCreateFilesNotification=n.FileOperationPatternKind=n.LinkedEditingRangeRequest=n.ShowDocumentRequest=n.SemanticTokensRegistrationType=n.SemanticTokensRefreshRequest=n.SemanticTokensRangeRequest=n.SemanticTokensDeltaRequest=n.SemanticTokensRequest=n.TokenFormat=n.CallHierarchyPrepareRequest=n.CallHierarchyOutgoingCallsRequest=n.CallHierarchyIncomingCallsRequest=n.WorkDoneProgressCancelNotification=n.WorkDoneProgressCreateRequest=n.WorkDoneProgress=n.SelectionRangeRequest=n.DeclarationRequest=n.FoldingRangeRequest=n.ColorPresentationRequest=n.DocumentColorRequest=n.ConfigurationRequest=n.DidChangeWorkspaceFoldersNotification=n.WorkspaceFoldersRequest=n.TypeDefinitionRequest=n.ImplementationRequest=n.ApplyWorkspaceEditRequest=n.ExecuteCommandRequest=n.PrepareRenameRequest=n.RenameRequest=n.PrepareSupportDefaultBehavior=n.DocumentOnTypeFormattingRequest=n.DocumentRangeFormattingRequest=n.DocumentFormattingRequest=n.DocumentLinkResolveRequest=n.DocumentLinkRequest=n.CodeLensRefreshRequest=n.CodeLensResolveRequest=n.CodeLensRequest=n.WorkspaceSymbolResolveRequest=void 0,n.DidCloseNotebookDocumentNotification=n.DidSaveNotebookDocumentNotification=n.DidChangeNotebookDocumentNotification=n.NotebookCellArrayChange=n.DidOpenNotebookDocumentNotification=n.NotebookDocumentSyncRegistrationType=n.NotebookDocument=n.NotebookCell=n.ExecutionSummary=n.NotebookCellKind=n.DiagnosticRefreshRequest=n.WorkspaceDiagnosticRequest=n.DocumentDiagnosticRequest=n.DocumentDiagnosticReportKind=n.DiagnosticServerCancellationData=n.InlayHintRefreshRequest=n.InlayHintResolveRequest=n.InlayHintRequest=n.InlineValueRefreshRequest=n.InlineValueRequest=n.TypeHierarchySupertypesRequest=void 0;var r,i,o,a,s,l,u,c,d,f,p,h,g,m,x,y,b,w,k,_,S,C,j,T,E,R,I,A,P,D,O,N,M,L,B,V,F,U,G,$,z,H,W,q,K,Y,Q,X,J,Z,ee,et,en,er,ei,eo,ea,es,el,eu=e.r(447677),ec=e.r(333859),ed=e.r(630794),ef=e.r(54411);Object.defineProperty(n,"ImplementationRequest",{enumerable:!0,get:function(){return ef.ImplementationRequest}});var ep=e.r(988115);Object.defineProperty(n,"TypeDefinitionRequest",{enumerable:!0,get:function(){return ep.TypeDefinitionRequest}});var eh=e.r(342835);Object.defineProperty(n,"WorkspaceFoldersRequest",{enumerable:!0,get:function(){return eh.WorkspaceFoldersRequest}}),Object.defineProperty(n,"DidChangeWorkspaceFoldersNotification",{enumerable:!0,get:function(){return eh.DidChangeWorkspaceFoldersNotification}});var eg=e.r(707767);Object.defineProperty(n,"ConfigurationRequest",{enumerable:!0,get:function(){return eg.ConfigurationRequest}});var em=e.r(364024);Object.defineProperty(n,"DocumentColorRequest",{enumerable:!0,get:function(){return em.DocumentColorRequest}}),Object.defineProperty(n,"ColorPresentationRequest",{enumerable:!0,get:function(){return em.ColorPresentationRequest}});var ev=e.r(710112);Object.defineProperty(n,"FoldingRangeRequest",{enumerable:!0,get:function(){return ev.FoldingRangeRequest}});var ex=e.r(840465);Object.defineProperty(n,"DeclarationRequest",{enumerable:!0,get:function(){return ex.DeclarationRequest}});var ey=e.r(492665);Object.defineProperty(n,"SelectionRangeRequest",{enumerable:!0,get:function(){return ey.SelectionRangeRequest}});var eb=e.r(374513);Object.defineProperty(n,"WorkDoneProgress",{enumerable:!0,get:function(){return eb.WorkDoneProgress}}),Object.defineProperty(n,"WorkDoneProgressCreateRequest",{enumerable:!0,get:function(){return eb.WorkDoneProgressCreateRequest}}),Object.defineProperty(n,"WorkDoneProgressCancelNotification",{enumerable:!0,get:function(){return eb.WorkDoneProgressCancelNotification}});var ew=e.r(397675);Object.defineProperty(n,"CallHierarchyIncomingCallsRequest",{enumerable:!0,get:function(){return ew.CallHierarchyIncomingCallsRequest}}),Object.defineProperty(n,"CallHierarchyOutgoingCallsRequest",{enumerable:!0,get:function(){return ew.CallHierarchyOutgoingCallsRequest}}),Object.defineProperty(n,"CallHierarchyPrepareRequest",{enumerable:!0,get:function(){return ew.CallHierarchyPrepareRequest}});var ek=e.r(707923);Object.defineProperty(n,"TokenFormat",{enumerable:!0,get:function(){return ek.TokenFormat}}),Object.defineProperty(n,"SemanticTokensRequest",{enumerable:!0,get:function(){return ek.SemanticTokensRequest}}),Object.defineProperty(n,"SemanticTokensDeltaRequest",{enumerable:!0,get:function(){return ek.SemanticTokensDeltaRequest}}),Object.defineProperty(n,"SemanticTokensRangeRequest",{enumerable:!0,get:function(){return ek.SemanticTokensRangeRequest}}),Object.defineProperty(n,"SemanticTokensRefreshRequest",{enumerable:!0,get:function(){return ek.SemanticTokensRefreshRequest}}),Object.defineProperty(n,"SemanticTokensRegistrationType",{enumerable:!0,get:function(){return ek.SemanticTokensRegistrationType}});var e_=e.r(224336);Object.defineProperty(n,"ShowDocumentRequest",{enumerable:!0,get:function(){return e_.ShowDocumentRequest}});var eS=e.r(526344);Object.defineProperty(n,"LinkedEditingRangeRequest",{enumerable:!0,get:function(){return eS.LinkedEditingRangeRequest}});var eC=e.r(180912);Object.defineProperty(n,"FileOperationPatternKind",{enumerable:!0,get:function(){return eC.FileOperationPatternKind}}),Object.defineProperty(n,"DidCreateFilesNotification",{enumerable:!0,get:function(){return eC.DidCreateFilesNotification}}),Object.defineProperty(n,"WillCreateFilesRequest",{enumerable:!0,get:function(){return eC.WillCreateFilesRequest}}),Object.defineProperty(n,"DidRenameFilesNotification",{enumerable:!0,get:function(){return eC.DidRenameFilesNotification}}),Object.defineProperty(n,"WillRenameFilesRequest",{enumerable:!0,get:function(){return eC.WillRenameFilesRequest}}),Object.defineProperty(n,"DidDeleteFilesNotification",{enumerable:!0,get:function(){return eC.DidDeleteFilesNotification}}),Object.defineProperty(n,"WillDeleteFilesRequest",{enumerable:!0,get:function(){return eC.WillDeleteFilesRequest}});var ej=e.r(913963);Object.defineProperty(n,"UniquenessLevel",{enumerable:!0,get:function(){return ej.UniquenessLevel}}),Object.defineProperty(n,"MonikerKind",{enumerable:!0,get:function(){return ej.MonikerKind}}),Object.defineProperty(n,"MonikerRequest",{enumerable:!0,get:function(){return ej.MonikerRequest}});var eT=e.r(882591);Object.defineProperty(n,"TypeHierarchyPrepareRequest",{enumerable:!0,get:function(){return eT.TypeHierarchyPrepareRequest}}),Object.defineProperty(n,"TypeHierarchySubtypesRequest",{enumerable:!0,get:function(){return eT.TypeHierarchySubtypesRequest}}),Object.defineProperty(n,"TypeHierarchySupertypesRequest",{enumerable:!0,get:function(){return eT.TypeHierarchySupertypesRequest}});var eE=e.r(562440);Object.defineProperty(n,"InlineValueRequest",{enumerable:!0,get:function(){return eE.InlineValueRequest}}),Object.defineProperty(n,"InlineValueRefreshRequest",{enumerable:!0,get:function(){return eE.InlineValueRefreshRequest}});var eR=e.r(816872);Object.defineProperty(n,"InlayHintRequest",{enumerable:!0,get:function(){return eR.InlayHintRequest}}),Object.defineProperty(n,"InlayHintResolveRequest",{enumerable:!0,get:function(){return eR.InlayHintResolveRequest}}),Object.defineProperty(n,"InlayHintRefreshRequest",{enumerable:!0,get:function(){return eR.InlayHintRefreshRequest}});var eI=e.r(482196);Object.defineProperty(n,"DiagnosticServerCancellationData",{enumerable:!0,get:function(){return eI.DiagnosticServerCancellationData}}),Object.defineProperty(n,"DocumentDiagnosticReportKind",{enumerable:!0,get:function(){return eI.DocumentDiagnosticReportKind}}),Object.defineProperty(n,"DocumentDiagnosticRequest",{enumerable:!0,get:function(){return eI.DocumentDiagnosticRequest}}),Object.defineProperty(n,"WorkspaceDiagnosticRequest",{enumerable:!0,get:function(){return eI.WorkspaceDiagnosticRequest}}),Object.defineProperty(n,"DiagnosticRefreshRequest",{enumerable:!0,get:function(){return eI.DiagnosticRefreshRequest}});var eA=e.r(381611);Object.defineProperty(n,"NotebookCellKind",{enumerable:!0,get:function(){return eA.NotebookCellKind}}),Object.defineProperty(n,"ExecutionSummary",{enumerable:!0,get:function(){return eA.ExecutionSummary}}),Object.defineProperty(n,"NotebookCell",{enumerable:!0,get:function(){return eA.NotebookCell}}),Object.defineProperty(n,"NotebookDocument",{enumerable:!0,get:function(){return eA.NotebookDocument}}),Object.defineProperty(n,"NotebookDocumentSyncRegistrationType",{enumerable:!0,get:function(){return eA.NotebookDocumentSyncRegistrationType}}),Object.defineProperty(n,"DidOpenNotebookDocumentNotification",{enumerable:!0,get:function(){return eA.DidOpenNotebookDocumentNotification}}),Object.defineProperty(n,"NotebookCellArrayChange",{enumerable:!0,get:function(){return eA.NotebookCellArrayChange}}),Object.defineProperty(n,"DidChangeNotebookDocumentNotification",{enumerable:!0,get:function(){return eA.DidChangeNotebookDocumentNotification}}),Object.defineProperty(n,"DidSaveNotebookDocumentNotification",{enumerable:!0,get:function(){return eA.DidSaveNotebookDocumentNotification}}),Object.defineProperty(n,"DidCloseNotebookDocumentNotification",{enumerable:!0,get:function(){return eA.DidCloseNotebookDocumentNotification}}),(eo=n.TextDocumentFilter||(n.TextDocumentFilter={})).is=function(e){return ed.string(e.language)||ed.string(e.scheme)||ed.string(e.pattern)},(ea=n.NotebookDocumentFilter||(n.NotebookDocumentFilter={})).is=function(e){return ed.objectLiteral(e)&&(ed.string(e.notebookType)||ed.string(e.scheme)||ed.string(e.pattern))},(es=n.NotebookCellTextDocumentFilter||(n.NotebookCellTextDocumentFilter={})).is=function(e){return ed.objectLiteral(e)&&(ed.string(e.notebook)||ea.is(e.notebook))&&(void 0===e.language||ed.string(e.language))},(el=n.DocumentSelector||(n.DocumentSelector={})).is=function(e){if(!Array.isArray(e))return!1;var t=!0,n=!1,r=void 0;try{for(var i,o=e[Symbol.iterator]();!(t=(i=o.next()).done);t=!0){var a=i.value;if(!ed.string(a)&&!eo.is(a)&&!es.is(a))return!1}}catch(e){n=!0,r=e}finally{try{t||null==o.return||o.return()}finally{if(n)throw r}}return!0},(r=n.RegistrationRequest||(n.RegistrationRequest={})).method="client/registerCapability",r.messageDirection=eu.MessageDirection.serverToClient,r.type=new eu.ProtocolRequestType(r.method),(i=n.UnregistrationRequest||(n.UnregistrationRequest={})).method="client/unregisterCapability",i.messageDirection=eu.MessageDirection.serverToClient,i.type=new eu.ProtocolRequestType(i.method),(o=n.ResourceOperationKind||(n.ResourceOperationKind={})).Create="create",o.Rename="rename",o.Delete="delete",(a=n.FailureHandlingKind||(n.FailureHandlingKind={})).Abort="abort",a.Transactional="transactional",a.TextOnlyTransactional="textOnlyTransactional",a.Undo="undo",(s=n.PositionEncodingKind||(n.PositionEncodingKind={})).UTF8="utf-8",s.UTF16="utf-16",s.UTF32="utf-32",(n.StaticRegistrationOptions||(n.StaticRegistrationOptions={})).hasId=function(e){return e&&ed.string(e.id)&&e.id.length>0},(n.TextDocumentRegistrationOptions||(n.TextDocumentRegistrationOptions={})).is=function(e){return e&&(null===e.documentSelector||el.is(e.documentSelector))},(l=n.WorkDoneProgressOptions||(n.WorkDoneProgressOptions={})).is=function(e){return ed.objectLiteral(e)&&(void 0===e.workDoneProgress||ed.boolean(e.workDoneProgress))},l.hasWorkDoneProgress=function(e){return e&&ed.boolean(e.workDoneProgress)},(u=n.InitializeRequest||(n.InitializeRequest={})).method="initialize",u.messageDirection=eu.MessageDirection.clientToServer,u.type=new eu.ProtocolRequestType(u.method),(n.InitializeErrorCodes||(n.InitializeErrorCodes={})).unknownProtocolVersion=1,(c=n.InitializedNotification||(n.InitializedNotification={})).method="initialized",c.messageDirection=eu.MessageDirection.clientToServer,c.type=new eu.ProtocolNotificationType(c.method),(d=n.ShutdownRequest||(n.ShutdownRequest={})).method="shutdown",d.messageDirection=eu.MessageDirection.clientToServer,d.type=new eu.ProtocolRequestType0(d.method),(f=n.ExitNotification||(n.ExitNotification={})).method="exit",f.messageDirection=eu.MessageDirection.clientToServer,f.type=new eu.ProtocolNotificationType0(f.method),(p=n.DidChangeConfigurationNotification||(n.DidChangeConfigurationNotification={})).method="workspace/didChangeConfiguration",p.messageDirection=eu.MessageDirection.clientToServer,p.type=new eu.ProtocolNotificationType(p.method),(h=n.MessageType||(n.MessageType={})).Error=1,h.Warning=2,h.Info=3,h.Log=4,(g=n.ShowMessageNotification||(n.ShowMessageNotification={})).method="window/showMessage",g.messageDirection=eu.MessageDirection.serverToClient,g.type=new eu.ProtocolNotificationType(g.method),(m=n.ShowMessageRequest||(n.ShowMessageRequest={})).method="window/showMessageRequest",m.messageDirection=eu.MessageDirection.serverToClient,m.type=new eu.ProtocolRequestType(m.method),(x=n.LogMessageNotification||(n.LogMessageNotification={})).method="window/logMessage",x.messageDirection=eu.MessageDirection.serverToClient,x.type=new eu.ProtocolNotificationType(x.method),(y=n.TelemetryEventNotification||(n.TelemetryEventNotification={})).method="telemetry/event",y.messageDirection=eu.MessageDirection.serverToClient,y.type=new eu.ProtocolNotificationType(y.method),(b=n.TextDocumentSyncKind||(n.TextDocumentSyncKind={})).None=0,b.Full=1,b.Incremental=2,(w=n.DidOpenTextDocumentNotification||(n.DidOpenTextDocumentNotification={})).method="textDocument/didOpen",w.messageDirection=eu.MessageDirection.clientToServer,w.type=new eu.ProtocolNotificationType(w.method),(k=n.TextDocumentContentChangeEvent||(n.TextDocumentContentChangeEvent={})).isIncremental=function(e){return null!=e&&"string"==typeof e.text&&void 0!==e.range&&(void 0===e.rangeLength||"number"==typeof e.rangeLength)},k.isFull=function(e){return null!=e&&"string"==typeof e.text&&void 0===e.range&&void 0===e.rangeLength},(_=n.DidChangeTextDocumentNotification||(n.DidChangeTextDocumentNotification={})).method="textDocument/didChange",_.messageDirection=eu.MessageDirection.clientToServer,_.type=new eu.ProtocolNotificationType(_.method),(S=n.DidCloseTextDocumentNotification||(n.DidCloseTextDocumentNotification={})).method="textDocument/didClose",S.messageDirection=eu.MessageDirection.clientToServer,S.type=new eu.ProtocolNotificationType(S.method),(C=n.DidSaveTextDocumentNotification||(n.DidSaveTextDocumentNotification={})).method="textDocument/didSave",C.messageDirection=eu.MessageDirection.clientToServer,C.type=new eu.ProtocolNotificationType(C.method),(j=n.TextDocumentSaveReason||(n.TextDocumentSaveReason={})).Manual=1,j.AfterDelay=2,j.FocusOut=3,(T=n.WillSaveTextDocumentNotification||(n.WillSaveTextDocumentNotification={})).method="textDocument/willSave",T.messageDirection=eu.MessageDirection.clientToServer,T.type=new eu.ProtocolNotificationType(T.method),(E=n.WillSaveTextDocumentWaitUntilRequest||(n.WillSaveTextDocumentWaitUntilRequest={})).method="textDocument/willSaveWaitUntil",E.messageDirection=eu.MessageDirection.clientToServer,E.type=new eu.ProtocolRequestType(E.method),(R=n.DidChangeWatchedFilesNotification||(n.DidChangeWatchedFilesNotification={})).method="workspace/didChangeWatchedFiles",R.messageDirection=eu.MessageDirection.clientToServer,R.type=new eu.ProtocolNotificationType(R.method),(I=n.FileChangeType||(n.FileChangeType={})).Created=1,I.Changed=2,I.Deleted=3,(n.RelativePattern||(n.RelativePattern={})).is=function(e){return ed.objectLiteral(e)&&(ec.URI.is(e.baseUri)||ec.WorkspaceFolder.is(e.baseUri))&&ed.string(e.pattern)},(A=n.WatchKind||(n.WatchKind={})).Create=1,A.Change=2,A.Delete=4,(P=n.PublishDiagnosticsNotification||(n.PublishDiagnosticsNotification={})).method="textDocument/publishDiagnostics",P.messageDirection=eu.MessageDirection.serverToClient,P.type=new eu.ProtocolNotificationType(P.method),(D=n.CompletionTriggerKind||(n.CompletionTriggerKind={})).Invoked=1,D.TriggerCharacter=2,D.TriggerForIncompleteCompletions=3,(O=n.CompletionRequest||(n.CompletionRequest={})).method="textDocument/completion",O.messageDirection=eu.MessageDirection.clientToServer,O.type=new eu.ProtocolRequestType(O.method),(N=n.CompletionResolveRequest||(n.CompletionResolveRequest={})).method="completionItem/resolve",N.messageDirection=eu.MessageDirection.clientToServer,N.type=new eu.ProtocolRequestType(N.method),(M=n.HoverRequest||(n.HoverRequest={})).method="textDocument/hover",M.messageDirection=eu.MessageDirection.clientToServer,M.type=new eu.ProtocolRequestType(M.method),(L=n.SignatureHelpTriggerKind||(n.SignatureHelpTriggerKind={})).Invoked=1,L.TriggerCharacter=2,L.ContentChange=3,(B=n.SignatureHelpRequest||(n.SignatureHelpRequest={})).method="textDocument/signatureHelp",B.messageDirection=eu.MessageDirection.clientToServer,B.type=new eu.ProtocolRequestType(B.method),(V=n.DefinitionRequest||(n.DefinitionRequest={})).method="textDocument/definition",V.messageDirection=eu.MessageDirection.clientToServer,V.type=new eu.ProtocolRequestType(V.method),(F=n.ReferencesRequest||(n.ReferencesRequest={})).method="textDocument/references",F.messageDirection=eu.MessageDirection.clientToServer,F.type=new eu.ProtocolRequestType(F.method),(U=n.DocumentHighlightRequest||(n.DocumentHighlightRequest={})).method="textDocument/documentHighlight",U.messageDirection=eu.MessageDirection.clientToServer,U.type=new eu.ProtocolRequestType(U.method),(G=n.DocumentSymbolRequest||(n.DocumentSymbolRequest={})).method="textDocument/documentSymbol",G.messageDirection=eu.MessageDirection.clientToServer,G.type=new eu.ProtocolRequestType(G.method),($=n.CodeActionRequest||(n.CodeActionRequest={})).method="textDocument/codeAction",$.messageDirection=eu.MessageDirection.clientToServer,$.type=new eu.ProtocolRequestType($.method),(z=n.CodeActionResolveRequest||(n.CodeActionResolveRequest={})).method="codeAction/resolve",z.messageDirection=eu.MessageDirection.clientToServer,z.type=new eu.ProtocolRequestType(z.method),(H=n.WorkspaceSymbolRequest||(n.WorkspaceSymbolRequest={})).method="workspace/symbol",H.messageDirection=eu.MessageDirection.clientToServer,H.type=new eu.ProtocolRequestType(H.method),(W=n.WorkspaceSymbolResolveRequest||(n.WorkspaceSymbolResolveRequest={})).method="workspaceSymbol/resolve",W.messageDirection=eu.MessageDirection.clientToServer,W.type=new eu.ProtocolRequestType(W.method),(q=n.CodeLensRequest||(n.CodeLensRequest={})).method="textDocument/codeLens",q.messageDirection=eu.MessageDirection.clientToServer,q.type=new eu.ProtocolRequestType(q.method),(K=n.CodeLensResolveRequest||(n.CodeLensResolveRequest={})).method="codeLens/resolve",K.messageDirection=eu.MessageDirection.clientToServer,K.type=new eu.ProtocolRequestType(K.method),(Y=n.CodeLensRefreshRequest||(n.CodeLensRefreshRequest={})).method="workspace/codeLens/refresh",Y.messageDirection=eu.MessageDirection.serverToClient,Y.type=new eu.ProtocolRequestType0(Y.method),(Q=n.DocumentLinkRequest||(n.DocumentLinkRequest={})).method="textDocument/documentLink",Q.messageDirection=eu.MessageDirection.clientToServer,Q.type=new eu.ProtocolRequestType(Q.method),(X=n.DocumentLinkResolveRequest||(n.DocumentLinkResolveRequest={})).method="documentLink/resolve",X.messageDirection=eu.MessageDirection.clientToServer,X.type=new eu.ProtocolRequestType(X.method),(J=n.DocumentFormattingRequest||(n.DocumentFormattingRequest={})).method="textDocument/formatting",J.messageDirection=eu.MessageDirection.clientToServer,J.type=new eu.ProtocolRequestType(J.method),(Z=n.DocumentRangeFormattingRequest||(n.DocumentRangeFormattingRequest={})).method="textDocument/rangeFormatting",Z.messageDirection=eu.MessageDirection.clientToServer,Z.type=new eu.ProtocolRequestType(Z.method),(ee=n.DocumentOnTypeFormattingRequest||(n.DocumentOnTypeFormattingRequest={})).method="textDocument/onTypeFormatting",ee.messageDirection=eu.MessageDirection.clientToServer,ee.type=new eu.ProtocolRequestType(ee.method),(n.PrepareSupportDefaultBehavior||(n.PrepareSupportDefaultBehavior={})).Identifier=1,(et=n.RenameRequest||(n.RenameRequest={})).method="textDocument/rename",et.messageDirection=eu.MessageDirection.clientToServer,et.type=new eu.ProtocolRequestType(et.method),(en=n.PrepareRenameRequest||(n.PrepareRenameRequest={})).method="textDocument/prepareRename",en.messageDirection=eu.MessageDirection.clientToServer,en.type=new eu.ProtocolRequestType(en.method),(er=n.ExecuteCommandRequest||(n.ExecuteCommandRequest={})).method="workspace/executeCommand",er.messageDirection=eu.MessageDirection.clientToServer,er.type=new eu.ProtocolRequestType(er.method),(ei=n.ApplyWorkspaceEditRequest||(n.ApplyWorkspaceEditRequest={})).method="workspace/applyEdit",ei.messageDirection=eu.MessageDirection.serverToClient,ei.type=new eu.ProtocolRequestType("workspace/applyEdit")},67354,(e,t,n)=>{"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.createProtocolConnection=void 0;var r=e.r(134892);n.createProtocolConnection=function(e,t,n,i){return r.ConnectionStrategy.is(i)&&(i={connectionStrategy:i}),(0,r.createMessageConnection)(e,t,n,i)}},935416,(e,t,n)=>{"use strict";var r,i=e.e&&e.e.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=e.e&&e.e.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||i(t,e,n)};Object.defineProperty(n,"__esModule",{value:!0}),n.LSPErrorCodes=n.createProtocolConnection=void 0,o(e.r(134892),n),o(e.r(333859),n),o(e.r(447677),n),o(e.r(901241),n);var a=e.r(67354);Object.defineProperty(n,"createProtocolConnection",{enumerable:!0,get:function(){return a.createProtocolConnection}}),(r=n.LSPErrorCodes||(n.LSPErrorCodes={})).lspReservedErrorRangeStart=-32899,r.RequestFailed=-32803,r.ServerCancelled=-32802,r.ContentModified=-32801,r.RequestCancelled=-32800,r.lspReservedErrorRangeEnd=-32800},822658,(e,t,n)=>{"use strict";var r=e.e&&e.e.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=e.e&&e.e.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)};Object.defineProperty(n,"__esModule",{value:!0}),n.createProtocolConnection=void 0;var o=e.r(829130);i(e.r(829130),n),i(e.r(935416),n),n.createProtocolConnection=function(e,t,n,r){return(0,o.createMessageConnection)(e,t,n,r)}},848955,842962,738324,486161,403781,44813,935997,275072,518202,e=>{"use strict";var t,n,r,i,o,a,s,l,u=e.i(389959),c=e.i(753950),d=e.i(179302);e.i(508987);var f=e.i(457103),p=e.i(242131),h=e.i(525476),g=e.i(111084),m=e.i(624859),x=e.i(473041),y=e.i(232557),b=e.i(182116),w=e.i(904851),k=e.i(90659),_=e.i(721281),S=e.i(276385),C=e.i(992785),j=e.i(240849),T=e.i(310761),E=e.i(468345),R=e.i(928353),I=e.i(700170),A=e.i(709485),P=e.i(441329),D=e.i(858248),O=e.i(933101),N=e.i(256059);e.i(32109);var M=e.i(384401),L=e.i(446530),B=e.i(613355),V=e.i(625484),F=(0,L.cssRecord)({container:[{marginRight:16},B.rcss.height("100%")],hintButton:[B.rcss.height("100%")]}),U=new R.CodeMirrorComponent(function(e){var t=e.onGenerateCode,n=e.height,r=(0,P.useIsInMobileWorkspace)(),i=(0,M.useKeyCombo)(O.generateOrModifyWithAICommand.id),o=Math.round(.6*n);return(0,S.jsx)(V.View,{css:F.container,children:(0,S.jsx)(N.HintButton,{keyCombo:r?void 0:i,text:"Generate",fontSize:o,css:F.hintButton,onClick:function(){(0,D.track)(A.events.GHOSTWRITER_CHAT_INLINE_HINT_CLICKED,{action:"generate"}),t()}})})}),G=d.EditorView.theme({".cm-ghostwriter-hint-layer":{width:"100%"}}),$=function(e){var t=e.selection.main.head;return e.doc.lineAt(t)},z=new I.ReactCompartment(function(e){return c.StateField.define({create:function(e){return $(e)},compare:C.default,update:function(e,t){return $(t.state)},provide:function(t){return[G,c.Prec.high((0,d.layer)({above:!0,class:"cm-ghostwriter-hint-layer",update:function(e){return(0,f.hasChanged)(e,t,E.InlinePocketState,j.CompleteCodeSuggestion)},markers:function(n){var r=n.state.field(t,!1);if(!r||!n.state.selection.main.empty)return[];var i=n.state.field(E.InlinePocketState,!1),o=0===n.state.doc.length,a=(0,T.hasPresentedSuggestion)(n.state);if(r.length>0||i||a||o)return[];var s=n.dom.querySelector(".cm-minimap-gutter"),l=(null==s?void 0:s.clientWidth)||0,u=r.to,c=n.lineBlockAt(u),d=c.top,f=c.height;return[new H({top:d+n.documentPadding.top,height:f,right:l,pocketOpen:null!==i,activeEditor:n.hasFocus,onGenerateCode:e})]}}))]}})}),H=function(){function e(t){(0,w._)(this,e),(0,_._)(this,"options",void 0),this.options=t}return(0,k._)(e,[{key:"position",value:function(e){e.style.top=this.options.top+"px",e.style.height=this.options.height+"px",e.style.right=this.options.right+"px",e.style.paddingRight=Math.round(.2*this.options.height)+"px"}},{key:"draw",value:function(){var e=U.create({onGenerateCode:this.options.onGenerateCode,height:this.options.height});return e.className="cm-ghostwriter-hint-marker",this.options.activeEditor||(e.style.visibility="hidden"),this.position(e),e}},{key:"eq",value:function(e){return this.options.top===e.options.top&&this.options.pocketOpen===e.options.pocketOpen&&this.options.activeEditor===e.options.activeEditor}}]),e}(),W=e.i(399119),q=e.i(445789),K=e.i(291607),Y=e.i(743347),Q=e.i(480028),X=e.i(960178),J=e.i(211397);function Z(e){var t=e.textVariant;return(0,S.jsxs)(X.Text,{variant:t,children:["AI Chat is currently unavailable. For more information, visit"," ",(0,S.jsx)("a",{href:"https://status.replit.com",target:"_blank",children:"our status page."})]})}e.s(["StatusText",()=>Z,"default",0,function(e){var t=e.textVariant,n=e.showImage;return(0,S.jsxs)(V.View,{css:[B.rcss.center,B.rcss.textAlign.center,B.rcss.px(16),B.rcss.colWithGap(8),B.rcss.flex.growAndShrink(1)],children:[(0,S.jsx)(Z,{textVariant:t}),n?(0,S.jsx)(J.default,{src:"/public/images/ghostwriter/orb.png",css:[{userSelect:"none",mixBlendMode:"screen",filter:"brightness(110%) saturate(1.2)",maskImage:"linear-gradient(".concat(Q.tokens.backgroundRoot,", transparent)")}],width:200,height:200,objectFit:"contain","aria-hidden":"true",alt:"",draggable:!1}):null]})}],842962);var ee=e.i(136540),et=e.i(283110),en=(0,L.cssRecord)({root:[B.rcss.border({color:Q.tokens.outlineDimmest}),B.rcss.p(8),B.rcss.borderRadius(4)]}),er=new R.CodeMirrorComponent(function(e){var t=e.onClose,n=e.requestMeasure;return(0,S.jsx)(K.PocketBoundary,{requestMeasure:n,type:"ghostwriterKillswitch",children:(0,S.jsxs)(V.View,{css:en.root,row:!0,gap:8,children:[(0,S.jsx)(V.View,{grow:!0,shrink:!0,children:(0,S.jsx)(Z,{textVariant:"text"})}),(0,S.jsx)(ee.IconButton,{alt:"Close",onClick:t,type:"button",children:(0,S.jsx)(et.default,{})})]})})}),ei=function(e){function t(e){var n,r=e.codeReference;return(0,w._)(this,t),n=(0,W._)(this,t),(0,_._)(n,"codeReference",void 0),n.codeReference=r,n}return(0,q._)(t,e),(0,k._)(t,[{key:"toDOM",value:function(e){var t=this;return er.create({onClose:function(){return(0,Y.closePocket)(e,t.codeReference)},requestMeasure:function(){return e.requestMeasure()}})}}]),t}(d.WidgetType),eo=e.i(530658),ea=e.i(131141),es=e.i(541793),el=e.i(161322),eu=e.i(188507);e.i(877212);var ec=e.i(970187),ed=e.i(51553),ef=e.i(334712),ep=e.i(629536),eh=e.i(444573),eg=e.i(160727),em=e.i(598986),ev=e.i(98816),ex=e.i(649960),ey=e.i(417120),eb=e.i(939652),ew=e.i(140487),ek=e.i(121817),e_=(0,es.atom)(0),eS=(0,es.atom)(function(e){return e(e_)<=K.COMPACT_WIDTH?"compact":"normal"}),eC=new R.CodeMirrorComponent(function(e){var t=e.id,n=e.requestMeasure,r=e.codeReference,i=e.updateCodeBlock,o=e.acceptSuggestion,a=e.onClose,s=e.autoFocus,l=e.updateDiffSelection,c=e.source,d=function(){var e=k();(null==e?void 0:e.completed)===void 0&&(null==O?void 0:O.completed)&&(e=O),(null==e?void 0:e.code)?((0,D.track)(A.events.AI_INLINE_EVENT,{action:"suggestion_accepted",intent_type:"modify",message_content:e.code,source:c}),o(e.code)):L()},f=function(){var e,t;V.current=$,(0,D.track)(A.events.AI_INLINE_EVENT,{action:"message_sent",intent_type:"modify",message_content:$,source:c}),b({message:$,type:eu.InlineMessageType.TRANSFORM_CODE,codeReference:{code:r.code,range:r.range,filePath:r.filePath,fileContent:null!=(e=r.fileContent)?e:"",fileVersion:r.fileVersion,language:null!=(t=r.language)?t:"",referenceType:eu.CodeReferenceType.INLINE}})},p=(0,ec.useAssistantInlineMode)().assistantInlineMode,h=(0,ed.useConfig)().hasAccessToAdvancedModel,g=(0,ef.useInlineActionModels)(),m=(0,ed.useIsRiverProtocolError)(),x=(0,eb.useGetSessionFileContext)(),y=(0,eg.useInlineMessage)({onCode:i,getFileContext:x,assistantMode:p}),b=y.sendMessage,w=y.stopMessage,k=y.getCode,_=y.loading,C=y.completed,j=y.error,T=y.clearError,E=(0,eo._)((0,u.useState)(!1),2),R=E[0],I=E[1],P=(0,eo._)((0,u.useState)(null),2),O=P[0],N=P[1],M=(0,ev.default)(l);(0,u.useEffect)(function(){_?M.current(eh.DiffSelection.Suggestion):(C||R)&&M.current(j?eh.DiffSelection.Original:eh.DiffSelection.Compare)},[M,C,R,j,_]);var L=(0,u.useCallback)(function(){w(),a()},[w,a]),B=(0,u.useCallback)(function(){(0,D.track)(A.events.AI_INLINE_EVENT,{action:"inline_textbox_closed",intent_type:"modify",source:c}),L()},[L,c]),V=(0,u.useRef)(null),F=function(){(0,D.track)(A.events.AI_INLINE_EVENT,{action:"generation_stopped",intent_type:"modify",message_content:$,source:c}),w()},U=(0,u.useRef)(null),G=(0,K.useInputState)({id:t,inputRef:U,loading:_,onSubmit:function(){Y?d():f()},onClose:B}),$=G.value,z=G.setValue,H=G.onKeyDown,W=G.escPressed,q=(0,ed.useIsAiClientConnected)(),Y=q&&!j&&(C||R)&&V.current===$,Q=(0,eo._)((0,u.useState)(function(){return(0,es.createStore)()}),1)[0],X=(0,el.useSetAtom)(e_,{store:Q}),J=(0,el.useAtomValue)(eS,{store:Q}),Z=(0,ex.default)(function(e){return X(e.width)});(0,u.useEffect)(function(){var e="inline-ai/last-sent-value/".concat(t),n="inline-ai/last-completed/".concat(t),r="inline-ai/last-code-res/".concat(t),i=em.default.get(e,"string"),o=em.default.get(n,"boolean"),a=em.default.get(r,"object");return i&&(V.current=i),I(!!o&&o),a&&N({code:a.code,completed:a.completed,error:a.error}),function(){em.default.set(n,C||o);var t=k();if((null==t?void 0:t.completed)!==void 0&&em.default.set(r,t),V.current){var i=V.current;if(0===i.length)return void em.default.remove(e);em.default.set(e,i)}}},[C,k,t]);var et="basic"===p?ep.AI_INLINE_BASIC_LIMIT:ep.AI_INLINE_ADVANCED_LIMIT,en=r.code.length>et,er=(0,ey.useAgentRunState)(),ei=er===eu.AgentRunState.AGENT_STATE_RUNNING||er===eu.AgentRunState.AGENT_STATE_PAUSING;return m?(0,S.jsx)(K.ConnectionError,{inlineActionType:"Modify",closeAction:L}):ei?(0,S.jsx)(K.AgentActiveBanner,{inlineActionType:"Modify",closeAction:L}):(0,S.jsx)(S.Fragment,{children:(0,S.jsxs)(K.PocketContainer,{requestMeasure:n,type:"generateCode",error:j,clearError:T,innerRef:Z,children:[(0,S.jsx)(K.Input,{value:$,inputRef:U,onChange:function(e){return z(e.currentTarget.value)},placeholder:"Enter a prompt to modify selected lines",onKeyDown:H,autoFocus:s}),(0,S.jsxs)(K.Footer,{children:[(0,S.jsxs)(S.Fragment,{children:[(0,S.jsx)(K.ModeLabel,{type:"transformCode",readableModelName:h?g.advancedModel.name.readable:g.basicModel.name.readable}),C||R?(0,S.jsx)(ee.IconButton,{alt:"Rerun the same prompt",onClick:function(){return f()},size:12,colorway:"grey",disabled:!q,children:(0,S.jsx)(ek.default,{})}):null]}),Y?(0,S.jsxs)(S.Fragment,{children:[(0,S.jsx)(ew.Button,{variant:"outlined",size:"small",text:"Reject",onClick:function(){var e=k();(null==e?void 0:e.completed)===void 0&&(null==O?void 0:O.completed)&&(e=O),(0,D.track)(A.events.AI_INLINE_EVENT,{action:"suggestion_rejected",intent_type:"modify",message_content:(null==e?void 0:e.code)?e.code:"",source:c}),B()}}),(0,S.jsx)(ew.Button,{size:"small",text:"Accept",colorway:"blurple",onClick:d,dataCy:"ghostwriter-inline-accept-suggestion"})]}):(0,S.jsx)(K.Submit,{escPressed:W,connecting:!q,loading:_,disabled:!$||!$.trim()||en,promptPresentation:"normal"===J,onClick:function(){_?F():f()},codeLengthExceeded:en})]})]})})}),ej=function(e){function t(e){var n,r=e.id,i=e.codeReference,o=e.source;return(0,w._)(this,t),n=(0,W._)(this,t),(0,_._)(n,"id",void 0),(0,_._)(n,"codeReference",void 0),(0,_._)(n,"source",void 0),n.id=r,n.codeReference=i,n.source=o,n}return(0,q._)(t,e),(0,k._)(t,[{key:"toDOM",value:function(e){var t=this.id,n=this.codeReference,r=this.source,i=eC.create({id:t,requestMeasure:function(){return e.requestMeasure()},codeReference:n,onClose:function(){return(0,Y.closePocket)(e,n)},acceptSuggestion:function(t){return(0,Y.replaceHighlightedAreaWithCode)(e,t,n)},updateCodeBlock:function(t){(0,Y.updateCodeBlock)(e,t)},updateDiffSelection:function(t){e.dispatch({effects:m.ShowDiffSelection.of(t)})},autoFocus:!0,source:r});return i.style.position="sticky",i.style.top="0px",i.style.zIndex="10",i}},{key:"updateDOM",value:function(e,t){var n=this.codeReference;return eC.update(e,function(e){return(0,ea.produce)(e,function(e){e.requestMeasure=function(){return t.requestMeasure()},e.codeReference=n,e.onClose=function(){return(0,Y.closePocket)(t,n)},e.acceptSuggestion=function(e){return(0,Y.replaceHighlightedAreaWithCode)(t,e,n)},e.updateCodeBlock=function(e){return(0,Y.updateCodeBlock)(t,e)},e.updateDiffSelection=function(e){t.dispatch({effects:m.ShowDiffSelection.of(e)})},e.autoFocus=!1})}),!0}},{key:"eq",value:function(e){return(0,Y.codeReferenceIsEqual)(this.codeReference,e.codeReference)}}]),t}(d.WidgetType),eT=e.i(736097),eE=e.i(807290),eR=Q.tokens.blurpleDimmest,eI=Q.tokens.accentPrimaryDimmest,eA=d.EditorView.theme({".cm-pocket-highlight":{backgroundColor:Q.tokens.blurpleDimmest,opacity:.2},"@keyframes moveGradient":{"0%":{backgroundPositionX:"100%"},"100%":{backgroundPositionX:"0%"}},".cm-pocket-highlight-loading":{background:"linear-gradient(90deg, ".concat(Q.tokens.blurpleDimmest,", ").concat(eI,", ").concat(eR,", ").concat(eI,")"),backgroundSize:"300% 100%",backgroundPositionX:"0%",animation:"moveGradient 2s linear infinite"}}),eP=d.EditorView.decorations.compute([E.InlinePocketState,m.DiffSelectionState,eT.fileName],function(e){var t=e.field(E.InlinePocketState),n=e.facet(eT.fileName);if(!t||!n||t.codeReference.filePath!==n)return d.Decoration.none;var r=e.doc.lineAt(t.codeReference.range.indexFrom).from,i={generateCode:b.GenerateCodeWidget,transformCode:ej,explainCode:y.ExplainCodeWidget,ghostwriterKillswitch:ei,codeLengthExceeded:g.CodeLengthExceededWidget}[t.type],o=d.Decoration.widget({widget:new i({id:t.id,codeReference:t.codeReference,source:t.source}),block:!0,side:0}).range(r);return d.Decoration.set(o)}),eD=(0,d.layer)({above:!1,update:function(e){return(0,f.hasChanged)(e,E.InlinePocketState)},markers:function(e){var t=e.state.field(E.InlinePocketState),n=e.state.facet(eT.fileName);if(!t||!n||t.codeReference.filePath!==n)return[];var r=t.codeReference.range.indexFrom,i=t.codeReference.range.indexTo,o=e.state.doc.lineAt(i);o.from>=r&&o.to===i&&i<e.state.doc.length&&(i+=1);var a=c.EditorSelection.range(r,i),s=t.loading&&t.codeReference.range.indexFrom<t.codeReference.range.indexTo?"cm-pocket-highlight-loading":"cm-pocket-highlight";return d.RectangleMarker.forRange(e,s,a)}}),eO=h.TransformDiff.compute([E.InlinePocketState,E.InlinePocketCodeBlock,eT.fileName,m.DiffSelectionState],function(e){var t=e.field(E.InlinePocketState),n=e.field(E.InlinePocketCodeBlock),r=e.facet(eT.fileName),i=e.field(m.DiffSelectionState);return t&&n&&r&&t.codeReference.filePath===r&&"transformCode"===t.type&&i===eh.DiffSelection.Compare?c.ChangeSet.of({from:t.codeReference.range.indexFrom,to:t.codeReference.range.indexTo,insert:n},e.doc.length).apply(e.doc):null}),eN=p.GhostText.compute([E.InlinePocketState,E.InlinePocketCodeBlock,eT.fileName],function(e){var t=e.field(E.InlinePocketState),n=e.field(E.InlinePocketCodeBlock),r=e.facet(eT.fileName);return t&&n&&r&&t.codeReference.filePath===r&&"generateCode"===t.type?c.ChangeSet.of({from:t.codeReference.range.indexTo,to:t.codeReference.range.indexTo,insert:n},e.doc.length):null});function eM(e){var t=e.onGenerateCode,n=(0,eE.useIsTeamWithAiDisabled)().isTeamWithAiDisabled,r=z.use(t);return(0,u.useMemo)(function(){var e=[eA,E.InlinePocketState,E.InlinePocketCodeBlock,eP,eD,m.DiffSelectionState,eO,x.RenderSuggestionForInlinePocket,eN,r];return n||e.push(r),e},[r,n])}e.s(["useInlineGhostwriterExtension",()=>eM],848955);var eL=e.i(346715),eB=function(e){function t(e){var n;return(0,w._)(this,t),n=(0,W._)(this,t),(0,_._)(n,"type",void 0),n.type=e,n}return(0,q._)(t,e),(0,k._)(t,null,[{key:"from",value:function(e){switch(e){case"yours":return this.yours;case"base":return this.base;case"middle":return this.middle;case"theirs":return this.theirs}}},{key:"range",value:function(e,t,n){return this.from(e).range(t,n)}}]),t}(c.RangeValue);function eV(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:7,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:e.length,i=[],o=n;o<=r;){var a=e.lineAt(o),s=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:7;if(e.text.length<t)return null;var n=e.text[0],r=function(e){switch(e){case"<":return"yours";case"|":return"base";case"=":return"middle";case">":return"theirs";default:return null}}(n);if(!r)return null;var i=n.repeat(t);return e.text.slice(0,t)!==i||e.text.length>t&&" "!==e.text[t]?null:r}(a,t);s&&i.push(eB.range(s,a.from,a.to)),o=a.to+1}return i}(0,_._)(eB,"yours",new eB("yours")),(0,_._)(eB,"base",new eB("base")),(0,_._)(eB,"middle",new eB("middle")),(0,_._)(eB,"theirs",new eB("theirs"));var eF=["yours","base","middle","theirs"];function eU(e){Array.isArray(e)&&(e=c.RangeSet.of(e));var t=[],n=[];if(0===e.size)return{hunks:t,hanging:n};for(var r=e.iter();null!==r.value;){var i,o={},a={},s=[],l=!0,u=!1,d=void 0;try{for(var f,p=eF[Symbol.iterator]();!(l=(f=p.next()).done);l=!0){var h=f.value,g=r.value,m=r.from,x=r.to;if("base"!==h||g.type===h){if(g.type===h)o[h]={from:m,to:x},s.push({from:m,to:x,type:g.type});else if("yours"!==g.type)s.push({from:m,to:x,type:g.type});else break;if(r.next(),null===r.value)break}}}catch(e){u=!0,d=e}finally{try{l||null==p.return||p.return()}finally{if(u)throw d}}if(!o.yours||!o.middle||!o.theirs){n.push.apply(n,(0,eL._)(s));continue}null!=o.base||(o.base=null),null!=a.base||(a.base=null);var y=null!=(i=o.base)?i:o.middle,b=o.yours.to+1,w=y.from-1;if(a.yours=b<w?{from:b,to:w}:null,o.base){var k=o.base.to+1,_=o.middle.from-1;a.base=k<_?{from:k,to:_}:null}var S=o.middle.to+1,C=o.theirs.from-1;a.theirs=S<C?{from:S,to:C}:null;var j={from:o.yours.from,to:o.theirs.to,markers:o,content:a};t.push(j)}return{hunks:t,hanging:n}}var eG=c.Facet.define({combine:function(e){return e.length?e[0]:7}}),e$=c.StateField.define({create:function(e){var t=e.doc,n=e.facet(eG),r=c.RangeSet.of(eV(t,n)),i=eU(r);return{markers:r,hunks:i.hunks,hanging:i.hanging}},update:function(e,t){var n=t.newDoc,r=t.startState.facet(eG),i=t.state.facet(eG);if(r!==i){var o=c.RangeSet.of(eV(n,i)),a=eU(o);return{markers:o,hunks:a.hunks,hanging:a.hanging}}if(!t.docChanged)return e;var s=null,l=null,u=null,d=null;t.changes.iterChangedRanges(function(e,t,n,r){s=null===s?e:Math.min(s,e),l=null===l?t:Math.max(l,t),u=null===u?n:Math.min(u,n),d=null===d?r:Math.max(d,r)});var f=e.markers;if(null!==s&&null!==l){var p=t.startState.doc.lineAt(s).from,h=t.startState.doc.lineAt(l).to;f=f.update({filter:function(){return!1},filterFrom:p,filterTo:h})}f=f.map(t.changes),null!==u&&null!==d&&(f=f.update({add:eV(n,i,u,d)}));var g=eU(f);return{markers:f,hunks:g.hunks,hanging:g.hanging}}}),ez=d.EditorView.atomicRanges.from(e$,function(e){return function(){return e.markers}}),eH=c.EditorState.changeFilter.of(function(e){var t=e.startState.field(e$);if(!e.docChanged||0===t.markers.size)return!0;var n=e.startState.doc,r=[];return e.changes.iterChanges(function(e,i,o,a,s){var l=s.length,u=Math.max(n.lineAt(e).from-1,0),c=Math.min(n.lineAt(i).to+1,n.length);t.markers.between(u,c,function(t,u){if((!(e<=t)||!(i>=u))&&(0===l||(e!==u||"\n"!==s.sliceString(0,1))&&(i!==t||"\n"!==s.sliceString(l-1,l)))){if(o!==a||(i!==u+1||0!==n.lineAt(i).length)&&(e!==t-1||0!==n.lineAt(e).length))r.push(t-1,u+1)}})}),!(r.length>0)||r}),eW=c.EditorState.transactionFilter.of(function(e){var t=e.docChanged?e.state.field(e$):e.startState.field(e$);if(0===t.markers.size)return e;var n=e.newSelection,r=!1,i=!1;do{i=!1;for(var o=0;o<n.ranges.length&&"break"!==function(e){var o=n.ranges[e],a=o.from,s=o.to,l=a,u=s;if(t.markers.between(a,s,function(e,t){var n=(e+t)/2;a>e&&a<t&&(l=a<n?e:t),s>e&&s<t&&(u=s<n?e:t)}),l!==a||u!==s){var d,f=o.anchor<o.head?l:u,p=o.anchor<o.head?u:l,h=o.goalColumn,g=null!=(d=o.bidiLevel)?d:void 0,m=c.EditorSelection.range(f,p,h,g);return n=n.replaceRange(m,e),i=!0,r=!0,"break"}}(o);o++);}while(i)return r?[e,{selection:n,sequential:!0}]:e}),eq="cm-git-conflict-marker-yours",eK="cm-git-conflict-marker-base",eY="cm-git-conflict-marker-middle",eQ="cm-git-conflict-marker-theirs",eX="cm-git-conflict-marker-hanging",eJ="cm-git-conflict-content-yours",eZ="cm-git-conflict-content-base",e0="cm-git-conflict-content-theirs";function e1(e){var t=e.background,n=e.color,r=e.noBorder,i={color:n,backgroundColor:t,backgroundClip:"padding-box",paddingTop:Q.tokens.space4,paddingBottom:Q.tokens.space4,fontWeight:Q.tokens.fontWeightBold};return void 0!==r&&r||(i.borderLeft="4px solid rgba(0, 150, 255, 0.1)",i.paddingLeft="2px"),i}function e2(e){return{backgroundColor:e.background,backgroundClip:"padding-box",borderLeft:"4px solid rgba(0, 150, 255, 0.1)",paddingLeft:"2px"}}var e3=d.EditorView.theme((i={},(0,_._)(i,".".concat(eq),e1({background:"rgba(0, 150, 255, 0.1)",color:Q.tokens.blueStrongest,noBorder:!0})),(0,_._)(i,".".concat(eY),e1({background:"rgba(255, 0, 0, 0.1)",color:Q.tokens.redStrongest})),(0,_._)(i,".".concat(eK),e1({background:"rgba(255, 165, 0, 0.1)",color:Q.tokens.orangeStrongest})),(0,_._)(i,".".concat(eQ),e1({background:"rgba(0, 150, 255, 0.1)",color:Q.tokens.blueStrongest,noBorder:!0})),(0,_._)(i,".".concat(eX),e1({background:"rgba(100, 150, 255, 0.1)",color:Q.tokens.blueStrongest,noBorder:!0})),(0,_._)(i,".".concat(eJ),e2({background:"rgba(0, 255, 0, 0.1)"})),(0,_._)(i,".".concat(e0),e2({background:"rgba(255, 0, 0, 0.1)"})),(0,_._)(i,".".concat(eZ),e2({background:"rgba(255, 165, 0, 0.1)"})),i)),e4={yours:{marker:d.Decoration.line({class:eq}),content:d.Decoration.line({class:eJ})},base:{marker:d.Decoration.line({class:eK}),content:d.Decoration.line({class:eZ})},middle:{marker:d.Decoration.line({class:eY})},theirs:{marker:d.Decoration.line({class:eQ}),content:d.Decoration.line({class:e0})},hanging:{marker:d.Decoration.line({class:eX})}},e8=function(){function e(t){(0,w._)(this,e),(0,_._)(this,"builder",void 0),(0,_._)(this,"doc",void 0),this.builder=new c.RangeSetBuilder,this.doc=t}return(0,k._)(e,[{key:"add",value:function(e,t){var n=this.doc.lineAt(e.from);if(n.to>=e.to)return void this.builder.add(n.from,n.from,t);for(var r=n.from;r<=e.to;)this.builder.add(r,r,t),r=this.doc.lineAt(r).to+1}},{key:"finish",value:function(){return this.builder.finish()}}]),e}(),e5=d.EditorView.decorations.from(e$,function(e){return function(t){var n=new e8(t.state.doc),r=!0,i=!1,o=void 0;try{for(var a,s=e.hunks[Symbol.iterator]();!(r=(a=s.next()).done);r=!0){var l=a.value;t.viewport.from>l.to||t.viewport.to<l.from||(n.add(l.markers.yours,e4.yours.marker),l.content.yours&&n.add(l.content.yours,e4.yours.content),l.markers.base&&n.add(l.markers.base,e4.base.marker),l.content.base&&n.add(l.content.base,e4.base.content),n.add(l.markers.middle,e4.middle.marker),l.content.theirs&&n.add(l.content.theirs,e4.theirs.content),n.add(l.markers.theirs,e4.theirs.marker))}}catch(e){i=!0,o=e}finally{try{r||null==s.return||s.return()}finally{if(i)throw o}}return n.finish()}}),e6=d.EditorView.decorations.from(e$,function(e){return function(){var t=new c.RangeSetBuilder,n=!0,r=!1,i=void 0;try{for(var o,a=e.hanging[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var s=o.value;t.add(s.from,s.from,e4.hanging.marker)}}catch(e){r=!0,i=e}finally{try{n||null==a.return||a.return()}finally{if(r)throw i}}return t.finish()}}),e9=[e$,[ez,eH,eW],[c.Prec.lowest(e3),e5,e6]],e7=e.i(297083),te=e.i(817556),tt=e.i(88892),tn=e.i(903673),tr=function(){function e(t,n,r,i,o,a){(0,w._)(this,e),(0,_._)(this,"original",void 0),(0,_._)(this,"current",void 0),(0,_._)(this,"chunks",void 0),(0,_._)(this,"desc",void 0),(0,_._)(this,"pending",void 0),(0,_._)(this,"ranges",void 0),this.original=t,this.current=n,this.chunks=r,this.desc=i,this.pending=o,this.ranges=a}return(0,k._)(e,[{key:"hasChanges",value:function(){return this.ranges.length>0}},{key:"update",value:function(t,n){var r,i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=arguments.length>3?arguments[3]:void 0,a=this.original,s=this.chunks,l=this.desc,u=this.pending,d=this.ranges;if(Math.abs((this.pending?this.pending.length:this.current.length)-t.length)>=250||i){var f=(0,tt.composeDiff)(l,u,n).pending;s=(0,tt.buildChunks)(a,t,{chunks:s,changesB:f},o),l=(0,tt.chunksToChangeDesc)(s,a.length),u=null,d=(0,tt.changeDescToRanges)(l)}else u=(r=(0,tt.composeDiff)(l,u,n)).pending,l=r.desc,d=(0,tt.changeDescToRanges)(l);return u&&t.eq(a)&&(s=[],l=c.ChangeSet.empty(a.length),u=null,d=[]),new e(a,t,s,l,u,d)}},{key:"isAccurate",value:function(){return null===this.pending}},{key:"getLineChangeType",value:function(e){var t=this.current.line(e);return 0===this.original.length&&this.current.length>0?tt.LineChangeType.COVERED:(0,tt.getLineChangeType)(this.original,this.current,t,tt.Side.B,this.ranges)}},{key:"iterRanges",value:function(){return(0,te._)(this,function(e){switch(e.label){case 0:return[5,(0,tn._)(this.ranges)];case 1:return e.sent(),[2]}})}}],[{key:"create",value:function(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:tt.DEFAULT_DIFF_CONFIG,i=(0,tt.buildChunks)(t,n,void 0,r),o=(0,tt.chunksToChangeDesc)(i,t.length),a=(0,tt.changeDescToRanges)(o);return new e(t,n,i,o,null,a)}}]),e}(),ti=e.i(664152),to=c.Facet.define({combine:function(e){var t;return null!=(t=e.filter(Boolean)[0])?t:null}}),ta=c.StateField.define({create:function(){return null},update:function(e,t){var n=t.state.facet(to);if(!n||Math.max(n.lines,t.newDoc.lines)>5e3||Math.max(n.length,t.newDoc.length)>4e5)return null;var r=performance.now(),i=tt.DEFAULT_DIFF_CONFIG,o="unknown";e&&e.original.eq(n)?t.docChanged&&(e=e.update(t.newDoc,t.changes,!(t.isUserEvent("input.type")||t.isUserEvent("delete.forward")||t.isUserEvent("delete.backward")),i),o="update"):(e=tr.create(n,t.newDoc,i),o="create");var a=performance.now()-r;return a>1e3&&ti.logger.time("slow SloppyDiff.create recorded",a,{start:n.toString(),end:t.newDoc.toString(),scanLimit:i.scanLimit,type:o}),e}});e.s(["GutterDiffInternalFacet",()=>to,"GutterDiffState",()=>ta],738324);var ts=Q.tokens.space2,tl="cm-diff-gutter",tu="".concat(tl,"-element"),tc="".concat(tu,"-insertion"),td="".concat(tu,"-modified"),tf="".concat(tu,"-deleted"),tp="".concat(tu,"-file-added"),th="".concat(tu,"-empty"),tg=Q.tokens.greenDefault,tm=Q.tokens.greenStronger,tv=Q.tokens.blueDefault,tx=Q.tokens.blueStronger,ty=Q.tokens.redDefault,tb=Q.tokens.redStronger,tw=Q.tokens.greenDimmer,tk=Q.tokens.greenDefault,t_=d.EditorView.theme((o={},(0,_._)(o,".".concat(tl,":first-of-type, .").concat(tu),{width:ts}),(0,_._)(o,".".concat(tc),{backgroundColor:tg,"&.cm-activeLineGutter":{backgroundColor:tm}}),(0,_._)(o,".".concat(td),{backgroundColor:tv,"&.cm-activeLineGutter":{backgroundColor:tx}}),(0,_._)(o,".".concat(tf),{backgroundColor:ty,"&.cm-activeLineGutter":{backgroundColor:tb}}),(0,_._)(o,".".concat(tp),{backgroundColor:tw,"&.cm-activeLineGutter":{backgroundColor:tk}}),(0,_._)(o,".".concat(th),{opacity:0}),o)),tS=new(function(e){function t(){var e;return(0,w._)(this,t),e=(0,W._)(this,t,arguments),(0,_._)(e,"elementClass","".concat(tu," ").concat(tc)),e}return(0,q._)(t,e),t}(d.GutterMarker)),tC=new(function(e){function t(){var e;return(0,w._)(this,t),e=(0,W._)(this,t,arguments),(0,_._)(e,"elementClass","".concat(tu," ").concat(tf)),e}return(0,q._)(t,e),t}(d.GutterMarker)),tj=new(function(e){function t(){var e;return(0,w._)(this,t),e=(0,W._)(this,t,arguments),(0,_._)(e,"elementClass","".concat(tu," ").concat(td)),e}return(0,q._)(t,e),t}(d.GutterMarker)),tT=new(function(e){function t(){var e;return(0,w._)(this,t),e=(0,W._)(this,t,arguments),(0,_._)(e,"elementClass","".concat(tu," ").concat(tp)),e}return(0,q._)(t,e),t}(d.GutterMarker)),tE=new(function(e){function t(){var e;return(0,w._)(this,t),e=(0,W._)(this,t,arguments),(0,_._)(e,"elementClass","".concat(tu," ").concat(th)),e}return(0,q._)(t,e),t}(d.GutterMarker)),tR=(0,d.gutter)({class:tl,renderEmptyElements:!0,lineMarker:function(e,t){var n=e.state.field(ta,!1);if(!n||!n.hasChanges())return tE;if(0===n.original.length)return tT;var r=e.state.doc.lineAt(t.from);switch(n.getLineChangeType(r.number)){case tt.LineChangeType.COVERED:return tS;case tt.LineChangeType.MODIFIED:return tj;default:return tE}},initialSpacer:function(e){return e.state.field(ta,!1)?tT:tE},updateSpacer:function(e,t){var n=t.state.field(ta,!1)?tT:tE;return e===n?e:n}}),tI=c.Facet.define({enables:function(e){return[to.computeN([e],function(t){return t.facet(e)}),t_,ta,c.Prec.highest(tR)]}}),tA=e.i(167626),tP=e.i(486701),tD=e.i(873753),tO=e.i(463930),tN=e.i(680118),tM=c.Facet.define({combine:function(e){var t;return null!=(t=e.filter(Boolean)[0])?t:null}}),tL=c.StateField.define({create:function(){return{diff:null,tree:tD.Tree.empty}},update:function(e,t){var n,r,i=t.state.facet(tM),o=null==(n=t.state.facet(tP.language))?void 0:n.parser;if(!i)return null===e.diff&&e.tree===tD.Tree.empty?e:{diff:null,tree:tD.Tree.empty};var a=e.diff,s=e.tree;return(a&&a.a.eq(i)?t.docChanged&&(a=a.updateB(t.newDoc,t.changes)):(a=tO.Diff.create(i,t.newDoc),s=tD.Tree.empty),(null==(r=t.startState.facet(tP.language))?void 0:r.parser)!==o&&(s=tD.Tree.empty),o&&s.length!==a.a.length)?(s=(0,tN.getIncrementallyParsedTree)({parser:o,text:a.a,maxTime:16,base:s}),{diff:a,tree:s}):e.diff===a&&e.tree===s?e:{diff:a,tree:s}}}),tB="cm-inline-diff-line-deletion-base",tV="cm-inline-diff-line-deletion",tF="cm-inline-diff-text-deletion",tU="cm-inline-diff-line-insertion-base",tG="cm-inline-diff-line-insertion",t$="cm-inline-diff-text-insertion",tz="rgba(180, 0, 0, 0.075)",tH="rgba(180, 0, 0, 0.125)",tW="rgba(0, 180, 0, 0.075)",tq="rgba(0, 180, 0, 0.125)",tK="cm-inline-diff-marker",tY="cm-inline-diff-marker-left",tQ="cm-inline-diff-marker-right";function tX(e,t){var n="linear-gradient(to right, ".concat(e,", ").concat(e,")");return t&&(n+=", linear-gradient(to right, ".concat(t,", ").concat(t,")")),n}var tJ=d.EditorView.theme((a={},(0,_._)(a,".".concat(tB,", .").concat(tV),{cursor:"text","&.cm-line ::selection":{backgroundColor:"".concat(Q.tokens.accentPrimaryDimmest," !important")}}),(0,_._)(a,".".concat(tB),{background:tX(tz)}),(0,_._)(a,".".concat(tV),{background:tX(tz,tH)}),(0,_._)(a,".".concat(tU),{background:tX(tW)}),(0,_._)(a,".".concat(tG),{background:tX(tW,tq)}),(0,_._)(a,".".concat(t$),{display:"inline-block",background:tq,"&:first-of-type":{backgroundClip:"padding-box",borderLeft:"3px solid ".concat(tq),paddingLeft:"3px",marginLeft:"-6px"}}),(0,_._)(a,".".concat(tF),{display:"inline-block",background:tH,"&:first-of-type":{backgroundClip:"padding-box",borderLeft:"3px solid ".concat(tH),paddingLeft:"3px",marginLeft:"-6px"}}),(0,_._)(a,".".concat(tK),{display:"flex",width:"100%",justifyContent:"space-between"}),(0,_._)(a,".".concat(tY),{width:"calc(50% - 1ch)",textAlign:"right"}),(0,_._)(a,".".concat(tQ),{width:"50%",textAlign:"right"}),a)),tZ=e.i(731291),t0=function(e){function t(e,n,r){var i;return(0,w._)(this,t),i=(0,W._)(this,t),(0,_._)(i,"line",void 0),(0,_._)(i,"index",void 0),(0,_._)(i,"changed",void 0),i.line=e,i.index=n,i.changed=r,i}return(0,q._)(t,e),(0,k._)(t,[{key:"estimatedHeight",get:function(){return 21}},{key:"toDOM",value:function(){var e=this,t=document.createElement("div");if(t.className=this.changed?"cm-line ".concat(tB):"cm-line ".concat(tV),!this.changed||!this.changed.length){var n=!0,r=!1,i=void 0;try{for(var o,a=this.line[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var s=o.value,l=s.text,u=s.tags,c=document.createElement("span");c.textContent=l||"",c.className=null!=u?u:"",t.appendChild(c)}}catch(e){r=!0,i=e}finally{try{n||null==a.return||a.return()}finally{if(r)throw i}}return t}for(var d=0,f=0,p=null,h=null,g=function(t,n){if(!p)throw Error("range is null");var r=e.line[f],i=r.text,o=r.tags,a=i.slice(d-p.from,n-p.from),s=document.createElement("span");s.textContent=a||"",s.className=null!=o?o:"",t.appendChild(s),d+=a.length};f<this.line.length;){if(!p){var m=this.line[f].text;p={from:d,to:d+m.length}}if(!h){var x=!0,y=!1,b=void 0;try{for(var w,k=this.changed[Symbol.iterator]();!(x=(w=k.next()).done);x=!0){var _=w.value;if(!(_.from>=p.to)&&!(_.to<=d)){var S=document.createElement("span");S.className=tF,h={from:_.from,to:_.to,dom:S},d<h.from&&g(t,h.from),t.appendChild(S);break}}}catch(e){y=!0,b=e}finally{try{x||null==k.return||k.return()}finally{if(y)throw b}}}h?(d<h.to&&g(h.dom,h.to),d>=h.to&&(h=null)):g(t,p.to),d>=p.to&&(p=null,f++)}return t}},{key:"eq",value:function(e){var n,r;return(0,tA._)(e,t)&&this.index===e.index&&this.line.length===e.line.length&&(null==(n=this.changed)?void 0:n.length)===(null==(r=e.changed)?void 0:r.length)&&(0,C.default)(this.line,e.line)&&(0,C.default)(this.changed,e.changed)}},{key:"ignoreEvent",value:function(e){return e.stopImmediatePropagation(),!0}}]),t}(d.WidgetType),t1=d.Decoration.line({class:tU}),t2=d.Decoration.line({class:tG}),t3=d.Decoration.mark({class:t$}),t4=d.EditorView.decorations.compute([tL],function(e){var t=function(e,t){if(r.getLineChangeType(e.number,tt.Side.B)===tt.LineChangeType.COVERED)o.push(t2.range(e.from));else{o.push(t1.range(e.from));var n=!0,i=!1,a=void 0;try{for(var s,l=(0,tt.changedRangesForLine)(e,t,tt.Side.B,!1)[Symbol.iterator]();!(n=(s=l.next()).done);n=!0){var u=s.value;o.push(t3.range(u.from,u.to))}}catch(e){i=!0,a=e}finally{try{n||null==l.return||l.return()}finally{if(i)throw a}}}},n=e.field(tL,!1);if(!n||!n.diff)return d.Decoration.none;var r=n.diff,i=n.tree,o=[],a=!0,s=!1,l=void 0;try{for(var u,c=r.chunks[Symbol.iterator]();!(a=(u=c.next()).done);a=!0){var f=u.value;if(f.fromB!==f.endB)for(var p=r.b.lineAt(f.fromB),h=r.b.lineAt(f.endB),g=p.number;g<=h.number;g++)t(r.b.line(g),f);else f.fromA===f.endA&&t(r.b.lineAt(f.fromB),f);if(f.fromA!==f.toA)for(var m=r.a.lineAt(f.fromA),x=(0,tZ.treeToHighlightedLines)(i,r.a,e,f.fromA,f.endA),y=0;y<x.length;y++){var b=x[y],w=r.a.line(m.number+y),k=r.getLineChangeType(w.number,tt.Side.A)===tt.LineChangeType.COVERED?null:(0,tt.changedRangesForLine)(w,f,tt.Side.A,!0),_=d.Decoration.widget({widget:new t0(b,w.number,k),block:!0,side:-(x.length-y)});o.push(_.range(f.fromB))}}}catch(e){s=!0,l=e}finally{try{a||null==c.return||c.return()}finally{if(s)throw l}}return d.Decoration.set(o,!0)}),t8=(0,d.gutter)({class:tl,renderEmptyElements:!0,lineMarker:function(e,t){var n=e.state.field(tL,!1);if(!n||!n.diff||!n.diff.hasChanges())return null;if(0===n.diff.a.length)return tS;var r=e.state.doc.lineAt(t.from);switch(n.diff.getLineChangeType(r.number,tt.Side.B)){case tt.LineChangeType.COVERED:case tt.LineChangeType.MODIFIED:return tS;default:return null}},widgetMarker:function(e,t){if(!(0,tA._)(t,t0))return null;var n=e.state.field(tL,!1);if(!n||!n.diff||!n.diff.hasChanges())return null;switch(n.diff.getLineChangeType(t.index,tt.Side.A)){case tt.LineChangeType.COVERED:case tt.LineChangeType.MODIFIED:return tC;default:return null}},initialSpacer:function(e){var t=e.state.field(tL,!1);return(null==t?void 0:t.diff)?tS:tE},updateSpacer:function(e,t){var n=t.state.field(tL,!1),r=(null==n?void 0:n.diff)?tS:tE;return e===r?e:r}}),t5=e.i(495970),t6=function(e){function t(e,n){var r;return(0,w._)(this,t),r=(0,W._)(this,t),(0,_._)(r,"left",void 0),(0,_._)(r,"right",void 0),r.left=e,r.right=n,r}return(0,q._)(t,e),(0,k._)(t,[{key:"toDOM",value:function(e){var t=e.state.doc.lines.toString().length,n=document.createElement("div"),r=document.createElement("span"),i=document.createElement("span");return n.className=tK,r.className=tY,i.className=tQ,n.style.width="".concat(2*t+1,"ch"),null!==this.left&&(r.textContent=this.left.toString()),null!==this.right&&(i.textContent=this.right.toString()),n.appendChild(r),n.appendChild(i),n}},{key:"eq",value:function(e){return(0,tA._)(e,t)&&this.left===e.left&&this.right===e.right}}]),t}(d.GutterMarker),t9=t5.LineNumberWidgetHandlers.of(function(e,t){if((0,tA._)(t,t0))return new t6(t.index,null)}),t7=[t5.LineNumberLineHandlers.of(function(e,t){var n,r=e.state.field(tL,!1);if(r&&r.diff&&r.diff.hasChanges()){var i=e.state.doc.lineAt(t.from),o=r.diff.getCorrespondingLine(i.number,tt.Side.B);return new t6(null!=(n=null==o?void 0:o.number)?n:null,i.number)}}),t9],ne=c.Facet.define({enables:function(e){return[tM.computeN([e],function(t){return t.facet(e)}),t_,tL,tJ,t4,t7,t8]}});e.s(["InlineDiff",()=>ne],486161);var nt=e.i(205104),nn=((t={}).GUTTER_DIFF="GUTTER_DIFF",t.INLINE_DIFF="INLINE_DIFF",t),nr=c.StateEffect.define(),ni=c.StateEffect.define(),no=c.StateField.define({create:function(){return{head:null,mode:"GUTTER_DIFF"}},update:function(e,t){var n=e.head,r=e.mode,i=!0,o=!1,a=void 0;try{for(var s,l=t.effects[Symbol.iterator]();!(i=(s=l.next()).done);i=!0){var u=s.value;u.is(nr)?n=u.value:u.is(ni)&&(r=u.value)}}catch(e){o=!0,a=e}finally{try{i||null==l.return||l.return()}finally{if(o)throw a}}return n!==e.head||r!==e.mode?{head:n,mode:r}:e},provide:function(e){return[tI.from(e,function(e){return"GUTTER_DIFF"===e.mode?e.head:null}),ne.from(e,function(e){return"INLINE_DIFF"===e.mode?e.head:null})]}}),na=function(){function e(t,n,r){var i=this;(0,w._)(this,e),(0,_._)(this,"view",void 0),(0,_._)(this,"git",void 0),(0,_._)(this,"path",void 0),(0,_._)(this,"disposed",void 0),(0,_._)(this,"dispose",void 0),this.view=t,this.git=n,this.path=r,this.disposed=!1,this.dispose=n.onRefresh(function(){return i.fetchThenUpdateState()}),this.fetchThenUpdateState()}return(0,k._)(e,[{key:"fetchThenUpdateState",value:function(){return(0,e7._)(function(){var e,t,n,r,i;return(0,te._)(this,function(o){switch(o.label){case 0:return[4,this.git.getFileContents({path:this.path,revision:"HEAD",convertToBase64:(0,nt.isMedia)(this.path)})];case 1:if(e=o.sent(),this.disposed||!(t=this.view.state.field(no,!1)))return[2];return(!(i=null===(r=e.error?null:null!=(n=e.content)?n:"")?null:this.view.state.toText(r))!=!t.head||i&&t.head&&!i.eq(t.head))&&this.view.dispatch({effects:nr.of(i)}),[2]}})}).call(this)}},{key:"destroy",value:function(){this.dispose(),this.disposed=!0}}]),e}();function ns(e,t){return t?[no,d.ViewPlugin.define(function(n){return new na(n,e,t)})]:[]}e.s(["GitDiffMode",()=>nn,"GitDiffState",()=>no,"gitDiff",()=>ns,"setGitDiffMode",()=>ni],403781);var nl=e.i(993796),nu=e.i(529810),nc=new I.ReactCompartment(function(e,t,n){var r=[ns(e,t)];return n||r.push(e9),r});function nd(e){var t=e.filePath,n=e.enableConflicts,r=(0,nl.useFlag)({controlName:"flag-editor-git-conflict-markers",logFlagToAnalytics:!1}),i=(0,nu.default)().git;return nc.use(i,void 0===t?null:t,!(void 0!==n&&n)||!r)}e.s(["default",()=>nd],44813);var nf=e.i(497644),np=e.i(197565),nh=e.i(878420),ng=e.i(64386),nm=e.i(822658),nv=e.i(72158),nx=e.i(887800),ny=e.i(333859),nb=c.Facet.define({combine:function(e){return e.some(Boolean)}});e.s(["AcceptSuggestionOnCommitCharacter",()=>nb],935997);var nw=e.i(886513),nk=e.i(623474),n_=e.i(663355),nS=e.i(862470);(n={})[n.Dollar=0]="Dollar",n[n.Colon=1]="Colon",n[n.Comma=2]="Comma",n[n.CurlyOpen=3]="CurlyOpen",n[n.CurlyClose=4]="CurlyClose",n[n.Backslash=5]="Backslash",n[n.Forwardslash=6]="Forwardslash",n[n.Pipe=7]="Pipe",n[n.Int=8]="Int",n[n.VariableName=9]="VariableName",n[n.Format=10]="Format",n[n.Plus=11]="Plus",n[n.Dash=12]="Dash",n[n.QuestionMark=13]="QuestionMark",n[n.EOF=14]="EOF";var nC=function(){function e(){(0,w._)(this,e),(0,_._)(this,"value",""),(0,_._)(this,"pos",0)}return(0,k._)(e,[{key:"text",value:function(e){this.value=e,this.pos=0}},{key:"tokenText",value:function(e){return this.value.substr(e.pos,e.len)}},{key:"next",value:function(){if(this.pos>=this.value.length)return{type:14,pos:this.pos,len:0};var t,n=this.pos,r=0,i=this.value.charCodeAt(n);if("number"==typeof(t=e._table[i]))return this.pos+=1,{type:t,pos:n,len:1};if(e.isDigitCharacter(i)){t=8;do r+=1,i=this.value.charCodeAt(n+r);while(e.isDigitCharacter(i))return this.pos+=r,{type:t,pos:n,len:r}}if(e.isVariableCharacter(i)){t=9;do i=this.value.charCodeAt(n+ ++r);while(e.isVariableCharacter(i)||e.isDigitCharacter(i))return this.pos+=r,{type:t,pos:n,len:r}}t=10;do r+=1,i=this.value.charCodeAt(n+r);while(!isNaN(i)&&void 0===e._table[i]&&!e.isDigitCharacter(i)&&!e.isVariableCharacter(i))return this.pos+=r,{type:t,pos:n,len:r}}}],[{key:"isDigitCharacter",value:function(e){return e>=48&&e<=57}},{key:"isVariableCharacter",value:function(e){return 95===e||e>=97&&e<=122||e>=65&&e<=90}}]),e}();(0,_._)(nC,"_table",(s={},(0,_._)(s,36,0),(0,_._)(s,58,1),(0,_._)(s,44,2),(0,_._)(s,123,3),(0,_._)(s,125,4),(0,_._)(s,92,5),(0,_._)(s,47,6),(0,_._)(s,124,7),(0,_._)(s,43,11),(0,_._)(s,45,12),(0,_._)(s,63,13),s));var nj=function(){function e(){var t;(0,w._)(this,e),(0,_._)(this,"parent",void 0),(0,_._)(this,"_children",[]),t=this,["parent"].forEach(function(e){Object.defineProperty(t,e,{enumerable:!1,writable:!0})})}return(0,k._)(e,[{key:"appendChild",value:function(e){return(0,tA._)(e,nT)&&(0,tA._)(this._children[this._children.length-1],nT)?this._children[this._children.length-1].value+=e.value:(e.parent=this,this._children.push(e)),this}},{key:"replace",value:function(e,t){var n=e.parent,r=n.children.indexOf(e),i=n.children.slice(0);i.splice.apply(i,[r,1].concat((0,eL._)(t))),n._children=i,function e(t,n){var r=!0,i=!1,o=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done);r=!0){var l=a.value;l.parent=n,e(l.children,l)}}catch(e){i=!0,o=e}finally{try{r||null==s.return||s.return()}finally{if(i)throw o}}}(t,n)}},{key:"children",get:function(){return this._children}},{key:"rightMostDescendant",get:function(){return this._children.length>0?this._children[this._children.length-1].rightMostDescendant:this}},{key:"snippet",get:function(){for(var e=this;;){if(!e)return;if((0,tA._)(e,nN))return e;e=e.parent}}},{key:"toString",value:function(){return this.children.reduce(function(e,t){return e+t.toString()},"")}},{key:"len",value:function(){return 0}},{key:"match",value:function(e){var t=!0,n=!1,r=void 0;try{for(var i,o=Object.entries(nL)[Symbol.iterator]();!(t=(i=o.next()).done);t=!0){var a=(0,eo._)(i.value,2),s=a[0],l=a[1];if((0,tA._)(this,l)&&s in e)return e[s](this)}}catch(e){n=!0,r=e}finally{try{t||null==o.return||o.return()}finally{if(n)throw r}}}}]),e}(),nT=function(e){function t(e){var n;return(0,w._)(this,t),n=(0,W._)(this,t),(0,_._)(n,"value",void 0),n.value=e,n}return(0,q._)(t,e),(0,k._)(t,[{key:"toString",value:function(){return this.value}},{key:"toTextmateString",value:function(){return t.escape(this.value)}},{key:"len",value:function(){return this.value.length}},{key:"clone",value:function(){return new t(this.value)}}],[{key:"escape",value:function(e){return e.replace(/\$|}|\\/g,"\\$&")}}]),t}(nj),nE=function(e){function t(){return(0,w._)(this,t),(0,W._)(this,t,arguments)}return(0,q._)(t,e),t}(nj),nR=function(e){function t(e){var n;return(0,w._)(this,t),n=(0,W._)(this,t),(0,_._)(n,"index",void 0),n.index=e,n}return(0,q._)(t,e),(0,k._)(t,[{key:"isFinalTabstop",get:function(){return 0===this.index}},{key:"choice",get:function(){return 1===this._children.length&&(0,tA._)(this._children[0],nI)?this._children[0]:void 0}},{key:"toTextmateString",value:function(){var e="";return(this.transform&&(e=this.transform.toTextmateString()),0!==this.children.length||this.transform)?0===this.children.length?"${".concat(this.index).concat(e,"}"):this.choice?"${".concat(this.index,"|").concat(this.choice.toTextmateString(),"|").concat(e,"}"):"${".concat(this.index,":").concat(this.children.map(function(e){return e.toTextmateString()}).join("")).concat(e,"}"):"$".concat(this.index)}},{key:"clone",value:function(){var e=new t(this.index);return this.transform&&(e.transform=this.transform.clone()),e._children=this.children.map(function(e){return e.clone()}),e}}],[{key:"compareByIndex",value:function(e,t){if(e.index===t.index)return 0;if(e.isFinalTabstop)return 1;if(t.isFinalTabstop)return -1;if(e.index<t.index)return -1;if(e.index>t.index)return 1;else return 0}}]),t}(nE),nI=function(e){function t(){var e;return(0,w._)(this,t),e=(0,W._)(this,t,arguments),(0,_._)(e,"options",[]),e}return(0,q._)(t,e),(0,k._)(t,[{key:"appendChild",value:function(e){return(0,tA._)(e,nT)&&(e.parent=this,this.options.push(e)),this}},{key:"toString",value:function(){return this.options[0].value}},{key:"toTextmateString",value:function(){return this.options.map(function(e){return e.value.replace(/\||,|\\/g,"\\$&")}).join(",")}},{key:"len",value:function(){return this.options[0].len()}},{key:"clone",value:function(){var e=new t;return this.options.forEach(e.appendChild,e),e}}]),t}(nj),nA=function(e){function t(){var e;return(0,w._)(this,t),e=(0,W._)(this,t,arguments),(0,_._)(e,"regexp",RegExp("")),e}return(0,q._)(t,e),(0,k._)(t,[{key:"resolve",value:function(e){var t=this,n=!1,r=e.replace(this.regexp,function(){for(var e=arguments.length,r=Array(e),i=0;i<e;i++)r[i]=arguments[i];return n=!0,t._replace(r.slice(0,-2))});return!n&&this._children.some(function(e){return(0,tA._)(e,nP)&&!!e.elseValue})&&(r=this._replace([])),r}},{key:"_replace",value:function(e){var t="",n=!0,r=!1,i=void 0;try{for(var o,a=this._children[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var s=o.value;if((0,tA._)(s,nP)){var l=e[s.index]||"";l=s.resolve(l),t+=l}else t+=s.toString()}}catch(e){r=!0,i=e}finally{try{n||null==a.return||a.return()}finally{if(r)throw i}}return t}},{key:"toString",value:function(){return""}},{key:"toTextmateString",value:function(){return"/".concat(this.regexp.source,"/").concat(this.children.map(function(e){return e.toTextmateString()}),"/").concat((this.regexp.ignoreCase?"i":"")+(this.regexp.global?"g":""))}},{key:"clone",value:function(){var e=new t;return e.regexp=new RegExp(this.regexp.source,(this.regexp.ignoreCase?"i":"")+(this.regexp.global?"g":"")),e._children=this.children.map(function(e){return e.clone()}),e}}]),t}(nj),nP=function(e){function t(e,n,r,i){var o;return(0,w._)(this,t),o=(0,W._)(this,t),(0,_._)(o,"index",void 0),(0,_._)(o,"shorthandName",void 0),(0,_._)(o,"ifValue",void 0),(0,_._)(o,"elseValue",void 0),o.index=e,o.shorthandName=n,o.ifValue=r,o.elseValue=i,o}return(0,q._)(t,e),(0,k._)(t,[{key:"resolve",value:function(e){if("upcase"===this.shorthandName)return e?e.toLocaleUpperCase():"";if("downcase"===this.shorthandName)return e?e.toLocaleLowerCase():"";if("capitalize"===this.shorthandName)return e?e[0].toLocaleUpperCase()+e.substr(1):"";if("pascalcase"===this.shorthandName)return e?this._toPascalCase(e):"";if("camelcase"===this.shorthandName)return e?this._toCamelCase(e):"";else if(e&&"string"==typeof this.ifValue)return this.ifValue;else if(!e&&"string"==typeof this.elseValue)return this.elseValue;else return e||""}},{key:"_toPascalCase",value:function(e){var t=e.match(/[a-z0-9]+/gi);return t?t.map(function(e){return e.charAt(0).toUpperCase()+e.substr(1)}).join(""):e}},{key:"_toCamelCase",value:function(e){var t=e.match(/[a-z0-9]+/gi);return t?t.map(function(e,t){return 0===t?e.charAt(0).toLowerCase()+e.substr(1):e.charAt(0).toUpperCase()+e.substr(1)}).join(""):e}},{key:"toTextmateString",value:function(){var e="${";return e+=this.index,this.shorthandName?e+=":/".concat(this.shorthandName):this.ifValue&&this.elseValue?e+=":?".concat(this.ifValue,":").concat(this.elseValue):this.ifValue?e+=":+".concat(this.ifValue):this.elseValue&&(e+=":-".concat(this.elseValue)),e+="}"}},{key:"clone",value:function(){return new t(this.index,this.shorthandName,this.ifValue,this.elseValue)}}]),t}(nj),nD=function(e){function t(e){var n;return(0,w._)(this,t),n=(0,W._)(this,t),(0,_._)(n,"name",void 0),n.name=e,n}return(0,q._)(t,e),(0,k._)(t,[{key:"resolve",value:function(e){var t=e.resolve(this);return this.transform&&(t=this.transform.resolve(t||"")),void 0!==t&&(this._children=[new nT(t)],!0)}},{key:"toTextmateString",value:function(){var e="";return(this.transform&&(e=this.transform.toTextmateString()),0===this.children.length)?"${".concat(this.name).concat(e,"}"):"${".concat(this.name,":").concat(this.children.map(function(e){return e.toTextmateString()}).join("")).concat(e,"}")}},{key:"clone",value:function(){var e=new t(this.name);return this.transform&&(e.transform=this.transform.clone()),e._children=this.children.map(function(e){return e.clone()}),e}}]),t}(nE);function nO(e,t){for(var n=(0,eL._)(e);n.length>0;){var r=n.shift();if(!t(r))break;n.unshift.apply(n,(0,eL._)(r.children))}}var nN=function(e){function t(){return(0,w._)(this,t),(0,W._)(this,t,arguments)}return(0,q._)(t,e),(0,k._)(t,[{key:"placeholderInfo",get:function(){if(!this._placeholders){var e,t=[];this.walk(function(n){return(0,tA._)(n,nR)&&(t.push(n),e=!e||e.index<n.index?n:e),!0}),this._placeholders={all:t,last:e}}return this._placeholders}},{key:"placeholders",get:function(){return this.placeholderInfo.all}},{key:"offset",value:function(e){var t=0,n=!1;return(this.walk(function(r){return r===e?(n=!0,!1):(t+=r.len(),!0)}),n)?t:-1}},{key:"fullLen",value:function(e){var t=0;return nO([e],function(e){return t+=e.len(),!0}),t}},{key:"enclosingPlaceholders",value:function(e){for(var t=[],n=e.parent;n;)(0,tA._)(n,nR)&&t.push(n),n=n.parent;return t}},{key:"resolveVariables",value:function(e){var t=this;return this.walk(function(n){return(0,tA._)(n,nD)&&n.resolve(e)&&delete t._placeholders,!0}),this}},{key:"appendChild",value:function(e){return delete this._placeholders,(0,n_._)((0,nS._)(t.prototype),"appendChild",this).call(this,e)}},{key:"replace",value:function(e,n){return delete this._placeholders,(0,n_._)((0,nS._)(t.prototype),"replace",this).call(this,e,n)}},{key:"toTextmateString",value:function(){return this.children.reduce(function(e,t){return e+t.toTextmateString()},"")}},{key:"clone",value:function(){var e=new t;return this._children=this.children.map(function(e){return e.clone()}),e}},{key:"walk",value:function(e){nO(this.children,e)}}]),t}(nj),nM=function(){function e(){(0,w._)(this,e),(0,_._)(this,"_scanner",new nC),(0,_._)(this,"_token",{type:14,pos:0,len:0})}return(0,k._)(e,[{key:"text",value:function(e){return this.parse(e).toString()}},{key:"parse",value:function(e,t,n){var r=new nN;return this.parseFragment(e,r),this.ensureFinalTabstop(r,null!=n&&n,null!=t&&t),r}},{key:"parseFragment",value:function(e,t){var n=t.children.length;for(this._scanner.text(e),this._token=this._scanner.next();this._parse(t););var r=new Map,i=[];t.walk(function(e){return(0,tA._)(e,nR)&&(e.isFinalTabstop?r.set(0,void 0):!r.has(e.index)&&e.children.length>0?r.set(e.index,e.children):i.push(e)),!0});var o=function(e,n){var i=r.get(e.index);if(i){var a=new nR(e.index);a.transform=e.transform;var s=!0,l=!1,u=void 0;try{for(var c,d=i[Symbol.iterator]();!(s=(c=d.next()).done);s=!0){var f=c.value.clone();a.appendChild(f),(0,tA._)(f,nR)&&r.has(f.index)&&!n.has(f.index)&&(n.add(f.index),o(f,n),n.delete(f.index))}}catch(e){l=!0,u=e}finally{try{s||null==d.return||d.return()}finally{if(l)throw u}}t.replace(e,[a])}},a=new Set,s=!0,l=!1,u=void 0;try{for(var c,d=i[Symbol.iterator]();!(s=(c=d.next()).done);s=!0){var f=c.value;o(f,a)}}catch(e){l=!0,u=e}finally{try{s||null==d.return||d.return()}finally{if(l)throw u}}return t.children.slice(n)}},{key:"ensureFinalTabstop",value:function(e,t,n){(t||n&&e.placeholders.length>0)&&(e.placeholders.find(function(e){return 0===e.index})||e.appendChild(new nR(0)))}},{key:"_accept",value:function(e,t){if(void 0===e||this._token.type===e){var n=!t||this._scanner.tokenText(this._token);return this._token=this._scanner.next(),n}return!1}},{key:"_backTo",value:function(e){return this._scanner.pos=e.pos+e.len,this._token=e,!1}},{key:"_until",value:function(e){for(var t=this._token;this._token.type!==e;){if(14===this._token.type)return!1;if(5===this._token.type){var n=this._scanner.next();if(0!==n.type&&4!==n.type&&5!==n.type)return!1}this._token=this._scanner.next()}var r=this._scanner.value.substring(t.pos,this._token.pos).replace(/\\(\$|}|\\)/g,"$1");return this._token=this._scanner.next(),r}},{key:"_parse",value:function(e){return this._parseEscaped(e)||this._parseTabstopOrVariableName(e)||this._parseComplexPlaceholder(e)||this._parseComplexVariable(e)||this._parseAnything(e)}},{key:"_parseEscaped",value:function(e){var t;return!!(t=this._accept(5,!0))&&(t=this._accept(0,!0)||this._accept(4,!0)||this._accept(5,!0)||t,e.appendChild(new nT(t)),!0)}},{key:"_parseTabstopOrVariableName",value:function(e){var t,n=this._token;return this._accept(0)&&(t=this._accept(9,!0)||this._accept(8,!0))?(e.appendChild(/^\d+$/.test(t)?new nR(Number(t)):new nD(t)),!0):this._backTo(n)}},{key:"_parseComplexPlaceholder",value:function(e){var t,n=this._token;if(!(this._accept(0)&&this._accept(3)&&(t=this._accept(8,!0))))return this._backTo(n);var r=new nR(Number(t));if(this._accept(1))for(;;){if(this._accept(4))return e.appendChild(r),!0;if(!this._parse(r))return e.appendChild(new nT("${"+t+":")),r.children.forEach(e.appendChild,e),!0}else if(r.index>0&&this._accept(7))for(var i=new nI;;){if(this._parseChoiceElement(i)){if(this._accept(2))continue;if(this._accept(7)&&(r.appendChild(i),this._accept(4)))return e.appendChild(r),!0}return this._backTo(n),!1}else if(this._accept(6))return this._parseTransform(r)?(e.appendChild(r),!0):(this._backTo(n),!1);else if(this._accept(4))return e.appendChild(r),!0;else return this._backTo(n)}},{key:"_parseChoiceElement",value:function(e){for(var t=this._token,n=[];2!==this._token.type&&7!==this._token.type;){var r=void 0;if(!(r=(r=this._accept(5,!0))?this._accept(2,!0)||this._accept(7,!0)||this._accept(5,!0)||r:this._accept(void 0,!0)))return this._backTo(t),!1;n.push(r)}return 0===n.length?(this._backTo(t),!1):(e.appendChild(new nT(n.join(""))),!0)}},{key:"_parseComplexVariable",value:function(e){var t,n=this._token;if(!(this._accept(0)&&this._accept(3)&&(t=this._accept(9,!0))))return this._backTo(n);var r=new nD(t);if(this._accept(1))for(;;){if(this._accept(4))return e.appendChild(r),!0;if(!this._parse(r))return e.appendChild(new nT("${"+t+":")),r.children.forEach(e.appendChild,e),!0}else if(this._accept(6))return this._parseTransform(r)?(e.appendChild(r),!0):(this._backTo(n),!1);else if(this._accept(4))return e.appendChild(r),!0;else return this._backTo(n)}},{key:"_parseTransform",value:function(e){for(var t=new nA,n="",r="";!this._accept(6);){var i=void 0;if(i=this._accept(5,!0)){n+=i=this._accept(6,!0)||i;continue}if(14!==this._token.type){n+=this._accept(void 0,!0);continue}return!1}for(;!this._accept(6);){var o=void 0;if(o=this._accept(5,!0)){o=this._accept(5,!0)||this._accept(6,!0)||o,t.appendChild(new nT(o));continue}if(!(this._parseFormatString(t)||this._parseAnything(t)))return!1}for(;!this._accept(4);){if(14!==this._token.type){r+=this._accept(void 0,!0);continue}return!1}try{t.regexp=new RegExp(n,r)}catch(e){return!1}return e.transform=t,!0}},{key:"_parseFormatString",value:function(e){var t=this._token;if(!this._accept(0))return!1;var n=!1;this._accept(3)&&(n=!0);var r=this._accept(8,!0);if(!r)return this._backTo(t),!1;if(!n)return e.appendChild(new nP(Number(r))),!0;if(this._accept(4))return e.appendChild(new nP(Number(r))),!0;if(!this._accept(1))return this._backTo(t),!1;if(this._accept(6)){var i=this._accept(9,!0);return i&&this._accept(4)?(e.appendChild(new nP(Number(r),i)),!0):(this._backTo(t),!1)}if(this._accept(11)){var o=this._until(4);if(o)return e.appendChild(new nP(Number(r),void 0,o,void 0)),!0}else if(this._accept(12)){var a=this._until(4);if(a)return e.appendChild(new nP(Number(r),void 0,void 0,a)),!0}else if(this._accept(13)){var s=this._until(1);if(s){var l=this._until(4);if(l)return e.appendChild(new nP(Number(r),void 0,s,l)),!0}}else{var u=this._until(4);if(u)return e.appendChild(new nP(Number(r),void 0,void 0,u)),!0}return this._backTo(t),!1}},{key:"_parseAnything",value:function(e){return 14!==this._token.type&&(e.appendChild(new nT(this._scanner.tokenText(this._token))),this._accept(void 0),!0)}}],[{key:"escape",value:function(e){return e.replace(/\$|}|\\/g,"\\$&")}},{key:"asInsertText",value:function(t){return new e().parse(t).toString()}},{key:"guessNeedsClipboard",value:function(e){return/\${?CLIPBOARD/.test(e)}}]),e}(),nL={Text:nT,Placeholder:nR,Variable:nD,FormatString:nP,Choice:nI},nB=function(){function e(t){(0,w._)(this,e),(0,_._)(this,"lines",void 0),this.lines=t.split(/\r\n?|\n/).map(function(e){return new nM().parse(e).children})}return(0,k._)(e,[{key:"apply",value:function(t){var n=t.view,r=t.from,i=t.to,o=e.instantiate(this.lines,t),a=o.text,s=o.ranges,l={from:r,to:i,insert:c.Text.of(a)},u={changes:l,scrollIntoView:!0,annotations:nv.pickedCompletion.of(t.completion)};if(s.length&&(u.selection=nH(s,0)),s.length>1){var d=new nU(s,0),f=u.effects=[nG.of(d)];void 0===n.state.field(nz,!1)&&f.push(c.StateEffect.appendConfig.of([nz,nq,nK]))}if(r===i&&!s.length){var p=c.ChangeSet.of(l,n.state.doc.length),h=n.state.selection.ranges.map(function(e){return e.map(p,0)});u.selection=c.EditorSelection.create(h,n.state.selection.mainIndex)}return u}}],[{key:"resolveVariable",value:function(e,t){var n=t.view,r=t.from,i=t.path;switch(e){case"TM_FILENAME":return(0,nk.basename)(i);case"TM_FILENAME_BASE":return(0,nk.basename)(i,(0,nk.extname)(i));case"TM_DIRECTORY":return(0,nk.dirname)(i);case"TM_FILEPATH":return i;case"TM_LINE_INDEX":return(n.state.doc.lineAt(r).number-1).toString();case"TM_LINE_NUMBER":return n.state.doc.lineAt(r).number.toString();default:return e}}},{key:"instantiate",value:function(t,n){var r=n.view,i=n.from,o=r.state,a=[],s=[],l=o.doc.lineAt(i),u=/^\s*/.exec(l.text)[0],c=o.facet(tP.indentUnit),d=!0,f=!1,p=void 0;try{for(var h,g,m=t[Symbol.iterator]();!(d=(g=m.next()).done);d=!0)!function(){var t=g.value,r=0,o="",l=function(e){var t=0,n=r;if(0===r&&(t=/^\t*/.exec(e)[0].length)){var i=u+c.repeat(t);e=i+e.slice(t),n+=i.length}return o+=e,r+=e.length,{line:a.length,from:n,to:r}},d=function(t){var o=!0,u=!1,c=void 0;try{for(var f,p=t[Symbol.iterator]();!(o=(f=p.next()).done);o=!0)f.value.match({Text:function(e){l(e.value)},Variable:function(t){var r=t.name,i=t.transform,o=e.resolveVariable(r,n);i&&(o=o.replace(i.regexp,function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return i.children.map(function(e){return e.match({Text:function(e){return e.value},FormatString:function(e){return e.resolve(t[e.index])}})}).filter(Boolean).join("")})),l(o)},Choice:function(e){l(e.options[0].value)},Placeholder:function(e){var t,n=a.length?i+a.map(function(e){return e.length}).reduce(function(e,t){return e+t}):i;if(null==(t=e.children)?void 0:t.length){var o={field:e.index,from:n+r,to:null};s.push(o),d(e.children),o.to=n+r}else{l("");var u=n+r;s.push({field:e.index,from:u,to:u})}}})}catch(e){u=!0,c=e}finally{try{o||null==p.return||p.return()}finally{if(u)throw c}}};d(t),a.push(o)}()}catch(e){f=!0,p=e}finally{try{d||null==m.return||m.return()}finally{if(f)throw p}}var x=(h=Math).max.apply(h,(0,eL._)(s.map(function(e){return e.field})));return{text:a,ranges:s.map(function(e){var t=e.field,n=(0,nw._)(e,["field"]);return(0,ng._)((0,nh._)({},n),{field:0===t?x:t-1})})}}}]),e}(),nV=d.Decoration.widget({widget:new(function(e){function t(){return(0,w._)(this,t),(0,W._)(this,t,arguments)}return(0,q._)(t,e),(0,k._)(t,[{key:"toDOM",value:function(){var e=document.createElement("span");return e.className="cm-snippetFieldPosition",e}},{key:"ignoreEvent",value:function(){return!1}}]),t}(d.WidgetType))}),nF=d.Decoration.mark({class:"cm-snippetField"}),nU=function(){function e(t,n){(0,w._)(this,e),(0,_._)(this,"ranges",void 0),(0,_._)(this,"active",void 0),(0,_._)(this,"deco",void 0),this.ranges=t,this.active=n,this.deco=d.Decoration.set(t.map(function(e){return(e.from===e.to?nV:nF).range(e.from,e.to)}))}return(0,k._)(e,[{key:"map",value:function(t){var n=[],r=!0,i=!1,o=void 0;try{for(var a,s=this.ranges[Symbol.iterator]();!(r=(a=s.next()).done);r=!0){var l=a.value,u=function(e,t){var n=t.mapPos(e.from,-1,c.MapMode.TrackDel),r=t.mapPos(e.to,1,c.MapMode.TrackDel);return null==n||null==r?null:{field:e.field,from:n,to:r}}(l,t);if(!u)return null;n.push(u)}}catch(e){i=!0,o=e}finally{try{r||null==s.return||s.return()}finally{if(i)throw o}}return new e(n,this.active)}},{key:"isSelectionInsideField",value:function(e){var t=this;return e.ranges.every(function(e){return t.ranges.some(function(n){return n.field===t.active&&n.from<=e.from&&n.to>=e.to})})}}]),e}(),nG=c.StateEffect.define({map:function(e,t){return null==e?void 0:e.map(t)}}),n$=c.StateEffect.define(),nz=c.StateField.define({create:function(){return null},update:function(e,t){var n=!0,r=!1,i=void 0;try{for(var o,a=t.effects[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var s=o.value;if(s.is(nG))return s.value;if(s.is(n$)&&e)return new nU(e.ranges,s.value)}}catch(e){r=!0,i=e}finally{try{n||null==a.return||a.return()}finally{if(r)throw i}}return e&&t.docChanged&&(e=e.map(t.changes)),e&&t.selection&&!e.isSelectionInsideField(t.selection)&&(e=null),e},provide:function(e){return d.EditorView.decorations.from(e,function(e){return e?e.deco:d.Decoration.none})}});function nH(e,t){var n=e.filter(function(e){return e.field===t}).map(function(e){return c.EditorSelection.range(e.from,e.to)});if(0!==n.length)return c.EditorSelection.create(n)}function nW(e){return function(t){var n,r=t.state,i=t.dispatch,o=r.field(nz,!1);if(!o||e<0&&0===o.active)return!1;var a=o.active+e,s=(n=Math).max.apply(n,(0,eL._)(o.ranges.map(function(e){return e.field}))),l=e>0&&o.active>=s;return i(r.update({selection:nH(o.ranges,a),effects:nG.of(l?null:new nU(o.ranges,a))})),!0}}var nq=c.Prec.highest(d.keymap.of([{key:"Tab",run:nW(1),shift:nW(-1)},{key:"Escape",run:function(e){var t=e.state,n=e.dispatch;return!!t.field(nz,!1)&&(n(t.update({effects:nG.of(null)})),!0)}}])),nK=d.EditorView.domEventHandlers({mousedown:function(e,t){var n,r=t.state.field(nz,!1);if(!r||null==(n=t.posAtCoords({x:e.clientX,y:e.clientY})))return!1;var i=r.ranges.find(function(e){return e.from<=n&&e.to>=n});return!!i&&i.field!==r.active&&(t.dispatch({selection:nH(r.ranges,i.field),effects:nG.of(r.ranges.some(function(e){return e.field>i.field})?new nU(r.ranges,i.field):null)}),!0)}}),nY=e.i(276822),nQ=e.i(916271),nX=(0,L.cssRecord)({styles0:[{p:{whiteSpace:"pre-wrap"}}]}),nJ={p:{padding:"".concat(Q.tokens.space2," ").concat(Q.tokens.space8),lineHeight:1.4,marginBottom:"".concat(Q.tokens.space8," !important")},"p:first-of-type":{marginTop:"".concat(Q.tokens.space4," !important")},"p:last-of-type":{marginBottom:"".concat(Q.tokens.space4," !important")},pre:{margin:"".concat(Q.tokens.space2," ").concat(Q.tokens.space8)},"pre + p":{borderTop:"1px solid ".concat(Q.tokens.outlineDimmest),paddingTop:Q.tokens.space4},"h1, h2, h3":{margin:"".concat(Q.tokens.space8," !important"),marginTop:"".concat(Q.tokens.space12," !important"),padding:"0 !important",paddingBottom:"".concat(Q.tokens.space4," !important"),fontSize:"100% !important",borderBottom:"1px solid ".concat(Q.tokens.backgroundHighest," !important"),lineHeight:1},"h1:first-of-type, h2:first-of-type, h3:first-of-type":{marginTop:"".concat(Q.tokens.space4," !important")},hr:{margin:"".concat(Q.tokens.space8," !important"),borderTop:"2px solid ".concat(Q.tokens.backgroundHighest," !important")},li:{margin:"".concat(Q.tokens.space2," ").concat(Q.tokens.space8)},".lsp-completion-detail":{borderBottom:"1px solid ".concat(Q.tokens.backgroundHighest),marginBottom:Q.tokens.space4},".cm-line":{paddingLeft:Q.tokens.space4,paddingRight:Q.tokens.space4},".cm-content":{paddingLeft:Q.tokens.space4,paddingRight:Q.tokens.space4}},nZ=(0,u.memo)(function(e){var t=e.content,n=e.className;return(0,S.jsx)(V.View,{css:nJ,children:(0,S.jsx)(nQ.default,{className:n,components:{code:function(e){return(0,S.jsx)(nY.default,(0,nh._)({minimal:!0,disableCopy:!0},e))}},children:t})})});function n0(e){var t=e.content,n=e.className;return"string"==typeof t?(0,S.jsx)(nZ,{css:nX.styles0,className:n,content:t}):t.kind===ny.MarkupKind.PlainText?(0,S.jsx)(V.View,{children:(0,S.jsx)(X.Text,{className:n,children:t.value})}):(0,S.jsx)(nZ,{className:n,content:t.value})}var n1=e.i(502379),n2=e.i(256969),n3=new WeakMap,n4=e.i(251119),n8=e.i(843553),n5=e.i(266374),n6="cm-ghostwriter-hint-tooltip",n9=d.EditorView.theme((0,_._)({".cm-ghostwriter-hint":{display:"none",width:"100%",backgroundColor:Q.tokens.backgroundHigher,borderTop:"solid 1px ".concat(Q.tokens.outlineDefault)}},".cm-tooltip-autocomplete.".concat(n6," .cm-ghostwriter-hint"),{display:"block"})),n7=(0,L.cssRecord)({hint:[B.rcss.font.default,{opacity:.6}]});function re(){return(0,S.jsxs)(V.View,{css:n7.hint,p:4,row:!0,gap:8,align:"center",children:[(0,S.jsx)(n5.default,{width:8,height:8}),(0,S.jsxs)(V.View,{row:!0,gap:4,align:"center",children:[(0,S.jsx)(n8.default,{size:"small",dimmed:!1,shortcut:{key:"tab"}}),(0,S.jsx)(X.Text,{variant:"small",multiline:!1,children:"to use AI suggestion."})]})]})}var rt=d.ViewPlugin.define(function(e){var t=function(){var t,n,r;return(0,eL._)(e.dom.children).concat((0,eL._)(null!=(r=null==(n=n4.RootLevelTooltipsMap.get(e))||null==(t=n.children[0])?void 0:t.children)?r:[])).filter(function(e){return e.classList.contains("cm-tooltip-autocomplete")})},n=function(e){return Array.from(e.children).filter(function(e){return e.classList.contains("cm-ghostwriter-hint")})},r=!1;return{update:function(){null!==(0,nv.completionStatus)(e.state)&&Promise.resolve().then(function(){if(!r){var e=!0,i=!1,o=void 0;try{for(var a,s=t()[Symbol.iterator]();!(e=(a=s.next()).done);e=!0){var l=a.value,u=n(l);if(0===u.length){var c=(0,R.createCodeMirrorElement)((0,S.jsx)(re,{}));c.className="cm-ghostwriter-hint",l.appendChild(c)}}}catch(e){i=!0,o=e}finally{try{e||null==s.return||s.return()}finally{if(i)throw o}}}})},destroy:function(){var e=!0,i=!1,o=void 0;try{for(var a,s=t()[Symbol.iterator]();!(e=(a=s.next()).done);e=!0){var l=a.value,u=!0,c=!1,d=void 0;try{for(var f,p=n(l)[Symbol.iterator]();!(u=(f=p.next()).done);u=!0){var h=f.value;l.removeChild(h)}}catch(e){c=!0,d=e}finally{try{u||null==p.return||p.return()}finally{if(c)throw d}}}}catch(e){i=!0,o=e}finally{try{e||null==s.return||s.return()}finally{if(i)throw o}}r=!0}}});function rn(e){var t=Object.keys(e).join(""),n=/\w/.test(t);return n&&(t=t.replace(/\w/g,"")),"[".concat(n?"\\w":"").concat(t.replace(".","").replace(/[^\w\s]/g,"\\$&"),"]")}var rr="lsp-completion-keyboard-shortcuts",ri=d.EditorView.theme((l={"& .cm-tooltip-autocomplete":{"& > *":{marginRight:4},"& > *:last-child":{marginRight:0},"& .cm-completionLabel":{flexGrow:1,flexShrink:1,overflowX:"auto",textOverflow:"ellipsis"},"& .cm-completionDetail":{color:Q.tokens.foregroundDimmer,fontSize:"85%",marginLeft:"unset"}}},(0,_._)(l,"& .".concat(rr),{display:"none"}),(0,_._)(l,'& [aria-selected="true"] .'.concat(rr),{float:"right",display:"inline-block"}),l)),ro=e.i(918323),ra=e.i(496216),rs=e.i(507374),rl=e.i(738705),ru=e.i(785707),rc=e.i(546284),rd=new(function(e){function t(){var e;return(0,w._)(this,t),(e=(0,W._)(this,t)).elementClass="cm-gutterElement-hidden",e}return(0,q._)(t,e),(0,k._)(t,[{key:"toDOM",value:function(){var e=document.createElement("span");e.classList.add("cm-hidden-lines-gutter");var t=document.createElement("span");return t.classList.add("cm-dot"),e.appendChild(t),e}}]),t}(d.GutterMarker)),rf=function(e){function t(e){var n;return(0,w._)(this,t),n=(0,W._)(this,t),(0,_._)(n,"numLines",void 0),n.numLines=e,n}return(0,q._)(t,e),(0,k._)(t,[{key:"eq",value:function(e){return e.numLines===this.numLines}},{key:"toDOM",value:function(){var e=document.createElement("span");return e.textContent="".concat(this.numLines," hidden ").concat((0,rc.default)("line",this.numLines)),e.className="cm-hidden-lines",e}}]),t}(d.WidgetType),rp=d.Decoration.mark({class:"cm-searchResultMatch"}),rh=d.EditorView.baseTheme({".cm-hidden-lines":{color:Q.tokens.foregroundDimmer,backgroundColor:Q.tokens.backgroundHighest,display:"inline-block",width:"100%"},".cm-gutterElement-hidden":{backgroundColor:Q.tokens.backgroundHighest},".cm-hidden-lines-gutter":{backgroundColor:Q.tokens.backgroundHighest,display:"flex",alignItems:"center",justifyContent:"center",width:"100%",height:"100%"},".cm-dot":{height:"5px",width:"5px",backgroundColor:Q.tokens.foregroundDimmest,borderRadius:"50%",display:"inline-block"},".cm-tooltip .cm-scroller":{border:"2px solid ".concat(Q.tokens.backgroundHighest),borderRadius:Q.tokens.borderRadius4},".cm-tooltip .cm-scroller:hover":{border:"2px solid ".concat(Q.tokens.accentPrimaryDimmest),boxShadow:Q.tokens.shadow1,cursor:"pointer"},".cm-searchResultMatch":{color:Q.tokens.foregroundDefault,backgroundColor:Q.tokens.accentPrimaryDimmest,outline:Q.tokens.accentPrimaryDimmer+" solid 1px"},".cm-searchResultMatch span":{color:Q.tokens.foregroundDefault},".cm-tooltip .cm-searchResultMatch:hover":{opacity:.8},".cm-tooltip .cm-gutterElement":{display:"flex",marginTop:0,textAlign:"center",alignItems:"center",justifyContent:"center",lineHeight:"21px"},".cm-tooltip .cm-line":{padding:0},".cm-tooltip .cm-gutters":{padding:0},".cm-tooltip .cm-content":{paddingTop:0},".cm-tooltip .cm-lineWrapping":{whiteSpace:"pre"},".cm-tooltip .cm-cursor":{display:"none"},".cm-tooltip .cm-selectionBackground":{display:"none"}}),rg=e.i(221250),rm=e.i(542101),rv=e.i(967629),rx=(0,rv.css)({scrollbarWidth:"thin",outline:"none",overflow:"auto",".cm-content":{paddingBottom:0},"::-webkit-scrollbar":{width:4},".cm-gutters":{minWidth:"unset"}}),ry=(0,rv.css)({overflow:"hidden",".cm-scroller":{overflow:"hidden"}}),rb={root:B.rcss.backgroundColor.backgroundRoot,higher:B.rcss.backgroundColor.backgroundHigher,highest:B.rcss.backgroundColor.backgroundHighest,default:B.rcss.backgroundColor.backgroundDefault},rw=new I.ReactCompartment(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return(0,d.lineNumbers)({formatNumber:function(t,n){for(var r=String(n.doc.lines).length,i=String(t+e-1);r>i.length;)i=""+i;return i}})});function rk(e){var t=e.path,n=e.initialDoc,r=e.maxHeight,i=e.minHeight,o=e.extensions,a=e.allowScroll,s=e.fontSize,l=e.hideGutter,c=e.startLineNumber,d=e.style,f=e.elevation,p=e.onNavigateToCode,h=(0,rm.default)(),g=h.ref,m=h.view,x=(0,u.useMemo)(function(){var e;return e=rb[null!=f?f:"default"],(0,rv.css)({".cm-editor":e,".cm-gutters":e})},[f]),y=rw.use(c);return(0,S.jsx)("div",{style:d,children:(0,S.jsx)(rg.default,{ref:g,initialDoc:n,css:[rx,x,void 0===a||a?null:ry],extensions:[y,void 0===o?[]:o],style:{minHeight:i,maxHeight:null!=r?r:"10em"},hideGutter:l,filePath:t,fontSize:s,readOnly:!0,onClick:function(e){if(p&&m){var t=e.clientX,n=e.clientY,r=m.posAtCoords({x:t,y:n});p(null!==r?(0,n1.offsetToPos)(m.state.doc,r):null)}}})})}var r_=e.i(672963),rS=e.i(630818),rC=e.i(576073),rj=e.i(940745),rT=(0,L.cssRecord)({snippetGroupText:[B.rcss.pl(8),B.rcss.py(8)],loadingContainer:[B.rcss.width(128),B.rcss.height(128),B.rcss.display.flex,B.rcss.align.center,B.rcss.justify.center],container:[B.rcss.minWidth("375px"),B.rcss.maxWidth("500px"),B.rcss.pt(4),B.rcss.overflowY("scroll")],firstReferenceDivider:[B.rcss.border({direction:"bottom",color:Q.tokens.backgroundHighest})],header:[B.rcss.p(4),B.rcss.pl(8)],referencesHeader:[B.rcss.p(4),B.rcss.pl(8)]}),rE=((r=rE||{}).DEFINITION="DEFINITION",r.REFERENCES="REFERENCES",r);function rR(e){var t=e.matchesMap,n=e.fileToContents,r=e.type,i=e.onClose,o=e.jumpToPosition,a=Object.keys(t);return 0===a.length?(0,S.jsx)(X.Text,{color:"dimmer",css:rT.snippetGroupText,multiline:!1,children:"REFERENCES"===r?"No references found":"No definitions found"}):(0,S.jsx)(V.View,{children:a.map(function(e){var r,s,l,u,f,p,h,g,m,x,y,b=t[e],w=n[e],k=(y=(x=b.sort(function(e,t){return e.from-t.from})).map(function(e){var t=e.from,n=e.to;return rp.range(t,n)}),[d.ViewPlugin.define(function(){return{}},{decorations:function(){return d.Decoration.set(y)}}),(r=x,s=w,l=[],u=1,r.forEach(function(e,t){var n=s.lineAt(e.from),i=s.lineAt(e.to);u<n.number-2&&l.push({startLine:u,endLine:n.number-2}),u=i.number+2,t===r.length-1&&u<s.lines&&l.push({startLine:u,endLine:s.lines})}),f=l.map(function(e){var t=s.line(e.startLine),n=s.line(e.endLine);return d.Decoration.replace({widget:new rf(e.endLine-e.startLine+1)}).range(t.from,n.to)}),p=l.map(function(e){var t=s.line(e.startLine);return d.Decoration.line({class:"cm-line-hidden"}).range(t.from)}),h=c.StateField.define({create:function(){return d.Decoration.set(f)},update:function(e){return e},provide:function(e){return d.EditorView.decorations.from(e)}}),g=c.StateField.define({create:function(){return d.Decoration.set(p)},update:function(e){return e},provide:function(e){return d.EditorView.decorations.from(e)}}),m=l.map(function(e){var t=s.line(e.startLine);return rd.range(t.from)}),[h,g,rh,d.lineNumberMarkers.of(c.RangeSet.of(m))])]);return(0,S.jsx)(V.View,{p:4,children:(0,S.jsx)(rP,{path:e,extensions:[k],doc:w,numMatches:b.length,initiallyExpanded:1===a.length,onNavigateToCode:function(t){if(null!==t)o({path:e,line:t.line+1,col:t.character});else{var n=(0,eo._)(b,1)[0],r=w.lineAt(n.from),a=n.from-r.from;o({path:e,line:r.number,col:a})}i()}})},e)})})}function rI(e){var t=e.onClose,n=e.references,r=e.definitions,i=e.jumpToPosition,o=(0,nu.default)().fs,a=(0,r_.default)(t,[]),s=(0,eo._)((0,u.useState)({}),2),l=s[0],d=s[1],f=(0,eo._)((0,u.useState)(!0),2),p=f[0],h=f[1];if((0,u.useEffect)(function(){var e=new Set((0,eL._)(n).concat((0,eL._)(r)).map(function(e){return e.path}));if(!e.size)return void h(!1);var t=!1;return(0,e7._)(function(){var n;return(0,te._)(this,function(r){switch(r.label){case 0:return h(!0),n={},[4,Promise.all(Array.from(e).map(function(e){return(0,e7._)(function(){var t;return(0,te._)(this,function(r){switch(r.label){case 0:return[4,o.readFile(e)];case 1:if((t=r.sent()).error)throw Error("Something went wrong reading file with path ".concat(e,". Received error: ").concat(t.error));return n[e]=c.Text.of(t.content.toString().split("\n")),[2]}})})()}))];case 1:if(r.sent(),h(!1),t)return[2];return d(function(e){return(0,nh._)({},e,n)}),[2]}})})(),function(){t=!0}},[o,n,r]),p)return(0,S.jsx)(V.View,{css:rT.loadingContainer,children:(0,S.jsx)(rj.default,{size:32})});var g={},m={};function x(e,t){var n=e.range,r=n.start,i=n.end;e.path in t||(t[e.path]=[]);var o=l[e.path],a=o.line(r.line+1),s=o.line(i.line+1);t[e.path].push({from:a.from+r.character,to:s.from+i.character})}return n.forEach(function(e){x(e,g)}),r.forEach(function(e){x(e,m)}),(0,S.jsxs)(V.View,{innerRef:a,css:rT.container,children:[(0,S.jsx)(V.View,{css:rT.firstReferenceDivider,children:(0,S.jsxs)(V.View,{p:4,children:[(0,S.jsxs)(V.View,{pr:4,row:!0,justify:"space-between",align:"center",children:[(0,S.jsx)(X.Header,{level:2,variant:"subheadDefault",css:rT.header,children:"Definitions"}),(0,S.jsx)(ee.IconButton,{alt:"Close",onClick:t,children:(0,S.jsx)(et.default,{})})]}),(0,S.jsx)(rR,{matchesMap:m,fileToContents:l,type:"DEFINITION",onClose:t,jumpToPosition:i})]})}),(0,S.jsx)(V.View,{children:(0,S.jsxs)(V.View,{p:4,children:[(0,S.jsx)(X.Header,{level:2,variant:"subheadDefault",css:rT.referencesHeader,children:"References"}),(0,S.jsx)(rR,{matchesMap:g,fileToContents:l,type:"REFERENCES",onClose:t,jumpToPosition:i})]})})]})}var rA=(0,L.cssRecord)({container:[B.rcss.width("100%"),B.rcss.p(4),B.rcss.rowWithGap(4),B.rcss.justify.spaceBetween,B.rcss.align.center],text:[B.rcss.flex.shrink(1),{textOverflow:"ellipsis"}]});function rP(e){var t=e.path,n=e.doc,r=e.extensions,i=e.numMatches,o=e.onNavigateToCode,a=e.initiallyExpanded,s=(0,eo._)((0,u.useState)(a),2),l=s[0],c=s[1];return(0,S.jsxs)(V.View,{children:[(0,S.jsxs)(V.View,{css:rA.container,children:[(0,S.jsxs)(V.View,{grow:!0,row:!0,gap:8,align:"center",children:[(0,S.jsx)(rS.default,{path:t}),(0,S.jsx)(X.Text,{multiline:!1,title:t,css:rA.text,children:t}),(0,S.jsx)(X.Text,{color:"dimmest",multiline:!1,children:(0,rc.default)("match",i,!0)})]}),(0,S.jsx)(ee.IconButton,{alt:l?"Collapse snippet":"Expand snippet",tooltipBehavior:"hidden",onClick:function(){return c(function(e){return!e})},children:(0,S.jsx)(rC.default,{rotate:180*!!l,style:{transition:"200ms ease"}})})]}),(0,S.jsx)(V.View,{p:4,style:{display:l?"block":"none"},children:(0,S.jsx)(rk,{path:t,initialDoc:n,extensions:void 0===r?[]:r,maxHeight:"max-content",allowScroll:!0,hideGutter:!0,onNavigateToCode:o})})]})}var rD=e.i(446749),rO=e.i(206586),rN=e.i(242719),rM=e.i(61524);function rL(e){var t=e.content,n=e.className,r=(0,rM.usePreferences)("fontSize").preferences;if("string"!=typeof t&&"kind"in t)return(0,S.jsx)(n0,{content:t});var i=(Array.isArray(t)?t:[t]).map(function(e){return"string"==typeof e?e:"```"+e.language+"\n"+e.value+"\n```"}).join("\n");return(0,S.jsx)(nQ.default,{css:[{p:{fontSize:r.fontSize},hr:{display:"none"}}],className:n,components:{code:function(e){return(0,S.jsx)(nY.default,(0,nh._)({minimal:!0,disableCopy:!0},e))}},children:i})}function rB(e){var t=e.className,n=e.content;return(0,S.jsx)(V.View,{css:[nJ,B.rcss.maxHeight(190),B.rcss.minHeight(30),B.rcss.overflowY("auto"),B.rcss.borderRadius(4),B.rcss.backgroundColor.backgroundHigher],children:(0,S.jsx)(rL,{content:n,className:t})})}var rV=e.i(863790),rF=e.i(78866),rU=e.i(235387),rG=e.i(223808),r$=e.i(969932);function rz(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:function(e){return e},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=c.StateEffect.define(),r=c.StateField.define({create:function(){return t},update:function(t,r){return(0,r$.forEachEffect)(r,n,function(n){t=e(n.value,t)}),t}});return{effect:n,state:r}}e.s(["StateEffectField",()=>rz],275072);var rH=rz(),rW=c.StateEffect.define(),rq=c.StateField.define({create:function(){return null},update:function(e,t){if(t.isUserEvent("select")||t.isUserEvent("undo")||t.isUserEvent("redo"))return null;if(!t.isUserEvent("input.type")||t.changes.empty)return e;var n="";return t.changes.iterChanges(function(e,t,r,i,o){n=o.sliceString(0,1)}),n||null}}),rK=new R.CodeMirrorComponent(function(e){var t,n,r=e.help,i=e.index,o="1px solid ".concat(Q.tokens.outlineDimmer),a="min(425px, 80vw)",s=r.signatures[i],l=r.signatures.length>1;if(!s)return null;var u=s.documentation,c=null!=r.activeParameter&&(null==(n=s.parameters)||null==(t=n[r.activeParameter])?void 0:t.documentation);return(0,S.jsxs)(V.View,{css:[B.rcss.backgroundColor.backgroundHigher,{width:"max-content"}],row:!0,children:[l?(0,S.jsx)(V.View,{css:[{borderRight:o,paddingBottom:5}],pl:4,row:!0,children:(0,S.jsxs)("span",{css:[{alignSelf:"flex-end"},B.rcss.p(4)],children:[i+1,"/",r.signatures.length]})}):null,(0,S.jsxs)(V.View,{children:[(0,S.jsx)(V.View,{css:[B.rcss.pl(l?4:8),B.rcss.pr(8),B.rcss.maxHeight(100),B.rcss.overflowY("scroll"),B.rcss.font.code,{lineHeight:Q.tokens.lineHeightSmall,maxWidth:a}],py:4,children:(0,S.jsx)(rY,{signature:s,activeParameter:r.activeParameter})}),!!(u||c)&&(0,S.jsxs)(V.View,{css:[B.rcss.px(l?4:8),B.rcss.py(2),B.rcss.maxHeight(200),B.rcss.overflow("scroll"),{borderTop:o,maxWidth:a}],children:[c?(0,S.jsx)(n0,{content:c}):null,u?(0,S.jsx)(n0,{content:u}):null]})]})]})});function rY(e){var t,n=e.signature,r=n.label,i=n.parameters,o=e.activeParameter;if(null==o||!i)return(0,S.jsx)("span",{children:r});var a=null==(t=i[o])?void 0:t.label;if(!a)return(0,S.jsx)("span",{children:r});var s=(0,eo._)("string"==typeof a?[r.indexOf(a),r.indexOf(a)+a.length]:a,2),l=s[0],u=s[1];return(0,S.jsxs)("div",{children:[(0,S.jsx)("span",{children:r.slice(0,l)}),(0,S.jsx)("strong",{children:a}),(0,S.jsx)("span",{children:r.slice(u)})]})}var rQ=e.i(15053),rX=e.i(577811),rJ=new Map;function rZ(e,t,n){if(!t.length)return[];var r,i,o,a,s,l,u=[(i=(r={lspClients:t,path:n}).lspClients,o=r.path,d.ViewPlugin.define(function(e){var t,n,r,a,s,l;return n=(t={lspClients:i,path:o,view:e}).lspClients,r=t.path,a=t.view,s=(0,rQ.v4)(),l=function(e){var t,n=rJ.get(e.clientId);return(null!=(t=null==n?void 0:n.get(r))?t:[])[0]===s},!function(){var e=!0,t=!1,i=void 0;try{for(var o,l=n[Symbol.iterator]();!(e=(o=l.next()).done);e=!0){var u,c=o.value,d=rJ.get(c.clientId),f=null!=(u=null==d?void 0:d.get(r))?u:[];d?d.set(r,(0,eL._)(f).concat([s])):rJ.set(c.clientId,new Map([[r,[s]]])),c.notify.didOpen(r,a.state.doc.toString())}}catch(e){t=!0,i=e}finally{try{e||null==l.return||l.return()}finally{if(t)throw i}}}(),{id:s,destroy:function(){var e=!0,t=!1,i=void 0;try{for(var o,a=n[Symbol.iterator]();!(e=(o=a.next()).done);e=!0){var l,u=o.value,c=rJ.get(u.clientId),d=(null!=(l=null==c?void 0:c.get(r))?l:[]).filter(function(e){return e!==s});u.getServerState()===rX.ServerState.INITIALIZED&&u.isOpen(r)&&u.notify.didClose(r),0===d.length?null==c||c.delete(r):null==c||c.set(r,d)}}catch(e){t=!0,i=e}finally{try{e||null==a.return||a.return()}finally{if(t)throw i}}},update:function(e){if(e.docChanged){var t=!0,i=!1,o=void 0;try{for(var a,s,u=n[Symbol.iterator]();!(t=(s=u.next()).done);t=!0){var c,d=s.value;if(l(d)){var f=null==(c=d.getServerCapabilities())?void 0:c.textDocumentSync;if(f!==nm.TextDocumentSyncKind.None&&d.isOpen(r)){if(f===nm.TextDocumentSyncKind.Full){d.notify.didChange(r,[{text:e.view.state.doc.toString()}]);continue}a||(a=function(e,t){var n=[],r=t;return e.iterChanges(function(e,t,i,o,a){var s=a.sliceString(0),l=t-e,u=l+i;n.push({range:{start:(0,n1.offsetToPos)(r,i),end:(0,n1.offsetToPos)(r,u)},rangeLength:l,text:s}),r=r.replace(i,u,a)}),n}(e.changes,e.startState.doc)),d.notify.didChange(r,a)}}}}catch(e){i=!0,o=e}finally{try{t||null==u.return||u.return()}finally{if(i)throw o}}}}}})),(0,ra.createDiagnosticsPlugin)({lspClients:t,path:n}),function(e,t){function n(e){return(0,n2.default)(e).isTextDocumentSyncSupported}return d.ViewPlugin.fromClass(function(){function r(e){(0,w._)(this,r),(0,_._)(this,"dispose",void 0),this.dispose=this.listen(e.state.facet(eT.fileName))}return(0,k._)(r,[{key:"update",value:function(e){(0,f.hasChanged)(e,eT.fileName)&&(this.dispose=this.listen(e.state.facet(eT.fileName)))}},{key:"destroy",value:function(){this.dispose&&this.dispose()}},{key:"listen",value:function(r){if((this.dispose&&this.dispose(),r)&&t.find(function(e){return n(e)}))return e.watchTextFile(r,{onFlush:function(){var e=!0,i=!1,o=void 0;try{for(var a,s=t[Symbol.iterator]();!(e=(a=s.next()).done);e=!0){var l=a.value;if(n(l))(0,n2.default)(l).isTextDocumentSyncSaveSupported&&l.isOpen(r)&&l.notify.didSave(r)}}catch(e){i=!0,o=e}finally{try{e||null==s.return||s.return()}finally{if(i)throw o}}}})}}]),r}())}(e,t),(0,np.createDocumentSymbolsExtenstion)(t)];return(0,nf.isMobile)()?u:(u.push([ri,n9,rt,(0,nv.autocompletion)({defaultKeymap:!1,closeOnBlur:!1,tooltipClass:function(e){return(0,T.hasPresentedSuggestion)(e)?n6:""},addToOptions:[{render:function(e,t){if(!(0,T.hasPresentedSuggestion)(t))return null;var n=(0,R.createCodeMirrorElement)((0,S.jsx)("div",{className:rr,children:(0,S.jsx)(n8.default,{size:"inherit",shortcut:{key:""}})}));return n.style.display="inline-flex",n},position:200}],override:t.map(function(e){var t,n,r;return(0,nv.ifNotIn)(["LineComment","BlockComment"],(t=.01>Math.random(),n=0,r=function(n,r,i){if(t&&r){var o=e.getLanguageId(r);return ti.logger.info("lsp:autocomplete:".concat(n),(0,nh._)({languageId:o},i)),(0,D.track)(A.events.LSP_COMPLETION_USED,(0,nh._)({type:n,sampleRate:.01},i))}},function(t){return(0,e7._)(function(){var i,o,a,s,l,u,d,f,p,h;return(0,te._)(this,function(g){switch(g.label){case 0:if(!(o=e.getServerCapabilities())||!(null==o?void 0:o.completionProvider)||!(a=function(e,t){var n=e.state,r=e.pos;if(e.explicit)return{triggerKind:nm.CompletionTriggerKind.Invoked};var i=n.doc.lineAt(r),o=i.text[r-i.from-1],a=i.text.substring(0,r-i.from);return(null==t?void 0:t.includes(o))?{triggerKind:nm.CompletionTriggerKind.TriggerCharacter,triggerCharacter:o}:a.match(/\w$/)?{triggerKind:nm.CompletionTriggerKind.Invoked}:null}(t,(null==o||null==(i=o.completionProvider)?void 0:i.triggerCharacters)||[])))return[2,null];if(n&&e.notify.cancelRequest(n),!(s=t.state.facet(eT.fileName)))throw Error("path not found");return n=e.generateId(),l=t.state.doc,[4,e.request.completion(s,(0,n1.offsetToPos)(l,t.pos),a,{id:n})];case 1:if("error"in(u=g.sent())||(d=u.result,t.aborted||!d))return[2,null];return f=Array.isArray(d)?d:d.items,h=Array.isArray(d)?{}:null!=(p=d.itemDefaults)?p:{},[2,function(e){for(var t,n=e.context,r=e.items,i=e.itemDefaults,o=e.client,a=e.trackCompletion,s=e.startingDoc,l=null,u=function(){return l},d=(E=r.filter(function(e){return!!e.label}),I=["label","kind"],A=new Set,E.filter(function(e){var t=I.map(function(t){return e[t]}).join("");return!A.has(t)&&(A.add(t),!0)})).map(function(e){return{item:e,label:e.label,filterText:(e.filterText||e.label).toLowerCase(),sortText:(e.sortText||e.label).toLowerCase()}}),f=((d=d.sort(function(e,t){return e.sortText<t.sortText?-1:+(e.sortText>t.sortText)})).length%2?d.length-1:d.length)/2,p=0;p<=f;p++){if(0===p&&d[f]){d[f].boost=0;continue}var h=d[f-p];if(h){var g=d[f-p+1],m=g.sortText,x=g.boost,y=void 0===x?0:x;h.boost=h.sortText===m?y:y+1}var b=d[f+p];if(b){var w=d[f+p-1],k=w.sortText,_=w.boost,C=void 0===_?0:_;b.boost=b.sortText===k?C:C-1}}var j=null!=(O=null==(P=d[0])?void 0:P.boost)?O:0,T=null!=(N=null==(D=d[d.length-1])?void 0:D.boost)?N:0;if(j>99||T<-99)for(var E,I,A,P,D,O,N,M,L=99/Math.max(Math.abs(j),Math.abs(T)),B=0;B<d.length;B++)d[B].boost=(null!=(M=d[B].boost)?M:0)*L;var V=(0,eo._)(function(e){var t=Object.create(null),n=Object.create(null),r=!0,i=!1,o=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done);r=!0){var l=a.value.filterText;t[l[0]]=!0;for(var u=1;u<l.length;u++)n[l[u]]=!0}}catch(e){i=!0,o=e}finally{try{r||null==s.return||s.return()}finally{if(i)throw o}}var c=rn(t)+rn(n)+"*$";return[RegExp("^"+c),new RegExp(c)]}(d),2),F=V[0],U=V[1],G=n.matchBefore(U),$=n.pos;function z(e,t){var n,r,l,d,f,p,h,g,m,x,y,b,w,k;return m=t.state.facet(eT.fileName),x=null!=(f=(0,nx.default)(t.state))?f:"unknown",y=(0,n2.default)(o),b=e.item,w=e.boost,k={label:b.label,detail:y.isCompletionLabelDetailsSupported?null==(n=b.labelDetails)?void 0:n.description:b.detail,type:null==(r=Object.entries(ny.CompletionItemKind).find(function(e){var t=(0,eo._)(e,2),n=(t[0],t[1]);return b.kind===n}))?void 0:r[0].toLowerCase(),commitCharacters:t.state.facet(nb)?null!=(g=null!=(h=null!=(p=b.commitCharacters)?p:i.commitCharacters)?h:null==(d=o.getServerCapabilities())||null==(l=d.completionProvider)?void 0:l.allCommitCharacters)?g:[]:void 0,boost:w},n3.set(k,e),k.apply=function(t,n,r,i){var l=function(e){var n=d?s:t.state.doc,r={from:(0,n1.posToOffset)(n,e.start),to:(0,n1.posToOffset)(n,e.end)};return d&&(r.from=d.mapPos(r.from),r.to=d.mapPos(r.to)),r};if(m){var d=u(),f=null!=(h=null==(p=e.resolved)?void 0:p.additionalTextEdits)?h:b.additionalTextEdits;if(b.insertTextFormat===ny.InsertTextFormat.Snippet){var p,h,g,y,w,k=null;f&&(k={changes:f.map(function(e){return(0,ng._)((0,nh._)({},l(e.range)),{insert:e.newText})})});var _=new nB(null!=(w=null!=(y=null==(g=b.textEdit)?void 0:g.newText)?y:b.insertText)?w:b.label);if(b.textEdit&&"range"in b.textEdit){var S=i,C=l(b.textEdit.range);r=C.from,i=Math.max(i=C.to,S)}var j=k?[k,_.apply({view:t,from:r,to:i,path:m,completion:n})]:[_.apply({view:t,from:r,to:i,path:m,completion:n})];t.dispatch.apply(t,(0,eL._)(j)),a("completion-accepted",m,{language:x,completionKind:b.kind,insertTextFormat:b.insertTextFormat});return}var T=[];if(b.textEdit){if(!("range"in b.textEdit))return;var E=l(b.textEdit.range);T.push((0,ng._)((0,nh._)({},E),{to:Math.max(E.to,t.state.selection.main.to),insert:b.textEdit.newText}))}else{var R=b.insertText||b.label,I=t.state.wordAt(i);I&&I.to>i&&R.includes(t.state.doc.sliceString(i,I.to))&&(i=I.to),T.push({from:r,to:i,insert:R})}var A=(0,eo._)(T,1)[0],P="";null==f||f.forEach(function(e){var t=l(e.range);"from"in A&&t.from===A.from&&(P=e.newText),T.push((0,ng._)((0,nh._)({},t),{insert:e.newText}))});var D=i-r;t.state.selection.ranges.forEach(function(e){if(e!==t.state.selection.main){if(!("insert"in A)||!A.insert)throw Error("Expected insert in mainChange");var n=e.from-D,r=P+A.insert;T.push({from:n,to:e.to,insert:r})}});var O=c.ChangeSet.of(T.map(function(e){return"from"in e&&void 0!==e.to?(0,ng._)((0,nh._)({},e),{from:Math.min(e.from,e.to),to:Math.max(e.from,e.to)}):e}),t.state.doc.length);a("completion-accepted",m,{language:x,completionKind:b.kind,insertTextFormat:b.insertTextFormat}),t.dispatch({annotations:nv.pickedCompletion.of(n),changes:O,selection:c.EditorSelection.create(t.state.selection.ranges.map(function(e){return e.map(O,0)}),t.state.selection.mainIndex)}),b.command&&o.request.executeCommand(b.command.command,b.command.arguments)}},y.isCompletionItemResolveSupported&&(k.info=function(){return(0,e7._)(function(){var t,n,r,i,s,l,u;return(0,te._)(this,function(c){switch(c.label){case 0:if(n=null!=(t=e.resolved)?t:null)return[3,2];return[4,o.request.resolveCompletionItem(b)];case 1:if(n="result"in(r=c.sent())?r.result:null,r.cancelled||null===n)return[2,null];e.resolved=n,c.label=2;case 2:if(i=Math.floor(0x7fffffff*Math.random()),s=[],m&&n.detail&&n.detail!==b.detail&&n.detail!==b.label&&(u=["```"+((l=m.lastIndexOf("."))>=0?m.slice(l+1):"md"),n.detail,"```"].join("\n"),s.push((0,S.jsx)(n0,{className:n.documentation?"lsp-completion-detail":void 0,content:{value:u,kind:"markdown"}},"".concat(i,"-detail")))),n.documentation&&s.push((0,S.jsx)(n0,{content:n.documentation},"".concat(i,"-documentation"))),0===s.length)return[2,null];return a("resolution-presented",m,{language:x,resolutionSource:"request",completionKind:b.kind}),[2,{dom:(0,R.createCodeMirrorElement)((0,S.jsx)("div",{children:s}))}]}})})()}),k}return G&&($=G.from),d.length&&a("completion-options-presented",n.state.facet(eT.fileName),{language:null!=(t=(0,nx.default)(n.state))?t:"unknown"}),{from:$,options:d.map(function(e){return z(e,n)}),validFor:F,update:function(e,t,n,r){return(0,ng._)((0,nh._)({},e),{options:e.options.map(function(e){var t,n=null!=(t=n3.get(e))?t:null;return n?z(n,r):e})})},map:function(e,t){return l=l?l.composeDesc(t):t,e}}}({context:t,startingDoc:l,items:f,itemDefaults:h,client:e,trackCompletion:r})]}})})()}))})})],function(e){var t={current:new Map},n=c.StateField.define({create:function(){return null},update:function(e,t){return t.isUserEvent("select.pointer")?null:(e&&t.newSelection.main.from!==e.pos&&(e=(0,ng._)((0,nh._)({},e),{pos:t.newSelection.main.from})),(0,r$.forEachEffect)(t,rH.effect,function(n){var r=n.value;e=r?{pos:t.newSelection.main.from,help:r,index:0}:null}),(0,r$.forEachEffect)(t,rW,function(t){var n=t.value;if(e){var r=e.help.signatures.length,i=(r+e.index+n)%r;e=i>=e.help.signatures.length||i<0?null:(0,ng._)((0,nh._)({},e),{index:i})}}),e)},provide:function(e){var t=function(t){var n=t.state.field(e);if(!n)throw Error("expected nonnull field");var r=rK.create({help:n.help,index:n.index});return{dom:r,update:function(t){rK.update(r,function(r){var i=t.state.field(e);return i&&i!==n?{help:i.help,index:i.index}:r})}}};return d.showTooltip.compute([e],function(n){var r=n.field(e);return r?{pos:r.pos,create:t,above:!0}:null})}}),r=d.ViewPlugin.define(function(){var r=(0,rG.default)(function(r){return(0,e7._)(function(){var i,o,a;return(0,te._)(this,function(s){switch(s.label){case 0:var l,u;if(!(i=r.state.selection.main).empty)return[3,2];return o=r.state.field(rH.state,!1),[4,(l=r.state,u=i.from,(0,e7._)(function(){var r,i,o,a,s,c;return(0,te._)(this,function(d){switch(d.label){case 0:var f,p,h,g,m;if(!(i=l.facet(eT.fileName))||(o=l.field(n,!1),a=l.field(rq,!1),!(s=e.filter(function(e){var t,n,r,i=null!=(r=null==(n=e.getServerCapabilities())||null==(t=n.signatureHelpProvider)?void 0:t.triggerCharacters)?r:[];return!!i.length&&(!!o||!!a&&!!i.includes(a))&&!0})).length))return[2,null];return[4,(f=l,p=u,h=s,g=i,m=t,(0,e7._)(function(){return(0,te._)(this,function(e){switch(e.label){case 0:return[4,Promise.all(h.map(function(e){return(0,e7._)(function(){var t,n;return(0,te._)(this,function(r){return(t=m.current.get(e.clientId))&&e.notify.cancelRequest(t),n=e.generateId(),m.current.set(e.clientId,n),[2,e.request.signatureHelp(g,(0,n1.offsetToPos)(f.doc,p),{id:n}).then(function(t){return(m.current.get(e.clientId)===n&&m.current.set(e.clientId,null),"error"in t)?null:t.result})]})})()}))];case 1:return[2,e.sent().find(function(e){return null!==e&&e.signatures.length})]}})})())];case 1:if(!(null==(c=d.sent())||null==(r=c.signatures)?void 0:r.length))return[2,null];return[2,c]}})})())];case 1:(a=s.sent())&&!o&&(0,nv.closeCompletion)(r),r.dispatch({effects:rH.effect.of(a)}),s.label=2;case 2:return[2]}})})()},0);return{update:function(t){e.some(function(e){return(0,n2.default)(e).isSignatureHelpSupported})&&t.selectionSet&&t.state.selection.main.empty&&r(t.view)}}});function i(e,t){var n=e.state.field(rH.state,!1);return"active"!==(0,nv.completionStatus)(e.state)&&null!=n&&("navigate"!==t||n.signatures.length>1)}var o=function(e){return function(t){return!!i(t,"navigate")&&(t.dispatch({effects:rW.of(e)}),!0)}},a=[{key:"ArrowDown",run:o(1)},{key:"ArrowUp",run:o(-1)},{key:"Escape",run:function(e){return!!i(e,"dismiss")&&(e.dispatch({effects:rH.effect.of(null)}),!0)}}];return[n,rH.state,rq,r,c.Prec.high(d.keymap.of(a))]}(t),(a=function(e){var t=null;return(0,d.hoverTooltip)(function(n,r){return(0,e7._)(function(){var i,o,a,s,l,u;return(0,te._)(this,function(c){switch(c.label){case 0:if(n.state.facet(rV.ContextMenuVisible)||!(0,n2.default)(e).isHoverSupported||!(i=n.state.facet(eT.fileName)))return[2,null];o=(0,n1.offsetToPos)(n.state.doc,r);try{a=n.state.wordAt(r)}catch(e){return[2,null]}if(t){if(t.from===(null==a?void 0:a.from)&&t.to===(null==a?void 0:a.to))return[2,null];e.notify.cancelRequest(t.id)}return t={id:s=e.generateId(),from:null==a?void 0:a.from,to:null==a?void 0:a.to},[4,e.request.hover(i,o,{id:s})];case 1:if(l=c.sent(),t=null,"error"in l||null===(u=l.result))return[2,null];return[2,function(e){var t,n,r=e.hover,i=e.state,o=e.offset;if((Array.isArray(r.contents)||"string"==typeof r.contents)&&0===r.contents.length)return null;var a="",s=i.doc;if(r.range)t=(0,n1.posToOffset)(s,r.range.start),n=(0,n1.posToOffset)(s,r.range.end),a=s.sliceString(t,n);else if(n=void 0,(t=o)<=i.doc.length){var l=i.wordAt(t);l?(a=s.sliceString(l.from,l.to),t=Math.min(t,l.from),n=l.to):a=s.sliceString(t,t+1)}return{pos:t,end:n,create:function(e){var t=(0,R.createCodeMirrorElement)((0,S.jsx)(rB,{content:r.contents,textHovered:a}));return t.classList.add("hover-tooltip"),t.style.padding="0",{dom:t,mount:function(){var t;t=function(){(0,d.repositionTooltips)(e)},[0,50,200,1e3].forEach(function(e){return setTimeout(t,e)})}}},above:!0}}({hover:u,offset:r,state:n.state})]}})})()},{hideOn:function(e){return!e.annotation(c.Transaction.remote)&&!!(e.isUserEvent("input")||e.isUserEvent("delete")||e.isUserEvent("select")||e.state.facet(rV.ContextMenuVisible))},hoverTime:0})},[c.Prec.highest(t.map(function(e){return a(e)})),d.EditorView.domEventObservers({mousedown:function(e,t){!((0,tA._)(e.target,HTMLElement)&&e.target.matches(".cm-tooltip *"))&&(0,d.hasHoverTooltips)(t.state)&&t.dispatch({effects:d.closeHoverTooltips})},keydown:function(e,t){"Escape"===e.key&&(0,d.hasHoverTooltips)(t.state)&&t.dispatch({effects:d.closeHoverTooltips})},scroll:function(e,t){(0,d.hasHoverTooltips)(t.state)&&t.dispatch({effects:d.closeHoverTooltips})}})]),(0,ro.createCodeActionsExtension)(t,e),(0,rF.createJumpToDefinitionExtension)({lspClients:t}),(s=c.StateEffect.define(),l=c.StateEffect.define(),[d.EditorView.updateListener.of(function(e){return(0,e7._)(function(){var n,r,i,o,a,u,c,d,f,p,h,g,m,x,y,b,w,k,_,S,C,j,T,E,R,I,A,P,D,O,N,M,L;return(0,te._)(this,function(B){switch(B.label){case 0:if(!t.some(function(e){var t=(0,n2.default)(e);return t.isFindReferencesSupported||t.isFindDefinitionSupported}))return[2];n=null,r=!0,i=!1,o=void 0;try{for(a=e.transactions[Symbol.iterator]();!(r=(u=a.next()).done);r=!0){c=u.value,d=!0,f=!1,p=void 0;try{for(h=c.effects[Symbol.iterator]();!(d=(g=h.next()).done);d=!0)(m=g.value).is(ru.findDefinitionsAndReferences)&&(n=m.value)}catch(e){f=!0,p=e}finally{try{d||null==h.return||h.return()}finally{if(f)throw p}}}}catch(e){i=!0,o=e}finally{try{r||null==a.return||a.return()}finally{if(i)throw o}}if(!n||!(x=e.view.state.facet(eT.fileName)))return[2];y=e.state.doc,b=(0,n1.offsetToPos)(y,n),w=[],k=!0,_=!1,S=void 0;try{for(C=function(){var e=T.value,t=(0,n2.default)(e);t.isFindDefinitionSupported&&w.push(e.request.findDefinitions(x,b).then(function(t){return{client:e,response:t,type:"definition"}})),t.isFindReferencesSupported&&w.push(e.request.findReferences(x,b,{includeDeclaration:!1}).then(function(t){return{client:e,response:t,type:"references"}}))},j=t[Symbol.iterator]();!(k=(T=j.next()).done);k=!0)C()}catch(e){_=!0,S=e}finally{try{k||null==j.return||j.return()}finally{if(_)throw S}}return E=Promise.all(w),(0,rl.bindLoading)(e.view,E),[4,E];case 1:R=B.sent(),I=[],A=[],P=!0,D=!1,O=void 0;try{for(N=function(){var e=L.value,t=e.client,n=e.response,r=e.type;if("error"in n)throw Error("Something went wrong fetching references: ".concat(n.error.message));var i=(0,rO.normalizeDefinitionResult)(n.result);if(!i)return"continue";"definition"===r&&I.push.apply(I,(0,eL._)(i.map(function(e){return(0,ng._)((0,nh._)({},e),{path:t.documentUriToPath(e.uri)})}))),"references"===r&&A.push.apply(A,(0,eL._)(i.map(function(e){return(0,ng._)((0,nh._)({},e),{path:t.documentUriToPath(e.uri)})})))},M=R[Symbol.iterator]();!(P=(L=M.next()).done);P=!0)N()}catch(e){D=!0,O=e}finally{try{P||null==M.return||M.return()}finally{if(D)throw O}}if(!I.length&&!A.length)return(0,rD.showMessageTooltip)(e.view,{message:"No references found",offset:n}),e.view.dispatch({effects:l.of(null)}),[2];return e.view.dispatch({effects:s.of({references:A,definitions:I})}),[2]}})})()}),c.StateField.define({create:function(){return null},update:function(e,t){var n=e,r=!0,i=!1,o=void 0;try{for(var a,u=t.effects[Symbol.iterator]();!(r=(a=u.next()).done);r=!0){var c=a.value;c.is(s)&&(n=c.value),c.is(l)&&(n=null)}}catch(e){i=!0,o=e}finally{try{r||null==u.return||u.return()}finally{if(i)throw o}}return n},provide:function(e){return[d.keymap.of([{key:"Escape",run:function(t){return!!t.state.field(e)&&(t.dispatch({effects:l.of(null)}),!0)}}]),d.showTooltip.compute([e],function(t){var n=t.field(e),r=t.facet(eT.fileName);if(!n)return null;var i=t.selection.asSingle().main;return{pos:i.from,end:i.to,create:function(e){var t=(0,R.createCodeMirrorElement)((0,S.jsx)("div",{children:(0,S.jsx)(rI,(0,ng._)((0,nh._)({},n),{onClose:function(){e.dispatch({effects:l.of(null)})},jumpToPosition:function(t){if(t.path!==r)return void(0,rN.openFile)(e.state,{path:t,secondary:!1});var n=t.line,i=t.col;(0,rs.handleDeeplink)({view:e,line:n,col:i}),e.focus()}}))}));return t.classList.add("replit-tooltip"),t.style.padding="0",t.style.overflow="scroll",{dom:t}}}})]}})]),(0,rU.createRenameExtension)(e,t)),u)}e.s(["createLSPExtensions",()=>rZ],518202)},546544,e=>{"use strict";var t=e.i(333859),n=[t.SemanticTokenTypes.namespace,t.SemanticTokenTypes.type,t.SemanticTokenTypes.class,t.SemanticTokenTypes.enum,t.SemanticTokenTypes.interface,t.SemanticTokenTypes.struct,t.SemanticTokenTypes.typeParameter,t.SemanticTokenTypes.parameter,t.SemanticTokenTypes.variable,t.SemanticTokenTypes.property,t.SemanticTokenTypes.enumMember,t.SemanticTokenTypes.event,t.SemanticTokenTypes.function,t.SemanticTokenTypes.method,t.SemanticTokenTypes.macro,t.SemanticTokenTypes.keyword,t.SemanticTokenTypes.modifier,t.SemanticTokenTypes.comment,t.SemanticTokenTypes.string,t.SemanticTokenTypes.number,t.SemanticTokenTypes.regexp,t.SemanticTokenTypes.operator,t.SemanticTokenTypes.decorator,"angle","arithmetic","attribute","attributeBracket","bitwise","boolean","brace","bracket","builtinAttribute","builtinType","character","colon","comma","comparison","constParameter","derive","deriveHelper","dot","escapeSequence","invalidEscapeSequence","formatSpecifier","generic","label","lifetime","logical","macroBang","parenthesis","punctuation","selfKeyword","selfTypeKeyword","semicolon","typeAlias","toolModule","union","unresolvedReference","tomlArrayKey","tomlTableKey"],r=[t.SemanticTokenModifiers.declaration,t.SemanticTokenModifiers.definition,t.SemanticTokenModifiers.readonly,t.SemanticTokenModifiers.static,t.SemanticTokenModifiers.deprecated,t.SemanticTokenModifiers.abstract,t.SemanticTokenModifiers.async,t.SemanticTokenModifiers.modification,t.SemanticTokenModifiers.documentation,t.SemanticTokenModifiers.defaultLibrary,"attribute","callable","constant","consuming","controlFlow","crateRoot","injected","intraDocLink","library","macro","mutable","public","reference","trait","unsafe"];function i(e,t){var r=e.tokenTypes[t];return r&&n.includes(r)?r:null}function o(e,t){for(var n=[],i=0;i<e.tokenModifiers.length;i++)if(t&1<<i){var o=e.tokenModifiers[i];o&&r.includes(o)&&n.push(o)}return n}e.s(["KNOWN_SEMANTIC_TOKENS",()=>n,"KNOWN_SEMANTIC_TOKEN_MODIFIERS",()=>r,"getSemanticTokenModifiers",()=>o,"getSemanticTokenType",()=>i])},300538,732676,317377,885970,299865,502674,809321,684555,268403,e=>{"use strict";var t,n,r,i,o=e.i(389959);e.i(508987);var a=e.i(518711),s=e.i(518202),l=e.i(828767),u=e.i(460448),c=e.i(935997),d=e.i(918323),f=e.i(297083),p=e.i(904851),h=e.i(90659),g=e.i(721281),m=e.i(817556),x=e.i(903673),y=e.i(753950),b=e.i(179302),w=e.i(457103),k=e.i(736097),_=e.i(346715),S=e.i(486701),C=e.i(433772),j=e.i(546544),T={namespace:C.tags.namespace,type:C.tags.typeName,class:C.tags.className,enum:C.tags.typeName,interface:C.tags.typeName,struct:C.tags.typeName,typeParameter:C.tags.typeName,parameter:C.tags.variableName,variable:C.tags.variableName,property:C.tags.propertyName,enumMember:C.tags.propertyName,event:C.tags.typeName,function:C.tags.function(C.tags.variableName),method:C.tags.function(C.tags.propertyName),macro:C.tags.macroName,keyword:C.tags.keyword,modifier:C.tags.modifier,comment:C.tags.comment,string:C.tags.string,number:C.tags.number,regexp:C.tags.regexp,operator:C.tags.operator,decorator:C.tags.function(C.tags.annotation),angle:null,arithmetic:C.tags.arithmeticOperator,attribute:C.tags.attributeName,attributeBracket:C.tags.bracket,bitwise:C.tags.bitwiseOperator,boolean:C.tags.bool,brace:C.tags.brace,bracket:C.tags.bracket,builtinAttribute:C.tags.standard(C.tags.attributeName),builtinType:C.tags.standard(C.tags.typeName),character:C.tags.character,colon:C.tags.punctuation,comma:C.tags.separator,comparison:C.tags.compareOperator,constParameter:C.tags.constant(C.tags.variableName),derive:C.tags.function(C.tags.annotation),deriveHelper:C.tags.function(C.tags.annotation),dot:C.tags.derefOperator,escapeSequence:C.tags.escape,invalidEscapeSequence:C.tags.invalid,formatSpecifier:C.tags.processingInstruction,generic:C.tags.typeName,label:C.tags.labelName,lifetime:C.tags.special(C.tags.variableName),logical:C.tags.logicOperator,macroBang:C.tags.macroName,parenthesis:C.tags.paren,punctuation:C.tags.punctuation,selfKeyword:C.tags.self,selfTypeKeyword:C.tags.self,semicolon:C.tags.separator,typeAlias:C.tags.typeName,toolModule:C.tags.namespace,union:null,unresolvedReference:null,tomlArrayKey:C.tags.propertyName,tomlTableKey:C.tags.className},E={declaration:C.tags.definition,definition:C.tags.definition,readonly:C.tags.constant,static:C.tags.constant,deprecated:null,abstract:null,async:C.tags.special,modification:function(e){return e===C.tags.keyword?C.tags.modifier:null},documentation:function(e){return e===C.tags.comment?C.tags.docComment:e===C.tags.string?C.tags.docString:null},defaultLibrary:C.tags.standard,attribute:null,callable:C.tags.function,constant:C.tags.constant,consuming:null,controlFlow:function(e){return e===C.tags.keyword?C.tags.controlKeyword:e===C.tags.operator?C.tags.controlOperator:null},crateRoot:null,injected:null,intraDocLink:function(){return C.tags.url},library:null,macro:null,mutable:null,public:null,reference:null,trait:null,unsafe:null},R=new Set([C.tags.comment,C.tags.string,C.tags.number,C.tags.keyword,C.tags.operator]),I=new Map,A=e.i(502379),P=e.i(256969),D=function(){function e(t,n){(0,p._)(this,e),(0,g._)(this,"data",void 0),(0,g._)(this,"id",void 0),this.data=t,this.id=n}return(0,h._)(e,[{key:"reset",value:function(){this.data=[],this.id=null}},{key:"update",value:function(e){if(!e)return void this.reset();if("edits"in e&&this.id){var t,n,r=e.edits.slice().sort(function(e,t){return t.start-e.start}),i=!0,o=!1,a=void 0;try{for(var s,l=r[Symbol.iterator]();!(i=(s=l.next()).done);i=!0){var u,c,d=s.value;(null==(u=d.data)?void 0:u.length)?(c=this.data).splice.apply(c,[d.start,d.deleteCount].concat((0,_._)(d.data))):this.data.splice(d.start,d.deleteCount)}}catch(e){o=!0,a=e}finally{try{i||null==l.return||l.return()}finally{if(o)throw a}}this.id=null!=(n=e.resultId)?n:null}else if("data"in e)this.data=e.data,this.id=null!=(t=e.resultId)?t:null;else throw Error("Invalid semantic tokens response")}},{key:"decorations",value:function(e,t){for(var n=t.doc,r=new y.RangeSetBuilder,i=0,o=0,a=0;a<this.data.length;a+=5){var s=this.data[a],l=this.data[a+1],u=this.data[a+2],c=this.data[a+3],d=this.data[a+4];i+=s,o=s>0?l:o+l;var f=function(e,t,n){var r=(0,j.getSemanticTokenType)(e,t);if(null===r)return null;var i=T[r];if(!i)return null;var o=(0,j.getSemanticTokenModifiers)(e,n),a="".concat(r,":").concat(o.join(",")),s=I.get(a);if(void 0!==s)return s;var l=o.map(function(e){if(void 0===E[e])return null;var t=E[e];return null===t?null:t}).filter(Boolean),u=!0,c=!1,d=void 0;try{for(var f,p=l[Symbol.iterator]();!(u=(f=p.next()).done);u=!0){var h=(0,f.value)(i);h&&(i=h)}}catch(e){c=!0,d=e}finally{try{u||null==p.return||p.return()}finally{if(c)throw d}}return i&&R.has(i)&&(i=null),I.set(a,i),i}(e,c,d);if(f){var p=(0,S.highlightingFor)(t,[f]);if(p){var h=(0,A.posToOffset)(n,{line:i,character:o}),g=(0,A.posToOffset)(n,{line:i,character:o+u}),m=b.Decoration.mark({class:p});r.add(h,g,m)}}}return r.finish()}}]),e}(),O=e.i(700170),N=["typescript"],M=function(){function e(t,n){var r=this;(0,p._)(this,e),(0,g._)(this,"view",void 0),(0,g._)(this,"client",void 0),(0,g._)(this,"data",void 0),(0,g._)(this,"controller",void 0),(0,g._)(this,"disposables",void 0),(0,g._)(this,"pending",void 0),(0,g._)(this,"running",void 0),(0,g._)(this,"changes",void 0),(0,g._)(this,"proneToDesync",void 0),(0,g._)(this,"decorations",void 0),this.view=t,this.client=n,this.data=new D([],null),this.controller=null,this.disposables=[],this.pending=!1,this.running=!1,this.changes=null,this.decorations=b.Decoration.none,this.proneToDesync=N.some(function(e){return n.clientId.includes(e)}),this.disposables.push(n.onSemanticTokensRefresh(function(){return r.refresh()}),n.onServerCapabilitiesChange(function(){return r.refresh()}));var i=t.state.facet(k.fileName);if(i)if(n.isOpen(i))this.run();else{var o=setTimeout(function(){n.isOpen(i)&&r.run()},500);this.disposables.push(function(){return clearTimeout(o)})}}return(0,h._)(e,[{key:"abort",value:function(){var e;this.pending=!1,null==(e=this.controller)||e.abort()}},{key:"refresh",value:function(){this.abort(),this.data.reset(),this.run()}},{key:"run",value:function(){this.pending=!0,this.running||(this.running=!0,(0,f._)(function(){var e,t;return(0,m._)(this,function(n){switch(n.label){case 0:t=function(){var t,n,r,i,o,a,s,l,u,c,d;return(0,m._)(this,function(p){switch(p.label){case 0:t=Date.now(),p.label=1;case 1:if(p.trys.push([1,3,,4]),e.pending=!1,e.changes=null,o=(i=e.view.state).facet(k.fileName),a=null==(r=e.client.getServerCapabilities())||null==(n=r.semanticTokensProvider)?void 0:n.legend,l=(s=(0,P.default)(e.client)).isSemanticTokensFullSupported||s.isSemanticTokensRangeSupported,!o||!a||!l||!e.client.isOpen(o))return e.data.reset(),e.decorations.size>0&&(e.decorations=b.Decoration.none,e.view.dispatch()),[2,"continue"];return e.controller=new AbortController,[4,function(e){return(0,f._)(function(e){var t,n,r,i,o,a,s,l,u,c,d;return(0,m._)(this,function(f){switch(f.label){case 0:if(t=e.client,n=e.path,r=e.previous,i=e.doc,o=e.signal,a=(0,P.default)(t),r&&a.isSemanticTokensDeltaSupported)s=t.semanticTokensDelta(n,r,{signal:o});else if(a.isSemanticTokensFullSupported)s=t.semanticTokensFull(n,{signal:o});else{if(!i||!a.isSemanticTokensRangeSupported)return[2,null];l=(0,A.offsetToPos)(i,0),u=(0,A.offsetToPos)(i,i.length),s=t.semanticTokensRange(n,{start:l,end:u},{signal:o})}return[4,s];case 1:if((c=f.sent())&&"error"in c&&-32802===c.error.code)return[2,!1];if(!c||c.cancelled||!(d="result"in c&&!c.cancelled?c.result:null))return[2,null];return[2,d]}})}).apply(this,arguments)}({client:e.client,path:o,previous:e.data.id,doc:i.doc,signal:e.controller.signal})];case 2:return!1===(u=p.sent())?e.pending=!0:e.controller.signal.aborted||(e.data.update(u),e.decorations=e.changes?e.data.decorations(a,i).map(e.changes):e.data.decorations(a,i),e.view.dispatch()),[3,4];case 3:return c=p.sent(),(0,b.logException)(e.view.state,c),e.data.reset(),e.decorations=b.Decoration.none,e.changes=null,[3,4];case 4:if(e.controller=null,d=Date.now()-t,!(e.pending&&d<150))return[3,6];return[4,new Promise(function(e){return setTimeout(e,150-d)})];case 5:p.sent(),p.label=6;case 6:return[2]}})},n.label=1;case 1:if(!this.pending)return[3,3];return e=this,[5,(0,x._)(t())];case 2:return n.sent(),[3,1];case 3:return this.running=!1,this.changes=null,[2]}})}).call(this))}},{key:"update",value:function(e){e.docChanged&&this.decorations.size&&(this.decorations=this.decorations.map(e.changes))}},{key:"postUpdate",value:function(e){(0,w.hasChanged)(e,k.fileName)?this.refresh():e.docChanged&&(this.running&&(this.changes=this.changes?this.changes.composeDesc(e.changes):e.changes),this.proneToDesync&&this.abort(),this.run())}},{key:"destroy",value:function(){this.abort(),this.data.reset();var e=!0,t=!1,n=void 0;try{for(var r,i=this.disposables[Symbol.iterator]();!(e=(r=i.next()).done);e=!0)(0,r.value)()}catch(e){t=!0,n=e}finally{try{e||null==i.return||i.return()}finally{if(t)throw n}}this.disposables=[]}}]),e}(),L=new O.ReactCompartment(function(e){if(!e||!e.length)return null;var t=e.map(function(e){return b.ViewPlugin.define(function(t){return new M(t,e)},{decorations:function(e){return e.decorations},provide:function(e){return b.EditorView.updateListener.of(function(t){var n;return null==(n=t.view.plugin(e))?void 0:n.postUpdate(t)})}})});return y.Prec.highest(t)}),B=e.i(522682),V=e.i(61524),F=e.i(993796),U=e.i(485237),G=e.i(529810);function $(e){var t=e.filePath,n=e.isLoading,r=(0,G.default)().fs,i=(0,U.default)(t),u=(0,V.usePreferences)("acceptSuggestionOnCommitCharacter","codeIntelligence","codeActionsOnSave","semanticTokens").preferences,c=(0,F.useFlag)({controlName:"flag-lsp-semantic-tokens",logFlagToAnalytics:!1}),d=n||!u.codeIntelligence||!i.find(function(e){return e.isSupportedFile(t)}),f=(0,o.useMemo)(function(){return new a.DynamicExtension(d?[]:(0,s.createLSPExtensions)(r,i,t))},[i,t,r,d]),p=(0,o.useMemo)(function(){return new a.DynamicExtension(function(){return l.LSPCapabilitiesFacet.of(i.map(function(e){return(0,P.default)(e)}))})},[i]);return(0,o.useEffect)(function(){return!i.length||d?f.set(null):(0,B.combineDisposables)(i.map(function(e){return e.onServerCapabilitiesChange(function(){p.set(l.LSPCapabilitiesFacet.of(i.map(function(e){return(0,P.default)(e)})))})}))},[p,i,f,d]),[p.extension,f.extension,z.use(u.acceptSuggestionOnCommitCharacter),H.use(u.codeActionsOnSave),W.use(u.codeIntelligence),L.use(u.semanticTokens&&c?i:null)]}var z=new O.ReactCompartment(function(e){return c.AcceptSuggestionOnCommitCharacter.of(e)}),H=new O.ReactCompartment(function(e){return d.CodeActionsOnSaveEnabled.of(e)}),W=new O.ReactCompartment(function(e){return u.CodeIntelligenceEnabled.of(e)});e.s(["default",()=>$],300538);var q=e.i(399119),K=e.i(445789),Y=e.i(530658),Q=e.i(840838),X=e.i(682532),J=e.i(873753),Z=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&0>t.indexOf(r)&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols)for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)0>t.indexOf(r[i])&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n},ee=y.Facet.define({combine:function(e){var t=[],n=!0,r=!1,i=void 0;try{for(var o,a=e[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var s=o.value;if(s){s.create;var l=s.gutters,u=Z(s,["create","gutters"]);t.push(Object.assign(Object.assign({},u),{enabled:!0,gutters:l?l.filter(function(e){return Object.keys(e).length>0}):void 0}))}}}catch(e){r=!0,i=e}finally{try{n||null==a.return||a.return()}finally{if(r)throw i}}return(0,y.combineConfig)(t,{enabled:t.length>0,displayText:"characters",eventHandlers:{},showOverlay:"always",gutters:[]})}}),et=b.EditorView.theme({".cm-minimap-overlay-container":{position:"absolute",top:0,height:"100%",width:"100%","&.cm-minimap-overlay-mouse-over":{opacity:0,transition:"visibility 0s linear 300ms, opacity 300ms"},"&.cm-minimap-overlay-mouse-over:hover":{opacity:1,transition:"visibility 0s linear 0ms, opacity 300ms"},"&.cm-minimap-overlay-off":{display:"none"},"& .cm-minimap-overlay":{background:"rgb(121, 121, 121)",opacity:"0.2",position:"absolute",right:0,top:0,width:"100%",transition:"top 0s ease-in 0ms","&:hover":{opacity:"0.3"}},"&.cm-minimap-overlay-active":{opacity:1,visibility:"visible",transition:"visibility 0s linear 0ms, opacity 300ms","& .cm-minimap-overlay":{opacity:"0.4"}}}}),en=8,er=[et,b.ViewPlugin.fromClass(function(){function e(t){(0,p._)(this,e),this.view=t,this._isDragging=!1,t.state.facet(ee).enabled&&this.create(t)}return(0,h._)(e,[{key:"create",value:function(e){this.container=(0,Q.default)("div",{class:"cm-minimap-overlay-container"}),this.dom=(0,Q.default)("div",{class:"cm-minimap-overlay"}),this.container.appendChild(this.dom),this.container.addEventListener("mousedown",this.onMouseDown.bind(this)),window.addEventListener("mouseup",this.onMouseUp.bind(this)),window.addEventListener("mousemove",this.onMouseMove.bind(this));var t=e.dom.querySelector(".cm-minimap-inner");t&&t.appendChild(this.container),this.computeShowOverlay(),this.computeHeight(),this.computeTop()}},{key:"remove",value:function(){this.container&&(this.container.removeEventListener("mousedown",this.onMouseDown),window.removeEventListener("mouseup",this.onMouseUp),window.removeEventListener("mousemove",this.onMouseMove),this.container.remove())}},{key:"update",value:function(e){var t=e.startState.facet(ee).enabled,n=e.state.facet(ee).enabled;t&&!n?this.remove():(!t&&n&&this.create(e.view),n&&(this.computeShowOverlay(),e.geometryChanged&&(this.computeHeight(),this.computeTop())))}},{key:"computeHeight",value:function(){if(this.dom){var e=this.view.dom.clientHeight/en;this.dom.style.height=e+"px"}}},{key:"computeTop",value:function(){if(!this._isDragging&&this.dom){var e=this.view.scrollDOM,t=e.clientHeight,n=e.scrollHeight,r=e.scrollTop,i=r/(n-t);isNaN(i)&&(i=0);var o=Math.min((t-t/en)*i,r/en);this.dom.style.top=o+"px"}}},{key:"computeShowOverlay",value:function(){if(this.container){"mouse-over"===this.view.state.facet(ee).showOverlay?this.container.classList.add("cm-minimap-overlay-mouse-over"):this.container.classList.remove("cm-minimap-overlay-mouse-over");var e=this.view.scrollDOM;e.clientHeight===e.scrollHeight?this.container.classList.add("cm-minimap-overlay-off"):this.container.classList.remove("cm-minimap-overlay-off")}}},{key:"onMouseDown",value:function(e){if(this.container&&2!==e.button){var t=e.clientY,n=e.target;if(n===this.dom){this._dragStartY=e.clientY,this._isDragging=!0,this.container.classList.add("cm-minimap-overlay-active");return}var r=this.view.scrollDOM,i=r.clientHeight,o=r.scrollHeight,a=r.scrollTop,s=n.getBoundingClientRect().top,l=Math.max(0,a-a/(o-i)*(i*en-i));this.view.scrollDOM.scrollTop=l+(t-s)*en-i/2}}},{key:"onMouseUp",value:function(e){this._isDragging&&this.container&&(this._dragStartY=void 0,this._isDragging=!1,this.container.classList.remove("cm-minimap-overlay-active"))}},{key:"onMouseMove",value:function(e){if(this._isDragging&&this.dom){if(e.preventDefault(),e.stopPropagation(),!this._dragStartY){this._dragStartY=e.clientY;return}var t=e.clientY-this._dragStartY;this._dragStartY=e.clientY;var n=this.dom.getBoundingClientRect().height,r=this.dom.getBoundingClientRect().y,i=parseFloat(this.dom.style.top),o=this.view.scrollDOM.scrollTop,a=this.view.scrollDOM.clientHeight,s=this.view.scrollDOM.scrollHeight,l=0===o,u=Math.round(o)>=Math.round(s-a);if((!l||!(t<0))&&(!l||!(e.clientY<r))&&(!u||!(t>0))&&(!u||!(e.clientY>r+n))){var c=this.view.scrollDOM.scrollHeight,d=this.view.scrollDOM.clientHeight,f=d-d/en,p=i+t;this.view.scrollDOM.scrollTop=Math.max(p/f*(c-d),p*en);var h=Math.min(Math.max(0,p),Math.min(f,(c-d)/en));this.dom.style.top=h+"px"}}}},{key:"destroy",value:function(){this.remove()}}]),e}(),{eventHandlers:{scroll:function(){var e=this;requestAnimationFrame(function(){return e.computeTop()})}}})],ei=function(){function e(t){(0,p._)(this,e),this.map=new Map,this.view=t}return(0,h._)(e,[{key:"get",value:function(e){return this.map.get(e)}},{key:"set",value:function(e,t){this.map.set(e,t)}}]),e}();function eo(e){if(!e.facet(ee).enabled)return[];var t,n=[],r=e.doc.iterLines(),i=(0,S.foldedRanges)(e).iter(),o=0;for(r.next();!r.done;){for(var a=r.value,s=o,l=s+a.length;i.value&&i.to<s;)i.next();var u=i.from,c=i.to,d=s>=u&&s<c,f=l>u&&l<=c;if(d){var p=null!=(t=n.pop())?t:[],h=p.pop();h&&h.folded&&(h.to=c),h&&p.push(h),h&&h.folded||p.push({from:u,to:c,folded:!0}),f||p.push({from:c,to:l,folded:!1}),n.push(p)}else f?n.push([{from:s,to:u,folded:!1},{from:u,to:c,folded:!0}]):n.push([{from:s,to:l,folded:!1}]);o=l+1,r.next()}return n}var ea=y.StateField.define({create:function(e){return eo(e)},update:function(e,t){return es([t])||t.docChanged?eo(t.state):e}});function es(e){return e.find(function(e){return e.effects.find(function(e){return e.is(S.foldEffect)||e.is(S.unfoldEffect)})})}var el=function(e){function t(e){var n;return(0,p._)(this,t),(n=(0,q._)(this,t,[e])).count=void 0,n}return(0,K._)(t,e),(0,h._)(t,[{key:"shouldUpdate",value:function(e){if(!e.state.facet(ee).enabled)return!1;if(e.docChanged)return!0;var t=!0,n=!1,r=void 0;try{for(var i,o=e.transactions[Symbol.iterator]();!(t=(i=o.next()).done);t=!0){var a=i.value,s=!0,l=!1,u=void 0;try{for(var c,d=a.effects[Symbol.iterator]();!(s=(c=d.next()).done);s=!0)if(c.value.is(X.setDiagnosticsEffect))return!0}catch(e){l=!0,u=e}finally{try{s||null==d.return||d.return()}finally{if(l)throw u}}}}catch(e){n=!0,r=e}finally{try{t||null==o.return||o.return()}finally{if(n)throw r}}return!!es(e.transactions)||void 0===this.count}},{key:"update",value:function(e){var t=this;if(this.shouldUpdate(e)){this.map.clear();var n=e.state.field(ea);this.count=(0,X.diagnosticCount)(e.state),(0,X.forEachDiagnostic)(e.state,function(e,r,i){for(var o=t.findLine(r,n),a=t.findLine(i,n),s=e.severity,l=o;l<=a;l++){var u=t.get(l);u&&(s=[s,u].sort(t.sort.bind(t)).slice(0,1)[0]),t.set(l,s)}})}}},{key:"drawLine",value:function(e,t){var n=e.context,r=e.lineHeight,i=e.offsetX,o=e.offsetY,a=this.get(t);a&&(n.globalAlpha=.65,n.beginPath(),n.rect(i,o,n.canvas.width-i,r),n.fillStyle=this.color(a),n.fill())}},{key:"findLine",value:function(e,t){return t.findIndex(function(t){var n=t.slice(0,1)[0],r=t.slice(-1)[0];return!!n&&!!r&&n.from<=e&&e<=r.to})+1}},{key:"color",value:function(e){return"error"===e?"#d11":"warning"===e?"orange":"#999"}},{key:"sort",value:function(e,t){return this.score(t)-this.score(e)}},{key:"score",value:function(e){switch(e){case"error":return 3;case"warning":return 2;default:return 1}}}]),t}(ei),eu=function(e){function t(e){var n;return(0,p._)(this,t),(n=(0,q._)(this,t,[e])).getDrawInfo(),n._themeClasses=e.dom.classList.value,n}return(0,K._)(t,e),(0,h._)(t,[{key:"shouldUpdate",value:function(e){return!!e.state.facet(ee).enabled&&!!(e.docChanged||e.selectionSet||this._themeClasses!==this.view.dom.classList.value||es(e.transactions))}},{key:"update",value:function(e){if(this.shouldUpdate(e)){this.map.clear(),this._themeClasses!==this.view.dom.classList.value&&(this._drawInfo=void 0,this._themeClasses=this.view.dom.classList.value);var t=e.state.selection.ranges,n=0,r=!0,i=!1,o=void 0;try{for(var a,s=e.state.field(ea).entries()[Symbol.iterator]();!(r=(a=s.next()).done);r=!0){var l=(0,Y._)(a.value,2),u=l[0],c=l[1],d=[],f=0,p=!0,h=!1,g=void 0;try{for(var m,x=c[Symbol.iterator]();!(p=(m=x.next()).done);p=!0){var y=m.value;do{if(n>=t.length||y.to<t[n].from)continue;if(t[n].from===t[n].to){n++;continue}var b=t[n],w={from:f+Math.max(y.from,b.from)-y.from,to:f+Math.min(y.to,b.to)-y.from,extends:b.to>y.to},k=d.slice(-1)[0];if(k&&k.to===w.from){var _=w.to;y.folded&&w.extends?_=w.from+1:y.folded&&!w.extends&&(_=k.to),d[d.length-1]=Object.assign(Object.assign({},k),{to:_,extends:w.extends})}else y.folded||d.push(w);if(w.extends)break;n++}while(n<t.length&&y.to>=t[n].from)f+=y.folded?1:y.to-y.from}}catch(e){h=!0,g=e}finally{try{p||null==x.return||x.return()}finally{if(h)throw g}}if(0!==d.length){var S=u+1;this.map.set(S,d)}}}catch(e){i=!0,o=e}finally{try{r||null==s.return||s.return()}finally{if(i)throw o}}}}},{key:"drawLine",value:function(e,t){var n=e.context,r=e.lineHeight,i=e.charWidth,o=e.offsetX,a=e.offsetY,s=this.get(t);if(s){var l=!0,u=!1,c=void 0;try{for(var d,f=s[Symbol.iterator]();!(l=(d=f.next()).done);l=!0){var p=d.value,h=o+p.from*i,g=(p.to-p.from)*i,m=n.canvas.width-h;p.extends&&(n.globalAlpha=.65,n.beginPath(),n.rect(h,a,m,r),n.fillStyle=this.getDrawInfo().backgroundColor,n.fill()),n.globalAlpha=1,n.beginPath(),n.rect(h,a,g,r),n.fillStyle=this.getDrawInfo().backgroundColor,n.fill()}}catch(e){u=!0,c=e}finally{try{l||null==f.return||f.return()}finally{if(u)throw c}}}}},{key:"getDrawInfo",value:function(){if(this._drawInfo)return this._drawInfo;var e=document.createElement("span");e.setAttribute("class","cm-selectionBackground"),this.view.dom.appendChild(e);var t={backgroundColor:window.getComputedStyle(e).backgroundColor};return this._drawInfo=t,this.view.dom.removeChild(e),t}}]),t}(ei),ec=function(e){function t(e){var n;return(0,p._)(this,t),(n=(0,q._)(this,t,[e]))._fontInfoMap=new Map,n._themeClasses=new Set(e.dom.classList.values()),e.state.facet(ee).enabled&&n.updateImpl(e.state),n}return(0,K._)(t,e),(0,h._)(t,[{key:"shouldUpdate",value:function(e){return!!(e.docChanged||e.state.facet(ee)!==e.startState.facet(ee)||this.themeChanged()||es(e.transactions))}},{key:"update",value:function(e){this.shouldUpdate(e)&&(this._highlightingCallbackId&&(void 0!==window.requestIdleCallback?cancelIdleCallback(this._highlightingCallbackId):clearTimeout(this._highlightingCallbackId)),this.updateImpl(e.state,e.changes))}},{key:"updateImpl",value:function(e,t){var n,r=this;this.map.clear(),this._displayText=e.facet(ee).displayText,this.themeChanged()&&this._fontInfoMap.clear();var i=void 0;if(this._previousTree&&t){var o=J.TreeFragment.addTree(this._previousTree),a=[];t.iterChangedRanges(function(e,t,n,r){return a.push({fromA:e,toA:t,fromB:n,toB:r})}),i=J.TreeFragment.applyChanges(o,a)}var s=e.doc.toString(),l=null==(n=e.facet(S.language))?void 0:n.parser,u=l?l.parse(s,i):void 0;this._previousTree=u;var c={style:function(t){return(0,S.highlightingFor)(e,t)}},d=[];if(u){var f=e.doc.lineAt(this.view.viewport.from).number,p=e.doc.lineAt(this.view.viewport.to).number,h=p-f,g=f/(e.doc.lines-h),m=4*h*2,x=g*m,y=Math.max(1,Math.floor(f-x)),b=Math.min(p+Math.floor(m-x),e.doc.lines);(0,C.highlightTree)(u,c,function(e,t,n){d.push({from:e,to:t,tags:n})},e.doc.line(y).from,e.doc.line(b).to)}this.updateMapImpl(e,d),d=[];var w=function(){u&&((0,C.highlightTree)(u,c,function(e,t,n){d.push({from:e,to:t,tags:n})}),r.updateMapImpl(e,d),r._highlightingCallbackId=void 0)};this._highlightingCallbackId=void 0!==window.requestIdleCallback?requestIdleCallback(w):setTimeout(w)}},{key:"updateMapImpl",value:function(e,t){this.map.clear();var n=e.doc.toString(),r=t.values(),i=r.next(),o=!0,a=!1,s=void 0;try{for(var l,u=e.field(ea).entries()[Symbol.iterator]();!(o=(l=u.next()).done);o=!0){var c=(0,Y._)(l.value,2),d=c[0],f=c[1],p=[],h=!0,g=!1,m=void 0;try{for(var x,y=f[Symbol.iterator]();!(h=(x=y.next()).done);h=!0){var b=x.value;if(b.from!==b.to){if(b.folded){p.push({text:"",tags:""});continue}for(var w=b.from;!i.done&&i.value.from<b.to;){var k=i.value,_=k.from,S=k.to,C=k.tags;if(S<w){i=r.next();continue}_>w&&p.push({text:n.slice(w,_),tags:""});var j=Math.max(_,b.from),T=Math.min(S,b.to);if(p.push({text:n.slice(j,T),tags:C}),w=T,S>T)break;i=r.next()}w!==b.to&&p.push({text:n.slice(w,b.to),tags:""})}}}catch(e){g=!0,m=e}finally{try{h||null==y.return||y.return()}finally{if(g)throw m}}var E=d+1;this.map.set(E,p)}}catch(e){a=!0,s=e}finally{try{o||null==u.return||u.return()}finally{if(a)throw s}}}},{key:"measure",value:function(e){var t=this.getFontInfo(""),n=t.color,r=t.font,i=t.lineHeight;return e.textBaseline="ideographic",e.fillStyle=n,e.font=r,{charWidth:e.measureText("_").width,lineHeight:i}}},{key:"beforeDraw",value:function(){this._fontInfoMap.clear()}},{key:"drawLine",value:function(e,t){var n=this.get(t);if(n){var r=e.context,i=e.charWidth,o=e.lineHeight,a=e.offsetX,s=e.offsetY;r.textBaseline="ideographic";var l=!0,u=!1,c=void 0;try{for(var d,f,p=n[Symbol.iterator]();!(l=(f=p.next()).done);l=!0){var h=f.value,g=this.getFontInfo(h.tags);switch((!d||d.color!==g.color)&&(r.fillStyle=g.color),(!d||d.font!==g.font)&&(r.font=g.font),d=g,o=Math.max(o,g.lineHeight),this._displayText){case"characters":r.fillText(h.text,a,s+o),a+=h.text.length*i;break;case"blocks":for(var m=/\S+/g,x=void 0;null!==(x=m.exec(h.text));){var y=a+x.index*i,b=(m.lastIndex-x.index)*i;if(y>r.canvas.width)break;y+b>r.canvas.width&&(b=r.canvas.width-y);var w=.5,k=o-w;r.fillStyle=g.color,r.globalAlpha=.65,r.beginPath(),r.rect(y,s,b,k),r.fill()}a+=h.text.length*i}}}catch(e){u=!0,c=e}finally{try{l||null==p.return||p.return()}finally{if(u)throw c}}}}},{key:"getFontInfo",value:function(e){var t=this._fontInfoMap.get(e);if(t)return t;var n=(0,Q.default)("span",{class:e}),r=(0,Q.default)("div",{class:"cm-line",style:"display: none"},n);this.view.contentDOM.appendChild(r);var i=window.getComputedStyle(n),o=parseFloat(i.lineHeight)/4,a={color:i.color,font:"".concat(i.fontStyle," ").concat(i.fontWeight," ").concat(o,"px ").concat(i.fontFamily),lineHeight:o};return this._fontInfoMap.set(e,a),this.view.contentDOM.removeChild(r),a}},{key:"themeChanged",value:function(){var e=this._themeClasses,t=new Set(this.view.dom.classList.values());if(this._themeClasses=t,!e||(e.delete("cm-focused"),t.delete("cm-focused"),e.size!==t.size))return!0;var n=!0;return e.forEach(function(e){t.has(e)||(n=!1)}),!n}}]),t}(ei),ed=b.EditorView.theme({"&":{height:"100%",overflowY:"auto"},"& .cm-minimap-gutter":{borderRight:0,flexShrink:0,left:"unset",position:"sticky",right:0,top:0},"& .cm-minimap-inner":{height:"100%",position:"absolute",right:0,top:0,overflowY:"hidden","& canvas":{display:"block"}},"& .cm-minimap-box-shadow":{boxShadow:"12px 0px 20px 5px #6c6c6c"}}),ef=b.ViewPlugin.fromClass(function(){function e(t){(0,p._)(this,e),this.view=t,this.text=new ec(t),this.selection=new eu(t),this.diagnostic=new el(t),t.state.facet(ep)&&this.create(t)}return(0,h._)(e,[{key:"create",value:function(e){var t,n=this,r=e.state.facet(ep);if(!r)throw Error("Expected nonnull");for(var i in this.inner=(0,Q.default)("div",{class:"cm-minimap-inner"}),this.canvas=(0,Q.default)("canvas"),this.dom=r.create(e).dom,this.dom.classList.add("cm-gutters"),this.dom.classList.add("cm-minimap-gutter"),this.inner.appendChild(this.canvas),this.dom.appendChild(this.inner),this.view.scrollDOM.insertBefore(this.dom,this.view.contentDOM.nextSibling),this.view.state.facet(ee).eventHandlers)t=this,function(e){var r=t.view.state.facet(ee).eventHandlers[e];r&&t.dom.addEventListener(e,function(e){return r(e,n.view)})}(i)}},{key:"remove",value:function(){this.dom&&this.dom.remove()}},{key:"update",value:function(e){var t=e.startState.facet(ep),n=e.state.facet(ep);t&&!n?this.remove():(!t&&n&&this.create(e.view),n&&(this.text.update(e),this.selection.update(e),this.diagnostic.update(e),this.render()))}},{key:"getWidth",value:function(){var e=this.view.dom.clientWidth;return e<=720?e/720*120:120}},{key:"render",value:function(){if(this.dom&&this.canvas&&this.inner){this.text.beforeDraw(),this.updateBoxShadow(),this.dom.style.width=this.getWidth()+"px",this.canvas.style.maxWidth=this.getWidth()+"px",this.canvas.width=2*this.getWidth();var e=this.view.dom.getBoundingClientRect().height;this.inner.style.minHeight=e+"px",this.canvas.height=2*e,this.canvas.style.height=e+"px";var t=this.canvas.getContext("2d");if(t){t.clearRect(0,0,this.canvas.width,this.canvas.height);for(var n=this.text.measure(t),r=n.charWidth,i=n.lineHeight,o=this.canvasStartAndEndIndex(t,i),a=o.startIndex,s=o.endIndex,l=o.offsetY,u=this.view.state.facet(ee).gutters,c=a;c<s&&!(c>=this.view.state.field(ea).length);c++){var d={offsetX:0,offsetY:l,context:t,lineHeight:i,charWidth:r};if(u.length){d.offsetX+=2;var f=!0,p=!1,h=void 0;try{for(var g,m=u[Symbol.iterator]();!(f=(g=m.next()).done);f=!0){var x=g.value;!function(e,t,n){var r=e[n];r&&(t.context.fillStyle=r,t.context.globalAlpha=1,t.context.beginPath(),t.context.rect(t.offsetX,t.offsetY,4,t.lineHeight),t.context.fill())}(x,d,c+1),d.offsetX+=4}}catch(e){p=!0,h=e}finally{try{f||null==m.return||m.return()}finally{if(p)throw h}}d.offsetX+=2}this.text.drawLine(d,c+1),this.selection.drawLine(d,c+1),this.diagnostic.drawLine(d,c+1),l+=i}t.restore()}}}},{key:"canvasStartAndEndIndex",value:function(e,t){var n=this.view.documentPadding,r=n.top,i=n.bottom;r/=4,i/=4;var o=e.canvas.height,a=this.view.scrollDOM,s=a.clientHeight,l=a.scrollHeight,u=a.scrollTop/(l-s);isNaN(u)&&(u=0);var c=Math.max(0,u*(r+i+this.view.state.field(ea).length*t-o)),d=Math.max(0,r-c),f=Math.round(Math.max(0,c-r)/t);return{startIndex:f,endIndex:f+Math.round((o-d)/t),offsetY:d}}},{key:"updateBoxShadow",value:function(){if(this.canvas){var e=this.view.scrollDOM,t=e.clientWidth,n=e.scrollWidth;t+e.scrollLeft<n?this.canvas.classList.add("cm-minimap-box-shadow"):this.canvas.classList.remove("cm-minimap-box-shadow")}}},{key:"destroy",value:function(){this.remove()}}]),e}(),{eventHandlers:{scroll:function(){var e=this;requestAnimationFrame(function(){return e.render()})}},provide:function(e){return b.EditorView.scrollMargins.of(function(t){var n,r=null==(n=t.plugin(e))?void 0:n.getWidth();return r?{right:r}:null})}}),ep=y.Facet.define({combine:function(e){var t;return null!=(t=e.find(function(e){return null!==e}))?t:null},enables:function(e){return[[ee.compute([e],function(t){return t.facet(e)}),ed,ea,ef,er]]}}),eh=e.i(738324),eg=e.i(88892),em=e.i(480028),ev=b.EditorView.theme({"& .cm-gutters.cm-minimap-gutter":{backgroundColor:em.tokens.backgroundDefault,borderLeft:"1px solid ".concat(em.tokens.backgroundHigher)},"& .cm-minimap-box-shadow":{boxShadow:"unset"}}),ex=y.StateField.define({create:function(e){return 0===e.doc.length||e.doc.lines>1e3},update:function(e,t){return t.docChanged?0===t.state.doc.length||t.state.doc.lines>1e3:e}}),ey=new O.ReactCompartment(function(e,t,n){var r=function(){return{dom:document.createElement("div")}};return e?null:[ev,ex,ep.compute([eh.GutterDiffState,ex],function(e){if(e.field(ex,!1)||"blocks"!==t&&"characters"!==t)return null;var i=e.field(eh.GutterDiffState,!1),o={};if(i)for(var a=1;a<=e.doc.lines;a++)switch(i.getLineChangeType(a)){case eg.LineChangeType.COVERED:o[a]=n.values.global.greenDefault;break;case eg.LineChangeType.MODIFIED:o[a]=n.values.global.blueDefault}return{create:r,displayText:t,gutters:[o]}})]});e.s(["MinimapCompartment",()=>ey],732676);var eb=e.i(878420),ew=e.i(64386),ek=y.Facet.define({combine:function(e){var t;return null!=(t=e.find(function(e){return null!==e}))?t:null}}),e_=y.Facet.define({combine:function(e){return eC(e)}}),eS=y.Facet.define({combine:function(e){return eC(e)}});function eC(e){var t=[];return e.forEach(function(e){return e?t.push(e):void 0}),t}e.s(["ConfigFacet",()=>ek,"CursorFacet",()=>eS,"LaneFacet",()=>e_],317377);var ej=e.i(167626),eT=function(e){function t(e){var n;return(0,p._)(this,t),n=(0,q._)(this,t),(0,g._)(n,"diagnostic",void 0),n.diagnostic=e,n}return(0,K._)(t,e),(0,h._)(t,[{key:"eq",value:function(e){return(0,ej._)(e,t)&&this.severityValue===e.severityValue}},{key:"severityValue",get:function(){switch(this.diagnostic.severity){case"error":return 3;case"warning":return 2;case"info":return 1;default:return 0}}},{key:"severityColor",get:function(){switch(this.diagnostic.severity){case"error":return"#d11";case"warning":return"orange";case"info":return"#999";default:return"#66d"}}}]),t}(y.RangeValue);function eE(e){var t=new y.RangeSetBuilder;return(0,X.forEachDiagnostic)(e,function(e,n,r){t.add(n,r,new eT(e))}),t.finish()}var eR=y.StateField.define({create:function(e){return eE(e)},update:function(e,t){return(0,w.hasChanged)(t,X.setDiagnosticsEffect)?eE(t.state):e.map(t.changes)},provide:function(e){return e_.compute([e],function(t){for(var n=new Map,r=t.field(e).iter();r.value;){for(var i=t.doc.lineAt(r.from),o=t.doc.lineAt(r.to),a=i.number;a<=o.number;){var s,l=null==(s=n.get(a))?void 0:s.severityValue;(!l||l<r.value.severityValue)&&n.set(a,r.value),a++}r.next()}return Array.from(n.entries()).map(function(e){var t=(0,Y._)(e,2),n=t[0],r=t[1];return{color:r.severityColor,number:n,zIndex:r.severityValue}})})}});function eI(){return eR}e.s(["lintLines",()=>eI],885970);var eA=e.i(220348),eP="cm-with-scrollbar",eD="cm-scrollbar-gutter",eO="cm-scrollbar-inner",eN="cm-scrollbar-overlay-container",eM="cm-scrollbar-overlay",eL="cm-scrollbar-overlay-invisible",eB="cm-scrollbar-overlay-active",eV="--cm-scrollbar-overlay-height",eF=b.EditorView.theme((r={"&":{height:"100%",overflowY:"auto"}},(0,g._)(r,"& .".concat(eD),{borderRight:0,boxSizing:"border-box",display:"flex",flexShrink:0,height:"100%",insetInlineStart:0,left:"unset",position:"sticky",right:0,top:0,width:"".concat(15,"px"),zIndex:200}),(0,g._)(r,"& .".concat(eO),{height:"100%",position:"absolute",right:0,top:0,overflowY:"hidden",borderLeft:"1px solid",borderLeftColor:"inherit"}),(0,g._)(r,"& .".concat(eO," > canvas"),{display:"block",height:"100%",width:"".concat(14,"px"),opacity:.6}),(0,g._)(r,".".concat(eN),(n={position:"absolute",top:0,height:"100%",width:"100%"},(0,g._)(n,"& .".concat(eM),(t={background:"rgb(121, 121, 121)",opacity:"0.2",position:"absolute",right:0,top:0,height:"max(".concat(20,"px, var(").concat(eV,"))"),width:"100%",transition:"top 0s ease-in 0ms"},(0,g._)(t,"&:hover",{opacity:"0.3"}),(0,g._)(t,"&.".concat(eL),{pointerEvents:"none",opacity:0}),t)),(0,g._)(n,"& .".concat(eB),(0,g._)({opacity:1,visibility:"visible",transition:"visibility 0s linear 0ms, opacity 300ms"},"& .".concat(eM),{opacity:"0.4"})),n)),(0,g._)(r,"&.".concat(eP," .cm-scroller::-webkit-scrollbar"),{width:0}),(0,g._)(r,"&.".concat(eP," .cm-scroller"),{scrollbarWidth:"none"}),r)),eU=function(){function e(t){(0,p._)(this,e),(0,g._)(this,"container",void 0),(0,g._)(this,"dragInfo",null),(0,g._)(this,"handle",void 0),(0,g._)(this,"observer",void 0),(0,g._)(this,"view",void 0),this.view=t,this.container=document.createElement("div"),this.container.classList.add(eN),this.container.role="presentation",this.container.ariaHidden="true",this.handle=document.createElement("div"),this.handle.classList.add(eM),this.container.appendChild(this.handle);var n=t.dom.querySelector(".".concat(eO));n&&n.appendChild(this.container),this.observer=new ResizeObserver(this.resizeHandle.bind(this)),this.observer.observe(t.dom),this.container.addEventListener("mousedown",this.onMouseDown.bind(this)),window.addEventListener("mouseup",this.onMouseUp.bind(this)),window.addEventListener("mousemove",this.onMouseMove.bind(this))}return(0,h._)(e,[{key:"resizeHandle",value:function(){var e=this;this.view.requestMeasure({key:"".concat(this,".resizeHandle"),read:function(){return{ratio:Math.min(1,e.view.scrollDOM.clientHeight/e.view.contentHeight)}},write:function(t){var n=t.ratio;e.handle.style.setProperty(eV,"".concat(100*n,"%")),1===n?e.handle.classList.add(eL):e.handle.classList.remove(eL)}})}},{key:"updateHandlePosition",value:function(){var e=this;this.view.requestMeasure({key:"".concat(this,".onScroll"),read:function(){var t=e.view.contentHeight,n=e.view.scrollDOM.clientHeight,r=e.handle.getBoundingClientRect().height;return{scrollTop:Math.round(e.view.scrollDOM.scrollTop*((n-r)/(t-n)))}},write:function(t){var n=t.scrollTop;e.handle.style.top="".concat(n,"px")}})}},{key:"onMouseDown",value:function(e){var t=this;if(2!==e.button){if(e.preventDefault(),e.target===this.handle){this.dragInfo={dragStartY:e.clientY},this.container.classList.add(eB);return}this.view.requestMeasure({key:"".concat(this,".onMouseDown"),read:function(){var n=t.view.scrollDOM.clientHeight,r=t.view.contentHeight;return{scrollTop:Math.max(0,e.clientY-e.target.getBoundingClientRect().top-n/r*n/2)/n*r}},write:function(e){var n=e.scrollTop;t.view.scrollDOM.scrollTop=n}})}}},{key:"onMouseUp",value:function(){this.dragInfo&&(this.dragInfo=null,this.container.classList.remove(eB))}},{key:"onMouseMove",value:function(e){if(this.dragInfo){e.preventDefault();var t=e.clientY-this.dragInfo.dragStartY;this.view.scrollDOM.scrollTop=this.view.scrollDOM.scrollTop+t/this.view.dom.clientHeight*this.view.contentHeight,this.view.scrollDOM.scrollTop>0&&Math.round(this.view.scrollDOM.scrollTop)<Math.round(this.view.contentHeight-this.view.dom.clientHeight)&&(this.dragInfo={dragStartY:e.clientY}),this.updateHandlePosition()}}},{key:"update",value:function(e){(e.docChanged||e.geometryChanged)&&(this.resizeHandle(),this.updateHandlePosition())}},{key:"destroy",value:function(){this.container.removeEventListener("mousedown",this.onMouseDown),window.removeEventListener("mouseup",this.onMouseUp),window.removeEventListener("mousemove",this.onMouseMove),this.container.remove(),this.observer.disconnect()}}]),e}(),eG=function(){function e(t){(0,p._)(this,e),(0,g._)(this,"dom",void 0),(0,g._)(this,"context",void 0),(0,g._)(this,"view",void 0),(0,g._)(this,"previousCanvasHeight",void 0),(0,g._)(this,"previousContentHeight",void 0),this.view=t;var n=t.state.facet(ek);if(!n)throw Error("expected config");this.dom=n.create(t).dom,this.dom.classList.add(eD);var r=document.createElement("div");r.classList.add(eO);var i=document.createElement("canvas");i.ariaHidden="true",this.context=i.getContext("2d"),r.appendChild(i),this.dom.appendChild(r),t.scrollDOM.insertBefore(this.dom,t.contentDOM.nextSibling),this.update()}return(0,h._)(e,[{key:"shouldRedraw",value:function(e,t){return!!(!e||!t||(0,w.hasChanged)(e,"doc","selection","focus",eS,e_,S.foldEffect,S.unfoldEffect))||this.view.contentHeight!==this.previousContentHeight||2*t.scrollClientHeight!==this.previousCanvasHeight}},{key:"update",value:function(e){var t=this;this.view.requestMeasure({key:this,read:function(){return{scrollClientHeight:t.view.scrollDOM.clientHeight}},write:function(n){var r=n.scrollClientHeight;if(t.context&&t.shouldRedraw(e,{scrollClientHeight:r})){t.previousContentHeight=t.view.contentHeight,t.context.canvas.width=28,t.context.canvas.height=2*r,t.previousCanvasHeight=t.context.canvas.height,t.context&&t.context.clearRect(0,0,t.context.canvas.width,t.context.canvas.height);var i=t.view.state.facet(eS),o=t.view.state.facet(e_),a=new Map,s=!0,l=!1,u=void 0;try{for(var c,d=o.entries()[Symbol.iterator]();!(s=(c=d.next()).done);s=!0){var f,p=(0,Y._)(c.value,2),h=p[0],g=p[1],m=h%3,x=void 0,y=void 0,b=!0,w=!1,k=void 0;try{for(var _,C=g[Symbol.iterator]();!(b=(_=C.next()).done);b=!0){var j,T=_.value;if(void 0===x||void 0===y){x=T,y=T;continue}if(y.number+1===T.number&&y.color===T.color&&y.zIndex===T.zIndex){y=T;continue}a.set(m,(null!=(j=a.get(m))?j:[]).concat([[x,y]])),x=T,y=T}}catch(e){w=!0,k=e}finally{try{b||null==C.return||C.return()}finally{if(w)throw k}}x&&y&&a.set(m,(null!=(f=a.get(m))?f:[]).concat([[x,y]]))}}catch(e){l=!0,u=e}finally{try{s||null==d.return||d.return()}finally{if(l)throw u}}var E=!0,R=!1,I=void 0;try{for(var A,P=a.entries()[Symbol.iterator]();!(E=(A=P.next()).done);E=!0){var D=(0,Y._)(A.value,2),O=D[0],N=D[1].sort(function(e,t){var n,r,i=(0,Y._)(e,1)[0],o=(0,Y._)(t,1)[0];return(null!=(n=i.zIndex)?n:0)-(null!=(r=o.zIndex)?r:0)}),M=!0,L=!1,B=void 0;try{for(var V,F=N[Symbol.iterator]();!(M=(V=F.next()).done);M=!0)!function(){var e=(0,Y._)(V.value,2),n=e[0],i=n.color,o=n.number,a=e[1].number,s=t.view.state.doc.line(o),l=t.view.state.doc.line(a),u=1/0,c=-1/0;if((0,S.foldedRanges)(t.view.state).between(s.from,l.to,function(e,t){u>e&&(u=e),c<t&&(c=t)}),u<c){var d=t.view.state.doc.lineAt(u);d.number<=s.number&&(s=d),t.view.state.doc.lineAt(c).number>=l.number&&(l=d)}var f=s.number,p=l.number,h=!0,g=!1,m=void 0;try{for(var x,y=t.view.state.field(eH)[Symbol.iterator]();!(h=(x=y.next()).done);h=!0){var b=(0,Y._)(x.value,2),w=b[0],k=b[1];w[0].number<s.number&&(f-=k),w[1].number<l.number&&(p-=k)}}catch(e){g=!0,m=e}finally{try{h||null==y.return||y.return()}finally{if(g)throw m}}t.drawRange({scrollClientHeight:r,color:i,from:f,to:p,lane:O})}()}catch(e){L=!0,B=e}finally{try{M||null==F.return||F.return()}finally{if(L)throw B}}}}catch(e){R=!0,I=e}finally{try{E||null==P.return||P.return()}finally{if(R)throw I}}var U=!0,G=!1,$=void 0;try{for(var z,H=i[Symbol.iterator]();!(U=(z=H.next()).done);U=!0){var W=z.value,q=!0,K=!1,Q=void 0;try{for(var X,J=W[Symbol.iterator]();!(q=(X=J.next()).done);q=!0){var Z=X.value,ee=Z.color,et=Z.number,en=et,er=!0,ei=!1,eo=void 0;try{for(var ea,es=t.view.state.field(eH)[Symbol.iterator]();!(er=(ea=es.next()).done);er=!0){var el=(0,Y._)(ea.value,2),eu=(0,Y._)(el[0],1)[0],ec=el[1];eu.number<et&&(en-=ec)}}catch(e){ei=!0,eo=e}finally{try{er||null==es.return||es.return()}finally{if(ei)throw eo}}t.drawRange({scrollClientHeight:r,color:ee,from:en})}}catch(e){K=!0,Q=e}finally{try{q||null==J.return||J.return()}finally{if(K)throw Q}}}}catch(e){G=!0,$=e}finally{try{U||null==H.return||H.return()}finally{if(G)throw $}}}}})}},{key:"destroy",value:function(){this.dom.remove()}},{key:"drawRange",value:function(e){if(this.context){var t,n=(this.view.documentPadding.top+this.view.defaultLineHeight*(e.from-1))/this.view.contentHeight*e.scrollClientHeight,r=2;e.to&&(r=(this.view.documentPadding.top+this.view.defaultLineHeight*e.to)/this.view.contentHeight*e.scrollClientHeight-n)<4&&(n-=(4-r)/2,r=4),this.context.fillStyle=e.color,this.context.beginPath(),this.context.fillRect(9.333333333333334*(null!=(t=e.lane)?t:0),2*n,28/(void 0===e.lane?1:3),2*r)}}}]),e}();function e$(e){for(var t=[],n=(0,S.foldedRanges)(e).iter();n.value;){var r=t[t.length-1];if(!r||r[0][1].to<n.to){var i=e.doc.lineAt(n.from),o=e.doc.lineAt(n.to);t.push([[i,o],o.number-i.number])}n.next()}return t}function ez(e){return null!==e.facet(ek)}var eH=y.StateField.define({create:function(e){return ez(e)?e$(e):[]},update:function(e,t){return ez(t.state)&&(0,w.hasChanged)(t,"doc",S.foldState,ez)?e$(t.state):e}});function eW(e){var t=e.color;return eS.compute(["doc","selection"],function(e){return e.selection.ranges.map(function(n){var r=n.head;return{color:t,number:e.doc.lineAt(r).number,zIndex:1/0}})})}e.s(["selectionLines",()=>eW],299865);var eq=y.Facet.define({combine:function(e){var t;return null!=(t=e.find(function(e){return null!==e}))?t:null},enables:function(e){return[ek.compute([e],function(t){return t.facet(e)}),eF,[eH,(0,eA.ConditionalViewPlugin)(function(e){return new eG(e)},{isEnabled:function(e){return null!==e.facet(ek)},provide:function(){return b.EditorView.editorAttributes.of(function(e){return null!==e.state.facet(ek)?{class:eP}:null})}})],(0,eA.ConditionalViewPlugin)(function(e){return new eU(e)},{isEnabled:function(e){return null!==e.facet(ek)},eventObservers:{scroll:function(){var e;null==(e=this.plugin())||e.updateHandlePosition()}}})]}});e.s(["showScrollbar",()=>eq],502674);var eK=e.i(210736),eY="cm-multiplayer-selection-green",eQ="cm-multiplayer-selection-red",eX="cm-multiplayer-selection-blue",eJ="cm-multiplayer-selection-gold",eZ="cm-multiplayer-selection-purple",e0="cm-multiplayer-selection-teal",e1="cm-multiplayer-selection-pink",e2=b.EditorView.theme((i={},(0,g._)(i,".".concat(eY),{background:"rgba(27, 196, 125, 0.2)"}),(0,g._)(i,".".concat(eQ),{background:"rgba(239, 85, 51, 0.2)"}),(0,g._)(i,".".concat(eX),{background:"rgba(24, 160, 251, 0.2)"}),(0,g._)(i,".".concat(eJ),{background:"rgba(255, 199, 0, 1)"}),(0,g._)(i,".".concat(eZ),{background:"rgba(144, 124, 255, 0.2)"}),(0,g._)(i,".".concat(e0),{background:"rgba(0, 181, 206, 0.2)"}),(0,g._)(i,".".concat(e1),{background:"rgba(238, 70, 211, 0.2)"}),i)),e3={"#1BC47D":eY,"#EF5533":eQ,"#18A0FB":eX,"#FFC700":eJ,"#907CFF":eZ,"#00B5CE":e0,"#EE46D3":e1},e4=y.StateEffect.define(),e8=y.StateEffect.define(),e5=y.StateEffect.define(),e6=y.StateField.define({create:function(){return{}},update:function(e,t){if(!t.changes.empty){var n=function(e){return t.changes.mapPos(Math.min(t.changes.length,e))},r={},i=!0,o=!1,a=void 0;try{for(var s,l=Object.values(e)[Symbol.iterator]();!(i=(s=l.next()).done);i=!0){var u=s.value;r[u.id]=(0,ew._)((0,eb._)({},u),{position:n(u.position),selectionStart:n(u.selectionStart),selectionEnd:n(u.selectionEnd)})}}catch(e){o=!0,a=e}finally{try{i||null==l.return||l.return()}finally{if(o)throw a}}e=r}var c=!0,d=!1,f=void 0;try{for(var p,h=t.effects[Symbol.iterator]();!(c=(p=h.next()).done);c=!0){var g=p.value;if(g.is(eK.resizeEditor)&&(e=(0,eb._)({},e)),g.is(e4)&&g.value.position<=t.newDoc.length&&((e=(0,eb._)({},e))[g.value.id]=(0,eb._)({},g.value)),g.is(e8)&&(e=(0,eb._)({},e),g.is(e8)&&delete e[g.value]),g.is(e5)){e=(0,eb._)({},e);var m=!0,x=!1,y=void 0;try{for(var b,w=Object.entries(e)[Symbol.iterator]();!(m=(b=w.next()).done);m=!0){var k=(0,Y._)(b.value,2),_=k[0];k[1].username===g.value&&delete e[_]}}catch(e){x=!0,y=e}finally{try{m||null==w.return||w.return()}finally{if(x)throw y}}}}}catch(e){d=!0,f=e}finally{try{c||null==h.return||h.return()}finally{if(d)throw f}}return e},provide:function(e){return[e2,y.Prec.high((0,b.layer)({above:!1,class:"cm-multiplayer-cursor-layer",update:function(t){return(0,w.hasChanged)(t,e)},markers:function(t){var n=t.state.field(e,!1);if(!n)return[];var r=[],i=!0,o=!1,a=void 0;try{for(var s,l=Object.values(n)[Symbol.iterator]();!(i=(s=l.next()).done);i=!0){var u=s.value,c=u.selectionStart,d=u.selectionEnd,f=u.color.selection;if(c!==d){var p=y.EditorSelection.range(c,d);r.push.apply(r,(0,_._)(b.RectangleMarker.forRange(t,f,p)))}}}catch(e){o=!0,a=e}finally{try{i||null==l.return||l.return()}finally{if(o)throw a}}return r}})),eS.compute([e],function(t){var n=t.field(e,!1);return n?Object.entries(n).map(function(e){var n=(0,Y._)(e,2),r=(n[0],n[1]);return{color:r.color.cursor,number:t.doc.lineAt(r.selectionStart).number}}):[]})]}});function e9(e){var t,n=e.cursor,r=e.usernameColorsMap,i=null==(t=n.user)?void 0:t.name;if(i){var o=n.id,a=n.position,s=n.selectionStart,l=n.selectionEnd,u=r[i];if(u&&o&&"number"==typeof a&&"number"==typeof s&&"number"==typeof l)return e4.of({id:o,username:i,position:a,color:{cursor:u,selection:e3[u]||""},selectionStart:s,selectionEnd:l})}}e.s(["addCursor",()=>e9,"addCursorEffect",()=>e4,"multiplayerCursorField",()=>e6,"removeCursorEffect",()=>e8,"userLeaveEffect",()=>e5],809321);var e7=function(){function e(t,n){var r=this;(0,p._)(this,e),(0,g._)(this,"view",void 0),(0,g._)(this,"presence",void 0),(0,g._)(this,"destroyed",void 0),(0,g._)(this,"dispose",void 0),(0,g._)(this,"followed",void 0),this.view=t,this.presence=n,this.destroyed=!1,this.followed=null,this.dispose=n.onFollowedUserChanged(function(e){return r.onFollowedUserChanged(e)}),Promise.resolve().then(function(){r.onFollowedUserChanged(n.getFollowedUser())})}return(0,h._)(e,[{key:"onFollowedUserChanged",value:function(e){var t=this;if(!this.destroyed&&(this.followed=e,this.followed)){var n=this.view.state.field(e6,!1);if(n){var r=Object.values(n).find(function(e){var n;return e.username===(null==(n=t.followed)?void 0:n.username)});r&&this.jumpToPosition(r.position)}}}},{key:"jumpToPosition",value:function(e){this.view.dispatch({effects:[b.EditorView.scrollIntoView(y.EditorSelection.cursor(e),{x:"center",y:"center"})]})}},{key:"unfollow",value:function(){this.presence.getFollowedUser()&&this.presence.unfollowUser()}},{key:"postUpdate",value:function(e){if(this.followed){var t=void 0,n=!0,r=!1,i=void 0;try{for(var o,a=e.transactions[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var s=o.value,l=!0,u=!1,c=void 0;try{for(var d,f=s.effects[Symbol.iterator]();!(l=(d=f.next()).done);l=!0){var p=d.value;p.is(e4)&&p.value.username===this.followed.username&&(t=p)}}catch(e){u=!0,c=e}finally{try{l||null==f.return||f.return()}finally{if(u)throw c}}}}catch(e){r=!0,i=e}finally{try{n||null==a.return||a.return()}finally{if(r)throw i}}t&&this.jumpToPosition(t.value.position)}}},{key:"destroy",value:function(){this.destroyed=!0,this.dispose()}}]),e}(),te=new O.ReactCompartment(function(e){return b.ViewPlugin.define(function(t){return new e7(t,e)},{provide:function(e){return b.EditorView.updateListener.of(function(t){var n;return null==(n=t.view.plugin(e))?void 0:n.postUpdate(t)})},eventHandlers:{click:function(){this.unfollow()},wheel:function(){this.unfollow()},keydown:function(e){"Control"!==e.key&&"Meta"!==e.key&&this.unfollow()}}})});e.s(["ObservationModeCompartment",()=>te],684555);var tt=b.ViewPlugin.define(function(e){var t=e.state.facet(tn),n=[];return{update:function(e){t=e.state.facet(tn);var n=!0,r=!1,i=void 0;try{for(var o,a=e.transactions[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var s=o.value;s.changes.empty||this.pushTransaction(s)}}catch(e){r=!0,i=e}finally{try{n||null==a.return||a.return()}finally{if(r)throw i}}},flush:function(){n=[]},logs:function(){return n},pushEvent:function(t){var n={anchor:e.state.selection.main.anchor,head:e.state.selection.main.head,docLength:e.state.doc.length,time:Date.now(),type:t.type};(0,ej._)(t,KeyboardEvent)&&(n.key=t.key,n.metaKey=t.metaKey,n.shiftKey=t.shiftKey,n.altKey=t.altKey,n.ctrlKey=t.ctrlKey),(0,ej._)(t,InputEvent)&&(n.data=t.data,n.inputType=t.inputType,n.isComposing=t.isComposing),(0,ej._)(t,CompositionEvent)&&(n.data=t.data),this.pushLog(n)},pushTransaction:function(e){this.pushLog({userEvent:e.annotation(y.Transaction.userEvent),changes:JSON.stringify(e.changes),time:Date.now(),type:"transaction"})},pushLog:function(e){t&&(n.push(e),n=n.slice(Math.max(0,n.length-100)))}}},{provide:function(e){var t=function(t,n){var r;return null==(r=n.plugin(e))?void 0:r.pushEvent(t)};return y.Prec.highest(b.EditorView.domEventHandlers({keypress:t,keydown:t,keyup:t,beforeinput:t,input:t,compositionstart:t,compositionupdate:t,compositionend:t}))}}),tn=y.Facet.define({combine:function(e){return!!e.length&&e[0]}}),tr=new O.ReactCompartment(function(e){return tn.of(e)});e.s(["KeystrokeDebuggerForErrors",()=>tt,"KeystrokeDebuggerForErrorsEnabledCompartment",()=>tr],268403)},755224,492555,545915,335392,140659,395787,507966,427469,930925,194536,275465,925565,548440,e=>{"use strict";var t,n,r=e.i(389959),i=e.i(555970),o=e.i(684555),a=e.i(904851),s=e.i(90659),l=e.i(721281),u=e.i(878420),c=e.i(64386),d=e.i(276385),f=e.i(753950),p=e.i(179302);e.i(508987);var h=e.i(457103),g=e.i(938668),m=e.i(700170),x=e.i(903381),y=e.i(222342),b=e.i(282453),w=e.i(268403),k=e.i(37292),_=e.i(251923),S=e.i(446530),C=e.i(613355),j=f.Annotation.define(),T=f.StateEffect.define(),E=f.StateField.define({create:function(){return!0},update:function(e,t){return!(0,h.hasChanged)(t,T)&&e},provide:function(e){return i.Initializing.from(e)}}),R=(0,S.cssRecord)({buttonLink:[C.rcss.reset.button,C.rcss.linkStyle]}),I="hide-editor-file-size-warning",A=b.default.get(I,"boolean"),P=function(){function e(t,n,r,i){var o=this;(0,a._)(this,e),(0,l._)(this,"view",void 0),(0,l._)(this,"path",void 0),(0,l._)(this,"fs",void 0),(0,l._)(this,"destroyed",void 0),(0,l._)(this,"dispose",void 0),(0,l._)(this,"debug",void 0),(0,l._)(this,"writeChange",void 0),this.view=t,this.path=n,this.fs=r,this.writeChange=null,this.destroyed=!1,this.debug=(0,c._)((0,u._)({},i),{latestReceivedVersion:0,openVersion:0,initiatedChanges:0,previousInitiatedChanges:null}),this.dispose=r.watchTextFile(n,{onReady:function(e){var n=e.initialContent,r=e.writeChange,a=e.version;!o.destroyed&&(o.debug.latestReceivedVersion=a,o.debug.openVersion=a,o.debug.setBsodFilePathVersion({filePath:o.path,version:a}),o.debug.trackTimeToLoadFileEnd(o.path),o.writeChange=r,t.dispatch({changes:{from:0,to:t.state.doc.length,insert:n},effects:T.of(null),annotations:[f.Transaction.addToHistory.of(!1),f.Transaction.remote.of(!0),j.of(!0)]}),n.length>=0xa00000&&!0!==A&&(A=!0,b.default.set(I,!0),i.showWarning((0,d.jsxs)(d.Fragment,{children:["Large files may be slow to edit. Consider using",(0,d.jsx)("br",{}),"Cloud Services like"," ",(0,d.jsx)("button",{onClick:function(){i.performPaneOperation({operation:"open",secondary:!0,pane:{type:"objectStorage"}})},css:R.buttonLink,children:"App Storage"})," ","and"," ",(0,d.jsx)("button",{onClick:function(){i.performPaneOperation({operation:"open",secondary:!0,pane:{type:"neon"}})},css:R.buttonLink,children:"PostgreSQL"}),"."]}),5e3)))},onChange:function(e){var n=e.changes,r=e.changeSource,i=e.version,a=e.userId;if(!o.destroyed){o.debug.latestReceivedVersion=i,o.debug.setBsodFilePathVersion({filePath:o.path,version:i});try{t.dispatch({changes:n,annotations:[f.Transaction.remote.of(r===x.ChangeSource.Container),f.Transaction.addToHistory.of(r===x.ChangeSource.Local||0===a),j.of(!0)]})}catch(e){o.debugThrowSyncRemoteOpError(n,r,e)}}},onError:function(){o.destroyed||(o.dispose=null,o.writeChange=null)},onMoveOrDelete:function(){o.destroyed||(o.dispose=null,o.writeChange=null)}})}return(0,s._)(e,[{key:"postUpdate",value:function(e){if(e.docChanged&&this.writeChange){var t=!0,n=!1,r=void 0;try{for(var i,o=e.transactions[Symbol.iterator]();!(t=(i=o.next()).done);t=!0){var a=i.value;if(!(a.annotation(f.Transaction.remote)||a.annotation(j))){this.debug.initiatedChanges++;var s=a.annotation(g.default)?{author:"ghostwriter"}:{};try{this.writeChange(a.changes,s),this.debug.previousInitiatedChanges=a.changes}catch(t){this.debugThrowWriteChangeError(e,a,t);break}}}}catch(e){n=!0,r=e}finally{try{t||null==o.return||o.return()}finally{if(n)throw r}}}}},{key:"destroy",value:function(){var e;this.destroyed=!0,null==(e=this.dispose)||e.call(this),this.dispose=null,this.writeChange=null,this.debug.deleteBsodFilePathVersion({filePath:this.path})}},{key:"debugThrowSyncRemoteOpError",value:function(e,t,n){var r=this;this.fs.readFile(this.path,{fromDisk:!1}).then(function(i){var o="replitReadError: "+i.error;i.error||(o=i.content.toString());var a=r.view.contentDOM.innerText;r.debug.throwBsod({origin:"Codemirror: ot/syncRemoteOp",error:n,tags:{ot:!0},extras:{filePath:r.path,previousChanges:JSON.stringify(r.debug.previousInitiatedChanges),changes:JSON.stringify(e),changeSource:t,otClientDoc:o,domText:a,cmDoc:r.view.state.doc.sliceString(0),openVersion:r.debug.openVersion,version:r.debug.latestReceivedVersion,initiatedChanges:r.debug.initiatedChanges}}),(0,p.logException)(r.view.state,n)})}},{key:"debugThrowWriteChangeError",value:function(e,t,n){var r=this;this.fs.readFile(this.path,{fromDisk:!1}).then(function(i){var o="replitReadError: "+i.error;i.error||(o=i.content.toString());var a=e.view.contentDOM.innerText,s=e.view.plugin(w.KeystrokeDebuggerForErrors),l=null==s?void 0:s.logs();null==s||s.flush(),r.debug.throwBsod({origin:"Codemirror: ot/writeChange",error:n,tags:{ot:!0},extras:{filePath:r.path,previousChanges:JSON.stringify(r.debug.previousInitiatedChanges),transactionChanges:JSON.stringify(t.changes),otherTransactionChanges:JSON.stringify(e.transactions.filter(function(e){return e!==t}).map(function(e){return e.changes})),transactionDoc:t.newDoc.sliceString(0),updateDoc:e.state.doc.sliceString(0),otClientDoc:o,domText:a,openVersion:r.debug.openVersion,latestReceivedVersion:r.debug.latestReceivedVersion,keystrokes:JSON.stringify(l)}})}),(0,p.logException)(e.state,n)}}]),e}(),D=new m.ReactCompartment(function(e,t,n){return p.ViewPlugin.define(function(r){return new P(r,e,t,n)},{provide:function(e){return[E,p.EditorView.updateListener.of(function(t){var n;return null==(n=t.view.plugin(e))?void 0:n.postUpdate(t)})]}})});function O(e){var t=e.filePath,n=e.fs,i=e.performPaneOperation,o=(0,_.default)().trackTimeToLoadFileEnd,a=(0,k.useThrowBsod)(),s=(0,k.useSetBsodFilePathVersion)(),l=(0,k.useDeleteBsodFilePathVersion)(),u=(0,y.default)().showWarning,c=(0,r.useMemo)(function(){return{trackTimeToLoadFileEnd:o,throwBsod:a,setBsodFilePathVersion:s,deleteBsodFilePathVersion:l,showWarning:u,performPaneOperation:i}},[l,s,a,o,u,i]);return D.use(t,n,c)}e.s(["OtIsLoading",()=>E,"useOtCompartment",()=>O],492555);var N=e.i(809321),M=e.i(346715),L=e.i(15053),B=e.i(480028),V=p.EditorView.theme({".multiplayer-cursor":{width:"2px",left:"0",top:"0"},".multiplayer-cursor .multiplayer-label":{boxShadow:B.tokens.shadow1,borderRadius:B.tokens.borderRadius4,padding:"1px",position:"absolute",left:"0px",animation:"fadeOut 2s ease-in forwards",color:"white",display:"inline-block",whiteSpace:"nowrap"},".multiplayer-cursor:hover .multiplayer-label":{animation:"auto"}});function F(e){e.style.transform="translate(-10000px, -10000px)"}var U=/iPhone|iPad|iPod/i;function G(){return!!window.navigator.userAgent.match(U)||"ontouchstart"in window&&window.navigator.userAgent.includes("Macintosh")}function $(e){var t=document.createElement("div");t.textContent=e.username,t.style.backgroundColor=e.color.cursor,t.classList.add("multiplayer-label");var n=document.createElement("div");return n.classList.add("multiplayer-cursor"),n.style.backgroundColor=e.color.cursor,n.style.position=G()?"absolute":"fixed",n.appendChild(t),{dom:n,label:t}}var z=new Map,H=[V,p.ViewPlugin.define(function(e){var t=e.state.field(N.multiplayerCursorField,!1),n=new Map((t?Object.values(t):[]).map(function(e){return[e.id,{view:$(e),cursor:e}]})),r=!0,i=0,o="function"==typeof IntersectionObserver?new IntersectionObserver(function(e){Date.now()>i-50&&e.length>0&&e[e.length-1].intersectionRatio<1&&u()},{threshold:[1]}):null;function a(){o&&(o.disconnect(),n.forEach(function(e){o.observe(e.view.dom)}))}function s(){!(!t||0===Object.values(t).length)&&(e.inView&&e.requestMeasure(c),r!==e.inView)&&((r=e.inView)||n.forEach(function(e){F(e.view.dom)}))}a();var l=null;function u(){null===l&&(l=setTimeout(function(){l=null,s()},50))}window.addEventListener("resize",u);var c={read:function(){return{editorRect:e.scrollDOM.getBoundingClientRect(),dimensions:new Map((t?Object.values(t):[]).map(function(t){var r=n.get(t.id),i=r?function(e,t){var n=z.get(e);if(n)return n;var r=t.getBoundingClientRect().width;return z.set(e,r),r}(t.username,r.view.label):null;return[t.id,{position:e.coordsAtPos(t.position),labelWidth:i}]}))}},write:function(e){n.forEach(function(t,n){var r=e.dimensions.get(n);!function(e){var t=e.cursorView,n=e.position,r=e.labelWidth,i=e.editorRect,o=t.dom,a=t.label;if(!n||!r)return F(o);var s=n.bottom-n.top;if(n.bottom<=i.top+s||n.top+s>=i.bottom||n.right<i.left-.1||n.left>i.right+.1)return F(o);var l=n.left+r-i.right,u="0px";l>0?(u="-".concat(l,"px"),a.style.borderBottomLeftRadius="4px"):a.style.borderBottomLeftRadius="0px",a.style.pointerEvents="none",a.style.transform="translate(".concat(u,", -100%)");var c=G()?{x:n.left-i.left+"px",y:n.top-i.top+"px"}:{x:"calc(".concat(n.left,"px + var(--fixed-position-offset-x))"),y:"calc(".concat(n.top,"px + var(--fixed-position-offset-y))")},d=c.x,f=c.y;o.style.transform="translate(".concat(d,", ").concat(f,")"),o.style.height=s+"px"}({cursorView:t.view,position:(null==r?void 0:r.position)||null,labelWidth:(null==r?void 0:r.labelWidth)||null,editorRect:e.editorRect})})},key:"multiplayer-cursors-plugin-".concat((0,L.v4)())};return{update:function(r){r.transactions.length&&(i=Date.now());var o=r.state.field(N.multiplayerCursorField,!1);if(o===r.startState.field(N.multiplayerCursorField,!1)){r.geometryChanged&&s();return}var l=new Map,u=new Set;if(o){var c=new Map((0,M._)(n.values()).map(function(e){return[e.cursor.id,e.view]}));Object.values(o).forEach(function(t){var n=c.get(t.id);if(n)u.add(n),l.set(t.id,{view:n,cursor:t});else{var r=$(t);l.set(t.id,{view:r,cursor:t}),e.dom.appendChild(r.dom)}})}n.forEach(function(e){u.has(e.view)||e.view.dom.remove()}),n=l,t=o,a(),s()},destroy:function(){window.removeEventListener("resize",u),n.forEach(function(e){e.view.dom.remove()}),t=void 0,n=new Map,null==o||o.disconnect(),l&&clearTimeout(l)},maybeMeasure:s}},{eventHandlers:{scroll:function(){this.maybeMeasure()}}})],W=function(){function e(t,n,r,i){var o=this;(0,a._)(this,e),(0,l._)(this,"view",void 0),(0,l._)(this,"colors",void 0),(0,l._)(this,"disposes",void 0),(0,l._)(this,"destroyed",void 0),(0,l._)(this,"updateSelections",void 0),this.view=t,this.destroyed=!1,this.colors=this.getColorMapFromUsers(i.getActiveUsers()),this.disposes=[],this.updateSelections=null,this.disposes.push(i.onUserLeave(function(e){o.destroyed||o.view.dispatch({effects:N.userLeaveEffect.of(e.username)})}),i.onActiveUsersChange(function(e){o.destroyed||(o.colors=o.getColorMapFromUsers(e))}),r.watchTextFile(n,{onReady:function(e){var t=e.updateSelections;o.destroyed||(o.updateSelections=t)},onCursor:function(e){if(!o.destroyed){var t=(0,N.addCursor)({cursor:e,usernameColorsMap:o.colors});t&&o.view.dispatch({effects:t})}},onRemoveCursor:function(e){o.destroyed||o.view.dispatch({effects:N.removeCursorEffect.of(e)})},onError:function(){o.updateSelections=null},onMoveOrDelete:function(){o.updateSelections=null}}))}return(0,s._)(e,[{key:"getColorMapFromUsers",value:function(e){return e.reduce(function(e,t){return t.username&&t.color?(0,c._)((0,u._)({},e),(0,l._)({},t.username,t.color)):e},{})}},{key:"postUpdate",value:function(e){if(!(!e.selectionSet||e.transactions.every(function(e){return e.annotation(f.Transaction.remote)}))&&this.updateSelections){var t=e.state.selection.ranges.map(function(e){return{position:e.head,selectionStart:e.from,selectionEnd:e.to}});this.updateSelections(t)}}},{key:"destroy",value:function(){this.destroyed=!0,this.disposes.forEach(function(e){return e()})}}]),e}(),q=new m.ReactCompartment(function(e,t,n){return[H,N.multiplayerCursorField,p.ViewPlugin.define(function(r){return new W(r,e,t,n)},{provide:function(e){return p.EditorView.updateListener.of(function(t){var n;return null==(n=t.view.plugin(e))?void 0:n.postUpdate(t)})}})]}),K=e.i(703613);function Y(e){var t,n=e.view,a=e.presence,s=e.fs,l=e.filePath,u=e.performPaneOperation,c=q.use(l,s,a),d=o.ObservationModeCompartment.use(a),f=O({filePath:l,fs:s,performPaneOperation:u}),p=null==(t=(0,K.useCodeMirrorValue)(n,i.Initializing))||t,h=(0,r.useMemo)(function(){return[f,c,d]},[f,c,d]);return(0,r.useMemo)(function(){return{isLoading:p,extensions:h}},[p,h])}e.s(["useMultiplayer",()=>Y],755224);var Q=e.i(47685),X=e.i(736097),J=e.i(205104),Z=e.i(297083),ee=e.i(817556),et=e.i(995683),en=e.i(386594),er=e.i(240913),ei=RegExp("_(?<num>\\d+)$"),eo=function(e,t,n){return(0,Z._)(function(){var r,i,o,a,s,l;return(0,ee._)(this,function(u){switch(u.label){case 0:var c;return r=encodeURI(e.name),[4,(c=(i=(0,J.getParentPath)(n))?i+"/"+r:r,(0,Z._)(function(){var e,n,r,i;return(0,ee._)(this,function(o){switch(o.label){case 0:return e=(0,J.getParentPath)(c),[4,t.readDir(e||er.ROOT_PATH)];case 1:if((n=o.sent()).error)return[2,c];return i=(r=function(e){if(n.children.find(function(t){return"FILE"===t.type&&t.filename===e})){var t,i=(0,J.getBaseName)(e),o=(0,J.getExt)(e),a=i.match(ei);if(null==a||null==(t=a.groups)?void 0:t.num){var s=Number(a.groups.num);return r("".concat(i.replace(ei,""),"_").concat(s+1,".").concat(o))}return r("".concat(i,"_2.").concat(o))}return e})((0,J.getFileName)(c)),[2,e?e+"/"+i:i]}})})())];case 1:return o=u.sent(),[4,(0,en.readFileAsArrayBuffer)(e)];case 2:return a=u.sent(),[4,t.writeFile(o,et.default.from(a))];case 3:return u.sent(),s=(0,J.getBaseName)(e.name),l=(0,J.getFileName)(o),[2,"![".concat(s,"](").concat(l,")")]}})})()};function ea(e){var t=e.view,n=e.event,r=e.clipboardText,i=e.filePath,o=t.state.selection;if(!i||!(0,J.isMarkdownFile)(i)||o.ranges.length>1||o.main.from===o.main.to||!r||!(0,Q.default)(r))return void function(){if(!n){var e=r||"";if(o.main.empty){var i=o.main.from+e.length;t.dispatch({changes:[{from:o.main.from,insert:e}],selection:f.EditorSelection.range(i,i)})}else t.dispatch(t.state.replaceSelection(e))}}();n&&n.preventDefault();var a=t.state.sliceDoc(o.main.from,o.main.to),s="[".concat(a,"](").concat(r,")"),l=o.main.from+s.length;t.dispatch({changes:{from:o.main.from,to:o.main.to,insert:s},selection:f.EditorSelection.range(l,l)})}e.s(["uploadImageAndGetMDCode",()=>eo],545915);var es=p.EditorView.domEventHandlers({paste:function(e,t){var n;ea({filePath:t.state.facet(X.fileName),view:t,event:e,clipboardText:null==(n=e.clipboardData)?void 0:n.getData("Text")})}}),el=new m.ReactCompartment(function(e){return p.EditorView.domEventHandlers({paste:function(t,n){var r=n.state.facet(X.fileName),i=null==t||null==(u=t.clipboardData)?void 0:u.files,o=function(e){var t=n.state.selection.main.head;n.dispatch({changes:{from:t,insert:e},selection:{anchor:t,head:t+e.length}})};if(i){var a=!0,s=!1,l=void 0;try{for(var u,c,d=i[Symbol.iterator]();!(a=(c=d.next()).done);a=!0){var f=c.value;r&&(0,J.isMarkdownFile)(r)&&eo(f,e,r).then(o)}}catch(e){s=!0,l=e}finally{try{a||null==d.return||d.return()}finally{if(s)throw l}}}}})});e.s(["PasteImgCompartment",()=>el,"PasteLink",()=>es,"handlePasteEvent",()=>ea],335392);var eu=e.i(399119),ec=e.i(445789),ed=e.i(167626),ef=e.i(305027),ep=e.i(445735),eh=e.i(858248),eg=e.i(709485),em=function(e){function t(e,n){var r;return(0,a._)(this,t),r=(0,eu._)(this,t),(0,l._)(r,"id",void 0),(0,l._)(r,"result",void 0),r.id=e,r.result=n,r}return(0,ec._)(t,e),(0,s._)(t,null,[{key:"range",value:function(e,t,n){return new this(e,n).range(t.from,t.to)}},{key:"generateId",value:function(){return this.secretId++}}]),t}(f.RangeValue);(0,l._)(em,"secretId",0);var ev=function(e){function t(e){var n;return(0,a._)(this,t),n=(0,eu._)(this,t),(0,l._)(n,"key",void 0),n.key=e,n}return(0,ec._)(t,e),(0,s._)(t,null,[{key:"from",value:function(e){return new this(e)}}]),t}(f.RangeValue),ex=f.StateEffect.define({map:function(e,t){var n=f.RangeSet.of(e).map(t).iter(),r=n.from,i=n.to;return em.range(e.value.id,f.EditorSelection.cursor(r,i),e.value.result)}}),ey=f.StateEffect.define(),eb=f.StateEffect.define(),ew=f.StateEffect.define(),ek=f.StateEffect.define(),e_=f.StateEffect.define(),eS=function(e){var t=e.state.field(eA);if(!t.size)return!1;for(var n=t.iter(),r=[];n.value;){var i=n.from,o=n.to,a=n.value;r.push({from:i,to:o,value:a}),n.next()}var s=e.state.doc.length,l=f.ChangeSet.empty(s),u=[],c=[],d=!0,p=!1,h=void 0;try{for(var g,m=r[Symbol.iterator]();!(d=(g=m.next()).done);d=!0)!function(){var e=g.value,t=e.from,n=e.to,r=e.value,i=r.result.secret,o=f.ChangeSet.of({from:t,to:n,insert:i},s).map(l,!0);u=u.map(function(e){return e.map(o)});var a=(l=l.compose(o)).mapPos(t)+i.length;u.push(f.EditorSelection.cursor(a)),c.push(ey.of(r.id)),(0,eh.track)(eg.events.PASTE_SCANNER_USED,{action:"original_accepted",provider:r.result.provider})}()}catch(e){p=!0,h=e}finally{try{d||null==m.return||m.return()}finally{if(p)throw h}}return e.dispatch({changes:l,effects:c,selection:f.EditorSelection.create(u)}),!0},eC=function(e){return!!e.state.field(eA).size&&(e.dispatch({effects:e.state.selection.ranges.map(function(e){return eb.of(e)})}),!0)},ej=function(){return!1},eT=function(e){return!!e.state.field(eA).size&&(e.dispatch({effects:e.state.selection.ranges.map(function(e){return ey.of(e)})}),!0)};function eE(e,t){var n,r=null==(n=e.clipboardData)?void 0:n.getData("text/plain");if(!r)return!1;var i=(0,ep.scan)(r);if(!i)return!1;e.preventDefault(),e.stopPropagation();var o=r.slice(0,i.start)+r.slice(i.end),a=em.generateId();return t.dispatch((0,c._)((0,u._)({},t.state.changeByRange(function(e){var t=e.from,n=e.to,r=f.EditorSelection.cursor(t+i.start);return{range:r,changes:{from:t,to:n,insert:o},effects:ex.of(em.range(a,r,i))}})),{scrollIntoView:!0})),(0,eh.track)(eg.events.PASTE_SCANNER_USED,{action:"secret_detected",provider:i.provider}),!0}var eR=f.StateField.define({create:function(){return f.RangeSet.empty},update:function(e,t){e=e.map(t.changes);var n=!0,r=!1,i=void 0;try{for(var o,a=t.effects[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var s=o.value;if(s.is(ek)){var l=s.value,u=l.from,c=l.to,d=l.secret;e=e.update({add:[ev.from(d).range(u,c)],filter:function(){return!1}})}s.is(e_)&&(e=f.RangeSet.empty)}}catch(e){r=!0,i=e}finally{try{n||null==a.return||a.return()}finally{if(r)throw i}}return e}}),eI=f.StateField.define({create:function(){return null},update:function(e,t){var n=t.state.field(eA,!1),r=!0,i=!1,o=void 0;try{for(var a,s=t.effects[Symbol.iterator]();!(r=(a=s.next()).done);r=!0){var l=a.value;n&&l.is(eb)&&((0,ed._)(l.value,f.SelectionRange)?n.between(l.value.from,l.value.to,function(t,n,r){e=r}):e=l.value),l.is(ew)&&(e=null)}}catch(e){i=!0,o=e}finally{try{r||null==s.return||s.return()}finally{if(i)throw o}}return e}}),eA=f.StateField.define({create:function(){return f.RangeSet.empty},update:function(e,t){e=e.map(t.changes);var n=!0,r=!1,i=void 0;try{for(var o,a=t.effects[Symbol.iterator]();!(n=(o=a.next()).done);n=!0)!function(){var t=o.value;t.is(ex)&&(e=e.update({add:[t.value],sort:!0})),t.is(ey)&&(e=(0,ed._)(t.value,f.SelectionRange)?e.update({filter:function(){return!1},filterFrom:t.value.from,filterTo:t.value.to}):e.update({filter:function(e,n,r){return r.id!==t.value}}))}()}catch(e){r=!0,i=e}finally{try{n||null==a.return||a.return()}finally{if(r)throw i}}return e},provide:function(){return[p.EditorView.domEventHandlers({paste:eE}),f.Prec.highest(p.keymap.of([{key:"Mod-z",run:eT},{key:"Enter",run:eS},{key:"Tab",run:eC,stopPropagation:!0},{key:"Escape",run:ej}]))]}}),eP=ef.ShouldSuppressCompleteCode.of(function(e){var t=e.state.field(eA,!1);if(!t||!t.size)return!1;var n=!1;return t.between(e.newSelection.main.from,e.newSelection.main.to,function(){return n=!0,!1}),n});e.s(["CloseModal",()=>ew,"HideSnippetPocket",()=>e_,"OpenModal",()=>eb,"PasteModalState",()=>eI,"PasteScannerState",()=>eA,"RemovePendingSecret",()=>ey,"SecretSnippetState",()=>eR,"ShowSnippetPocket",()=>ek,"SuppressCompleteCodeWhenSecretsPresent",()=>eP,"onAcceptOriginal",()=>eS],140659);var eD=e.i(119468),eO=e.i(242131),eN=e.i(684481),eM=e.i(530658),eL=e.i(921211),eB=e.i(529810),eV=e.i(140487),eF=e.i(136540),eU=e.i(607278),eG=e.i(739521),e$=e.i(960178),ez=e.i(625484),eH=e.i(841691),eW=e.i(90102),eq=(0,S.cssRecord)({buttons:[C.rcss.display.flex,C.rcss.rowWithGap(4),C.rcss.justify.end],input:[C.rcss.colWithGap(4),C.rcss.flex.grow(1)],label:[C.rcss.color.foregroundDimmer,C.rcss.fontSize(12),C.rcss.height(24),C.rcss.justify.center],flexRow:[C.rcss.display.flex,C.rcss.rowWithGap(8),C.rcss.align.center]}),eK={fontFamily:"text-security-disc"},eY=ez.SpecializedView.label;function eQ(e){var t=(0,eB.default)().secrets,n=(0,r.useId)(),i=(0,r.useId)(),o=(0,eM._)((0,r.useState)(""),2),a=o[0],s=o[1],l=(0,eM._)((0,r.useState)(e.initialValue),2),u=l[0],c=l[1],f=(0,eM._)((0,r.useState)(!1),2),p=f[0],h=f[1],g=(0,r.useRef)(null);return(0,r.useEffect)(function(){if(e.isOpen){var t;null==(t=g.current)||t.focus(),(0,eh.track)(eg.events.PASTE_SCANNER_USED,{action:"modal_opened",provider:null==e?void 0:e.provider})}},[e.isOpen,null==e?void 0:e.provider]),(0,d.jsx)(eL.FocusScope,{contain:!0,children:(0,d.jsx)(eG.Modal,{isOpen:e.isOpen,onRequestClose:e.onCancel,children:(0,d.jsxs)(ez.View,{gap:16,children:[(0,d.jsx)(e$.Text,{variant:"subheadBig",multiline:!1,children:"Add a key name for your secret value"}),(0,d.jsxs)(ez.View,{css:eq.flexRow,children:[(0,d.jsxs)(ez.View,{css:eq.input,children:[(0,d.jsx)(eY,{css:eq.label,htmlFor:n,children:"Key"}),(0,d.jsx)(eU.Input,{id:n,ref:g,value:a,onChange:function(e){return s(e.target.value)}})]}),(0,d.jsxs)(ez.View,{css:eq.input,children:[(0,d.jsxs)(ez.View,{css:eq.flexRow,children:[(0,d.jsx)(eY,{css:eq.label,htmlFor:i,children:"Value"}),(0,d.jsx)(eF.IconButton,{alt:"Toggle Secret",onClick:function(){return h(function(e){return!e})},tooltipPlacement:"top",children:p?(0,d.jsx)(eW.default,{}):(0,d.jsx)(eH.default,{})})]}),(0,d.jsx)(eU.Input,{id:i,value:u,onChange:function(e){return c(e.target.value)},style:p?void 0:eK})]})]}),(0,d.jsxs)(ez.View,{css:eq.buttons,children:[(0,d.jsx)(eV.Button,{text:"Cancel",onClick:e.onCancel}),(0,d.jsx)(eV.Button,{colorway:"primary",text:"Save Secret",disabled:0===a.length||0===u.length,onClick:function(){return(0,Z._)(function(){return(0,ee._)(this,function(n){switch(n.label){case 0:return[4,t.addEntries([{key:a,value:u}])];case 1:return n.sent(),e.onSaveSecret(a,u),(0,eh.track)(eg.events.PASTE_SCANNER_USED,{action:"secret_created",provider:null==e?void 0:e.provider}),[2]}})})()}})]})]})})})}e.i(32109);var eX=e.i(926118),eJ=e.i(530310),eZ=e.i(42458),e0=(0,S.cssRecord)({hint:[C.rcss.align.center,C.rcss.border({color:B.tokens.outlineDimmer,direction:"top"}),C.rcss.color.foregroundDimmest,C.rcss.display.flex,C.rcss.flex.row,C.rcss.px(8),C.rcss.py(4),C.rcss.rowWithGap(8)],key:[C.rcss.px(4)],wrapper:[C.rcss.backgroundColor.backgroundHigher,C.rcss.borderRadius(4),C.rcss.cursor.default,C.rcss.font.default],mobileButtons:[C.rcss.flex.grow(1)],mobileHint:[C.rcss.justify.center]}),e1={borderTop:"1px solid ".concat(B.tokens.outlineDimmer),borderBottom:"1px solid ".concat(B.tokens.outlineDimmer),borderRadius:0};function e2(e){return(0,d.jsxs)(ez.View,{css:e0.wrapper,style:e.onMobile?e1:void 0,children:[(0,d.jsxs)(ez.View,{p:8,style:{textAlign:e.onMobile?"center":"inherit"},children:[(0,d.jsx)(ez.View,{children:"The value you pasted looks like a secret."}),(0,d.jsx)(ez.View,{children:"Store it securely using our Secrets feature."})]}),e.onMobile?(0,d.jsx)(e4,(0,u._)({},e)):(0,d.jsx)(e3,(0,u._)({},e))]})}function e3(e){return(0,d.jsxs)(d.Fragment,{children:[(0,d.jsxs)(ez.View,{css:e0.hint,onClick:e.onClickUseSecrets,children:[(0,d.jsx)(eJ.default,{}),"Press",(0,d.jsx)(ez.View,{css:e0.key,children:(0,d.jsx)(eX.KeyComboBlocks,{keyCombo:"Tab",small:!0})}),"to use Secrets"]}),(0,d.jsxs)(ez.View,{css:e0.hint,onClick:e.onClickPasteAnyway,children:[(0,d.jsx)(eZ.default,{}),"Press",(0,d.jsx)(ez.View,{css:e0.key,children:(0,d.jsx)(eX.KeyComboBlocks,{keyCombo:"Enter",small:!0})}),"to paste anyway"]})]})}function e4(e){return(0,d.jsxs)(ez.View,{css:[e0.hint,e0.mobileHint],children:[(0,d.jsx)(eV.Button,{css:e0.mobileButtons,iconLeft:(0,d.jsx)(eJ.default,{}),text:"Use Secrets",onClick:e.onClickUseSecrets,colorway:"primary"}),(0,d.jsx)(eV.Button,{css:e0.mobileButtons,iconLeft:(0,d.jsx)(eZ.default,{}),text:"Paste Anyway",onClick:e.onClickPasteAnyway})]})}function e8(e){(0,r.useEffect)(function(){var t=function(t){"Escape"===t.key&&e(t)};return window.addEventListener("keydown",t),function(){window.removeEventListener("keydown",t)}},[e])}e.s(["default",()=>e8],395787);var e5=e.i(12291),e6=e.i(929872),e9=e.i(283110),e7=(0,S.cssRecord)({border:[C.rcss.border({color:B.tokens.accentPrimaryDefault,direction:"y",width:1})],title:[C.rcss.display.flex,C.rcss.rowWithGap(8),C.rcss.align.center,C.rcss.justify.spaceBetween,C.rcss.px(8),C.rcss.pt(4),C.rcss.font.default],wrapper:[C.rcss.backgroundColor.backgroundRoot,C.rcss.py(0),C.rcss.position.relative,C.rcss.zIndex(200)]});function te(e){return e8(e.onClose),(0,d.jsx)(eL.FocusScope,{autoFocus:!0,children:(0,d.jsx)(ez.View,{css:e7.wrapper,children:(0,d.jsxs)(ez.View,{css:e7.border,children:[(0,d.jsxs)(ez.View,{css:e7.title,children:[(0,d.jsxs)(e$.Text,{multiline:!1,children:["Access the secret ",(0,d.jsx)("strong",{children:e.keyName}),":"]}),(0,d.jsx)(eF.IconButton,{alt:"Close",onClick:e.onClose,children:(0,d.jsx)(e9.default,{})})]}),(0,d.jsx)(e6.Surface,{background:"root",children:(0,d.jsx)(e5.default,{keyName:e.keyName,filePath:e.filePath,onInsert:e.onInsert})})]})})})}var tt=e.i(928353),tn=e.i(74920),tr=eO.GhostText.compute([eA],function(e){var t=e.field(eA).iter();if(null===t.value)return null;for(var n=[];null!==t.value;){var r=t.from,i=t.to,o=t.value;n.push({from:r,to:i,insert:o.result.secret}),t.next()}return n}),ti=function(e){function t(e,n){var r;return(0,a._)(this,t),r=(0,eu._)(this,t),(0,l._)(r,"secret",void 0),(0,l._)(r,"as",void 0),r.secret=e,r.as=n,r}return(0,ec._)(t,e),(0,s._)(t,[{key:"toDOM",value:function(e){var t=this,n=(0,tt.createCodeMirrorElement)((0,d.jsx)(e2,{onMobile:"pocket"===this.as,onClickUseSecrets:function(){e.dispatch({effects:eb.of(t.secret)})},onClickPasteAnyway:function(){eS(e),e.focus()},onClickUndo:function(){e.dispatch({effects:ey.of(t.secret.id)}),e.focus()}}));return"pocket"===this.as&&(n.style.zIndex="200",n.style.position="relative",this.adjustForGutter(n,e)),n}},{key:"updateDOM",value:function(e,t){return this.adjustForGutter(e,t),!0}},{key:"adjustForGutter",value:function(e,t){var n=t.dom.querySelector(".cm-gutters");e.style.marginLeft=n?"-".concat(n.clientWidth,"px"):"inherit"}}]),t}(p.WidgetType),to=tn.MountedReactNodes.compute([eI],function(e){var t=e.facet(X.fileName),n=e.field(eI);return n&&t?{key:"pasteScannerModal",node:function(e){return(0,d.jsx)(eQ,{isOpen:!0,initialValue:n.result.secret,provider:n.result.provider,onSaveSecret:function(t){return(0,Z._)(function(){var r,i,o,a,s;return(0,ee._)(this,function(l){for(r=e.state.field(eA).iter(),i=[];r.value;)o=r.from,a=r.to,(s=r.value).id===n.id&&(i.push(ey.of(s.id)),i.push(ek.of({secret:t,from:o,to:a}))),r.next();return e.dispatch({effects:(0,M._)(i).concat([ew.of(null)])}),[2]})})()},onCancel:function(){return e.dispatch({effects:ew.of(null)})}})}}:null}),ta=p.EditorView.decorations.compute([eR],function(e){var t=e.field(eR).iter(),n=t.from,r=t.to,i=t.value,o=e.facet(X.fileName);return i&&o?p.Decoration.set(p.Decoration.widget({widget:new ts(i.key,o),side:1,block:!0}).range(n,r)):p.Decoration.none}),ts=function(e){function t(e,n){var r;return(0,a._)(this,t),r=(0,eu._)(this,t),(0,l._)(r,"key",void 0),(0,l._)(r,"filePath",void 0),r.key=e,r.filePath=n,r}return(0,ec._)(t,e),(0,s._)(t,[{key:"toDOM",value:function(e){var t=(0,tt.createCodeMirrorElement)((0,d.jsx)(te,{keyName:this.key,filePath:this.filePath,onClose:function(){return e.dispatch({effects:e_.of(null)})},onInsert:function(t){e.dispatch(e.state.changeByRange(function(e){return{range:f.EditorSelection.cursor(e.from+t.length),changes:{from:e.from,to:e.to,insert:t}}})),e.focus(),(0,eh.track)(eg.events.PASTE_SCANNER_USED,{action:"secret_key_inserted"})}}));return this.adjustForGutter(t,e),t}},{key:"updateDOM",value:function(e,t){return this.adjustForGutter(e,t),!0}},{key:"adjustForGutter",value:function(e,t){var n=t.dom.querySelector(".cm-gutters");e.style.marginLeft=n?"-".concat(n.clientWidth,"px"):"inherit"}}]),t}(p.WidgetType),tl=[tr,(t=[eI,eA],n=function(e){if(null!=e.field(eI,!1))return null;var t=e.field(eA,!1);return t||null},[p.showTooltip.compute(t,function(e){var t=n(e);if(!t||e.facet(eN.IsMobile))return null;for(var r=t.iter();r.value;){var i=function(){var e=new ti(r.value,"tooltip");return{v:{arrow:!0,pos:r.to,create:function(t){return{dom:e.toDOM(t)}}}}}();if("object"===(0,eD._)(i))return i.v}return null}),p.EditorView.decorations.compute(t,function(e){var t=n(e);if(!t||!e.facet(eN.IsMobile))return p.Decoration.none;var r=t.iter();if(!r.value)return p.Decoration.none;for(;r.value;){var i=new ti(r.value,"pocket");return p.Decoration.set(p.Decoration.widget({widget:i,side:1,block:!0}).range(r.to,r.to))}return p.Decoration.none})]),to,ta],tu=[eR,eA,eI,tl,eP];e.s(["pasteScannerExtension",()=>tu],507966);var tc=e.i(664152);function td(e,t){var n=performance.now();tc.logger.time(e,n-t)}var tf=new m.ReactCompartment(function(e){var t=e?.01:.001;return f.Prec.highest(p.EditorView.domEventHandlers({keydown:function(e){if(Math.random()<t){var n=e.timeStamp;requestAnimationFrame(function(){td("editor input latency",n),"undefined"!=typeof requestIdleCallback?requestIdleCallback(function(){td("editor input latency after layout",n)}):setTimeout(function(){td("editor input latency after layout",n)})})}}}))});e.s(["MeasureInputLatencyCompartment",()=>tf],427469);var tp=f.StateField.define({create:function(){return null},update:function(e,t){var n=!0,r=!1,i=void 0;try{for(var o,a=t.effects[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var s=o.value;if(s.is(th))return s.value}}catch(e){r=!0,i=e}finally{try{n||null==a.return||a.return()}finally{if(r)throw i}}if(!e)return null;if(!t.changes.empty){var l=t.changes.mapPos(e.pos,-1,f.MapMode.TrackDel),u=t.changes.mapPos(e.pos+e.text.length,-1,f.MapMode.TrackDel);return null===l||null===u||t.newDoc.sliceString(l,u)!==e.text?null:Object.assign(Object.assign({},e),{pos:l})}return e},provide:function(e){return[p.EditorView.decorations.from(e,function(e){if(!e)return p.Decoration.none;var t=e.pos,n=e.pos+e.text.length,r=e.rule.className;return p.Decoration.set(tg({className:r}).range(t,n))}),p.EditorView.contentAttributes.from(e,function(e){return e&&e.rule.cursor?{style:"cursor: ".concat(e.rule.cursor)}:{style:""}})]}}),th=f.StateEffect.define(),tg=function(e){var t;return p.Decoration.mark({class:"cm-interact ".concat(null!=(t=null==e?void 0:e.className)?t:"")})},tm=p.EditorView.theme({".cm-interact":{background:"rgba(128, 128, 255, 0.2)",borderRadius:"4px"}}),tv=f.Facet.define(),tx=f.Facet.define({combine:function(e){return e[e.length-1]}}),ty=p.ViewPlugin.define(function(e){return{target:null,dragging:!1,mouseX:0,mouseY:0,getMatch:function(){var t=e.state.facet(tv),n=e.posAtCoords({x:this.mouseX,y:this.mouseY});if(!n)return null;var r=e.state.doc.lineAt(n),i=n-r.from,o=null,a=!0,s=!1,l=void 0;try{for(var u,c=t[Symbol.iterator]();!(a=(u=c.next()).done);a=!0){var d=u.value,f=!0,p=!1,h=void 0;try{for(var g,m=r.text.matchAll(d.regexp)[Symbol.iterator]();!(f=(g=m.next()).done);f=!0){var x=g.value;if(void 0!==x.index){var y=x[0];if(y){var b=x.index,w=x.index+y.length;i<b||i>w||(!o||y.length<o.text.length)&&(o={rule:d,pos:r.from+b,text:y})}}}}catch(e){p=!0,h=e}finally{try{f||null==m.return||m.return()}finally{if(p)throw h}}}}catch(e){s=!0,l=e}finally{try{a||null==c.return||c.return()}finally{if(s)throw l}}return o},updateText:function(t){return function(n){e.dispatch({effects:th.of(Object.assign(Object.assign({},t),{text:n})),changes:{from:t.pos,to:t.pos+t.text.length,insert:n}})}},setTarget:function(t){this.target=t,e.dispatch({effects:th.of(t)})},isModKeyDown:function(t){var n=e.state.facet(tx),r=!!window.navigator&&window.navigator.userAgent.includes("Macintosh");switch(n){case"alt":return t.altKey;case"shift":return t.shiftKey;case"ctrl":return t.ctrlKey;case"meta":return t.metaKey;case"mod":return r?t.metaKey:t.ctrlKey}throw Error("Invalid mod key: ".concat(n))},update:function(e){var t=e.state.field(tp,!1);void 0!==t&&this.target!==t&&(this.target=t,null===t&&this.endDrag())},startDrag:function(e){this.dragging||!this.target||(this.dragging=!0,this.target.rule.onDragStart&&this.target.rule.onDragStart(this.target.text,this.updateText(this.target),e))},endDrag:function(){var e;!this.dragging||(this.dragging=!1,(null==(e=this.target)?void 0:e.rule.onDragEnd)&&this.target.rule.onDragEnd(this.target.text,this.updateText(this.target)))}}},{eventHandlers:{mousedown:function(e,t){var n=this;!this.isModKeyDown(e)||this.target&&(e.preventDefault(),this.target.rule.onClick&&this.target.rule.onClick(this.target.text,function(e){n.target&&n.updateText(n.target)(e)},e),this.target.rule.onDrag&&this.startDrag(e))},mousemove:function(e,t){if(this.mouseX=e.clientX,this.mouseY=e.clientY,!this.isModKeyDown(e)){this.target&&this.setTarget(null);return}this.target&&this.dragging?this.target.rule.onDrag&&this.target.rule.onDrag(this.target.text,this.updateText(this.target),e):this.setTarget(this.getMatch())},mouseup:function(e,t){this.endDrag(),this.target&&!this.isModKeyDown(e)&&this.setTarget(null),this.isModKeyDown(e)&&this.setTarget(this.getMatch())},mouseleave:function(e,t){this.endDrag(),this.target&&this.setTarget(null)},keydown:function(e,t){!this.target&&this.isModKeyDown(e)&&this.setTarget(this.getMatch())},keyup:function(e,t){this.target&&!this.isModKeyDown(e)&&(this.endDrag(),this.setTarget(null))}}}),tb=function(){var e,t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return[tp,tm,ty,tx.of(null!=(e=n.key)?e:"alt"),(null!=(t=n.rules)?t:[]).map(function(e){return tv.of(e)})]},tw=[{regexp:/https?:\/\/[^\s)"']+/g,cursor:"pointer",onClick:function(e){(0,Q.default)(e)&&window.open(e,"_blank")}}],tk=new m.ReactCompartment(function(e){return e?null:tb({key:"mod",rules:tw})});e.s(["InteractCompartment",()=>tk],930925);var t_=e.i(316699),tS=new Set,tC=(0,t_.default)(function(){var e=!0,t=!1,n=void 0;try{for(var r,i=tS[Symbol.iterator]();!(e=(r=i.next()).done);e=!0){var o=r.value;(0,eh.track)(eg.events.WS_TYPED,{fileExt:o})}}catch(e){t=!0,n=e}finally{try{e||null==i.return||i.return()}finally{if(t)throw n}}tS.clear()},18e4),tj=p.EditorView.updateListener.of(function(e){if(e.docChanged){var t=e.state.facet(X.fileName);if(t){var n=(0,J.getExt)(t)||(0,J.getFileName)(t);!e.transactions.some(function(e){return e.annotation(f.Transaction.remote)})&&(tS.has(n)||(tS.add(n),tC()))}}});e.s(["TrackOnTypeExtension",()=>tj],194536);var tT=e.i(210736),tE=p.EditorView.theme({".cm-ruler-element":{backgroundColor:B.tokens.backgroundHigher}}),tR=f.StateField.define({create:function(e){return 0===e.doc.length},update:function(e,t){return t.docChanged?0===t.state.doc.length:e}}),tI=(0,p.layer)({above:!1,class:"cm-ruler-layer",update:function(e){return(0,h.hasChanged)(e,tA,tR,tT.resizeEditor)},markers:function(e){if(e.state.field(tR,!1))return[];var t=e.state.facet(tA);if(0===t.length)return[];var n=[],r=e.dom.getBoundingClientRect(),i=e.contentDOM.getBoundingClientRect().left-r.left+6,o=r.width-2,a=Math.max(r.height,e.contentHeight),s=!0,l=!1,u=void 0;try{for(var c,d=t[Symbol.iterator]();!(s=(c=d.next()).done);s=!0){var f=c.value,h=i+e.defaultCharacterWidth*f;h<o&&n.push(new p.RectangleMarker("cm-ruler-element",h,0,2,a))}}catch(e){l=!0,u=e}finally{try{s||null==d.return||d.return()}finally{if(l)throw u}}return n}}),tA=f.Facet.define({enables:[tR,tI,tE]}),tP=new m.ReactCompartment(function(e){return e.map(function(e){return tA.of(e)})});e.s(["RulersCompartment",()=>tP],275465);var tD=e.i(502674),tO=e.i(317377),tN=e.i(885970),tM=e.i(299865),tL=e.i(738324),tB=e.i(88892),tV=p.EditorView.theme({"& .cm-scrollbar-gutter":{backgroundColor:B.tokens.backgroundDefault},"& .cm-scrollbar-inner":{borderColor:B.tokens.backgroundHigher}}),tF=new m.ReactCompartment(function(e,t){return e?null:[tV,tD.showScrollbar.of({create:function(){return{dom:document.createElement("div")}}}),tO.LaneFacet.compute(["doc",tL.GutterDiffState],function(e){var n=e.field(tL.GutterDiffState,!1);if(!n)return null;for(var r=[],i=1;i<=e.doc.lines;i++)switch(n.getLineChangeType(i)){case tB.LineChangeType.COVERED:r.push({number:i,color:t.values.global.greenDefault,zIndex:1});break;case tB.LineChangeType.MODIFIED:r.push({number:i,color:t.values.global.blueDefault,zIndex:0})}return r}),(0,tN.lintLines)(),(0,tM.selectionLines)({color:t.values.global.foregroundDefault})]});function tU(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1e3;if(!e.valid)return[];for(var r=[],i=e.getCursor(t),o=i.next();!o.done&&r.length<n;)r.push(o.value),o=i.next();return r}e.s(["SemanticScrollbarCompartment",()=>tF],925565),e.s(["default",()=>tU],548440)},770781,518975,705414,714330,351278,260480,e=>{"use strict";var t,n=e.i(223808),r=e.i(672199),i=e.i(753950),o=e.i(179302);e.i(508987);var a=e.i(457103),s=e.i(530658),l=e.i(276385),u=e.i(389959),c=e.i(928353),d=e.i(548440),f=e.i(98816),p=e.i(649960),h=e.i(670413),g=e.i(551959),m=e.i(294751),x=e.i(480028),y=e.i(446530),b=e.i(613355),w=e.i(140487),k=e.i(136540),_=e.i(607278),S=e.i(929872),C=e.i(960178),j=e.i(625484),T=e.i(542932),E=e.i(782096),R=e.i(283110),I=e.i(597512),A=e.i(874721);function P(e){return e>420?"large":"small"}var D=j.SpecializedView.div,O=(0,y.cssRecord)({root:[{borderBottom:"1px solid",borderColor:x.tokens.outlineDimmest}],panelButtonWrapper:[b.rcss.center,b.rcss.height(32)],content:[b.rcss.display.grid,b.rcss.flex.growAndShrink(1),{gridTemplateAreas:'"search search-controls"',gridTemplateRows:"1fr",gridTemplateColumns:"1fr max-content",gap:x.tokens.space8}],contentExpanded:[{gridTemplateAreas:'"search search-controls" "replace replace-controls"',gridTemplateRows:"1fr 1fr",gridTemplateColumns:"1fr max-content"}],contentExpandedSmall:[{gridTemplateAreas:'"search" "search-controls" "replace" "replace-controls"',gridTemplateRows:"1fr max-content 1fr max-content",gridTemplateColumns:"1fr"}],contentSmall:[{gridTemplateAreas:'"search" "search-controls"',gridTemplateRows:"1fr max-content",gridTemplateColumns:"1fr"}],matchLabel:[b.rcss.position.absolute,b.rcss.top(0),b.rcss.right(0),b.rcss.height("100%"),b.rcss.center,b.rcss.pr(4)],searchInputWrapper:[b.rcss.position.relative,{gridArea:"search"}],searchControls:[b.rcss.display.flex,b.rcss.align.center,b.rcss.rowWithGap(8),b.rcss.flex.wrap,{gridArea:"search-controls"}],replaceInputWrapper:[{gridArea:"replace"}],replaceControls:[b.rcss.display.flex,b.rcss.align.center,b.rcss.rowWithGap(8),b.rcss.flex.wrap,{gridArea:"replace-controls"}],searchSettings:b.rcss.flex.row});function N(e){var t=(0,u.useRef)(null);return(0,u.useEffect)(function(){if(t.current){var n;e!==(null==(n=t.current)?void 0:n.value)&&(t.current.value=e)}},[e]),t}var M=new c.CodeMirrorComponent((0,u.forwardRef)(function(e,t){var n=e.view,i=e.query,a=e.updateQuery,c=(0,s._)((0,u.useState)(!1),2),x=c[0],y=c[1],b=(0,s._)((0,u.useState)([]),2),M=b[0],L=b[1],B=(0,s._)((0,u.useState)(null),2),V=B[0],F=B[1],U=M.length,G=(0,f.default)(i),$=(0,f.default)(M),z=N(i.search),H=N(i.replace);function W(){(0,r.findNext)(n);var e=n.state.selection.main;n.dispatch({effects:o.EditorView.scrollIntoView(e.from,{y:"center",x:"center"})}),U<=1||F(function(t){if(null===t){var n=M.findIndex(function(t){return t.from===e.from&&t.to===e.to});return -1===n?1:n+1}return t>=U?1:t+1})}function q(){(0,r.findPrevious)(n);var e=n.state.selection.main;n.dispatch({effects:o.EditorView.scrollIntoView(e.from,{y:"center",x:"center"})}),U<=1||F(function(t){if(null===t){var n=M.findIndex(function(t){return t.from===e.from&&t.to===e.to});return -1===n?1:n+1}return t<=1?U||1:t-1})}(0,u.useImperativeHandle)(t,function(){return{onSelectionSet:function(){var e=n.state.selection.main,t=$.current.findIndex(function(t){return t.from<=e.anchor&&t.to>=e.anchor});F(-1!==t?t+1:null)},onDocChanged:function(){L((0,d.default)(G.current,n.state.doc)),F(null)},onExpandRequested:function(){y(!0)}}},[n,G,$]),(0,u.useEffect)(function(){var e=(0,d.default)(i,n.state.doc);L(e);var t=n.state.selection.main,r=e.findIndex(function(e){return e.from<=t.anchor&&e.to>=t.anchor});F(-1!==r?r+1:null)},[n,i]);var K=(0,s._)((0,u.useState)(function(){return P(n.dom.clientWidth)}),2),Y=K[0],Q=K[1],X=(0,p.default)(function(e){e.width&&Q(P(e.width))});function J(e){return(0,o.runScopeHandlers)(n,e,"search-panel")}var Z=U>0,ee=i.search.length>0?"0 / 0":null,et=Z?"".concat(V||1," / ").concat(U):ee,en=et?8*et.length:null,er=(0,l.jsxs)(j.View,{css:O.searchSettings,children:[(0,l.jsx)(m.default,{alt:"case sensitive",icon:(0,l.jsx)(T.default,{}),checked:i.caseSensitive,onClick:function(){a({caseSensitive:!i.caseSensitive})}}),(0,l.jsx)(m.default,{alt:"regular expressions",icon:(0,l.jsx)(I.default,{}),checked:i.regexp,onClick:function(){a({regexp:!i.regexp})}}),(0,l.jsx)(m.default,{alt:"whole words",icon:(0,l.jsx)(A.default,{}),checked:i.wholeWord,onClick:function(){a({wholeWord:!i.wholeWord})}})]}),ei=[O.content];return"small"!==Y&&x?ei.push(O.contentExpanded):"small"===Y&&x?ei.push(O.contentExpandedSmall):"small"!==Y||x||ei.push(O.contentSmall),(0,l.jsx)(D,{ref:X,onKeyDown:function(e){J(e)&&e.preventDefault()},children:(0,l.jsxs)(S.Surface,{elevated:!0,css:O.root,px:4,py:6,row:!0,gap:4,children:[(0,l.jsx)(j.View,{css:O.panelButtonWrapper,children:(0,l.jsx)(k.IconButton,{alt:x?"Close replace panel":"Show replace panel",size:32,onClick:function(){y(function(e){return!e})},children:(0,l.jsx)(E.default,{rotate:90*!!x,style:{transition:"200ms ease"}})})}),(0,l.jsxs)(j.View,{css:ei,children:[(0,l.jsxs)(j.View,{css:O.searchInputWrapper,children:[(0,l.jsx)(g.InputWithHistory,{ref:z,style:{padding:4,paddingRight:null!=en?en:void 0},placeholder:"Search",defaultValue:i.search,name:"search","main-field":"true",onKeyDown:function(e){if((0,h.getCmdOrCtrl)(e)&&"f"===e.key)return void e.currentTarget.select();if("enter"===e.key.toLowerCase()&&!J(e)){if(e.preventDefault(),e.shiftKey)return void q();W()}},onChange:function(e){a({search:e})}}),et?(0,l.jsx)(j.View,{css:O.matchLabel,children:(0,l.jsx)(C.Text,{variant:"small",color:"dimmest",multiline:!1,children:et})}):null]}),(0,l.jsxs)(j.View,{css:O.searchControls,children:[(0,l.jsxs)(j.View,{row:!0,children:[(0,l.jsx)(k.IconButton,{size:32,alt:"Previous",onClick:function(){q()},children:(0,l.jsx)(E.default,{rotate:-90})}),(0,l.jsx)(k.IconButton,{size:32,alt:"Next",onClick:function(){W()},children:(0,l.jsx)(E.default,{rotate:90})})]}),(0,l.jsx)(w.Button,{text:"Select all",onClick:function(){(0,r.selectMatches)(n),n.focus()}}),er]}),x?(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(j.View,{css:O.replaceInputWrapper,children:(0,l.jsx)(_.Input,{ref:H,style:{padding:4},placeholder:"Replacement",name:"replace",defaultValue:i.replace,onKeyDown:function(e){"enter"!==e.key.toLowerCase()||J(e)||(e.preventDefault(),(0,r.replaceNext)(n))},onChange:function(e){a({replace:e.target.value})}})}),(0,l.jsxs)(j.View,{css:O.replaceControls,children:[(0,l.jsx)(w.Button,{text:"Replace",onClick:function(){(0,r.replaceNext)(n)}}),(0,l.jsx)(w.Button,{text:"Replace all",onClick:function(){(0,r.replaceAll)(n)}})]})]}):null]}),(0,l.jsx)(j.View,{css:O.panelButtonWrapper,children:(0,l.jsx)(k.IconButton,{alt:"Close Search Panel",tooltipBehavior:"hidden",onClick:function(){(0,r.closeSearchPanel)(n)},children:(0,l.jsx)(R.default,{})})})]})})})),L=i.StateEffect.define(),B=[(0,r.search)({createPanel:function(e){var t=!1,i=!1,o=!1,s=!1,l=!1,u=(0,n.default)(function(t){var n,i,o,a,s,l,u=(0,r.getSearchQuery)(e.state),c=new r.SearchQuery({search:null!=(n=t.search)?n:u.search,caseSensitive:null!=(i=t.caseSensitive)?i:u.caseSensitive,literal:null!=(o=t.literal)?o:u.literal,regexp:null!=(a=t.regexp)?a:u.regexp,replace:null!=(s=t.replace)?s:u.replace,wholeWord:null!=(l=t.wholeWord)?l:u.wholeWord});c.eq(u)||e.dispatch({effects:r.setSearchQuery.of(c)})},300),c=M.create({view:e,query:(0,r.getSearchQuery)(e.state),updateQuery:u});return{dom:c,top:!0,update:function(t){(0,a.hasChanged)(t,r.setSearchQuery)&&M.set(c,{view:e,query:(0,r.getSearchQuery)(t.state),updateQuery:u}),t.selectionSet&&!s&&(s=!0,requestAnimationFrame(function(){if(!i){var e;s=!1,null==(e=M.ref(c))||e.onSelectionSet()}})),t.docChanged&&!o&&(o=!0,requestAnimationFrame(function(){if(!i){var e;o=!1,null==(e=M.ref(c))||e.onDocChanged()}})),(0,a.hasChanged)(t,L)&&!l&&(l=!0,requestAnimationFrame(function(){if(!i){var e;l=!1,null==(e=M.ref(c))||e.onExpandRequested()}}))},mount:function(){t||(t=!0,requestAnimationFrame(function(){if(!i){t=!1;var e=c.querySelector("[main-field]");e&&(e.focus(),e.select())}}))},destroy:function(){return i=!0}}}}),o.keymap.of([{win:"Ctrl-h",linux:"Ctrl-h",preventDefault:!0,run:function(e){return!!((0,r.searchPanelOpen)(e.state)||(0,r.openSearchPanel)(e))&&(e.dispatch({effects:L.of(null)}),!0)}}])];e.s(["ReplitSearchPanel",()=>B],770781);var V=e.i(904851),F=e.i(90659),U=e.i(721281),G=e.i(488566),$=e.i(486701),z=e.i(736097),H=e.i(555970),W=e.i(492555),q=e.i(260924),K=e.i(700170),Y=e.i(207237),Q=null!=(t=globalThis.requestIdleCallback)?t:globalThis.requestAnimationFrame;function X(e,t,n){var r=e.field(t,!1);if(void 0===r){if(void 0===n)throw Error("Field is not mounted on state");return n}return t.spec.toJSON(r,e)}function J(e){for(var t=e.sliceString(0,200)+e.length,n=0,r=0;r<t.length;r++)n=(n<<5)-n+t.charCodeAt(r)|0;return(n>>>0).toString(36)}var Z=function(){function e(t,n,r,i){var o=this;(0,V._)(this,e),(0,U._)(this,"view",void 0),(0,U._)(this,"replId",void 0),(0,U._)(this,"cache",void 0),(0,U._)(this,"compartment",void 0),(0,U._)(this,"historyIsMounted",void 0),(0,U._)(this,"destroyed",void 0),(0,U._)(this,"pending",void 0),this.view=t,this.replId=n,this.cache=r,this.compartment=i,this.historyIsMounted=!1,this.destroyed=!1,this.pending=!1,this.scheduleCacheUpdate=this.scheduleCacheUpdate.bind(this),this.view.scrollDOM.addEventListener("scroll",this.scheduleCacheUpdate),this.view.state.field(W.OtIsLoading,!1)||Promise.resolve().then(function(){o.destroyed||o.apply()})}return(0,F._)(e,[{key:"key",get:function(){var e=this.view.state.facet(z.fileName);return e?"".concat(this.replId,":").concat(e):null}},{key:"apply",value:function(){if(!this.historyIsMounted&&this.view.state.field(G.historyField,!1))return void(0,o.logException)(this.view.state,Error("History was preconfigured on this view, if you want to use state cache, please make sure history is not already configured for this view"));if(!this.key||this.view.state.field(W.OtIsLoading,!1)){if(this.historyIsMounted){var e,t,n=this.key?H.Initializing.of(!0):[];this.view.dispatch({effects:this.compartment.reconfigure(n)}),this.historyIsMounted=!1}return}var r=this.cache.get(this.key);if(!r||r.hash!==J(this.view.state.doc)){this.view.dispatch({effects:this.compartment.reconfigure((0,G.history)())}),this.historyIsMounted=!0;return}var a=i.EditorSelection.fromJSON(r.selection),s=[(e=r.scroll,(t=o.EditorView.scrollIntoView(e.pos,{y:"start",x:"start",yMargin:e.yDiff,xMargin:e.scrollLeft})).value.isSnapshot=!0,t),this.compartment.reconfigure([G.historyField.init(function(e){var t,n;return t=G.historyField,n=r.history,t.spec.fromJSON(n,e)}),(0,G.history)()])];if(this.view.state.field($.foldState,!1))for(var l=0;l<r.folds.length;l+=2){var u=r.folds[l],c=r.folds[l+1];s.push($.foldEffect.of({from:u,to:c}))}this.view.dispatch({selection:a,effects:s}),this.historyIsMounted=!0}},{key:"scheduleCacheUpdate",value:function(){var e=this;this.pending||(this.pending=!0,Q(function(){e.pending&&!e.destroyed&&(e.pending=!1,e.historyIsMounted&&e.key&&e.cache.set(e.key,{hash:J(e.view.state.doc),scroll:function(e){var t=e.scrollDOM.scrollTop,n=e.scrollDOM.scrollLeft;if(0===t&&0===n)return{pos:0,yDiff:0,scrollLeft:0};var r=e.lineBlockAtHeight(t+8),i=r.from>=e.viewport.from||e.viewportLineBlocks[0].top-t>200?r:e.viewportLineBlocks[0];return{pos:i.from,yDiff:i.top-t,scrollLeft:n}}(e.view),selection:e.view.state.selection.toJSON(),history:X(e.view.state,G.historyField),folds:X(e.view.state,$.foldState,[])}))}))}},{key:"postUpdate",value:function(e){(0,a.hasChanged)(e,z.fileName,W.OtIsLoading)?this.apply():!this.pending&&this.historyIsMounted&&(0,a.hasChanged)(e,"doc","selection",G.historyField,$.foldState)&&this.scheduleCacheUpdate()}},{key:"destroy",value:function(){this.destroyed=!0,this.view.scrollDOM.removeEventListener("scroll",this.scheduleCacheUpdate)}}]),e}(),ee=new K.ReactCompartment(function(e,t){var n=new i.Compartment,r=o.ViewPlugin.define(function(r){return new Z(r,e,t,n)},{provide:function(e){return o.EditorView.updateListener.of(function(t){var n;null==(n=t.view.plugin(e))||n.postUpdate(t)})}});return[n.of(H.Initializing.of(!0)),r]});function et(){var e=(0,Y.default)(),t=(0,u.useContext)(q.StateCacheContext);if(!t)throw Error("Expected codemirror state to be in codemirror state context");return ee.use(e,t)}e.s(["default",()=>et],518975);var en=o.EditorView.theme({"&":{contain:"size"},"& > .cm-scroller":{contain:"strict"}});e.s(["ContainmentTheme",()=>en],705414);var er=e.i(399528),ei=e.i(15053),eo=e.i(310761),ea=e.i(703613),es=e.i(569910),el=e.i(134628),eu=e.i(441329),ec=e.i(479407),ed=e.i(385164),ef=e.i(335392);function ep(e){return{filePath:e,text:"",selections:[],hasFocus:!1}}function eh(e,t){var n;return null==t?ep(e):{filePath:e,text:null!=(n=t.state.doc.toString())?n:"",selections:t.state.selection.ranges.map(function(e){var t=e.from;return{location:t,length:e.to-t}}),hasFocus:t.hasFocus}}function eg(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:(0,ei.v4)(),n={messageType:el.BridgeMessageType.TEXT_EDITOR_STATE,filePath:e.textEditorState.filePath,text:e.textEditorState.text,selections:e.textEditorState.selections,hasFocus:e.textEditorState.hasFocus,hasGhostwriterSuggestion:e.hasGhostwriterSuggestion,revisionId:e.revisionId};(0,ec.sendMessage)(n,t)}function em(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:(0,ei.v4)(),n={messageType:el.BridgeMessageType.TEXT_EDITOR_CLOSED,filePath:e};(0,ec.sendMessage)(n,t)}function ev(e,t,n,r,i){return r===e&&r===n.textEditorState.filePath&&t===n.textEditorState.filePath&&i===n.revisionId}function ex(e){var t=e.map(function(e){return i.EditorSelection.range(e.location,e.location+e.length)});return i.EditorSelection.create(t)}function ey(e,t,n,r,i){var o,a,s,l,u,c,d,f,p,h,g=i.payload;if((0,el.isBridgePayloadRequestSetSelection)(g)){if(!ev(e,t,r,g.filePath,g.revisionId))return!1;var m=ex(g.selections);return n.dispatch({selection:m,scrollIntoView:!0}),!0}if((0,el.isBridgePayloadRequestSetText)(g)){if(!ev(e,t,r,g.filePath,g.revisionId))return!1;var x=ex(g.selections);return n.dispatch({changes:{from:0,to:n.state.doc.length,insert:g.text},selection:x,scrollIntoView:!0}),!0}if((0,el.isBridgePayloadRequestInsertText)(g)){if(!ev(e,t,r,g.filePath,g.revisionId))return!1;var y=g.insertionRange,b=ex(g.selections);return n.dispatch({changes:{from:y.location,to:y.location+y.length,insert:g.text},selection:b,scrollIntoView:!0}),!0}if((0,el.isBridgePayloadRequestReplaceSelection)(g))return!!ev(e,t,r,g.filePath,g.revisionId)&&(n.dispatch(n.state.replaceSelection(g.text)),!0);if((0,el.isBridgePayloadRequestPasteText)(g))ev(e,t,r,g.filePath,g.revisionId)&&(0,ef.handlePasteEvent)({filePath:e,view:n,clipboardText:g.text});else if((0,el.isBridgePayloadRequestTextEditorAction)(g))switch(g.action){case el.BridgeTextEditorAction.REQUEST_BLUR:if(!ev(e,t,r,g.filePath,g.revisionId))return!1;n.contentDOM.blur();return;case el.BridgeTextEditorAction.REQUEST_UNDO:return o=e,a=t,s=n,l=r,u=g.filePath,!!ev(o,a,l,u,g.revisionId)&&((0,G.undo)(s),!0);case el.BridgeTextEditorAction.REQUEST_REDO:return c=e,d=t,f=n,p=r,h=g.filePath,!!ev(c,d,p,h,g.revisionId)&&((0,G.redo)(f),!0);case el.BridgeTextEditorAction.REQUEST_INDENT_SELECTION:return!!ev(e,t,r,g.filePath,g.revisionId)&&(G.indentMore(n),!0);case el.BridgeTextEditorAction.REQUEST_DEDENT_SELECTION:return!!ev(e,t,r,g.filePath,g.revisionId)&&(G.indentLess(n),!0);case el.BridgeTextEditorAction.REQUEST_TOGGLE_COMMENT:return!!ev(e,t,r,g.filePath,g.revisionId)&&(G.toggleComment(n),!0);case el.BridgeTextEditorAction.REQUEST_ACCEPT_GHOSTWRITER_SUGGESTION:return!!ev(e,t,r,g.filePath,g.revisionId)&&(0,ed.acceptCompleteCodeSuggestion)(n);case el.BridgeTextEditorAction.REQUEST_FOCUS:return n.focus(),!0;default:throw Error("Unknown BridgeTextEditorAction.")}else throw Error("Invalid payload.")}function eb(e){var t,n=e.view,r=e.filePath,i=(0,er.useRouter)(),o=(0,eu.isInBonsaiWebview)(i),a=(0,u.useRef)({revisionId:(0,ei.v4)(),textEditorState:ep(r),hasGhostwriterSuggestion:!1}),s=(0,u.useRef)(r),l=null!=(t=null==n?void 0:n.plugin(ea.StateListenerPlugin))?t:null;(0,u.useEffect)(function(){if(o&&n&&l&&!l.destroyed){var e=function(e){eg(a.current,e.messageId)},t=function(t){ey(r,s.current,n,a.current,t)?e(t):(0,ec.sendErrorMessage)(t.messageId)},i=function(t){ey(r,s.current,n,a.current,t)?e(t):(0,ec.sendErrorMessage)(t.messageId)},u=function(n){try{var r=n.data;if(!(0,el.isBridgeMessage)(r)||r.protocolVersion!==el.nativeBridgeProtocolVersion)return;var o=r.payload;r.messageDirection===el.BridgeMessageDirection.TO_NATIVE&&(0,el.isBridgePayloadWorkspaceState)(o)&&(s.current=o.activePaneFilePath),(0,ec.textEditorBridgeMessageHandler)(n,function(n){var o=n.type;switch(o){case el.BridgeMessageType.TEXT_EDITOR_STATE_REQUEST:e(r);break;case el.BridgeMessageType.REQUEST_SET_SELECTION:case el.BridgeMessageType.REQUEST_REPLACE_SELECTION:case el.BridgeMessageType.REQUEST_SET_TEXT:case el.BridgeMessageType.REQUEST_INSERT_TEXT:case el.BridgeMessageType.REQUEST_PASTE_TEXT:t(r);break;case el.BridgeMessageType.TEXT_EDITOR_REQUEST_ACTION:i(r);break;default:(0,es.default)(o)}})}catch(e){throw Error("Invalid message: ".concat(e))}};window.addEventListener("message",u),a.current={revisionId:(0,ei.v4)(),textEditorState:eh(r,n),hasGhostwriterSuggestion:(0,eo.hasPresentedSuggestion)(n.state)},eg(a.current);var c=!1,d=!1,f=l.bind({changed:function(e){var t;return e.docChanged?(c=!0,!0):!!e.selectionSet||!!e.focusChanged||(null==(t=a.current)?void 0:t.hasGhostwriterSuggestion)!==(0,eo.hasPresentedSuggestion)(e.state)},callback:function(){var e=c?(0,ei.v4)():a.current.revisionId;c=!1,a.current={revisionId:e,textEditorState:eh(r,n),hasGhostwriterSuggestion:(0,eo.hasPresentedSuggestion)(n.state)},eg(a.current)},destroy:function(){window.removeEventListener("message",u),d||(em(r),d=!0)}});return function(){window.removeEventListener("message",u),f(),d||(em(r),d=!0)}}},[n,r,o,l])}function ew(e){var t=e.selection,n=e.doc,r=t.ranges.map(function(e){return e.extend(n.lineAt(e.from).from,n.lineAt(e.to).to)});return i.EditorSelection.create(r)}e.s(["default",()=>eb],714330),e.s(["selectFullLines",()=>ew],351278);var ek=e.i(188507),e_=e.i(205104);function eS(e,t,n){var r=e.selection.main,i=e.sliceDoc(r.from,r.to),o=(0,e_.getExt)(t);return{code:i,filePath:t,fileVersion:n,fileContent:e.doc.toString(),range:{indexFrom:r.from,indexTo:r.to,lineFrom:e.doc.lineAt(r.from).number,lineTo:e.doc.lineAt(r.to).number},language:o,referenceType:ek.CodeReferenceType.INLINE}}e.s(["default",()=>eS],260480)},177461,162943,e=>{"use strict";var t=e.i(297083),n=e.i(817556),r=e.i(276385),i=e.i(389959),o=e.i(15053),a=e.i(629536),s=e.i(753950),l=e.i(179302);e.i(440545);var u=e.i(214705),c=e.i(915599),d=e.i(936381),f=e.i(260171),p=e.i(351278),h=e.i(918323),g=e.i(785707),m=e.i(78866),x=e.i(235387),y=e.i(335392),b=e.i(502379),w=e.i(700170),k=e.i(993796),_=e.i(610357),S=e.i(664152),C=e.i(858248),j=e.i(709485),T=e.i(485237),E=e.i(179147),R=e.i(529810),I=e.i(770396),A=e.i(863790),P=e.i(260480),D=e.i(242719),O=e.i(933101),N=e.i(106020),M=e.i(100811),L=e.i(667279),B=e.i(623059);e.i(32109);var V=e.i(384401),F=e.i(262206),U=e.i(736318),G=e.i(480028),$=e.i(291883),z=e.i(610327),H=e.i(442060),W=e.i(107413),q=e.i(389922),K=e.i(51606),Y=e.i(171612),Q=e.i(283023),X=e.i(243914),J=e.i(761922),Z=e.i(525212),ee=e.i(217867),et=e.i(239337),en=e.i(437181),er=e.i(903283),ei=e.i(292642),eo=e.i(373764),ea=e.i(793579),es=e.i(962008);function el(e){var t=e.label,n=e.icon,r=e.run,i=e.keyboardShortcut,o=e.dataCy;return{match:N.matchLabel,data:{type:"action",label:t,icon:n,run:r,keyboardShortcut:i,dataCy:o}}}function eu(e){var t=e.view,n=e.mainSelection,r=e.codeReference;t.dispatch({selection:{anchor:n.to},effects:[d.inlinePocketEffect.of({id:(0,o.v4)(),codeReference:r,type:"ghostwriterKillswitch"}),l.EditorView.scrollIntoView(n.to,{y:"center"})]})}function ec(e){var t=e.path,n=(0,R.default)().fs,r=(0,k.useFlag)({controlName:"flag-killswitch-ghostwriter-chat",logFlagToAnalytics:!1});return(0,i.useCallback)(function(e,i){var a=e.state,u=a.doc,c=a.selection,f=a.lineBreak,p=u.lineAt(c.main.head);p.length&&e.dispatch({changes:{from:p.to,insert:f},selection:s.EditorSelection.cursor(p.to+1)});var h=n.getOTVersion(t),g=(0,P.default)(e.state,t,h);if((0,C.track)(j.events.AI_INLINE_EVENT,{action:"inline_textbox_opened",intent_type:"generate",source:i}),r)return void eu({view:e,mainSelection:e.state.selection.main,codeReference:g});var m=e.state.selection.main.to;e.dispatch({selection:{anchor:m},effects:[d.inlinePocketEffect.of({id:(0,o.v4)(),codeReference:g,type:"generateCode",source:i}),l.EditorView.scrollIntoView(m,{y:"center"})]})},[t,n,r])}function ed(e){var t=e.path,n=(0,R.default)().fs,r=(0,k.useFlag)({controlName:"flag-killswitch-ghostwriter-chat",logFlagToAnalytics:!1});return(0,i.useCallback)(function(e,i){e.dispatch({selection:(0,p.selectFullLines)(e.state)});var a=n.getOTVersion(t),s=(0,P.default)(e.state,t,a);if(r)return void eu({view:e,mainSelection:e.state.selection.main,codeReference:s});(0,C.track)(j.events.AI_INLINE_EVENT,{action:"inline_textbox_opened",intent_type:"modify",source:i});var u=e.state.selection.main.to;e.dispatch({selection:{anchor:u},effects:[d.inlinePocketEffect.of({id:(0,o.v4)(),type:"transformCode",codeReference:s,source:i}),l.EditorView.scrollIntoView(u,{y:"center"})]})},[t,n,r])}function ef(e){var t=e.path,n=(0,R.default)().fs,r=(0,k.useFlag)({controlName:"flag-killswitch-ghostwriter-chat",logFlagToAnalytics:!1});return(0,i.useCallback)(function(e,i){e.dispatch({selection:(0,p.selectFullLines)(e.state)});var s,u,c,f,h=n.getOTVersion(t),g=(0,P.default)(e.state,t,h);(0,C.track)(j.events.AI_INLINE_EVENT,{action:"inline_textbox_opened",intent_type:"explain",source:i});var m=e.state.selection.main.to-e.state.selection.main.from>a.AI_INLINE_BASIC_LIMIT;if(m)return void(u=(s={view:e,mainSelection:e.state.selection.main,codeReference:g}).view,c=s.mainSelection,f=s.codeReference,u.dispatch({selection:{anchor:c.to},effects:[d.inlinePocketEffect.of({id:(0,o.v4)(),codeReference:f,type:"codeLengthExceeded"}),l.EditorView.scrollIntoView(c.to,{y:"center"})]}));if(r||m)return void eu({view:e,mainSelection:e.state.selection.main,codeReference:g});var x=e.state.selection.main.to;e.dispatch({selection:{anchor:x},effects:[d.inlinePocketEffect.of({id:(0,o.v4)(),codeReference:g,type:"explainCode",source:i}),l.EditorView.scrollIntoView(x,{y:"center"})]})},[n,t,r])}function ep(e){var o,s,l,d,p,w,k,C,j,R,A,P,N,eu,ep,eh,eg=e.path,em=e.view,ev=(o=ec({path:eg}),s=ed({path:eg}),l=ef({path:eg}),d=(0,V.useKeyCombo)(O.generateOrModifyWithAICommand.id),(0,i.useCallback)(function(e){var t=[],n=!e.state.selection.main.empty;return o&&!n&&t.push(el({label:"Generate with "+a.ASSISTANT_NAME,icon:(0,r.jsx)(en.default,{color:G.tokens.tealStronger}),keyboardShortcut:d,run:function(){o(e,"action_menu")},dataCy:"context-menu-GenerateCode"})),n&&(t.push(el({label:"Explain with "+a.ASSISTANT_NAME,icon:(0,r.jsx)(et.default,{color:G.tokens.tealStronger}),dataCy:"context-menu-ExplainCode",run:function(){l(e,"action_menu")}})),t.push(el({label:"Modify with "+a.ASSISTANT_NAME,icon:(0,r.jsx)(ee.default,{color:G.tokens.tealStronger}),keyboardShortcut:d,dataCy:"context-menu-TransformCode",run:function(){s(e,"action_menu")}}))),t},[o,s,l,d])),ex=(0,i.useCallback)(function(e){var i=[el({label:"Copy link to position",icon:(0,r.jsx)(ei.default,{}),run:function(){var t=(0,b.offsetToPos)(e.state.doc,e.state.selection.main.head),n=t.line,r=t.character,i=(0,U.createDeeplinkURL)({path:eg,line:n+1,col:r});(0,_.default)(i)}}),el({label:"Copy",icon:(0,r.jsx)(K.default,{}),keyboardShortcut:(0,F.defaultKeyCombo)({cmdOrCtrl:!0,key:"c"}),run:function(){var t=(0,f.copiedRange)(e.state).text;(0,_.default)(t)}}),el({label:"Cut",icon:(0,r.jsx)(Y.default,{}),keyboardShortcut:(0,F.defaultKeyCombo)({cmdOrCtrl:!0,key:"x"}),run:function(){var t=(0,f.copiedRange)(e.state),n=t.text,r=t.ranges;(0,_.default)(n),e.state.readOnly||e.dispatch({changes:r,scrollIntoView:!0,userEvent:"delete.cut"})}})];return window.navigator.clipboard&&"readText"in window.navigator.clipboard&&i.push(el({label:"Paste",icon:(0,r.jsx)(W.default,{}),keyboardShortcut:(0,F.defaultKeyCombo)({cmdOrCtrl:!0,key:"v"}),run:function(){return(0,t._)(function(){var t,r;return(0,n._)(this,function(n){switch(n.label){case 0:t="",n.label=1;case 1:return n.trys.push([1,3,,4]),[4,window.navigator.clipboard.readText()];case 2:return t=n.sent(),[3,4];case 3:return r=n.sent(),S.logger.error("CodeMirror context menu paste failed",{message:r.message}),[2];case 4:return(0,y.handlePasteEvent)({filePath:eg,view:e,clipboardText:t}),[2]}})})()}})),i},[eg]),ey=(p=(0,T.default)(eg),w=(0,E.default)(p),k=(0,V.useKeyCombo)("editor.action.goToDefinition"),C=(0,V.useKeyCombo)("editor.action.goToTypeDefinition"),j=(0,V.useKeyCombo)("editor.action.goToImplementation"),R=(0,V.useKeyCombo)("editor.action.goToReferences"),A=(0,V.useKeyCombo)("editor.selection.allOccurrences"),P=(0,V.useKeyCombo)("editor.action.sourceActions"),N=(0,V.useKeyCombo)("editor.action.formatDocument"),eu=(0,V.useKeyCombo)("editor.action.codeActions"),ep=(0,V.useKeyCombo)("editor.action.renameSymbol"),(0,i.useCallback)(function(e){var t=[],n=w&&p.length;return n&&w.isFindDefinitionSupported&&t.push(el({label:"Go to definition",icon:(0,r.jsx)(X.default,{}),dataCy:"context-menu-JumpToDefinition",run:function(t){(0,m.goToDefinition)(e,t)},keyboardShortcut:k})),n&&w.isFindTypeDefinitionSupported&&t.push(el({label:"Go to type definition",icon:(0,r.jsx)(H.default,{}),run:function(){(0,m.goToTypeDefinition)(e)},keyboardShortcut:C})),n&&w.isFindImplementationSupported&&t.push(el({label:"Go to implementation",icon:(0,r.jsx)(es.default,{}),run:function(){(0,m.goToImplementation)(e)},keyboardShortcut:j})),n&&(w.isFindDefinitionSupported||w.isFindReferencesSupported)&&t.push(el({label:"Show references",icon:(0,r.jsx)(z.default,{}),keyboardShortcut:R,run:function(){(0,g.findReferences)(e)}})),t.push(el({label:"Find in Repl",icon:(0,r.jsx)(ea.default,{}),run:function(){var t=(0,f.copiedRange)(e.state).text;(0,D.openPane)(e.state,{pane:{type:"searchReplace",data:{initialQuery:t}}})}})),n&&w.isRenameSupported&&t.push(el({label:"Rename all occurrences",icon:(0,r.jsx)(Q.default,{}),keyboardShortcut:ep,run:function(){(0,x.StartRenameCommand)(e)}})),e.state.facet(c.HasFormatter)&&t.push(el({label:"Format document",icon:(0,r.jsx)(Z.default,{}),keyboardShortcut:N,run:function(){(0,u.FormatCommand)(e)}})),!e.state.selection.main.empty&&e.state.facet(c.HasRangeFormatter)&&t.push(el({label:"Format selection",icon:(0,r.jsx)(Z.default,{}),run:function(){(0,u.FormatSelectionCommand)(e)}})),t.push(el({label:"Select all occurrences",icon:(0,r.jsx)(q.default,{}),keyboardShortcut:A,run:function(){(0,I.selectAllOccurrences)(e)}})),n&&w.isCodeActionsSupported&&(w.isSourceActionsSupported&&t.push(el({label:"Source actions",icon:(0,r.jsx)(J.default,{}),keyboardShortcut:P,run:function(){(0,h.CodeActionsSourceActionsCommand)(e)}})),t.push(el({label:"More actions",icon:(0,r.jsx)(er.default,{}),keyboardShortcut:eu,run:function(){(0,h.CodeActionsCommand)(e,{force:!0})}}))),t},[w,p,A,P,k,C,j,R,ep,N,eu])),eb=(eh=(0,L.useExtensionCommands)(B.ContributionType.EditorContextMenu),(0,i.useCallback)(function(e){var r=[];return r.push({data:{type:"group",key:"extensions"},commands:function(){return(0,t._)(function(){var r;return(0,n._)(this,function(i){switch(i.label){case 0:return r=[{data:{filePath:e.filePath,selection:e.view.state.selection.toJSON()}}],[4,Promise.all(eh.map(function(e){return(0,t._)(function(){var t;return(0,n._)(this,function(n){switch(n.label){case 0:return[4,e.create({path:r})];case 1:if(!(t=n.sent()))return[2,null];return[2,(0,M.wrapExtensionCommand)(t,{path:r})]}})})()}))];case 1:return[2,i.sent().filter(Boolean)]}})})()}}),r},[eh]));return(0,i.useCallback)(function(){var e=em?[{data:{type:"context",label:a.ASSISTANT_NAME,icon:(0,r.jsx)($.default,{})},commands:function(){return ev(em)}},{data:{type:"context",label:"Code actions",icon:(0,r.jsx)(er.default,{})},commands:function(){return ey(em)}},{data:{type:"context",label:"Clipboard",icon:(0,r.jsx)(W.default,{})},commands:function(){return ex(em)}},{data:{type:"context",label:"Extensions",icon:(0,r.jsx)(eo.default,{})},commands:function(){return eb({view:em,filePath:eg})}}]:[];return{data:{type:"context",label:"Search actions",icon:(0,r.jsx)(ea.default,{})},commands:function(){return e}}},[em,ev,ey,ex,eg,eb])}var eh=new w.ReactCompartment(function(e,t,n){return e?null:[(0,A.ContextMenuVisibleExtension)(t),l.EditorView.domEventHandlers({contextmenu:function(e,t){var r=e.clientX,i=e.clientY,o=t.state.selection.main,a=t.posAtCoords({x:r,y:i}),l=t.state.doc.length,u=null===a?l:a;if(u<o.from||u>o.to){var c=s.EditorSelection.cursor(u);t.dispatch({selection:c})}return n(e),!0}})]});e.s(["ContextMenuCompartment",()=>eh,"useAssistantEditCode",()=>ed,"useAssistantExplainCode",()=>ef,"useAssistantGenerateCode",()=>ec,"useGetContextMenuCommand",()=>ep],177461);var eg=e.i(878420),em=e.i(569384),ev=e.i(973245),ex=e.i(304277);function ey(){var e=(0,em._)(["\n  query ReplCodeExamples($language: String!) {\n    languageExamples(language: $language) {\n      ... on LanguageExamples {\n        examples {\n          ... on LanguageExample {\n            mainFile\n            name\n            code\n          }\n        }\n      }\n    }\n  }\n"]);return ey=function(){return e},e}e.i(566901);var eb={},ew=(0,ev.gql)(ey());function ek(e){var t=(0,eg._)({},eb,e);return ex.useQuery(ew,t)}e.s(["useReplCodeExamplesQuery",()=>ek],162943)},970652,e=>{"use strict";var t,n=e.i(530658),r=e.i(276385),i=e.i(389959),o=e.i(162943),a=e.i(753950),s=e.i(74920),l=e.i(969932);e.i(694906);var u=e.i(446692),c=e.i(205104),d=e.i(807290),f=e.i(858248),p=e.i(709485),h=e.i(917375),g=e.i(86159),m=e.i(721281),x=e.i(409146),y=e.i(967629),b=e.i(877249),w=e.i(754873),k=e.i(613355),_=e.i(960178),S=e.i(625484),C=e.i(940745),j=S.SpecializedView.button;function T(e){var t=e.name,n=e.children,i=e.onClick;return(0,r.jsxs)(j,{onClick:function(){return i()},css:[w.interactive.nofill,k.rcss.p(8),k.rcss.focusRing,k.rcss.textAlign.left],children:[(0,r.jsx)(_.Text,{variant:"subheadDefault",css:k.rcss.pb(16),multiline:!1,children:t}),(0,r.jsx)(S.View,{css:[k.rcss.backgroundColor.backgroundDefault,k.rcss.p(8),k.rcss.borderRadius(8)],children:n})]})}var E="@media (min-width: ".concat(b.BREAKPOINTS.tabletMax,"px)"),R=(0,y.css)([k.rcss.colWithGap(16),(0,m._)({},E,{width:"calc(50%  - 8px)",flex:"0 0 auto",gap:"16px"})]);function I(e){var t=e.children;return(0,r.jsx)(S.View,{css:[(0,m._)({},E,[k.rcss.rowWithGap(16)])],children:t})}function A(e){var t=e.mainFile,n=e.examples,i=e.onSelect;return(0,r.jsxs)(S.View,{gap:24,children:[(0,r.jsx)(_.Header,{level:1,variant:"headerDefault",children:"Code examples"}),(0,r.jsx)(_.Text,{children:"Get started with some program examples."}),(0,r.jsxs)(I,{css:[k.rcss.colWithGap(16)],children:[(0,r.jsx)(S.View,{css:R,children:n.slice(0,(n.length+1)/2).map(function(e){return(0,r.jsx)(T,{name:e.name,onClick:function(){return i(e)},children:(0,r.jsx)(x.default,{code:e.code,filePath:t,fontSize:12,disableCursorStyling:!0})},e.name)})}),(0,r.jsx)(S.View,{css:R,children:n.slice((n.length+1)/2).map(function(e){return(0,r.jsx)(T,{name:e.name,onClick:function(){return i(e)},children:(0,r.jsx)(x.default,{code:e.code,filePath:t,fontSize:12,disableCursorStyling:!0})},e.name)})})]})]})}function P(e){var t=e.filePath,n=e.language,i=e.onSelect,a=(0,o.useReplCodeExamplesQuery)({variables:{language:n}}),s=a.data,l=a.loading,u=a.error;if(l)return(0,r.jsx)(S.View,{pt:32,pb:32,gap:0,justify:"center",align:"center",children:(0,r.jsx)(C.default,{})});if(u)return(0,r.jsx)(S.View,{pt:32,pb:32,gap:0,justify:"center",align:"center",children:u.message});var c=(null==s?void 0:s.languageExamples.__typename)==="LanguageExamples"?s.languageExamples.examples:null;return(null==c?void 0:c.length)?(null==c?void 0:c.length)?(0,r.jsx)(A,{mainFile:t,examples:c,onSelect:i}):(0,r.jsx)(S.View,{pt:32,pb:32,gap:0,justify:"center",align:"center",children:(0,r.jsxs)(_.Text,{children:["Sorry, this language doesnt have any examples. Want to add some? Contact us at ",(0,r.jsx)("a",{href:"mailto:support@replit.com",children:"support@replit.com"}),"!"]})}):null}var D=e.i(904851),O=e.i(90659),N=e.i(992785),M=e.i(179302);e.i(508987);var L=e.i(457103),B=e.i(468345),V=e.i(140659),F=e.i(928353),U=e.i(700170);e.i(32109);var G=e.i(926118),$=e.i(480028),z=(0,e.i(446530).cssRecord)({root:[{marginTop:"10%",pointerEvents:"none","*":{pointerEvents:"all"}}],button:[k.rcss.reset.button,k.rcss.rowWithGap(6),k.rcss.align.center,k.rcss.color.foregroundDimmest,k.rcss.cursor.pointer,{fontFamily:$.tokens.fontFamilyDefault,"*":{borderColor:$.tokens.foregroundDimmest,color:$.tokens.foregroundDimmest},":hover *":{borderColor:$.tokens.foregroundDefault,color:$.tokens.foregroundDefault}}]}),H="cm-empty-state-layer",W="cm-empty-state-dom",q=M.EditorView.theme((t={},(0,m._)(t,".".concat(H),{width:"100%",height:"100%",pointerEvents:"none",zIndex:"201 !important"}),(0,m._)(t,".".concat(W),{position:"absolute",width:"100%",pointerEvents:"none",display:"flex",justifyContent:"center"}),t)),K=function(){function e(t){(0,D._)(this,e),(0,m._)(this,"options",void 0),this.options=t}return(0,O._)(e,[{key:"draw",value:function(){var e=this.options,t=e.ctas,n=e.view,i=e.width,o=(0,F.createCodeMirrorElement)((0,r.jsx)(S.View,{css:z.root,p:16,align:"center",gap:8,children:t.map(function(e){return(0,r.jsxs)(S.View,{css:z.button,onClick:function(){return e.onClick(n)},children:[(0,r.jsxs)(S.View,{row:!0,gap:4,children:[e.icon,(0,r.jsx)(_.Text,{variant:"small",children:e.text})]}),e.shortcut?(0,r.jsx)(G.KeyComboBlocks,{keyCombo:e.shortcut,fontSize:12}):null]},e.text)})}));return o.className=W,o.style.width=i+"px",o.style.visibility=i>240?"visibile":"hidden",o.style.left="0px",o}},{key:"eq",value:function(e){return(0,N.default)(e.options,this.options)}}]),e}(),Y=new U.ReactCompartment(function(e){var t=function(e){var t;return!(e.doc.length>0||e.field(B.InlinePocketState))&&(null==(t=e.field(V.PasteScannerState,!1))||!t.size)},n=a.StateField.define({create:t,update:function(e,n){return t(n.state)}}),r=(0,M.layer)({above:!0,class:H,update:function(e){return(0,L.hasChanged)(e,n)},markers:function(t){if(!t.state.field(n,!1))return[];var r=t.dom.getBoundingClientRect();return[new K({ctas:e,width:Math.round(t.contentDOM.getBoundingClientRect().right-r.left),view:t})]}});return[q,n,r]}),Q=e.i(242719),X=e.i(933101),J=e.i(952685),Z=e.i(384401),ee=e.i(739521),et=e.i(437181),en=e.i(406345),er=e.i(962008);function ei(e){var t=e.cta,n=e.version;(0,f.track)(p.events.EDITOR_EMPTY_STATE_CLICKED,{cta:t,version:n})}var eo=a.StateEffect.define(),ea=a.StateField.define({create:function(){return null},update:function(e,t){var n=e;return(0,l.forEachEffect)(t,eo,function(e){n=e.value}),n}}),es=s.MountedReactNodes.from(ea,function(e){if(!e)return null;var t=e.language,n=e.filePath;return{key:"examplesModal",node:function(e){var i=function(){e.dispatch({effects:eo.of(null)})};return(0,r.jsx)(ee.Modal,{maxWidth:872,isOpen:!0,onRequestClose:i,children:(0,r.jsx)(ec,{onRequestClose:i,language:t,filePath:n})})}}}),el=[ea,es];function eu(e){var t,n,a,s,l,h=e.isMobile,g=e.filePath,m=e.generateCode,x=(0,Z.useKeyCombo)(X.generateOrModifyWithAICommand.id),y=null!=(s=null==(t=u.FileTypeRepository.from(g))?void 0:t.id)?s:null,b=(0,d.useIsTeamWithAiDisabled)().isTeamWithAiDisabled,w=(0,o.useReplCodeExamplesQuery)({variables:{language:y},skip:!y}).data,k=(null!=(l=null==w||null==(a=w.languageExamples)||null==(n=a.examples)?void 0:n.length)?l:0)>=1,_=(0,i.useMemo)(function(){var e=[];return(0,c.isMarkdownFile)(g)||b||e.push({icon:(0,r.jsx)(et.default,{}),text:"Generate Code with AI",shortcut:h?void 0:x,onClick:function(e){ei({cta:"generate",version:"new"}),m(e,"shortcut")}}),y&&k&&e.push({icon:(0,r.jsx)(er.default,{}),text:"Start with a code example",onClick:function(e){ei({cta:"examples",version:"new"}),e.dispatch({effects:eo.of({language:y,filePath:g})})}}),e.push({icon:(0,r.jsx)(en.default,{}),text:"Add powerful Integrations",onClick:function(e){(0,Q.openPane)(e.state,{pane:{type:"integrations"},secondary:!0}),ei({cta:"integrations",version:"new"}),(0,f.track)(p.events.TOOL_OPENED,{source:"fileEditorEmptyState",tool:"integrations"})}}),e},[g,b,y,k,h,x,m]);return[Y.use(_),el]}function ec(e){var t=e.onRequestClose,o=e.language,a=e.filePath,s=(0,g.useTourStep)(h.newUserTour.id,h.TourStepIds.Examples),l=(0,g.useTourStep)(h.newUserTour.id,h.TourStepIds.Editor),u=(0,n._)((0,i.useState)(!1),2),c=u[0],d=u[1],f=(0,J.default)(a),p=(0,i.useRef)(null==s?void 0:s.isActive),m=(0,i.useRef)();m.current=null==s?void 0:s.isActive;var x=(0,i.useRef)(null==s?void 0:s.goto);return(x.current=null==s?void 0:s.goto,(0,i.useEffect)(function(){return function(){var e;m.current&&(null==(e=x.current)||e.call(x,h.TourStepIds.Editor))}},[]),(0,i.useEffect)(function(){if((null==l?void 0:l.isActive)&&!p.current){if(!c)return void d(!0);l.goto(h.TourStepIds.Examples)}},[l,t,c]),(0,i.useEffect)(function(){if(null==s?void 0:s.isActive){p.current=!0;return}p.current&&t(null)},[t,null==s?void 0:s.isActive]),f)?(0,r.jsx)("div",{ref:null==s?void 0:s.tourRef,children:(0,r.jsx)(P,{filePath:a,language:o,onSelect:function(e){f({code:e.code,insertAt:0}),t({exampleName:e.name})}})}):(0,r.jsx)("div",{children:"Please make sure you have a file open"})}e.s(["useEmptyState",()=>eu],970652)},817760,e=>{"use strict";var t=e.i(530658),n=e.i(848415),r=e.i(288148),i=e.i(205104),o=e.i(529810),a=e.i(259475),s=e.i(545915);function l(e){var l=e.view,u=e.filePath,c=(0,o.default)().fs;return(0,t._)((0,n.useDrop)({accept:[a.DragItems.Code,r.NativeTypes.FILE],drop:function(e,t){if(l){var n=t.getClientOffset(),r=n?l.posAtCoords(n):null;if(null!==r){var o=function(e){l.focus(),l.dispatch({changes:{from:r,insert:e},selection:{anchor:r,head:r+e.length}})};if(e.type===a.DragItems.Code)o(e.code);else{var d=!0,f=!1,p=void 0;try{for(var h,g=e.files[Symbol.iterator]();!(d=(h=g.next()).done);d=!0){var m=h.value;u&&(0,i.isMarkdownFile)(u)&&(0,s.uploadImageAndGetMDCode)(m,c,u).then(o)}}catch(e){f=!0,p=e}finally{try{d||null==g.return||g.return()}finally{if(f)throw p}}}}}}}),2)[1]}e.s(["default",()=>l])},482070,690140,479166,142914,798705,82382,405146,630162,715571,e=>{"use strict";var t,n,r=e.i(297083),i=e.i(817556),o=e.i(276385),a=e.i(389959),s=e.i(179302),l=e.i(440416),u=e.i(406948),c=e.i(394205),d=e.i(440545),f=e.i(654360),p=e.i(122947),h=e.i(204219),g=e.i(848955),m=e.i(44813),x=e.i(507374),y=e.i(97149),b=e.i(300538),w=e.i(732676),k=e.i(755224),_=e.i(335392),S=e.i(507966),C=e.i(427469),j=e.i(221250),T=e.i(930925),E=e.i(194536),R=e.i(542101),I=e.i(275465),A=e.i(925565),P=e.i(770781),D=e.i(518975),O=e.i(705414),N=e.i(700170),M=e.i(234961),L=e.i(61524),B=e.i(441329),V=e.i(332441),F=e.i(597865),U=e.i(529810),G=e.i(714330),$=e.i(268403),z=e.i(57168),H=e.i(37292),W=e.i(177461),q=e.i(17262),K=e.i(970652),Y=e.i(817760),Q=e.i(242719),X=e.i(933101),J=e.i(109853);e.i(429225);var Z=e.i(84396),ee=e.i(564169),et=e.i(736097),en=e.i(91442);function er(e){var t=e.selection.main.head,n=e.doc.lineAt(t);return{offset:t,line:n.number,column:t-n.from+1}}var ei=new N.ReactCompartment(function(e){return s.EditorView.focusChangeEffect.of(function(t,n){var r=t.facet(et.fileName);return r&&e(r,n?{type:"focus",position:er(t)}:{type:"blur"}),null})}),eo=new N.ReactCompartment(function(e){return s.EditorView.updateListener.of(function(t){if(t.selectionSet){var n=t.state.facet(et.fileName);n&&e(n,{type:"update",hasFocus:t.view.hasFocus,position:er(t.state)})}})});e.i(545082);var ea=e.i(852819),es=e.i(703774),el=new N.ReactCompartment(function(){return(0,s.scrollPastEnd)()}),eu=function(e){var t=(0,F.default)(function(t){return(0,r._)(function(){var n;return(0,i._)(this,function(r){switch(r.label){case 0:return[4,t.status()];case 1:if((n=r.sent()).error)return[2,{error:n.error,isUnmerged:null}];if(n.changes.find(function(t){return t.path===e&&(t.type.index===M.GitStatusChangedFileType.UNMERGED||t.type.worktree===M.GitStatusChangedFileType.UNMERGED)}))return[2,{error:null,isUnmerged:!0}];return[2,{error:null,isUnmerged:!1}]}})})()},[e]);return t||{error:null,isUnmerged:null}};function ec(e){var t,n,r,i,N,M,F=e.filePath,et=e.isHidden,er=e.isReadOnly,ec=e.isReadOnlyWhileAgentWorking,ed=e.deeplink,ef=e.onDeeplinkUpdated,ep=e.performPaneOperation,eh=(0,U.default)(),eg=eh.fs,em=eh.presence,ev=(0,L.usePreferences)("formatOnSave","rulers","minimapDisplay","showLeadingWhitespace","showEnclosedWhitespace","showTrailingWhitespace","showSelectedWhitespace").preferences,ex=(0,R.default)(),ey=ex.ref,eb=ex.view,ew=(0,a.useCallback)(function(e){return ep({operation:"open",pane:e,secondary:!0})},[ep]);(0,ee.useSetCodeEditorView)(eb);var ek=(0,V.useUserAgent)(),e_=$.KeystrokeDebuggerForErrorsEnabledCompartment.use(!!(null==ek?void 0:ek.match(/Chrome/i))&&!!(null==ek?void 0:ek.match(/Android/i))),eS=(0,a.useContext)(ea.SessionContext),eC=(0,H.useGetBsodFileVersionByPath)(),ej=(n=(t={path:F,isHidden:et}).path,r=t.isHidden,i=(0,en.useUpdateCursorState)(),N=ei.use(i),M=eo.use(i),(0,a.useEffect)(function(){i(n,{type:r?"hidden":"unhidden"})},[r,i,n]),(0,a.useEffect)(function(){return function(){i(n,{type:"unmount"})}},[i,n]),(0,a.useMemo)(function(){return[N,M]},[N,M])),eT=(0,k.useMultiplayer)({view:eb,presence:em,fs:eg,filePath:F,performPaneOperation:ep}),eE=eT.isLoading,eR=eT.extensions,eI=(0,D.default)(),eA=(0,b.default)({filePath:F,isLoading:eE});(0,x.default)({filePath:F,view:eb,isLoading:eE,deeplink:ed,onDeeplinkUpdated:ef});var eP=(0,Y.default)({view:eb,filePath:F}),eD=(0,h.default)({filePath:F});(0,G.default)({view:eb,filePath:F});var eO=eu(F).isUnmerged,eN=(0,m.default)({filePath:F,enableConflicts:!0===eO}),eM=(0,B.useIsInMobileWorkspace)(),eL=T.InteractCompartment.use(eM),eB=_.PasteImgCompartment.use(eg),eV=C.MeasureInputLatencyCompartment.use(eM),eF=I.RulersCompartment.use(ev.rulers),eU=(0,es.useTheme)(),eG=w.MinimapCompartment.use(eM,ev.minimapDisplay,eU),e$=A.SemanticScrollbarCompartment.use(eM,eU),ez=d.FormatterExtensionCompartment.use(),eH=(0,f.useFormattingProviders)({filePath:F}),eW=c.VisibleWhitespaceCompartment.use(ev.showLeadingWhitespace,ev.showEnclosedWhitespace,ev.showTrailingWhitespace,ev.showSelectedWhitespace),eq=(0,u.useTrackFirstPasteExtension)({analyticsSurface:"workspace_editor"}),eK=(0,W.useAssistantGenerateCode)({path:F}),eY=(0,W.useAssistantExplainCode)({path:F}),eQ=(0,W.useAssistantEditCode)({path:F}),eX=(0,a.useCallback)(function(){eb&&eK(eb,"shortcut")},[eb,eK]),eJ=(0,K.useEmptyState)({isMobile:eM,generateCode:eK,filePath:F}),eZ=(0,a.useCallback)(function(){ew({type:"ghostwriterChat"})},[ew]),e0=(0,g.useInlineGhostwriterExtension)({onGenerateCode:eX,onReplyInChat:eZ}),e1=(0,Z.useContextMenu)(),e2=e1.onContextMenu,e3=e1.closeContextMenu,e4=e1.openContextMenu,e8=e1.isVisible,e5=(0,a.useCallback)(function(e){eb&&(0,s.runScopeHandlers)(eb,e,"context-menu")&&(e3(),e.stopPropagation(),e.preventDefault())},[e3,eb]),e6=(0,W.useGetContextMenuCommand)({path:F,view:eb}),e9=(0,a.useCallback)(function(e){e2(e,{command:e6(),width:275,onKeyDownHandler:e5})},[e6,e2,e5]),e7=(0,a.useCallback)(function(e,t){e4({target:e,command:[e6(),t],width:275,onKeyDownHandler:e5})},[e6,e5,e4]),te=W.ContextMenuCompartment.use(eM,e8,e9),tt=q.ContextMenuOpenerCompartment.use(e7),tn=(0,a.useCallback)(function(e){e4({target:{x:e.right-275,y:e.top},width:275,command:e6(),onKeyDownHandler:e5})},[e6,e5,e4]),tr=(0,X.useSelectionControls)({editCode:eQ,explainCode:eY,generateCode:eK,onMoreClick:tn}),ti=el.use(),to=(0,Q.usePerformPaneOperationFacet)(ep),ta=l.DisabledWhileAgentWorking.use(ec);return(0,o.jsx)("div",{css:J.CodeMirrorEditorStyleEditor,"data-cy":eE?"loading-workspace-cm-editor":"workspace-cm-editor-".concat(F),children:(0,o.jsx)(j.default,{ref:ey,elementRef:eP,css:J.CodeMirrorEditorStyleEditorContainer,filePath:F,hideTooltips:et,readOnly:er,extensions:[te,tt,eR,eI,eA,eJ,ti,eL,e_,eV,eN,e$,eG,_.PasteLink,eB,$.KeystrokeDebuggerForErrors,e0,S.pasteScannerExtension,O.ContainmentTheme,eF,eW,ez,eH,p.RevetGhostwriterCodeInsertState,eD,P.ReplitSearchPanel,E.TrackOnTypeExtension,eM?[]:tr,ej,y.LintPanelExtension,to,eq,ta],onException:function(e){var t,n={filePath:F,cursorPosition:JSON.stringify(null==eS||null==(t=eS.get(en.cursorStateAtom))?void 0:t.position),fileVersion:eC({filePath:F})};if(eb){var r=eb.plugin($.KeystrokeDebuggerForErrors),i=null==r?void 0:r.logs();null==r||r.flush(),n.domText=eb.contentDOM.innerText,n.keystrokes=JSON.stringify(i),n.selection=JSON.stringify(eb.state.selection.main.toJSON()),n.updateDoc=eb.state.doc.sliceString(0)}(0,z.captureNonFatalWorkspaceException)(e,{tags:{origin:"CodemirrorEditor: useEditor/onException",codemirror:!0},extras:n})},noHistory:!0})})}e.s(["default",()=>ec],482070);var ed=e.i(513705),ef=e.i(530658),ep=e.i(346715),eh=e.i(255615),eg=e.i(443893),em=e.i(625251),ev=e.i(405411),ex=e.i(131141),ey=e.i(541793),eb=e.i(161322),ew=e.i(649960),ek=e.i(480028),e_=e.i(446530),eS=e.i(754873),eC=e.i(613355),ej=e.i(604963),eT=e.i(625484),eE=e.i(196353),eR=(0,ey.atom)(0),eI=(0,ey.atom)(new Map([["normal",[]],["compact",[]]])),eA=(0,ey.atom)(null,function(e,t,n){var r=e(eN);t(eI,function(e){return(0,ex.produce)(e,function(e){var t=e.get(r);if(!t)throw Error("Expect width for: "+r);t[n.index]=n.width})})}),eP=(0,ey.atom)(null,function(e,t,n){t(eI,function(e){return(0,ex.produce)(e,function(e){var t=!0,r=!1,i=void 0;try{for(var o,a=e[Symbol.iterator]();!(t=(o=a.next()).done);t=!0)(0,ef._)(o.value,2)[1].slice(0,n)}catch(e){r=!0,i=e}finally{try{t||null==a.return||a.return()}finally{if(r)throw i}}})})}),eD=(0,ey.atom)(function(e){var t=new Map([["normal",0],["compact",0]]),n=!0,r=!1,i=void 0;try{for(var o,a=e(eI)[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var s=(0,ef._)(o.value,2),l=s[0],u=s[1],c=0,d=!0,f=!1,p=void 0;try{for(var h,g=u[Symbol.iterator]();!(d=(h=g.next()).done);d=!0){var m=h.value;void 0!==m&&(c+=m)}}catch(e){f=!0,p=e}finally{try{d||null==g.return||g.return()}finally{if(f)throw p}}t.set(l,c)}}catch(e){r=!0,i=e}finally{try{n||null==a.return||a.return()}finally{if(r)throw i}}return t}),eO=(0,ey.atom)(function(e){if("normal"===e(eN))return null;var t=e(eI).get("compact");if(!t)return null;var n=e(eR)-24,r=0,i=!0,o=!1,a=void 0;try{for(var s,l=t[Symbol.iterator]();!(i=(s=l.next()).done);i=!0){var u=s.value;if(void 0!==u){if((n-=u)>0){r++;continue}return r}}}catch(e){o=!0,a=e}finally{try{i||null==l.return||l.return()}finally{if(o)throw a}}return null}),eN=(0,ey.atom)(function(e){var t,n=e(eR);return(null!=(t=e(eD).get("normal"))?t:0)>n?"compact":"normal"}),eM=(0,e_.cssRecord)({item:[eC.rcss.viewStyle,eS.interactive.listItem,eC.rcss.p(6),eC.rcss.rowWithGap(4),eC.rcss.align.center,{fontSize:ek.tokens.fontSizeSmall}]});function eL(e){var t=(0,ef._)((0,a.useState)(null),2),n=t[0],r=t[1],i=null!==n&&(null==(d=e.items[n])?void 0:d.popover);if(i)return(0,o.jsx)(o.Fragment,{children:i});var s=[],l=!0,u=!1,c=void 0;try{for(var d,f,p=e.items[Symbol.iterator]();!(l=(f=p.next()).done);l=!0){var h=f.value;h.onClick||h.popover||s.push(h.key)}}catch(e){u=!0,c=e}finally{try{l||null==p.return||p.return()}finally{if(u)throw c}}return(0,o.jsx)(em.Menu,{disabledKeys:s,onAction:function(t){var n=!0,i=!1,o=void 0;try{for(var a,s=e.items[Symbol.iterator]();!(n=(a=s.next()).done);n=!0){var l=a.value;if(l.key===t){if(l.onClick){l.onClick();break}l.popover&&r(e.items.indexOf(l));break}}}catch(e){i=!0,o=e}finally{try{n||null==s.return||s.return()}finally{if(i)throw o}}},children:e.items.map(function(e){return(0,o.jsx)(em.MenuItem,{id:e.key,css:eM.item,children:(0,o.jsx)(eB.Provider,{value:function(){},children:(0,a.cloneElement)(e.item,{presentation:"overflowMenu"})})},e.key)})})}var eB=(0,a.createContext)(function(e){});function eV(){return(0,a.useContext)(eB)}var eF=(0,e_.cssRecord)({button:[eC.rcss.viewStyle,eC.rcss.reset.button,eC.rcss.rowWithGap(4),eC.rcss.center,eC.rcss.color.foregroundDimmest,eC.rcss.hover([eC.rcss.color.foregroundDefault]),eC.rcss.height("100%"),{fontSize:12,"&:has(*)":[eC.rcss.px(4),eS.interactive.nofill,eC.rcss.borderRadius(0)]}],tooltip:[eC.rcss.backgroundColor.backgroundHighest,eC.rcss.borderRadius(4),eC.rcss.color.foregroundDimmer,eC.rcss.p(4),eC.rcss.border({color:ek.tokens.outlineDefault}),{fontSize:12}]});function eU(e){var t=(0,ew.default)(function(t){return e.onWidth(t.width)}),n=(0,ef._)((0,a.useState)(null),2),r=n[0],i=n[1];return(0,o.jsx)(eT.View,{innerRef:t,children:(0,o.jsxs)(ev.TooltipTrigger,{isDisabled:null==r||e.hidden,children:[(0,o.jsx)(eh.Button,{isDisabled:e.isDisabled||e.hidden,css:eF.button,style:e.hidden?{opacity:0,pointerEvents:"none"}:void 0,onPress:function(){var t;return null==(t=e.onClick)?void 0:t.call(e)},children:(0,o.jsx)(eB.Provider,{value:i,children:e.children})}),(0,o.jsx)(ev.Tooltip,{placement:"top",offset:8,css:eF.tooltip,children:r})]})})}var eG=(0,e_.cssRecord)({root:[eC.rcss.position.relative,{"& > div:first-of-type > button":{borderBottomLeftRadius:4},"& > div:button:last-of-type > button":{borderBottomRightRadius:4}}],middle:[eC.rcss.flex.growAndShrink(1)],moreButton:[{width:24},eC.rcss.reset.button,eC.rcss.center,eS.interactive.nofill,eC.rcss.height("100%"),eC.rcss.position.absolute,eC.rcss.right(0),eC.rcss.top(0)]});function e$(e){var t=e.left.filter(Boolean),n=e.right.filter(Boolean),r=(0,ef._)((0,a.useState)(function(){return(0,ey.createStore)()}),1)[0],i=(0,eb.useAtomValue)(eN,{store:r}),s=(0,eb.useAtomValue)(eO,{store:r}),l=(0,eb.useSetAtom)(eA,{store:r}),u=(0,eb.useSetAtom)(eR,{store:r}),c=(0,ew.default)(function(e){return u(e.width)}),d=t.length-1,f=(0,ep._)(t).concat((0,ep._)(n)),p=(0,eb.useSetAtom)(eP,{store:r}),h=f.length;return(0,a.useEffect)(function(){p(h)},[p,h]),(0,o.jsx)(o.Fragment,{children:(0,o.jsxs)(eT.View,{className:e.className,css:eG.root,grow:!0,shrink:!0,row:!0,innerRef:c,children:[f.map(function(e,t){return e.popover?(0,o.jsxs)(a.Fragment,{children:[(0,o.jsxs)(eg.DialogTrigger,{children:[(0,o.jsx)(eU,{onWidth:function(e){return l({index:t,width:e})},hidden:null!==s&&t>=s,isDisabled:!e.popover&&!e.onClick,children:(0,a.cloneElement)(e.item,{presentation:i})}),(0,o.jsx)(ej.RawPopover,{placement:t<=d?"top left":"top right",children:e.popover})]}),t===d?(0,o.jsx)(eT.View,{css:eG.middle}):null]},e.key):(0,o.jsxs)(a.Fragment,{children:[(0,o.jsx)(eU,{onWidth:function(e){return l({index:t,width:e})},onClick:e.onClick,hidden:null!==s&&t>=s,isDisabled:!e.popover&&!e.onClick,children:(0,a.cloneElement)(e.item,{presentation:i})}),t===d?(0,o.jsx)(eT.View,{css:eG.middle}):null]},e.key+t)}),null===s?null:(0,o.jsxs)(eg.DialogTrigger,{children:[(0,o.jsx)(eh.Button,{css:eG.moreButton,children:(0,o.jsx)(eE.default,{size:12})}),(0,o.jsx)(ej.RawPopover,{placement:"top right",children:(0,o.jsx)(eL,{items:f.slice(s)})})]})]})})}e.s(["CodeEditorStatusBar",()=>e$,"useSetTooltip",()=>eV],690140),e.i(32109);var ez=e.i(926118),eH=e.i(127227),eW=e.i(960178),eq=e.i(266374),eK=e.i(217867);function eY(e){var t=e.presentation,n=(0,L.usePreferences)("codeSuggestion").preferences.codeSuggestion,r=eV();return(0,a.useEffect)(function(){r("compact"===t?"AI":null)},[r,t]),(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(eq.default,{size:12,color:n?ek.tokens.blurpleDefault:void 0}),"compact"===t?null:(0,o.jsx)(eT.View,{children:"AI"})]})}var eQ=(0,e_.cssRecord)({root:[eC.rcss.maxWidth(260)],featureTitle:[eC.rcss.fontWeight.medium]});function eX(){var e=(0,a.useId)(),t=(0,L.usePreferences)("codeSuggestion"),n=t.preferences.codeSuggestion,r=t.update;return(0,o.jsxs)(eT.View,{css:eQ.root,p:8,children:[(0,o.jsxs)(eT.View,{row:!0,gap:8,align:"center",children:[(0,o.jsxs)(eT.View,{css:eQ.featureTitle,grow:!0,shrink:!0,row:!0,gap:4,align:"center",children:[(0,o.jsx)(eK.default,{color:ek.tokens.blurpleDefault}),(0,o.jsx)(eW.Text,{children:"AI Autocomplete"})]}),(0,o.jsxs)(eT.View,{row:!0,gap:4,align:"center",children:[(0,o.jsx)(eT.View,{tag:"label",htmlFor:e,children:(0,o.jsx)(eW.Text,{color:"dimmer",variant:"small",children:"Enable"})}),(0,o.jsx)(eH.Checkbox,{id:e,checked:n,name:"Code Complete",onChange:function(){return r({codeSuggestion:!n})}})]})]}),(0,o.jsxs)(eT.View,{gap:8,children:[(0,o.jsx)(eW.Text,{color:"dimmer",variant:"small",children:"Suggest lines of code as you type based on existing context."}),(0,o.jsxs)(eT.View,{row:!0,gap:4,align:"center",children:[(0,o.jsx)(eW.Text,{color:"dimmer",variant:"small",children:"Press"}),(0,o.jsx)(ez.KeyComboBlocks,{small:!0,keyCombo:"Tab"}),(0,o.jsx)(eW.Text,{color:"dimmer",variant:"small",children:"to accept result"})]})]})]})}function eJ(){var e=(0,ed.default)();return(0,ed.isCodeCompleteFrontendEnabled)(e)?{item:(0,o.jsx)(eY,{}),popover:(0,o.jsx)(eX,{}),key:"ai"}:null}e.s(["useAiItem",()=>eJ],479166);var eZ=e.i(721281),e0=e.i(878420),e1=e.i(64386),e2=e.i(204179),e3=e.i(703613);e.i(694906);var e4=e.i(446692),e8=e.i(205104),e5=e.i(780671),e6=e.i(522682),e9=e.i(577811),e7=((t=e7||{})[t.Loading=0]="Loading",t[t.Ready=1]="Ready",t[t.Exited=2]="Exited",t[t.Stalled=3]="Stalled",t[t.Partial=4]="Partial",t[t.Missing=5]="Missing",t[t.Disabled=6]="Disabled",t),te=(0,ey.atom)(new Map),tt=(0,ey.atom)(null,function(e,t,n,r){t(te,function(e){return(0,ex.produce)(e,function(e){var t=e.get(n);t&&e.set(n,(0,e1._)((0,e0._)({},t),{state:r}))})})}),tn=(0,ey.atom)(null,function(e,t,n,r){t(te,function(e){return(0,ex.produce)(e,function(e){var t=e.get(n);t&&e.set(n,(0,e1._)((0,e0._)({},t),{health:r}))})})}),tr=(0,ey.atom)(null,function(e,t,n,r){t(te,function(e){return(0,ex.produce)(e,function(e){var i=new Set,o=!0,a=!1,s=void 0;try{for(var l,u=n[Symbol.iterator]();!(o=(l=u.next()).done);o=!0)!function(){var n,o=l.value;i.add(o.clientId),null==(n=e.get(o.clientId))||n.dispose(),e.set(o.clientId,{client:o,health:o.getServerHealth(),state:o.getServerState(),restart:function(){return r.restart(o.clientId)},dispose:(0,e6.combineDisposables)([o.onServerStateChange(function(e){return t(tt,o.clientId,e)}),o.onServerHealthChange(function(e){return t(tn,o.clientId,e)})])})}()}catch(e){a=!0,s=e}finally{try{o||null==u.return||u.return()}finally{if(a)throw s}}var c=!0,d=!1,f=void 0;try{for(var p,h=e.entries()[Symbol.iterator]();!(c=(p=h.next()).done);c=!0){var g=(0,ef._)(p.value,2),m=g[0],x=g[1].dispose;i.has(m)||(x(),e.delete(m))}}catch(e){d=!0,f=e}finally{try{c||null==h.return||h.return()}finally{if(d)throw f}}})})});function ti(e){switch(e){case 3:return 4;case 0:return 3;case 1:return 2;case 2:return 1;default:return 0}}function to(){return tu((0,a.useMemo)(function(){return(0,ey.atom)(function(e){var t;return null!=(t=Array.from(e(te).values()).map(function(e){return ta(e)}).sort(function(e,t){return ti(t)-ti(e)})[0])?t:5})},[]))}function ta(e){return e.health===e9.ServerHealth.STALLED?3:e.state===e9.ServerState.INITIALIZING||e.state===e9.ServerState.INITIALIZED&&e.health!==e9.ServerHealth.READY?0:e.health===e9.ServerHealth.READY?1:e.state===e9.ServerState.EXITED?2:5}function ts(e){return tu((0,a.useMemo)(function(){return(0,ey.atom)(function(t){var n=t(te).get(e);return n?ta(n):5})},[e]))}function tl(){return tu((0,a.useMemo)(function(){return(0,ey.atom)(function(e){return Array.from(e(te).values()).map(function(e){return{clientId:e.client.clientId,clientName:e.client.clientName,restart:function(){return e.restart()}}})})},[]))}function tu(e){return(0,eb.useAtomValue)(e,{store:function(){var e=(0,a.useContext)(tc);if(!e)throw Error("Expected store in context");return e}()})}var tc=(0,a.createContext)(null);function td(e){var t,n,r,i=(t=e.filePath,n=e.lspnix,r=(0,ef._)((0,a.useState)(function(){return(0,ey.createStore)()}),1)[0],(0,a.useEffect)(function(){return n.onClient(t,function(e){return r.set(tr,e,n)})},[t,n,r]),r);return(0,o.jsx)(tc.Provider,{value:i,children:e.children})}e.s(["CodeIntelligenceStatusProvider",()=>td,"useClients",()=>tl,"useCombinedStatusIconState",()=>to,"useServerState",()=>ts],142914);var tf=e.i(988676),tp=e.i(630818),th=e.i(679668),tg=e.i(21247),tm=e.i(257097),tv=e.i(451042),tx=e.i(840028),ty=e.i(940745);function tb(e){var t=e.filePath,n=e.presentation,r=(0,ee.useCodeEditorView)(),i=(0,e3.useCodeMirrorValue)(r,et.languageSupport),s=(0,a.useMemo)(function(){var e,n,r,o;return(r=null==(e=e4.FileTypeRepository.from(t))?void 0:e.name)?r:(r=null==i||null==(n=i.language)?void 0:n.name)&&r.length>0?(o=r).slice(0,1).toUpperCase()+o.slice(1).toLowerCase():(r=(0,e8.getExt)(t),i)?r:"Plain Text"},[t,i]),l=(0,e3.useCodeMirrorValue)(r,e2.SelectedProvider),u=(0,ef._)((0,a.useState)(l?{title:l.name,value:l.id}:void 0),2),c=u[0],d=u[1],f=(0,a.useRef)(!1);(0,a.useEffect)(function(){f.current||(null==c?void 0:c.value)!==(null==l?void 0:l.id)&&d(l?{title:l.name,value:l.id}:void 0)},[c,l]);var p=eV();(0,a.useEffect)(function(){p("Language support"+("compact"===n?" (".concat(s,")"):""))},[p,n,s]);var h=to();return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(tE,{state:h}),"compact"===n?null:(0,o.jsx)(eT.View,{children:s})]})}var tw=(0,e_.cssRecord)({menu:[eC.rcss.maxWidth(390),eC.rcss.minWidth(390)],file:[eC.rcss.pl(4),eC.rcss.display.inlineFlex,eC.rcss.rowWithGap(4),eC.rcss.align.center,{verticalAlign:"top"}],section:[eC.rcss.rowWithGap(8),eC.rcss.align.center,eC.rcss.justify.spaceBetween],header:[eC.rcss.colWithGap(2),eC.rcss.flex.shrink(1)],staticWidth:[eC.rcss.flex.grow(0),eC.rcss.flex.shrink(1)],variableWidth:[eC.rcss.flex.grow(1),eC.rcss.flex.shrink(0),{flexBasis:0}],flexEnd:[eC.rcss.align.end],red:[eC.rcss.color.redDefault],row:[eC.rcss.rowWithGap(8),eC.rcss.align.center]});function tk(e){var t=e.filePath,n=e.openSettings,s=(0,ee.useCodeEditorView)(),l=(0,U.default)().dotReplit,u=(0,e3.useCodeMirrorValue)(s,e2.SelectedProvider),c=(0,e3.useCodeMirrorValue)(s,e2.AvailableProviders),d=(0,ef._)((0,a.useState)(u?{title:u.name,value:u.id}:void 0),2),f=d[0],p=d[1],h=(0,a.useRef)(!1),g=(0,a.useMemo)(function(){var e;return null!=(e=null==c?void 0:c.map(function(e){return{title:e.name,value:e.id,icon:void 0}}))?e:[]},[c]);return(0,o.jsxs)(eT.View,{css:tw.menu,p:8,gap:8,children:[(0,o.jsxs)(eW.Header,{level:1,children:["Language support for ",(0,o.jsxs)("span",{css:tw.file,children:[(0,o.jsx)(tp.default,{path:t,size:16})," ",(0,o.jsx)("span",{children:(0,e8.getFileName)(t)})]})]}),(0,o.jsx)(tf.DividerH,{}),(0,o.jsx)(t_,{openSettings:n}),c&&f?(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(tf.DividerH,{}),(0,o.jsxs)(eT.View,{css:tw.section,children:[(0,o.jsx)(eT.View,{css:[tw.header,tw.staticWidth],children:(0,o.jsx)(eW.Text,{multiline:!1,children:"Code Formatter"})}),1===c.length?(0,o.jsx)(eT.View,{css:[tw.header,tw.variableWidth,tw.flexEnd],children:(0,o.jsx)(eW.Text,{multiline:!1,children:f.title})}):(0,o.jsx)(eT.View,{row:!0,gap:4,children:(0,o.jsx)(th.Select,{"aria-label":"Select code formatter",items:g,selectedItem:(0,e1._)((0,e0._)({},f),{icon:h.current?(0,o.jsx)(ty.default,{size:12}):void 0}),disabled:h.current,onChange:function(e){var n,o;"value"in e&&e.value===f.value||(h.current=!0,p(e),(n=l,o={path:t,formatterId:"value"in e?e.value:""},(0,r._)(function(){var e,t;return(0,i._)(this,function(r){return(e=".".concat((0,e5.getFileExtension)(o.path)),t="rules/formatter/fileExtensions/".concat(e,"/id"),o.formatterId)?[2,n.updateDotReplit([{path:"rules/formatter/fileExtensions",op:"add",value:JSON.stringify((0,eZ._)({},"".concat(e),{id:o.formatterId}))}])]:[2,n.updateDotReplit([{path:t,op:"remove"}])]})})()).finally(function(){return h.current=!1}))}})})]})]}):null]})}function t_(e){var t=e.openSettings,n=tl();return(0,o.jsxs)(o.Fragment,{children:[n.map(function(e){return(0,o.jsx)(eT.View,{css:tw.section,children:(0,o.jsx)(tC,{languageServerId:e.clientId,name:e.clientName,restart:function(){return e.restart()},openSettings:t})},e.clientId)}),0===n.length?(0,o.jsx)(eT.View,{css:tw.section,children:(0,o.jsx)(tj,{openSettings:t})}):null]})}function tS(e){var t=(0,o.jsx)("a",{tabIndex:0,role:"button",onClick:e.restart,onKeyDown:function(t){"Enter"===t.key&&e.restart()},children:"Restart"});switch(e.state){case 0:return(0,o.jsx)(eW.Text,{multiline:!1,color:"dimmer",children:"Loading"});case 1:return(0,o.jsx)(eW.Text,{multiline:!1,color:"dimmer",children:"Active"});case 3:return(0,o.jsxs)(eT.View,{css:tw.row,children:[(0,o.jsx)(eW.Text,{css:tw.red,multiline:!1,children:"Stalled"})," ",t]});case 2:return(0,o.jsxs)(eT.View,{css:tw.row,children:[(0,o.jsx)(eW.Text,{css:tw.red,multiline:!1,children:"Stopped"})," ",t]});default:return null}}function tC(e){var t=ts(e.languageServerId);switch(t){case 0:case 1:case 2:case 3:return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(eT.View,{css:[tw.header,tw.variableWidth],children:(0,o.jsx)(eW.Text,{multiline:!1,children:e.name})}),(0,o.jsx)(eT.View,{css:[tw.header,tw.staticWidth],children:(0,o.jsx)(tS,{restart:e.restart,state:t})})]});default:return null}}function tj(e){return(0,L.usePreferences)("codeIntelligence").preferences.codeIntelligence?(0,o.jsx)(eT.View,{css:tw.header,children:(0,o.jsx)(eW.Text,{color:"dimmer",children:"Limited language support because the language server is not available."})}):(0,o.jsx)(eT.View,{css:tw.header,children:(0,o.jsxs)(eW.Text,{multiline:!0,color:"dimmer",children:["Code intelligence is disabled. Enable it in settings.",(0,o.jsx)("br",{}),(0,o.jsx)("a",{tabIndex:0,role:"button",onClick:e.openSettings,onKeyDown:function(t){"Enter"===t.key&&e.openSettings()},children:"Open settings"})]})})}var tT=((n=tT||{})[n.Loading=0]="Loading",n[n.Ready=1]="Ready",n[n.Exited=2]="Exited",n[n.Stalled=3]="Stalled",n[n.Partial=4]="Partial",n[n.Missing=5]="Missing",n[n.Disabled=6]="Disabled",n);function tE(e){switch(e.state){case 3:case 6:case 4:return(0,o.jsx)(tx.default,{size:16});case 0:return(0,o.jsx)(ty.default,{size:16,color:ek.tokens.blueStronger});case 1:return(0,o.jsx)(eT.View,{dataCy:"ws-code-intelligence-active",children:(0,o.jsx)(tm.default,{size:16})});case 2:return(0,o.jsx)(tv.default,{size:16});case 5:return(0,o.jsx)(tg.default,{size:16})}}function tR(e){var t=e.filePath,n=e.openSettings;return{item:(0,o.jsx)(tb,{filePath:t,openSettings:n}),popover:(0,o.jsx)(tk,{openSettings:n,filePath:t}),key:"codeIntelligence"}}e.s(["useCodeIntelligence",()=>tR],798705);var tI=e.i(10581),tA=e.i(993796),tP=e.i(925978);function tD(e){var t=e.presentation,n=(0,F.default)(function(e){return(0,r._)(function(){var t,n,r,o;return(0,i._)(this,function(i){switch(i.label){case 0:return[4,e.getRepositoryState()];case 1:if((t=i.sent()).error)return[2,t];if(n=t.type,r=null,n===tI.GitRepositoryStateType.INITIALIZING)return[3,3];return[4,e.status()];case 2:if((o=i.sent()).error)return[2,o];r=o,i.label=3;case 3:return[2,{branchName:null==r?void 0:r.branch,error:null}]}})})()}),s=!n||n.error?null:n.branchName,l=eV();return(0,a.useEffect)(function(){l("compact"===t&&s?s:null)},[l,t,s]),s?(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(tP.default,{color:ek.tokens.foregroundDimmer,size:12}),"compact"===t?null:(0,o.jsx)(eT.View,{children:s})]}):null}function tO(e){return(0,tA.useFlag)({controlName:"flag-status-bar-branch",logFlagToAnalytics:!1})?{item:(0,o.jsx)(tD,{}),onClick:e,key:"currentBranch"}:null}e.s(["useCurrentBranchItem",()=>tO],82382);var tN=e.i(672199);e.i(508987);var tM=e.i(457103),tL=e.i(555970);function tB(e){if(e.facet(tL.Initializing))return"";var t=e.selection,n="",r=0;if(t.ranges.length>1){r=t.ranges.reduce(function(e,t){return e+(t.to-t.from)},0);var i=t.ranges.length;n="".concat(i," selections")}else{var o=t.ranges[0],a=e.doc.lineAt(o.head),s=o.head-a.from;r=o.to-o.from,n="Ln ".concat(a.number,", Col ").concat(s+1)}return r>0&&(n+=" (".concat(r," chars)")),n}function tV(e){var t=e.view,n=(0,a.useRef)(null);return(0,a.useEffect)(function(){var e,r=n.current,i=null!=(e=t.plugin(e3.StateListenerPlugin))?e:null;if(r&&i&&!i.destroyed){var o=null,a=t.state;r.textContent=tB(a);var s=i.bind({changed:function(e){return(0,tM.hasChanged)(e,"selection",tL.Initializing)},callback:function(e){a=e.state,null===o&&(o=requestAnimationFrame(function(){o=null,r.textContent=a?tB(a):""}))}});return function(){s(),null!==o&&cancelAnimationFrame(o),r.textContent=""}}},[t]),(0,o.jsx)("span",{ref:n,"data-cy":"current-position"})}function tF(){var e=(0,ee.useCodeEditorView)();return e?{item:(0,o.jsx)(tV,{view:e}),onClick:function(){return(0,tN.gotoLine)(e)},key:"currentPosition"}:null}e.s(["useCurrentPositionItem",()=>tF],405146);var tU=e.i(961864);function tG(e){var t=e.presentation,n=eV();return(0,a.useEffect)(function(){n("compact"===t?"History":null)},[n,t]),(0,o.jsxs)(o.Fragment,{children:["compact"===t?null:(0,o.jsx)(eT.View,{children:"History"}),(0,o.jsx)(tU.default,{size:12})]})}function t$(e){var t=e.filePath,n=e.performPaneOperation,r=(0,a.useCallback)(function(){n({operation:"replace",pane:{type:"history",data:{path:t}}})},[n,t]);return{item:(0,o.jsx)(tG,{}),key:"history",onClick:r}}e.s(["useHistoryItem",()=>t$],630162);var tz=e.i(753950),tH=e.i(348320),tW=e.i(963323);function tq(e,t,n){var r=[],i=0,o=!0,a=!1,s=void 0;try{for(var l,u=e.iterLines()[Symbol.iterator]();!(o=(l=u.next()).done);o=!0){var c=l.value,d=i;if(i=i+c.length+1,0!==c.length){var f=(0,tW.numColumns)(c,t),p=c.trimStart(),h=d+(c.length-p.length);if(0!==f&&d!==h){var g="";if(n===tH.IndentationType.TABS){var m=Math.floor(f/t),x=f%t;g="	".repeat(m)+" ".repeat(x)}else n===tH.IndentationType.SPACES&&(g=" ".repeat(f));g+p!==c&&r.push({from:d,to:h,insert:g})}}}}catch(e){a=!0,s=e}finally{try{o||null==u.return||u.return()}finally{if(a)throw s}}return tz.ChangeSet.of(r,e.length)}function tK(e,t,n,r){if(t===tH.IndentationType.TABS)return tz.ChangeSet.empty(e.length);var i=" ".repeat(r),o=[],a=0,s=!0,l=!1,u=void 0;try{for(var c,d=e.iterLines()[Symbol.iterator]();!(s=(c=d.next()).done);s=!0){var f=c.value,p=a;if(a=a+f.length+1,0!==f.length){var h=(0,tW.numColumns)(f,n),g=f.trimStart(),m=p+(f.length-g.length);if(0!==h&&p!==m){var x=Math.floor(h/n),y=h%n,b=i.repeat(x)+" ".repeat(y);b+g!==f&&o.push({from:p,to:m,insert:b})}}}}catch(e){l=!0,u=e}finally{try{s||null==d.return||d.return()}finally{if(l)throw u}}return tz.ChangeSet.of(o,e.length)}e.s(["convertIndentationSizeChangeSet",()=>tK,"convertIndentationTypeChangeSet",()=>tq],715571)},683426,810206,641209,808229,e=>{"use strict";var t=e.i(878420),n=e.i(276385),r=e.i(389959),i=e.i(529810),o=e.i(479166),a=e.i(690140),s=e.i(798705),l=e.i(142914),u=e.i(82382),c=e.i(405146),d=e.i(630162),f=e.i(64386),p=e.i(886513),h=e.i(530658),g=e.i(346715),m=e.i(486701),x=e.i(753950),y=e.i(715571),b=e.i(716343),w=e.i(348320),k=e.i(555970),_=e.i(703613),S=e.i(205104),C=e.i(61524),j=e.i(556088),T=e.i(721281),E=e.i(446530),R=e.i(613355),I=e.i(428596),A=e.i(965153),P=e.i(960178),D=e.i(625484),O="@container (max-width: 480px)",N=(0,E.cssRecord)({wrapper:[(0,T._)({},O,[R.rcss.colWithGap(8),R.rcss.align.start])]});function M(e){var t=e.id,i=e.title,o=e.children,a=e.variant,s=(0,I.useIdSeed)()(t),l="default"===(void 0===a?"default":a);return(0,n.jsxs)(D.View,{css:N.wrapper,gap:8,row:l,justify:l?"space-between":void 0,align:l?"center":void 0,children:[(0,n.jsx)(D.View,{grow:!0,shrink:!0,tag:"label",htmlFor:s,children:"string"==typeof i?(0,n.jsx)(P.Text,{multiline:!1,children:i}):i}),(0,r.cloneElement)(o,{id:s})]})}function L(e){var t=e.title,i=e.defaultExpanded,o=e.children,a=(0,h._)((0,r.useState)(void 0!==i&&i),2),s=a[0],l=a[1];return(0,n.jsx)(A.AccordionItem,{headerContent:(0,n.jsx)(P.Text,{variant:"subheadDefault",children:t}),expanded:s,onClick:function(){return l(!s)},children:(0,n.jsx)(D.View,{p:4,gap:12,children:o})})}e.s(["COLUMN_LAYOUT_BREAKPOINT",()=>O,"CollapsibleSection",()=>L,"Section",()=>M],810206);var B=e.i(140487),V=e.i(85742),F=e.i(624782),U=e.i(12034),G=e.i(112767),$=(0,E.cssRecord)({select:[R.rcss.minWidth(200),{button:{border:"0 none"}}],wrapper:[R.rcss.rowWithGap(8),R.rcss.align.center,(0,T._)({},O,[R.rcss.flex.rowReverse])],rightComponentWrapper:(0,T._)({},O,[R.rcss.ml(8)]),titleHeading:[R.rcss.center,R.rcss.justify.start],staffOnlyPill:[R.rcss.height(18)]});function z(e){var t=e.children,r=e.settingName,i=e.settingDescription,o=e.settingId,a=e.title,s=e.rightComponent,l=e.isStaffOnly,u=a;return a||(u=i?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(D.View,{css:$.titleHeading,row:!0,gap:8,children:[(0,n.jsx)(P.Text,{multiline:!1,children:r}),l?(0,n.jsx)(F.Pill,{css:$.staffOnlyPill,text:"Staff-only",colorway:"warning"}):null]}),(0,n.jsx)(P.Text,{variant:"small",color:"dimmest",children:i})]}):(0,n.jsx)(P.Text,{multiline:!1,children:r})),(0,n.jsx)(M,{id:o,title:u,children:(0,n.jsxs)(D.View,{css:$.wrapper,children:[s?(0,n.jsx)(D.View,{css:$.rightComponentWrapper,children:s}):null,t]})})}function H(e){var t=e.setting,r=e.currentValue,i=e.update,o=e.rightComponent,a=e.filterOptions,s=e.title;if("select"===t.type){var l,u=a?t.options.filter(a):t.options;return(0,n.jsx)(z,{settingName:t.name,settingDescription:t.description,settingId:t.id,title:s,rightComponent:o,children:(0,n.jsx)(U.Select,{"aria-label":t.name,style:{marginRight:0},items:u,defaultSelectedKey:null==(l=u.find(function(e){return r===e.editorPreferencesValue}))?void 0:l.id,onSelectionChange:function(e){var n;if("string"!=typeof t.editorPreferencesKey)throw Error("Setting does not have an editorPreferencesKey");i((0,T._)({},t.editorPreferencesKey,null==(n=u.find(function(t){return t.id===e}))?void 0:n.editorPreferencesValue))},css:$.select,dataCy:t.id,children:function(e){return(0,n.jsx)(V.ListBoxItem,{id:e.id,label:e.title,dataCy:e.id,fixedHeight:32},e.id)}})})}if("boolean"===t.type)return(0,n.jsx)(z,{settingName:t.name,settingDescription:t.description,settingId:t.id,title:s,rightComponent:o,children:(0,n.jsx)(G.Switch,{"aria-label":t.name,isSelected:r,onChange:function(e){if("string"!=typeof t.editorPreferencesKey)throw Error("Setting does not have an editorPreferencesKey");i((0,T._)({},t.editorPreferencesKey,e))},dataCy:t.id})});throw Error("Unsupported setting type")}function W(e){var t,r=e.setting,i=e.currentValueOption,o=e.disabledReason,a=(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(P.Text,{multiline:!1,children:r.name}),(0,n.jsx)(P.Text,{variant:"small",color:"dimmest",children:o})]});return(0,n.jsx)(M,{id:r.id,title:a,children:(0,n.jsx)(D.View,{css:$.wrapper,children:i?(0,n.jsx)(B.Button,{text:null!=(t=null==i?void 0:i.title)?t:"Disabled",disabled:!0}):null})})}e.s(["DisabledEditorSettingBox",()=>W,"EditorSettingBox",()=>H],641209);var q=e.i(988676),K=e.i(607278),Y=[{value:"spaces",title:"spaces"},{value:"tabs",title:"tabs"}],Q=(0,E.cssRecord)({sizeInput:[R.rcss.py(6),R.rcss.flex.growAndShrink(0),{border:"none"}]});function X(){var e=(0,C.usePreferences)("indentDetection","indentFormatPastes","indentIsSpaces","indentSize"),t=e.preferences,r=e.update;return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(H,{setting:j.userPreferences.indentationDetection,currentValue:t.indentDetection,update:r}),(0,n.jsx)(q.DividerH,{}),(0,n.jsx)(H,{setting:j.userPreferences.indentFormatPastes,currentValue:t.indentFormatPastes,update:r}),(0,n.jsx)(q.DividerH,{}),(0,n.jsx)(H,{setting:j.userPreferences.indentIsSpaces,currentValue:t.indentIsSpaces,update:r}),(0,n.jsx)(q.DividerH,{}),(0,n.jsx)(M,{id:"indentSize",title:(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(P.Text,{multiline:!1,children:"Indentation Size"}),(0,n.jsx)(P.Text,{variant:"small",color:"dimmest",children:"The number of columns taken up by an indentation level."})]}),children:(0,n.jsx)(Z,{css:Q.sizeInput,size:t.indentSize,onChange:function(e){r({indentSize:e})}})})]})}function J(e){return null==e||("string"==typeof e&&(e=parseInt(e,10)),isNaN(e))?2:(Number.isInteger(e)||(e=Math.round(e)),e<1)?1:e>16?16:e}function Z(e){var t=e.size,i=e.onChange,o=e.className,a=(0,h._)((0,r.useState)(null),2),s=a[0],l=a[1],u=null!==s?s:t.toString(),c=""===u?"6ch":u.length+5.5+"ch";return(0,n.jsx)(K.Input,{type:"number",style:{width:c},className:o,min:1,max:16,value:u,onBlur:function(){return l(null)},onChange:function(e){var t=e.target.value.trim(),n=e.target.valueAsNumber;""===t||isNaN(n)?l(t):e.target.validity.valid?(l(null),i(J(n))):(l(t),""===t||isNaN(parseInt(t,10))||i(J(t)))}})}e.s(["IndentationSizeInput",()=>Z,"default",()=>X,"indentTypeItems",()=>Y],808229);var ee=e.i(564169),et=e.i(480028),en=e.i(630818),er=e.i(396776),ei=e.i(679668),eo=e.i(616278),ea=e.i(606867),es=e.i(940745),el=e.i(121817),eu=e.i(357399),ec=e.i(273191),ed=e.i(42458),ef=(0,E.cssRecord)({menu:[R.rcss.maxWidth(410)],file:[R.rcss.pl(4),R.rcss.display.inlineFlex,R.rcss.rowWithGap(4),R.rcss.align.center,{verticalAlign:"top"}],section:[R.rcss.rowWithGap(8),R.rcss.align.center,R.rcss.justify.spaceBetween],header:[R.rcss.colWithGap(2),R.rcss.flex.shrink(1)],sizeInput:{border:"none"}});function ep(e){var t,i=e.filePath,o=e.openSettings,a=(0,C.usePreferences)("indentDetection","indentSize").preferences,s=(0,ee.useCodeEditorView)(),l=(0,_.useCodeMirrorValue)(s,k.Initializing),u=null!==l&&!!a.indentDetection&&l,c=(0,_.useCodeMirrorValue)(s,b.FileTypeIndentationType),d=(0,_.useCodeMirrorValue)(s,b.DetectedIndentation),f=(0,_.useCodeMirrorValue)(s,b.CanDetectIndentation),p=null!=(t=(0,_.useCodeMirrorValue)(s,x.EditorState.tabSize))?t:a.indentSize,j="	"===(0,_.useCodeMirrorValue)(s,m.indentUnit)?w.IndentationType.TABS:w.IndentationType.SPACES,T=(0,h._)((0,r.useState)(!1),2),E=T[0],R=T[1],I=(0,h._)((0,r.useState)(j),2),A=I[0],O=I[1],N=(0,h._)((0,r.useState)(p),2),M=N[0],L=N[1],V=(0,h._)((0,r.useState)(!1),2),F=V[0],U=V[1],G=(0,h._)((0,r.useState)(!1),2),$=G[0],z=G[1],H=(0,h._)((0,r.useState)(!1),2),W=H[0],K=H[1],Q=(0,h._)((0,r.useState)(!1),2),X=Q[0],J=Q[1];(0,r.useEffect)(function(){F||(O(j),L(p))},[j,p,F]),(0,r.useEffect)(function(){E||(O(j),L(p),U(!1))},[E,j,p]),(0,r.useEffect)(function(){A===j&&M===p&&U(!1)},[A,M,j,p]),(0,r.useEffect)(function(){if($||W||X){var e=setTimeout(function(){z(!1),K(!1),J(!1)},1e3);return function(){return clearTimeout(e)}}},[$,W,X]),u&&E&&R(!1);var et=(0,r.useCallback)(function(){if(s){var e=(0,y.convertIndentationTypeChangeSet)(s.state.doc,p,j);s.dispatch({changes:e,effects:b.forceIndentationDetection.of(!0)}),K(!0)}},[s,j,p]),ea=(0,r.useCallback)(function(){s&&(s.dispatch({effects:b.forceIndentationDetection.of(!0)}),s.state.field(b.DetectedIndentation)&&s.dispatch({effects:b.setIndentationOverride.of({type:void 0,size:void 0})}),J(!0))},[s]),es=(0,r.useCallback)(function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(s){var t=void 0,n=[b.setIndentationOverride.of({type:A,size:M})];if(e){if(A!==j&&(t=(0,y.convertIndentationTypeChangeSet)(s.state.doc,p,A)),A===w.IndentationType.SPACES&&M!==p){var r=t?t.apply(s.state.doc):s.state.doc,i=(0,y.convertIndentationSizeChangeSet)(r,A,p,M);t=t?t.compose(i):i}t&&n.push(b.forceIndentationDetection.of(!0))}s.dispatch({changes:t,effects:n}),U(!1),z(!0)}},[s,j,p,A,M]),ep=(0,r.useCallback)(function(){R(!1),o()},[o]),eh=(0,r.useMemo)(function(){if(d){var e=d.size,t=d.type===w.IndentationType.SPACES?"spaces":"tabs";return"This file appears to use a unit of ".concat(e," ").concat(t,".")}return f?"Indentation detection hasn't been run on this file yet.":"This file is too small for indentation detection."},[d,f]);return(0,n.jsxs)(D.View,{css:ef.menu,p:8,gap:8,children:[(0,n.jsxs)(P.Header,{level:1,children:["Indentation for",(0,n.jsxs)("span",{css:ef.file,children:[(0,n.jsx)(en.default,{path:i,size:16})," ",(0,n.jsx)("span",{children:(0,S.getFileName)(i)})]})]}),c?(0,n.jsx)(er.StatusBanner,{colorway:"warning",icon:(0,n.jsx)(ed.default,{}),text:"This file type requires that ".concat(c===w.IndentationType.SPACES?"spaces":"tabs"," be used for indentation.")}):null,(0,n.jsx)(q.DividerH,{}),(0,n.jsxs)(D.View,{css:ef.section,children:[(0,n.jsxs)(D.View,{css:ef.header,children:[(0,n.jsx)(P.Text,{multiline:!1,children:"Indentation unit"}),(0,n.jsx)(P.Text,{variant:"small",color:"dimmer",children:"The size and character to use when indenting lines."})]}),(0,n.jsxs)(D.View,{row:!0,gap:4,children:[(0,n.jsx)(Z,{css:ef.sizeInput,size:M,onChange:function(e){e!==M&&(L(e),U(!0))}}),(0,n.jsx)(ei.Select,{"aria-label":"Select indentation type",items:(0,g._)(Y),selectedItem:Y.find(function(e){return e.value===(A===w.IndentationType.SPACES?"spaces":"tabs")}),onChange:function(e){var t=(null==e?void 0:e.value)==="spaces"?w.IndentationType.SPACES:w.IndentationType.TABS;t!==A&&(O(t),U(!0))}})]})]}),(0,n.jsx)(q.DividerH,{}),a.indentDetection?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(D.View,{css:ef.section,children:[(0,n.jsxs)(D.View,{css:ef.header,children:[(0,n.jsx)(P.Text,{multiline:!1,children:"Detected indentation unit"}),(0,n.jsx)(P.Text,{variant:"small",color:"dimmer",children:eh})]}),X?(0,n.jsx)(B.Button,{colorway:"positive",text:"Detected!",iconLeft:(0,n.jsx)(eo.default,{}),onClick:ea}):(0,n.jsx)(B.Button,{text:d?"Re-detect":"Detect",iconLeft:(0,n.jsx)(el.default,{}),disabled:!f&&!d,onClick:ea})]}),(0,n.jsx)(q.DividerH,{})]}):null,(0,n.jsxs)(D.View,{row:!0,gap:8,align:"center",justify:"space-between",children:[(0,n.jsx)(B.Button,{text:"Global settings",iconLeft:(0,n.jsx)(eu.default,{}),onClick:ep}),(0,n.jsx)(D.View,{row:!0,gap:4,children:$||W?(0,n.jsx)(n.Fragment,{children:$?(0,n.jsx)(B.Button,{text:"Saved!",colorway:"positive",iconLeft:(0,n.jsx)(eo.default,{}),onClick:function(){return es(!1)}}):(0,n.jsx)(B.Button,{text:"Re-indented!",colorway:"positive",iconLeft:(0,n.jsx)(eo.default,{}),onClick:et})}):(0,n.jsx)(n.Fragment,{children:F?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(B.Button,{text:"Save and re-indent",colorway:"primary",iconLeft:(0,n.jsx)(ec.default,{}),onClick:function(){return es(!0)}}),(0,n.jsx)(B.Button,{text:"Save",iconLeft:(0,n.jsx)(eo.default,{}),onClick:function(){return es(!1)}})]}):(0,n.jsx)(B.Button,{text:"Re-indent file",iconLeft:(0,n.jsx)(ec.default,{}),onClick:et})})})]})]})}function eh(e){var t,i=e.presentation,o=(0,C.usePreferences)("indentDetection","indentSize").preferences,s=(0,ee.useCodeEditorView)(),l=(0,_.useCodeMirrorValue)(s,k.Initializing),u=null!==l&&!!o.indentDetection&&l,c=null!=(t=(0,_.useCodeMirrorValue)(s,x.EditorState.tabSize))?t:o.indentSize,d="	"===(0,_.useCodeMirrorValue)(s,m.indentUnit)?w.IndentationType.TABS:w.IndentationType.SPACES,f=(0,a.useSetTooltip)();return(0,r.useEffect)(function(){f("File Indentation")},[f]),(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(em,{type:d,loading:u}),"compact"===i?null:(0,n.jsx)(ev,{type:d,size:c,loading:u})]})}function eg(e){var r=e.size,i=void 0===r?16:r,o=(0,p._)(e,["size"]);return(0,n.jsx)(ea.default,(0,f._)((0,t._)({size:i},o),{children:(0,n.jsx)("circle",{cx:i,cy:i,r:i/2,fillRule:"evenodd"})}))}function em(e){var t=e.type;return e.loading?(0,n.jsx)(es.default,{size:12}):t===w.IndentationType.SPACES?(0,n.jsx)(eg,{color:et.tokens.foregroundDimmer,size:12}):(0,n.jsx)(ec.default,{color:et.tokens.foregroundDimmer,size:12})}function ev(e){var t=e.type,r=e.size;if(e.loading)return(0,n.jsx)(P.Text,{variant:"small",color:"dimmest",children:"Detecting..."});var i=t===w.IndentationType.SPACES?"Spaces":"Tabs";return(0,n.jsxs)(P.Text,{variant:"small",color:"dimmer",children:[i,": ",r]})}var ex=e.i(333859),ey=e.i(97149),eb=e.i(546284),ew=e.i(485237),ek=e.i(214989),e_=(0,E.cssRecord)({group:[R.rcss.align.center,R.rcss.rowWithGap(4)]});function eS(e){var t,i,o,s,l,u,c,d=e.filePath,f=e.presentation,p=(t=d,o=(i=(0,h._)((0,r.useState)(null),2))[0],s=i[1],l=(0,ew.default)(t),(0,r.useEffect)(function(){var e=function(e){if(e.path===t){var n=[],r=!0,i=!1,o=void 0;try{for(var a,u=l[Symbol.iterator]();!(r=(a=u.next()).done);r=!0){var c=a.value;c.isOpen(t)&&n.push.apply(n,(0,g._)(c.getDiagnostics(e.path)))}}catch(e){i=!0,o=e}finally{try{r||null==u.return||u.return()}finally{if(i)throw o}}s(n)}},n=[],r=!0,i=!1,o=void 0;try{for(var a,u=l[Symbol.iterator]();!(r=(a=u.next()).done);r=!0){var c=a.value;c.isOpen(t)&&n.push.apply(n,(0,g._)(c.getDiagnostics(t)))}}catch(e){i=!0,o=e}finally{try{r||null==u.return||u.return()}finally{if(i)throw o}}s(n);var d=[],f=!0,p=!1,h=void 0;try{for(var m,x=l[Symbol.iterator]();!(f=(m=x.next()).done);f=!0){var y=m.value;d.push(y.onDiagnostics(function(t){return e(t)}))}}catch(e){p=!0,h=e}finally{try{f||null==x.return||x.return()}finally{if(p)throw h}}return function(){d.forEach(function(e){return e()})}},[l,t]),o),m=(0,r.useMemo)(function(){var e,t;return p?(t=(e=p).reduce(function(e,t){return void 0===t.severity||(e[t.severity]=(e[t.severity]||0)+1),e},{}),e.length>0&&0===Object.keys(t).length&&(t[ex.DiagnosticSeverity.Error]=e.length),t):null},[p]),x=m&&null!=(u=m[ex.DiagnosticSeverity.Error])?u:0,y=m&&null!=(c=m[ex.DiagnosticSeverity.Warning])?c:0,b=null===m,w=(0,a.useSetTooltip)();return((0,r.useEffect)(function(){if(b)return void w(null);var e="";0===x&&0===y&&(e="No problems"),x>0&&(e+="".concat((0,eb.default)("Error",x),": ").concat(x)),y>0&&(e.length>0&&(e+=", "),e+="".concat((0,eb.default)("Warning",y),": ").concat(y)),w(e)},[w,f,b,y,x]),m)?(0,n.jsxs)(D.View,{align:"center",row:!0,gap:8,children:[(0,n.jsxs)(D.View,{css:e_.group,children:[(0,n.jsx)(ek.default,{severity:ex.DiagnosticSeverity.Error,size:12}),"compact"===f?null:(0,n.jsx)(P.Text,{color:"dimmer",variant:"small",multiline:!1,children:String(x)})]}),(0,n.jsxs)(D.View,{css:e_.group,children:[(0,n.jsx)(ek.default,{severity:ex.DiagnosticSeverity.Warning,size:12}),"compact"===f?null:(0,n.jsx)(P.Text,{color:"dimmer",variant:"small",multiline:!1,children:String(y)})]})]}):null}var eC=e.i(403781),ej=e.i(993796),eT=e.i(189373);function eE(e){var t=e.presentation,i=e.toggled?"Diffing":"Diff",o=(0,a.useSetTooltip)();return(0,r.useEffect)(function(){o("compact"===t?i:null)},[o,t,i]),(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(eT.default,{color:et.tokens.foregroundDimmer,size:12}),"compact"===t?null:(0,n.jsx)(D.View,{children:i})]})}var eR=e.i(301988),eI=(0,E.cssRecord)({text:[{textTransform:"capitalize"}]});function eA(t){var i=t.presentation,o=(0,h._)((0,r.useState)(null),2),s=o[0],l=o[1],u=(0,r.useRef)(null),c=(0,r.useRef)(null),d=(0,a.useSetTooltip)(),f=(0,ee.useCodeEditorView)(),p=(0,C.usePreferences)("keyboardHandler").preferences,g=(null==p?void 0:p.keyboardHandler)==="vim",m=(0,r.useCallback)(function(e){var t=null!=e?e:"";if(f&&s&&void 0===e){var n,r,o=s.getCM(f);t=null!=(r=null==o||null==(n=o.state.vim)?void 0:n.mode)?r:"normal"}d("compact"===i?t:null),c.current=t,u.current&&u.current.innerText!==t&&(u.current.innerText=t||"")},[f,s,d,i]);return(0,r.useEffect)(function(){g&&!s&&e.A(441994).then(function(e){l(e),m()})},[g,s,m]),(0,r.useEffect)(function(){if(f&&g&&s){var e,t=u.current,n=null!=(e=f.plugin(_.StateListenerPlugin))?e:null;if(t&&n&&!n.destroyed)return n.bind({changed:function(){var e,t,n=s.getCM(f),r=null!=(t=null==n||null==(e=n.state.vim)?void 0:e.mode)?t:"";return c.current!==r},callback:function(){m()}})}},[f,g,s,m]),g?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(eR.default,{size:12}),"compact"===i?null:(0,n.jsx)("span",{css:eI.text,ref:u})]}):null}var eP=(0,E.cssRecord)({root:[{borderTop:"1px solid ".concat(et.tokens.backgroundHigher)},{height:"29px",contain:"strict"}]}),eD=(0,r.memo)(function(e){var t,i,l,f,p,h,g,m,x,y,b,w,k,S=e.filePath,C=e.performPaneOperation,j=(0,r.useCallback)(function(e){return C({operation:"open",pane:e,secondary:!0})},[C]),T=(0,r.useCallback)(function(){return j({type:"preferences"})},[j]),E=(0,o.useAiItem)(),R=(0,s.useCodeIntelligence)({filePath:S,openSettings:T}),I=(t=(0,ee.useCodeEditorView)(),{item:(0,n.jsx)(eS,{filePath:S}),onClick:t?function(){return(0,ey.toggleLintPanel)(t)}:void 0,key:"lspDiagnostics"}),A=(0,u.useCurrentBranchItem)(function(){return j({type:"git"})}),P=(i=(0,ej.useFlag)({controlName:"flag-editor-git-inline-diff",logFlagToAnalytics:!1}),m=(l=(0,ee.useCodeEditorView)(),f=(0,_.useCodeMirrorValue)(l,eC.GitDiffState),p=!l||!f||null===f.head,h=(null==f?void 0:f.mode)===eC.GitDiffMode.INLINE_DIFF,g={toggle:(0,r.useCallback)(function(){if(!l)return null;l.dispatch({effects:eC.setGitDiffMode.of(h?eC.GitDiffMode.GUTTER_DIFF:eC.GitDiffMode.INLINE_DIFF)})},[l,h]),toggled:h,disabled:p}).toggle,x=g.toggled,y=g.disabled,i&&!y?{item:(0,n.jsx)(eE,{toggled:x}),onClick:m,key:"toggleDiff"}:null),D={item:(0,n.jsx)(eA,{}),key:"vimMode"},O=(0,c.useCurrentPositionItem)(),N=(0,d.useHistoryItem)({filePath:S,performPaneOperation:C}),M=(w=(b={filePath:S,openSettings:T}).filePath,k=b.openSettings,{item:(0,n.jsx)(eh,{}),popover:(0,n.jsx)(ep,{filePath:w,openSettings:k}),key:"indentation"});return(0,n.jsx)(a.CodeEditorStatusBar,{css:eP.root,left:[E,R,I,A,P,D],right:[O,M,N]})});function eO(e){var r=(0,i.default)().lspnix;return(0,n.jsx)(l.CodeIntelligenceStatusProvider,{filePath:e.filePath,lspnix:r,children:(0,n.jsx)(eD,(0,t._)({},e))})}e.s(["CodeEditorStatusBarWithLSP",()=>eO],683426)},493602,e=>{"use strict";var t=e.i(276385),n=e.i(389959),r=e.i(188507),i=e.i(877212),o=e.i(10681),a=e.i(698053),s=e.i(62424),l=e.i(482070),u=e.i(109853),c=e.i(683426),d=e.i(151386),f=e.i(417120),p=e.i(446530),h=e.i(613355),g=e.i(625484),m=(0,p.cssRecord)({root:[h.rcss.position.relative,h.rcss.flex.column,h.rcss.overflowY("hidden"),h.rcss.width("100%"),h.rcss.height("100%")]});function x(e){var p=(0,n.useRef)(null),h=(0,a.default)(),x=(0,i.useSupportsAgent)(),y=(0,f.useAgentRunState)(),b=x&&(y===r.AgentRunState.AGENT_STATE_RUNNING||y===r.AgentRunState.AGENT_STATE_PAUSING),w=(0,d.useFilePaneFlag)();return(0,t.jsxs)(g.View,{innerRef:p,css:m.root,children:[w?null:(0,t.jsx)(s.CodeEditorHeader,{performPaneOperation:e.performPaneOperation,path:e.filePath,isReadOnly:b}),(0,t.jsx)("div",{css:u.CodeMirrorEditorStyleRoot,children:(0,t.jsx)(l.default,{filePath:e.filePath,hideMobileKeyboardToolbar:e.hideMobileKeyboardToolbar,isHidden:e.isHidden,isReadOnly:b,isReadOnlyWhileAgentWorking:b,deeplink:e.deeplink,onDeeplinkUpdated:e.onDeeplinkUpdated,performPaneOperation:e.performPaneOperation})}),(0,t.jsx)("div",{style:{display:h?"none":"block"},children:(0,t.jsx)(c.CodeEditorStatusBarWithLSP,{filePath:e.filePath,performPaneOperation:e.performPaneOperation})}),e.hideMobileKeyboardToolbar?null:(0,t.jsx)(o.default,{filePath:e.filePath,isLoading:!1})]})}e.s(["default",()=>x])},800633,e=>{"use strict";var t=e.i(530658),n=e.i(276385),r=e.i(389959),i=e.i(903381),o=e.i(529810),a=e.i(446530),s=e.i(613355),l=e.i(396776),u=e.i(625484),c=e.i(42458);function d(e){var n=e.path,a=e.replaceEditorPath,s=e.getFileRenameInProgress,l=(0,o.default)().fs,u=(0,t._)((0,r.useState)(null),2),c=u[0],d=u[1];return(0,r.useEffect)(function(){if(n){if(n.startsWith("/"))return d('Cannot open "'.concat(n,'"')),function(){d(null)};var e=l.watchPathStat(n,{onNewStat:function(e){var t=s();e.exists?e.type===i.FileType.Directory?d('"'.concat(n,'" is a directory')):d(null):(null==t?void 0:t.from)===n?a(t.to):d('No file found at "'.concat(n,'", it may have been deleted'))},onError:function(){d('Unknown error occured while read "'.concat(n,'", try re-opening the editor'))}});return function(){e(),d(null)}}},[s,l,n,a]),c}var f=(0,a.cssRecord)({root:[s.rcss.coverContainer,s.rcss.center,s.rcss.p(16)]});function p(e){var t=e.message;return(0,n.jsx)(u.View,{css:f.root,children:(0,n.jsx)(u.View,{children:(0,n.jsx)(l.StatusBanner,{icon:(0,n.jsx)(c.default,{}),colorway:"orange",text:t})})})}e.s(["WatchFileErrorMessage",()=>p,"useWatchFileError",()=>d])},162540,e=>{"use strict";var t=e.i(878420),n=e.i(64386),r=e.i(530658),i=e.i(346715),o=e.i(276385),a=e.i(389959),s=e.i(960933),l=e.i(862927),u=e.i(541793),c=e.i(486701),d=e.i(682532),f=e.i(893255);e.i(440545);var p=e.i(214705),h=e.i(915599),g=e.i(122947),m=e.i(496216),x=e.i(703613),y=e.i(205104),b=e.i(61524),w=e.i(125674),k=e.i(441329),_=e.i(493602),S=e.i(106020),C=e.i(185511),j=e.i(800633),T=e.i(181227),E=e.i(564169);e.i(282890);var R=e.i(716636);e.i(545082);var I=e.i(91442),A=e.i(423111),P=e.i(259493),D=e.i(965863),O=e.i(630818),N=e.i(460508),M=e.i(782096),L=e.i(857714),B=e.i(841691),V=e.i(90102),F=e.i(525212),U=e.i(961864),G=e.i(260310),$=e.i(805938),z=s.Type.Object({type:s.Type.Literal("codeEditor"),data:s.Type.Object({path:s.Type.Union([s.Type.String({minLength:1}),s.Type.Null()]),line:s.Type.Optional(s.Type.Number()),col:s.Type.Optional(s.Type.Number())})}),H={Content:function(e){var r=e.pane,i=e.options;return(0,o.jsx)(q,(0,n._)((0,t._)({},r.data),{isActive:i.isActive,isHidden:i.isHidden,performPaneOperation:i.performPaneOperation}))},Icon:function(e){var t=e.pane,n=e.size;return(0,o.jsx)(O.default,{path:t.data.path||"",size:n})},getTitle:function(e){return e.data.path?(0,y.getFileName)(e.data.path):"No file open"},category:R.PaneCategory.WorkspaceFeatures,decode:function(e){return l.Value.Decode(z,e)}};function W(e){var t,n,r,s,l,u,_,j,T,R=e.path,A=e.performPaneOperation,O=(0,E.useCodeEditorView)(),z=(0,w.default)(function(){return O?{match:S.matchLabel,data:{type:"action",label:"Toggle all folds",icon:(0,o.jsx)(M.default,{}),run:function(){0===(0,c.foldedRanges)(O.state).size?(0,c.foldAll)(O):(0,c.unfoldAll)(O)}}}:null},[O]),H=(0,x.useCodeMirrorValue)(O,f.HasHadUserInput);(0,a.useEffect)(function(){H&&A({operation:"commit"})},[H,A]);var W=(0,C.useFileCommands)({path:R,performPaneOperation:A}),q=(t=(0,E.useCodeEditorView)(),n=(0,x.useCodeMirrorValue)(t,h.HasFormatter),(0,w.default)(function(){if(t&&n)return{match:S.matchLabel,data:{label:"Format "+(0,y.getFileName)(R),icon:(0,o.jsx)(F.default,{}),type:"action",run:function(){(0,p.FormatCommand)(t)}}}},[n,R,t])),K=(r=(0,k.useIsInMobileWorkspace)(),l=(s=(0,b.usePreferences)("minimapDisplay")).preferences.minimapDisplay,u=s.update,(0,w.default)(function(){return r?null:{match:S.matchLabel,data:{label:"Minimap",icon:(0,o.jsx)(N.default,{}),type:"context"},commands:function(e){var t=e.active,n=e.searchQuery;return t||n?[{value:"none",label:"Hide",icon:(0,o.jsx)(V.default,{})},{value:"characters",label:"Characters",icon:(0,o.jsx)($.default,{})},{value:"blocks",label:"Blocks",icon:(0,o.jsx)(G.default,{})}].filter(function(e){return e.value!==l}).map(function(e){return{match:S.matchLabel,data:{type:"action",label:e.label,icon:e.icon,run:function(){u({minimapDisplay:e.value})}}}}):[]}}},[u,l,r])),Y=(_=function(){return A({operation:"replace",pane:{type:"history",data:{path:R}}})},(0,w.default)(function(){return{match:S.matchLabel,data:{label:"History",icon:(0,o.jsx)(U.default,{}),type:"action",run:function(){_()}}}},[_])),Q=(j=(0,I.useGetCursorState)(),(0,w.default)(function(){var e=void 0;if((0,y.isMarkdownFile)(R)&&(e={type:"markdown",data:{path:R}}),(0,y.isSVGFile)(R)&&(e={type:"media",data:{path:R}}),(0,y.isCsvFile)(R)&&(e={type:"csvPreview",data:{path:R}}),e)return{match:S.matchLabel,data:{label:"Preview",icon:(0,o.jsx)(B.default,{}),type:"action",run:function(){if(e){if("csvPreview"===e.type){var t;e.data.line=null==(t=j())?void 0:t.position.line}A({operation:"replace",pane:e})}}}}},[j,R,A])),X=(T=(0,D.useSetRevealFile)(),{match:S.matchLabel,data:{label:"Reveal in file tree",icon:(0,o.jsx)(L.default,{}),type:"action",run:function(){T(R)}}});return(0,P.useSetPaneBindings)(function(){if(O){var e=[],t=[],n=[];return q&&e.push(q),Q&&t.push(Q),K&&t.push(K),z&&t.push(z),n.push(X),n.push(Y),W&&e.push.apply(e,(0,i._)(W)),{type:"codeEditor",commands:[{name:"File Operations",commands:e},{name:"View",commands:t},{name:"Navigation",commands:n}].filter(function(e){return e.commands.length>0}),getEditorView:function(){return O},getCurrentSelectionText:function(){if(!O.state.selection.main.empty)return O.state.sliceDoc(O.state.selection.main.from,O.state.selection.main.to)},insertGhostwriterChatCode:function(e,t){(0,g.insertGhostwriterCode)({view:O,insert:e,overwrite:t})},revertGhostwriterChatCode:function(){(0,g.revertGhostwriterCode)(O)},fetchProblems:function(){return(0,d.forceLinting)(O),(0,m.getDiagnostics)(O.state)}}}},[O,q,Q,Y,K,z,X,W]),(0,P.useSetFocusTarget)(function(){return O},[O]),null}function q(e){var t=e.path,n=e.line,i=e.col,s=e.isHidden,l=e.performPaneOperation,c=(0,r._)((0,a.useState)(!s),2),d=c[0],f=c[1];d||s||f(!0);var p=(0,r._)((0,a.useState)(function(){return(0,u.createStore)()}),1)[0],h=(0,r._)((0,a.useState)(function(){return(0,u.createStore)()}),1)[0],g=(0,a.useCallback)(function(e){l({operation:"replace",pane:{type:"codeEditor",data:{path:e}}})},[l]),m=(0,A.useGetFileRenameInProgress)(),x=(0,j.useWatchFileError)({path:t,replaceEditorPath:g,getFileRenameInProgress:m}),y=(0,w.default)(function(){return{line:n,col:i}},[n,i]),b=(0,w.default)(function(){return function(){l({operation:"replace",pane:{type:"codeEditor",data:{path:t}}})}},[l,t]);return t?x?(0,o.jsx)(j.WatchFileErrorMessage,{message:x}):s&&!d?null:(0,o.jsx)(E.CodeEditorViewContext.Provider,{value:p,children:(0,o.jsxs)(T.HistoryPaneContext.Provider,{value:h,children:[(0,o.jsx)(_.default,{filePath:t,isHidden:null!=s&&s,deeplink:y,onDeeplinkUpdated:b,hideMobileKeyboardToolbar:!0,performPaneOperation:l},t),(0,o.jsx)(W,{path:t,performPaneOperation:l})]})}):null}e.s(["PaneActions",()=>W,"codeEditorUI",()=>H])},676702,e=>{"use strict";var t=e.i(276385),n=e.i(960933),r=e.i(862927),i=e.i(205104),o=e.i(297083),a=e.i(530658),s=e.i(817556),l=e.i(389959),u=e.i(906368),c=e.i(903381),d=e.i(529810),f=e.i(106020),p=e.i(346715),h=e.i(143003),g=e.i(790486),m=e.i(415756),x=e.i(650587),y=e.i(967629),b=e.i(480028),w=e.i(446530),k=e.i(613355),_=e.i(136540),S=e.i(51054),C=e.i(625484),j=e.i(283023),T=(0,y.keyframes)({"0%":{backgroundColor:b.tokens.accentPrimaryDimmer},"100%":{backgroundColor:"transparent"}}),E=(0,w.cssRecord)({filter:[k.rcss.border({color:b.tokens.outlineDimmest,direction:"bottom"})],tableRoot:[k.rcss.flex.growAndShrink(1),k.rcss.width("100%"),k.rcss.overflow("auto"),{'&[data-resizing="true"]':{overflow:"hidden",pointerEvents:"none"}}],virtualTable:[k.rcss.width("fit-content"),k.rcss.position.relative],tableHeader:[k.rcss.display.flex,k.rcss.flex.row,k.rcss.backgroundColor.backgroundDefault,k.rcss.position.sticky,k.rcss.zIndex(1),k.rcss.top(0),k.rcss.noSelect],headerCell:[k.rcss.color.foregroundDefault,k.rcss.fontWeight.medium,k.rcss.fontSize(12),k.rcss.px(6),k.rcss.display.flex,k.rcss.align.center,k.rcss.border({color:b.tokens.outlineDimmest,direction:"bottom"}),k.rcss.border({color:b.tokens.outlineDimmest,direction:"right"}),{height:25,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis","&:first-child":{background:b.tokens.backgroundDefault,position:"sticky",left:0,zIndex:1}}],tableRow:[k.rcss.flex.row,{'&[data-highlighted="true"]':{animation:"".concat(T," ").concat(2e3,"ms ease-out forwards")}}],tableCell:[k.rcss.display.flex,k.rcss.align.center,k.rcss.color.foregroundDimmer,k.rcss.fontSize(12),k.rcss.px(6),k.rcss.border({color:b.tokens.outlineDimmest,direction:"bottom"}),k.rcss.border({color:b.tokens.outlineDimmest,direction:"right"}),{height:25,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis","&:first-child":{justifyContent:"center",position:"sticky",left:0,background:b.tokens.backgroundDefault}}],resizeHandle:[k.rcss.position.absolute,k.rcss.top(0),k.rcss.right(0),k.rcss.height("100%"),k.rcss.width(4),{cursor:"col-resize","&:hover":{backgroundColor:b.tokens.accentPrimaryDefault}}]}),R=function(e,t){var n=(0,a._)((0,l.useState)(e),2),r=n[0],i=n[1],o=(0,l.useMemo)(function(){return new m.AsyncFzf(e,{selector:function(e){return Object.values(e).join(" ")},casing:"case-insensitive"})},[e]);return(0,l.useEffect)(function(){t?o.find(t).then(function(e){i(e.map(function(e){return e.item}))}).catch(function(){}):i(e)},[e,o,t]),r},I=function(e){var t=(0,a._)((0,l.useState)(e),2),n=t[0],r=t[1],i=(0,a._)((0,l.useState)(null),2),o=i[0],s=i[1],u=(0,a._)((0,l.useState)(0),2),c=u[0],d=u[1],f=(0,a._)((0,l.useState)(0),2),h=f[0],g=f[1],m=(0,l.useCallback)(function(e,t){s(e),d(t.clientX),g(n[e])},[n]),x=(0,l.useCallback)(function(e){if(null!==o){var t=Math.max(50,Math.min(300,h+(e.clientX-c)));r(function(e){var n=(0,p._)(e);return n[o]=t,n})}},[o,h,c]),y=(0,l.useCallback)(function(){s(null)},[]);return(0,l.useEffect)(function(){if(null!==o){var e=function(e){return x(e)},t=function(){return y()};return document.addEventListener("mousemove",e),document.addEventListener("mouseup",t),function(){document.removeEventListener("mousemove",e),document.removeEventListener("mouseup",t)}}},[y,x,o]),{columnWidths:n,setColumnWidths:r,resizingColumn:o,handleResizeStart:m}};function A(e){var n=e.data,r=e.initialLine,i=e.openInEditor,o=(0,x.useIsMobile)(),s=(0,a._)((0,l.useState)(""),2),u=s[0],c=s[1],d=(0,l.useMemo)(function(){if(0===n.length)return{headers:[],data:[],calculatedColumnWidths:[]};var e=[""].concat((0,p._)(n[0])),t=e.map(function(e,t){return{key:t.toString(),label:e,isRowHeader:0===t}}),r=[],i=Array(e.length).fill(0);n.slice(1).forEach(function(e,n){var o={0:(n+1).toString(),key:n.toString()};t.slice(1).forEach(function(t,n){var r=e[n]||"";o[(n+1).toString()]=r,i[n+1]=Math.max(i[n+1],r.length)}),r.push(o)});var o=i.map(function(e,n){return 0===n?25:Math.min(Math.max(8*Math.max(e,t[n].label.length),50),300)});return{headers:t,data:r,calculatedColumnWidths:o}},[n]),f=d.headers,m=d.data,y=d.calculatedColumnWidths,b=R(m,u),w=I(y),k=w.columnWidths,T=w.setColumnWidths,A=w.resizingColumn,P=w.handleResizeStart,D=(0,a._)((0,l.useState)(null),2),O=D[0],N=D[1];(0,l.useEffect)(function(){T(y)},[y,T]);var M=(0,l.useRef)(null),L=(0,g.useVirtualizer)({count:b.length,getScrollElement:function(){return M.current},estimateSize:function(){return 25},overscan:10,rangeExtractor:function(e){var t=new Set([0].concat((0,p._)((0,h.defaultRangeExtractor)(e))));return(0,p._)(t)}});return(0,l.useEffect)(function(){if(r&&b.length>r){var e=r-2;L.scrollToIndex(e,{align:"center"}),N(e);var t=setTimeout(function(){return N(null)},2e3);return function(){return clearTimeout(t)}}},[b.length,r,L]),(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(C.View,{css:E.filter,p:4,children:(0,t.jsx)(S.SearchBar,{value:u,onChange:function(e){return c(e.target.value)},onClear:function(){return c("")}})}),(0,t.jsx)("div",{css:E.tableRoot,ref:M,"data-resizing":null!==A,children:(0,t.jsxs)("div",{css:E.virtualTable,style:{height:"".concat(L.getTotalSize(),"px"),width:"".concat(k.reduce(function(e,t){return e+t},0),"px")},children:[(0,t.jsx)("div",{css:E.tableHeader,children:f.map(function(e,n){return(0,t.jsxs)("div",{css:E.headerCell,style:{width:"".concat(k[n],"px")},children:[e.label,o||0===n?null:(0,t.jsx)("div",{css:E.resizeHandle,onMouseDown:function(e){return P(n,e)},role:"separator"})]},e.key)})}),L.getVirtualItems().map(function(e){var n=b[e.index];return n?(0,t.jsx)("div",{css:E.tableRow,"data-index":e.index,"data-highlighted":e.index===O,style:{position:"absolute",top:0,left:0,width:"100%",height:"".concat(e.size,"px"),transform:"translateY(".concat(25+e.start,"px)")},children:f.map(function(e,r){var o=n[e.key];return(0,t.jsx)("div",{css:E.tableCell,style:{width:"".concat(k[r],"px")},children:0===r?(0,t.jsx)(_.IconButton,{colorway:"primary",alt:"Edit at this line",onClick:function(){return i(parseInt(o,10)+1)},size:18,children:(0,t.jsx)(j.default,{})}):o},e.key)})},e.key.toString()):null})]})})]})}var P=e.i(827759),D=e.i(406206),O=e.i(259493),N=e.i(396776),M=e.i(718610),L=e.i(940745),B=e.i(42458),V=(0,w.cssRecord)({root:[k.rcss.flex.column,k.rcss.height("100%"),k.rcss.width("100%"),k.rcss.overflow("hidden")],loadingContainer:[k.rcss.center]});function F(n){var r=n.filePath,i=n.initialLine,p=n.performPaneOperation,h=(0,d.default)().fs,g=(0,a._)((0,l.useState)([]),2),m=g[0],x=g[1],y=(0,l.useCallback)(function(e){p({operation:"replace",pane:{type:"codeEditor",data:{path:r,line:e}}}),p({operation:"commit"})},[p,r]);(0,O.useSetPaneBindings)(function(){return{commands:[{commands:[{match:f.matchLabel,data:{label:"Open in Editor",icon:(0,t.jsx)(M.default,{}),type:"action",run:function(){return y()}}}]}]}},[y]);var b=(0,a._)((0,l.useState)(!1),2),w=b[0],k=b[1],_=(0,a._)((0,l.useState)(!0),2),S=_[0],j=_[1];return(0,l.useEffect)(function(){var t=function(t){return(0,o._)(function(){var n;return(0,s._)(this,function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,e.A(519741)];case 1:return r.sent().default.parse(t,{complete:function(e){x(e.data),j(!1),k(!1)}}),[3,3];case 2:return n=r.sent(),u.captureException(n),k(!0),[3,3];case 3:return[2]}})})()};return h.watchTextFile(r,{onReady:function(e){return t(e.initialContent)},onChange:function(e){return t(e.latestContent)},onMoveOrDelete:function(e){e.eventType===c.ChangeEventType.Delete&&p({operation:"replace",pane:{type:"commands",data:{autoFocus:!0}}})}})},[r,h,p]),(0,t.jsxs)(C.View,{css:V.root,children:[(0,t.jsx)(P.FileHeader,{path:r,performPaneOperation:p,children:(0,t.jsx)(D.PaneHeaderActionButton,{altText:"Open file in editor",buttonText:"Open in Editor",onClick:function(){return y()},icon:(0,t.jsx)(M.default,{})})}),w?(0,t.jsx)(C.View,{p:8,children:(0,t.jsx)(N.StatusBanner,{icon:(0,t.jsx)(B.default,{}),colorway:"red",text:"This CSV could not be displayed."})}):(0,t.jsx)(t.Fragment,{children:S?(0,t.jsx)(C.View,{css:V.loadingContainer,grow:!0,shrink:!0,children:(0,t.jsx)(L.default,{})}):(0,t.jsx)(A,{data:m,openInEditor:y,initialLine:i})})]})}e.i(282890);var U=e.i(716636),G=e.i(771824),$=n.Type.Object({type:n.Type.Literal("csvPreview"),data:n.Type.Object({path:n.Type.String(),line:n.Type.Optional(n.Type.Integer())})}),z={Content:function(e){var n=e.options.performPaneOperation,r=e.pane.data,i=r.path,o=r.line;return(0,t.jsx)(F,{filePath:i,performPaneOperation:n,initialLine:o})},Icon:function(e){var n=e.size;return(0,t.jsx)(G.default,{size:n})},getTitle:function(e){return e.data.path?(0,i.getFileName)(e.data.path):"CSV Preview"},description:"Preview CSV files in a tabular format",category:U.PaneCategory.Other,decode:function(e){return r.Value.Decode($,e)}};e.s(["csvPreviewUI",()=>z],676702)},231133,e=>{e.v({button:"index-module__aSAQ8q__button",menu:"index-module__aSAQ8q__menu"})},751367,e=>{"use strict";var t=e.i(276385),n=e.i(389959),r=e.i(960933),i=e.i(862927),o=e.i(530658),a=e.i(346715),s=e.i(341190),l=e.i(77164),u=e.i(601059),c=e.i(960178),d=e.i(625484),f=e.i(782096);function p(e){var n=e.tab,r=e.fullPath,i=e.level,o=e.onNavigate;return n.children&&!n.component?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(s.Header,{children:(0,t.jsx)(d.View,{pt:8,px:8,children:(0,t.jsx)(c.Text,{variant:0===i?"subheadDefault":"small",children:n.label})})}),(0,t.jsx)(h,{tabs:n.children,currentPath:r,onNavigate:o})]}):(0,t.jsx)(u.BaseMenuItem,{textValue:n.label,onAction:function(){return o(r)},children:(0,t.jsxs)(d.View,{row:!0,gap:12,align:"center",justify:"space-between",grow:!0,children:[(0,t.jsxs)(d.View,{row:!0,gap:12,align:"center",children:[n.icon,(0,t.jsxs)(d.View,{gap:2,children:[(0,t.jsx)(c.Text,{children:n.label}),n.description?(0,t.jsx)(c.Text,{variant:"small",color:"dimmer",children:n.description}):null]})]}),(0,t.jsx)(f.default,{size:16})]})})}function h(e){var n=e.tabs,r=e.currentPath,i=void 0===r?[]:r,s=e.onNavigate,l=i.length;return(0,t.jsx)(t.Fragment,{children:Object.entries(n).map(function(e){var n=(0,o._)(e,2),r=n[0],u=n[1],c=(0,a._)(i).concat([r]);return(0,t.jsx)(p,{tab:u,fullPath:c,isTopLevel:0===l,level:l,onNavigate:s},c.join("-"))})})}function g(e){var n=e.onNavigate;return(0,t.jsxs)(d.View,{p:16,gap:16,children:[(0,t.jsxs)(d.View,{gap:8,children:[(0,t.jsx)(c.Text,{variant:"subheadBig",children:"Developer Tools"}),(0,t.jsx)(c.Text,{color:"dimmer",children:"Access debugging tools, monitor resources, and manage your development environment"})]}),(0,t.jsx)(u.Menu,{"aria-label":"Developer Tools Overview",selectionMode:"none",children:(0,t.jsx)(h,{tabs:l.developerTabs,onNavigate:n})})]})}var m=e.i(136540),x=e.i(878420),y=e.i(64386),b=e.i(625251),w=e.i(992785),k=e.i(140487),_=e.i(604963),S=e.i(616278),C=e.i(231133);function j(e){var n=e.label,r=e.icon,i=e.description,o=e.isActive,a=e.showChevron,s=e.onAction;return(0,t.jsx)(u.BaseMenuItem,{textValue:n,onAction:s,children:(0,t.jsxs)(d.View,{row:!0,gap:12,align:"center",justify:"space-between",grow:!0,children:[(0,t.jsxs)(d.View,{row:!0,gap:12,align:"center",children:[r,(0,t.jsxs)(d.View,{gap:2,children:[(0,t.jsx)(c.Text,{children:n}),i?(0,t.jsx)(c.Text,{variant:"small",color:"dimmer",children:i}):null]})]}),void 0!==o&&o?(0,t.jsx)(S.default,{size:16}):null,void 0!==a&&a?(0,t.jsx)(f.default,{size:16}):null]})})}function T(e){var n=e.items,r=e.currentPath,i=void 0===r?[]:r,s=e.parentPath,l=e.onNavigate;return(0,t.jsx)(t.Fragment,{children:n.map(function(e){if(e.children&&Object.keys(e.children).length>0){var n=Object.entries(e.children).map(function(e){var t=(0,o._)(e,2),n=t[0],r=t[1];return(0,y._)((0,x._)({},r),{id:n})});return(0,t.jsxs)(b.SubmenuTrigger,{children:[(0,t.jsx)(j,{label:e.label,icon:e.icon,showChevron:!0}),(0,t.jsx)(_.RawPopover,{clsx:C.default.menu,children:(0,t.jsx)(u.Menu,{"aria-label":e.label,children:(0,t.jsx)(T,{items:n,currentPath:i,parentPath:(0,a._)(s).concat([e.id]),onNavigate:l})})})]},e.id)}var r=(0,a._)(s).concat([e.id]);return(0,t.jsx)(j,{label:e.label,icon:e.icon,isActive:(0,w.default)(r,i),onAction:function(){l(r)}},e.id)})})}function E(e){var r=e.tree,i=e.currentPath,a=void 0===i?[]:i,s=e.onNavigate,l=(0,n.useCallback)(function(e){if(0===e)return Object.entries(r).map(function(e){var t=(0,o._)(e,2),n=t[0],r=t[1];return(0,y._)((0,x._)({},r),{id:n})});for(var t=r,n=0;n<e;n++){var i=a[n];if(!i||!t[i])return[];var s=t[i];if(!s.children)return[];t=s.children}return Object.entries(t).map(function(e){var t=(0,o._)(e,2),n=t[0],r=t[1];return(0,y._)((0,x._)({},r),{id:n})})},[r,a]),c=(0,n.useCallback)(function(e){var t=a[e];return l(e).find(function(e){return e.id===t})},[a,l]);return 0===a.length?null:(0,t.jsx)(d.View,{row:!0,gap:6,children:a.map(function(e,r){var i=c(r),o=l(r);return i?(0,t.jsx)(n.Fragment,{children:(0,t.jsx)(u.PopupMenu,{label:i.label,trigger:(0,t.jsx)(k.Button,{clsx:C.default.button,iconLeft:i.icon,variant:"nofill",text:i.label}),children:(0,t.jsx)(T,{items:o,currentPath:a,parentPath:a.slice(0,r),onNavigate:s})})},e+r):null})})}var R=e.i(352767);function I(e){var r,i=e.tab,o=e.openPane,a=e.navTo,s=(r=l.developerTabs,(0,n.useMemo)(function(){if(!i||0===i.length)return null;if(0===i.length)return null;var e=r[i[0]];if(!e)return null;for(var t=1;t<i.length;t++){var n=i[t],o=e.children;if(null==o||!o[n])return null;e=o[n]}return e},[r,i])),u=s&&"component"in s&&s.component;return u?(0,t.jsxs)(d.View,{grow:!0,shrink:!0,children:[(0,t.jsxs)(d.View,{row:!0,p:8,gap:0,align:"center",children:[(0,t.jsx)(m.IconButton,{size:32,onClick:function(){return a(null)},alt:"Overview",children:(0,t.jsx)(R.default,{})}),(0,t.jsx)(E,{tree:l.developerTabs,currentPath:i,onNavigate:a})]}),(0,t.jsx)(d.View,{grow:!0,shrink:!0,children:(0,t.jsx)(u,{openPane:o})})]}):(0,t.jsx)(g,{onNavigate:a})}e.i(282890);var A=e.i(716636),P=e.i(480028),D=e.i(718610),O=e.i(606867),N=r.Type.Object({type:r.Type.Literal("developer"),data:r.Type.Optional(r.Type.Object({tab:r.Type.Optional(r.Type.Array(r.Type.String()))}))}),M={Content:function(e){var r=e.pane.data,i=e.options,o=(0,n.useCallback)(function(e){i.performPaneOperation({operation:"open",secondary:!0,pane:e})},[i]),a=(0,n.useCallback)(function(e){i.performPaneOperation({operation:"replace",pane:{type:"developer",data:e?{tab:e}:void 0}})},[i]);return(0,t.jsx)(I,{tab:null==r?void 0:r.tab,openPane:o,navTo:a})},Icon:function(e){var n=e.size;return(0,t.jsx)(O.IconContext.Provider,{value:{color:P.tokens.blueStronger,size:n},children:(0,t.jsx)(D.default,{})})},getTitle:function(){return"Developer"},category:A.PaneCategory.Other,decode:function(e){return i.Value.Decode(N,e)}};e.s(["developerUI",()=>M],751367)},972291,e=>{"use strict";var t,n=e.i(960933),r=e.i(705705),i=e.i(963931);n.Type.Object({refs:n.Type.Array(r.GitRefSchema),hash:n.Type.String(),parents:n.Type.Union([n.Type.Null(),n.Type.Array(n.Type.String())]),grafted:n.Type.Boolean(),author:i.GitUserSchema,committer:i.GitUserSchema,subject:n.Type.String(),body:n.Type.String(),trailers:n.Type.Record(n.Type.String(),n.Type.Union([n.Type.String(),n.Type.Undefined()])),notes:n.Type.Optional(n.Type.String())});var o=((t={}).ADDED="ADDED",t.COPIED="COPIED",t.DELETED="DELETED",t.MODIFIED="MODIFIED",t.RENAMED="RENAMED",t.TYPE_CHANGED="TYPE_CHANGED",t.UNKNOWN="UNKNOWN",t.BROKEN="BROKEN",t),a=n.Type.Enum(o);n.Type.Object({path:n.Type.String(),type:a,originalPath:n.Type.Optional(n.Type.String())}),e.s(["GitCommitFileType",()=>o])},876899,138290,930856,933974,304662,737898,e=>{"use strict";var t=e.i(530658),n=e.i(276385),r=e.i(389959),i=e.i(960933),o=e.i(862927),a=e.i(972291);e.i(344424);var s=e.i(487638),l=e.i(205104),u=e.i(297083),c=e.i(817556),d=e.i(597865),f=e.i(529810),p=e.i(906368),h=function(e){var t=e.context,n=e.gitService,r=e.result,i=e.data;p.withScope(function(e){e.setTag("service","git"),e.setTag("context",t),e.setExtra("env",n.getEnv()),i&&p.setExtra("data",i),p.captureException(r.error)})};e.s(["reportErrorToSentry",()=>h],138290);let g=function(e,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=(0,t._)((0,r.useState)(null),2),a=o[0],s=o[1],p=(0,t._)((0,r.useState)(!0),2),g=p[0],m=p[1],x=(0,f.default)().fs,y=(0,d.default)(function(t){return(0,u._)(function(){var r,i;return(0,c._)(this,function(o){switch(o.label){case 0:m(!0),o.label=1;case 1:return o.trys.push([1,3,,4]),[4,(0,u._)(function(){var r,i,o;return(0,c._)(this,function(a){switch(a.label){case 0:if("generatedFile"===n.type)return[2,""];if("git"!==n.type)return[3,2];return r=n.revision,[4,t.getFileContents({path:e,revision:r,convertToBase64:(0,l.isMedia)(e)})];case 1:if((i=a.sent()).error)throw h({context:"use-file-at-revision-fetch-content",gitService:t,result:i,data:{path:e,revision:r}}),i.error;return[2,i.content||""];case 2:return[4,x.readFile(e,{fromDisk:!0})];case 3:if((o=a.sent()).error)throw o.error;return[2,o.content.toString("utf8")]}})})()];case 2:return r=o.sent(),m(!1),[2,{content:r,error:null}];case 3:return i=o.sent(),m(!1),[2,{content:null,error:i}];case 4:return[2]}})})()},[e,n,x],i);return(0,r.useEffect)(function(){y&&(y.error?s(null):s(y.content))},[y]),{fileContent:a,loading:g}};e.i(282890);var m=e.i(716636),x=e.i(480028),y=e.i(446530),b=e.i(613355),w=e.i(965153),k=e.i(630818),_=e.i(960178),S=e.i(625484),C=e.i(753950),j=e.i(486161),T=e.i(878420),E=e.i(64386),R=e.i(886513),I=e.i(346715),A=e.i(676480),P=e.i(179302),D="rgba(180, 0, 0, 0.125)",O="rgba(0, 180, 0, 0.125)",N=P.EditorView.theme({"&.cm-merge-b .cm-changedLine":{background:"rgba(0, 180, 0, 0.075)"},"&.cm-merge-a .cm-changedLine":{background:"rgba(180, 0, 0, 0.075)"},"&.cm-merge-b .cm-changedLineGutter":{background:O},"&.cm-merge-a .cm-changedLineGutter":{background:D},"&.cm-merge-b .cm-changedText":{background:O,outline:"solid 1px ".concat(O),borderRadius:"2px"},"&.cm-merge-a .cm-changedText":{background:D,outline:"solid 1px ".concat(D),borderRadius:"2px"},".cm-collapsedLines":{color:x.tokens.accentPrimaryStrongest,background:x.tokens.accentPrimaryDimmest,transition:"background 250ms ease","&:hover":{background:x.tokens.accentPrimaryDimmer}}}),M=[P.EditorView.baseTheme({".cm-scroller":{height:"100% !important",overflowY:"auto !important"}}),P.EditorView.theme({".cm-scroller":{height:"auto !important",overflowY:"visible !important"}})],L=[C.Prec.highest(M),N],B=e.i(210736),V=e.i(221250),F=e.i(786962),U=e.i(98816);function G(e){var i,o,a,s=e.a,l=e.b,u=e.style,c=e.className,d=(0,R._)(e,["a","b","style","className"]),f=(0,t._)((0,r.useState)(null),2),p=f[0],h=f[1],g=(0,t._)((0,r.useState)(null),2),m=g[0],x=g[1],y=(0,r.useRef)(!1),b=(0,U.default)(d),w=(0,U.default)(s.doc),k=(0,U.default)(l.doc),_=(0,V.useBaseCodeMirrorExtensions)((0,E._)((0,T._)({},s),{readOnly:!0})),S=(0,V.useBaseCodeMirrorExtensions)((0,E._)((0,T._)({},l),{readOnly:!0})),C=(i=(0,t._)((0,r.useState)(),2)[1],(0,r.useCallback)(function(e){i(function(){throw e})},[])),j=d.orientation,D=d.revertControls,O=d.renderRevertControl,N=d.collapseUnchanged,M=d.gutter,G=d.highlightChanges,z=void 0!==N,H=null==N?void 0:N.margin,W=null==N?void 0:N.minSize,q=null!=(o=null==m?void 0:m.a)?o:null,K=null!=(a=null==m?void 0:m.b)?a:null;return(0,V.assertClientSide)(),(0,r.useEffect)(function(){var e=function(e){C(e)};if(p){var t=null;try{t=new A.MergeView((0,E._)((0,T._)({},b.current),{parent:p,a:{doc:w.current,extensions:[P.EditorView.exceptionSink.of(e),L].concat((0,I._)(_))},b:{doc:k.current,extensions:[P.EditorView.exceptionSink.of(e),L].concat((0,I._)(S))}}))}catch(t){e(t)}return t&&(x(t),y.current=!0),function(){if(t){x(null);try{t.destroy()}catch(t){e(t)}}}}},[p]),(0,r.useEffect)(function(){q&&!y.current&&q.dispatch({changes:{from:0,to:q.state.doc.length,insert:s.doc}})},[q,s.doc]),(0,r.useEffect)(function(){K&&!y.current&&K.dispatch({changes:{from:0,to:K.state.doc.length,insert:l.doc}})},[K,l.doc]),(0,r.useEffect)(function(){m&&!y.current&&$(m,b.current.collapseUnchanged)},[m,b,s.doc,l.doc]),(0,r.useEffect)(function(){if(m&&!y.current){var e=z?{margin:H,minSize:W}:void 0;m.reconfigure({orientation:j,revertControls:D,renderRevertControl:O,collapseUnchanged:e,gutter:M,highlightChanges:G}),e&&$(m,e)}},[m,j,D,O,z,H,W,M,G]),(0,B.useObserveCodeMirrorResize)(q),(0,B.useObserveCodeMirrorResize)(K),(0,r.useEffect)(function(){y.current=!1}),(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("div",{ref:h,className:c,style:u}),(0,n.jsx)(F.EditorReactRootMount,{view:q}),(0,n.jsx)(F.EditorReactRootMount,{view:K})]})}function $(e,t){e&&t&&(e.reconfigure({collapseUnchanged:void 0}),e.reconfigure({collapseUnchanged:(0,T._)({},t)}))}e.s(["default",()=>G],930856);var z=e.i(234961),H=(0,y.cssRecord)({container:[b.rcss.width(60),b.rcss.height(24),b.rcss.display.flex,b.rcss.center,b.rcss.borderRadius(4),b.rcss.fontSize(x.tokens.fontSizeSmall)]});function W(e){var t,r,i;switch(e.type){case z.GitStatusChangedFileType.ADDED:case z.GitStatusChangedFileType.UNTRACKED:t="Added",r=x.tokens.greenDimmest,i=x.tokens.greenStrongest;break;case z.GitStatusChangedFileType.MODIFIED:t="Modified",r=x.tokens.yellowDimmest,i=x.tokens.yellowStrongest;break;case z.GitStatusChangedFileType.DELETED:t="Deleted",r=x.tokens.redDimmest,i=x.tokens.redStrongest;break;case z.GitStatusChangedFileType.RENAMED:t="Renamed",r=x.tokens.tealDimmest,i=x.tokens.tealStrongest;break;case z.GitStatusChangedFileType.COPIED:t="Copy",r=x.tokens.limeDimmest,i=x.tokens.limeStrongest;break;default:return null}return(0,n.jsx)(S.View,{style:{backgroundColor:r,color:i},css:H.container,children:(0,n.jsx)("span",{children:t})})}function q(e){var t,r,i;switch(e.type){case"ADDED":t="Added",r=x.tokens.greenDimmest,i=x.tokens.greenStrongest;break;case"MODIFIED":t="Modified",r=x.tokens.yellowDimmest,i=x.tokens.yellowStrongest;break;case"DELETED":t="Deleted",r=x.tokens.redDimmest,i=x.tokens.redStrongest;break;case"RENAMED":t="Renamed",r=x.tokens.tealDimmest,i=x.tokens.tealStrongest;break;case"COPIED":t="Copy",r=x.tokens.limeDimmest,i=x.tokens.limeStrongest;break;default:return null}return(0,n.jsx)(S.View,{style:{backgroundColor:r,color:i},css:H.container,children:(0,n.jsx)("span",{children:t})})}e.s(["CommitFileType",()=>q,"default",()=>W],933974);var K=e.i(296223),Y=e.i(721321),Q=e.i(88619),X=e.i(136540),J=e.i(929872),Z=e.i(369948),ee=e.i(576073),et=e.i(462783),en=e.i(940745),er=[{"& > span:first-child-of-type":[b.rcss.flex.grow(1),b.rcss.textAlign.left]},{"& > span":[b.rcss.flex.shrink(1)]},b.rcss.height("auto"),b.rcss.p(8),b.rcss.fontWeight.medium,b.rcss.backgroundColor.backgroundHigher,b.rcss.flex.row,b.rcss.align.center,b.rcss.justify.spaceBetween,b.rcss.overflow("hidden"),b.rcss.cursor.pointer],ei=(0,y.cssRecord)({buttonFolded:[er,b.rcss.borderRadius(8)],buttonUnfolded:[er,b.rcss.borderRadius(8,8,0,0)],rowContainer:[b.rcss.position.relative,b.rcss.zIndex(1),b.rcss.overflow("hidden")],diffContainer:[b.rcss.borderRadius(8)],bodyContainer:[b.rcss.borderRadius(0,0,8,8),b.rcss.p(8),b.rcss.display.flex,b.rcss.flex.row,b.rcss.flex.wrap,b.rcss.align.center,b.rcss.justify.center,b.rcss.backgroundColor.backgroundDefault,b.rcss.border({color:x.tokens.outlineDimmer,direction:"bottom"}),b.rcss.border({color:x.tokens.outlineDimmer,direction:"left"}),b.rcss.border({color:x.tokens.outlineDimmer,direction:"right"})],noChangesContainer:[b.rcss.py(8),b.rcss.px(8),b.rcss.center,b.rcss.width("100%")],innerContainer:[b.rcss.display.flex,b.rcss.align.center],splitContainer:[b.rcss.display.flex,b.rcss.flex.row,b.rcss.justify.spaceBetween,b.rcss.maxWidth("100%"),b.rcss.align.center],splitChild:[{flexBasis:"50%"}],buttonGroupItem:[b.rcss.width(64),b.rcss.height(32)]}),eo=function(e){var t=e.value,r=e.onChange;return(0,n.jsxs)(Y.ButtonGroup,{name:"SplitOrUnifiedDiff",value:t,onChange:r,row:!0,children:[(0,n.jsx)(S.View,{css:ei.buttonGroupItem,children:(0,n.jsx)(Y.ButtonGroupItem,{value:"Unified",text:"Unified",id:"SplitOrUnifiedDiffUnified"})}),(0,n.jsx)(S.View,{css:ei.buttonGroupItem,children:(0,n.jsx)(Y.ButtonGroupItem,{value:"Split",text:"Split",id:"SplitOrUnifiedDiffSplit"})})]})},ea=function(e){var t=e.folded,r=void 0!==t&&t,i=e.setFolded,o=e.diff,a="".concat(o.initial.path,"/").concat(o.initial.filename),s="".concat(o.final.path,"/").concat(o.final.filename);return(0,n.jsxs)(S.View,{css:r?ei.buttonFolded:ei.buttonUnfolded,onClick:function(){return i(!r)},children:[(0,n.jsxs)(S.View,{css:[ei.rowContainer,b.rcss.flex.shrink(1)],align:"center",row:!0,gap:8,children:["RENAMED"===o.status||"COPIED"===o.status?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(k.default,{path:a}),(0,n.jsx)(_.Text,{multiline:!1,children:o.initial.filename}),""===o.initial.path?null:(0,n.jsx)(_.Text,{multiline:!1,color:"dimmest",css:[b.rcss.fontWeight.normal],maxLines:1,children:o.initial.path}),(0,n.jsx)(Z.default,{}),(0,n.jsx)(k.default,{path:s}),(0,n.jsx)(_.Text,{multiline:!1,children:o.final.filename}),""===o.final.path?null:(0,n.jsx)(_.Text,{multiline:!1,color:"dimmest",css:[b.rcss.fontWeight.normal],children:o.final.path})]}):(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(k.default,{path:s}),(0,n.jsx)(_.Text,{multiline:!1,children:o.final.filename}),""===o.final.path?null:(0,n.jsx)(_.Text,{multiline:!1,color:"dimmest",css:[b.rcss.fontWeight.normal],children:o.final.path})]}),(0,n.jsx)(Q.CopyIconButton,{textToCopy:s,tooltipText:"Copy Full Path",tooltipPlacement:"bottom-end"})]}),(0,n.jsxs)(S.View,{css:ei.rowContainer,align:"center",row:!0,gap:8,children:[(0,n.jsx)(q,{type:o.status}),(0,n.jsx)(X.IconButton,{alt:r?"Collapse diff":"Expand diff",onClick:function(){return i(!r)},children:r?(0,n.jsx)(ee.default,{}):(0,n.jsx)(et.default,{})})]})]})},es=function(e){var t=e.diff,r=e.splitOrUnified,i=e.extensions;return"Split"===r?(0,n.jsx)(G,{a:{filePath:t.initial.filename,doc:t.initial.content},b:{filePath:t.final.filename,doc:t.final.content,extensions:i},collapseUnchanged:{},style:{width:"100%"}}):(0,n.jsx)(V.default,{filePath:t.final.filename,initialDoc:t.final.content,extensions:[j.InlineDiff.of(C.Text.of(t.initial.content.split("\n")))],readOnly:!0,style:{width:"100%"}})},el=function(e){return(0,l.isMedia)(e)?"media":(0,l.isOTFile)(e)?"ot":"binary"},eu=function(e){var t=e.content,r=e.type,i=e.filename,o=e.extensions;switch(r){case"media":return(0,n.jsx)(S.View,{css:[{display:"flex",height:"100%"}],children:(0,n.jsx)(K.Viewer,{src:(0,K.getMediaSrc)(t,(0,l.getMediaMime)(i)),mime:(0,l.getMediaMime)(i),fileName:i})});case"ot":return(0,n.jsx)(V.default,{filePath:i,initialDoc:t,readOnly:!0,style:{width:"100%"},extensions:o});default:return(0,n.jsx)(_.Text,{color:"dimmest",multiline:!1,children:"This binary file has changed."})}},ec=function(e){var t=e.diff,r=e.splitOrUnified,i=e.extensions;if(t.loading)return(0,n.jsx)(S.View,{css:ei.noChangesContainer,children:(0,n.jsx)(en.default,{size:20})});if(t.initial.content===t.final.content)return(0,n.jsx)(S.View,{css:ei.noChangesContainer,children:(0,n.jsx)(_.Text,{color:"dimmest",multiline:!1,children:"There are no changes to show."})});if("DELETED"===t.status)return(0,n.jsx)(S.View,{css:ei.noChangesContainer,children:(0,n.jsx)(_.Text,{color:"dimmest",multiline:!1,children:"This file has been deleted."})});var o=el(t.initial.filename),a=el(t.final.filename);if("ADDED"===t.status)switch(a){case"media":return(0,n.jsx)(S.View,{css:ei.noChangesContainer,children:(0,n.jsx)(S.View,{css:ei.innerContainer,children:(0,n.jsx)(K.Viewer,{src:(0,K.getMediaSrc)(t.final.content,(0,l.getMediaMime)(t.final.filename)),mime:(0,l.getMediaMime)(t.final.filename),fileName:t.final.filename})})});case"ot":return(0,n.jsx)(S.View,{css:ei.noChangesContainer,children:(0,n.jsx)(V.default,{filePath:t.final.filename,initialDoc:t.final.content,readOnly:!0,style:{width:"100%"},extensions:i})});default:return(0,n.jsx)(S.View,{css:ei.noChangesContainer,children:(0,n.jsx)(_.Text,{color:"dimmest",multiline:!1,children:"This binary file has been added."})})}return"binary"===o&&"binary"===a?(0,n.jsx)(S.View,{css:ei.noChangesContainer,children:(0,n.jsx)(_.Text,{color:"dimmest",multiline:!1,children:"This binary file has changed."})}):"ot"===o&&"ot"===a?(0,n.jsx)(es,{diff:t,splitOrUnified:r,extensions:i}):(0,n.jsxs)(S.View,{css:ei.splitContainer,p:8,children:[(0,n.jsx)(S.View,{css:ei.splitChild,align:"center",justify:"center",children:(0,n.jsx)(eu,{content:t.initial.content,type:o,filename:t.initial.filename,extensions:i})}),(0,n.jsx)(S.View,{css:ei.splitChild,children:(0,n.jsx)(eu,{content:t.final.content,type:a,filename:t.final.filename,extensions:i})})]})},ed=function(e){var t=e.diff,r=e.folded,i=e.setFolded,o=e.splitOrUnified;return(0,n.jsxs)(S.View,{css:ei.diffContainer,grow:!0,children:[(0,n.jsx)(ea,{folded:r,setFolded:i,diff:t}),r?null:(0,n.jsx)(J.Surface,{css:ei.bodyContainer,elevated:!0,children:(0,n.jsx)(ec,{diff:t,splitOrUnified:o})})]},t.id)};e.s(["DiffBody",()=>ec,"DiffViewer",()=>ed,"SplitOrUnifiedDiffButton",()=>eo],304662);var ef=e.i(12219),ep=e.i(230999),eh=i.Type.Object({type:i.Type.Literal("git"),revision:i.Type.String()}),eg=i.Type.Object({type:i.Type.Literal("fs")}),em=i.Type.Object({type:i.Type.Literal("generatedFile"),content:i.Type.String()}),ev=i.Type.Object({left:i.Type.Object({path:i.Type.String(),data:i.Type.Union([eh,eg,em])}),right:i.Type.Object({path:i.Type.String(),data:i.Type.Union([eh,eg,em])})}),ex=i.Type.Object({type:i.Type.Literal("patch"),diff:s.UnifiedDiffSchema}),ey=i.Type.Object({type:i.Type.Literal("diff"),data:i.Type.Union([ev,i.Type.Array(ev),ex])}),eb=(0,y.cssRecord)({container:[b.rcss.p(8)],singleDiffWrapper:[b.rcss.width("100%"),b.rcss.backgroundColor.backgroundHigher,b.rcss.borderRadius(4),b.rcss.mb(8)],accordionBody:[b.rcss.border({direction:"x",width:1,color:x.tokens.backgroundHigher}),b.rcss.border({direction:"bottom",width:1,color:x.tokens.backgroundHigher}),b.rcss.backgroundColor.backgroundDefault,b.rcss.borderRadius(0,0,4,4)]});function ew(e){var i=e.left,o=e.right,s=e.splitOrUnified,u=(0,t._)((0,r.useState)(!0),2),c=u[0],d=u[1],f=g(i.path,i.data),p=f.fileContent,h=f.loading,m=g(o.path,o.data),x=m.fileContent,y=m.loading,b="generatedFile"===i.data.type?i.data.content:null,C="generatedFile"===o.data.type?o.data.content:null,j=p||b,T=x||C,E=(0,r.useMemo)(function(){return null===j&&null!==T?a.GitCommitFileType.ADDED:null!==j&&null===T?a.GitCommitFileType.DELETED:a.GitCommitFileType.MODIFIED},[j,T]),R={id:"".concat(i.path,"-").concat(o.path),status:E,loading:h||y,initial:{filename:(0,l.getFileName)(i.path),path:(0,l.getParentPath)(i.path),content:null!=j?j:""},final:{filename:(0,l.getFileName)(o.path),path:(0,l.getParentPath)(o.path),content:null!=T?T:""}};return(0,n.jsx)(S.View,{css:eb.singleDiffWrapper,children:(0,n.jsx)(w.AccordionItem,{expanded:c,onClick:function(){return d(function(e){return!e})},headerContent:(0,n.jsxs)(S.View,{row:!0,gap:8,children:[(0,n.jsx)(k.default,{path:i.path}),(0,n.jsx)(_.Text,{multiline:!1,children:i.path})]}),children:(0,n.jsx)(S.View,{css:eb.accordionBody,p:4,children:(0,n.jsx)(ec,{splitOrUnified:s,diff:R})})})})}function ek(e){var t=e.patch;return(0,n.jsx)(S.View,{css:eb.container,children:(0,n.jsx)(ef.default,{patch:t.diff,compressed:!1,background:null})})}var e_={Content:function(e){var i=e.pane.data,o=(0,t._)((0,r.useState)("Split"),2),a=o[0],s=o[1],l=(0,r.useMemo)(function(){return Array.isArray(i)?i:[i]},[i]);return"type"in i&&"patch"===i.type?(0,n.jsx)(ek,{patch:i}):(0,n.jsxs)(S.View,{gap:8,css:eb.container,children:[(0,n.jsx)(eo,{value:a,onChange:s}),(0,n.jsx)(S.View,{children:l.map(function(e){return"left"in e&&"right"in e?(0,n.jsx)(ew,{left:e.left,right:e.right,splitOrUnified:a},e.left.path+e.right.path):null})})]})},Icon:function(){return(0,n.jsx)(ep.default,{})},getTitle:function(e){var t=e.data,n=Array.isArray(t)?t:[t];if(1===n.length){var r=n[0];if("type"in r&&"patch"===r.type){var i=r.diff,o=i.labelA,a=i.labelB;return o===a?"Diff: ".concat((0,l.getFileName)(null!=o?o:"")):"Diff: ".concat(o," - ").concat(a)}if("left"in r&&"right"in r)return r.left.path===r.right.path?"Diff: ".concat((0,l.getFileName)(r.left.path)):"Diff: ".concat((0,l.getFileName)(r.left.path)," - ").concat((0,l.getFileName)(r.right.path))}return"Diff: ".concat(n.length," files")},category:m.PaneCategory.WorkspaceFeatures,decode:function(e){return o.Value.Decode(ey,e)}};e.s(["diffUI",()=>e_],876899);var eS=e.i(569384),eC=e.i(973245),ej=e.i(304277);function eT(){var e=(0,eS._)(["\n  query WorkspaceDraw($id: String!) {\n    currentUser {\n      id\n      username\n    }\n    getRepl(id: $id) {\n      ... on Repl {\n        __typename\n        id\n      }\n    }\n  }\n"]);return eT=function(){return e},e}e.i(566901);var eE={},eR=(0,eC.gql)(eT());function eI(e){var t=(0,T._)({},eE,e);return ej.useQuery(eR,t)}e.s(["useWorkspaceDrawQuery",()=>eI],737898)},900396,282007,118022,100371,95826,752169,592639,27329,4533,955047,966773,673376,15862,480170,718402,793384,751690,58075,e=>{"use strict";var t=e.i(276385),n=e.i(960933),r=e.i(862927),i=e.i(205104),o=e.i(529810),a=e.i(394212),s=e.i(297083),l=e.i(878420),u=e.i(64386),c=e.i(530658),d=e.i(346715),f=e.i(817556),p=e.i(389959),h=e.i(223808),g=e.i(15053),m=e.i(737898),x=e.i(995683),y=e.i(921521),b=e.i(207237),w=e.i(299798),k=e.i(927158),_=e.i(516351),S=function(e){return e.reduce(function(e,t){return e[t.id]=t,e},{})};let C=function(e,t,n){if(!e)return[];var r,i=t(e.getSceneElementsIncludingDeleted()),o=e.getAppState();return(r=n.reduce(function(e,t){var n,r,a;return t.id===(null==(n=o.editingElement)?void 0:n.id)||t.id===(null==(r=o.resizingElement)?void 0:r.id)||t.id===(null==(a=o.draggingElement)?void 0:a.id)||(i[t.id]&&i[t.id].version>t.version||i[t.id]&&i[t.id].version===t.version&&i[t.id].versionNonce!==t.versionNonce&&i[t.id].versionNonce<t.versionNonce?e.push(i[t.id]):e.push(t),delete i[t.id]),e},[])).concat.apply(r,(0,d._)(Object.values(i)))},j=function(){var e,t,n=new Promise(function(n,r){e=n,t=r});return n.resolve=e,n.reject=t,n};var T=e.i(663762),E=e.i(967629),R=e.i(480028),I=e.i(703774),A=e.i(625484),P=e.i(219577),D=(0,E.css)(".excalidraw.excalidraw-modal-container.excalidraw--mobile{margin-top:",P.HEADER_HEIGHT-1,"px;}");function O(n){var r,i=n.fs,o=n.filePath,P=(0,c._)((0,p.useState)(void 0),2),O=P[0],N=P[1],M=(0,y.default)(),L=(0,p.useRef)(function(e){return(0,d._)(e)}),B=(0,p.useRef)(function(e){return -1}),V=(0,p.useRef)(),F=(0,p.useRef)(j()),U=(0,k.usePid2Callback)(function(e){return function(t){return e.excalidraw.update.rpc(t)}},[]);(0,p.useEffect)(function(){e.A(532703).then(function(e){L.current=function(t){return t.filter(function(t){return t.isDeleted||!e.isInvisiblySmallElement(t)})},B.current=e.getSceneVersion,N(e.Excalidraw)})},[]);var G=(0,p.useCallback)(function(){return V.current},[]),$=(0,b.default)(),z=(0,m.useWorkspaceDrawQuery)({variables:{id:$},ssr:!1}),H=z.data,W=z.loading,q=(null==H||null==(r=H.currentUser)?void 0:r.username)||"",K=(0,I.useTheme)().isDarkColorScheme,Y=(0,T.useActiveUsers)(),Q=(0,_.default)(),X=null==Q?void 0:Q.color,J=(0,c._)((0,p.useState)(new Map),2),Z=J[0],ee=J[1],et=(0,c._)((0,p.useState)(-1),2),en=et[0],er=et[1],ei=(0,p.useRef)((0,g.v4)()).current;(0,p.useEffect)(function(){(0,s._)(function(){var e,t;return(0,f._)(this,function(n){switch(n.label){case 0:if(!H||!H.currentUser)return[2];return[4,F.current];case 1:return n.sent(),e=G().getAppState().collaborators,t=new Map,Y.forEach(function(n){if(n.username!==(null==H||null==(r=H.currentUser)?void 0:r.username)){var r,i=e.get(n.username)||{};t.set(n.username,(0,u._)((0,l._)({},i),{username:n.username,color:{background:n.color,foreground:n.color}}))}}),G().updateScene({collaborators:t}),[2]}})})()},[H,Y,G]);var eo=(0,p.useCallback)(function(e,t){return(0,s._)(function(){var n,r,i,a,s,l;return(0,f._)(this,function(u){t||(e=e.filter(function(e){return!Z.has(e.id)||e.version>Z.get(e.id)})),n=!0,r=!1,i=void 0;try{for(a=e[Symbol.iterator]();!(n=(s=a.next()).done);n=!0)l=s.value,Z.set(l.id,l.version),ee(new Map(Z))}catch(e){r=!0,i=e}finally{try{n||null==a.return||a.return()}finally{if(r)throw i}}return null==U||U({paneId:ei,path:o,$kind:"elements",elements:JSON.stringify(e)}),[2]})})()},[U,ei,o,Z]);(0,w.usePid2)(function(e,t){var n=t.signal;return(0,s._)(function(){var t,r,i,s,c,d,p,h,g,m,x,y,b,w,k,_;return(0,f._)(this,function(f){switch(f.label){case 0:return t=e.excalidraw.listen.subscribe({paneId:ei,path:o},{signal:n}).resReadable,[4,F.current];case 1:f.sent(),r=!1,i=!1,f.label=2;case 2:f.trys.push([2,7,8,13]),c=(0,a._)(t),f.label=3;case 3:return[4,c.next()];case 4:if(!(r=!(d=f.sent()).done))return[3,6];if(!(p=d.value).ok)return[2];"collaborator"===p.payload.$kind?(h=G().getAppState().collaborators,m=(g=p.payload).pointer,x=g.selectedElementIds,h.set(p.payload.username,(0,u._)((0,l._)({},h.get(p.payload.username)),{pointer:m,selectedElementIds:x,username:p.payload.username})),G().updateScene({collaborators:h})):"elements"===p.payload.$kind?(y=JSON.parse(p.payload.elements),b=C(G(),S,y),(w=B.current(b))>en&&(er(w),G().updateScene({elements:b}))):"leave"===p.payload.$kind&&((k=G().getAppState().collaborators).delete(p.payload.username),G().updateScene({collaborators:k})),f.label=5;case 5:return r=!1,[3,3];case 6:return[3,13];case 7:return _=f.sent(),i=!0,s=_,[3,13];case 8:if(f.trys.push([8,,11,12]),!(r&&null!=c.return))return[3,10];return[4,c.return()];case 9:f.sent(),f.label=10;case 10:return[3,12];case 11:if(i)throw s;return[7];case 12:return[7];case 13:return[2]}})})()},[ei,o,G,en,B]),(0,p.useEffect)(function(){(0,s._)(function(){var e,t;return(0,f._)(this,function(n){switch(n.label){case 0:if(!o||!i)return[2];return[4,i.readFile(o)];case 1:if(!("content"in(e=n.sent())))return[3,3];return t=JSON.parse(e.content.toString()||"{}"),[4,F.current];case 2:n.sent(),G().updateScene({elements:t.elements||[],appState:t.appState||{}}),G().scrollToContent(),n.label=3;case 3:return[2]}})})()},[o,i,G]);var ea=(0,p.useCallback)((0,h.default)(function(e,t){return(0,s._)(function(){var n;return(0,f._)(this,function(r){switch(r.label){case 0:if(n=e.filter(function(e){return!e.isDeleted}),!o)return[3,2];return[4,i.writeFile(o,x.default.from(JSON.stringify({elements:n,files:t})))];case 1:r.sent(),r.label=2;case 2:return[2]}})})()},350),[o]),es=(0,p.useCallback)(function(e){var t=B.current(e);t>en&&(eo(L.current(e),!1),er(t))},[eo,L,B]);return(0,t.jsxs)(A.View,{css:{position:"relative",height:"100%",width:"100%",flex:1,boxShadow:X?"0 3px 0 3px ".concat(X):"none",backgroundColor:R.tokens.backgroundDefault,"& .excalidraw [title~=Library]":{display:"none"}},onMouseLeave:function(){null==U||U({paneId:ei,path:o,$kind:"leave"})},children:[O&&!W?(0,t.jsx)(O,{ref:function(e){e&&(V.current=e,e.readyPromise&&e.readyPromise.then(function(e){F.current.resolve(e)}).catch(function(e){F.current.reject(e)}))},UIOptions:{canvasActions:{loadScene:!1}},isCollaborating:!0,theme:K?"dark":"light",onPointerUpdate:function(e){var t=e.pointer;null==U||U({paneId:ei,path:o,$kind:"collaborator",pointer:t,selectedElementIds:G().getAppState().selectedElementIds||{}})},onChange:function(e,t,n){es(e),B.current(e)>en&&ea(e,n)},name:q}):null,M?(0,t.jsx)(E.Global,{styles:[D]}):null]})}function N(e){var n=e.fs,r=e.filePath;return(0,t.jsx)(O,{fs:n,filePath:r},r)}e.s(["default",()=>N],282007);var M=e.i(185511),L=e.i(294468),B=e.i(827759);e.i(282890);var V=e.i(716636),F=e.i(259493),U=e.i(136319),G=n.Type.Object({type:n.Type.Literal("draw"),data:n.Type.Object({path:n.Type.String()})}),$={Content:function(e){var n=e.pane,r=e.options.performPaneOperation;return(0,t.jsx)(z,{path:n.data.path,performPaneOperation:r})},Icon:function(e){var n=e.size;return(0,t.jsx)(U.default,{size:n})},getTitle:function(e){return(0,i.getFileName)(e.data.path)},category:V.PaneCategory.WorkspaceFeatures,decode:function(e){return r.Value.Decode(G,e)}};function z(e){var n=e.path,r=e.performPaneOperation,i=(0,o.default)().fs,a=(0,M.useFileCommands)({path:n,performPaneOperation:r});return(0,F.useSetPaneBindings)(function(){if(a)return{commands:[{commands:a}]}},[a]),(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(B.FileHeader,{path:n,performPaneOperation:r}),(0,t.jsx)(L.Content,{children:(0,t.jsx)(N,{fs:i,filePath:n})})]})}e.s(["drawUI",()=>$],900396);var H=e.i(32967),W=e.i(530310),q=n.Type.Object({type:n.Type.Literal("envEditor")}),K={Content:function(e){var n=e.options.performPaneOperation;return(0,t.jsx)(H.default,{performPaneOperation:n})},Icon:function(e){var n=e.size;return(0,t.jsx)(W.default,{size:n})},getTitle:function(){return"Secrets"},description:"Store sensitive information (like API keys) securely in your App",category:V.PaneCategory.WorkspaceFeatures,decode:function(e){return r.Value.Decode(q,e)}};e.s(["envEditorUI",()=>K],118022);var Y=e.i(721281),Q=e.i(131141);e.i(925218);var X=e.i(112077),J=e.i(649960);function Z(){var e=(0,X.useCreateObservable)({open:!1,overlayed:!1,width:0}),t=(0,J.default)(function(t){e.set((0,Q.produce)(e.current,function(e){var n=Math.min(t.width,240);e.overlayed=t.width<500+n,e.width=n}))}),n=(0,p.useCallback)(function(t){return e.set((0,Q.produce)(e.current,function(e){e.open=null!=t?t:!e.open}))},[e]),r=(0,p.useCallback)(function(){var t=e.current,r=t.open,i=t.overlayed;r&&i&&n(!1)},[e,n]);return{state:e,setSidebarContainerEl:t,toggleSidebar:n,closeIfNeeded:r}}var ee=(0,e.i(123850).createCssVarTokens)(["sidebarTransform","sidebarWidth","sidebarHeight","paddingLeft","sidebarOpacity","sidebarPointerEvents","sidebarBorder","sidebarBlanketPointerEvents","sidebarBlanketOpacity"]),et=ee.cssVars,en=ee.styleTokens;function er(e){var t,n,r="calc(100% - ".concat(R.tokens.space16,")"),i="translate(".concat(R.tokens.space8,", ").concat(R.tokens.space8,")");return e.open?(t={},(0,Y._)(t,et.paddingLeft,e.overlayed?"0":e.width+6+"px"),(0,Y._)(t,et.sidebarWidth,e.width+"px"),(0,Y._)(t,et.sidebarOpacity,"1"),(0,Y._)(t,et.sidebarBlanketOpacity,e.overlayed?"1":"0"),(0,Y._)(t,et.sidebarBlanketPointerEvents,e.overlayed?"all":"none"),(0,Y._)(t,et.sidebarPointerEvents,"all"),(0,Y._)(t,et.sidebarTransform,i),(0,Y._)(t,et.sidebarHeight,r),t):(n={},(0,Y._)(n,et.paddingLeft,"0"),(0,Y._)(n,et.sidebarWidth,e.width+"px"),(0,Y._)(n,et.sidebarOpacity,"0"),(0,Y._)(n,et.sidebarBlanketOpacity,"0"),(0,Y._)(n,et.sidebarBlanketPointerEvents,"none"),(0,Y._)(n,et.sidebarPointerEvents,"none"),(0,Y._)(n,et.sidebarTransform,i),(0,Y._)(n,et.sidebarHeight,r),n)}e.s(["getSidebarCssVars",()=>er,"sidebarStyleTokens",()=>en,"useChatSidebarState",()=>Z],100371);var ei=e.i(629536),eo=e.i(596139),ea=e.i(418725),es=e.i(973519),el=e.i(158689),eu=e.i(758386),ec=e.i(446530),ed=e.i(613355),ef=e.i(751273),ep="The ".concat(eo.freePlanName," plan includes Basic ").concat(ei.ASSISTANT_NAME,". Upgrade for more capabilities."),eh=(0,ec.cssRecord)({pill:[ed.rcss.cursor.pointer]}),eg=function(e){var n=(0,eu.useUpsellContext)(),r=n.showAiUpsell,i=n.refetch,o=(0,es.useGlobalModal)().show;return r?(0,t.jsx)(ef.Tooltip,{tooltip:ep,children:(0,t.jsx)(el.Pill,{css:eh.pill,text:"BASIC",onClick:function(){return(0,s._)(function(){return(0,f._)(this,function(t){switch(t.label){case 0:return[4,o("MembershipPurchaseModal",{headingText:"Upgrade for Advanced AI",subHeadingText:"Get the most advanced model with higher quality responses and generation",analyticsContext:{upgrade:{context:"ai_chat_upsell"}},onPurchaseComplete:function(){var t;null==(t=e.onPurchaseComplete)||t.call(e),i()}})];case 1:return t.sent(),[2]}})})()}})}):null};e.s(["AiUpsellPillWithPurchaseModal",()=>eg],95826);var em=e.i(602213),ev=e.i(500736),ex=e.i(128258),ey=e.i(929872),eb=e.i(960178),ew=e.i(819700),ek=ed.container.max(520),e_=(0,ec.cssRecord)({upgradeSurface:[ed.rcss.center,ed.rcss.borderRadius("container")],upgradeSurfaceAiItems:[(0,Y._)({},ek,[ed.rcss.colWithGap(16)])],upgradeSurfaceAiItem:[ed.rcss.colWithGap(8),ed.rcss.align.center,ed.rcss.maxWidth(220),ed.rcss.textAlign.center],upgradeSurfaceAiItemTitle:[ed.rcss.rowWithGap(4),ed.rcss.align.center],shortText:[ed.rcss.display.none,(0,Y._)({},ek,[ed.rcss.display.block])],longText:[ed.rcss.display.block,(0,Y._)({},ek,[ed.rcss.display.none])]});function eS(){var e=(0,ev.useReplUrl)();return(0,t.jsxs)(ey.Surface,{elevated:!0,css:e_.upgradeSurface,p:16,gap:16,children:[(0,t.jsxs)(A.View,{children:[(0,t.jsx)(A.View,{css:e_.longText,children:(0,t.jsx)(ea.default,{context:"ai_chat_upsell",text:"Upgrade to Replit ".concat(eo.corePlanName," for more powerful AI"),variant:"default",modalHeadingText:"Upgrade to Replit ".concat(eo.corePlanName," for more powerful AI"),redirectPath:e})}),(0,t.jsx)(A.View,{css:e_.shortText,children:(0,t.jsx)(ea.default,{context:"ai_chat_upsell",text:"Upgrade to ".concat(eo.corePlanName),variant:"default",css:e_.shortText,redirectPath:e})})]}),(0,t.jsxs)(A.View,{css:e_.upgradeSurfaceAiItems,row:!0,gap:16,children:[(0,t.jsxs)(A.View,{css:e_.upgradeSurfaceAiItem,children:[(0,t.jsxs)(A.View,{css:e_.upgradeSurfaceAiItemTitle,children:[(0,t.jsx)(ew.default,{size:16}),(0,t.jsx)(eb.Text,{variant:"subheadDefault",children:ei.ASSISTANT_NAME}),(0,t.jsx)(el.Pill,{text:"ADVANCED"})]}),(0,t.jsx)(eb.Text,{variant:"small",color:"dimmer",children:ei.ASSISTANT_ADVANCED_CAPABILITIES})]}),(0,t.jsxs)(A.View,{css:e_.upgradeSurfaceAiItem,children:[(0,t.jsxs)(A.View,{css:e_.upgradeSurfaceAiItemTitle,children:[(0,t.jsx)(em.AgentAvatar,{size:16}),(0,t.jsx)(eb.Text,{variant:"subheadDefault",children:"Agent"})]}),(0,t.jsx)(eb.Text,{variant:"small",color:"dimmer",children:ei.AGENT_DESCRIPTION})]})]})]})}function eC(){var e=(0,ex.default)();return(0,t.jsxs)(A.View,{row:!0,gap:4,align:"center",children:[(0,t.jsx)(eb.Header,{level:1,variant:"subheadDefault",children:ei.ASSISTANT_NAME}),(0,t.jsx)(eg,{onPurchaseComplete:e})]})}e.s(["AssistantFreeModeUpsell",()=>eS,"AssistantFreeModeUpsellTitle",()=>eC],752169);var ej=e.i(396776),eT=e.i(42458),eE="Connection to ".concat(ei.ASSISTANT_NAME," lost. Try refreshing the page."),eR=(0,ec.cssRecord)({root:[{justifySelf:"end"}],errorBannerContainer:[ed.rcss.display.flex,ed.rcss.align.center,ed.rcss.flex.grow(1),ed.rcss.minHeight(32),ed.rcss.maxHeight(300),ed.rcss.overflow("auto")],errorBanner:[ed.rcss.minHeight("fit-content"),ed.rcss.p(8)]});function eI(){return(0,t.jsx)(A.View,{css:eR.root,px:8,pb:8,children:(0,t.jsx)(A.View,{css:eR.errorBannerContainer,justify:"center",children:(0,t.jsx)(A.View,{css:eR.errorBanner,children:(0,t.jsx)(ej.StatusBanner,{icon:(0,t.jsx)(eT.default,{}),colorway:"red",text:eE})})})})}function eA(){var e=(0,p.useRef)(null),t=(0,X.useCreateObservable)(!1);return(0,p.useEffect)(function(){var n=e.current;if(n){var r=function(){var e=n.scrollTop>0;t.current!==e&&t.set(e)},i=requestAnimationFrame(r),o=function(){i&&cancelAnimationFrame(i),i=requestAnimationFrame(r)};return n.addEventListener("scroll",o),function(){n.removeEventListener("scroll",o),i&&cancelAnimationFrame(i)}}},[e,t]),{scrollerRef:e,isScrolledDown:t}}e.s(["ChatError",()=>eI],592639),e.s(["useIsScrolledDown",()=>eA],27329);var eP=e.i(383748),eD=function(){var e=(0,eu.useUpsellContext)(),n=e.showAiUpsell,r=e.refetch,i=(0,es.useGlobalModal)().show,o=(0,ex.default)();return n?(0,t.jsx)(A.View,{tag:"button",css:eO.bannerWrapper,onClick:function(){return(0,s._)(function(){return(0,f._)(this,function(e){switch(e.label){case 0:return[4,i("MembershipPurchaseModal",{headingText:"Upgrade for Advanced AI",subHeadingText:"Get the most advanced model with higher quality responses and generation",analyticsContext:{upgrade:{context:"ai_chat_upsell"}},onPurchaseComplete:function(){r(),o()}})];case 1:return e.sent(),[2]}})})()},children:(0,t.jsx)(ej.StatusBanner,{icon:(0,t.jsx)(eP.default,{}),colorway:"yellow",text:"You're using the free Basic AI model. Upgrade to get better AI responses and more accurate code generation and analysis.",css:eO.banner})}):null},eO=(0,ec.cssRecord)({bannerWrapper:[ed.rcss.cursor.pointer,ed.rcss.textAlign.left],banner:[ed.rcss.borderRadius(0)]});e.s(["AiUpsellChatStatus",()=>eD],4533);var eN=e.i(374106),eM=e.i(188507),eL=e.i(986194),eB=e.i(799581);function eV(e){return e.error&&e.error.type!==eM.EventErrorType.EVENT_ERROR_TYPE_UNKNOWN?e.error.type:null}var eF=e.i(115425);e.s(["default",0,{direction:"reverse",state:{iterativeAgentEvents:[],didProcessLatestProposedActionsEvent:!1},transformer:function(e,t){var n=e.contents.contents;if((0,eL.isKind)(n,"messageEventContents")){var r=(0,eL.unkind)(n);if(e.sender.type===eM.UserType.USER)return{type:"userMessage",sender:{id:e.sender.id},uploadedFiles:r.uploadedFiles,codeReference:r.codeReference,content:r.content,targetedElement:r.targetedElement};var i,o,a,s,c,f,p,h,g,m,x,y,b,w,k,_,S,C,j,T,E,R,I,A,P,D=eV(e),O=function(e){if(!(0,eL.isKind)(e,"proposedFileChanges"))return{fileChanges:[],commitId:"",summary:""};var t=(0,eL.unkind)(e),n=t.changes,r=t.commitId,i=t.summary;return{fileChanges:n.map(function(e){return(0,u._)((0,l._)({},e),{filePath:(0,eF.trimLeadingSlash)(e.filePath)})}),commitId:r,summary:i}}((0,eL.unkind)(n).extraActions),N=O.fileChanges,M=O.commitId,L=O.summary,B=(0,eL.unkind)(n).assistantProposedActions,V=(0,eN.isEventAssistantEditRequest)(e),F=(o=B,a=N,s=(i=e.id,t.iterativeAgentEvents.filter(function(e){return(0,eL.isKind)(e.contents,"installingPackages")||(0,eL.isKind)(e.contents,"installedPackages")?(0,eL.unkind)(e.contents).eventWhichProposedPackageInstall===i:(0,eL.isKind)(e.contents,"startedShellExecution")||(0,eL.isKind)(e.contents,"finishedShellExecution")?(0,eL.unkind)(e.contents).eventWhichProposedShellExecution===i:(0,eL.isKind)(e.contents,"appliedRunConfiguration")?(0,eL.unkind)(e.contents).eventWhichProposedRunConfiguration===i:(0,eL.isKind)(e.contents,"appliedDeploymentConfiguration")?(0,eL.unkind)(e.contents).eventWhichProposedDeploymentConfiguration===i:!!(0,eL.isKind)(e.contents,"appliedWorkflowConfiguration")&&(0,eL.unkind)(e.contents).eventWhichProposedWorkflowConfiguration===i})),x=(null!=(c=null==o?void 0:o.shellCommands)?c:[]).map(function(e){var t,n;return s.forEach(function(r){(0,eL.isKind)(r.contents,"startedShellExecution")&&r.contents.startedShellExecution.messageContentsOffset===e.messageContentsOffset&&(t=r.contents.startedShellExecution),(0,eL.isKind)(r.contents,"finishedShellExecution")&&r.contents.finishedShellExecution.messageContentsOffset===e.messageContentsOffset&&(n=r.contents.finishedShellExecution)}),n&&n.processId===(null==t?void 0:t.processId)?{state:"finished",command:e.command,isDangerous:e.isDangerous,messageContentsOffset:e.messageContentsOffset,workingDirectory:e.workingDirectory,commandOutput:n.commandOutput,exitCode:n.exitCode}:t?{state:"running",command:e.command,isDangerous:e.isDangerous,messageContentsOffset:e.messageContentsOffset,workingDirectory:e.workingDirectory,processId:t.processId}:{state:"proposed",command:e.command,isDangerous:e.isDangerous,messageContentsOffset:e.messageContentsOffset,workingDirectory:e.workingDirectory}}),y=(null!=(f=null==o?void 0:o.packageInstalls)?f:[]).map(function(e){var t,n;return s.forEach(function(r){(0,eL.isKind)(r.contents,"installingPackages")&&r.contents.installingPackages.messageContentsOffset===e.messageContentsOffset&&(t=r.contents.installingPackages),(0,eL.isKind)(r.contents,"installedPackages")&&r.contents.installedPackages.messageContentsOffset===e.messageContentsOffset&&(n=r.contents.installedPackages)}),n&&n.processId===(null==t?void 0:t.processId)?{state:"installed",language:e.language,packageList:e.packageList,messageContentsOffset:e.messageContentsOffset,installationOutput:n.installationOutput,exitCode:n.exitCode}:t?{state:"installing",language:e.language,packageList:e.packageList,messageContentsOffset:e.messageContentsOffset,processId:t.processId}:{state:"proposed",language:e.language,packageList:e.packageList,messageContentsOffset:e.messageContentsOffset}}),b=null!=(p=o.workspaceToolNudges)?p:[],w=(null!=(h=o.runConfigurations)?h:[]).map(function(e){var t=s.some(function(t){return!!(0,eL.isKind)(t.contents,"appliedRunConfiguration")&&t.contents.appliedRunConfiguration.messageContentsOffset===e.messageContentsOffset});return(0,l._)({state:t?"applied":"proposed"},e)}),k=(null!=(g=o.workflowConfigurations)?g:[]).map(function(e){var t=s.some(function(t){return!!(0,eL.isKind)(t.contents,"appliedWorkflowConfiguration")&&t.contents.appliedWorkflowConfiguration.messageContentsOffset===e.messageContentsOffset});return(0,l._)({state:t?"applied":"proposed"},e)}),_=(null!=(m=o.deploymentConfigurations)?m:[]).map(function(e){var t=s.some(function(t){return!!(0,eL.isKind)(t.contents,"appliedDeploymentConfiguration")&&t.contents.appliedDeploymentConfiguration.messageContentsOffset===e.messageContentsOffset});return(0,l._)({state:t?"applied":"proposed"},e)}),S=(0,d._)(x.map(function(e){return(0,eL.withKind)("shellCommand",e)})).concat((0,d._)(y.map(function(e){return(0,eL.withKind)("packageInstall",e)})),(0,d._)(a.map(function(e){return(0,eL.withKind)("fileChange",e)})),(0,d._)(b.map(function(e){return(0,eL.withKind)("workspaceToolNudge",e)})),(0,d._)(w.map(function(e){return(0,eL.withKind)("runConfiguration",e)})),(0,d._)(_.map(function(e){return(0,eL.withKind)("deploymentConfiguration",e)})),(0,d._)(k.map(function(e){return(0,eL.withKind)("workflowConfiguration",e)}))).sort(function(e,t){return(0,eL.unkind)(e).messageContentsOffset-(0,eL.unkind)(t).messageContentsOffset}),C=x.length>0,j=y.length>0,T=w.length>0,E=_.length>0,R=k.length>0,{sortedActions:S,hasAnyWorkspaceProposedActions:C||j||T||E||R}),U=F.sortedActions,G=F.hasAnyWorkspaceProposedActions,$=!1;return t.didProcessLatestProposedActionsEvent||(t.didProcessLatestProposedActionsEvent=$=B.didCountEditRequest||B.workflowConfigurations.length>0),{type:"assistantMessage",content:r.content,created:e.created,state:e.state,intent:{value:r.intent,kind:"message"},error:D,usedModelSelector:r.usedModelSelector,ragSources:function(e){var t=e.sources;if(null==t)return[];var n=t.slice().sort(function(e,t){return e.url.localeCompare(t.url)});return(0,eB.dedupe)(n,"url")}(r),isDebugMessage:!1,sessionId:e.sessionId,proposedActions:(0,u._)((0,l._)({},B),{commitId:null!=(I=B.commitId)?I:M,summary:null!=(A=B.summary)?A:L,fileChanges:N,sortedActions:U,didCreateCheckpoint:null!=(P=B.didCreateCheckpoint)&&P,didCountEditRequest:V,hasAnyWorkspaceProposedActions:G}),isLatestProposedActionsEvent:$}}if((0,eL.isKind)(n,"inlineActionEventContents")){var z=(0,eL.unkind)(n);if(e.sender.type===eM.UserType.USER)return{type:"userMessage",sender:{id:e.sender.id},codeReference:z.codeReference,content:z.content};var H=eV(e);return{type:"assistantMessage",content:z.content,created:e.created,state:e.state,intent:{value:z.messageType,kind:"inline"},error:H,usedModelSelector:z.usedModelSelector,ragSources:[],isDebugMessage:z.messageType===eM.InlineMessageType.DEBUGGER,sessionId:e.sessionId,proposedActions:null,isLatestProposedActionsEvent:!1}}if((0,eL.isKind)(n,"iterativeAgentEventContents")){var W=(0,eL.unkind)(n);t.iterativeAgentEvents.push(W);var q=(0,eN.getEventIdWhichProposedAction)(e);if(!q)return;return{type:"assistantAction",contents:W,created:e.created,sessionId:e.sessionId,eventIdWhichProposedAction:q}}}}],955047);var eU=e.i(266645),eG=e.i(200260),e$=e.i(64256),ez=e.i(409146),eH=e.i(140487),eW=e.i(630818),eq=e.i(292642),eK=(0,ec.cssRecord)({root:[ed.rcss.borderRadius(4),ed.rcss.border({color:R.tokens.outlineDimmest})],header:[ed.rcss.border({color:R.tokens.outlineDimmest,direction:"bottom"})],button:[{borderRadius:0,borderTopLeftRadius:4}]});function eY(e){var n=e.codeReference,r=e.onClick;return(0,t.jsxs)(ey.Surface,{css:eK.root,elevated:!0,children:[(0,t.jsx)(A.View,{css:eK.header,row:!0,gap:4,children:(0,t.jsx)(eH.Button,{css:eK.button,size:"small",variant:"nofill",iconLeft:(0,t.jsx)(eW.default,{size:12,path:n.filePath}),iconRight:(0,t.jsx)(eq.default,{}),text:"".concat(n.filePath," ").concat(n.range.lineFrom,":").concat(n.range.lineTo),onClick:r})}),(0,t.jsx)(ez.default,{lineNumbers:!0,lineNumbersStart:n.range.lineFrom,language:n.language,code:n.code,filePath:n.filePath})]})}var eQ=e.i(462995),eX=e.i(165579),eJ=e.i(569384),eZ=e.i(973245),e0=e.i(304277);function e1(){var e=(0,eJ._)(["\n  fragment AiChatMessageUser on User {\n    id\n    username\n    fullName\n    image\n    url\n  }\n"]);return e1=function(){return e},e}function e2(){var e=(0,eJ._)(["\n  query AiChatMessageUserData($id: Int!) {\n    user(id: $id) {\n      ...AiChatMessageUser\n    }\n  }\n  ","\n"]);return e2=function(){return e},e}e.i(566901);var e3={},e4=(0,eZ.gql)(e1()),e8=(0,eZ.gql)(e2(),e4),e5=e.i(714165);function e6(e){var n,r,i,o,a,s,u,c,d,f=(n={variables:{id:e.id}},r=(0,l._)({},e3,n),e0.useQuery(e8,r)).data,p=null==f?void 0:f.user;return e.showAvatarOnly?(0,t.jsx)(e5.Avatar,{size:24,username:null!=(i=null==p?void 0:p.username)?i:"",fullName:null!=(o=null==p?void 0:p.fullName)?o:"",src:null!=(a=null==p?void 0:p.image)?a:""}):(0,t.jsxs)(A.View,{row:!0,gap:8,align:"center",children:[(0,t.jsx)(e5.Avatar,{size:24,username:null!=(s=null==p?void 0:p.username)?s:"",fullName:null!=(u=null==p?void 0:p.fullName)?u:"",src:null!=(c=null==p?void 0:p.image)?c:""}),(0,t.jsx)(eb.Text,{variant:"small",color:"dimmer",children:null!=(d=null==p?void 0:p.username)?d:""})]})}var e9=e.i(66718);function e7(e){return(0,p.useCallback)(function(t){var n,r="string"==typeof t?{path:t}:t;e({type:null!=(n=(0,e9.getPaneTypeForFile)(r))?n:"codeEditor",data:r})},[e])}e.s(["useOpenFile",()=>e7],966773);var te=e.i(755323),tt=(0,ec.cssRecord)({event:[{justifyContent:"end"}],userMessageAttachments:[ed.rcss.maxWidth("100%")],message:[ed.rcss.maxWidth(400),ed.rcss.px(8),ed.rcss.py(6),ed.rcss.borderRadius(),ed.rcss.colorMixBg(R.tokens.accentPrimaryDefault,"transparent",.4)],codeReference:[{width:"100%"}]}),tn=(0,p.memo)(function(e){var n,r=e.data,i=e.openPane,o=e.readFile,a=e7(i);return r?(0,t.jsx)(tr,{openFile:a,content:r.content,userId:Number(r.sender.id),codeReference:r.codeReference,uploadedFiles:r.uploadedFiles,readFile:o,targetedElement:null!=(n=r.targetedElement)?n:null}):null});function tr(e){var n=e.openFile,r=e.readFile,i=e.content,o=e.userId,a=e.codeReference,s=e.uploadedFiles,l=e.targetedElement,u=(0,eQ.useMarkdownCodeComponent)({openFile:n,messageSenderType:eM.UserType.USER});return(0,t.jsxs)(A.View,{css:tt.event,px:16,pt:32,pb:16,row:!0,gap:8,children:[(0,t.jsxs)(A.View,{grow:!0,shrink:!0,gap:8,align:"end",children:[s?(0,t.jsx)(ti,{attachments:s,readFile:r}):null,(0,t.jsxs)(A.View,{css:tt.message,gap:8,children:[(0,t.jsx)(eQ.MessageMarkdown,{text:i,codeComponent:u,messageState:eM.EventState.COMPLETE}),l?(0,t.jsx)(eX.TargetedElement,{targetedElement:l}):null]}),(null==a?void 0:a.code)?(0,t.jsx)(A.View,{css:tt.codeReference,children:(0,t.jsx)(eY,{codeReference:a,onClick:function(){var e=null==a?void 0:a.filePath;e&&n({path:e,line:null==a?void 0:a.range.lineTo})}})}):null]}),(0,t.jsx)(A.View,{pt:6,children:(0,t.jsx)(e6,{id:o,showAvatarOnly:!0})})]})}function ti(e){var n=e.attachments,r=e.readFile,i=n.filter(function(e){return!(e.path.split("/").pop()||"").startsWith(te.TARGETED_ELEMENT_SCREENSHOT_PREFIX)});return 0===i.length?null:(0,t.jsx)(A.View,{css:tt.userMessageAttachments,children:(0,t.jsx)(eU.default,{fileAttachments:i.map(function(e){return(0,t.jsx)(eG.FileAttachment,{attachment:e,readFile:r,getAttachmentTypeDisclaimer:(0,e$.getAttachmentTypeDisclaimer)({aiName:ei.ASSISTANT_NAME})},e.path)})})})}e.s(["UserMessageEvent",()=>tn],673376);var to=e.i(754873),ta=e.i(6338),ts=e.i(624782),tl=e.i(245150),tu=(0,ec.cssRecord)({container:[ed.rcss.py(4),ed.rcss.px(8),ed.rcss.borderRadius(4),ed.rcss.flex.growAndShrink(1),ed.rcss.rowWithGap(8),ed.rcss.align.center,ed.rcss.border({color:"transparent"}),{backgroundColor:R.tokens.interactiveBackground,"&.generation-complete":[to.interactive.filledAndOutlined],"&.generation-in-progress":[ta.loadingStyle.foregroundPulse()],"&.is-applied":[ed.rcss.py(2)]}],iconCol:[ed.rcss.py(4),{alignSelf:"flex-start"}],textCol:[ed.rcss.flex.growAndShrink(1),ed.rcss.colWithGap(4),ed.rcss.overflow("hidden")],filePathAndDiffLines:[ed.rcss.rowWithGap(4),ed.rcss.justify.spaceBetween,ed.rcss.align.center],filePath:[ed.rcss.flex.shrink(1)],diffLineStatsPill:[ed.rcss.fontWeight.medium],editSummary:[{".is-reverted &":[ed.rcss.color.foregroundDimmest,{textDecoration:"line-through"}]}]});function tc(e){var n=e.filePath,r=e.content,i=e.changeSummary,o=e.changeStatus,a=e.lineStats,s=e.onOpenDiff,l=e.state,u=l===eM.FileChangeGenerationState.GENERATION_COMPLETE,c=(0,p.useCallback)(function(){u&&s(n,{type:"generatedFile",content:r})},[n,s,u,r]);return(0,t.jsxs)(ey.Surface,{css:tu.container,className:"is-".concat(o.state," generation-").concat(function(e){switch(e){case eM.FileChangeGenerationState.GENERATION_IN_PROGRESS:return"in-progress";case eM.FileChangeGenerationState.GENERATION_REGENERATING:return"regenerating";case eM.FileChangeGenerationState.GENERATION_COMPLETE:return"complete";case eM.FileChangeGenerationState.GENERATION_ERROR:return"error";default:return"unknown"}}(l)),onClick:c,children:[(0,t.jsx)(A.View,{css:tu.iconCol,children:(0,t.jsx)(eW.default,{path:n,fill:"reverted"===o.state?R.tokens.foregroundDimmest:void 0})}),(0,t.jsxs)(A.View,{css:tu.textCol,children:[(0,t.jsxs)(A.View,{css:tu.filePathAndDiffLines,children:[(0,t.jsx)(eb.Text,{variant:"text",color:"default",multiline:!1,css:tu.filePath,children:n}),"reverted"===o.state?(0,t.jsxs)(A.View,{row:!0,gap:4,align:"center",children:[(0,t.jsx)(tl.default,{}),(0,t.jsx)(eb.Text,{variant:"text",color:"dimmer",children:"Reverted"})]}):u?(0,t.jsx)(tf,{filePath:n,lineStats:a}):null]}),(0,t.jsx)(A.View,{css:tu.editSummary,children:(0,t.jsx)(eb.Text,{variant:"small",color:"dimmer",children:i})})]})]})}function td(e){var n=e.filePath,r=e.linesAdded,i=e.linesRemoved,o=e.onOpenDiff,a=e.commitHash;return(0,t.jsxs)(ey.Surface,{css:tu.container,className:"is-applied generation-complete",onClick:function(){return o(n,{type:"git",revision:a})},children:[(0,t.jsx)(A.View,{css:tu.iconCol,children:(0,t.jsx)(eW.default,{path:n})}),(0,t.jsx)(A.View,{css:tu.textCol,children:(0,t.jsxs)(A.View,{css:tu.filePathAndDiffLines,children:[(0,t.jsx)(eb.Text,{variant:"text",color:"default",children:n}),(0,t.jsx)(tf,{filePath:n,lineStats:{added:r,removed:i}})]})})]})}function tf(e){var n=e.lineStats;return null==n?null:(0,t.jsxs)(A.View,{row:!0,gap:4,children:[(0,t.jsx)(ts.Pill,{css:tu.diffLineStatsPill,compact:!0,colorway:"positive",text:"+".concat(n.added)}),(0,t.jsx)(ts.Pill,{css:tu.diffLineStatsPill,compact:!0,colorway:"negative",text:"-".concat(n.removed)})]})}e.s(["AppliedFileChangeCard",()=>td,"ProposedFileChangeCard",()=>tc],15862);var tp=e.i(678741);e.i(877212);var th=e.i(924908),tg=e.i(267103);function tm(e){var t=e.sessionId,n=(0,th.useChatter)(),r=(0,tg.useObservable)(n.sessions.get(t));return(0,p.useCallback)(function(){return null==r?void 0:r.appendEvent({kind:"message",intent:eM.MessageAction.ITERATIVE_AGENT,modelType:eM.ModelType.ADVANCED,message:"The recent code changes you proposed are outdated. Please try generating new file edits which accomplish the same goal.",uploadedFiles:[],useRag:!1,webviewTargetedElement:void 0,fileContext:[],mostRecentFile:void 0})},[r])}function tv(e){var t=e.sessionId,n=e.eventIdWhichProposedChanges,r=(0,th.useChatter)(),i=(0,tg.useObservable)(r.sessions.get(t));return(0,p.useCallback)(function(e){var t=e.appliedChanges,r=e.commitHash;return null==i?void 0:i.appendEvent({kind:"iterativeAgent",action:{eventIdWhichProposedChanges:n,appliedChanges:t,commitHash:r}})},[n,i])}function tx(e){var t=e.sessionId,n=e.eventIdWhichProposedShellExecution,r=(0,th.useChatter)(),i=(0,tg.useObservable)(r.sessions.get(t));return{sendStartedShellExecutionMessage:(0,p.useCallback)(function(e){var t=e.processId,r=e.messageContentsOffset;return null==i?void 0:i.appendEvent({kind:"iterativeAgent",action:{eventIdWhichProposedShellExecution:n,processId:t,messageContentsOffset:r}})},[n,i]),sendFinishedShellExecutionMessage:(0,p.useCallback)(function(e){var t=e.commandOutput,r=e.exitCode,o=e.processId,a=e.messageContentsOffset;return null==i?void 0:i.appendEvent({kind:"iterativeAgent",action:{eventIdWhichProposedShellExecution:n,commandOutput:t,exitCode:r,processId:o,messageContentsOffset:a}})},[n,i])}}function ty(e){var t=e.sessionId,n=e.eventIdWhichProposedPackageInstall,r=(0,th.useChatter)(),i=(0,tg.useObservable)(r.sessions.get(t));return{sendInstallingPackagesMessage:(0,p.useCallback)(function(e){var t=e.processId,r=e.messageContentsOffset;return null==i?void 0:i.appendEvent({kind:"iterativeAgent",action:{eventIdWhichProposedPackageInstall:n,processId:t,messageContentsOffset:r}})},[n,i]),sendInstalledPackagesMessage:(0,p.useCallback)(function(e){var t=e.installationOutput,r=e.exitCode,o=e.processId,a=e.messageContentsOffset;return null==i?void 0:i.appendEvent({kind:"iterativeAgent",action:{eventIdWhichProposedPackageInstall:n,installationOutput:t,messageContentsOffset:a,exitCode:r,processId:o}})},[n,i])}}function tb(e){var t=e.sessionId,n=e.eventIdWhichProposedRunConfiguration,r=(0,th.useChatter)(),i=(0,tg.useObservable)(r.sessions.get(t));return(0,p.useCallback)(function(e){var t=e.messageContentsOffset;return null==i?void 0:i.appendEvent({kind:"iterativeAgent",action:{eventIdWhichProposedRunConfiguration:n,messageContentsOffset:t}})},[n,i])}function tw(e){var t=e.sessionId,n=e.eventIdWhichProposedWorkflowConfiguration,r=(0,th.useChatter)(),i=(0,tg.useObservable)(r.sessions.get(t));return(0,p.useCallback)(function(e){var t=e.messageContentsOffset;return null==i?void 0:i.appendEvent({kind:"iterativeAgent",action:{eventIdWhichProposedWorkflowConfiguration:n,messageContentsOffset:t}})},[n,i])}function tk(e){var t=e.sessionId,n=e.eventIdWhichProposedDeploymentConfiguration,r=(0,th.useChatter)(),i=(0,tg.useObservable)(r.sessions.get(t));return(0,p.useCallback)(function(e){var t=e.messageContentsOffset;return null==i?void 0:i.appendEvent({kind:"iterativeAgent",action:{eventIdWhichProposedDeploymentConfiguration:n,messageContentsOffset:t}})},[n,i])}e.s(["useSendAssistantAppliedFileChangesMessage",()=>tv,"useSendAssistantApplyDeploymentConfigurationMessage",()=>tk,"useSendAssistantApplyRunConfigurationMessage",()=>tb,"useSendAssistantApplyWorkflowConfigurationMessage",()=>tw,"useSendAssistantPackagerMessages",()=>ty,"useSendAssistantRetryEditRequestMessage",()=>tm,"useSendAssistantShellExecutionMessages",()=>tx],480170);var t_=e.i(937500),tS=e.i(993796);function tC(){var e=(0,tS.useFlag)({controlName:"flag-agent-sandbox"});return{spawnCommand:(0,k.usePid2Callback)(function(t){return function(n){return(0,s._)(function(){var r;return(0,f._)(this,function(i){switch(i.label){case 0:return[4,t.shellExec.spawn.rpc({cmd:"bash",args:["-ci",n],env:{REPLIT_MODE:"assistant"},sandbox:e?{rules:[{operation:"Modify",prefixes:["/home/runner/workspace/.replit","/home/runner/workspace/replit.nix","/home/runner/workspace/.cache/replit/","/home/runner/workspace/.local/state/replit/"],message:"A protected file was prevented from being modified. These files are crucial for the correct functionality of the application and should not be modified"},{operation:"Delete",prefixes:["/home/runner/workspace/.replit","/home/runner/workspace/replit.nix","/home/runner/workspace/.local/state/replit/"],message:"A protected file was prevented from being deleted. These files are crucial for the correct functionality of the application and should not be modified"},{operation:"Delete",prefixes:["/home/runner/workspace/.git"],excludePrefixes:["/home/runner/workspace/.git/index.lock"],message:"An unsafe operation with git was blocked to protect your application's history and the ability to go back to other points in time."}]}:void 0})];case 1:if(!(r=i.sent()).ok)return[2,r];return[2,{ok:!0,payload:r.payload.id}]}})})()}},[e]),killProcessId:(0,k.usePid2Callback)(function(e){return function(t){return(0,s._)(function(){return(0,f._)(this,function(n){switch(n.label){case 0:return[4,e.shellExec.kill.rpc({id:t})];case 1:return[2,n.sent()]}})})()}},[]),waitAndGetCommandOutput:(0,k.usePid2Callback)(function(e){return function(t){return(0,s._)(function(){var n,r,i,o,s,l,u,c,d,p,h,g,m,x,y,b,w,k;return(0,f._)(this,function(f){switch(f.label){case 0:n=e.shellExec.monitor.subscribe({id:t}).resReadable,r=-1,i=!1,o=!1,f.label=1;case 1:f.trys.push([1,6,7,12]),l=(0,a._)(n),f.label=2;case 2:return[4,l.next()];case 3:if(!(i=!(u=f.sent()).done))return[3,5];if((c=u.value).ok&&"Finished"===c.payload.state)return r=c.payload.exitCode,[3,5];f.label=4;case 4:return i=!1,[3,2];case 5:return[3,12];case 6:return d=f.sent(),o=!0,s=d,[3,12];case 7:if(f.trys.push([7,,10,11]),!(i&&null!=l.return))return[3,9];return[4,l.return()];case 8:f.sent(),f.label=9;case 9:return[3,11];case 10:if(o)throw s;return[7];case 11:return[7];case 12:p=e.shellExec.readBuffer.subscribe({id:t}).resReadable,h=t_.Buffer.alloc(0),g=!1,m=!1,f.label=13;case 13:f.trys.push([13,18,19,24]),y=(0,a._)(p),f.label=14;case 14:return[4,y.next()];case 15:if(!(g=!(b=f.sent()).done))return[3,17];if((w=b.value).ok&&"output"===w.payload.$kind&&(h=t_.Buffer.concat([h,w.payload.output])),w.ok&&"finished"===w.payload.$kind)return[2,{commandOutput:h.toString(),exitCode:r,processId:t}];f.label=16;case 16:return g=!1,[3,14];case 17:return[3,24];case 18:return k=f.sent(),m=!0,x=k,[3,24];case 19:if(f.trys.push([19,,22,23]),!(g&&null!=y.return))return[3,21];return[4,y.return()];case 20:f.sent(),f.label=21;case 21:return[3,23];case 22:if(m)throw x;return[7];case 23:return[7];case 24:return[2]}})})()}},[])}}e.s(["default",()=>tC],718402);var tj=e.i(762211),tT=e.i(965153),tE=e.i(136540),tR=e.i(978669),tI=e.i(121817),tA=e.i(342574),tP=e.i(796817),tD=(0,ec.cssRecord)({container:[ed.rcss.borderRadius(4),ed.rcss.flex.growAndShrink(1),ed.rcss.border({width:1,color:R.tokens.interactiveBorder}),{"> div":{alignItems:"start"},"> div > button":[ed.rcss.mt(4),ed.rcss.mr(4)]}],headerWrapper:[ed.rcss.width("100%"),ed.rcss.flex.growAndShrink(1)],headerInner:[ed.rcss.width("100%")],textWrapper:[ed.rcss.flex.wrap,ed.rcss.font.code,{lineHeight:R.tokens.lineHeightDefault}],actionsWrapper:[ed.rcss.height("100%")],terminalWrapper:[ed.rcss.width("100%"),{"> div":ed.rcss.borderRadius(0,0,4,4)}],warningIcon:[ed.rcss.mx(4)]});function tO(e){var n=e.command,r=e.eventId,i=e.sessionId,o=e.openPane,a=(0,c._)((0,p.useState)("proposed"!==n.state),2),d=a[0],h=a[1],g=tC(),m=g.spawnCommand,x=g.killProcessId,y=g.waitAndGetCommandOutput,b=tx({sessionId:i,eventIdWhichProposedShellExecution:r}),w=b.sendStartedShellExecutionMessage,k=b.sendFinishedShellExecutionMessage;(0,p.useEffect)(function(){"running"===n.state&&h(!0),"finished"===n.state&&0===n.commandOutput.length&&h(!1)},[n]);var _=(0,p.useCallback)(function(){return(0,s._)(function(){var e,t,r,i;return(0,f._)(this,function(o){switch(o.label){case 0:if(!m||!x||!y)return[2];if("running"!==n.state)return[3,2];return[4,x(n.processId)];case 1:case 6:return o.sent(),[2];case 2:return[4,m(n.command)];case 3:if(!(null==(e=o.sent())?void 0:e.ok))return[2];return[4,w({processId:t=e.payload,messageContentsOffset:n.messageContentsOffset})];case 4:if(!(null==(r=o.sent())?void 0:r.ok))return[2];return[4,y(t)];case 5:if(!(i=o.sent()))return[2];return[4,k((0,u._)((0,l._)({},i),{messageContentsOffset:n.messageContentsOffset}))]}})})()},[n,x,k,w,m,y]),S=(0,p.useCallback)(function(){o({type:"shell",data:{initialCmd:"".concat(n.command,"\n")}})},[n.command,o]);return(0,t.jsx)(tN,{command:n,isExpanded:d,toggleExpanded:function(){return h(function(e){return!e})},openPane:o,onRunInline:_,onRunInShell:S})}function tN(e){var n=e.command,r=e.isExpanded,i=e.toggleExpanded,o=e.openPane,a=e.onRunInline,s=e.onRunInShell,l=(0,t.jsx)(tR.default,{}),u="Run";return"running"===n.state&&(l=(0,t.jsx)(tP.default,{}),u="Stop"),"finished"===n.state&&(l=(0,t.jsx)(tI.default,{}),u="Run again"),(0,t.jsx)(ey.Surface,{elevated:!0,children:(0,t.jsx)(tT.AccordionItem,{css:tD.container,expanded:r,onClick:i,disabled:"proposed"===n.state,chevron:"start",toggleOn:"chevron",headerContent:(0,t.jsx)(A.View,{css:tD.headerWrapper,row:!0,children:(0,t.jsxs)(A.View,{row:!0,gap:8,align:"center",justify:"space-between",css:tD.headerInner,children:[(0,t.jsx)(A.View,{row:!0,gap:8,align:"center",css:tD.textWrapper,grow:!0,shrink:!0,children:n.command}),(0,t.jsx)(A.View,{align:"start",css:tD.actionsWrapper,grow:0,shrink:0,children:(0,t.jsxs)(A.View,{row:!0,gap:4,align:"center",children:[(0,t.jsx)(tE.IconButton,{size:24,alt:"Run in Shell",onClick:s,children:(0,t.jsx)(tA.default,{})}),(0,t.jsx)(eH.Button,{size:"small",colorway:"proposed"===n.state?"primary":void 0,text:u,iconLeft:l,onClick:a}),n.isDangerous?(0,t.jsx)(ef.Tooltip,{tooltip:"This command is potentially dangerous!",children:(0,t.jsx)(eT.default,{color:R.tokens.accentNegativeDefault,css:tD.warningIcon})}):null]})})]})}),children:(0,t.jsxs)(A.View,{css:tD.terminalWrapper,children:["running"===n.state?(0,t.jsx)(tp.default,{processId:n.processId,maxHeight:160,openPane:o,interactive:!0}):null,"finished"===n.state?(0,t.jsx)(tj.AutoGrowingTerminalForHistoricalOutput,{output:n.commandOutput,maxHeight:160,openPane:o}):null]})})})}e.s(["default",()=>tO],793384);var tM=e.i(753950),tL=e.i(463930);function tB(){var e=(0,o.default)().fs;return(0,p.useCallback)(function(t){var n=t.changes;return(0,s._)(function(){var t,r,i,o,a,s,l,u,c,d,p,h,g;return(0,f._)(this,function(f){switch(f.label){case 0:t=new Map,r=!0,i=!1,o=void 0,f.label=1;case 1:f.trys.push([1,6,7,8]),a=n[Symbol.iterator](),f.label=2;case 2:if(r=(s=a.next()).done)return[3,5];if((l=s.value).state!==eM.FileChangeGenerationState.GENERATION_COMPLETE)return[3,4];return u=[""],[4,e.readFile(l.filePath)];case 3:(c=f.sent()).error||(u=c.content.toString().split("\n")),d=tM.Text.of(u),p=tM.Text.of(l.content.split("\n")),h=tL.Diff.create(d,p),t.set(l.filePath,h.getLineStats()),f.label=4;case 4:return r=!0,[3,2];case 5:return[3,8];case 6:return g=f.sent(),i=!0,o=g,[3,8];case 7:try{r||null==a.return||a.return()}finally{if(i)throw o}return[7];case 8:return[2,t]}})})()},[e])}e.s(["useGetProposedFileChangesLineStats",()=>tB],751690);var tV=e.i(992785),tF=e.i(965863);function tU(e){var t=e.changeStatus,n=e.removePane,r=(0,tF.useOpenPanes)(),i=(0,c._)((0,p.useState)(null),2),o=i[0],a=i[1],s=(0,p.useRef)(t);return(0,p.useEffect)(function(){if("applied"!==s.current.state&&"applied"===t.state&&null!=o){var e,i=null==(e=r.find(function(e){var t=(0,c._)(e,2),n=(t[0],t[1]);return"diff"===n.type&&(0,tV.default)(n.data,o)}))?void 0:e[0];i&&(n(i),a(null))}s.current=t},[t,o,r,n]),{onOpenTemporaryDiffPane:a}}e.s(["default",()=>tU],58075)},210943,17322,231008,725371,845874,263286,e=>{"use strict";var t,n=e.i(276385),r=e.i(389959),i=e.i(188507),o=e.i(297083),a=e.i(878420),s=e.i(64386),l=e.i(530658),u=e.i(346715),c=e.i(817556),d=e.i(986194),f=e.i(502305),p=e.i(546284),h=e.i(318037),g=e.i(15862),m=e.i(793384),x=e.i(751690),y=e.i(58075),b=e.i(150316),w=e.i(47503),k=e.i(982829),_=e.i(729122);function S(){var e=(0,w.useCurrentUserId)(),t=(0,_.useWorkflows)(),n=(0,_.useAddWorkflow)(),i=(0,_.useUpdateWorkflow)(),a=(0,_.useSetRunButton)();return(0,r.useCallback)(function(r){return(0,o._)(function(){var o,s,l,u,d;return(0,c._)(this,function(c){if(!e)return[2];if(o=t.findIndex(function(e){return e.name===r.workflowName}),s=r.commands.map(function(e){return{task:"shell.exec",args:e}}),l="sequential"===r.mode?"sequential":"parallel",o>=0){if("agent"===(d=t[o]).author||(null==(u=d.metadata)?void 0:u.generated))return[2];i(o,function(e){var n=t[o].tasks;e.tasks=(0,k.mergeProposedTasks)(n,s)},{persist:!0})}else n({name:r.workflowName,author:e,tasks:s,mode:l});return r.setRunButton&&a(r.workflowName),[2]})})()},[e,t,i,n,a])}var C=e.i(480170),j=e.i(480028),T=e.i(446530),E=e.i(613355),R=e.i(140487),I=e.i(136540),A=e.i(929872),P=e.i(960178),D=e.i(625484),O=e.i(616278),N=e.i(978669),M=e.i(357399),L=(0,T.cssRecord)({container:[E.rcss.borderRadius(4),E.rcss.flex.growAndShrink(1),E.rcss.border({width:1,color:j.tokens.interactiveBorder})],infoWrapper:[E.rcss.flex.wrap],inlineRunButton:[E.rcss.display.inlineFlex,E.rcss.backgroundColor.greyDimmest,E.rcss.color.greyStrongest,E.rcss.align.center,E.rcss.borderRadius(8),E.rcss.py(2),E.rcss.px(6),E.rcss.mx(2)]});function B(e){var t=e.text;return(0,n.jsxs)(D.View,{css:L.inlineRunButton,row:!0,gap:6,children:[(0,n.jsx)(N.default,{size:12}),(0,n.jsx)(P.Text,{children:t})]})}function V(e){var t,i=e.workflowConfiguration,o=e.eventId,a=e.sessionId,s=e.openPane,l=(0,r.useCallback)(function(){s({type:"workflows"})},[s]),u=S(),c=(0,C.useSendAssistantApplyWorkflowConfigurationMessage)({sessionId:a,eventIdWhichProposedWorkflowConfiguration:o}),d=(0,r.useCallback)(function(){u(i),c({messageContentsOffset:i.messageContentsOffset})},[u,c,i]);return(0,n.jsxs)(A.Surface,{elevated:!0,css:L.container,p:8,children:[(0,n.jsxs)(D.View,{row:!0,align:"start",justify:"space-between",children:[(0,n.jsxs)(D.View,{row:!0,align:"center",gap:8,css:L.infoWrapper,grow:!0,shrink:!0,children:["Set",(0,n.jsx)(B,{text:i.workflowName}),"to run"]}),(0,n.jsxs)(D.View,{row:!0,gap:4,align:"center",grow:0,shrink:0,children:[(0,n.jsx)(I.IconButton,{size:24,alt:"Open Workflows",onClick:l,children:(0,n.jsx)(M.default,{})}),(0,n.jsx)(R.Button,{size:"small",colorway:"proposed"===i.state?"primary":void 0,onClick:d,text:"proposed"===i.state?"Apply":"Applied",disabled:"proposed"!==i.state,iconLeft:(0,n.jsx)(O.default,{})})]})]}),(0,n.jsx)(b.WorkflowTasks,{workflow:(t=i.commands.map(function(e){return{task:"shell.exec",args:e}}),{name:i.workflowName,tasks:t,mode:i.mode}),readOnlyMode:!0,simplified:!0})]})}e.i(282890);var F=e.i(827456),U=e.i(754873),G=e.i(264661),$=(0,T.cssRecord)({container:[E.rcss.borderRadius(4),E.rcss.flex.growAndShrink(1),E.rcss.rowWithGap(8),U.interactive.filledAndOutlined],iconCol:[E.rcss.py(4)]});function z(e){var t=e.toolName,r=e.openPane,i=(0,F.usePaneUIContext)();return H.includes(t)?(0,n.jsxs)(A.Surface,{css:$.container,px:8,py:4,onClick:function(){return r({type:t})},children:[(0,n.jsx)(D.View,{css:$.iconCol,children:i.Icon({pane:{type:t},size:16})}),(0,n.jsxs)(D.View,{grow:!0,shrink:!0,justify:"center",children:[(0,n.jsx)(P.Text,{color:"default",children:i.getTitle({type:t})}),(0,n.jsx)(P.Text,{color:"dimmer",variant:"small",children:i.getDescription({type:t})})]}),(0,n.jsx)(D.View,{css:$.iconCol,children:(0,n.jsx)(G.default,{})})]}):null}var H=["agentChat","deployments","envEditor"],W=e.i(462995),q=e.i(927158);function K(){return(0,q.usePid2Callback)(function(e){return function(t){var n=t.buildCommand,r=t.runCommand;return(0,o._)(function(){return(0,c._)(this,function(t){return[2,e.agentToolDeployConfig.update.rpc({build:n?["sh","-c",n]:void 0,run:["sh","-c",r]})]})})()}},[])}var Y=e.i(624782),Q=e.i(503536),X=(0,T.cssRecord)({container:[E.rcss.borderRadius(4),E.rcss.flex.growAndShrink(1),E.rcss.border({width:1,color:j.tokens.interactiveBorder})],runCommandPill:[E.rcss.font.code,E.rcss.flex.growAndShrink(0)],infoWrapper:[E.rcss.flex.wrap,E.rcss.height("100%")]});function J(e){var t=e.deploymentConfiguration,i=e.eventId,a=e.sessionId,s=e.openPane,l=(0,r.useCallback)(function(){s({type:"deployments"})},[s]),u=K(),d=(0,C.useSendAssistantApplyDeploymentConfigurationMessage)({sessionId:a,eventIdWhichProposedDeploymentConfiguration:i}),f=(0,r.useCallback)(function(){return(0,o._)(function(){return(0,c._)(this,function(e){switch(e.label){case 0:if(!u)return[2];return[4,u({buildCommand:t.buildCommand,runCommand:t.runCommand})];case 1:if(!e.sent().ok)return[2];return[4,d({messageContentsOffset:t.messageContentsOffset})];case 2:return e.sent(),[2]}})})()},[u,t.buildCommand,t.messageContentsOffset,t.runCommand,d]),p=t.buildCommand.length>0,h="Set deployment run command to ";return p&&(h=" and run command to "),(0,n.jsx)(A.Surface,{elevated:!0,css:X.container,p:8,children:(0,n.jsxs)(D.View,{row:!0,align:"start",justify:"space-between",children:[(0,n.jsxs)(D.View,{row:!0,align:"center",gap:8,css:X.infoWrapper,grow:!0,shrink:!0,children:[p?(0,n.jsxs)(n.Fragment,{children:["Set deployment build command to"," ",(0,n.jsx)(Y.Pill,{text:t.buildCommand,css:X.runCommandPill})]}):null,h,(0,n.jsx)(Y.Pill,{text:t.runCommand,css:X.runCommandPill})]}),(0,n.jsxs)(D.View,{row:!0,gap:4,align:"center",grow:0,shrink:0,children:[(0,n.jsx)(I.IconButton,{size:24,alt:"Open Published Apps",onClick:l,children:(0,n.jsx)(Q.default,{})}),(0,n.jsx)(R.Button,{size:"small",onClick:f,text:"proposed"===t.state?"Apply":"Applied",disabled:"proposed"!==t.state,colorway:"proposed"===t.state?"primary":void 0,iconLeft:(0,n.jsx)(O.default,{})})]})]})})}var Z=e.i(529810),ee=e.i(974770),et=e.i(937500),en=e.i(394212);function er(){return{spawnInstall:(0,q.usePid2Callback)(function(e){return function(t){var n=t.language,r=t.packageList;return(0,o._)(function(){var t;return(0,c._)(this,function(i){switch(i.label){case 0:return[4,e.agentToolPackager.spawnInstallPackages.rpc({language:n,pkgs:r})];case 1:if(!(t=i.sent()).ok)return[2,t];return[2,{ok:!0,payload:t.payload.id}]}})})()}},[]),waitAndGetSpawnedInstallPackagesResult:(0,q.usePid2Callback)(function(e){return function(t){return(0,o._)(function(){var n,r,i,o,a,s,l,u,d,f;return(0,c._)(this,function(c){switch(c.label){case 0:n=e.agentToolPackager.waitAndGetSpawnedInstallPackagesResult.subscribe({processId:t}).resReadable,r=et.Buffer.alloc(0),i=!1,o=!1,c.label=1;case 1:c.trys.push([1,6,7,12]),s=(0,en._)(n),c.label=2;case 2:return[4,s.next()];case 3:if(!(i=!(l=c.sent()).done))return[3,5];if((u=l.value).ok&&"output"===u.payload.$kind&&(r=et.Buffer.concat([r,u.payload.output])),u.ok&&"finished"===u.payload.$kind)return d=u.payload.exitCode,[2,{installationOutput:r.toString(),exitCode:d}];c.label=4;case 4:return i=!1,[3,2];case 5:return[3,12];case 6:return f=c.sent(),o=!0,a=f,[3,12];case 7:if(c.trys.push([7,,10,11]),!(i&&null!=s.return))return[3,9];return[4,s.return()];case 8:c.sent(),c.label=9;case 9:return[3,11];case 10:if(o)throw a;return[7];case 11:return[7];case 12:return[2]}})})()}})}}var ei=e.i(762211),eo=e.i(965153),ea=e.i(982204),es=e.i(940745),el=e.i(634669);function eu(e){var t,i=e.eventId,a=e.packageInstall,s=e.sessionId,u=e.openPane,d=(t=(0,Z.default)().git,(0,r.useCallback)(function(e){return(0,o._)(function(){var n,r;return(0,c._)(this,function(i){switch(i.label){case 0:return[4,t.status()];case 1:if((n=i.sent()).error)return[2,n];if(0===(r=null!=e?e:n.changes.map(function(e){return e.path})).length)return[2];return[2,t.stageFiles({add:r})]}})})()},[t])),f=(0,l._)((0,r.useState)("installed"===a.state&&0!==a.exitCode),2),p=f[0],h=f[1];(0,r.useEffect)(function(){"installing"===a.state&&h(!0),"installed"===a.state&&0===a.exitCode&&h(!1)},[a]);var g=er(),m=g.spawnInstall,x=g.waitAndGetSpawnedInstallPackagesResult,y=(0,C.useSendAssistantPackagerMessages)({sessionId:s,eventIdWhichProposedPackageInstall:i}),b=y.sendInstallingPackagesMessage,w=y.sendInstalledPackagesMessage,k=(0,r.useCallback)(function(){return(0,o._)(function(){var e,t,n;return(0,c._)(this,function(r){switch(r.label){case 0:if(!m||!x)return[2];return h(!0),[4,null==m?void 0:m({language:a.language,packageList:a.packageList})];case 1:if(!(null==(e=r.sent())?void 0:e.ok))return[2];return[4,b({processId:t=e.payload,messageContentsOffset:a.messageContentsOffset})];case 2:return r.sent(),[4,x(t)];case 3:if(!(n=r.sent()))return[2];return 0===n.exitCode&&h(!1),[4,w({installationOutput:n.installationOutput,exitCode:n.exitCode,processId:t,messageContentsOffset:a.messageContentsOffset})];case 4:return r.sent(),[4,d()];case 5:return r.sent(),[2]}})})()},[m,x,a,b,w,d]);return(0,n.jsx)(ed,{packageInstall:a,isExpanded:p,toggleExpanded:function(){return h(function(e){return!e})},openPane:u,onInstallClick:k})}var ec=(0,T.cssRecord)({container:[E.rcss.borderRadius(4),E.rcss.flex.growAndShrink(1),E.rcss.border({width:1,color:j.tokens.interactiveBorder}),{"> div":{alignItems:"start"},"> div > button":[E.rcss.mt(4),E.rcss.mr(4)]}],headerWrapper:[E.rcss.width("100%"),E.rcss.flex.growAndShrink(1)],headerInner:[E.rcss.mb(2)],packagesWrapper:[E.rcss.width("100%"),E.rcss.py(4),{display:"flex",flexDirection:"row",flexWrap:"wrap",gap:j.tokens.space8}],package:[E.rcss.borderRadius(4),E.rcss.px(8),E.rcss.py(4),E.rcss.width("calc(50% - ".concat(j.tokens.space4,")")),E.rcss.backgroundColor.backgroundHighest],terminalWrapper:[E.rcss.width("100%"),{"> div":E.rcss.borderRadius(0,0,4,4)}]});function ed(e){var t=e.packageInstall,i=e.isExpanded,o=e.toggleExpanded,a=e.openPane,s=e.onInstallClick,l=(0,r.useCallback)(function(){a({type:"developer",data:{tab:["dependencies","import"]}})},[a]),u="Install",c=(0,n.jsx)(el.default,{}),d=!1;return"installing"===t.state&&(u="Installing...",c=(0,n.jsx)(es.default,{}),d=!0),"installed"===t.state&&(u="Installed",c=(0,n.jsx)(O.default,{}),d=!0),(0,n.jsx)(A.Surface,{elevated:!0,children:(0,n.jsx)(eo.AccordionItem,{css:ec.container,expanded:i,onClick:o,disabled:"proposed"===t.state,chevron:"start",toggleOn:"chevron",headerContent:(0,n.jsxs)(D.View,{css:ec.headerWrapper,children:[(0,n.jsxs)(D.View,{row:!0,gap:8,align:"center",justify:"space-between",css:ec.headerInner,children:[(0,n.jsx)(P.Text,{variant:"text",color:"default",children:"Dependencies"}),(0,n.jsxs)(D.View,{row:!0,gap:4,align:"center",children:[(0,n.jsx)(I.IconButton,{size:24,alt:"Open Dependencies",onClick:l,children:(0,n.jsx)(ea.default,{})}),(0,n.jsx)(R.Button,{text:u,iconLeft:c,disabled:d,size:"small",colorway:"proposed"===t.state?"primary":void 0,onClick:s})]})]}),(0,n.jsx)(D.View,{css:ec.packagesWrapper,children:t.packageList.map(function(e,t){return(0,n.jsx)(A.Surface,{css:ec.package,row:!0,gap:8,align:"center",justify:"space-between",children:(0,n.jsxs)(D.View,{row:!0,gap:4,align:"center",children:[(0,n.jsx)(el.default,{}),(0,n.jsx)(P.Text,{children:e})]})},t+"-"+e)})})]}),children:(0,n.jsxs)(D.View,{css:ec.terminalWrapper,children:["installing"===t.state?(0,n.jsx)(ee.default,{processId:t.processId,openPane:a,maxHeight:160}):null,"installed"===t.state?(0,n.jsx)(ei.AutoGrowingTerminalForHistoricalOutput,{output:t.installationOutput,maxHeight:160,openPane:a}):null]})})})}function ef(){var e=(0,w.useCurrentUserId)(),t=(0,_.useWorkflows)(),n=(0,_.useAddWorkflow)(),i=(0,_.useUpdateWorkflow)(),l=(0,_.useSetRunButton)();return(0,r.useCallback)(function(r){return(0,o._)(function(){var o;return(0,c._)(this,function(c){return e&&((o=t.findIndex(function(e){return e.name===r.workflowName}))>=0?i(o,function(e){var t="agent"===e.author,n=e.tasks.find(function(e){return"shell.exec"===e.task&&e.args===r.oldCommand});if(n)n.args=r.newCommand;else{if(t){var i=e.tasks.find(function(e){return"shell.exec"===e.task}),o=e.tasks.filter(function(e){return"shell.exec"!==e.task});e.tasks=(0,u._)(o).concat([(0,s._)((0,a._)({},i),{task:"shell.exec",args:r.newCommand})]);return}e.tasks=[{task:"shell.exec",args:r.newCommand}]}},{persist:!0}):n({name:r.workflowName,author:e,tasks:[{task:"shell.exec",args:r.newCommand}]}),r.setRunButton&&l(r.workflowName)),[2]})})()},[e,t,i,n,l])}var ep=(0,T.cssRecord)({container:[E.rcss.borderRadius(4),E.rcss.flex.growAndShrink(1),E.rcss.border({width:1,color:j.tokens.interactiveBorder})],infoWrapper:[E.rcss.flex.wrap],runCommandPill:[E.rcss.font.code,E.rcss.flex.growAndShrink(0)],inlineRunButton:[E.rcss.display.inlineFlex,E.rcss.backgroundColor.greyDimmest,E.rcss.color.greyStrongest,E.rcss.align.center,E.rcss.borderRadius(8),E.rcss.py(2),E.rcss.px(6),E.rcss.mx(2)]});function eh(e){var t=e.text;return(0,n.jsxs)(D.View,{css:ep.inlineRunButton,row:!0,gap:6,children:[(0,n.jsx)(N.default,{size:12}),(0,n.jsx)(P.Text,{children:t})]})}function eg(e){var t=e.runConfiguration,i=e.eventId,o=e.sessionId,a=e.openPane,s=(0,r.useCallback)(function(){a({type:"workflows"})},[a]),l=ef(),u=(0,C.useSendAssistantApplyRunConfigurationMessage)({sessionId:o,eventIdWhichProposedRunConfiguration:i}),c=(0,r.useCallback)(function(){l(t),u({messageContentsOffset:t.messageContentsOffset})},[l,u,t]);return(0,n.jsx)(A.Surface,{elevated:!0,css:ep.container,p:8,children:(0,n.jsxs)(D.View,{row:!0,align:"start",justify:"space-between",children:[(0,n.jsxs)(D.View,{row:!0,align:"center",gap:8,css:ep.infoWrapper,grow:!0,shrink:!0,children:["Set",(0,n.jsx)(eh,{text:t.workflowName}),"to",(0,n.jsx)(Y.Pill,{text:t.newCommand,css:ep.runCommandPill})]}),(0,n.jsxs)(D.View,{row:!0,gap:4,align:"center",grow:0,shrink:0,children:[(0,n.jsx)(I.IconButton,{size:24,alt:"Open Workflows",onClick:s,children:(0,n.jsx)(M.default,{})}),(0,n.jsx)(R.Button,{size:"small",colorway:"proposed"===t.state?"primary":void 0,onClick:c,text:"proposed"===t.state?"Apply":"Applied",disabled:"proposed"!==t.state,iconLeft:(0,n.jsx)(O.default,{})})]})]})})}var em=e.i(877212),ev=e.i(924908);e.i(925218);var ex=e.i(641555);function ey(e){var t=e.sessionId,n=e.eventIdWhichProposedChanges,i=(0,ev.useChatter)(),o=(0,ex.useObservableMemo)(function(){return t?i.sessions.get(t):void 0},[t,i]),a=(0,ex.useObservableMemo)(function(){return null==o?void 0:o.reduce(eb,1e3)},[o]);return(0,r.useMemo)(function(){var e=null==a?void 0:a[n];return null!=e?e:{state:"pending"}},[a,n])}var eb={direction:"reverse",state:{},reducer:function(e,t){if((null==(n=e.contents.contents)?void 0:n.$kind)==="iterativeAgentEventContents"){var n,r=e.contents.contents.iterativeAgentEventContents.contents;if((null==r?void 0:r.$kind)==="appliedFileChanges"){var i=r.appliedFileChanges.eventWhichProposedChanges;if(t[i])return;t[i]={state:"applied",appliedChanges:r.appliedFileChanges.appliedChanges,commitHash:r.appliedFileChanges.commitHash};return}if((null==r?void 0:r.$kind)==="revertedFileChanges"){var o=r.revertedFileChanges.eventWhichProposedChanges;if(t[o])return;t[o]={state:"reverted",revertedChanges:r.revertedFileChanges.revertedChanges};return}}}};e.s(["useProposedChangesStatus",()=>ey],17322);var ew=e.i(630818),ek=e.i(761922);let e_=(0,r.memo)(function(e){var t=e.text,i=e.ragSources,a=e.proposedActions,s=e.eventId,f=e.eventState,p=e.markdownCodeComponent,g=e.markdownLinkComponent,y=e.sessionId,b=e.openPane,w=e.removePane,k=[];null!=i&&k.push((0,n.jsx)(eC,{eventState:f,ragSources:i,openPane:b},"rag-sources"));var _=null!=a?a:{sortedActions:[],commitId:"",fileChanges:[]},S=_.sortedActions,C=_.commitId,j=_.fileChanges,T=(0,x.useGetProposedFileChangesLineStats)(),E=(0,l._)((0,r.useState)(function(){return new Map}),2),R=E[0],I=E[1];(0,r.useEffect)(function(){(0,o._)(function(){return(0,c._)(this,function(e){switch(e.label){case 0:return[4,T({changes:j})];case 1:return I(e.sent()),[2]}})})()},[j,T]);var A=S.reduce(function(e,r){var i=(0,d.unkind)(r).messageContentsOffset;if(null==i||!y)return e;var o=(0,u._)(e.parts);if(o.push((0,n.jsx)(W.MessageMarkdown,{text:t.slice(e.chars,i),codeComponent:p,linkComponent:g,messageState:f},"text-slice-".concat(e.chars,"-to-").concat(i))),(0,d.isKind)(r,"fileChange")){var a=(0,d.unkind)(r);o.push((0,n.jsx)(ej,{change:a,commitId:C,lineStats:R.get(a.filePath),sessionId:y,eventId:s,openPane:b,removePane:w},a.filePath))}else if((0,d.isKind)(r,"shellCommand")){var l=(0,d.unkind)(r);o.push((0,n.jsx)(m.default,{command:l,openPane:b,eventId:s,sessionId:y},l.command))}else if((0,d.isKind)(r,"packageInstall"))o.push((0,n.jsx)(eu,{eventId:s,sessionId:y,packageInstall:r.packageInstall,openPane:b},r.packageInstall.language+"---"+r.packageInstall.packageList.join("-")));else if((0,d.isKind)(r,"workspaceToolNudge")){var c=(0,d.unkind)(r);"deployments"===c.toolName?o.push((0,n.jsx)(h.SuggestDeployCard,{openDeploymentsPane:function(){return b({type:"deployments"})},paneType:"ghostwriterChat"},c.toolName)):o.push((0,n.jsx)(eT,{nudge:c,openPane:b},c.toolName))}else(0,d.isKind)(r,"runConfiguration")?o.push((0,n.jsx)(eg,{runConfiguration:r.runConfiguration,openPane:b,eventId:s,sessionId:y},r.runConfiguration.workflowName+"---"+r.runConfiguration.oldCommand+"---"+r.runConfiguration.newCommand)):(0,d.isKind)(r,"deploymentConfiguration")?o.push((0,n.jsx)(J,{deploymentConfiguration:r.deploymentConfiguration,openPane:b,eventId:s,sessionId:y},r.deploymentConfiguration.buildCommand+"---"+r.deploymentConfiguration.runCommand)):(0,d.isKind)(r,"workflowConfiguration")&&o.push((0,n.jsx)(V,{workflowConfiguration:r.workflowConfiguration,openPane:b,eventId:s,sessionId:y},r.workflowConfiguration.workflowName+"---"+r.workflowConfiguration.commands.join("&&")));return{chars:i,parts:o}},{chars:0,parts:k}),P=A.chars,D=A.parts,O=t.slice(P).trim();O.length>0&&D.push((0,n.jsx)(W.MessageMarkdown,{text:O,codeComponent:p,linkComponent:g,messageState:f},"remaining-text"));var N=S.filter(function(e){return null==(0,d.unkind)(e).messageContentsOffset}),M=!0,L=!1,B=void 0;try{for(var F,U=N[Symbol.iterator]();!(M=(F=U.next()).done);M=!0){var G=F.value;if((0,d.isKind)(G,"fileChange")){var $=(0,d.unkind)(G);D.push((0,n.jsx)(ej,{change:$,commitId:C,lineStats:R.get($.filePath),sessionId:y,eventId:s,openPane:b,removePane:w},$.filePath))}}}catch(e){L=!0,B=e}finally{try{M||null==U.return||U.return()}finally{if(L)throw B}}return(0,n.jsx)(n.Fragment,{children:D})});var eS=(0,T.cssRecord)({container:[E.rcss.borderRadius()],accordionItem:[E.rcss.flex.growAndShrink(1)],list:[E.rcss.display.flex,E.rcss.colWithGap(2),E.rcss.p(4),E.rcss.border({color:j.tokens.outlineDefault}),E.rcss.borderRadius()],listItem:[E.rcss.cursor.pointer,U.interactive.listItem,E.rcss.p(4),E.rcss.borderRadius(4)],header:[E.rcss.color.foregroundDimmer]});function eC(e){var t=e.eventState,r=e.ragSources,o=e.openPane;if(0===r.length)return null;var a=(0,p.default)("file",r.length);return(0,n.jsx)(A.Surface,{css:eS.container,row:!0,children:(0,n.jsx)(eo.AccordionItem,{css:eS.accordionItem,headerContent:(0,n.jsxs)(D.View,{row:!0,gap:6,align:"center",css:eS.header,children:[(0,n.jsx)(ek.default,{}),(0,n.jsx)(P.Text,{children:t===i.EventState.IN_PROGRESS?"Reading ".concat(r.length," ").concat(a,""):"Read ".concat(r.length," ").concat(a)})]}),children:(0,n.jsx)("ul",{"aria-label":"RAG sources",css:eS.list,children:r.map(function(e){var t=(0,f.trimFileUrlPrefix)(e.url);return(0,n.jsx)("li",{children:(0,n.jsxs)(D.View,{css:eS.listItem,row:!0,gap:4,onClick:function(){return o({type:"codeEditor",data:{path:t}})},children:[(0,n.jsx)(ew.default,{path:t,size:16}),(0,n.jsx)(P.Text,{variant:"small",children:t})]})},e.url)})})})})}function ej(e){var t=e.change,i=e.commitId,o=e.lineStats,l=e.sessionId,u=e.eventId,c=e.openPane,d=e.removePane,f=ey({sessionId:l,eventIdWhichProposedChanges:u}),p=(0,y.default)({changeStatus:f,removePane:d}).onOpenTemporaryDiffPane,h=(0,r.useCallback)(function(e,t){var n={type:"diff",data:{left:{path:e,data:{type:"git",revision:i}},right:{path:e,data:t}}};c(n),p(n.data)},[c,i,p]);if(!t)return null;if("applied"===f.state){var m=f.appliedChanges,x=f.commitHash,b=m.find(function(e){return e.filePath===t.filePath});return b?(0,n.jsx)(g.AppliedFileChangeCard,(0,a._)({commitHash:x,onOpenDiff:h},b)):null}return(0,n.jsx)(g.ProposedFileChangeCard,(0,s._)((0,a._)({},t),{changeStatus:f,lineStats:o,onOpenDiff:h}))}function eT(e){var t=e.nudge,r=e.openPane;return(0,n.jsx)(z,(0,s._)((0,a._)({},t),{openPane:r}))}var eE=(0,r.memo)(function(e){var t=e.eventId,r=e.eventState,o=e.content,a=e.intent,s=e.ragSources,l=e.proposedActions,u=e.sessionId,c=e.openPane,d=e.removePane,f=e.markdownCodeComponent,p=e.markdownLinkComponent;return o||r===i.EventState.COMPLETE?a===i.MessageAction.ITERATIVE_AGENT?(0,n.jsx)(e_,{text:o,eventId:t,eventState:r,ragSources:s,proposedActions:l,markdownCodeComponent:f,markdownLinkComponent:p,sessionId:u,openPane:c,removePane:d}):(0,n.jsx)(W.MessageMarkdown,{text:o,codeComponent:f,linkComponent:p,messageState:r}):(0,n.jsx)(es.default,{})});e.s(["AiMessageContents",()=>eE],210943);var eR=e.i(886513),eI=e.i(629536),eA=e.i(845822),eP=e.i(61524),eD=e.i(952521),eO=e.i(417120);function eN(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.commit,n=void 0===t||t,i=(0,Z.default)().git,a=(0,l._)((0,r.useState)(!1),2),s=a[0],u=a[1],d=(0,l._)((0,r.useState)(null),2),f=d[0],p=d[1];return(0,r.useEffect)(function(){(0,o._)(function(){var e;return(0,c._)(this,function(t){switch(t.label){case 0:return[4,i.isInitialized()];case 1:if(null!=(e=t.sent()).error)return p(e.error),[2];if(u(e.initialized),!e.initialized)return[3,7];if(!n)return[3,6];t.label=2;case 2:return t.trys.push([2,4,,6]),[4,i.getCommit({commit:"HEAD"})];case 3:case 5:return t.sent(),[3,6];case 4:return t.sent(),[4,i.commit({message:"Initial commit"})];case 6:return u(!0),[3,9];case 7:return[4,i.init({initialCommit:n})];case 8:t.sent(),u(!0),t.label=9;case 9:return[2]}})})()},[i,n]),{isGitInitialized:s,gitError:f}}e.s(["default",()=>eN],231008);var eM=e.i(649960),eL=e.i(201567),eB=e.i(11235),eV=e.i(396776),eF=e.i(363201),eU=(0,T.cssRecord)({root:[E.rcss.width("100%")],banner:[E.rcss.width("100%")],li:[{listStyle:"none"}]});function eG(e){var t=e.changedPaths,i=e.openPane,o=(0,l._)((0,r.useState)(100),2),a=o[0],s=o[1],u=(0,eM.default)(function(e){s(e.width/10)});return(0,n.jsx)(D.View,{innerRef:u,css:eU.root,children:(0,n.jsx)(eV.StatusBanner,{css:eU.banner,icon:(0,n.jsx)(eF.default,{}),colorway:"yellow",text:(0,n.jsxs)(eB.Prose,{variant:"small",children:[eI.ASSISTANT_NAME," has detected other changes to these files since this code was generated:",(0,n.jsx)("ul",{style:{margin:0},children:t.map(function(e){return(0,n.jsx)("li",{css:eU.li,children:(0,n.jsx)(R.Button,{variant:"underlined",size:"small",iconLeft:(0,n.jsx)(ew.default,{path:e,size:16}),text:(0,eL.truncateFilePath)(e,{truncateFrom:"start",maxLength:a}),onClick:function(){return i({type:"codeEditor",data:{path:e}})}})},e)})}),"You can retry this ",eA.ASSISTANT_USAGE_UNIT," or overwrite those changes and apply ",eI.ASSISTANT_NAME," edits anyway."]})})})}var e$=e.i(569910),ez=e.i(131141);e.i(694906);var eH=e.i(515672),eW=e.i(112077),eq=e.i(267103),eK=e.i(19004),eY=e.i(98816),eQ=e.i(718402);function eX(e){var t,n,i,f,p,h,g=e.sessionId,m=e.eventId,y=e.sortedActions,b=e.changesSummary,w=e.handleAutoRestart,k=e.doAutoApplyChanges,_=(n=(t={sessionId:g,eventId:m,prevUserMessageContent:e.prevUserMessageContent}).sessionId,i=t.eventId,f=t.prevUserMessageContent,p=(0,Z.default)().git,(0,r.useCallback)(function(e){var t=e.changes,r=e.summary;return(0,o._)(function(){var e,o,a,s,l,d,h,g,m,x,y,b;return(0,c._)(this,function(c){switch(c.label){case 0:return p.forceRefresh(),[4,p.status()];case 1:if((e=c.sent()).error)return[2,e];if(0===e.changes.length||(o="Assistant checkpoint",0===t.length))return[2,{error:eI.AssistantErrors.NOTHING_TO_COMMIT}];r&&(o+=": ".concat(r)),o+="\n\nAssistant generated file changes:\n",a=!0,s=!1,l=void 0;try{for(d=t[Symbol.iterator]();!(a=(h=d.next()).done);a=!0)g=h.value,o+="- ".concat(g.filePath,": ").concat(g.changeSummary,"\n")}catch(e){s=!0,l=e}finally{try{a||null==d.return||d.return()}finally{if(s)throw l}}return f&&(o+="\n---\n\nUser prompt:\n\n".concat(f)),m=e.changes.filter(function(e){return!e.staged}).filter(function(e){return eH.packagerFiles.includes(e.path)}).map(function(e){return e.path}),x=e.changes.filter(function(e){return e.staged}).map(function(e){return e.path}),y=t.map(function(e){return e.filePath}),b=new Set((0,u._)(m).concat((0,u._)(x),(0,u._)(y))),[4,p.stageFiles({add:Array.from(b)})];case 2:return c.sent(),[2,p.commit({message:o,trailers:{"Replit-Commit-Author":"Assistant","Replit-Commit-Session-Id":n,"Replit-Commit-Event-Id":i}})]}})})()},[i,p,f,n])),j=(0,eW.useCreateObservable)(void 0);(0,r.useEffect)(function(){var e=function(e){return"workspaceToolNudge"===e.$kind?{action:e,state:"skipped",checked:!1}:"shellCommand"===e.$kind&&e.shellCommand.isDangerous?{action:e,state:"preparing",checked:!1}:{action:e,state:"preparing",checked:!0}};j.update((0,ez.produce)(function(t){if(!t)return y.map(e);for(var n=0;n<y.length;n++)t[n]?t[n].action=y[n]:t.push(e(y[n]))}))},[j,y]);var T=(0,l._)((0,r.useState)({state:"idle"}),2),E=T[0],R=T[1],I=(0,eY.default)(E),A=(0,r.useRef)(!1),P=(0,C.useSendAssistantAppliedFileChangesMessage)({sessionId:g,eventIdWhichProposedChanges:m}),D=(0,x.useGetProposedFileChangesLineStats)(),O=(0,eQ.default)(),N=O.spawnCommand,M=O.waitAndGetCommandOutput,L=(0,C.useSendAssistantShellExecutionMessages)({sessionId:g,eventIdWhichProposedShellExecution:m}),B=L.sendStartedShellExecutionMessage,V=L.sendFinishedShellExecutionMessage,F=er(),U=F.spawnInstall,G=F.waitAndGetSpawnedInstallPackagesResult,$=(0,C.useSendAssistantPackagerMessages)({sessionId:g,eventIdWhichProposedPackageInstall:m}),z=$.sendInstallingPackagesMessage,H=$.sendInstalledPackagesMessage,W=ef(),q=(0,C.useSendAssistantApplyRunConfigurationMessage)({sessionId:g,eventIdWhichProposedRunConfiguration:m}),Y=S(),Q=(0,C.useSendAssistantApplyWorkflowConfigurationMessage)({sessionId:g,eventIdWhichProposedWorkflowConfiguration:m}),X=K(),J=(0,C.useSendAssistantApplyDeploymentConfigurationMessage)({sessionId:g,eventIdWhichProposedDeploymentConfiguration:m}),ee=(h=(0,Z.default)().fs,(0,r.useCallback)(function(e){var t=e.change;return(0,o._)(function(){var e;return(0,c._)(this,function(n){switch(n.label){case 0:return[4,h.writeFile(t.filePath,t.content)];case 1:if(null!==(e=n.sent()).error)return[2,{error:e.error}];return[2,{}]}})})()},[h])),et=(0,r.useMemo)(function(){return N&&M&&U&&G&&X},[X,N,U,M,G]),ei=(0,r.useCallback)(function(){return(0,o._)(function(){var e,t,n,r,i,o,l,u,f,p,h,g,m,x,y,k,S,C,T,E,O,L,F,$,K,Z,er,ei,eo,ea,es,el,eu,ec,ed,ef,ep,eh;return(0,c._)(this,function(c){switch(c.label){case 0:if(!j.current||"idle"!==I.current.state||!et)return[2];return R({state:"working"}),[4,D({changes:e=j.current.map(function(e){return(0,d.isKind)(e.action,"fileChange")?(0,d.unkind)(e.action):null}).filter(function(e){return null!==e})})];case 1:t=c.sent(),n=new Set,r=!1,j.update((0,ez.produce)(function(e){null==e||e.forEach(function(e){e.state="preparing"===e.state&&e.checked?"scheduled":"skipped"})})),i=-1,o=!1,l=!1,c.label=2;case 2:c.trys.push([2,30,31,36]),f=(0,en._)(j.current),c.label=3;case 3:return[4,f.next()];case 4:if(!(o=!(p=c.sent()).done))return[3,29];if(h=p.value,i++,"scheduled"!==h.state)return[3,28];switch(j.update((0,ez.produce)(function(e){e&&(e[i].state="working")})),g=function(){j.update((0,ez.produce)(function(e){e&&(e[i]={action:e[i].action,checked:e[i].checked,state:"done"})}))},m=function(e){j.update((0,ez.produce)(function(t){t&&(t[i]={action:t[i].action,checked:t[i].checked,state:"failed",error:e})}))},y=(x=h.action).$kind){case"workspaceToolNudge":return[3,5];case"shellCommand":return[3,6];case"packageInstall":return[3,11];case"runConfiguration":return[3,16];case"deploymentConfiguration":return[3,19];case"fileChange":return[3,22];case"workflowConfiguration":return[3,24]}return[3,27];case 5:return[3,28];case 6:return k=x.shellCommand,[4,null==N?void 0:N(k.command)];case 7:if(!(null==(S=c.sent())?void 0:S.ok))return m("Spawning shell command failed"),[3,28];return[4,B({processId:S.payload,messageContentsOffset:k.messageContentsOffset})];case 8:if(!(null==(C=c.sent())?void 0:C.ok))return m("Server request failed"),[3,28];return[4,null==M?void 0:M(S.payload)];case 9:if(!(T=c.sent())||0!==T.exitCode)return m("Shell command failed"),[3,28];return[4,V((0,s._)((0,a._)({},T),{messageContentsOffset:k.messageContentsOffset}))];case 10:if(!(null==(E=c.sent())?void 0:E.ok))return m("Server request failed"),[3,28];return g(),[3,28];case 11:return O=x.packageInstall,[4,null==U?void 0:U({language:O.language,packageList:O.packageList})];case 12:if(!(null==(L=c.sent())?void 0:L.ok))return m("spawning packager failed"),[3,28];return[4,z({processId:L.payload,messageContentsOffset:O.messageContentsOffset})];case 13:if(!(null==(F=c.sent())?void 0:F.ok))return m("Server request failed"),[3,28];return[4,null==G?void 0:G(L.payload)];case 14:if(!($=c.sent())||0!==$.exitCode)return m("Failed to run packager"),[3,28];return[4,H({installationOutput:$.installationOutput,exitCode:$.exitCode,processId:L.payload,messageContentsOffset:O.messageContentsOffset})];case 15:if(!(null==(K=c.sent())?void 0:K.ok))return m("Server request failed"),[3,28];return g(),[3,28];case 16:return[4,W(Z=x.runConfiguration)];case 17:return c.sent(),[4,q({messageContentsOffset:Z.messageContentsOffset})];case 18:if(!(null==(er=c.sent())?void 0:er.ok))return m("Server request failed"),[3,28];return g(),[3,28];case 19:return ei=x.deploymentConfiguration,[4,null==X?void 0:X({buildCommand:ei.buildCommand,runCommand:ei.runCommand})];case 20:if(!(null==(eo=c.sent())?void 0:eo.ok))return m("failed configuring deployment"),[3,28];return[4,J({messageContentsOffset:ei.messageContentsOffset})];case 21:if(!(null==(ea=c.sent())?void 0:ea.ok))return m("Server request failed"),[3,28];return g(),[3,28];case 22:return[4,ee({change:x.fileChange})];case 23:if(c.sent().error)return m("file write failed"),[3,28];return g(),n.add(x.fileChange.filePath),[3,28];case 24:return[4,Y(es=x.workflowConfiguration)];case 25:return c.sent(),[4,Q({messageContentsOffset:es.messageContentsOffset})];case 26:if(!(null==(el=c.sent())?void 0:el.ok))return m("Server request failed"),[3,28];return g(),r=!0,[3,28];case 27:(0,e$.default)(y),c.label=28;case 28:return o=!1,[3,3];case 29:return[3,36];case 30:return eu=c.sent(),l=!0,u=eu,[3,36];case 31:if(c.trys.push([31,,34,35]),!(o&&null!=f.return))return[3,33];return[4,f.return()];case 32:c.sent(),c.label=33;case 33:return[3,35];case 34:if(l)throw u;return[7];case 35:return[7];case 36:return ec=e.filter(function(e){return n.has(e.filePath)}).map(function(e){return{filePath:e.filePath,changeSummary:e.changeSummary}}),r&&ec.push({filePath:eK.dotReplitPath,changeSummary:"Updated app configuration"}),[4,_({changes:ec,summary:b})];case 37:if(ef="hash"in(ed=c.sent())?ed.hash:null,ep="error"in ed?ed.error:null,!ef)return ep===eI.AssistantErrors.NOTHING_TO_COMMIT?R({state:"failed",error:"Nothing to commit",canRetryApply:!1}):R({state:"failed",error:"Commit failed: "+ep,canRetryApply:!0}),[2];return[4,P({appliedChanges:ec.map(function(e){var n,r,i=e.filePath,o=e.changeSummary,a=t.get(i);return{filePath:i,linesAdded:null!=(n=null==a?void 0:a.added)?n:0,linesRemoved:null!=(r=null==a?void 0:a.removed)?r:0,changeSummary:o}}),commitHash:ef})];case 38:if(!(null==(eh=c.sent())?void 0:eh.ok))return R({state:"failed",error:"Server request failed",canRetryApply:!0}),[2];return R({state:"done"}),w(),A.current=!1,[2]}})})()},[j,I,et,_,b,D,P,w,N,B,M,V,U,z,G,H,W,q,X,J,ee,Y,Q]),eo=(0,r.useCallback)(function(){j.update((0,ez.produce)(function(e){null==e||e.forEach(function(e){e.state="preparing"})})),R({state:"idle"}),I.current={state:"idle"},ei()},[ei,I,j]),ea=(0,eq.useObservable)(j),es=(0,r.useCallback)(function(e){j.update((0,ez.produce)(function(t){t&&"preparing"===t[e].state&&(t[e].checked=!t[e].checked)}))},[j]);return(0,r.useEffect)(function(){k&&et&&"idle"===I.current.state&&!0!==A.current&&(A.current=!0,ei())},[ei,k,I,A,et]),{state:E,multistepActions:ea,toggleMultistepActionCheck:es,applyActions:ei,reapplyActions:eo}}var eJ=e.i(127227),eZ=e.i(751273),e0=e.i(245225),e1=e.i(559073),e2=e.i(342574),e3=e.i(42458),e4=(0,T.cssRecord)({wrapper:[E.rcss.width("100%"),E.rcss.p(8),E.rcss.borderRadius(4)],actionRowWrapper:[E.rcss.height(24)],actionRow:[E.rcss.maxWidth("100%"),E.rcss.flex.growAndShrink(1),E.rcss.overflow("hidden")],handleOverflow:[E.rcss.maxWidth("100%"),E.rcss.flex.growAndShrink(1),E.rcss.overflow("hidden")],alignBaseline:[E.rcss.height("100%"),{alignItems:"baseline"}],iconWrapper:[E.rcss.width(20)],errorText:[E.rcss.color.accentNegativeStronger]});function e8(e){var t=e.action,r=t.state;switch(r){case"preparing":return null;case"scheduled":case"skipped":return(0,n.jsx)(e0.default,{});case"working":return(0,n.jsx)(es.default,{});case"done":return(0,n.jsx)(O.default,{color:j.tokens.accentPositiveDefault});case"failed":return(0,n.jsx)(eZ.Tooltip,{tooltip:t.error,children:(0,n.jsx)(e3.default,{color:j.tokens.accentNegativeDefault})});default:(0,e$.default)(r)}}function e5(e){var t=e.action,r=t.$kind;switch(r){case"workspaceToolNudge":return null;case"shellCommand":return(0,n.jsxs)(D.View,{align:"center",row:!0,gap:4,css:e4.handleOverflow,children:[(0,n.jsx)(e2.default,{}),(0,n.jsxs)(D.View,{row:!0,gap:2,css:e4.alignBaseline,children:["Run shell command:"," ",(0,n.jsx)(P.Text,{multiline:!1,variant:"code",children:t.shellCommand.command})]})]});case"packageInstall":return(0,n.jsxs)(D.View,{align:"center",row:!0,gap:4,css:e4.handleOverflow,children:[(0,n.jsx)(ea.default,{}),(0,n.jsxs)(D.View,{row:!0,gap:2,css:e4.alignBaseline,children:["Install dependencies:",t.packageInstall.packageList.map(function(e){return(0,n.jsx)(Y.Pill,{text:e},e)})]})]});case"fileChange":return(0,n.jsxs)(D.View,{align:"center",row:!0,gap:4,css:e4.handleOverflow,children:[(0,n.jsx)(ek.default,{}),(0,n.jsxs)(D.View,{row:!0,gap:4,css:e4.alignBaseline,children:["Edit file",(0,n.jsx)(P.Text,{multiline:!1,variant:"code",children:t.fileChange.filePath})]})]});case"runConfiguration":return(0,n.jsxs)(D.View,{align:"center",row:!0,gap:4,css:e4.handleOverflow,children:[(0,n.jsx)(e1.default,{}),(0,n.jsxs)(D.View,{row:!0,gap:4,css:e4.alignBaseline,children:["Configure ",(0,n.jsx)(Y.Pill,{text:t.runConfiguration.workflowName})," ","workflow"]})]});case"deploymentConfiguration":var i=t.deploymentConfiguration.buildCommand.length>0,o=t.deploymentConfiguration.runCommand.length>0,a="";return i&&!o?a="Configure deployment build command":!i&&o?a="Configure deployment run command":i&&o&&(a="Configure deployment build and run commands"),(0,n.jsxs)(D.View,{align:"center",row:!0,gap:4,css:e4.handleOverflow,children:[(0,n.jsx)(Q.default,{}),(0,n.jsx)(D.View,{row:!0,gap:4,css:e4.alignBaseline,children:(0,n.jsx)(D.View,{row:!0,align:"center",children:a})})]});case"workflowConfiguration":return(0,n.jsxs)(D.View,{align:"center",row:!0,gap:4,css:e4.handleOverflow,children:[(0,n.jsx)(e1.default,{}),(0,n.jsxs)(D.View,{row:!0,gap:4,css:e4.alignBaseline,children:["Configure ",(0,n.jsx)(Y.Pill,{text:t.workflowConfiguration.workflowName})," ","workflow"]})]});default:(0,e$.default)(r)}}function e6(e){var t=e.sessionId,i=e.eventId,o=e.sortedActions,a=e.changesSummary,s=e.changeStatus,l=e.onCancel,u=eX({sessionId:t,eventId:i,handleAutoRestart:e.handleAutoRestart,doAutoApplyChanges:e.doAutoApplyChanges,sortedActions:o,changesSummary:a,prevUserMessageContent:e.prevUserMessageContent}),c=u.applyActions,d=u.reapplyActions,f=u.multistepActions,p=u.toggleMultistepActionCheck,h=u.state,g=(0,r.useMemo)(function(){return!!("failed"===h.state||(null==f?void 0:f.some(function(e){return"failed"===e.state})))},[f,h.state]);return f&&0!==f.length&&("applied"!==s.state||g)?(0,n.jsx)(e9,{multistepActions:f,multistepState:h,onCancel:l,applyActions:c,reapplyActions:d,toggleMultistepActionCheck:p}):null}function e9(e){var t=e.multistepActions,i=e.multistepState,o=e.onCancel,a=e.applyActions,s=e.reapplyActions,l=e.toggleMultistepActionCheck,u=(0,r.useMemo)(function(){return null==t?void 0:t.some(function(e){return"preparing"===e.state&&!0===e.checked})},[t]);return(0,n.jsxs)(A.Surface,{elevated:!0,css:e4.wrapper,gap:8,children:[(0,n.jsx)(P.Text,{children:"Apply all:"}),(0,n.jsxs)(D.View,{gap:8,css:e4.handleOverflow,children:[(0,n.jsx)(D.View,{gap:4,css:e4.handleOverflow,children:null==t?void 0:t.map(function(e,t){return(0,n.jsxs)(D.View,{row:!0,gap:8,css:e4.actionRow,children:[(0,n.jsx)(D.View,{align:"center",justify:"center",css:e4.iconWrapper,children:"preparing"===e.state?(0,n.jsx)(eJ.Checkbox,{name:e.action.$kind,checked:e.checked,onChange:function(){l(t)}}):(0,n.jsx)(e8,{action:e})}),(0,n.jsx)(D.View,{align:"center",css:e4.actionRowWrapper,children:(0,n.jsx)(e5,{action:e.action})})]},t+"---"+e.action.$kind)})}),"idle"===i.state?(0,n.jsxs)(D.View,{row:!0,gap:8,children:[(0,n.jsx)(R.Button,{text:"Cancel",onClick:o}),(0,n.jsx)(R.Button,{text:"Ok",colorway:"primary",disabled:!u,onClick:a})]}):null,"failed"===i.state?(0,n.jsxs)(D.View,{row:!0,gap:16,css:e4.errorText,align:"center",children:[(0,n.jsx)(D.View,{children:i.error}),i.canRetryApply?(0,n.jsx)(R.Button,{text:"Try again",colorway:"primary",onClick:s}):null]}):null]})]})}var e7=e.i(604963);function te(e){var t=e.runState,a=e.onClick,s=t===i.AgentRunState.AGENT_STATE_PAUSING,u=(0,l._)((0,r.useState)(!1),2),d=u[0],f=u[1],p=(0,r.useCallback)(function(){return(0,o._)(function(){return(0,c._)(this,function(e){switch(e.label){case 0:return[4,a()];case 1:return e.sent(),f(!1),[2]}})})()},[a]);return(0,n.jsxs)(e7.PopoverTrigger,{label:"Stop ".concat(eI.AGENT_NAME," confirmation"),placement:"top",trigger:"click",isOpen:d,onOpenChange:f,children:[(0,n.jsx)(R.Button,{text:s?"Stopping ".concat(eI.AGENT_NAME,""):"Stop ".concat(eI.AGENT_NAME),colorway:"red",disabled:s}),(0,n.jsxs)(D.View,{p:8,gap:8,children:[(0,n.jsxs)(P.Text,{children:["Are you sure you want to stop"," ",(0,eI.getAgentName)({variant:"casual",capitalizeFirstChar:!1}),"?"]}),(0,n.jsxs)(D.View,{row:!0,gap:4,children:[(0,n.jsx)(R.Button,{text:"Cancel",onClick:function(){return f(!1)}}),(0,n.jsx)(R.Button,{text:"Stop ".concat(eI.AGENT_NAME),onClick:p,colorway:"red"})]})]})]})}var tt=e.i(721281),tn=e.i(825118),tr=e.i(597865),ti=e.i(189373),to=e.i(938024),ta=e.i(644171),ts=(0,T.cssRecord)({buttonRow:[E.rcss.flex.wrap],errorContainer:[E.rcss.rowWithGap(8),E.rcss.align.center,E.rcss.color.accentNegativeDefault],statusBanner:[E.rcss.width("100%")]});function tl(e){var t,u,d,f,p,h,g,m,x,b,w,k=e.fileChanges,S=e.commitId,j=e.summary,T=e.sortedActions,I=e.eventId,A=e.sessionId,O=e.openAiChatSettingsPanel,N=e.openPane,M=e.removePane,L=e.hasAnyWorkspaceProposedActions,B=e.isLatestProposedActionsEvent,V=e.isMessageComplete,F=e.prevUserMessageContent,U=(0,eD.useMemoedDismissibleElement)("workspace-assistant-auto-apply-changes"),G=(0,eD.useMemoedDismissibleElement)("workspace-assistant-auto-restart-repl"),$=(0,eP.usePreferences)("assistantAutoApplyChanges","assistantAutoRestartRepl").preferences,z=1===k.length&&!L,H=k.length>0,W=$.assistantAutoApplyChanges&&U.isDone,q=eN().isGitInitialized,K=(0,em.useSupportsAgent)(),Y=(0,eO.useAgentRunState)(),Q=(0,eO.usePauseAgent)(),X=K&&(Y===i.AgentRunState.AGENT_STATE_RUNNING||Y===i.AgentRunState.AGENT_STATE_PAUSING),J=(0,l._)((0,r.useState)(null),2),ee=J[0],et=J[1],en=(0,r.useCallback)(function(){return(0,o._)(function(){return(0,c._)(this,function(e){try{Q()}catch(e){et("Unable to pause agent: ".concat(e))}return[2]})})()},[Q]),er=ey({sessionId:A,eventIdWhichProposedChanges:I}),ei=k.some(function(e){return e.state===i.FileChangeGenerationState.GENERATION_REGENERATING}),eo=V&&"pending"===er.state&&!ei,ea=(0,y.default)({changeStatus:er,removePane:M}).onOpenTemporaryDiffPane,el=(u=(t={filePaths:(0,r.useMemo)(function(){return k.map(function(e){return e.filePath})},[k]),commitId:S}).commitId,d=t.filePaths,f=(0,Z.default)().fs,h=(p=(0,l._)((0,r.useState)(null),2))[0],g=p[1],m=(0,tr.default)(function(e){return(0,o._)(function(){var t,n,r,i,o,a,s,l,f,p;return(0,c._)(this,function(c){switch(c.label){case 0:if(t=null,n={},!u)return[2,{error:tn.GitErrors.NO_COMMITS}];r=!0,i=!1,o=void 0,c.label=1;case 1:c.trys.push([1,6,7,8]),a=d[Symbol.iterator](),c.label=2;case 2:if(r=(s=a.next()).done)return[3,5];return l=s.value,[4,e.getFileContents({path:l,revision:u,convertToBase64:!1})];case 3:(f=c.sent()).error?t=f.error:f.content&&(n[l]=f.content),c.label=4;case 4:return r=!0,[3,2];case 5:return[3,8];case 6:return p=c.sent(),i=!0,o=p,[3,8];case 7:try{r||null==a.return||a.return()}finally{if(i)throw o}return[7];case 8:return[2,t?{error:t}:{fileContents:n,error:null}]}})})()},[u,d],{keepStaleResult:!0}),(0,r.useEffect)(function(){(null==m?void 0:m.error)&&g(m.error)},[m]),b=(x=(0,l._)((0,r.useState)({}),2))[0],w=x[1],(0,r.useEffect)(function(){(e=f,t=d,(0,o._)(function(){var n,r;return(0,c._)(this,function(i){switch(i.label){case 0:return n={},r=null,[4,Promise.all(t.map(function(t){return(0,o._)(function(){var i;return(0,c._)(this,function(o){switch(o.label){case 0:return[4,e.readFile(t)];case 1:return(i=o.sent()).error?r=i.error:n[t]=i.content.toString(),[2]}})})()}))];case 1:return i.sent(),[2,{contents:n,error:r}]}})})()).then(function(e){var t=e.contents,n=e.error;w(t),n&&g(n)});var e,t,n=d.map(function(e){return f.watchTextFile(e,{onChange:function(){return(0,o._)(function(){var t;return(0,c._)(this,function(n){switch(n.label){case 0:return[4,f.readFile(e)];case 1:if((t=n.sent()).error)return g(t.error),[2];return w(function(n){return(0,s._)((0,a._)({},n),(0,tt._)({},e,t.content.toString()))}),[2]}})})()}})});return function(){n.forEach(function(e){return e()})}},[f,d]),(0,r.useMemo)(function(){if(null==m||null==b)return{changedPaths:[],hasAnyChangedPaths:!1,error:h,isLoading:!0};if(h)return{changedPaths:[],hasAnyChangedPaths:!1,error:h,isLoading:!1};var e=d.filter(function(e){if(!m.fileContents)return!1;var t=b[e],n=m.fileContents[e];return void 0!==t&&void 0!==n&&b[e]!==m.fileContents[e]});return{changedPaths:e,hasAnyChangedPaths:e.length>0,error:h,isLoading:!1}},[b,m,d,h])),eu=el.changedPaths,ec=el.hasAnyChangedPaths,ed=el.isLoading,ef=(0,_.useOnReRun)(),ep=(0,l._)((0,r.useState)(!1),2),eh=ep[0],eg=ep[1],ev=(0,C.useSendAssistantRetryEditRequestMessage)({sessionId:A}),ex=(0,r.useCallback)(function(){return(0,o._)(function(){return(0,c._)(this,function(e){return $.assistantAutoRestartRepl&&(ef(),eg(!0)),[2]})})()},[$.assistantAutoRestartRepl,ef]),eb=(0,r.useMemo)(function(){return!!W&&!!B&&!!eo&&!X},[X,eo,W,B]),ew=eX({sessionId:A,eventId:I,handleAutoRestart:ex,doAutoApplyChanges:eb,sortedActions:T,changesSummary:j,prevUserMessageContent:F}),ek=ew.applyActions,e_=ew.state,eS="working"===e_.state,eC="failed"===e_.state?e_.error:void 0,ej="failed"===e_.state&&e_.canRetryApply,eT=(0,r.useCallback)(function(){return(0,o._)(function(){return(0,c._)(this,function(e){return ek(),U.isDone||U.setAsDone(),[2]})})()},[ek,U]),eE=(0,l._)((0,r.useState)(!1),2),eR=eE[0],eA=eE[1],eM=(0,r.useCallback)(function(){if(z)return eT();eA(!0)},[eT,z]),eL=(0,r.useCallback)(function(){var e=k.map(function(e){return{left:{path:e.filePath,data:{type:"git",revision:S}},right:{path:e.filePath,data:{type:"generatedFile",content:e.content}}}});N({type:"diff",data:e}),ea(e)},[S,N,k,ea]);(0,r.useEffect)(function(){eb&&eM()},[eb,eM]);var eB=(0,n.jsx)(eV.StatusBanner,{css:ts.statusBanner,icon:(0,n.jsx)(eF.default,{}),colorway:"teal",text:(0,n.jsxs)(n.Fragment,{children:[eI.ASSISTANT_NAME," can automatically apply proposed changes to your App. You can enable this behavior in"," ",(0,n.jsx)(R.Button,{css:E.rcss.display.inlineFlex,variant:"underlined",size:"small",onClick:O,text:"".concat(eI.ASSISTANT_NAME," Settings")}),"."]}),closable:!0,closeAction:U.setAsDone}),eU=(0,n.jsx)(eV.StatusBanner,{css:ts.statusBanner,icon:(0,n.jsx)(eF.default,{}),colorway:"teal",text:(0,n.jsxs)(n.Fragment,{children:[eI.ASSISTANT_NAME," automatically restarted your App after applying file changes. You can disable this behavior in"," ",(0,n.jsx)(R.Button,{css:E.rcss.display.inlineFlex,variant:"underlined",size:"small",onClick:O,text:"".concat(eI.ASSISTANT_NAME," Settings")}),"."]}),closable:!0,closeAction:G.setAsDone}),eG=X?(0,n.jsxs)(P.Text,{variant:"small",color:"dimmer",children:[(0,eI.getAgentName)({capitalizeFirstChar:!0})," is currently active. Changes cannot be applied until ",(0,eI.getAgentName)()," finishes working."]}):null;return B&&q?eS||ei?(0,n.jsxs)(D.View,{row:!0,gap:8,align:"center",children:[ei?(0,n.jsx)(P.Text,{color:"dimmer",children:"Thinking"}):eS?(0,n.jsx)(P.Text,{color:"dimmer",children:"Applying changes"}):null,(0,n.jsx)(es.default,{})]}):V?(0,n.jsxs)(D.View,{gap:8,align:"start",children:[U.isDone?null:eB,(0,n.jsx)(tu,{changeStatus:er,isLoadingFilesChangedSinceCommit:ed,hasAnyChangedPaths:ec,changedPaths:eu,openPane:N,handleRetryProposingChanges:ev,handleApplyChanges:eM,isAgentActive:X,agentRunState:Y,handlePauseAgent:en,assistantAutoApplyChanges:$.assistantAutoApplyChanges,openMultiDiffPane:eL,isMultistepApplyUIVisible:eR,hasSingleFileChangeOnly:z,hasAnyFileChanges:H}),eG,null==ee?null:(0,n.jsxs)(D.View,{css:ts.errorContainer,children:[(0,n.jsx)(to.default,{}),ee,(0,n.jsx)(R.Button,{text:"Try again",onClick:en,variant:"underlined",iconLeft:(0,n.jsx)(ta.default,{})})]}),null==eC?null:(0,n.jsxs)(D.View,{css:ts.errorContainer,children:[(0,n.jsx)(to.default,{}),eC,ej?(0,n.jsx)(R.Button,{text:"Try again",onClick:eM,variant:"underlined",iconLeft:(0,n.jsx)(ta.default,{})}):null]}),!eh||G.isDone?null:eU,eR?(0,n.jsx)(e6,{sessionId:A,eventId:I,sortedActions:T,changesSummary:j,changeStatus:er,onCancel:function(){eA(!1)},handleAutoRestart:ex,doAutoApplyChanges:eb,prevUserMessageContent:F}):null]}):null:null}function tu(e){var t=e.changeStatus,r=e.isLoadingFilesChangedSinceCommit,i=e.hasAnyChangedPaths,o=e.changedPaths,a=e.openPane,s=e.handleRetryProposingChanges,l=e.handleApplyChanges,u=e.isAgentActive,c=e.agentRunState,d=e.handlePauseAgent,f=e.assistantAutoApplyChanges,p=e.openMultiDiffPane,h=e.isMultistepApplyUIVisible,g=e.hasSingleFileChangeOnly,m=e.hasAnyFileChanges;return h||"pending"!==t.state?null:r?(0,n.jsx)(D.View,{css:ts.buttonRow,row:!0,gap:8,align:"center",children:(0,n.jsx)(R.Button,{text:"Validating code changes",iconLeft:(0,n.jsx)(es.default,{}),disabled:!0})}):i?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(eG,{changedPaths:o,openPane:a}),(0,n.jsxs)(D.View,{css:ts.buttonRow,row:!0,gap:8,align:"center",children:[(0,n.jsx)(R.Button,{text:"Retry ".concat(eA.ASSISTANT_USAGE_UNIT),onClick:s,iconLeft:(0,n.jsx)(ta.default,{})}),(0,n.jsx)(R.Button,{text:"Overwrite and apply",onClick:l,iconLeft:(0,n.jsx)(O.default,{}),colorway:"warning"})]})]}):(0,n.jsxs)(D.View,{css:ts.buttonRow,row:!0,gap:8,align:"center",children:[u?(0,n.jsx)(te,{runState:c,onClick:d}):null,(0,n.jsx)(eZ.Tooltip,{tooltip:"Stop agent before applying changes",placement:"top",isDisabled:!u,children:(0,n.jsx)(R.Button,{text:g?"Apply":"Apply all",onClick:l,iconLeft:(0,n.jsx)(O.default,{}),disabled:u,colorway:f?"green":"primary"})}),m?(0,n.jsx)(R.Button,{text:"Preview code changes",onClick:p,iconLeft:(0,n.jsx)(ti.default,{}),disabled:u}):null]})}function tc(e){var t=e.proposedActions,r=(0,eR._)(e,["proposedActions"]);return t&&(t.fileChanges.length>0||t.hasAnyWorkspaceProposedActions)?(0,n.jsx)(tl,(0,a._)({},r,t)):null}function td(){return(0,n.jsx)(D.View,{px:16,py:8,children:(0,n.jsx)(eV.StatusBanner,{text:"".concat(eI.ASSISTANT_NAME," saved your work"),icon:(0,n.jsx)(O.default,{}),colorway:"primary"})})}e.s(["AiMessageEventActions",()=>tc],725371),e.s(["AssistantCheckpointBanner",()=>td],845874);var tf=e.i(477932),tp=e.i(596139),th=e.i(605526),tg=e.i(207237),tm=e.i(313264),tv=e.i(257811),tx=e.i(230999),ty=e.i(245150),tb=e.i(651499),tw=((t={}).None="none",t.Starter="starter",t.Paid="paid",t),tk=(0,T.cssRecord)({root:[E.rcss.borderRadius(),E.rcss.border({color:j.tokens.outlineDimmest})],icon:{paddingTop:3},footer:[{"@container (max-width: 400px)":[E.rcss.colWithGap(8),E.rcss.align.start,E.rcss.height("100%")]}],footerActions:[E.rcss.color.foregroundDimmer,E.rcss.mr(4),{"@container (max-width: 400px)":{width:"100%"}}],footerSmallButtonContainer:[E.rcss.display.inlineFlex,{"@container (max-width: 400px)":[E.rcss.flex.grow(1)]}],footerSmallButton:[{marginTop:-10,marginRight:-4},{"@container (max-width: 400px)":{margin:0}}],timestamp:[E.rcss.rowWithGap(4),E.rcss.flex.wrap],summaryContainer:[E.rcss.width(200)]});function t_(e){var t=e.commitId,r=e.changeSetSummary,i=e.date,o=e.isAtCheckpoint,a=e.isRestoring,s=e.wasReverted,l=e.isLoading,u=e.onCommitRestore,c=e.onOpenCommit,d=e.restoreButtonText,f=e.usageIndicatorVariant,p=(0,tg.default)(),h=(0,th.useOrgId)(p).orgId,g=(0,tm.useMonthlyCreditsExhausted)(h).hasUserExhaustedMonthlyCredits,m="starter"===f?"Used 1 ".concat(tp.freePlanName," plan ").concat(eI.ASSISTANT_NAME," ").concat(eA.ASSISTANT_USAGE_UNIT):"The ".concat(eA.ASSISTANT_USAGE_UNIT," for this checkpoint used ").concat(eA.ASSISTANT_UNIT_PRICE_IN_CENTS," ").concat(g?"":"of your usage credits",".");return(0,n.jsxs)(A.Surface,{elevated:!0,css:tk.root,py:4,px:8,row:!0,gap:8,children:[(0,n.jsx)(D.View,{css:tk.icon,children:(0,n.jsx)(tx.default,{color:j.tokens.foregroundDimmest})}),(0,n.jsxs)(D.View,{grow:!0,shrink:!0,gap:4,children:[(0,n.jsxs)(D.View,{row:!0,gap:8,align:"center",justify:"space-between",children:[(0,n.jsxs)(D.View,{row:!0,gap:4,children:[(0,n.jsx)(P.Text,{maxLines:2,color:s&&!o?"dimmer":"default",style:{textDecoration:s&&!o?"line-through":void 0},children:o?"Currently at checkpoint":"Checkpoint made"}),s&&!o?(0,n.jsx)(P.Text,{color:"dimmer",children:"Reverted"}):null]}),"none"!==f?(0,n.jsx)(eZ.Tooltip,{tooltip:m,placement:"top",children:(0,n.jsx)(tb.default,{})}):null]}),(0,n.jsx)(D.View,{children:void 0!==l&&l?(0,n.jsx)(D.View,{css:tk.summaryContainer,children:(0,n.jsx)(tf.default,{speed:2,backgroundColor:j.tokens.backgroundHighest,foregroundColor:j.tokens.backgroundHigher,height:18,children:(0,n.jsx)("rect",{x:"0",y:"0",rx:"4",ry:"4",width:"200",height:"16"})})}):r?(0,n.jsx)(P.Text,{color:"dimmer",variant:"small",children:r}):null}),(0,n.jsxs)(D.View,{css:tk.footer,row:!0,align:"end",children:[(0,n.jsxs)(D.View,{row:!0,gap:8,children:[i?(0,n.jsx)(D.View,{css:tk.timestamp,style:{color:j.tokens.foregroundDimmer},children:(0,n.jsx)(tv.Timestamp,{textVariant:"small",live:!0,date:i})}):null,t?(0,n.jsx)(tS,{commitId:t,onOpenCommit:c}):null]}),(0,n.jsx)(D.View,{css:tk.footerActions,grow:!0,shrink:!0,row:!0,justify:"end",children:t&&u&&!o?(0,n.jsx)(eZ.Tooltip,{tooltip:"Already at this checkpoint",isDisabled:!o,css:tk.footerSmallButtonContainer,children:(0,n.jsx)(R.Button,{css:tk.footerSmallButton,onClick:u,iconLeft:a?(0,n.jsx)(es.default,{}):s?(0,n.jsx)(ta.default,{}):(0,n.jsx)(ty.default,{}),disabled:a||o,size:"small",variant:"underlinedOnHover",text:s?"Restore checkpoint":void 0===d?"Go to this checkpoint":d})}):null})]})]})]})}function tS(e){var t=e.commitId,r=e.onOpenCommit;return(0,n.jsxs)(D.View,{css:tk.timestamp,style:{color:j.tokens.foregroundDimmer},children:[(0,n.jsx)(P.Text,{variant:"small",multiline:!1,children:""}),r?(0,n.jsx)(R.Button,{variant:"underlinedOnHover",text:t.slice(0,8),size:"small",onClick:function(){return r(t)}}):(0,n.jsx)(P.Text,{variant:"small",children:t})]})}e.s(["CheckpointUsageIndicatorVariant",()=>tw,"default",()=>t_],263286)},627557,e=>{"use strict";var t=e.i(530658),n=e.i(633600);function r(e,t){for(var n=[],r=e.split(t),i=0;i<r.length;i++){var o=r[i].trim();""!==o&&n.push(o)}return n}function i(e){return e.replace(/^<|>$/g,"")}function o(e){return"'".concat(e.replace(/'/g,"'\\''"),"'")}function a(e){return e.replace(/^refs\/(?:heads|remotes)\//,"")}function s(e){if(-1===e.indexOf("/")||e.startsWith("refs/heads/"))return[null,null];if(e.startsWith("refs/remotes/")){var t=(0,n._)(e.split("/"));return[t[2],t.slice(3).join("/")]}var r=(0,n._)(e.split("/"));return[r[0],r.slice(1).join("/")]}function l(e){return e.replace(/^refs\/remotes\//,"")}function u(e){var t=(0,n._)(e.split("\n")),r=t[0],i=t.slice(1);return i.length?"".concat(r,"\n").concat(i.map(function(e){return"	"+e}).join("\n")):e}function c(e){if(0===Object.keys(e).length)return"";var n=Object.entries(e).map(function(e){var n=(0,t._)(e,2),r=n[0],i=n[1];return"".concat(r,": ").concat(u(i))}).join("\n");return'-m "'.concat(n,'"')}function d(e){var t=(0,n._)(e.split("\n")),r=t[0],i=t.slice(1);return i.length?"".concat(r,"\n").concat(i.map(function(e){return e.slice(1)}).join("\n")):e}e.s(["formatTrailer",()=>u,"formatTrailersForMessage",()=>c,"parseTrailer",()=>d,"removeBranchRefsPath",()=>a,"removeGitEmailBrackets",()=>i,"removeRemoteRefsPath",()=>l,"splitRemoteFromBranch",()=>s,"splitTrimFilter",()=>r,"wrapInSingleQuotes",()=>o])},398220,e=>{"use strict";var t=e.i(297083),n=e.i(721281),r=e.i(878420),i=e.i(64386),o=e.i(817556),a=e.i(960933),s=e.i(627557),l="Replit-Restored-To";function u(e,a){return(0,t._)(function(){var t;return(0,o._)(this,function(o){switch(o.label){case 0:var u,c,d,f,p,h;return[4,e((c=(0,s.wrapInSingleQuotes)(a.commit),d=(0,s.wrapInSingleQuotes)(null!=(u=a.message)?u:"Restored to ".concat(c)),f=(0,i._)((0,r._)({},a.trailers),(0,n._)({},l,"${RESOLVED_COMMIT_HASH}")),p=(0,s.formatTrailersForMessage)(f),h="-p HEAD"+(a.extraParent?" -p ".concat((0,s.wrapInSingleQuotes)(a.extraParent)):""),["set -eo pipefail;","RESOLVED_COMMIT_HASH=$(git rev-parse ".concat(c,");"),"COMMIT_HASH=$(git commit-tree ".concat(h," -m ").concat(d," ").concat(p,' "${RESOLVED_COMMIT_HASH}^{tree}");'),'git reset --quiet --hard "$COMMIT_HASH"; echo -n "$COMMIT_HASH";'].join(" ")))];case 1:if((t=o.sent()).error)return[2,t];return[2,{hash:t.output,error:null}]}})})()}a.Type.Object({commit:a.Type.String(),extraParent:a.Type.Optional(a.Type.String()),message:a.Type.Optional(a.Type.String()),trailers:a.Type.Optional(a.Type.Record(a.Type.String(),a.Type.String()))}),e.s(["GIT_RESTORED_TO_TRAILER",()=>l,"default",()=>u])},379391,688216,288419,667625,71600,863002,43817,e=>{"use strict";var t,n=e.i(878420),r=e.i(886513),i=e.i(530658),o=e.i(276385),a=e.i(389959);e.i(877212);var s=e.i(924908);e.i(925218);var l=e.i(267103),u=e.i(641555),c=e.i(27329),d=e.i(529810),f=e.i(4533),p=e.i(955047),h=e.i(704977),g=e.i(673376),m=e.i(297083),x=e.i(817556),y=e.i(188507),b=e.i(605526),w=e.i(207237),k=e.i(313264),_=e.i(210943),S=e.i(725371),C=e.i(845874),j=e.i(597865),T=e.i(263286),E=e.i(398220),R=e.i(446530),I=e.i(613355),A=e.i(625484),P=(0,R.cssRecord)({errorContainer:[I.rcss.color.accentNegativeDefault]});function D(e){var t=e.commitHash,n=e.created,r=e.onOpenCommit,i=e.onRestoreToCommit,a=e.isRestoring,s=e.error,l=void 0===s?null:s,u=e.currentCommit,c=void 0===u?null:u,d=e.commitDetails,f=void 0===d?null:d,p=e.isLoading,h=e.usageIndicatorVariant,g=(null==c?void 0:c.hash)===t,y=(null==c?void 0:c.trailers[E.GIT_RESTORED_TO_TRAILER])===t;return(0,o.jsxs)(A.View,{px:16,py:8,gap:8,children:[l?(0,o.jsx)(A.View,{css:P.errorContainer,children:l}):null,(0,o.jsx)(T.default,{commitId:t,changeSetSummary:null==f?void 0:f.subject,date:n,isAtCheckpoint:!!(y||g),isRestoring:void 0!==a&&a,onCommitRestore:function(){return(0,m._)(function(){return(0,x._)(this,function(e){switch(e.label){case 0:if(!i)return[2];e.label=1;case 1:return e.trys.push([1,3,,4]),[4,i()];case 2:case 3:return e.sent(),[3,4];case 4:return[2]}})})()},onOpenCommit:r,isLoading:void 0!==p&&p,usageIndicatorVariant:h})]})}function O(e){var t=e.commitHash,n=e.created,r=e.onOpenCommit,s=e.onRestoreToCommit,l=(0,i._)((0,a.useState)(!1),2),u=l[0],c=l[1],d=(0,i._)((0,a.useState)(null),2),f=d[0],p=d[1],h=(0,i._)((0,a.useState)(!0),2),g=h[0],y=h[1],b=(0,i._)((0,a.useState)(null),2),w=b[0],k=b[1],_=(0,i._)((0,a.useState)(null),2),S=_[0],C=_[1],E=(0,i._)((0,a.useState)(!0),2),R=E[0],I=E[1];return(0,j.default)(function(e){return(0,m._)(function(){var n,r,o,a;return(0,x._)(this,function(s){switch(s.label){case 0:return[4,Promise.all([e.getCommit({commit:"HEAD"}),e.getCommit({commit:t})])];case 1:return r=(n=i._.apply(void 0,[s.sent(),2]))[0],o=n[1],r.error?k(null):(a={},Object.entries(r.trailers||{}).forEach(function(e){var t=(0,i._)(e,2),n=t[0],r=t[1];a[n]=null!=r?r:""}),k({hash:r.hash,trailers:a})),o.error?C(null):C({subject:o.subject}),y(!1),[2,{error:null}]}})})()},[t]),(0,a.useEffect)(function(){if(R){var e=setTimeout(function(){I(!1)},3e3);return function(){return clearTimeout(e)}}},[R]),(0,o.jsx)(D,{commitHash:t,created:n,onOpenCommit:r,onRestoreToCommit:function(){return(0,m._)(function(){return(0,x._)(this,function(e){if(!s)return[2];c(!0);try{s(),p(null)}catch(e){p("Failed to restore to checkpoint")}finally{c(!1)}return[2]})})()},isRestoring:u,error:f,currentCommit:w,commitDetails:S,isLoading:g,usageIndicatorVariant:T.CheckpointUsageIndicatorVariant.None})}var N=e.i(845822),M=e.i(17322),L=e.i(480028),B=e.i(751273),V=e.i(651499),F=(0,R.cssRecord)({costInfo:[I.rcss.height(24)]});function U(e){var t=e.eventId,n=e.sessionId,r=e.hasUserExhaustedMonthlyCredits,i=e.didCountEditRequest,a=(0,M.useProposedChangesStatus)({sessionId:n,eventIdWhichProposedChanges:t});return(0,o.jsx)(A.View,{grow:!0,shrink:!0,row:!0,gap:4,justify:"start",children:i&&"pending"===a.state?(0,o.jsx)(A.View,{css:F.costInfo,row:!0,align:"center",children:(0,o.jsx)(B.Tooltip,{tooltip:"This ".concat(N.ASSISTANT_USAGE_UNIT," used ").concat(N.ASSISTANT_UNIT_PRICE_IN_CENTS," ").concat(r?"":"of your usage credits","."),placement:"bottom",children:(0,o.jsx)(V.default,{color:L.tokens.foregroundDimmer})})}):null})}var G=e.i(629536),$=e.i(825118),z=e.i(98816),H=e.i(546284),W=e.i(205104),q=e.i(960178),K=e.i(916271),Y=e.i(925978),Q=(0,R.cssRecord)({revertText:[I.rcss.color.orangeStronger,I.rcss.fontWeight.medium],mergeText:[I.rcss.color.purpleStronger,I.rcss.fontWeight.medium],pullRequestId:[I.rcss.fontWeight.medium],hash:[I.rcss.fontWeight.medium],filePathPrefix:[I.rcss.color.foregroundDimmest],commitBody:[I.rcss.font.code,{whiteSpace:"pre-wrap"},{fontSize:L.tokens.fontSizeSmall}],clickableName:[I.rcss.cursor.pointer,{"&:hover":{textDecoration:"underline"}}],tooltip:[I.rcss.display.inlineFlex,I.rcss.rowWithGap(4),I.rcss.align.center],path:[{fontSize:L.tokens.fontSizeSmall},I.rcss.font.code],currentBranchIndicator:[I.rcss.height(16),I.rcss.width(16),I.rcss.align.center],currentBranchDot:[I.rcss.height(6),I.rcss.width(6),I.rcss.backgroundColor.accentPrimaryStronger,I.rcss.borderRadius("full")],branchNameWrapper:[I.rcss.flex.row,I.rcss.align.center],fixTooltipDisplay:{"& > span":{display:"inline-block"}},headingWrapper:[I.rcss.display.inlineFlex,I.rcss.rowWithGap(4),I.rcss.align.center,I.rcss.flex.shrink(1),I.rcss.overflow("hidden")],headingRemote:[{verticalAlign:"text-bottom"},I.rcss.mr(4)],headingCurrent:[I.rcss.px(4)],current:[I.rcss.position.relative,I.rcss.top("-1px"),I.rcss.display.inlineFlex,I.rcss.pl(2),I.rcss.pr(8)],icon:[{verticalAlign:"baseline !important"},I.rcss.mr(4)],bodyContainer:[I.rcss.border({color:L.tokens.outlineDimmest,direction:"full"}),I.rcss.borderRadius(8),I.rcss.p(16)]});function X(e){var t=e.text,n=e.className;return(0,o.jsx)("span",{className:n,css:Q.revertText,children:t})}function J(e){var t=e.text,n=e.className;return(0,o.jsx)("span",{className:n,css:Q.mergeText,children:t})}function Z(e){var t,n=e.id,r=e.hash,i=e.className;return t=void 0===r||r?"string"==typeof n&&n.startsWith("#")?n:"#".concat(n):"string"==typeof n&&n.startsWith("#")?n.slice(1):"".concat(n),(0,o.jsx)("span",{className:i,css:Q.pullRequestId,children:t})}function ee(e){var t=e.hash,n=e.length,r=e.className;return(0,o.jsx)("span",{className:r,css:Q.hash,children:t.slice(0,(void 0===n?8:n)+1)})}function et(e){var t=e.subject,n=e.remoteName,r=e.quoted,i=void 0!==r&&r,a=e.className;return n?(0,o.jsx)(K.default,{className:a,background:!1,lineBreaks:!0,themed:!0,useRemarkGfm:!0,remarkGitHubOptions:{repository:n},children:i?'"'.concat(t,'"'):t}):(0,o.jsx)("span",{className:a,children:i?'"'.concat(t,'"'):t})}function en(e){var t=e.body,n=e.view,r=e.className;return"Source"===(void 0===n?"Source":n)?(0,o.jsx)(A.View,{css:Q.bodyContainer,children:(0,o.jsx)("pre",{className:r,css:Q.commitBody,children:t})}):(0,o.jsx)(A.View,{css:Q.bodyContainer,children:(0,o.jsx)(K.default,{className:r,background:!1,mentionsLink:!0,lineBreaks:!0,themed:!0,useRemarkGfm:!0,children:t})})}function er(){return(0,o.jsx)("span",{css:Q.fixTooltipDisplay,children:(0,o.jsx)(B.Tooltip,{tooltip:"This is your current branch",children:(0,o.jsx)(A.View,{css:Q.currentBranchIndicator,children:(0,o.jsx)(A.View,{css:Q.currentBranchDot})})})})}function ei(e){var t=e.name,n=e.remote,r=e.current,i=void 0!==r&&r,a=e.heading,s=void 0!==a&&a,l=e.icon,u=void 0!==l&&l,c=e.onClick,d=e.className,f=null;return(!0===u?f=s?(0,o.jsx)(Y.default,{size:16}):(0,o.jsx)(Y.default,{css:Q.icon,size:12}):u&&(f=u),s)?(0,o.jsxs)("div",{css:Q.headingWrapper,children:[f,(0,o.jsxs)(q.Text,{variant:"subheadDefault",multiline:!1,children:[n?(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("span",{css:Q.headingRemote,children:n}),(0,o.jsx)("span",{css:Q.headingRemote,children:"/"})]}):null,c?(0,o.jsx)(es,{label:"View branch",onClick:c,children:t}):(0,o.jsx)("span",{children:t})]}),i?(0,o.jsx)("span",{css:s?Q.headingCurrent:Q.current,children:(0,o.jsx)(er,{})}):null]}):(0,o.jsxs)("span",{className:d,css:Q.branchNameWrapper,children:[f,n?(0,o.jsxs)("span",{children:[n,"/"]}):null,c?(0,o.jsx)(es,{label:"View branch",onClick:c,children:t}):(0,o.jsx)("span",{children:t}),i?(0,o.jsx)(er,{}):null]})}function eo(e){var t=e.path,n=e.prefix,r=e.onClick,i=e.className,a=(0,W.getFileName)(t),s=!r&&(a===t||null!==n&&n+a===t);return(0,o.jsx)("span",{css:Q.fixTooltipDisplay,children:(0,o.jsx)(B.Tooltip,{maxWidth:"auto",tooltip:(0,o.jsx)(ea,{path:t,openable:!!r}),isDisabled:s,children:r?(0,o.jsxs)(es,{label:"Open ".concat(a),onClick:r,className:i,children:[n?(0,o.jsx)("span",{css:Q.filePathPrefix,children:n}):null,(0,o.jsx)("span",{children:a})]}):(0,o.jsxs)("span",{className:i,children:[n?(0,o.jsx)("span",{css:Q.filePathPrefix,children:n}):null,(0,o.jsx)("span",{children:a})]})})})}function ea(e){var t=e.path,n=e.openable;return(0,o.jsxs)("span",{css:Q.tooltip,children:[void 0===n||n?(0,o.jsx)("span",{children:"Open"}):null,(0,o.jsx)("span",{css:Q.path,children:t})]})}function es(e){var t=e.label,n=e.onClick,r=e.className,i=e.children;return(0,o.jsx)("span",{className:r,css:Q.clickableName,role:"button",tabIndex:-1,"aria-label":t,onClick:n,onKeyDown:function(e){("Enter"===e.key||" "===e.key)&&(null==n||n())},children:i})}e.s(["BranchName",()=>ei,"CommitBody",()=>en,"CommitSubject",()=>et,"FilePath",()=>eo,"Hash",()=>ee,"MergeText",()=>J,"PullRequestID",()=>Z,"RevertText",()=>X],688216);var el=e.i(630818),eu=(0,R.cssRecord)({source:[I.rcss.color.foregroundDimmest],sourceArrow:[I.rcss.mx(8)]});function ec(e){var t=e.path,n=e.prefix,r=e.source,i=e.onClick;return(0,o.jsxs)(A.View,{grow:!0,shrink:!0,align:"center",row:!0,gap:8,children:[(0,o.jsx)(el.default,{path:t}),(0,o.jsxs)(q.Text,{multiline:!1,children:[(0,o.jsx)(eo,{path:t,prefix:n,onClick:i}),r?(0,o.jsxs)("span",{css:eu.source,children:[(0,o.jsx)("span",{css:eu.sourceArrow,children:""}),(0,o.jsx)(eo,{path:r})]}):null]})]})}e.s(["default",()=>ec],288419);var ed=e.i(140487),ef=e.i(739521),ep=e.i(71754),eh=e.i(940745),eg=e.i(245150),em=(0,R.cssRecord)({list:[I.rcss.px(4),I.rcss.colWithGap(2)]});function ev(e){var t,n=e.isOpen,r=e.files,i=e.commitHash,s=e.callback,l=(0,z.default)(s),u=(0,a.useCallback)(function(){var e;null==(e=l.current)||e.call(l,!0)},[l]),c=(0,a.useCallback)(function(){var e;null==(e=l.current)||e.call(l,!1)},[l]),d=(t=i,(0,j.default)(function(e){return(0,m._)(function(){var n,r;return(0,x._)(this,function(i){switch(i.label){case 0:if(!t)return[2,{error:$.GitErrors.INVALID_REFERENCE}];return[4,e.status()];case 1:if((n=i.sent()).error)return[2,{error:n.error}];return[4,e.getCommit({commit:t})];case 2:if((r=i.sent()).error)return[2,{error:r.error}];return[2,r]}})})()},[t])),f=d&&!d.error&&d.subject;return(0,o.jsx)(ef.Modal,{isOpen:n,onRequestClose:c,children:n?(0,o.jsxs)(A.View,{gap:8,children:[(0,o.jsx)(q.Header,{level:2,children:d?"Restore to ".concat(null!=f?f:"".concat(G.ASSISTANT_NAME," checkpoint")):(0,o.jsx)(eh.default,{})}),0===r.length?(0,o.jsx)(q.Text,{multiline:!1,children:"No file changes for this commit."}):(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(ex,{files:r}),(0,o.jsxs)(A.View,{row:!0,gap:8,justify:"end",children:[(0,o.jsx)(ed.Button,{text:"Cancel",iconLeft:(0,o.jsx)(ep.default,{}),onClick:c}),(0,o.jsx)(ed.Button,{text:"Restore Commit",iconLeft:(0,o.jsx)(eg.default,{}),colorway:"primary",onClick:u})]})]})]}):null})}function ex(e){var t=e.files;return(0,o.jsx)(A.View,{gap:12,children:(0,o.jsxs)(A.View,{gap:4,children:[(0,o.jsx)(q.Text,{multiline:!1,children:"The following ".concat((0,H.default)("file",t.length)," will be modified")}),(0,o.jsx)(ey,{files:t})]})})}function ey(e){var t=e.files,n=(0,a.useMemo)(function(){return t.length>20?t.slice(0,20):t},[t]);return(0,o.jsx)(A.View,{children:(0,o.jsxs)("ul",{css:em.list,children:[n.map(function(e){return(0,o.jsx)("li",{children:(0,o.jsx)(ec,{path:e.path,source:e.originalPath})},e.path)}),t.length<=20?null:(0,o.jsx)("li",{children:(0,o.jsxs)(q.Text,{color:"dimmer",children:[" ",t.length-20," more"," ",(0,H.default)("file",t.length-20)]})})]})})}function eb(){var e,t=(0,i._)((0,a.useState)(function(){return{isOpen:!1,files:[]}}),2),r=t[0],s=t[1],l=(e=(0,d.default)().git,(0,a.useCallback)(function(t){var n=t.commitA,r=t.commitB;return(0,m._)(function(){var t,i;return(0,x._)(this,function(o){switch(o.label){case 0:return[4,e.status()];case 1:if(null!==(t=o.sent()).error)return[2,{error:t.error}];return[4,e.getChangesBetweenCommits({a:n,b:r})];case 2:if(null!==(i=o.sent()).error)return[2,{error:i.error}];return[2,{error:null,files:i.files}]}})})()},[e]));return{confirmRestoreToCommit:(0,a.useCallback)(function(e){return new Promise(function(t,n){return(0,m._)(function(){var r,i;return(0,x._)(this,function(o){switch(o.label){case 0:return[4,l({commitA:"HEAD",commitB:e})];case 1:if((r=o.sent()).error)return n(r.error),[2];if(0===r.files.length)return n("No files changed"),[2];return i=function(e){s({isOpen:!1,files:[],callback:void 0,commitHash:void 0}),t(e)},s({isOpen:!0,files:r.files,callback:i,commitHash:e}),[2]}})})()})},[l]),restoreConfirmationModal:(0,a.useMemo)(function(){return(0,o.jsx)(ev,(0,n._)({},r))},[r])}}var ew=e.i(64386),ek=e.i(95826),e_=e.i(692910),eS=e.i(257811),eC=e.i(819700);function ej(e){var t=e.children,n=e.intent,r=e.showUpsell,i=e.date;return(0,o.jsxs)(A.View,{row:!0,gap:8,align:"center",children:[(0,o.jsx)(eC.default,{size:24}),(0,o.jsx)(q.Text,{variant:"small",color:"dimmer",children:G.ASSISTANT_NAME}),r?(0,o.jsx)(ek.AiUpsellPillWithPurchaseModal,{}):null,(0,o.jsx)(eS.Timestamp,{textVariant:"small",textColor:"dimmest",date:i}),(null==n?void 0:n.kind)==="message"?(0,o.jsx)(e_.IntentIconLabel,{intent:n.value,icon:{color:L.tokens.foregroundDimmest,size:12},text:{color:"dimmest",variant:"small"}}):null,(null==n?void 0:n.kind)==="inline"?(0,o.jsx)(e_.InlineActionIconLabel,{type:n.value,icon:{color:L.tokens.foregroundDimmest,size:12},text:{color:"dimmest",variant:"small"}}):null,t]})}function eT(e){var t=e.children,i=e.headerProps,a=void 0===i?{showUpsell:!1,intent:null,date:new Date}:i,s=e.headerActions,l=e.footer,u=e.footerActions,c=(0,r._)(e,["children","headerProps","headerActions","footer","footerActions"]);return(0,o.jsxs)(A.View,(0,ew._)((0,n._)({px:16,py:8,gap:8},c),{children:[(0,o.jsx)(ej,(0,ew._)((0,n._)({},a),{children:s})),t,l||u?(0,o.jsxs)(A.View,{row:!0,gap:8,align:"center",justify:"space-between",children:[(0,o.jsx)(A.View,{children:l}),(0,o.jsx)(A.View,{grow:!0,shrink:!0,row:!0,gap:8,align:"center",justify:"end",children:u})]}):null]}))}var eE=e.i(51553),eR=e.i(396776),eI=e.i(363201),eA=e.i(42458);function eP(e){var t=(0,eE.useIsAiClientConnected)(),n=(0,i._)((0,a.useState)(t),1)[0];switch(e.type){case y.EventErrorType.MANUALLY_ABORTED:return(0,o.jsx)(eR.StatusBanner,{icon:(0,o.jsx)(eI.default,{}),text:"Message was stopped"});case y.EventErrorType.USAGE_LIMIT:return(0,o.jsx)(eR.StatusBanner,{icon:(0,o.jsx)(eA.default,{}),colorway:"orange",text:"Usage limit reached"});default:return(0,o.jsx)(eR.StatusBanner,{icon:(0,o.jsx)(eA.default,{}),colorway:"red",text:n?"Something went wrong":"Please refresh the page and try again"})}}var eD=e.i(462995),eO=e.i(966773),eN=e.i(526962),eM=e.i(471458);function eL(){var e=(0,d.default)().git;return(0,a.useCallback)(function(t){var n=t.commitHash;return(0,m._)(function(){var t,r;return(0,x._)(this,function(i){switch(i.label){case 0:return[4,e.status()];case 1:if(null!=(t=i.sent()).error)return[2,{error:t.error}];return[4,e.restoreCommit({commit:n})];case 2:if(r=i.sent(),e.forceRefresh(),null!=r.error)return[2,{error:r.error}];return[2,{}]}})})()},[e])}var eB=(0,a.memo)(function(e){var t,n,r,i,s,l,u=e.id,c=e.data,d=e.prevData,f=e.openPane,p=e.removePane,h=e.openAiChatSettingsPanel,g=e.isLastEvent,j=eL(),T=eb(),E=T.confirmRestoreToCommit,R=T.restoreConfirmationModal,I=(0,w.default)(),P=(0,b.useOrgId)(I).orgId,D=(0,k.useMonthlyCreditsExhausted)(P).hasUserExhaustedMonthlyCredits,N=(0,eO.useOpenFile)(f),M=(0,a.useCallback)(function(e,t){return f({type:"webview",data:{ports:{path:e,port:t,type:"local"}}})},[f]),L=(0,eD.useMarkdownCodeComponent)({openFile:N,messageSenderType:y.UserType.AI}),B=(0,eM.default)({openWebview:M,ragSources:c.ragSources}),V=(0,a.useCallback)(function(e){return f({type:"git",data:{mode:{type:eN.GitPaneModeType.COMMIT,hash:e}}})},[f]),F=c.state===y.EventState.COMPLETE,G=null==(t=c.proposedActions)?void 0:t.didCreateCheckpoint,$=(null==d?void 0:d.type)==="userMessage"?d.content:void 0;return(0,o.jsxs)(A.View,{children:[R,G?g?(0,o.jsx)(C.AssistantCheckpointBanner,{}):(0,o.jsx)(O,{commitHash:null!=(s=null==(n=c.proposedActions)?void 0:n.commitId)?s:"",created:c.created,onOpenCommit:V,onRestoreToCommit:function(){return(0,m._)(function(){var e;return(0,x._)(this,function(t){switch(t.label){case 0:if(!(null==(e=c.proposedActions)?void 0:e.commitId))return[2];return[4,E(c.proposedActions.commitId)];case 1:if(!t.sent())return[3,3];return[4,j({commitHash:c.proposedActions.commitId})];case 2:t.sent(),t.label=3;case 3:return[2]}})})()}}):null,(0,o.jsxs)(eT,{"data-cy":"message-from-ai",headerProps:{showUpsell:!0,date:c.created,intent:c.intent},headerActions:(0,o.jsx)(U,{eventId:u,sessionId:c.sessionId,didCountEditRequest:null!=(l=null==(r=c.proposedActions)?void 0:r.didCountEditRequest)&&l,hasUserExhaustedMonthlyCredits:D}),footer:F&&c.error?(0,o.jsx)(eP,{type:c.error}):null,children:[(0,o.jsx)(_.AiMessageContents,{eventId:u,content:c.content,intent:(null==(i=c.intent)?void 0:i.kind)==="message"?c.intent.value:null,ragSources:c.ragSources,proposedActions:c.proposedActions,sessionId:c.sessionId,openPane:f,removePane:p,markdownCodeComponent:c.isDebugMessage?void 0:L,markdownLinkComponent:B,eventState:c.state}),(0,o.jsx)(S.AiMessageEventActions,{eventId:u,proposedActions:c.proposedActions,isLatestProposedActionsEvent:c.isLatestProposedActionsEvent,isMessageComplete:F,sessionId:c.sessionId,openAiChatSettingsPanel:h,openPane:f,removePane:p,prevUserMessageContent:$})]})]})}),eV=e.i(986194),eF=e.i(61524),eU=e.i(441329),eG=e.i(858248),e$=e.i(709485),ez=e.i(729122),eH=e.i(754873),eW=e.i(929872),eq=e.i(978669),eK=e.i(121817),eY=(0,R.cssRecord)({container:[I.rcss.borderRadius(),I.rcss.py(4),I.rcss.px(8),I.rcss.border({color:L.tokens.outlineDimmest}),eH.interactive.filledAndOutlined],runButton:[I.rcss.rowWithGap(4),I.rcss.justify.center,I.rcss.align.center,I.rcss.height(24),I.rcss.minWidth(48),I.rcss.cursor.pointer,I.rcss.position.relative,I.rcss.fontWeight.medium]});function eQ(e){var t=e.isWorkflowLoading,n=e.isRunning,r=e.forceDisable,i=e.handleRunButtonClick;return t?(0,o.jsxs)(A.View,{css:eY.runButton,children:[(0,o.jsx)(eh.default,{size:12}),(0,o.jsx)(q.Text,{multiline:!1,variant:"small",children:"Loading"})]}):n?(0,o.jsxs)(A.View,{css:eY.runButton,onClick:i,children:[(0,o.jsx)(eK.default,{size:12}),(0,o.jsx)(q.Text,{multiline:!1,variant:"small",children:"Rerun"})]}):(0,o.jsxs)(A.View,{disabled:r,css:eY.runButton,onClick:i,children:[(0,o.jsx)(eq.default,{size:12}),(0,o.jsx)(q.Text,{multiline:!1,variant:"small",children:"Run"})]})}function eX(){var e,t,n,r,i,s=(0,ez.useIsLoading)(),l=(0,ez.useRunInfo)(),u=l.isRunning,c=l.isDisabled,d=l.runButtonWorkflowName,f=(0,ez.useOnReRun)(),p=(0,a.useCallback)(function(){(0,eG.track)(e$.events.WORKSPACE,{action:"run_button_used",usage:"clicked",source:"assistantRerunButton",runner:"workflows"}),f()},[f]);return(0,o.jsx)(eW.Surface,{css:eY.container,grow:!0,shrink:!0,children:(0,o.jsx)(B.Tooltip,{placement:"top",tooltip:(n=(e={forceDisable:c,runButtonText:d,isRunning:u,isWorkflowLoading:s}).forceDisable,r=e.isRunning,i=e.isWorkflowLoading,t=n?"Run button is not configured":i?"Connecting to the workspace":r?"Rerun app":"Run app",(0,o.jsx)(q.Text,{variant:"small",color:"dimmer",children:t})),children:(0,o.jsx)(eQ,{forceDisable:c,handleRunButtonClick:p,isRunning:u,isWorkflowLoading:s})})})}var eJ=e.i(938024),eZ=(0,R.cssRecord)({errorContainer:[I.rcss.color.accentNegativeDefault]});function e0(e){var t,n,r,u=e.sessionId,c=e.commitHash,d=e.created,f=e.eventId,p=e.eventWhichProposedChanges,h=e.onOpenCommit,g=e.appliedChanges,y=e.usageIndicatorVariant,b=e.changeSetSummary,w=e.didCountEditRequest,k=(0,eU.useIsInMobileWorkspace)(),_=(0,eF.usePreferences)("assistantAutoRestartRepl").preferences,S=(0,i._)((0,a.useState)(!1),2),C=S[0],j=S[1],R=(0,i._)((0,a.useState)(null),2),I=R[0],P=R[1],D=e1("HEAD"),O=e1("HEAD^1"),N=D&&!D.error&&D.hash===c,L="reverted"===(0,M.useProposedChangesStatus)({sessionId:u,eventIdWhichProposedChanges:p}).state,B=D&&!D.error&&D.trailers[E.GIT_RESTORED_TO_TRAILER]===c,V=eL(),F=eb(),U=F.confirmRestoreToCommit,G=F.restoreConfirmationModal,$=(t=u,n=(0,s.useChatter)(),r=(0,l.useObservable)(n.sessions.get(t)),(0,a.useCallback)(function(e){if(null!=t)return null==r?void 0:r.appendEvent({kind:"iterativeAgent",action:e})},[r,t]));function z(e){return(0,m._)(function(){var t;return(0,x._)(this,function(n){switch(n.label){case 0:if(!e)return[2];return j(!0),[4,V({commitHash:e})];case 1:if((t=n.sent()).error)return P(t.error),j(!1),[2];return P(null),j(!1),[2]}})})()}var H=O&&!O.error,W=(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(q.Text,{variant:"small",color:"dimmer",children:"You may need to re-run your App to see the latest changes take effect."}),k?null:(0,o.jsx)(eX,{})]});return(0,o.jsxs)(A.View,{px:16,py:8,gap:8,children:[G,I?(0,o.jsxs)(A.View,{css:eZ.errorContainer,row:!0,gap:8,align:"center",children:[(0,o.jsx)(eJ.default,{}),I]}):null,N?H?(0,o.jsx)(T.default,{commitId:c,changeSetSummary:b,date:d,isAtCheckpoint:!1,isRestoring:C,onOpenCommit:h,onCommitRestore:function(){return(0,m._)(function(){return(0,x._)(this,function(e){switch(e.label){case 0:return[4,z(O.hash)];case 1:return e.sent(),$({eventIdWhichProposedChanges:p,eventIdWhichAppliedChanges:f,revertedChanges:g}),[2]}})})()},restoreButtonText:"Undo these changes",usageIndicatorVariant:w?y:T.CheckpointUsageIndicatorVariant.None}):null:(0,o.jsx)(T.default,{commitId:c,changeSetSummary:b,date:d,isAtCheckpoint:!!B,isRestoring:C,onCommitRestore:function(){return(0,m._)(function(){return(0,x._)(this,function(e){switch(e.label){case 0:if(!c)return[2];e.label=1;case 1:return e.trys.push([1,3,,4]),[4,U(c)];case 2:return e.sent()&&z(c),[3,4];case 3:return e.sent(),P("Something went wrong. Please try again."),[3,4];case 4:return[2]}})})()},onOpenCommit:h,usageIndicatorVariant:w?y:T.CheckpointUsageIndicatorVariant.None,wasReverted:L}),(0,o.jsx)(A.View,{gap:8,align:"start",children:N&&!_.assistantAutoRestartRepl?W:null})]})}function e1(e){return(0,j.default)(function(t){return(0,m._)(function(){var n;return(0,x._)(this,function(r){switch(r.label){case 0:return[4,t.getCommit({commit:e})];case 1:if((n=r.sent()).error)return[2,n];return[2,{hash:n.hash,trailers:n.trailers,error:null,body:n.body,subject:n.subject}]}})})()},[e])}function e2(e){var t=e.id,r=e.data,i=e.proposedActionEventData,s=e.openPane,u=e.checkpointUsageIndicatorVariant,c=(0,l.useObservable)(i),d=(0,a.useCallback)(function(e){return s({type:"git",data:{mode:{type:eN.GitPaneModeType.COMMIT,hash:e}}})},[s]);if((null==c?void 0:c.type)!=="assistantMessage"||!c.proposedActions)return null;if((0,eV.isKind)(r.contents.contents,"appliedFileChanges")){var f=c.proposedActions,p=f.summary,h=f.didCountEditRequest;return(0,o.jsx)(e0,(0,ew._)((0,n._)({},(0,eV.unkind)(r.contents.contents)),{sessionId:r.sessionId,eventId:t,created:r.created,onOpenCommit:d,usageIndicatorVariant:u,changeSetSummary:p,didCountEditRequest:h}))}return(0,eV.isKind)(r.contents.contents,"revertedFileChanges"),null}var e3=e.i(248011),e4=e.i(721281);e.i(242933);var e8=e.i(790164),e5=e.i(869226),e6=e.i(877249),e9=e.i(123850),e7=(0,e9.createCssVarTokens)(["opacity"]),te=e7.cssVars,tt=e7.styleTokens,tn=(0,R.cssRecord)({fade:[I.rcss.position.absolute,I.rcss.top(-1),I.rcss.left(0),I.rcss.width("100%"),I.rcss.height(40),I.rcss.backgroundGradient(L.tokens.surfaceBackground,"transparent"),{pointerEvents:"none",opacity:tt.opacity,transitionProperty:"opacity",transitionDuration:e6.TRANSITIONS.duration,transitionTimingFunction:e6.TRANSITIONS.timingFunction}]});function tr(e){var t=e.show,n=(0,a.useRef)(null);return(0,e5.useStyleSet)(n,null!=t?t:new e8.ObservableState(!0),function(e){return(0,e4._)({},te.opacity,e?"1":"0")}),(0,o.jsx)("div",{ref:n,css:tn.fade})}var ti=e.i(901708),to=(0,R.cssRecord)({bannerContainer:[I.rcss.position.sticky],loadingContainer:[I.rcss.center,I.rcss.flex.growAndShrink(1)]});function ta(e){var t=e.shouldAutoscrollRef,i=(0,r._)(e,["shouldAutoscrollRef"]),s=(0,a.useRef)(new Map),l=i.sessionId,u=(0,c.useIsScrolledDown)(),d=u.scrollerRef,p=u.isScrolledDown;return(0,o.jsxs)(ti.AutoScroller,{shouldAutoScrollRef:t,scrollCacheKey:l,scrollCache:s.current,scrollerRef:d,children:[(0,o.jsx)(A.View,{css:to.bannerContainer,children:(0,o.jsx)(f.AiUpsellChatStatus,{})}),(0,o.jsx)(ts,(0,n._)({},i)),(0,o.jsx)(tr,{show:p})]})}function ts(e){var t=e.sessionId,c=(0,r._)(e,["sessionId"]),d=(0,s.useChatter)(),f=(0,l.useObservable)(d.sessions.get(t)),g=(0,a.useMemo)(function(){return null==f?void 0:f.transform(p.default,1e3)},[f]),m=(0,u.useObservableMemo)(function(){return null==g?void 0:g.tuples},[g],{preserve:!1}),x=(0,u.useObservableMemo)(function(){return null==g?void 0:g.mapped},[g],{preserve:!1}),y=(0,l.useObservable)(null==f?void 0:f.leaf),b=(0,e3.useIsFreemiumStarterPlanUsersOwnRepl)().isFreemiumStarterPlanUsersOwnRepl?T.CheckpointUsageIndicatorVariant.Starter:T.CheckpointUsageIndicatorVariant.Paid,w=(0,h.useCreateCodeInsertObservable)();return m&&x?(0,o.jsx)(h.CodeInsertProvider,{value:w,children:m.map(function(e,t){var r=(0,i._)(e,2),a=r[0],s=r[1];return(0,o.jsx)(tl,(0,n._)({id:a,data:s,prevData:t>0?m[t-1][1]:void 0,isLastEvent:a===y,checkpointUsageIndicatorVariant:b,eventDataMap:x},c),a)})}):(0,o.jsx)(A.View,{css:to.loadingContainer,children:(0,o.jsx)(eh.default,{})})}function tl(e){var t=e.id,i=e.data,a=e.prevData,s=e.eventDataMap,u=(0,r._)(e,["id","data","prevData","eventDataMap"]),c=(0,d.default)(),f=c.secrets,p=c.fs,h=(0,l.useObservable)(i),m=(0,l.useObservable)(a);if((null==h?void 0:h.type)==="userMessage")return(0,o.jsx)(g.UserMessageEvent,{data:h,openPane:u.openPane,readFile:p.readFile});if((null==h?void 0:h.type)==="assistantMessage")return(0,o.jsx)(eB,(0,n._)({id:t,data:h,prevData:m,addSecretEntries:f.addEntries},u));if((null==h?void 0:h.type)==="assistantAction"){var x=s.get(h.eventIdWhichProposedAction);return(0,o.jsx)(e2,(0,n._)({id:t,data:h,proposedActionEventData:x},u))}return null}e.s(["ChatEvents",()=>ta],379391);var tu=e.i(596139),tc=e.i(973519),td=e.i(158689);e.i(33699);var tf=e.i(765695),tp=e.i(556088),th=e.i(993796),tg=e.i(641209),tm=e.i(988676);function tv(e){var t=e.hasAccessToAdvancedModel,n=(0,th.useFlag)({controlName:"flag-poliwag-override"}),r=(0,eF.usePreferences)("assistantAutoApplyChanges","assistantAutoRestartRepl","assistantAdvancedModelOverride"),i=r.preferences,a=r.update,s=(0,tf.useChatEngineModels)(),l=s.advancedModel,u=s.overrideModel,c=n?(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(tg.EditorSettingBox,{setting:tp.userPreferences.assistantAdvancedModelOverride,currentValue:i.assistantAdvancedModelOverride,update:a,title:(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(A.View,{row:!0,gap:8,align:"center",justify:"start",children:(0,o.jsx)(q.Text,{multiline:!1,children:"Model Override"})}),(0,o.jsx)(A.View,{row:!0,gap:8,children:(0,o.jsxs)(q.Text,{variant:"small",color:"dimmest",children:["Current: ",(null!=u?u:l).name.readable]})})]})}),(0,o.jsx)(tm.DividerH,{})]}):null;return(0,o.jsxs)(o.Fragment,{children:[c,t?(0,o.jsx)(tg.EditorSettingBox,{setting:tp.userPreferences.assistantAutoApplyChanges,update:a,currentValue:i.assistantAutoApplyChanges}):(0,o.jsx)(tg.DisabledEditorSettingBox,{setting:tp.userPreferences.assistantAutoApplyChanges,currentValueOption:void 0,disabledReason:"Advanced Assistant can automatically apply code changes."}),(0,o.jsx)(tm.DividerH,{}),t?(0,o.jsx)(tg.EditorSettingBox,{setting:tp.userPreferences.assistantAutoRestartRepl,update:a,currentValue:i.assistantAutoRestartRepl}):(0,o.jsx)(tg.DisabledEditorSettingBox,{setting:tp.userPreferences.assistantAutoRestartRepl,currentValueOption:void 0,disabledReason:"Advanced Assistant can automatically restart your App after applying changes."})]})}var tx=e.i(346715),ty=e.i(569384),tb=e.i(973245),tw=e.i(304277);e.i(566901);var tk=e.i(951262);function t_(){var e=(0,ty._)(["\n  query UserPrompts {\n    currentUser {\n      id\n      aiPrompts {\n        ... on UserAiPromptsResult {\n          prompts {\n            id\n            prompt\n            title\n          }\n        }\n      }\n    }\n  }\n"]);return t_=function(){return e},e}function tS(){var e=(0,ty._)(["\n  mutation UpdateUserAiPrompts($input: UpdateUserAiPromptsInput!) {\n    updateUserAiPrompts(input: $input) {\n      ... on AICustomPrompt {\n        id\n        prompt\n        title\n      }\n    }\n  }\n"]);return tS=function(){return e},e}function tC(){var e=(0,ty._)(["\n  mutation EditUserAiPrompt($input: EditUserAiPromptInput!) {\n    editUserAiPrompt(input: $input) {\n      ... on AICustomPrompt {\n        id\n        prompt\n        title\n      }\n    }\n  }\n"]);return tC=function(){return e},e}function tj(){var e=(0,ty._)(["\n  mutation DeleteUserAiPrompts($input: DeleteUserAiPromptsInput!) {\n    deleteUserAiPrompt(input: $input) {\n      ... on DeleteUserAiPromptResult {\n        id\n      }\n    }\n  }\n"]);return tj=function(){return e},e}function tT(){var e=(0,ty._)(["\n  query ReplSelectedPrompt($replId: String!) {\n    getRepl(id: $replId) {\n      ... on Repl {\n        id\n        replAiPromptId\n      }\n    }\n  }\n"]);return tT=function(){return e},e}function tE(){var e=(0,ty._)(["\n  mutation UpdateReplAiPromptSelection(\n    $input: UpdateReplAiPromptSelectionInput!\n  ) {\n    updateReplAiPromptSelection(input: $input) {\n      ... on UpdateReplAiPromptSelectionResult {\n        repl {\n          id\n        }\n      }\n    }\n  }\n"]);return tE=function(){return e},e}function tR(){var e=(0,ty._)(["\n  mutation DeleteReplAiPromptSelection(\n    $input: DeleteReplAiPromptSelectionInput!\n  ) {\n    deleteReplAiPromptSelection(input: $input) {\n      ... on DeleteReplAiPromptSelectionResult {\n        repl {\n          id\n        }\n      }\n    }\n  }\n"]);return tR=function(){return e},e}var tI={},tA=(0,tb.gql)(t_()),tP=(0,tb.gql)(tS()),tD=(0,tb.gql)(tC()),tO=(0,tb.gql)(tj()),tN=(0,tb.gql)(tT()),tM=(0,tb.gql)(tE()),tL=(0,tb.gql)(tR()),tB=e.i(593583),tV=e.i(607278),tF=(0,R.cssRecord)({input:[I.rcss.maxHeight("200px"),{resize:"vertical",overflow:"auto"}],buttonContainer:[I.rcss.width("100%"),I.rcss.rowWithGap(6),I.rcss.justify.end,I.rcss.pt(4)]});function tU(e){var t,r,s=e.refetchPrompts,l=e.onClose,u=(0,i._)((0,a.useState)(""),2),c=u[0],d=u[1],f=(0,i._)((0,a.useState)(""),2),p=f[0],h=f[1],g=(0,i._)((0,a.useState)(!1),2),y=g[0],b=g[1],w=(0,i._)((t={onCompleted:function(){(0,eG.track)(e$.events.ASSISTANT_USED,{action:"custom_prompt_saved",title:p,prompt:c}),S(),s(),l(),b(!1)},onError:function(){b(!0)}},r=(0,n._)({},tI,t),tk.useMutation(tP,r)),2),k=w[0],_=w[1].loading,S=function(){d(""),h("")},C=_||!c||!p;return(0,o.jsxs)(A.View,{py:4,gap:8,children:[y?(0,o.jsx)(eR.StatusBanner,{icon:(0,o.jsx)(eJ.default,{}),colorway:"red",text:"Could not save prompt. Try again."}):null,(0,o.jsx)(tB.Form,{onSubmit:function(e){e.preventDefault(),(0,m._)(function(){var e,t;return(0,x._)(this,function(n){switch(n.label){case 0:if(e=c.trim(),t=p.trim(),!e||!t)return[2];return[4,k({variables:{input:{prompt:e,title:t}}})];case 1:return n.sent(),[2]}})})()},children:(0,o.jsxs)(A.View,{gap:4,children:[(0,o.jsxs)(A.View,{row:!0,gap:6,align:"center",children:[(0,o.jsx)(q.Text,{children:"Title"}),(0,o.jsx)(q.Text,{variant:"small",color:"dimmer",children:"(max 70 characters)"})]}),(0,o.jsx)(tV.Input,{disabled:_,value:p,onChange:function(e){var t=e.target.value;t.length<=70&&h(t)}}),(0,o.jsx)(q.Text,{children:"Prompt"}),(0,o.jsx)(tV.MultiLineInput,{disabled:_,value:c,onChange:function(e){var t=e.target.value;t.length<=15e3&&d(t)},css:tF.input,autoSize:!0}),(0,o.jsxs)(A.View,{css:tF.buttonContainer,children:[(0,o.jsx)(ed.Button,{colorway:"primary",text:"Save",type:"submit",disabled:C,loading:_}),(0,o.jsx)(ed.Button,{text:"Cancel",onClick:function(){l(),b(!1)}})]})]})})]})}var tG=e.i(965153),t$=e.i(887877),tz=e.i(952030),tH=(0,R.cssRecord)({input:[I.rcss.maxHeight("200px"),{resize:"vertical",overflow:"auto"}],buttonContainer:[I.rcss.width("100%"),I.rcss.rowWithGap(6),I.rcss.justify.end],form:[I.rcss.colWithGap(6)],promptItem:[I.rcss.borderRadius(),I.rcss.py(6),I.rcss.px(8)]});function tW(e){var t,r,s,l,u=e.isOpen,c=e.prompts,d=e.promptDataLoading,f=e.onClose,p=e.refetchPrompts,h=(0,i._)((0,a.useState)(!1),2),g=h[0],y=h[1],b=(0,i._)((0,a.useState)(c||[]),2),w=b[0],k=b[1],_=(0,i._)((0,a.useState)(new Set),2),S=_[0],C=_[1],j=(0,i._)((t={onCompleted:function(){p()}},r=(0,n._)({},tI,t),tk.useMutation(tO,r)),2),T=j[0],E=j[1].loading,R=(0,i._)((s={onCompleted:function(){p()}},l=(0,n._)({},tI,s),tk.useMutation(tD,l)),2),I=R[0],P=R[1].loading;(0,a.useEffect)(function(){c&&k(function(e){return c.map(function(t){return S.has(t.id)&&e.find(function(e){return e.id===t.id})||t})})},[c,S]);var D=function(e,t,r){k(function(i){return i.map(function(i){return i.id===e?(0,ew._)((0,n._)({},i),(0,e4._)({},t,r)):i})}),C(function(t){return new Set(t).add(e)})},O=function(e){k(function(t){return t.map(function(t){return t.id===e&&c&&c.find(function(t){return t.id===e})||t})}),C(function(t){var n=new Set(t);return n.delete(e),n})};return(0,o.jsxs)(ef.Modal,{isOpen:u,onRequestClose:function(){f(),y(!1)},children:[(0,o.jsx)(q.Text,{variant:"subheadBig",children:"Manage Prompts"}),c?(0,o.jsxs)(A.View,{py:8,gap:4,children:[(0,tx._)(w).sort(function(e,t){return e.title.localeCompare(t.title,void 0,{sensitivity:"base"})}).map(function(e){return(0,o.jsx)(tG.AccordionItem,{headerContent:(0,o.jsx)(q.Text,{children:e.title}),children:(0,o.jsx)(eW.Surface,{elevated:!0,css:tH.promptItem,children:(0,o.jsxs)(t$.Form,{css:tH.form,onSubmit:function(t){var n;t.preventDefault(),n=e.id,(0,m._)(function(){var e;return(0,x._)(this,function(t){switch(t.label){case 0:if(!(null==(e=w.find(function(e){return e.id===n}))?void 0:e.title)||!(null==e?void 0:e.prompt))return[2];return[4,I({variables:{input:{promptId:e.id,prompt:e.prompt,title:e.title}}})];case 1:return t.sent(),C(function(e){var t=new Set(e);return t.delete(n),t}),[2]}})})()},children:[(0,o.jsxs)(A.View,{row:!0,gap:6,align:"center",children:[(0,o.jsx)(q.Text,{children:"Title"}),(0,o.jsx)(q.Text,{variant:"small",color:"dimmer",children:"(max 70 characters)"})]}),(0,o.jsx)(tV.Input,{disabled:P,value:e.title,onChange:function(t){return D(e.id,"title",t.target.value)}}),(0,o.jsx)(q.Text,{children:"Prompt"}),(0,o.jsx)(tV.MultiLineInput,{disabled:P,value:e.prompt,onChange:function(t){return D(e.id,"prompt",t.target.value)},css:tH.input,autoSize:!0}),(0,o.jsxs)(A.View,{css:tH.buttonContainer,children:[(0,o.jsx)(ed.Button,{colorway:"red",text:"Delete",onClick:function(){var t;return t=e.id,(0,m._)(function(){return(0,x._)(this,function(e){return T({variables:{input:{promptId:t}}}),[2]})})()},disabled:E}),(0,o.jsx)(ed.Button,{colorway:"primary",text:"Save",type:"submit",disabled:!S.has(e.id)||P||!e.title||!e.prompt}),(0,o.jsx)(ed.Button,{text:"Reset",onClick:function(){return O(e.id)},disabled:!S.has(e.id)})]})]})})},e.id)}),d?(0,o.jsxs)(A.View,{py:4,row:!0,gap:6,align:"center",children:[(0,o.jsx)(eh.default,{size:16}),(0,o.jsx)(q.Text,{variant:"small",color:"dimmer",children:"Updating prompts"})]}):null]}):null,(0,o.jsx)(A.View,{py:4,gap:8,children:g?(0,o.jsx)(tU,{refetchPrompts:p,onClose:function(){return y(!1)}}):(0,o.jsx)(ed.Button,{text:"Add new prompt",iconLeft:(0,o.jsx)(tz.default,{}),colorway:"primary",onClick:function(){return y(!0)}})})]})}var tq=e.i(6338),tK=e.i(136540),tY=e.i(85742),tQ=e.i(12034),tX=e.i(357399),tJ="default",tZ={id:tJ,prompt:"".concat(G.ASSISTANT_NAME," will operate using its default behavior."),title:"Default"},t0=(0,R.cssRecord)({select:[I.rcss.flex.growAndShrink(1),{"& button":{height:"auto",minHeight:"32px"},"& button > span > div > span":{textAlign:"justify"}}],selectContainer:[I.rcss.width("100%"),I.rcss.align.center],loadingContainer:[I.rcss.borderRadius(),I.rcss.mr(24),I.rcss.gap(6)],loadingPrompt:[I.rcss.width("fit-content"),I.rcss.px(4),tq.loadingStyle.foregroundPulse(),{color:"transparent"}]});function t1(){var e,t,r,s,l,u,c,d,f,p,h,g=(0,i._)((0,a.useState)(!1),2),y=g[0],b=g[1],k=(0,w.default)(),_=(e={notifyOnNetworkStatusChange:!0},t=(0,n._)({},tI,e),tw.useQuery(tA,t)),S=_.data,C=_.loading,j=_.refetch,T=(r={variables:{replId:k}},s=(0,n._)({},tI,r),tw.useQuery(tN,s)),E=T.data,R=T.refetch,I=(0,i._)((l={onCompleted:function(){R()}},u=(0,n._)({},tI,l),tk.useMutation(tM,u)),1)[0],P=(0,i._)((c={update:function(e,t){var n,r=t.data;(null==r||null==(n=r.deleteReplAiPromptSelection)?void 0:n.__typename)==="DeleteReplAiPromptSelectionResult"&&r.deleteReplAiPromptSelection.repl.id&&e.modify({id:e.identify({__typename:"Repl",id:k}),fields:{replAiPromptId:function(){}}})}},d=(0,n._)({},tI,c),tk.useMutation(tL,d)),1)[0],D=S&&(null==(f=S.currentUser)?void 0:f.aiPrompts.__typename)==="UserAiPromptsResult"?null==(p=S.currentUser)?void 0:p.aiPrompts.prompts:[],O=(null==E?void 0:E.getRepl.__typename)==="Repl"?E.getRepl.replAiPromptId:void 0;return(0,o.jsxs)(A.View,{gap:4,children:[(0,o.jsxs)(q.Text,{multiline:!1,children:[G.ASSISTANT_NAME," Prompt"]}),(0,o.jsxs)(q.Text,{variant:"small",color:"dimmest",children:["Personalize your ",G.ASSISTANT_NAME," with custom rules & instructions"]}),C?(0,o.jsxs)(eW.Surface,{css:t0.loadingContainer,px:8,py:8,elevated:!0,children:[(0,o.jsx)(q.Text,{css:t0.loadingPrompt,children:"Sample prompt title"}),(0,o.jsx)(q.Text,{variant:"small",css:t0.loadingPrompt,children:"Sample prompt contents. These are rules & instructions for Assistant behavior."})]}):(0,o.jsxs)(A.View,{css:t0.selectContainer,row:!0,gap:4,children:[(0,o.jsx)(tQ.Select,{"aria-label":"Assistant Custom Prompt",style:{marginRight:0},items:[tZ].concat((0,tx._)(D)),defaultSelectedKey:(null==(h=D.find(function(e){return O===e.id}))?void 0:h.id)||tJ,onSelectionChange:function(e){var t,n;n=(null==(t=D.find(function(t){return t.id===e}))?void 0:t.id)||tJ,(0,m._)(function(){var e,t,r;return(0,x._)(this,function(i){switch(i.label){case 0:if(n!==tJ)return[3,3];if(!O)return[3,2];return[4,P({variables:{input:{replId:k,promptId:O}}})];case 1:i.sent(),i.label=2;case 2:return[2];case 3:return[4,I({variables:{input:{promptId:n,replId:k}}})];case 4:return(null==(t=i.sent().data)||null==(e=t.updateReplAiPromptSelection)?void 0:e.__typename)==="UpdateReplAiPromptSelectionResult"&&(r=D.find(function(e){return e.id===n}),(0,eG.track)(e$.events.ASSISTANT_USED,{action:"custom_prompt_selected",title:null==r?void 0:r.title,prompt:null==r?void 0:r.prompt})),[2]}})})()},css:t0.select,children:function(e){return(0,o.jsx)(tY.ListBoxItem,{id:e.id,label:e.title,description:e.prompt,dataCy:e.id},e.id)}}),(0,o.jsx)(tK.IconButton,{alt:"Manage prompts",onClick:function(){return b(!0)},children:(0,o.jsx)(tX.default,{})})]}),(0,o.jsx)(tW,{isOpen:y,prompts:D,promptDataLoading:C,onClose:function(){b(!1)},refetchPrompts:j})]})}var t2=e.i(968783),t3=e.i(341126),t4=e.i(672963),t8=(0,e9.createCssVarTokens)(["fontSize","padding","border"]),t5=t8.cssVars,t6=t8.styleTokens,t9=(0,R.cssRecord)({root:[I.rcss.center,I.rcss.flex.growAndShrink(1)],input:[{backgroundColor:"transparent",border:t6.border,fontSize:t6.fontSize,padding:t6.padding},I.rcss.flex.growAndShrink(1)]});function t7(e){var t,n,r=(0,i._)((0,a.useState)(e.initialValue),2),s=r[0],l=r[1],u=(0,z.default)(e.onCancel),c=(0,t4.default)(function(){return u.current()},[]),d=(0,a.useRef)(null);(0,a.useEffect)(function(){var e;null==(e=d.current)||e.select()},[]);var f=e.compact?(t={},(0,e4._)(t,t5.border,"0 none"),(0,e4._)(t,t5.fontSize,L.tokens.fontSizeSmall),(0,e4._)(t,t5.padding,"0 ".concat(L.tokens.space2)),t):(n={},(0,e4._)(n,t5.padding,"".concat(L.tokens.space8)),(0,e4._)(n,t5.fontSize,L.tokens.fontSizeDefault),n);return(0,o.jsx)(A.View,{style:f,innerRef:c,css:t9.root,row:!0,gap:4,tag:"form",onSubmit:function(t){t.preventDefault(),s&&e.onSubmit(s)},children:(0,o.jsx)(tV.Input,{placeholder:"Name this chat",ref:d,css:t9.input,value:s,onChange:function(e){return l(e.currentTarget.value)},onKeyDown:function(t){"Escape"===t.key&&e.onCancel()}})})}e.s(["EditTitle",()=>t7],667625);var ne=e.i(848969),nt=e.i(601059),nn=e.i(644826),nr=e.i(883002);function ni(e){var t,n=(0,i._)((0,a.useState)(!1),2),r=n[0],s=n[1];return r?(0,o.jsx)(t7,{compact:!0,initialValue:null!=(t=e.title)?t:"",onCancel:function(){return s(!1)},onSubmit:function(t){s(!1),e.onRename(t)}}):(0,o.jsx)(na,{title:e.title,archived:e.archived,onRename:function(){return s(!0)},onToggleArchived:e.onToggleArchived})}var no=(0,R.cssRecord)({root:[{maxWidth:"100%"}]});function na(e){var t,n=(0,i._)((0,a.useState)(!1),2),r=n[0],s=n[1];return(0,o.jsx)(A.View,{css:no.root,grow:!0,shrink:!0,children:(0,o.jsxs)(nt.PopupMenu,{"aria-label":"Chat options",trigger:(0,o.jsx)(ed.Button,{variant:"nofill",size:"small",text:null!=(t=e.title)?t:"New chat",iconRight:(0,o.jsx)(nn.default,{rotate:180*!!r,size:12})}),onAction:function(t){switch(t){case"rename":e.onRename();break;case"archive":case"unarchive":e.onToggleArchived()}},isOpen:r,onOpenChange:s,placement:"bottom",children:[(0,o.jsx)(nt.MenuItem,{id:"rename",label:"Rename"}),(0,o.jsx)(nt.MenuItem,{id:e.archived?"unarchive":"archive",label:e.archived?"Unarchive":"Archive"})]})})}function ns(e){return(0,o.jsx)(tK.IconButton,{alt:"Settings",onClick:e.onClick,children:(0,o.jsx)(tX.default,{})})}function nl(e){var t=e.sessionCostInCents,n=(0,t2.useCurrentUserStoredOrgContext)(),r=n.orgId,i=n.orgSlug,a=r&&i?"".concat((0,t3.orgLinks)({slug:i}).usage.href,"#agent"):"/usage#agent";return(0,o.jsx)(ne.IconButtonLink,{alt:t?"Your usage for this chat: $".concat((t/100).toFixed(2)):"Usage Page",href:a,target:"_blank",onClick:function(){(0,eG.track)(e$.events.ASSISTANT_USED,{action:"opened_usage_link",intent_type:null,model:null,user_model_selection:null,message_content:null,message_source:"chat_pane",message_surface:"workspace_ai_pane"})},children:(0,o.jsx)(V.default,{})})}var nu=(0,R.cssRecord)({root:[I.rcss.height(28),I.rcss.rowWithGap(4),I.rcss.px(2),I.rcss.justify.spaceBetween,I.rcss.align.center],center:[],right:[I.rcss.rowWithGap(0)]});function nc(e){var t=e.onSidebarButtonClick,n=e.onAddButtonClick,r=e.title,i=e.prefsButton,a=e.usageButton,s=e.sessionCost;return(0,o.jsxs)(A.View,{align:"center",row:!0,gap:0,children:[(0,o.jsx)(A.View,{children:(0,o.jsx)(tK.IconButton,{alt:"All chats",onClick:t,children:(0,o.jsx)(nr.default,{})})}),(0,o.jsx)(ed.Button,{iconLeft:(0,o.jsx)(tz.default,{}),text:"New chat",size:"small",variant:"nofill",onClick:n}),(0,o.jsx)(A.View,{grow:!0,shrink:!0,align:"center",children:r}),(0,o.jsxs)(A.View,{row:!0,gap:4,align:"center",children:[s,a,i]})]})}e.s(["Header",()=>nc,"PrefsButton",()=>ns,"Title",()=>ni,"UsageButtonLink",()=>nl,"css",()=>nu],71600);var nd=e.i(549762),nf=(0,R.cssRecord)({container:[I.rcss.flex.column,I.rcss.position.relative],body:[I.rcss.overflowY("auto")],footer:[I.rcss.minHeight(40),I.rcss.flex.row,I.rcss.align.center],settingsPaneButton:[I.rcss.display.inlineFlex,I.rcss.mx(4),{verticalAlign:"bottom",gap:L.tokens.space4}],heading:[I.rcss.fontWeight.medium],upgradePill:[eH.interactive.filled,(t={},(0,e4._)(t,L.properties.interactiveBackground,L.tokens.yellowDimmest),(0,e4._)(t,L.properties.interactiveBackgroundActive,L.tokens.yellowDimmer),t)]});function np(e){var t=e.hasAccessToAdvancedModel,n=e.onOpenUserSettings,r=(0,tc.useGlobalModal)().show;return(0,o.jsxs)(eW.Surface,{css:nf.container,grow:!0,shrink:!0,background:"default",children:[(0,o.jsxs)(A.View,{css:nf.body,grow:!0,shrink:!0,py:8,px:16,gap:8,children:[(0,o.jsx)(tm.DividerH,{}),(0,o.jsx)(t1,{}),(0,o.jsx)(tm.DividerH,{}),(0,o.jsxs)(A.View,{row:!0,gap:4,align:"center",children:[(0,o.jsx)(q.Text,{css:nf.heading,variant:"text",children:"Advanced ".concat(G.ASSISTANT_NAME," Preferences")}),t?null:(0,o.jsx)(td.Pill,{css:nf.upgradePill,text:tu.corePlanName,onClick:function(){return(0,m._)(function(){return(0,x._)(this,function(e){switch(e.label){case 0:return[4,r("MembershipPurchaseModal",{analyticsContext:{upgrade:{context:"ai_chat_upsell",surface:"assistant_settings"}}})];case 1:return e.sent(),[2]}})})()}})]}),(0,o.jsx)(tv,{hasAccessToAdvancedModel:t}),(0,o.jsx)(tm.DividerH,{})]}),(0,o.jsx)(tm.DividerH,{}),(0,o.jsx)(A.View,{css:nf.footer,py:8,px:16,children:(0,o.jsxs)(q.Text,{variant:"small",children:["Looking for more workspace settings?"," ",(0,o.jsx)(ed.Button,{css:nf.settingsPaneButton,iconLeft:(0,o.jsx)(tX.default,{}),size:"small",variant:"underlined",text:"Open User Settings",onClick:n})]})})]})}function nh(e){var t=e.onBack;return(0,o.jsx)(A.View,{css:nu.root,children:(0,o.jsxs)(A.View,{row:!0,align:"center",children:[(0,o.jsx)(tK.IconButton,{onClick:t,alt:"Back to session",children:(0,o.jsx)(nd.default,{})}),(0,o.jsx)(q.Text,{children:"Settings"})]})})}function ng(e){var t=e.text,i=(0,r._)(e,["text"]),s=(0,a.useRef)(null),l=(0,a.useRef)(t);return(0,a.useEffect)(function(){if(l.current!==t){var e=t.length;!function n(){var r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;requestAnimationFrame(function(){var i=s.current;i&&(i.textContent=t.slice(0,r),r!==e&&n(r+1))})}()}},[t]),(0,a.useEffect)(function(){l.current=t},[t]),(0,o.jsx)(q.Text,(0,ew._)((0,n._)({},i),{ref:s,children:t}))}e.s(["ChatPreferencesHeader",()=>nh,"ChatPreferencesPanel",()=>np],863002),e.s(["AnimatedText",()=>ng],43817)},374463,(e,t,n)=>{"use strict";t.exports=function(){}},760740,864667,e=>{"use strict";var t,n,r,i,o,a,s,l=e.i(276385),u=e.i(721281),c=e.i(878420),d=e.i(64386),f=e.i(530658),p=e.i(389959),h=e.i(790486),g=e.i(122648);e.i(877212);var m=e.i(924908);e.i(925218);var x=e.i(267103),y=e.i(43817),b=e.i(667625),w=e.i(480028),k=e.i(446530),_=e.i(754873),S=e.i(123850),C=e.i(613355),j=e.i(886513),T=e.i(486597),E=e.i(342942),R=e.i(918542),I=e.i(545150),A=e.i(374463),P=function(){return(P=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};function D(e,t){switch(t.type){case a.REGISTER_TAB_STOP:var n=t.payload;if(!n.domElementRef.current)return e;for(var r=-1,s=e.tabStops.length-1;s>=0;--s){var l=e.tabStops[s];if(l.id===n.id)return(0,A.default)(!1,"'".concat(n.id,"' tab stop already registered")),e;if(-1===r&&l.domElementRef.current&&4&l.domElementRef.current.compareDocumentPosition(n.domElementRef.current)){r=s+1;break}}-1===r&&(r=0);var u=e.tabStops.slice();return u.splice(r,0,n),P(P({},e),{selectedId:M(u,e.selectedId),tabStops:u,rowStartMap:null});case a.UNREGISTER_TAB_STOP:var c=t.payload.id,u=e.tabStops.filter(function(e){return e.id!==c});if(u.length===e.tabStops.length)return(0,A.default)(!1,"'".concat(c,"' tab stop already unregistered")),e;return P(P({},e),{selectedId:M(u,e.selectedId),tabStops:u,rowStartMap:null});case a.TAB_STOP_UPDATED:var d=t.payload,f=d.id,p=d.rowIndex,h=d.disabled,g=e.tabStops.findIndex(function(e){return e.id===f});if(-1===g)return(0,A.default)(!1,"'".concat(f,"' tab stop not registered")),e;var m=e.tabStops[g];if(m.disabled===h&&m.rowIndex===p)return e;var n=P(P({},m),{rowIndex:p,disabled:h}),u=e.tabStops.slice();return u.splice(g,1,n),P(P({},e),{selectedId:M(u,e.selectedId),tabStops:u,rowStartMap:null});case a.KEY_DOWN:var x=t.payload,y=x.id,b=x.key,w=x.ctrlKey,g=e.tabStops.findIndex(function(e){return e.id===y});if(-1===g)return(0,A.default)(!1,"'".concat(y,"' tab stop not registered")),e;var k=e.tabStops[g];if(k.disabled)return e;var _=null!==k.rowIndex,S=g===O(e.tabStops),C=g===N(e.tabStops),j=function(e,t,n,r,a,s,l){switch(e){case i.ArrowLeft:if(n||"horizontal"===r||"both"===r)return!n&&a&&s?o.VERY_LAST:o.PREVIOUS;return null;case i.ArrowRight:if(n||"horizontal"===r||"both"===r)return!n&&a&&l?o.VERY_FIRST:o.NEXT;return null;case i.ArrowUp:if(n)return o.PREVIOUS_ROW;if("vertical"===r||"both"===r)return a&&s?o.VERY_LAST:o.PREVIOUS;return null;case i.ArrowDown:if(n)return o.NEXT_ROW;if("vertical"===r||"both"===r)return a&&l?o.VERY_FIRST:o.NEXT;return null;case i.Home:return!n||t?o.VERY_FIRST:o.FIRST_IN_ROW;case i.End:return!n||t?o.VERY_LAST:o.LAST_IN_ROW;default:return null}}(b,w,_,e.direction,e.loopAround,S,C);if(!j)return e;switch(j){case o.NEXT:for(var s=g+1;s<e.tabStops.length;++s){var m=e.tabStops[s];if(_&&m.rowIndex!==k.rowIndex)break;if(!m.disabled)return L(e,m)}break;case o.PREVIOUS:for(var s=g-1;s>=0;--s){var m=e.tabStops[s];if(_&&m.rowIndex!==k.rowIndex)break;if(!m.disabled)return L(e,m)}break;case o.VERY_FIRST:var T=O(e.tabStops);if(T>-1)return L(e,e.tabStops[T]);break;case o.VERY_LAST:var E=N(e.tabStops);if(E>-1)return L(e,e.tabStops[E]);break;case o.PREVIOUS_ROW:if(null===k.rowIndex||0===k.rowIndex)break;var R=e.rowStartMap||B(e),I=R.get(k.rowIndex);if(void 0===I)break;for(var D=g-I,s=k.rowIndex-1;s>=0;--s){var V=R.get(s);if(void 0===V)return e;var F=e.tabStops[V+D];if(F&&!F.disabled)return L(e,F,R)}return P(P({},e),{allowFocusing:!0,rowStartMap:R});case o.NEXT_ROW:var U=e.tabStops[e.tabStops.length-1].rowIndex;if(null===k.rowIndex||null===U||k.rowIndex===U)break;var R=e.rowStartMap||B(e),I=R.get(k.rowIndex);if(void 0===I)break;for(var D=g-I,s=k.rowIndex+1;s<=U;++s){var G=R.get(s);if(void 0===G)return e;var F=e.tabStops[G+D];if(F&&!F.disabled)return L(e,F,R)}return P(P({},e),{allowFocusing:!0,rowStartMap:R});case o.FIRST_IN_ROW:if(null===k.rowIndex)break;var R=e.rowStartMap||B(e),I=R.get(k.rowIndex);if(void 0===I)break;for(var s=I;s<e.tabStops.length;++s){var m=e.tabStops[s];if(m.rowIndex!==k.rowIndex)break;if(!m.disabled)return L(e,e.tabStops[s],R)}break;case o.LAST_IN_ROW:if(null===k.rowIndex)break;for(var R=e.rowStartMap||B(e),$=R.has(k.rowIndex+1)?(R.get(k.rowIndex+1)||0)-1:e.tabStops.length-1,s=$;s>=0;--s){var m=e.tabStops[s];if(m.rowIndex!==k.rowIndex)break;if(!m.disabled)return L(e,e.tabStops[s],R)}}return e;case a.CLICKED:var z=t.payload.id,g=e.tabStops.findIndex(function(e){return e.id===z});if(-1===g)return(0,A.default)(!1,"'".concat(z,"' tab stop not registered")),e;var k=e.tabStops[g];return k.disabled?e:L(e,k,void 0,e.focusOnClick);case a.OPTIONS_UPDATED:return P(P({},e),t.payload);default:return e}}function O(e){return e.findIndex(function(e){return!e.disabled})}function N(e){for(var t=e.length-1;t>=0;--t)if(!e[t].disabled)return t;return -1}function M(e,t){if(null===t){var n=e.findIndex(function(e){return!e.disabled});return -1===n?null:e[n].id}var r=e.findIndex(function(e){return e.id===t});return -1===r||e[r].disabled?-1===(r=e.findIndex(function(e){return!e.disabled}))?null:e[r].id:t}function L(e,t,n,r){return void 0===r&&(r=!0),P(P({},e),{allowFocusing:r,selectedId:t.id,rowStartMap:n||e.rowStartMap})}function B(e){for(var t=new Map,n=0;n<e.tabStops.length;++n){var r=e.tabStops[n].rowIndex;null===r||t.has(r)||t.set(r,n)}return t}(t=i||(i={})).ArrowLeft="ArrowLeft",t.ArrowRight="ArrowRight",t.ArrowUp="ArrowUp",t.ArrowDown="ArrowDown",t.Home="Home",t.End="End",(n=o||(o={})).PREVIOUS="PREVIOUS",n.NEXT="NEXT",n.VERY_FIRST="VERY_FIRST",n.VERY_LAST="VERY_LAST",n.PREVIOUS_ROW="PREVIOUS_ROW",n.NEXT_ROW="NEXT_ROW",n.FIRST_IN_ROW="FIRST_IN_ROW",n.LAST_IN_ROW="LAST_IN_ROW",(r=a||(a={})).REGISTER_TAB_STOP="REGISTER_TAB_STOP",r.UNREGISTER_TAB_STOP="UNREGISTER_TAB_STOP",r.KEY_DOWN="KEY_DOWN",r.CLICKED="CLICKED",r.TAB_STOP_UPDATED="TAB_STOP_UPDATED",r.OPTIONS_UPDATED="OPTIONS_UPDATED";var V={selectedId:null,allowFocusing:!1,tabStops:[],direction:"horizontal",focusOnClick:!1,loopAround:!1,rowStartMap:null},F=(0,p.createContext)({state:V,dispatch:function(){}}),U=function(e){var t=e.children,n=e.options,r=(0,p.useReducer)(D,P(P({},V),n)),i=r[0],o=r[1];(0,p.useEffect)(function(){var e,t,r;o({type:a.OPTIONS_UPDATED,payload:{direction:null!=(e=null==n?void 0:n.direction)?e:V.direction,focusOnClick:null!=(t=null==n?void 0:n.focusOnClick)?t:V.focusOnClick,loopAround:null!=(r=null==n?void 0:n.loopAround)?r:V.loopAround}})},[null==n?void 0:n.direction,null==n?void 0:n.focusOnClick,null==n?void 0:n.loopAround]);var s=(0,p.useMemo)(function(){return{state:i,dispatch:o}},[i]);return p.default.createElement(F.Provider,{value:s},t)},G=0;function $(e,t,n){void 0===n&&(n=null);var r=(0,p.useRef)(null);function o(){return r.current||(r.current="rti_".concat(++G)),r.current}var s=(0,p.useRef)(!1),l=(0,p.useContext)(F);(0,p.useEffect)(function(){var r=o();return l.dispatch({type:a.REGISTER_TAB_STOP,payload:{id:r,domElementRef:e,rowIndex:n,disabled:t}}),function(){l.dispatch({type:a.UNREGISTER_TAB_STOP,payload:{id:r}})}},[]),(0,p.useEffect)(function(){s.current?l.dispatch({type:a.TAB_STOP_UPDATED,payload:{id:o(),rowIndex:n,disabled:t}}):s.current=!0},[n,t]);var u=(0,p.useCallback)(function(e){var t=i[e.key];t&&(l.dispatch({type:a.KEY_DOWN,payload:{id:o(),key:t,ctrlKey:e.ctrlKey}}),e.preventDefault())},[]),c=(0,p.useCallback)(function(){l.dispatch({type:a.CLICKED,payload:{id:o()}})},[]),d=o()===l.state.selectedId,f=d&&l.state.allowFocusing;return[d?0:-1,f,u,c]}function z(e,t){(0,p.useEffect)(function(){e&&t.current&&t.current.focus()},[e])}e.s(["RovingTabIndexProvider",()=>U,"useFocusEffect",()=>z,"useRovingTabIndex",()=>$],864667);var H=e.i(343252),W=e.i(929872),q=e.i(960178),K=e.i(625484),Y=function(){var e=(0,f._)((0,p.useState)(!1),2),t=e[0],n=e[1],r=(0,f._)((0,p.useState)({x:0,y:0}),2);return{clicked:t,setClicked:n,points:r[0],setPoints:r[1]}},Q=function(){var e=Y(),t=e.clicked,n=e.setClicked,r=e.points,i=e.setPoints;(0,p.useEffect)(function(){var e=function(){return n(!1)};return document.addEventListener("click",e),function(){document.removeEventListener("click",e)}},[n]);var o=(0,p.useCallback)(function(e){var t=e.x,r=e.y;n(!0),i({x:t,y:r})},[n,i]),a=(0,p.useCallback)(function(e){e.preventDefault(),e.stopPropagation(),o({x:e.clientX,y:e.clientY})},[o]),s=(0,p.useCallback)(function(){n(!1)},[n]);return{triggerProps:{onContextMenu:a},menuProps:(0,d._)((0,c._)({},r),{isOpen:t}),onClose:s,open:o}},X=(0,k.cssRecord)({menu:[C.rcss.position.fixed,C.rcss.flex.column,C.rcss.borderRadius(8),C.rcss.shadow(1),{"& > :first-child":[C.rcss.borderRadius(8,8,0,0)],"& > :last-child":[C.rcss.borderRadius(0,0,8,8)]}],item:[C.rcss.reset.button,{'&:not([disabled]):not([aria-disabled="true"])':[_.interactive.listItem],'&[disabled], &[aria-disabled="true"]':[C.rcss.color.foregroundDimmest]},C.rcss.p(8),C.rcss.rowWithGap(8),C.rcss.align.center],underlay:[C.rcss.position.fixed,{top:0,left:0,bottom:0,right:0}]}),J=function(e){e.preventDefault()},Z=function(e){var t=e.children,n=e.isOpen,r=e.defaultOpen,i=e.onOpenChange,o=e.x,a=e.y,s=(0,j._)(e,["children","isOpen","defaultOpen","onOpenChange","x","y"]),u=(0,T.useOverlayTriggerState)({isOpen:n,defaultOpen:r,onOpenChange:i}),f=(0,p.useRef)(null),h=(0,R.useModalOverlay)({},u,f),g=h.modalProps,m=h.underlayProps;return n?(0,l.jsx)(E.Overlay,{portalContainer:document.body,children:(0,l.jsx)("div",(0,d._)((0,c._)({css:X.underlay},m),{onContextMenu:J,children:(0,l.jsx)(I.default,{children:(0,l.jsx)(W.Surface,(0,d._)((0,c._)({elevated:!0,css:X.menu},g,s),{innerRef:f,tag:"ul",role:"menubar","aria-orientation":"vertical","aria-label":"Context",style:{left:o,top:a},children:(0,l.jsx)(U,{options:{direction:"vertical"},children:t})}))})}))}):null},ee=K.SpecializedView.button,et=(0,p.forwardRef)(function(e,t){var n=e.children,r=e.iconLeft,i=e.isDisabled,o=void 0!==i&&i,a=e.onClick,s=(0,j._)(e,["children","iconLeft","isDisabled","onClick"]),u=(0,p.useRef)(null),h=(0,f._)($(u,o),4),g=h[0],m=h[1],x=h[2],y=h[3];z(m,u);var b=(0,p.useCallback)(function(e){o||(y(),null==a||a(e))},[y,o,a]),w=(0,H.useMergeRefs)([t,u]);return(0,l.jsxs)(ee,(0,d._)((0,c._)({disabled:o,css:X.item,role:"menuitem",ref:w,tabIndex:g,onKeyDown:x,onClick:b},s),{children:[r,(0,l.jsx)(q.Text,{multiline:!1,children:n})]}))}),en=e.i(136540),er=e.i(257811),ei=e.i(940745),eo=e.i(196353),ea=(0,S.createCssVarTokens)(["sessionBackground","actionsButtonDisplay"]),es=ea.cssVars,el=ea.styleTokens,eu=(0,k.cssRecord)({loading:[C.rcss.coverContainer,C.rcss.center],tabs:[C.rcss.height("100%")],tabsInner:[C.rcss.height("100%")],tabPanel:[C.rcss.height("100%")],tabContent:[C.rcss.position.relative,C.rcss.height("100%"),C.rcss.flex.growAndShrink(1)],tabListLeft:[C.rcss.viewStyle,C.rcss.rowWithGap(2)],tab:[C.rcss.viewStyle,_.interactive.nofill,C.rcss.px(8),C.rcss.height(30),C.rcss.justify.center,C.rcss.borderRadius(4),{"&[data-selected]":{backgroundColor:w.tokens.interactiveBackgroundActive}}],sessions:[C.rcss.position.absolute,C.rcss.overflow("hidden"),C.rcss.px(8),{top:0,left:0,right:0,bottom:0}],session:[C.rcss.px(6),C.rcss.py(4),C.rcss.border({direction:"bottom"}),_.interactive.listItem,C.rcss.borderRadius(),(s={backgroundColor:el.sessionBackground},(0,u._)(s,C.media.canHover,(0,u._)({},es.actionsButtonDisplay,"none")),(0,u._)(s,"&:hover",(0,u._)({},es.actionsButtonDisplay,"block")),s)],emptyState:[C.rcss.center,C.rcss.p(16)],header:[C.rcss.rowWithGap(4),C.rcss.height(24),C.rcss.align.center],title:[C.rcss.flex.growAndShrink(1)],actionsButton:[{opacity:.5,display:el.actionsButtonDisplay,"&:hover":{opacity:1}}],sessionListWrapper:[{overflow:"auto"},C.rcss.flex.growAndShrink(1)],sessionListInner:[C.rcss.position.relative],sessionListItem:[C.rcss.position.absolute,C.rcss.top(0),C.rcss.left(0),C.rcss.width("100%")]});function ec(e){var t=e.onClick;return(0,l.jsxs)(K.View,{style:(0,u._)({},es.sessionBackground,w.tokens.accentPrimaryDimmest),css:eu.session,onClick:t,children:[(0,l.jsx)(K.View,{css:eu.header,children:(0,l.jsx)(K.View,{css:eu.title,children:(0,l.jsx)(q.Text,{multiline:!1,children:"New Chat"})})}),(0,l.jsx)(q.Text,{multiline:!1,color:"dimmest",variant:"small",children:"just now"})]})}function ed(e){var t,n=e.selected,r=e.onClick,i=e.session,o=(0,f._)((0,p.useState)(!1),2),a=o[0],s=o[1],h=Q(),g=h.menuProps,m=h.triggerProps,k=h.open,_=(0,x.useObservable)(i.data);return _?a?(0,l.jsxs)(K.View,{children:[(0,l.jsx)(b.EditTitle,{initialValue:null!=(t=_.title)?t:"",onCancel:function(){return s(!1)},onSubmit:function(e){i.updateSession({title:e}),s(!1)}}),(0,l.jsx)(K.View,{px:4,children:(0,l.jsx)(er.Timestamp,{textColor:"dimmest",textVariant:"small",date:i.created})})]}):(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)(K.View,(0,d._)((0,c._)({style:n?(0,u._)({},es.sessionBackground,w.tokens.backgroundHigher):void 0,css:eu.session,onClick:r},m),{children:[(0,l.jsxs)(K.View,{css:eu.header,children:[(0,l.jsx)(K.View,{css:eu.title,children:(0,l.jsx)(y.AnimatedText,{multiline:!1,text:_.title.length>0?_.title:"Untitled"})}),(0,l.jsx)(en.IconButton,{css:eu.actionsButton,alt:"Actions",tooltipBehavior:"hidden",onClick:function(e){var t=e.target.getBoundingClientRect();k({x:t.x,y:t.y})},children:(0,l.jsx)(eo.default,{})})]}),(0,l.jsx)(er.Timestamp,{textColor:"dimmest",textVariant:"small",date:i.created})]})),(0,l.jsxs)(Z,(0,d._)((0,c._)({},g),{children:[(0,l.jsx)(et,{onClick:function(){return s(!0)},children:"Rename"}),(0,l.jsx)(et,{onClick:function(){i.updateSession({archived:!_.archived})},children:(null==_?void 0:_.archived)?"Unarchive":"Archive"})]}))]}):null}function ef(){return(0,l.jsx)(K.View,{css:eu.emptyState,children:(0,l.jsx)(q.Text,{color:"dimmest",children:"No chats"})})}function ep(e){var t=e.sessions,n=e.currentSessionId,r=e.onSessionClick,i=(0,p.useRef)(null),o=(0,h.useVirtualizer)({overscan:10,count:t.length,getItemKey:function(e){return t[e].id},getScrollElement:function(){return i.current},estimateSize:function(){return 52}});return(0,l.jsx)(K.View,{innerRef:i,css:eu.sessionListWrapper,children:(0,l.jsx)(K.View,{style:{height:o.getTotalSize()},css:eu.sessionListInner,children:o.getVirtualItems().map(function(e){var i=t[e.index];return(0,l.jsx)("div",{ref:o.measureElement,"data-index":e.index,css:eu.sessionListItem,style:{height:e.size,transform:"translateY(".concat(e.start,"px)")},children:(0,l.jsx)(ed,{session:i,selected:i.id===n,onClick:function(){return r(i.id)}})},e.key.toString())})})})}function eh(e){var t=(0,m.useChatter)(),n=(0,x.useObservable)(t.sessions.chat.archived),r=(0,p.useMemo)(function(){return n?Array.from(n.values()).sort(function(e,t){return t.created.getTime()-e.created.getTime()}):[]},[n]);return n?0===r.length?(0,l.jsx)(ef,{}):(0,l.jsx)(ep,{sessions:r,currentSessionId:e.currentSessionId,onSessionClick:e.onSessionClick}):(0,l.jsx)(K.View,{css:eu.loading,children:(0,l.jsx)(ei.default,{})})}function eg(e){var t=(0,m.useChatter)(),n=(0,x.useObservable)(t.sessions.chat.open.list);return n?0===n.length?(0,l.jsx)(ec,{onClick:function(){return e.onNewSessionClick()}}):(0,l.jsx)(ep,{sessions:n,currentSessionId:e.currentSessionId,onSessionClick:e.onSessionClick}):(0,l.jsx)(K.View,{css:eu.loading,children:(0,l.jsx)(ei.default,{})})}var em=["Chats","Archived"];function ev(e){var t=(0,f._)((0,p.useState)("Chats"),2),n=t[0],r=t[1];return(0,l.jsx)(g.Tabs,{selectedKey:n,onSelectionChange:r,css:eu.tabs,children:(0,l.jsxs)(K.View,{css:eu.tabsInner,children:[(0,l.jsx)(K.View,{gap:4,p:8,children:(0,l.jsx)(g.TabList,{"aria-label":"Chats",css:eu.tabListLeft,children:em.map(function(e){return(0,l.jsx)(g.Tab,{id:e,css:eu.tab,children:(0,l.jsx)(q.Text,{color:"dimmer",children:e})},e)})})}),(0,l.jsx)(K.View,{css:eu.tabContent,children:em.map(function(t){return(0,l.jsx)(g.TabPanel,{id:t,css:eu.tabPanel,children:(0,l.jsx)(K.View,{css:eu.sessions,children:"Chats"===t?(0,l.jsx)(eg,(0,c._)({},e)):(0,l.jsx)(eh,(0,c._)({},e))})},t)})})]})})}var ex=e.i(140487),ey=e.i(357399),eb=(0,k.cssRecord)({sessionsListContainer:[C.rcss.overflowY("auto")],footer:[C.rcss.border({direction:"top",color:w.tokens.outlineDimmest})]});function ew(e){var t=e.currentSessionId,n=e.onSessionClick,r=e.onNewSessionClick,i=e.onSettingsButtonClick;return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(K.View,{css:eb.sessionsListContainer,grow:!0,shrink:!0,children:(0,l.jsx)(ev,{currentSessionId:t,onSessionClick:n,onNewSessionClick:r})}),(0,l.jsx)(K.View,{css:eb.footer,children:(0,l.jsx)(ex.Button,{text:"Settings",iconLeft:(0,l.jsx)(ey.default,{}),alignment:"start",onClick:i,size:"small",variant:"nofill"})})]})}e.s(["default",()=>ew],760740)},338148,(e,t,n)=>{var r=e.r(365738);!function(i,o){if("function"==typeof define&&define.amd){let t;void 0!==(t=o())&&e.v(t)}else"object"===r._(n)?t.exports=o():i.inflection=o()}(e.e,function(){var e=["accommodation","adulthood","advertising","advice","aggression","aid","air","aircraft","alcohol","anger","applause","arithmetic","assistance","athletics","bacon","baggage","beef","biology","blood","botany","bread","butter","carbon","cardboard","cash","chalk","chaos","chess","crossroads","countryside","dancing","deer","dignity","dirt","dust","economics","education","electricity","engineering","enjoyment","envy","equipment","ethics","evidence","evolution","fame","fiction","flour","flu","food","fuel","fun","furniture","gallows","garbage","garlic","genetics","gold","golf","gossip","grammar","gratitude","grief","guilt","gymnastics","happiness","hardware","harm","hate","hatred","health","heat","help","homework","honesty","honey","hospitality","housework","humour","hunger","hydrogen","ice","importance","inflation","information","innocence","iron","irony","jam","jewelry","judo","karate","knowledge","lack","laughter","lava","leather","leisure","lightning","linguine","linguini","linguistics","literature","litter","livestock","logic","loneliness","luck","luggage","macaroni","machinery","magic","management","mankind","marble","mathematics","mayonnaise","measles","methane","milk","minus","money","mud","music","mumps","nature","news","nitrogen","nonsense","nurture","nutrition","obedience","obesity","oxygen","pasta","patience","physics","poetry","pollution","poverty","pride","psychology","publicity","punctuation","quartz","racism","relaxation","reliability","research","respect","revenge","rice","rubbish","rum","safety","scenery","seafood","seaside","series","shame","sheep","shopping","sleep","smoke","smoking","snow","soap","software","soil","spaghetti","species","steam","stuff","stupidity","sunshine","symmetry","tennis","thirst","thunder","timber","traffic","transportation","trust","underwear","unemployment","unity","validity","veal","vegetation","vegetarianism","vengeance","violence","vitality","warmth","wealth","weather","welfare","wheat","wildlife","wisdom","yoga","zinc","zoology"],t={plural:{men:RegExp("^(m|wom)en$","gi"),people:/(pe)ople$/gi,children:/(child)ren$/gi,tia:/([ti])a$/gi,analyses:RegExp("((a)naly|(b)a|(d)iagno|(p)arenthe|(p)rogno|(s)ynop|(t)he)ses$","gi"),hives:RegExp("(hi|ti)ves$","gi"),curves:/(curve)s$/gi,lrves:/([lr])ves$/gi,aves:/([a])ves$/gi,foves:RegExp("([^fo])ves$","gi"),movies:/(m)ovies$/gi,aeiouyies:RegExp("([^aeiouy]|qu)ies$","gi"),series:/(s)eries$/gi,xes:RegExp("(x|ch|ss|sh)es$","gi"),mice:RegExp("([m|l])ice$","gi"),buses:/(bus)es$/gi,oes:/(o)es$/gi,shoes:/(shoe)s$/gi,crises:RegExp("(cris|ax|test)es$","gi"),octopi:RegExp("(octop|vir)i$","gi"),aliases:RegExp("(alias|canvas|status|campus)es$","gi"),summonses:RegExp("^(summons)es$","gi"),oxen:RegExp("^(ox)en","gi"),matrices:/(matr)ices$/gi,vertices:RegExp("(vert|ind)ices$","gi"),feet:RegExp("^feet$","gi"),teeth:RegExp("^teeth$","gi"),geese:RegExp("^geese$","gi"),quizzes:/(quiz)zes$/gi,whereases:RegExp("^(whereas)es$","gi"),criteria:RegExp("^(criteri)a$","gi"),genera:RegExp("^genera$","gi"),ss:/ss$/gi,s:/s$/gi},singular:{man:RegExp("^(m|wom)an$","gi"),person:/(pe)rson$/gi,child:/(child)$/gi,ox:RegExp("^(ox)$","gi"),axis:RegExp("(ax|test)is$","gi"),octopus:RegExp("(octop|vir)us$","gi"),alias:RegExp("(alias|status|canvas|campus)$","gi"),summons:RegExp("^(summons)$","gi"),bus:/(bu)s$/gi,buffalo:RegExp("(buffal|tomat|potat)o$","gi"),tium:/([ti])um$/gi,sis:/sis$/gi,ffe:RegExp("(?:([^f])fe|([lr])f)$","gi"),hive:RegExp("(hi|ti)ve$","gi"),aeiouyy:RegExp("([^aeiouy]|qu)y$","gi"),x:RegExp("(x|ch|ss|sh)$","gi"),matrix:/(matr)ix$/gi,vertex:RegExp("(vert|ind)ex$","gi"),mouse:RegExp("([m|l])ouse$","gi"),foot:RegExp("^foot$","gi"),tooth:RegExp("^tooth$","gi"),goose:RegExp("^goose$","gi"),quiz:/(quiz)$/gi,whereas:RegExp("^(whereas)$","gi"),criterion:RegExp("^(criteri)on$","gi"),genus:RegExp("^genus$","gi"),s:/s$/gi,common:/$/gi}},n=[[t.plural.men],[t.plural.people],[t.plural.children],[t.plural.tia],[t.plural.analyses],[t.plural.hives],[t.plural.curves],[t.plural.lrves],[t.plural.foves],[t.plural.aeiouyies],[t.plural.series],[t.plural.movies],[t.plural.xes],[t.plural.mice],[t.plural.buses],[t.plural.oes],[t.plural.shoes],[t.plural.crises],[t.plural.octopi],[t.plural.aliases],[t.plural.summonses],[t.plural.oxen],[t.plural.matrices],[t.plural.feet],[t.plural.teeth],[t.plural.geese],[t.plural.quizzes],[t.plural.whereases],[t.plural.criteria],[t.plural.genera],[t.singular.man,"$1en"],[t.singular.person,"$1ople"],[t.singular.child,"$1ren"],[t.singular.ox,"$1en"],[t.singular.axis,"$1es"],[t.singular.octopus,"$1i"],[t.singular.alias,"$1es"],[t.singular.summons,"$1es"],[t.singular.bus,"$1ses"],[t.singular.buffalo,"$1oes"],[t.singular.tium,"$1a"],[t.singular.sis,"ses"],[t.singular.ffe,"$1$2ves"],[t.singular.hive,"$1ves"],[t.singular.aeiouyy,"$1ies"],[t.singular.matrix,"$1ices"],[t.singular.vertex,"$1ices"],[t.singular.x,"$1es"],[t.singular.mouse,"$1ice"],[t.singular.foot,"feet"],[t.singular.tooth,"teeth"],[t.singular.goose,"geese"],[t.singular.quiz,"$1zes"],[t.singular.whereas,"$1es"],[t.singular.criterion,"$1a"],[t.singular.genus,"genera"],[t.singular.s,"s"],[t.singular.common,"s"]],r=[[t.singular.man],[t.singular.person],[t.singular.child],[t.singular.ox],[t.singular.axis],[t.singular.octopus],[t.singular.alias],[t.singular.summons],[t.singular.bus],[t.singular.buffalo],[t.singular.tium],[t.singular.sis],[t.singular.ffe],[t.singular.hive],[t.singular.aeiouyy],[t.singular.x],[t.singular.matrix],[t.singular.mouse],[t.singular.foot],[t.singular.tooth],[t.singular.goose],[t.singular.quiz],[t.singular.whereas],[t.singular.criterion],[t.singular.genus],[t.plural.men,"$1an"],[t.plural.people,"$1rson"],[t.plural.children,"$1"],[t.plural.genera,"genus"],[t.plural.criteria,"$1on"],[t.plural.tia,"$1um"],[t.plural.analyses,"$1$2sis"],[t.plural.hives,"$1ve"],[t.plural.curves,"$1"],[t.plural.lrves,"$1f"],[t.plural.aves,"$1ve"],[t.plural.foves,"$1fe"],[t.plural.movies,"$1ovie"],[t.plural.aeiouyies,"$1y"],[t.plural.series,"$1eries"],[t.plural.xes,"$1"],[t.plural.mice,"$1ouse"],[t.plural.buses,"$1"],[t.plural.oes,"$1"],[t.plural.shoes,"$1"],[t.plural.crises,"$1is"],[t.plural.octopi,"$1us"],[t.plural.aliases,"$1"],[t.plural.summonses,"$1"],[t.plural.oxen,"$1"],[t.plural.matrices,"$1ix"],[t.plural.vertices,"$1ex"],[t.plural.feet,"foot"],[t.plural.teeth,"tooth"],[t.plural.geese,"goose"],[t.plural.quizzes,"$1"],[t.plural.whereases,"$1"],[t.plural.ss,"ss"],[t.plural.s,""]],i=["and","or","nor","a","an","the","so","but","to","of","at","by","from","into","on","onto","off","out","in","over","with","for"],o=RegExp("(_ids|_id)$","g"),a=/_/g,s=RegExp("[ _]","g"),l=/([A-Z])/g,u=RegExp("^_"),c={_apply_rules:function(e,t,n,r){if(r)e=r;else if(!(c.indexOf(n,e.toLowerCase())>-1)){for(var i=0,o=t.length;i<o;i++)if(e.match(t[i][0])){void 0!==t[i][1]&&(e=e.replace(t[i][0],t[i][1]));break}}return e},indexOf:function(e,t,n,r){n||(n=-1);for(var i=-1,o=n,a=e.length;o<a;o++)if(e[o]===t||r&&r(e[o],t)){i=o;break}return i},pluralize:function(t,r){return c._apply_rules(t,n,e,r)},singularize:function(t,n){return c._apply_rules(t,r,e,n)},inflect:function(t,i,o,a){return isNaN(i=parseInt(i,10))?t:0===i||i>1?c._apply_rules(t,n,e,a):c._apply_rules(t,r,e,o)},camelize:function(e,t){for(var n,r,i,o,a=e.split("/"),s=0,l=a.length;s<l;s++){for(n=a[s].split("_"),r=0,i=n.length;r<i;r++)0!==r&&(n[r]=n[r].toLowerCase()),o=n[r].charAt(0),o=t&&0===s&&0===r?o.toLowerCase():o.toUpperCase(),n[r]=o+n[r].substring(1);a[s]=n.join("")}return a.join("::")},underscore:function(e,t){if(t&&e===e.toUpperCase())return e;for(var n=e.split("::"),r=0,i=n.length;r<i;r++)n[r]=n[r].replace(l,"_$1"),n[r]=n[r].replace(u,"");return n.join("/").toLowerCase()},humanize:function(e,t){return e=(e=(e=e.toLowerCase()).replace(o,"")).replace(a," "),t||(e=c.capitalize(e)),e},capitalize:function(e){return(e=e.toLowerCase()).substring(0,1).toUpperCase()+e.substring(1)},dasherize:function(e){return e.replace(s,"-")},titleize:function(e){for(var t,n,r,o=(e=e.toLowerCase().replace(a," ")).split(" "),s=0,l=o.length;s<l;s++){for(t=o[s].split("-"),n=0,r=t.length;n<r;n++)0>c.indexOf(i,t[n].toLowerCase())&&(t[n]=c.capitalize(t[n]));o[s]=t.join("-")}return(e=o.join(" ")).substring(0,1).toUpperCase()+e.substring(1)},demodulize:function(e){var t=e.split("::");return t[t.length-1]},tableize:function(e){return e=c.underscore(e),e=c.pluralize(e)},classify:function(e){return e=c.camelize(e),e=c.singularize(e)},foreign_key:function(e,t){return e=c.demodulize(e),e=c.underscore(e)+(t?"":"_")+"id"},ordinalize:function(e){for(var t=e.split(" "),n=0,r=t.length;n<r;n++)if(!isNaN(parseInt(t[n],10))){var i=t[n].substring(t[n].length-2),o=t[n].substring(t[n].length-1),a="th";"11"!=i&&"12"!=i&&"13"!=i&&("1"===o?a="st":"2"===o?a="nd":"3"===o&&(a="rd")),t[n]+=a}return t.join(" ")},transform:function(e,t){for(var n=0,r=t.length;n<r;n++){var i=t[n];c.hasOwnProperty(i)&&(e=c[i](e))}return e}};return c.version="1.12.0",c})},73817,e=>{e.v({button:"VisualSelectorButton-module__m0Cd3G__button"})},866585,40253,e=>{"use strict";var t,n=e.i(878420),r=e.i(64386),i=e.i(530658),o=e.i(276385),a=e.i(389959),s=e.i(960933),l=e.i(862927),u=e.i(188507);e.i(877212);var c=e.i(924908),d=e.i(629536);e.i(925218);var f=e.i(641555),p=e.i(993796),h=e.i(807290),g=e.i(602399),m=e.i(297083),x=e.i(817556),y=e.i(399528),b=e.i(368964),w=e.i(970187),k=e.i(51553),_=e.i(100371),S=e.i(123111),C=e.i(222342),j=e.i(441329),T=e.i(529810),E=e.i(66830),R=e.i(833887),I=e.i(752169),A=e.i(592639),P=e.i(379391),D=e.i(267103),O=e.i(343252),N=e.i(869226),M=e.i(858248),L=e.i(709485),B=e.i(286645),V=e.i(900433),F=e.i(863002),U=e.i(760740),G=e.i(338148),$=e.i(596139),z=e.i(845822),H=e.i(418725),W=e.i(83226),q=e.i(552488),K=e.i(480028),Y=e.i(446530),Q=e.i(613355),X=e.i(136540),J=e.i(27820),Z=e.i(604963),ee=e.i(396776),et=e.i(960178),en=e.i(625484),er=e.i(774792),ei=e.i(940745),eo=e.i(651499);function ea(){var e=(0,i._)((0,a.useState)(!1),2),t=e[0],n=e[1],r=(0,W.useGetAssistantFreeUsage)().assistantEdits,s=(0,i._)((0,a.useState)(!1),2),l=s[0],u=s[1];return(0,q.useOnHitFreemiumAlertThreshold)({usage:null==r?void 0:r.usage,limit:null==r?void 0:r.limit,percentThreshold:q.FREEMIUM_POPUP_ALERT_THRESHOLD,onHitThreshold:function(){n(!0),u(!0)}}),(0,q.useOnHitFreemiumAlertThreshold)({usage:null==r?void 0:r.usage,limit:null==r?void 0:r.limit,percentThreshold:100,onHitThreshold:function(){(0,M.track)(L.events.ASSISTANT_USED,{action:"hit_freemium_quota"})}}),(0,o.jsxs)(Z.PopoverTrigger,{isOpen:t,onOpenChange:function(e){n(e),e||u(!1)},label:"Usage",placement:"bottom start",children:[(0,o.jsx)(X.IconButton,{alt:"Usage",disabled:!r,children:(0,o.jsx)(en.View,{css:es.iconBadgeWrapper,children:(0,o.jsx)(eo.default,{})})}),(0,o.jsx)(en.View,{css:es.popoverWrapper,p:8,children:(0,o.jsxs)(en.View,{gap:12,children:[(0,o.jsxs)(et.Text,{css:es.header,children:["Free ",d.ASSISTANT_NAME," usage"]}),(0,o.jsx)(el,{limit:null==r?void 0:r.limit,usage:null==r?void 0:r.usage,isShowingAlertExplanation:l})]})})]})}var es=(0,Y.cssRecord)({popoverWrapper:[Q.rcss.width(280)],header:[Q.rcss.fontWeight.bold],measureBar:[Q.rcss.height(8)],usageMeterAndTitle:[Q.rcss.display.flex,Q.rcss.flex.row,Q.rcss.justify.spaceBetween,Q.rcss.align.center],iconBadgeWrapper:[Q.rcss.position.relative]});function el(e){var t=e.limit,n=e.usage,r=e.isShowingAlertExplanation;if(!t||void 0===n)return(0,o.jsx)(ei.default,{});var i=n>=t,a=Math.floor(n/t*100),s="You've used ".concat(a,"% of your ").concat($.freePlanName," plan ").concat(d.ASSISTANT_NAME," ").concat((0,G.pluralize)(z.ASSISTANT_USAGE_UNIT),". ").concat(d.ASSISTANT_NAME," creates edits when asked to make a change to the code.");return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(en.View,{gap:4,children:(0,o.jsx)(eu,{title:"".concat(d.ASSISTANT_NAME," ").concat((0,G.pluralize)(z.ASSISTANT_USAGE_UNIT)),current:n,max:t})}),i?(0,o.jsx)(ed,{}):null,r?(0,o.jsx)(ee.StatusBanner,{text:s,colorway:"primary"}):null,(0,o.jsx)(H.default,{text:"Upgrade for more",colorway:"brand",variant:"outlined",context:"assistant_freemium_quota",iconLeft:(0,o.jsx)(er.default,{})})]})}function eu(e){var t=e.title,n=e.current,r=e.max;return(0,o.jsxs)(en.View,{gap:6,children:[(0,o.jsxs)(en.View,{css:es.usageMeterAndTitle,children:[(0,o.jsx)(et.Text,{height:"singleLine",children:t}),(0,o.jsxs)(et.Text,{height:"singleLine",color:"dimmer",children:[n," / ",r]})]}),(0,o.jsx)("div",{children:(0,o.jsx)(J.MeasureBar,{css:es.measureBar,total:r,current:n,color:K.tokens.blueDefault,tooltipHidden:!0})})]})}var ec=(0,Y.cssRecord)({root:[Q.rcss.border({color:K.tokens.orangeDimmer}),Q.rcss.borderRadius(),Q.rcss.py(4),Q.rcss.px(6),Q.rcss.colorMixBg(K.tokens.orangeDimmer,"transparent",.25)],text:[Q.rcss.color.orangeStronger]});function ed(){return(0,o.jsx)(en.View,{css:ec.root,children:(0,o.jsxs)(et.Text,{css:ec.text,children:["You've used 100% of your free ",d.ASSISTANT_NAME," quota."]})})}var ef=e.i(71600),ep=e.i(108232),eh=e.i(248011),eg=e.i(929872),em=(0,Y.cssRecord)({header:[Q.rcss.height(28),{zIndex:1}],main:[Q.rcss.position.relative,Q.rcss.flex.growAndShrink(1),Q.rcss.justify.end],content:[{paddingLeft:_.sidebarStyleTokens.paddingLeft,justifyContent:"end"}],sidebarBlanket:[Q.rcss.coverContainer,{zIndex:3,backgroundColor:K.tokens.backgroundOverlay,pointerEvents:_.sidebarStyleTokens.sidebarBlanketPointerEvents,opacity:_.sidebarStyleTokens.sidebarBlanketOpacity}],sidebar:[Q.rcss.position.absolute,Q.rcss.top(0),Q.rcss.left(0),Q.rcss.borderRadius(),{pointerEvents:_.sidebarStyleTokens.sidebarPointerEvents,width:_.sidebarStyleTokens.sidebarWidth,height:_.sidebarStyleTokens.sidebarHeight,opacity:_.sidebarStyleTokens.sidebarOpacity,transform:_.sidebarStyleTokens.sidebarTransform,border:"1px solid "+K.tokens.outlineDimmest,zIndex:3}]});function ev(e){var t=e.sessionId,n=e.children,r=e.isSettingsPanelOpen,i=e.setIsSettingsPanelOpen,s=e.setSessionId,l=e.openUserSettingsPane,u=e.onNewSessionClick,d=e.sidebarState,p=(0,c.useChatter)(),h=(0,f.useObservableMemo)(function(){return t?p.sessions.get(t):null},[p,t]),g=(0,f.useObservableMemo)(function(){return null==h?void 0:h.data},[h]),m=(0,D.useObservable)(p.sessions.chat.open),x=(0,D.useObservable)(p.sessions.chat.archived),y=(0,k.useConfig)().hasAccessToAdvancedModel,b=(0,eh.useIsFreemiumStarterPlanUsersOwnRepl)().isFreemiumStarterPlanUsersOwnRepl,w=d.state,S=d.setSidebarContainerEl,C=d.toggleSidebar,j=d.closeIfNeeded;function T(){i(!0),j()}var R=(0,a.useCallback)(function(){(0,M.track)(L.events.ASSISTANT_USED,{action:"new_session",intent_type:null,model:null,user_model_selection:null,message_content:null,message_source:"chat_pane",message_surface:"workspace_ai_pane"}),j(),u()},[j,u]),I=(0,a.useCallback)(function(){if(h&&g){var e=g.archived;if((0,M.track)(L.events.ASSISTANT_USED,{action:e?"chat_unarchived":"chat_archived",intent_type:null,model:null,user_model_selection:null,message_content:null,message_source:"chat_pane",message_surface:"workspace_ai_pane"}),h.id===t){var n=e?x:m;if(n&&n.size>1){var r=Array.from(n.keys()).find(function(e){return e!==h.id});s(null!=r?r:null)}else R()}h.updateSession({archived:!e})}},[x,R,m,h,g,t,s]),A=(0,a.useCallback)(function(e){(0,M.track)(L.events.ASSISTANT_USED,{action:"chat_renamed",intent_type:null,model:null,user_model_selection:null,message_content:null,message_source:"chat_pane",message_surface:"workspace_ai_pane"}),null==h||h.updateSession({title:e})},[h]),P=(0,E.useAiChatAttachments)().addAttachments,G=(0,V.useDropTarget)({addAttachments:P}),$=G.isDraggedOver,z=G.drop,H=(0,a.useRef)(null);(0,N.useStyleSet)(H,w,_.getSidebarCssVars);var W=g?(0,o.jsx)(ef.Title,{title:g.title,archived:g.archived,onRename:A,onToggleArchived:I},g.id):null,q=(0,ep.useAssistantSessionCostInCents)(t),K=(0,o.jsx)(ef.Header,{onAddButtonClick:R,onSidebarButtonClick:function(){return C()},title:W,prefsButton:(0,o.jsx)(ef.PrefsButton,{onClick:T}),usageButton:b?(0,o.jsx)(ea,{}):(0,o.jsx)(ef.UsageButtonLink,{sessionCostInCents:q}),sessionCost:null}),Y=(0,O.useMergeRefs)([H,z]);return(0,o.jsxs)(en.View,{grow:!0,shrink:!0,px:4,innerRef:Y,children:[(0,o.jsx)(eg.Surface,{css:em.header,children:r?(0,o.jsx)(F.ChatPreferencesHeader,{onBack:function(){return i(!1)}}):K}),(0,o.jsxs)(en.View,{css:em.main,innerRef:S,children:[r?null:(0,o.jsx)(en.View,{css:em.sidebarBlanket,onClick:function(){return C(!1)}}),(0,o.jsx)(eg.Surface,{css:em.sidebar,children:(0,o.jsx)(U.default,{currentSessionId:t,onNewSessionClick:R,onSessionClick:function(e){i(!1),s(e),j()},onSettingsButtonClick:T})}),(0,o.jsx)(en.View,{css:em.content,grow:!0,shrink:!0,children:r?(0,o.jsx)(F.ChatPreferencesPanel,{hasAccessToAdvancedModel:y,onOpenUserSettings:l}):n})]}),$?(0,o.jsx)(B.default,{}):null]})}var ex=e.i(357993),ey=e.i(153277),eb=e.i(526962),ew=e.i(569384),ek=e.i(973245),e_=e.i(304277);function eS(){var e=(0,ew._)(["\n  fragment AssistantAuthorizations on OrgAuthorizations {\n    basicAssistant: useAiAssistant(mode: basic) {\n      __typename\n      isAuthorized\n      message\n      code\n    }\n    advancedAssistant: useAiAssistant(mode: advanced) {\n      __typename\n      isAuthorized\n      message\n      code\n    }\n  }\n"]);return eS=function(){return e},e}function eC(){var e=(0,ew._)(["\n  query GetAssistantReplAuthorizations($orgId: String) {\n    currentUser {\n      id\n      personalOrgAuthorizations {\n        ... on OrgAuthorizations {\n          ...AssistantAuthorizations\n        }\n        ... on Error {\n          message\n        }\n      }\n      org(orgId: $orgId) {\n        ... on Org {\n          id\n          authorizations {\n            ... on OrgAuthorizations {\n              ...AssistantAuthorizations\n            }\n          }\n        }\n        ... on Error {\n          message\n        }\n      }\n    }\n  }\n  ","\n"]);return eC=function(){return e},e}e.i(566901);var ej={},eT=(0,ek.gql)(eS()),eE=(0,ek.gql)(eC(),eT),eR=e.i(605526),eI=e.i(207237),eA=e.i(223808),eP=e.i(197159),eD=e.i(986194),eO=e.i(939652),eN=e.i(965863),eM=e.i(959406),eL=e.i(886513),eB=e.i(546284),eV=e.i(973519),eF=e.i(968783),eU=e.i(552144),eG=e.i(353384);function e$(e){var t=e.onClick,r=(0,eF.useCurrentUserStoredOrgContext)(),i=r.orgRole,a=r.orgId,s=r.orgSlug;switch(i){case b.SystemOrgGroupType.SystemAdmins:return(0,o.jsx)(en.View,{p:8,children:(0,o.jsx)(eU.StatusBannerButton,(0,n._)({iconLeft:(0,o.jsx)(er.default,{}),text:"Your team has a failed payment. Please update your team's payment method to continue using AI services.",colorway:"negative",onClick:null!=t?t:function(){}},!t&&{href:"/orb-customer-portal/org/".concat(a),target:"_blank"}))});case b.SystemOrgGroupType.SystemMembers:case b.SystemOrgGroupType.SystemGuests:case b.SystemOrgGroupType.SystemViewers:return(0,o.jsx)(en.View,{p:8,children:(0,o.jsx)(eU.StatusBannerButton,(0,n._)({iconLeft:(0,o.jsx)(eG.default,{}),text:"Your team has a failed payment. Please contact your team admins to address outstanding invoices to continue using AI services.",colorway:"negative",onClick:null!=t?t:function(){}},!t&&{href:"/t/".concat(s,"/members"),target:"_blank"}))});default:return(0,o.jsx)(en.View,{p:8,children:(0,o.jsx)(eU.StatusBannerButton,(0,n._)({iconLeft:(0,o.jsx)(er.default,{}),text:"You have a failed payment. Please update your payment method to continue using AI services.",colorway:"negative",onClick:null!=t?t:function(){}},!t&&{href:"/account#billing",target:"_blank"}))})}}e.s(["PaymentDelinquentButton",()=>e$],40253);var ez=e.i(267473),eH=e.i(53617),eW=e.i(547450),eq=e.i(128258),eK=e.i(881476),eY=e.i(696683);function eQ(){var e=(0,ew._)(["\n  fragment StartWithAiUsageBudget on UsageBasedBillingBudget {\n    id\n    hasReachedBudget\n  }\n"]);return eQ=function(){return e},e}function eX(){var e=(0,ew._)(["\n  query AssitantUsageBanner($orgId: String) {\n    currentUser {\n      id\n      ...CoreSubscriptionPlanStatus\n      usageBasedBillingBudget {\n        __typename\n        ... on UsageBasedBillingBudget {\n          ...StartWithAiUsageBudget\n        }\n      }\n      usageBasedBillingAlerts {\n        ...EditUsageBasedBillingAlertsFormInitialConfig\n      }\n      org(orgId: $orgId) {\n        __typename\n        ... on Org {\n          id\n          name\n          usageBasedBillingBudget {\n            __typename\n            ... on UsageBasedBillingBudget {\n              ...StartWithAiUsageBudget\n            }\n          }\n          usageBasedBillingAlerts {\n            ...EditUsageBasedBillingAlertsFormInitialConfig\n          }\n        }\n      }\n    }\n  }\n  ","\n  ","\n  ","\n"]);return eX=function(){return e},e}var eJ={},eZ=(0,ek.gql)(eQ()),e0=(0,ek.gql)(eX(),eK.CoreSubscriptionPlanStatusFragmentDoc,eZ,eY.EditUsageBasedBillingAlertsFormInitialConfigFragmentDoc),e1=e.i(845228),e2=e.i(32629),e3=e.i(201411),e4=e.i(907371),e8=e.i(739521),e5=(0,Y.cssRecord)({bannerContainer:[Q.rcss.pb(6)]});function e6(e){var t,s,l,u,c,f,p,h,g,m,x,y,b=e.assistantAuthz,w=(0,i._)((0,a.useState)(!1),2),k=w[0],_=w[1],S=(0,i._)((0,a.useState)(!1),2),C=S[0],j=S[1],T=(0,i._)((0,a.useState)(!1),2),E=T[0],R=T[1],I=null==(l=(0,e2.useUserPaymentMethod)().paymentMethod)?void 0:l.last4,A=(0,eI.default)(),P=(0,eR.useOrgId)(A).orgId,D=(t={variables:{orgId:P}},s=(0,n._)({},eJ,t),e_.useQuery(e0,s)),O=D.data,N=D.loading,M=!1;P?(u=(null==O||null==(c=O.currentUser)?void 0:c.org.__typename)==="Org"&&"UsageBasedBillingAlertsConfig"===O.currentUser.org.usageBasedBillingAlerts.__typename?O.currentUser.org.usageBasedBillingAlerts:void 0,M=(null==O||null==(f=O.currentUser)?void 0:f.org.__typename)==="Org"&&(null==(p=O.currentUser.org.usageBasedBillingBudget)?void 0:p.__typename)==="UsageBasedBillingBudget"&&O.currentUser.org.usageBasedBillingBudget.hasReachedBudget):(u=(null==O||null==(h=O.currentUser)?void 0:h.usageBasedBillingAlerts.__typename)==="UsageBasedBillingAlertsConfig"?O.currentUser.usageBasedBillingAlerts:void 0,M=(null==O||null==(m=O.currentUser)||null==(g=m.usageBasedBillingBudget)?void 0:g.__typename)==="UsageBasedBillingBudget"&&O.currentUser.usageBasedBillingBudget.hasReachedBudget);var L=null!=(x=null==O?void 0:O.currentUser)?x:null,B=(null==L?void 0:L.org.__typename)==="Org"?L.org:void 0,V=null!=(y=null==L?void 0:L.hasCore)&&y,F=(0,e4.useCreateInteractive)({variant:"underlined"}),U={clsx:F.clsx,style:(0,r._)((0,n._)({},F.style),{fontSize:"inherit",color:"inherit"})};return N||(null==b?void 0:b.advancedAssistant.isAuthorized)||E?null:I||V?M?(0,o.jsxs)(en.View,{children:[(0,o.jsx)(e8.Modal,{isOpen:C,onRequestClose:function(){return j(!1)},children:(0,o.jsx)(e3.EditUsageBasedBillingAlertsForm,{org:B,initialSettings:u,onDone:function(){return j(!1)}})}),(0,o.jsx)(en.View,{css:e5.bannerContainer,children:(0,o.jsx)(ee.StatusBanner,{icon:(0,o.jsx)(eo.default,{}),text:(0,o.jsxs)(et.Text,{variant:"small",children:["You must"," ",(0,o.jsx)("button",(0,r._)((0,n._)({},U),{onClick:function(){j(!0)},children:"increase your usage budget"}))," ","to enable Advanced ",d.ASSISTANT_NAME,"."]}),colorway:"blue",closable:!0,closeAction:function(){return R(!0)}})})]}):null:(0,o.jsxs)(en.View,{children:[(0,o.jsx)(e8.Modal,{isOpen:k,onRequestClose:function(){return _(!1)},children:(0,o.jsxs)(en.View,{gap:16,children:[(0,o.jsx)(et.Text,{variant:"subheadDefault",multiline:!1,children:"Add Payment Method"}),(0,o.jsx)(e1.NewPaymentMethodForm,{onClose:function(){_(!1)}})]})}),(0,o.jsx)(en.View,{css:e5.bannerContainer,children:(0,o.jsx)(ee.StatusBanner,{icon:(0,o.jsx)(er.default,{}),text:(0,o.jsxs)(et.Text,{variant:"small",children:["You must"," ",(0,o.jsx)("button",(0,r._)((0,n._)({},U),{onClick:function(){_(!0)},children:"add a billing method"}))," ","to enable Advanced ",d.ASSISTANT_NAME,"."]}),colorway:"blue",closable:!0,closeAction:function(){return R(!0)}})})]})}var e9=e.i(346715),e7=e.i(765695),te=e.i(608572),tt=e.i(703613),tn=e.i(542101),tr=e.i(956515),ti=e.i(266645),to=e.i(628576),ta=e.i(200260),ts=e.i(709696),tl=e.i(64256),tu=e.i(149448),tc=e.i(604671),td=e.i(255615),tf=e.i(654647),tp=e.i(413309),th=e.i(178339),tg=e.i(650587),tm=e.i(158689),tv=e.i(692910),tx=e.i(754873),ty=e.i(818503),tb=e.i(624782),tw=e.i(33914),tk=e.i(616278),t_=e.i(644826),tS=e.i(693188),tC=(0,Y.cssRecord)({root:[Q.rcss.color.foregroundDimmer],label:[Q.rcss.visuallyHidden],selectButton:[Q.rcss.reset.button,Q.rcss.flex.row,Q.rcss.rowWithGap(4),Q.rcss.cursor.pointer,Q.rcss.align.center,Q.rcss.px(4),Q.rcss.py(2),tx.interactive.nofill,Q.rcss.color.foregroundDimmest,Q.rcss.fontSize(12),{'&[aria-expanded="true"] .chevron':{transform:"rotate(180deg)"},"&:hover":Q.rcss.color.foregroundDefault}],pooverSurface:[Q.rcss.borderRadius(4),Q.rcss.border({color:K.tokens.outlineDefault})]});function tj(e){var t,n=e.assistantMode,r=e.availableModels,i=e.assistantAdvancedAuthz,a=e.showModelNames,s=void 0===a||a,l=e.basicModeAffordances,c=e.advancedModeAffordances,d=e.onChange,f=r.basicModel,p=r.advancedModel,h=r.overrideModel,g=(0,tg.useIsMobile)();return(0,o.jsx)(en.View,{css:tC.root,grow:!0,shrink:!0,children:(0,o.jsxs)(th.Select,{selectedKey:n,onSelectionChange:function(e){switch(e){case"basic":case"advanced":d(e)}},children:[(0,o.jsx)(ty.Label,{css:tC.label,children:"Assistant mode"}),(0,o.jsxs)(td.Button,{css:tC.selectButton,children:[(0,o.jsx)(tv.ModelIcon,{model:"basic"===n?u.ModelType.BASIC:u.ModelType.ADVANCED,size:12}),"basic"===n?"Basic":"Advanced",(0,o.jsx)(t_.default,{size:12})]}),(0,o.jsx)(tp.Popover,{placement:g?"top":void 0,children:(0,o.jsx)(eg.Surface,{css:tC.pooverSurface,elevated:!0,children:(0,o.jsxs)(tf.ListBox,{"aria-label":"Assistant chat mode",selectionMode:"single",children:[(0,o.jsx)(tf.ListBoxItem,{id:"basic","aria-label":"basic",children:(0,o.jsx)(tE,{readableModelName:f.name.readable,isSelected:"basic"===n,modeAffordances:void 0===l?"Ask questions":l,showModelNames:s})}),(0,o.jsx)(tf.ListBoxItem,{id:"advanced","aria-label":"advanced",children:(0,o.jsx)(tR,{readableModelName:null!=(t=null==h?void 0:h.name.readable)?t:p.name.readable,isSelected:"advanced"===n,isOverrideActive:null!=r.overrideModel,authz:i,modeAffordances:void 0===c?"Generate code & actions":c,showModelNames:s})})]})})})]})})}var tT=(0,Y.cssRecord)({root:[Q.rcss.px(8),Q.rcss.py(6),Q.rcss.rowWithGap(8),Q.rcss.align.center,Q.rcss.cursor.pointer,Q.rcss.hover({backgroundColor:K.tokens.backgroundHighest})],content:[Q.rcss.colWithGap(0),Q.rcss.flex.growAndShrink(1)],modelName:[Q.rcss.rowWithGap(6),Q.rcss.align.center]});function tE(e){var t=e.readableModelName,n=e.isSelected,r=e.modeAffordances,i=e.showModelNames;return(0,o.jsxs)(en.View,{css:tT.root,children:[(0,o.jsx)(en.View,{children:(0,o.jsx)(tw.default,{color:K.tokens.foregroundDimmer})}),(0,o.jsxs)(en.View,{css:tT.content,children:[(0,o.jsx)(en.View,{css:tT.modelName,children:(0,o.jsx)(et.Text,{variant:"small",children:"Basic"})}),(0,o.jsxs)(et.Text,{variant:"small",color:"dimmer",children:[r," ",i?"with ".concat(t):""]})]}),(0,o.jsx)(en.View,{children:n?(0,o.jsx)(tk.default,{color:K.tokens.foregroundDefault}):null})]})}function tR(e){var t=e.readableModelName,n=e.authz,r=e.isSelected,i=e.isOverrideActive,a=e.modeAffordances,s=e.showModelNames;return(0,o.jsxs)(en.View,{css:tT.root,children:[(0,o.jsx)(en.View,{children:(0,o.jsx)(tS.default,{color:K.tokens.foregroundDefault})}),(0,o.jsxs)(en.View,{css:tT.content,children:[(0,o.jsxs)(en.View,{css:tT.modelName,children:[(0,o.jsx)(et.Text,{variant:"small",children:"Advanced"}),n.isAuthorized?(0,o.jsxs)(et.Text,{variant:"small",color:"dimmer",children:[z.ASSISTANT_UNIT_PRICE_IN_CENTS,"/",z.ASSISTANT_USAGE_UNIT]}):null,n.isAuthorized?null:(0,o.jsx)(tm.Pill,{text:$.corePlanName}),void 0!==i&&i?(0,o.jsx)(tb.Pill,{colorway:"orange",text:"Override"}):null]}),(0,o.jsxs)(et.Text,{variant:"small",color:"dimmer",children:[a," ",s?"with ".concat(t):""]})]}),(0,o.jsx)(en.View,{children:r?(0,o.jsx)(tk.default,{color:K.tokens.foregroundDefault}):null})]})}var tI=e.i(751273),tA=e.i(819700),tP=e.i(363201),tD=(0,Y.cssRecord)({root:[Q.rcss.borderRadius(4,4,0,0),Q.rcss.rowWithGap(6),Q.rcss.align.center,Q.rcss.minHeight(28),Q.rcss.backgroundColor.backgroundHigher,Q.rcss.position.relative,Q.rcss.container("assistantControlBar")],modelIndicatorText:[{"@container (max-width: 270px)":{display:"none"}}],modelIndicatorTooltip:[Q.rcss.colWithGap(8),Q.rcss.p(4),Q.rcss.width("100%")]});function tO(e){var t,n,r,i,s,l=e.availableModels,u=e.assistantAdvancedAuthz,c=void 0===u?{isAuthorized:!0}:u,d=e.onModeSelectChange,f=(0,w.useAssistantChatMode)().assistantMode,p=(0,e7.usePreferredAdvancedModelName)(),h=(0,a.useRef)(null),g=(0,j.useIsInMobileWorkspace)();return(0,o.jsx)(en.View,{css:tD.root,px:6,innerRef:h,children:(0,o.jsxs)(tc.UNSTABLE_PortalProvider,{getContainer:function(){return g?h.current:document.body},children:[(0,o.jsx)(tA.default,{}),(0,o.jsx)(en.View,{grow:!0,shrink:!0,children:(0,o.jsx)(tj,{availableModels:l,assistantMode:f,assistantAdvancedAuthz:c,onChange:d})}),(0,o.jsx)(tN,{assistantMode:f,assistantAdvancedAuthz:c,isOverrideActive:"advanced"===f&&null!=l.overrideModel,preferredAdvancedModelName:null==p?void 0:p.readable,text:(t=l,n=f,r=t.basicModel,i=t.advancedModel,s=t.overrideModel,"basic"===n?r.name.readable:"advanced"===n&&s?s.name.readable:i.name.readable)})]})})}function tN(e){var t=e.assistantMode,n=e.assistantAdvancedAuthz,r=e.isOverrideActive,i=void 0!==r&&r,a=e.preferredAdvancedModelName,s=e.text;return(0,o.jsxs)(en.View,{row:!0,gap:4,align:"center",children:[i?(0,o.jsx)(tb.Pill,{colorway:"orange",text:"Override"}):null,(0,o.jsx)(et.Text,{css:tD.modelIndicatorText,variant:"small",color:"dimmer",children:s}),(0,o.jsx)(tI.Tooltip,{tooltip:"basic"===t?(0,o.jsx)(tM,{assistantAdvancedAuthz:n}):(0,o.jsx)(tL,{assistantAdvancedAuthz:n,preferredAdvancedModelName:i?a:void 0}),placement:"top-end",children:(0,o.jsx)(tP.default,{color:K.tokens.foregroundDimmest})})]})}function tM(e){var t=e.assistantAdvancedAuthz;return(0,o.jsx)(en.View,{css:tD.modelIndicatorTooltip,children:(0,o.jsxs)(et.Text,{variant:"small",children:[(0,o.jsx)("strong",{children:"Basic"}),": ",d.ASSISTANT_NAME,t.isAuthorized?" will answer questions about your code or the Replit environment using a lightweight model.":" will answer general coding questions."]})})}function tL(e){var t=e.assistantAdvancedAuthz,n=e.preferredAdvancedModelName;return(0,o.jsxs)(en.View,{css:tD.modelIndicatorTooltip,children:[(0,o.jsxs)(et.Text,{variant:"small",children:[(0,o.jsx)("strong",{children:"Advanced"}),": In addition to answering questions,"," ",d.ASSISTANT_NAME," will write code, propose file changes & shell commands, and use advanced code search techniques."]}),t.isAuthorized&&n?(0,o.jsxs)(et.Text,{variant:"small",children:["Note that ",n," is best for code generation, and you will experience degraded performance with other models."]}):null]})}var tB=e.i(721281),tV=e.i(72158),tF=e.i(179302),tU=e.i(406948),tG=e.i(825423),t$=e.i(257378),tz=e.i(564416),tH=e.i(808032),tW=e.i(700170),tq=e.i(98816),tK=e.i(337761),tY=e.i(624714),tQ=e.i(245218),tX=e.i(177160),tJ=e.i(559099),tZ=e.i(231895),t0=e.i(183112),t1=e.i(69731),t2=e.i(179549),t3=e.i(779056),t4=e.i(123850),t8=e.i(608263),t5=e.i(566818),t6=(0,t4.createCssVarTokens)(["padding","columnGap"]),t9=t6.cssVars,t7=t6.styleTokens,ne=tF.EditorView.theme((t={"&":{flexGrow:1},"& .cm-content":{fontFamily:K.tokens.fontFamilyDefault}},(0,tB._)(t,"& .".concat(tH.ACTIVE_LINE_LAYER_CLASS),{display:"none"}),(0,tB._)(t,"& .cm-cursor",{borderLeftColor:K.tokens.foregroundDefault,borderLeftWidth:"1px"}),t)),nt=(0,Y.cssRecord)({controlBarContainer:[Q.rcss.position.absolute,Q.rcss.width("100%"),Q.rcss.top(0),Q.rcss.left(0),Q.rcss.border({width:1,color:K.tokens.outlineDimmer,direction:"bottom"})],footer:[Q.rcss.height(32)],left:[{cursor:"text"}],right:[Q.rcss.display.flex,Q.rcss.rowWithGap(8),Q.rcss.align.end],rightColumn:[Q.rcss.display.flex,Q.rcss.flex.column,Q.rcss.align.center],codemirror:[Q.rcss.display.flex,Q.rcss.flex.grow(1),Q.rcss.maxHeight(300),{"& .cm-editor":[Q.rcss.flex.grow(1)]}],send:[Q.rcss.mr(2)],chatInput:[Q.rcss.borderRadius(4),tx.interactive.filledAndOutlined,Q.rcss.p(4),Q.rcss.position.relative,{"@media (hover: hover)":{":not([disabled], [aria-disabled])":{cursor:"text"}},padding:t7.padding,columnGap:t7.columnGap,rowGap:K.tokens.space4,border:"1px solid ".concat(K.tokens.outlineDimmest),"&:not([disabled], [aria-disabled])":{borderColor:K.tokens.outlineDimmer},"&:hover:not([disabled], [aria-disabled]):hover":{borderColor:K.tokens.tealStronger},"&:focus-within":{borderColor:K.tokens.tealStronger}}]});function nn(e){var t,n,r,i,s,l,u,c,d,f=(0,j.useIsInMobileWorkspace)(),p=(0,j.useIsInBonsaiWebview)(),h=(n=(t={view:e.view,setPromptEditor:e.inputRef}).view,r=t.setPromptEditor,i=(0,a.useRef)(null),s=(0,tq.default)(r),(0,a.useEffect)(function(){if(n){var e=s.current;return e({setValue:function(e){n.state.doc.toString()!==e&&n.dispatch({changes:{from:0,to:n.state.doc.length,insert:e}})},getValue:function(){return n.state.doc.toString()},focus:function(){n.focus(),n.dispatch({selection:{anchor:n.state.doc.length}})},animatePlaceholder:function(){n.dispatch({effects:t2.animateTextEffect.of(!0)}),(0,tK.styleSet)(i,"border-color",K.tokens.accentPrimaryDefault),setTimeout(function(){requestAnimationFrame(function(){var e;null==(e=i.current)||e.style.removeProperty("border-color")})},60),n.focus()},animateBorder:function(){}}),function(){e(null)}}},[n,s]),i),g=(0,t2.usePlaceholder)({text:e.placeholderText}),m=(0,tt.useCodeMirrorValue)(e.view,t2.isEmpty),x=tJ.MaxLength.use(e.maxLength),y=(0,tq.default)(e.onSubmit),b=nr.use((0,a.useCallback)(function(e){return y.current(e)},[y]),!e.isConnected),w=tZ.FileCompletion.use(e.findFiles),k=t1.FileDecorations.use(e.openFile),_=t0.FileContext.use(e.fileContextInclusions),S=tU.TrackPasteCompartment.use({analyticsSurface:e.analyticsSurface,shouldTrack:!0}),C=e.updateFileContext,T=tZ.FileCompletionAccepted.use((0,a.useCallback)(function(e){return null==C?void 0:C({path:e,preference:"include"})},[C])),E=tZ.FileCompletionRemoval.use((0,a.useCallback)(function(e){return null==C?void 0:C({path:e,preference:"exclude"})},[C])),R=tY.HandlePasteCompartment.use({addAttachments:e.addAttachments,onAutoAttachedLargePaste:function(e){(0,M.track)(L.events.ASSISTANT_USED,{action:"auto_attached_large_paste",fileSize:e})}}),I=(!e.view||!0===m)&&!e.isLastEventInProgress||e.isSessionLoading&&!e.isLastEventInProgress||(null==(l=e.assistantModeAuthz)?void 0:l.isAuthorized)===!1||e.isSubmitDisabled,A=e.attachments,P=e.attachmentButton,D=e.controlBar,N=e.debugButton,B=e.fileContextButton,V=e.visualSelectorButton,F=(0,tQ.useUrlContextFeatureKillswitch)(),U=e.isSessionLoading,G=e.isLastEventInProgress,$=(0,a.useMemo)(function(){return U?{sendButtonIcon:(0,o.jsx)(ei.default,{}),sendButtonAlt:"Loading"}:G?{sendButtonIcon:(0,o.jsx)(t5.default,{}),sendButtonAlt:"Stop"}:{sendButtonIcon:(0,o.jsx)(t8.default,{}),sendButtonAlt:"Send"}},[U,G]),z=$.sendButtonIcon,H=$.sendButtonAlt,W=function(){if(e.isLastEventInProgress)return void e.onStop();if(e.view){var t=e.view.state.doc.toString();t&&(e.onSubmit(t),e.view.dispatch({changes:{from:0,to:e.view.state.doc.length}}))}},q=(0,t3.useRegisterPipAnchor)({type:"assistant"}),Y=(0,O.useMergeRefs)([h,q],{breadcrumb:"client/workspace/components/AiChat/ChatInput/index.tsx:346"}),Q=void 0;return e.isSubmitDisabled&&e.submitDisabledReason?Q=e.submitDisabledReason:(null==(u=e.assistantModeAuthz)?void 0:u.isAuthorized)===!1&&(Q=null==(c=e.assistantModeAuthz)?void 0:c.message),(0,o.jsxs)(eg.Surface,{css:nt.chatInput,innerRef:Y,style:(d={flexDirection:"compact"===e.variant?"row":void 0},(0,tB._)(d,t9.padding,"compact"===e.variant?"2px 5px":"4px 4px"),(0,tB._)(d,t9.columnGap,f||p?"0px":"4px"),(0,tB._)(d,"paddingTop",e.controlBar?K.tokens.space32:void 0),d),children:[D?(0,o.jsx)(en.View,{css:nt.controlBarContainer,children:D}):null,A,(0,o.jsx)(tz.default,{ref:e.codemirrorRef,css:nt.codemirror,fontSize:14,extensions:[ne,b,S,R,g,tJ.characterLimit,x,_,k,w,T,E,t$.autocorrectExtension,tG.autocapitalizeExtension,e.isPasteAndDropSupported?R:[],F?[]:ts.UrlAttachmentExtensions]}),(0,o.jsxs)(en.View,{css:nt.footer,py:4,row:!0,gap:8,align:"end",children:["compact"===e.variant?null:(0,o.jsxs)(en.View,{css:nt.left,grow:!0,shrink:!0,row:!0,gap:8,align:"center",onClick:function(t){if(t.target===t.currentTarget){var n;null==(n=e.view)||n.focus()}},children:[P,V,B,N]}),(0,o.jsxs)(en.View,{css:nt.right,style:{alignItems:"compact"===e.variant?"flex-end":"center"},children:["compact"===e.variant?null:(0,o.jsx)(tJ.OverCharacterLimit,{view:e.view}),(0,o.jsxs)(en.View,{css:nt.rightColumn,children:["compact"===e.variant?(0,o.jsx)(tJ.OverCharacterLimit,{view:e.view}):null,f?(0,o.jsx)(tX.SendButton,{variant:"assistant",alt:H,onClick:W,dataCy:"ai-chat-send-button",iconOverride:e.isLastEventInProgress?(0,o.jsx)(t5.default,{}):void 0}):(0,o.jsx)(en.View,{css:nt.send,children:e.isConnected?(0,o.jsx)(X.IconButton,{colorway:I?"grey":"teal",disabled:I,tooltipContents:Q,tooltipBehavior:I?"default":"hidden",dataCy:"ai-chat-send-button",alt:H,onClick:W,filled:!0,children:z}):(0,o.jsx)(X.IconButton,{disabled:!0,alt:"Connecting",children:(0,o.jsx)(ei.default,{})})})]})]})]})]})}var nr=new tW.ReactCompartment(function(e,t){return tF.EditorView.domEventHandlers({keydown:function(n,r){!((0,tV.currentCompletions)(r.state).length>0)&&("Enter"===n.key&&n.metaKey&&n.stopPropagation(),"Enter"===n.key&&!n.shiftKey)&&(n.preventDefault(),t||r.state.field(t2.isEmpty)||(e(r.state.doc.toString()),r.dispatch({changes:{from:0,to:r.state.doc.length}})))}})}),ni=e.i(69686);e.i(619231);var no=e.i(490338),na=e.i(394212);function ns(){var e=(0,ew._)(["\n  query GetRagAuthorization($replId: String!) {\n    getRepl(id: $replId) {\n      ... on Repl {\n        id\n        authorizations {\n          useRag {\n            isAuthorized\n            code\n            message\n          }\n        }\n      }\n    }\n  }\n"]);return ns=function(){return e},e}var nl={},nu=(0,ek.gql)(ns()),nc=e.i(299798);function nd(){var e,t,r,o=(0,i._)((0,a.useState)(null),2),s=o[0],l=o[1],u=(0,eI.default)(),c=(e={variables:{replId:u}},t=(0,n._)({},nl,e),e_.useQuery(nu,t)),d=c.data,f=c.refetch,p=(null==d||null==(r=d.getRepl)?void 0:r.__typename)==="Repl"&&d.getRepl.authorizations.useRag.isAuthorized;return(0,nc.usePid2)(function(e,t){var n=t.signal;return(0,m._)(function(){var t,r,i,o,a,s,u,c;return(0,x._)(this,function(d){switch(d.label){case 0:if(!p)return[2];t=e.viktor.subscribeCurrentState.subscribe({},{signal:n}).resReadable,r=!1,i=!1,d.label=1;case 1:d.trys.push([1,6,7,12]),a=(0,na._)(t),d.label=2;case 2:return[4,a.next()];case 3:if(!(r=!(s=d.sent()).done))return[3,5];if(!(u=s.value).ok)return l({error:u.payload.message}),[3,5];l(u.payload),d.label=4;case 4:return r=!1,[3,2];case 5:return[3,12];case 6:return c=d.sent(),i=!0,o=c,[3,12];case 7:if(d.trys.push([7,,10,11]),!(r&&null!=a.return))return[3,9];return[4,a.return()];case 8:d.sent(),d.label=9;case 9:return[3,11];case 10:if(i)throw o;return[7];case 11:return[7];case 12:return[2]}})})()},[p]),{isRagAuthorized:p,ragState:s,refetchRagAuthorization:(0,a.useCallback)(function(){f({replId:u})},[f,u])}}var nf=e.i(212596),np=e.i(659790),nh=e.i(231008),ng=e.i(395787),nm=e.i(127154),nv=e.i(559491),nx=e.i(117807),ny=e.i(448534),nb=e.i(341470),nw=e.i(98791),nk=e.i(140487),n_=e.i(796926),nS=e.i(73817);function nC(e){var t=e.disabled,n=e.disabledReason;(0,nb.useBeaconHandler)();var r=(0,no.useVisualSelector)({context:"assistant"}),i=r.isActive,s=r.setVisualSelectorEnabled,l=r.isSelectorScriptLoaded,u=r.element,c=r.setElement,d=r.isEditingSupported,f=(0,nv.isVisualSelectorIncompatibleStack)((0,nx.useAgentStackBlueprint)()),p=(0,nm.useIsVisualSelectorCompatibleWebviewAvailable)(),h=(0,tg.useIsMobile)({tablet:!0}),g=f||!l||!p||h;(0,ng.default)((0,a.useCallback)(function(e){i&&(e.preventDefault(),c(null),s(!1))},[i,c,s]));var m=(0,a.useRef)(null),x=(0,a.useCallback)(function(){s(!0,{isEditingEnabled:!1,shouldClearSelection:!1})},[s]),y=(0,nw.usePackageVersionCheck)(),b=y.shouldShowUpgradeModal,w=y.isUpgrading,k=y.checkVersionAndProceed,_=y.handleUpgradeConfirm,S=y.handleUpgradeCancel,C=y.handleModalClose,j=(0,a.useCallback)(function(){S(),x()},[S,x]),T=(0,a.useCallback)(function(){k()&&x()},[k,x]);if(g)return null;var E=!!n,R=d?"Visual Editor":"Element selector";return E&&(R=n),(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(tI.Tooltip,{isDisabled:!E,tooltip:R,placement:"top-start",children:(0,o.jsx)(nk.Button,{ref:m,clsx:nS.default.button,disabled:g||void 0!==t&&t,variant:i?"default":"nofill",colorway:i?"primary":void 0,size:"small",text:(null==u?void 0:u.componentName)?u.componentName:i?"":d?"Edit":"Select",onClick:T,iconLeft:(0,o.jsx)(n_.default,{size:16})})}),(0,o.jsx)(ny.UpgradeModal,{shouldShowUpgradeModal:b,isUpgrading:w,onUpgradeConfirm:_,onUpgradeCancel:j,onClose:C})]})}var nj=(0,Y.cssRecord)({attachments:[Q.rcss.px(4),Q.rcss.py(8)]});function nT(e){var t,n,r,i,s,l,h,g,y,b,_,S,R,I,A,P,O,N,B,V,F,U,G=e.assistantAuthz,$=e.sendMessage,z=e.stopMessage,H=e.openFile,W=e.openGitCommit,q=e.inputRef,K=e.isSessionLoading,Y=e.sessionId,Q=e.fileContextInclusions,X=e.dataAppTourGenerateCodeStep,J=e.portfolioWebsiteTourGenerateCodeStep,Z=e.shouldAutoscrollRef,ee=(0,c.useChatter)(),et=(0,f.useObservableMemo)(function(){return Y?ee.sessions.get(Y):null},[ee,Y],{default:null}),en=(0,p.useFlag)({controlName:"flag-agent-debug-info-button"}),er=(0,p.useFlag)({controlName:"flag-assistant-visual-editor-button"}),ei=(0,T.default)().fs;(0,nh.default)();var eo=(0,nf.useFindFiles)(ei),ea=(0,tu.useLastEvent)(et),es=(null==ea?void 0:ea.state)===u.EventState.IN_PROGRESS,el=(0,te.useUpdateFileContextPreferences)(),eu=(0,te.useExcludeAllFileContextPreferences)(),ec=(0,e7.useChatEngineModels)(),ed=(0,k.useIsAiClientConnected)(),ef=nd(),ep=ef.isRagAuthorized,eh=ef.ragState,eg=ef.refetchRagAuthorization;(0,a.useEffect)(function(){eg()},[null==G||null==(F=G.advancedAssistant)?void 0:F.isAuthorized,eg]);var em=(0,eV.useGlobalModal)().show,ev=(0,w.useAssistantChatMode)(),ex=ev.assistantMode,ey=ev.setAssistantMode,eb=(0,e7.useChatEngine)().limits.messageCharacters,ew=(0,j.useIsInMobileWorkspace)(),ek=(0,C.default)().showError,e_=(0,E.useAiChatAttachments)(),eS=e_.attachments,eC=e_.urlAttachments,ej=e_.removeAttachment,eT=e_.addAttachments,eE=e_.addUrlAttachment,eR=e_.removeUrlAttachment,eI=e_.clearAttachments,eA=e_.isLoading,eP=(i=(t={mode:ex,authz:G}).mode,s=t.authz,l=!0,h=void 0,"advanced"===i?(l=null!=(n=null==s?void 0:s.advancedAssistant.isAuthorized)&&n,h=null==s?void 0:s.advancedAssistant.message):"basic"===i&&(l=null!=(r=null==s?void 0:s.basicAssistant.isAuthorized)&&r,h=null==s?void 0:s.basicAssistant.message),(0,a.useMemo)(function(){return{isAuthorized:l,message:h}},[l,h])),eD=(y=(g={authz:eP,sendMessage:$,shouldAutoscrollRef:Z}).authz,b=g.sendMessage,_=g.shouldAutoscrollRef,S=(0,k.useIsAiClientConnected)(),R=nd().isRagAuthorized,A=(I=(0,no.useVisualSelector)({context:"assistant"})).setVisualSelectorEnabled,P=I.element,N=(O=(0,w.useAssistantChatMode)()).getAssistantMessageIntent,B=O.getAssistantMessageModel,V=O.getAssistantMode,(0,a.useCallback)(function(e,t){if(S){var n=B(y);(0,M.track)(L.events.ASSISTANT_USED,{action:"message_sent",assistant_mode:V(),message_content:e,message_source:"chat_pane",message_surface:"workspace_ai_pane",is_agent_repl:!0}),b({message:e,attachments:t,useRag:R,modelType:n,intent:N(),webviewTargetedElement:null!=P?P:void 0}),_.current=!0,A(!1)}},[S,N,V,B,y,b,R,_,P,A])),eO=(0,tn.default)(),eN=eO.ref,eM=eO.view,eL=null!=(U=(0,tt.useCodeMirrorValue)(eM,ts.detectedUrlsState))?U:[],eB=(0,D.useObservable)(eA),eF=(0,D.useObservable)(eS);return(0,o.jsx)(o.Fragment,{children:(0,o.jsx)(nn,{codemirrorRef:eN,view:eM,assistantModeAuthz:eP,placeholderText:"Ask ".concat(d.ASSISTANT_NAME,", use @ to include specific files..."),isPasteAndDropSupported:!0,isConnected:ed,inputRef:q,isLastEventInProgress:es,isSessionLoading:K,isSubmitDisabled:eB,submitDisabledReason:eA?"Please wait for files to finish uploading":null,findFiles:eo,fileContextInclusions:Q,updateFileContext:function(e){return el(e.path,e.preference)},openFile:H,openGitCommit:W,maxLength:eb,onStop:z,onSubmit:function(e){return(0,m._)(function(){return(0,x._)(this,function(t){return eP.isAuthorized&&(eD(e,(0,e9._)(eS.current).concat((0,e9._)(eC.current.map(function(e){return e.file})))),eI(),e.trim().length>0&&((null==X?void 0:X.isActive)?X.next():(null==J?void 0:J.isActive)&&J.next())),[2]})})()},analyticsSurface:"workspace_ai_sidebar",attachments:(0,o.jsx)(ti.default,{css:nj.attachments,detectedUrls:eL.map(function(e){return(0,o.jsx)(to.default,{source:"workspace",url:e,addUrlAttachment:eE,removeUrlAttachment:eR,onError:ek},e)}),fileAttachments:eF.map(function(e){return(0,o.jsx)(ta.FileAttachment,{attachment:e,removeAttachment:ej,getAttachmentTypeDisclaimer:(0,tl.getAttachmentTypeDisclaimer)({aiName:d.ASSISTANT_NAME}),imagesDisabledMessage:"basic"===ex?"".concat(d.ASSISTANT_NAME," can't see images in Basic mode"):void 0},e.path)})}),attachmentButton:(0,o.jsx)(tr.AttachmentButton,{source:"workspace",status:K?"loading":"composing",addAttachments:eT}),addAttachments:eT,debugButton:en&&Y?(0,o.jsx)(np.AiSessionDebugInfoButton,{sessionId:Y,sessionType:u.SessionType.CHAT}):void 0,fileContextButton:(0,o.jsx)(ni.FileContextButton,{isInMobileWorkspace:ew,onChange:function(e){return el(e.path,e.preference)},unSelectAll:function(e){return eu(e.paths)},findFiles:eo,fileContextInclusions:Q,isRagAuthorized:ep,ragState:eh}),controlBar:(0,o.jsx)(tO,{availableModels:ec,assistantAdvancedAuthz:null==G?void 0:G.advancedAssistant,onModeSelectChange:function(e){return(0,m._)(function(){return(0,x._)(this,function(t){switch(t.label){case 0:if(!(!(null==G?void 0:G.advancedAssistant.isAuthorized)&&"advanced"===e))return[3,2];return[4,em("MembershipPurchaseModal",{analyticsContext:{upgrade:{context:"ai_model_selector",surface:"ghostwriter_power_up_dialog"}}})];case 1:return t.sent(),[2];case 2:return e!==ex&&(0,M.track)(L.events.ASSISTANT_USED,{action:"mode_changed",intent_type:null,mode:e,message_content:null,message_source:"chat_pane",message_surface:"workspace_ai_pane"}),ey(e),[2]}})})()}}),visualSelectorButton:er?(0,o.jsx)(nC,{}):void 0})})}var nE=(0,Y.cssRecord)({surface:[Q.rcss.borderRadius(),Q.rcss.textAlign.center],buttonContainer:[Q.rcss.width("100%"),Q.rcss.justify.center]});function nR(e){var t=e.assistantAuthz,r=e.getFileContext,i=e.hideInput,a=(0,eL._)(e,["assistantAuthz","getFileContext","hideInput"]),s=(0,eV.useGlobalModal)().show,l=(0,eh.useIsFreemiumStarterPlanUsersOwnRepl)().isFreemiumStarterPlanUsersOwnRepl,u=(0,eW.useIsGuestInStarterPlanUserRepl)(),c=(0,W.useGetAssistantFreeUsage)().assistantEdits,f=(0,w.useAssistantChatMode)(),h=f.assistantMode,g=f.setAssistantMode,y=!!("advanced"===h&&l&&!(null==c?void 0:c.isUnderQuota)),k=(null==t?void 0:t.advancedAssistant.code)===b.OrgAuthorizationCode.PaymentDelinquent,_=(0,p.useFlag)({controlName:"flag-freemium-ai-load-shedder"}),S=(0,eq.default)(),C=function(){(0,M.track)(L.events.ASSISTANT_USED,{action:"mode_changed",intent_type:null,mode:"basic",message_content:null,message_source:"chat_pane",message_surface:"workspace_ai_pane"}),g("basic")};return y?(0,o.jsx)(en.View,{py:8,px:6,children:(0,o.jsxs)(eg.Surface,{elevated:!0,css:nE.surface,py:8,px:12,gap:8,align:"center",children:[(0,o.jsxs)(et.Text,{variant:"subheadDefault",children:["You've run out of free ",d.ASSISTANT_NAME," ",(0,eB.default)(z.ASSISTANT_USAGE_UNIT)]}),(0,o.jsxs)(et.Text,{children:["Upgrade to ",$.corePlanName," to continue generating code. You can still ask ",d.ASSISTANT_NAME," questions in Basic mode."]}),(0,o.jsxs)(en.View,{css:nE.buttonContainer,row:!0,gap:8,children:[(0,o.jsx)(nk.Button,{text:"Upgrade to ".concat($.corePlanName),iconLeft:(0,o.jsx)(tS.default,{}),onClick:function(){return(0,m._)(function(){return(0,x._)(this,function(e){switch(e.label){case 0:return[4,s("MembershipPurchaseModal",{analyticsContext:{upgrade:{context:"assistant_freemium_quota"}},onPurchaseComplete:S})];case 1:return e.sent(),[2]}})})()},colorway:"brand"}),(0,o.jsx)(nk.Button,{text:"Switch to Basic mode",onClick:function(){return C()}})]})]})}):i?null:k?(0,o.jsx)(e$,{}):l&&_?(0,o.jsx)(ez.FreemiumTemporarilyUnavailable,{aiName:d.ASSISTANT_NAME}):u?(0,o.jsx)(en.View,{p:8,children:(0,o.jsx)(eH.GuestsNotAllowedToUseAiInStarterPlanRepls,{aiName:d.ASSISTANT_NAME})}):(0,o.jsxs)(en.View,{px:8,pb:8,children:[(0,o.jsx)(e6,{assistantAuthz:t}),(0,o.jsx)(nT,(0,n._)({assistantAuthz:t,getFileContext:r},a))]})}var nI=(0,a.forwardRef)(function(e,t){var s,l,d,p,h,g,D,O,N,M,L,B,V,F,U,G,$,z,H,W,q=(0,S.default)(),K=e.openPane,Y=e.onSessionChange,Q=e.removePane,X=(0,i._)((0,a.useState)(null!=(W=e.initialSessionId)?W:null),2),J=X[0],Z=X[1],ee=(0,i._)((0,a.useState)(!1),2),et=ee[0],en=ee[1],er=(0,c.useChatter)(),ei=(0,f.useObservableMemo)(function(){return J?er.sessions.get(J):null},[er,J],{default:null}),eo=(0,_.useChatSidebarState)();(0,a.useImperativeHandle)(t,function(){return{updateActiveSessionId:function(e){Z(null!=e?e:null)},openSettingsPanel:e$.openSettingsPanel,toggleSidebar:function(){eo.toggleSidebar()}}}),(0,a.useEffect)(function(){null==Y||Y(J)},[Y,J]),s=(0,i._)((0,eP.useGetAssistantFreeUsageLazyQuery)({fetchPolicy:"network-only",ssr:!1}),1)[0],l=(0,a.useMemo)(function(){return(0,eA.default)(s,2e3,{trailing:!0})},[s]),(0,c.useChatHook)("received-completed-event",function(e){var t=e.event.contents.contents;(0,eD.isKind)(t,"messageEventContents")&&(0,eD.unkind)(t).assistantProposedActions.didCountEditRequest&&l()});var ea=(0,k.useIsRiverProtocolError)(),es=(0,a.useRef)(!1),el=(0,i._)((0,a.useState)(null),2),eu=el[0],ec=el[1],ed=(0,y.useRouter)(),ef=(0,j.doesBonsaiWebviewSupportFeature)(ed,"hideChatInput"),ep=(h=(0,eI.default)(),D=(g=(0,eR.useOrgId)(h)).orgId,O=g.loading,N=g.hasError,V=(M={variables:{orgId:D}},L=(0,n._)({},ej,M),B=e_.useQuery(eE,L)).data,F=B.loading,U=B.error,G=B.refetch,O||N||F||U?{refetch:G,loading:O||F}:void 0===D?{authorizations:(null==V||null==(p=V.currentUser)?void 0:p.personalOrgAuthorizations.__typename)==="OrgAuthorizations"?V.currentUser.personalOrgAuthorizations:void 0,refetch:G,loading:!1}:{authorizations:(null==V||null==(d=V.currentUser)?void 0:d.org.__typename)==="Org"?V.currentUser.org.authorizations:void 0,refetch:G,loading:!1}),eh=ep.authorizations,eg=ep.loading,em=(0,w.useAssistantChatMode)().getAssistantMode;function ew(e){if(Z(e),!q&&(null==eu||eu.focus(),!e)){var t;null==eu||null==(t=eu.setValue)||t.call(eu,"")}}var ek=(0,a.useCallback)(function(e){return K((0,eM.getPaneForFile)(e))},[K]),eS=(0,a.useCallback)(function(e){return K({type:"git",data:{mode:{type:eb.GitPaneModeType.COMMIT,hash:e}}})},[K]),eC=(0,T.default)(),eT=eC.fs,eL=eC.dotReplit,eB=(0,ey.useFileContext)({recentFilesObservable:(0,eN.useRecentFilesObservable)(),getFileContext:(0,eO.useGetFileContext)(eT,eL),assistantMode:em()}),eV=eB.fileContextInclusions,eF=eB.getFileContext,eU=e.inputRef,eG=(0,a.useCallback)(function(e){ec(e),null==eU||eU(e)},[eU]),e$=(z=($=(0,i._)((0,a.useState)(!1),2))[0],H=$[1],{isSettingsPanelOpen:z,openSettingsPanel:(0,a.useCallback)(function(){return H(!0)},[]),openUserSettingsPane:(0,a.useCallback)(function(){K({type:"preferences"})},[K]),setIsSettingsPanelOpen:H}),ez=!!(null==eh?void 0:eh.advancedAssistant.isAuthorized),eH=(null==eh?void 0:eh.advancedAssistant.code)===b.OrgAuthorizationCode.PaymentDelinquent,eW=(0,a.useCallback)(function(e){var t=e.message,n=e.attachments,r=e.useRag,i=e.modelType,o=e.intent,a=e.webviewTargetedElement;return(0,m._)(function(){var e,s,l,c,d,f;return(0,x._)(this,function(p){switch(p.label){case 0:if(et)return[2];if(en(!0),e=ei)return[3,2];return[4,er.sessions.create({sessionType:u.SessionType.CHAT})];case 1:if(!(s=p.sent()).ok)return en(!1),[2];e=s.payload,p.label=2;case 2:return Z(e.id),l=n.map(function(e){return{path:e.path,mimeType:e.file.type}}),[4,eF()];case 3:return d=(c=p.sent()).fileContext,f=c.mostRecentFile,[4,e.appendEvent({kind:"message",intent:o,modelType:i,message:t,uploadedFiles:l,useRag:r,webviewTargetedElement:a,fileContext:d,mostRecentFile:f})];case 4:return p.sent(),en(!1),[2]}})})()},[et,ei,eF,er]),eq=(0,a.useCallback)(function(){return(0,m._)(function(){return(0,x._)(this,function(e){switch(e.label){case 0:if(!ei)return[3,2];return[4,ei.abortLastEvent()];case 1:e.sent(),en(!1),e.label=2;case 2:return[2]}})})()},[ei]),eK=(0,R.useUploadFilesHandler)(),eY=(0,C.default)().showError;return(0,o.jsx)(E.AiChatAttachmentsProvider,{sessionId:null!=J?J:void 0,uploadFiles:eK,onError:eY,children:(0,o.jsxs)(ev,(0,r._)((0,n._)({sessionId:J,setSessionId:ew,onNewSessionClick:function(){ew(null),null==eu||eu.animatePlaceholder()},sidebarState:eo},e$),{children:[ei?(0,o.jsx)(P.ChatEvents,{openPane:K,removePane:Q,sessionId:null==ei?void 0:ei.id,shouldAutoscrollRef:es,openAiChatSettingsPanel:e$.openSettingsPanel}):(0,o.jsx)(ex.SessionEmptyState,{showPromptSuggestions:!ef,sessionType:u.SessionType.CHAT,onPromptSuggestionClick:eu?function(e){var t;null==eu||null==(t=eu.setValue)||t.call(eu,e.text),q||null==eu||eu.focus()}:void 0,onSwitchToAgent:function(){return K({type:"agentChat"})},openAiChatSettingsPanel:e$.openSettingsPanel,titleContent:eg||ez?null:(0,o.jsx)(I.AssistantFreeModeUpsellTitle,{}),footerContent:eg||ez||eH?void 0:(0,o.jsx)(I.AssistantFreeModeUpsell,{})}),ea?(0,o.jsx)(A.ChatError,{}):(0,o.jsx)(nR,{assistantAuthz:eh,sendMessage:eW,stopMessage:eq,openFile:ek,openGitCommit:eS,inputRef:eG,isSessionLoading:et,sessionId:J,getFileContext:eF,fileContextInclusions:eV,shouldAutoscrollRef:es,hideInput:ef})]}))})}),nA=e.i(842962);e.i(282890);var nP=e.i(716636),nD=e.i(953299),nO=e.i(259493),nN=e.i(291883),nM=e.i(717368),nL=e.i(606867),nB=e.i(883002),nV=e.i(357399),nF=s.Type.Object({type:s.Type.Literal("ghostwriterChat"),data:s.Type.Optional(s.Type.Object({sessionId:s.Type.Optional(s.Type.String()),newSessionType:s.Type.Optional(s.Type.Enum(u.SessionType))}))}),nU=(0,Y.cssRecord)({root:[Q.rcss.center,Q.rcss.flex.growAndShrink(1),Q.rcss.p(16)]});function nG(){return(0,o.jsx)(en.View,{css:nU.root,children:(0,o.jsx)(et.Text,{children:"AI is disabled for this team"})})}var n$={Content:function(e){var t=e.pane.data,s=e.options,l=(0,c.useChatter)(),u=(0,f.useObservableMemo)(function(){return(null==t?void 0:t.sessionId)?l.sessions.get(t.sessionId):null},[l,null==t?void 0:t.sessionId],{default:null}),d=(0,p.useFlag)({controlName:"flag-killswitch-ghostwriter-chat",logFlagToAnalytics:!1}),m=s.performPaneOperation,x=(0,a.useCallback)(function(e){m({operation:"open",pane:e,secondary:!0})},[m]),y=(0,a.useCallback)(function(e){m({operation:"remove",pane:{id:e}})},[m]),b=(0,i._)((0,a.useState)(null),2),w=b[0],k=b[1];(0,nO.useSetFocusTarget)(function(){return w},[w]);var _=(0,a.useRef)(""),S=(0,a.useRef)(null==t?void 0:t.sessionId),C=(0,a.useRef)(null==t?void 0:t.sessionId),j=(0,a.useRef)(null);(0,a.useEffect)(function(){if(C.current!==(null==t?void 0:t.sessionId)){var e;C.current=null==t?void 0:t.sessionId,null==(e=j.current)||e.updateActiveSessionId(null==t?void 0:t.sessionId)}},[null==t?void 0:t.sessionId]);var T=(0,a.useCallback)(function(e){C.current!==e&&(C.current=null!=e?e:void 0,m({operation:"replace",pane:{type:"ghostwriterChat",data:e?{sessionId:e}:void 0}}))},[m]),E=(0,g.useAIFeedbackCommand)(u,void 0,"assistant_chat"),R=E.FeedbackModal,I=E.feedbackCommandGroup,A=(0,nD.useUsageCommand)({sessionId:null==t?void 0:t.sessionId,type:"assistant"}).usageCommand;return((0,nO.useSetPaneBindings)(function(){var e={type:"ghostwriterChat",setInputText:w?w.setValue:function(e){_.current=e}},t=[{name:"Chat",commands:[{data:{type:"action",icon:(0,o.jsx)(nM.default,{}),label:"New chat",run:function(){T(null),null==w||w.animatePlaceholder()}}},{data:{type:"action",icon:(0,o.jsx)(nB.default,{}),label:"All chats",run:function(){var e;null==(e=j.current)||e.toggleSidebar()}}}]},{name:"Settings",commands:[A,{data:{type:"action",icon:(0,o.jsx)(nV.default,{}),label:"Settings",run:function(){var e;null==(e=j.current)||e.openSettingsPanel()}}}]},I];return(0,r._)((0,n._)({},e),{commands:t})},[w,T,j,A,I]),(0,h.useIsTeamWithAiDisabled)().isTeamWithAiDisabled)?(0,o.jsx)(nG,{}):d?(0,o.jsx)(nA.default,{textVariant:"headerDefault",showImage:!0}):(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(nI,{ref:j,inputRef:k,initialSessionId:S.current,openPane:x,removePane:y,analyticsMessageSurface:"workspace_ai_pane",onSessionChange:T}),(0,o.jsx)(R,{})]})},Icon:function(e){var t=e.size,n=e.color;return(0,o.jsx)(nL.IconContext.Provider,{value:{color:n,size:t},children:n?(0,o.jsx)(nN.default,{color:n}):(0,o.jsx)(tA.default,{})})},getTitle:function(){return d.ASSISTANT_NAME},description:d.ASSISTANT_DESCRIPTION,category:nP.PaneCategory.WorkspaceFeatures,decode:function(e){return l.Value.Decode(nF,e)}};e.s(["ghostwriterChatUI",()=>n$],866585)},625108,e=>{"use strict";var t=e.i(530658),n=e.i(633600),r=e.i(705705),i="HEAD -> ",o="refs/heads/",a="refs/remotes/",s="tag: ",l="refs/tags/",u=/^refs\/remotes\/([^/]+)\/HEAD$/;e.s(["parseGitRef",()=>function e(c){var d;switch("HEAD"===(d=c)||"refs/HEAD"===d||d.startsWith(i)?r.GitRefType.HEAD:d.startsWith(o)?r.GitRefType.BRANCH:d.startsWith(a)?u.test(d)?r.GitRefType.REMOTE_HEAD:r.GitRefType.REMOTE_BRANCH:d.startsWith(l)||d.startsWith(s)?r.GitRefType.TAG:r.GitRefType.BRANCH){case r.GitRefType.HEAD:if(c.startsWith(i)){if(c.endsWith("(detached)"))return{type:r.GitRefType.HEAD,name:"HEAD",detached:!0,ref:null};return{type:r.GitRefType.HEAD,name:"HEAD",detached:!1,ref:e(c.slice(i.length))}}return{type:r.GitRefType.HEAD,name:"HEAD",detached:!1,ref:null};case r.GitRefType.REMOTE_HEAD:var f=c.slice(a.length),p=(0,t._)(f.split("/"),1)[0];return{type:r.GitRefType.REMOTE_HEAD,name:"HEAD",remote:p};case r.GitRefType.BRANCH:return{type:r.GitRefType.BRANCH,name:c.startsWith(o)?c.slice(o.length):c};case r.GitRefType.REMOTE_BRANCH:var h=c.slice(a.length),g=(0,n._)(h.split("/")),m=g[0],x=g.slice(1).join("/");return{type:r.GitRefType.REMOTE_BRANCH,name:h,remote:m,branch:x};case r.GitRefType.TAG:return c.startsWith(s)&&(c=c.slice(s.length)),c.startsWith(l)&&(c=c.slice(l.length)),{type:r.GitRefType.TAG,name:c}}}])},167193,e=>{"use strict";var t=e.i(297083),n=e.i(530658),r=e.i(346715),i=e.i(817556),o=e.i(627557),a=e.i(625108),s=e.i(680183),l=e.i(705705);function u(e,t){return!!e&&!!t&&(e===t||e.name===t.name&&e.remote===t.remote)}function c(e){var t=(0,n._)(e.split("	"),6),r=t[0],i=t[1],u=t[2],c=t[3],d=t[4],f=t[5],p=(0,a.parseGitRef)(r),h={hash:u,author:{name:c,email:(0,o.removeGitEmailBrackets)(d),date:1e3*parseInt(f,10)}};if(p.type===l.GitRefType.BRANCH){var g=i?(0,a.parseGitRef)(i):null,m=g&&(g.type===l.GitRefType.REMOTE_BRANCH||g.type===l.GitRefType.BRANCH)?g:null;return{type:s.GitBranchType.LOCAL,name:p.name,push:m,remote:null,tracking:null,commit:h}}return p.type===l.GitRefType.REMOTE_BRANCH?{type:s.GitBranchType.REMOTE,name:p.branch,remote:p.remote,push:null,tracking:null,commit:h}:null}function d(e){return(0,t._)(function(e){var t,n,a=arguments;return(0,i._)(this,function(i){switch(i.label){case 0:return[4,e(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(!1===e.local&&!1===e.remote)throw Error("Cannot specify both local and remote as false");var t=[];if(t.push('--format="%(refname)%09%(push)%09%(objectname)%09%(authorname)%09%(authoremail)%09%(authordate:unix)"'),e.max&&t.push("--count=".concat(e.max)),e.pattern)if("string"==typeof e.pattern)t.push((0,o.wrapInSingleQuotes)(e.pattern));else{var n,i,a=e.pattern.map(function(e){return(0,o.wrapInSingleQuotes)(e)});t.push.apply(t,(0,r._)(a))}else(null==(n=e.local)||n)&&t.push("refs/heads"),(null==(i=e.remote)||i)&&t.push("refs/remotes");return"git for-each-ref ".concat(t.join(" "))}(a.length>1&&void 0!==a[1]?a[1]:{}),{serviceMethod:"git-list-branches"})];case 1:if((t=i.sent()).error)return[2,t];return(n=function(e){var t=[],n=[],i=!0,o=!1,a=void 0;try{for(var u,c=e[Symbol.iterator]();!(i=(u=c.next()).done);i=!0){var d=u.value;d.type===s.GitBranchType.LOCAL?t.push(d):d.type===s.GitBranchType.REMOTE&&n.push(d)}}catch(e){o=!0,a=e}finally{try{i||null==c.return||c.return()}finally{if(o)throw a}}var f=new Set,p=[],h=!0,g=!1,m=void 0;try{for(var x,y=n[Symbol.iterator]();!(h=(x=y.next()).done);h=!0)!function(){var e=x.value,n=t.find(function(t){return t.push&&t.push.type===l.GitRefType.REMOTE_BRANCH&&t.push.remote===e.remote&&t.push.branch===e.name&&t.name===e.name});n&&(f.add(e),f.add(n),p.push({type:s.GitBranchType.TRACKED,name:n.name,remote:e.remote,push:n.push,tracking:e,commit:n.commit}))}()}catch(e){g=!0,m=e}finally{try{h||null==y.return||y.return()}finally{if(g)throw m}}var b=e.filter(function(e){return!f.has(e)});return(0,r._)(b).concat((0,r._)(p))}((0,o.splitTrimFilter)(t.output,"\n").map(c).filter(function(e){return null!==e}))).sort(function(e,t){return t.commit.author.date-e.commit.author.date}),[2,{branches:n,error:null}]}})}).apply(this,arguments)}e.s(["branchesEqual",()=>u,"default",()=>d])},137804,730792,520739,e=>{"use strict";var t=e.i(297083),n=e.i(530658),r=e.i(817556),i=e.i(276385),o=e.i(389959),a=e.i(529810),s=e.i(346715),l=e.i(541793),u=e.i(161322),c=(0,o.createContext)(null),d=(0,o.createContext)(null);function f(){var e=(0,o.useContext)(c);if(!e)throw Error("Expected store in context");return e}var p=(0,l.atom)([]),h=(0,l.atom)(function(e){return e(p)},function(e,t,n){var r=e(p),i=Math.random().toString(36).substring(7);t(p,[{id:i,type:n,dismiss:function(){var n=e(p).filter(function(e){return e.id!==i});t(p,n)}}].concat((0,s._)(r)))});function g(){return(0,u.useAtomValue)(h,{store:f()})}function m(){return(0,u.useSetAtom)(h,{store:f()})}function x(){var e=(0,o.useContext)(d);if(!e)throw Error("Expected mode switcher in context");return e}e.s(["GitPaneErrorContext",()=>c,"GitPaneModeSwitcherContext",()=>d,"useGitErrorList",()=>g,"useGitPaneModeSwitcher",()=>x,"useNotifyGitError",()=>m],730792);var y=e.i(878420),b=e.i(709485),w=e.i(858248);function k(e,t){(0,w.track)(b.events.GIT_FEATURE_USED,(0,y._)({action:e,source:"git-pane"},t))}e.s(["trackGitPaneEvent",()=>k],520739);var _=e.i(446530),S=e.i(613355),C=e.i(140487),j=e.i(127227),T=e.i(960178),E=e.i(625484),R=e.i(450565),I=e.i(940745),A=(0,_.cssRecord)({checkboxLabel:S.rcss.rowWithGap(8)});function P(){var e=(0,o.useId)(),s=(0,n._)((0,o.useState)(!0),2),l=s[0],u=s[1],c=(0,n._)((0,o.useState)(!1),2),d=c[0],f=c[1],p=m(),h=(0,a.default)().git;return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(C.Button,{text:d?"Initializing...":"Initialize Git Repository",iconLeft:d?(0,i.jsx)(I.default,{}):(0,i.jsx)(R.default,{}),colorway:"primary",loading:d,onClick:function(){return(0,t._)(function(){var e;return(0,r._)(this,function(t){switch(t.label){case 0:if(d)return[2];return f(!0),[4,h.init({initialCommit:l,includeAllInitialFiles:!0})];case 1:return(e=t.sent()).error?(f(!1),p(e.error)):(h.forceRefresh(),k("repository-initialized")),[2]}})})()}}),(0,i.jsxs)(E.View,{css:A.checkboxLabel,tag:"label",children:[(0,i.jsx)(j.Checkbox,{id:e,checked:l,onChange:function(e){return u(e)},size:"small"}),(0,i.jsx)(T.Text,{variant:"small",multiline:!1,children:"Create initial commit with all changes"})]})]})}e.s(["default",()=>P],137804)},791675,e=>{"use strict";var t,n,r=((t={}).FS_CHANGE="FS_CHANGE",t.FORCED_REFRESH="FORCED_REFRESH",t.NEW_PROFILE="NEW_PROFILE",t.CHANGED_PROFILE="CHANGED_PROFILE",t),i=((n={}).REPLIT_DEFAULT="REPLIT_DEFAULT",n.GITHUB="GITHUB",n.BITBUCKET="BITBUCKET",n.GITLAB="GITLAB",n);e.s(["GitEvent",()=>r,"GitProfileProvider",()=>i])},691490,242816,39838,856392,618277,e=>{"use strict";var t=e.i(276385),n=e.i(297083),r=e.i(817556),i=e.i(825118),o=e.i(993796),a=e.i(597865),s=e.i(530658),l=e.i(389959),u=e.i(791675),c=e.i(142685),d=e.i(921521),f=e.i(191060),p=e.i(529810),h=e.i(520739);function g(){var e=(0,a.default)(function(e){return(0,n._)(function(){return(0,r._)(this,function(t){return[2,{connectedToGithub:m(e),error:null}]})})()});return null==e||e.error?null:e.connectedToGithub}function m(e){return e.hasProfile(u.GitProfileProvider.GITHUB)}e.s(["default",()=>g,"isConnectedToGithub",()=>m],242816);var x=e.i(140487),y=e.i(616278),b=e.i(523579),w=e.i(940745);function k(e){var n=e.label,r=e.allowReconnect,i=e.callback,o=(0,s._)((0,l.useState)(!1),2),a=o[0],m=o[1],k=(0,p.default)().git,_=g(),S=(0,d.default)(),C=(0,f.useAuthGithub)({onAuth:function(){(0,h.trackGitPaneEvent)("github-user-connected"),m(!1),k.refreshProfiles({preferredProvider:u.GitProfileProvider.GITHUB}),null==i||i()},onClose:function(){return m(!1)}});return _&&!(void 0!==r&&r)?(0,t.jsx)(x.Button,{text:"Connected to GitHub",colorway:"primary",iconLeft:(0,t.jsx)(y.default,{}),disabled:!0}):(0,t.jsx)(x.Button,{text:a||null===_?"Connecting...":S?"Visit account page to connect to GitHub":void 0===n?"Connect to GitHub":n,colorway:"primary",iconLeft:a?(0,t.jsx)(w.default,{}):(0,t.jsx)(b.default,{}),loading:a,onClick:function(){S?c.desktopAppApi.openExternalUrl("/account#connected-services"):(m(!0),C())}})}e.s(["default",()=>k],39838);var _=e.i(730792),S=e.i(167626),C=e.i(627557),j=e.i(464121);function T(e){return!!e&&("string"==typeof e?e.includes(j.GITHUB_URL):e.fetch.includes(j.GITHUB_URL))}function E(e){return!!e&&("string"==typeof e?e.includes(j.BITBUCKET_URL):e.fetch.includes(j.BITBUCKET_URL))}function R(e){return!!e&&("string"==typeof e?e.includes(j.GITLAB_URL):e.fetch.includes(j.GITLAB_URL))}function I(e){return e.endsWith(".git")?e.slice(0,-4):e}function A(e){if(!e)return null;var t="string"==typeof e?e:e.fetch;return T(t)||R(t)||E(t)?I(t):null}function P(e,t){var n=null,r=null;if((0,S._)(e,Map)){var i=(0,C.splitRemoteFromBranch)(t),o=i[0];if(n=i[1],!o||!n)return null;var a=e.get(o);if(!a)return null;r=A(a)}else n=t,r=A(e);return r&&T(r)?"".concat(r,"/tree/").concat(n):null}function D(e){var t="string"==typeof e?e:e.fetch;if(T(t)||E(t)||R(t)){var n=(t=I(t)).split("/");if(n.length<2)return null;var r=n[n.length-2],i=n[n.length-1];return"".concat(r,"/").concat(i)}return null}e.s(["navigationURLForRemote",()=>A,"navigationURLForRemoteBranch",()=>P,"remoteURLIsBitbucket",()=>E,"remoteURLIsGitHub",()=>T,"remoteURLIsGitLab",()=>R,"simpleNameForRemote",()=>D],856392);var O=e.i(526962),N=e.i(446530),M=e.i(613355),L=e.i(929872),B=e.i(960178),V=e.i(625484),F=e.i(283110),U=e.i(357399),G=(0,N.cssRecord)({body:[M.rcss.borderRadius(0,0,8,8)],remedies:[M.rcss.flex.wrap,{gap:"8px"}]});function $(e){var n=e.description,r=e.remedies,i=e.error;return(0,t.jsxs)(L.Surface,{css:G.body,p:4,gap:8,elevated:!0,children:[(0,t.jsx)(B.Text,{children:n}),(0,t.jsxs)(V.View,{css:G.remedies,row:!0,align:"center",justify:"end",children:[r,(0,t.jsx)(x.Button,{text:"Dismiss",iconLeft:(0,t.jsx)(F.default,{}),onClick:i.dismiss})]})]})}function z(e){var s=e.error,l=(0,o.useFlag)({controlName:"flag-github-connection-migration",default:!1}),u=(0,_.useGitPaneModeSwitcher)(),c=(0,a.default)(function(e){return(0,n._)(function(){var n,o,a,c,d,f,p,h,g,y;return(0,r._)(this,function(r){switch(r.label){case 0:switch(s.type){case i.GitErrors.UNKNOWN_NOT_GIT:return[3,1];case i.GitErrors.UNKNOWN:return[3,2];case i.GitErrors.CHANNEL_CLOSED:return[3,3];case i.GitErrors.NOT_INITIALIZED:return[3,4];case i.GitErrors.UNAUTHENTICATED:return[3,5];case i.GitErrors.INDEX_FILE_CORRUPT:return[3,7];case i.GitErrors.UNKNOWN_REMOTE:return[3,8];case i.GitErrors.UNKNOWN_REF:return[3,9];case i.GitErrors.INDEX_LOCKED:return[3,10];case i.GitErrors.NO_COMMITS:return[3,11];case i.GitErrors.PATH_MATCHED_NO_FILES:return[3,12];case i.GitErrors.USER_NOT_CONFIGURED:return[3,13];case i.GitErrors.INVALID_REFERENCE:return[3,14];case i.GitErrors.BRANCH_ALREADY_EXISTS:return[3,15];case i.GitErrors.MERGE_CONFLICT:return[3,16];case i.GitErrors.UPSTREAM_NOT_SET:return[3,17];case i.GitErrors.HEAD_DETACHED:return[3,18];case i.GitErrors.DIRTY_WORKTREE:return[3,19];case i.GitErrors.PROTECTED_BRANCH:return[3,20];case i.GitErrors.PUSH_REJECTED:return[3,21];case i.GitErrors.REMOTE_ALREADY_EXISTS:return[3,22];case i.GitErrors.TIMEOUT:return[3,23];case i.GitErrors.ALREADY_INITIALIZED:return[3,24];case i.GitErrors.PRE_COMMIT_HOOK_FAILED:return[3,25]}return[3,26];case 1:return n="Unknown error from the Git service. This is probably a bug in the app.",o=null,[3,27];case 2:return n="There was an unrecognized fatal error with Git. This is probably a bug in the app.",o=null,[3,27];case 3:return n="The command was interrupted. Please try again.",o=null,[3,27];case 4:return n="There isn't a Git repository in the Repl's root directory.",o=null,[3,27];case 5:return[4,e.getRemotes()];case 6:if((a=r.sent()).error)return[2,a];if(0!==a.remotes.size){c=!1,d=!0,f=!1,p=void 0;try{for(h=a.remotes.values()[Symbol.iterator]();!(d=(g=h.next()).done);d=!0)if(y=g.value,T(y)){c=!0;break}}catch(e){f=!0,p=e}finally{try{d||null==h.return||h.return()}finally{if(f)throw p}}if(l)return n="Failed to authenticate with the remote. Please ensure you have a valid connection to authenticate with the current remote.",o=(0,t.jsx)(x.Button,{colorway:"primary",iconLeft:(0,t.jsx)(U.default,{}),text:"Edit Settings",onClick:function(){u({type:O.GitPaneModeType.SETTINGS}),s.dismiss()}}),[3,27];if(c){if(m(e))return n="Failed to authenticate with the remote. Please ensure that Replit has access to this repository on GitHub.",o=(0,t.jsx)(k,{label:"Update GitHub Repository Access",callback:s.dismiss,allowReconnect:!0}),[3,27];return n="Failed to authenticate with the remote. You have not connected your Replit account to GitHub, so Replit may not have access to the remote repository. Please connect your account to GitHub and try again.",o=(0,t.jsx)(k,{label:"Connect to GitHub",callback:s.dismiss,allowReconnect:!0}),[3,27]}}return n="Failed to authenticate with the remote.",o=null,[3,27];case 7:return n="The Git index file is corrupt. This can happen if the index file is manually edited, or if the Git repository is corrupted.",o=null,[3,27];case 8:return n="The remote specified isn't configured.",o=null,[3,27];case 9:return n="Remote ref of current branch is missing, publish your branch or restore the remote branch",o=null,[3,27];case 10:return n="Git tried to perform an action but the index lockfile still exists. This means Git either crashed previously or is still running an action.",o=null,[3,27];case 11:return n="There are no commits in the repository.",o=null,[3,27];case 12:return n="The path specified didn't match any files.",o=null,[3,27];case 13:return n="There isn't any user information configured for Git.",o=null,[3,27];case 14:return n="An unknown/invalid reference was specified. This is usually a branch, but it could be something else, such as a tag.",o=null,[3,27];case 15:return n="The branch specified already exists.",o=null,[3,27];case 16:return n="There was an unexpected merge conflict.",o=null,[3,27];case 17:return n="The upstream branch isn't set.",o=null,[3,27];case 18:return n="The HEAD is detached. You have a commit checked out, not a branch.",o=null,[3,27];case 19:return n="There are uncommitted changes.",o=null,[3,27];case 20:return n="This operation cannot be performed on a protected branch.",o=null,[3,27];case 21:return n="The push was rejected by the remote. This is usually because the remote has commits that aren't in the local repository.",o=null,[3,27];case 22:return n="The remote specified already exists.",o=null,[3,27];case 23:return n="The remote operation timed out.",o=null,[3,27];case 24:return n="There is already a Git repository in the Repl's root directory.",o=null,[3,27];case 25:return n="The pre-commit hook failed.",o=null,[3,27];case 26:return n="We ran into an unknown error that we don't have a description for. This is probably a bug with the app.",o=null,[3,27];case 27:return[2,{description:n,remedies:o,error:null}]}})})()},[s,u,l],{refresh:!1});if(!c)return(0,t.jsx)($,{description:null,remedies:null,error:s});if(c.error)return(0,t.jsx)($,{description:"Unknown error from the Git service. This is probably a bug in the app.",remedies:null,error:s});var d=c.description,f=c.remedies;return(0,t.jsx)($,{description:d,remedies:f,error:s})}var H=e.i(42458),W=(0,N.cssRecord)({errorNotification:[{pointerEvents:"all"},M.rcss.p(1),M.rcss.backgroundColor.accentNegativeDimmer,M.rcss.borderRadius(8),M.rcss.shadow(3)],header:[M.rcss.display.flex,M.rcss.flex.row,M.rcss.align.center,M.rcss.justify.spaceBetween,M.rcss.color.accentNegativeStrongest],errorType:[M.rcss.font.code,{opacity:.75}],body:[M.rcss.backgroundColor.backgroundHigher,M.rcss.borderRadius(0,0,8,8)]});function q(e){var n=e.error;return(0,t.jsxs)(V.View,{css:W.errorNotification,children:[(0,t.jsxs)(V.View,{css:W.header,py:4,px:8,children:[(0,t.jsxs)(V.View,{row:!0,gap:4,align:"center",children:[(0,t.jsx)(H.default,{}),(0,t.jsx)(B.Text,{variant:"subheadDefault",multiline:!1,children:function(e){switch(e.type){case i.GitErrors.UNKNOWN_NOT_GIT:return"Unknown Error";case i.GitErrors.UNKNOWN:return"Unknown Git Error";case i.GitErrors.NOT_INITIALIZED:case i.GitErrors.UNAUTHENTICATED:case i.GitErrors.INDEX_FILE_CORRUPT:case i.GitErrors.UNKNOWN_REMOTE:case i.GitErrors.UNKNOWN_REF:case i.GitErrors.INDEX_LOCKED:case i.GitErrors.NO_COMMITS:case i.GitErrors.PATH_MATCHED_NO_FILES:case i.GitErrors.USER_NOT_CONFIGURED:case i.GitErrors.INVALID_REFERENCE:case i.GitErrors.BRANCH_ALREADY_EXISTS:case i.GitErrors.MERGE_CONFLICT:case i.GitErrors.HEAD_DETACHED:case i.GitErrors.DIRTY_WORKTREE:case i.GitErrors.PUSH_REJECTED:case i.GitErrors.PROTECTED_BRANCH:case i.GitErrors.REMOTE_ALREADY_EXISTS:case i.GitErrors.ALREADY_INITIALIZED:case i.GitErrors.TIMEOUT:case i.GitErrors.OBJECT_HAS_NO_NOTE:case i.GitErrors.NOTE_SUCCESSFULLY_REMOVED:case i.GitErrors.NOTE_SUCCESSFULLY_OVERWRITTEN:case i.GitErrors.OBJECT_ALREADY_HAS_NOTE:case i.GitErrors.PRE_COMMIT_HOOK_FAILED:return"Git Error";default:return"Unknown Error"}}(n)})]}),(0,t.jsx)(B.Text,{css:W.errorType,multiline:!1,children:n.type})]}),(0,t.jsx)(V.View,{css:W.body,pt:4,pb:8,px:8,gap:8,children:(0,t.jsx)(z,{error:n})})]})}var K=(0,N.cssRecord)({errorList:[{pointerEvents:"none"},{transition:"background-color 100ms"},M.rcss.position.absolute,M.rcss.top(0),M.rcss.bottom(0),M.rcss.left(0),M.rcss.right(0),M.rcss.p(8),M.rcss.colWithGap(16),M.rcss.zIndex(10)]});function Y(){var e=(0,_.useGitErrorList)();return(0,t.jsx)(V.View,{style:{backgroundColor:e.length>0?"rgba(0, 0, 0, 0.25)":"transparent"},css:K.errorList,children:e.map(function(e){return(0,t.jsx)(q,{error:e},e.id)})})}e.s(["default",()=>Y],691490);var Q=e.i(136540),X=e.i(121817);function J(){var e,i,o,u,c=(0,s._)((0,l.useState)(!1),2),d=c[0],f=c[1],g=(0,p.default)().git,m=(i=(e=(0,s._)((0,l.useState)(!1),2))[0],o=e[1],u=(0,p.default)().git,(0,l.useEffect)(function(){return u.onBusyChange(o)},[u]),i),x=(0,_.useNotifyGitError)(),y=(0,a.default)(function(e){return(0,n._)(function(){var t,n;return(0,r._)(this,function(r){switch(r.label){case 0:return[4,e.isInitialized()];case 1:if((t=r.sent()).error)return x(t.error),[2,t];if(!t.initialized)return[2,{hasRemotes:!1,error:null}];return[4,e.getRemotes()];case 2:if((n=r.sent()).error)return x(n.error),[2,n];return[2,{hasRemotes:n.remotes.size>0,error:null}]}})})()},[x]);if(null==y?void 0:y.error)return null;var b=!!y&&y.hasRemotes,k=m||d||null===y;return(0,t.jsx)(Q.IconButton,{alt:b?"Refresh and Fetch":"Refresh",size:24,onClick:function(){return(0,n._)(function(){var e;return(0,r._)(this,function(t){switch(t.label){case 0:if(g.isBusy()||k)return[2];if(f(!0),!b)return[3,2];return[4,g.fetch()];case 1:(e=t.sent()).error?x(e.error):(0,h.trackGitPaneEvent)("remote-fetched"),t.label=2;case 2:return[4,g.refreshProfiles()];case 3:return t.sent(),g.forceRefresh(),setTimeout(function(){return f(!1)},500),[2]}})})()},disabled:k,children:k?(0,t.jsx)(w.default,{}):(0,t.jsx)(X.default,{})})}e.s(["RefreshButton",()=>J],618277)},861392,e=>{"use strict";var t=e.i(530658),n=e.i(680183),r=e.i(705705),i=e.i(627557),o=/[~^:?*[\\\0-\x20\x7F]/,a=/^(([A-Za-z0-9]+@|http(|s):\/\/)|(http(|s):\/\/[A-Za-z0-9]+@))([A-Za-z0-9.]+(:\d+)?)(?::|\/)([\d/\w.-]+?)$/,s=new RegExp([o,/^$/,/^\//,/\/$/,/\.lock$/,/\/{2,}/,/^\./,/\.$/,/\/\./,/\.\./,/@\{/,/^@$/,/^-/].map(function(e){return"(?:".concat(e.source,")")}).join("|"));function l(e){return 0===e.length||!o.test(e)}function u(e){return!s.test(e)}function c(e){return!s.test(e)}function d(e){return a.test(e)}function f(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return"string"==typeof e?(0,i.removeBranchRefsPath)(e):"commit"in e?e.type===n.GitBranchType.LOCAL||t&&e.type===n.GitBranchType.TRACKED?e.name:"".concat(e.remote,"/").concat(e.name):e.name}function p(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if("string"==typeof e)return e;if("commit"in e)return e.type===n.GitBranchType.LOCAL||t&&e.type===n.GitBranchType.TRACKED?"refs/heads/".concat(e.name):"refs/remotes/".concat(e.remote,"/").concat(e.name);if(e.type===r.GitRefType.BRANCH)return"refs/heads/".concat(e.name);if(e.type===r.GitRefType.REMOTE_BRANCH)return"refs/remotes/".concat(e.remote,"/").concat(e.branch);throw Error("Unknown branch object")}function h(e){var o=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if("string"==typeof e)return o&&!e.startsWith("refs/remotes/")?null:(0,t._)((0,i.splitRemoteFromBranch)(e),1)[0];if("commit"in e)return o&&e.type!==n.GitBranchType.REMOTE?null:e.remote;if(e.type===r.GitRefType.BRANCH)return null;if(e.type===r.GitRefType.REMOTE_BRANCH)return e.remote;throw Error("Unknown branch object")}function g(e,t){return e===t||null!==e&&null!==t&&p(e)===p(t)}e.s(["getBranchRemote",()=>h,"getFullBranchName",()=>p,"getQualifiedBranchName",()=>f,"hasOnlyValidBranchNameCharacters",()=>l,"isSameBranchRef",()=>g,"isValidBranchName",()=>u,"isValidRemoteName",()=>c,"isValidRemoteUrl",()=>d])},291689,e=>{"use strict";var t=e.i(878420),n=e.i(569384),r=e.i(973245);e.i(304277);var i=e.i(566901);function o(){var e=(0,n._)(["\n  query GitUserImageByUsername($username: String!) {\n    userByUsername(username: $username) {\n      id\n      image\n    }\n  }\n"]);return o=function(){return e},e}var a={},s=(0,r.gql)(o());function l(e){var n=(0,t._)({},a,e);return i.useLazyQuery(s,n)}e.s(["useGitUserImageByUsernameLazyQuery",()=>l])},458112,e=>{"use strict";e.s(["GITHUB_PRIVACY_EMAIL_DOMAIN",()=>"users.noreply.github.com","REPLIT_PRIVACY_EMAIL_DOMAIN",()=>"users.noreply.replit.com"])},891156,e=>{e.v({connectExistingButtonDesktop:"PushBranchButton-module__7kiiaq__connectExistingButtonDesktop",connectExistingButtonMobile:"PushBranchButton-module__7kiiaq__connectExistingButtonMobile",mobileButton:"PushBranchButton-module__7kiiaq__mobileButton",remoteStatusBanner:"PushBranchButton-module__7kiiaq__remoteStatusBanner",remoteStatusBannerDesktop:"PushBranchButton-module__7kiiaq__remoteStatusBannerDesktop",remoteStatusBannerMobile:"PushBranchButton-module__7kiiaq__remoteStatusBannerMobile",settingsButton:"PushBranchButton-module__7kiiaq__settingsButton",statusText:"PushBranchButton-module__7kiiaq__statusText"})},944520,350098,191967,825711,36397,368085,243599,264887,e=>{"use strict";var t=e.i(276385),n=e.i(618277),r=e.i(526962),i=e.i(480028),o=e.i(446530),a=e.i(613355),s=e.i(136540),l=e.i(960178),u=e.i(625484),c=e.i(297083),d=e.i(878420),f=e.i(64386),p=e.i(886513),h=e.i(530658),g=e.i(346715),m=e.i(817556),x=e.i(389959),y=e.i(790486),b=e.i(864667),w=e.i(167193),k=e.i(861392),_=e.i(680183),S=e.i(597865),C=e.i(529810),j=e.i(730792),T=e.i(954856),E=e.i(291689),R=e.i(683855),I=e.i(458112),A=e.i(714165),P=e.i(751273),D=e.i(353384),O=(0,o.cssRecord)({gitUserContainer:[a.rcss.flex.row],gitUserInnerContainer:[a.rcss.align.center,a.rcss.flex.row,{"& > :not(:first-child)":{marginLeft:i.tokens.space4}}],gitUserInnerContainerFlipped:[a.rcss.align.center,a.rcss.flex.rowReverse,{"& > :not(:last-child)":{marginLeft:i.tokens.space4}}],alignCenter:[a.rcss.align.center]});function N(e){var n=e.name,r=e.email,i=e.allowPlaceholderAvatar,o=void 0!==i&&i,a=e.color,s=void 0===a?"default":a,c=e.small,d=void 0!==c&&c,f=e.flip,p=void 0!==f&&f,h=e.placement,g=e.showTooltip;return void 0===g||g?(0,t.jsx)(u.View,{css:O.gitUserContainer,children:(0,t.jsx)(P.Tooltip,{placement:void 0===h?"bottom":h,tooltip:(0,t.jsx)(l.Text,{children:r}),children:(0,t.jsxs)(u.View,{css:p?O.gitUserInnerContainerFlipped:O.gitUserInnerContainer,children:[(0,t.jsx)(M,{email:r,name:n,enablePlaceholder:o,small:d}),(0,t.jsx)(l.Text,{multiline:!1,color:s,variant:d?"small":"text",children:n})]})})}):(0,t.jsx)(u.View,{css:O.gitUserContainer,children:(0,t.jsxs)(u.View,{css:p?O.gitUserInnerContainerFlipped:O.gitUserInnerContainer,children:[(0,t.jsx)(M,{email:r,name:n,enablePlaceholder:o,small:d}),(0,t.jsx)(l.Text,{multiline:!1,color:s,variant:d?"small":"text",children:n})]})})}function M(e){var n=e.name,r=e.email,o=e.enablePlaceholder,a=void 0!==o&&o,s=e.small,l=void 0!==s&&s,u=(0,h._)((0,E.useGitUserImageByUsernameLazyQuery)({initialFetchPolicy:"cache-and-network",nextFetchPolicy:"cache-first",ssr:!1}),1)[0],d=(0,h._)((0,x.useState)(null),2),f=d[0],p=d[1];return(0,x.useEffect)(function(){(0,c._)(function(){var e,t,n,i,o,a,s,l,c,d;return(0,m._)(this,function(f){switch(f.label){case 0:if(!r.endsWith("@".concat(I.GITHUB_PRIVACY_EMAIL_DOMAIN)))return[3,1];return e=r.split("@")[0],(t=(0,h._)(e.split("+"),2))[0],n=t[1],p((0,R.sanitizeHref)("https://github.com/".concat(n,".png"))),[3,4];case 1:if(!r.endsWith("@".concat(I.REPLIT_PRIVACY_EMAIL_DOMAIN)))return[3,3];return a=r.split("@")[0],(s=(0,h._)(a.split("-"),2))[0],[4,u({variables:{username:s[1]}})];case 2:return(l=null==(o=f.sent().data)||null==(i=o.userByUsername)?void 0:i.image)&&p(l),[3,4];case 3:c=(0,T.md5)(r),(d=new URL("https://gravatar.com/avatar/".concat(c))).searchParams.append("d","404"),p(d.toString()),f.label=4;case 4:return[2]}})})()},[r,u]),(0,x.useMemo)(function(){var e=l?12:16;return null===f?a?(0,t.jsx)(D.default,{css:O.alignCenter,size:e,color:i.tokens.foregroundDefault}):null:(0,t.jsx)(A.Avatar,{css:O.alignCenter,username:n,src:f,onError:function(){return p(null)},size:e})},[f,a,l,n])}e.s(["default",()=>N],350098);var L=e.i(520739),B=e.i(688216),V=e.i(754873),F=e.i(140487),U=e.i(988676),G=e.i(604963),$=e.i(51054),z=e.i(257811),H=e.i(576073),W=e.i(462783),q=e.i(940745),K=e.i(952030),Y=u.SpecializedView.button,Q=(0,o.cssRecord)({fullWidth:[a.rcss.width("100%")],paddedX:[a.rcss.px(8)],loadingContainer:[a.rcss.display.flex,a.rcss.align.center,a.rcss.justify.center,a.rcss.py(48)],menu:[a.rcss.maxWidth(390),a.rcss.width(280),a.rcss.display.flex,a.rcss.flex.shrink(1),a.rcss.maxHeight(640),a.rcss.borderRadius(8),a.rcss.overflow("hidden")],form:[a.rcss.display.flex,a.rcss.flex.growAndShrink(1),a.rcss.flex.column,a.rcss.overflow("hidden")],body:[a.rcss.py(8),a.rcss.colWithGap(8),a.rcss.flex.growAndShrink(1),a.rcss.overflow("auto")],selector:[a.rcss.display.flex,a.rcss.align.center,a.rcss.rowWithGap(4),a.rcss.color.foregroundDefault],menuItem:[{backgroundColor:"inherit"},V.interactive.listItem,a.rcss.px(8),a.rcss.py(4),a.rcss.borderRadius(0),a.rcss.align.start],virtualItem:[a.rcss.position.absolute,a.rcss.top(0),a.rcss.left(0),a.rcss.width("100%"),a.rcss.overflow("hidden")],virtualList:[a.rcss.position.relative],divider:[a.rcss.mt(8),a.rcss.mb(8),a.rcss.ml(0),a.rcss.mr(0)],errorText:[a.rcss.color.accentNegativeStronger,a.rcss.mt(4)],createBranchButton:[a.rcss.height(32),a.rcss.overflow("hidden"),{whiteSpace:"nowrap",textOverflow:"ellipsis"}]}),X=function(e,t){var n=(0,j.useNotifyGitError)(),i=(0,C.default)().git,o=(0,h._)((0,x.useState)(!0),2),a=o[0],s=o[1],l=(0,S.default)(function(e){return(0,c._)(function(){var t,r,i,o,a,l,u,c,d,f,p,h,g,x,y,b,w,_,S,C,j;return(0,m._)(this,function(m){switch(m.label){case 0:return s(!0),[4,e.isInitialized()];case 1:if((t=m.sent()).error)return n(t.error),s(!1),[2,t];if(!t.initialized)return s(!1),[2,{active:[],stale:[],important:[],error:null}];return[4,e.listBranches()];case 2:if((r=m.sent()).error)return n(r.error),s(!1),[2,r];return[4,e.findDefaultBranches()];case 3:if((i=m.sent()).error)return n(i.error),s(!1),[2,i];o=r.branches,a=new Set,l=!0,u=!1,c=void 0;try{for(d=function(){var e=p.value,t=o.find(function(t){return(0,k.isSameBranchRef)(t,e)});t&&a.add(t)},f=i.refs[Symbol.iterator]();!(l=(p=f.next()).done);l=!0)d()}catch(e){u=!0,c=e}finally{try{l||null==f.return||f.return()}finally{if(u)throw c}}h=Date.now()-72e6,g=[],x=[],y=!0,b=!1,w=void 0;try{for(_=o[Symbol.iterator]();!(y=(S=_.next()).done);y=!0)C=S.value,a.has(C)||(C.commit.author.date>h?g.push(C):x.push(C))}catch(e){b=!0,w=e}finally{try{y||null==_.return||_.return()}finally{if(b)throw w}}return j=Array.from(a),s(!1),[2,{active:g,stale:x,important:j,error:null}]}})})()},[n]),u=function(t){return(0,c._)(function(){var r;return(0,m._)(this,function(o){switch(o.label){case 0:if(a||(0,k.isSameBranchRef)(e,t))return[2];return s(!0),[4,i.switchBranch(t)];case 1:return(r=o.sent()).error?(n(r.error),s(!1)):(i.forceRefresh(),(0,L.trackGitPaneEvent)("branch-switched")),[2]}})})()},d=function(e){return(0,c._)(function(){var t;return(0,m._)(this,function(r){switch(r.label){case 0:if(a||""===e)return[2];return s(!0),[4,i.createBranch({name:e,checkout:!0})];case 1:return(t=r.sent()).error?(n(t.error),s(!1)):(i.forceRefresh(),(0,L.trackGitPaneEvent)("branch-created")),[2]}})})()};if((0,x.useEffect)(function(){null!==e&&(s(!1),t({type:r.GitPaneModeType.CURRENT_BRANCH}))},[e,t]),null===l||a)return{loading:a,active:[],stale:[],important:[],handleSwitchBranch:u,handleCreateBranch:d,error:null};if(l.error)return{loading:a,active:[],stale:[],important:[],handleSwitchBranch:u,handleCreateBranch:d,error:l.error};var f=l.active,p=l.stale,g=l.important;return{loading:a,active:null!=f?f:[],stale:null!=p?p:[],important:null!=g?g:[],handleSwitchBranch:u,handleCreateBranch:d,error:null}},J=function(e){var n=e.branch,r=X(n,e.switchMode),i=r.loading,o=r.active,a=r.important,s=r.stale,l=r.handleSwitchBranch,u=r.handleCreateBranch,d=(0,h._)((0,x.useState)(!1),2),f=d[0],p=d[1],g=(0,h._)((0,x.useState)(""),2),y=g[0],b=g[1],w=(0,h._)((0,x.useState)(!1),2),k=w[0],_=w[1];return(0,t.jsx)(es,{isOpen:f,setIsOpen:p,important:a,active:o,stale:s,current:n,query:y,setQuery:b,onSwitchBranch:l,createBranchLoading:k,createBranch:function(){return(0,c._)(function(){return(0,m._)(this,function(e){switch(e.label){case 0:return _(!0),[4,u(y)];case 1:return e.sent(),b(""),_(!1),[2]}})})()},loading:i})},Z=function(e){var n=e.onClick,r=e.children,i=(0,x.useRef)(null),o=(0,h._)((0,b.useRovingTabIndex)(i,!1),4),a=o[0],s=o[1],l=o[2],u=o[3];return(0,b.useFocusEffect)(s,i),(0,t.jsx)(Y,{ref:i,role:"menuitem",css:Q.menuItem,onClick:function(e){u(),n(e)},onKeyDown:l,tabIndex:a,children:r})},ee=function(e){var n=e.branch;return(0,t.jsxs)(u.View,{shrink:!0,row:!0,gap:8,align:"center",children:[(0,t.jsx)(N,{name:n.commit.author.name,email:n.commit.author.email,color:"dimmer",allowPlaceholderAvatar:!0,placement:"top",showTooltip:!1,small:!0}),(0,t.jsx)(l.Text,{color:"dimmer",variant:"small",children:(0,z.toRelativeDate)({date:n.commit.author.date})})]})},et=function(e){var n=e.branch,r=e.current,i=e.onSwitchBranch,o=(0,x.useMemo)(function(){return(0,w.branchesEqual)(n,r)},[n,r]);return(0,t.jsxs)(Z,{onClick:function(){return i(n)},children:[(0,t.jsx)(l.Text,{multiline:!1,css:a.rcss.color.foregroundDefault,children:(0,t.jsx)(B.BranchName,{name:n.name,remote:n.type===_.GitBranchType.REMOTE?n.remote:null,current:o})}),(0,t.jsx)(ee,{branch:n})]})},en=function(e,t){return t.filter(function(t){return(0,k.getFullBranchName)(t).toLowerCase().includes(e.toLowerCase())})},er=function(e,t,n){var r=0,i=[];if(e.length+t.length+n.length===0)return i;if(e.length>0){i.push({key:"heading-important-".concat(r++),type:"heading",title:"Important"});for(var o=0;o<e.length;++o)i.push({key:"branch-important-".concat(r++),type:"branch",branch:e[o]});t.length+n.length>0&&i.push({key:"divider-important-".concat(r++),type:"divider"})}if(t.length>0){i.push({key:"heading-active-".concat(r++),type:"heading",title:"Active"});for(var a=0;a<t.length;++a)i.push({key:"branch-active-".concat(r++),type:"branch",branch:t[a]});n.length>0&&i.push({key:"divider-active-".concat(r++),type:"divider"})}if(n.length>0){i.push({key:"heading-stale-".concat(r++),type:"heading",title:"Stale"});for(var s=0;s<n.length;++s)i.push({key:"branch-stale-".concat(r++),type:"branch",branch:n[s]})}return i},ei=function(e){var n=e.item,r=e.current,i=e.onSwitchBranch;return"heading"===n.type?(0,t.jsx)(u.View,{css:Q.paddedX,children:(0,t.jsx)(l.Text,{multiline:!1,variant:"small",color:"dimmest",css:a.rcss.fontWeight.medium,children:n.title})}):"divider"===n.type?(0,t.jsx)(u.View,{css:Q.divider,children:(0,t.jsx)(U.DividerH,{})}):(0,t.jsx)(u.View,{children:(0,t.jsx)(et,{branch:n.branch,current:r,onSwitchBranch:i})})},eo=function(e){var n=e.items,r=e.current,i=e.onSwitchBranch,o=(0,x.useRef)(null),a=(0,y.useVirtualizer)({overscan:10,count:n.length,getScrollElement:function(){return o.current},estimateSize:function(e){var t,r;return null!=(t=void 0===(r=n[e])?0:"heading"===r.type?30:"branch"===r.type?65:"divider"===r.type?20:void 0)?t:0}});return(0,t.jsx)(b.RovingTabIndexProvider,{options:{direction:"vertical"},children:(0,t.jsx)("div",{css:Q.body,ref:o,children:(0,t.jsx)("ul",{css:Q.virtualList,style:{height:"".concat(a.getTotalSize(),"px")},children:a.getVirtualItems().map(function(e){return(0,t.jsx)("div",{css:Q.virtualItem,style:{transform:"translateY(".concat(e.start,"px)")},"data-index":e.index,ref:a.measureElement,children:(0,t.jsx)(ei,{item:n[e.index],current:r,onSwitchBranch:i})},e.key.toString())})})})})},ea=function(e){var n=e.query,r=e.setQuery,i=e.filteredImportant,o=e.filteredActive,a=e.filteredStale,s=e.current,c=e.onSwitchBranch,d=e.createBranchLoading,f=e.createBranch,p=e.loading,h=(0,x.useMemo)(function(){return er(i,o,a)},[i,o,a]),m='Create Branch "'.concat(n,'"'),y=(0,x.useMemo)(function(){return(0,g._)(i).concat((0,g._)(o),(0,g._)(a)).some(function(e){return e.name===n})},[n,i,o,a]);return(0,t.jsx)(u.View,{css:Q.menu,children:(0,t.jsx)("form",{onSubmit:function(e){e.preventDefault(),f()},css:Q.form,children:p?(0,t.jsx)(u.View,{css:Q.loadingContainer,children:(0,t.jsx)(q.default,{})}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(u.View,{p:8,children:(0,t.jsx)($.SearchBar,{value:n,onChange:function(e){r(e.target.value)},onClear:function(){r("")},loading:!1,placeholder:"Find or create a branch..."})}),(0,t.jsx)(u.View,{css:Q.paddedX,children:(0,t.jsx)(U.DividerH,{})}),h.length>0?(0,t.jsx)(eo,{items:h,current:s,onSwitchBranch:c}):null,y||""===n?null:(0,t.jsxs)(u.View,{p:8,children:[(0,t.jsx)(F.Button,{text:m,size:"small",iconLeft:d?(0,t.jsx)(q.default,{}):(0,t.jsx)(K.default,{}),stretch:!0,css:Q.createBranchButton,disabled:d||!(0,k.isValidBranchName)(n),type:"submit"}),(0,k.isValidBranchName)(n)?null:(0,t.jsx)(l.Text,{variant:"small",css:Q.errorText,multiline:!1,children:"Invalid branch name"})]})]})})})},es=function(e){var n=e.isOpen,r=e.setIsOpen,i=e.important,o=e.active,a=e.stale,s=e.current,u=e.query,c=e.setQuery,h=e.onSwitchBranch,g=e.createBranchLoading,m=e.createBranch,y=e.loading,b=(0,x.useMemo)(function(){return en(u,i)},[u,i]),w=(0,x.useMemo)(function(){return en(u,o)},[u,o]),k=(0,x.useMemo)(function(){return en(u,a)},[u,a]);return(0,t.jsxs)(G.PopoverTrigger,{label:"View Branches",placement:"bottom",isOpen:n,onOpenChange:function(e){r(e)},offset:16,children:[function(e){var r=e.onClick,i=(0,p._)(e,["onClick"]);return(0,t.jsx)(F.Button,{variant:"nofill",text:(0,t.jsxs)(l.Text,(0,f._)((0,d._)({multiline:!1,variant:"small",css:Q.selector},i),{children:[(0,t.jsx)(B.BranchName,{name:s.name,remote:s.type===_.GitBranchType.REMOTE?s.remote:null,icon:!0}),n?(0,t.jsx)(W.default,{}):(0,t.jsx)(H.default,{})]})),size:"small",stretch:!0,alignment:"start",css:Q.fullWidth,onClick:r})},(0,t.jsx)(ea,{query:u,setQuery:c,filteredImportant:b,filteredActive:w,filteredStale:k,current:s,onSwitchBranch:h,createBranchLoading:g,createBranch:m,loading:y})]})},el=e.i(549762),eu=e.i(626729),ec=e.i(357399),ed=(0,o.cssRecord)({container:[a.rcss.height(36),a.rcss.px(8),a.rcss.py(4),a.rcss.rowWithGap(8),a.rcss.backgroundColor.backgroundDefault,a.rcss.align.center,a.rcss.justify.spaceBetween,a.rcss.zIndex(1),{borderBottom:"1px solid ".concat(i.tokens.outlineDimmer)}],left:[a.rcss.rowWithGap(4),a.rcss.align.center,a.rcss.flex.growAndShrink(1)],right:[a.rcss.rowWithGap(8),a.rcss.align.center],back:{marginLeft:-4}}),ef=function(e){var r=e.openSettings;return(0,t.jsxs)(u.View,{css:ed.container,children:[(0,t.jsxs)(u.View,{css:ed.left,children:[(0,t.jsx)(eu.default,{size:16}),(0,t.jsx)(l.Text,{variant:"subheadDefault",multiline:!1,children:"Repository"})]}),(0,t.jsxs)(u.View,{css:ed.right,children:[(0,t.jsx)(ey,{openSettings:r}),(0,t.jsx)(n.RefreshButton,{})]})]})},ep=function(e){var r=e.branch,i=e.switchMode,o=e.openSettings;return(0,t.jsxs)(u.View,{css:ed.container,children:[(0,t.jsx)(u.View,{css:ed.left,children:(0,t.jsx)(J,{branch:r,switchMode:i})}),(0,t.jsxs)(u.View,{css:ed.right,children:[(0,t.jsx)(ey,{openSettings:o}),(0,t.jsx)(n.RefreshButton,{})]})]})},eh=function(e){var n=e.onBack;return(0,t.jsxs)(u.View,{css:ed.container,children:[(0,t.jsxs)(u.View,{css:ed.left,children:[(0,t.jsx)(ev,{onBack:n,alt:"Back"}),(0,t.jsx)(l.Text,{variant:"subheadDefault",multiline:!1,children:"Settings"})]}),(0,t.jsx)(u.View,{css:ed.right})]})},eg=function(e){var r=e.switchMode,i=e.openSettings;return(0,t.jsxs)(u.View,{css:ed.container,children:[(0,t.jsxs)(u.View,{css:ed.left,children:[(0,t.jsx)(ex,{switchMode:r}),(0,t.jsx)(l.Text,{variant:"subheadDefault",multiline:!1,children:"Commit"})]}),(0,t.jsxs)(u.View,{css:ed.right,children:[(0,t.jsx)(ey,{openSettings:i}),(0,t.jsx)(n.RefreshButton,{})]})]})};function em(e){var n=e.mode,i=e.branch,o=e.switchMode,a=e.onBack,s=function(){return o({type:r.GitPaneModeType.SETTINGS})};switch(n){case r.GitPaneModeType.DASHBOARD:return(0,t.jsx)(ef,{openSettings:s});case r.GitPaneModeType.BRANCH:case r.GitPaneModeType.CURRENT_BRANCH:if(null===i)throw Error("Tried to show branch in header, but branch is null");return(0,t.jsx)(ep,{branch:i,switchMode:o,openSettings:s});case r.GitPaneModeType.SETTINGS:return(0,t.jsx)(eh,{onBack:a});case r.GitPaneModeType.COMMIT:return(0,t.jsx)(eg,{switchMode:o,openSettings:s});default:return(0,t.jsxs)(u.View,{css:ed.container,children:[(0,t.jsx)(u.View,{css:ed.left}),(0,t.jsx)(u.View,{css:ed.right})]})}}function ev(e){var n=e.onBack,r=e.alt;return(0,t.jsx)(s.IconButton,{css:ed.back,alt:r,size:28,onClick:n,children:(0,t.jsx)(el.default,{})})}function ex(e){var n=e.switchMode;return(0,t.jsx)(ev,{css:ed.back,onBack:function(){return n({type:r.GitPaneModeType.CURRENT_BRANCH})},alt:"Back to current branch"})}function ey(e){var n=e.openSettings;return(0,t.jsx)(s.IconButton,{alt:"Settings",size:24,onClick:n,children:(0,t.jsx)(ec.default,{})})}function eb(){return(0,t.jsxs)(u.View,{children:[(0,t.jsx)(l.Text,{multiline:!1,children:"Unsupported state: you are applying a mailbox patch."}),(0,t.jsx)(l.Text,{multiline:!1,children:"Please finish the patch manually."})]})}function ew(){return(0,t.jsxs)(u.View,{children:[(0,t.jsx)(l.Text,{multiline:!1,children:"Unsupported state: you are in the middle of a bisect."}),(0,t.jsx)(l.Text,{multiline:!1,children:"Please finish the bisect manually."})]})}e.s(["default",()=>em],944520),e.s(["default",()=>eb],191967),e.s(["default",()=>ew],825711),e.s(["DeprecationBanner",()=>e2,"PushBranchButton",()=>e4],243599);var ek=e.i(569384),e_=e.i(973245),eS=e.i(304277);function eC(){var e=(0,ek._)(["\n  query PushBranchButtonIsProjectRepl($id: String!) {\n    getRepl(id: $id) {\n      __typename\n      ... on Repl {\n        id\n        project {\n          id\n        }\n      }\n    }\n  }\n"]);return eC=function(){return e},e}e.i(566901);var ej={},eT=(0,e_.gql)(eC()),eE=e.i(627557),eR=e.i(993796),eI=e.i(207237),eA=e.i(138290),eP=e.i(242816),eD=e.i(791675);function eO(){var e=(0,eR.useFlag)({controlName:"flag-github-connection-migration",default:!1}),t=(0,S.default)(function(t){return(0,c._)(function(){var n;return(0,m._)(this,function(r){switch(r.label){case 0:var i,o;return n={},[4,(i=t,o=e,(0,c._)(function(){return(0,m._)(this,function(e){switch(e.label){case 0:return[4,i.getProfiles()];case 1:return[2,e.sent().filter(function(e){return e.provider!==eD.GitProfileProvider.REPLIT_DEFAULT&&(!o||e.provider!==eD.GitProfileProvider.GITHUB||!!e.isSourceOpenInt)}).length>0]}})})())];case 1:return[2,(n.connectedToGitProvider=r.sent(),n.error=null,n)]}})})()});return null==t||t.error?null:t.connectedToGitProvider}e.s(["default",()=>eO],36397);var eN=e.i(952e3),eM=e.i(967629),eL=e.i(607278),eB=e.i(352758),eV=e.i(616278),eF=e.i(283110),eU=(0,eM.css)(a.rcss.rowWithGap(4)),eG=(0,eM.css)(a.rcss.flex.growAndShrink(1)),e$=(0,eM.css)(a.rcss.color.accentNegativeStronger,a.rcss.pl(4));function ez(e){var n=e.initialRemoteUrl,r=e.remoteName,i=e.updateRemote,o=(0,C.default)().git,a=(0,h._)((0,x.useState)(),2),s=a[0],d=a[1];(0,x.useEffect)(function(){d(void 0)},[n]);var f=(0,h._)((0,x.useState)(),2),p=f[0],g=f[1],y=(0,h._)((0,x.useState)(!1),2),b=y[0],w=y[1],_=function(){return(0,c._)(function(){var e,t,n;return(0,m._)(this,function(a){switch(a.label){case 0:if(a.trys.push([0,5,6,7]),!s)return[2];if(w(!0),!(0,k.isValidRemoteUrl)(s))throw Error("Invalid remote url.");return[4,o.getRemotes()];case 1:if((e=a.sent()).error)throw Error("Error finding current remotes, ".concat(e.error));if(!e.remotes.has(r))return[3,3];return[4,o.setRemoteURL({remote:r,url:s})];case 2:if((t=a.sent()).error)throw(0,eA.reportErrorToSentry)({context:"remote-input",gitService:o,result:t,data:{remote:r,url:s}}),Error("Error (".concat(t.error,") setting ").concat(r," to use ").concat(s," as a remote."));return(0,L.trackGitPaneEvent)("remote-edited"),i(s),[2];case 3:return[4,o.addRemote({name:r,url:s})];case 4:if((n=a.sent()).error)throw(0,eA.reportErrorToSentry)({context:"remote-input",gitService:o,result:n,data:{remote:r,url:s}}),Error("Error (".concat(n.error,") adding ").concat(r," ").concat(s," as a remote."));return(0,L.trackGitPaneEvent)("remote-added"),[3,7];case 5:return g(a.sent().message),[3,7];case 6:return w(!1),[7];case 7:return[2]}})})()};return(0,t.jsxs)(u.View,{grow:!0,children:[(0,t.jsx)(eL.Input,{name:"Remote URL",placeholder:"Enter Remote URL",value:null!=s?s:n,autoComplete:"off",autoCorrect:"off",onChange:function(e){g(void 0),d(e.target.value)},inputMode:"url","aria-label":"Remote URL",onKeyDown:function(e){"Enter"===e.key&&_()}}),p?(0,t.jsx)(l.Text,{variant:"small",css:e$,multiline:!1,children:p}):null,s&&s!==n?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(eB.default,{height:1}),(0,t.jsxs)(u.View,{css:eU,children:[(0,t.jsx)(F.Button,{css:eG,text:"Cancel",iconLeft:(0,t.jsx)(eF.default,{}),onClick:function(){return d(void 0)}}),(0,t.jsx)(F.Button,{css:eG,text:b?"Saving":"Save",loading:b,colorway:"primary",iconLeft:(0,t.jsx)(eV.default,{}),onClick:_})]})]}):null]})}e.s(["default",()=>ez],368085);var eH=e.i(739521),eW=e.i(624782),eq=e.i(396776),eK=e.i(788331),eY=e.i(363201),eQ=e.i(264661),eX=e.i(891156),eJ=function(e){var n=e.onViewSettingsClick;return(0,t.jsx)("button",{clsx:eX.default.settingsButton,onClick:n,children:"settings view."})},eZ=function(){var e=(0,h._)((0,x.useState)(""),2),n=e[0],r=e[1];return(0,t.jsxs)(u.View,{gap:8,children:[(0,t.jsx)(l.Text,{color:"dimmest",multiline:!1,children:"Connect Existing Remote"}),(0,t.jsx)(ez,{remoteName:"origin",initialRemoteUrl:n,updateRemote:r})]})},e0=function(e){var n=e.onCreateRemoteClick,r=(0,h._)((0,x.useState)(!1),2),i=r[0],o=r[1];return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(eq.StatusBanner,{text:(0,t.jsxs)(u.View,{gap:8,children:[(0,t.jsxs)(u.View,{clsx:eX.default.statusText,row:!0,justify:"space-between",align:"center",gap:8,children:[(0,t.jsx)("span",{children:"No remote repositories configured. To push your changes, create a new repository or connect to an existing one."}),(0,t.jsxs)(u.View,{row:!0,gap:4,clsx:eX.default.remoteStatusBannerDesktop,children:[(0,t.jsx)(F.Button,{text:"Create Remote",onClick:n,colorway:"primary"}),(0,t.jsx)(F.Button,{text:"Connect Existing",onClick:function(){o(!0)},clsx:eX.default.connectExistingButtonDesktop,variant:"outlined"})]})]}),(0,t.jsxs)(u.View,{row:!0,gap:4,clsx:eX.default.remoteStatusBannerMobile,align:"center",children:[(0,t.jsx)(F.Button,{text:"Create Remote",clsx:eX.default.mobileButton,onClick:n,colorway:"primary"}),(0,t.jsx)(F.Button,{text:"Connect Existing",clsx:eX.default.connectExistingButtonMobile,onClick:function(){o(!0)},variant:"outlined"})]})]}),closable:!1,clsx:eX.default.remoteStatusBanner}),(0,t.jsx)(eH.Modal,{isOpen:i,onRequestClose:function(){return o(!1)},children:(0,t.jsx)(eZ,{})})]})},e1=function(){var e=(0,j.useGitPaneModeSwitcher)();return(0,t.jsx)(eq.StatusBanner,{text:(0,t.jsx)(u.View,{clsx:eX.default.statusText,justify:"space-between",align:"center",gap:8,children:(0,t.jsxs)(l.Text,{variant:"small",children:["No Git provider configured. To push your changes, connect to a provider in the",(0,t.jsx)(eJ,{onViewSettingsClick:function(){return e({type:r.GitPaneModeType.SETTINGS})}})]})}),closable:!1})},e2=function(e){var n=e.onViewSettingsClick;return(0,t.jsx)(eq.StatusBanner,{colorway:"warning",icon:(0,t.jsx)(eY.default,{}),text:(0,t.jsx)(u.View,{clsx:eX.default.statusText,justify:"space-between",align:"start",gap:8,children:(0,t.jsxs)("span",{children:["Your GitHub connection has been deprecated. Please reconnect to continue using it in the",(0,t.jsx)(eJ,{onViewSettingsClick:n})]})}),clsx:eX.default.banner})},e3=function(e){var n=e.loading,i=e.nonProjectRemote,o=e.isConnectedToValidGitProvider,a=e.isConnectedToGitHub,s=e.onCreateRemoteClick,l=(0,eR.useFlag)({controlName:"flag-github-connection-migration"}),u=(0,j.useGitPaneModeSwitcher)();return l&&a&&!o?(0,t.jsx)(e2,{onViewSettingsClick:function(){return u({type:r.GitPaneModeType.SETTINGS})}}):o?n||i?null:(0,t.jsx)(e0,{onCreateRemoteClick:s}):(0,t.jsx)(e1,{})};function e4(e){var n,r,i,o,a,s=e.branch,f=e.performPaneOperation,p=e.onCreateRemoteClick,g=(0,h._)((0,x.useState)(!1),2),y=g[0],b=g[1],w=(0,h._)((0,x.useState)(!1),2),k=w[0],T=w[1],E=(0,h._)((0,x.useState)(null),2),R=E[0],I=E[1],A=(0,h._)((0,x.useState)(!1),2),P=A[0],D=A[1],O=(0,eI.default)(),N=(0,eP.default)(),M=(n={variables:{id:O}},r=(0,d._)({},ej,n),eS.useQuery(eT,r)).data,B=eO(),V=(null==M||null==(i=M.getRepl)?void 0:i.__typename)==="Repl"&&(null==(o=M.getRepl.project)?void 0:o.id)||!1,U=(0,j.useNotifyGitError)(),G=(0,C.default)().git,$=(0,S.default)(function(e){return(0,c._)(function(){var t,n,r,i,o,a,s,l,u,c;return(0,m._)(this,function(d){switch(d.label){case 0:return[4,e.isInitialized()];case 1:if((n=d.sent()).error)return U(n.error),(0,eA.reportErrorToSentry)({context:"publish-branch-button-initialized",gitService:e,result:n}),[2,{remote:null,error:n.error}];if(!n.initialized)return[2,{remote:null,error:null}];return[4,e.getRemotes()];case 2:if((r=d.sent()).error)return(0,eA.reportErrorToSentry)({context:"publish-branch-button-get-remotes",gitService:e,result:r}),U(r.error),[2,r];return i=(0,eN.getDefaultNonProjectRemote)(r.remotes),[4,e.status()];case 3:if((o=d.sent()).error)return U(o.error),(0,eA.reportErrorToSentry)({context:"publish-branch-button-status",gitService:e,result:o}),[2,o];if(!(o.branch&&i))return[3,5];return a=(0,eE.removeBranchRefsPath)(o.branch),s="refs/remotes/".concat(i,"/").concat(a),[4,e.branchExists(s)];case 4:(l=d.sent()).error?((0,eA.reportErrorToSentry)({context:"publish-branch-button-branch-exists",gitService:e,result:l,data:{upstream:a,fullRemoteRef:s}}),U(l.error)):l.exists&&I("".concat(i,"/").concat(a)),d.label=5;case 5:return c=i&&null!=(u=null==(t=r.remotes.get(i))?void 0:t.fetch)?u:null,[2,{remote:i,remoteUrl:c,error:null}]}})})()},[U],{keepStaleResult:!1});if((0,x.useEffect)(function(){(0,c._)(function(){var e;return(0,m._)(this,function(t){switch(t.label){case 0:if(!(P&&R))return[3,2];return[4,G.setBranchUpstream({upstream:R})];case 1:(e=t.sent()).error&&((0,eA.reportErrorToSentry)({context:"publish-branch-button-set-branch-upstream",gitService:G,result:e,data:{upstream:R}}),U(e.error)),D(!1),I(null),t.label=2;case 2:return[2]}})})()},[G,U,P,R]),null==$?void 0:$.error)return null;var z=$?$.remote:null,H=null===$,W=s.type!==_.GitBranchType.LOCAL||!z||P,K="".concat(z,"/").concat(s.name);return(a=y?"Pushing to '".concat(K,"'..."):s.type!==_.GitBranchType.LOCAL?"Branch has already been pushed to '".concat(K,"'"):H?"Checking if branch ".concat(s.name," can be pushed..."):z?"Push branch as '".concat(K,"'"):"No remotes to push to",V&&$&&!z)?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(F.Button,{iconLeft:(0,t.jsx)(eW.Pill,{text:"Beta",variant:"outline",colorway:"blue"}),text:"Collaborate in the Project pane",onClick:function(){f({operation:"open",pane:{type:"project"}})},iconRight:(0,t.jsx)(eQ.default,{})}),(0,t.jsx)(l.Text,{color:"dimmer",children:"Use the Project pane to merge your changes between repls and collaborate with your teammates. You've received early access to this feature with your Replit Teams subscription."})]}):(0,t.jsxs)(t.Fragment,{children:[R?(0,t.jsx)(eH.Modal,{isOpen:k,onRequestClose:function(){return T(!1)},children:(0,t.jsxs)(u.View,{gap:24,children:[(0,t.jsx)(l.Text,{variant:"headerDefault",children:"Branch already exists"}),(0,t.jsx)(l.Text,{children:"Upstream branch '".concat(R,"' already exists.\n          To push the branch, please confirm you would like to set upstream branch to it.")}),(0,t.jsx)(F.Button,{text:"Set upstream to '".concat(R,"'"),onClick:function(){R&&(D(!0),T(!1))}})]})}):null,(0,t.jsx)(e3,{loading:H,nonProjectRemote:z,isConnectedToGitHub:N,isConnectedToValidGitProvider:null!=B&&B,onCreateRemoteClick:p}),(0,t.jsx)(F.Button,{text:a,iconLeft:H||y?(0,t.jsx)(q.default,{}):(0,t.jsx)(eK.default,{}),onClick:function(){return(0,c._)(function(){var e;return(0,m._)(this,function(t){switch(t.label){case 0:if(!z||y)return[2];if(R)return T(!0),[2];return b(!0),[4,G.push({publish:{remote:z}})];case 1:return(e=t.sent()).error?(b(!1),U(e.error),(0,eA.reportErrorToSentry)({context:"publish-branch-button-push",gitService:G,result:e,data:{remote:z}})):(G.forceRefresh(),(0,L.trackGitPaneEvent)("branch-published-to-remote")),[2]}})})()},loading:H||y,disabled:W})]})}var e8=function(e,t,n){var r=new Set,i=!0,o=!1,a=void 0;try{for(var s,l=t[Symbol.iterator]();!(i=(s=l.next()).done);i=!0){var u=s.value;r.add(u.hash)}}catch(e){o=!0,a=e}finally{try{i||null==l.return||l.return()}finally{if(o)throw a}}var c=!0,d=!1,f=void 0;try{for(var p,h=n[Symbol.iterator]();!(c=(p=h.next()).done);c=!0){var g=p.value;r.add(g.hash)}}catch(e){d=!0,f=e}finally{try{c||null==h.return||h.return()}finally{if(d)throw f}}return e.filter(function(e){return!r.has(e.hash)})};function e5(e,t,n){var r=(0,j.useNotifyGitError)(),i=(0,S.default)(function(r){return(0,c._)(function(){var i,o,a,s,l,u,c,d,f;return(0,m._)(this,function(p){switch(p.label){case 0:return[4,r.isInitialized()];case 1:if((i=p.sent()).error)return(0,eA.reportErrorToSentry)({context:"use-branch-commits",gitService:r,result:i}),[2,{error:i.error}];if(!i.initialized)return[2,{log:[],onlyRemote:[],onlyLocal:[],error:null}];if(!e)return[2,{error:null}];if(!(!e.tracking||0===t&&0===n))return[3,3];return o=(0,k.getQualifiedBranchName)(e,!0),[4,r.log({max:100,revRange:o})];case 2:if((a=p.sent()).error)return(0,eA.reportErrorToSentry)({context:"use-branch-commits",gitService:r,result:a,data:{branch:e,behind:t,ahead:n,revision:o}}),[2,a];return[2,{log:a.commits,error:null}];case 3:return s=(0,k.getQualifiedBranchName)(e),[4,Promise.all([r.log({max:100,revRange:e.name}),r.log({max:100,revRange:"".concat(e.name,"..").concat(s)}),r.log({max:100,revRange:"".concat(s,"..").concat(e.name)})])];case 4:if(l=p.sent(),c=(u=(0,h._)(l,3))[0],d=u[1],f=u[2],c.error)return(0,eA.reportErrorToSentry)({context:"use-branch-commits-log",gitService:r,result:c,data:{branch:e,behind:t,ahead:n,remoteBranch:s}}),[2,{error:c.error}];if(d.error)return(0,eA.reportErrorToSentry)({context:"use-branch-commits-only-remote",gitService:r,result:d,data:{branch:e,behind:t,ahead:n,remoteBranch:s}}),[2,{error:d.error}];if(f.error)return(0,eA.reportErrorToSentry)({context:"use-branch-commits-only-local",gitService:r,result:f,data:{branch:e,behind:t,ahead:n,remoteBranch:s}}),[2,{error:f.error}];return[2,{log:c.commits,onlyRemote:d.commits,onlyLocal:f.commits,error:null}]}})})()},[e,t,n]);return(0,x.useMemo)(function(){if(!i)return null;if(i.error)return r(i.error),{error:i.error};var e=i.log,t=i.onlyRemote,n=i.onlyLocal;return t||n?(e&&(e=e8(e,null!=t?t:[],null!=n?n:[])),{log:e,onlyRemote:t,onlyLocal:n,error:null}):{log:e,error:null}},[r,i])}e.s(["default",()=>e5,"filterKnownCommits",()=>e8],264887)},385485,e=>{e.v({messageSurface:"AccessibilityBanner-module__KbYUjq__messageSurface"})},467880,e=>{e.v({errorText:"CreateRemoteForm-module__hiv3cW__errorText",privateToggle:"CreateRemoteForm-module__hiv3cW__privateToggle",statusText:"CreateRemoteForm-module__hiv3cW__statusText"})},952e3,25358,467612,166963,636680,875259,680011,772275,540285,710106,973267,35647,737553,674373,345008,569484,e=>{"use strict";e.s(["default",()=>n3,"getDefaultNonProjectRemote",()=>n8,"styles",()=>n2],952e3);var t,n,r=e.i(530658),i=e.i(346715),o=e.i(276385),a=e.i(389959),s=e.i(680183),l=e.i(243599),u=e.i(264887),c=e.i(297083),d=e.i(817556),f=e.i(546284),p=e.i(529810),h=e.i(730792),g=e.i(138290),m=e.i(520739),x=e.i(633600),y=e.i(479491),b=e.i(650587),w=e.i(343252),k=e.i(159667);e.i(32109);var _=e.i(926118),S=e.i(384401),C=e.i(480028),j=e.i(446530),T=e.i(613355),E=e.i(140487),R=e.i(607278),I=e.i(929872),A=e.i(960178),P=e.i(751273),D=e.i(625484),O=e.i(576073),N=e.i(462783),M={height:32,width:"100%",resize:"none",border:"none"},L={width:"100%",resize:"none",border:"none"},B=(0,j.cssRecord)({surface:[T.rcss.borderRadius(0,0,8,8)],button:[T.rcss.height("auto"),T.rcss.py(8),T.rcss.fontWeight.medium,T.rcss.borderRadius(8,8,0,0),T.rcss.justify.start,T.rcss.border({color:C.tokens.outlineDimmer,direction:"bottom"}),{"> span:first-child":{flexGrow:1,textAlign:"start"}}],requiredText:[T.rcss.display.inlineFlex,T.rcss.rowWithGap(4)],subjectFieldHeader:[T.rcss.center,T.rcss.justify.spaceBetween],subjectInput:M,bodyInput:L,subjectInputDisabled:[M,{opacity:.5}],bodyInputDisabled:[L,{opacity:.5}],required:[T.rcss.color.accentNegativeStronger],keyCombo:[T.rcss.display.inlineFlex,T.rcss.rowWithGap(4),T.rcss.flex.grow(1),T.rcss.align.center],keyComboText:[T.rcss.fontWeight.normal,T.rcss.color.foregroundDimmest]});function V(e){var t=e.message,n=e.disabled,i=void 0!==n&&n,s=e.onMessageChange,l=e.onCommitShortcut,u=(0,r._)((0,a.useState)(!0),2),c=u[0],d=u[1],f=(0,r._)((0,a.useState)(!1),2),p=f[0],h=f[1],g=(0,r._)((0,a.useState)(!1),2),m=g[0],y=g[1],w=(0,a.useRef)(null),C=(0,a.useRef)(null),j=(0,x._)(t.split("\n\n")),T=j[0],R=void 0===T?"":T,A=j.slice(1).join("\n\n"),P=(0,b.useIsMobile)();function M(e,t){s((e=e.replaceAll("\n"," "))+(t?"\n\n"+t:""))}var L=(0,S.useKeyCombo)(k.commands.gitCommit.id);return(0,S.useCommandScope)(k.GitCommandScope,m),(0,S.useCommandBinding)(function(){return[k.commands.gitCommit.id,{run:function(){null==l||l()},scope:k.GitCommandScope,bubble:!1}]},[l]),(0,o.jsxs)(D.View,{children:[(0,o.jsx)(E.Button,{css:B.button,text:(0,o.jsxs)("span",{css:B.requiredText,children:[(0,o.jsx)("span",{children:"Message"}),c?(0,o.jsx)(G,{}):null]}),secondaryText:P||!L?void 0:(0,o.jsxs)("span",{css:B.keyCombo,children:[(0,o.jsx)("span",{css:B.keyComboText,children:"Commit:"}),(0,o.jsx)(_.KeyComboBlocks,{keyCombo:L,small:!0})]}),iconRight:c?(0,o.jsx)(O.default,{}):(0,o.jsx)(N.default,{}),onClick:function(){return d(function(e){return!e})},size:"small"}),(0,o.jsxs)(I.Surface,{css:B.surface,p:8,gap:12,elevated:!0,children:[(0,o.jsx)(F,{ref:w,value:R,compact:c,disabled:i,onChange:function(e){M(e,A)},onNewline:function(){if(c)d(!1),h(!0);else{if(!C.current)return;C.current.focus(),C.current.setSelectionRange(0,0)}},onFocus:function(){y(!0)},onBlur:function(){y(!1)}}),c&&!A?null:(0,o.jsx)(U,{ref:C,value:A,compact:c,disabled:i,onChange:function(e){if(M(R,e),c&&!e){var t;null==(t=w.current)||t.focus()}else c&&d(!1)},onBackspaceWhenEmpty:function(){w.current&&w.current.focus()},onFocus:function(){p&&h(!1),y(!0)},onBlur:function(){y(!1)},autoFocus:p})]})]})}var F=(0,a.forwardRef)(function(e,t){var n=e.value,r=e.compact,i=void 0!==r&&r,s=e.disabled,l=void 0!==s&&s,u=e.onChange,c=e.onNewline,d=e.onFocus,f=e.onBlur,p=(0,a.useRef)(null),h=(0,y.default)().ref,g=(0,w.useMergeRefs)([t,h,p],{breadcrumb:"client/workspace/components/Git/modified/CommitMessage.tsx:267"});return(0,o.jsxs)(D.View,{gap:8,children:[i?null:(0,o.jsx)(D.View,{css:B.subjectFieldHeader,row:!0,children:(0,o.jsx)(A.Text,{variant:"small",color:"dimmer",multiline:!1,children:(0,o.jsxs)("span",{css:B.requiredText,children:[(0,o.jsx)("span",{children:"Summary"}),(0,o.jsx)(G,{})]})})}),(0,o.jsx)(R.MultiLineInput,{ref:i?t:g,css:l?B.subjectInputDisabled:B.subjectInput,placeholder:"Summary of your commit...",value:n,disabled:l,onChange:function(e){return null==u?void 0:u(e.currentTarget.value)},onKeyDown:function(e){"Enter"!==e.key||e.defaultPrevented||(e.preventDefault(),e.stopPropagation(),null==c||c())},onFocus:d,onBlur:f})]})}),U=(0,a.forwardRef)(function(e,t){var n=e.value,r=e.compact,i=void 0!==r&&r,a=e.disabled,s=void 0!==a&&a,l=e.autoFocus,u=e.onChange,c=e.onBackspaceWhenEmpty,d=e.onFocus,f=e.onBlur,p=(0,y.default)().ref,h=(0,w.useMergeRefs)([t,p],{breadcrumb:"client/workspace/components/Git/modified/CommitMessage.tsx:335"});return(0,o.jsxs)(D.View,{gap:8,children:[i?null:(0,o.jsx)(A.Text,{variant:"small",color:"dimmer",multiline:!1,children:"Description"}),(0,o.jsx)(R.MultiLineInput,{ref:i?t:h,css:s?B.bodyInputDisabled:B.bodyInput,placeholder:"Description of your commit...",value:n,disabled:s,onChange:function(e){return null==u?void 0:u(e.currentTarget.value)},onKeyDown:function(e){"Backspace"===e.key&&""===n&&(e.preventDefault(),e.stopPropagation(),null==c||c())},onFocus:d,onBlur:f,autoFocus:void 0!==l&&l})]})});function G(){return(0,o.jsx)(P.Tooltip,{tooltip:"This field is required.",placement:"top",children:(0,o.jsx)("span",{css:B.required,children:"*"})})}var $=e.i(234961),z=e.i(923772),H=e.i(790486),W=e.i(125674),q=e.i(136540),K=e.i(940745),Y=e.i(783437),Q=e.i(952030),X=e.i(245150),J=(0,j.cssRecord)({actionsIndex:[T.rcss.height(24),T.rcss.align.center,T.rcss.borderRadius(4)],actionsWorktree:[T.rcss.height(24),T.rcss.flex.row,T.rcss.align.center,T.rcss.borderRadius(4)],unstage:[T.rcss.height(24),T.rcss.width(24),T.rcss.borderRadius(2)],stage:[T.rcss.px(12),T.rcss.height(24),T.rcss.width(24),T.rcss.borderRadius(2)],discard:[T.rcss.pl(16),T.rcss.pr(12),T.rcss.height(24),T.rcss.width(24),T.rcss.borderRadius(2)],discardIcon:{transform:"scale(0.85)"},divider:[T.rcss.height("75%"),T.rcss.width(1),T.rcss.backgroundColor.outlineStronger]});function Z(e){var t=e.file,n=e.list,i=e.stageFiles,s=e.restoreFiles,l=e.disabled,u=void 0!==l&&l,f=(0,r._)((0,a.useState)(!1),2),p=f[0],h=f[1],g=(0,r._)((0,a.useState)(!1),2),m=g[0],x=g[1];return(u=u||m||p,"index"===n)?(0,o.jsx)(I.Surface,{elevated:!0,css:J.actionsIndex,children:(0,o.jsx)(q.IconButton,{css:J.unstage,alt:"Unstage changes",size:18,onClick:function(){return(0,c._)(function(){return(0,d._)(this,function(e){switch(e.label){case 0:if(u)return[2];return h(!0),[4,i({reset:[t.path]})];case 1:return e.sent(),h(!1),[2]}})})()},disabled:u,children:p?(0,o.jsx)(K.default,{}):(0,o.jsx)(Y.default,{})})}):(0,o.jsxs)(I.Surface,{elevated:!0,css:J.actionsWorktree,children:[(0,o.jsx)(q.IconButton,{css:J.discard,alt:"Discard changes",size:18,onClick:function(){return(0,c._)(function(){return(0,d._)(this,function(e){switch(e.label){case 0:if(u||"worktree"!==n)return[2];return x(!0),[4,s(t.path)];case 1:return e.sent(),x(!1),[2]}})})()},disabled:u,children:m?(0,o.jsx)(K.default,{}):(0,o.jsx)(X.default,{css:J.discardIcon})}),(0,o.jsx)("div",{css:J.divider}),(0,o.jsx)(q.IconButton,{css:J.stage,alt:"Stage changes",size:18,onClick:function(){return(0,c._)(function(){return(0,d._)(this,function(e){switch(e.label){case 0:if(u)return[2];return h(!0),[4,i({add:[t.path]})];case 1:return e.sent(),h(!1),[2]}})})()},disabled:u,children:p?(0,o.jsx)(K.default,{}):(0,o.jsx)(Q.default,{})})]})}var ee=e.i(288419),et=e.i(933974);function en(e){var t,n=e.file,r=e.list,i=e.stageFiles,a=e.restoreFiles,s=e.pathMap,l=e.disabled,u=e.onFilePathClick,c=null==s?void 0:s.get(n.path),d=null==(t=n.source)?void 0:t.path,f="index"===r?n.type.index:n.type.worktree,p=(0,W.default)(function(){if(f!==$.GitStatusChangedFileType.DELETED)return function(){return u({path:n.path})}},[n.path,u,f]);return(0,o.jsxs)(D.View,{py:2,row:!0,gap:4,align:"center",children:[(0,o.jsx)(ee.default,{path:n.path,prefix:c,source:d,onClick:p}),(0,o.jsx)(et.default,{type:f}),(0,o.jsx)(Z,{file:n,list:r,stageFiles:i,restoreFiles:a,disabled:void 0!==l&&l})]})}var er=(0,j.cssRecord)({actions:[T.rcss.backgroundColor.backgroundHighest,T.rcss.borderRadius(8)],buttonDiscard:[T.rcss.borderRadius(8,0,0,8)],buttonStage:[T.rcss.borderRadius(0,8,8,0)],divider:[T.rcss.my(8),T.rcss.width(1),T.rcss.backgroundColor.outlineStronger]});function ei(e){var t=e.type,n=e.stageFiles,i=e.restoreFiles,s=e.disabled,l=void 0!==s&&s,u=(0,r._)((0,a.useState)(!1),2),f=u[0],p=u[1],h=(0,r._)((0,a.useState)(!1),2),g=h[0],m=h[1];function x(){return(0,c._)(function(){return(0,d._)(this,function(e){switch(e.label){case 0:if(l)return[2];return p(!0),[4,n({all:"index"!==t})];case 1:return e.sent(),p(!1),[2]}})})()}return(l=l||g||f,"index"===t)?(0,o.jsx)(E.Button,{text:"Unstage All",iconLeft:f?(0,o.jsx)(K.default,{}):(0,o.jsx)(Y.default,{}),onClick:x,disabled:l,loading:f,size:"small"}):(0,o.jsxs)(D.View,{css:er.actions,row:!0,gap:2,children:[(0,o.jsx)(E.Button,{css:er.buttonDiscard,text:"Discard All",iconLeft:g?(0,o.jsx)(K.default,{}):(0,o.jsx)(X.default,{}),onClick:function(){return(0,c._)(function(){return(0,d._)(this,function(e){switch(e.label){case 0:if(l||"worktree"!==t)return[2];return m(!0),[4,i(!0)];case 1:return e.sent(),m(!1),[2]}})})()},disabled:l,loading:g,size:"small"}),(0,o.jsx)("div",{css:er.divider}),(0,o.jsx)(E.Button,{css:er.buttonStage,text:"Stage All",iconLeft:f?(0,o.jsx)(K.default,{}):(0,o.jsx)(Q.default,{}),onClick:x,disabled:l,loading:f,size:"small"})]})}var eo=(0,j.cssRecord)({header:[T.rcss.px(8),T.rcss.rowWithGap(4),T.rcss.align.center],headerFoldable:[T.rcss.py(4),T.rcss.pl(4),T.rcss.pr(8),T.rcss.rowWithGap(4),T.rcss.align.center],headerText:[T.rcss.flex.grow(1)],body:[T.rcss.px(8),T.rcss.maxHeight("25vh"),T.rcss.overflowY("auto")]});function ea(e){var t,n=e.files,i=e.type,s=e.stageFiles,l=e.restoreFiles,u=e.onFilePathClick,c=e.pathMap,d=e.foldable,f=void 0!==d&&d,p=e.disabled,h=void 0!==p&&p,g=(0,r._)((0,a.useState)(!1),2),m=g[0],x=g[1],y=(0,a.useRef)(null),b=(0,a.useRef)(null),w=(0,H.useVirtualizer)({count:n.length,getScrollElement:function(){return b.current},getItemKey:function(e){return n[e].path},estimateSize:function(){return 28},overscan:20}),k=w.getVirtualItems();return f&&m?(0,o.jsx)(D.View,{py:4,children:(0,o.jsxs)(D.View,{css:f?eo.headerFoldable:eo.header,children:[(0,o.jsx)(es,{files:n,type:i,setFolded:x,foldable:!0,folded:!0}),(0,o.jsx)(ei,{type:i,stageFiles:s,restoreFiles:l,disabled:h})]})}):(0,o.jsxs)(D.View,{innerRef:y,pt:4,pb:8,gap:4,children:[(0,o.jsxs)(D.View,{css:f?eo.headerFoldable:eo.header,children:[(0,o.jsx)(es,{files:n,type:i,setFolded:x,foldable:f}),(0,o.jsx)(ei,{type:i,stageFiles:s,restoreFiles:l,disabled:h})]}),(0,o.jsx)(D.SpecializedView.div,{ref:b,css:eo.body,children:(0,o.jsx)("div",{style:{minHeight:w.getTotalSize()},children:(0,o.jsx)("div",{style:{transform:"translateY(".concat(null==(t=k[0])?void 0:t.start,"px)"),willChange:"transform"},children:k.map(function(e){var t=n[e.index];return(0,o.jsx)("div",{"data-index":e.index,children:(0,o.jsx)(en,{file:t,list:i,stageFiles:s,restoreFiles:l,onFilePathClick:u,pathMap:c,disabled:h},t.path)},e.key.toString())})})})})]})}function es(e){var t=e.files,n=e.type,r=e.setFolded,i=e.foldable,a=void 0!==i&&i,s=e.folded,l=(0,f.default)("file",t.length),u="".concat(t.length," ").concat("index"===n?"staged":"changed"," ").concat(l);return a&&void 0!==s&&s?(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(q.IconButton,{alt:"Show list",onClick:function(){return r(!1)},children:(0,o.jsx)(O.default,{})}),(0,o.jsx)(A.Text,{css:eo.headerText,multiline:!1,children:u})]}):(0,o.jsxs)(o.Fragment,{children:[a?(0,o.jsx)(q.IconButton,{alt:"Hide list",onClick:function(){return r(!0)},children:(0,o.jsx)(N.default,{color:C.tokens.foregroundDimmest})}):null,(0,o.jsx)(A.Text,{css:eo.headerText,color:"dimmest",multiline:!1,children:u})]})}var el=e.i(878420),eu=e.i(64386),ec=e.i(98816),ed=e.i(739521),ef=e.i(71754),ep=(0,j.cssRecord)({list:[T.rcss.px(4),T.rcss.colWithGap(2)]});function eh(e){var t=e.show,n=e.files,r=e.pathMap,i=e.callback,s=(0,ec.default)(i),l=(0,a.useCallback)(function(){var e;null==(e=s.current)||e.call(s,!0)},[s]),u=(0,a.useCallback)(function(){var e;null==(e=s.current)||e.call(s,!1)},[s]);return(0,o.jsx)(ed.Modal,{isOpen:t,onRequestClose:u,children:t?(0,o.jsxs)(D.View,{gap:8,children:[(0,o.jsxs)(A.Header,{level:2,children:["Discard ",(0,f.default)("Change",n.length)]}),(0,o.jsx)(eg,{files:n,pathMap:r}),(0,o.jsxs)(D.View,{row:!0,gap:8,justify:"end",children:[(0,o.jsx)(E.Button,{text:"Cancel",iconLeft:(0,o.jsx)(ef.default,{}),onClick:u}),(0,o.jsx)(E.Button,{text:"Discard ".concat((0,f.default)("Change",n.length)),iconLeft:(0,o.jsx)(X.default,{}),colorway:"negative",onClick:l})]})]}):null})}function eg(e){var t=e.files,n=e.pathMap,r=[],i=[],a=!0,s=!1,l=void 0;try{for(var u,c=t[Symbol.iterator]();!(a=(u=c.next()).done);a=!0){var d=u.value;d.type.worktree===$.GitStatusChangedFileType.UNTRACKED?i.push(d):r.push(d)}}catch(e){s=!0,l=e}finally{try{a||null==c.return||c.return()}finally{if(s)throw l}}return!r.length&&i.length?(0,o.jsxs)(D.View,{gap:4,children:[(0,o.jsx)(A.Text,{children:1===i.length?"Do you want to permanently delete this file?":"Do you want to permanently delete these files?"}),(0,o.jsx)(em,{files:i,pathMap:n})]}):r.length&&!i.length?(0,o.jsxs)(D.View,{gap:4,children:[(0,o.jsx)(A.Text,{children:1===r.length?"Do you want to undo the changes to this file?":"Do you want to undo the changes to these files?"}),(0,o.jsx)(em,{files:r,pathMap:n})]}):(0,o.jsxs)(D.View,{gap:12,children:[r.length?(0,o.jsxs)(D.View,{gap:4,children:[(0,o.jsxs)(A.Header,{level:3,children:["Tracked ",(0,f.default)("File",r.length)]}),(0,o.jsx)(A.Text,{multiline:!1,children:1===r.length?"This file will have its changes undone.":"These files will have their changes undone."}),(0,o.jsx)(em,{files:r,pathMap:n})]}):null,i.length?(0,o.jsxs)(D.View,{gap:4,children:[(0,o.jsxs)(A.Header,{level:3,children:["Untracked ",(0,f.default)("File",i.length)]}),(0,o.jsx)(A.Text,{multiline:!1,children:1===i.length?"This file will be permanently deleted.":"These files will be permanently deleted."}),(0,o.jsx)(em,{files:i,pathMap:n})]}):null]})}function em(e){var t=e.files,n=e.pathMap,r=(0,a.useMemo)(function(){return t.length>20?t.slice(0,20):t},[t]);return(0,o.jsx)(D.View,{children:(0,o.jsxs)("ul",{css:ep.list,children:[r.map(function(e){var t;return(0,o.jsx)("li",{children:(0,o.jsx)(ee.default,{path:e.path,prefix:n.get(e.path),source:null==(t=e.source)?void 0:t.path})},e.path)}),t.length<=20?null:(0,o.jsx)("li",{children:(0,o.jsxs)(A.Text,{color:"dimmer",children:["... ",t.length-20," more"," ",(0,f.default)("file",t.length-20)]})})]})})}function ev(e){var t=(0,r._)((0,a.useState)(function(){return{show:!1,files:[]}}),2),n=t[0],i=t[1];return{openRestoreConfirmationModal:(0,a.useCallback)(function(e){return new Promise(function(t){0===e.length&&t(!1),i({show:!0,files:e,callback:function(e){i({show:!1,files:[],callback:void 0}),t(e)}})})},[]),restoreConfirmationModal:(0,a.useMemo)(function(){return(0,o.jsx)(eh,(0,eu._)((0,el._)({},n),{pathMap:e}))},[n,e])}}var ex=[{"& > span:first-child":[T.rcss.flex.grow(1),T.rcss.textAlign.left]},{"& > span":[T.rcss.flex.shrink(1)]}],ey=(0,j.cssRecord)({buttonFolded:[ex,T.rcss.height("auto"),T.rcss.py(8),T.rcss.fontWeight.medium],buttonUnfolded:[ex,T.rcss.height("auto"),T.rcss.py(8),T.rcss.fontWeight.medium,T.rcss.border({color:C.tokens.outlineDimmer,direction:"bottom"}),T.rcss.borderRadius(8,8,0,0)],container:[T.rcss.flex.grow(1),T.rcss.borderRadius(8)],lists:[T.rcss.borderRadius(0,0,8,8)],divider:[T.rcss.height(1),T.rcss.minHeight(1),T.rcss.width("100%"),T.rcss.backgroundColor.outlineDimmer],autoStageMessage:[T.rcss.center],noChangesMessage:[T.rcss.center],details:[T.rcss.rowWithGap(4),T.rcss.fontWeight.normal,T.rcss.color.foregroundDimmest]});function eb(e){var t=e.status,n=e.stageFiles,i=e.restoreFiles,s=e.onStagedFileClick,l=e.disabled,u=void 0!==l&&l,f=(0,r._)((0,a.useState)(!1),2),p=f[0],h=f[1],g=(0,r._)((0,a.useState)(!1),2),m=g[0],x=g[1],y=(0,r._)((0,a.useState)(!1),2),b=y[0],w=y[1],k=(0,a.useMemo)(function(){return(0,z.getUniquePathMap)(t.changes.map(function(e){return e.path}))},[t]),_=(0,r._)((0,a.useMemo)(function(){var e=[],n=[],r=!0,i=!1,o=void 0;try{for(var a,s=t.changes[Symbol.iterator]();!(r=(a=s.next()).done);r=!0){var l=a.value;l.staged&&e.push(l),l.type.worktree!==$.GitStatusChangedFileType.UNMODIFIED&&n.push(l)}}catch(e){i=!0,o=e}finally{try{r||null==s.return||s.return()}finally{if(i)throw o}}return[e,n]},[t.changes]),2),S=_[0],C=_[1],j=S.length>0&&C.length>0,T=ev(k),E=T.openRestoreConfirmationModal,R=T.restoreConfirmationModal,P=(0,a.useCallback)(function(e){return(0,c._)(function(){return(0,d._)(this,function(t){switch(t.label){case 0:if(!("all"in e))return[3,2];return x(!0),[4,n(e)];case 1:return t.sent(),x(!1),[3,4];case 2:return[4,n(e)];case 3:t.sent(),t.label=4;case 4:return[2]}})})()},[n]),O=(0,a.useCallback)(function(e){return(0,c._)(function(){var t,n;return(0,d._)(this,function(r){switch(r.label){case 0:if(!0!==e)return[3,4];return w(!0),[4,E(C)];case 1:if(!r.sent())return[3,3];return[4,i(e)];case 2:r.sent(),r.label=3;case 3:return w(!1),[3,8];case 4:if("string"==typeof e){if(!(n=C.find(function(t){return t.path===e})))throw w(!1),Error("Could not find file in worktree list");t=[n]}else t=C.filter(function(t){return e.includes(t.path)});return[4,E(t)];case 5:if(!r.sent())return[3,7];return[4,i(e)];case 6:r.sent(),r.label=7;case 7:w(!1),r.label=8;case 8:return[2]}})})()},[E,i,C]);return p?(0,o.jsx)(ew,{setFolded:h,changeCount:C.length,stagedCount:S.length,disabled:u,folded:!0}):0===S.length&&0===C.length?(0,o.jsxs)(D.View,{style:{opacity:u?.725:void 0},css:ey.container,children:[(0,o.jsx)(ew,{setFolded:h,changeCount:C.length,stagedCount:S.length,disabled:u}),(0,o.jsx)(I.Surface,{css:ey.lists,elevated:!0,children:(0,o.jsx)(D.View,{css:ey.noChangesMessage,py:16,px:4,children:(0,o.jsx)(A.Text,{color:"dimmest",multiline:!1,children:"No changed or staged files."})})})]}):(0,o.jsxs)(o.Fragment,{children:[(0,o.jsxs)(D.View,{style:{opacity:u?.725:void 0},css:ey.container,children:[(0,o.jsx)(ew,{setFolded:h,changeCount:C.length,stagedCount:S.length,disabled:u}),(0,o.jsxs)(I.Surface,{css:ey.lists,elevated:!0,children:[0===S.length?null:(0,o.jsx)(ea,{type:"index",files:S,stageFiles:P,restoreFiles:O,onFilePathClick:s,pathMap:k,foldable:j,disabled:u||m||b}),j?(0,o.jsx)("div",{css:ey.divider}):null,0===C.length?null:(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(ea,{type:"worktree",files:C,stageFiles:P,restoreFiles:O,onFilePathClick:s,pathMap:k,foldable:j,disabled:u||m||b}),j?null:(0,o.jsx)(D.View,{css:ey.autoStageMessage,pt:4,pb:8,px:4,children:(0,o.jsx)(A.Text,{variant:"small",color:"dimmest",multiline:!1,children:"Committing will automatically stage your changes."})})]})]})]}),R]})}function ew(e){var t=e.folded,n=void 0!==t&&t,r=e.setFolded,i=e.changeCount,a=e.stagedCount,s=e.disabled;return(0,o.jsx)(E.Button,{css:n?ey.buttonFolded:ey.buttonUnfolded,text:"Review Changes",secondaryText:(0,o.jsx)(ek,{folded:n,changeCount:i,stagedCount:a}),onClick:function(){return r(!n)},iconRight:n?(0,o.jsx)(O.default,{}):(0,o.jsx)(N.default,{}),disabled:void 0!==s&&s,size:"small"})}function ek(e){var t=e.folded,n=e.changeCount,r=e.stagedCount;if(!t)return null;var i=n>0,a=r>0;return i||a?(0,o.jsxs)("span",{css:ey.details,children:[i?(0,o.jsxs)("span",{children:[n," ",(0,f.default)("change",n)]}):null,i&&a?(0,o.jsx)("span",{children:"/"}):null,a?(0,o.jsxs)("span",{children:[r," staged"]}):null]}):(0,o.jsx)("span",{css:ey.details,children:(0,o.jsx)("span",{children:"no changes"})})}var e_=e.i(616278);function eS(e){var t=e.status,n=e.onStagedFileClick,i=e.defaultMessage,s=(0,r._)((0,a.useState)(t),2),l=s[0],u=s[1],x=(0,r._)((0,a.useState)(null!=i?i:""),2),y=x[0],b=x[1],w=(0,r._)((0,a.useState)(0),2),k=w[0],_=w[1],S=(0,r._)((0,a.useState)(!1),2),C=S[0],j=S[1],T=(0,h.useNotifyGitError)();(0,a.useEffect)(function(){return u(t)},[t]);var R=(0,p.default)().git;if(!l||!l.changes.length)return(0,o.jsx)(D.View,{gap:8,children:(0,o.jsx)(A.Text,{color:"dimmest",multiline:!1,children:"There are no changes to commit."})});var I=l.changes.length,O=l.changes.filter(function(e){return e.staged}).length;function N(){return(0,c._)(function(){var e,t;return(0,d._)(this,function(n){switch(n.label){case 0:if(""===y||C||0===I||k>0)return[2];if(j(!0),0!==O)return[3,2];return[4,R.stageFiles({all:!0})];case 1:n.sent(),n.label=2;case 2:return[4,R.commit({message:y})];case 3:if(!(e=n.sent()).error)return[3,4];return j(!1),T(e.error),(0,g.reportErrorToSentry)({context:"commit-area-commit",gitService:R,result:e,data:{message:y}}),[3,6];case 4:return(0,m.trackGitPaneEvent)("commit-created",{hasDescription:-1!==y.trim().indexOf("\n\n")}),[4,R.status()];case 5:t=n.sent(),j(!1),t.error?(T(t.error),(0,g.reportErrorToSentry)({context:"commit-area-status",gitService:R,result:t,data:{message:y}})):(b(""),u(t)),R.forceRefresh(),n.label=6;case 6:return[2]}})})()}var M="Nothing to commit";if(C)M="Committing...";else if(O>0&&O<I){var L=(0,f.default)("change",O);M="Commit ".concat(O," staged ").concat(L)}else I>0&&(M="Stage and commit all changes");var B=!y||0===I||k>0||C;return(0,o.jsxs)(D.View,{gap:8,children:[(0,o.jsx)(V,{message:y,disabled:C,onMessageChange:b,onCommitShortcut:N}),(0,o.jsx)(eb,{status:l,stageFiles:function(e){return(0,c._)(function(){var t,n;return(0,d._)(this,function(r){switch(r.label){case 0:if(C)return[2];return _(function(e){return e+1}),[4,R.stageFiles(e)];case 1:if((t=r.sent()).error)return[3,3];return[4,R.status()];case 2:return(n=r.sent()).error?((0,g.reportErrorToSentry)({context:"commit-area-status",gitService:R,result:n,data:{opts:e}}),T(n.error)):u(n),R.forceRefresh(),[3,4];case 3:T(t.error),(0,g.reportErrorToSentry)({context:"commit-area-stage-files",gitService:R,result:t,data:{opts:e}}),r.label=4;case 4:return _(function(e){return e-1}),[2]}})})()},restoreFiles:function(e){return(0,c._)(function(){var t,n;return(0,d._)(this,function(r){switch(r.label){case 0:if(C)return[2];return _(function(e){return e+1}),[4,R.restoreFiles(e)];case 1:if((t=r.sent()).error)return[3,3];return[4,R.status()];case 2:return(n=r.sent()).error?((0,g.reportErrorToSentry)({context:"commit-area-status",gitService:R,result:n,data:{files:e}}),T(n.error)):u(n),R.forceRefresh(),[3,4];case 3:(0,g.reportErrorToSentry)({context:"commit-area-restore-files",gitService:R,result:t,data:{files:e}}),T(t.error),r.label=4;case 4:return _(function(e){return e-1}),[2]}})})()},onStagedFileClick:n,disabled:C}),B?(0,o.jsx)(P.Tooltip,{tooltip:k>0?"Changes in progress":0===I?"There are no changes to commit.":"You must enter a commit message before you can commit.",children:(0,o.jsx)(E.Button,{text:M,onClick:N,disabled:B,loading:C,colorway:"primary",iconLeft:(0,o.jsx)(e_.default,{}),stretch:!0})}):(0,o.jsx)(E.Button,{text:M,onClick:N,disabled:B,loading:C,colorway:"primary",iconLeft:(0,o.jsx)(e_.default,{}),stretch:!0})]})}e.s(["default",()=>eS],25358);var eC=e.i(886513),ej=/\s\(#(\d+)\)$/,eT=/^Revert "(.+)"/,eE=/^This reverts commit ([a-f0-9]+)(?:, reversing changes made to ([a-f0-9]+))?\./;function eR(e){var t=eT.exec(e.subject),n=eE.exec(e.body);if(t&&n){var r,i=n[1],o=t[1],a=ej.exec(o);return a&&(r=parseInt(a[1],10)),{hash:i,subject:o,pr:r}}return null}var eI=/\B#\d+\b/g,eA=/^Merged? pull request (#\d+\b)/,eP=/^Merge branch '(.+)'/,eD=/into (.+)$/;function eO(e){if("GitHub"===e.committer.name&&"noreply@github.com"===e.committer.email){var t=e.subject.match(eI);if(t){var n,r=parseInt(t[t.length-1].slice(1),10);if(r)return ej.test(e.subject)&&(n=e.subject.replace(ej,"").trim()),!n&&eA.test(e.subject)&&e.body&&-1===e.body.indexOf("\n")&&(n=e.body),{type:"pull-request",id:r,subject:n,reverts:eR(e)}}}if(eA.test(e.subject)){var i,o=eA.exec(e.subject);if(o)return e.body&&-1===e.body.indexOf("\n")&&(i=e.body),{type:"pull-request",id:parseInt(o[1].slice(1),10),subject:i,reverts:eR(e)}}if(eP.test(e.subject)){var a=eP.exec(e.subject);if(a){var s=eD.exec(e.subject);return{type:"branch",source:a[1],target:s?s[1]:null}}}return e.parents&&e.parents.length>2?{type:"octopus",parents:e.parents}:e.parents&&e.parents.length>1?{type:"simple",a:e.parents[0],b:e.parents[1]}:null}var eN={position:"absolute",top:0,height:9,width:9,border:"1px solid ".concat(C.tokens.purpleStrongest),borderRadius:"50%"},eM=(0,j.cssRecord)({markerContainer:[T.rcss.display.flex,T.rcss.align.center,T.rcss.justify.center,T.rcss.minHeight(20),T.rcss.minWidth(20)],commitMarker:[T.rcss.height(4),T.rcss.width(4),T.rcss.backgroundColor.foregroundDefault,T.rcss.borderRadius("full")],collapsedMarkerIconDot:[T.rcss.height(3),T.rcss.width(3),T.rcss.backgroundColor.foregroundDimmer,T.rcss.borderRadius("full")],collapsedMarkerIconContainer:[T.rcss.display.flex,T.rcss.align.center,T.rcss.justify.center,{"div + div":{marginLeft:1}}],collapsedMarker:[T.rcss.display.flex,T.rcss.align.center,T.rcss.justify.center,T.rcss.height(20),T.rcss.width(20),T.rcss.backgroundColor.backgroundHighest,T.rcss.borderRadius("full")],revertMarker:[T.rcss.display.flex,T.rcss.height(20),T.rcss.width(20),T.rcss.backgroundColor.orangeDimmest,T.rcss.borderRadius("full"),T.rcss.align.center,T.rcss.justify.center],mergeMarker:[T.rcss.display.flex,T.rcss.height(20),T.rcss.width(20),T.rcss.backgroundColor.purpleDimmest,T.rcss.borderRadius("full"),T.rcss.align.center,T.rcss.justify.center],mergeMarkerIconContainer:[T.rcss.position.relative,T.rcss.height(9),T.rcss.width(13)],mergeMarkerIconLeft:[(0,el._)({},eN),T.rcss.left(0)],mergeMarkerIconRight:[(0,el._)({},eN),T.rcss.right(0)],boundaryMarker:[T.rcss.height(6),T.rcss.width(6),T.rcss.backgroundColor.backgroundDefault,T.rcss.borderRadius("full"),{border:"1px solid ".concat(C.tokens.backgroundHighest)}]});function eL(e){var t=function(e){switch(e){case"none":default:return null;case"commit":return(0,o.jsx)(eB,{});case"revert":return(0,o.jsx)(eV,{});case"merge":return(0,o.jsx)(eF,{});case"boundary":return(0,o.jsx)(eU,{});case"collapsed":return(0,o.jsx)(eG,{})}}(e.type);return t?(0,o.jsx)("div",{css:eM.markerContainer,children:t}):null}function eB(){return(0,o.jsx)("div",{css:eM.commitMarker})}function eV(){return(0,o.jsx)("div",{css:eM.revertMarker,children:(0,o.jsx)(X.default,{size:12,color:C.tokens.orangeStrongest})})}function eF(){return(0,o.jsx)("div",{css:eM.mergeMarker,children:(0,o.jsxs)("div",{css:eM.mergeMarkerIconContainer,children:[(0,o.jsx)("div",{css:eM.mergeMarkerIconLeft}),(0,o.jsx)("div",{css:eM.mergeMarkerIconRight})]})})}function eU(){return(0,o.jsx)("div",{css:eM.boundaryMarker})}function eG(){return(0,o.jsx)("div",{css:eM.collapsedMarker,children:(0,o.jsxs)("div",{css:eM.collapsedMarkerIconContainer,children:[(0,o.jsx)("div",{css:eM.collapsedMarkerIconDot}),(0,o.jsx)("div",{css:eM.collapsedMarkerIconDot}),(0,o.jsx)("div",{css:eM.collapsedMarkerIconDot})]})})}var e$=e.i(721281),ez=[T.rcss.position.absolute,T.rcss.left(0),T.rcss.width(18)],eH=(0,j.cssRecord)({connectorSegmentBorderSolid:[ez,{borderRight:"1px solid ".concat(C.tokens.outlineDimmest)}],connectorSegmentBorderDashed:[ez,{borderRight:"1px dashed ".concat(C.tokens.outlineDimmest)}]});function eW(e){var t=e.boundaryTop,n=void 0!==t&&t,r=e.boundaryBottom,i=void 0!==r&&r,a=e.joint,s=void 0===a?"top":a,l=e.hideTop,u=void 0!==l&&l,c=e.hideBottom,d=void 0!==c&&c;if(u&&d)return null;if(n===i&&!u&&!d)return(0,o.jsx)(eK,{top:0,bottom:0,dashed:n&&i});var f=u?null:(0,o.jsx)(eq,{start:"top",joint:s,dashed:n}),p=d?null:(0,o.jsx)(eq,{start:"bottom",joint:s,dashed:i});return(0,o.jsxs)(o.Fragment,{children:[f,p]})}function eq(e){var t,n,r=e.start,i=e.joint,a=e.dashed,s="center"===i?(t={},(0,e$._)(t,r,0),(0,e$._)(t,"height","50%"),t):(n={},(0,e$._)(n,r,0),(0,e$._)(n,r===i?"height":i,8),n);return(0,o.jsx)(eK,(0,eu._)((0,el._)({},s),{dashed:void 0!==a&&a}))}function eK(e){var t=e.top,n=e.bottom,r=e.height,i=e.dashed;return(0,o.jsx)("div",{css:void 0!==i&&i?eH.connectorSegmentBorderDashed:eH.connectorSegmentBorderSolid,style:{top:t,bottom:n,height:r}})}var eY=e.i(754873),eQ=(0,j.cssRecord)({container:{position:"relative",marginLeft:30,marginRight:4,paddingLeft:6,userSelect:"none"},containerInteractive:[eY.interactive.nofill,{position:"relative",marginLeft:30,marginRight:4,paddingLeft:6,userSelect:"none"}],nodeFoldedIconContainer:{position:"absolute",top:"50%",transform:"translateY(-50%)",right:8,zIndex:1,opacity:0,"div:hover > &":{transition:"opacity 120ms ease-out",opacity:1}},nodeUnFoldedIconContainer:{position:"absolute",top:"50%",transform:"translateY(-50%)",right:8,zIndex:1},nodeContentContainer:[T.rcss.colWithGap(4),{position:"relative",paddingTop:8,paddingBottom:8,paddingRight:8}],nodeHeader:{display:"block",height:20},nodeUnfoldedContentSurface:[T.rcss.mt(4),T.rcss.mb(8),T.rcss.p(8),T.rcss.borderRadius(8),{marginLeft:36,marginRight:8,overflowX:"hidden"}],unfoldedContentContainer:[T.rcss.position.relative]});function eX(e){var t=e.boundaryTop,n=e.boundaryBottom,i=void 0!==n&&n,s=e.hideConnectorTop,l=e.hideConnectorBottom,u=void 0!==l&&l,c=e.joint,d=void 0===c?"top":c,f=e.marker,p=e.header,h=e.unfoldedContent,g=e.children,m=e.className,x=(0,r._)((0,a.useState)(!0),2),y=x[0],b=x[1];return(0,o.jsxs)(D.View,{className:m,css:T.rcss.position.relative,children:[(0,o.jsx)(eW,{boundaryTop:void 0!==t&&t,boundaryBottom:i,joint:d,hideTop:void 0!==s&&s,hideBottom:u}),f?(0,o.jsx)(eZ,{joint:d,children:f}):null,h?(0,o.jsxs)(D.View,{css:eQ.containerInteractive,role:"button",tabIndex:0,onClick:function(){b(!y)},onKeyDown:function(e){("Enter"===e.key||" "===e.key)&&b(!y)},children:[y?(0,o.jsx)("div",{css:eQ.nodeFoldedIconContainer,children:(0,o.jsx)(O.default,{})}):(0,o.jsx)("div",{css:eQ.nodeUnFoldedIconContainer,children:(0,o.jsx)(N.default,{})}),(0,o.jsxs)(D.View,{css:eQ.nodeContentContainer,children:[p?(0,o.jsx)(D.View,{css:eQ.nodeHeader,children:p}):null,g?(0,o.jsx)(D.View,{children:g}):null]})]}):(0,o.jsx)(D.View,{css:eQ.container,children:(0,o.jsxs)(D.View,{css:eQ.nodeContentContainer,children:[p?(0,o.jsx)(D.View,{css:eQ.nodeHeader,children:p}):null,g?(0,o.jsx)(D.View,{children:g}):null]})}),!h||y?null:(0,o.jsxs)(D.View,{css:eQ.unfoldedContentContainer,children:[u?null:(0,o.jsx)(eK,{top:0,bottom:0,dashed:i}),(0,o.jsx)(I.Surface,{css:eQ.nodeUnfoldedContentSurface,elevated:!0,children:h})]})]})}var eJ=(0,j.cssRecord)({top:{position:"absolute",top:8,left:18,transform:"translateX(-50%)"},bottom:{position:"absolute",bottom:8,left:18,transform:"translateX(-50%)"},center:{position:"absolute",top:"50%",left:18,transform:"translateX(-50%) translateY(-50%)"}});function eZ(e){var t=e.joint,n=e.children;return(0,o.jsx)("div",{css:eJ[void 0===t?"top":t],children:n})}var e0=e.i(988676),e1=e.i(496019),e2=(0,j.cssRecord)({container:[T.rcss.height("100%")],textContainer:[T.rcss.center],text:[T.rcss.flex.shrink(0)]});function e3(e){var t=e.text,n=(0,eC._)(e,["text"]);return(0,o.jsx)(eX,(0,el._)({marker:(0,o.jsx)(eL,{type:"boundary"}),joint:"center",header:(0,o.jsxs)(D.View,{css:e2.container,row:!0,gap:8,align:"center",justify:"space-between",children:[(0,o.jsx)(e0.DividerH,{}),(0,o.jsxs)(D.View,{css:e2.textContainer,row:!0,gap:4,children:[(0,o.jsx)(e1.default,{size:12,color:C.tokens.foregroundDimmest}),(0,o.jsx)(A.Text,{css:e2.text,variant:"small",color:"dimmest",multiline:!1,children:t})]}),(0,o.jsx)(e0.DividerH,{})]})},n))}var e4=e.i(350098),e8=e.i(688216),e5=e.i(88619),e6=e.i(257811),e9=e.i(51606),e7=(0,j.cssRecord)({definitionList:{display:"grid",gridTemplateColumns:"auto 1fr",paddingLeft:C.tokens.space4,"> dt":{display:"flex",alignItems:"center",paddingBottom:C.tokens.space2},"> dd":{marginLeft:C.tokens.space12,paddingBottom:C.tokens.space2}},listHeader:[T.rcss.fontWeight.medium],commitList:[T.rcss.colWithGap(2),T.rcss.pl(4)]}),te=function(e,t){var n=!e.body,r=null,i=null;return t&&"type"in t?(r=t,"pull-request"===t.type&&(t.reverts&&(i=t.reverts),t.subject&&(n=!0))):t&&(i=t),{hideBody:n,merge:r,revert:i}},tt=function(e){var t=e.hash;return(0,o.jsx)(e5.CopyButton,{size:"small",iconLeft:(0,o.jsx)(e9.default,{}),textToCopy:t,text:t.slice(0,7),tooltipSuccessText:"Hash copied!"})},tn=function(e){var t=e.onClick,n=e.text,r=e.loading;return(0,o.jsx)(P.Tooltip,{tooltip:"Discard current changes and restore files to time of commit",children:(0,o.jsx)(E.Button,{text:n,onClick:t,size:"small",iconLeft:void 0!==r&&r?(0,o.jsx)(K.default,{}):(0,o.jsx)(X.default,{})})})},tr=function(e,t){return e.name!==t.name||e.email!==t.email},ti=function(e,t){return!(6e4>Math.abs(e-t))};function to(e){var t=e.commit,n=e.info,r=tr(t.committer,t.author),i=ti(t.author.date,t.committer.date),a=te(t,void 0===n?null:n),s=a.hideBody,l=a.merge,u=a.revert;return(0,o.jsxs)(D.View,{gap:8,children:[s?null:(0,o.jsxs)(D.View,{gap:8,children:[(0,o.jsx)(A.Text,{children:(0,o.jsx)(e8.CommitBody,{body:t.body})}),(0,o.jsx)(e0.DividerH,{css:T.rcss.backgroundColor.outlineDimmer})]}),(0,o.jsxs)(D.View,{children:[(0,o.jsx)(A.Text,{css:e7.listHeader,multiline:!1,children:"Author"}),(0,o.jsxs)("dl",{css:e7.definitionList,children:[(0,o.jsx)("dt",{children:"Name:"}),(0,o.jsx)("dd",{children:t.author.name}),(0,o.jsx)("dt",{children:"Email:"}),(0,o.jsx)("dd",{children:t.author.email})]})]}),r?(0,o.jsxs)(D.View,{children:[(0,o.jsx)(A.Text,{css:e7.listHeader,multiline:!1,children:"Committer"}),(0,o.jsxs)("dl",{css:e7.definitionList,children:[(0,o.jsx)("dt",{children:"Name:"}),(0,o.jsx)("dd",{children:t.committer.name}),(0,o.jsx)("dt",{children:"Email:"}),(0,o.jsx)("dd",{children:t.committer.email})]})]}):null,(0,o.jsxs)(D.View,{children:[(0,o.jsx)(A.Text,{css:e7.listHeader,multiline:!1,children:"Commit"}),(0,o.jsxs)("dl",{css:e7.definitionList,children:[i?(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("dt",{children:"Authored:"}),(0,o.jsx)("dd",{children:(0,o.jsx)(e6.Timestamp,{date:t.author.date,dateFormat:"absolute"})}),(0,o.jsx)("dt",{children:"Committed:"}),(0,o.jsx)("dd",{children:(0,o.jsx)(e6.Timestamp,{date:t.committer.date,dateFormat:"absolute"})})]}):(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("dt",{children:"Date:"}),(0,o.jsx)("dd",{children:(0,o.jsx)(e6.Timestamp,{date:t.author.date,dateFormat:"absolute"})})]}),(0,o.jsx)("dt",{children:"Hash:"}),(0,o.jsx)("dd",{children:(0,o.jsx)(tt,{hash:t.hash})}),l&&"pull-request"===l.type?(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("dt",{children:"PR:"}),(0,o.jsxs)("dd",{children:["#",l.id]})]}):null,l&&"branch"===l.type?(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("dt",{children:"Merged:"}),(0,o.jsx)("dd",{children:l.source}),l.target?(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("dt",{children:"Into:"}),(0,o.jsx)("dd",{children:l.target})]}):null]}):null,u?(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("dt",{children:"Reverted:"}),(0,o.jsx)("dd",{children:u.hash})]}):null]})]}),l&&"simple"===l.type?(0,o.jsxs)(D.View,{children:[(0,o.jsx)(A.Text,{css:e7.listHeader,multiline:!1,children:"Merged"}),(0,o.jsxs)(D.View,{css:e7.commitList,children:[(0,o.jsx)(A.Text,{multiline:!1,children:l.a}),(0,o.jsx)(A.Text,{multiline:!1,children:l.b})]})]}):null,l&&"octopus"===l.type?(0,o.jsxs)(D.View,{children:[(0,o.jsx)(A.Text,{css:e7.listHeader,multiline:!1,children:"Merged"}),(0,o.jsx)(D.View,{css:e7.commitList,children:l.parents.map(function(e,t){return(0,o.jsx)(A.Text,{multiline:!1,children:e},t)})})]}):null]})}var ta=(0,j.cssRecord)({headerText:[T.rcss.rowWithGap(4),T.rcss.flex.row,T.rcss.align.stretch,T.rcss.fontWeight.medium,{"> span":{whiteSpace:"nowrap",textOverflow:"ellipsis",overflow:"hidden"}}],headerContainer:[{"> span":{width:"calc(100%)"}}],button:[T.rcss.reset.button,T.rcss.linkStyle,T.rcss.color.foregroundDefault,T.rcss.fontWeight.medium,{display:"block",width:"100%",textAlign:"left"}]}),ts=function(e){var t=e.author;return(0,o.jsxs)(D.View,{row:!0,gap:8,align:"center",children:[(0,o.jsx)(e4.default,{name:t.name,email:t.email,color:"dimmer",allowPlaceholderAvatar:!0,small:!0}),(0,o.jsx)(e6.Timestamp,{date:t.date,textColor:"dimmest",textVariant:"small",dateFormat:"switch"})]})},tl=function(e){var t=e.children;return(0,o.jsx)(A.Text,{css:ta.headerText,multiline:!1,maxLines:1,children:t})},tu=function(e){var t=e.commit,n=e.onViewCommitClick,r=e.children;return(0,o.jsx)(D.View,{css:ta.headerContainer,gap:4,align:"start",justify:"start",children:(0,o.jsx)(P.Tooltip,{tooltip:"View ".concat(t.hash.slice(0,7)),children:(0,o.jsx)("button",{css:ta.button,onClick:function(){return n(t.hash)},children:r})})})};function tc(e){var t=e.commit,n=(0,eC._)(e,["commit"]);return(0,o.jsx)(eX,(0,eu._)((0,el._)({marker:(0,o.jsx)(eL,{type:"commit"}),header:(0,o.jsx)(tl,{children:(0,o.jsx)(e8.CommitSubject,{subject:t.subject})}),unfoldedContent:(0,o.jsx)(to,{commit:t})},n),{children:(0,o.jsx)(ts,{author:t.author})}))}var td=function(e){var t=e.commit,n=e.onViewCommitClick,r=(0,eC._)(e,["commit","onViewCommitClick"]);return(0,o.jsx)(eX,(0,eu._)((0,el._)({marker:(0,o.jsx)(eL,{type:"commit"}),header:(0,o.jsx)(tu,{commit:t,onViewCommitClick:function(){return n(t.hash)},children:(0,o.jsx)(tl,{children:(0,o.jsx)(e8.CommitSubject,{subject:t.subject})})})},r),{children:(0,o.jsx)(ts,{author:t.author})}))},tf=e.i(902846);function tp(e){var t,n=e.commit,r=e.info,i=(0,eC._)(e,["commit","info"]);return"branch"!==r.type&&(t="pull-request"===r.type&&r.subject?r.subject:n.subject),(0,o.jsx)(eX,(0,eu._)((0,el._)({marker:(0,o.jsx)(eL,{type:"merge"}),header:(0,o.jsxs)(tl,{children:[(0,o.jsx)(e8.MergeText,{text:"merged"}),(0,o.jsx)(tg,{info:r,hash:n.hash,subject:n.subject})]}),unfoldedContent:(0,o.jsx)(to,{commit:n,info:r})},i),{children:(0,o.jsxs)(D.View,{gap:8,children:[t?(0,o.jsx)(A.Text,{color:"dimmer",variant:"small",multiline:!1,children:(0,o.jsx)(e8.CommitSubject,{subject:t})}):null,(0,o.jsx)(ts,{author:n.author})]})}))}var th=function(e){var t,n=e.commit,r=e.info,i=e.onViewCommitClick,a=(0,eC._)(e,["commit","info","onViewCommitClick"]);return"branch"!==r.type&&(t="pull-request"===r.type&&r.subject?r.subject:n.subject),(0,o.jsx)(eX,(0,eu._)((0,el._)({marker:(0,o.jsx)(eL,{type:"merge"}),header:(0,o.jsx)(tu,{commit:n,onViewCommitClick:function(){return i(n.hash)},children:(0,o.jsxs)(tl,{children:[(0,o.jsx)(e8.MergeText,{text:"merged"}),(0,o.jsx)(tg,{info:r,hash:n.hash,subject:n.subject})]})})},a),{children:(0,o.jsxs)(D.View,{gap:8,children:[t?(0,o.jsx)(A.Text,{color:"dimmer",variant:"small",multiline:!1,children:(0,o.jsx)(e8.CommitSubject,{subject:t})}):null,(0,o.jsx)(ts,{author:n.author})]})}))};function tg(e){var t=e.info,n=e.hash,r=e.subject,i=(0,o.jsx)("span",{css:T.rcss.fontWeight.medium,children:r});switch(t.type){case"pull-request":return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("span",{children:"pull request"}),(0,o.jsx)(e8.PullRequestID,{id:t.id}),t.reverts&&t.reverts.pr?(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("span",{children:"-"}),(0,o.jsx)(e8.RevertText,{text:"reverts"}),(0,o.jsx)(e8.PullRequestID,{id:t.reverts.pr})]}):null]});case"branch":if(!t.target)return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("span",{children:"branch"}),(0,o.jsx)(e8.BranchName,{name:t.source})]});return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(e8.BranchName,{name:t.source}),(0,o.jsx)("span",{children:"into"}),(0,o.jsx)(e8.BranchName,{name:t.target})]});case"simple":return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(e8.Hash,{hash:t.a}),(0,o.jsx)(tf.default,{css:{alignSelf:"center"},size:12}),(0,o.jsx)(e8.Hash,{hash:t.b})]});case"octopus":return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("span",{children:"commit"}),(0,o.jsx)(e8.Hash,{hash:n}),(0,o.jsxs)("span",{children:["(",t.parents.length," parents)"]})]});default:return i}}function tm(e){var t=e.commit,n=e.info,r=(0,eC._)(e,["commit","info"]);return(0,o.jsx)(eX,(0,eu._)((0,el._)({marker:(0,o.jsx)(eL,{type:"revert"}),header:(0,o.jsxs)(tl,{children:[(0,o.jsx)(e8.RevertText,{text:"reverted"}),(0,o.jsx)(e8.Hash,{hash:n.hash}),(0,o.jsx)(e8.CommitSubject,{subject:n.subject,quoted:!0})]}),unfoldedContent:(0,o.jsx)(to,{commit:t,info:n})},r),{children:(0,o.jsx)(ts,{author:t.author})}))}var tv=function(e){var t=e.commit,n=e.info,r=e.onViewCommitClick,i=(0,eC._)(e,["commit","info","onViewCommitClick"]);return(0,o.jsx)(eX,(0,eu._)((0,el._)({marker:(0,o.jsx)(eL,{type:"revert"}),header:(0,o.jsx)(tu,{commit:t,onViewCommitClick:function(){return r(t.hash)},children:(0,o.jsxs)(tl,{children:[(0,o.jsx)(e8.RevertText,{text:"reverted"}),(0,o.jsx)(e8.Hash,{hash:n.hash}),(0,o.jsx)(e8.CommitSubject,{subject:n.subject,quoted:!0})]})})},i),{children:(0,o.jsx)(ts,{author:t.author})}))},tx=(0,j.cssRecord)({body:[T.rcss.flex.growAndShrink(1)],virtualItem:[T.rcss.position.absolute,T.rcss.top(0),T.rcss.left(0),T.rcss.width("100%"),T.rcss.overflow("hidden")],virtualList:[T.rcss.position.relative]}),ty=function(){return 60};function tb(e){var t=e.items,n=(0,a.useRef)(null),r=(0,H.useVirtualizer)({overscan:10,count:t.length,getScrollElement:function(){return n.current},estimateSize:ty});return(0,o.jsx)("div",{ref:n,css:tx.body,children:(0,o.jsx)("div",{css:tx.virtualList,style:{height:"".concat(r.getTotalSize(),"px")},children:r.getVirtualItems().map(function(e){return(0,o.jsx)("div",{css:tx.virtualItem,style:{transform:"translateY(".concat(e.start,"px)")},"data-index":e.index,ref:r.measureElement,children:(0,o.jsx)(tw,{items:t,index:e.index})},e.key.toString())})})})}function tw(e){var t=e.items,n=e.index,r=t[n],i=0===n,a=n===t.length-1;if("boundary"===r.type)return(0,o.jsx)(e3,{text:r.text,hideConnectorTop:i,hideConnectorBottom:a,boundaryTop:!0,boundaryBottom:!0},r.text);var s=t[n-1]?t[n-1].type:null,l=t[n+1]?t[n+1].type:null;return(0,o.jsx)(tk,{commit:r.commit,hideConnectorTop:i,hideConnectorBottom:a,boundaryTop:"commit"!==s,boundaryBottom:"commit"!==l,onViewCommitClick:r.onViewCommitClick},r.commit.hash)}function tk(e){var t=e.commit,n=e.onViewCommitClick,r=(0,eC._)(e,["commit","onViewCommitClick"]),i=eO(t);if(i)return n?(0,o.jsx)(th,(0,el._)({info:i,commit:t,onViewCommitClick:n},r)):(0,o.jsx)(tp,(0,el._)({info:i,commit:t},r));var a=eR(t);return a?n?(0,o.jsx)(tv,(0,el._)({info:a,commit:t,onViewCommitClick:n},r)):(0,o.jsx)(tm,(0,el._)({info:a,commit:t},r)):n?(0,o.jsx)(td,(0,el._)({commit:t,onViewCommitClick:n},r)):(0,o.jsx)(tc,(0,el._)({commit:t},r))}var t_=e.i(169252),tS=e.i(569384),tC=e.i(973245),tj=e.i(304277);function tT(){var e=(0,tS._)(["\n  query AccessibilityBannerGetRemoteAccessibility(\n    $provider: ProviderEnum!\n    $remoteUrl: String!\n  ) {\n    getRemoteAccessibility(provider: $provider, remoteUrl: $remoteUrl) {\n      __typename\n      ... on RemoteAccessibility {\n        accessibility\n        message\n      }\n    }\n  }\n"]);return tT=function(){return e},e}e.i(566901);var tE={},tR=(0,tC.gql)(tT()),tI=e.i(91720),tA=e.i(396776),tP=e.i(264661),tD=e.i(385485),tO=function(e){var t,n,r,i,a,s,l,u=e.remoteUrl,c=(t={variables:{provider:"github",remoteUrl:u}},n=(0,el._)({},tE,t),tj.useQuery(tR,n)).data,d=null==c||null==(r=c.getRemoteAccessibility)?void 0:r.accessibility;if(d&&d!==t_.AccessibilityEnum.Accessible)return d===t_.AccessibilityEnum.NeedsOauthAppApproval?(0,o.jsx)(tN,{message:null!=(s=null==c||null==(a=c.getRemoteAccessibility)?void 0:a.message)?s:""}):(0,o.jsx)(tM,{message:null!=(l=null==c||null==(i=c.getRemoteAccessibility)?void 0:i.message)?l:"",remoteUrl:null!=u?u:""})},tN=function(e){var t=e.message,n=(0,r._)((0,a.useState)(!1),2),i=n[0],s=n[1];return(0,o.jsx)(D.View,{pt:8,px:8,children:(0,o.jsx)(tA.StatusBanner,{colorway:"warning",text:(0,o.jsxs)(D.View,{gap:8,children:[(0,o.jsx)(A.Text,{multiline:!0,variant:"small",children:"Your organization has restricted Oauth app access. Request approval from your organization admins to access this repository."}),(0,o.jsxs)(D.View,{row:!0,align:"center",justify:"start",gap:8,children:[(0,o.jsx)(tI.ButtonLink,{size:"small",colorway:"warning",target:"_blank",rel:"noopener noreferrer",text:"Request approval",iconRight:(0,o.jsx)(tP.default,{}),href:"https://docs.github.com/en/account-and-profile/how-tos/organization-membership/requesting-organization-approval-for-oauth-apps"}),(0,o.jsx)(E.Button,{variant:"underlined",text:(0,o.jsx)(A.Text,{variant:"small",color:"dimmer",children:i?"Hide details":"View details"}),iconRight:i?(0,o.jsx)(N.default,{}):(0,o.jsx)(O.default,{}),onClick:function(){return s(!i)}})]}),i?(0,o.jsx)(I.Surface,{clsx:tD.default.messageSurface,children:(0,o.jsx)(A.Text,{variant:"small",color:"dimmer",children:t})}):null]})})})},tM=function(e){var t=e.message,n=e.remoteUrl,i=(0,r._)((0,a.useState)(!1),2),s=i[0],l=i[1];return(0,o.jsx)(D.View,{pt:8,px:8,children:(0,o.jsx)(tA.StatusBanner,{colorway:"warning",text:(0,o.jsxs)(D.View,{gap:8,children:[(0,o.jsxs)(D.View,{row:!0,align:"center",justify:"start",gap:8,children:[(0,o.jsxs)(A.Text,{multiline:!0,variant:"small",children:["The remote repository is not accessible. Please confirm that you have access to this repository"," ",n?": ".concat(n):"","."]}),(0,o.jsx)(E.Button,{variant:"underlined",text:(0,o.jsx)(A.Text,{variant:"small",color:"dimmer",children:s?"Hide details":"View details"}),iconRight:s?(0,o.jsx)(N.default,{}):(0,o.jsx)(O.default,{}),onClick:function(){return l(!s)}})]}),s?(0,o.jsx)(I.Surface,{clsx:tD.default.messageSurface,children:(0,o.jsx)(A.Text,{variant:"small",color:"dimmer",children:t})}):null]})})})},tL=e.i(993796),tB=e.i(242816),tV=e.i(526962),tF=e.i(357399),tU=e.i(42458),tG=(0,j.cssRecord)({warning:[T.rcss.align.start],header:[T.rcss.fontWeight.bold]});function t$(){var e=(0,h.useGitPaneModeSwitcher)(),t=(0,tL.useFlag)({controlName:"flag-github-connection-migration",default:!1}),n=(0,tB.default)();return(0,o.jsx)(o.Fragment,{children:n?(0,o.jsx)(o.Fragment,{children:(0,o.jsx)(l.DeprecationBanner,{onViewSettingsClick:function(){return e({type:tV.GitPaneModeType.SETTINGS})}})}):(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(tA.StatusBanner,{css:tG.warning,icon:(0,o.jsx)(tU.default,{}),colorway:"warning",text:(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("span",{css:tG.header,children:t?"Can't push or pull from git provider":"Can't push or pull from GitHub"}),(0,o.jsx)("br",{}),(0,o.jsx)("span",{children:t?"This app has a remote repository configured but you are not connected to any git providers.":"This app has a GitHub repository as a remote but you are not connected to GitHub."})]})}),(0,o.jsx)(E.Button,{colorway:"primary",iconLeft:(0,o.jsx)(tF.default,{}),text:"Edit Settings",onClick:function(){e({type:tV.GitPaneModeType.SETTINGS})}})]})})}var tz=e.i(682070),tH=(0,j.cssRecord)({text:[T.rcss.flex.shrink(1)]});function tW(e){var t=e.date,n=(0,r._)((0,a.useState)(null),2),i=n[0],s=n[1];return((0,a.useEffect)(function(){if(t){var e=function(){var e=new Date,n="just now";e.getTime()-t.getTime()>6e4&&(n=(0,tz.default)(t,e,{addSuffix:!0})),s(n=n.replace(/minutes?/,"min"))};e();var n=setInterval(e,6e4);return function(){clearInterval(n),s(null)}}},[t]),i)?(0,o.jsxs)(A.Text,{css:tH.text,color:"dimmest",variant:"small",multiline:!1,children:["last fetched ",i]}):null}function tq(e){var t=e.hasRemoteMergeConflict,n=e.hasUnpulledCommits,r=e.hasUnpushedCommits,i=e.workTreeDirty,a=[];return i&&n&&a.push("Can't pull: you have uncommitted changes"),t&&(n||r)&&(n&&r?(i||a.push("Warning: pulling will start a merge with conflicts"),a.push("Can't push: unpulled changes must be merged first")):n?i||a.push("Warning: pulling will start a merge with conflicts"):r&&a.push("Can't push: merge conflict with remote")),a.length?(0,o.jsx)(o.Fragment,{children:a.map(function(e){return(0,o.jsx)(tA.StatusBanner,{text:e,colorway:"warning",icon:(0,o.jsx)(tU.default,{})},e)})}):null}var tK=(0,j.cssRecord)({divider:[T.rcss.mx(8)]});function tY(e){var t=e.ahead,n=e.behind;if(!t&&!n)return(0,o.jsx)(A.Text,{color:"dimmest",multiline:!1,children:"Nothing to pull or push"});var r=null,i=null;if(n){var a=(0,f.default)("commit",n);r="".concat(n," ").concat(a," to pull")}if(t){var s=(0,f.default)("commit",t);i="".concat(t," ").concat(s," to push")}return(0,o.jsxs)(A.Text,{color:"dimmer",variant:"small",multiline:!1,children:[r?(0,o.jsx)("span",{children:r}):null,r&&i?(0,o.jsx)("span",{css:tK.divider,children:""}):null,i?(0,o.jsx)("span",{children:i}):null]})}var tQ=e.i(906368),tX=e.i(825118),tJ=e.i(861392),tZ=e.i(791675),t0=e.i(960933);t0.Type.Object({name:t0.Type.String(),push:t0.Type.String(),fetch:t0.Type.String()});var t1=((t={}).FF_ONLY="FF_ONLY",t.MERGE="MERGE",t.REBASE="REBASE",t);t0.Type.Enum(t1),e.s(["GitPullMode",()=>t1],467612);var t2=e.i(10581),t3=e.i(597865),t4=e.i(856392);function t8(e){return(0,c._)(function(){var t,n;return(0,d._)(this,function(r){switch(r.label){case 0:return t=null,[4,Promise.race([e,new Promise(function(e){return t=setTimeout(function(){tQ.withScope(function(e){e.setTag("gitPane",!0),tQ.captureException(Error("Remote update operation timed out"))}),e({error:tX.GitErrors.TIMEOUT})},9e4)})])];case 1:return n=r.sent(),t&&clearTimeout(t),[2,n]}})})()}var t5=(0,j.cssRecord)({container:[T.rcss.flex.grow(1)],branch:[T.rcss.mr(4),T.rcss.color.foregroundDefault,T.rcss.fontWeight.medium,{"&:hover":{textDecoration:"underline"}}],divider:[T.rcss.color.foregroundDimmest],text:[T.rcss.ml(4),T.rcss.color.foregroundDimmest]});function t6(e){var t=e.upstream,n=e.remotes,r=(0,a.useMemo)(function(){return(0,t4.navigationURLForRemoteBranch)(n,t)},[t,n]);return(0,o.jsxs)(A.Text,{css:t5.container,variant:"small",multiline:!1,children:[r?(0,o.jsx)("a",{css:t5.branch,href:r,target:"_blank",children:t}):(0,o.jsx)("span",{css:t5.branch,children:t}),(0,o.jsx)("span",{css:t5.divider,children:""}),(0,o.jsx)("span",{css:t5.text,children:"upstream"})]})}var t9=e.i(6338),t7=e.i(757390),ne=e.i(121817),nt=e.i(759097),nn=(0,j.cssRecord)({container:[T.rcss.borderRadius(8)],loading:[T.rcss.height(64),t9.loadingStyle.backgroundPulse(),T.rcss.borderRadius(8)],header:[T.rcss.py(4),T.rcss.px(8),T.rcss.rowWithGap(8),T.rcss.align.center,T.rcss.flex.shrink(1),T.rcss.border({color:C.tokens.outlineDimmer,direction:"bottom"})],fetch:{border:"none"},body:[T.rcss.px(8),T.rcss.pt(8),T.rcss.pb(12),T.rcss.colWithGap(8)],sync:[T.rcss.flex.grow(1)],pull:[T.rcss.pr(12),T.rcss.borderRadius(8,0,0,8),T.rcss.border({color:C.tokens.outlineDefault,direction:"right"})],push:[T.rcss.borderRadius(0,8,8,0)]});function nr(e){var t=e.remotes,n=e.gotoPendingState,i=(0,h.useNotifyGitError)(),s=function(e){var t=e.onError,n=e.onPullConflicts,i=(0,r._)((0,a.useState)(!1),2),o=i[0],s=i[1],l=(0,r._)((0,a.useState)(!1),2),u=l[0],f=l[1],h=(0,r._)((0,a.useState)(!1),2),g=h[0],x=h[1],y=(0,r._)((0,a.useState)(!1),2),b=y[0],w=y[1],k=(0,p.default)().git,_=(0,t3.default)(function(e){return(0,c._)(function(){var t,n,r,i,o,a,s,l,u,f,p,h,g,m,x,y,b,w,k,_,S,C;return(0,d._)(this,function(j){switch(j.label){case 0:return i={upstream:null,hasUnpulledCommits:!1,hasUnpushedCommits:!1,hasRemoteMergeConflict:!1,pullMode:t1.FF_ONLY,canPull:!1,canPush:!1,workTreeDirty:!1,needProviderConnection:!1,ahead:0,behind:0,lastFetched:null},[4,e.getRepositoryState()];case 1:if((o=j.sent()).error)return[2,o];if(a=o.state,o.type!==t2.GitRepositoryStateType.NORMAL)return[2,{error:tX.GitErrors.INVALID_STATE}];return(a===t2.GitRepositoryState.DIRTY_WORKTREE||a===t2.GitRepositoryState.DIRTY_INDEX)&&(i.workTreeDirty=!0),[4,e.status()];case 2:if((s=j.sent()).error)return[2,s];if(l=s.branch,u=null==(t=s.upstream)?void 0:t.branch,p=null!=(f=null==(n=s.upstream)?void 0:n.ahead)?f:0,g=null!=(h=null==(r=s.upstream)?void 0:r.behind)?h:0,!l)return[2,{error:tX.GitErrors.HEAD_DETACHED}];if(i.ahead=p,i.behind=g,!u)return[3,9];return i.upstream=u,i.hasUnpulledCommits=g>0,i.hasUnpushedCommits=p>0,[4,e.lastFetched()];case 3:if((x=j.sent()).error)return[2,x];return i.lastFetched=x.lastFetched,[4,e.canMergeBranches(l,u)];case 4:var T;if((y=j.sent()).error)return[2,y];return y.canMerge||(i.hasRemoteMergeConflict=!0),[4,(T=u,(0,c._)(function(){var t,n,r;return(0,d._)(this,function(i){switch(i.label){case 0:if(!(t=(0,tJ.getBranchRemote)(T)))return[2,{error:tX.GitErrors.INVALID_REFERENCE}];return[4,e.getRemotes()];case 1:if((n=i.sent()).error)return[2,n];if(!(r=n.remotes.get(t)))return[2,{error:tX.GitErrors.INVALID_REFERENCE}];return[2,{remote:r,error:null}]}})})())];case 5:if((b=j.sent()).error)return[2,b];if(w=b.remote,S=null!=(_=null==(k=(0,tL.getUserFlags)())||null==(m=k.flags["flag-github-connection-migration"])?void 0:m.value)&&_,C=!1,!S)return[3,7];return[4,e.getProfiles()];case 6:return C=!j.sent().some(function(e){return e.isSourceOpenInt}),[3,8];case 7:C=!e.hasProfile(tZ.GitProfileProvider.GITHUB)&&(0,t4.remoteURLIsGitHub)(w),j.label=8;case 8:C&&(i.needProviderConnection=!0),i.workTreeDirty||i.needProviderConnection||(i.canPull=!0),!i.hasUnpushedCommits||i.hasUnpulledCommits||i.needProviderConnection||(i.canPush=!0),p>0&&(i.pullMode=i.hasRemoteMergeConflict?t1.MERGE:t1.REBASE),j.label=9;case 9:return[2,(0,eu._)((0,el._)({},i),{error:null})]}})})()});if(!_)return{type:"loading"};if(_.error||!_.upstream)return{type:"error",error:_.error};if(!_.upstream)return{type:"noUpstream"};var S=_.upstream,C=_.hasUnpulledCommits,j=_.hasUnpushedCommits,T=_.hasRemoteMergeConflict,E=_.pullMode,R=_.canPull,I=_.canPush,A=_.workTreeDirty,P=_.needProviderConnection,D=_.ahead,O=_.behind,N=_.lastFetched;if(P)return{type:"needProviderConnection",upstream:S};var M=o||u||g||b,L=!S||P||M,B=!R||M,V=!I||M,F=!R&&!I||T||M;return{type:"remote",fetch:function(){return(0,c._)(function(){var e;return(0,d._)(this,function(n){switch(n.label){case 0:if(L)return[2];return s(!0),[4,t8(k.fetch())];case 1:return e=n.sent(),k.forceRefresh(),s(!1),e.error?t(e.error):(0,m.trackGitPaneEvent)("remote-fetched"),[2]}})})()},fetching:o,fetchDisabled:L,lastFetched:N,pull:function(){return(0,c._)(function(){var e;return(0,d._)(this,function(r){switch(r.label){case 0:if(B)return[2];return f(!0),[4,t8(k.pull({mode:E,allowConflicts:!0}))];case 1:return e=r.sent(),f(!1),e.error?t(e.error):(e.hasConflicts&&n(),k.forceRefresh(),(0,m.trackGitPaneEvent)("upstream-pulled")),[2]}})})()},pulling:u,pullDisabled:B,pullMode:E,canPull:R,push:function(){return(0,c._)(function(){var e;return(0,d._)(this,function(n){switch(n.label){case 0:if(V)return[2];return x(!0),[4,t8(k.push())];case 1:return e=n.sent(),k.forceRefresh(),x(!1),e.error?t(e.error):(0,m.trackGitPaneEvent)("upstream-pushed"),[2]}})})()},pushing:g,pushDisabled:V,canPush:I,sync:function(){return(0,c._)(function(){var e,n;return(0,d._)(this,function(r){switch(r.label){case 0:if(F)return[2];if(w(!0),!R)return[3,2];return[4,t8(k.pull({mode:E}))];case 1:if((e=r.sent()).error)return t(e.error),w(!1),[2];(0,m.trackGitPaneEvent)("upstream-pulled"),r.label=2;case 2:if(!I)return[3,4];return[4,k.push()];case 3:if((n=r.sent()).error)return t(n.error),w(!1),[2];(0,m.trackGitPaneEvent)("upstream-pushed"),r.label=4;case 4:return k.forceRefresh(),w(!1),[2]}})})()},syncing:b,syncDisabled:F,upstream:S,hasUnpulledCommits:C,hasUnpushedCommits:j,hasRemoteMergeConflict:T,workTreeDirty:A,ahead:D,behind:O}}({onError:i,onPullConflicts:n}),l="error"===s.type?s.error:null;return((0,a.useEffect)(function(){l&&i(l)},[l,i]),"loading"===s.type)?(0,o.jsx)(I.Surface,{css:nn.loading,elevated:!0}):"error"===s.type||"noUpstream"===s.type?null:"needProviderConnection"===s.type?(0,o.jsxs)(I.Surface,{css:nn.container,elevated:!0,children:[(0,o.jsxs)(D.View,{css:nn.header,children:[(0,o.jsx)(t6,{upstream:s.upstream,remotes:t}),(0,o.jsx)(E.Button,{css:nn.fetch,text:"Fetch",iconLeft:(0,o.jsx)(ne.default,{}),disabled:!0,variant:"outlined",size:"small"})]}),(0,o.jsx)(D.View,{css:nn.body,children:(0,o.jsx)(t$,{})})]}):(0,o.jsxs)(I.Surface,{css:nn.container,elevated:!0,children:[(0,o.jsxs)(D.View,{css:nn.header,children:[(0,o.jsx)(t6,{upstream:s.upstream,remotes:t}),(0,o.jsx)(tW,{date:s.lastFetched}),(0,o.jsx)(E.Button,{css:nn.fetch,text:"Fetch",iconLeft:s.fetching?(0,o.jsx)(K.default,{}):(0,o.jsx)(ne.default,{}),onClick:s.fetch,loading:s.fetching,disabled:s.fetchDisabled,variant:"outlined",size:"small"})]}),(0,o.jsxs)(D.View,{css:nn.body,children:[(0,o.jsx)(tq,{hasRemoteMergeConflict:s.hasRemoteMergeConflict,hasUnpulledCommits:s.hasUnpulledCommits,hasUnpushedCommits:s.hasUnpushedCommits,workTreeDirty:s.workTreeDirty}),(0,o.jsx)(tY,{ahead:s.ahead,behind:s.behind}),(0,o.jsxs)(D.View,{grow:!0,row:!0,gap:8,children:[(0,o.jsx)("div",{css:nn.sync,children:(0,o.jsx)(P.Tooltip,{tooltip:"Pull & push the latest changes",children:(0,o.jsx)(E.Button,{css:nn.sync,text:"Sync with Remote",iconLeft:s.syncing?(0,o.jsx)(K.default,{}):(0,o.jsx)(tf.default,{rotate:90}),onClick:s.sync,loading:s.syncing,disabled:s.syncDisabled,size:"small"})})}),(0,o.jsxs)(D.View,{row:!0,children:[(0,o.jsx)(E.Button,{css:nn.pull,text:"Pull",iconLeft:s.pulling?(0,o.jsx)(K.default,{}):(0,o.jsx)(t7.default,{}),onClick:s.pull,loading:s.pulling,disabled:s.pullDisabled,size:"small"}),(0,o.jsx)(E.Button,{css:nn.push,text:"Push",iconLeft:s.pushing?(0,o.jsx)(K.default,{}):(0,o.jsx)(nt.default,{}),onClick:s.push,loading:s.pushing,disabled:s.pushDisabled,size:"small"})]})]})]})]})}var ni=e.i(243914),no=e.i(523579),na=e.i(434286),ns=e.i(721385),nl=(0,j.cssRecord)({remoteUrl:[{border:"none"},T.rcss.height("auto"),T.rcss.py(4),T.rcss.px(8)]}),nu=function(e){switch(e){case"github":return(0,o.jsx)(no.default,{});case"gitlab":return(0,o.jsx)(ns.default,{});case"bitbucket":return(0,o.jsx)(na.default,{})}};function nc(e){var t=e.branch,n=e.remotes,i=(0,r._)((0,a.useMemo)(function(){if(t.type===s.GitBranchType.LOCAL)return[null,null,null];var e=n.get(t.remote);if(!e)return[null,null,null];var r=(0,t4.navigationURLForRemote)(e),i=(0,t4.simpleNameForRemote)(e),o=null;return(0,t4.remoteURLIsGitHub)(r)?o="github":(0,t4.remoteURLIsGitLab)(r)?o="gitlab":(0,t4.remoteURLIsBitbucket)(r)&&(o="bitbucket"),[r,i,o]},[t,n]),3),l=i[0],u=i[1],c=i[2];return l&&u&&c?(0,o.jsx)(tI.ButtonLink,{css:nl.remoteUrl,text:u,href:l,target:"_blank",iconLeft:nu(c),iconRight:(0,o.jsx)(ni.default,{}),variant:"outlined",size:"small"}):null}var nd=e.i(967629),nf=(0,nd.keyframes)({from:{opacity:0},to:{opacity:1}}),np=(0,j.cssRecord)({loadingView:[{animation:"".concat(nf," 0.125s 0.25s linear backwards")},T.rcss.flex.grow(1),T.rcss.display.flex,T.rcss.center]});function nh(){return(0,o.jsx)(D.View,{css:np.loadingView,children:(0,o.jsx)(K.default,{size:48})})}function ng(){var e=(0,tS._)(["\n  query CreateRemoteFormRepl($replId: String!) {\n    getRepl(id: $replId) {\n      ... on Repl {\n        id\n        description\n        isPrivate\n        slug\n        url\n      }\n    }\n  }\n"]);return ng=function(){return e},e}function nm(){var e=(0,tS._)(["\n  query CreateRemoteFormUser($orgId: String!) {\n    currentUser {\n      ... on CurrentUser {\n        id\n        gitHubInfo {\n          installations {\n            id\n            type\n            name\n            avatarUrl\n            accountId\n            repositorySelection\n          }\n          accessToken\n        }\n        gitHubInfoV2 {\n          organizations {\n            id\n            type\n            avatarUrl\n            name\n          }\n        }\n        bitbucketInfo {\n          workspacesToProjects {\n            uuid\n            name\n            slug\n            projects {\n              uuid\n              name\n            }\n          }\n        }\n        gitLabInfo {\n          groups {\n            namespaceId\n            name\n            visibility\n            description\n            avatarUrl\n            webUrl\n            fullName\n            fullPath\n          }\n        }\n        org(orgId: $orgId) {\n          ... on Org {\n            id\n            settings {\n              ... on OrgSettings {\n                requirePrivateRemote\n                adminOnlyPrivateRemoteBypass\n              }\n            }\n          }\n        }\n      }\n    }\n  }\n"]);return nm=function(){return e},e}e.s(["default",()=>nh],166963);var nv={},nx=(0,tC.gql)(ng()),ny=(0,tC.gql)(nm()),nb=e.i(569910),nw=e.i(968783),nk=e.i(222342),n_=e.i(207237),nS=e.i(412160),nC=e.i(625251),nj=e.i(601059);function nT(e){var t=e.value,n=e.onChange,i=e.workspacesToProjects,a=e.loading,s=e.disabled,l=i.some(function(e){return(null==e?void 0:e.projects)&&e.projects.length>0});return(0,o.jsxs)(D.View,{gap:2,children:[l||a?null:(0,o.jsx)(tA.StatusBanner,{colorway:"warning",text:(0,o.jsxs)(A.Text,{children:["No available projects. Connect your Bitbucket account to continue."," ",(0,o.jsx)(nS.default,{href:"/integrations",children:"Manage Connection"})]})}),(0,o.jsx)(nj.PopupMenu,{isDisabled:!l||s,label:"Select a project",trigger:a?(0,o.jsx)(E.Button,{text:(0,o.jsx)(K.default,{}),disabled:!0}):(0,o.jsx)(E.Button,{iconRight:(0,o.jsx)(O.default,{}),text:t?"".concat(t.projectName," (").concat(t.workspaceName,")"):"Select a Bitbucket project",disabled:!l||s}),onAction:function(e){var t,o,a,s,l,u=(0,r._)(e.toString().split("::"),2),c=u[0],d=u[1],f=i.find(function(e){return(null==e?void 0:e.slug)===c}),p=null==f||null==(t=f.projects)?void 0:t.find(function(e){return(null==e?void 0:e.uuid)===d});p&&f&&n({projectUuid:null!=(o=p.uuid)?o:"",projectName:null!=(a=p.name)?a:"",workspaceName:null!=(s=f.name)?s:"",workspaceSlug:null!=(l=f.slug)?l:""})},children:i.map(function(e){var t,n;return e?(0,o.jsxs)(nC.MenuSection,{children:[(0,o.jsx)(nj.MenuHeader,{text:null!=(n=e.name)?n:"Unnamed Workspace"}),null==(t=e.projects)?void 0:t.map(function(t){var n;return t?(0,o.jsx)(nj.MenuItem,{id:"".concat(e.slug,"::").concat(t.uuid),label:null!=(n=t.name)?n:"Unnamed Project"},"".concat(e.slug,"::").concat(t.uuid)):null}),(0,o.jsx)(nj.Separator,{})]},e.uuid):null})})]})}var nE=e.i(714165),nR=e.i(721321),nI=e.i(552144),nA=e.i(561954),nP=e.i(778119);function nD(e){var t=e.hasGitHubMigrationEnabled,n=e.value,r=e.onChange,i=e.installations,a=e.organizations,s=e.loading,l=e.disabled,u=null==i?void 0:i.filter(function(e){return"Organization"===e.type}),c=t?a:u,d=c&&c.length>0,f="organization"===n.type?n.organizationName:void 0;return(0,o.jsxs)(D.View,{gap:8,children:[(0,o.jsxs)(nR.ButtonGroup,{stretch:!0,row:!0,name:"repository-location",value:n.type,onChange:function(e){if("organization"===e){if(!d)return void r({type:"organization",organizationName:void 0});r({type:"organization",organizationName:c[0].name})}else r({type:"personal"})},disabled:s||l,children:[(0,o.jsx)(nR.ButtonGroupItem,{id:"personal",value:"personal",text:"Personal",icon:(0,o.jsx)(nP.default,{})}),(0,o.jsx)(nR.ButtonGroupItem,{id:"organization",value:"organization",text:"Organization",icon:s?(0,o.jsx)(K.default,{}):(0,o.jsx)(nA.default,{})})]}),"organization"===n.type&&(0,o.jsxs)(D.View,{children:[d||s?null:(0,o.jsx)(tA.StatusBanner,{colorway:"warning",text:(0,o.jsxs)(A.Text,{children:["No available organizations. Install the Replit Github app on your organization to continue."," ",(0,o.jsx)(nS.default,{href:"/account#connected-services",children:"Manage Connection"})]})}),(0,o.jsx)(nj.PopupMenu,{isDisabled:!d||l,label:"Select an organization",trigger:s?(0,o.jsx)(E.Button,{text:(0,o.jsx)(K.default,{}),disabled:!0}):(0,o.jsx)(E.Button,{iconRight:(0,o.jsx)(O.default,{}),text:null!=f?f:"Select a target GitHub organization",disabled:!d||l}),onAction:function(e){r({type:"organization",organizationName:e.toString()})},items:null==c?void 0:c.map(function(e){return{id:e.id,name:e.name,avatarUrl:e.avatarUrl}}),children:function(e){var t;return(0,o.jsx)(nj.MenuItem,{id:e.name,label:e.name,icon:(0,o.jsx)(nE.Avatar,{src:null!=(t=e.avatarUrl)?t:null,username:e.name,size:16})},e.name)}}),t?(0,o.jsx)(D.View,{pt:4,children:(0,o.jsx)(nI.StatusBannerButton,{text:" Not seeing your organization? You may need to request approval",iconLeft:(0,o.jsx)(tP.default,{}),href:"https://docs.github.com/en/account-and-profile/how-tos/organization-membership/requesting-organization-approval-for-oauth-apps"})}):null]})]})}function nO(e){var t=e.value,n=e.onChange,r=e.groups,i=e.loading,a=e.disabled,s=r.length>0,l="group"===t.type?t.groupName:void 0;return(0,o.jsxs)(D.View,{gap:8,children:[(0,o.jsxs)(nR.ButtonGroup,{stretch:!0,row:!0,name:"repository-location",value:t.type,onChange:function(e){if("group"===e){var t;if(!s)return void n({type:"group",groupId:void 0,groupName:void 0});n({type:"group",groupId:r[0].namespaceId,groupName:null!=(t=r[0].fullName)?t:r[0].name})}else n({type:"personal"})},disabled:i||a,children:[(0,o.jsx)(nR.ButtonGroupItem,{id:"personal",value:"personal",text:"Personal",icon:(0,o.jsx)(nP.default,{})}),(0,o.jsx)(nR.ButtonGroupItem,{id:"group",value:"group",text:"Group",icon:i?(0,o.jsx)(K.default,{}):(0,o.jsx)(nA.default,{})})]}),"group"===t.type&&(0,o.jsxs)(D.View,{children:[s||i?null:(0,o.jsx)(tA.StatusBanner,{colorway:"warning",text:(0,o.jsxs)(A.Text,{children:["No available groups. Connect your GitLab account to continue."," ",(0,o.jsx)(nS.default,{href:"/integrations",children:"Manage Connection"})]})}),(0,o.jsx)(nj.PopupMenu,{isDisabled:!s||a,label:"Select a group",trigger:i?(0,o.jsx)(E.Button,{text:(0,o.jsx)(K.default,{}),disabled:!0}):(0,o.jsx)(E.Button,{iconRight:(0,o.jsx)(O.default,{}),text:null!=l?l:"Select a GitLab group",disabled:!s||a}),onAction:function(e){var t,i=r.find(function(t){return t.namespaceId===Number(e)});i&&n({type:"group",groupId:i.namespaceId,groupName:null!=(t=i.fullName)?t:i.name})},children:r.map(function(e){var t;return(0,o.jsx)(nj.MenuItem,{id:e.namespaceId.toString(),label:null!=(t=e.fullName)?t:e.name},e.namespaceId)})})]})]})}var nN=e.i(951262);function nM(){var e=(0,tS._)(["\n  mutation CreateBitbucketRepo($input: CreateBitbucketRepoInput!) {\n    createBitbucketRepo(input: $input) {\n      ... on CreateBitbucketRepoResult {\n        remoteUrl\n      }\n      ... on UnauthorizedError {\n        message\n      }\n      ... on UserError {\n        message\n      }\n    }\n  }\n"]);return nM=function(){return e},e}var nL={},nB=(0,tC.gql)(nM());function nV(){var e=(0,tS._)(["\n  mutation CreateGitHubRepo($input: CreateGithubRepoInput!) {\n    createGithubRepo(input: $input) {\n      ... on CreateGithubRepoResult {\n        remoteUrl\n      }\n      ... on UnauthorizedError {\n        message\n      }\n      ... on UserError {\n        message\n      }\n    }\n  }\n"]);return nV=function(){return e},e}var nF={},nU=(0,tC.gql)(nV());function nG(){var e=(0,tS._)(["\n  mutation CreateGitLabRepo($input: CreateGitlabProjectInput!) {\n    createGitlabProject(input: $input) {\n      ... on CreateGitlabProjectResult {\n        remoteUrl\n      }\n      ... on UnauthorizedError {\n        message\n      }\n      ... on UserError {\n        message\n      }\n    }\n  }\n"]);return nG=function(){return e},e}var n$={},nz=(0,tC.gql)(nG()),nH=e.i(428596),nW=e.i(352758),nq=e.i(987154),nK=e.i(530310),nY=e.i(467880);function nQ(e){var t,n,i,s,l,u,f,h,g,x,y,b,w,k,_,S,C,j,T,I,O,N,M,L,B,V,F,U,G,$,z,H,W,q,K,Y=e.remoteName,Q=e.onCreateSuccess,X=e.updateRemote,J=(0,nk.default)().showConfirm,Z=(0,p.default)().git,ee=(0,r._)((0,a.useState)("github"),2),et=ee[0],en=ee[1],er=(0,nH.useIdSeed)(),ei=(0,n_.default)(),eo=(0,a.useRef)(null),ea=(0,a.useRef)(null),es=(0,nw.useCurrentUserStoredOrgContext)(),eu=es.orgRole,ec=es.orgId,ed=(t={variables:{replId:ei}},n=(0,el._)({},nv,t),tj.useQuery(nx,n)).data,ef=(i={variables:{orgId:null!=ec?ec:""}},s=(0,el._)({},nv,i),tj.useQuery(ny,s)),ep=ef.data,eh=ef.loading,eg=null!=(H=null==ep||null==(_=ep.currentUser)||null==(k=_.gitHubInfo)?void 0:k.installations)?H:[],em=(0,tL.useFlag)({controlName:"flag-github-connection-migration",default:!1}),ev=(0,tL.useFlag)({controlName:"flag-source-control-integrations",default:!1}),ex=null!=(W=null==ep||null==(C=ep.currentUser)||null==(S=C.gitHubInfoV2)?void 0:S.organizations)?W:[],ey=null!=(q=null==ep||null==(T=ep.currentUser)||null==(j=T.bitbucketInfo)?void 0:j.workspacesToProjects)?q:[],eb=null!=(K=null==ep||null==(O=ep.currentUser)||null==(I=O.gitLabInfo)?void 0:I.groups)?K:[],ew=(null==ep||null==(M=ep.currentUser)||null==(N=M.org)?void 0:N.__typename)==="Org"&&(null==ep||null==(V=ep.currentUser)||null==(B=V.org)||null==(L=B.settings)?void 0:L.__typename)==="OrgSettings"&&ep.currentUser.org.settings.requirePrivateRemote,ek=(null==ep||null==(U=ep.currentUser)||null==(F=U.org)?void 0:F.__typename)==="Org"&&(null==ep||null==(z=ep.currentUser)||null==($=z.org)||null==(G=$.settings)?void 0:G.__typename)==="OrgSettings"&&ep.currentUser.org.settings.adminOnlyPrivateRemoteBypass,e_=ew||ek&&eu!==t_.SystemOrgGroupType.SystemAdmins,eS=(null==ed?void 0:ed.getRepl.__typename)==="Repl"?ed.getRepl:{slug:void 0,description:void 0,isPrivate:void 0,url:void 0},eC=eS.slug,ej=eS.description,eT=eS.isPrivate,eE=eS.url,eR=(f=(u=(0,r._)((l=(0,el._)({},nF,void 0),nN.useMutation(nU,l)),2))[0],{create:function(e){return(0,c._)(function(){var t,n,r,i;return(0,d._)(this,function(o){switch(o.label){case 0:return[4,f({variables:{input:{name:e.name,description:e.description,homepage:e.homepage,isPrivate:e.isPrivate,githubOrgId:"organization"===e.location.type?e.location.organizationName:void 0,ownerType:"organization"===e.location.type?t_.GithubRepoOwnerType.Organization:t_.GithubRepoOwnerType.User}}})];case 1:if((null==(t=(i=o.sent()).data)?void 0:t.createGithubRepo.__typename)==="UnauthorizedError"||(null==(n=i.data)?void 0:n.createGithubRepo.__typename)==="UserError")return[2,{error:i.data.createGithubRepo.message}];if((null==(r=i.data)?void 0:r.createGithubRepo.__typename)==="CreateGithubRepoResult")return[2,{remoteUrl:i.data.createGithubRepo.remoteUrl}];return[2,{error:"Unknown error occurred"}]}})})()},loading:u[1].loading}),eI=eR.create,eA=eR.loading,eP=(x=(g=(0,r._)((h=(0,el._)({},nL,void 0),nN.useMutation(nB,h)),2))[0],{create:function(e){return(0,c._)(function(){var t,n,r,i;return(0,d._)(this,function(o){switch(o.label){case 0:return[4,x({variables:{input:{workspace:e.project.workspaceSlug,name:e.name,description:e.description,isPrivate:e.isPrivate}}})];case 1:if((null==(t=(i=o.sent()).data)?void 0:t.createBitbucketRepo.__typename)==="UnauthorizedError"||(null==(n=i.data)?void 0:n.createBitbucketRepo.__typename)==="UserError")return[2,{error:i.data.createBitbucketRepo.message}];if((null==(r=i.data)?void 0:r.createBitbucketRepo.__typename)==="CreateBitbucketRepoResult")return[2,{remoteUrl:i.data.createBitbucketRepo.remoteUrl}];return[2,{error:"Unknown error occurred"}]}})})()},loading:g[1].loading}),eD=eP.create,eO=eP.loading,eN=(w=(b=(0,r._)((y=(0,el._)({},n$,void 0),nN.useMutation(nz,y)),2))[0],{create:function(e){return(0,c._)(function(){var t,n,r,i;return(0,d._)(this,function(o){switch(o.label){case 0:return[4,w({variables:{input:{name:e.name,description:e.description,isPrivate:e.isPrivate,namespaceId:"group"===e.location.type?e.location.groupId:void 0,ownerType:"group"===e.location.type?t_.GitlabProjectOwnerType.Group:t_.GitlabProjectOwnerType.User}}})];case 1:if((null==(t=(i=o.sent()).data)?void 0:t.createGitlabProject.__typename)==="UnauthorizedError"||(null==(n=i.data)?void 0:n.createGitlabProject.__typename)==="UserError")return[2,{error:i.data.createGitlabProject.message}];if((null==(r=i.data)?void 0:r.createGitlabProject.__typename)==="CreateGitlabProjectResult")return[2,{remoteUrl:i.data.createGitlabProject.remoteUrl}];return[2,{error:"Unknown error occurred"}]}})})()},loading:b[1].loading}),eM=eN.create,eL=eN.loading,eB=eA||eO||eL,eV=(0,r._)((0,a.useState)(),2),eF=eV[0],eU=eV[1],eG=(0,r._)((0,a.useState)({type:"personal"}),2),e$=eG[0],ez=eG[1],eH=(0,r._)((0,a.useState)(void 0),2),eW=eH[0],eq=eH[1],eK=(0,r._)((0,a.useState)({type:"personal"}),2),eY=eK[0],eQ=eK[1],eX=(0,r._)((0,a.useState)(!!e_||null==eT||eT),2),eJ=eX[0],eZ=eX[1],e0=(0,r._)((0,a.useState)(null!=eC?eC:""),2),e1=e0[0],e2=e0[1],e3=(0,r._)((0,a.useState)(),2),e4=e3[0],e8=e3[1],e5=(0,r._)((0,a.useState)(null!=ej?ej:eE&&"Repository for https://replit.com".concat(eE)),2),e6=e5[0],e9=e5[1],e7=(0,r._)((0,a.useState)(),2),te=e7[0],tt=e7[1],tn=!e1||"bitbucket"===et&&!eW||"github"===et&&"organization"===e$.type&&!e$.organizationName||"gitlab"===et&&"group"===eY.type&&!eY.groupName,tr=function(){e8(void 0),tt(void 0),eU(void 0)},ti=function(e){return(0,c._)(function(){var t,n,r;return(0,d._)(this,function(i){switch(i.label){case 0:return[4,Z.getRemotes()];case 1:if((t=i.sent()).error)return eU("Error finding current remotes, ".concat(t.error)),[2];if(!t.remotes.has(Y))return[3,3];return[4,Z.setRemoteURL({remote:Y,url:e})];case 2:if((n=i.sent()).error)return eU("Error (".concat(n.error,") setting ").concat(Y," to use ").concat(e," as a remote.")),[2];return null==X||X(e),(0,m.trackGitPaneEvent)("remote-edited"),[2];case 3:return[4,Z.addRemote({name:Y,url:e})];case 4:if((r=i.sent()).error)return eU("Error (".concat(r.error,") adding ").concat(Y," ").concat(e," as a remote.")),[2];return null==X||X(e),(0,m.trackGitPaneEvent)("remote-added"),[2]}})})()},to={github:{name:"GitHub",icon:(0,o.jsx)(no.default,{})},bitbucket:{name:"Bitbucket",icon:(0,o.jsx)(na.default,{})},gitlab:{name:"GitLab",icon:(0,o.jsx)(ns.default,{})}}[et];return(0,o.jsxs)(D.View,{gap:4,children:[ev?(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(A.Text,{color:"dimmest",multiline:!1,children:"Git Provider"}),(0,o.jsxs)(nR.ButtonGroup,{stretch:!0,row:!0,name:"git-provider",value:et,onChange:function(e){return en(e)},children:[(0,o.jsx)(nR.ButtonGroupItem,{id:"github",value:"github",text:"GitHub",icon:(0,o.jsx)(no.default,{})}),(0,o.jsx)(nR.ButtonGroupItem,{id:"bitbucket",value:"bitbucket",text:"Bitbucket",icon:(0,o.jsx)(na.default,{})}),(0,o.jsx)(nR.ButtonGroupItem,{id:"gitlab",value:"gitlab",text:"GitLab",icon:(0,o.jsx)(ns.default,{})})]})]}):null,(0,o.jsx)(nW.default,{height:1}),(0,o.jsx)(A.Text,{color:"dimmest",multiline:!1,children:"Repository Location"}),function(e){switch(e){case"github":return(0,o.jsx)(nD,{value:e$,onChange:ez,installations:eg,organizations:em?ex:void 0,loading:eh,hasGitHubMigrationEnabled:em});case"bitbucket":return(0,o.jsx)(nT,{value:eW,onChange:eq,workspacesToProjects:ey.filter(function(e){return null!=e}),loading:eh});case"gitlab":return(0,o.jsx)(nO,{value:eY,onChange:eQ,groups:eb.filter(function(e){return null!=e}),loading:eh});default:(0,nb.default)(e)}}(et),(0,o.jsx)(A.Text,{color:"dimmest",multiline:!1,id:er("repo-name-label"),children:"Repository name"}),(0,o.jsx)(R.Input,{ref:eo,placeholder:"Enter repository name",value:e1,onChange:function(e){e8(void 0),e2(e.target.value)},onKeyDown:function(e){if("Enter"===e.key){var t;e.preventDefault(),null==(t=ea.current)||t.focus()}},"aria-labelledby":er("repo-name-label")}),(0,o.jsx)(A.Text,{clsx:nY.default.errorText,multiline:!1,children:e4}),(0,o.jsx)(nW.default,{height:1}),(0,o.jsx)(A.Text,{color:"dimmest",multiline:!1,id:er("repo-description-label"),children:"Repository description"}),(0,o.jsx)(R.MultiLineInput,{ref:ea,maxLength:350,name:"Repository description",placeholder:"Enter repository description",value:null!=e6?e6:void 0,onChange:function(e){tt(void 0),e9(e.target.value)},"aria-labelledby":er("repo-description-label")}),(0,o.jsx)(A.Text,{css:nY.default.errorText,multiline:!1,children:te}),(0,o.jsx)(nW.default,{height:1}),(0,o.jsx)(A.Text,{color:"dimmest",multiline:!1,children:"Privacy"}),(0,o.jsx)(P.Tooltip,{tooltip:ew?"Private repositories are required.":ek?"Only admins can create public repositories.":"Users can create both public and private repositories.",isDisabled:!e_,children:(0,o.jsxs)(nR.ButtonGroup,{tag:"fieldset",id:er("privacy"),name:er("privacy"),disabled:e_||eh,value:eJ,onChange:function(e){return eZ(e)},row:!0,clsx:nY.default.privateToggle,children:[(0,o.jsx)(nR.ButtonGroupItem,{id:er("true"),value:!0,text:"Private",icon:(0,o.jsx)(nK.default,{})}),(0,o.jsx)(nR.ButtonGroupItem,{id:er("false"),value:!1,text:"Public",icon:(0,o.jsx)(nq.default,{})})]})}),(0,o.jsx)(nW.default,{height:2}),(0,o.jsx)(D.View,{children:tn?(0,o.jsx)(tA.StatusBanner,{clsx:nY.default.statusText,text:(0,o.jsx)(A.Text,{color:"dimmest",variant:"small",children:e1?"bitbucket"!==et||eW?"github"!==et||"organization"!==e$.type||e$.organizationName?"gitlab"!==et||"group"!==eY.type||eY.groupName?"":"Target group is required":"Target organization is required":"Bitbucket project is required":"Repository name is required"})}):null}),(0,o.jsx)(E.Button,{text:eB?"Creating Repository on ".concat(to.name,""):"Create Repository on ".concat(to.name),colorway:"primary",iconLeft:to.icon,onClick:function(){return(0,c._)(function(){var e,t,n;return(0,d._)(this,function(r){switch(r.label){case 0:if(tr(),!e1)return[2];if(!(0,tJ.isValidRemoteName)(e1))return e8("Invalid remote name."),[2];if("bitbucket"!==et)return[3,4];if(!eW)return eU("Please select a Bitbucket project"),[2];return[4,eD({name:e1,description:null!=e6?e6:void 0,isPrivate:eJ,project:eW})];case 1:if((e=r.sent()).error)return eU(e.error),[2];if(!e.remoteUrl)return[3,3];return[4,ti(e.remoteUrl)];case 2:r.sent(),(0,m.trackGitPaneEvent)("bitbucket-repository-published"),J("Created repository on Bitbucket"),Q(),r.label=3;case 3:return[2];case 4:if("github"!==et)return[3,8];if("organization"===e$.type&&!e$.organizationName)return eU("Please select an organization"),[2];return[4,eI({name:e1,description:null!=e6?e6:null,homepage:eE?"https://replit.com".concat(eE):void 0,isPrivate:eJ,location:e$})];case 5:if((t=r.sent()).error)return eU(t.error),[2];if(!t.remoteUrl)return[3,7];return[4,ti(t.remoteUrl)];case 6:r.sent(),(0,m.trackGitPaneEvent)("github-repository-published"),J("Created repository on Github"),Q(),r.label=7;case 7:return[2];case 8:if("gitlab"!==et)return[3,11];if("group"===eY.type&&!eY.groupName)return eU("Please select a group"),[2];return[4,eM({name:e1,description:e6,isPrivate:eJ,location:eY})];case 9:if((n=r.sent()).error)return eU(n.error),[2];if(!n.remoteUrl)return[3,11];return[4,ti(n.remoteUrl)];case 10:r.sent(),(0,m.trackGitPaneEvent)("gitlab-repository-published"),J("Created repository on GitLab"),Q(),r.label=11;case 11:return[2]}})})()},loading:eB,disabled:tn}),eF?(0,o.jsx)(A.Text,{css:nY.default.errorText,maxLines:2,multiline:!1,children:eF}):null]})}e.s(["default",()=>nQ],636680);var nX=function(e){return"repl-".concat(e)};function nJ(e){return e.url.endsWith(".replit.dev:.")}var nZ=function(e){var t=e.replId,n=e.branch;return"repl-".concat(t,"/").concat(n)},n0=function(e){var t=e.git,n=e.replId;return(0,c._)(function(){var e,r,i,o,a,s;return(0,d._)(this,function(l){switch(l.label){case 0:return e=nX(n),r="".concat(n,"@ssh.v1.replit.dev:."),[4,t.getRemotes()];case 1:if((i=l.sent()).error)return[2,i];if(!i.remotes.has(e))return[3,4];if((null==(o=i.remotes.get(e))?void 0:o.fetch)===r)return[3,3];return[4,t.setRemoteURL({remote:e,url:r})];case 2:if((a=l.sent()).error)return[2,a];l.label=3;case 3:return[2,{error:null,remote:{name:e,url:r}}];case 4:return[4,t.addRemote({name:e,url:r,fetch:!0})];case 5:if((s=l.sent()).error&&s.error!==tX.GitErrors.REMOTE_ALREADY_EXISTS)return[2,s];return[2,{error:null,remote:{name:e,url:r}}]}})})()};function n1(e){var t=(0,t3.default)(function(t){return(0,c._)(function(){var n;return(0,d._)(this,function(r){switch(r.label){case 0:if(!e)return[2,{hasStarted:!1,error:null,remote:null}];return[4,n0({git:t,replId:e})];case 1:if((n=r.sent()).error)return[2,{hasStarted:!0,error:n.error}];return[2,{hasStarted:!0,error:null,remote:n.remote}]}})})()},[e]);return t&&t.hasStarted?t.error?{state:"Error",error:t.error}:{state:"Success",error:null,remote:t.remote}:{state:"Loading",error:null}}e.s(["isReplRemote",()=>nJ,"remoteBranchForRepl",()=>nZ,"remoteNameForRepl",()=>nX,"setupRemoteForReplId",()=>n0,"useSetupRemoteForReplId",()=>n1],875259);var n2=(0,j.cssRecord)({view:[],sectionContainer:[T.rcss.colWithGap(8)],section:[T.rcss.pt(8),T.rcss.pb(16),T.rcss.px(8),T.rcss.colWithGap(8),T.rcss.border({color:C.tokens.outlineDimmest,direction:"bottom"})],remoteUpdatesHeader:[],reviewChangesHeader:[],headerText:[T.rcss.fontWeight.medium],replMergingHeader:[T.rcss.rowWithGap(8),T.rcss.align.center],switchToBranch:[T.rcss.p(4),T.rcss.flex.row,T.rcss.align.center,T.rcss.justify.spaceBetween,T.rcss.mt(0),T.rcss.mb(0)]});function n3(e){var t,n,c,d,f,p=e.status,h=e.remotes,g=e.branch,m=e.onStagedFileClick,x=e.onViewCommitClick,y=e.gotoPendingState,b=e.current,w=void 0!==b&&b,k=e.performPaneOperation,_=w?null==p||null==(t=p.upstream)?void 0:t.behind:void 0,S=w?null==p||null==(n=p.upstream)?void 0:n.ahead:void 0,C=(0,u.default)(g,_,S),j=!!h&&h.size>0,T=n8(h),E=T?null==h||null==(c=h.get(T))?void 0:c.fetch:null,R=(null==g?void 0:g.type)===s.GitBranchType.LOCAL,I=(0,r._)((0,a.useState)(!1),2),P=I[0],O=I[1],N=(0,a.useMemo)(function(){if(!C||C.error)return[];var e=[],t=C.log,n=void 0===t?[]:t,r=C.onlyRemote,o=void 0===r?[]:r,a=C.onlyLocal,s=void 0===a?[]:a,l=n.length>0,u=o.length>0,c=s.length>0;return u&&(e.push({type:"boundary",text:"Not pulled from remote"}),e.push.apply(e,(0,i._)(n4(o,x)))),c&&(e.push({type:"boundary",text:"Not pushed to remote"}),e.push.apply(e,(0,i._)(n4(s,x)))),l&&((u||c)&&e.push({type:"boundary",text:"Up to date with remote"}),e.push.apply(e,(0,i._)(n4(n,x)))),e},[C,x]);return g?(0,o.jsxs)(D.View,{grow:!0,pt:4,pb:8,px:4,gap:8,children:[(0,o.jsxs)(D.View,{gap:8,children:[(0,o.jsx)(ed.Modal,{isOpen:P,onRequestClose:function(){return O(!1)},children:(0,o.jsx)(nQ,{remoteName:null!=(f=null==h||null==(d=h.values().next().value)?void 0:d.name)?f:"origin",onCreateSuccess:function(){return O(!1)}})}),E?(0,o.jsx)(tO,{remoteUrl:E}):null,R?(0,o.jsx)(D.View,{css:n2.section,children:(0,o.jsx)(l.PushBranchButton,{performPaneOperation:k,branch:g,onCreateRemoteClick:function(){return O(!0)}})}):null,w&&!R&&h&&j?(0,o.jsxs)(D.View,{css:n2.section,children:[(0,o.jsxs)(D.View,{row:!0,gap:8,align:"center",justify:"space-between",children:[(0,o.jsx)(A.Text,{css:n2.headerText,multiline:!1,children:"Remote Updates"}),(0,o.jsx)(nc,{branch:g,remotes:h})]}),(0,o.jsx)(nr,{remotes:h,gotoPendingState:y})]}):null,w&&p?(0,o.jsxs)(D.View,{css:n2.section,children:[(0,o.jsx)(D.View,{row:!0,gap:8,align:"center",children:(0,o.jsx)(A.Text,{css:n2.headerText,multiline:!1,children:"Commit"})}),(0,o.jsx)(eS,{status:p,onStagedFileClick:m})]}):null]}),C?(0,o.jsx)(tb,{items:N}):(0,o.jsx)(nh,{})]}):(0,o.jsx)("div",{children:"No branch"})}function n4(e,t){return e.map(function(e){return{type:"commit",commit:e,onViewCommitClick:t}})}function n8(e){if(!e||!e.size)return null;if(e.has("origin"))return"origin";var t=!0,n=!1,i=void 0;try{for(var o,a=e[Symbol.iterator]();!(t=(o=a.next()).done);t=!0){var s=(0,r._)(o.value,2),l=s[0],u=s[1];if(!nJ({url:u.fetch}))return l}}catch(e){n=!0,i=e}finally{try{t||null==a.return||a.return()}finally{if(n)throw i}}return null}function n5(){return(0,o.jsxs)(D.View,{children:[(0,o.jsx)(A.Text,{multiline:!1,children:"Unsupported state: you are in the middle of a cherry-pick."}),(0,o.jsx)(A.Text,{multiline:!1,children:"Please finish the cherry-pick manually."})]})}e.s(["default",()=>n5],680011);let n6=function(e){var t=(0,t3.default)(function(t){return(0,c._)(function(){var n,r,i;return(0,d._)(this,function(o){switch(o.label){case 0:return[4,t.isInitialized()];case 1:if((n=o.sent()).error)return[2,{error:n.error}];if(!n.initialized)return[2,{error:tX.GitErrors.NOT_INITIALIZED}];return[4,t.log({max:1,revRange:e})];case 2:if((r=o.sent()).error)return[2,{error:r.error}];if(0===r.commits.length)return[2,{error:tX.GitErrors.NO_COMMITS}];return[2,{commit:null!=(i=r.commits[0])?i:null,error:null}]}})})()},[e]);return(0,a.useMemo)(function(){return t?t.error?{error:t.error}:t:null},[t])};var n9=e.i(15053),n7=e.i(205104);let re=function(e){var t=(0,h.useNotifyGitError)(),n=(0,t3.default)(function(t){return(0,c._)(function(){var n,r,o,a,s,l;return(0,d._)(this,function(u){switch(u.label){case 0:return o=e.hash,[4,t.getFilesForCommit(o)];case 1:if(null==(a=u.sent())?void 0:a.error)return(0,g.reportErrorToSentry)({context:"use-commit-diffs",gitService:t,result:a,data:{commit:e}}),[2,{error:a.error,diffs:[]}];return s=(null==a||null==(n=a.files)?void 0:n.filter(function(e){return["ADDED","MODIFIED","COPIED","RENAMED","TYPE_CHANGED"].includes(e.type)}))||[],l=(null==a||null==(r=a.files)?void 0:r.filter(function(e){return["DELETED","MODIFIED","COPIED","RENAMED","TYPE_CHANGED"].includes(e.type)}))||[],[2,{error:null,diffs:Array.from(new Set((0,i._)(s).concat((0,i._)(l)))).map(function(e){var t,n;return{id:(0,n9.v4)(),status:e.type,loading:!1,initial:{filename:(0,n7.getFileName)(null!=(t=e.originalPath)?t:e.path),path:(0,n7.getParentPath)(null!=(n=e.originalPath)?n:e.path),content:""},final:{filename:(0,n7.getFileName)(e.path),path:(0,n7.getParentPath)(e.path),content:""}}})}]}})})()},[e]);return(0,a.useMemo)(function(){return n?n.error?(t(n.error),null):n:null},[t,n])};var rt=function(e,t,n,r){return(0,c._)(function(){var i,o,a;return(0,d._)(this,function(s){switch(s.label){case 0:return i=""===t?n:"".concat(t,"/").concat(n),[4,e.getFileContents({path:i,revision:r,convertToBase64:(0,n7.isMedia)(i)})];case 1:if((o=s.sent()).error)throw o.error;return[2,null!=(a=null==o?void 0:o.content)?a:""]}})})()},rn=e.i(51054),rr=e.i(304662),ri=e.i(718610),ro=e.i(841691),ra=(0,j.cssRecord)({splitOrUnisonContainer:[T.rcss.flex.wrap],emphasizedText:[T.rcss.fontWeight.medium],buttonGroupItem:[T.rcss.width(64),T.rcss.height(32)],textContainer:[T.rcss.mt(8),T.rcss.overflow("break-all")]}),rs=function(e){var t=e.children;return(0,o.jsx)(D.View,{css:ra.splitOrUnisonContainer,gap:8,align:"center",justify:"space-between",row:!0,children:t})},rl=function(e){var t=e.value,n=e.onChange;return(0,o.jsxs)(nR.ButtonGroup,{name:"SplitOrUnifiedDiff",value:t,onChange:n,row:!0,children:[(0,o.jsx)(D.View,{css:ra.buttonGroupItem,children:(0,o.jsx)(nR.ButtonGroupItem,{value:"Unified",text:"Unified",id:"SplitOrUnifiedDiffUnified"})}),(0,o.jsx)(D.View,{css:ra.buttonGroupItem,children:(0,o.jsx)(nR.ButtonGroupItem,{value:"Split",text:"Split",id:"SplitOrUnifiedDiffSplit"})})]})},ru=function(e){var t=e.value,n=e.onChange;return(0,o.jsx)(q.IconButton,{alt:"Markdown"===t?"View Source":"View Markdown",onClick:function(){return n("Markdown"===t?"Source":"Markdown")},children:"Markdown"===t?(0,o.jsx)(ri.default,{}):(0,o.jsx)(ro.default,{})})},rc=function(e){var t=e.files,n=e.totalFiles;return t===n?(0,o.jsxs)(A.Text,{css:ra.textContainer,children:["Showing"," ",(0,o.jsxs)("span",{css:ra.emphasizedText,children:[n," changed ",(0,f.default)("file",n),"."]})]}):(0,o.jsxs)(A.Text,{css:ra.textContainer,children:["Showing"," ",(0,o.jsxs)("span",{css:ra.emphasizedText,children:[t," of ",n," changed ",(0,f.default)("file",n),"."]})]})},rd=function(e){var t=e.query,n=e.setQuery,r=e.totalDiffs,i=e.diffs,s=e.splitOrUnified,l=e.setSplitOrUnified,u=e.folded,c=e.setFolded,d=(0,a.useMemo)(function(){return i.filter(function(e){var n="".concat(e.final.path,"/").concat(e.final.filename),r="".concat(e.initial.path,"/").concat(e.initial.filename);return n.toLowerCase().includes(t.toLowerCase())||r.toLowerCase().includes(t.toLowerCase())})},[t,i]);return(0,o.jsxs)(D.View,{gap:16,children:[(0,o.jsx)(rn.SearchBar,{value:t,onChange:function(e){n(e.target.value)},onClear:function(){n("")},loading:!1,placeholder:"Filter changed files"}),(0,o.jsxs)(rs,{children:[(0,o.jsx)(rc,{files:d.length,totalFiles:r}),i.length>0?(0,o.jsx)(rl,{value:s,onChange:function(e){return l(e)}}):null]}),d.map(function(e){var t;return(0,o.jsx)(rr.DiffViewer,{folded:null==(t=u[e.id])||t,setFolded:function(t){return c(e.id,t)},diff:e,splitOrUnified:s},e.id)})]})},rf=(0,j.cssRecord)({metaContainer:[T.rcss.flex.wrap]});let rp=function(e){var t=e.author,n=e.committer,r=tr(n,t),i=ti(n.date,t.date);return(0,o.jsxs)(D.View,{css:rf.metaContainer,row:!0,gap:4,align:"center",children:[r&&i?(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(e4.default,{name:t.name,email:t.email,color:"dimmer",allowPlaceholderAvatar:!0,small:!0}),(0,o.jsx)(A.Text,{variant:"small",children:"authored"}),(0,o.jsx)(e6.Timestamp,{date:t.date,textColor:"dimmest",textVariant:"small"}),(0,o.jsx)(A.Text,{variant:"small",children:"and"})]}):null,r&&!i?(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(e4.default,{name:t.name,email:t.email,color:"dimmer",allowPlaceholderAvatar:!0,small:!0}),(0,o.jsx)(A.Text,{variant:"small",children:"authored"}),(0,o.jsx)(A.Text,{variant:"small",children:"and"})]}):null,(0,o.jsx)(e4.default,{name:n.name,email:n.email,color:"dimmer",allowPlaceholderAvatar:!0,small:!0}),!r&&i?(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(A.Text,{variant:"small",children:"authored "}),(0,o.jsx)(e6.Timestamp,{date:t.date,textColor:"dimmest",textVariant:"small"}),(0,o.jsx)(A.Text,{variant:"small",children:"and "})]}):null,(0,o.jsx)(A.Text,{variant:"small",children:"committed"}),(0,o.jsx)(e6.Timestamp,{date:n.date,textColor:"dimmest",textVariant:"small"})]})};var rh=(0,j.cssRecord)({dullText:[T.rcss.color.foregroundDimmest],tooltipContainer:[T.rcss.display.inlineBlock]}),rg=function(e){var t=e.onViewCommitClick,n=e.hash;return(0,o.jsx)("span",{css:rh.tooltipContainer,children:(0,o.jsx)(P.Tooltip,{tooltip:"View commit",children:(0,o.jsx)("button",{css:[T.rcss.reset.button,T.rcss.linkStyle,T.rcss.fontWeight.medium],onClick:function(){return t(n)},children:n.slice(0,7)})})})};let rm=function(e){var t=e.parents,n=e.grafted,r=e.onViewCommitClick;return(0,o.jsxs)(A.Text,{variant:"small",children:[(0,o.jsxs)("span",{css:rh.dullText,children:[n?"Grafted with ":null,t.length," ",(0,f.default)("parent",t.length)," "]}),0===t.length?null:t.map(function(e,n){return(0,o.jsxs)(a.Fragment,{children:[(0,o.jsx)(rg,{hash:e,onViewCommitClick:r}),n===t.length-1?"":(0,o.jsx)("span",{css:rh.dullText,children:", "})]},e)})]})},rv=function(e){var t=e.source,n=e.target;return n?(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("span",{children:"branch"}),(0,o.jsx)(e8.BranchName,{name:t}),(0,o.jsx)("span",{children:" into "}),(0,o.jsx)(e8.BranchName,{name:n})]}):(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("span",{children:"branch"}),(0,o.jsx)(e8.BranchName,{name:t})]})};var rx="gitCommitSubject",ry=(0,nd.css)([T.rcss.display.inline,{fontSize:"inherit",fontWeight:"inherit",lineHeight:"inherit"}]),rb=(0,j.cssRecord)({header:[(n={},(0,e$._)(n,"& .".concat(rx),ry),(0,e$._)(n,"& .".concat(rx," > div"),ry),(0,e$._)(n,"& .".concat(rx," p"),ry),n)],markerContainer:[T.rcss.display.inlineFlex,T.rcss.mr(4)],mergeContainer:[T.rcss.rowWithGap(4),T.rcss.flex.row,T.rcss.flex.wrap,T.rcss.align.stretch,T.rcss.flex.shrink(0)]});let rw=function(e){var t=e.merge,n=e.revert,r=e.subject,i=e.remotes,s=e.onViewCommitClick,l=(0,a.useMemo)(function(){var e,r=null;if(((null==t?void 0:t.type)==="pull-request"?r=t.id:n&&(null==n?void 0:n.pr)&&(r=n.pr),r)&&i){var o=i.get("origin");if(!o){var a=Array.from(i.values());if(1!==a.length)return;o=a[0]}return null!=(e=(0,t4.simpleNameForRemote)(o))?e:void 0}},[t,i,n]);return(0,o.jsxs)(A.Header,{level:2,variant:"subheadDefault",multiline:!0,css:rb.header,children:[t?(0,o.jsxs)("span",{css:rb.mergeContainer,children:[(0,o.jsx)("span",{css:rb.markerContainer,children:(0,o.jsx)(eL,{type:"merge"})}),(0,o.jsx)(e8.MergeText,{text:"merged"}),(null==t?void 0:t.type)==="pull-request"?(0,o.jsxs)(o.Fragment,{children:["PR ",(0,o.jsx)(e8.PullRequestID,{id:t.id,hash:!0}),(null==n?void 0:n.pr)?(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(e8.RevertText,{text:"reverts"})," ",(0,o.jsx)(e8.PullRequestID,{id:n.pr,hash:!0})]}):null]}):null,(null==t?void 0:t.type)==="branch"?(0,o.jsx)(o.Fragment,{children:(0,o.jsx)(rv,{source:t.source,target:t.target})}):null]}):null,n&&!t?(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("span",{css:rb.markerContainer,children:(0,o.jsx)(eL,{type:"revert"})}),(0,o.jsx)(e8.RevertText,{text:"reverted"})," ",(0,o.jsx)("button",{css:[T.rcss.reset.button,T.rcss.linkStyle,T.rcss.fontWeight.medium],onClick:function(){(null==n?void 0:n.hash)!==void 0&&s(n.hash)},children:n.hash.slice(0,7)})," - "]}):null,(0,o.jsx)(e8.CommitSubject,{className:rx,subject:r,remoteName:l})]})};var rk=(0,j.cssRecord)({splitContainer:[T.rcss.display.flex,T.rcss.flex.row,T.rcss.flex.shrink(1),T.rcss.flex.wrap,T.rcss.justify.spaceBetween,T.rcss.maxWidth("100%"),T.rcss.border({color:C.tokens.outlineDimmest,direction:"bottom"}),T.rcss.pb(16)]});let r_=function(e){var t,n=e.git,s=e.commit,l=e.info,u=e.onViewCommitClick,f=void 0===u?function(){}:u,p=e.remotes,m=e.status,x=(0,a.useMemo)(function(){return(0,z.getUniquePathMap)(m?m.changes.map(function(e){return e.path}):[])},[m]),y=(0,a.useMemo)(function(){if(!m)return[];var e=[],t=!0,n=!1,r=void 0;try{for(var i,o=m.changes[Symbol.iterator]();!(t=(i=o.next()).done);t=!0){var a=i.value;a.type.worktree!==$.GitStatusChangedFileType.UNMODIFIED&&e.push(a)}}catch(e){n=!0,r=e}finally{try{t||null==o.return||o.return()}finally{if(n)throw r}}return e},[m]),b=(0,nk.default)().showConfirm,w=(0,h.useNotifyGitError)(),k=(0,r._)((0,a.useState)(!1),2),_=k[0],S=k[1],C=(0,r._)((0,a.useState)(""),2),j=C[0],T=C[1],E=(0,r._)((0,a.useState)("Split"),2),R=E[0],I=E[1],P=(0,r._)((0,a.useState)("Markdown"),2),O=P[0],N=P[1],M=(0,r._)((0,a.useState)({}),2),L=M[0],B=M[1],V=(0,r._)((0,a.useState)([]),2),F=V[0],U=V[1],G=te(s,l),H=G.hideBody,W=G.merge,q=G.revert,K=s.hash,Y=s.subject,Q=s.body,X=s.committer,J=s.author,Z=s.grafted,ee=null!=(t=s.parents)?t:[],et=re(s),en=(0,a.useCallback)(function(){var e=!(arguments.length>0)||void 0===arguments[0]||arguments[0];return(0,c._)(function(){var t,r;return(0,d._)(this,function(i){switch(i.label){case 0:return[4,n.restoreFiles(e,s.hash)];case 1:if((t=i.sent()).error)return[3,3];return[4,n.status()];case 2:return(r=i.sent()).error?(w(r.error),(0,g.reportErrorToSentry)({context:"commit-view",gitService:n,result:r,data:{files:e,commit:s.hash}})):b("Restored commit!"),n.forceRefresh(),[3,4];case 3:w(t.error),(0,g.reportErrorToSentry)({context:"commit-view",gitService:n,result:t,data:{files:e,commit:s.hash}}),i.label=4;case 4:return[2]}})})()},[s.hash,n,w,b]),er=ev(x),ei=er.openRestoreConfirmationModal,eo=er.restoreConfirmationModal,ea=(0,a.useCallback)(function(){var e=!(arguments.length>0)||void 0===arguments[0]||arguments[0];return(0,c._)(function(){var t,n;return(0,d._)(this,function(r){switch(r.label){case 0:if(!0!==e)return[3,6];if(S(!0),0!==y.length)return[3,2];return[4,en()];case 1:return r.sent(),S(!1),[2];case 2:return[4,ei(y)];case 3:if(!r.sent())return[3,5];return[4,en()];case 4:r.sent(),r.label=5;case 5:return S(!1),[3,10];case 6:if("string"==typeof e){if(!(n=y.find(function(t){return t.path===e})))throw S(!1),Error("Could not find file in worktree list");t=[n]}else t=y.filter(function(t){return e.includes(t.path)});return[4,ei(t)];case 7:if(!r.sent())return[3,9];return[4,en(e)];case 8:r.sent(),r.label=9;case 9:S(!1),r.label=10;case 10:return[2]}})})()},[ei,en,y]);return(0,a.useEffect)(function(){var e;U(null!=(e=null==et?void 0:et.diffs.map(function(e){return(0,eu._)((0,el._)({},e),{loading:!0})}))?e:[])},[et]),(0,a.useEffect)(function(){null!==et&&et.error&&w(et.error)},[et,w]),(0,o.jsxs)(D.View,{p:16,gap:16,children:[(0,o.jsx)(rw,{remotes:p,merge:W,revert:q,subject:Y,onViewCommitClick:f}),(0,o.jsxs)(rs,{children:[(0,o.jsxs)(D.View,{row:!0,gap:8,shrink:!0,align:"start",children:[(0,o.jsx)(tt,{hash:K}),(0,o.jsx)(tn,{onClick:function(){return ea()},text:"Restore All",loading:_})]}),H?null:(0,o.jsx)(ru,{value:O,onChange:function(e){N(e)}})]}),H?null:(0,o.jsx)(e8.CommitBody,{body:Q,view:O}),(0,o.jsxs)(D.View,{css:rk.splitContainer,children:[(0,o.jsx)(rp,{author:J,committer:X}),(0,o.jsx)(rm,{parents:ee,grafted:Z,onViewCommitClick:f})]}),null!==W?(0,o.jsx)(A.Text,{variant:"small",color:"dimmest",children:"There is more than one parent, diffing against the first parent."}):null,null===et?(0,o.jsx)(nh,{}):(0,o.jsx)(rd,{query:j,setQuery:T,totalDiffs:et.diffs.length,diffs:F,splitOrUnified:R,setSplitOrUnified:I,folded:L,setFolded:function(e,t){return(0,c._)(function(){var r,o,a;return(0,d._)(this,function(l){switch(l.label){case 0:if(B(function(n){var r=(0,el._)({},n);return r[e]=t,r}),!(r=F.find(function(t){return t.id===e})))return w(tX.GitErrors.INVALID_STATE),(0,g.reportErrorToSentry)({context:"commit-view",gitService:n,result:{error:tX.GitErrors.INVALID_STATE},data:{diffId:e}}),[2];if(!(!t&&r.loading))return[3,4];l.label=1;case 1:var u;return l.trys.push([1,3,,4]),[4,(u=r,(0,c._)(function(){var e,t,r,i;return(0,d._)(this,function(o){switch(o.label){case 0:return t=s.hash,[4,rt(n,u.final.path,u.final.filename,t)];case 1:if(r=o.sent(),i="",!(!s.grafted&&(null==(e=s.parents)?void 0:e.length)))return[3,3];return[4,rt(n,u.initial.path,u.initial.filename,"".concat(t,"^"))];case 2:i=o.sent(),o.label=3;case 3:return[2,(0,eu._)((0,el._)({},u),{loading:!1,initial:(0,eu._)((0,el._)({},u.initial),{content:i}),final:(0,eu._)((0,el._)({},u.final),{content:r})})]}})})())];case 2:return o=l.sent(),U(function(t){var n=(0,i._)(t),r=n.findIndex(function(t){return t.id===e});return n[r]=o,n}),[3,4];case 3:return a=l.sent(),(0,g.reportErrorToSentry)({context:"commit-view",gitService:n,result:a,data:{diffId:e}}),w(a),[2];case 4:return[2]}})})()}}),eo]})};function rS(e){var t=e.hash,n=e.remotes,r=e.onViewCommitClick,i=e.switchMode,a=e.status,s=(0,p.default)().git,l=(0,h.useNotifyGitError)(),u=n6(null!=t?t:"");if(null===u)return(0,o.jsx)(nh,{});if(u.error)return u.error===tX.GitErrors.NOT_INITIALIZED?i({type:tV.GitPaneModeType.CURRENT_BRANCH}):(l(u.error),(u.error===tX.GitErrors.UNKNOWN||u.error===tX.GitErrors.UNKNOWN_NOT_GIT)&&(0,g.reportErrorToSentry)({context:"commit-view",gitService:s,result:u,data:{hash:t}})),null;if(null===u.commit)return l(tX.GitErrors.UNKNOWN),null;var c=u.commit,d=eO(c)||eR(c);return(0,o.jsx)(r_,{git:s,commit:c,info:d,onViewCommitClick:r,remotes:n,status:a})}function rC(){return(0,o.jsxs)(D.View,{children:[(0,o.jsx)(A.Text,{multiline:!0,children:"Unsupported state: your config is currently locked. This can happen if multiple git processes are running operations at the same time."}),(0,o.jsx)(A.Text,{multiline:!0,children:"Please resolve the issue by ending those git operations. If you are sure you do not have git operations running, you can delete your .git/config.lock file."})]})}e.s(["default",()=>rS],772275),e.s(["default",()=>rC],540285);var rj=e.i(167193),rT=(0,j.cssRecord)({branch:[eY.interactive.nofill,T.rcss.py(12),T.rcss.px(8),T.rcss.colWithGap(2),T.rcss.justify.center,T.rcss.borderRadius(8),T.rcss.flex.shrink(1)]});function rE(e){var t=e.branch,n=e.current,r=e.onClick;return(0,o.jsxs)(D.View,{css:rT.branch,tabIndex:0,role:"button","aria-label":"Switch to branch ".concat((0,tJ.getQualifiedBranchName)(t,!0)),onClick:r,onKeyDown:function(e){("Enter"===e.key||" "===e.key)&&(null==r||r())},children:[(0,o.jsx)(A.Text,{multiline:!1,children:(0,o.jsx)(e8.BranchName,{name:t.name,remote:t.type===s.GitBranchType.REMOTE?t.remote:null,current:void 0!==n&&n,onClick:r,icon:!0})}),(0,o.jsx)(rR,{branch:t})]})}function rR(e){var t=e.branch;return(0,o.jsxs)(D.View,{shrink:!0,row:!0,gap:8,align:"center",children:[(0,o.jsx)(e4.default,{name:t.commit.author.name,email:t.commit.author.email,color:"dimmest",allowPlaceholderAvatar:!0}),(0,o.jsx)(e6.Timestamp,{date:t.commit.author.date,textColor:"dimmest",textVariant:"small"})]})}var rI=(0,j.cssRecord)({expandButton:[{verticalAlign:"middle"},T.rcss.justify.spaceBetween],branchListContainer:[T.rcss.display.flex],topRowInteractive:[{verticalAlign:"middle"},T.rcss.justify.spaceBetween,T.rcss.borderRadius(8,8,0,0)],branchList:[T.rcss.borderRadius(8)],branchListFoldable:[T.rcss.borderRadius(0,0,8,8)]});function rA(e){var t=e.name,n=e.branches,i=e.current,s=void 0===i?null:i,l=e.foldable,u=void 0!==l&&l,c=e.folded,d=e.switchBranch,f=(0,r._)((0,a.useState)(!!u&&void 0!==c&&c),2),p=f[0],h=f[1],g=(0,a.useMemo)(function(){return n.map(function(e){return(0,o.jsx)(rE,{branch:e,current:(0,rj.branchesEqual)(e,s),onClick:function(){return d(e)}},(0,tJ.getFullBranchName)(e))})},[n,s,d]);return p?(0,o.jsx)(E.Button,{css:rI.expandButton,text:t,iconRight:(0,o.jsx)(O.default,{}),onClick:function(){return h(!1)},size:"big"}):u?(0,o.jsxs)(D.View,{css:rI.branchListContainer,children:[(0,o.jsx)(E.Button,{css:rI.topRowInteractive,text:t,iconRight:(0,o.jsx)(N.default,{}),onClick:function(){return h(!0)},size:"big"}),(0,o.jsx)(I.Surface,{css:rI.branchListFoldable,elevated:!0,children:g})]}):(0,o.jsxs)(D.View,{css:rI.branchListContainer,children:[(0,o.jsx)(D.View,{p:4,row:!0,align:"center",justify:"space-between",children:(0,o.jsx)(A.Text,{variant:"subheadDefault",multiline:!1,children:t})}),(0,o.jsx)(I.Surface,{css:rI.branchList,elevated:!0,children:g})]})}var rP=(0,j.cssRecord)({container:[T.rcss.borderRadius(8)],button:[T.rcss.flex.grow(1)],inputDisabled:[{opacity:.75}]});function rD(){var e=(0,r._)((0,a.useState)(!0),2),t=e[0],n=e[1],i=(0,r._)((0,a.useState)(""),2),s=i[0],l=i[1],u=(0,r._)((0,a.useState)(!1),2),f=u[0],g=u[1],x=(0,h.useNotifyGitError)(),y=(0,p.default)().git;function b(){n(!0),l("")}function w(){return(0,c._)(function(){var e;return(0,d._)(this,function(r){switch(r.label){case 0:if(t||!s||f)return[2];return g(!0),[4,y.createBranch({name:s,checkout:!0})];case 1:return(e=r.sent()).error?(x(e.error),g(!1)):(y.forceRefresh(),g(!1),l(""),n(!0),(0,m.trackGitPaneEvent)("branch-created")),[2]}})})()}if(t)return(0,o.jsx)(E.Button,{text:"Create Branch",iconLeft:(0,o.jsx)(Q.default,{}),onClick:function(){return n(!1)}});var k=!s||!(0,tJ.isValidBranchName)(s);return(0,o.jsxs)(I.Surface,{css:rP.container,p:8,gap:8,elevated:!0,children:[(0,o.jsx)(rO,{value:s,onChange:l,onSubmit:w,onCancel:b,disabled:f}),(0,o.jsxs)(D.View,{row:!0,gap:4,children:[(0,o.jsx)(E.Button,{css:rP.button,text:"Cancel",onClick:b,disabled:f}),(0,o.jsx)(E.Button,{css:rP.button,text:"Create Branch",colorway:"primary",iconLeft:(0,o.jsx)(Q.default,{}),onClick:w,loading:f,disabled:k})]})]})}function rO(e){var t=e.value,n=e.disabled,r=e.onChange,i=e.onSubmit,a=e.onCancel;function s(e){(0,tJ.hasOnlyValidBranchNameCharacters)(e)&&(null==r||r(e))}return(0,o.jsx)(R.Input,{value:t,css:n?rP.inputDisabled:void 0,disabled:n,placeholder:"Enter a name for your new branch",onChange:function(e){return s(e.currentTarget.value)},onKeyDown:function(e){var n=e.key,r=function(){return e.preventDefault()};switch(n){case"Enter":null==i||i(),r();break;case"Escape":null==a||a(),r();break;case" ":if(""===t){r();break}s(t+"-"),r()}},onBlur:function(){""===t&&(null==a||a())},autoFocus:!0})}function rN(e){var t=e.currentBranch,n=e.switchMode,i=(0,h.useNotifyGitError)(),s=(0,p.default)().git,l=(0,r._)((0,a.useState)(null),2),u=l[0],f=l[1],x=(0,t3.default)(function(e){return(0,c._)(function(){var t,n,r,o,a,s,l,u,c,f,p,h,m,x,y,b,w,k,_;return(0,d._)(this,function(d){switch(d.label){case 0:return[4,e.listBranches()];case 1:if((t=d.sent()).error)return i(t.error),(0,g.reportErrorToSentry)({context:"dashboard-view",gitService:e,result:t}),[2,t];return[4,e.findDefaultBranches()];case 2:if((n=d.sent()).error)return i(n.error),[2,n];r=t.branches,o=new Set,a=!0,s=!1,l=void 0;try{for(u=function(){var e=f.value,t=r.find(function(t){return(0,tJ.isSameBranchRef)(t,e)});t&&o.add(t)},c=n.refs[Symbol.iterator]();!(a=(f=c.next()).done);a=!0)u()}catch(e){s=!0,l=e}finally{try{a||null==c.return||c.return()}finally{if(s)throw l}}p=Date.now()-5184e6,h=[],m=[],x=!0,y=!1,b=void 0;try{for(w=r[Symbol.iterator]();!(x=(k=w.next()).done);x=!0)_=k.value,o.has(_)||(_.commit.author.date>p?h.push(_):m.push(_))}catch(e){y=!0,b=e}finally{try{x||null==w.return||w.return()}finally{if(y)throw b}}return[2,{active:h,stale:m,important:Array.from(o),error:null}]}})})()},[i]),y=function(e){return(0,c._)(function(){var r;return(0,d._)(this,function(o){switch(o.label){case 0:if(null!==u)return[2];return(0,tJ.isSameBranchRef)(t,e)&&n({type:tV.GitPaneModeType.CURRENT_BRANCH}),f(e),[4,s.switchBranch(e)];case 1:return(r=o.sent()).error?(i(r.error),(0,g.reportErrorToSentry)({context:"dashboard-view",gitService:s,result:r,data:{branch:e.name}}),f(null)):(s.forceRefresh(),(0,m.trackGitPaneEvent)("branch-switched")),[2]}})})()};if((0,a.useEffect)(function(){null!==u&&(0,tJ.isSameBranchRef)(t,u)&&(f(null),n({type:tV.GitPaneModeType.CURRENT_BRANCH}))},[t,u,n]),!x||null!==u)return(0,o.jsx)(nh,{});if(x.error)return(0,o.jsx)("div",{children:x.error});var b=x.active,w=x.stale,k=x.important;return(0,o.jsx)(D.View,{gap:8,children:(0,o.jsxs)(D.View,{pb:8,px:8,gap:16,children:[t?(0,o.jsxs)(D.View,{gap:8,children:[(0,o.jsx)(rA,{branches:[t],current:t,name:"Current Branch",switchBranch:y}),(0,o.jsx)(rD,{})]}):null,(0,o.jsx)(A.Text,{variant:"subheadDefault",multiline:!1,css:n2.switchToBranch,children:"Switch Branch"}),0===k.length?null:(0,o.jsx)(rA,{branches:k,current:t,name:"Important",switchBranch:y,foldable:!0}),0===b.length?null:(0,o.jsx)(rA,{branches:b,current:t,name:"Active",switchBranch:y,foldable:!0}),0===w.length?null:(0,o.jsx)(rA,{branches:w,current:t,name:"Stale",switchBranch:y,foldable:!0,folded:!0})]})})}function rM(){return(0,o.jsxs)(D.View,{children:[(0,o.jsx)(A.Text,{multiline:!1,children:"Unsupported state: your HEAD is currently detached."}),(0,o.jsx)(A.Text,{multiline:!1,children:"Please checkout a branch."})]})}function rL(){return(0,o.jsxs)(D.View,{children:[(0,o.jsx)(A.Text,{multiline:!0,children:"Unsupported state: your index is currently locked. This can happen if multiple git processes are running operations at the same time."}),(0,o.jsx)(A.Text,{multiline:!0,children:"Please resolve the issue by ending those git operations. If you are sure you do not have git operations running, you can delete your .git/index.lock file."})]})}e.s(["default",()=>rN],710106),e.s(["default",()=>rM],973267),e.s(["default",()=>rL],35647);var rB=e.i(167626),rV=e.i(630818);function rF(e){var t=e.files,n=e.uniquePathMap,i=e.onFileClick,a=[];if((0,rB._)(t,Map)){var s=!0,l=!1,u=void 0;try{for(var c,d=t[Symbol.iterator]();!(s=(c=d.next()).done);s=!0){var f=(0,r._)(c.value,2),p=f[0],h=f[1],g=n.get(p);a.push({path:p,prefix:g,resolved:h})}}catch(e){l=!0,u=e}finally{try{s||null==d.return||d.return()}finally{if(l)throw u}}}else{var m=!0,x=!1,y=void 0;try{for(var b,w=t[Symbol.iterator]();!(m=(b=w.next()).done);m=!0){var k=b.value,_=n.get(k);a.push({path:k,prefix:_,resolved:!0})}}catch(e){x=!0,y=e}finally{try{m||null==w.return||w.return()}finally{if(x)throw y}}}return(0,o.jsx)(D.View,{gap:4,children:a.map(function(e){var t=e.path,n=e.prefix,r=e.resolved;return(0,o.jsxs)(D.View,{row:!0,gap:8,align:"center",children:[(0,o.jsxs)(D.View,{grow:!0,align:"center",row:!0,gap:8,children:[(0,o.jsx)(rV.default,{path:t}),(0,o.jsx)(A.Text,{multiline:!1,children:(0,o.jsx)(e8.FilePath,{path:t,prefix:n,onClick:function(){return i({path:t,type:"conflict"})}})})]}),r?(0,o.jsx)(e_.default,{color:C.tokens.greenStronger}):(0,o.jsx)(tU.default,{color:C.tokens.orangeStronger})]},t)})})}function rU(e){var t=e.hasConflicts?(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("span",{css:T.rcss.fontWeight.medium,children:"Resolve all conflicts to complete merge."}),(0,o.jsx)("br",{}),(0,o.jsx)("span",{children:"You can't do anything else until the merge has been completed or aborted."})]}):(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("span",{css:T.rcss.fontWeight.medium,children:"You are in the middle of a merge."}),(0,o.jsx)("br",{}),(0,o.jsx)("span",{children:"You can't do anything else until the merge has been completed or aborted. You have no conflicts to resolve, so the merge can be completed without any further action."})]});return(0,o.jsx)(tA.StatusBanner,{colorway:"warning",icon:(0,o.jsx)(tU.default,{}),text:t})}var rG=e.i(627557),r$=e.i(369948),rz=e.i(230999),rH=(0,j.cssRecord)({left:[{flexBasis:0,flexGrow:1},T.rcss.colWithGap(8)],right:{flexBasis:0,flexGrow:1},branch:[T.rcss.p(8),T.rcss.rowWithGap(4),T.rcss.flex.grow(1),T.rcss.center,T.rcss.borderRadius(8)]});function rW(e){var t,n=e.branch,i=e.refs,a=e.refsAreBranches,s=e.isUpstreamPull;if(!i.length)return null;if(s){var l=(0,r._)((0,rG.splitRemoteFromBranch)(i[0]),2),u=l[0],c=l[1];u&&c&&(t=(0,o.jsx)(I.Surface,{css:rH.branch,elevated:!0,children:(0,o.jsx)(e8.BranchName,{remote:u,name:c,icon:!0,heading:!0})}))}return t||(t=i.map(function(e){return(0,o.jsx)(I.Surface,{css:rH.branch,elevated:!0,children:(0,o.jsx)(e8.BranchName,{name:e,icon:!!a||(0,o.jsx)(rz.default,{size:16}),heading:!0})},e)})),(0,o.jsxs)(D.View,{row:!0,gap:4,align:"center",justify:"space-between",children:[(0,o.jsx)(D.View,{css:rH.left,children:t}),(0,o.jsx)(r$.default,{size:24,color:C.tokens.foregroundDimmest}),(0,o.jsx)(D.View,{css:rH.right,children:(0,o.jsx)(I.Surface,{css:rH.branch,elevated:!0,children:(0,o.jsx)(e8.BranchName,{name:n,icon:!0,current:!0,heading:!0})})})]})}var rq=e.i(127227),rK=e.i(105208),rY=(0,j.cssRecord)({fakePaneHeader:[T.rcss.backgroundColor.backgroundDefault,T.rcss.align.center,{borderBottom:"1px solid ".concat(C.tokens.outlineDimmer)}],listContainer:[T.rcss.borderRadius(8)],list:[],listDisabled:[{opacity:.5},T.rcss.pb(8),T.rcss.colWithGap(8)],listHeader:[T.rcss.pb(4),T.rcss.flex.grow(1),T.rcss.border({color:C.tokens.outlineDimmer,direction:"bottom"})],listFiles:[T.rcss.px(8)],includeOtherFiles:[{cursor:"pointer",maxWidth:"max-content",userSelect:"none"},T.rcss.rowWithGap(8)]});function rQ(e){var t=e.onFileClick,n=e.gotoPendingState,s=(0,r._)((0,a.useState)(!0),2),l=s[0],u=s[1],f=(0,r._)((0,a.useState)(!1),2),m=f[0],x=f[1],y=(0,r._)((0,a.useState)(!1),2),b=y[0],w=y[1],k=m||b,_=(0,h.useNotifyGitError)(),S=(0,p.default)().git,C=(0,a.useId)(),j=(0,t3.default)(function(e){return(0,c._)(function(){var t,n,i,o,a,s,l,u,c,f,p,h,m,x,y,b,w,k,_,S;return(0,d._)(this,function(d){switch(d.label){case 0:return[4,e.status()];case 1:if((t=d.sent()).error)return(0,g.reportErrorToSentry)({context:"use-merging-view-state-status",gitService:e,result:t}),[2,t];if(!(n=t.branch))return[2,{error:tX.GitErrors.HEAD_DETACHED}];return[4,e.getConflictingFiles()];case 2:if((i=d.sent()).error)return[2,i];return o=i.files,[4,e.getMergingRefs()];case 3:if((a=d.sent()).error)return(0,g.reportErrorToSentry)({context:"use-merging-view-state-merging-refs",gitService:e,result:a,data:{status:t,conflictingFiles:o}}),[2,a];s=a.commits,c=(u=(l=a.branches).length>0)?l:s,f=t.changes.filter(function(e){return!e.unmerged}).map(function(e){return e.path}),p=!0,h=!0,m=!1,x=void 0;try{for(y=o[Symbol.iterator]();!(h=(b=y.next()).done);h=!0)if(!(0,r._)(b.value,2)[1]){p=!1;break}}catch(e){m=!0,x=e}finally{try{h||null==y.return||y.return()}finally{if(m)throw x}}return w=(0,z.getUniquePathMap)(t.changes.map(function(e){return e.path})),k=o.size>0,_=f.length>0,S=null!==t.upstream&&1===l.length&&l[0]===t.upstream.branch,[2,{refs:c,branch:n,conflictingFiles:o,otherChangedFiles:f,refsAreBranches:u,allIsResolved:p,uniquePathMap:w,hasConflicts:k,hasOtherChanges:_,isUpstreamPull:S,error:null}]}})})()});if((0,a.useEffect)(function(){(null==j?void 0:j.error)&&_(j.error)},[null==j?void 0:j.error,_]),!j)return(0,o.jsx)(nh,{});if(j.error)return null;var R=j.refs,P=j.branch,O=j.conflictingFiles,N=j.otherChangedFiles,M=j.refsAreBranches,L=j.allIsResolved,B=j.uniquePathMap,V=j.hasConflicts,F=j.hasOtherChanges,U=j.isUpstreamPull,G=U?"Complete in-progress pull":"Complete in-progress merge";return V&&(G=U?"Resolve pull conflicts":"Resolve merge conflicts"),(0,o.jsxs)(D.View,{children:[(0,o.jsxs)(D.View,{css:rY.fakePaneHeader,p:8,row:!0,gap:8,children:[(0,o.jsx)(rK.default,{}),(0,o.jsx)(A.Text,{variant:"subheadDefault",multiline:!1,children:G})]}),(0,o.jsxs)(D.View,{pt:16,pb:8,px:8,gap:12,children:[(0,o.jsx)(rW,{branch:P,refs:R,refsAreBranches:M,isUpstreamPull:U}),(0,o.jsx)(rU,{hasConflicts:V}),(0,o.jsxs)(I.Surface,{css:rY.listContainer,p:8,gap:8,elevated:!0,children:[(0,o.jsxs)(D.View,{pb:8,gap:8,children:[(0,o.jsx)(D.View,{css:rY.listHeader,children:(0,o.jsx)(A.Text,{css:T.rcss.fontWeight.medium,multiline:!1,children:"Conflicting Files"})}),(0,o.jsx)(D.View,{css:rY.listFiles,children:V?(0,o.jsx)(rF,{files:O,uniquePathMap:B,onFileClick:t}):(0,o.jsx)(A.Text,{variant:"small",color:"dimmest",multiline:!1,children:"There are no conflicting files in this merge."})})]}),F?(0,o.jsxs)(D.View,{css:l?rY.list:rY.listDisabled,children:[(0,o.jsx)(D.View,{css:rY.listHeader,children:(0,o.jsx)(A.Text,{css:T.rcss.fontWeight.medium,multiline:!1,children:"Other Changed Files"})}),(0,o.jsx)(D.View,{css:rY.listFiles,children:(0,o.jsx)(rF,{files:N,uniquePathMap:B,onFileClick:t})})]}):null]}),(0,o.jsxs)(D.View,{css:rY.includeOtherFiles,tag:"label",children:[(0,o.jsx)(rq.Checkbox,{id:C,checked:l,onChange:function(e){return u(e)}}),(0,o.jsx)(A.Text,{multiline:!1,children:"Include other changed files in commit"})]}),(0,o.jsxs)(D.View,{gap:8,children:[(0,o.jsx)(E.Button,{text:U?"Complete pull":"Complete merge and commit",colorway:"primary",iconLeft:m?(0,o.jsx)(K.default,{}):(0,o.jsx)(rK.default,{}),disabled:!L||k,loading:m,onClick:function(){return(0,c._)(function(){var e,t,r,o,a,s,u,c,f,p,h;return(0,d._)(this,function(d){switch(d.label){case 0:if(!L||k)return[2];x(!0),e=[],t=!0,r=!1,o=void 0;try{for(a=O.keys()[Symbol.iterator]();!(t=(s=a.next()).done);t=!0)u=s.value,e.push(u)}catch(e){r=!0,o=e}finally{try{t||null==a.return||a.return()}finally{if(r)throw o}}return l&&(c=e).push.apply(c,(0,i._)(N)),[4,S.stageFiles({all:!1})];case 1:if((f=d.sent()).error)return _(f.error),x(!1),[2];return[4,S.stageFiles({add:e})];case 2:if((p=d.sent()).error)return _(p.error),x(!1),[2];return[4,S.mergeContinue()];case 3:if(!(h=d.sent()).error)return[3,5];return[4,S.stageFiles({all:!1})];case 4:return d.sent(),_(h.error),x(!1),[3,6];case 5:n(),S.forceRefresh(),d.label=6;case 6:return[2]}})})()}}),(0,o.jsx)(E.Button,{text:U?"Abort pull":"Abort merge",colorway:"negative",iconLeft:b?(0,o.jsx)(K.default,{}):(0,o.jsx)(ef.default,{}),disabled:k,loading:b,onClick:function(){return(0,c._)(function(){var e;return(0,d._)(this,function(t){switch(t.label){case 0:if(k)return[2];return w(!0),[4,S.mergeAbort()];case 1:return(e=t.sent()).error?(_(e.error),w(!1),(0,g.reportErrorToSentry)({context:"merging-view-abort",gitService:S,result:e,data:{branch:P}})):(n(),S.forceRefresh()),[2]}})})()}})]})]})]})}e.s(["default",()=>rQ],737553);var rX=(0,j.cssRecord)({fakePaneHeader:[T.rcss.backgroundColor.backgroundDefault,T.rcss.align.center,{borderBottom:"1px solid ".concat(C.tokens.outlineDimmer)}],listContainer:[T.rcss.borderRadius(8)],list:[],listDisabled:[{opacity:.5},T.rcss.pb(8),T.rcss.colWithGap(8)],listHeader:[T.rcss.pb(4),T.rcss.flex.grow(1),T.rcss.border({color:C.tokens.outlineDimmer,direction:"bottom"})],listFiles:[T.rcss.px(8)],includeOtherFiles:[{cursor:"pointer",maxWidth:"max-content",userSelect:"none"},T.rcss.rowWithGap(8)]});function rJ(e){var t=e.onFileClick,n=e.gotoPendingState,s=(0,r._)((0,a.useState)(!0),2),l=s[0],u=s[1],f=(0,r._)((0,a.useState)(!1),2),m=f[0],x=f[1],y=(0,r._)((0,a.useState)(!1),2),b=y[0],w=y[1],k=m||b,_=(0,h.useNotifyGitError)(),S=(0,p.default)().git,C=(0,a.useId)(),j=(0,t3.default)(function(e){return(0,c._)(function(){var t,n,i,o,a,s,l,u,c,f,p,h,m,x;return(0,d._)(this,function(d){switch(d.label){case 0:return[4,e.status()];case 1:if((t=d.sent()).error)return(0,g.reportErrorToSentry)({context:"use-rebasing-view-state-status",gitService:e,result:t}),[2,t];if(!(n=t.branch))return[2,{error:tX.GitErrors.HEAD_DETACHED}];return[4,e.getConflictingFiles()];case 2:if((i=d.sent()).error)return[2,i];o=i.files,a=t.changes.filter(function(e){return!e.unmerged}).map(function(e){return e.path}),s=!0,l=!0,u=!1,c=void 0;try{for(f=o[Symbol.iterator]();!(l=(p=f.next()).done);l=!0)if(!(0,r._)(p.value,2)[1]){s=!1;break}}catch(e){u=!0,c=e}finally{try{l||null==f.return||f.return()}finally{if(u)throw c}}return h=(0,z.getUniquePathMap)(t.changes.map(function(e){return e.path})),m=o.size>0,x=a.length>0,[2,{branch:n,conflictingFiles:o,otherChangedFiles:a,allIsResolved:s,uniquePathMap:h,hasConflicts:m,hasOtherChanges:x,error:null}]}})})()});if((0,a.useEffect)(function(){(null==j?void 0:j.error)&&_(j.error)},[null==j?void 0:j.error,_]),!j)return(0,o.jsx)(nh,{});if(j.error)return null;var R=j.branch,P=j.conflictingFiles,O=j.otherChangedFiles,N=j.allIsResolved,M=j.uniquePathMap,L=j.hasConflicts,B=j.hasOtherChanges,V="Complete in-progress rebase";return L&&(V="Resolve conflicts"),(0,o.jsxs)(D.View,{children:[(0,o.jsxs)(D.View,{css:rX.fakePaneHeader,p:8,row:!0,gap:8,children:[(0,o.jsx)(rK.default,{}),(0,o.jsx)(A.Text,{variant:"subheadDefault",multiline:!1,children:V})]}),(0,o.jsxs)(D.View,{pt:16,pb:8,px:8,gap:12,children:[(0,o.jsx)(rU,{hasConflicts:L}),(0,o.jsxs)(I.Surface,{css:rX.listContainer,p:8,gap:8,elevated:!0,children:[(0,o.jsxs)(D.View,{pb:8,gap:8,children:[(0,o.jsx)(D.View,{css:rX.listHeader,children:(0,o.jsx)(A.Text,{css:T.rcss.fontWeight.medium,multiline:!1,children:"Conflicting Files"})}),(0,o.jsx)(D.View,{css:rX.listFiles,children:L?(0,o.jsx)(rF,{files:P,uniquePathMap:M,onFileClick:t}):(0,o.jsx)(A.Text,{variant:"small",color:"dimmest",multiline:!1,children:"There are no conflicting files in this step."})})]}),B?(0,o.jsxs)(D.View,{css:l?rX.list:rX.listDisabled,children:[(0,o.jsx)(D.View,{css:rX.listHeader,children:(0,o.jsx)(A.Text,{css:T.rcss.fontWeight.medium,multiline:!1,children:"Other Changed Files"})}),(0,o.jsx)(D.View,{css:rX.listFiles,children:(0,o.jsx)(rF,{files:O,uniquePathMap:M,onFileClick:t})})]}):null]}),(0,o.jsxs)(D.View,{css:rX.includeOtherFiles,tag:"label",children:[(0,o.jsx)(rq.Checkbox,{id:C,checked:l,onChange:function(e){return u(e)}}),(0,o.jsx)(A.Text,{multiline:!1,children:"Include other changed files in commit"})]}),(0,o.jsxs)(D.View,{gap:8,children:[(0,o.jsx)(E.Button,{text:"commit and continue rebase",colorway:"primary",iconLeft:m?(0,o.jsx)(K.default,{}):(0,o.jsx)(rK.default,{}),disabled:!N||k,loading:m,onClick:function(){return(0,c._)(function(){var e,t,r,o,a,s,u,c,f,p,h;return(0,d._)(this,function(d){switch(d.label){case 0:if(!N||k)return[2];x(!0),e=[],t=!0,r=!1,o=void 0;try{for(a=P.keys()[Symbol.iterator]();!(t=(s=a.next()).done);t=!0)u=s.value,e.push(u)}catch(e){r=!0,o=e}finally{try{t||null==a.return||a.return()}finally{if(r)throw o}}return l&&(c=e).push.apply(c,(0,i._)(O)),[4,S.stageFiles({all:!1})];case 1:if((f=d.sent()).error)return _(f.error),x(!1),[2];return[4,S.stageFiles({add:e})];case 2:if((p=d.sent()).error)return _(p.error),x(!1),[2];return[4,S.escapeHatchGitExecWrite("git rebase --continue")];case 3:if(!(h=d.sent()).error)return[3,5];return[4,S.stageFiles({all:!1})];case 4:return d.sent(),_(h.error),x(!1),[3,6];case 5:n(),S.forceRefresh(),d.label=6;case 6:return[2]}})})()}}),(0,o.jsx)(E.Button,{text:"Abort rebase",colorway:"negative",iconLeft:b?(0,o.jsx)(K.default,{}):(0,o.jsx)(ef.default,{}),disabled:k,loading:b,onClick:function(){return(0,c._)(function(){var e;return(0,d._)(this,function(t){switch(t.label){case 0:if(k)return[2];return w(!0),[4,S.escapeHatchGitExecWrite("git rebase --abort")];case 1:return(e=t.sent()).error?(_(e.error),w(!1),(0,g.reportErrorToSentry)({context:"rebasing-view-abort",gitService:S,result:e,data:{branch:R}})):(n(),S.forceRefresh()),[2]}})})()}})]})]})]})}function rZ(){return(0,o.jsxs)(D.View,{children:[(0,o.jsx)(A.Text,{multiline:!1,children:"Unsupported state: you are in the middle of a rebase."}),(0,o.jsx)(A.Text,{multiline:!1,children:"Please finish the rebase manually."})]})}function r0(){return(0,o.jsxs)(D.View,{children:[(0,o.jsx)(A.Text,{multiline:!1,children:"Unsupported state: you are in the middle of a revert."}),(0,o.jsx)(A.Text,{multiline:!1,children:"Please finish the revert manually."})]})}e.s(["default",()=>rJ],674373),e.s(["default",()=>rZ],345008),e.s(["default",()=>r0],569484)},686356,e=>{"use strict";var t=e.i(878420),n=e.i(569384),r=e.i(973245),i=e.i(304277);function o(){var e=(0,n._)(["\n  fragment GitServiceUser on CurrentUser {\n    image\n    username\n    email\n    firstName\n    lastName\n    gitHubInfo {\n      isAppCurrentlyInstalled\n      accessToken\n      userInfo {\n        name\n        username\n        email\n        avatarUrl\n      }\n    }\n    gitHubInfoV2 {\n      accessToken\n      userInfo {\n        name\n        username\n        email\n        avatarUrl\n      }\n    }\n    bitbucketInfo {\n      accessToken\n      userInfo {\n        name\n        username\n        email\n        avatarUrl\n      }\n    }\n    gitLabInfo {\n      accessToken\n      userInfo {\n        name\n        username\n        email\n        avatarUrl\n      }\n    }\n  }\n"]);return o=function(){return e},e}function a(){var e=(0,n._)(["\n  query GitServiceCurrentUser {\n    currentUser {\n      id\n      ...GitServiceUser\n    }\n  }\n  ","\n"]);return a=function(){return e},e}e.i(566901);var s={},l=(0,r.gql)(o()),u=(0,r.gql)(a(),l);function c(e){var n=(0,t._)({},s,e);return i.useQuery(u,n)}e.s(["GitServiceCurrentUserDocument",()=>u,"useGitServiceCurrentUserQuery",()=>c])},836102,e=>{"use strict";var t=e.i(297083),n=e.i(817556),r=e.i(686356),i=e.i(791675),o=e.i(569910),a=e.i(173738),s=e.i(458112);function l(e){switch(e){case i.GitProfileProvider.GITHUB:return"GitHub";case i.GitProfileProvider.BITBUCKET:return"Bitbucket";case i.GitProfileProvider.GITLAB:return"GitLab";case i.GitProfileProvider.REPLIT_DEFAULT:return"Default Profile";default:(0,o.default)(e)}}function u(e){return(0,t._)(function(e){var t,o,l,u,c,d,f,p,h,g,m,x,y,b,w,k,_,S,C,j,T,E,R,I,A,P,D,O,N,M,L,B,V,F,U,G,$,z,H;return(0,n._)(this,function(n){switch(n.label){case 0:return t=e.defaultUsername,o=e.defaultUserId,l=e.onProfiles,x=new Map,[4,null===a.apolloClient||void 0===a.apolloClient?void 0:a.apolloClient.query({query:r.GitServiceCurrentUserDocument,context:{noBatch:!0},fetchPolicy:"network-only"})];case 1:var W,q,K,Y;return _=(k=null!=(w=null==(b=(null!=(y=n.sent())?y:{data:null}).data)?void 0:b.currentUser)?w:{username:t,id:o,firstName:null,lastName:null}).id,S=k.firstName,C=k.lastName,j=k.username,_&&j&&(E=j,S&&(E=S),C&&(E=C),S&&C&&(E=S+" "+C),I={provider:i.GitProfileProvider.REPLIT_DEFAULT,email:"".concat(_,"-").concat(j,"@").concat(s.REPLIT_PRIVACY_EMAIL_DOMAIN),name:E,username:j,avatar:null!=(R=null==b||null==(T=b.currentUser)?void 0:T.image)?R:null},x.set(I.provider,I)),(P=null!=(A=null==b||null==(c=b.currentUser)||null==(u=c.gitHubInfoV2)?void 0:u.userInfo)?A:null==b||null==(f=b.currentUser)||null==(d=f.gitHubInfo)?void 0:d.userInfo)&&P.email&&P.username&&((null==b||null==(q=b.currentUser)||null==(W=q.gitHubInfoV2)?void 0:W.accessToken)||(null==b||null==(Y=b.currentUser)||null==(K=Y.gitHubInfo)?void 0:K.isAppCurrentlyInstalled))&&(L={provider:i.GitProfileProvider.GITHUB,email:P.email,name:null!=(N=P.name)?N:P.username,username:P.username,avatar:null!=(M=P.avatarUrl)?M:null,isSourceOpenInt:!!(null==b||null==(O=b.currentUser)||null==(D=O.gitHubInfoV2)?void 0:D.accessToken)},x.set(L.provider,L)),(B=null==b||null==(h=b.currentUser)||null==(p=h.bitbucketInfo)?void 0:p.userInfo)&&B.email&&B.username&&(U={provider:i.GitProfileProvider.BITBUCKET,email:B.email,name:null!=(V=B.name)?V:B.username,username:B.username,avatar:null!=(F=B.avatarUrl)?F:null,isSourceOpenInt:!0},x.set(U.provider,U)),(G=null==b||null==(m=b.currentUser)||null==(g=m.gitLabInfo)?void 0:g.userInfo)&&G.email&&G.username&&(H={provider:i.GitProfileProvider.GITLAB,email:G.email,name:null!=($=G.name)?$:G.username,username:G.username,avatar:null!=(z=G.avatarUrl)?z:null,isSourceOpenInt:!0},x.set(H.provider,H)),l(x),[2]}})}).apply(this,arguments)}e.s(["default",()=>u,"providerEnumToDisplayName",()=>l])},254837,e=>{e.v({"connection-section-glow":"ProviderConnectionSection-module__5MNnsG__connection-section-glow",connectionItem:"ProviderConnectionSection-module__5MNnsG__connectionItem",sectionContainer:"ProviderConnectionSection-module__5MNnsG__sectionContainer",sectionHeader:"ProviderConnectionSection-module__5MNnsG__sectionHeader",sectionHeaderCollapsed:"ProviderConnectionSection-module__5MNnsG__sectionHeaderCollapsed",sectionHeaderExpanded:"ProviderConnectionSection-module__5MNnsG__sectionHeaderExpanded"})},221721,883117,627254,548747,372014,919449,81621,33297,e=>{"use strict";var t,n=e.i(276385),r=e.i(960933),i=e.i(862927),o=e.i(297083),a=e.i(530658),s=e.i(817556),l=e.i(389959),u=e.i(541793),c=e.i(507491),d=e.i(167193),f=e.i(10581),p=e.i(569910),h=e.i(993796),g=e.i(98816),m=e.i(597865),x=e.i(529810),y=e.i(137804),b=e.i(691490),w=e.i(730792),k=e.i(944520),_=e.i(138290),S=e.i(520739),C=e.i(526962),j=e.i(191967),T=e.i(825711),E=e.i(952e3),R=e.i(680011),I=e.i(772275),A=e.i(540285),P=e.i(710106),D=e.i(973267),O=e.i(35647),N=e.i(166963),M=e.i(737553),L=e.i(674373),B=e.i(345008),V=e.i(569484),F=e.i(791675),U=e.i(399528),G=e.i(441329),$=e.i(836102),z=e.i(39838),H=e.i(714165),W=e.i(960178),q=e.i(625484);function K(e){var t=e.username,r=e.avatar,i=e.fullName;return(0,n.jsxs)(q.View,{row:!0,gap:8,align:"center",children:[(0,n.jsx)(H.Avatar,{src:null!=r?r:null,username:t,fullName:i}),(0,n.jsx)(W.Text,{variant:"subheadDefault",multiline:!1,children:t})]})}var Y=e.i(480028),Q=e.i(446530),X=e.i(754873),J=e.i(613355),Z=e.i(91720),ee=e.i(734882),et=e.i(243914),en=(0,Q.cssRecord)({list:{"> div:first-child":J.rcss.borderRadius(8,8,0,0),"> div:last-child":[J.rcss.borderRadius(0,0,8,8),{border:"none"}]},profile:[X.interactive.filled,J.rcss.flex.row,J.rcss.justify.spaceBetween,J.rcss.p(12),J.rcss.borderRadius(0),J.rcss.border({color:Y.tokens.outlineDefault,direction:"bottom"})],email:[J.rcss.flex.shrink(1)],connectToGithubContainer:[J.rcss.backgroundColor.backgroundHigher],notConnectedText:[J.rcss.pb(4)],settingsButton:{background:"transparent",border:"none","&:hover":{textDecoration:"underline"}},radio:{pointerEvents:"none"}});function er(e){var t=e.profiles,r=e.current,i=e.showConnectToGithub,o=e.onSelectProvider,a=(0,U.useRouter)(),s=(0,G.isInBonsaiWebview)(a),u=(0,l.useId)(),c=(0,h.useFlag)({controlName:"flag-github-connection-migration",default:!1});return(0,n.jsxs)(ee.RadioGroup,{name:u,css:en.list,value:null!=r?r:"",children:[t.map(function(e){if(c&&e.provider===F.GitProfileProvider.GITHUB&&!e.isSourceOpenInt)return null;var t=(0,$.providerEnumToDisplayName)(e.provider),i=void 0;return e.provider!==F.GitProfileProvider.GITHUB||c?e.provider!==F.GitProfileProvider.REPLIT_DEFAULT&&(i="/integrations"):i=s?"/mobile/auth/github/app_permissions":"/auth/github/app_permissions?close=1",(0,n.jsx)(ei,{profile:e,providerName:t,current:e.provider===r,onSelectProvider:o,settingsURL:i},e.provider)}),i?(0,n.jsxs)(q.View,{css:en.connectToGithubContainer,p:12,gap:4,children:[(0,n.jsx)(q.View,{row:!0,gap:4,align:"center",children:(0,n.jsx)(K,{username:"GitHub Account",fullName:"GitHub Account"})}),(0,n.jsx)(W.Text,{color:"dimmest",css:en.notConnectedText,multiline:!1,children:"Your GitHub account is not connected."}),(0,n.jsx)(z.default,{})]}):null]})}function ei(e){var t=e.profile,r=e.current,i=e.providerName,o=e.settingsURL,a=e.onSelectProvider,s=t.provider,u=t.name,c=t.username,d=t.email,f=t.avatar,p=(0,l.useId)();return(0,n.jsxs)(q.View,{onClick:function(){return a(s)},css:en.profile,children:[(0,n.jsxs)(q.View,{shrink:!0,gap:4,children:[(0,n.jsxs)(q.View,{row:!0,gap:8,align:"center",children:[(0,n.jsx)(K,{username:c,avatar:f,fullName:u}),o?(0,n.jsx)(Z.ButtonLink,{css:en.settingsButton,text:"".concat(i," Settings"),iconRight:(0,n.jsx)(et.default,{}),href:o,target:"_blank",variant:"outlined",size:"small"}):(0,n.jsx)(W.Text,{color:"dimmest",variant:"small",multiline:!1,children:i})]}),(0,n.jsxs)(W.Text,{color:"dimmest",css:en.email,multiline:!1,children:[u," <",d,">"]})]}),(0,n.jsx)(ee.Radio,{css:en.radio,id:p,checked:r,value:s})]})}var eo=(0,Q.cssRecord)({profileContainer:[J.rcss.flex.column]});function ea(){var e=(0,x.default)().git,t=(0,m.default)(function(e){return(0,o._)(function(){var t,n,r;return(0,s._)(this,function(i){return t=e.getCurrentProfile(),n=e.getProfiles(),[2,{profiles:n,current:null!=(r=null==t?void 0:t.provider)?r:null,hasGitHub:e.hasProfile(F.GitProfileProvider.GITHUB),error:null}]})})()}),r=(0,h.useFlag)({controlName:"flag-github-connection-migration",default:!1});if(!t)return null;if(null!==t.error)return(0,_.reportErrorToSentry)({context:"git-profiles",gitService:e,result:{error:t.error}}),null;var i=t.profiles,a=t.current,l=t.hasGitHub;return(0,n.jsx)(q.View,{css:eo.profileContainer,children:(0,n.jsx)(er,{profiles:i,current:a,showConnectToGithub:!r&&!l,onSelectProvider:function(t){e.setCurrentProfile(t),t===F.GitProfileProvider.REPLIT_DEFAULT?(0,S.trackGitPaneEvent)("profile-changed",{profile:"replit"}):t===F.GitProfileProvider.GITHUB?(0,S.trackGitPaneEvent)("profile-changed",{profile:"github"}):t===F.GitProfileProvider.BITBUCKET&&(0,S.trackGitPaneEvent)("profile-changed",{profile:"bitbucket"})}})})}var es=e.i(36397),el=e.i(636680),eu=e.i(140487),ec=e.i(739521);function ed(e){var t=e.remoteName,r=e.updateRemote,i=(0,a._)((0,l.useState)(!1),2),o=i[0],s=i[1],u=(0,es.default)();return(0,n.jsxs)(n.Fragment,{children:[u?(0,n.jsx)(eu.Button,{text:"Create Remote",onClick:function(){return s(!0)},variant:"outlined",disabled:!u}):null,(0,n.jsx)(ec.Modal,{isOpen:o,onRequestClose:function(){return s(!1)},children:(0,n.jsx)(el.default,{remoteName:t,updateRemote:r,onCreateSuccess:function(){return s(!1)}})})]})}var ef=e.i(917063),ep=e.i(882793),eh=e.i(163355),eg=e.i(142685),em=e.i(921521),ev=e.i(191060),ex=e.i(242816),ey=e.i(988676),eb=e.i(211397),ew=e.i(576073),ek=e.i(462783),e_=e.i(283660),eS=e.i(523579),eC=e.i(940745),ej=e.i(488014),eT=e.i(254837),eE=[],eR=[];function eI(e){var t,r,i,u,c,d,f,p=e.expanded,g=e.onClick,m=e.shouldAnimateOnMount,y=void 0!==m&&m,b=e.connectorData,w=e.connectorLoading,k=void 0!==w&&w,_=e.connectorRefetch,S=(0,h.useFlag)({controlName:"flag-github-connection-migration",default:!1}),C=(0,h.useFlag)({controlName:"flag-source-control-integrations",default:!1}),j=(0,h.useFlag)({controlName:"flag-killswitch-gitlab",default:!1}),T=(0,em.default)(),E=(0,ex.default)(),R=(0,a._)((0,l.useState)(!1),2),I=R[0],A=R[1],P=(0,a._)((0,l.useState)(null),2),D=P[0],O=P[1],N=(0,l.useRef)(null);(0,l.useEffect)(function(){if(y&&N.current){var e=N.current;e.style.setProperty("animation","".concat(eT.default["connection-section-glow"]," 1.5s")),e.addEventListener("animationend",function(){return e.style.removeProperty("animation")},{once:!0})}},[y]);var M=(0,a._)((0,l.useState)(!1),2),L=M[0],B=M[1],V=(0,a._)((0,l.useState)(null),2),U=V[0],G=V[1],$=(0,eh.usePersonalConnectorMutations)({refetch:null!=_?_:function(){}}),z=$.handleEvent,H=$.handleDelete,K=(0,x.default)().git,Y=(0,ev.useAuthGithub)({onAuth:function(){A(!1),K.refreshProfiles({preferredProvider:F.GitProfileProvider.GITHUB}),null==_||_()},onClose:function(){return A(!1)}}),Q=(null==b||null==(t=b.currentUser)?void 0:t.__typename)==="CurrentUser"&&(null==b||null==(i=b.currentUser)||null==(r=i.connectorContext)?void 0:r.__typename)==="CurrentUserConnectorContext"?null==b||null==(u=b.currentUser)?void 0:u.connectorContext:null,X=null!=(c=null==Q?void 0:Q.openIntClientToken)?c:null,J=null!=(d=null==Q?void 0:Q.connections)?d:eE,Z=null!=(f=null==Q?void 0:Q.connectorConfigs)?f:eR,ee=(0,l.useMemo)(function(){var e=[],t=J.filter(function(e){return ep.VERSION_CONTROL_CONNECTORS.has(e.connectorName)}),n=new Set(t.map(function(e){return e.connectorName})),r=Z.filter(function(e){return e.connectorName&&ep.VERSION_CONTROL_CONNECTORS.has(e.connectorName)&&!n.has(e.connectorName)});return t.forEach(function(t){var n,r,i,o=(0,ep.isAppScopedConnector)(t.connectorName)?"appConnection":"accountConnection",a=j&&"GITLAB_SOURCE_CONTROL"===t.connectorName;e.push({id:t.connectionId,displayName:t.displayName,iconPath:t.iconPath,connectorName:t.connectorName,connectorType:o,type:t.type,status:a?"maintenance":null!=(n=t.status)?n:"",repls:null!=(r=t.repls)?r:[],description:null!=(i=ep.CONNECTOR_DESCRIPTIONS[t.connectorName])?i:""})}),r.forEach(function(t){var n,r,i=j&&"GITLAB_SOURCE_CONTROL"===t.connectorName;e.push({id:t.id,displayName:null!=(n=t.displayName)?n:"",iconPath:t.iconPath,connectorName:null!=(r=t.connectorName)?r:"",connectorType:"availableConnector",type:t.type,status:i?"maintenance":"",repls:[],description:t.connectorName?ep.CONNECTOR_DESCRIPTIONS[t.connectorName]:""})}),e},[J,Z,j]),et=(0,l.useMemo)(function(){var e={id:"github-hardcoded",displayName:"GitHub",iconPath:null,connectorName:"GITHUB",connectorType:E?"accountConnection":"availableConnector",type:"oauth2",status:E?"healthy":"disconnected",repls:[],description:ep.CONNECTOR_DESCRIPTIONS.GITHUB};if(C)return ee;if(S){var t=ee.find(function(e){return"GITHUB"===e.connectorName});if(t)return[t]}return[e]},[E,ee,S,C]),en=function(){T?eg.desktopAppApi.openExternalUrl("/account#connected-services"):(A(!0),Y())},er=function(e){var t=e.item.status;return"maintenance"===t?(0,n.jsxs)(q.View,{row:!0,align:"center",gap:4,children:[(0,n.jsx)(e_.default,{size:8,color:"orange"}),(0,n.jsx)(W.Text,{variant:"small",color:"dimmer",children:"Under maintenance"})]}):(0,n.jsxs)(q.View,{row:!0,align:"center",gap:4,children:[(0,n.jsx)(e_.default,{size:8,color:"healthy"===t?"green":"grey"}),(0,n.jsx)(W.Text,{variant:"small",color:"dimmer",children:"healthy"===t?"Active":"Disconnected"})]})},ei=function(e){var t=e.item;if(j&&"GITLAB_SOURCE_CONTROL"===t.connectorName)return(0,n.jsx)(eu.Button,{variant:"default",text:"Unavailable",size:"small",disabled:!0});if("accountConnection"===t.connectorType||"appConnection"===t.connectorType)return"GITHUB"===t.connectorName?(0,n.jsx)(eu.Button,{variant:"default",text:"Manage",size:"small",onClick:function(){T?eg.desktopAppApi.openExternalUrl("/account#connected-services"):window.location.href="/account#connected-services"}}):(0,n.jsx)(eu.Button,{variant:"outlined",size:"small",colorway:"negative",text:"Delete",onClick:function(){O(t)}});if("GITHUB"===t.connectorName){var r="Sign in";return T?r="Visit account page":I&&(r="Connecting..."),(0,n.jsx)(eu.Button,{iconLeft:I?(0,n.jsx)(eC.default,{}):(0,n.jsx)(ej.default,{}),variant:"outlined",colorway:"primary",size:"small",text:r,loading:I,onClick:en})}return(0,n.jsx)(eu.Button,{iconLeft:(0,n.jsx)(ej.default,{}),variant:"outlined",colorway:"primary",size:"small",text:"Sign in",onClick:function(){G(t.connectorName),B(!0)}})};return(0,n.jsxs)(q.View,{clsx:eT.default.sectionContainer,innerRef:N,children:[(0,n.jsxs)(q.View,{row:!0,justify:"space-between",align:"center",p:8,clsx:[eT.default.sectionHeader,p?eT.default.sectionHeaderExpanded:eT.default.sectionHeaderCollapsed],onClick:g,children:[(0,n.jsx)(q.View,{grow:!0,shrink:!0,children:(0,n.jsx)(W.Text,{variant:"subheadDefault",multiline:!1,children:"Connections"})}),k?(0,n.jsx)(eC.default,{}):p?(0,n.jsx)(ek.default,{}):(0,n.jsx)(ew.default,{})]}),(0,n.jsx)(ey.DividerH,{}),p&&!k?(0,n.jsxs)(q.View,{p:8,children:[et.map(function(e){return(0,n.jsxs)(q.View,{row:!0,grow:!0,clsx:eT.default.connectionItem,children:[(0,n.jsxs)(q.View,{gap:8,row:!0,align:"center",children:["GITHUB"===e.connectorName?(0,n.jsx)(eS.default,{size:24,style:{padding:3}}):null,"GITHUB"!==e.connectorName&&e.iconPath?(0,n.jsx)(eb.default,{width:24,height:24,src:e.iconPath,alt:e.displayName}):null,(0,n.jsx)(W.Text,{children:e.displayName}),(0,n.jsx)(er,{item:e})]}),(0,n.jsx)(q.View,{row:!0,justify:"end",children:(0,n.jsx)(ei,{item:e})})]},e.id)}),(0,n.jsx)(ef.AddIntegrationModal,{isOpen:L,setIsOpen:function(e){return B(e)},token:null!=X?X:"",selectedConnector:null!=U?U:void 0,onEvent:function(e){return(0,o._)(function(){var t;return(0,s._)(this,function(n){switch(n.label){case 0:return[4,z(e)];case 1:if(n.sent(),!U)return[3,6];if(!(t=function(e){if(!ep.VERSION_CONTROL_CONNECTORS.has(e))return null;switch(e){case"GITHUB_SOURCE_CONTROL":return F.GitProfileProvider.GITHUB;case"BITBUCKET_SOURCE_CONTROL":return F.GitProfileProvider.BITBUCKET;case"GITLAB_SOURCE_CONTROL":return F.GitProfileProvider.GITLAB;default:return null}}(U)))return[3,3];return[4,K.refreshProfiles({preferredProvider:t})];case 2:return n.sent(),[3,5];case 3:return[4,K.refreshProfiles({})];case 4:n.sent(),n.label=5;case 5:return[3,8];case 6:return[4,K.refreshProfiles({})];case 7:n.sent(),n.label=8;case 8:return[2]}})})()}}),(0,n.jsx)(ef.DeleteIntegrationModal,{isOpen:!!D,setIsOpen:function(){return O(null)},onDelete:function(){return(0,o._)(function(){return(0,s._)(this,function(e){switch(e.label){case 0:if(!D)return[3,3];return[4,H(D.id)];case 1:return e.sent(),[4,K.refreshProfiles({})];case 2:e.sent(),O(null),e.label=3;case 3:return[2]}})})()},connectorDisplayName:null==D?void 0:D.displayName})]}):null]})}var eA=e.i(368085),eP=e.i(352758),eD="origin";function eO(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.shouldAnimateConnections,r=e.connectorData,i=e.connectorLoading,l=e.connectorRefetch,u=(0,m.default)(function(e){return(0,o._)(function(){var t,n,r,i;return(0,s._)(this,function(o){switch(o.label){case 0:return[4,e.getRemotes()];case 1:if((t=o.sent()).error)return(0,_.reportErrorToSentry)({context:"remote-config",gitService:e,result:t}),[2,{url:void 0,name:eD,error:t.error}];if(!(r=(0,a._)(null!=(n=t.remotes.values())?n:void 0,1)[0]))return[2,{url:void 0,name:eD,error:null}];return[2,{url:r.push||r.fetch,name:null!=(i=r.name)?i:eD,error:null}]}})})()});return null==u?(0,n.jsxs)(q.View,{css:J.rcss.center,children:[(0,n.jsx)(W.Text,{color:"dimmest",multiline:!1,children:"Loading remote information."}),(0,n.jsx)(N.default,{})]}):(null==u?void 0:u.error)?null:(0,n.jsx)(eN,{initialRemoteUrl:null==u?void 0:u.url,remoteName:null==u?void 0:u.name,shouldAnimateConnections:void 0!==t&&t,connectorData:r,connectorLoading:i,connectorRefetch:l})}function eN(e){var t=e.initialRemoteUrl,r=e.remoteName,i=e.shouldAnimateConnections,o=void 0!==i&&i,s=e.connectorData,u=e.connectorLoading,c=e.connectorRefetch,d=(0,a._)((0,l.useState)(t),2),f=d[0],p=d[1],h=function(e){p(e)},g=(0,a._)((0,l.useState)(!0),2),m=g[0],x=g[1];return(0,l.useEffect)(function(){o&&x(!0)},[o]),(0,n.jsxs)(q.View,{children:[(0,n.jsx)(W.Text,{variant:"subheadDefault",multiline:!1,children:"Remote"}),(0,n.jsx)(eP.default,{height:1}),(0,n.jsxs)(q.View,{row:!0,justify:"space-between",gap:4,children:[(0,n.jsx)(eA.default,{remoteName:r,initialRemoteUrl:f,updateRemote:h}),(0,n.jsx)(ed,{remoteName:r,updateRemote:h})]}),s?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(eP.default,{height:2}),(0,n.jsx)(eI,{expanded:m,onClick:function(){return x(!m)},shouldAnimateOnMount:o,connectorData:s,connectorLoading:u,connectorRefetch:c})]}):null]})}(t={})[t.GitHub=0]="GitHub",t[t.Bitbucket=1]="Bitbucket";var eM=(0,e.i(967629).css)(J.rcss.px(16));function eL(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.shouldAnimateConnections,r=e.connectorData,i=e.connectorLoading,o=e.connectorRefetch;return(0,h.useFlag)({controlName:"flag-github-connection-migration"})?(0,n.jsx)(eB,{shouldAnimateConnections:void 0!==t&&t,connectorData:r,connectorLoading:i,connectorRefetch:o}):(0,n.jsxs)(q.View,{css:eM,children:[(0,n.jsx)(eP.default,{height:2}),(0,n.jsx)(eO,{}),(0,n.jsx)(eP.default,{height:2}),(0,n.jsx)(eV,{})]})}function eB(e){var t=e.shouldAnimateConnections,r=e.connectorData,i=e.connectorLoading,o=e.connectorRefetch;return(0,n.jsxs)(q.View,{css:eM,children:[(0,n.jsx)(eP.default,{height:2}),(0,n.jsx)(eO,{shouldAnimateConnections:void 0!==t&&t,connectorData:r,connectorLoading:i,connectorRefetch:o}),(0,n.jsx)(eP.default,{height:2}),(0,n.jsx)(eV,{})]})}function eV(){return(0,n.jsxs)(q.View,{children:[(0,n.jsx)(W.Text,{variant:"subheadDefault",multiline:!1,children:"Commit author"}),(0,n.jsx)(eP.default,{height:1}),(0,n.jsx)(ea,{})]})}function eF(){return(0,n.jsx)(q.View,{children:(0,n.jsx)(W.Text,{multiline:!0,children:"Something went wrong. Please refresh the page and try again."})})}var eU=e.i(25358),eG=e.i(688216),e$=e.i(396776),ez=e.i(42458),eH=(0,Q.cssRecord)({fakePaneHeader:[J.rcss.backgroundColor.backgroundDefault,J.rcss.align.center,{borderBottom:"1px solid ".concat(Y.tokens.outlineDimmer)}]});function eW(e){var t=e.onFileClick,r=e.status;return(0,n.jsxs)(q.View,{children:[(0,n.jsx)(eq,{}),(0,n.jsxs)(q.View,{p:8,pt:16,gap:16,children:[(0,n.jsx)(e$.StatusBanner,{colorway:"orange",icon:(0,n.jsx)(ez.default,{}),text:"Your current branch doesn't have any commits. You need to make an initial commit before continuing."}),(0,n.jsxs)(q.View,{css:E.styles.section,children:[(0,n.jsx)(q.View,{css:E.styles.reviewChangesHeader,children:(0,n.jsx)(W.Text,{css:E.styles.headerText,multiline:!1,children:"Commit"})}),(0,n.jsx)(eU.default,{status:r,onStagedFileClick:t,defaultMessage:"Initial commit"})]})]})]})}function eq(){var e=(0,w.useNotifyGitError)(),t=(0,m.default)(function(t){return(0,o._)(function(){var n;return(0,s._)(this,function(r){switch(r.label){case 0:return[4,t.status()];case 1:return(n=r.sent()).error&&((0,_.reportErrorToSentry)({context:"unborn-branch-view-status",gitService:t,result:n}),e(n.error)),[2,n]}})})()},[e]);return(null==t?void 0:t.error)?null:(0,n.jsx)(q.View,{css:eH.fakePaneHeader,px:8,py:4,row:!0,gap:8,children:(null==t?void 0:t.branch)?(0,n.jsx)(eG.BranchName,{name:t.branch,current:!0,heading:!0}):null})}var eK=e.i(712516);e.i(282890);var eY=e.i(66718),eQ=(0,Q.cssRecord)({gitPane:[J.rcss.position.relative,J.rcss.display.flex,J.rcss.minHeight("100%")],gitPaneContent:[J.rcss.overflow("auto")]});function eX(e){var t=e.isActive,r=e.performPaneOperation,i=e.mode,u=void 0===i?{type:C.GitPaneModeType.CURRENT_BRANCH}:i,p=(0,l.useRef)(),x=(0,l.useCallback)(function(e){r({operation:"replace",pane:{type:"git",data:{mode:e}}})},[r]),y=(0,a._)((0,l.useState)(!1),2),b=y[0],j=y[1],T=(0,a._)((0,l.useState)(!1),2),E=T[0],R=T[1];(0,l.useEffect)(function(){u.type!==C.GitPaneModeType.SETTINGS&&E&&R(!1)},[u.type,E]);var I=(0,h.useFlag)({controlName:"flag-github-connection-migration"}),A=(0,c.useUserConnectorsPageQuery)({ssr:!1,skip:!I}),D=A.data,O=A.loading,M=A.refetch;e1(void 0!==t&&t);var L=(0,m.default)(function(e){return(0,o._)(function(){var t,n,r,i,o,a,l,u,c,d;return(0,s._)(this,function(s){switch(s.label){case 0:return[4,e.getRepositoryState()];case 1:if((t=s.sent()).error)return[2,t];if(n=t.state,r=t.type,i=null,o=null,a=null,r===f.GitRepositoryStateType.INITIALIZING)return[3,6];return[4,e.status()];case 2:if((l=s.sent()).error)return(0,_.reportErrorToSentry)({context:"git-pane-status",gitService:e,result:l,data:{state:n,type:r}}),[2,l];return i=l,[4,e.getRemotes()];case 3:if((u=s.sent()).error)return(0,_.reportErrorToSentry)({context:"git-pane-remotes",gitService:e,result:u,data:{state:n,type:r}}),[2,u];if(o=u.remotes,!i.branch)return[3,5];return[4,e.getBranch(i.branch)];case 4:if((c=s.sent()).error)return(0,_.reportErrorToSentry)({context:"git-pane-branch",gitService:e,result:c,data:{state:n,type:r}}),[2,c];a=c.branch,s.label=5;case 5:return[3,8];case 6:return[4,e.status()];case 7:if((d=s.sent()).error)return(0,_.reportErrorToSentry)({context:"git-pane-status-initializing",gitService:e,result:d,data:{state:n,type:r}}),[2,{state:n,type:r,status:i,remotes:o,currentBranch:a,error:null}];i=d,s.label=8;case 8:return[2,{state:n,type:r,status:i,remotes:o,currentBranch:a,error:null}]}})})()}),B=!L||L.error?null:L.currentBranch,V=(0,l.useCallback)(function(e){switch(x(e),e.type){case C.GitPaneModeType.DASHBOARD:(0,S.trackGitPaneEvent)("pane-mode-changed",{mode:"dashboard"});break;case C.GitPaneModeType.BRANCH:(0,S.trackGitPaneEvent)("pane-mode-changed",{mode:"branch"});break;case C.GitPaneModeType.CURRENT_BRANCH:(0,S.trackGitPaneEvent)("pane-mode-changed",{mode:"current-branch"});break;case C.GitPaneModeType.SETTINGS:(0,S.trackGitPaneEvent)("pane-mode-changed",{mode:"settings"})}},[x]),F=(0,l.useCallback)(function(){p.current?(V(p.current),p.current=void 0):V({type:C.GitPaneModeType.CURRENT_BRANCH})},[V]),U=(0,g.default)(u),G=(0,l.useCallback)(function(e){var t=function(e){p.current=U.current,V(e)};switch(e.type){case C.GitPaneModeType.DASHBOARD:t(e);break;case C.GitPaneModeType.BRANCH:if((0,d.branchesEqual)(e.branch,B)){t({type:C.GitPaneModeType.CURRENT_BRANCH});break}t(e);break;case C.GitPaneModeType.CURRENT_BRANCH:case C.GitPaneModeType.SETTINGS:case C.GitPaneModeType.COMMIT:t(e)}},[V,B,U]),$=(0,l.useCallback)(function(e){var t=e.path,n=e.type,i=(0,eY.getPaneTypeForFile)({path:t});"codeEditor"!==i?r({operation:"open",pane:{type:i,data:{path:t}},secondary:!0}):"conflict"===(void 0===n?"change":n)?r({operation:"open",pane:{type:"codeEditor",data:{path:t}},secondary:!0}):r({operation:"open",pane:{type:"diff",data:{left:{path:t,data:{type:"git",revision:"HEAD"}},right:{path:t,data:{type:"fs"}}}},secondary:!0})},[r]),z=(0,l.useCallback)(function(e){G({type:C.GitPaneModeType.COMMIT,hash:e})},[G]),H=(0,l.useCallback)(function(){j(!0)},[]);u.type===C.GitPaneModeType.BRANCH&&(0,d.branchesEqual)(u.branch,B)&&V({type:C.GitPaneModeType.CURRENT_BRANCH}),(0,l.useEffect)(function(){return j(!1)},[L]);var W=function(){if(b||!L||L.error)return(0,n.jsx)(eJ,{children:(null==L?void 0:L.error)?(0,n.jsx)(eK.default,{pane:{type:"git"},headerText:"Git pane is unavailable.",bodyText:(0,n.jsxs)(n.Fragment,{children:["Something went wrong. Error: ",(0,n.jsx)("code",{children:L.error})]}),asciiArt:"Computer"}):(0,n.jsx)(N.default,{})});switch(L.type){case f.GitRepositoryStateType.INITIALIZING:case f.GitRepositoryStateType.INTERMEDIATE:case f.GitRepositoryStateType.DETACHED_HEAD:return(0,n.jsx)(eJ,{children:(0,n.jsx)(eZ,{state:L.state,status:L.status,onFileClick:$,gotoPendingState:H})});case f.GitRepositoryStateType.NORMAL:if(u.type===C.GitPaneModeType.BRANCH&&!u.branch||u.type===C.GitPaneModeType.CURRENT_BRANCH&&!B)return(0,n.jsx)(eJ,{header:(0,n.jsx)(k.default,{mode:C.GitPaneModeType.DASHBOARD,branch:null,switchMode:G,onBack:F}),children:(0,n.jsx)(P.default,{currentBranch:null,switchMode:G})});var e=null;return u.type===C.GitPaneModeType.CURRENT_BRANCH?e=B:u.type===C.GitPaneModeType.BRANCH&&(e=u.branch),(0,n.jsx)(eJ,{header:(0,n.jsx)(k.default,{mode:u.type,branch:e,switchMode:G,onBack:F}),children:(0,n.jsx)(w.GitPaneModeSwitcherContext.Provider,{value:function(e){e.type===C.GitPaneModeType.SETTINGS&&(R(!0),setTimeout(function(){R(!1)},1600)),G(e)},children:(0,n.jsx)(e0,{performPaneOperation:r,mode:u,status:L.status,remotes:L.remotes,currentBranch:B,switchMode:G,onStagedFileClick:$,onViewCommitClick:z,gotoPendingState:H,shouldAnimateConnections:E,connectorData:D,connectorLoading:O,connectorRefetch:M})})})}}();return(0,n.jsx)(w.GitPaneModeSwitcherContext.Provider,{value:G,children:W})}function eJ(e){var t=e.header,r=e.children,i=(0,a._)((0,l.useState)(function(){return(0,u.createStore)()}),1)[0];return(0,n.jsx)(w.GitPaneErrorContext.Provider,{value:i,children:(0,n.jsxs)(q.View,{css:eQ.gitPane,children:[(0,n.jsx)(b.default,{}),t,(0,n.jsx)(q.View,{css:eQ.gitPaneContent,grow:!0,shrink:!0,children:r})]})})}function eZ(e){var t=e.state,r=e.status,i=e.onFileClick,o=e.gotoPendingState,a=(0,h.useFlag)({controlName:"flag-new-rebase-editor",logFlagToAnalytics:!1,default:!1});switch(t){case f.GitRepositoryState.NOT_INITIALIZED:return(0,n.jsx)(eK.default,{pane:{type:"git"},action:(0,n.jsx)(y.default,{})});case f.GitRepositoryState.ON_UNBORN_BRANCH:return(0,n.jsx)(eW,{onFileClick:i,status:r});case f.GitRepositoryState.MERGING:return(0,n.jsx)(M.default,{onFileClick:i,gotoPendingState:o});case f.GitRepositoryState.REBASING:return a?(0,n.jsx)(L.default,{gotoPendingState:o,onFileClick:i}):(0,n.jsx)(B.default,{});case f.GitRepositoryState.REVERTING:return(0,n.jsx)(V.default,{});case f.GitRepositoryState.CHERRY_PICKING:return(0,n.jsx)(R.default,{});case f.GitRepositoryState.APPLYING_MAILBOX:return(0,n.jsx)(j.default,{});case f.GitRepositoryState.BISECTING:return(0,n.jsx)(T.default,{});case f.GitRepositoryState.DETACHED_HEAD:return(0,n.jsx)(D.default,{});case f.GitRepositoryState.INDEX_LOCKED:return(0,n.jsx)(O.default,{});case f.GitRepositoryState.CONFIG_LOCKED:return(0,n.jsx)(A.default,{});case f.GitRepositoryState.CLEAN:case f.GitRepositoryState.DIRTY_INDEX:case f.GitRepositoryState.DIRTY_WORKTREE:case f.GitRepositoryState.HEAD_MISSING:case f.GitRepositoryState.TREE_CORRUPTED:return(0,n.jsx)(eF,{});default:(0,p.default)(t)}}function e0(e){var t=e.mode,r=e.status,i=e.remotes,o=e.currentBranch,a=e.switchMode,s=e.onStagedFileClick,l=e.onViewCommitClick,u=e.gotoPendingState,c=e.performPaneOperation,d=e.shouldAnimateConnections,f=e.connectorData,h=e.connectorLoading,g=e.connectorRefetch;switch(t.type){case C.GitPaneModeType.DASHBOARD:return(0,n.jsx)(P.default,{currentBranch:o,switchMode:a});case C.GitPaneModeType.BRANCH:return(0,n.jsx)(E.default,{performPaneOperation:c,status:r,branch:t.branch,remotes:i,onStagedFileClick:s,onViewCommitClick:l,gotoPendingState:u});case C.GitPaneModeType.CURRENT_BRANCH:return(0,n.jsx)(E.default,{performPaneOperation:c,status:r,remotes:i,branch:o,onStagedFileClick:s,onViewCommitClick:l,gotoPendingState:u,current:!0});case C.GitPaneModeType.SETTINGS:return(0,n.jsx)(eL,{shouldAnimateConnections:d,connectorData:f,connectorLoading:h,connectorRefetch:g});case C.GitPaneModeType.COMMIT:return(0,n.jsx)(I.default,{status:r,remotes:i,onViewCommitClick:l,hash:t.hash,switchMode:a});default:(0,p.default)(t)}}function e1(e){var t=(0,x.default)().git;(0,l.useEffect)(function(){e&&setTimeout(function(){t.forceRefresh()},100)},[e,t])}e.s(["default",()=>eX,"useGitRefreshWhenIsActive",()=>e1],883117);var e2=e.i(716636),e3=e.i(450565),e4=e.i(606867),e8=r.Type.Object({type:r.Type.Literal("git"),data:r.Type.Optional(r.Type.Object({mode:C.GitPaneModeSchema}))}),e5={Content:function(e){var t,r=e.options,i=r.isActive,o=r.performPaneOperation,a=e.pane;return(0,n.jsx)(eX,{isActive:i,performPaneOperation:o,mode:null==(t=a.data)?void 0:t.mode})},Icon:function(e){var t=e.size;return(0,n.jsx)(e4.IconContext.Provider,{value:{color:Y.tokens.greenStrongest,size:t},children:(0,n.jsx)(e3.default,{})})},getTitle:function(){return"Git"},description:"Version control for your App",category:e2.PaneCategory.WorkspaceFeatures,decode:function(e){return i.Value.Decode(e8,e)}};e.s(["gitUI",()=>e5],221721);var e6=e.i(878420),e9=e.i(709485),e7=e.i(858248),te=e.i(37292),tt=e.i(181227);function tn(){var e=(0,te.useThrowBsod)();return(0,l.useCallback)(function(t,n,r){e({origin:"History2: useHistoryBSOD",error:t,tags:{source:"ws-history2",type:n},extras:(0,e6._)({state:tt.historyStateDebug.current()},r)})},[e])}function tr(e){(0,e7.track)(e9.events.HISTORY_USED,{action:e,which:"ws"})}function ti(e){var t=e.onClose;return(0,n.jsx)(eu.Button,{text:"Cancel",onClick:function(){tr("historyExplicitlyClosed"),t()}})}e.s(["historyEvent",()=>tr,"useHistoryBSOD",()=>tn],627254),e.s(["default",()=>ti],548747);var to=e.i(112767);function ta(){var e,t="/replEnvironmentMobile"===(0,U.useRouter)().pathname,r=(0,tt.useHistoryState)(),i=(0,tt.useSetHistoryState)(),o=!r||0===r.count;return(0,n.jsx)(to.Switch,{isDisabled:o,onChange:function(e){return i({comparing:e})},isSelected:null!=(e=null==r?void 0:r.comparing)&&e,children:t?"Compare":"Compare Latest"})}e.s(["default",()=>ta],372014);var ts=e.i(257811);function tl(){var e=(0,tt.useHistoryState)();if(!e||0===e.count)return null;var t=e.changes[e.version].timestamp;return(0,n.jsx)(ts.Timestamp,{textColor:"dimmer",dateFormat:"switch",date:t})}e.s(["default",()=>tl],919449);var tu=e.i(397124);function tc(e){var t=e.reversed,r=void 0!==t&&t,i=e.hideName,o=void 0!==i&&i,a=e.color,s=void 0===a?"default":a,u=(0,tt.useHistoryState)(),c=(0,l.useMemo)(function(){return[r?J.rcss.rowReverseWithGap(4):J.rcss.rowWithGap(4),J.rcss.align.center]},[r]);if(!u)return null;if(0===u.count)return(0,n.jsxs)(q.View,{css:c,children:[(0,n.jsx)(tu.default,{size:24}),(0,n.jsx)(W.Text,{color:s,multiline:!1,children:"Server Authored"})]});var d=u.changes[u.version];if(!u.users)return(0,n.jsxs)(q.View,{css:c,children:[(0,n.jsx)(H.Avatar,{size:24,src:"/public/images/ghost.svg",username:"Unknown"}),o?null:(0,n.jsx)(W.Text,{color:s,multiline:!1,children:"Unknown"})]});var f=u.users[d.userId];if(!f)if(d.timestamp>16546464e5)return(0,n.jsxs)(q.View,{css:c,children:[(0,n.jsx)(tu.default,{size:24}),o?null:(0,n.jsx)(W.Text,{color:s,multiline:!1,children:"Server Authored"})]});else return(0,n.jsxs)(q.View,{css:c,children:[(0,n.jsx)(H.Avatar,{size:24,src:"/public/images/ghost.svg",username:"Unknown"}),o?null:(0,n.jsx)(W.Text,{color:s,multiline:!1,children:"Unknown"})]});return(0,n.jsxs)(q.View,{css:c,children:[(0,n.jsx)(H.Avatar,{size:24,src:f.image,username:f.username}),o?null:(0,n.jsx)(W.Text,{color:s,multiline:!1,children:f.username})]})}e.s(["default",()=>tc],81621);var td=e.i(569384),tf=e.i(973245);function tp(){var e=(0,td._)(["\n  query WorkspaceHistory2Users($ids: [Int!]!) {\n    currentUser {\n      id\n      username\n      image\n    }\n    usersByIds(ids: $ids) {\n      id\n      username\n      image\n    }\n  }\n"]);return tp=function(){return e},e}function th(){var e=(0,td._)(["\n  query WorkspaceHistory2CurrentUserDate {\n    currentUser {\n      id\n      timeCreated\n    }\n  }\n"]);return th=function(){return e},e}e.i(304277),e.i(566901);var tg=(0,tf.gql)(tp());(0,tf.gql)(th()),e.s(["WorkspaceHistory2UsersDocument",()=>tg],33297)},605976,e=>{"use strict";var t=e.i(276385),n=e.i(399528),r=e.i(389959),i=e.i(548747),o=e.i(372014),a=e.i(919449),s=e.i(81621),l=e.i(181227),u=e.i(167626),c=e.i(530658),d=e.i(442121),f=e.i(529810),p=e.i(297083),h=e.i(633600),g=e.i(346715),m=e.i(817556),x=e.i(906368),y=e.i(33297),b=e.i(810394),w=e.i(399119),k=e.i(904851),_=e.i(445789),S=function(e){function t(e){var n;return(0,k._)(this,t),(n=(0,w._)(this,t,[e])).name="UserError",n}return(0,_._)(t,e),t}((0,e.i(463348)._)(Error));function C(e,t,n){return new Promise(function(r,i){try{var o=e.watchTextFile(t,{onReady:function(e){return(0,p._)(function(){var t,a;return(0,m._)(this,function(s){switch(s.label){case 0:return s.trys.push([0,2,,3]),[4,n(e)];case 1:return t=s.sent(),r(t),[3,3];case 2:return a=s.sent(),i(a),[3,3];case 3:return o(),[2]}})})()}})}catch(e){i(e)}})}var j=b.USER_LOOKUP_LIMIT,T=e.i(627254),E=e.i(222342),R=e.i(967629),I=e.i(613355),A=e.i(140487),P=e.i(739521),D=e.i(396776),O=e.i(929872),N=e.i(960178),M=e.i(257811),L=e.i(625484),B=e.i(961864),V=e.i(363201),F=(0,R.css)({display:"grid",gridTemplateColumns:"auto 1fr",rowGap:"0.5rem",columnGap:"1rem","> dt":{display:"flex",alignItems:"center",fontWeight:"bold"}});function U(e){var n=e.onCloseHistory,i=(0,E.default)().showError,o=(0,c._)((0,r.useState)(!1),2),a=o[0],d=o[1],g=(0,c._)((0,r.useState)(!1),2),y=g[0],b=g[1],w=(0,f.default)().fs,k=(0,l.useHistoryState)(),_=(0,T.useHistoryBSOD)(),j="Reset",R=!0;return k?0===k.count?(j="No history",R=!0):y||a?(j="Resetting...",R=!0):k.playing?(j="Playing...",R=!0):k.version===k.count-1?(j="Viewing latest",R=!0):(j="Reset editor to here",R=!1):(j="Loading...",R=!0),(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(A.Button,{text:j,disabled:R,onClick:function(){return d(!0)},colorway:"primary",iconLeft:(0,t.jsx)(B.default,{})}),k&&0!==k.count&&(0,t.jsx)(P.Modal,{isOpen:a,onRequestClose:function(){y||d(!1)},children:(0,t.jsxs)(L.View,{gap:24,children:[(0,t.jsx)(N.Header,{variant:"headerDefault",level:2,children:"Reset file version"}),(0,t.jsx)(O.Surface,{elevated:!0,css:[I.rcss.borderRadius(8)],px:16,py:12,children:(0,t.jsxs)("dl",{css:F,children:[(0,t.jsx)("dt",{children:"File"}),(0,t.jsx)("dd",{children:k.filePath}),(0,t.jsx)("dt",{children:"Version"}),(0,t.jsxs)("dd",{children:[k.version+1,(0,t.jsxs)("span",{css:[I.rcss.color.foregroundDimmest],children:[(0,t.jsx)("span",{css:I.rcss.mx(8),children:"/"}),k.count]})]}),(0,t.jsx)("dt",{children:"Date"}),(0,t.jsx)("dd",{children:(0,t.jsx)(M.Timestamp,{date:k.changes[k.version].timestamp,dateFormat:"absolute"})}),(0,t.jsx)("dt",{children:"Author"}),(0,t.jsx)("dd",{children:(0,t.jsx)(s.default,{})})]})}),(0,t.jsx)(D.StatusBanner,{icon:(0,t.jsx)(V.default,{}),colorway:"positive",text:"Resetting is non-destructive. The reset content will become a new version at the end of history. You can always go back to the version you just had."}),(0,t.jsxs)(L.View,{row:!0,gap:8,justify:"end",children:[(0,t.jsx)(A.Button,{text:"Cancel",disabled:y,onClick:function(){return d(!1)}}),(0,t.jsx)(A.Button,{text:y?"Resetting Version...":"Reset Version",disabled:y,colorway:"primary",onClick:function(){return(0,p._)(function(){var e,t;return(0,m._)(this,function(r){switch(r.label){case 0:if(!k||!w||y)return[2];r.label=1;case 1:var o;return r.trys.push([1,3,4,5]),b(!0),(0,T.historyEvent)("versionRestored"),e=k.filePath,[4,(o=k.version+1,C(w,e,function(t){var n=t.fetchChanges,r=t.writeChange,i=t.version;return(0,p._)(function(){var t,a,s,l,u;return(0,m._)(this,function(c){switch(c.label){case 0:if(o>i)throw Error("Cannot reset to a version that does not exist");if(o===i)return[2];t=null,c.label=1;case 1:return c.trys.push([1,3,,4]),[4,n(1,i,"")];case 2:if((a=c.sent()).isDisposed)throw new S("File deleted or removed.");return t=a.result,[3,4];case 3:throw c.sent(),new S("Something went wrong while resetting the file. It is possible that a bad connection is to blame. Please try again.");case 4:l=(s=(0,h._)(t.slice(o,t.length).reverse()))[0],u=s.slice(1).reduce(function(e,t){return e.compose(t.invertedChanges)},l.invertedChanges);try{r(u)}catch(e){throw x.captureException(e),new S("Something went wrong while resetting the file. Maybe the file changed while you were restoring it? Please try again.")}return[4,w.flush(new Set([e]))];case 5:return c.sent(),[2]}})})()}))];case 2:return r.sent(),n(),[3,5];case 3:if(t=r.sent(),(0,u._)(t,S))return i(t.message),[2];return _(t,"restore"),[3,5];case 4:return d(!1),b(!1),[7];case 5:return[2]}})})()},iconLeft:(0,t.jsx)(B.default,{})})]})]})})]})}var G=e.i(337761),$=e.i(480028);let z=(0,r.forwardRef)(function(e,n){var i=(0,l.useHistoryState)(),o=(0,r.useRef)(null);(0,r.useImperativeHandle)(n,function(){return o.current}),i&&o.current&&(o.current.setAttribute("aria-valuemin","1"),o.current.setAttribute("aria-valuemax",String(i.count)),o.current.setAttribute("aria-valuenow",String(i.version+1)));var a=(0,r.useMemo)(function(){return(0,t.jsx)("div",{ref:o,role:"slider",tabIndex:0,css:{position:"absolute",top:"0",left:"calc((100% - 16px) * var(--scrubber-progress, 0))",width:"16px",height:"16px",backgroundColor:$.tokens.accentPrimaryDefault,borderRadius:"100%",outline:"none",cursor:"pointer",transition:"left var(--scrubber-transition-time, 100ms) ease-out",willChange:"left, transition",":focus":{boxShadow:"0 0 0 1px ".concat($.tokens.foregroundDefault," inset")}}})},[]);return i&&i.count>1?a:null}),H=(0,r.forwardRef)(function(e,n){var i=(0,l.useHistoryState)(),o=(0,r.useMemo)(function(){return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{ref:n,"aria-hidden":!0,css:{position:"relative",top:"0",width:"100%",height:"16px",margin:"0",cursor:"pointer"}}),(0,t.jsx)("div",{"aria-hidden":!0,css:{position:"absolute",top:"6px",left:"0",width:"100%",height:"4px",margin:"0",overflow:"hidden",pointerEvents:"none",backgroundColor:$.tokens.backgroundHighest,borderRadius:"2px"},children:(0,t.jsx)("div",{"aria-hidden":!0,css:{position:"absolute",top:"0",left:"0",width:"100%",height:"4px",margin:"0",pointerEvents:"none",backgroundColor:$.tokens.accentPrimaryDefault,transformOrigin:"left",transform:"scaleX(var(--scrubber-progress, 0))",transition:"transform var(--scrubber-transition-time, 100ms) ease-out",willChange:"transform, transition"}})})]})},[n]),a=(0,r.useMemo)(function(){return(0,t.jsx)("div",{ref:n,"aria-hidden":!0,css:{width:"100%",height:"16px",pointerEvents:"none"},children:(0,t.jsx)("div",{css:{position:"absolute",width:"100%",height:"4px",top:"6px",left:"0",backgroundColor:$.tokens.backgroundHighest,borderRadius:"2px"}})})},[n]);return i&&i.count>1?o:a});var W=["ArrowLeft","ArrowRight","Home","End"];function q(){var e=(0,l.useHistoryState)(),n=(0,l.useSetHistoryState)(),i=(0,c._)((0,r.useState)(!1),2),o=i[0],a=i[1],s=(0,r.useRef)(null),u=(0,r.useRef)(null),d=(0,r.useRef)(null),f=function(e){(0,G.styleSet)(s,"--scrubber-transition-time",e)},p=function(e){(0,G.styleSet)(s,"--scrubber-progress",e.toString())};return e&&!o&&(p(e.version/(e.count-1)),e.playing?f("50ms"):f("100ms")),(0,r.useEffect)(function(){if(e&&u.current&&d.current&&!o){var t=u.current,r=d.current,i=function(i){if(0===i.button){a(!0),r.focus();var o=t.getBoundingClientRect(),s=r.getBoundingClientRect(),l=o.width,u=s.width,c=i.target===t?u/2:i.clientX-s.left,d=null,h=function(t){var r=Math.max(0,Math.min(1,(t-o.left-c)/(l-u)));r!==d&&(d=r,p(r),n({version:Math.round(r*(e.count-1)),playing:!1}))};h(i.clientX);var g=function(e){f("0ms"),h(e.clientX),e.preventDefault(),e.stopPropagation()},m=function(){window.removeEventListener("pointermove",g),window.removeEventListener("pointerup",m),window.removeEventListener("pointercancel",m),f("100ms"),a(!1)};window.addEventListener("pointermove",g),window.addEventListener("pointerup",m),window.addEventListener("pointercancel",m),i.preventDefault(),i.stopPropagation()}};return t.addEventListener("pointerdown",i),r.addEventListener("pointerdown",i),function(){t.removeEventListener("pointerdown",i),r.removeEventListener("pointerdown",i)}}},[e,n,o]),(0,r.useEffect)(function(){if(e&&d.current&&!o){var t=d.current,r=function(t){if(e&&W.includes(t.key)){var r=t.shiftKey?10:1,i=e.version,o=e.count-1,a=Math.max(0,i-r),s=Math.min(o,i+r),l=null;switch(t.key){case"ArrowLeft":l=a;break;case"ArrowRight":l=s;break;case"Home":l=0;break;case"End":l=o}null!==l&&(n({version:l,playing:!1}),t.preventDefault(),t.stopPropagation())}};return t.addEventListener("keydown",r),function(){t.removeEventListener("keydown",r)}}},[e,n,o]),(0,r.useMemo)(function(){return(0,t.jsxs)(L.View,{innerRef:s,css:{position:"relative",height:"16px",width:"100%",touchAction:"none","--scrubber-progress":1,"--scrubber-transition-time":"100ms",":hover, :focus-within":{filter:"brightness(1.1)"},":hover:focus-within":{filter:"brightness(1.2)"}},children:[(0,t.jsx)(H,{ref:u}),(0,t.jsx)(z,{ref:d})]})},[])}function K(){var e=(0,l.useHistoryState)(),n=0,r=0;e&&0!==e.count&&(n=e.version+1,r=e.count);var i=e?"default":"dimmer";return(0,t.jsxs)(L.View,{row:!0,gap:4,justify:"space-between",children:[(0,t.jsx)(N.Text,{css:{minWidth:"2ch",textAlign:"right"},color:i,multiline:!1,children:n}),(0,t.jsx)(N.Text,{css:{width:"1ch",textAlign:"center"},color:"dimmer",multiline:!1,children:"/"}),(0,t.jsx)(N.Text,{css:{minWidth:"2ch",textAlign:"left"},color:"dimmer",multiline:!1,children:r})]})}function Y(e){if(e<0)throw Error('Require at least zero ops to compute pace, got "'+e+'"');return 1/Math.log(e+2)*100}var Q=e.i(136540),X=e.i(785719),J=e.i(978669);function Z(){var e,n,i,o,a=(0,l.useHistoryState)(),s=(0,l.useSetHistoryState)(),u=(null!=(n=null==a||null==(e=a.changes)?void 0:e.length)?n:1)-1,d=null!=(i=null==a?void 0:a.version)?i:0,f=null!=(o=null==a?void 0:a.playing)&&o,p=!a||0===a.count,h=function(e,t,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:Y,o=(0,c._)((0,r.useState)(!1),2),a=o[0],s=o[1],l=(0,r.useCallback)(function(){t(1)},[t]),u=(0,r.useCallback)(function(){e+1>n?s(!1):t(e+1)},[t,e,n]);return(0,r.useEffect)(function(){if(a){var e=setTimeout(function(){u()},i(n));return function(){return clearTimeout(e)}}},[a,u,i,n]),{isPlaying:a,start:function(){s(!0)},stop:function(){s(!1)},reset:l}}(d,function(e){return s({version:e})},u),g=h.isPlaying,m=h.start,x=h.stop;(0,r.useEffect)(function(){g&&!f?x():!g&&f&&m()},[f,g,m,x]);var y="Loading...";return a&&(g?y="Pause":a.version===a.count-1?y="Play file history from beginning":0===a.version?y="Play file history":a.version>0&&(y="Play file history from here")),(0,t.jsx)(Q.IconButton,{alt:y,size:24,disabled:p,onClick:function(){d===u?s({version:0,playing:!0}):s({playing:!f})},children:g?(0,t.jsx)(X.default,{}):(0,t.jsx)(J.default,{})})}var ee=e.i(549762),et=e.i(782096);function en(){return(0,t.jsxs)(L.View,{row:!0,gap:4,align:"center",children:[(0,t.jsx)(Z,{}),(0,t.jsx)(er,{}),(0,t.jsx)(K,{}),(0,t.jsx)(ei,{})]})}function er(){var e=(0,l.useHistoryState)(),n=(0,l.useSetHistoryState)(),r=!e||0===e.version||0===e.count;return(0,t.jsx)(Q.IconButton,{alt:"Move backwards one version",size:24,disabled:r,onClick:function(){e&&e.version>0&&n({version:e.version-1})},children:(0,t.jsx)(ee.default,{})})}function ei(){var e=(0,l.useHistoryState)(),n=(0,l.useSetHistoryState)(),r=!e||e.version===e.count-1||0===e.count;return(0,t.jsx)(Q.IconButton,{alt:"Move forwards one version",size:24,disabled:r,onClick:function(){e&&e.version<e.count-1&&n({version:e.version+1})},children:(0,t.jsx)(et.default,{})})}function eo(e){var h,x,b,w,k,_=e.filePath,S=e.onCloseHistory,E="/replEnvironmentMobile"===(0,n.useRouter)().pathname,R=E?I.rcss.borderRadius(0):I.rcss.borderRadius(0,0,8,8),A=(0,l.useHistoryState)(),P=(0,l.useSetHistoryState)(),D=(0,l.useClearHistoryState)(),M=(0,T.useHistoryBSOD)(),B=(x=(h=(0,c._)((0,r.useState)({data:null,loading:!0,error:null,handledError:null}),2))[0],b=h[1],w=(0,f.default)().fs,k=(0,d.useApolloClient)(),(0,r.useEffect)(function(){if(!_)return void b({data:null,loading:!1,error:null,handledError:null});b({data:null,loading:!0,error:null,handledError:null});var e=!1;return(0,p._)(function(){var e,t,n;return(0,m._)(this,function(r){switch(r.label){case 0:return[4,C(w,_,function(e){var t=e.fetchChanges,n=e.version;return(0,p._)(function(){return(0,m._)(this,function(e){return 0===n?[2,{isDisposed:!1,result:[]}]:[2,t(1,n,"")]})})()})];case 1:var i;if((e=r.sent()).isDisposed)return[2,{data:null,handledError:"File deleted or removed."}];return[4,(i=t=e.result,(0,p._)(function(){var e,t,n,r,o,a,s,l,u,c,d,f,p,h,x,b,w,_;return(0,m._)(this,function(m){switch(m.label){case 0:e=new Set,t=!0,n=!1,r=void 0;try{for(o=i[Symbol.iterator]();!(t=(a=o.next()).done);t=!0)(s=a.value).userId&&e.add(s.userId)}catch(e){n=!0,r=e}finally{try{t||null==o.return||o.return()}finally{if(n)throw r}}if(0===e.size)return[2,{}];if(e.size>=j)return[2,"too_many_users"];return[4,k.query({query:y.WorkspaceHistory2UsersDocument,variables:{ids:Array.from(e)}})];case 1:if(u=(l=m.sent()).data,c=l.error)throw c;d=u.currentUser?[u.currentUser].concat((0,g._)(u.usersByIds)):u.usersByIds,f={},p=!0,h=!1,x=void 0;try{for(b=d[Symbol.iterator]();!(p=(w=b.next()).done);p=!0)f[(_=w.value).id]={id:_.id,username:_.username,image:_.image}}catch(e){h=!0,x=e}finally{try{p||null==b.return||b.return()}finally{if(h)throw x}}return[2,f]}})})())];case 2:if("too_many_users"===(n=r.sent()))return[2,{data:{changes:t,users:null},handledError:null}];return[2,{data:{changes:t,users:n},handledError:null}]}})})().then(function(t){var n=t.data,r=t.handledError;if(!e){if(r)return void b({data:null,loading:!1,error:null,handledError:r});b({data:n,loading:!1,error:null,handledError:null})}}).catch(function(t){e||((0,u._)(t,Error)||(t=Error(t)),b({data:null,loading:!1,error:t,handledError:null}))}),function(){e=!0}},[_,w,k]),x),V=B.data,F=B.loading,G=B.error;return(0,r.useEffect)(function(){return G?void M(G,"history2-index",{filePath:_}):V&&!F?(P({filePath:_,changes:V.changes,users:V.users}),(0,T.historyEvent)("historyLoaded"),function(){D()}):void 0},[_,V,F,G,M,P,D]),(0,t.jsxs)(L.View,{css:[I.rcss.zIndex(3),I.rcss.overflow("hidden"),R,I.rcss.backgroundColor.backgroundDefault,{borderTop:"2px solid ".concat($.tokens.backgroundHigher),boxShadow:"rgba(2, 2, 3, 0.125) 0px -16px 32px 0px"}],p:8,gap:8,children:[(0,t.jsxs)(O.Surface,{css:[I.rcss.position.relative,I.rcss.colWithGap(4),I.rcss.px(12),I.rcss.pt(8),I.rcss.pb(8),I.rcss.align.center,I.rcss.borderRadius(8),I.rcss.overflow("hidden")],elevated:!0,children:[(0,t.jsx)(q,{}),(0,t.jsxs)(L.View,{css:[I.rcss.display.flex,I.rcss.flex.row,I.rcss.align.center,I.rcss.justify.spaceBetween,I.rcss.width("100%")],children:[(0,t.jsx)(en,{}),A&&A.count>0?(0,t.jsxs)(L.View,{row:!0,gap:4,align:"center",children:[(0,t.jsx)(a.default,{}),F||E?null:(0,t.jsx)(N.Text,{color:"dimmer",multiline:!1,children:""}),(0,t.jsx)(s.default,{color:"dimmer",hideName:E,reversed:!0})]}):null]})]}),(0,t.jsxs)(L.View,{css:[I.rcss.display.flex,I.rcss.flex.row],children:[(0,t.jsx)(ea,{justify:"flex-start",children:(0,t.jsx)(o.default,{})}),(0,t.jsxs)(ea,{justify:"flex-end",children:[(0,t.jsx)(i.default,{onClose:S}),(0,t.jsx)(U,{onCloseHistory:S})]})]})]})}function ea(e){var n=e.children,r=e.justify;return(0,t.jsx)("div",{css:{display:"flex",flexGrow:1,flexBasis:0,alignItems:"center",justifyContent:r,columnGap:$.tokens.space8,minWidth:0},children:n})}e.s(["default",()=>eo],605976)},975068,e=>{e.v({centeredMessage:"ConnectorsPane-module__dm_Zsq__centeredMessage",manageConnectionContainer:"ConnectorsPane-module__dm_Zsq__manageConnectionContainer",searchControlsDesktop:"ConnectorsPane-module__dm_Zsq__searchControlsDesktop",searchControlsMobile:"ConnectorsPane-module__dm_Zsq__searchControlsMobile",tabPanels:"ConnectorsPane-module__dm_Zsq__tabPanels",tabs:"ConnectorsPane-module__dm_Zsq__tabs"})},851581,e=>{e.v({container:"DatabaseItem-module__43v9-W__container",containerNotClickable:"DatabaseItem-module__43v9-W__containerNotClickable",containerSelected:"DatabaseItem-module__43v9-W__containerSelected",skeletonText:"DatabaseItem-module__43v9-W__skeletonText"})},902071,e=>{e.v({databaseGrid:"DatabaseOverviewPage-module__9pcY1q__databaseGrid",skeletonText:"DatabaseOverviewPage-module__9pcY1q__skeletonText",wrapper:"DatabaseOverviewPage-module__9pcY1q__wrapper"})},189891,(e,t,n)=>{var r=e.r(365738);!function(){"use strict";var n={}.hasOwnProperty;function i(){for(var e=[],t=0;t<arguments.length;t++){var o=arguments[t];if(o){var a=void 0===o?"undefined":r._(o);if("string"===a||"number"===a)e.push(o);else if(Array.isArray(o)){if(o.length){var s=i.apply(null,o);s&&e.push(s)}}else if("object"===a){if(o.toString!==Object.prototype.toString&&!o.toString.toString().includes("[native code]")){e.push(o.toString());continue}for(var l in o)n.call(o,l)&&o[l]&&e.push(l)}}}return e.join(" ")}if(t.exports)i.default=i,t.exports=i;else if("function"==typeof define&&"object"===r._(define.amd)&&define.amd)void 0!==i&&e.v(i);else window.classNames=i}()},877768,e=>{e.v({envVarLabel:"DatabaseEnvVariable-module__ZGGlvq__envVarLabel"})},349248,e=>{e.v({cta:"CreateDatabase-module__78GBNW__cta",ctaStatusBanner:"CreateDatabase-module__78GBNW__ctaStatusBanner",payment:"CreateDatabase-module__78GBNW__payment"})},579134,e=>{e.v({productionDatabaseTourContent:"DatabaseSelector-module__vw1Uoq__productionDatabaseTourContent",wrapper:"DatabaseSelector-module__vw1Uoq__wrapper"})},61313,e=>{e.v({selectorBar:"DatabaseSelectorBar-module__qW8E_q__selectorBar"})},3382,e=>{e.v({"skeleton-delay-fadein":"DatabaseOverviewTab2-module__pDjseq__skeleton-delay-fadein",skeletonDelayed:"DatabaseOverviewTab2-module__pDjseq__skeletonDelayed",skeletonIcon:"DatabaseOverviewTab2-module__pDjseq__skeletonIcon",skeletonItem:"DatabaseOverviewTab2-module__pDjseq__skeletonItem",skeletonName:"DatabaseOverviewTab2-module__pDjseq__skeletonName",skeletonStorage:"DatabaseOverviewTab2-module__pDjseq__skeletonStorage",tableGrid:"DatabaseOverviewTab2-module__pDjseq__tableGrid"})},67810,e=>{e.v({content:"DatabaseTabs-module__YqHQRG__content",overviewTabPanel:"DatabaseTabs-module__YqHQRG__overviewTabPanel",settingsTabPanel:"DatabaseTabs-module__YqHQRG__settingsTabPanel",studioTabPanel:"DatabaseTabs-module__YqHQRG__studioTabPanel",tabList:"DatabaseTabs-module__YqHQRG__tabList",tabPanels:"DatabaseTabs-module__YqHQRG__tabPanels",wrapper:"DatabaseTabs-module__YqHQRG__wrapper"})},457214,e=>{e.v({detailsItem:"NeonStartPage-module__mOouaq__detailsItem",detailsText:"NeonStartPage-module__mOouaq__detailsText"})},467495,e=>{e.v({divider:"WorkspacePreferencesSection-module__Y7UL9G__divider"})},846445,e=>{e.v({root:"index-module__nGOWIa__root",tabPanel:"index-module__nGOWIa__tabPanel"})},110066,637972,224986,466638,138071,827305,292672,275222,401455,921009,494948,932287,e=>{"use strict";var t,n,r,i,o,a=e.i(878420),s=e.i(64386),l=e.i(530658),u=e.i(276385),c=e.i(389959),d=e.i(960933),f=e.i(862927),p=e.i(541793),h=e.i(205104),g=e.i(125674),m=e.i(185511),x=e.i(827759),y=e.i(605976),b=e.i(179302),w=e.i(486701),k=e.i(399119),_=e.i(904851),S=e.i(90659),C=e.i(721281),j=e.i(445789),T=e.i(753950),E=e.i(433772),R=e.i(167626),I=e.i(960308),A=(0,e.i(275072).StateEffectField)();function P(e){if(!(0,R._)(e,T.Transaction))return{compareTo:e.field(A.state,!1),changed:!1};var t=e.state.field(A.state,!1),n=e.startState.field(A.state,!1)!==t;return{compareTo:t,changed:n}}function D(e,t){e.state.field(A.state,!1)!==t&&e.dispatch({effects:A.effect.of(t)})}var O=T.StateField.define({create:function(){return null},update:function(e,t){var n=P(t),r=n.compareTo,i=n.changed;if(!r)return null;if(!t.docChanged&&!i)return e;var o=t.state.doc.toString();return new I.LineBasedDiff(o,r)}}),N=null!=(i=globalThis.requestIdleCallback)?i:globalThis.requestAnimationFrame,M=null!=(o=globalThis.cancelIdleCallback)?o:globalThis.cancelAnimationFrame,L=b.Decoration.line({class:"cm-diff-deleted"}),B=function(e){function t(e,n){var r;return(0,_._)(this,t),r=(0,k._)(this,t),(0,C._)(r,"insertion",void 0),(0,C._)(r,"highlight",void 0),(0,C._)(r,"pendingHighlight",void 0),r.insertion=e,r.highlight=n,r}return(0,j._)(t,e),(0,S._)(t,[{key:"destroy",value:function(){this.pendingHighlight&&M(this.pendingHighlight)}},{key:"toDOM",value:function(){var e=document.createElement("div");return e.className="cm-diff-inserted cm-line",this.updateDOM(e),e}},{key:"eq",value:function(e){return!e.pendingHighlight&&this.insertion===e.insertion}},{key:"updateDOM",value:function(e){var t=this;return this.pendingHighlight&&(M(this.pendingHighlight),this.pendingHighlight=null),this.insertion.length?e.textContent=this.insertion:e.innerHTML="&nbsp;",this.highlight&&this.insertion.length&&(this.pendingHighlight=N(function(){if(t.highlight){t.pendingHighlight=null;try{var n=t.highlight();e.innerHTML="",e.append(n)}catch(e){}}})),!0}}]),t}(b.WidgetType),V=T.StateField.define({create:function(){return b.Decoration.none},update:function(e,t){var n=t.state.field(O,!1);if(!n)return b.Decoration.none;var r=P(t).changed;if(!t.docChanged&&!r)return e.map(t.changes);var i=[],o=function(e,t){i.push({from:e,to:e,value:t})},a=n.startInsertions();if(a){var s=!0,l=!1,u=void 0;try{for(var c,d=a[Symbol.iterator]();!(s=(c=d.next()).done);s=!0)!function(){var e=c.value,n=new B(e.content,function(){return F(t.state,e.content)});o(0,b.Decoration.widget({widget:n,side:-1,block:!0}))}()}catch(e){l=!0,u=e}finally{try{s||null==d.return||d.return()}finally{if(l)throw u}}}var f=!0,p=!1,h=void 0;try{for(var g,m=n.lines()[Symbol.iterator]();!(f=(g=m.next()).done);f=!0){var x=g.value;if(x.isDeleted&&o(x.from,L),x.insertions){var y=!0,w=!1,k=void 0;try{for(var _,S=x.insertions[Symbol.iterator]();!(y=(_=S.next()).done);y=!0)!function(){var e=_.value,n=new B(e.content,function(){return F(t.state,e.content)});o(x.to,b.Decoration.widget({widget:n,side:1,block:!0}))}()}catch(e){w=!0,k=e}finally{try{y||null==S.return||S.return()}finally{if(w)throw k}}}}}catch(e){p=!0,h=e}finally{try{f||null==m.return||m.return()}finally{if(p)throw h}}return b.Decoration.set(i,!0)},provide:function(e){return b.EditorView.decorations.from(e)}});function F(e,t){var n,r=document.createDocumentFragment(),i=null==(n=e.facet(w.language))?void 0:n.parser;if(!i){var o=document.createElement("span");return o.textContent=t,r.append(o),r}var a=i.parse(t),s=0;if((0,E.highlightTree)(a,{style:function(t){return(0,w.highlightingFor)(e,t)}},function(e,n,i){if(e>s){var o=document.createElement("span");o.textContent=t.slice(s,e),r.append(o)}var a=document.createElement("span");a.className=i,a.textContent=t.slice(e,n),r.append(a),s=n}),s<t.length){var l=document.createElement("span");l.textContent=t.slice(s),r.append(l)}return r}var U=e.i(346715),G=function(e){function t(e){var n;return(0,_._)(this,t),n=(0,k._)(this,t),(0,C._)(n,"line",void 0),n.line=e,n}return(0,j._)(t,e),(0,S._)(t,[{key:"eq",value:function(e){return this.line===e.line}},{key:"toDOM",value:function(){var e=document.createElement("div");return e.className="cm-diff-gutter-element-fallback",e.innerText=this.line.toString(),e}}]),t}(b.GutterMarker),$=function(e){function t(e,n){var r;return(0,_._)(this,t),r=(0,k._)(this,t),(0,C._)(r,"lines",void 0),(0,C._)(r,"preceding",void 0),r.elementClass="cm-diff-gutter-block",r.lines=e,n&&(r.preceding=n),r}return(0,j._)(t,e),(0,S._)(t,[{key:"eq",value:function(e){var t,n,r,i;if((null==(t=this.lines)?void 0:t.length)!==(null==e||null==(n=e.lines)?void 0:n.length)||(null==(r=this.preceding)?void 0:r.length)!==(null==e||null==(i=e.preceding)?void 0:i.length))return!1;if(this.preceding&&e.preceding)for(var o=0;o<this.preceding.length;o++){var a=this.preceding[o],s=e.preceding[o];if(a.height!==s.height||a.left!==s.left||a.right!==s.right)return!1}if(this.lines&&e.lines)for(var l=0;l<this.lines.length;l++){var u=this.lines[l],c=e.lines[l];if(u.height!==c.height||u.left!==c.left||u.right!==c.right)return!1}return!0}},{key:"toDOM",value:function(){var e=this,t=document.createElement("div");if(this.preceding){var n=this.preceding.slice().reverse(),r=0,i=!0,o=!1,a=void 0;try{for(var s,l=n[Symbol.iterator]();!(i=(s=l.next()).done);i=!0){var u=s.value;r+=u.height;var c=this.piece(u);c.style.position="absolute",c.style.top="-".concat(r,"px"),t.prepend(c)}}catch(e){o=!0,a=e}finally{try{i||null==l.return||l.return()}finally{if(o)throw a}}}var d=this.lines.map(function(t){return e.piece(t)});return t.append.apply(t,(0,U._)(d)),t}},{key:"piece",value:function(e){var t=e.height,n=e.left,r=e.right,i=document.createElement("span");i.className="cm-diff-gutter-part",null!==n&&(i.innerText=n.toString());var o=document.createElement("span");o.className="cm-diff-gutter-part",null!==r&&(o.innerText=r.toString());var a=document.createElement("div");return a.className="cm-diff-gutter-element",a.style.height="".concat(t,"px"),a.append(i,o),(null===n||null===r)&&(null===r&&a.classList.add("cm-diff-gutter-deleted"),null===n&&a.classList.add("cm-diff-gutter-inserted")),a}}]),t}(b.GutterMarker),z=(0,b.gutter)({class:"cm-lineNumbers cm-diff-gutter",markers:function(e){var t=e.viewportLineBlocks,n=[],r=P(e.state).compareTo,i=e.state.field(O,!1),o=function(e,t){n.push({from:e,to:e,value:t})};if(!r||!i){var a=!0,s=!1,l=void 0;try{for(var u,c=t[Symbol.iterator]();!(a=(u=c.next()).done);a=!0){var d=u.value,f=e.state.doc.lineAt(d.from).number;if(d.type===b.BlockType.Text)o(d.from,new G(f));else if(Array.isArray(d.type)){var p=!0,h=!1,g=void 0;try{for(var m,x=d.type[Symbol.iterator]();!(p=(m=x.next()).done);p=!0){var y=m.value;if(y.type===b.BlockType.Text){o(y.from,new G(f));break}}}catch(e){h=!0,g=e}finally{try{p||null==x.return||x.return()}finally{if(h)throw g}}}}}catch(e){s=!0,l=e}finally{try{a||null==c.return||c.return()}finally{if(s)throw l}}return T.RangeSet.of(n,!0)}var w=!0,k=!1,_=void 0;try{for(var S,C=t[Symbol.iterator]();!(w=(S=C.next()).done);w=!0){var j=S.value,E=[],R=e.state.doc.lineAt(j.from).number,I=i.line(R);if(I){var A=e.defaultLineHeight,D=I.offset,N=I.isDeleted,M=I.insertions,L=1===R?i.startInsertions():null,B=L?L.length:0,V=L?[]:null;if(!(Array.isArray(j.type)&&j.type.length>=B+(null!=(H=null==M?void 0:M.length)?H:0)+1)){if(L&&V){var F=!0,U=!1,z=void 0;try{for(var H,W,q=L[Symbol.iterator]();!(F=(W=q.next()).done);F=!0){var K=W.value;V.push({height:A,left:null,right:K.number})}}catch(e){U=!0,z=e}finally{try{F||null==q.return||q.return()}finally{if(U)throw z}}}if(E.push({height:j.height,left:R,right:N?null:R+D}),M){var Y=!0,Q=!1,X=void 0;try{for(var J,Z=M[Symbol.iterator]();!(Y=(J=Z.next()).done);Y=!0){var ee=J.value;E.push({height:A,left:null,right:ee.number})}}catch(e){Q=!0,X=e}finally{try{Y||null==Z.return||Z.return()}finally{if(Q)throw X}}}o(j.from,new $(E,V));continue}for(var et=0;et<j.type.length;et++){var en=j.type[et];if((null==en?void 0:en.type)===b.BlockType.Text){if(L&&V)for(var er=0;er<L.length;er++){var ei,eo=L[er],ea=j.type[et-er-1];V.push({height:null!=(ei=null==ea?void 0:ea.height)?ei:A,left:null,right:eo.number})}if(E.push({height:en.height,left:R,right:N?null:R+D}),M)for(var es=0;es<M.length;es++){var el,eu=M[es],ec=j.type[et+es+1];E.push({height:null!=(el=null==ec?void 0:ec.height)?el:A,left:null,right:eu.number})}break}}o(j.from,new $(E,V))}}}catch(e){k=!0,_=e}finally{try{w||null==C.return||C.return()}finally{if(k)throw _}}return T.RangeSet.of(n,!0)},lineMarkerChange:function(e){if(e.docChanged)return!0;var t=!0,n=!1,r=void 0;try{for(var i,o=e.transactions[Symbol.iterator]();!(t=(i=o.next()).done);t=!0){var a=i.value;if(P(a).changed)return!0}}catch(e){n=!0,r=e}finally{try{t||null==o.return||o.return()}finally{if(n)throw r}}return!1},initialSpacer:function(e){return new G(e.state.doc.lines)},updateSpacer:function(e,t){var n=t.state.doc.lines;return P(t.state).compareTo?new $([{height:0,left:n,right:n}]):new G(n)}}),H="#0053A644",W="#c93c3733",q=[b.EditorView.theme({".cm-diff-inserted":{backgroundColor:H},".cm-diff-deleted":{backgroundColor:W},".cm-diff-gutter .cm-diff-gutter-block":{position:"relative",padding:"0"},".cm-diff-gutter-element":{display:"flex",width:"100%",alignItems:"center",columnGap:"8px",padding:"0 6px",borderLeft:"4px solid transparent"},".cm-diff-gutter-part":{display:"inline-block",height:"100%",width:"50%",textAlign:"center"},".cm-diff-gutter-inserted":{backgroundColor:H,borderLeftColor:"#0053A6"},".cm-diff-gutter-deleted":{backgroundColor:W,borderLeftColor:"#c93c37"},".cm-diff-gutter + .cm-foldGutter":{width:"0",transform:"translateX(-12px)",overflow:"visible"},".cm-diff-gutter .cm-diff-gutter-element":{paddingRight:"16px"},".cm-diff-gutter .cm-diff-gutter-element-fallback":{paddingRight:"12px"}}),A.state,O,V,z,(0,w.foldGutter)({openText:"",closedText:""})],K=e.i(463348),Y=e.i(817556),Q=((t={})[t.Insertion=0]="Insertion",t[t.Deletion=1]="Deletion",t),X=function(){function e(t){(0,_._)(this,e),(0,C._)(this,"map",new Map),(0,C._)(this,"duration",void 0),this.duration=t}return(0,S._)(e,[{key:"set",value:function(e,t,n,r,i){var o=this.map.get(e);o||(o=new Map,this.map.set(e,o)),o.set(t,{from:e,to:t,time:n,type:r,cursor:i})}},{key:"get",value:function(e,t){var n=this.map.get(e);if(n)return n.get(t)}},{key:"update",value:function(t){var n=Date.now(),r=new e(this.duration),i=!0,o=!1,a=void 0;try{for(var s,l=this[Symbol.iterator]();!(i=(s=l.next()).done);i=!0){var u=s.value;if(!(n-u.time>this.duration)){var c=t.changes.mapPos(u.from,-1,T.MapMode.TrackDel),d=t.changes.mapPos(u.to,-1,T.MapMode.TrackDel);if(null!==c&&null!==d){var f=u.cursor;t.docChanged&&(f=!1),r.set(c,d,u.time,u.type,f)}}}}catch(e){o=!0,a=e}finally{try{i||null==l.return||l.return()}finally{if(o)throw a}}return t.changes.iterChangedRanges(function(e,t,i,o){r.set(i,o,n,+(i===o),!0)},!0),r}},{key:"cursors",value:function(){var e,t,n,r,i,o,a;return(0,Y._)(this,function(s){switch(s.label){case 0:e=!0,t=!1,n=void 0,s.label=1;case 1:s.trys.push([1,6,7,8]),r=this[Symbol.iterator](),s.label=2;case 2:if(e=(i=r.next()).done)return[3,5];if(!(o=i.value).cursor)return[3,4];return[4,{type:o.type,pos:o.to}];case 3:s.sent(),s.label=4;case 4:return e=!0,[3,2];case 5:return[3,8];case 6:return a=s.sent(),t=!0,n=a,[3,8];case 7:try{e||null==r.return||r.return()}finally{if(t)throw n}return[7];case 8:return[2]}})}},{key:Symbol.iterator,value:function(){var e=[],t=!0,n=!1,r=void 0;try{for(var i,o=this.map.values()[Symbol.iterator]();!(t=(i=o.next()).done);t=!0){var a=i.value,s=!0,l=!1,u=void 0;try{for(var c,d=a.values()[Symbol.iterator]();!(s=(c=d.next()).done);s=!0){var f=c.value;e.push(f)}}catch(e){l=!0,u=e}finally{try{s||null==d.return||d.return()}finally{if(l)throw u}}}}catch(e){n=!0,r=e}finally{try{t||null==o.return||o.return()}finally{if(n)throw r}}return e[Symbol.iterator]()}}]),e}(),J=function(){function e(t){var n=this;(0,_._)(this,e),(0,C._)(this,"view",void 0),(0,C._)(this,"overlay",void 0),(0,C._)(this,"elements",void 0),(0,C._)(this,"measureRequest",void 0),this.view=t,this.overlay=document.createElement("div"),this.overlay.className="cm-overlay-generic",this.overlay.style.pointerEvents="none",this.overlay.style.contain="size style",this.overlay.setAttribute("aria-hidden","true"),this.view.scrollDOM.appendChild(this.overlay),this.elements=new Map,this.measureRequest={key:this,read:function(){var e=[],t=n.view.scrollDOM.getBoundingClientRect(),r=n.view.scrollDOM.scrollTop,i=n.view.scrollDOM.scrollLeft,o=!0,a=!1,s=void 0;try{for(var l,u=n.elements.values()[Symbol.iterator]();!(o=(l=u.next()).done);o=!0){var c=l.value,d=c.dom,f=c.pos,p=c.offsetX,h=c.offsetY,g=n.view.coordsAtPos(f),m=n.view.lineBlockAt(f);if(!g){e.push({dom:d,x:null,y:null});continue}var x=m.top-r+t.top+n.view.documentPadding.top,y=Math.round((g.top-x)/n.view.defaultLineHeight)*n.view.defaultLineHeight+x,b=i+g.left-t.left+p,w=r+y-t.top+h;e.push({dom:d,x:b,y:w})}}catch(e){a=!0,s=e}finally{try{o||null==u.return||u.return()}finally{if(a)throw s}}return e},write:function(e){var t=!0,n=!1,r=void 0;try{for(var i,o=e[Symbol.iterator]();!(t=(i=o.next()).done);t=!0)!function(){var e=i.value,t=e.dom,n=e.x,r=e.y;if(null===n||null===r)return t.style.visibility="hidden",t.style.transition="none";t.style.visibility="",t.style.transform="translate(".concat(n,"px, ").concat(r,"px)"),t.style.transition.startsWith("none")&&requestAnimationFrame(function(){t.style.transition=""})}()}catch(e){n=!0,r=e}finally{try{t||null==o.return||o.return()}finally{if(n)throw r}}}}}return(0,S._)(e,[{key:"destroy",value:function(){this.view.scrollDOM.removeChild(this.overlay)}},{key:"map",value:function(e){if(e.geometryChanged||e.viewportChanged){if(e.docChanged){var t=Array.from(this.elements.values()),n=!0,r=!1,i=void 0;try{for(var o,a=t[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var s=o.value,l=e.changes.mapPos(s.pos,-1,T.MapMode.TrackDel);if(!l){this.removeElement(s.dom);continue}s.pos=l}}catch(e){r=!0,i=e}finally{try{n||null==a.return||a.return()}finally{if(r)throw i}}}this.view.requestMeasure(this.measureRequest)}}},{key:"addElement",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;if(!this.elements.has(e)){var i={dom:e,pos:t,offsetX:n,offsetY:r};return this.elements.set(e,i),this.overlay.appendChild(e),e.style.visibility="hidden",e.style.position="absolute",e.style.top="0",e.style.left="0",e.style.willChange="transform",e.style.transition="none",this.view.requestMeasure(this.measureRequest),i}}},{key:"removeElement",value:function(e){this.elements.has(e)&&(this.elements.delete(e),e.parentNode===this.overlay&&this.overlay.removeChild(e))}},{key:"updateElement",value:function(e,t){var n=t.pos,r=t.offsetX,i=t.offsetY,o=this.elements.get(e);o&&(void 0!==n&&(o.pos=n),void 0!==r&&(o.offsetX=r),void 0!==i&&(o.offsetY=i),this.view.requestMeasure(this.measureRequest))}},{key:"clear",value:function(){this.elements.clear(),this.overlay.innerHTML=""}}]),e}(),Z="cm-flash-insertion",ee="cm-flash-deletion",et="cm-flash-element",en=b.EditorView.theme((0,C._)({},".".concat(Z,", .").concat(ee),{display:"inline-block"})),er=function(e){function t(){var e;return(0,_._)(this,t),e=(0,k._)(this,t,arguments),(0,C._)(e,"animation",void 0),e}return(0,j._)(t,e),(0,S._)(t,[{key:"type",get:function(){return this.classList.contains(Z)?Q.Insertion:Q.Deletion}},{key:"isPlaying",get:function(){var e;return(null==(e=this.animation)?void 0:e.playState)==="running"}},{key:"isNested",value:function(){for(var e=this.parentElement;e&&!e.classList.contains("cm-line");){if((0,R._)(e,t)&&e.type===this.type)return!0;e=e.parentElement}return!1}},{key:"stop",value:function(){var e,t;null==(t=this.animation)||null==(e=t.cancel)||e.call(t)}},{key:"play",value:function(){var e=this.isPlaying;if(this.stop(),!this.isNested()){var t=Date.now()-parseInt(this.getAttribute("data-time")||"0",10);if(!(t>1e3)){var n=this.type===Q.Insertion?"rgba(100, 255, 0, 0.3)":"rgba(255, 32, 32, 0.25)";this.animate&&(this.animation=this.animate({backgroundColor:e?[n,n,"transparent"]:["transparent",n,"transparent"],offset:[0,.05,1]},{id:"cm-flash-anim",duration:1e3,easing:"ease-in-out",delay:-t}))}}}},{key:"connectedCallback",value:function(){this.play()}},{key:"attributeChangedCallback",value:function(e,t,n){"data-time"===e&&n&&this.play()}}],[{key:"observedAttributes",get:function(){return["data-time"]}}]),t}((0,K._)(HTMLElement));customElements.get(et)||customElements.define(et,er);var ei=function(){function e(t){(0,_._)(this,e),(0,C._)(this,"view",void 0),(0,C._)(this,"prevFlashes",void 0),(0,C._)(this,"decorations",void 0),(0,C._)(this,"hasRenderedOnce",void 0),(0,C._)(this,"overlay",void 0),this.view=t,this.prevFlashes=new X(1e3),this.decorations=b.Decoration.set([]),this.hasRenderedOnce=!1,this.overlay=new J(t)}return(0,S._)(e,[{key:"destroy",value:function(){this.overlay.destroy()}},{key:"update",value:function(e){if(!this.hasRenderedOnce){e.docChanged&&(this.hasRenderedOnce=!0);return}var t=this.prevFlashes.update(e),n=[],r=!0,i=!1,o=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done);r=!0){var l=a.value;switch(l.type){case Q.Insertion:n.push({from:l.from,to:l.to,value:(u=l.time,b.Decoration.mark({class:Z,tagName:et,attributes:{"data-time":u.toString()}}))});break;case Q.Deletion:var u,c,d=e.state.wordAt(l.from);d&&n.push({from:d.from,to:l.to,value:(c=l.time,b.Decoration.mark({class:ee,tagName:et,attributes:{"data-time":c.toString()}}))})}}}catch(e){i=!0,o=e}finally{try{r||null==s.return||s.return()}finally{if(i)throw o}}this.overlay.clear();var f=this.view.defaultLineHeight.toString()+"px",p=!0,h=!1,g=void 0;try{for(var m,x=t.cursors()[Symbol.iterator]();!(p=(m=x.next()).done);p=!0){var y=m.value,w=y.type,k=y.pos,_=function(e,t){var n=e===Q.Insertion?"rgba(0, 100, 255, 1)":"rgba(255, 32, 32, 1)",r=document.createElement("div");return r.style.width="3px",r.style.height=t,r.style.borderRadius="1px",r.style.backgroundColor=n,r.animate&&r.animate({opacity:[1,0]},{duration:500,delay:400,fill:"forwards"}),r}(w,f);this.overlay.addElement(_,k)}}catch(e){h=!0,g=e}finally{try{p||null==x.return||x.return()}finally{if(h)throw g}}this.prevFlashes=t,this.decorations=b.Decoration.set(n,!0)}}]),e}(),eo=b.ViewPlugin.fromClass(ei,{decorations:function(e){return e.decorations}}),ea=T.Prec.lowest([en,eo]),es=e.i(221250),el=e.i(542101),eu=e.i(700170),ec=e.i(109853),ed=e.i(181227),ef=e.i(633600),ep=function(){function e(t){(0,_._)(this,e),(0,C._)(this,"changes",void 0),(0,C._)(this,"forward",void 0),(0,C._)(this,"inverted",void 0),(0,C._)(this,"locations",void 0),this.changes=[],this.forward=[],this.inverted=[],this.locations=[];var n=!0,r=!1,i=void 0;try{for(var o,a,s=t[Symbol.iterator]();!(n=(a=s.next()).done);n=!0)o=this,function(){var e=a.value,t=e.changes,n=e.invertedChanges,r=null,i=!1;t.iterChangedRanges(function(e,t,n,o){i||(r||(r=o),n!==o&&(i=!0))}),o.forward.push(t),o.inverted.push(n),o.locations.push(r)}()}catch(e){r=!0,i=e}finally{try{n||null==s.return||s.return()}finally{if(r)throw i}}}return(0,S._)(e,[{key:"length",get:function(){return this.forward.length}},{key:"slice",value:function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.length;if(t>this.length||n>this.length||t<0||n<0)throw Error("Invalid version range");if(t===n){if(0===this.length)return[T.ChangeSet.empty(0),null];var r=this.forward[t].newLength;return[T.ChangeSet.empty(r),null]}var i=t<n?eh(this.forward.slice(t,n)):eh(this.inverted.slice(n,t).reverse()),o=t<n?t:n-1,a=null!=(e=this.locations[o])?e:null;return null!==a&&a>i.newLength&&(a=i.newLength),[i,a]}},{key:"get",value:function(e){if(e>this.length||e<0)throw Error("Invalid version");return this.changes[e]}},{key:"documentFor",value:function(e){if(e>this.length||e<0)throw Error("Invalid version");if(0===this.length)return"";var t=(0,l._)(this.slice(0,e),1)[0],n=T.Text.of([""]);return t.apply(n).sliceString(0)}}]),e}();function eh(e){if(0===e.length)return T.ChangeSet.empty(0);if(1===e.length)return e[0];var t=(0,ef._)(e),n=t[0],r=t.slice(1),i=n,o=!0,a=!1,s=void 0;try{for(var l,u=r[Symbol.iterator]();!(o=(l=u.next()).done);o=!0){var c=l.value;i=i.compose(c)}}catch(e){a=!0,s=e}finally{try{o||null==u.return||u.return()}finally{if(a)throw s}}return i}var eg=e.i(627254),em=e.i(564169),ev=new eu.ReactCompartment(function(){return(0,b.scrollPastEnd)()}),ex=[ea,q];function ey(e){var t,n,r,i=e.filePath,o=(0,ed.useHistoryState)(),a=(0,el.default)(),s=a.ref,d=a.view;(0,em.useSetCodeEditorView)(d),(0,ed.useSetHistoryDebugView)(d);var f=(0,eg.useHistoryBSOD)();t=(0,c.useMemo)(function(){return(null==o?void 0:o.changes)?new ep(o.changes):null},[null==o?void 0:o.changes]),n=(0,c.useMemo)(function(){return t?t.documentFor(t.length):null},[t]),r=(0,c.useRef)({current:-1,next:0,pending:!1}),(0,c.useEffect)(function(){if(d)return function(){r.current.pending=!1,r.current={current:-1,next:0,pending:!1}}},[d]),(0,c.useEffect)(function(){if(d&&o&&t){o.comparing?D(d,n):D(d,null);var e=r.current;e.next=o.version,e.pending||e.current===e.next||(e.pending=!0,requestAnimationFrame(function(){!1===e.pending||(e.pending=!1,d&&t&&e.current!==e.next&&(function(e,t,n,r){var i=(0,l._)(t.slice(n+1,r+1),2),o=i[0],a=i[1];if(o.length!==e.state.doc.length){var s=(0,l._)(t.slice(0,r+1),1)[0];if(s.length!==e.state.doc.length)throw Error("Unresolvable mismatch between changes and document");e.dispatch({changes:{from:0,to:e.state.doc.length}}),e.dispatch({changes:s});return}e.dispatch({changes:o,effects:a?b.EditorView.scrollIntoView(a,{yMargin:10}):void 0})}(d,t,e.current,e.next),e.current=e.next))}))}},[d,o,t,n]);var p=ev.use();return(0,u.jsx)("div",{css:ec.CodeMirrorEditorStyleRoot,children:(0,u.jsx)("div",{css:ec.CodeMirrorEditorStyleEditor,children:o&&0===o.count?(0,u.jsx)(eb,{}):(0,u.jsx)("div",{css:ec.CodeMirrorEditorStyleEditor,children:(0,u.jsx)(es.default,{ref:s,css:ec.CodeMirrorEditorStyleEditorContainer,filePath:i,extensions:[p,ex],initializing:!o,onException:function(e){f(e,"viewer-codemirror")},readOnly:!0,noHistory:!0,hideGutter:!0})})})})}function eb(){return(0,u.jsx)("div",{css:[ec.CodeMirrorEditorStyleEditor,{display:"flex",alignItems:"center",justifyContent:"center"}],children:(0,u.jsx)("span",{children:"This file has no history."})})}e.i(282890);var ew=e.i(716636),ek=e.i(259493),e_=e.i(961864),eS=d.Type.Object({type:d.Type.Literal("history"),data:d.Type.Object({path:d.Type.Union([d.Type.String(),d.Type.Null()])})}),eC={Content:function(e){var t=e.pane,n=e.options;return(0,u.jsx)(ej,(0,s._)((0,a._)({},t.data),{performPaneOperation:n.performPaneOperation}))},Icon:function(e){var t=e.size;return(0,u.jsx)(e_.default,{size:t})},getTitle:function(e){return e.data.path?"History - ".concat((0,h.getFileName)(e.data.path)):"History - no file open"},category:ew.PaneCategory.WorkspaceFeatures,decode:function(e){return f.Value.Decode(eS,e)}};function ej(e){var t=e.path,n=e.performPaneOperation,r=(0,l._)((0,c.useState)(function(){return(0,p.createStore)()}),1)[0],i=(0,l._)((0,c.useState)(function(){return(0,p.createStore)()}),1)[0],o=(0,m.useFileCommands)({path:t,performPaneOperation:n});(0,ek.useSetPaneBindings)(function(){if(o)return{commands:[{commands:o}]}},[o]);var a=(0,g.default)(function(){return function(){n({operation:"replace",pane:{type:"codeEditor",data:{path:t}}})}},[t,n]);return t?(0,u.jsx)(em.CodeEditorViewContext.Provider,{value:r,children:(0,u.jsx)(ed.HistoryPaneContext.Provider,{value:i,children:(0,u.jsxs)("div",{css:{position:"relative",display:"flex",flexDirection:"column",overflowY:"hidden",height:"100%",width:"100%"},children:[(0,u.jsx)(x.FileHeader,{path:t,performPaneOperation:n}),(0,u.jsx)(ey,{filePath:t}),(0,u.jsx)(y.default,{filePath:t,onCloseHistory:a})]})})}):null}e.s(["historyUI",()=>eC],110066);var eT=e.i(297083),eE=e.i(717215),eR=e.i(415756),eI=e.i(569384),eA=e.i(973245),eP=e.i(304277);e.i(566901);var eD=e.i(951262);function eO(){var e=(0,eI._)(["\n  fragment WorkspaceReplInfo on Repl {\n    id\n    title\n    iconUrl\n    url\n    timeCreated\n    user {\n      id\n      username\n      image\n    }\n  }\n"]);return eO=function(){return e},e}function eN(){var e=(0,eI._)(["\n  fragment WorkspaceConnectionInfo on OintConnection {\n    type\n    connectionId\n    connectorName\n    displayName\n    iconPath\n    status\n    environment\n    scopes\n    repls {\n      ...WorkspaceReplInfo\n    }\n  }\n  ","\n"]);return eN=function(){return e},e}function eM(){var e=(0,eI._)(["\n  fragment WorkspaceConnectorContext on CurrentUserConnectorContext {\n    openIntClientToken\n    connectorWhitelist\n    connections {\n      ...WorkspaceConnectionInfo\n    }\n    connectorConfigs {\n      id\n      type\n      connectorName\n      displayName\n      iconPath\n      config\n      webhookEvents {\n        name\n        model\n        description\n      }\n    }\n  }\n  ","\n"]);return eM=function(){return e},e}function eL(){var e=(0,eI._)(["\n  fragment WorkspaceOrgConnectorContext on OrgConnectorContext {\n    openIntClientToken\n    connectorWhitelist\n    connections {\n      ...WorkspaceConnectionInfo\n    }\n    connectorConfigs {\n      id\n      type\n      connectorName\n      displayName\n      iconPath\n      webhookEvents {\n        name\n        model\n        description\n      }\n    }\n  }\n  ","\n"]);return eL=function(){return e},e}function eB(){var e=(0,eI._)(["\n  query WorkspaceUserConnectors {\n    currentUser {\n      ... on CurrentUser {\n        id\n        connectorContext {\n          __typename\n          ...WorkspaceConnectorContext\n          ... on Error {\n            message\n          }\n        }\n      }\n    }\n  }\n  ","\n"]);return eB=function(){return e},e}function eV(){var e=(0,eI._)(["\n  query WorkspaceOrgConnectors($orgSlug: String!) {\n    currentUser {\n      ... on CurrentUser {\n        id\n        org(orgSlug: $orgSlug) {\n          __typename\n          ... on Org {\n            id\n            connectorContext {\n              __typename\n              ...WorkspaceOrgConnectorContext\n              ... on Error {\n                message\n              }\n            }\n          }\n          ... on Error {\n            message\n          }\n        }\n      }\n    }\n  }\n  ","\n"]);return eV=function(){return e},e}function eF(){var e=(0,eI._)(["\n  mutation CreateWorkspaceConnection($input: CreateConnectionInput!) {\n    createConnection(input: $input) {\n      ... on CreateConnection {\n        connectionId\n      }\n      ... on Error {\n        message\n      }\n    }\n  }\n"]);return eF=function(){return e},e}function eU(){var e=(0,eI._)(["\n  mutation DeleteWorkspaceConnection($input: DeleteConnectionInput!) {\n    deleteConnection(input: $input) {\n      ... on DeleteConnection {\n        success\n      }\n    }\n  }\n"]);return eU=function(){return e},e}var eG={},e$=(0,eA.gql)(eO()),ez=(0,eA.gql)(eN(),e$),eH=(0,eA.gql)(eM(),ez),eW=(0,eA.gql)(eL(),ez),eq=(0,eA.gql)(eB(),eH),eK=(0,eA.gql)(eV(),eW),eY=(0,eA.gql)(eF()),eQ=(0,eA.gql)(eU()),eX=e.i(917063),eJ=e.i(109900),eZ=e.i(801769),e0=e.i(24290),e1=e.i(696263),e2=e.i(275531),e3=e.i(968783),e4=e.i(858248),e8=e.i(709485),e5=e.i(344782),e6=e.i(613355),e9=e.i(140487),e7=e.i(734582),te=e.i(601059),tt=e.i(51054),tn=e.i(272119),tr=e.i(423828),ti=e.i(545969),to=e.i(960178),ta=e.i(625484),ts=e.i(283660),tl=e.i(406345),tu=e.i(940745),tc=e.i(742166),td=e.i(952030),tf=e.i(373764),tp=e.i(357399),th=e.i(975068),tg=[],tm=[],tv=function(e){var t=e.query,n=e.connectionsUsedInApp,r=e.onManage,i=e.onDelete,o=e.isLoading,a=(0,l._)((0,c.useState)(null),2),s=a[0],d=a[1],f=(0,c.useMemo)(function(){return new eR.Fzf(n,{fuzzy:!1,selector:function(e){return"".concat(e.displayName," ").concat(e.type)}})},[n]),p=(0,c.useMemo)(function(){return t?f.find(t).map(function(e){return e.item}):n},[f,t,n]),h=function(e){var t=e.item;return r?(0,u.jsx)(e9.Button,{iconLeft:(0,u.jsx)(tp.default,{}),variant:"default",text:"Manage",size:"small",onClick:function(){if("availableConnector"!==t.connectorType){var e;(0,e4.track)(e8.events.MANAGE_CONNECTION_CLICKED,{connectorName:t.connectorName}),r(null!=(e=t.connections)?e:[],t.connectorType)}}}):(0,u.jsx)(te.PopupMenu,{"aria-label":"Manage integration",trigger:(0,u.jsx)(e9.Button,{iconLeft:(0,u.jsx)(tp.default,{}),size:"small",variant:"default",text:"Manage"}),children:(0,u.jsx)(te.MenuItem,{id:"delete-".concat(t.id),label:"Delete",isDestructive:!0,onAction:function(){d(t)}})})};return(0,u.jsxs)(ta.View,{pt:12,children:[(0,u.jsx)(e7.IndexTable,{title:"",autoLayout:!1,columns:[{key:"name",label:"Name",allowSorting:!1,width:200,isRowHeader:!0},{key:"description",label:"Description",allowSorting:!1,maxWidth:760},{key:"status",label:"Connection Status",allowSorting:!1,width:118},{key:"actions",label:"",allowSorting:!1,width:99}],items:p,emptyState:t?void 0:(0,u.jsx)(function(){return(0,u.jsx)(ta.View,{className:th.default.centeredMessage,children:(0,u.jsx)(to.Text,{children:"No connections added to this app"})})},{}),loading:void 0!==o&&o,children:function(e){var t;return(0,u.jsxs)(tr.TableRow,{id:e.id,children:[(0,u.jsx)(tn.TableCell,{children:(0,u.jsxs)(ta.View,{gap:8,row:!0,align:"center",children:[(0,u.jsx)(ta.View,{children:(0,u.jsx)(eE.default,{width:24,height:24,src:null!=(t=e.iconPath)?t:"",alt:e.displayName})}),(0,u.jsx)(to.Text,{children:e.displayName})]})},"name"),(0,u.jsx)(tn.TableCell,{children:(0,u.jsx)(to.Text,{color:"dimmer",variant:"text",children:e.description})},"description"),(0,u.jsx)(tn.TableCell,{children:(0,u.jsx)(ta.View,{row:!0,children:"accountConnection"===e.connectorType&&(0,u.jsxs)(ta.View,{row:!0,gap:8,align:"center",children:[(0,u.jsx)(ts.default,{size:8,color:"healthy"===e.status?"green":"red"}),(0,u.jsx)(to.Text,{variant:"small",children:"healthy"===e.status?"Active":"Disconnected"})]})})},"status"),(0,u.jsx)(tn.TableCell,{children:(0,u.jsx)(ta.View,{row:!0,justify:"end",children:(0,u.jsx)(h,{item:e})})},"actions")]},e.id)}}),(0,u.jsx)(eX.DeleteIntegrationModal,{isOpen:!!s,setIsOpen:function(){return d(null)},onDelete:function(){return(0,eT._)(function(){var e,t,n,r;return(0,Y._)(this,function(o){switch(o.label){case 0:if(!(i&&(null==s||null==(t=s.connections)||null==(e=t[0])?void 0:e.connectionId)))return[3,2];return[4,i(null==s||null==(r=s.connections)||null==(n=r[0])?void 0:n.connectionId)];case 1:o.sent(),o.label=2;case 2:return d(null),[2]}})})()},connectorDisplayName:null==s?void 0:s.displayName})]})},tx=function(e,t){var n=e.filter(function(e){var n;return null==(n=e.repls)?void 0:n.some(function(e){return e.id===t})});return(0,e2.groupConnectionsByConnector)(n)},ty=function(e){var t,n,r=e.token,i=e.connections,o=e.connectorConfigs,d=e.orgId,f=e.openPane,p=e.connectionsUsedInApp,h=e.whitelist,g=e.refetch,m=e.isLoading,x=void 0!==m&&m,y=(0,l._)((t=(0,a._)({},eG,void 0),eD.useMutation(eY,t)),1)[0],b=(0,l._)((n=(0,a._)({},eG,void 0),eD.useMutation(eQ,n)),1)[0],w=(0,l._)((0,c.useState)(0),2),k=w[0],_=w[1],S=(0,l._)((0,c.useState)(null),2),C=S[0],j=S[1],T=(0,l._)((0,c.useState)(!1),2),E=T[0],R=T[1],I=(0,l._)((0,c.useState)(""),2),A=I[0],P=I[1],D=(0,l._)((0,c.useState)(null),2),O=D[0],N=D[1],M=(0,c.useCallback)(function(e){return(0,eT._)(function(){return(0,Y._)(this,function(t){switch(t.label){case 0:return[4,b({variables:{input:{connectionId:e,orgId:null!=d?d:null}},optimisticResponse:{__typename:"RootMutationType",deleteConnection:{__typename:"DeleteConnection",success:!0}},update:function(t){try{var n,r=t.readQuery({query:eq});if((null==r||null==(n=r.currentUser)?void 0:n.__typename)==="CurrentUser"){var i=r.currentUser.connectorContext.connections.filter(function(t){return t.connectionId!==e});t.writeQuery({query:eq,data:{currentUser:(0,s._)((0,a._)({},r.currentUser),{connectorContext:(0,s._)((0,a._)({},r.currentUser.connectorContext),{connections:i})})}})}}catch(e){}}})];case 1:return t.sent(),[4,g()];case 2:return t.sent(),[2]}})})()},[b,g,d]),L=function(e,t){j({connections:e,connectorType:t})};return C?(0,u.jsxs)(ta.View,{className:th.default.manageConnectionContainer,children:[(0,u.jsx)(eZ.ManageConnection,{connections:C.connections,connectorType:C.connectorType,onBack:function(){return j(null)},onDelete:function(){N(C.connections[0])}}),(0,u.jsx)(eX.DeleteIntegrationModal,{isOpen:!!O,setIsOpen:function(){return N(null)},onDelete:function(){return(0,eT._)(function(){return(0,Y._)(this,function(e){switch(e.label){case 0:if(!O)return[3,2];return[4,M(O.connectionId)];case 1:e.sent(),j(null),N(null),e.label=2;case 2:return[2]}})})()},connectorDisplayName:null==O?void 0:O.displayName})]}):(0,u.jsxs)(ta.View,{css:e6.rcss.pageContent,gap:32,children:[(0,u.jsxs)(ta.View,{align:"center",justify:"space-between",row:!0,children:[(0,u.jsxs)(ta.View,{gap:8,align:"center",row:!0,children:[(0,u.jsx)(tl.default,{size:24}),(0,u.jsx)(to.Header,{level:1,variant:"headerBig",children:"Integrations"})]}),(0,u.jsxs)(ta.View,{row:!0,gap:8,className:th.default.searchControlsDesktop,children:[(0,u.jsx)(tt.SearchBar,{placeholder:"Search integrations",value:A,onChange:function(e){return P(e.target.value)},onClear:function(){return P("")}}),d?null:(0,u.jsx)(e9.Button,{text:"Request an integration",iconLeft:(0,u.jsx)(td.default,{}),variant:"outlined",onClick:function(){return R(!0)}})]})]}),(0,u.jsxs)(ta.View,{row:!0,gap:8,className:th.default.searchControlsMobile,children:[(0,u.jsx)(tt.SearchBar,{placeholder:"Search integrations",value:A,onChange:function(e){return P(e.target.value)},onClear:function(){return P("")}}),d?null:(0,u.jsx)(e9.Button,{text:"Request an integration",iconLeft:(0,u.jsx)(td.default,{}),variant:"outlined",onClick:function(){return R(!0)}})]}),(0,u.jsxs)(ta.View,{gap:16,children:[(0,u.jsxs)(ta.View,{gap:4,children:[(0,u.jsx)(to.Header,{level:2,variant:"subheadBig",children:"Replit managed"}),(0,u.jsx)(to.Text,{color:"dimmer",children:"These are built-in integrations that work automatically. Create an app and your agent can start using these right away."})]}),(0,u.jsx)(e0.ReplitManagedTable,{query:A,openPane:void 0===f?function(){}:f})]}),(0,u.jsxs)(ta.View,{gap:16,children:[(0,u.jsx)(ta.View,{row:!0,justify:"space-between",align:"center",children:(0,u.jsxs)(ta.View,{gap:4,children:[(0,u.jsx)(to.Header,{level:2,variant:"subheadBig",children:"Connectors"}),(0,u.jsx)(to.Text,{color:"dimmer",children:"These are first-party integrations Replit supports. Sign in once and build with them across your apps."})]})}),(0,u.jsx)("div",{className:th.default.tabs,children:(0,u.jsxs)(ti.Tabs,{selectedKey:k,onSelectionChange:_,children:[(0,u.jsxs)(ti.TabList,{withDividers:!1,children:[(0,u.jsx)(ti.Tab,{id:"used",iconLeft:(0,u.jsx)(tc.default,{}),children:"Used in this App"}),(0,u.jsx)(ti.Tab,{id:"all",iconLeft:(0,u.jsx)(tf.default,{}),children:"All connectors"})]}),(0,u.jsx)("div",{className:th.default.tabPanels,children:(0,u.jsxs)(ti.TabPanels,{children:[(0,u.jsx)(ti.TabPanel,{id:"used",children:(0,u.jsx)(tv,{query:A,token:r,connectionsUsedInApp:p,onManage:L,onDelete:M,isLoading:x})}),(0,u.jsx)(ti.TabPanel,{id:"all",children:(0,u.jsx)(eX.ConnectorsShared,{token:r,connectorConfigs:o,connections:i,onDelete:M,onEvent:function(e){return(0,eT._)(function(){return(0,Y._)(this,function(t){switch(t.label){case 0:if("connect.connection-connected"!==e.name)return[3,2];return[4,y({variables:{input:{connectionId:e.data.connection_id,orgId:null!=d?d:null}}})];case 1:t.sent(),g(),_(1),t.label=2;case 2:return[2]}})})()},onManage:L,query:A,shouldShowConnectButton:!0,whitelist:h,isLoading:x})})]})})]})})]}),(0,u.jsx)(e5.McpServersSection,{query:A}),(0,u.jsx)(eJ.GitProvidersSection,{query:A}),d?null:(0,u.jsx)(e1.RequestNewConnectorModal,{isOpen:E,onRequestClose:function(){return R(!1)}})]})};let tb=function(e){var t,n,r,i,o,s,l=e.openPane,d=e.currentReplId,f=void 0===d?"":d,p=(0,e3.useCurrentUserStoredOrgContext)(),h=p.orgSlug,g=p.orgId,m=(t={ssr:!1,skip:!!g},n=(0,a._)({},eG,t),eP.useQuery(eq,n)),x=m.data,y=m.loading,b=m.error,w=m.refetch,k=(r={ssr:!1,skip:!g||!h,variables:h?{orgSlug:h}:void 0},i=(0,a._)({},eG,r),eP.useQuery(eK,i)),_=k.data,S=k.loading,C=k.error,j=k.refetch,T=y||S,E=g?j:w,R=(0,c.useMemo)(function(){var e,t,n,r,i,o,a,s,l,u,c=(null==_||null==(e=_.currentUser)?void 0:e.__typename)==="CurrentUser"&&(null==_||null==(n=_.currentUser)||null==(t=n.org)?void 0:t.__typename)==="Org"?null==_||null==(i=_.currentUser)||null==(r=i.org)?void 0:r.connectorContext:null,d=(null==x||null==(o=x.currentUser)?void 0:o.__typename)==="CurrentUser"?null==x||null==(a=x.currentUser)?void 0:a.connectorContext:null,p=g?c:d;if(!p)return{token:null,connections:tg,connectorConfigs:tm,connectionsUsedInApp:[]};var h=(null==p?void 0:p.__typename)==="CurrentUserConnectorContext"||(null==p?void 0:p.__typename)==="OrgConnectorContext"?p.openIntClientToken:null,m=((null==p?void 0:p.__typename)==="CurrentUserConnectorContext"||(null==p?void 0:p.__typename)==="OrgConnectorContext")&&null!=(s=p.connections)?s:tg,y=tx(m,f);return{token:h,connections:m,connectorConfigs:((null==p?void 0:p.__typename)==="CurrentUserConnectorContext"||(null==p?void 0:p.__typename)==="OrgConnectorContext")&&null!=(l=p.connectorConfigs)?l:tm,connectionsUsedInApp:y,connectorWhitelist:((null==p?void 0:p.__typename)==="CurrentUserConnectorContext"||(null==p?void 0:p.__typename)==="OrgConnectorContext")&&null!=(u=p.connectorWhitelist)?u:[]}},[g,x,_,f]);return T?(0,u.jsx)(ta.View,{className:th.default.centeredMessage,children:(0,u.jsx)(tu.default,{})}):b||C?(0,u.jsx)(ta.View,{className:th.default.centeredMessage,children:(0,u.jsx)(to.Text,{children:"Error loading connectors"})}):(0,u.jsx)(ty,{orgId:g,openPane:void 0===l?function(){}:l,currentReplId:f,token:null!=(o=R.token)?o:"",connections:R.connections,connectorConfigs:R.connectorConfigs,connectionsUsedInApp:R.connectionsUsedInApp,refetch:E,whitelist:null!=(s=R.connectorWhitelist)?s:[],isLoading:T})};var tw=e.i(207237),tk=e.i(142365),t_=e.i(806804);function tS(e){var t=e.openPane,n=(0,tw.default)(),r=(0,t_.default)("integrations-pane","integrations-toast").dismiss;return(0,c.useEffect)(function(){r()},[r]),(0,tk.useTrackEffect)(e8.events.INTEGRATIONS_PANE_USED,{action:"viewed"}),(0,u.jsx)(tb,{openPane:t,currentReplId:n})}var tC=d.Type.Object({type:d.Type.Literal("integrations")}),tj={Content:function(e){var t=e.options.performPaneOperation,n=(0,c.useCallback)(function(e){return t({operation:"open",secondary:!0,pane:e})},[t]);return(0,u.jsx)(tS,{openPane:n})},Icon:function(e){var t=e.size;return(0,u.jsx)(tl.default,{size:t})},getTitle:function(){return"Integrations"},description:"Connect to Replit-native and external services",category:ew.PaneCategory.CloudServices,decode:function(e){return f.Value.Decode(tC,e)}};e.s(["integrationsUI",()=>tj],637972);var tT=e.i(761201),tE=e.i(610357),tR=e.i(952685);e.i(545082);var tI=e.i(91442),tA=e.i(446530),tP=e.i(929872),tD=e.i(369948),tO=e.i(51606),tN=(0,tA.cssRecord)({button:{width:"fit-content"}});function tM(e){var t=e.code,n=e.activeFile,r=(0,tI.useGetCursorState)(),i=(0,tR.default)(n),o=i?{text:"Insert",iconRight:(0,u.jsx)(tD.default,{}),onClick:function(){var e,n,o;return i({code:t,insertAt:null!=(o=null==(n=r())||null==(e=n.position)?void 0:e.offset)?o:"end"})}}:{text:"Copy",iconLeft:(0,u.jsx)(tO.default,{}),onClick:function(){return(0,tE.default)(t)}};return(0,u.jsx)(tP.Surface,{background:"default",children:(0,u.jsx)(e9.Button,(0,a._)({size:"small",variant:"outlined",css:tN.button},o))})}var tL=e.i(480028),tB=e.i(607278),tV=(0,tA.cssRecord)({self:e6.rcss.colWithGap(4),content:[e6.rcss.backgroundColor.backgroundRoot,e6.rcss.borderRadius(4),e6.rcss.p(4),e6.rcss.align.center,e6.rcss.maxWidth("100%"),e6.rcss.overflowX("auto"),{width:"fit-content"}]});function tF(e){var t=e.method,n=e.content,r=e.activeFile,i=(0,l._)((0,c.useState)(n),2),o=i[0],a=i[1];return(0,u.jsxs)(ta.View,{css:tV.self,children:[(0,u.jsx)(tW,{title:t}),(0,u.jsx)(ta.View,{css:tV.content,row:!0,gap:4,children:o.map(function(e,n){var r="".concat(t,"-").concat(n);return"input"===e.type?(0,u.jsx)(tG,{i:n,value:e.value,placeholder:e.placeholder,setContent:a},r):(0,u.jsx)(tz,{value:e.value},r)})}),(0,u.jsx)(tM,{code:o.reduce(function(e,t){return e+(t.value||("input"===t.type?t.placeholder:""))},""),activeFile:r})]})}var tU=(0,tA.cssRecord)({self:[e6.rcss.width(64),e6.rcss.height(24),e6.rcss.zIndex(1)]});function tG(e){var t=e.i,n=e.value,r=e.placeholder,i=e.setContent;return(0,u.jsx)(tB.Input,{onChange:function(e){i(function(n){return n.map(function(n,r){return t===r?(0,s._)((0,a._)({},n),{value:e.target.value}):n})})},placeholder:r,value:n||"",css:tU.self})}var t$=(0,tA.cssRecord)({self:[e6.rcss.borderRadius(0),e6.rcss.backgroundColor.backgroundRoot],code:[e6.rcss.font.code,e6.rcss.color.greyStronger,e6.rcss.p(4),{whiteSpace:"pre-wrap"}]});function tz(e){var t=e.value;return(0,u.jsx)(ta.View,{css:t$.self,children:(0,u.jsx)(to.Text,{css:t$.code,children:t})})}var tH=(0,tA.cssRecord)({self:e6.rcss.rowWithGap(4),bold:{fontWeight:tL.tokens.fontWeightMedium}});function tW(e){var t=e.title,n=(0,l._)((0,g.default)(function(){var e=(0,ef._)(t.split(" "));return[e[0],e.slice(1).join(" ")]},[t]),2),r=n[0],i=n[1];return(0,u.jsxs)(ta.View,{css:tH.self,children:[(0,u.jsx)(to.Text,{css:tH.bold,multiline:!1,children:r}),(0,u.jsx)(to.Text,{color:"dimmer",multiline:!1,children:i})]})}var tq=((n=tq||{}).IMPORT="Import the database",n.CREATE="Create a new database",n.SET="Set a key to a value",n.GET="Get a key's value",n.DELETE="Delete a key",n.LIST="List all keys",n.LIST_PREFIX="List keys with a prefix",n),tK={language:"Bash",methods:[tJ("Set a key to a value","curl $REPLIT_DB_URL -d '{{key}} = {{value}}'"),tJ("Get a key's value","curl $REPLIT_DB_URL/{{key}}"),tJ("Delete a key","curl -XDELETE $REPLIT_DB_URL/{{key}}"),tJ("List all keys",'curl "$REPLIT_DB_URL?prefix={{key}}"')]},tY={language:"Node",methods:[tJ("Import the database",'const Database = require("@replit/database")'),tJ("Create a new database","const db = new Database()"),tJ("Set a key to a value",'db.set("{{key}}", "{{value}}").then(() => {})'),tJ("Get a key's value",'db.get("{{key}}").then(value => {})'),tJ("Delete a key",'db.delete("{{key}}").then(() => {})'),tJ("List all keys","db.list().then(keys => {\n  console.log(keys);\n})"),tJ("List keys with a prefix",'db.list("{{prefix}}").then(matches => {})')]},tQ={language:"Go",methods:[tJ("Import the database",'import "github.com/replit/database-go"'),tJ("Set a key to a value",'db.Set("{{key}}", "{{value}}")'),tJ("Get a key's value",'value, _ := database.Get("{{key}}")'),tJ("Delete a key",'database.Delete("{{key}}")'),tJ("List all keys",'keys, _ := database.ListKeys("")'),tJ("List keys with a prefix",'matches, _ := database.ListKeys("{{prefix}}")')]},tX={language:"Python",methods:[tJ("Import the database","from replit import db"),tJ("Set a key to a value",'db["{{key}}"] = "{{value}}"'),tJ("Get a key's value",'db["{{key}}"]'),tJ("Delete a key",'del db["{{key}}"]'),tJ("List all keys","keys = db.keys()\nprint(list(keys))"),tJ("List keys with a prefix",'matches = db.prefix("{{prefix}}")')]};function tJ(e,t){return{method:e,content:function(e){for(var t=[],n=0;n<e.length;){var r=e.indexOf("{{",n),i=e.indexOf("}}",n);if(-1===r||-1===i){t.push({type:"code",value:e.substring(n)});break}t.push({type:"code",value:e.substring(n,r)}),t.push({type:"input",placeholder:e.substring(r+2,i)}),n=i+2}return t}(t)}}var tZ=(0,tA.cssRecord)({self:e6.rcss.colWithGap(24),code:[e6.rcss.font.code,e6.rcss.color.greyStronger,e6.rcss.backgroundColor.backgroundRoot,e6.rcss.p(4),e6.rcss.borderRadius(4)]});function t0(e){var t=e.activeFile,n=(0,g.default)(function(){switch(t?(0,h.getExt)(t):"bash"){case"js":case"ts":case"tsx":case"jsx":case"mjs":return tY;case"go":return tQ;case"py":return tX;default:return tK}},[t]);return(0,u.jsxs)(ta.View,{css:tZ.self,children:[(0,u.jsxs)(to.Text,{color:"dimmer",children:["You can use the Database from any App by making HTTP requests or a client library as outlined below. Weve set an environment variable called ",(0,u.jsx)("code",{css:tZ.code,children:"REPLIT_DB_URL"})," in your App if you'd like to interact with the database directly."]}),n.methods.map(function(e){return(0,u.jsx)(tF,{method:e.method,content:e.content,activeFile:t},"".concat(n.language).concat(e.method))})]})}var t1=e.i(965153);function t2(e){var t=e.title,n=e.defaultExpanded,r=e.children;return(0,u.jsx)(t1.AccordionItem,{defaultExpanded:n,headerContent:(0,u.jsx)(to.Text,{variant:"subheadDefault",multiline:!1,children:t}),children:(0,u.jsx)(ta.View,{p:12,gap:8,children:r})})}var t3=e.i(546284),t4=e.i(967629),t8=e.i(6338),t5=e.i(27820),t6=(0,t4.keyframes)("from{opacity:0}to{opacity:1}"),t9=(0,tA.cssRecord)({self:[{animation:"".concat(t6," 100ms forwards ease-in-out alternate")}],selfLoadingText:[e6.rcss.height(16),e6.rcss.width(48),e6.rcss.borderRadius(4),t8.loadingStyle.backgroundPulse()],selfLoading:[e6.rcss.height(12),e6.rcss.borderRadius(16),t8.loadingStyle.backgroundPulse()],text:[e6.rcss.rowWithGap(4),{display:"inline-flex"}],textSpan:[e6.rcss.width("fit-content"),e6.rcss.display.inlineFlex]});function t7(e){var t,n,r=e.database,i=e.loading,o=(null==r?void 0:r.sizeMB)||0,a=(t=1e6*(t=o)/1048576,"".concat(t.toFixed(),"/50 MiB")),s=i||!r;return(0,u.jsx)(ta.View,{css:t9.self,gap:8,children:s?(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)(ta.View,{css:t9.selfLoadingText}),(0,u.jsx)(ta.View,{css:t9.selfLoading})]}):(0,u.jsxs)(u.Fragment,{children:[(0,u.jsxs)(to.Text,{color:"dimmer",css:t9.text,multiline:!1,children:[(0,u.jsx)(ta.SpecializedView.span,{css:t9.textSpan,children:a}),(0,u.jsx)(ta.SpecializedView.span,{css:t9.textSpan,children:"|"}),(0,u.jsx)(ta.SpecializedView.span,{css:t9.textSpan,children:(n=(n=null==r?void 0:r.keysCount)||0,"".concat(n," ").concat((0,t3.default)("key",n)))})]}),(0,u.jsx)(t5.MeasureBar,{current:o,total:50,tooltip:a})]})},s?"databaseLoadingStats":"databaseLoadedStats")}function ne(){var e=(0,eI._)(["\n  fragment DatabaseUsage on Database {\n    id\n    keysCount\n    sizeMB\n  }\n"]);return ne=function(){return e},e}function nt(){var e=(0,eI._)(["\n  query Database($replID: String!) {\n    getRepl(id: $replID) {\n      ... on Repl {\n        id\n        database {\n          id\n          ...DatabaseUsage\n        }\n      }\n    }\n    currentUser {\n      id\n      isLoggedIn\n    }\n  }\n  ","\n"]);return nt=function(){return e},e}var nn={},nr=(0,eA.gql)(ne()),ni=(0,eA.gql)(nt(),nr),no=e.i(712516),na=e.i(827456),ns=e.i(91720),nl=e.i(396776),nu=e.i(934565),nc=(0,tA.cssRecord)({sectionWrapper:[e6.rcss.width("100%"),e6.rcss.maxWidth(450)]});function nd(){var e,t,n,r,i,o,s,l,c,d=(s=(r={variables:{replID:(0,tw.default)()},pollInterval:1e4},i=(0,a._)({},nn,r),o=eP.useQuery(ni,i)).data,l=o.error,c=o.loading,s&&("Repl"===s.getRepl.__typename?t=null==s||null==(n=s.getRepl)?void 0:n.database:e="Could not fetch Database info"),l&&("GraphQL error: You don't have access to this database"===l.message?t=null:e=l.message),{db:t,loading:c,error:e}),f=d.db,p=d.error,h=d.loading,g=(0,tI.useCursorFilepath)(),m=(0,na.usePaneUIContext)().getTitle({type:"database"});return(0,u.jsx)(no.default,{pane:{type:"database"},headerText:m,action:(0,u.jsxs)(ta.View,{css:nc.sectionWrapper,gap:16,children:[p?(0,u.jsx)(nl.StatusBanner,{colorway:"negative",text:p}):null,(0,u.jsx)(t2,{title:"Storage capacity",children:(0,u.jsx)(t7,{database:f,loading:h})}),(0,u.jsx)(t2,{title:"How to use the database",children:(0,u.jsx)(t0,{activeFile:g})}),(0,u.jsx)(ns.ButtonLink,{href:tT.LINKS_DOCS.REPL_DATABASE,target:"_blank",rel:"noopener",iconLeft:(0,u.jsx)(nu.default,{}),text:"Learn more in the docs"})]})})}var nf=e.i(606867),np=e.i(515313),nh=d.Type.Object({type:d.Type.Literal("database")}),ng={Content:function(){return(0,u.jsx)(nd,{})},Icon:function(e){var t=e.size;return(0,u.jsx)(nf.IconContext.Provider,{value:{color:tL.tokens.blurpleStronger,size:t},children:(0,u.jsx)(np.default,{})})},getTitle:function(){return"Replit Key-Value Store"},description:"Free, easy-to-use key-value store suitable for unstructured data, caching, session management, fast lookups, and flexible data models",category:ew.PaneCategory.CloudServices,decode:function(e){return f.Value.Decode(nh,e)}};e.s(["kvStoreUI",()=>ng],224986);var nm=e.i(316699),nv=e.i(903381),nx=e.i(736451),ny=e.i(649960),nb=e.i(376363),nw=e.i(529810),nk=e.i(106020),n_=e.i(411928),nS=e.i(406206),nC=(0,tA.cssRecord)({root:[e6.rcss.coverContainer,e6.rcss.center]});function nj(){return(0,u.jsx)(ta.View,{css:nC.root,children:(0,u.jsx)(tu.default,{size:32})})}var nT=e.i(877249),nE=e.i(718610),nR=(0,c.memo)(n_.default),nI=(0,tA.cssRecord)({bodyRoot:[e6.rcss.overflowY("auto")],contentRoot:[e6.rcss.height("100%"),e6.rcss.width("100%"),e6.rcss.overflow("auto"),e6.rcss.zIndex(2),e6.rcss.align.center,e6.rcss.py(16),e6.rcss.px(16),e6.rcss.borderRadius(8),(0,C._)({margin:"0 auto"},"@media only screen and (min-width: ".concat(nT.BREAKPOINTS.tabletMin,"px)"),e6.rcss.px(32))],emptyState:[{"& button":[{color:tL.tokens.foregroundDimmer}]}],markdownContainer:[e6.rcss.width("100%"),{"& .rendered-markdown":[e6.rcss.flex.column,e6.rcss.center],"& .rendered-markdown > *":[e6.rcss.maxWidth(840),e6.rcss.width("100%")],"& .rendered-markdown > table":e6.rcss.maxWidth("100%")}],paneRoot:[e6.rcss.position.relative,e6.rcss.display.flex,e6.rcss.flex.column,e6.rcss.overflowY("hidden"),e6.rcss.height("100%"),e6.rcss.width("100%")]});function nA(e){var t,n,r=(0,nw.default)().fs,i=(0,l._)((t=(0,c.useRef)(!1),n=(0,c.useRef)(null),[(0,ny.default)(function(){t.current=!0,n.current&&clearTimeout(n.current),n.current=setTimeout(function(){t.current=!1},150)},{type:"throttle",wait:37.5}),t]),2),o=i[0],a=i[1],s=(0,c.useRef)(null),d=(0,nx.usePrefersReducedMotion)(),f=e.path,p=e.performPaneOperation,h=(0,c.useCallback)(function(){p({operation:"replace",pane:{type:"codeEditor",data:{path:f}}}),p({operation:"commit"})},[p,f]);(0,ek.useSetPaneBindings)(function(){return{commands:[{commands:[{match:nk.matchLabel,data:{label:"Open in Editor",icon:(0,u.jsx)(nE.default,{}),type:"action",run:h}}]}]}},[h]);var g=e.isHidden,m=(0,tI.useObservableCursorState)();(0,c.useEffect)(function(){if(!g){var e=(0,nm.default)(function(e){(0,nb.default)(e,{behavior:d?"auto":"smooth",scrollMode:"if-needed"})},100),t=(0,nm.default)(function(t){if(f===(null==t?void 0:t.path)&&t&&!a.current){var n=s.current?function(e,t){var n=e.querySelectorAll(".rendered-markdown [data-sourcepos]");if(!(null==n?void 0:n.length))return null;var r=Array.from(n).reverse(),i=t.line,o=t.column,a=!0,s=!1,u=void 0;try{for(var c,d=r[Symbol.iterator]();!(a=(c=d.next()).done);a=!0){var f=c.value,p=f.dataset.sourcepos;if(!p)throw Error("Expected data source pos on selected element");var h=(0,l._)(p.split("-"),2),g=h[0],m=h[1],x=(0,l._)(g.split(":").map(Number),2),y=x[0],b=x[1],w=(0,l._)(m.split(":").map(Number),2),k=w[0],_=w[1];if(i>=y&&o>=b&&(i<k||i===k&&o<=_))return f}}catch(e){s=!0,u=e}finally{try{a||null==d.return||d.return()}finally{if(s)throw u}}}(s.current,t.position):null;n&&e(n)}},200),n=m.subscribe(t);return function(){t.cancel(),e.cancel(),n()}}},[m,g,d,f]);var y=(0,l._)((0,c.useState)(null),2),b=y[0],w=y[1];return(0,c.useEffect)(function(){return w(null),r.watchTextFile(f,{onReady:function(e){w(e.initialContent.toString())},onChange:function(e){w(e.latestContent)},onMoveOrDelete:function(e){e.eventType===nv.ChangeEventType.Delete&&p({operation:"replace",pane:{type:"commands",data:{autoFocus:!0}}})}})},[f,r,p]),(0,u.jsxs)(ta.View,{css:nI.paneRoot,children:[(0,u.jsx)(x.FileHeader,{path:e.path,performPaneOperation:p,children:b&&b.trim().length?(0,u.jsx)(nS.PaneHeaderActionButton,{altText:"Open file in editor",buttonText:"Open in Editor",onClick:h,icon:(0,u.jsx)(nE.default,{})}):null}),(0,u.jsx)(ta.View,{css:nI.bodyRoot,grow:!0,shrink:!0,children:(0,u.jsx)(nP,{ref:o,content:b,fs:r,markdownContainerRef:s,openInEditor:h,path:f})})]})}var nP=(0,c.forwardRef)(function(e,t){var n=e.content,r=e.fs,i=e.markdownContainerRef,o=e.openInEditor,a=e.path;return null===n?(0,u.jsx)(nD,{}):(0,u.jsx)(ta.View,{css:nI.contentRoot,gap:8,innerRef:t,children:(0,u.jsx)(ta.View,{innerRef:i,css:nI.markdownContainer,children:n.trim().length?(0,u.jsx)(nR,{path:a,source:n,fs:r,sourcePos:!0}):(0,u.jsx)("div",{className:"rendered-markdown rendered-markdown-empty",children:(0,u.jsxs)(ta.View,{css:nI.emptyState,gap:4,align:"center",innerRef:t,children:[(0,u.jsx)(to.Text,{color:"dimmer",children:(0,u.jsx)("i",{children:"This file is empty"})}),(0,u.jsx)(e9.Button,{text:"Open in Editor",iconLeft:(0,u.jsx)(nE.default,{}),onClick:o,variant:"nofill"})]})})})})});function nD(){var e=(0,l._)((0,c.useState)(!1),2),t=e[0],n=e[1];return(0,c.useEffect)(function(){var e=setTimeout(function(){return n(!0)},500);return function(){clearTimeout(e)}},[]),t?(0,u.jsx)(nj,{}):null}var nO=e.i(1289),nN=d.Type.Object({type:d.Type.Literal("markdown"),data:d.Type.Object({path:d.Type.String({minLength:1})})}),nM={Content:function(e){var t=e.pane,n=e.options;return(0,u.jsx)(nA,{path:t.data.path,isHidden:!!n.isHidden,performPaneOperation:n.performPaneOperation})},Icon:function(e){var t=e.size;return(0,u.jsx)(nO.default,{fill:"currentColor",size:t})},getTitle:function(e){return e.data.path?(0,h.getFileName)(e.data.path):"Markdown"},category:ew.PaneCategory.WorkspaceFeatures,decode:function(e){return f.Value.Decode(nN,e)}};e.s(["markdownPreviewUi",()=>nM],466638);var nL=e.i(294468),nB=e.i(296223),nV=e.i(630818),nF=d.Type.Object({type:d.Type.Literal("media"),data:d.Type.Object({path:d.Type.String()})}),nU={Content:function(e){var t=e.pane,n=e.options;return(0,u.jsx)(nG,{path:t.data.path,performPaneOperation:n.performPaneOperation})},Icon:function(e){var t=e.pane,n=e.size;return(0,u.jsx)(nV.default,{path:t.data.path,size:n})},getTitle:function(e){return(0,h.getFileName)(e.data.path)},category:ew.PaneCategory.WorkspaceFeatures,decode:function(e){return f.Value.Decode(nF,e)}};function nG(e){var t=e.path,n=e.performPaneOperation,r=(0,nw.default)().fs,i=(0,m.useFileCommands)({path:t,performPaneOperation:n}),o=i?(0,U._)(i):[],a=(0,c.useCallback)(function(){n({operation:"replace",pane:{type:"codeEditor",data:{path:t}}})},[n,t]),s={match:nk.matchLabel,data:{label:"Open in Editor",icon:(0,u.jsx)(nE.default,{}),type:"action",run:function(){a()}}};return(0,h.isSVGFile)(t)&&o.push(s),(0,ek.useSetPaneBindings)(function(){if(i)return{commands:[{commands:o}]}},[i]),(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)(x.FileHeader,{path:t,performPaneOperation:n,children:(0,u.jsx)(nS.PaneHeaderActionButton,{altText:"Open file in editor",buttonText:"Open in Editor",onClick:a,icon:(0,u.jsx)(nE.default,{})})}),(0,u.jsx)(nL.Content,{centered:!0,children:(0,u.jsx)(nB.default,{filePath:t,fs:r})})]})}e.s(["mediaUI",()=>nU],138071);var n$=e.i(984556),nz=["B","KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"],nH=["B","KB","MB","GB","TB","PB","EB","ZB","YB"];function nW(e,t){var n,r=t||{},i=r.signed,o=r.digitsNumber,a=r.isKib,s=r.isKibNotation;if(n=void 0!==i&&i?e<0?"-":"+":"",0===e)return"".concat(n,"0B");var l=void 0===a||a?1024:1e3,u=Math.floor(Math.log(Math.abs(e))/Math.log(l));return"".concat(n).concat(parseFloat(Math.abs(e/Math.pow(l,u)).toFixed(void 0===o?2:o))).concat((void 0!==s&&s?nz:nH)[u])}var nq=e.i(262664),nK=e.i(424746),nY=d.Type.Literal("overview-page"),nQ=d.Type.Literal("db-page");d.Type.Union([nY,nQ]);var nX=d.Type.Literal("overview"),nJ=d.Type.Literal("commands"),nZ=d.Type.Literal("settings"),n0=d.Type.Literal("drizzle-studio");d.Type.Union([nX,nJ,nZ,n0]);var n1=d.Type.Object({databaseId:d.Type.Integer()}),n2=d.Type.Optional(n1),n3=(0,c.createContext)(void 0),n4=function(e){var t,n,r,i,o,d,p,h,g,m,x=e.children,y=e.initialOpenAtDatabase,b=e.performPaneOperation,w=(0,c.useCallback)(function(e){b({operation:"open",pane:e})},[b]),k=(0,c.useCallback)(function(){b({operation:"replace",pane:{type:"neon"}})},[b]),_=(0,l._)((0,c.useState)("overview"),2),S=_[0],C=_[1],j=(0,c.useCallback)(function(e){C(e),k()},[k]),T=(0,l._)((0,c.useState)(f.Value.Check(n2,y)?y.databaseId:null),2),E=T[0],R=T[1],I=(0,l._)((0,c.useState)(f.Value.Check(n2,y)?"db-page":"overview-page"),2),A=I[0],P=I[1];(0,c.useEffect)(function(){y&&f.Value.Check(n2,y)&&(P("db-page"),R(y.databaseId))},[y]);var D=(0,l._)((0,c.useState)(null),2),O=D[0],N=D[1],M=(0,l._)((0,c.useState)(null),2),L=M[0],B=M[1],V=(0,c.useCallback)(function(e){N(e),k()},[k]),F=(0,c.useCallback)(function(e){B(e),k()},[k]),G=(0,c.useCallback)(function(e){R(e),k()},[k]),$=(n=(t=(0,nK.useNeonDevelopmentDatabase)()).database,r=t.loading,o=(i=(0,nK.useNeonProductionDatabase)()).database,d=i.loading,h=(p=(0,nq.useHeliumDevelopmentDatabase)()).database,g=p.loading,m=[n,o].filter(Boolean),{databases:(0,c.useMemo)(function(){return(0,U._)(m.map(function(e){var t;return(0,s._)((0,a._)({},e),{kind:"neon",maxSizeBytes:parseFloat(null!=(t=e.quotaLogicalSizeBytes)?t:"0")})})).concat((0,U._)(h&&void 0===n?[h]:[]))},[m,h,n]),loading:r||d||g}),z=$.databases,H=$.loading;return(0,u.jsx)(n3.Provider,{value:{selectedTab:S,selectTab:j,selectedPage:A,selectPage:P,selectedSchema:O,selectSchema:V,selectedTable:L,selectTable:F,selectedDatabaseId:E,selectDatabaseId:G,databases:z,loading:H,openPane:w},children:x})},n8=function(){var e=(0,c.useContext)(n3);if(!e)throw Error("useDatabaseContext must be used within a DatabasePaneProvider");return e},n5=e.i(906368),n6=(0,c.createContext)(null),n9=function(){var e=(0,c.useContext)(n6);if(!e)throw Error("useRefreshContext must be used within a RefreshProvider");return e},n7=function(e,t){var n=n9(),r=n.registerRefresh,i=n.unregisterRefresh;(0,c.useEffect)(function(){if(t)return r(e,t),function(){return i(e)}},[e,t,r,i])};function re(e,t){return(0,c.useCallback)(function(){for(var n=arguments.length,r=Array(n),i=0;i<n;i++)r[i]=arguments[i];return(0,eT._)(function(){var n;return(0,Y._)(this,function(i){switch(i.label){case 0:t(!0),i.label=1;case 1:return i.trys.push([1,3,4,5]),[4,e.apply(void 0,(0,U._)(r))];case 2:return i.sent(),[3,5];case 3:return n=i.sent(),n5.captureException(n),[3,5];case 4:return t(!1),[7];case 5:return[2]}})})()},[e,t])}var rt=function(e){var t=e.children,n=(0,l._)((0,c.useState)(!1),2),r=n[0],i=n[1],o=n8().selectedPage,a=(0,c.useRef)(new Map),s=(0,c.useCallback)(function(e,t){a.current.set(e,t)},[]),d=(0,c.useCallback)(function(e){a.current.delete(e)},[]),f=re(function(e){return(0,eT._)(function(){var t;return(0,Y._)(this,function(n){switch(n.label){case 0:return[4,null==(t=a.current.get(e))?void 0:t()];case 1:return n.sent(),[2]}})})()},i),p=re(function(){return(0,eT._)(function(){var e,t;return(0,Y._)(this,function(n){switch(n.label){case 0:if("overview-page"!==o)return[3,2];return[4,Promise.all([null==(e=a.current.get(o))?void 0:e()].concat((0,U._)(Array.from(a.current.entries()).map(function(e){var t=(0,l._)(e,2),n=t[0],r=t[1];return(0,eT._)(function(){return(0,Y._)(this,function(e){switch(e.label){case 0:if(!n.startsWith("database-item-"))return[3,2];return[4,r()];case 1:return e.sent(),[3,3];case 2:return[2,Promise.resolve()];case 3:return[2]}})})()}))))];case 1:return n.sent(),[3,4];case 2:return[4,null==(t=a.current.get(o))?void 0:t()];case 3:n.sent(),n.label=4;case 4:return[2]}})})()},i);return(0,u.jsx)(n6.Provider,{value:{refreshing:r,registerRefresh:s,unregisterRefresh:d,refreshByKey:f,refreshCurrentContext:p},children:t})},rn=e.i(832550),rr=e.i(782096),ri=e.i(785719),ro=e.i(851581),ra=t8.loadingStyle.backgroundPulse(tL.tokens.backgroundHigher,tL.tokens.backgroundHighest),rs=function(e){var t,n=e.name,r=e.storage,i=e.loading,o=e.onClick,a=e.isSelected,s=e.isFrozen,l=void 0!==s&&s;return(0,u.jsxs)(ta.View,{row:!0,align:"center",justify:"space-between",clsx:(t={},(0,C._)(t,ro.default.container,o),(0,C._)(t,ro.default.containerSelected,o&&void 0!==a&&a),(0,C._)(t,ro.default.containerNotClickable,!o),t),onClick:o,children:[(0,u.jsxs)(ta.View,{row:!0,align:"center",gap:12,children:[l?(0,u.jsx)(ri.default,{}):(0,u.jsx)(np.default,{}),(0,u.jsxs)(ta.View,{children:[(0,u.jsx)(to.Text,{variant:"subheadDefault",children:n}),i?(0,u.jsx)(ta.View,{css:ra,className:ro.default.skeletonText}):(0,u.jsx)(to.Text,{variant:"small",color:"dimmer",children:l?"Database is paused":r})]})]}),o?(0,u.jsx)(rr.default,{}):null]})},rl=e.i(912790),ru=e.i(902071),rc=t8.loadingStyle.backgroundPulse(tL.tokens.backgroundHigher,tL.tokens.backgroundHighest),rd=function(e){var t=e.databases,n=e.onSelectDatabase,r=(0,n$.useDatabaseUsageSectionCurrentUserQuery)(),i=r.data,o=r.refetch,a=(0,c.useMemo)(function(){return function(e){var t,n,r=e.data;if((null==r||null==(t=r.currentUser)?void 0:t.__typename)==="CurrentUser"){var i=null==r||null==(n=r.currentUser)?void 0:n.usageInterval;if(i&&"UsageInterval"===i.__typename){var o=i.resources.neonComputeTime.usage;return{computeTimeUsageFormatted:(0,rl.toDisplaySize)(o,{resourceUsageType:"Hours"}),renewalInfo:new Date(i.endDate).toLocaleString("default",{month:"short",day:"numeric"})}}}}({data:i})},[i]),s=void 0===a;return n7("overview-page",o),(0,u.jsx)(ta.View,{row:!1,className:ru.default.wrapper,children:(0,u.jsxs)(ta.View,{p:16,gap:8,grow:1,children:[(0,u.jsx)(to.Text,{variant:"subheadDefault",children:"Databases"}),(0,u.jsx)(ta.View,{className:ru.default.databaseGrid,children:t.map(function(e){return(0,u.jsx)(rf,{database:e,onSelectDatabase:n},e.databaseId)})}),(0,u.jsxs)(ta.View,{gap:8,pt:8,children:[(0,u.jsx)(to.Text,{variant:"subheadDefault",children:"Billing Period"}),s?(0,u.jsx)(ta.View,{css:rc,className:ru.default.skeletonText}):(0,u.jsxs)(to.Text,{variant:"small",color:"dimmer",children:["Renews monthly, ",null==a?void 0:a.renewalInfo]})]}),(0,u.jsxs)(ta.View,{gap:8,pt:8,children:[(0,u.jsx)(to.Text,{variant:"subheadDefault",children:"Hours of Compute Used"}),s?(0,u.jsx)(ta.View,{css:rc,className:ru.default.skeletonText}):(0,u.jsx)(to.Text,{variant:"small",color:"dimmer",children:null==a?void 0:a.computeTimeUsageFormatted})]})]})})},rf=function(e){var t=e.database,n=e.onSelectDatabase,r=n8().selectPage,i=(0,rn.useGetDatabaseSize)(t),o=i.databaseSize,a=i.loading,s=i.refetch;n7("database-item-".concat(t.databaseId),s);var l="".concat(nW(o)," / ").concat(nW(t.maxSizeBytes));return(0,u.jsx)(rs,{name:"neon"===t.kind&&"production"===t.type?"Production Database":"Development Database",isFrozen:"neon"===t.kind&&t.isFrozen,loading:a,storage:l,onClick:function(){n(t),r("db-page")}})},rp=e.i(399528),rh=e.i(850834),rg=e.i(368964),rm=e.i(196127);function rv(){var e=(0,eI._)(["\n  query NeonStartPage($replId: String!) {\n    currentUser {\n      id\n      usageInterval {\n        ... on UsageInterval {\n          resources {\n            neonComputeTime {\n              allotment\n              usage\n            }\n            neonDataStorage {\n              allotment\n              usage\n            }\n          }\n        }\n      }\n    }\n    getRepl(id: $replId) {\n      ... on Repl {\n        id\n        authorizations {\n          createDatabase {\n            isAuthorized\n            code\n            message\n          }\n        }\n      }\n    }\n  }\n"]);return rv=function(){return e},e}var rx={},ry=(0,eA.gql)(rv()),rb=e.i(629536),rw=e.i(569910),rk=e.i(330666);let r_={version:4,country_calling_codes:{1:["US","AG","AI","AS","BB","BM","BS","CA","DM","DO","GD","GU","JM","KN","KY","LC","MP","MS","PR","SX","TC","TT","VC","VG","VI"],7:["RU","KZ"],20:["EG"],27:["ZA"],30:["GR"],31:["NL"],32:["BE"],33:["FR"],34:["ES"],36:["HU"],39:["IT","VA"],40:["RO"],41:["CH"],43:["AT"],44:["GB","GG","IM","JE"],45:["DK"],46:["SE"],47:["NO","SJ"],48:["PL"],49:["DE"],51:["PE"],52:["MX"],53:["CU"],54:["AR"],55:["BR"],56:["CL"],57:["CO"],58:["VE"],60:["MY"],61:["AU","CC","CX"],62:["ID"],63:["PH"],64:["NZ"],65:["SG"],66:["TH"],81:["JP"],82:["KR"],84:["VN"],86:["CN"],90:["TR"],91:["IN"],92:["PK"],93:["AF"],94:["LK"],95:["MM"],98:["IR"],211:["SS"],212:["MA","EH"],213:["DZ"],216:["TN"],218:["LY"],220:["GM"],221:["SN"],222:["MR"],223:["ML"],224:["GN"],225:["CI"],226:["BF"],227:["NE"],228:["TG"],229:["BJ"],230:["MU"],231:["LR"],232:["SL"],233:["GH"],234:["NG"],235:["TD"],236:["CF"],237:["CM"],238:["CV"],239:["ST"],240:["GQ"],241:["GA"],242:["CG"],243:["CD"],244:["AO"],245:["GW"],246:["IO"],247:["AC"],248:["SC"],249:["SD"],250:["RW"],251:["ET"],252:["SO"],253:["DJ"],254:["KE"],255:["TZ"],256:["UG"],257:["BI"],258:["MZ"],260:["ZM"],261:["MG"],262:["RE","YT"],263:["ZW"],264:["NA"],265:["MW"],266:["LS"],267:["BW"],268:["SZ"],269:["KM"],290:["SH","TA"],291:["ER"],297:["AW"],298:["FO"],299:["GL"],350:["GI"],351:["PT"],352:["LU"],353:["IE"],354:["IS"],355:["AL"],356:["MT"],357:["CY"],358:["FI","AX"],359:["BG"],370:["LT"],371:["LV"],372:["EE"],373:["MD"],374:["AM"],375:["BY"],376:["AD"],377:["MC"],378:["SM"],380:["UA"],381:["RS"],382:["ME"],383:["XK"],385:["HR"],386:["SI"],387:["BA"],389:["MK"],420:["CZ"],421:["SK"],423:["LI"],500:["FK"],501:["BZ"],502:["GT"],503:["SV"],504:["HN"],505:["NI"],506:["CR"],507:["PA"],508:["PM"],509:["HT"],590:["GP","BL","MF"],591:["BO"],592:["GY"],593:["EC"],594:["GF"],595:["PY"],596:["MQ"],597:["SR"],598:["UY"],599:["CW","BQ"],670:["TL"],672:["NF"],673:["BN"],674:["NR"],675:["PG"],676:["TO"],677:["SB"],678:["VU"],679:["FJ"],680:["PW"],681:["WF"],682:["CK"],683:["NU"],685:["WS"],686:["KI"],687:["NC"],688:["TV"],689:["PF"],690:["TK"],691:["FM"],692:["MH"],850:["KP"],852:["HK"],853:["MO"],855:["KH"],856:["LA"],880:["BD"],886:["TW"],960:["MV"],961:["LB"],962:["JO"],963:["SY"],964:["IQ"],965:["KW"],966:["SA"],967:["YE"],968:["OM"],970:["PS"],971:["AE"],972:["IL"],973:["BH"],974:["QA"],975:["BT"],976:["MN"],977:["NP"],992:["TJ"],993:["TM"],994:["AZ"],995:["GE"],996:["KG"],998:["UZ"]},countries:{AC:["247","00","(?:[01589]\\d|[46])\\d{4}",[5,6]],AD:["376","00","(?:1|6\\d)\\d{7}|[135-9]\\d{5}",[6,8,9],[["(\\d{3})(\\d{3})","$1 $2",["[135-9]"]],["(\\d{4})(\\d{4})","$1 $2",["1"]],["(\\d{3})(\\d{3})(\\d{3})","$1 $2 $3",["6"]]]],AE:["971","00","(?:[4-7]\\d|9[0-689])\\d{7}|800\\d{2,9}|[2-4679]\\d{7}",[5,6,7,8,9,10,11,12],[["(\\d{3})(\\d{2,9})","$1 $2",["60|8"]],["(\\d)(\\d{3})(\\d{4})","$1 $2 $3",["[236]|[479][2-8]"],"0$1"],["(\\d{3})(\\d)(\\d{5})","$1 $2 $3",["[479]"]],["(\\d{2})(\\d{3})(\\d{4})","$1 $2 $3",["5"],"0$1"]],"0"],AF:["93","00","[2-7]\\d{8}",[9],[["(\\d{2})(\\d{3})(\\d{4})","$1 $2 $3",["[2-7]"],"0$1"]],"0"],AG:["1","011","(?:268|[58]\\d\\d|900)\\d{7}",[10],0,"1",0,"([457]\\d{6})$|1","268$1",0,"268"],AI:["1","011","(?:264|[58]\\d\\d|900)\\d{7}",[10],0,"1",0,"([2457]\\d{6})$|1","264$1",0,"264"],AL:["355","00","(?:700\\d\\d|900)\\d{3}|8\\d{5,7}|(?:[2-5]|6\\d)\\d{7}",[6,7,8,9],[["(\\d{3})(\\d{3,4})","$1 $2",["80|9"],"0$1"],["(\\d)(\\d{3})(\\d{4})","$1 $2 $3",["4[2-6]"],"0$1"],["(\\d{2})(\\d{3})(\\d{3})","$1 $2 $3",["[2358][2-5]|4"],"0$1"],["(\\d{3})(\\d{5})","$1 $2",["[23578]"],"0$1"],["(\\d{2})(\\d{3})(\\d{4})","$1 $2 $3",["6"],"0$1"]],"0"],AM:["374","00","(?:[1-489]\\d|55|60|77)\\d{6}",[8],[["(\\d{3})(\\d{2})(\\d{3})","$1 $2 $3",["[89]0"],"0 $1"],["(\\d{3})(\\d{5})","$1 $2",["2|3[12]"],"(0$1)"],["(\\d{2})(\\d{6})","$1 $2",["1|47"],"(0$1)"],["(\\d{2})(\\d{6})","$1 $2",["[3-9]"],"0$1"]],"0"],AO:["244","00","[29]\\d{8}",[9],[["(\\d{3})(\\d{3})(\\d{3})","$1 $2 $3",["[29]"]]]],AR:["54","00","(?:11|[89]\\d\\d)\\d{8}|[2368]\\d{9}",[10,11],[["(\\d{4})(\\d{2})(\\d{4})","$1 $2-$3",["2(?:2[024-9]|3[0-59]|47|6[245]|9[02-8])|3(?:3[28]|4[03-9]|5[2-46-8]|7[1-578]|8[2-9])","2(?:[23]02|6(?:[25]|4[6-8])|9(?:[02356]|4[02568]|72|8[23]))|3(?:3[28]|4(?:[04679]|3[5-8]|5[4-68]|8[2379])|5(?:[2467]|3[237]|8[2-5])|7[1-578]|8(?:[2469]|3[2578]|5[4-8]|7[36-8]|8[5-8]))|2(?:2[24-9]|3[1-59]|47)","2(?:[23]02|6(?:[25]|4(?:64|[78]))|9(?:[02356]|4(?:[0268]|5[2-6])|72|8[23]))|3(?:3[28]|4(?:[04679]|3[78]|5(?:4[46]|8)|8[2379])|5(?:[2467]|3[237]|8[23])|7[1-578]|8(?:[2469]|3[278]|5[56][46]|86[3-6]))|2(?:2[24-9]|3[1-59]|47)|38(?:[58][78]|7[378])|3(?:4[35][56]|58[45]|8(?:[38]5|54|76))[4-6]","2(?:[23]02|6(?:[25]|4(?:64|[78]))|9(?:[02356]|4(?:[0268]|5[2-6])|72|8[23]))|3(?:3[28]|4(?:[04679]|3(?:5(?:4[0-25689]|[56])|[78])|58|8[2379])|5(?:[2467]|3[237]|8(?:[23]|4(?:[45]|60)|5(?:4[0-39]|5|64)))|7[1-578]|8(?:[2469]|3[278]|54(?:4|5[13-7]|6[89])|86[3-6]))|2(?:2[24-9]|3[1-59]|47)|38(?:[58][78]|7[378])|3(?:454|85[56])[46]|3(?:4(?:36|5[56])|8(?:[38]5|76))[4-6]"],"0$1",1],["(\\d{2})(\\d{4})(\\d{4})","$1 $2-$3",["1"],"0$1",1],["(\\d{3})(\\d{3})(\\d{4})","$1-$2-$3",["[68]"],"0$1"],["(\\d{3})(\\d{3})(\\d{4})","$1 $2-$3",["[23]"],"0$1",1],["(\\d)(\\d{4})(\\d{2})(\\d{4})","$2 15-$3-$4",["9(?:2[2-469]|3[3-578])","9(?:2(?:2[024-9]|3[0-59]|47|6[245]|9[02-8])|3(?:3[28]|4[03-9]|5[2-46-8]|7[1-578]|8[2-9]))","9(?:2(?:[23]02|6(?:[25]|4[6-8])|9(?:[02356]|4[02568]|72|8[23]))|3(?:3[28]|4(?:[04679]|3[5-8]|5[4-68]|8[2379])|5(?:[2467]|3[237]|8[2-5])|7[1-578]|8(?:[2469]|3[2578]|5[4-8]|7[36-8]|8[5-8])))|92(?:2[24-9]|3[1-59]|47)","9(?:2(?:[23]02|6(?:[25]|4(?:64|[78]))|9(?:[02356]|4(?:[0268]|5[2-6])|72|8[23]))|3(?:3[28]|4(?:[04679]|3[78]|5(?:4[46]|8)|8[2379])|5(?:[2467]|3[237]|8[23])|7[1-578]|8(?:[2469]|3[278]|5(?:[56][46]|[78])|7[378]|8(?:6[3-6]|[78]))))|92(?:2[24-9]|3[1-59]|47)|93(?:4[35][56]|58[45]|8(?:[38]5|54|76))[4-6]","9(?:2(?:[23]02|6(?:[25]|4(?:64|[78]))|9(?:[02356]|4(?:[0268]|5[2-6])|72|8[23]))|3(?:3[28]|4(?:[04679]|3(?:5(?:4[0-25689]|[56])|[78])|5(?:4[46]|8)|8[2379])|5(?:[2467]|3[237]|8(?:[23]|4(?:[45]|60)|5(?:4[0-39]|5|64)))|7[1-578]|8(?:[2469]|3[278]|5(?:4(?:4|5[13-7]|6[89])|[56][46]|[78])|7[378]|8(?:6[3-6]|[78]))))|92(?:2[24-9]|3[1-59]|47)|93(?:4(?:36|5[56])|8(?:[38]5|76))[4-6]"],"0$1",0,"$1 $2 $3-$4"],["(\\d)(\\d{2})(\\d{4})(\\d{4})","$2 15-$3-$4",["91"],"0$1",0,"$1 $2 $3-$4"],["(\\d{3})(\\d{3})(\\d{5})","$1-$2-$3",["8"],"0$1"],["(\\d)(\\d{3})(\\d{3})(\\d{4})","$2 15-$3-$4",["9"],"0$1",0,"$1 $2 $3-$4"]],"0",0,"0?(?:(11|2(?:2(?:02?|[13]|2[13-79]|4[1-6]|5[2457]|6[124-8]|7[1-4]|8[13-6]|9[1267])|3(?:02?|1[467]|2[03-6]|3[13-8]|[49][2-6]|5[2-8]|[67])|4(?:7[3-578]|9)|6(?:[0136]|2[24-6]|4[6-8]?|5[15-8])|80|9(?:0[1-3]|[19]|2\\d|3[1-6]|4[02568]?|5[2-4]|6[2-46]|72?|8[23]?))|3(?:3(?:2[79]|6|8[2578])|4(?:0[0-24-9]|[12]|3[5-8]?|4[24-7]|5[4-68]?|6[02-9]|7[126]|8[2379]?|9[1-36-8])|5(?:1|2[1245]|3[237]?|4[1-46-9]|6[2-4]|7[1-6]|8[2-5]?)|6[24]|7(?:[069]|1[1568]|2[15]|3[145]|4[13]|5[14-8]|7[2-57]|8[126])|8(?:[01]|2[15-7]|3[2578]?|4[13-6]|5[4-8]?|6[1-357-9]|7[36-8]?|8[5-8]?|9[124])))15)?","9$1"],AS:["1","011","(?:[58]\\d\\d|684|900)\\d{7}",[10],0,"1",0,"([267]\\d{6})$|1","684$1",0,"684"],AT:["43","00","1\\d{3,12}|2\\d{6,12}|43(?:(?:0\\d|5[02-9])\\d{3,9}|2\\d{4,5}|[3467]\\d{4}|8\\d{4,6}|9\\d{4,7})|5\\d{4,12}|8\\d{7,12}|9\\d{8,12}|(?:[367]\\d|4[0-24-9])\\d{4,11}",[4,5,6,7,8,9,10,11,12,13],[["(\\d)(\\d{3,12})","$1 $2",["1(?:11|[2-9])"],"0$1"],["(\\d{3})(\\d{2})","$1 $2",["517"],"0$1"],["(\\d{2})(\\d{3,5})","$1 $2",["5[079]"],"0$1"],["(\\d{3})(\\d{3,10})","$1 $2",["(?:31|4)6|51|6(?:5[0-3579]|[6-9])|7(?:20|32|8)|[89]"],"0$1"],["(\\d{4})(\\d{3,9})","$1 $2",["[2-467]|5[2-6]"],"0$1"],["(\\d{2})(\\d{3})(\\d{3,4})","$1 $2 $3",["5"],"0$1"],["(\\d{2})(\\d{4})(\\d{4,7})","$1 $2 $3",["5"],"0$1"]],"0"],AU:["61","001[14-689]|14(?:1[14]|34|4[17]|[56]6|7[47]|88)0011","1(?:[0-79]\\d{7}(?:\\d(?:\\d{2})?)?|8[0-24-9]\\d{7})|[2-478]\\d{8}|1\\d{4,7}",[5,6,7,8,9,10,12],[["(\\d{2})(\\d{3,4})","$1 $2",["16"],"0$1"],["(\\d{2})(\\d{3})(\\d{2,4})","$1 $2 $3",["16"],"0$1"],["(\\d{3})(\\d{3})(\\d{3})","$1 $2 $3",["14|4"],"0$1"],["(\\d)(\\d{4})(\\d{4})","$1 $2 $3",["[2378]"],"(0$1)"],["(\\d{4})(\\d{3})(\\d{3})","$1 $2 $3",["1(?:30|[89])"]]],"0",0,"(183[12])|0",0,0,0,[["(?:(?:2(?:[0-26-9]\\d|3[0-8]|4[02-9]|5[0135-9])|3(?:[0-3589]\\d|4[0-578]|6[1-9]|7[0-35-9])|7(?:[013-57-9]\\d|2[0-8]))\\d{3}|8(?:51(?:0(?:0[03-9]|[12479]\\d|3[2-9]|5[0-8]|6[1-9]|8[0-7])|1(?:[0235689]\\d|1[0-69]|4[0-589]|7[0-47-9])|2(?:0[0-79]|[18][13579]|2[14-9]|3[0-46-9]|[4-6]\\d|7[89]|9[0-4]))|(?:6[0-8]|[78]\\d)\\d{3}|9(?:[02-9]\\d{3}|1(?:(?:[0-58]\\d|6[0135-9])\\d|7(?:0[0-24-9]|[1-9]\\d)|9(?:[0-46-9]\\d|5[0-79])))))\\d{3}",[9]],["4(?:(?:79|94)[01]|83[0-389])\\d{5}|4(?:[0-3]\\d|4[047-9]|5[0-25-9]|6[016-9]|7[02-8]|8[0-24-9]|9[0-37-9])\\d{6}",[9]],["180(?:0\\d{3}|2)\\d{3}",[7,10]],["190[0-26]\\d{6}",[10]],0,0,0,["163\\d{2,6}",[5,6,7,8,9]],["14(?:5(?:1[0458]|[23][458])|71\\d)\\d{4}",[9]],["13(?:00\\d{6}(?:\\d{2})?|45[0-4]\\d{3})|13\\d{4}",[6,8,10,12]]],"0011"],AW:["297","00","(?:[25-79]\\d\\d|800)\\d{4}",[7],[["(\\d{3})(\\d{4})","$1 $2",["[25-9]"]]]],AX:["358","00|99(?:[01469]|5(?:[14]1|3[23]|5[59]|77|88|9[09]))","2\\d{4,9}|35\\d{4,5}|(?:60\\d\\d|800)\\d{4,6}|7\\d{5,11}|(?:[14]\\d|3[0-46-9]|50)\\d{4,8}",[5,6,7,8,9,10,11,12],0,"0",0,0,0,0,"18",0,"00"],AZ:["994","00","365\\d{6}|(?:[124579]\\d|60|88)\\d{7}",[9],[["(\\d{3})(\\d{2})(\\d{2})(\\d{2})","$1 $2 $3 $4",["90"],"0$1"],["(\\d{2})(\\d{3})(\\d{2})(\\d{2})","$1 $2 $3 $4",["1[28]|2|365|46","1[28]|2|365[45]|46","1[28]|2|365(?:4|5[02])|46"],"(0$1)"],["(\\d{2})(\\d{3})(\\d{2})(\\d{2})","$1 $2 $3 $4",["[13-9]"],"0$1"]],"0"],BA:["387","00","6\\d{8}|(?:[35689]\\d|49|70)\\d{6}",[8,9],[["(\\d{2})(\\d{3})(\\d{3})","$1 $2 $3",["6[1-3]|[7-9]"],"0$1"],["(\\d{2})(\\d{3})(\\d{3})","$1 $2-$3",["[3-5]|6[56]"],"0$1"],["(\\d{2})(\\d{2})(\\d{2})(\\d{3})","$1 $2 $3 $4",["6"],"0$1"]],"0"],BB:["1","011","(?:246|[58]\\d\\d|900)\\d{7}",[10],0,"1",0,"([2-9]\\d{6})$|1","246$1",0,"246"],BD:["880","00","[1-469]\\d{9}|8[0-79]\\d{7,8}|[2-79]\\d{8}|[2-9]\\d{7}|[3-9]\\d{6}|[57-9]\\d{5}",[6,7,8,9,10],[["(\\d{2})(\\d{4,6})","$1-$2",["31[5-8]|[459]1"],"0$1"],["(\\d{3})(\\d{3,7})","$1-$2",["3(?:[67]|8[013-9])|4(?:6[168]|7|[89][18])|5(?:6[128]|9)|6(?:[15]|28|4[14])|7[2-589]|8(?:0[014-9]|[12])|9[358]|(?:3[2-5]|4[235]|5[2-578]|6[0389]|76|8[3-7]|9[24])1|(?:44|66)[01346-9]"],"0$1"],["(\\d{4})(\\d{3,6})","$1-$2",["[13-9]|22"],"0$1"],["(\\d)(\\d{7,8})","$1-$2",["2"],"0$1"]],"0"],BE:["32","00","4\\d{8}|[1-9]\\d{7}",[8,9],[["(\\d{3})(\\d{2})(\\d{3})","$1 $2 $3",["(?:80|9)0"],"0$1"],["(\\d)(\\d{3})(\\d{2})(\\d{2})","$1 $2 $3 $4",["[239]|4[23]"],"0$1"],["(\\d{2})(\\d{2})(\\d{2})(\\d{2})","$1 $2 $3 $4",["[15-8]"],"0$1"],["(\\d{3})(\\d{2})(\\d{2})(\\d{2})","$1 $2 $3 $4",["4"],"0$1"]],"0"],BF:["226","00","[025-7]\\d{7}",[8],[["(\\d{2})(\\d{2})(\\d{2})(\\d{2})","$1 $2 $3 $4",["[025-7]"]]]],BG:["359","00","00800\\d{7}|[2-7]\\d{6,7}|[89]\\d{6,8}|2\\d{5}",[6,7,8,9,12],[["(\\d)(\\d)(\\d{2})(\\d{2})","$1 $2 $3 $4",["2"],"0$1"],["(\\d{3})(\\d{4})","$1 $2",["43[1-6]|70[1-9]"],"0$1"],["(\\d)(\\d{3})(\\d{3,4})","$1 $2 $3",["2"],"0$1"],["(\\d{2})(\\d{3})(\\d{2,3})","$1 $2 $3",["[356]|4[124-7]|7[1-9]|8[1-6]|9[1-7]"],"0$1"],["(\\d{3})(\\d{2})(\\d{3})","$1 $2 $3",["(?:70|8)0"],"0$1"],["(\\d{3})(\\d{3})(\\d{2})","$1 $2 $3",["43[1-7]|7"],"0$1"],["(\\d{2})(\\d{3})(\\d{3,4})","$1 $2 $3",["[48]|9[08]"],"0$1"],["(\\d{3})(\\d{3})(\\d{3})","$1 $2 $3",["9"],"0$1"]],"0"],BH:["973","00","[136-9]\\d{7}",[8],[["(\\d{4})(\\d{4})","$1 $2",["[13679]|8[02-4679]"]]]],BI:["257","00","(?:[267]\\d|31)\\d{6}",[8],[["(\\d{2})(\\d{2})(\\d{2})(\\d{2})","$1 $2 $3 $4",["[2367]"]]]],BJ:["229","00","[24-689]\\d{7}",[8],[["(\\d{2})(\\d{2})(\\d{2})(\\d{2})","$1 $2 $3 $4",["[24-689]"]]]],BL:["590","00","590\\d{6}|(?:69|80|9\\d)\\d{7}",[9],0,"0",0,0,0,0,0,[["590(?:2[7-9]|3[3-7]|5[12]|87)\\d{4}"],["69(?:0\\d\\d|1(?:2[2-9]|3[0-5]))\\d{4}"],["80[0-5]\\d{6}"],0,0,0,0,0,["9(?:(?:395|76[018])\\d|475[0-5])\\d{4}"]]],BM:["1","011","(?:441|[58]\\d\\d|900)\\d{7}",[10],0,"1",0,"([2-9]\\d{6})$|1","441$1",0,"441"],BN:["673","00","[2-578]\\d{6}",[7],[["(\\d{3})(\\d{4})","$1 $2",["[2-578]"]]]],BO:["591","00(?:1\\d)?","(?:[2-467]\\d\\d|8001)\\d{5}",[8,9],[["(\\d)(\\d{7})","$1 $2",["[23]|4[46]"]],["(\\d{8})","$1",["[67]"]],["(\\d{3})(\\d{2})(\\d{4})","$1 $2 $3",["8"]]],"0",0,"0(1\\d)?"],BQ:["599","00","(?:[34]1|7\\d)\\d{5}",[7],0,0,0,0,0,0,"[347]"],BR:["55","00(?:1[245]|2[1-35]|31|4[13]|[56]5|99)","(?:[1-46-9]\\d\\d|5(?:[0-46-9]\\d|5[0-46-9]))\\d{8}|[1-9]\\d{9}|[3589]\\d{8}|[34]\\d{7}",[8,9,10,11],[["(\\d{4})(\\d{4})","$1-$2",["300|4(?:0[02]|37)","4(?:02|37)0|[34]00"]],["(\\d{3})(\\d{2,3})(\\d{4})","$1 $2 $3",["(?:[358]|90)0"],"0$1"],["(\\d{2})(\\d{4})(\\d{4})","$1 $2-$3",["(?:[14689][1-9]|2[12478]|3[1-578]|5[13-5]|7[13-579])[2-57]"],"($1)"],["(\\d{2})(\\d{5})(\\d{4})","$1 $2-$3",["[16][1-9]|[2-57-9]"],"($1)"]],"0",0,"(?:0|90)(?:(1[245]|2[1-35]|31|4[13]|[56]5|99)(\\d{10,11}))?","$2"],BS:["1","011","(?:242|[58]\\d\\d|900)\\d{7}",[10],0,"1",0,"([3-8]\\d{6})$|1","242$1",0,"242"],BT:["975","00","[17]\\d{7}|[2-8]\\d{6}",[7,8],[["(\\d)(\\d{3})(\\d{3})","$1 $2 $3",["[2-68]|7[246]"]],["(\\d{2})(\\d{2})(\\d{2})(\\d{2})","$1 $2 $3 $4",["1[67]|7"]]]],BW:["267","00","(?:0800|(?:[37]|800)\\d)\\d{6}|(?:[2-6]\\d|90)\\d{5}",[7,8,10],[["(\\d{2})(\\d{5})","$1 $2",["90"]],["(\\d{3})(\\d{4})","$1 $2",["[24-6]|3[15-9]"]],["(\\d{2})(\\d{3})(\\d{3})","$1 $2 $3",["[37]"]],["(\\d{4})(\\d{3})(\\d{3})","$1 $2 $3",["0"]],["(\\d{3})(\\d{4})(\\d{3})","$1 $2 $3",["8"]]]],BY:["375","810","(?:[12]\\d|33|44|902)\\d{7}|8(?:0[0-79]\\d{5,7}|[1-7]\\d{9})|8(?:1[0-489]|[5-79]\\d)\\d{7}|8[1-79]\\d{6,7}|8[0-79]\\d{5}|8\\d{5}",[6,7,8,9,10,11],[["(\\d{3})(\\d{3})","$1 $2",["800"],"8 $1"],["(\\d{3})(\\d{2})(\\d{2,4})","$1 $2 $3",["800"],"8 $1"],["(\\d{4})(\\d{2})(\\d{3})","$1 $2-$3",["1(?:5[169]|6[3-5]|7[179])|2(?:1[35]|2[34]|3[3-5])","1(?:5[169]|6(?:3[1-3]|4|5[125])|7(?:1[3-9]|7[0-24-6]|9[2-7]))|2(?:1[35]|2[34]|3[3-5])"],"8 0$1"],["(\\d{3})(\\d{2})(\\d{2})(\\d{2})","$1 $2-$3-$4",["1(?:[56]|7[467])|2[1-3]"],"8 0$1"],["(\\d{2})(\\d{3})(\\d{2})(\\d{2})","$1 $2-$3-$4",["[1-4]"],"8 0$1"],["(\\d{3})(\\d{3,4})(\\d{4})","$1 $2 $3",["[89]"],"8 $1"]],"8",0,"0|80?",0,0,0,0,"8~10"],BZ:["501","00","(?:0800\\d|[2-8])\\d{6}",[7,11],[["(\\d{3})(\\d{4})","$1-$2",["[2-8]"]],["(\\d)(\\d{3})(\\d{4})(\\d{3})","$1-$2-$3-$4",["0"]]]],CA:["1","011","(?:[2-8]\\d|90)\\d{8}|3\\d{6}",[7,10],0,"1",0,0,0,0,0,[["(?:2(?:04|[23]6|[48]9|50|63)|3(?:06|43|54|6[578]|82)|4(?:03|1[68]|[26]8|3[178]|50|74)|5(?:06|1[49]|48|79|8[147])|6(?:04|[18]3|39|47|72)|7(?:0[59]|42|53|78|8[02])|8(?:[06]7|19|25|73)|90[25])[2-9]\\d{6}",[10]],["",[10]],["8(?:00|33|44|55|66|77|88)[2-9]\\d{6}",[10]],["900[2-9]\\d{6}",[10]],["52(?:3(?:[2-46-9][02-9]\\d|5(?:[02-46-9]\\d|5[0-46-9]))|4(?:[2-478][02-9]\\d|5(?:[034]\\d|2[024-9]|5[0-46-9])|6(?:0[1-9]|[2-9]\\d)|9(?:[05-9]\\d|2[0-5]|49)))\\d{4}|52[34][2-9]1[02-9]\\d{4}|(?:5(?:00|2[125-9]|33|44|66|77|88)|622)[2-9]\\d{6}",[10]],0,["310\\d{4}",[7]],0,["600[2-9]\\d{6}",[10]]]],CC:["61","001[14-689]|14(?:1[14]|34|4[17]|[56]6|7[47]|88)0011","1(?:[0-79]\\d{8}(?:\\d{2})?|8[0-24-9]\\d{7})|[148]\\d{8}|1\\d{5,7}",[6,7,8,9,10,12],0,"0",0,"([59]\\d{7})$|0","8$1",0,0,[["8(?:51(?:0(?:02|31|60|89)|1(?:18|76)|223)|91(?:0(?:1[0-2]|29)|1(?:[28]2|50|79)|2(?:10|64)|3(?:[06]8|22)|4[29]8|62\\d|70[23]|959))\\d{3}",[9]],["4(?:(?:79|94)[01]|83[0-389])\\d{5}|4(?:[0-3]\\d|4[047-9]|5[0-25-9]|6[016-9]|7[02-8]|8[0-24-9]|9[0-37-9])\\d{6}",[9]],["180(?:0\\d{3}|2)\\d{3}",[7,10]],["190[0-26]\\d{6}",[10]],0,0,0,0,["14(?:5(?:1[0458]|[23][458])|71\\d)\\d{4}",[9]],["13(?:00\\d{6}(?:\\d{2})?|45[0-4]\\d{3})|13\\d{4}",[6,8,10,12]]],"0011"],CD:["243","00","[189]\\d{8}|[1-68]\\d{6}",[7,9],[["(\\d{2})(\\d{2})(\\d{3})","$1 $2 $3",["88"],"0$1"],["(\\d{2})(\\d{5})","$1 $2",["[1-6]"],"0$1"],["(\\d{2})(\\d{3})(\\d{4})","$1 $2 $3",["1"],"0$1"],["(\\d{3})(\\d{3})(\\d{3})","$1 $2 $3",["[89]"],"0$1"]],"0"],CF:["236","00","(?:[27]\\d{3}|8776)\\d{4}",[8],[["(\\d{2})(\\d{2})(\\d{2})(\\d{2})","$1 $2 $3 $4",["[278]"]]]],CG:["242","00","222\\d{6}|(?:0\\d|80)\\d{7}",[9],[["(\\d)(\\d{4})(\\d{4})","$1 $2 $3",["8"]],["(\\d{2})(\\d{3})(\\d{4})","$1 $2 $3",["[02]"]]]],CH:["41","00","8\\d{11}|[2-9]\\d{8}",[9],[["(\\d{3})(\\d{3})(\\d{3})","$1 $2 $3",["8[047]|90"],"0$1"],["(\\d{2})(\\d{3})(\\d{2})(\\d{2})","$1 $2 $3 $4",["[2-79]|81"],"0$1"],["(\\d{3})(\\d{2})(\\d{3})(\\d{2})(\\d{2})","$1 $2 $3 $4 $5",["8"],"0$1"]],"0"],CI:["225","00","[02]\\d{9}",[10],[["(\\d{2})(\\d{2})(\\d)(\\d{5})","$1 $2 $3 $4",["2"]],["(\\d{2})(\\d{2})(\\d{2})(\\d{4})","$1 $2 $3 $4",["0"]]]],CK:["682","00","[2-578]\\d{4}",[5],[["(\\d{2})(\\d{3})","$1 $2",["[2-578]"]]]],CL:["56","(?:0|1(?:1[0-69]|2[02-5]|5[13-58]|69|7[0167]|8[018]))0","12300\\d{6}|6\\d{9,10}|[2-9]\\d{8}",[9,10,11],[["(\\d{5})(\\d{4})","$1 $2",["219","2196"],"($1)"],["(\\d{2})(\\d{3})(\\d{4})","$1 $2 $3",["44"]],["(\\d)(\\d{4})(\\d{4})","$1 $2 $3",["2[1-36]"],"($1)"],["(\\d)(\\d{4})(\\d{4})","$1 $2 $3",["9[2-9]"]],["(\\d{2})(\\d{3})(\\d{4})","$1 $2 $3",["3[2-5]|[47]|5[1-3578]|6[13-57]|8(?:0[1-9]|[1-9])"],"($1)"],["(\\d{3})(\\d{3})(\\d{3,4})","$1 $2 $3",["60|8"]],["(\\d{4})(\\d{3})(\\d{4})","$1 $2 $3",["1"]],["(\\d{3})(\\d{3})(\\d{2})(\\d{3})","$1 $2 $3 $4",["60"]]]],CM:["237","00","[26]\\d{8}|88\\d{6,7}",[8,9],[["(\\d{2})(\\d{2})(\\d{2})(\\d{2})","$1 $2 $3 $4",["88"]],["(\\d)(\\d{2})(\\d{2})(\\d{2})(\\d{2})","$1 $2 $3 $4 $5",["[26]|88"]]]],CN:["86","00|1(?:[12]\\d|79)\\d\\d00","1[127]\\d{8,9}|2\\d{9}(?:\\d{2})?|[12]\\d{6,7}|86\\d{6}|(?:1[03-689]\\d|6)\\d{7,9}|(?:[3-579]\\d|8[0-57-9])\\d{6,9}",[7,8,9,10,11,12],[["(\\d{2})(\\d{5,6})","$1 $2",["(?:10|2[0-57-9])[19]","(?:10|2[0-57-9])(?:10|9[56])","10(?:10|9[56])|2[0-57-9](?:100|9[56])"],"0$1"],["(\\d{3})(\\d{5,6})","$1 $2",["3(?:[157]|35|49|9[1-68])|4(?:[17]|2[179]|6[47-9]|8[23])|5(?:[1357]|2[37]|4[36]|6[1-46]|80)|6(?:3[1-5]|6[0238]|9[12])|7(?:01|[1579]|2[248]|3[014-9]|4[3-6]|6[023689])|8(?:1[236-8]|2[5-7]|[37]|8[36-8]|9[1-8])|9(?:0[1-3689]|1[1-79]|[379]|4[13]|5[1-5])|(?:4[35]|59|85)[1-9]","(?:3(?:[157]\\d|35|49|9[1-68])|4(?:[17]\\d|2[179]|[35][1-9]|6[47-9]|8[23])|5(?:[1357]\\d|2[37]|4[36]|6[1-46]|80|9[1-9])|6(?:3[1-5]|6[0238]|9[12])|7(?:01|[1579]\\d|2[248]|3[014-9]|4[3-6]|6[023689])|8(?:1[236-8]|2[5-7]|[37]\\d|5[1-9]|8[36-8]|9[1-8])|9(?:0[1-3689]|1[1-79]|[379]\\d|4[13]|5[1-5]))[19]","85[23](?:10|95)|(?:3(?:[157]\\d|35|49|9[1-68])|4(?:[17]\\d|2[179]|[35][1-9]|6[47-9]|8[23])|5(?:[1357]\\d|2[37]|4[36]|6[1-46]|80|9[1-9])|6(?:3[1-5]|6[0238]|9[12])|7(?:01|[1579]\\d|2[248]|3[014-9]|4[3-6]|6[023689])|8(?:1[236-8]|2[5-7]|[37]\\d|5[14-9]|8[36-8]|9[1-8])|9(?:0[1-3689]|1[1-79]|[379]\\d|4[13]|5[1-5]))(?:10|9[56])","85[23](?:100|95)|(?:3(?:[157]\\d|35|49|9[1-68])|4(?:[17]\\d|2[179]|[35][1-9]|6[47-9]|8[23])|5(?:[1357]\\d|2[37]|4[36]|6[1-46]|80|9[1-9])|6(?:3[1-5]|6[0238]|9[12])|7(?:01|[1579]\\d|2[248]|3[014-9]|4[3-6]|6[023689])|8(?:1[236-8]|2[5-7]|[37]\\d|5[14-9]|8[36-8]|9[1-8])|9(?:0[1-3689]|1[1-79]|[379]\\d|4[13]|5[1-5]))(?:100|9[56])"],"0$1"],["(\\d{3})(\\d{3})(\\d{4})","$1 $2 $3",["(?:4|80)0"]],["(\\d{2})(\\d{4})(\\d{4})","$1 $2 $3",["10|2(?:[02-57-9]|1[1-9])","10|2(?:[02-57-9]|1[1-9])","10[0-79]|2(?:[02-57-9]|1[1-79])|(?:10|21)8(?:0[1-9]|[1-9])"],"0$1",1],["(\\d{3})(\\d{3})(\\d{4})","$1 $2 $3",["3(?:[3-59]|7[02-68])|4(?:[26-8]|3[3-9]|5[2-9])|5(?:3[03-9]|[468]|7[028]|9[2-46-9])|6|7(?:[0-247]|3[04-9]|5[0-4689]|6[2368])|8(?:[1-358]|9[1-7])|9(?:[013479]|5[1-5])|(?:[34]1|55|79|87)[02-9]"],"0$1",1],["(\\d{3})(\\d{7,8})","$1 $2",["9"]],["(\\d{4})(\\d{3})(\\d{4})","$1 $2 $3",["80"],"0$1",1],["(\\d{3})(\\d{4})(\\d{4})","$1 $2 $3",["[3-578]"],"0$1",1],["(\\d{3})(\\d{4})(\\d{4})","$1 $2 $3",["1[3-9]"]],["(\\d{2})(\\d{3})(\\d{3})(\\d{4})","$1 $2 $3 $4",["[12]"],"0$1",1]],"0",0,"(1(?:[12]\\d|79)\\d\\d)|0",0,0,0,0,"00"],CO:["57","00(?:4(?:[14]4|56)|[579])","(?:60\\d\\d|9101)\\d{6}|(?:1\\d|3)\\d{9}",[10,11],[["(\\d{3})(\\d{7})","$1 $2",["6"],"($1)"],["(\\d{3})(\\d{7})","$1 $2",["3[0-357]|91"]],["(\\d)(\\d{3})(\\d{7})","$1-$2-$3",["1"],"0$1",0,"$1 $2 $3"]],"0",0,"0(4(?:[14]4|56)|[579])?"],CR:["506","00","(?:8\\d|90)\\d{8}|(?:[24-8]\\d{3}|3005)\\d{4}",[8,10],[["(\\d{4})(\\d{4})","$1 $2",["[2-7]|8[3-9]"]],["(\\d{3})(\\d{3})(\\d{4})","$1-$2-$3",["[89]"]]],0,0,"(19(?:0[0-2468]|1[09]|20|66|77|99))"],CU:["53","119","[27]\\d{6,7}|[34]\\d{5,7}|63\\d{6}|(?:5|8\\d\\d)\\d{7}",[6,7,8,10],[["(\\d{2})(\\d{4,6})","$1 $2",["2[1-4]|[34]"],"(0$1)"],["(\\d)(\\d{6,7})","$1 $2",["7"],"(0$1)"],["(\\d)(\\d{7})","$1 $2",["[56]"],"0$1"],["(\\d{3})(\\d{7})","$1 $2",["8"],"0$1"]],"0"],CV:["238","0","(?:[2-59]\\d\\d|800)\\d{4}",[7],[["(\\d{3})(\\d{2})(\\d{2})","$1 $2 $3",["[2-589]"]]]],CW:["599","00","(?:[34]1|60|(?:7|9\\d)\\d)\\d{5}",[7,8],[["(\\d{3})(\\d{4})","$1 $2",["[3467]"]],["(\\d)(\\d{3})(\\d{4})","$1 $2 $3",["9[4-8]"]]],0,0,0,0,0,"[69]"],CX:["61","001[14-689]|14(?:1[14]|34|4[17]|[56]6|7[47]|88)0011","1(?:[0-79]\\d{8}(?:\\d{2})?|8[0-24-9]\\d{7})|[148]\\d{8}|1\\d{5,7}",[6,7,8,9,10,12],0,"0",0,"([59]\\d{7})$|0","8$1",0,0,[["8(?:51(?:0(?:01|30|59|88)|1(?:17|46|75)|2(?:22|35))|91(?:00[6-9]|1(?:[28]1|49|78)|2(?:09|63)|3(?:12|26|75)|4(?:56|97)|64\\d|7(?:0[01]|1[0-2])|958))\\d{3}",[9]],["4(?:(?:79|94)[01]|83[0-389])\\d{5}|4(?:[0-3]\\d|4[047-9]|5[0-25-9]|6[016-9]|7[02-8]|8[0-24-9]|9[0-37-9])\\d{6}",[9]],["180(?:0\\d{3}|2)\\d{3}",[7,10]],["190[0-26]\\d{6}",[10]],0,0,0,0,["14(?:5(?:1[0458]|[23][458])|71\\d)\\d{4}",[9]],["13(?:00\\d{6}(?:\\d{2})?|45[0-4]\\d{3})|13\\d{4}",[6,8,10,12]]],"0011"],CY:["357","00","(?:[279]\\d|[58]0)\\d{6}",[8],[["(\\d{2})(\\d{6})","$1 $2",["[257-9]"]]]],CZ:["420","00","(?:[2-578]\\d|60)\\d{7}|9\\d{8,11}",[9],[["(\\d{3})(\\d{3})(\\d{3})","$1 $2 $3",["[2-8]|9[015-7]"]],["(\\d{2})(\\d{3})(\\d{3})(\\d{2})","$1 $2 $3 $4",["96"]],["(\\d{2})(\\d{3})(\\d{3})(\\d{3})","$1 $2 $3 $4",["9"]],["(\\d{3})(\\d{3})(\\d{3})(\\d{3})","$1 $2 $3 $4",["9"]]]],DE:["49","00","[2579]\\d{5,14}|49(?:[34]0|69|8\\d)\\d\\d?|49(?:37|49|60|7[089]|9\\d)\\d{1,3}|49(?:2[024-9]|3[2-689]|7[1-7])\\d{1,8}|(?:1|[368]\\d|4[0-8])\\d{3,13}|49(?:[015]\\d|2[13]|31|[46][1-8])\\d{1,9}",[4,5,6,7,8,9,10,11,12,13,14,15],[["(\\d{2})(\\d{3,13})","$1 $2",["3[02]|40|[68]9"],"0$1"],["(\\d{3})(\\d{3,12})","$1 $2",["2(?:0[1-389]|1[124]|2[18]|3[14])|3(?:[35-9][15]|4[015])|906|(?:2[4-9]|4[2-9]|[579][1-9]|[68][1-8])1","2(?:0[1-389]|12[0-8])|3(?:[35-9][15]|4[015])|906|2(?:[13][14]|2[18])|(?:2[4-9]|4[2-9]|[579][1-9]|[68][1-8])1"],"0$1"],["(\\d{4})(\\d{2,11})","$1 $2",["[24-6]|3(?:[3569][02-46-9]|4[2-4679]|7[2-467]|8[2-46-8])|70[2-8]|8(?:0[2-9]|[1-8])|90[7-9]|[79][1-9]","[24-6]|3(?:3(?:0[1-467]|2[127-9]|3[124578]|7[1257-9]|8[1256]|9[145])|4(?:2[135]|4[13578]|9[1346])|5(?:0[14]|2[1-3589]|6[1-4]|7[13468]|8[13568])|6(?:2[1-489]|3[124-6]|6[13]|7[12579]|8[1-356]|9[135])|7(?:2[1-7]|4[145]|6[1-5]|7[1-4])|8(?:21|3[1468]|6|7[1467]|8[136])|9(?:0[12479]|2[1358]|4[134679]|6[1-9]|7[136]|8[147]|9[1468]))|70[2-8]|8(?:0[2-9]|[1-8])|90[7-9]|[79][1-9]|3[68]4[1347]|3(?:47|60)[1356]|3(?:3[46]|46|5[49])[1246]|3[4579]3[1357]"],"0$1"],["(\\d{3})(\\d{4})","$1 $2",["138"],"0$1"],["(\\d{5})(\\d{2,10})","$1 $2",["3"],"0$1"],["(\\d{3})(\\d{5,11})","$1 $2",["181"],"0$1"],["(\\d{3})(\\d)(\\d{4,10})","$1 $2 $3",["1(?:3|80)|9"],"0$1"],["(\\d{3})(\\d{7,8})","$1 $2",["1[67]"],"0$1"],["(\\d{3})(\\d{7,12})","$1 $2",["8"],"0$1"],["(\\d{5})(\\d{6})","$1 $2",["185","1850","18500"],"0$1"],["(\\d{3})(\\d{4})(\\d{4})","$1 $2 $3",["7"],"0$1"],["(\\d{4})(\\d{7})","$1 $2",["18[68]"],"0$1"],["(\\d{5})(\\d{6})","$1 $2",["15[0568]"],"0$1"],["(\\d{4})(\\d{7})","$1 $2",["15[1279]"],"0$1"],["(\\d{3})(\\d{8})","$1 $2",["18"],"0$1"],["(\\d{3})(\\d{2})(\\d{7,8})","$1 $2 $3",["1(?:6[023]|7)"],"0$1"],["(\\d{4})(\\d{2})(\\d{7})","$1 $2 $3",["15[279]"],"0$1"],["(\\d{3})(\\d{2})(\\d{8})","$1 $2 $3",["15"],"0$1"]],"0"],DJ:["253","00","(?:2\\d|77)\\d{6}",[8],[["(\\d{2})(\\d{2})(\\d{2})(\\d{2})","$1 $2 $3 $4",["[27]"]]]],DK:["45","00","[2-9]\\d{7}",[8],[["(\\d{2})(\\d{2})(\\d{2})(\\d{2})","$1 $2 $3 $4",["[2-9]"]]]],DM:["1","011","(?:[58]\\d\\d|767|900)\\d{7}",[10],0,"1",0,"([2-7]\\d{6})$|1","767$1",0,"767"],DO:["1","011","(?:[58]\\d\\d|900)\\d{7}",[10],0,"1",0,0,0,0,"8001|8[024]9"],DZ:["213","00","(?:[1-4]|[5-79]\\d|80)\\d{7}",[8,9],[["(\\d{2})(\\d{2})(\\d{2})(\\d{2})","$1 $2 $3 $4",["[1-4]"],"0$1"],["(\\d{2})(\\d{3})(\\d{2})(\\d{2})","$1 $2 $3 $4",["9"],"0$1"],["(\\d{3})(\\d{2})(\\d{2})(\\d{2})","$1 $2 $3 $4",["[5-8]"],"0$1"]],"0"],EC:["593","00","1\\d{9,10}|(?:[2-7]|9\\d)\\d{7}",[8,9,10,11],[["(\\d)(\\d{3})(\\d{4})","$1 $2-$3",["[2-7]"],"(0$1)",0,"$1-$2-$3"],["(\\d{2})(\\d{3})(\\d{4})","$1 $2 $3",["9"],"0$1"],["(\\d{4})(\\d{3})(\\d{3,4})","$1 $2 $3",["1"]]],"0"],EE:["372","00","8\\d{9}|[4578]\\d{7}|(?:[3-8]\\d|90)\\d{5}",[7,8,10],[["(\\d{3})(\\d{4})","$1 $2",["[369]|4[3-8]|5(?:[0-2]|5[0-478]|6[45])|7[1-9]|88","[369]|4[3-8]|5(?:[02]|1(?:[0-8]|95)|5[0-478]|6(?:4[0-4]|5[1-589]))|7[1-9]|88"]],["(\\d{4})(\\d{3,4})","$1 $2",["[45]|8(?:00|[1-49])","[45]|8(?:00[1-9]|[1-49])"]],["(\\d{2})(\\d{2})(\\d{4})","$1 $2 $3",["7"]],["(\\d{4})(\\d{3})(\\d{3})","$1 $2 $3",["8"]]]],EG:["20","00","[189]\\d{8,9}|[24-6]\\d{8}|[135]\\d{7}",[8,9,10],[["(\\d)(\\d{7,8})","$1 $2",["[23]"],"0$1"],["(\\d{2})(\\d{6,7})","$1 $2",["1[35]|[4-6]|8[2468]|9[235-7]"],"0$1"],["(\\d{3})(\\d{3})(\\d{4})","$1 $2 $3",["[89]"],"0$1"],["(\\d{2})(\\d{8})","$1 $2",["1"],"0$1"]],"0"],EH:["212","00","[5-8]\\d{8}",[9],0,"0",0,0,0,0,"528[89]"],ER:["291","00","[178]\\d{6}",[7],[["(\\d)(\\d{3})(\\d{3})","$1 $2 $3",["[178]"],"0$1"]],"0"],ES:["34","00","[5-9]\\d{8}",[9],[["(\\d{3})(\\d{3})(\\d{3})","$1 $2 $3",["[89]00"]],["(\\d{3})(\\d{2})(\\d{2})(\\d{2})","$1 $2 $3 $4",["[5-9]"]]]],ET:["251","00","(?:11|[2-579]\\d)\\d{7}",[9],[["(\\d{2})(\\d{3})(\\d{4})","$1 $2 $3",["[1-579]"],"0$1"]],"0"],FI:["358","00|99(?:[01469]|5(?:[14]1|3[23]|5[59]|77|88|9[09]))","[1-35689]\\d{4}|7\\d{10,11}|(?:[124-7]\\d|3[0-46-9])\\d{8}|[1-9]\\d{5,8}",[5,6,7,8,9,10,11,12],[["(\\d)(\\d{4,9})","$1 $2",["[2568][1-8]|3(?:0[1-9]|[1-9])|9"],"0$1"],["(\\d{3})(\\d{3,7})","$1 $2",["[12]00|[368]|70[07-9]"],"0$1"],["(\\d{2})(\\d{4,8})","$1 $2",["[1245]|7[135]"],"0$1"],["(\\d{2})(\\d{6,10})","$1 $2",["7"],"0$1"]],"0",0,0,0,0,"1[03-79]|[2-9]",0,"00"],FJ:["679","0(?:0|52)","45\\d{5}|(?:0800\\d|[235-9])\\d{6}",[7,11],[["(\\d{3})(\\d{4})","$1 $2",["[235-9]|45"]],["(\\d{4})(\\d{3})(\\d{4})","$1 $2 $3",["0"]]],0,0,0,0,0,0,0,"00"],FK:["500","00","[2-7]\\d{4}",[5]],FM:["691","00","(?:[39]\\d\\d|820)\\d{4}",[7],[["(\\d{3})(\\d{4})","$1 $2",["[389]"]]]],FO:["298","00","[2-9]\\d{5}",[6],[["(\\d{6})","$1",["[2-9]"]]],0,0,"(10(?:01|[12]0|88))"],FR:["33","00","[1-9]\\d{8}",[9],[["(\\d{3})(\\d{2})(\\d{2})(\\d{2})","$1 $2 $3 $4",["8"],"0 $1"],["(\\d)(\\d{2})(\\d{2})(\\d{2})(\\d{2})","$1 $2 $3 $4 $5",["[1-79]"],"0$1"]],"0"],GA:["241","00","(?:[067]\\d|11)\\d{6}|[2-7]\\d{6}",[7,8],[["(\\d)(\\d{2})(\\d{2})(\\d{2})","$1 $2 $3 $4",["[2-7]"],"0$1"],["(\\d{2})(\\d{2})(\\d{2})(\\d{2})","$1 $2 $3 $4",["0"]],["(\\d{2})(\\d{2})(\\d{2})(\\d{2})","$1 $2 $3 $4",["11|[67]"],"0$1"]],0,0,"0(11\\d{6}|60\\d{6}|61\\d{6}|6[256]\\d{6}|7[467]\\d{6})","$1"],GB:["44","00","[1-357-9]\\d{9}|[18]\\d{8}|8\\d{6}",[7,9,10],[["(\\d{3})(\\d{4})","$1 $2",["800","8001","80011","800111","8001111"],"0$1"],["(\\d{3})(\\d{2})(\\d{2})","$1 $2 $3",["845","8454","84546","845464"],"0$1"],["(\\d{3})(\\d{6})","$1 $2",["800"],"0$1"],["(\\d{5})(\\d{4,5})","$1 $2",["1(?:38|5[23]|69|76|94)","1(?:(?:38|69)7|5(?:24|39)|768|946)","1(?:3873|5(?:242|39[4-6])|(?:697|768)[347]|9467)"],"0$1"],["(\\d{4})(\\d{5,6})","$1 $2",["1(?:[2-69][02-9]|[78])"],"0$1"],["(\\d{2})(\\d{4})(\\d{4})","$1 $2 $3",["[25]|7(?:0|6[02-9])","[25]|7(?:0|6(?:[03-9]|2[356]))"],"0$1"],["(\\d{4})(\\d{6})","$1 $2",["7"],"0$1"],["(\\d{3})(\\d{3})(\\d{4})","$1 $2 $3",["[1389]"],"0$1"]],"0",0,0,0,0,0,[["(?:1(?:1(?:3(?:[0-58]\\d\\d|73[0235])|4(?:[0-5]\\d\\d|69[7-9]|70[0-79])|(?:(?:5[0-26-9]|[78][0-49])\\d|6(?:[0-4]\\d|50))\\d)|(?:2(?:(?:0[024-9]|2[3-9]|3[3-79]|4[1-689]|[58][02-9]|6[0-47-9]|7[013-9]|9\\d)\\d|1(?:[0-7]\\d|8[0-2]))|(?:3(?:0\\d|1[0-8]|[25][02-9]|3[02-579]|[468][0-46-9]|7[1-35-79]|9[2-578])|4(?:0[03-9]|[137]\\d|[28][02-57-9]|4[02-69]|5[0-8]|[69][0-79])|5(?:0[1-35-9]|[16]\\d|2[024-9]|3[015689]|4[02-9]|5[03-9]|7[0-35-9]|8[0-468]|9[0-57-9])|6(?:0[034689]|1\\d|2[0-35689]|[38][013-9]|4[1-467]|5[0-69]|6[13-9]|7[0-8]|9[0-24578])|7(?:0[0246-9]|2\\d|3[0236-8]|4[03-9]|5[0-46-9]|6[013-9]|7[0-35-9]|8[024-9]|9[02-9])|8(?:0[35-9]|2[1-57-9]|3[02-578]|4[0-578]|5[124-9]|6[2-69]|7\\d|8[02-9]|9[02569])|9(?:0[02-589]|[18]\\d|2[02-689]|3[1-57-9]|4[2-9]|5[0-579]|6[2-47-9]|7[0-24578]|9[2-57]))\\d)\\d)|2(?:0[013478]|3[0189]|4[017]|8[0-46-9]|9[0-2])\\d{3})\\d{4}|1(?:2(?:0(?:46[1-4]|87[2-9])|545[1-79]|76(?:2\\d|3[1-8]|6[1-6])|9(?:7(?:2[0-4]|3[2-5])|8(?:2[2-8]|7[0-47-9]|8[3-5])))|3(?:6(?:38[2-5]|47[23])|8(?:47[04-9]|64[0157-9]))|4(?:044[1-7]|20(?:2[23]|8\\d)|6(?:0(?:30|5[2-57]|6[1-8]|7[2-8])|140)|8(?:052|87[1-3]))|5(?:2(?:4(?:3[2-79]|6\\d)|76\\d)|6(?:26[06-9]|686))|6(?:06(?:4\\d|7[4-79])|295[5-7]|35[34]\\d|47(?:24|61)|59(?:5[08]|6[67]|74)|9(?:55[0-4]|77[23]))|7(?:26(?:6[13-9]|7[0-7])|(?:442|688)\\d|50(?:2[0-3]|[3-68]2|76))|8(?:27[56]\\d|37(?:5[2-5]|8[239])|843[2-58])|9(?:0(?:0(?:6[1-8]|85)|52\\d)|3583|4(?:66[1-8]|9(?:2[01]|81))|63(?:23|3[1-4])|9561))\\d{3}",[9,10]],["7(?:457[0-57-9]|700[01]|911[028])\\d{5}|7(?:[1-3]\\d\\d|4(?:[0-46-9]\\d|5[0-689])|5(?:0[0-8]|[13-9]\\d|2[0-35-9])|7(?:0[1-9]|[1-7]\\d|8[02-9]|9[0-689])|8(?:[014-9]\\d|[23][0-8])|9(?:[024-9]\\d|1[02-9]|3[0-689]))\\d{6}",[10]],["80[08]\\d{7}|800\\d{6}|8001111"],["(?:8(?:4[2-5]|7[0-3])|9(?:[01]\\d|8[2-49]))\\d{7}|845464\\d",[7,10]],["70\\d{8}",[10]],0,["(?:3[0347]|55)\\d{8}",[10]],["76(?:464|652)\\d{5}|76(?:0[0-28]|2[356]|34|4[01347]|5[49]|6[0-369]|77|8[14]|9[139])\\d{6}",[10]],["56\\d{8}",[10]]],0," x"],GD:["1","011","(?:473|[58]\\d\\d|900)\\d{7}",[10],0,"1",0,"([2-9]\\d{6})$|1","473$1",0,"473"],GE:["995","00","(?:[3-57]\\d\\d|800)\\d{6}",[9],[["(\\d{3})(\\d{3})(\\d{3})","$1 $2 $3",["70"],"0$1"],["(\\d{2})(\\d{3})(\\d{2})(\\d{2})","$1 $2 $3 $4",["32"],"0$1"],["(\\d{3})(\\d{2})(\\d{2})(\\d{2})","$1 $2 $3 $4",["[57]"]],["(\\d{3})(\\d{2})(\\d{2})(\\d{2})","$1 $2 $3 $4",["[348]"],"0$1"]],"0"],GF:["594","00","[56]94\\d{6}|(?:80|9\\d)\\d{7}",[9],[["(\\d{3})(\\d{2})(\\d{2})(\\d{2})","$1 $2 $3 $4",["[56]|9[47]"],"0$1"],["(\\d{3})(\\d{2})(\\d{2})(\\d{2})","$1 $2 $3 $4",["[89]"],"0$1"]],"0"],GG:["44","00","(?:1481|[357-9]\\d{3})\\d{6}|8\\d{6}(?:\\d{2})?",[7,9,10],0,"0",0,"([25-9]\\d{5})$|0","1481$1",0,0,[["1481[25-9]\\d{5}",[10]],["7(?:(?:781|839)\\d|911[17])\\d{5}",[10]],["80[08]\\d{7}|800\\d{6}|8001111"],["(?:8(?:4[2-5]|7[0-3])|9(?:[01]\\d|8[0-3]))\\d{7}|845464\\d",[7,10]],["70\\d{8}",[10]],0,["(?:3[0347]|55)\\d{8}",[10]],["76(?:464|652)\\d{5}|76(?:0[0-28]|2[356]|34|4[01347]|5[49]|6[0-369]|77|8[14]|9[139])\\d{6}",[10]],["56\\d{8}",[10]]]],GH:["233","00","(?:[235]\\d{3}|800)\\d{5}",[8,9],[["(\\d{3})(\\d{5})","$1 $2",["8"],"0$1"],["(\\d{2})(\\d{3})(\\d{4})","$1 $2 $3",["[235]"],"0$1"]],"0"],GI:["350","00","(?:[25]\\d|60)\\d{6}",[8],[["(\\d{3})(\\d{5})","$1 $2",["2"]]]],GL:["299","00","(?:19|[2-689]\\d|70)\\d{4}",[6],[["(\\d{2})(\\d{2})(\\d{2})","$1 $2 $3",["19|[2-9]"]]]],GM:["220","00","[2-9]\\d{6}",[7],[["(\\d{3})(\\d{4})","$1 $2",["[2-9]"]]]],GN:["224","00","722\\d{6}|(?:3|6\\d)\\d{7}",[8,9],[["(\\d{2})(\\d{2})(\\d{2})(\\d{2})","$1 $2 $3 $4",["3"]],["(\\d{3})(\\d{2})(\\d{2})(\\d{2})","$1 $2 $3 $4",["[67]"]]]],GP:["590","00","590\\d{6}|(?:69|80|9\\d)\\d{7}",[9],[["(\\d{3})(\\d{2})(\\d{2})(\\d{2})","$1 $2 $3 $4",["[569]"],"0$1"],["(\\d{3})(\\d{2})(\\d{2})(\\d{2})","$1 $2 $3 $4",["8"],"0$1"]],"0",0,0,0,0,0,[["590(?:0[1-68]|[14][0-24-9]|2[0-68]|3[1-9]|5[3-579]|[68][0-689]|7[08]|9\\d)\\d{4}"],["69(?:0\\d\\d|1(?:2[2-9]|3[0-5]))\\d{4}"],["80[0-5]\\d{6}"],0,0,0,0,0,["9(?:(?:395|76[018])\\d|475[0-5])\\d{4}"]]],GQ:["240","00","222\\d{6}|(?:3\\d|55|[89]0)\\d{7}",[9],[["(\\d{3})(\\d{3})(\\d{3})","$1 $2 $3",["[235]"]],["(\\d{3})(\\d{6})","$1 $2",["[89]"]]]],GR:["30","00","5005000\\d{3}|8\\d{9,11}|(?:[269]\\d|70)\\d{8}",[10,11,12],[["(\\d{2})(\\d{4})(\\d{4})","$1 $2 $3",["21|7"]],["(\\d{4})(\\d{6})","$1 $2",["2(?:2|3[2-57-9]|4[2-469]|5[2-59]|6[2-9]|7[2-69]|8[2-49])|5"]],["(\\d{3})(\\d{3})(\\d{4})","$1 $2 $3",["[2689]"]],["(\\d{3})(\\d{3,4})(\\d{5})","$1 $2 $3",["8"]]]],GT:["502","00","(?:1\\d{3}|[2-7])\\d{7}",[8,11],[["(\\d{4})(\\d{4})","$1 $2",["[2-7]"]],["(\\d{4})(\\d{3})(\\d{4})","$1 $2 $3",["1"]]]],GU:["1","011","(?:[58]\\d\\d|671|900)\\d{7}",[10],0,"1",0,"([3-9]\\d{6})$|1","671$1",0,"671"],GW:["245","00","[49]\\d{8}|4\\d{6}",[7,9],[["(\\d{3})(\\d{4})","$1 $2",["40"]],["(\\d{3})(\\d{3})(\\d{3})","$1 $2 $3",["[49]"]]]],GY:["592","001","9008\\d{3}|(?:[2-467]\\d\\d|510|862)\\d{4}",[7],[["(\\d{3})(\\d{4})","$1 $2",["[2-9]"]]]],HK:["852","00(?:30|5[09]|[126-9]?)","8[0-46-9]\\d{6,7}|9\\d{4,7}|(?:[2-7]|9\\d{3})\\d{7}",[5,6,7,8,9,11],[["(\\d{3})(\\d{2,5})","$1 $2",["900","9003"]],["(\\d{4})(\\d{4})","$1 $2",["[2-7]|8[1-4]|9(?:0[1-9]|[1-8])"]],["(\\d{3})(\\d{3})(\\d{3})","$1 $2 $3",["8"]],["(\\d{3})(\\d{2})(\\d{3})(\\d{3})","$1 $2 $3 $4",["9"]]],0,0,0,0,0,0,0,"00"],HN:["504","00","8\\d{10}|[237-9]\\d{7}",[8,11],[["(\\d{4})(\\d{4})","$1-$2",["[237-9]"]]]],HR:["385","00","(?:[24-69]\\d|3[0-79])\\d{7}|80\\d{5,7}|[1-79]\\d{7}|6\\d{5,6}",[6,7,8,9],[["(\\d{2})(\\d{2})(\\d{2,3})","$1 $2 $3",["6[01]"],"0$1"],["(\\d{3})(\\d{2})(\\d{2,3})","$1 $2 $3",["8"],"0$1"],["(\\d)(\\d{4})(\\d{3})","$1 $2 $3",["1"],"0$1"],["(\\d{2})(\\d{3})(\\d{3,4})","$1 $2 $3",["[67]"],"0$1"],["(\\d{2})(\\d{3})(\\d{3,4})","$1 $2 $3",["9"],"0$1"],["(\\d{2})(\\d{3})(\\d{3,4})","$1 $2 $3",["[2-5]"],"0$1"],["(\\d{3})(\\d{3})(\\d{3})","$1 $2 $3",["8"],"0$1"]],"0"],HT:["509","00","(?:[2-489]\\d|55)\\d{6}",[8],[["(\\d{2})(\\d{2})(\\d{4})","$1 $2 $3",["[2-589]"]]]],HU:["36","00","[235-7]\\d{8}|[1-9]\\d{7}",[8,9],[["(\\d)(\\d{3})(\\d{4})","$1 $2 $3",["1"],"(06 $1)"],["(\\d{2})(\\d{3})(\\d{3})","$1 $2 $3",["[27][2-9]|3[2-7]|4[24-9]|5[2-79]|6|8[2-57-9]|9[2-69]"],"(06 $1)"],["(\\d{2})(\\d{3})(\\d{3,4})","$1 $2 $3",["[2-9]"],"06 $1"]],"06"],ID:["62","00[89]","(?:(?:00[1-9]|8\\d)\\d{4}|[1-36])\\d{6}|00\\d{10}|[1-9]\\d{8,10}|[2-9]\\d{7}",[7,8,9,10,11,12,13],[["(\\d)(\\d{3})(\\d{3})","$1 $2 $3",["15"]],["(\\d{2})(\\d{5,9})","$1 $2",["2[124]|[36]1"],"(0$1)"],["(\\d{3})(\\d{5,7})","$1 $2",["800"],"0$1"],["(\\d{3})(\\d{5,8})","$1 $2",["[2-79]"],"(0$1)"],["(\\d{3})(\\d{3,4})(\\d{3})","$1-$2-$3",["8[1-35-9]"],"0$1"],["(\\d{3})(\\d{6,8})","$1 $2",["1"],"0$1"],["(\\d{3})(\\d{3})(\\d{4})","$1 $2 $3",["804"],"0$1"],["(\\d{3})(\\d)(\\d{3})(\\d{3})","$1 $2 $3 $4",["80"],"0$1"],["(\\d{3})(\\d{4})(\\d{4,5})","$1-$2-$3",["8"],"0$1"]],"0"],IE:["353","00","(?:1\\d|[2569])\\d{6,8}|4\\d{6,9}|7\\d{8}|8\\d{8,9}",[7,8,9,10],[["(\\d{2})(\\d{5})","$1 $2",["2[24-9]|47|58|6[237-9]|9[35-9]"],"(0$1)"],["(\\d{3})(\\d{5})","$1 $2",["[45]0"],"(0$1)"],["(\\d)(\\d{3,4})(\\d{4})","$1 $2 $3",["1"],"(0$1)"],["(\\d{2})(\\d{3})(\\d{3,4})","$1 $2 $3",["[2569]|4[1-69]|7[14]"],"(0$1)"],["(\\d{3})(\\d{3})(\\d{3})","$1 $2 $3",["70"],"0$1"],["(\\d{3})(\\d{3})(\\d{3})","$1 $2 $3",["81"],"(0$1)"],["(\\d{2})(\\d{3})(\\d{4})","$1 $2 $3",["[78]"],"0$1"],["(\\d{4})(\\d{3})(\\d{3})","$1 $2 $3",["1"]],["(\\d{2})(\\d{4})(\\d{4})","$1 $2 $3",["4"],"(0$1)"],["(\\d{2})(\\d)(\\d{3})(\\d{4})","$1 $2 $3 $4",["8"],"0$1"]],"0"],IL:["972","0(?:0|1[2-9])","1\\d{6}(?:\\d{3,5})?|[57]\\d{8}|[1-489]\\d{7}",[7,8,9,10,11,12],[["(\\d{4})(\\d{3})","$1-$2",["125"]],["(\\d{4})(\\d{2})(\\d{2})","$1-$2-$3",["121"]],["(\\d)(\\d{3})(\\d{4})","$1-$2-$3",["[2-489]"],"0$1"],["(\\d{2})(\\d{3})(\\d{4})","$1-$2-$3",["[57]"],"0$1"],["(\\d{4})(\\d{3})(\\d{3})","$1-$2-$3",["12"]],["(\\d{4})(\\d{6})","$1-$2",["159"]],["(\\d)(\\d{3})(\\d{3})(\\d{3})","$1-$2-$3-$4",["1[7-9]"]],["(\\d{3})(\\d{1,2})(\\d{3})(\\d{4})","$1-$2 $3-$4",["15"]]],"0"],IM:["44","00","1624\\d{6}|(?:[3578]\\d|90)\\d{8}",[10],0,"0",0,"([25-8]\\d{5})$|0","1624$1",0,"74576|(?:16|7[56])24"],IN:["91","00","(?:000800|[2-9]\\d\\d)\\d{7}|1\\d{7,12}",[8,9,10,11,12,13],[["(\\d{8})","$1",["5(?:0|2[23]|3[03]|[67]1|88)","5(?:0|2(?:21|3)|3(?:0|3[23])|616|717|888)","5(?:0|2(?:21|3)|3(?:0|3[23])|616|717|8888)"],0,1],["(\\d{4})(\\d{4,5})","$1 $2",["180","1800"],0,1],["(\\d{3})(\\d{3})(\\d{4})","$1 $2 $3",["140"],0,1],["(\\d{2})(\\d{4})(\\d{4})","$1 $2 $3",["11|2[02]|33|4[04]|79[1-7]|80[2-46]","11|2[02]|33|4[04]|79(?:[1-6]|7[19])|80(?:[2-4]|6[0-589])","11|2[02]|33|4[04]|79(?:[124-6]|3(?:[02-9]|1[0-24-9])|7(?:1|9[1-6]))|80(?:[2-4]|6[0-589])"],"0$1",1],["(\\d{3})(\\d{3})(\\d{4})","$1 $2 $3",["1(?:2[0-249]|3[0-25]|4[145]|[68]|7[1257])|2(?:1[257]|3[013]|4[01]|5[0137]|6[0158]|78|8[1568])|3(?:26|4[1-3]|5[34]|6[01489]|7[02-46]|8[159])|4(?:1[36]|2[1-47]|5[12]|6[0-26-9]|7[0-24-9]|8[013-57]|9[014-7])|5(?:1[025]|22|[36][25]|4[28]|5[12]|[78]1)|6(?:12|[2-4]1|5[17]|6[13]|80)|7(?:12|3[134]|4[47]|61|88)|8(?:16|2[014]|3[126]|6[136]|7[078]|8[34]|91)|(?:43|59|75)[15]|(?:1[59]|29|67|72)[14]","1(?:2[0-24]|3[0-25]|4[145]|[59][14]|6[1-9]|7[1257]|8[1-57-9])|2(?:1[257]|3[013]|4[01]|5[0137]|6[058]|78|8[1568]|9[14])|3(?:26|4[1-3]|5[34]|6[01489]|7[02-46]|8[159])|4(?:1[36]|2[1-47]|3[15]|5[12]|6[0-26-9]|7[0-24-9]|8[013-57]|9[014-7])|5(?:1[025]|22|[36][25]|4[28]|[578]1|9[15])|674|7(?:(?:2[14]|3[34]|5[15])[2-6]|61[346]|88[0-8])|8(?:70[2-6]|84[235-7]|91[3-7])|(?:1(?:29|60|8[06])|261|552|6(?:12|[2-47]1|5[17]|6[13]|80)|7(?:12|31|4[47])|8(?:16|2[014]|3[126]|6[136]|7[78]|83))[2-7]","1(?:2[0-24]|3[0-25]|4[145]|[59][14]|6[1-9]|7[1257]|8[1-57-9])|2(?:1[257]|3[013]|4[01]|5[0137]|6[058]|78|8[1568]|9[14])|3(?:26|4[1-3]|5[34]|6[01489]|7[02-46]|8[159])|4(?:1[36]|2[1-47]|3[15]|5[12]|6[0-26-9]|7[0-24-9]|8[013-57]|9[014-7])|5(?:1[025]|22|[36][25]|4[28]|[578]1|9[15])|6(?:12(?:[2-6]|7[0-8])|74[2-7])|7(?:(?:2[14]|5[15])[2-6]|3171|61[346]|88(?:[2-7]|82))|8(?:70[2-6]|84(?:[2356]|7[19])|91(?:[3-6]|7[19]))|73[134][2-6]|(?:74[47]|8(?:16|2[014]|3[126]|6[136]|7[78]|83))(?:[2-6]|7[19])|(?:1(?:29|60|8[06])|261|552|6(?:[2-4]1|5[17]|6[13]|7(?:1|4[0189])|80)|7(?:12|88[01]))[2-7]"],"0$1",1],["(\\d{4})(\\d{3})(\\d{3})","$1 $2 $3",["1(?:[2-479]|5[0235-9])|[2-5]|6(?:1[1358]|2[2457-9]|3[2-5]|4[235-7]|5[2-689]|6[24578]|7[235689]|8[1-6])|7(?:1[013-9]|28|3[129]|4[1-35689]|5[29]|6[02-5]|70)|807","1(?:[2-479]|5[0235-9])|[2-5]|6(?:1[1358]|2(?:[2457]|84|95)|3(?:[2-4]|55)|4[235-7]|5[2-689]|6[24578]|7[235689]|8[1-6])|7(?:1(?:[013-8]|9[6-9])|28[6-8]|3(?:17|2[0-49]|9[2-57])|4(?:1[2-4]|[29][0-7]|3[0-8]|[56]|8[0-24-7])|5(?:2[1-3]|9[0-6])|6(?:0[5689]|2[5-9]|3[02-8]|4|5[0-367])|70[13-7])|807[19]","1(?:[2-479]|5(?:[0236-9]|5[013-9]))|[2-5]|6(?:2(?:84|95)|355|83)|73179|807(?:1|9[1-3])|(?:1552|6(?:1[1358]|2[2457]|3[2-4]|4[235-7]|5[2-689]|6[24578]|7[235689]|8[124-6])\\d|7(?:1(?:[013-8]\\d|9[6-9])|28[6-8]|3(?:2[0-49]|9[2-57])|4(?:1[2-4]|[29][0-7]|3[0-8]|[56]\\d|8[0-24-7])|5(?:2[1-3]|9[0-6])|6(?:0[5689]|2[5-9]|3[02-8]|4\\d|5[0-367])|70[13-7]))[2-7]"],"0$1",1],["(\\d{5})(\\d{5})","$1 $2",["[6-9]"],"0$1",1],["(\\d{4})(\\d{2,4})(\\d{4})","$1 $2 $3",["1(?:6|8[06])","1(?:6|8[06]0)"],0,1],["(\\d{4})(\\d{3})(\\d{3})(\\d{3})","$1 $2 $3 $4",["18"],0,1]],"0"],IO:["246","00","3\\d{6}",[7],[["(\\d{3})(\\d{4})","$1 $2",["3"]]]],IQ:["964","00","(?:1|7\\d\\d)\\d{7}|[2-6]\\d{7,8}",[8,9,10],[["(\\d)(\\d{3})(\\d{4})","$1 $2 $3",["1"],"0$1"],["(\\d{2})(\\d{3})(\\d{3,4})","$1 $2 $3",["[2-6]"],"0$1"],["(\\d{3})(\\d{3})(\\d{4})","$1 $2 $3",["7"],"0$1"]],"0"],IR:["98","00","[1-9]\\d{9}|(?:[1-8]\\d\\d|9)\\d{3,4}",[4,5,6,7,10],[["(\\d{4,5})","$1",["96"],"0$1"],["(\\d{2})(\\d{4,5})","$1 $2",["(?:1[137]|2[13-68]|3[1458]|4[145]|5[1468]|6[16]|7[1467]|8[13467])[12689]"],"0$1"],["(\\d{3})(\\d{3})(\\d{3,4})","$1 $2 $3",["9"],"0$1"],["(\\d{2})(\\d{4})(\\d{4})","$1 $2 $3",["[1-8]"],"0$1"]],"0"],IS:["354","00|1(?:0(?:01|[12]0)|100)","(?:38\\d|[4-9])\\d{6}",[7,9],[["(\\d{3})(\\d{4})","$1 $2",["[4-9]"]],["(\\d{3})(\\d{3})(\\d{3})","$1 $2 $3",["3"]]],0,0,0,0,0,0,0,"00"],IT:["39","00","0\\d{5,10}|1\\d{8,10}|3(?:[0-8]\\d{7,10}|9\\d{7,8})|(?:55|70)\\d{8}|8\\d{5}(?:\\d{2,4})?",[6,7,8,9,10,11],[["(\\d{2})(\\d{4,6})","$1 $2",["0[26]"]],["(\\d{3})(\\d{3,6})","$1 $2",["0[13-57-9][0159]|8(?:03|4[17]|9[2-5])","0[13-57-9][0159]|8(?:03|4[17]|9(?:2|3[04]|[45][0-4]))"]],["(\\d{4})(\\d{2,6})","$1 $2",["0(?:[13-579][2-46-8]|8[236-8])"]],["(\\d{4})(\\d{4})","$1 $2",["894"]],["(\\d{2})(\\d{3,4})(\\d{4})","$1 $2 $3",["0[26]|5"]],["(\\d{3})(\\d{3})(\\d{3,4})","$1 $2 $3",["1(?:44|[679])|[378]"]],["(\\d{3})(\\d{3,4})(\\d{4})","$1 $2 $3",["0[13-57-9][0159]|14"]],["(\\d{2})(\\d{4})(\\d{5})","$1 $2 $3",["0[26]"]],["(\\d{4})(\\d{3})(\\d{4})","$1 $2 $3",["0"]],["(\\d{3})(\\d{4})(\\d{4,5})","$1 $2 $3",["3"]]],0,0,0,0,0,0,[["0669[0-79]\\d{1,6}|0(?:1(?:[0159]\\d|[27][1-5]|31|4[1-4]|6[1356]|8[2-57])|2\\d\\d|3(?:[0159]\\d|2[1-4]|3[12]|[48][1-6]|6[2-59]|7[1-7])|4(?:[0159]\\d|[23][1-9]|4[245]|6[1-5]|7[1-4]|81)|5(?:[0159]\\d|2[1-5]|3[2-6]|4[1-79]|6[4-6]|7[1-578]|8[3-8])|6(?:[0-57-9]\\d|6[0-8])|7(?:[0159]\\d|2[12]|3[1-7]|4[2-46]|6[13569]|7[13-6]|8[1-59])|8(?:[0159]\\d|2[3-578]|3[1-356]|[6-8][1-5])|9(?:[0159]\\d|[238][1-5]|4[12]|6[1-8]|7[1-6]))\\d{2,7}"],["3[1-9]\\d{8}|3[2-9]\\d{7}",[9,10]],["80(?:0\\d{3}|3)\\d{3}",[6,9]],["(?:0878\\d{3}|89(?:2\\d|3[04]|4(?:[0-4]|[5-9]\\d\\d)|5[0-4]))\\d\\d|(?:1(?:44|6[346])|89(?:38|5[5-9]|9))\\d{6}",[6,8,9,10]],["1(?:78\\d|99)\\d{6}",[9,10]],0,0,0,["55\\d{8}",[10]],["84(?:[08]\\d{3}|[17])\\d{3}",[6,9]]]],JE:["44","00","1534\\d{6}|(?:[3578]\\d|90)\\d{8}",[10],0,"0",0,"([0-24-8]\\d{5})$|0","1534$1",0,0,[["1534[0-24-8]\\d{5}"],["7(?:(?:(?:50|82)9|937)\\d|7(?:00[378]|97[7-9]))\\d{5}"],["80(?:07(?:35|81)|8901)\\d{4}"],["(?:8(?:4(?:4(?:4(?:05|42|69)|703)|5(?:041|800))|7(?:0002|1206))|90(?:066[59]|1810|71(?:07|55)))\\d{4}"],["701511\\d{4}"],0,["(?:3(?:0(?:07(?:35|81)|8901)|3\\d{4}|4(?:4(?:4(?:05|42|69)|703)|5(?:041|800))|7(?:0002|1206))|55\\d{4})\\d{4}"],["76(?:464|652)\\d{5}|76(?:0[0-28]|2[356]|34|4[01347]|5[49]|6[0-369]|77|8[14]|9[139])\\d{6}"],["56\\d{8}"]]],JM:["1","011","(?:[58]\\d\\d|658|900)\\d{7}",[10],0,"1",0,0,0,0,"658|876"],JO:["962","00","(?:(?:[2689]|7\\d)\\d|32|53)\\d{6}",[8,9],[["(\\d)(\\d{3})(\\d{4})","$1 $2 $3",["[2356]|87"],"(0$1)"],["(\\d{3})(\\d{5,6})","$1 $2",["[89]"],"0$1"],["(\\d{2})(\\d{7})","$1 $2",["70"],"0$1"],["(\\d)(\\d{4})(\\d{4})","$1 $2 $3",["7"],"0$1"]],"0"],JP:["81","010","00[1-9]\\d{6,14}|[257-9]\\d{9}|(?:00|[1-9]\\d\\d)\\d{6}",[8,9,10,11,12,13,14,15,16,17],[["(\\d{3})(\\d{3})(\\d{3})","$1-$2-$3",["(?:12|57|99)0"],"0$1"],["(\\d{4})(\\d)(\\d{4})","$1-$2-$3",["1(?:26|3[79]|4[56]|5[4-68]|6[3-5])|499|5(?:76|97)|746|8(?:3[89]|47|51)|9(?:80|9[16])","1(?:267|3(?:7[247]|9[278])|466|5(?:47|58|64)|6(?:3[245]|48|5[4-68]))|499[2468]|5(?:76|97)9|7468|8(?:3(?:8[7-9]|96)|477|51[2-9])|9(?:802|9(?:1[23]|69))|1(?:45|58)[67]","1(?:267|3(?:7[247]|9[278])|466|5(?:47|58|64)|6(?:3[245]|48|5[4-68]))|499[2468]|5(?:769|979[2-69])|7468|8(?:3(?:8[7-9]|96[2457-9])|477|51[2-9])|9(?:802|9(?:1[23]|69))|1(?:45|58)[67]"],"0$1"],["(\\d{2})(\\d{3})(\\d{4})","$1-$2-$3",["60"],"0$1"],["(\\d)(\\d{4})(\\d{4})","$1-$2-$3",["[36]|4(?:2[09]|7[01])","[36]|4(?:2(?:0|9[02-69])|7(?:0[019]|1))"],"0$1"],["(\\d{2})(\\d{3})(\\d{4})","$1-$2-$3",["1(?:1|5[45]|77|88|9[69])|2(?:2[1-37]|3[0-269]|4[59]|5|6[24]|7[1-358]|8[1369]|9[0-38])|4(?:[28][1-9]|3[0-57]|[45]|6[248]|7[2-579]|9[29])|5(?:2|3[0459]|4[0-369]|5[29]|8[02389]|9[0-389])|7(?:2[02-46-9]|34|[58]|6[0249]|7[57]|9[2-6])|8(?:2[124589]|3[26-9]|49|51|6|7[0-468]|8[68]|9[019])|9(?:[23][1-9]|4[15]|5[138]|6[1-3]|7[156]|8[189]|9[1-489])","1(?:1|5(?:4[018]|5[017])|77|88|9[69])|2(?:2(?:[127]|3[014-9])|3[0-269]|4[59]|5(?:[1-3]|5[0-69]|9[19])|62|7(?:[1-35]|8[0189])|8(?:[16]|3[0134]|9[0-5])|9(?:[028]|17))|4(?:2(?:[13-79]|8[014-6])|3[0-57]|[45]|6[248]|7[2-47]|8[1-9]|9[29])|5(?:2|3(?:[045]|9[0-8])|4[0-369]|5[29]|8[02389]|9[0-3])|7(?:2[02-46-9]|34|[58]|6[0249]|7[57]|9(?:[23]|4[0-59]|5[01569]|6[0167]))|8(?:2(?:[1258]|4[0-39]|9[0-2469])|3(?:[29]|60)|49|51|6(?:[0-24]|36|5[0-3589]|7[23]|9[01459])|7[0-468]|8[68])|9(?:[23][1-9]|4[15]|5[138]|6[1-3]|7[156]|8[189]|9(?:[1289]|3[34]|4[0178]))|(?:264|837)[016-9]|2(?:57|93)[015-9]|(?:25[0468]|422|838)[01]|(?:47[59]|59[89]|8(?:6[68]|9))[019]","1(?:1|5(?:4[018]|5[017])|77|88|9[69])|2(?:2[127]|3[0-269]|4[59]|5(?:[1-3]|5[0-69]|9(?:17|99))|6(?:2|4[016-9])|7(?:[1-35]|8[0189])|8(?:[16]|3[0134]|9[0-5])|9(?:[028]|17))|4(?:2(?:[13-79]|8[014-6])|3[0-57]|[45]|6[248]|7[2-47]|9[29])|5(?:2|3(?:[045]|9(?:[0-58]|6[4-9]|7[0-35689]))|4[0-369]|5[29]|8[02389]|9[0-3])|7(?:2[02-46-9]|34|[58]|6[0249]|7[57]|9(?:[23]|4[0-59]|5[01569]|6[0167]))|8(?:2(?:[1258]|4[0-39]|9[0169])|3(?:[29]|60|7(?:[017-9]|6[6-8]))|49|51|6(?:[0-24]|36[2-57-9]|5(?:[0-389]|5[23])|6(?:[01]|9[178])|7(?:2[2-468]|3[78])|9[0145])|7[0-468]|8[68])|9(?:4[15]|5[138]|7[156]|8[189]|9(?:[1289]|3(?:31|4[357])|4[0178]))|(?:8294|96)[1-3]|2(?:57|93)[015-9]|(?:223|8699)[014-9]|(?:25[0468]|422|838)[01]|(?:48|8292|9[23])[1-9]|(?:47[59]|59[89]|8(?:68|9))[019]"],"0$1"],["(\\d{3})(\\d{2})(\\d{4})","$1-$2-$3",["[14]|[289][2-9]|5[3-9]|7[2-4679]"],"0$1"],["(\\d{3})(\\d{3})(\\d{4})","$1-$2-$3",["800"],"0$1"],["(\\d{2})(\\d{4})(\\d{4})","$1-$2-$3",["[257-9]"],"0$1"]],"0",0,"(000[259]\\d{6})$|(?:(?:003768)0?)|0","$1"],KE:["254","000","(?:[17]\\d\\d|900)\\d{6}|(?:2|80)0\\d{6,7}|[4-6]\\d{6,8}",[7,8,9,10],[["(\\d{2})(\\d{5,7})","$1 $2",["[24-6]"],"0$1"],["(\\d{3})(\\d{6})","$1 $2",["[17]"],"0$1"],["(\\d{3})(\\d{3})(\\d{3,4})","$1 $2 $3",["[89]"],"0$1"]],"0"],KG:["996","00","8\\d{9}|[235-9]\\d{8}",[9,10],[["(\\d{4})(\\d{5})","$1 $2",["3(?:1[346]|[24-79])"],"0$1"],["(\\d{3})(\\d{3})(\\d{3})","$1 $2 $3",["[235-79]|88"],"0$1"],["(\\d{3})(\\d{3})(\\d)(\\d{2,3})","$1 $2 $3 $4",["8"],"0$1"]],"0"],KH:["855","00[14-9]","1\\d{9}|[1-9]\\d{7,8}",[8,9,10],[["(\\d{2})(\\d{3})(\\d{3,4})","$1 $2 $3",["[1-9]"],"0$1"],["(\\d{4})(\\d{3})(\\d{3})","$1 $2 $3",["1"]]],"0"],KI:["686","00","(?:[37]\\d|6[0-79])\\d{6}|(?:[2-48]\\d|50)\\d{3}",[5,8],0,"0"],KM:["269","00","[3478]\\d{6}",[7],[["(\\d{3})(\\d{2})(\\d{2})","$1 $2 $3",["[3478]"]]]],KN:["1","011","(?:[58]\\d\\d|900)\\d{7}",[10],0,"1",0,"([2-7]\\d{6})$|1","869$1",0,"869"],KP:["850","00|99","85\\d{6}|(?:19\\d|[2-7])\\d{7}",[8,10],[["(\\d{2})(\\d{3})(\\d{3})","$1 $2 $3",["8"],"0$1"],["(\\d)(\\d{3})(\\d{4})","$1 $2 $3",["[2-7]"],"0$1"],["(\\d{3})(\\d{3})(\\d{4})","$1 $2 $3",["1"],"0$1"]],"0"],KR:["82","00(?:[125689]|3(?:[46]5|91)|7(?:00|27|3|55|6[126]))","00[1-9]\\d{8,11}|(?:[12]|5\\d{3})\\d{7}|[13-6]\\d{9}|(?:[1-6]\\d|80)\\d{7}|[3-6]\\d{4,5}|(?:00|7)0\\d{8}",[5,6,8,9,10,11,12,13,14],[["(\\d{2})(\\d{3,4})","$1-$2",["(?:3[1-3]|[46][1-4]|5[1-5])1"],"0$1"],["(\\d{4})(\\d{4})","$1-$2",["1"]],["(\\d)(\\d{3,4})(\\d{4})","$1-$2-$3",["2"],"0$1"],["(\\d{2})(\\d{3})(\\d{4})","$1-$2-$3",["60|8"],"0$1"],["(\\d{2})(\\d{3,4})(\\d{4})","$1-$2-$3",["[1346]|5[1-5]"],"0$1"],["(\\d{2})(\\d{4})(\\d{4})","$1-$2-$3",["[57]"],"0$1"],["(\\d{2})(\\d{5})(\\d{4})","$1-$2-$3",["5"],"0$1"]],"0",0,"0(8(?:[1-46-8]|5\\d\\d))?"],KW:["965","00","18\\d{5}|(?:[2569]\\d|41)\\d{6}",[7,8],[["(\\d{4})(\\d{3,4})","$1 $2",["[169]|2(?:[235]|4[1-35-9])|52"]],["(\\d{3})(\\d{5})","$1 $2",["[245]"]]]],KY:["1","011","(?:345|[58]\\d\\d|900)\\d{7}",[10],0,"1",0,"([2-9]\\d{6})$|1","345$1",0,"345"],KZ:["7","810","(?:33622|8\\d{8})\\d{5}|[78]\\d{9}",[10,14],0,"8",0,0,0,0,"33|7",0,"8~10"],LA:["856","00","[23]\\d{9}|3\\d{8}|(?:[235-8]\\d|41)\\d{6}",[8,9,10],[["(\\d{2})(\\d{3})(\\d{3})","$1 $2 $3",["2[13]|3[14]|[4-8]"],"0$1"],["(\\d{2})(\\d{2})(\\d{2})(\\d{3})","$1 $2 $3 $4",["30[013-9]"],"0$1"],["(\\d{2})(\\d{2})(\\d{3})(\\d{3})","$1 $2 $3 $4",["[23]"],"0$1"]],"0"],LB:["961","00","[27-9]\\d{7}|[13-9]\\d{6}",[7,8],[["(\\d)(\\d{3})(\\d{3})","$1 $2 $3",["[13-69]|7(?:[2-57]|62|8[0-7]|9[04-9])|8[02-9]"],"0$1"],["(\\d{2})(\\d{3})(\\d{3})","$1 $2 $3",["[27-9]"]]],"0"],LC:["1","011","(?:[58]\\d\\d|758|900)\\d{7}",[10],0,"1",0,"([2-8]\\d{6})$|1","758$1",0,"758"],LI:["423","00","[68]\\d{8}|(?:[2378]\\d|90)\\d{5}",[7,9],[["(\\d{3})(\\d{2})(\\d{2})","$1 $2 $3",["[2379]|8(?:0[09]|7)","[2379]|8(?:0(?:02|9)|7)"]],["(\\d{3})(\\d{3})(\\d{3})","$1 $2 $3",["8"]],["(\\d{2})(\\d{3})(\\d{4})","$1 $2 $3",["69"]],["(\\d{3})(\\d{3})(\\d{3})","$1 $2 $3",["6"]]],"0",0,"(1001)|0"],LK:["94","00","[1-9]\\d{8}",[9],[["(\\d{2})(\\d{3})(\\d{4})","$1 $2 $3",["7"],"0$1"],["(\\d{3})(\\d{3})(\\d{3})","$1 $2 $3",["[1-689]"],"0$1"]],"0"],LR:["231","00","(?:[25]\\d|33|77|88)\\d{7}|(?:2\\d|[4-6])\\d{6}",[7,8,9],[["(\\d)(\\d{3})(\\d{3})","$1 $2 $3",["[4-6]"],"0$1"],["(\\d{2})(\\d{3})(\\d{3})","$1 $2 $3",["2"],"0$1"],["(\\d{2})(\\d{3})(\\d{4})","$1 $2 $3",["[23578]"],"0$1"]],"0"],LS:["266","00","(?:[256]\\d\\d|800)\\d{5}",[8],[["(\\d{4})(\\d{4})","$1 $2",["[2568]"]]]],LT:["370","00","(?:[3469]\\d|52|[78]0)\\d{6}",[8],[["(\\d)(\\d{3})(\\d{4})","$1 $2 $3",["52[0-7]"],"(8-$1)",1],["(\\d{3})(\\d{2})(\\d{3})","$1 $2 $3",["[7-9]"],"8 $1",1],["(\\d{2})(\\d{6})","$1 $2",["37|4(?:[15]|6[1-8])"],"(8-$1)",1],["(\\d{3})(\\d{5})","$1 $2",["[3-6]"],"(8-$1)",1]],"8",0,"[08]"],LU:["352","00","35[013-9]\\d{4,8}|6\\d{8}|35\\d{2,4}|(?:[2457-9]\\d|3[0-46-9])\\d{2,9}",[4,5,6,7,8,9,10,11],[["(\\d{2})(\\d{3})","$1 $2",["2(?:0[2-689]|[2-9])|[3-57]|8(?:0[2-9]|[13-9])|9(?:0[89]|[2-579])"]],["(\\d{2})(\\d{2})(\\d{2})","$1 $2 $3",["2(?:0[2-689]|[2-9])|[3-57]|8(?:0[2-9]|[13-9])|9(?:0[89]|[2-579])"]],["(\\d{2})(\\d{2})(\\d{3})","$1 $2 $3",["20[2-689]"]],["(\\d{2})(\\d{2})(\\d{2})(\\d{1,2})","$1 $2 $3 $4",["2(?:[0367]|4[3-8])"]],["(\\d{3})(\\d{2})(\\d{3})","$1 $2 $3",["80[01]|90[015]"]],["(\\d{2})(\\d{2})(\\d{2})(\\d{3})","$1 $2 $3 $4",["20"]],["(\\d{3})(\\d{3})(\\d{3})","$1 $2 $3",["6"]],["(\\d{2})(\\d{2})(\\d{2})(\\d{2})(\\d{1,2})","$1 $2 $3 $4 $5",["2(?:[0367]|4[3-8])"]],["(\\d{2})(\\d{2})(\\d{2})(\\d{1,5})","$1 $2 $3 $4",["[3-57]|8[13-9]|9(?:0[89]|[2-579])|(?:2|80)[2-9]"]]],0,0,"(15(?:0[06]|1[12]|[35]5|4[04]|6[26]|77|88|99)\\d)"],LV:["371","00","(?:[268]\\d|90)\\d{6}",[8],[["(\\d{2})(\\d{3})(\\d{3})","$1 $2 $3",["[269]|8[01]"]]]],LY:["218","00","[2-9]\\d{8}",[9],[["(\\d{2})(\\d{7})","$1-$2",["[2-9]"],"0$1"]],"0"],MA:["212","00","[5-8]\\d{8}",[9],[["(\\d{5})(\\d{4})","$1-$2",["5(?:29|38)","5(?:29[1289]|389)","529(?:1[1-46-9]|2[013-8]|90)|5(?:298|389)[0-46-9]"],"0$1"],["(\\d{3})(\\d{2})(\\d{2})(\\d{2})","$1 $2 $3 $4",["5[45]"],"0$1"],["(\\d{4})(\\d{5})","$1-$2",["5(?:2[2-489]|3[5-9]|9)|892","5(?:2(?:[2-49]|8[235-9])|3[5-9]|9)|892"],"0$1"],["(\\d{2})(\\d{7})","$1-$2",["8"],"0$1"],["(\\d{3})(\\d{6})","$1-$2",["[5-7]"],"0$1"]],"0",0,0,0,0,0,[["5293[01]\\d{4}|5(?:2(?:[0-25-7]\\d|3[1-578]|4[02-46-8]|8[0235-7]|9[0-289])|3(?:[0-47]\\d|5[02-9]|6[02-8]|8[0189]|9[3-9])|(?:4[067]|5[03])\\d)\\d{5}"],["(?:6(?:[0-79]\\d|8[0-247-9])|7(?:[017]\\d|2[0-2]|6[0-8]|8[0-3]))\\d{6}"],["80\\d{7}"],["89\\d{7}"],0,0,0,0,["592(?:4[0-2]|93)\\d{4}"]]],MC:["377","00","(?:[3489]|6\\d)\\d{7}",[8,9],[["(\\d{2})(\\d{3})(\\d{3})","$1 $2 $3",["4"],"0$1"],["(\\d{2})(\\d{2})(\\d{2})(\\d{2})","$1 $2 $3 $4",["[389]"]],["(\\d)(\\d{2})(\\d{2})(\\d{2})(\\d{2})","$1 $2 $3 $4 $5",["6"],"0$1"]],"0"],MD:["373","00","(?:[235-7]\\d|[89]0)\\d{6}",[8],[["(\\d{3})(\\d{5})","$1 $2",["[89]"],"0$1"],["(\\d{2})(\\d{3})(\\d{3})","$1 $2 $3",["22|3"],"0$1"],["(\\d{3})(\\d{2})(\\d{3})","$1 $2 $3",["[25-7]"],"0$1"]],"0"],ME:["382","00","(?:20|[3-79]\\d)\\d{6}|80\\d{6,7}",[8,9],[["(\\d{2})(\\d{3})(\\d{3,4})","$1 $2 $3",["[2-9]"],"0$1"]],"0"],MF:["590","00","590\\d{6}|(?:69|80|9\\d)\\d{7}",[9],0,"0",0,0,0,0,0,[["590(?:0[079]|[14]3|[27][79]|3[03-7]|5[0-268]|87)\\d{4}"],["69(?:0\\d\\d|1(?:2[2-9]|3[0-5]))\\d{4}"],["80[0-5]\\d{6}"],0,0,0,0,0,["9(?:(?:395|76[018])\\d|475[0-5])\\d{4}"]]],MG:["261","00","[23]\\d{8}",[9],[["(\\d{2})(\\d{2})(\\d{3})(\\d{2})","$1 $2 $3 $4",["[23]"],"0$1"]],"0",0,"([24-9]\\d{6})$|0","20$1"],MH:["692","011","329\\d{4}|(?:[256]\\d|45)\\d{5}",[7],[["(\\d{3})(\\d{4})","$1-$2",["[2-6]"]]],"1"],MK:["389","00","[2-578]\\d{7}",[8],[["(\\d)(\\d{3})(\\d{4})","$1 $2 $3",["2|34[47]|4(?:[37]7|5[47]|64)"],"0$1"],["(\\d{2})(\\d{3})(\\d{3})","$1 $2 $3",["[347]"],"0$1"],["(\\d{3})(\\d)(\\d{2})(\\d{2})","$1 $2 $3 $4",["[58]"],"0$1"]],"0"],ML:["223","00","[24-9]\\d{7}",[8],[["(\\d{2})(\\d{2})(\\d{2})(\\d{2})","$1 $2 $3 $4",["[24-9]"]]]],MM:["95","00","1\\d{5,7}|95\\d{6}|(?:[4-7]|9[0-46-9])\\d{6,8}|(?:2|8\\d)\\d{5,8}",[6,7,8,9,10],[["(\\d)(\\d{2})(\\d{3})","$1 $2 $3",["16|2"],"0$1"],["(\\d{2})(\\d{2})(\\d{3})","$1 $2 $3",["[45]|6(?:0[23]|[1-689]|7[235-7])|7(?:[0-4]|5[2-7])|8[1-6]"],"0$1"],["(\\d)(\\d{3})(\\d{3,4})","$1 $2 $3",["[12]"],"0$1"],["(\\d{2})(\\d{3})(\\d{3,4})","$1 $2 $3",["[4-7]|8[1-35]"],"0$1"],["(\\d)(\\d{3})(\\d{4,6})","$1 $2 $3",["9(?:2[0-4]|[35-9]|4[137-9])"],"0$1"],["(\\d)(\\d{4})(\\d{4})","$1 $2 $3",["2"],"0$1"],["(\\d{3})(\\d{3})(\\d{4})","$1 $2 $3",["8"],"0$1"],["(\\d)(\\d{3})(\\d{3})(\\d{3})","$1 $2 $3 $4",["92"],"0$1"],["(\\d)(\\d{5})(\\d{4})","$1 $2 $3",["9"],"0$1"]],"0"],MN:["976","001","[12]\\d{7,9}|[5-9]\\d{7}",[8,9,10],[["(\\d{2})(\\d{2})(\\d{4})","$1 $2 $3",["[12]1"],"0$1"],["(\\d{4})(\\d{4})","$1 $2",["[5-9]"]],["(\\d{3})(\\d{5,6})","$1 $2",["[12]2[1-3]"],"0$1"],["(\\d{4})(\\d{5,6})","$1 $2",["[12](?:27|3[2-8]|4[2-68]|5[1-4689])","[12](?:27|3[2-8]|4[2-68]|5[1-4689])[0-3]"],"0$1"],["(\\d{5})(\\d{4,5})","$1 $2",["[12]"],"0$1"]],"0"],MO:["853","00","0800\\d{3}|(?:28|[68]\\d)\\d{6}",[7,8],[["(\\d{4})(\\d{3})","$1 $2",["0"]],["(\\d{4})(\\d{4})","$1 $2",["[268]"]]]],MP:["1","011","[58]\\d{9}|(?:67|90)0\\d{7}",[10],0,"1",0,"([2-9]\\d{6})$|1","670$1",0,"670"],MQ:["596","00","596\\d{6}|(?:69|80|9\\d)\\d{7}",[9],[["(\\d{3})(\\d{2})(\\d{2})(\\d{2})","$1 $2 $3 $4",["[569]"],"0$1"],["(\\d{3})(\\d{2})(\\d{2})(\\d{2})","$1 $2 $3 $4",["8"],"0$1"]],"0"],MR:["222","00","(?:[2-4]\\d\\d|800)\\d{5}",[8],[["(\\d{2})(\\d{2})(\\d{2})(\\d{2})","$1 $2 $3 $4",["[2-48]"]]]],MS:["1","011","(?:[58]\\d\\d|664|900)\\d{7}",[10],0,"1",0,"([34]\\d{6})$|1","664$1",0,"664"],MT:["356","00","3550\\d{4}|(?:[2579]\\d\\d|800)\\d{5}",[8],[["(\\d{4})(\\d{4})","$1 $2",["[2357-9]"]]]],MU:["230","0(?:0|[24-7]0|3[03])","(?:[57]|8\\d\\d)\\d{7}|[2-468]\\d{6}",[7,8,10],[["(\\d{3})(\\d{4})","$1 $2",["[2-46]|8[013]"]],["(\\d{4})(\\d{4})","$1 $2",["[57]"]],["(\\d{5})(\\d{5})","$1 $2",["8"]]],0,0,0,0,0,0,0,"020"],MV:["960","0(?:0|19)","(?:800|9[0-57-9]\\d)\\d{7}|[34679]\\d{6}",[7,10],[["(\\d{3})(\\d{4})","$1-$2",["[34679]"]],["(\\d{3})(\\d{3})(\\d{4})","$1 $2 $3",["[89]"]]],0,0,0,0,0,0,0,"00"],MW:["265","00","(?:[1289]\\d|31|77)\\d{7}|1\\d{6}",[7,9],[["(\\d)(\\d{3})(\\d{3})","$1 $2 $3",["1[2-9]"],"0$1"],["(\\d{3})(\\d{3})(\\d{3})","$1 $2 $3",["2"],"0$1"],["(\\d{3})(\\d{2})(\\d{2})(\\d{2})","$1 $2 $3 $4",["[137-9]"],"0$1"]],"0"],MX:["52","0[09]","1(?:(?:[27]2|44|99)[1-9]|65[0-689])\\d{7}|(?:1(?:[01]\\d|2[13-9]|[35][1-9]|4[0-35-9]|6[0-46-9]|7[013-9]|8[1-79]|9[1-8])|[2-9]\\d)\\d{8}",[10,11],[["(\\d{2})(\\d{4})(\\d{4})","$1 $2 $3",["33|5[56]|81"],0,1],["(\\d{3})(\\d{3})(\\d{4})","$1 $2 $3",["[2-9]"],0,1],["(\\d)(\\d{2})(\\d{4})(\\d{4})","$2 $3 $4",["1(?:33|5[56]|81)"],0,1],["(\\d)(\\d{3})(\\d{3})(\\d{4})","$2 $3 $4",["1"],0,1]],"01",0,"0(?:[12]|4[45])|1",0,0,0,0,"00"],MY:["60","00","1\\d{8,9}|(?:3\\d|[4-9])\\d{7}",[8,9,10],[["(\\d)(\\d{3})(\\d{4})","$1-$2 $3",["[4-79]"],"0$1"],["(\\d{2})(\\d{3})(\\d{3,4})","$1-$2 $3",["1(?:[02469]|[378][1-9]|53)|8","1(?:[02469]|[37][1-9]|53|8(?:[1-46-9]|5[7-9]))|8"],"0$1"],["(\\d)(\\d{4})(\\d{4})","$1-$2 $3",["3"],"0$1"],["(\\d)(\\d{3})(\\d{2})(\\d{4})","$1-$2-$3-$4",["1(?:[367]|80)"]],["(\\d{3})(\\d{3})(\\d{4})","$1-$2 $3",["15"],"0$1"],["(\\d{2})(\\d{4})(\\d{4})","$1-$2 $3",["1"],"0$1"]],"0"],MZ:["258","00","(?:2|8\\d)\\d{7}",[8,9],[["(\\d{2})(\\d{3})(\\d{3,4})","$1 $2 $3",["2|8[2-79]"]],["(\\d{3})(\\d{3})(\\d{3})","$1 $2 $3",["8"]]]],NA:["264","00","[68]\\d{7,8}",[8,9],[["(\\d{2})(\\d{3})(\\d{3})","$1 $2 $3",["88"],"0$1"],["(\\d{2})(\\d{3})(\\d{3,4})","$1 $2 $3",["6"],"0$1"],["(\\d{3})(\\d{3})(\\d{3})","$1 $2 $3",["87"],"0$1"],["(\\d{2})(\\d{3})(\\d{4})","$1 $2 $3",["8"],"0$1"]],"0"],NC:["687","00","(?:050|[2-57-9]\\d\\d)\\d{3}",[6],[["(\\d{2})(\\d{2})(\\d{2})","$1.$2.$3",["[02-57-9]"]]]],NE:["227","00","[027-9]\\d{7}",[8],[["(\\d{2})(\\d{3})(\\d{3})","$1 $2 $3",["08"]],["(\\d{2})(\\d{2})(\\d{2})(\\d{2})","$1 $2 $3 $4",["[089]|2[013]|7[047]"]]]],NF:["672","00","[13]\\d{5}",[6],[["(\\d{2})(\\d{4})","$1 $2",["1[0-3]"]],["(\\d)(\\d{5})","$1 $2",["[13]"]]],0,0,"([0-258]\\d{4})$","3$1"],NG:["234","009","(?:[124-7]|9\\d{3})\\d{6}|[1-9]\\d{7}|[78]\\d{9,13}",[7,8,10,11,12,13,14],[["(\\d{2})(\\d{2})(\\d{3})","$1 $2 $3",["78"],"0$1"],["(\\d)(\\d{3})(\\d{3,4})","$1 $2 $3",["[12]|9(?:0[3-9]|[1-9])"],"0$1"],["(\\d{2})(\\d{3})(\\d{2,3})","$1 $2 $3",["[3-7]|8[2-9]"],"0$1"],["(\\d{3})(\\d{3})(\\d{3,4})","$1 $2 $3",["[7-9]"],"0$1"],["(\\d{3})(\\d{4})(\\d{4,5})","$1 $2 $3",["[78]"],"0$1"],["(\\d{3})(\\d{5})(\\d{5,6})","$1 $2 $3",["[78]"],"0$1"]],"0"],NI:["505","00","(?:1800|[25-8]\\d{3})\\d{4}",[8],[["(\\d{4})(\\d{4})","$1 $2",["[125-8]"]]]],NL:["31","00","(?:[124-7]\\d\\d|3(?:[02-9]\\d|1[0-8]))\\d{6}|8\\d{6,9}|9\\d{6,10}|1\\d{4,5}",[5,6,7,8,9,10,11],[["(\\d{3})(\\d{4,7})","$1 $2",["[89]0"],"0$1"],["(\\d{2})(\\d{7})","$1 $2",["66"],"0$1"],["(\\d)(\\d{8})","$1 $2",["6"],"0$1"],["(\\d{3})(\\d{3})(\\d{3})","$1 $2 $3",["1[16-8]|2[259]|3[124]|4[17-9]|5[124679]"],"0$1"],["(\\d{2})(\\d{3})(\\d{4})","$1 $2 $3",["[1-578]|91"],"0$1"],["(\\d{3})(\\d{3})(\\d{5})","$1 $2 $3",["9"],"0$1"]],"0"],NO:["47","00","(?:0|[2-9]\\d{3})\\d{4}",[5,8],[["(\\d{3})(\\d{2})(\\d{3})","$1 $2 $3",["8"]],["(\\d{2})(\\d{2})(\\d{2})(\\d{2})","$1 $2 $3 $4",["[2-79]"]]],0,0,0,0,0,"[02-689]|7[0-8]"],NP:["977","00","(?:1\\d|9)\\d{9}|[1-9]\\d{7}",[8,10,11],[["(\\d)(\\d{7})","$1-$2",["1[2-6]"],"0$1"],["(\\d{2})(\\d{6})","$1-$2",["1[01]|[2-8]|9(?:[1-59]|[67][2-6])"],"0$1"],["(\\d{3})(\\d{7})","$1-$2",["9"]]],"0"],NR:["674","00","(?:444|(?:55|8\\d)\\d|666)\\d{4}",[7],[["(\\d{3})(\\d{4})","$1 $2",["[4-68]"]]]],NU:["683","00","(?:[47]|888\\d)\\d{3}",[4,7],[["(\\d{3})(\\d{4})","$1 $2",["8"]]]],NZ:["64","0(?:0|161)","[1289]\\d{9}|50\\d{5}(?:\\d{2,3})?|[27-9]\\d{7,8}|(?:[34]\\d|6[0-35-9])\\d{6}|8\\d{4,6}",[5,6,7,8,9,10],[["(\\d{2})(\\d{3,8})","$1 $2",["8[1-79]"],"0$1"],["(\\d{3})(\\d{2})(\\d{2,3})","$1 $2 $3",["50[036-8]|8|90","50(?:[0367]|88)|8|90"],"0$1"],["(\\d)(\\d{3})(\\d{4})","$1 $2 $3",["24|[346]|7[2-57-9]|9[2-9]"],"0$1"],["(\\d{3})(\\d{3})(\\d{3,4})","$1 $2 $3",["2(?:10|74)|[589]"],"0$1"],["(\\d{2})(\\d{3,4})(\\d{4})","$1 $2 $3",["1|2[028]"],"0$1"],["(\\d{2})(\\d{3})(\\d{3,5})","$1 $2 $3",["2(?:[169]|7[0-35-9])|7"],"0$1"]],"0",0,0,0,0,0,0,"00"],OM:["968","00","(?:1505|[279]\\d{3}|500)\\d{4}|800\\d{5,6}",[7,8,9],[["(\\d{3})(\\d{4,6})","$1 $2",["[58]"]],["(\\d{2})(\\d{6})","$1 $2",["2"]],["(\\d{4})(\\d{4})","$1 $2",["[179]"]]]],PA:["507","00","(?:00800|8\\d{3})\\d{6}|[68]\\d{7}|[1-57-9]\\d{6}",[7,8,10,11],[["(\\d{3})(\\d{4})","$1-$2",["[1-57-9]"]],["(\\d{4})(\\d{4})","$1-$2",["[68]"]],["(\\d{3})(\\d{3})(\\d{4})","$1 $2 $3",["8"]]]],PE:["51","00|19(?:1[124]|77|90)00","(?:[14-8]|9\\d)\\d{7}",[8,9],[["(\\d{3})(\\d{5})","$1 $2",["80"],"(0$1)"],["(\\d)(\\d{7})","$1 $2",["1"],"(0$1)"],["(\\d{2})(\\d{6})","$1 $2",["[4-8]"],"(0$1)"],["(\\d{3})(\\d{3})(\\d{3})","$1 $2 $3",["9"]]],"0",0,0,0,0,0,0,"00"," Anexo "],PF:["689","00","4\\d{5}(?:\\d{2})?|8\\d{7,8}",[6,8,9],[["(\\d{2})(\\d{2})(\\d{2})","$1 $2 $3",["44"]],["(\\d{2})(\\d{2})(\\d{2})(\\d{2})","$1 $2 $3 $4",["4|8[7-9]"]],["(\\d{3})(\\d{2})(\\d{2})(\\d{2})","$1 $2 $3 $4",["8"]]]],PG:["675","00|140[1-3]","(?:180|[78]\\d{3})\\d{4}|(?:[2-589]\\d|64)\\d{5}",[7,8],[["(\\d{3})(\\d{4})","$1 $2",["18|[2-69]|85"]],["(\\d{4})(\\d{4})","$1 $2",["[78]"]]],0,0,0,0,0,0,0,"00"],PH:["63","00","(?:[2-7]|9\\d)\\d{8}|2\\d{5}|(?:1800|8)\\d{7,9}",[6,8,9,10,11,12,13],[["(\\d)(\\d{5})","$1 $2",["2"],"(0$1)"],["(\\d{4})(\\d{4,6})","$1 $2",["3(?:23|39|46)|4(?:2[3-6]|[35]9|4[26]|76)|544|88[245]|(?:52|64|86)2","3(?:230|397|461)|4(?:2(?:35|[46]4|51)|396|4(?:22|63)|59[347]|76[15])|5(?:221|446)|642[23]|8(?:622|8(?:[24]2|5[13]))"],"(0$1)"],["(\\d{5})(\\d{4})","$1 $2",["346|4(?:27|9[35])|883","3469|4(?:279|9(?:30|56))|8834"],"(0$1)"],["(\\d)(\\d{4})(\\d{4})","$1 $2 $3",["2"],"(0$1)"],["(\\d{2})(\\d{3})(\\d{4})","$1 $2 $3",["[3-7]|8[2-8]"],"(0$1)"],["(\\d{3})(\\d{3})(\\d{4})","$1 $2 $3",["[89]"],"0$1"],["(\\d{4})(\\d{3})(\\d{4})","$1 $2 $3",["1"]],["(\\d{4})(\\d{1,2})(\\d{3})(\\d{4})","$1 $2 $3 $4",["1"]]],"0"],PK:["92","00","122\\d{6}|[24-8]\\d{10,11}|9(?:[013-9]\\d{8,10}|2(?:[01]\\d\\d|2(?:[06-8]\\d|1[01]))\\d{7})|(?:[2-8]\\d{3}|92(?:[0-7]\\d|8[1-9]))\\d{6}|[24-9]\\d{8}|[89]\\d{7}",[8,9,10,11,12],[["(\\d{3})(\\d{3})(\\d{2,7})","$1 $2 $3",["[89]0"],"0$1"],["(\\d{4})(\\d{5})","$1 $2",["1"]],["(\\d{3})(\\d{6,7})","$1 $2",["2(?:3[2358]|4[2-4]|9[2-8])|45[3479]|54[2-467]|60[468]|72[236]|8(?:2[2-689]|3[23578]|4[3478]|5[2356])|9(?:2[2-8]|3[27-9]|4[2-6]|6[3569]|9[25-8])","9(?:2[3-8]|98)|(?:2(?:3[2358]|4[2-4]|9[2-8])|45[3479]|54[2-467]|60[468]|72[236]|8(?:2[2-689]|3[23578]|4[3478]|5[2356])|9(?:22|3[27-9]|4[2-6]|6[3569]|9[25-7]))[2-9]"],"(0$1)"],["(\\d{2})(\\d{7,8})","$1 $2",["(?:2[125]|4[0-246-9]|5[1-35-7]|6[1-8]|7[14]|8[16]|91)[2-9]"],"(0$1)"],["(\\d{5})(\\d{5})","$1 $2",["58"],"(0$1)"],["(\\d{3})(\\d{7})","$1 $2",["3"],"0$1"],["(\\d{2})(\\d{3})(\\d{3})(\\d{3})","$1 $2 $3 $4",["2[125]|4[0-246-9]|5[1-35-7]|6[1-8]|7[14]|8[16]|91"],"(0$1)"],["(\\d{3})(\\d{3})(\\d{3})(\\d{3})","$1 $2 $3 $4",["[24-9]"],"(0$1)"]],"0"],PL:["48","00","(?:6|8\\d\\d)\\d{7}|[1-9]\\d{6}(?:\\d{2})?|[26]\\d{5}",[6,7,8,9,10],[["(\\d{5})","$1",["19"]],["(\\d{3})(\\d{3})","$1 $2",["11|20|64"]],["(\\d{2})(\\d{2})(\\d{3})","$1 $2 $3",["(?:1[2-8]|2[2-69]|3[2-4]|4[1-468]|5[24-689]|6[1-3578]|7[14-7]|8[1-79]|9[145])1","(?:1[2-8]|2[2-69]|3[2-4]|4[1-468]|5[24-689]|6[1-3578]|7[14-7]|8[1-79]|9[145])19"]],["(\\d{3})(\\d{2})(\\d{2,3})","$1 $2 $3",["64"]],["(\\d{3})(\\d{3})(\\d{3})","$1 $2 $3",["21|39|45|5[0137]|6[0469]|7[02389]|8(?:0[14]|8)"]],["(\\d{2})(\\d{3})(\\d{2})(\\d{2})","$1 $2 $3 $4",["1[2-8]|[2-7]|8[1-79]|9[145]"]],["(\\d{3})(\\d{3})(\\d{3,4})","$1 $2 $3",["8"]]]],PM:["508","00","[45]\\d{5}|(?:708|80\\d)\\d{6}",[6,9],[["(\\d{2})(\\d{2})(\\d{2})","$1 $2 $3",["[45]"],"0$1"],["(\\d{3})(\\d{3})(\\d{3})","$1 $2 $3",["7"]],["(\\d{3})(\\d{2})(\\d{2})(\\d{2})","$1 $2 $3 $4",["8"],"0$1"]],"0"],PR:["1","011","(?:[589]\\d\\d|787)\\d{7}",[10],0,"1",0,0,0,0,"787|939"],PS:["970","00","[2489]2\\d{6}|(?:1\\d|5)\\d{8}",[8,9,10],[["(\\d)(\\d{3})(\\d{4})","$1 $2 $3",["[2489]"],"0$1"],["(\\d{3})(\\d{3})(\\d{3})","$1 $2 $3",["5"],"0$1"],["(\\d{4})(\\d{3})(\\d{3})","$1 $2 $3",["1"]]],"0"],PT:["351","00","1693\\d{5}|(?:[26-9]\\d|30)\\d{7}",[9],[["(\\d{2})(\\d{3})(\\d{4})","$1 $2 $3",["2[12]"]],["(\\d{3})(\\d{3})(\\d{3})","$1 $2 $3",["16|[236-9]"]]]],PW:["680","01[12]","(?:[24-8]\\d\\d|345|900)\\d{4}",[7],[["(\\d{3})(\\d{4})","$1 $2",["[2-9]"]]]],PY:["595","00","59\\d{4,6}|9\\d{5,10}|(?:[2-46-8]\\d|5[0-8])\\d{4,7}",[6,7,8,9,10,11],[["(\\d{3})(\\d{3,6})","$1 $2",["[2-9]0"],"0$1"],["(\\d{2})(\\d{5})","$1 $2",["[26]1|3[289]|4[1246-8]|7[1-3]|8[1-36]"],"(0$1)"],["(\\d{3})(\\d{4,5})","$1 $2",["2[279]|3[13-5]|4[359]|5|6(?:[34]|7[1-46-8])|7[46-8]|85"],"(0$1)"],["(\\d{2})(\\d{3})(\\d{3,4})","$1 $2 $3",["2[14-68]|3[26-9]|4[1246-8]|6(?:1|75)|7[1-35]|8[1-36]"],"(0$1)"],["(\\d{2})(\\d{3})(\\d{4})","$1 $2 $3",["87"]],["(\\d{3})(\\d{6})","$1 $2",["9(?:[5-79]|8[1-6])"],"0$1"],["(\\d{3})(\\d{3})(\\d{3})","$1 $2 $3",["[2-8]"],"0$1"],["(\\d{4})(\\d{3})(\\d{4})","$1 $2 $3",["9"]]],"0"],QA:["974","00","800\\d{4}|(?:2|800)\\d{6}|(?:0080|[3-7])\\d{7}",[7,8,9,11],[["(\\d{3})(\\d{4})","$1 $2",["2[16]|8"]],["(\\d{4})(\\d{4})","$1 $2",["[3-7]"]]]],RE:["262","00","(?:26|[689]\\d)\\d{7}",[9],[["(\\d{3})(\\d{2})(\\d{2})(\\d{2})","$1 $2 $3 $4",["[2689]"],"0$1"]],"0",0,0,0,0,0,[["26(?:2\\d\\d|3(?:0\\d|1[0-5]))\\d{4}"],["69(?:2\\d\\d|3(?:[06][0-6]|1[013]|2[0-2]|3[0-39]|4\\d|5[0-5]|7[0-27]|8[0-8]|9[0-479]))\\d{4}"],["80\\d{7}"],["89[1-37-9]\\d{6}"],0,0,0,0,["9(?:399[0-3]|479[0-5]|76(?:2[27]|3[0-37]))\\d{4}"],["8(?:1[019]|2[0156]|84|90)\\d{6}"]]],RO:["40","00","(?:[2378]\\d|90)\\d{7}|[23]\\d{5}",[6,9],[["(\\d{3})(\\d{3})","$1 $2",["2[3-6]","2[3-6]\\d9"],"0$1"],["(\\d{2})(\\d{4})","$1 $2",["219|31"],"0$1"],["(\\d{2})(\\d{3})(\\d{4})","$1 $2 $3",["[23]1"],"0$1"],["(\\d{3})(\\d{3})(\\d{3})","$1 $2 $3",["[237-9]"],"0$1"]],"0",0,0,0,0,0,0,0," int "],RS:["381","00","38[02-9]\\d{6,9}|6\\d{7,9}|90\\d{4,8}|38\\d{5,6}|(?:7\\d\\d|800)\\d{3,9}|(?:[12]\\d|3[0-79])\\d{5,10}",[6,7,8,9,10,11,12],[["(\\d{3})(\\d{3,9})","$1 $2",["(?:2[389]|39)0|[7-9]"],"0$1"],["(\\d{2})(\\d{5,10})","$1 $2",["[1-36]"],"0$1"]],"0"],RU:["7","810","8\\d{13}|[347-9]\\d{9}",[10,14],[["(\\d{4})(\\d{2})(\\d{2})(\\d{2})","$1 $2 $3 $4",["7(?:1[0-8]|2[1-9])","7(?:1(?:[0-356]2|4[29]|7|8[27])|2(?:1[23]|[2-9]2))","7(?:1(?:[0-356]2|4[29]|7|8[27])|2(?:13[03-69]|62[013-9]))|72[1-57-9]2"],"8 ($1)",1],["(\\d{5})(\\d)(\\d{2})(\\d{2})","$1 $2 $3 $4",["7(?:1[0-68]|2[1-9])","7(?:1(?:[06][3-6]|[18]|2[35]|[3-5][3-5])|2(?:[13][3-5]|[24-689]|7[457]))","7(?:1(?:0(?:[356]|4[023])|[18]|2(?:3[013-9]|5)|3[45]|43[013-79]|5(?:3[1-8]|4[1-7]|5)|6(?:3[0-35-9]|[4-6]))|2(?:1(?:3[178]|[45])|[24-689]|3[35]|7[457]))|7(?:14|23)4[0-8]|71(?:33|45)[1-79]"],"8 ($1)",1],["(\\d{3})(\\d{3})(\\d{4})","$1 $2 $3",["7"],"8 ($1)",1],["(\\d{3})(\\d{3})(\\d{2})(\\d{2})","$1 $2-$3-$4",["[349]|8(?:[02-7]|1[1-8])"],"8 ($1)",1],["(\\d{4})(\\d{4})(\\d{3})(\\d{3})","$1 $2 $3 $4",["8"],"8 ($1)"]],"8",0,0,0,0,"3[04-689]|[489]",0,"8~10"],RW:["250","00","(?:06|[27]\\d\\d|[89]00)\\d{6}",[8,9],[["(\\d{2})(\\d{2})(\\d{2})(\\d{2})","$1 $2 $3 $4",["0"]],["(\\d{3})(\\d{3})(\\d{3})","$1 $2 $3",["2"]],["(\\d{3})(\\d{3})(\\d{3})","$1 $2 $3",["[7-9]"],"0$1"]],"0"],SA:["966","00","92\\d{7}|(?:[15]|8\\d)\\d{8}",[9,10],[["(\\d{4})(\\d{5})","$1 $2",["9"]],["(\\d{2})(\\d{3})(\\d{4})","$1 $2 $3",["1"],"0$1"],["(\\d{2})(\\d{3})(\\d{4})","$1 $2 $3",["5"],"0$1"],["(\\d{3})(\\d{3})(\\d{3,4})","$1 $2 $3",["81"],"0$1"],["(\\d{3})(\\d{3})(\\d{4})","$1 $2 $3",["8"]]],"0"],SB:["677","0[01]","(?:[1-6]|[7-9]\\d\\d)\\d{4}",[5,7],[["(\\d{2})(\\d{5})","$1 $2",["7|8[4-9]|9(?:[1-8]|9[0-8])"]]]],SC:["248","010|0[0-2]","800\\d{4}|(?:[249]\\d|64)\\d{5}",[7],[["(\\d)(\\d{3})(\\d{3})","$1 $2 $3",["[246]|9[57]"]]],0,0,0,0,0,0,0,"00"],SD:["249","00","[19]\\d{8}",[9],[["(\\d{2})(\\d{3})(\\d{4})","$1 $2 $3",["[19]"],"0$1"]],"0"],SE:["46","00","(?:[26]\\d\\d|9)\\d{9}|[1-9]\\d{8}|[1-689]\\d{7}|[1-4689]\\d{6}|2\\d{5}",[6,7,8,9,10],[["(\\d{2})(\\d{2,3})(\\d{2})","$1-$2 $3",["20"],"0$1",0,"$1 $2 $3"],["(\\d{3})(\\d{4})","$1-$2",["9(?:00|39|44|9)"],"0$1",0,"$1 $2"],["(\\d{2})(\\d{3})(\\d{2})","$1-$2 $3",["[12][136]|3[356]|4[0246]|6[03]|90[1-9]"],"0$1",0,"$1 $2 $3"],["(\\d)(\\d{2,3})(\\d{2})(\\d{2})","$1-$2 $3 $4",["8"],"0$1",0,"$1 $2 $3 $4"],["(\\d{3})(\\d{2,3})(\\d{2})","$1-$2 $3",["1[2457]|2(?:[247-9]|5[0138])|3[0247-9]|4[1357-9]|5[0-35-9]|6(?:[125689]|4[02-57]|7[0-2])|9(?:[125-8]|3[02-5]|4[0-3])"],"0$1",0,"$1 $2 $3"],["(\\d{3})(\\d{2,3})(\\d{3})","$1-$2 $3",["9(?:00|39|44)"],"0$1",0,"$1 $2 $3"],["(\\d{2})(\\d{2,3})(\\d{2})(\\d{2})","$1-$2 $3 $4",["1[13689]|2[0136]|3[1356]|4[0246]|54|6[03]|90[1-9]"],"0$1",0,"$1 $2 $3 $4"],["(\\d{2})(\\d{3})(\\d{2})(\\d{2})","$1-$2 $3 $4",["10|7"],"0$1",0,"$1 $2 $3 $4"],["(\\d)(\\d{3})(\\d{3})(\\d{2})","$1-$2 $3 $4",["8"],"0$1",0,"$1 $2 $3 $4"],["(\\d{3})(\\d{2})(\\d{2})(\\d{2})","$1-$2 $3 $4",["[13-5]|2(?:[247-9]|5[0138])|6(?:[124-689]|7[0-2])|9(?:[125-8]|3[02-5]|4[0-3])"],"0$1",0,"$1 $2 $3 $4"],["(\\d{3})(\\d{2})(\\d{2})(\\d{3})","$1-$2 $3 $4",["9"],"0$1",0,"$1 $2 $3 $4"],["(\\d{3})(\\d{2})(\\d{3})(\\d{2})(\\d{2})","$1-$2 $3 $4 $5",["[26]"],"0$1",0,"$1 $2 $3 $4 $5"]],"0"],SG:["65","0[0-3]\\d","(?:(?:1\\d|8)\\d\\d|7000)\\d{7}|[3689]\\d{7}",[8,10,11],[["(\\d{4})(\\d{4})","$1 $2",["[369]|8(?:0[1-8]|[1-9])"]],["(\\d{3})(\\d{3})(\\d{4})","$1 $2 $3",["8"]],["(\\d{4})(\\d{4})(\\d{3})","$1 $2 $3",["7"]],["(\\d{4})(\\d{3})(\\d{4})","$1 $2 $3",["1"]]]],SH:["290","00","(?:[256]\\d|8)\\d{3}",[4,5],0,0,0,0,0,0,"[256]"],SI:["386","00|10(?:22|66|88|99)","[1-7]\\d{7}|8\\d{4,7}|90\\d{4,6}",[5,6,7,8],[["(\\d{2})(\\d{3,6})","$1 $2",["8[09]|9"],"0$1"],["(\\d{3})(\\d{5})","$1 $2",["59|8"],"0$1"],["(\\d{2})(\\d{3})(\\d{3})","$1 $2 $3",["[37][01]|4[0139]|51|6"],"0$1"],["(\\d)(\\d{3})(\\d{2})(\\d{2})","$1 $2 $3 $4",["[1-57]"],"(0$1)"]],"0",0,0,0,0,0,0,"00"],SJ:["47","00","0\\d{4}|(?:[489]\\d|79)\\d{6}",[5,8],0,0,0,0,0,0,"79"],SK:["421","00","[2-689]\\d{8}|[2-59]\\d{6}|[2-5]\\d{5}",[6,7,9],[["(\\d)(\\d{2})(\\d{3,4})","$1 $2 $3",["21"],"0$1"],["(\\d{2})(\\d{2})(\\d{2,3})","$1 $2 $3",["[3-5][1-8]1","[3-5][1-8]1[67]"],"0$1"],["(\\d)(\\d{3})(\\d{3})(\\d{2})","$1/$2 $3 $4",["2"],"0$1"],["(\\d{3})(\\d{3})(\\d{3})","$1 $2 $3",["[689]"],"0$1"],["(\\d{2})(\\d{3})(\\d{2})(\\d{2})","$1/$2 $3 $4",["[3-5]"],"0$1"]],"0"],SL:["232","00","(?:[237-9]\\d|66)\\d{6}",[8],[["(\\d{2})(\\d{6})","$1 $2",["[236-9]"],"(0$1)"]],"0"],SM:["378","00","(?:0549|[5-7]\\d)\\d{6}",[8,10],[["(\\d{2})(\\d{2})(\\d{2})(\\d{2})","$1 $2 $3 $4",["[5-7]"]],["(\\d{4})(\\d{6})","$1 $2",["0"]]],0,0,"([89]\\d{5})$","0549$1"],SN:["221","00","(?:[378]\\d|93)\\d{7}",[9],[["(\\d{3})(\\d{2})(\\d{2})(\\d{2})","$1 $2 $3 $4",["8"]],["(\\d{2})(\\d{3})(\\d{2})(\\d{2})","$1 $2 $3 $4",["[379]"]]]],SO:["252","00","[346-9]\\d{8}|[12679]\\d{7}|[1-5]\\d{6}|[1348]\\d{5}",[6,7,8,9],[["(\\d{2})(\\d{4})","$1 $2",["8[125]"]],["(\\d{6})","$1",["[134]"]],["(\\d)(\\d{6})","$1 $2",["[15]|2[0-79]|3[0-46-8]|4[0-7]"]],["(\\d)(\\d{7})","$1 $2",["(?:2|90)4|[67]"]],["(\\d{3})(\\d{3})(\\d{3})","$1 $2 $3",["[348]|64|79|90"]],["(\\d{2})(\\d{5,7})","$1 $2",["1|28|6[0-35-9]|77|9[2-9]"]]],"0"],SR:["597","00","(?:[2-5]|68|[78]\\d)\\d{5}",[6,7],[["(\\d{2})(\\d{2})(\\d{2})","$1-$2-$3",["56"]],["(\\d{3})(\\d{3})","$1-$2",["[2-5]"]],["(\\d{3})(\\d{4})","$1-$2",["[6-8]"]]]],SS:["211","00","[19]\\d{8}",[9],[["(\\d{3})(\\d{3})(\\d{3})","$1 $2 $3",["[19]"],"0$1"]],"0"],ST:["239","00","(?:22|9\\d)\\d{5}",[7],[["(\\d{3})(\\d{4})","$1 $2",["[29]"]]]],SV:["503","00","[267]\\d{7}|[89]00\\d{4}(?:\\d{4})?",[7,8,11],[["(\\d{3})(\\d{4})","$1 $2",["[89]"]],["(\\d{4})(\\d{4})","$1 $2",["[267]"]],["(\\d{3})(\\d{4})(\\d{4})","$1 $2 $3",["[89]"]]]],SX:["1","011","7215\\d{6}|(?:[58]\\d\\d|900)\\d{7}",[10],0,"1",0,"(5\\d{6})$|1","721$1",0,"721"],SY:["963","00","[1-39]\\d{8}|[1-5]\\d{7}",[8,9],[["(\\d{2})(\\d{3})(\\d{3,4})","$1 $2 $3",["[1-5]"],"0$1",1],["(\\d{3})(\\d{3})(\\d{3})","$1 $2 $3",["9"],"0$1",1]],"0"],SZ:["268","00","0800\\d{4}|(?:[237]\\d|900)\\d{6}",[8,9],[["(\\d{4})(\\d{4})","$1 $2",["[0237]"]],["(\\d{5})(\\d{4})","$1 $2",["9"]]]],TA:["290","00","8\\d{3}",[4],0,0,0,0,0,0,"8"],TC:["1","011","(?:[58]\\d\\d|649|900)\\d{7}",[10],0,"1",0,"([2-479]\\d{6})$|1","649$1",0,"649"],TD:["235","00|16","(?:22|[69]\\d|77)\\d{6}",[8],[["(\\d{2})(\\d{2})(\\d{2})(\\d{2})","$1 $2 $3 $4",["[2679]"]]],0,0,0,0,0,0,0,"00"],TG:["228","00","[279]\\d{7}",[8],[["(\\d{2})(\\d{2})(\\d{2})(\\d{2})","$1 $2 $3 $4",["[279]"]]]],TH:["66","00[1-9]","(?:001800|[2-57]|[689]\\d)\\d{7}|1\\d{7,9}",[8,9,10,13],[["(\\d)(\\d{3})(\\d{4})","$1 $2 $3",["2"],"0$1"],["(\\d{2})(\\d{3})(\\d{3,4})","$1 $2 $3",["[13-9]"],"0$1"],["(\\d{4})(\\d{3})(\\d{3})","$1 $2 $3",["1"]]],"0"],TJ:["992","810","[0-57-9]\\d{8}",[9],[["(\\d{6})(\\d)(\\d{2})","$1 $2 $3",["331","3317"]],["(\\d{3})(\\d{2})(\\d{4})","$1 $2 $3",["44[04]|[34]7"]],["(\\d{4})(\\d)(\\d{4})","$1 $2 $3",["3[1-5]"]],["(\\d{2})(\\d{3})(\\d{4})","$1 $2 $3",["[0-57-9]"]]],0,0,0,0,0,0,0,"8~10"],TK:["690","00","[2-47]\\d{3,6}",[4,5,6,7]],TL:["670","00","7\\d{7}|(?:[2-47]\\d|[89]0)\\d{5}",[7,8],[["(\\d{3})(\\d{4})","$1 $2",["[2-489]|70"]],["(\\d{4})(\\d{4})","$1 $2",["7"]]]],TM:["993","810","[1-6]\\d{7}",[8],[["(\\d{2})(\\d{2})(\\d{2})(\\d{2})","$1 $2-$3-$4",["12"],"(8 $1)"],["(\\d{3})(\\d)(\\d{2})(\\d{2})","$1 $2-$3-$4",["[1-5]"],"(8 $1)"],["(\\d{2})(\\d{6})","$1 $2",["6"],"8 $1"]],"8",0,0,0,0,0,0,"8~10"],TN:["216","00","[2-57-9]\\d{7}",[8],[["(\\d{2})(\\d{3})(\\d{3})","$1 $2 $3",["[2-57-9]"]]]],TO:["676","00","(?:0800|(?:[5-8]\\d\\d|999)\\d)\\d{3}|[2-8]\\d{4}",[5,7],[["(\\d{2})(\\d{3})","$1-$2",["[2-4]|50|6[09]|7[0-24-69]|8[05]"]],["(\\d{4})(\\d{3})","$1 $2",["0"]],["(\\d{3})(\\d{4})","$1 $2",["[5-9]"]]]],TR:["90","00","4\\d{6}|8\\d{11,12}|(?:[2-58]\\d\\d|900)\\d{7}",[7,10,12,13],[["(\\d{3})(\\d{3})(\\d{4})","$1 $2 $3",["512|8[01589]|90"],"0$1",1],["(\\d{3})(\\d{3})(\\d{2})(\\d{2})","$1 $2 $3 $4",["5(?:[0-59]|61)","5(?:[0-59]|616)","5(?:[0-59]|6161)"],"0$1",1],["(\\d{3})(\\d{3})(\\d{2})(\\d{2})","$1 $2 $3 $4",["[24][1-8]|3[1-9]"],"(0$1)",1],["(\\d{3})(\\d{3})(\\d{6,7})","$1 $2 $3",["80"],"0$1",1]],"0"],TT:["1","011","(?:[58]\\d\\d|900)\\d{7}",[10],0,"1",0,"([2-46-8]\\d{6})$|1","868$1",0,"868"],TV:["688","00","(?:2|7\\d\\d|90)\\d{4}",[5,6,7],[["(\\d{2})(\\d{3})","$1 $2",["2"]],["(\\d{2})(\\d{4})","$1 $2",["90"]],["(\\d{2})(\\d{5})","$1 $2",["7"]]]],TW:["886","0(?:0[25-79]|19)","[2-689]\\d{8}|7\\d{9,10}|[2-8]\\d{7}|2\\d{6}",[7,8,9,10,11],[["(\\d{2})(\\d)(\\d{4})","$1 $2 $3",["202"],"0$1"],["(\\d{2})(\\d{3})(\\d{3,4})","$1 $2 $3",["[258]0"],"0$1"],["(\\d)(\\d{3,4})(\\d{4})","$1 $2 $3",["[23568]|4(?:0[02-48]|[1-47-9])|7[1-9]","[23568]|4(?:0[2-48]|[1-47-9])|(?:400|7)[1-9]"],"0$1"],["(\\d{3})(\\d{3})(\\d{3})","$1 $2 $3",["[49]"],"0$1"],["(\\d{2})(\\d{4})(\\d{4,5})","$1 $2 $3",["7"],"0$1"]],"0",0,0,0,0,0,0,0,"#"],TZ:["255","00[056]","(?:[25-8]\\d|41|90)\\d{7}",[9],[["(\\d{3})(\\d{2})(\\d{4})","$1 $2 $3",["[89]"],"0$1"],["(\\d{2})(\\d{3})(\\d{4})","$1 $2 $3",["[24]"],"0$1"],["(\\d{2})(\\d{7})","$1 $2",["5"]],["(\\d{3})(\\d{3})(\\d{3})","$1 $2 $3",["[67]"],"0$1"]],"0"],UA:["380","00","[89]\\d{9}|[3-9]\\d{8}",[9,10],[["(\\d{3})(\\d{3})(\\d{3})","$1 $2 $3",["6[12][29]|(?:3[1-8]|4[136-8]|5[12457]|6[49])2|(?:56|65)[24]","6[12][29]|(?:35|4[1378]|5[12457]|6[49])2|(?:56|65)[24]|(?:3[1-46-8]|46)2[013-9]"],"0$1"],["(\\d{4})(\\d{5})","$1 $2",["3[1-8]|4(?:[1367]|[45][6-9]|8[4-6])|5(?:[1-5]|6[0135689]|7[4-6])|6(?:[12][3-7]|[459])","3[1-8]|4(?:[1367]|[45][6-9]|8[4-6])|5(?:[1-5]|6(?:[015689]|3[02389])|7[4-6])|6(?:[12][3-7]|[459])"],"0$1"],["(\\d{2})(\\d{3})(\\d{4})","$1 $2 $3",["[3-7]|89|9[1-9]"],"0$1"],["(\\d{3})(\\d{3})(\\d{3,4})","$1 $2 $3",["[89]"],"0$1"]],"0",0,0,0,0,0,0,"0~0"],UG:["256","00[057]","800\\d{6}|(?:[29]0|[347]\\d)\\d{7}",[9],[["(\\d{4})(\\d{5})","$1 $2",["202","2024"],"0$1"],["(\\d{3})(\\d{6})","$1 $2",["[27-9]|4(?:6[45]|[7-9])"],"0$1"],["(\\d{2})(\\d{7})","$1 $2",["[34]"],"0$1"]],"0"],US:["1","011","[2-9]\\d{9}|3\\d{6}",[10],[["(\\d{3})(\\d{4})","$1-$2",["310"],0,1],["(\\d{3})(\\d{3})(\\d{4})","($1) $2-$3",["[2-9]"],0,1,"$1-$2-$3"]],"1",0,0,0,0,0,[["5056(?:[0-35-9]\\d|4[46])\\d{4}|(?:4722|505[2-57-9]|983[29])\\d{6}|(?:2(?:0[1-35-9]|1[02-9]|2[03-589]|3[149]|4[08]|5[1-46]|6[0279]|7[0269]|8[13])|3(?:0[1-57-9]|1[02-9]|2[01356]|3[0-24679]|4[167]|5[0-2]|6[014]|8[056])|4(?:0[124-9]|1[02-579]|2[3-5]|3[0245]|4[023578]|58|6[349]|7[0589]|8[04])|5(?:0[1-47-9]|1[0235-8]|20|3[0149]|4[01]|5[179]|6[1-47]|7[0-5]|8[0256])|6(?:0[1-35-9]|1[024-9]|2[03689]|[34][016]|5[01679]|6[0-279]|78|8[0-29])|7(?:0[1-46-8]|1[2-9]|2[04-7]|3[1247]|4[037]|5[47]|6[02359]|7[0-59]|8[156])|8(?:0[1-68]|1[02-8]|2[068]|3[0-2589]|4[03578]|5[046-9]|6[02-5]|7[028])|9(?:0[1346-9]|1[02-9]|2[0589]|3[0146-8]|4[01357-9]|5[12469]|7[0-389]|8[04-69]))[2-9]\\d{6}"],[""],["8(?:00|33|44|55|66|77|88)[2-9]\\d{6}"],["900[2-9]\\d{6}"],["52(?:3(?:[2-46-9][02-9]\\d|5(?:[02-46-9]\\d|5[0-46-9]))|4(?:[2-478][02-9]\\d|5(?:[034]\\d|2[024-9]|5[0-46-9])|6(?:0[1-9]|[2-9]\\d)|9(?:[05-9]\\d|2[0-5]|49)))\\d{4}|52[34][2-9]1[02-9]\\d{4}|5(?:00|2[125-9]|33|44|66|77|88)[2-9]\\d{6}"]]],UY:["598","0(?:0|1[3-9]\\d)","(?:0004|4)\\d{9}|[1249]\\d{7}|(?:[49]\\d|80)\\d{5}",[7,8,10,13],[["(\\d{3})(\\d{4})","$1 $2",["405|8|90"],"0$1"],["(\\d{2})(\\d{3})(\\d{3})","$1 $2 $3",["9"],"0$1"],["(\\d{4})(\\d{4})","$1 $2",["[124]"]],["(\\d{3})(\\d{3})(\\d{4})","$1 $2 $3",["4"],"0$1"],["(\\d{3})(\\d{3})(\\d{3})(\\d{4})","$1 $2 $3 $4",["0"]]],"0",0,0,0,0,0,0,"00"," int. "],UZ:["998","810","200\\d{6}|(?:33|[5-79]\\d|88)\\d{7}",[9],[["(\\d{2})(\\d{3})(\\d{2})(\\d{2})","$1 $2 $3 $4",["[235-9]"],"8 $1"]],"8",0,0,0,0,0,0,"8~10"],VA:["39","00","0\\d{5,10}|3[0-8]\\d{7,10}|55\\d{8}|8\\d{5}(?:\\d{2,4})?|(?:1\\d|39)\\d{7,8}",[6,7,8,9,10,11],0,0,0,0,0,0,"06698"],VC:["1","011","(?:[58]\\d\\d|784|900)\\d{7}",[10],0,"1",0,"([2-7]\\d{6})$|1","784$1",0,"784"],VE:["58","00","[68]00\\d{7}|(?:[24]\\d|[59]0)\\d{8}",[10],[["(\\d{3})(\\d{7})","$1-$2",["[24-689]"],"0$1"]],"0"],VG:["1","011","(?:284|[58]\\d\\d|900)\\d{7}",[10],0,"1",0,"([2-578]\\d{6})$|1","284$1",0,"284"],VI:["1","011","[58]\\d{9}|(?:34|90)0\\d{7}",[10],0,"1",0,"([2-9]\\d{6})$|1","340$1",0,"340"],VN:["84","00","[12]\\d{9}|[135-9]\\d{8}|[16]\\d{7}|[16-8]\\d{6}",[7,8,9,10],[["(\\d{2})(\\d{5})","$1 $2",["80"],"0$1",1],["(\\d{4})(\\d{4,6})","$1 $2",["1"],0,1],["(\\d{2})(\\d{3})(\\d{2})(\\d{2})","$1 $2 $3 $4",["6"],"0$1",1],["(\\d{3})(\\d{3})(\\d{3})","$1 $2 $3",["[357-9]"],"0$1",1],["(\\d{2})(\\d{4})(\\d{4})","$1 $2 $3",["2[48]"],"0$1",1],["(\\d{3})(\\d{4})(\\d{3})","$1 $2 $3",["2"],"0$1",1]],"0"],VU:["678","00","[57-9]\\d{6}|(?:[238]\\d|48)\\d{3}",[5,7],[["(\\d{3})(\\d{4})","$1 $2",["[57-9]"]]]],WF:["681","00","(?:40|72)\\d{4}|8\\d{5}(?:\\d{3})?",[6,9],[["(\\d{2})(\\d{2})(\\d{2})","$1 $2 $3",["[478]"]],["(\\d{3})(\\d{2})(\\d{2})(\\d{2})","$1 $2 $3 $4",["8"]]]],WS:["685","0","(?:[2-6]|8\\d{5})\\d{4}|[78]\\d{6}|[68]\\d{5}",[5,6,7,10],[["(\\d{5})","$1",["[2-5]|6[1-9]"]],["(\\d{3})(\\d{3,7})","$1 $2",["[68]"]],["(\\d{2})(\\d{5})","$1 $2",["7"]]]],XK:["383","00","[23]\\d{7,8}|(?:4\\d\\d|[89]00)\\d{5}",[8,9],[["(\\d{3})(\\d{5})","$1 $2",["[89]"],"0$1"],["(\\d{2})(\\d{3})(\\d{3})","$1 $2 $3",["[2-4]"],"0$1"],["(\\d{3})(\\d{3})(\\d{3})","$1 $2 $3",["[23]"],"0$1"]],"0"],YE:["967","00","(?:1|7\\d)\\d{7}|[1-7]\\d{6}",[7,8,9],[["(\\d)(\\d{3})(\\d{3,4})","$1 $2 $3",["[1-6]|7(?:[24-6]|8[0-7])"],"0$1"],["(\\d{3})(\\d{3})(\\d{3})","$1 $2 $3",["7"],"0$1"]],"0"],YT:["262","00","(?:80|9\\d)\\d{7}|(?:26|63)9\\d{6}",[9],0,"0",0,0,0,0,0,[["269(?:0[0-467]|5[0-4]|6\\d|[78]0)\\d{4}"],["639(?:0[0-79]|1[019]|[267]\\d|3[09]|40|5[05-9]|9[04-79])\\d{4}"],["80\\d{7}"],0,0,0,0,0,["9(?:(?:39|47)8[01]|769\\d)\\d{4}"]]],ZA:["27","00","[1-79]\\d{8}|8\\d{4,9}",[5,6,7,8,9,10],[["(\\d{2})(\\d{3,4})","$1 $2",["8[1-4]"],"0$1"],["(\\d{2})(\\d{3})(\\d{2,3})","$1 $2 $3",["8[1-4]"],"0$1"],["(\\d{3})(\\d{3})(\\d{3})","$1 $2 $3",["860"],"0$1"],["(\\d{2})(\\d{3})(\\d{4})","$1 $2 $3",["[1-9]"],"0$1"],["(\\d{3})(\\d{3})(\\d{4})","$1 $2 $3",["8"],"0$1"]],"0"],ZM:["260","00","800\\d{6}|(?:21|63|[79]\\d)\\d{7}",[9],[["(\\d{3})(\\d{3})(\\d{3})","$1 $2 $3",["[28]"],"0$1"],["(\\d{2})(\\d{7})","$1 $2",["[79]"],"0$1"]],"0"],ZW:["263","00","2(?:[0-57-9]\\d{6,8}|6[0-24-9]\\d{6,7})|[38]\\d{9}|[35-8]\\d{8}|[3-6]\\d{7}|[1-689]\\d{6}|[1-3569]\\d{5}|[1356]\\d{4}",[5,6,7,8,9,10],[["(\\d{3})(\\d{3,5})","$1 $2",["2(?:0[45]|2[278]|[49]8)|3(?:[09]8|17)|6(?:[29]8|37|75)|[23][78]|(?:33|5[15]|6[68])[78]"],"0$1"],["(\\d)(\\d{3})(\\d{2,4})","$1 $2 $3",["[49]"],"0$1"],["(\\d{3})(\\d{4})","$1 $2",["80"],"0$1"],["(\\d{2})(\\d{7})","$1 $2",["24|8[13-59]|(?:2[05-79]|39|5[45]|6[15-8])2","2(?:02[014]|4|[56]20|[79]2)|392|5(?:42|525)|6(?:[16-8]21|52[013])|8[13-59]"],"(0$1)"],["(\\d{2})(\\d{3})(\\d{4})","$1 $2 $3",["7"],"0$1"],["(\\d{3})(\\d{3})(\\d{3,4})","$1 $2 $3",["2(?:1[39]|2[0157]|[378]|[56][14])|3(?:12|29)","2(?:1[39]|2[0157]|[378]|[56][14])|3(?:123|29)"],"0$1"],["(\\d{4})(\\d{6})","$1 $2",["8"],"0$1"],["(\\d{2})(\\d{3,5})","$1 $2",["1|2(?:0[0-36-9]|12|29|[56])|3(?:1[0-689]|[24-6])|5(?:[0236-9]|1[2-4])|6(?:[013-59]|7[0-46-9])|(?:33|55|6[68])[0-69]|(?:29|3[09]|62)[0-79]"],"0$1"],["(\\d{2})(\\d{3})(\\d{3,4})","$1 $2 $3",["29[013-9]|39|54"],"0$1"],["(\\d{4})(\\d{3,5})","$1 $2",["(?:25|54)8","258|5483"],"0$1"]],"0"]},nonGeographic:{800:["800",0,"(?:00|[1-9]\\d)\\d{6}",[8],[["(\\d{4})(\\d{4})","$1 $2",["\\d"]]],0,0,0,0,0,0,[0,0,["(?:00|[1-9]\\d)\\d{6}"]]],808:["808",0,"[1-9]\\d{7}",[8],[["(\\d{4})(\\d{4})","$1 $2",["[1-9]"]]],0,0,0,0,0,0,[0,0,0,0,0,0,0,0,0,["[1-9]\\d{7}"]]],870:["870",0,"7\\d{11}|[35-7]\\d{8}",[9,12],[["(\\d{3})(\\d{3})(\\d{3})","$1 $2 $3",["[35-7]"]]],0,0,0,0,0,0,[0,["(?:[356]|774[45])\\d{8}|7[6-8]\\d{7}"]]],878:["878",0,"10\\d{10}",[12],[["(\\d{2})(\\d{5})(\\d{5})","$1 $2 $3",["1"]]],0,0,0,0,0,0,[0,0,0,0,0,0,0,0,["10\\d{10}"]]],881:["881",0,"[0-36-9]\\d{8}",[9],[["(\\d)(\\d{3})(\\d{5})","$1 $2 $3",["[0-36-9]"]]],0,0,0,0,0,0,[0,["[0-36-9]\\d{8}"]]],882:["882",0,"[13]\\d{6}(?:\\d{2,5})?|[19]\\d{7}|(?:[25]\\d\\d|4)\\d{7}(?:\\d{2})?",[7,8,9,10,11,12],[["(\\d{2})(\\d{5})","$1 $2",["16|342"]],["(\\d{2})(\\d{6})","$1 $2",["49"]],["(\\d{2})(\\d{2})(\\d{4})","$1 $2 $3",["1[36]|9"]],["(\\d{2})(\\d{4})(\\d{3})","$1 $2 $3",["3[23]"]],["(\\d{2})(\\d{3,4})(\\d{4})","$1 $2 $3",["16"]],["(\\d{2})(\\d{4})(\\d{4})","$1 $2 $3",["10|23|3(?:[15]|4[57])|4|51"]],["(\\d{3})(\\d{4})(\\d{4})","$1 $2 $3",["34"]],["(\\d{2})(\\d{4,5})(\\d{5})","$1 $2 $3",["[1-35]"]]],0,0,0,0,0,0,[0,["342\\d{4}|(?:337|49)\\d{6}|(?:3(?:2|47|7\\d{3})|50\\d{3})\\d{7}",[7,8,9,10,12]],0,0,0,0,0,0,["1(?:3(?:0[0347]|[13][0139]|2[035]|4[013568]|6[0459]|7[06]|8[15-8]|9[0689])\\d{4}|6\\d{5,10})|(?:345\\d|9[89])\\d{6}|(?:10|2(?:3|85\\d)|3(?:[15]|[69]\\d\\d)|4[15-8]|51)\\d{8}"]]],883:["883",0,"(?:[1-4]\\d|51)\\d{6,10}",[8,9,10,11,12],[["(\\d{3})(\\d{3})(\\d{2,8})","$1 $2 $3",["[14]|2[24-689]|3[02-689]|51[24-9]"]],["(\\d{3})(\\d{3})(\\d{3})","$1 $2 $3",["510"]],["(\\d{3})(\\d{3})(\\d{4})","$1 $2 $3",["21"]],["(\\d{4})(\\d{4})(\\d{4})","$1 $2 $3",["51[13]"]],["(\\d{3})(\\d{3})(\\d{3})(\\d{3})","$1 $2 $3 $4",["[235]"]]],0,0,0,0,0,0,[0,0,0,0,0,0,0,0,["(?:2(?:00\\d\\d|10)|(?:370[1-9]|51\\d0)\\d)\\d{7}|51(?:00\\d{5}|[24-9]0\\d{4,7})|(?:1[013-79]|2[24-689]|3[02-689]|4[0-4])0\\d{5,9}"]]],888:["888",0,"\\d{11}",[11],[["(\\d{3})(\\d{3})(\\d{5})","$1 $2 $3"]],0,0,0,0,0,0,[0,0,0,0,0,0,["\\d{11}"]]],979:["979",0,"[1359]\\d{8}",[9],[["(\\d)(\\d{4})(\\d{4})","$1 $2 $3",["[1359]"]]],0,0,0,0,0,0,[0,0,0,["[1359]\\d{8}"]]]}};function rS(e){return(rS="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function rC(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function rj(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var rT="0-9---",rE="".concat("--").concat("/").concat(".").concat(" ").concat("()\\[\\]").concat("~"),rR="+";function rI(e){return(rI="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function rA(e){if(void 0===e)throw ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function rP(e){var t="function"==typeof Map?new Map:void 0;return(rP=function(e){var n;if(null===e||(n=e,-1===Function.toString.call(n).indexOf("[native code]")))return e;if("function"!=typeof e)throw TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,r)}function r(){return rD(e,arguments,rM(this).constructor)}return r.prototype=Object.create(e.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),rN(r,e)})(e)}function rD(e,t,n){return(rD=rO()?Reflect.construct:function(e,t,n){var r=[null];r.push.apply(r,t);var i=new(Function.bind.apply(e,r));return n&&rN(i,n.prototype),i}).apply(null,arguments)}function rO(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}function rN(e,t){return(rN=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function rM(e){return(rM=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var rL=function(e){if("function"!=typeof e&&null!==e)throw TypeError("Super expression must either be null or a function");r.prototype=Object.create(e&&e.prototype,{constructor:{value:r,writable:!0,configurable:!0}}),Object.defineProperty(r,"prototype",{writable:!1}),e&&rN(r,e);var t,n=(t=rO(),function(){var e,n=rM(r);return e=t?Reflect.construct(n,arguments,rM(this).constructor):n.apply(this,arguments),function(e,t){if(t&&("object"===rI(t)||"function"==typeof t))return t;if(void 0!==t)throw TypeError("Derived constructors may only return object or undefined");return rA(e)}(this,e)});function r(e){var t;if(!(0,R._)(this,r))throw TypeError("Cannot call a class as a function");return Object.setPrototypeOf(rA(t=n.call(this,e)),r.prototype),t.name=t.constructor.name,t}return Object.defineProperty(r,"prototype",{writable:!1}),r}(rP(Error));function rB(e,t){e=e.split("-"),t=t.split("-");for(var n=e[0].split("."),r=t[0].split("."),i=0;i<3;i++){var o=Number(n[i]),a=Number(r[i]);if(o>a)return 1;if(a>o)return -1;if(!isNaN(o)&&isNaN(a))return 1;if(isNaN(o)&&!isNaN(a))return -1}return e[1]&&t[1]?e[1]>t[1]?1:e[1]<t[1]?-1:0:!e[1]&&t[1]?1:e[1]&&!t[1]?-1:0}function rV(e){return(rV="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function rF(e,t){if(!(0,R._)(e,t))throw TypeError("Cannot call a class as a function")}function rU(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function rG(e,t,n){return t&&rU(e.prototype,t),n&&rU(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}var r$=" ext. ",rz=/^\d+$/,rH=function(){function e(t){rF(this,e),function(e){if(!e)throw Error("[libphonenumber-js] `metadata` argument not passed. Check your arguments.");if(!rX(e)||!rX(e.countries))throw Error("[libphonenumber-js] `metadata` argument was passed but it's not a valid metadata. Must be an object having `.countries` child object property. Got ".concat(rX(e)?"an object of shape: { "+Object.keys(e).join(", ")+" }":"a "+rJ(e)+": "+e,"."))}(t),this.metadata=t,r1.call(this,t)}return rG(e,[{key:"getCountries",value:function(){return Object.keys(this.metadata.countries).filter(function(e){return"001"!==e})}},{key:"getCountryMetadata",value:function(e){return this.metadata.countries[e]}},{key:"nonGeographic",value:function(){if(!this.v1&&!this.v2&&!this.v3)return this.metadata.nonGeographic||this.metadata.nonGeographical}},{key:"hasCountry",value:function(e){return void 0!==this.getCountryMetadata(e)}},{key:"hasCallingCode",value:function(e){if(this.getCountryCodesForCallingCode(e))return!0;if(this.nonGeographic()){if(this.nonGeographic()[e])return!0}else{var t=this.countryCallingCodes()[e];if(t&&1===t.length&&"001"===t[0])return!0}}},{key:"isNonGeographicCallingCode",value:function(e){return this.nonGeographic()?!!this.nonGeographic()[e]:!this.getCountryCodesForCallingCode(e)}},{key:"country",value:function(e){return this.selectNumberingPlan(e)}},{key:"selectNumberingPlan",value:function(e,t){if(e&&rz.test(e)&&(t=e,e=null),e&&"001"!==e){if(!this.hasCountry(e))throw Error("Unknown country: ".concat(e));this.numberingPlan=new rW(this.getCountryMetadata(e),this)}else if(t){if(!this.hasCallingCode(t))throw Error("Unknown calling code: ".concat(t));this.numberingPlan=new rW(this.getNumberingPlanMetadata(t),this)}else this.numberingPlan=void 0;return this}},{key:"getCountryCodesForCallingCode",value:function(e){var t=this.countryCallingCodes()[e];if(t){if(1===t.length&&3===t[0].length)return;return t}}},{key:"getCountryCodeForCallingCode",value:function(e){var t=this.getCountryCodesForCallingCode(e);if(t)return t[0]}},{key:"getNumberingPlanMetadata",value:function(e){var t=this.getCountryCodeForCallingCode(e);if(t)return this.getCountryMetadata(t);if(this.nonGeographic()){var n=this.nonGeographic()[e];if(n)return n}else{var r=this.countryCallingCodes()[e];if(r&&1===r.length&&"001"===r[0])return this.metadata.countries["001"]}}},{key:"countryCallingCode",value:function(){return this.numberingPlan.callingCode()}},{key:"IDDPrefix",value:function(){return this.numberingPlan.IDDPrefix()}},{key:"defaultIDDPrefix",value:function(){return this.numberingPlan.defaultIDDPrefix()}},{key:"nationalNumberPattern",value:function(){return this.numberingPlan.nationalNumberPattern()}},{key:"possibleLengths",value:function(){return this.numberingPlan.possibleLengths()}},{key:"formats",value:function(){return this.numberingPlan.formats()}},{key:"nationalPrefixForParsing",value:function(){return this.numberingPlan.nationalPrefixForParsing()}},{key:"nationalPrefixTransformRule",value:function(){return this.numberingPlan.nationalPrefixTransformRule()}},{key:"leadingDigits",value:function(){return this.numberingPlan.leadingDigits()}},{key:"hasTypes",value:function(){return this.numberingPlan.hasTypes()}},{key:"type",value:function(e){return this.numberingPlan.type(e)}},{key:"ext",value:function(){return this.numberingPlan.ext()}},{key:"countryCallingCodes",value:function(){return this.v1?this.metadata.country_phone_code_to_countries:this.metadata.country_calling_codes}},{key:"chooseCountryByCountryCallingCode",value:function(e){return this.selectNumberingPlan(e)}},{key:"hasSelectedNumberingPlan",value:function(){return void 0!==this.numberingPlan}}]),e}(),rW=function(){function e(t,n){rF(this,e),this.globalMetadataObject=n,this.metadata=t,r1.call(this,n.metadata)}return rG(e,[{key:"callingCode",value:function(){return this.metadata[0]}},{key:"getDefaultCountryMetadataForRegion",value:function(){return this.globalMetadataObject.getNumberingPlanMetadata(this.callingCode())}},{key:"IDDPrefix",value:function(){if(!this.v1&&!this.v2)return this.metadata[1]}},{key:"defaultIDDPrefix",value:function(){if(!this.v1&&!this.v2)return this.metadata[12]}},{key:"nationalNumberPattern",value:function(){return this.v1||this.v2?this.metadata[1]:this.metadata[2]}},{key:"possibleLengths",value:function(){if(!this.v1)return this.metadata[this.v2?2:3]}},{key:"_getFormats",value:function(e){return e[this.v1?2:this.v2?3:4]}},{key:"formats",value:function(){var e=this;return(this._getFormats(this.metadata)||this._getFormats(this.getDefaultCountryMetadataForRegion())||[]).map(function(t){return new rq(t,e)})}},{key:"nationalPrefix",value:function(){return this.metadata[this.v1?3:this.v2?4:5]}},{key:"_getNationalPrefixFormattingRule",value:function(e){return e[this.v1?4:this.v2?5:6]}},{key:"nationalPrefixFormattingRule",value:function(){return this._getNationalPrefixFormattingRule(this.metadata)||this._getNationalPrefixFormattingRule(this.getDefaultCountryMetadataForRegion())}},{key:"_nationalPrefixForParsing",value:function(){return this.metadata[this.v1?5:this.v2?6:7]}},{key:"nationalPrefixForParsing",value:function(){return this._nationalPrefixForParsing()||this.nationalPrefix()}},{key:"nationalPrefixTransformRule",value:function(){return this.metadata[this.v1?6:this.v2?7:8]}},{key:"_getNationalPrefixIsOptionalWhenFormatting",value:function(){return!!this.metadata[this.v1?7:this.v2?8:9]}},{key:"nationalPrefixIsOptionalWhenFormattingInNationalFormat",value:function(){return this._getNationalPrefixIsOptionalWhenFormatting(this.metadata)||this._getNationalPrefixIsOptionalWhenFormatting(this.getDefaultCountryMetadataForRegion())}},{key:"leadingDigits",value:function(){return this.metadata[this.v1?8:this.v2?9:10]}},{key:"types",value:function(){return this.metadata[this.v1?9:this.v2?10:11]}},{key:"hasTypes",value:function(){return(!this.types()||0!==this.types().length)&&!!this.types()}},{key:"type",value:function(e){if(this.hasTypes()&&rQ(this.types(),e))return new rY(rQ(this.types(),e),this)}},{key:"ext",value:function(){return this.v1||this.v2?r$:this.metadata[13]||r$}}]),e}(),rq=function(){function e(t,n){rF(this,e),this._format=t,this.metadata=n}return rG(e,[{key:"pattern",value:function(){return this._format[0]}},{key:"format",value:function(){return this._format[1]}},{key:"leadingDigitsPatterns",value:function(){return this._format[2]||[]}},{key:"nationalPrefixFormattingRule",value:function(){return this._format[3]||this.metadata.nationalPrefixFormattingRule()}},{key:"nationalPrefixIsOptionalWhenFormattingInNationalFormat",value:function(){return!!this._format[4]||this.metadata.nationalPrefixIsOptionalWhenFormattingInNationalFormat()}},{key:"nationalPrefixIsMandatoryWhenFormattingInNationalFormat",value:function(){return this.usesNationalPrefix()&&!this.nationalPrefixIsOptionalWhenFormattingInNationalFormat()}},{key:"usesNationalPrefix",value:function(){return!(!this.nationalPrefixFormattingRule()||rK.test(this.nationalPrefixFormattingRule()))}},{key:"internationalFormat",value:function(){return this._format[5]||this.format()}}]),e}(),rK=/^\(?\$1\)?$/,rY=function(){function e(t,n){rF(this,e),this.type=t,this.metadata=n}return rG(e,[{key:"pattern",value:function(){return this.metadata.v1?this.type:this.type[0]}},{key:"possibleLengths",value:function(){if(!this.metadata.v1)return this.type[1]||this.metadata.possibleLengths()}}]),e}();function rQ(e,t){switch(t){case"FIXED_LINE":return e[0];case"MOBILE":return e[1];case"TOLL_FREE":return e[2];case"PREMIUM_RATE":return e[3];case"PERSONAL_NUMBER":return e[4];case"VOICEMAIL":return e[5];case"UAN":return e[6];case"PAGER":return e[7];case"VOIP":return e[8];case"SHARED_COST":return e[9]}}var rX=function(e){return"object"===rV(e)},rJ=function(e){return rV(e)};function rZ(e,t){if((t=new rH(t)).hasCountry(e))return t.country(e).countryCallingCode();throw Error("Unknown country: ".concat(e))}function r0(e,t){return t.countries.hasOwnProperty(e)}function r1(e){var t=e.version;"number"==typeof t?(this.v1=1===t,this.v2=2===t,this.v3=3===t,this.v4=4===t):t?-1===rB(t,"1.2.0")?this.v2=!0:-1===rB(t,"1.7.35")?this.v3=!0:this.v4=!0:this.v1=!0}var r2=function(e){return"([".concat(rT,"]{1,").concat(e,"})")};function r3(e){var t="[ \\t,]*",n="[:\\.]?[ \\t,-]*",r="[ \\t]*";return";ext="+r2("20")+"|"+(t+"(?:e?xt(?:ensi(?:o?|))?n?|??||anexo)"+n+r2("20"))+"#?|"+(t+"(?:[x#~]|int|)"+n+r2("9"))+"#?|"+("[- ]+"+r2("6"))+"#|"+(r+"(?:,{2}|;)"+n+r2("15"))+"#?|"+(r+"(?:,)+"+n+r2("9"))+"#?"}var r4="["+rR+"]{0,1}(?:["+rE+"]*["+rT+"]){3,}["+rE+rT+"]*",r8=RegExp("^["+rR+"]{0,1}(?:["+rE+"]*["+rT+"]){1,2}$","i"),r5=RegExp("^["+rT+"]{2}$|^"+(r4+"(?:"+r3())+")?$","i"),r6=RegExp("(?:"+r3()+")$","i");function r9(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var r7={0:"0",1:"1",2:"2",3:"3",4:"4",5:"5",6:"6",7:"7",8:"8",9:"9","":"0","":"1","":"2","":"3","":"4","":"5","":"6","":"7","":"8","":"9","":"0","":"1","":"2","":"3","":"4","":"5","":"6","":"7","":"8","":"9","":"0","":"1","":"2","":"3","":"4","":"5","":"6","":"7","":"8","":"9"};function ie(e){for(var t,n="",r=function(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(n)return(n=n.call(e)).next.bind(n);if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return r9(e,void 0);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return r9(e,void 0)}}(e))){n&&(e=n);var r=0;return function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}}}throw TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(e.split(""));!(t=r()).done;){var i=r7[t.value];i&&(n+=i)}return n}function it(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function ir(e){for(var t,n="",r=function(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(n)return(n=n.call(e)).next.bind(n);if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return it(e,void 0);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return it(e,void 0)}}(e))){n&&(e=n);var r=0;return function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}}}throw TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(e.split(""));!(t=r()).done;){var i=t.value;n+=ii(i,n)||""}return n}function ii(e,t){if("+"===e){if(t)return;return"+"}return r7[e]}function io(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function ia(e,t){return function e(t,n,r){var i=r.type(n),o=i&&i.possibleLengths()||r.possibleLengths();if(!o)return"IS_POSSIBLE";if("FIXED_LINE_OR_MOBILE"===n){if(!r.type("FIXED_LINE"))return e(t,"MOBILE",r);var a=r.type("MOBILE");a&&(o=function(e,t){for(var n,r=e.slice(),i=function(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(n)return(n=n.call(e)).next.bind(n);if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return io(e,void 0);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return io(e,void 0)}}(e))){n&&(e=n);var r=0;return function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}}}throw TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(t);!(n=i()).done;){var o=n.value;0>e.indexOf(o)&&r.push(o)}return r.sort(function(e,t){return e-t})}(o,a.possibleLengths()))}else if(n&&!i)return"INVALID_LENGTH";var s=t.length,l=o[0];return l===s?"IS_POSSIBLE":l>s?"TOO_SHORT":o[o.length-1]<s?"TOO_LONG":o.indexOf(s,1)>=0?"IS_POSSIBLE":"INVALID_LENGTH"}(e,void 0,t)}function is(e,t){return"IS_POSSIBLE"===ia(e,t)}function il(e,t){return e=e||"",RegExp("^(?:"+t+")$").test(e)}function iu(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var ic=["MOBILE","PREMIUM_RATE","TOLL_FREE","SHARED_COST","VOIP","PERSONAL_NUMBER","PAGER","UAN","VOICEMAIL"];function id(e,t,n){if(t=t||{},e.country){(n=new rH(n)).selectNumberingPlan(e.country,e.countryCallingCode);var r=t.v2?e.nationalNumber:e.phone;if(il(r,n.nationalNumberPattern())){if(ip(r,"FIXED_LINE",n))return n.type("MOBILE")&&""===n.type("MOBILE").pattern()||!n.type("MOBILE")||ip(r,"MOBILE",n)?"FIXED_LINE_OR_MOBILE":"FIXED_LINE";for(var i,o=function(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(n)return(n=n.call(e)).next.bind(n);if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return iu(e,void 0);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return iu(e,void 0)}}(e))){n&&(e=n);var r=0;return function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}}}throw TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(ic);!(i=o()).done;){var a=i.value;if(ip(r,a,n))return a}}}}function ip(e,t,n){return!(!(t=n.type(t))||!t.pattern()||t.possibleLengths()&&0>t.possibleLengths().indexOf(e.length))&&il(e,t.pattern())}function ih(e){return e.replace(RegExp("[".concat(rE,"]+"),"g")," ").trim()}var ig=/(\$\d)/;function im(e,t,n){var r=n.useInternationalFormat,i=n.withNationalPrefix;n.carrierCode,n.metadata;var o=e.replace(new RegExp(t.pattern()),r?t.internationalFormat():i&&t.nationalPrefixFormattingRule()?t.format().replace(ig,t.nationalPrefixFormattingRule()):t.format());return r?ih(o):o}var iv=/^[\d]+(?:[~\u2053\u223C\uFF5E][\d]+)?$/;function ix(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function iy(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function ib(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?iy(Object(n),!0).forEach(function(t){var r,i,o;r=e,i=t,o=n[t],i in r?Object.defineProperty(r,i,{value:o,enumerable:!0,configurable:!0,writable:!0}):r[i]=o}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):iy(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var iw={formatExtension:function(e,t,n){return"".concat(e).concat(n.ext()).concat(t)}};function ik(e,t,n,r,i){var o=function(e,t){for(var n,r=function(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(n)return(n=n.call(e)).next.bind(n);if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return ix(e,void 0);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return ix(e,void 0)}}(e))){n&&(e=n);var r=0;return function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}}}throw TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(e);!(n=r()).done;){var i=n.value;if(i.leadingDigitsPatterns().length>0){var o=i.leadingDigitsPatterns()[i.leadingDigitsPatterns().length-1];if(0!==t.search(o))continue}if(il(t,i.pattern()))return i}}(r.formats(),e);return o?im(e,o,{useInternationalFormat:"INTERNATIONAL"===n,withNationalPrefix:!o.nationalPrefixIsOptionalWhenFormattingInNationalFormat()||!i||!1!==i.nationalPrefix,carrierCode:t,metadata:r}):e}function i_(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function iS(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i_(Object(n),!0).forEach(function(t){var r,i,o;r=e,i=t,o=n[t],i in r?Object.defineProperty(r,i,{value:o,enumerable:!0,configurable:!0,writable:!0}):r[i]=o}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i_(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var iC=function(){var e;function t(e,n,r){if(!(0,R._)(this,t))throw TypeError("Cannot call a class as a function");if(!e)throw TypeError("`country` or `countryCallingCode` not passed");if(!n)throw TypeError("`nationalNumber` not passed");if(!r)throw TypeError("`metadata` not passed");var i=function(e,t){var n,r,i=new rH(t);return/^[A-Z]{2}$/.test(e)?(n=e,i.selectNumberingPlan(n),r=i.countryCallingCode()):r=e,{country:n,countryCallingCode:r}}(e,r),o=i.country,a=i.countryCallingCode;this.country=o,this.countryCallingCode=a,this.nationalNumber=n,this.number="+"+this.countryCallingCode+this.nationalNumber,this.getMetadata=function(){return r}}return e=[{key:"setExt",value:function(e){this.ext=e}},{key:"getPossibleCountries",value:function(){var e,t,n,r;return this.country?[this.country]:(e=this.countryCallingCode,t=this.nationalNumber,(r=new rH(n=this.getMetadata()).getCountryCodesForCallingCode(e))?r.filter(function(e){var r,i,o;return r=t,i=e,(o=new rH(n)).selectNumberingPlan(i),o.numberingPlan.possibleLengths().indexOf(r.length)>=0}):[])}},{key:"isPossible",value:function(){return function(e,t,n){if(void 0===t&&(t={}),n=new rH(n),t.v2){if(!e.countryCallingCode)throw Error("Invalid phone number object passed");n.selectNumberingPlan(e.countryCallingCode)}else{if(!e.phone)return!1;if(e.country){if(!n.hasCountry(e.country))throw Error("Unknown country: ".concat(e.country));n.country(e.country)}else{if(!e.countryCallingCode)throw Error("Invalid phone number object passed");n.selectNumberingPlan(e.countryCallingCode)}}if(n.possibleLengths())return is(e.phone||e.nationalNumber,n);if(e.countryCallingCode&&n.isNonGeographicCallingCode(e.countryCallingCode))return!0;throw Error('Missing "possibleLengths" in metadata. Perhaps the metadata has been generated before v1.0.18.')}(this,{v2:!0},this.getMetadata())}},{key:"isValid",value:function(){var e,t;return(e=e={v2:!0},(t=new rH(t=this.getMetadata())).selectNumberingPlan(this.country,this.countryCallingCode),t.hasTypes())?void 0!==id(this,e,t.metadata):il(e.v2?this.nationalNumber:this.phone,t.nationalNumberPattern())}},{key:"isNonGeographic",value:function(){return new rH(this.getMetadata()).isNonGeographicCallingCode(this.countryCallingCode)}},{key:"isEqual",value:function(e){return this.number===e.number&&this.ext===e.ext}},{key:"getType",value:function(){return id(this,{v2:!0},this.getMetadata())}},{key:"format",value:function(e,t){return function(e,t,n,r){if(n=n?ib(ib({},iw),n):iw,r=new rH(r),e.country&&"001"!==e.country){if(!r.hasCountry(e.country))throw Error("Unknown country: ".concat(e.country));r.country(e.country)}else{if(!e.countryCallingCode)return e.phone||"";r.selectNumberingPlan(e.countryCallingCode)}var i,o,a,s,l,u,c,d,f,p,h,g,m,x=r.countryCallingCode(),y=n.v2?e.nationalNumber:e.phone;switch(t){case"NATIONAL":if(!y)return"";return i=m=ik(y,e.carrierCode,"NATIONAL",r,n),o=e.ext,a=r,s=n.formatExtension,o?s(i,o,a):i;case"INTERNATIONAL":if(!y)return"+".concat(x);return m=ik(y,null,"INTERNATIONAL",r,n),l=m="+".concat(x," ").concat(m),u=e.ext,c=r,d=n.formatExtension,u?d(l,u,c):l;case"E.164":return"+".concat(x).concat(y);case"RFC3966":var b={number:"+".concat(x).concat(y),ext:e.ext},w=b.number,k=b.ext;if(!w)return"";if("+"!==w[0])throw Error('"formatRFC3966()" expects "number" to be in E.164 format.');return"tel:".concat(w).concat(k?";ext="+k:"");case"IDD":if(!n.fromCountry)return;return f=function(e,t,n,r,i){if(rZ(r,i.metadata)===n){var o,a,s=ik(e,t,"NATIONAL",i);return"1"===n?n+" "+s:s}var l=(o=void 0,((a=new rH(i.metadata)).selectNumberingPlan(r,o),a.defaultIDDPrefix())?a.defaultIDDPrefix():iv.test(a.IDDPrefix())?a.IDDPrefix():void 0);if(l)return"".concat(l," ").concat(n," ").concat(ik(e,null,"INTERNATIONAL",i))}(y,e.carrierCode,x,n.fromCountry,r),p=e.ext,h=r,g=n.formatExtension,p?g(f,p,h):f;default:throw Error('Unknown "format" argument passed to "formatNumber()": "'.concat(t,'"'))}}(this,e,t?iS(iS({},t),{},{v2:!0}):{v2:!0},this.getMetadata())}},{key:"formatNational",value:function(e){return this.format("NATIONAL",e)}},{key:"formatInternational",value:function(e){return this.format("INTERNATIONAL",e)}},{key:"getURI",value:function(e){return this.format("RFC3966",e)}}],function(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t}(),ij=RegExp("(["+rT+"])");function iT(e,t,n,r){if(t){var i=new rH(r);i.selectNumberingPlan(t,n);var o=new RegExp(i.IDDPrefix());if(0===e.search(o)){var a=(e=e.slice(e.match(o)[0].length)).match(ij);if(!a||null==a[1]||!(a[1].length>0)||"0"!==a[1])return e}}}function iE(e,t){if(e&&t.numberingPlan.nationalPrefixForParsing()){var n=RegExp("^(?:"+t.numberingPlan.nationalPrefixForParsing()+")"),r=n.exec(e);if(r){var i,o,a,s=r.length-1,l=s>0&&r[s];if(t.nationalPrefixTransformRule()&&l)i=e.replace(n,t.nationalPrefixTransformRule()),s>1&&(o=r[1]);else{var u=r[0];i=e.slice(u.length),l&&(o=r[1])}if(l){var c=e.indexOf(r[1]);e.slice(0,c)===t.numberingPlan.nationalPrefix()&&(a=t.numberingPlan.nationalPrefix())}else a=r[0];return{nationalNumber:i,nationalPrefix:a,carrierCode:o}}}return{nationalNumber:e}}function iR(e,t){var n,r,i,o=iE(e,t),a=o.carrierCode,s=o.nationalNumber;return s!==e&&(n=e,r=s,!(!il(n,(i=t).nationalNumberPattern())||il(r,i.nationalNumberPattern()))||t.possibleLengths()&&!function(e,t){switch(ia(e,t)){case"TOO_SHORT":case"INVALID_LENGTH":return!1;default:return!0}}(s,t))?{nationalNumber:e}:{nationalNumber:s,carrierCode:a}}function iI(e,t,n,r){var i=t?rZ(t,r):n;if(0===e.indexOf(i)){(r=new rH(r)).selectNumberingPlan(t,n);var o=e.slice(i.length),a=iR(o,r).nationalNumber,s=iR(e,r).nationalNumber;if(!il(s,r.nationalNumberPattern())&&il(a,r.nationalNumberPattern())||"TOO_LONG"===ia(s,r))return{countryCallingCode:i,number:o}}return{number:e}}function iA(e,t,n,r){if(!e)return{};if("+"!==e[0]){var i,o=iT(e,t,n,r);if(o&&o!==e)i=!0,e="+"+o;else{if(t||n){var a=iI(e,t,n,r),s=a.countryCallingCode,l=a.number;if(s)return{countryCallingCodeSource:"FROM_NUMBER_WITHOUT_PLUS_SIGN",countryCallingCode:s,number:l}}return{number:e}}}if("0"===e[1])return{};r=new rH(r);for(var u=2;u-1<=3&&u<=e.length;){var c=e.slice(1,u);if(r.hasCallingCode(c))return r.selectNumberingPlan(c),{countryCallingCodeSource:i?"FROM_NUMBER_WITH_IDD":"FROM_NUMBER_WITH_PLUS_SIGN",countryCallingCode:c,number:e.slice(u)};u++}return{}}function iP(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function iD(e,t){var n=t.countries,r=t.defaultCountry,i=t.metadata;i=new rH(i);for(var o,a=[],s=function(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(n)return(n=n.call(e)).next.bind(n);if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return iP(e,void 0);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return iP(e,void 0)}}(e))){n&&(e=n);var r=0;return function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}}}throw TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(n);!(o=s()).done;){var l=o.value;if(i.country(l),i.leadingDigits()){if(e&&0===e.search(i.leadingDigits()))return l}else if(id({phone:e,country:l},void 0,i.metadata))if(!r)return l;else{if(l===r)return l;a.push(l)}}if(a.length>0)return a[0]}function iO(e,t){var n=t.nationalNumber,r=t.defaultCountry,i=t.metadata,o=i.getCountryCodesForCallingCode(e);if(o)return 1===o.length?o[0]:iD(n,{countries:o,defaultCountry:r,metadata:i.metadata})}var iN="(["+rT+"]|[\\-\\.\\(\\)]?)",iM=RegExp("^\\+"+iN+"*["+rT+"]"+iN+"*$","g"),iL=RegExp("^("+("["+rT+"]+((\\-)*[")+rT+"])*\\.)*[a-zA-Z]+((\\-)*["+rT+"])*\\.?$","g"),iB="tel:",iV=";phone-context=",iF=RegExp("["+rR+rT+"]"),iU=RegExp("[^"+rT+"#]+$");function iG(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function i$(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?iG(Object(n),!0).forEach(function(t){var r,i,o;r=e,i=t,o=n[t],i in r?Object.defineProperty(r,i,{value:o,enumerable:!0,configurable:!0,writable:!0}):r[i]=o}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):iG(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function iz(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function iH(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?iz(Object(n),!0).forEach(function(t){var r,i,o;r=e,i=t,o=n[t],i in r?Object.defineProperty(r,i,{value:o,enumerable:!0,configurable:!0,writable:!0}):r[i]=o}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):iz(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function iW(e){return new rH(e).getCountries()}let iq={ext:"ext.",country:"Phone number country",phone:"Phone",AB:"Abkhazia",AC:"Ascension Island",AD:"Andorra",AE:"United Arab Emirates",AF:"Afghanistan",AG:"Antigua and Barbuda",AI:"Anguilla",AL:"Albania",AM:"Armenia",AO:"Angola",AQ:"Antarctica",AR:"Argentina",AS:"American Samoa",AT:"Austria",AU:"Australia",AW:"Aruba",AX:"land Islands",AZ:"Azerbaijan",BA:"Bosnia and Herzegovina",BB:"Barbados",BD:"Bangladesh",BE:"Belgium",BF:"Burkina Faso",BG:"Bulgaria",BH:"Bahrain",BI:"Burundi",BJ:"Benin",BL:"Saint Barthlemy",BM:"Bermuda",BN:"Brunei Darussalam",BO:"Bolivia",BQ:"Bonaire, Sint Eustatius and Saba",BR:"Brazil",BS:"Bahamas",BT:"Bhutan",BV:"Bouvet Island",BW:"Botswana",BY:"Belarus",BZ:"Belize",CA:"Canada",CC:"Cocos (Keeling) Islands",CD:"Congo, Democratic Republic of the",CF:"Central African Republic",CG:"Congo",CH:"Switzerland",CI:"Cote d'Ivoire",CK:"Cook Islands",CL:"Chile",CM:"Cameroon",CN:"China",CO:"Colombia",CR:"Costa Rica",CU:"Cuba",CV:"Cape Verde",CW:"Curaao",CX:"Christmas Island",CY:"Cyprus",CZ:"Czech Republic",DE:"Germany",DJ:"Djibouti",DK:"Denmark",DM:"Dominica",DO:"Dominican Republic",DZ:"Algeria",EC:"Ecuador",EE:"Estonia",EG:"Egypt",EH:"Western Sahara",ER:"Eritrea",ES:"Spain",ET:"Ethiopia",FI:"Finland",FJ:"Fiji",FK:"Falkland Islands",FM:"Federated States of Micronesia",FO:"Faroe Islands",FR:"France",GA:"Gabon",GB:"United Kingdom",GD:"Grenada",GE:"Georgia",GF:"French Guiana",GG:"Guernsey",GH:"Ghana",GI:"Gibraltar",GL:"Greenland",GM:"Gambia",GN:"Guinea",GP:"Guadeloupe",GQ:"Equatorial Guinea",GR:"Greece",GS:"South Georgia and the South Sandwich Islands",GT:"Guatemala",GU:"Guam",GW:"Guinea-Bissau",GY:"Guyana",HK:"Hong Kong",HM:"Heard Island and McDonald Islands",HN:"Honduras",HR:"Croatia",HT:"Haiti",HU:"Hungary",ID:"Indonesia",IE:"Ireland",IL:"Israel",IM:"Isle of Man",IN:"India",IO:"British Indian Ocean Territory",IQ:"Iraq",IR:"Iran",IS:"Iceland",IT:"Italy",JE:"Jersey",JM:"Jamaica",JO:"Jordan",JP:"Japan",KE:"Kenya",KG:"Kyrgyzstan",KH:"Cambodia",KI:"Kiribati",KM:"Comoros",KN:"Saint Kitts and Nevis",KP:"North Korea",KR:"South Korea",KW:"Kuwait",KY:"Cayman Islands",KZ:"Kazakhstan",LA:"Laos",LB:"Lebanon",LC:"Saint Lucia",LI:"Liechtenstein",LK:"Sri Lanka",LR:"Liberia",LS:"Lesotho",LT:"Lithuania",LU:"Luxembourg",LV:"Latvia",LY:"Libya",MA:"Morocco",MC:"Monaco",MD:"Moldova",ME:"Montenegro",MF:"Saint Martin (French Part)",MG:"Madagascar",MH:"Marshall Islands",MK:"North Macedonia",ML:"Mali",MM:"Myanmar",MN:"Mongolia",MO:"Macao",MP:"Northern Mariana Islands",MQ:"Martinique",MR:"Mauritania",MS:"Montserrat",MT:"Malta",MU:"Mauritius",MV:"Maldives",MW:"Malawi",MX:"Mexico",MY:"Malaysia",MZ:"Mozambique",NA:"Namibia",NC:"New Caledonia",NE:"Niger",NF:"Norfolk Island",NG:"Nigeria",NI:"Nicaragua",NL:"Netherlands",NO:"Norway",NP:"Nepal",NR:"Nauru",NU:"Niue",NZ:"New Zealand",OM:"Oman",OS:"South Ossetia",PA:"Panama",PE:"Peru",PF:"French Polynesia",PG:"Papua New Guinea",PH:"Philippines",PK:"Pakistan",PL:"Poland",PM:"Saint Pierre and Miquelon",PN:"Pitcairn",PR:"Puerto Rico",PS:"Palestine",PT:"Portugal",PW:"Palau",PY:"Paraguay",QA:"Qatar",RE:"Reunion",RO:"Romania",RS:"Serbia",RU:"Russia",RW:"Rwanda",SA:"Saudi Arabia",SB:"Solomon Islands",SC:"Seychelles",SD:"Sudan",SE:"Sweden",SG:"Singapore",SH:"Saint Helena",SI:"Slovenia",SJ:"Svalbard and Jan Mayen",SK:"Slovakia",SL:"Sierra Leone",SM:"San Marino",SN:"Senegal",SO:"Somalia",SR:"Suriname",SS:"South Sudan",ST:"Sao Tome and Principe",SV:"El Salvador",SX:"Sint Maarten",SY:"Syria",SZ:"Swaziland",TA:"Tristan da Cunha",TC:"Turks and Caicos Islands",TD:"Chad",TF:"French Southern Territories",TG:"Togo",TH:"Thailand",TJ:"Tajikistan",TK:"Tokelau",TL:"Timor-Leste",TM:"Turkmenistan",TN:"Tunisia",TO:"Tonga",TR:"Turkey",TT:"Trinidad and Tobago",TV:"Tuvalu",TW:"Taiwan",TZ:"Tanzania",UA:"Ukraine",UG:"Uganda",UM:"United States Minor Outlying Islands",US:"United States",UY:"Uruguay",UZ:"Uzbekistan",VA:"Holy See (Vatican City State)",VC:"Saint Vincent and the Grenadines",VE:"Venezuela",VG:"Virgin Islands, British",VI:"Virgin Islands, U.S.",VN:"Vietnam",VU:"Vanuatu",WF:"Wallis and Futuna",WS:"Samoa",XK:"Kosovo",YE:"Yemen",YT:"Mayotte",ZA:"South Africa",ZM:"Zambia",ZW:"Zimbabwe",ZZ:"International"};var iK=e.i(203537),iY=iK.default.shape({country_calling_codes:iK.default.object.isRequired,countries:iK.default.object.isRequired}),iQ=iK.default.objectOf(iK.default.string),iX=e.i(189891);function iJ(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function iZ(e,t){for(var n,r=0,i=function(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(n)return(n=n.call(e)).next.bind(n);if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return iJ(e,void 0);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return iJ(e,void 0)}}(e))){n&&(e=n);var r=0;return function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}}}throw TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(t.split(""));!(n=i()).done;)n.value===e&&r++;return r}function i0(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function i1(e,t){void 0!==t&&(function(){if("undefined"!=typeof navigator)return i2.test(navigator.userAgent)}()?setTimeout(function(){return e.setSelectionRange(t,t)},0):e.setSelectionRange(t,t))}var i2=/Android/i;function i3(e,t,n,r,i){var o=function(e,t,n){for(var r="",i=0,o=0;o<e.length;){var a=n(e[o],r);void 0!==a&&(r+=a,void 0!==t&&(t===o?i=r.length-1:t>o&&(i=r.length))),o++}return void 0===t&&(i=r.length),{value:r,caret:i}}(e.value,e.selectionStart,t),a=o.value,s=o.caret;if(r){var l=function(e,t,n){switch(n){case"Backspace":t>0&&(e=e.slice(0,t-1)+e.slice(t),t--);break;case"Delete":e=e.slice(0,t)+e.slice(t+1)}return{value:e,caret:t}}(a,s,r);a=l.value,s=l.caret}var u=function(e,t,n){"string"==typeof n&&(n=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"x",n=arguments.length>2?arguments[2]:void 0;if(!e)return function(e){return{text:e}};var r=iZ(t,e);return function(i){if(!i)return{text:"",template:e};for(var o,a=0,s="",l=function(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(n)return(n=n.call(e)).next.bind(n);if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return i0(e,void 0);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return i0(e,void 0)}}(e))){n&&(e=n);var r=0;return function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}}}throw TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(e.split(""));!(o=l()).done;){var u=o.value;if(u!==t){s+=u;continue}if(s+=i[a],++a===i.length&&i.length<r)break}return n&&(s=function(e,t){for(var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"x",r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:" ",i=e.length,o=iZ("(",e)-iZ(")",e);o>0&&i<t.length;)e+=t[i].replace(n,r),")"===t[i]&&o--,i++;return e}(s,e)),{text:s,template:e}}}(n));var r=n(e)||{},i=r.text,o=r.template;if(void 0===i&&(i=e),o)if(void 0===t)t=i.length;else{for(var a=0,s=!1,l=-1;a<i.length&&a<o.length;){if(i[a]!==o[a]){if(0===t){s=!0,t=a;break}l=a,t--}a++}s||(t=l+1)}return{text:i,caret:t}}(a,s,n),c=u.text;s=u.caret,e.value=c,i1(e,s),i(a)}var i4=["value","parse","format","inputComponent","onChange","onKeyDown"];function i8(){return(i8=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function i5(e,t){var n=e.value,r=e.parse,i=e.format,o=e.inputComponent,a=e.onChange,s=e.onKeyDown,l=function(e,t){if(null==e)return{};var n,r,i=function(e,t){if(null==e)return{};var n,r,i={},o=Object.keys(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}(e,i4),u=(0,c.useRef)(),d=(0,c.useCallback)(function(e){u.current=e,t&&("function"==typeof t?t(e):t.current=e)},[t]),f=(0,c.useCallback)(function(e){i3(u.current,r,i,void 0,a)},[u,r,i,a]),p=(0,c.useCallback)(function(e){s&&s(e);var t=u.current;if(!t.hasAttribute("readonly")){var n=function(e){switch(e.keyCode){case 8:return"Backspace";case 46:return"Delete"}}(e);switch(n){case"Delete":case"Backspace":e.preventDefault();var o,l,c,d=function(e){if(e.selectionStart!==e.selectionEnd)return{start:e.selectionStart,end:e.selectionEnd}}(t);if(d){return o=t,l=d,c=o.value,o.value=c=c.slice(0,l.start)+c.slice(l.end),i1(o,l.start),i3(t,r,i,void 0,a)}return i3(t,r,i,n,a)}}},[u,r,i,a,s]);return c.default.createElement(o,i8({},l,{ref:d,value:i(null==n?"":n).text,onKeyDown:p,onChange:f}))}(i5=c.default.forwardRef(i5)).propTypes={parse:iK.default.func.isRequired,format:iK.default.func.isRequired,inputComponent:iK.default.elementType.isRequired,type:iK.default.string.isRequired,value:iK.default.string,onChange:iK.default.func.isRequired,onKeyDown:iK.default.func,onCut:iK.default.func,onPaste:iK.default.func},i5.defaultProps={inputComponent:"input",type:"text"};let i6=i5;var i9=function(){var e;function t(e){var n=e.onCountryChange,r=e.onCallingCodeChange;if(!(0,R._)(this,t))throw TypeError("Cannot call a class as a function");this.onCountryChange=n,this.onCallingCodeChange=r}return e=[{key:"reset",value:function(e){var t=e.country,n=e.callingCode;this.international=!1,this.missingPlus=!1,this.IDDPrefix=void 0,this.callingCode=void 0,this.digits="",this.resetNationalSignificantNumber(),this.initCountryAndCallingCode(t,n)}},{key:"resetNationalSignificantNumber",value:function(){this.nationalSignificantNumber=this.getNationalDigits(),this.nationalSignificantNumberMatchesInput=!0,this.nationalPrefix=void 0,this.carrierCode=void 0,this.complexPrefixBeforeNationalSignificantNumber=void 0}},{key:"update",value:function(e){for(var t=0,n=Object.keys(e);t<n.length;t++){var r=n[t];this[r]=e[r]}}},{key:"initCountryAndCallingCode",value:function(e,t){this.setCountry(e),this.setCallingCode(t)}},{key:"setCountry",value:function(e){this.country=e,this.onCountryChange(e)}},{key:"setCallingCode",value:function(e){this.callingCode=e,this.onCallingCodeChange(e,this.country)}},{key:"startInternationalNumber",value:function(e,t){this.international=!0,this.initCountryAndCallingCode(e,t)}},{key:"appendDigits",value:function(e){this.digits+=e}},{key:"appendNationalSignificantNumberDigits",value:function(e){this.nationalSignificantNumber+=e}},{key:"getNationalDigits",value:function(){return this.international?this.digits.slice((this.IDDPrefix?this.IDDPrefix.length:0)+(this.callingCode?this.callingCode.length:0)):this.digits}},{key:"getDigitsWithoutInternationalPrefix",value:function(){return this.international&&this.IDDPrefix?this.digits.slice(this.IDDPrefix.length):this.digits}}],function(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t}();function i7(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var oe=/x/;function ot(e,t){if(t<1)return"";for(var n="";t>1;)1&t&&(n+=e),t>>=1,e+=e;return n+e}function on(e,t){return")"===e[t]&&t++,function(e){for(var t=[],n=0;n<e.length;)"("===e[n]?t.push(n):")"===e[n]&&t.pop(),n++;var r=0,i="";t.push(e.length);for(var o=0;o<t.length;o++){var a=t[o];i+=e.slice(r,a),r=a+1}return i}(e.slice(0,t))}function or(e,t,n){var r,i,o=n.metadata,a=n.useNationalPrefixFormattingRule,s=n.getSeparatorAfterNationalPrefix,l=im(e.nationalSignificantNumber,t,{carrierCode:e.carrierCode,useInternationalFormat:e.international,withNationalPrefix:a,metadata:o});if(!a&&(e.nationalPrefix?l=e.nationalPrefix+s(t)+l:e.complexPrefixBeforeNationalSignificantNumber&&(l=e.complexPrefixBeforeNationalSignificantNumber+" "+l)),r=l,i=e,ie(r)===i.getNationalDigits())return l}var oi=function(){var e;function t(){if(!(0,R._)(this,t))throw TypeError("Cannot call a class as a function")}return e=[{key:"parse",value:function(e){if(this.context=[{or:!0,instructions:[]}],this.parsePattern(e),1!==this.context.length)throw Error("Non-finalized contexts left when pattern parse ended");var t=this.context[0],n=t.branches,r=t.instructions;if(n)return{op:"|",args:n.concat([os(r)])};if(0===r.length)throw Error("Pattern is required");return 1===r.length?r[0]:r}},{key:"startContext",value:function(e){this.context.push(e)}},{key:"endContext",value:function(){this.context.pop()}},{key:"getContext",value:function(){return this.context[this.context.length-1]}},{key:"parsePattern",value:function(e){if(!e)throw Error("Pattern is required");var t=e.match(oa);if(!t){if(oo.test(e))throw Error("Illegal characters found in a pattern: ".concat(e));this.getContext().instructions=this.getContext().instructions.concat(e.split(""));return}var n=t[1],r=e.slice(0,t.index),i=e.slice(t.index+n.length);switch(n){case"(?:":r&&this.parsePattern(r),this.startContext({or:!0,instructions:[],branches:[]});break;case")":if(!this.getContext().or)throw Error('")" operator must be preceded by "(?:" operator');if(r&&this.parsePattern(r),0===this.getContext().instructions.length)throw Error('No instructions found after "|" operator in an "or" group');var o=this.getContext().branches;o.push(os(this.getContext().instructions)),this.endContext(),this.getContext().instructions.push({op:"|",args:o});break;case"|":if(!this.getContext().or)throw Error('"|" operator can only be used inside "or" groups');if(r&&this.parsePattern(r),!this.getContext().branches)if(1===this.context.length)this.getContext().branches=[];else throw Error('"branches" not found in an "or" group context');this.getContext().branches.push(os(this.getContext().instructions)),this.getContext().instructions=[];break;case"[":r&&this.parsePattern(r),this.startContext({oneOfSet:!0});break;case"]":if(!this.getContext().oneOfSet)throw Error('"]" operator must be preceded by "[" operator');this.endContext(),this.getContext().instructions.push({op:"[]",args:function(e){for(var t=[],n=0;n<e.length;){if("-"===e[n]){if(0===n||n===e.length-1)throw Error("Couldn't parse a one-of set pattern: ".concat(e));for(var r=e[n-1].charCodeAt(0)+1,i=e[n+1].charCodeAt(0)-1,o=r;o<=i;)t.push(String.fromCharCode(o)),o++}else t.push(e[n]);n++}return t}(r)});break;default:throw Error("Unknown operator: ".concat(n))}i&&this.parsePattern(i)}}],function(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t}(),oo=/[\(\)\[\]\?\:\|]/,oa=RegExp("(\\||\\(\\?\\:|\\)|\\[|\\])");function os(e){return 1===e.length?e[0]:e}function ol(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(n)return(n=n.call(e)).next.bind(n);if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return ou(e,void 0);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return ou(e,void 0)}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0;return function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}}}throw TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function ou(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var oc=function(){var e;function t(e){if(!(0,R._)(this,t))throw TypeError("Cannot call a class as a function");this.matchTree=new oi().parse(e)}return e=[{key:"match",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.allowOverflow;if(!e)throw Error("String is required");var r=function e(t,n,r){if("string"==typeof n){var i=t.join("");return 0===n.indexOf(i)?t.length===n.length?{match:!0,matchedChars:t}:{partialMatch:!0}:0===i.indexOf(n)?r&&t.length>n.length?{overflow:!0}:{match:!0,matchedChars:t.slice(0,n.length)}:void 0}if(Array.isArray(n)){for(var o=t.slice(),a=0;a<n.length;){var s=e(o,n[a],r&&a===n.length-1);if(!s)return;if(s.overflow)return s;if(s.match){if(0===(o=o.slice(s.matchedChars.length)).length)if(a===n.length-1)return{match:!0,matchedChars:t};else return{partialMatch:!0}}else if(s.partialMatch)return{partialMatch:!0};else throw Error("Unsupported match result:\n".concat(JSON.stringify(s,null,2)));a++}return r?{overflow:!0}:{match:!0,matchedChars:t.slice(0,t.length-o.length)}}switch(n.op){case"|":for(var l,u,c=ol(n.args);!(u=c()).done;){var d=e(t,u.value,r);if(d)if(d.overflow)return d;else if(d.match)return{match:!0,matchedChars:d.matchedChars};else if(d.partialMatch)l=!0;else throw Error("Unsupported match result:\n".concat(JSON.stringify(d,null,2)))}if(l)return{partialMatch:!0};return;case"[]":for(var f,p=ol(n.args);!(f=p()).done;){var h=f.value;if(t[0]===h){if(1===t.length)return{match:!0,matchedChars:t};if(r)return{overflow:!0};return{match:!0,matchedChars:[h]}}}return;default:throw Error("Unsupported instruction tree: ".concat(n))}}(e.split(""),this.matchTree,!0);if(r&&r.match&&delete r.matchedChars,!r||!r.overflow||n)return r}}],function(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t}();function od(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(n)return(n=n.call(e)).next.bind(n);if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return of(e,void 0);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return of(e,void 0)}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0;return function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}}}throw TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function of(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var op=ot("9",15),oh=/[- ]/,og=RegExp("["+rE+"]*\\$1["+rE+"]*(\\$\\d["+rE+"]*)*$"),om=function(){var e;function t(e){e.state;var n=e.metadata;if(!(0,R._)(this,t))throw TypeError("Cannot call a class as a function");this.metadata=n,this.resetFormat()}return e=[{key:"resetFormat",value:function(){this.chosenFormat=void 0,this.template=void 0,this.nationalNumberTemplate=void 0,this.populatedNationalNumberTemplate=void 0,this.populatedNationalNumberTemplatePosition=-1}},{key:"reset",value:function(e,t){this.resetFormat(),e?(this.isNANP="1"===e.callingCode(),this.matchingFormats=e.formats(),t.nationalSignificantNumber&&this.narrowDownMatchingFormats(t)):(this.isNANP=void 0,this.matchingFormats=[])}},{key:"format",value:function(e,t){var n=this;if("IS_POSSIBLE"===ia(t.nationalSignificantNumber,this.metadata))for(var r,i=od(this.matchingFormats);!(r=i()).done;){var o=r.value,a=function(e,t,n){var r=n.metadata,i=n.shouldTryNationalPrefixFormattingRule,o=n.getSeparatorAfterNationalPrefix;if(new RegExp("^(?:".concat(t.pattern(),")$")).test(e.nationalSignificantNumber))return function(e,t,n){var r=n.metadata,i=n.shouldTryNationalPrefixFormattingRule,o=n.getSeparatorAfterNationalPrefix;if(e.nationalSignificantNumber,e.international,e.nationalPrefix,e.carrierCode,i(t)){var a=or(e,t,{useNationalPrefixFormattingRule:!0,getSeparatorAfterNationalPrefix:o,metadata:r});if(a)return a}return or(e,t,{useNationalPrefixFormattingRule:!1,getSeparatorAfterNationalPrefix:o,metadata:r})}(e,t,{metadata:r,shouldTryNationalPrefixFormattingRule:i,getSeparatorAfterNationalPrefix:o})}(t,o,{metadata:this.metadata,shouldTryNationalPrefixFormattingRule:function(e){return n.shouldTryNationalPrefixFormattingRule(e,{international:t.international,nationalPrefix:t.nationalPrefix})},getSeparatorAfterNationalPrefix:function(e){return n.getSeparatorAfterNationalPrefix(e)}});if(a)return this.resetFormat(),this.chosenFormat=o,this.setNationalNumberTemplate(a.replace(/\d/g,"x"),t),this.populatedNationalNumberTemplate=a,this.populatedNationalNumberTemplatePosition=this.template.lastIndexOf("x"),a}return this.formatNationalNumberWithNextDigits(e,t)}},{key:"formatNationalNumberWithNextDigits",value:function(e,t){var n=this.chosenFormat,r=this.chooseFormat(t);if(r)if(r===n)return this.formatNextNationalNumberDigits(e);else return this.formatNextNationalNumberDigits(t.getNationalDigits())}},{key:"narrowDownMatchingFormats",value:function(e){var t=this,n=e.nationalSignificantNumber,r=e.nationalPrefix,i=e.international,o=n.length-3;o<0&&(o=0),this.matchingFormats=this.matchingFormats.filter(function(e){return t.formatSuits(e,i,r)&&t.formatMatches(e,n,o)}),this.chosenFormat&&-1===this.matchingFormats.indexOf(this.chosenFormat)&&this.resetFormat()}},{key:"formatSuits",value:function(e,t,n){return!(n&&!e.usesNationalPrefix()&&!e.nationalPrefixIsOptionalWhenFormattingInNationalFormat()||!t&&!n&&e.nationalPrefixIsMandatoryWhenFormattingInNationalFormat())}},{key:"formatMatches",value:function(e,t,n){var r=e.leadingDigitsPatterns().length;if(0===r)return!0;n=Math.min(n,r-1);var i=e.leadingDigitsPatterns()[n];if(t.length<3)try{return void 0!==new oc(i).match(t,{allowOverflow:!0})}catch(e){return console.error(e),!0}return new RegExp("^(".concat(i,")")).test(t)}},{key:"getFormatFormat",value:function(e,t){return t?e.internationalFormat():e.format()}},{key:"chooseFormat",value:function(e){for(var t,n=this,r=od(this.matchingFormats.slice());!(t=r()).done;){var i=function(){var r=t.value;return n.chosenFormat===r?"break":og.test(n.getFormatFormat(r,e.international))?n.createTemplateForFormat(r,e)?(n.chosenFormat=r,"break"):(n.matchingFormats=n.matchingFormats.filter(function(e){return e!==r}),"continue"):"continue"}();if("break"===i)break;if("continue"===i)continue}return this.chosenFormat||this.resetFormat(),this.chosenFormat}},{key:"createTemplateForFormat",value:function(e,t){if(!(e.pattern().indexOf("|")>=0)){var n=this.getTemplateForFormat(e,t);if(n)return this.setNationalNumberTemplate(n,t),!0}}},{key:"getSeparatorAfterNationalPrefix",value:function(e){return this.isNANP||e&&e.nationalPrefixFormattingRule()&&oh.test(e.nationalPrefixFormattingRule())?" ":""}},{key:"getInternationalPrefixBeforeCountryCallingCode",value:function(e,t){var n=e.IDDPrefix,r=e.missingPlus;return n?t&&!1===t.spacing?n:n+" ":r?"":"+"}},{key:"getTemplate",value:function(e){if(this.template){for(var t=-1,n=0,r=e.international?this.getInternationalPrefixBeforeCountryCallingCode(e,{spacing:!1}):"";n<r.length+e.getDigitsWithoutInternationalPrefix().length;)t=this.template.indexOf("x",t+1),n++;return on(this.template,t+1)}}},{key:"setNationalNumberTemplate",value:function(e,t){this.nationalNumberTemplate=e,this.populatedNationalNumberTemplate=e,this.populatedNationalNumberTemplatePosition=-1,t.international?this.template=this.getInternationalPrefixBeforeCountryCallingCode(t).replace(/[\d\+]/g,"x")+ot("x",t.callingCode.length)+" "+e:this.template=e}},{key:"getTemplateForFormat",value:function(e,t){var n,r=t.nationalSignificantNumber,i=t.international,o=t.nationalPrefix,a=t.complexPrefixBeforeNationalSignificantNumber,s=e.pattern();s=s.replace(/\[([^\[\]])*\]/g,"\\d").replace(/\d(?=[^,}][^,}])/g,"\\d");var l=op.match(s)[0];if(!(r.length>l.length)){var u=RegExp("^"+s+"$"),c=r.replace(/\d/g,"9");u.test(c)&&(l=c);var d=this.getFormatFormat(e,i);if(this.shouldTryNationalPrefixFormattingRule(e,{international:i,nationalPrefix:o})){var f=d.replace(ig,e.nationalPrefixFormattingRule());if(ie(e.nationalPrefixFormattingRule())===(o||"")+ie("$1")&&(d=f,n=!0,o))for(var p=o.length;p>0;)d=d.replace(/\d/,"x"),p--}var h=l.replace(new RegExp(s),d).replace(/9/g,"x");return!n&&(a?h=ot("x",a.length)+" "+h:o&&(h=ot("x",o.length)+this.getSeparatorAfterNationalPrefix(e)+h)),i&&(h=ih(h)),h}}},{key:"formatNextNationalNumberDigits",value:function(e){var t=function(e,t,n){for(var r,i=function(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(n)return(n=n.call(e)).next.bind(n);if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return i7(e,void 0);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return i7(e,void 0)}}(e))){n&&(e=n);var r=0;return function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}}}throw TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(n.split(""));!(r=i()).done;){var o=r.value;if(0>e.slice(t+1).search(oe))return;t=e.search(oe),e=e.replace(oe,o)}return[e,t]}(this.populatedNationalNumberTemplate,this.populatedNationalNumberTemplatePosition,e);return t?(this.populatedNationalNumberTemplate=t[0],this.populatedNationalNumberTemplatePosition=t[1],on(this.populatedNationalNumberTemplate,this.populatedNationalNumberTemplatePosition+1)):void this.resetFormat()}},{key:"shouldTryNationalPrefixFormattingRule",value:function(e,t){var n=t.international,r=t.nationalPrefix;if(e.nationalPrefixFormattingRule()){var i=e.usesNationalPrefix();if(i&&r||!i&&!n)return!0}}}],function(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t}();function ov(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n,r,i=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=i){var o=[],a=!0,s=!1;try{for(i=i.call(e);!(a=(n=i.next()).done)&&(o.push(n.value),!t||o.length!==t);a=!0);}catch(e){s=!0,r=e}finally{try{a||null==i.return||i.return()}finally{if(s)throw r}}return o}}(e,t)||function(e,t){if(e){if("string"==typeof e)return ox(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return ox(e,t)}}(e,t)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ox(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var oy=RegExp("^["+rE+rT+"]+$","i"),ob="(?:["+rR+"]["+rE+rT+"]*|["+rE+rT+"]+)",ow=RegExp("[^"+rE+rT+"]+.*$"),ok=/[^\d\[\]]/,o_=function(){var e;function t(e){var n=e.defaultCountry,r=e.defaultCallingCode,i=e.metadata,o=e.onNationalSignificantNumberChange;if(!(0,R._)(this,t))throw TypeError("Cannot call a class as a function");this.defaultCountry=n,this.defaultCallingCode=r,this.metadata=i,this.onNationalSignificantNumberChange=o}return e=[{key:"input",value:function(e,t){var n,r,i,o,a,s=ov((i=(r=ov("+"===(n=function(e){var t,n=e.search(ob);if(!(n<0))return"+"===(e=e.slice(n))[0]&&(t=!0,e=e.slice(1)),e=e.replace(ow,""),t&&(e="+"+e),e}(e)||"")[0]?[n.slice(1),!0]:[n],2))[0],o=r[1],oy.test(i)||(i=""),[i,o]),2),l=s[0],u=s[1],c=ie(l);return u&&!t.digits&&(t.startInternationalNumber(),c||(a=!0)),c&&this.inputDigits(c,t),{digits:c,justLeadingPlus:a}}},{key:"inputDigits",value:function(e,t){var n=t.digits,r=n.length<3&&n.length+e.length>=3;if(t.appendDigits(e),r&&this.extractIddPrefix(t),this.isWaitingForCountryCallingCode(t)){if(!this.extractCountryCallingCode(t))return}else t.appendNationalSignificantNumberDigits(e);t.international||this.hasExtractedNationalSignificantNumber||this.extractNationalSignificantNumber(t.getNationalDigits(),function(e){return t.update(e)})}},{key:"isWaitingForCountryCallingCode",value:function(e){var t=e.international,n=e.callingCode;return t&&!n}},{key:"extractCountryCallingCode",value:function(e){var t=iA("+"+e.getDigitsWithoutInternationalPrefix(),this.defaultCountry,this.defaultCallingCode,this.metadata.metadata),n=t.countryCallingCode,r=t.number;if(n)return e.setCallingCode(n),e.update({nationalSignificantNumber:r}),!0}},{key:"reset",value:function(e){if(e){this.hasSelectedNumberingPlan=!0;var t=e._nationalPrefixForParsing();this.couldPossiblyExtractAnotherNationalSignificantNumber=t&&ok.test(t)}else this.hasSelectedNumberingPlan=void 0,this.couldPossiblyExtractAnotherNationalSignificantNumber=void 0}},{key:"extractNationalSignificantNumber",value:function(e,t){if(this.hasSelectedNumberingPlan){var n=iE(e,this.metadata),r=n.nationalPrefix,i=n.nationalNumber,o=n.carrierCode;if(i!==e)return this.onExtractedNationalNumber(r,o,i,e,t),!0}}},{key:"extractAnotherNationalSignificantNumber",value:function(e,t,n){if(!this.hasExtractedNationalSignificantNumber)return this.extractNationalSignificantNumber(e,n);if(this.couldPossiblyExtractAnotherNationalSignificantNumber){var r=iE(e,this.metadata),i=r.nationalPrefix,o=r.nationalNumber,a=r.carrierCode;if(o!==t)return this.onExtractedNationalNumber(i,a,o,e,n),!0}}},{key:"onExtractedNationalNumber",value:function(e,t,n,r,i){var o,a,s=r.lastIndexOf(n);if(s>=0&&s===r.length-n.length){a=!0;var l=r.slice(0,s);l!==e&&(o=l)}i({nationalPrefix:e,carrierCode:t,nationalSignificantNumber:n,nationalSignificantNumberMatchesInput:a,complexPrefixBeforeNationalSignificantNumber:o}),this.hasExtractedNationalSignificantNumber=!0,this.onNationalSignificantNumberChange()}},{key:"reExtractNationalSignificantNumber",value:function(e){return!!this.extractAnotherNationalSignificantNumber(e.getNationalDigits(),e.nationalSignificantNumber,function(t){return e.update(t)})||(this.extractIddPrefix(e)||this.fixMissingPlus(e)?(this.extractCallingCodeAndNationalSignificantNumber(e),!0):void 0)}},{key:"extractIddPrefix",value:function(e){var t=e.international,n=e.IDDPrefix,r=e.digits;if(e.nationalSignificantNumber,!t&&!n){var i=iT(r,this.defaultCountry,this.defaultCallingCode,this.metadata.metadata);if(void 0!==i&&i!==r)return e.update({IDDPrefix:r.slice(0,r.length-i.length)}),this.startInternationalNumber(e,{country:void 0,callingCode:void 0}),!0}}},{key:"fixMissingPlus",value:function(e){if(!e.international){var t=iI(e.digits,this.defaultCountry,this.defaultCallingCode,this.metadata.metadata),n=t.countryCallingCode;if(t.number,n)return e.update({missingPlus:!0}),this.startInternationalNumber(e,{country:e.country,callingCode:n}),!0}}},{key:"startInternationalNumber",value:function(e,t){var n=t.country,r=t.callingCode;e.startInternationalNumber(n,r),e.nationalSignificantNumber&&(e.resetNationalSignificantNumber(),this.onNationalSignificantNumberChange(),this.hasExtractedNationalSignificantNumber=void 0)}},{key:"extractCallingCodeAndNationalSignificantNumber",value:function(e){this.extractCountryCallingCode(e)&&this.extractNationalSignificantNumber(e.getNationalDigits(),function(t){return e.update(t)})}}],function(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t}();function oS(e){return(oS="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function oC(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var oj=function(){var e;function t(e,n){if(!(0,R._)(this,t))throw TypeError("Cannot call a class as a function");this.metadata=new rH(n);var r,i=function(e){if(Array.isArray(e))return e}(r=this.getCountryAndCallingCode(e))||function(e,t){var n,r,i=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=i){var o=[],a=!0,s=!1;try{for(i=i.call(e);!(a=(n=i.next()).done)&&(o.push(n.value),2!==o.length);a=!0);}catch(e){s=!0,r=e}finally{try{a||null==i.return||i.return()}finally{if(s)throw r}}return o}}(r,2)||function(e,t){if(e){if("string"==typeof e)return oC(e,2);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return oC(e,2)}}(r,2)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(),o=i[0],a=i[1];this.defaultCountry=o,this.defaultCallingCode=a,this.reset()}return e=[{key:"getCountryAndCallingCode",value:function(e){var t,n;return e&&("object"===oS(e)?(t=e.defaultCountry,n=e.defaultCallingCode):t=e),t&&!this.metadata.hasCountry(t)&&(t=void 0),[t,n]}},{key:"input",value:function(e){var t=this.parser.input(e,this.state),n=t.digits;if(t.justLeadingPlus)this.formattedOutput="+";else if(n){if(this.determineTheCountryIfNeeded(),this.state.nationalSignificantNumber&&this.formatter.narrowDownMatchingFormats(this.state),this.metadata.hasSelectedNumberingPlan()&&(r=this.formatter.format(n,this.state)),void 0===r&&this.parser.reExtractNationalSignificantNumber(this.state)){this.determineTheCountryIfNeeded();var r,i=this.state.getNationalDigits();i&&(r=this.formatter.format(i,this.state))}this.formattedOutput=r?this.getFullNumber(r):this.getNonFormattedNumber()}return this.formattedOutput}},{key:"reset",value:function(){var e=this;return this.state=new i9({onCountryChange:function(t){e.country=t},onCallingCodeChange:function(t,n){e.metadata.selectNumberingPlan(n,t),e.formatter.reset(e.metadata.numberingPlan,e.state),e.parser.reset(e.metadata.numberingPlan)}}),this.formatter=new om({state:this.state,metadata:this.metadata}),this.parser=new o_({defaultCountry:this.defaultCountry,defaultCallingCode:this.defaultCallingCode,metadata:this.metadata,state:this.state,onNationalSignificantNumberChange:function(){e.determineTheCountryIfNeeded(),e.formatter.reset(e.metadata.numberingPlan,e.state)}}),this.state.reset({country:this.defaultCountry,callingCode:this.defaultCallingCode}),this.formattedOutput="",this}},{key:"isInternational",value:function(){return this.state.international}},{key:"getCallingCode",value:function(){if(this.isInternational())return this.state.callingCode}},{key:"getCountryCallingCode",value:function(){return this.getCallingCode()}},{key:"getCountry",value:function(){if(this.state.digits)return this._getCountry()}},{key:"_getCountry",value:function(){return this.state.country}},{key:"determineTheCountryIfNeeded",value:function(){(!this.state.country||this.isCountryCallingCodeAmbiguous())&&this.determineTheCountry()}},{key:"getFullNumber",value:function(e){var t=this;if(this.isInternational()){var n=function(e){return t.formatter.getInternationalPrefixBeforeCountryCallingCode(t.state,{spacing:!!e})+e},r=this.state.callingCode;return n(r?e?"".concat(r," ").concat(e):r:"".concat(this.state.getDigitsWithoutInternationalPrefix()))}return e}},{key:"getNonFormattedNationalNumberWithPrefix",value:function(){var e=this.state,t=e.nationalSignificantNumber,n=e.complexPrefixBeforeNationalSignificantNumber,r=e.nationalPrefix,i=t,o=n||r;return o&&(i=o+i),i}},{key:"getNonFormattedNumber",value:function(){var e=this.state.nationalSignificantNumberMatchesInput;return this.getFullNumber(e?this.getNonFormattedNationalNumberWithPrefix():this.state.getNationalDigits())}},{key:"getNonFormattedTemplate",value:function(){var e=this.getNonFormattedNumber();if(e)return e.replace(/[\+\d]/g,"x")}},{key:"isCountryCallingCodeAmbiguous",value:function(){var e=this.state.callingCode,t=this.metadata.getCountryCodesForCallingCode(e);return t&&t.length>1}},{key:"determineTheCountry",value:function(){this.state.setCountry(iO(this.isInternational()?this.state.callingCode:this.defaultCallingCode,{nationalNumber:this.state.nationalSignificantNumber,defaultCountry:this.defaultCountry,metadata:this.metadata}))}},{key:"getNumberValue",value:function(){var e=this.state,t=e.digits,n=e.callingCode,r=e.country,i=e.nationalSignificantNumber;if(t){if(this.isInternational())if(n)return"+"+n+i;else return"+"+t;else if(r||n)return"+"+(r?this.metadata.countryCallingCode():n)+i}}},{key:"getNumber",value:function(){var e=this.state,t=e.nationalSignificantNumber,n=e.carrierCode,r=e.callingCode,i=this._getCountry();if(t&&(i||r)){if(i&&i===this.defaultCountry){var o=new rH(this.metadata.metadata);o.selectNumberingPlan(i);var a=o.numberingPlan.callingCode(),s=this.metadata.getCountryCodesForCallingCode(a);if(s.length>1){var l=iD(t,{countries:s,defaultCountry:this.defaultCountry,metadata:this.metadata.metadata});l&&(i=l)}}var u=new iC(i||r,t,this.metadata.metadata);return n&&(u.carrierCode=n),u}}},{key:"isPossible",value:function(){var e=this.getNumber();return!!e&&e.isPossible()}},{key:"isValid",value:function(){var e=this.getNumber();return!!e&&e.isValid()}},{key:"getNationalNumber",value:function(){return this.state.nationalSignificantNumber}},{key:"getChars",value:function(){return(this.state.international?"+":"")+this.state.digits}},{key:"getTemplate",value:function(){return this.formatter.getTemplate(this.state)||this.getNonFormattedTemplate()||""}}],function(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t}();function oT(e){var t=e.country,n=e.international,r=e.withCountryCallingCode,i=e.metadata;return t&&n&&!r?"+".concat(rZ(t,i)):""}function oE(e,t){return t&&" "===(e=e.slice(t.length))[0]&&(e=e.slice(1)),e}var oR=["country","international","withCountryCallingCode","metadata"];function oI(){return(oI=Object.assign.bind()).apply(this,arguments)}let oA=function(e){function t(e,t){var n=e.country,r=e.international,i=e.withCountryCallingCode,o=e.metadata,a=void 0===o?void 0:o,s=function(e,t){if(null==e)return{};var n,r,i=function(e,t){if(null==e)return{};var n,r,i={},o=Object.keys(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}(e,oR),l=(0,c.useCallback)(function(e){var t=new oj(n,a),o=oT({country:n,international:r,withCountryCallingCode:i,metadata:a}),s=t.input(o+e),l=t.getTemplate();return o&&(s=oE(s,o),l&&(l=oE(l,o))),{text:s,template:l}},[n,a]);return c.default.createElement(i6,oI({},s,{ref:t,parse:ii,format:l}))}return(t=c.default.forwardRef(t)).propTypes={value:iK.default.string.isRequired,onChange:iK.default.func.isRequired,country:iK.default.string,international:iK.default.bool,withCountryCallingCode:iK.default.bool,metadata:iK.default.object},t}();var oP=["value","onChange","country","international","withCountryCallingCode","metadata","inputComponent"];function oD(){return(oD=Object.assign.bind()).apply(this,arguments)}let oO=function(e){function t(e,t){var n=e.value,r=e.onChange,i=e.country,o=e.international,a=e.withCountryCallingCode,s=e.metadata,l=void 0===s?void 0:s,u=e.inputComponent,d=function(e,t){if(null==e)return{};var n,r,i=function(e,t){if(null==e)return{};var n,r,i={},o=Object.keys(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}(e,oP),f=oT({country:i,international:o,withCountryCallingCode:a,metadata:l}),p=(0,c.useCallback)(function(e){var t=ir(e.target.value);t===n&&0===oN(f,t,i,l).indexOf(e.target.value)&&(t=t.slice(0,-1)),r(t)},[f,n,r,i,l]);return c.default.createElement(void 0===u?"input":u,oD({},d,{ref:t,value:oN(f,n,i,l),onChange:p}))}return(t=c.default.forwardRef(t)).propTypes={value:iK.default.string.isRequired,onChange:iK.default.func.isRequired,country:iK.default.string,international:iK.default.bool,withCountryCallingCode:iK.default.bool,metadata:iK.default.object,inputComponent:iK.default.elementType},t}();function oN(e,t,n,r){var i,o,a;return oE((i=e+t,o=n,(a=r)||(a=o,o=void 0),new oj(o,a).input(i)),e)}function oM(e){return String.fromCodePoint(127397+e.toUpperCase().charCodeAt(0))}var oL=["value","onChange","options"],oB=["value","options","className","iconComponent","getIconAspectRatio","arrowComponent","unicodeFlags"];function oV(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function oF(){return(oF=Object.assign.bind()).apply(this,arguments)}function oU(e,t){if(null==e)return{};var n,r,i=function(e,t){if(null==e)return{};var n,r,i={},o=Object.keys(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}function oG(e){var t=e.value,n=e.onChange,r=e.options,i=oU(e,oL),o=(0,c.useCallback)(function(e){var t=e.target.value;n("ZZ"===t?void 0:t)},[n]);return(0,c.useMemo)(function(){return oW(r,t)},[r,t]),c.default.createElement("select",oF({},i,{value:t||"ZZ",onChange:o}),r.map(function(e){var t=e.value,n=e.label,r=e.divider;return c.default.createElement("option",{key:r?"|":t||"ZZ",value:r?"|":t||"ZZ",disabled:!!r,style:r?o$:void 0},n)}))}oG.propTypes={value:iK.default.string,onChange:iK.default.func.isRequired,options:iK.default.arrayOf(iK.default.shape({value:iK.default.string,label:iK.default.string,divider:iK.default.bool})).isRequired};var o$={fontSize:"1px",backgroundColor:"currentColor",color:"inherit"};function oz(e){var t=e.value,n=e.options,r=e.className,i=e.iconComponent,o=(e.getIconAspectRatio,e.arrowComponent),a=e.unicodeFlags,s=oU(e,oB),l=(0,c.useMemo)(function(){return oW(n,t)},[n,t]);return c.default.createElement("div",{className:"PhoneInputCountry"},c.default.createElement(oG,oF({},s,{value:t,options:n,className:(0,iX.default)("PhoneInputCountrySelect",r)})),a&&t&&c.default.createElement("div",{className:"PhoneInputCountryIconUnicode"},oM(t[0])+oM(t[1])),!(a&&t)&&c.default.createElement(i,{"aria-hidden":!0,country:t,label:l&&l.label,aspectRatio:a?1:void 0}),c.default.createElement(void 0===o?oH:o,null))}function oH(){return c.default.createElement("div",{className:"PhoneInputCountrySelectArrow"})}function oW(e,t){for(var n,r=function(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(n)return(n=n.call(e)).next.bind(n);if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return oV(e,void 0);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return oV(e,void 0)}}(e))){n&&(e=n);var r=0;return function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}}}throw TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(e);!(n=r()).done;){var i=n.value;if(!i.divider&&i.value===t)return i}}oz.propTypes={iconComponent:iK.default.elementType,arrowComponent:iK.default.elementType,unicodeFlags:iK.default.bool};var oq=["country","countryName","flags","flagUrl"];function oK(){return(oK=Object.assign.bind()).apply(this,arguments)}function oY(e){var t=e.country,n=e.countryName,r=e.flags,i=e.flagUrl,o=function(e,t){if(null==e)return{};var n,r,i=function(e,t){if(null==e)return{};var n,r,i={},o=Object.keys(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}(e,oq);return r&&r[t]?r[t]({title:n}):c.default.createElement("img",oK({},o,{alt:n,role:n?void 0:"presentation",src:i.replace("{XX}",t).replace("{xx}",t.toLowerCase())}))}oY.propTypes={country:iK.default.string.isRequired,countryName:iK.default.string.isRequired,flags:iK.default.objectOf(iK.default.elementType),flagUrl:iK.default.string.isRequired};var oQ=["aspectRatio"],oX=["title"],oJ=["title"];function oZ(){return(oZ=Object.assign.bind()).apply(this,arguments)}function o0(e,t){if(null==e)return{};var n,r,i=function(e,t){if(null==e)return{};var n,r,i={},o=Object.keys(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}function o1(e){var t=e.aspectRatio,n=o0(e,oQ);return 1===t?c.default.createElement(o3,n):c.default.createElement(o2,n)}function o2(e){var t=e.title,n=o0(e,oX);return c.default.createElement("svg",oZ({},n,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 75 50"}),c.default.createElement("title",null,t),c.default.createElement("g",{className:"PhoneInputInternationalIconGlobe",stroke:"currentColor",fill:"none",strokeWidth:"2",strokeMiterlimit:"10"},c.default.createElement("path",{strokeLinecap:"round",d:"M47.2,36.1C48.1,36,49,36,50,36c7.4,0,14,1.7,18.5,4.3"}),c.default.createElement("path",{d:"M68.6,9.6C64.2,12.3,57.5,14,50,14c-7.4,0-14-1.7-18.5-4.3"}),c.default.createElement("line",{x1:"26",y1:"25",x2:"74",y2:"25"}),c.default.createElement("line",{x1:"50",y1:"1",x2:"50",y2:"49"}),c.default.createElement("path",{strokeLinecap:"round",d:"M46.3,48.7c1.2,0.2,2.5,0.3,3.7,0.3c13.3,0,24-10.7,24-24S63.3,1,50,1S26,11.7,26,25c0,2,0.3,3.9,0.7,5.8"}),c.default.createElement("path",{strokeLinecap:"round",d:"M46.8,48.2c1,0.6,2.1,0.8,3.2,0.8c6.6,0,12-10.7,12-24S56.6,1,50,1S38,11.7,38,25c0,1.4,0.1,2.7,0.2,4c0,0.1,0,0.2,0,0.2"})),c.default.createElement("path",{className:"PhoneInputInternationalIconPhone",stroke:"none",fill:"currentColor",d:"M12.4,17.9c2.9-2.9,5.4-4.8,0.3-11.2S4.1,5.2,1.3,8.1C-2,11.4,1.1,23.5,13.1,35.6s24.3,15.2,27.5,11.9c2.8-2.8,7.8-6.3,1.4-11.5s-8.3-2.6-11.2,0.3c-2,2-7.2-2.2-11.7-6.7S10.4,19.9,12.4,17.9z"}))}function o3(e){var t=e.title,n=o0(e,oJ);return c.default.createElement("svg",oZ({},n,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 50 50"}),c.default.createElement("title",null,t),c.default.createElement("g",{className:"PhoneInputInternationalIconGlobe",stroke:"currentColor",fill:"none",strokeWidth:"2",strokeLinecap:"round"},c.default.createElement("path",{d:"M8.45,13A21.44,21.44,0,1,1,37.08,41.56"}),c.default.createElement("path",{d:"M19.36,35.47a36.9,36.9,0,0,1-2.28-13.24C17.08,10.39,21.88.85,27.8.85s10.72,9.54,10.72,21.38c0,6.48-1.44,12.28-3.71,16.21"}),c.default.createElement("path",{d:"M17.41,33.4A39,39,0,0,1,27.8,32.06c6.62,0,12.55,1.5,16.48,3.86"}),c.default.createElement("path",{d:"M44.29,8.53c-3.93,2.37-9.86,3.88-16.49,3.88S15.25,10.9,11.31,8.54"}),c.default.createElement("line",{x1:"27.8",y1:"0.85",x2:"27.8",y2:"34.61"}),c.default.createElement("line",{x1:"15.2",y1:"22.23",x2:"49.15",y2:"22.23"})),c.default.createElement("path",{className:"PhoneInputInternationalIconPhone",stroke:"transparent",fill:"currentColor",d:"M9.42,26.64c2.22-2.22,4.15-3.59.22-8.49S3.08,17,.93,19.17c-2.49,2.48-.13,11.74,9,20.89s18.41,11.5,20.89,9c2.15-2.15,5.91-4.77,1-8.71s-6.27-2-8.49.22c-1.55,1.55-5.48-1.69-8.86-5.08S7.87,28.19,9.42,26.64Z"}))}function o4(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function o8(e,t){return!!r0(e,t)||(console.error("Country not found: ".concat(e)),!1)}function o5(e,t){return e&&0===(e=e.filter(function(e){return o8(e,t)})).length&&(e=void 0),e}o1.propTypes={title:iK.default.string.isRequired,aspectRatio:iK.default.number},o2.propTypes={title:iK.default.string.isRequired},o3.propTypes={title:iK.default.string.isRequired};var o6=["country","label","aspectRatio"];function o9(){return(o9=Object.assign.bind()).apply(this,arguments)}function o7(e){var t=e.flags,n=e.flagUrl,r=e.flagComponent,i=e.internationalIcon;function o(e){var o=e.country,a=e.label,s=e.aspectRatio,l=function(e,t){if(null==e)return{};var n,r,i=function(e,t){if(null==e)return{};var n,r,i={},o=Object.keys(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}(e,o6),u=i===o1?s:void 0;return c.default.createElement("div",o9({},l,{className:(0,iX.default)("PhoneInputCountryIcon",{"PhoneInputCountryIcon--square":1===u,"PhoneInputCountryIcon--border":o})}),o?c.default.createElement(r,{country:o,countryName:a,flags:t,flagUrl:n,className:"PhoneInputCountryIconImg"}):c.default.createElement(i,{title:a,aspectRatio:u,className:"PhoneInputCountryIconImg"}))}return o.propTypes={country:iK.default.string,label:iK.default.string.isRequired,aspectRatio:iK.default.number},o}function ae(e,t){return"+"+rZ(e,t)}function at(e,t){return function(){var e,t=function(e){var t,n,r,i,o=function(e){if(Array.isArray(e))return e}(t=Array.prototype.slice.call(e))||function(e,t){var n,r,i=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=i){var o=[],a=!0,s=!1;try{for(i=i.call(e);!(a=(n=i.next()).done)&&(o.push(n.value),4!==o.length);a=!0);}catch(e){s=!0,r=e}finally{try{a||null==i.return||i.return()}finally{if(s)throw r}}return o}}(t,4)||function(e,t){if(e){if("string"==typeof e)return rj(e,4);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return rj(e,4)}}(t,4)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(),a=o[0],s=o[1],l=o[2],u=o[3];if("string"==typeof a)n=a;else throw TypeError("A text for parsing must be a string.");if(s&&"string"!=typeof s)if("object"===rS(s))l?(r=s,i=l):i=s;else throw Error("Invalid second argument: ".concat(s));else u?(r=l,i=u):(r=void 0,i=l),s&&(r=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?rC(Object(n),!0).forEach(function(t){var r,i,o;r=e,i=t,o=n[t],i in r?Object.defineProperty(r,i,{value:o,enumerable:!0,configurable:!0,writable:!0}):r[i]=o}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):rC(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}({defaultCountry:s},r));return{text:n,options:r,metadata:i}}(arguments),n=t.text,r=t.options,i=t.metadata,o=r;o&&o.defaultCountry&&!r0(o.defaultCountry,i)&&(o=iH(iH({},o),{},{defaultCountry:void 0}));try{return e=o,function(e,t,n){if(t=t||{},n=new rH(n),t.defaultCountry&&!n.hasCountry(t.defaultCountry)){if(t.v2)throw new rL("INVALID_COUNTRY");throw Error("Unknown country: ".concat(t.defaultCountry))}var r,i,o,a,s=function(e,t,n){var r=function(e,t){var n=t.extractFormattedPhoneNumber,r=function(e){var t=e.indexOf(iV);if(t<0)return null;var n=t+iV.length;if(n>=e.length)return"";var r=e.indexOf(";",n);return r>=0?e.substring(n,r):e.substring(n)}(e);if(!(null===r||0!==r.length&&(iM.test(r)||iL.test(r))))throw new rL("NOT_A_NUMBER");if(null===r)i=n(e)||"";else{i="","+"===r.charAt(0)&&(i+=r);var i,o,a=e.indexOf(iB);o=a>=0?a+iB.length:0;var s=e.indexOf(iV);i+=e.substring(o,s)}var l=i.indexOf(";isub=");if(l>0&&(i=i.substring(0,l)),""!==i)return i}(e,{extractFormattedPhoneNumber:function(e){if(e){if(e.length>250){if(t)throw new rL("TOO_LONG");return}if(!1===n)return e;var r=e.search(iF);return r<0?void 0:e.slice(r).replace(iU,"")}}});if(!r)return{};if(!(r.length>=2&&r5.test(r)))return r8.test(r)?{error:"TOO_SHORT"}:{};var i=function(e){var t=e.search(r6);if(t<0)return{};for(var n=e.slice(0,t),r=e.match(r6),i=1;i<r.length;){if(r[i])return{number:n,ext:r[i]};i++}}(r);return i.ext?i:{number:r}}(e,t.v2,t.extract),l=s.number,u=s.ext,c=s.error;if(!l){if(t.v2){if("TOO_SHORT"===c)throw new rL("TOO_SHORT");throw new rL("NOT_A_NUMBER")}return{}}var d=function(e,t,n,r){var i,o=iA(ir(e),t,n,r.metadata),a=o.countryCallingCodeSource,s=o.countryCallingCode,l=o.number;if(s)r.selectNumberingPlan(s);else{if(!l||!t&&!n)return{};r.selectNumberingPlan(t,n),t&&(i=t),s=n||rZ(t,r.metadata)}if(!l)return{countryCallingCodeSource:a,countryCallingCode:s};var u=iR(ir(l),r),c=u.nationalNumber,d=u.carrierCode,f=iO(s,{nationalNumber:c,defaultCountry:t,metadata:r});return f&&(i=f,"001"===f||r.country(i)),{country:i,countryCallingCode:s,countryCallingCodeSource:a,nationalNumber:c,carrierCode:d}}(l,t.defaultCountry,t.defaultCallingCode,n),f=d.country,p=d.nationalNumber,h=d.countryCallingCode,g=d.countryCallingCodeSource,m=d.carrierCode;if(!n.hasSelectedNumberingPlan()){if(t.v2)throw new rL("INVALID_COUNTRY");return{}}if(!p||p.length<2){if(t.v2)throw new rL("TOO_SHORT");return{}}if(p.length>17){if(t.v2)throw new rL("TOO_LONG");return{}}if(t.v2){var x=new iC(h,p,n.metadata);return f&&(x.country=f),m&&(x.carrierCode=m),u&&(x.ext=u),x.__countryCallingCodeSource=g,x}var y=(t.extended?!!n.hasSelectedNumberingPlan():!!f)&&il(p,n.nationalNumberPattern());return t.extended?{country:f,countryCallingCode:h,carrierCode:m,valid:y,possible:!!y||!!(!0===t.extended&&n.possibleLengths()&&is(p,n)),phone:p,ext:u}:y?(r=f,i=p,o=u,a={country:r,phone:i},o&&(a.ext=o),a):{}}(n,i$(i$({},e),{},{v2:!0}),i)}catch(e){if((0,R._)(e,rL));else throw e}}(e||"",t)}function an(e,t,n){if(e){if("+"===e[0]){if("+"===e)return;var r=new oj(t,n);return r.input(e),r.getNumberValue()}if(t){var i=aa(e,t,n);return"+".concat(rZ(t,n)).concat(i||"")}}}function ar(e,t){var n,r,i=t.country,o=t.countries,a=t.required,s=t.metadata;if("+"===e)return i;var l=(n=e,(r=new oj(null,s)).input(n),r.getCountry());return l&&(!o||o.indexOf(l)>=0)?l:!i||a||as(e,i,s)?i:void 0}function ai(e,t,n){if(0!==e.indexOf(ae(t,n)))return e.replace(/\D/g,"");var r=new oj(t,n);r.input(e);var i=r.getNumber();return i?i.formatNational().replace(/\D/g,""):""}function ao(e,t,n){return String.prototype.localeCompare?e.localeCompare(t,n):e<t?-1:+(e>t)}function aa(e,t,n){var r=new oj(t,n);r.input(e);var i=r.getNumber();return i&&i.nationalNumber}function as(e,t,n){for(var r=ae(t,n),i=0;i<e.length&&i<r.length;){if(e[i]!==r[i])return!1;i++}return!0}function al(e){var t=e.value,n=e.phoneNumber,r=e.defaultCountry,i=e.international,o=e.useNationalFormat,a=e.metadata;return(!1===i||o)&&n&&n.country?n.formatNational().replace(/\D/g,""):!t&&i&&r?ae(r,a):t}function au(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function ac(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?au(Object(n),!0).forEach(function(t){var r,i,o;r=e,i=t,o=n[t],i in r?Object.defineProperty(r,i,{value:o,enumerable:!0,configurable:!0,writable:!0}):r[i]=o}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):au(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function ad(e,t){return null===e&&(e=void 0),null===t&&(t=void 0),e===t}function af(e){return(af="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}o7({flagUrl:"https://purecatamphetamine.github.io/country-flag-icons/3x2/{XX}.svg",flagComponent:oY,internationalIcon:o1});var ap=["name","disabled","readOnly","autoComplete","style","className","inputRef","inputComponent","numberInputProps","smartCaret","countrySelectComponent","countrySelectProps","containerComponent","defaultCountry","countries","countryOptionsOrder","labels","flags","flagComponent","flagUrl","addInternationalOption","internationalIcon","displayInitialValueAsLocalNumber","initialValueFormat","onCountryChange","limitMaxLength","countryCallingCodeEditable","focusInputOnCountrySelection","reset","metadata","international","locales"];function ah(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function ag(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ah(Object(n),!0).forEach(function(t){aw(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ah(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function am(){return(am=Object.assign.bind()).apply(this,arguments)}function av(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function ax(e,t){return(ax=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function ay(e){if(void 0===e)throw ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ab(e){return(ab=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function aw(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var ak=function(e){if("function"!=typeof e&&null!==e)throw TypeError("Super expression must either be null or a function");o.prototype=Object.create(e&&e.prototype,{constructor:{value:o,writable:!0,configurable:!0}}),Object.defineProperty(o,"prototype",{writable:!1}),e&&ax(o,e);var t,n,r,i=(t=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}(),function(){var e,n=ab(o);return e=t?Reflect.construct(n,arguments,ab(this).constructor):n.apply(this,arguments),function(e,t){if(t&&("object"===af(t)||"function"==typeof t))return t;if(void 0!==t)throw TypeError("Derived constructors may only return object or undefined");return ay(e)}(this,e)});function o(e){if(!(0,R._)(this,o))throw TypeError("Cannot call a class as a function");aw(ay(p=i.call(this,e)),"setInputRef",function(e){p.inputRef.current=e;var t=p.props.inputRef;t&&("function"==typeof t?t(e):t.current=e)}),aw(ay(p),"isCountrySupportedWithError",function(e){return o8(e,p.props.metadata)}),aw(ay(p),"onCountryChange",function(e){var t=p.props,n=t.international,r=t.metadata,i=t.onChange,o=t.focusInputOnCountrySelection,a=p.state,s=function(e,t){var n=t.prevCountry,r=t.newCountry,i=t.metadata,o=t.useNationalFormat;if(n===r)return e;if(!e)if(o)return"";else return r?ae(r,i):"";if(r){if("+"===e[0]){if(o)return 0===e.indexOf("+"+rZ(r,i))?function(e,t,n){if(t){var r="+"+rZ(t,n);if(e.length<r.length){if(0===r.indexOf(e))return""}else if(0===e.indexOf(r))return e.slice(r.length)}for(var i=0,o=Object.keys(n.country_calling_codes);i<o.length;i++){var a=o[i];if(1===e.indexOf(a))return e.slice(1+a.length)}return""}(e,r,i):"";if(n){var a=ae(r,i);if(0!==e.indexOf(a))return a}else{var s=ae(r,i);return 0===e.indexOf(s)?e:s}}}else if("+"!==e[0])return an(e,n,i)||"";return e}(a.phoneDigits,{prevCountry:a.country,newCountry:e,metadata:r,useNationalFormat:!n}),l=an(s,e,r);o&&p.inputRef.current.focus(),p.setState({country:e,hasUserSelectedACountry:!0,phoneDigits:s,value:l},function(){i(l)})}),aw(ay(p),"onChange",function(e){var t=p.props,n=t.defaultCountry,r=t.onChange,i=t.addInternationalOption,o=t.international,a=t.limitMaxLength,s=t.countryCallingCodeEditable,l=t.metadata,u=p.state,c=u.countries,d=function(e,t){var n,r=t.prevPhoneDigits,i=t.country,o=t.defaultCountry,a=t.countryRequired,s=t.getAnyCountry,l=t.countries,u=t.international,c=t.limitMaxLength,d=t.countryCallingCodeEditable,f=t.metadata;if(u&&!1===d&&i){var p,h=ae(i,f);if(0!==e.indexOf(h))return e&&"+"!==e[0]?p=an(e=h+e,i,f):e=h,{phoneDigits:e,value:p,country:i}}return!1===u&&i&&e&&"+"===e[0]&&(e=ai(e,i,f)),e&&i&&c&&(e=function(e,t,n){var r=aa(e,t,n);if(r){var i,o,a=r.length-(i=t,(o=new rH(o=n)).selectNumberingPlan(i),o.numberingPlan.possibleLengths()[o.numberingPlan.possibleLengths().length-1]);if(a>0)return e.slice(0,e.length-a)}return e}(e,i,f)),e&&"+"!==e[0]&&(!i||u)&&(e="+"+e),!e&&r&&"+"===r[0]&&(i=u?void 0:o),"+"===e&&r&&"+"===r[0]&&r.length>1&&(i=void 0),e&&(n="+"===e[0]&&("+"===e||i&&0===ae(i,f).indexOf(e))?void 0:an(e,i,f)),n&&(i=ar(n,{country:i,countries:l,metadata:f}),!1===u&&i&&e&&"+"===e[0]&&(n=an(e=ai(e,i,f),i,f))),!i&&a&&(i=o||s()),{phoneDigits:e,country:i,value:n}}(e,{prevPhoneDigits:u.phoneDigits,country:u.country,countryRequired:!i,defaultCountry:n,getAnyCountry:function(){return p.getFirstSupportedCountry({countries:c})},countries:c,international:o,limitMaxLength:a,countryCallingCodeEditable:s,metadata:l}),f=d.phoneDigits,h=d.country,g=d.value,m={phoneDigits:f,value:g,country:h};!1!==s||g||f!==p.state.phoneDigits||(m.forceRerender={}),p.setState(m,function(){return r(g)})}),aw(ay(p),"_onFocus",function(){return p.setState({isFocused:!0})}),aw(ay(p),"_onBlur",function(){return p.setState({isFocused:!1})}),aw(ay(p),"onFocus",function(e){p._onFocus();var t=p.props.onFocus;t&&t(e)}),aw(ay(p),"onBlur",function(e){var t=p.props.onBlur;p._onBlur(),t&&t(e)}),aw(ay(p),"onCountryFocus",function(e){p._onFocus();var t=p.props.countrySelectProps;if(t){var n=t.onFocus;n&&n(e)}}),aw(ay(p),"onCountryBlur",function(e){p._onBlur();var t=p.props.countrySelectProps;if(t){var n=t.onBlur;n&&n(e)}}),p.inputRef=c.default.createRef();var t,n,r,a,s,l,u,d,f,p,h=p.props,g=h.value,m=(h.labels,h.international),x=h.addInternationalOption,y=h.displayInitialValueAsLocalNumber,b=h.initialValueFormat,w=h.metadata,k=p.props,_=k.defaultCountry,S=k.countries;_&&!p.isCountrySupportedWithError(_)&&(_=void 0),S=o5(S,w);var C=at(g,w);p.CountryIcon=o7(p.props);var j=(r=(t={value:g,phoneNumber:C,defaultCountry:_,required:!x,countries:S||iW(w),getAnyCountry:function(){return p.getFirstSupportedCountry({countries:S})},metadata:w}).value,a=t.phoneNumber,s=t.defaultCountry,l=t.getAnyCountry,u=t.countries,d=t.required,f=t.metadata,a&&a.country?n=a.country:s&&(!r||as(r,s,f))&&(n=s),u&&0>u.indexOf(n)&&(n=void 0),!n&&d&&u&&u.length>0&&(n=l()),n);return p.state={props:p.props,country:j,countries:S,phoneDigits:al({value:g,phoneNumber:C,defaultCountry:_,international:m,useNationalFormat:y||"national"===b,metadata:w}),value:g},p}return n=[{key:"componentDidMount",value:function(){var e=this.props.onCountryChange,t=this.props.defaultCountry,n=this.state.country;e&&(t&&!this.isCountrySupportedWithError(t)&&(t=void 0),n!==t&&e(n))}},{key:"componentDidUpdate",value:function(e,t){var n=this.props.onCountryChange,r=this.state.country;n&&r!==t.country&&n(r)}},{key:"getCountrySelectOptions",value:function(e){var t=e.countries,n=this.props,r=n.international,i=n.countryCallingCodeEditable,o=n.countryOptionsOrder,a=n.addInternationalOption,s=n.labels,l=n.locales,u=n.metadata;return this.useMemoCountrySelectOptions(function(){var e,n,c,d,f,p,h;return function(e,t){if(!t)return e;for(var n,r=[],i=[],o=r,a=function(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(n)return(n=n.call(e)).next.bind(n);if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return o4(e,void 0);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return o4(e,void 0)}}(e))){n&&(e=n);var r=0;return function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}}}throw TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(t);!(n=a()).done;){var s=n.value;"|"===s?o.push({divider:!0}):"..."===s||""===s?o=i:function(){var t=void 0;t=""===s?void 0:s;var n=e.indexOf(e.filter(function(e){return e.value===t})[0]),r=e[n];e.splice(n,1),o.push(r)}()}return r.concat(e).concat(i)}((n=(e={countries:t||iW(u),countryNames:s,addInternationalOption:(!r||!1!==i)&&a,compareStringsLocales:l}).countries,c=e.countryNames,d=e.addInternationalOption,f=e.compareStringsLocales,(p=e.compareStrings)||(p=ao),(h=n.map(function(e){return{value:e,label:c[e]||e}})).sort(function(e,t){return p(e.label,t.label,f)}),d&&h.unshift({label:c.ZZ}),h),function(e,t){if(e&&(e=e.filter(function(e){switch(e){case"":case"|":case"...":case"":return!0;default:return o8(e,t)}})).length>0)return e}(o,u))},[t,o,a,s,u])}},{key:"useMemoCountrySelectOptions",value:function(e,t){return this.countrySelectOptionsMemoDependencies&&function(e,t){if(e.length!==t.length)return!1;for(var n=0;n<e.length;){if(e[n]!==t[n])return!1;n++}return!0}(t,this.countrySelectOptionsMemoDependencies)||(this.countrySelectOptionsMemo=e(),this.countrySelectOptionsMemoDependencies=t),this.countrySelectOptionsMemo}},{key:"getFirstSupportedCountry",value:function(e){var t=e.countries;return this.getCountrySelectOptions({countries:t})[0].value}},{key:"render",value:function(){var e=this.props,t=e.name,n=e.disabled,r=e.readOnly,i=e.autoComplete,o=e.style,a=e.className,s=(e.inputRef,e.inputComponent),l=e.numberInputProps,u=e.smartCaret,d=e.countrySelectComponent,f=e.countrySelectProps,p=e.containerComponent,h=(e.defaultCountry,e.countries,e.countryOptionsOrder,e.labels),g=(e.flags,e.flagComponent,e.flagUrl,e.addInternationalOption,e.internationalIcon,e.displayInitialValueAsLocalNumber,e.initialValueFormat,e.onCountryChange,e.limitMaxLength,e.countryCallingCodeEditable,e.focusInputOnCountrySelection,e.reset,e.metadata),m=(e.international,e.locales,function(e,t){if(null==e)return{};var n,r,i=function(e,t){if(null==e)return{};var n,r,i={},o=Object.keys(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}(e,ap)),x=this.state,y=x.country,b=x.countries,w=x.phoneDigits,k=x.isFocused,_=this.getCountrySelectOptions({countries:b});return c.default.createElement(p,{style:o,className:(0,iX.default)(a,"PhoneInput",{"PhoneInput--focus":k,"PhoneInput--disabled":n,"PhoneInput--readOnly":r})},c.default.createElement(d,am({name:t?"".concat(t,"Country"):void 0,"aria-label":h.country},f,{value:y,options:_,onChange:this.onCountryChange,onFocus:this.onCountryFocus,onBlur:this.onCountryBlur,disabled:n||f&&f.disabled,readOnly:r||f&&f.readOnly,iconComponent:this.CountryIcon})),c.default.createElement(u?oA:oO,am({ref:this.setInputRef,type:"tel",autoComplete:i},l,m,{name:t,metadata:g,country:y,value:w||"",onChange:this.onChange,onFocus:this.onFocus,onBlur:this.onBlur,disabled:n,readOnly:r,inputComponent:s,className:(0,iX.default)("PhoneInputInput",l&&l.className,m.className)})))}}],r=[{key:"getDerivedStateFromProps",value:function(e,t){return ag({props:e},function(e,t,n){var r=e.metadata,i=e.countries,o=e.defaultCountry,a=e.value,s=e.reset,l=e.international,u=e.displayInitialValueAsLocalNumber,c=e.initialValueFormat,d=t.defaultCountry,f=t.value,p=t.reset;n.country;var h=n.value,g=n.hasUserSelectedACountry,m=function(e){return al(ac(ac({},e),{},{international:l,useNationalFormat:u||"national"===c,metadata:r}))};if(s!==p)return{phoneDigits:m({value:void 0,defaultCountry:o}),value:void 0,country:o,hasUserSelectedACountry:void 0};if(o!==d){var x=!o||o8(o,r),y=!h||l&&h===m({value:void 0,defaultCountry:d}),b=!a&&y;if(!g&&x&&b)return{country:o,phoneDigits:m({value:void 0,defaultCountry:o}),value:void 0}}if(!ad(a,f)&&!ad(a,h)){if(a){var w,k,_=at(a,r),S=o5(i,r);_&&_.country?(!S||S.indexOf(_.country)>=0)&&(w=_.country):(w=ar(a,{country:void 0,countries:S,metadata:r}))||!o||0!==a.indexOf(ae(o,r))||(w=o)}return a||(k={hasUserSelectedACountry:void 0}),ac(ac({},k),{},{phoneDigits:m({phoneNumber:_,value:a,defaultCountry:o}),value:a,country:a?w:o})}}(e,t.props,t))}}],n&&av(o.prototype,n),r&&av(o,r),Object.defineProperty(o,"prototype",{writable:!1}),o}(c.default.PureComponent),a_=c.default.forwardRef(function(e,t){return c.default.createElement(ak,am({},function(e){for(var t in e=ag({},e),aS)void 0===e[t]&&(e[t]=aS[t]);return e}(e),{inputRef:t}))});a_.propTypes={value:iK.default.string,onChange:iK.default.func.isRequired,onFocus:iK.default.func,onBlur:iK.default.func,disabled:iK.default.bool,readOnly:iK.default.bool,autoComplete:iK.default.string,initialValueFormat:iK.default.oneOf(["national"]),displayInitialValueAsLocalNumber:iK.default.bool,defaultCountry:iK.default.string,countries:iK.default.arrayOf(iK.default.string),labels:iQ,locales:iK.default.oneOfType([iK.default.string,iK.default.arrayOf(iK.default.string)]),flagUrl:iK.default.string,flags:iK.default.objectOf(iK.default.elementType),flagComponent:iK.default.elementType,addInternationalOption:iK.default.bool,internationalIcon:iK.default.elementType,countryOptionsOrder:iK.default.arrayOf(iK.default.string),style:iK.default.object,className:iK.default.string,countrySelectComponent:iK.default.elementType,countrySelectProps:iK.default.object,inputComponent:iK.default.elementType,containerComponent:iK.default.elementType,numberInputProps:iK.default.object,smartCaret:iK.default.bool,international:iK.default.bool,limitMaxLength:iK.default.bool,countryCallingCodeEditable:iK.default.bool,metadata:iY,onCountryChange:iK.default.func,focusInputOnCountrySelection:iK.default.bool};var aS={autoComplete:"tel",countrySelectComponent:oz,flagComponent:oY,flagUrl:"https://purecatamphetamine.github.io/country-flag-icons/3x2/{XX}.svg",internationalIcon:o1,inputComponent:"input",containerComponent:"div",reset:iK.default.any,smartCaret:!0,addInternationalOption:!0,countryCallingCodeEditable:!0,focusInputOnCountrySelection:!0},aC=["metadata","labels"];function aj(){return(aj=Object.assign.bind()).apply(this,arguments)}function aT(e){var t=c.default.forwardRef(function(t,n){var r=t.metadata,i=t.labels,o=function(e,t){if(null==e)return{};var n,r,i=function(e,t){if(null==e)return{};var n,r,i={},o=Object.keys(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}(t,aC);return c.default.createElement(a_,aj({},o,{ref:n,metadata:void 0===r?e:r,labels:void 0===i?iq:i}))});return t.propTypes={metadata:iY,labels:iQ},t}aT();let aE=aT(r_);function aR(){var e=(0,eI._)(["\n  mutation SendSmsVerification($input: SendSmsVerificationInput!) {\n    sendSmsVerification(input: $input) {\n      ... on SendSmsVerificationResult {\n        __typename\n        success\n      }\n      ... on UserError {\n        __typename\n        message\n      }\n      ... on TooManyRequestsError {\n        __typename\n        message\n      }\n      ... on UnauthorizedError {\n        __typename\n        message\n      }\n    }\n  }\n"]);return aR=function(){return e},e}function aI(){var e=(0,eI._)(["\n  mutation ConfirmSmsVerification($input: ConfirmSmsVerificationInput!) {\n    confirmSmsVerification(input: $input) {\n      ... on ConfirmSmsVerificationResult {\n        __typename\n        success\n      }\n      ... on UserError {\n        __typename\n        message\n      }\n      ... on TooManyRequestsError {\n        __typename\n        message\n      }\n      ... on UnauthorizedError {\n        __typename\n        message\n      }\n    }\n  }\n"]);return aI=function(){return e},e}var aA={},aP=(0,eA.gql)(aR()),aD=(0,eA.gql)(aI()),aO=function(e,t){switch(t.type){case"setPhoneNumber":return(0,s._)((0,a._)({},e),{phoneNumber:t.phoneNumber});case"setCode":return(0,s._)((0,a._)({},e),{code:t.code});case"setError":return(0,s._)((0,a._)({},e),{error:t.message});case"setMode":return(0,s._)((0,a._)({},e),{mode:t.mode});default:return e}},aN=function(){var e,t,n,r,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},o=i.onSuccess,u=i.context,d=(0,l._)((0,c.useReducer)(aO,{mode:"phone-input"}),2),f=d[0],p=d[1],h=(0,l._)((e={onError:function(){return p({type:"setError",message:"Something went wrong"})},onCompleted:function(e){"SendSmsVerificationResult"===e.sendSmsVerification.__typename?p({type:"setMode",mode:"code-input"}):p({type:"setError",message:e.sendSmsVerification.message})}},t=(0,a._)({},aA,e),eD.useMutation(aP,t)),2),g=h[0],m=h[1].loading,x=(0,l._)((n={onError:function(){return p({type:"setError",message:"Something went wrong"})},onCompleted:function(e){if("ConfirmSmsVerificationResult"===e.confirmSmsVerification.__typename){null==o||o(),p({type:"setMode",mode:"success"});return}p({type:"setError",message:e.confirmSmsVerification.message})}},r=(0,a._)({},aA,n),eD.useMutation(aD,r)),2),y=x[0],b=x[1].loading;return[(0,s._)((0,a._)({},f),{loading:b||m}),{reset:function(){p({type:"setMode",mode:"phone-input"}),p({type:"setPhoneNumber",phoneNumber:void 0}),p({type:"setCode",code:void 0}),p({type:"setError",message:void 0})},submitCode:function(){if(!b){var e=f.phoneNumber,t=f.code;if(!e)return void p({type:"setError",message:"Phone number is required"});if(!t)return void p({type:"setError",message:"Verification code is required"});p({type:"setError",message:void 0}),y({variables:{input:{phoneNumber:e,code:t,context:u}}})}},submitPhoneNumber:function(){if(!m){var e=f.phoneNumber;if(!e)return void p({type:"setError",message:"Phone number is required"});p({type:"setError",message:void 0}),g({variables:{input:{phoneNumber:e,context:u}}})}},handleCodeChange:function(e){p({type:"setCode",code:e})},handlePhoneNumberChange:function(e){p({type:"setPhoneNumber",phoneNumber:e})}}]},aM=e.i(754873),aL=(0,tA.cssRecord)({mobilePhoneInput:[{".PhoneInput":[e6.rcss.display.flex,e6.rcss.rowWithGap(4),aM.interactive.filledAndOutlined,e6.rcss.px(8),e6.rcss.py(4),e6.rcss.color.foregroundDefault,{".PhoneInputCountry":[e6.rcss.rowWithGap(4),e6.rcss.display.flex,e6.rcss.align.center,e6.rcss.flex.shrink(1),e6.rcss.position.relative,{".PhoneInputCountryIcon":[e6.rcss.width(16),e6.rcss.height(12),{".PhoneInputCountryIconImg":[e6.rcss.display.block,e6.rcss.width("100%"),e6.rcss.height("100%")]}],".PhoneInputCountrySelect":[e6.rcss.position.absolute,e6.rcss.top(0),e6.rcss.left(0),e6.rcss.width("100%"),e6.rcss.height("100%"),{opacity:0,zIndex:1,cursor:"pointer"}],".PhoneInputCountrySelectArrow":[e6.rcss.display.block,e6.rcss.width(8),e6.rcss.height(8),e6.rcss.mx(2),e6.rcss.mb(4),{content:'""',borderStyle:"solid",borderColor:tL.tokens.foregroundDefault,borderTopWidth:0,borderBottomWidth:1,borderLeftWidth:0,borderRightWidth:1,transform:"rotate(45deg)"}]}],".PhoneInputInput":[e6.rcss.flex.grow(1),{appearance:"none",background:"transparent",border:0,"&:focus":{outline:0}}]}]}],resetResendOptions:[e6.rcss.display.inlineBlock],textButton:[e6.rcss.reset.button,e6.rcss.color.accentPrimaryStronger,e6.rcss.focusRing,e6.rcss.borderRadius(4),{":focus":{outlineOffset:"2px"},transitionProperty:"color, box-shadow",transitionDuration:nT.TRANSITIONS.duration,transitionTimingFunction:nT.TRANSITIONS.timingFunction,":not([disabled])":{textDecoration:"underline",cursor:"pointer","@media (hover: hover)":{":hover":{color:tL.tokens.accentPrimaryStrongest}},":not(textarea):active":{color:tL.tokens.accentPrimaryStrongest}}}]}),aB=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=(0,c.useId)();return e?"".concat(e,"-").concat(t):t};let aV=function(e){var t=e.context,n=e.ctas,r=void 0===n?{sendCode:"Send code",confirmCode:"Confirm code"}:n,i=e.onSuccess,o=e.autoFocus,a=(0,l._)(aN({onSuccess:i,context:t}),2),s=a[0],c=a[1],d=aB("sms-verification-phone"),f=aB("sms-verification-phone-error"),p=aB("sms-verification-code"),h=aB("sms-verification-code-error");switch(s.mode){case"phone-input":return(0,u.jsxs)(ta.View,{css:aL.mobilePhoneInput,gap:8,tag:"form",onSubmit:function(e){e.preventDefault(),c.submitPhoneNumber()},children:[(0,u.jsx)(to.Text,{children:"Enter your phone number:"}),(0,u.jsx)(rk.VisuallyHidden,{children:(0,u.jsx)("label",{htmlFor:d,children:"Phone Number"})}),(0,u.jsx)(aE,{id:d,addInternationalOption:!1,countryCallingCodeEditable:!1,defaultCountry:"US",international:!0,value:s.phoneNumber,onChange:c.handlePhoneNumberChange,numberInputProps:{"aria-describedby":f,onKeyDown:function(e){"Enter"===e.key&&c.submitPhoneNumber()},autoFocus:void 0===o||o}}),s.error?(0,u.jsx)(nl.StatusBanner,{id:f,colorway:"warning",text:s.error}):null,(0,u.jsx)(to.Text,{variant:"small",color:"dimmer",children:"Your phone number is only used for account verification."}),(0,u.jsx)(e9.Button,{colorway:"primary",text:r.sendCode,loading:s.loading,type:"submit"})]});case"code-input":return(0,u.jsxs)(ta.View,{gap:8,tag:"form",onSubmit:function(e){e.preventDefault(),c.submitCode()},children:[(0,u.jsxs)(to.Text,{children:["We just sent a verification code to ",s.phoneNumber,". Enter the code below."]}),(0,u.jsx)(rk.VisuallyHidden,{children:(0,u.jsx)("label",{htmlFor:p,children:"code"})}),(0,u.jsx)(tB.Input,{id:p,type:"text",inputMode:"numeric",pattern:"[0-9]*",autoComplete:"one-time-code",value:s.code,onChange:function(e){var t=e.currentTarget.value;return c.handleCodeChange(t)},onKeyDown:function(e){"Enter"===e.key&&c.submitCode()},"aria-describedby":h}),s.error?(0,u.jsx)(nl.StatusBanner,{id:h,colorway:"warning",text:s.error}):null,(0,u.jsxs)(ta.View,{gap:0,children:[(0,u.jsx)(to.Text,{variant:"small",color:"dimmer",multiline:!0,children:"Didn't get the code?"}),(0,u.jsxs)(to.Text,{variant:"small",color:"dimmer",css:aL.resetResendOptions,children:[(0,u.jsx)("button",{disabled:s.loading,css:aL.textButton,onClick:c.submitPhoneNumber,type:"button",children:"Resend the code"})," or ",(0,u.jsx)("button",{disabled:s.loading,css:aL.textButton,onClick:c.reset,type:"button",children:"use a different number"})]})]}),(0,u.jsx)(e9.Button,{text:r.confirmCode,colorway:"primary",loading:s.loading,type:"submit"})]});case"success":return(0,u.jsx)(ta.View,{align:"center",children:(0,u.jsx)(tu.default,{size:24})})}};e.s(["default",0,aV],827305);var aF=e.i(441329);function aU(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{isOrg:!1}).isOrg,t=(0,rp.useRouter)(),n=(0,aF.doesBonsaiWebviewSupportFeature)(t,"stripePayment");return(0,c.useMemo)(function(){return n&&!e?[rg.ReplAuthorizationCode.RequiresUnbanning]:[rg.ReplAuthorizationCode.RequiresUnbanning,rg.ReplAuthorizationCode.RequiresPaymentMethod,rg.ReplAuthorizationCode.PaymentDelinquent,rg.ReplAuthorizationCode.InsufficientBudget]},[n,e])}e.s(["useBonsaiUnsupportedAuthzCodes",()=>aU],292672);var aG=e.i(222342),a$=e.i(845228),az=e.i(418725),aH=e.i(40253),aW=e.i(884151),aq=e.i(765890),aK="DATABASE_URL",aY="PGDATABASE",aQ="PGHOST",aX="PGPORT",aJ="5432",aZ="PGUSER",a0="PGPASSWORD",a1=function(e){var t=e.connectionString,n=e.databaseName,r=new URL(t.replace("postgres://","https://").replace("postgresql://","https://"));return new Map([[aK,t],[aY,n],[aQ,r.host],[aX,aJ],[aZ,r.username],[a0,r.password]])},a2=function(e){(0,e4.track)(e8.events.DATABASE_USED,(0,a._)({type:"PostgreSQL",provider:"neon"},e))},a3=e.i(428596),a4=e.i(107413),a8=e.i(841691),a5=e.i(90102),a6=e.i(877768),a9=function(e){var t=e.envVarKey,n=e.envVarValue,r=e.isSecret,i=(0,a3.useIdSeed)()("db-env-var-".concat(t)),o=(0,l._)((0,c.useState)(!1),2),a=o[0],s=o[1];return(0,u.jsxs)(ta.View,{gap:8,py:8,row:!0,align:"center",children:[(0,u.jsx)("label",{clsx:a6.default.envVarLabel,htmlFor:i,children:t}),(0,u.jsx)(ta.View,{grow:!0,shrink:!0,children:(0,u.jsx)(tB.Input,{id:i,type:!r||a?"text":"password",readOnly:!0,value:n})}),(0,u.jsxs)(ta.View,{align:"center",gap:8,row:!0,children:[(0,u.jsx)(e9.Button,{text:"",iconLeft:(0,u.jsx)(a4.default,{}),onClick:function(){(0,tE.default)(n),a2({action:"envVarCopied",envVarKey:t,envVarType:"value"})}}),r?(0,u.jsx)(e9.Button,{text:"",iconLeft:a?(0,u.jsx)(a5.default,{}):(0,u.jsx)(a8.default,{}),onClick:function(){return s(function(e){return!e})}}):null]})]})},a7=function(e){return(0,c.useCallback)(function(t){return function(e){return(0,eT._)(function(e){var t,n;return(0,Y._)(this,function(r){switch(r.label){case 0:return t=e.secrets,n=a1({connectionString:e.connectionString,databaseName:e.databaseName}),[4,(0,eT._)(function(){var e,r,i,o,a,s,u,c,d,f;return(0,Y._)(this,function(p){switch(p.label){case 0:return[4,t.read()];case 1:e=p.sent(),r=new Map,i=!0,o=!1,a=void 0;try{for(s=n[Symbol.iterator]();!(i=(u=s.next()).done);i=!0)d=(c=(0,l._)(u.value,2))[0],f=c[1],e.get(d)!==f&&r.set(d,f)}catch(e){o=!0,a=e}finally{try{i||null==s.return||s.return()}finally{if(o)throw a}}return r.size>0&&t.addEntries(r),[2]}})})()];case 1:return r.sent(),[2]}})}).apply(this,arguments)}({secrets:e,connectionString:t.connectionString,databaseName:t.databaseName})},[e])},se=function(e){var t=e.database;return"neon"===t.kind?(0,u.jsx)(st,{connectionString:t.connectionString,databaseName:t.databaseName,databaseType:t.type}):(0,u.jsx)(ta.View,{gap:8,children:(0,u.jsx)(a9,{envVarKey:aK,envVarValue:t.connectionString,isSecret:!0})})},st=function(e){var t=e.connectionString,n=e.databaseName,r=e.databaseType,i=(0,g.default)(function(){return a1({connectionString:t,databaseName:n})},[t,n]),o=i.get(aQ),a=i.get(aZ),s=i.get(a0);if("string"!=typeof o||"string"!=typeof a||"string"!=typeof s)throw Error("Expected all envVars to exist");var l=a7((0,nw.default)().secrets);return(0,c.useEffect)(function(){"production"!==r&&l({connectionString:t,databaseName:n})},[r,t,n,l]),(0,u.jsxs)(ta.View,{children:[(0,u.jsx)(a9,{envVarKey:aK,envVarValue:t,isSecret:!0}),(0,u.jsx)(a9,{envVarKey:aY,envVarValue:n}),(0,u.jsx)(a9,{envVarKey:aQ,envVarValue:o}),(0,u.jsx)(a9,{envVarKey:aX,envVarValue:aJ}),(0,u.jsx)(a9,{envVarKey:aZ,envVarValue:a}),(0,u.jsx)(a9,{envVarKey:a0,envVarValue:s,isSecret:!0})]})},sn=e.i(188507),sr=e.i(877212),si=e.i(993796),so=e.i(468095),sa=e.i(783992),ss=e.i(702069),sl=e.i(500736),su=e.i(552144),sc=e.i(899323),sd=e.i(42458),sf=e.i(349248);function sp(e){var t=e.loadingAgentCreate,n=e.loading,r=e.createDatabaseAuthz,i=e.handleOnCreate,o=e.refetchUbbCapabilitiesQueryData,a=e.onShowPaymentMethodForm,s=e.isPaymentMethodFormShown,l=e.onShowSupportForm,c=e.hasOneClickCreation,d=e.replId,f=e.handleAgentCreate,p=(0,rp.useRouter)(),h=(0,aF.isInBonsaiWebview)(p),g=(0,sl.useReplUrl)();(0,aW.default)({onChange:o});var m=aU();if(!r)return(0,u.jsx)(ta.View,{gap:8,align:"center",children:(0,u.jsx)(tu.default,{})});if(!r.isAuthorized&&h&&m.includes(r.code))return(0,u.jsx)(nl.StatusBanner,{text:r.message,colorway:"warning",icon:(0,u.jsx)(sd.default,{}),clsx:sf.default.ctaStatusBanner});switch(r.code){case rg.ReplAuthorizationCode.RequiresPaymentMethodOrSubscription:return(0,u.jsx)(ta.View,{gap:8,align:"center",children:(0,u.jsx)(az.default,{context:"workspace_postgresql_pane",text:"Upgrade your plan to create a database",clsx:sf.default.cta,colorway:"primary",variant:"default",disabled:s,onPlanCheckoutComplete:o,modalHeadingText:"Upgrade your plan to create a database",redirectPath:g})});case rg.ReplAuthorizationCode.RequiresActiveSubscription:return(0,u.jsxs)(ta.View,{gap:8,align:"center",children:[(0,u.jsx)(az.default,{context:"workspace_postgresql_pane",text:"Upgrade your plan to create a database",clsx:sf.default.cta,colorway:"primary",variant:"default",disabled:s,onPlanCheckoutComplete:o,modalHeadingText:"Upgrade your plan to create a database",redirectPath:g}),(0,u.jsx)(e9.Button,{variant:"nofill",colorway:"primary",text:"or add a payment method",clsx:sf.default.cta,disabled:s,loading:n,iconLeft:(0,u.jsx)(sc.default,{}),onClick:a})]});case rg.ReplAuthorizationCode.RequiresSmsVerification:return(0,u.jsx)(aV,{context:rg.SmsVerificationContext.Neon,onSuccess:o});case rg.ReplAuthorizationCode.RequiresPaymentMethod:return(0,u.jsx)(e9.Button,{colorway:"primary",text:"Add a payment method",clsx:sf.default.cta,disabled:s,loading:n,iconLeft:(0,u.jsx)(sc.default,{}),onClick:a});case rg.ReplAuthorizationCode.RequiresUnbanning:return(0,u.jsx)(su.StatusBannerButton,{text:"Your account currently has restrictions on creating a database. We're here to help! Please reach out to support@replit.com for assistance.",colorway:"warning",iconLeft:(0,u.jsx)(sd.default,{}),clsx:sf.default.ctaStatusBanner,onClick:l});case rg.ReplAuthorizationCode.InsufficientBudget:return(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)(nl.StatusBanner,{text:"You've reached your monthly usage budget. Increase your budget to create a database.",colorway:"warning",icon:(0,u.jsx)(sd.default,{}),clsx:sf.default.ctaStatusBanner}),(0,u.jsx)(ss.UsageBudget,{onUpdateSuccess:o,replId:d})]});case rg.ReplAuthorizationCode.PaymentDelinquent:return(0,u.jsx)(aH.PaymentDelinquentButton,{onClick:a});case rg.ReplAuthorizationCode.FeatureDisabled:case rg.ReplAuthorizationCode.FeatureUnsupportedForReplitTeams:case rg.ReplAuthorizationCode.FeatureUnsupportedForTeamsEdu:case rg.ReplAuthorizationCode.FeatureUnsupportedForTeamsFree:case rg.ReplAuthorizationCode.FeatureUnsupportedForTeamsPro:case rg.ReplAuthorizationCode.InsufficientPermissions:case rg.ReplAuthorizationCode.InsufficientQuota:case rg.ReplAuthorizationCode.RequiresActiveTeamsSubscription:case rg.ReplAuthorizationCode.RequiresEmailVerification:return(0,u.jsx)(nl.StatusBanner,{text:r.message,colorway:"warning",icon:(0,u.jsx)(sd.default,{}),clsx:sf.default.ctaStatusBanner});case rg.ReplAuthorizationCode.Authorized:case rg.ReplAuthorizationCode.AuthorizedQuota:return(0,u.jsx)(ta.View,{gap:8,align:"center",children:c?(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)(aq.SendAgentMessageButtonGroup,{className:sf.default.cta,onSendAgentMessage:f,loading:t,disabled:n,buttonText:"Ask ".concat(rb.AGENT_NAME," to set up a database"),menuPrefix:"Ask"}),(0,u.jsx)(e9.Button,{onClick:i,clsx:sf.default.cta,text:n?"":"Create a database manually",iconLeft:n?(0,u.jsx)(tu.default,{}):(0,u.jsx)(u.Fragment,{}),loading:n,disabled:t})]}):(0,u.jsx)(e9.Button,{colorway:"primary",onClick:i,clsx:sf.default.cta,text:n?"":"Create a database",iconLeft:n?(0,u.jsx)(tu.default,{}):(0,u.jsx)(u.Fragment,{}),loading:n})});case rg.ReplAuthorizationCode.RequiresEnterprisePlan:return;default:(0,rw.default)(r.code)}}function sh(e){var t,n,r,i,o,s,d,f,p,h,g,m,x,y,b=e.onShowSupportForm,w=e.onAgentMessageSent,k=(0,l._)((0,c.useState)(!1),2),_=k[0],S=k[1],C=(0,tw.default)(),j=(0,aG.default)().showError,T=(n=(t={openPane:n8().openPane,onAgentMessageSent:w}).openPane,r=t.onAgentMessageSent,i=(0,aG.default)().showError,s=(o=(0,l._)((0,c.useState)(!1),2))[0],d=o[1],f=(0,si.useFlag)({controlName:"agent-empty-state-db-creation"}),p=(0,sr.useSupportsAgent)()&&f,h=(0,c.useCallback)(function(e){d(!1),i("Error creating Agent chat: ".concat((0,R._)(e,Error)?e.message:"Unknown error"))},[i]),g=(0,so.useSendAgentMessage)({openPane:n,onError:h}),m=(0,c.useCallback)(function(e){return(0,eT._)(function(){return(0,Y._)(this,function(t){switch(t.label){case 0:if(!p)return[2];return d(!0),[4,g({kind:"requestFeatureAdd",feature:sn.RequestFeatureAddType.REQUEST_FEATURE_ADD_TYPE_NEON_DATABASE},e)];case 1:return t.sent(),d(!1),r&&r(),[2]}})})()},[p,g,r]),{hasOneClickCreation:p,didStartAgentCreation:s,handleAgentCreate:m}),E=T.didStartAgentCreation,I=T.handleAgentCreate,A=T.hasOneClickCreation,P=(x={notifyOnNetworkStatusChange:!0,variables:{replId:C},onError:function(e){j(e.message)}},y=(0,a._)({},rx,x),eP.useQuery(ry,y)),D=P.loading,O=P.data,N=P.refetch,M=(0,nw.default)(),L=M.psql,B=a7(M.secrets),V=(0,l._)((0,rm.useCreateNeonDatabaseMutation)({refetchQueries:[{query:rh.GetNeonDatabasesDocument,variables:{input:{replId:C}}}],onError:function(e){j("Error when creating Neon database: ".concat(e.message)),a2({action:"created",success:!1})},update:function(e,t){var n=t.data;(null==n?void 0:n.createNeonDatabase.__typename)==="CreateNeonDatabaseResult"&&e.writeQuery({query:rh.GetNeonDatabasesDocument,variables:{input:{replId:C}},data:{__typename:"RootQueryType",getNeonDatabases:{__typename:"GetNeonDatabasesResult",databases:[n.createNeonDatabase.database]}}})},onCompleted:function(e){return(0,eT._)(function(){var t,n;return(0,Y._)(this,function(r){switch(r.label){case 0:if((null==e?void 0:e.createNeonDatabase.__typename)!=="CreateNeonDatabaseResult")return[3,5];if(!(0,sa.isValidNeonDatabase)(e.createNeonDatabase.database))return j("Error: could not create database, please try again"),[2];r.label=1;case 1:return r.trys.push([1,3,,4]),[4,L.ensureNixPsqlModuleInstalled(!0)];case 2:return r.sent(),B({connectionString:(t=e.createNeonDatabase.database).connectionString,databaseName:t.databaseName}),a2({action:"created",success:!0}),[3,4];case 3:return n=r.sent(),j("Error: ".concat(n.message)),[3,4];case 4:return[3,6];case 5:return j("Error: ".concat(null==e?void 0:e.createNeonDatabase.message)),a2({action:"created",success:!1}),[2];case 6:return[2]}})})()}}),2),F=V[0],U=V[1].loading,G=(null==O?void 0:O.getRepl.__typename)==="Repl"?O.getRepl.authorizations.createDatabase:void 0;return(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)(sp,{loadingAgentCreate:E,handleAgentCreate:I,hasOneClickCreation:A,replId:C,loading:D||U,createDatabaseAuthz:G,handleOnCreate:function(){F({variables:{input:{replId:C}}})},refetchUbbCapabilitiesQueryData:N,onShowPaymentMethodForm:function(){return S(!0)},isPaymentMethodFormShown:_,onShowSupportForm:b||function(){}}),(0,u.jsx)(ns.ButtonLink,{href:"https://docs.replit.com/cloud-services/storage-and-databases/postgresql-on-replit",variant:"nofill",target:"_blank",rel:"noopener",iconLeft:(0,u.jsx)(nu.default,{}),text:"Learn more"}),_?(0,u.jsx)(tP.Surface,{elevated:!0,clsx:sf.default.payment,p:16,children:(0,u.jsx)(a$.NewPaymentMethodForm,{onClose:function(){return(0,eT._)(function(){return(0,Y._)(this,function(e){switch(e.label){case 0:return S(!1),[4,N()];case 1:return e.sent(),[2]}})})()},context:"workspace_postgresql_pane"})}):null]})}var sg=e.i(965863),sm=e.i(739521),sv=e.i(604963),sx=e.i(616278),sy=e.i(576073),sb=e.i(579134);function sw(e){return"neon"===e.kind&&"development"===e.type||"helium"===e.kind}function sk(e){return"neon"===e.kind&&"production"===e.type}function s_(e){var t=e.selectedDatabase;return(0,u.jsx)(e9.Button,{size:"default",variant:"nofill",text:"".concat(sw(t)?"Development":"Production"," Database"),iconRight:(0,u.jsx)(sy.default,{size:12})})}function sS(e){var t=e.selectedDatabase,n=e.databases,r=e.onSelect,i=e.setIsCreateDatabaseOpen,o=e.hasDevelopmentDatabase,a=function(e){return sw(e)?"Development":"Production"};return(0,u.jsxs)(te.PopupMenu,{label:a(t),items:n,trigger:(0,u.jsx)(s_,{selectedDatabase:t}),children:[n.map(function(e){return(0,u.jsx)(te.MenuItem,{icon:(0,u.jsx)(sx.default,{visibility:e.databaseId===t.databaseId?"visible":"hidden"}),id:e.databaseId,label:a(e),onAction:function(){r(e)},isDisabled:e.databaseId===t.databaseId},e.databaseId)}),o?null:(0,u.jsx)(te.MenuItem,{icon:(0,u.jsx)(td.default,{}),id:"create-development",label:"Create Development Database",onAction:function(){i(!0)}})]})}function sC(e){var t=e.dismissDatabaseTour;return(0,u.jsxs)(ta.View,{clsx:sb.default.productionDatabaseTourContent,gap:12,p:16,children:[(0,u.jsx)(to.Text,{variant:"subheadDefault",children:"Not sure where your data went? Check your Production database."}),(0,u.jsx)(to.Text,{children:"Replit now uses separate production and development databases to keep your live data safe."}),(0,u.jsxs)(ta.View,{row:!0,align:"center",justify:"end",gap:8,children:[(0,u.jsx)(ns.ButtonLink,{href:"https://docs.replit.com/cloud-services/storage-and-databases/production-databases",target:"_blank",text:"Learn more"}),(0,u.jsx)(e9.Button,{onClick:t,text:"Got it",colorway:"primary"})]})]})}function sj(e){var t=e.onSelect,n=e.selectedDatabase,r=e.databases,i=n8().selectedPage,o=(0,l._)((0,c.useState)(!1),2),a=o[0],s=o[1],d=r.some(sw),f=r.some(sk),p=(0,t_.default)("workspace","workspace-database-pane-toggle-tour"),h=p.shouldDisplay,g=p.register,m=p.dismiss,x=(0,l._)((0,c.useState)(!0),2),y=x[0],b=x[1],w=f&&d&&"db-page"===i&&sw(n),k=(0,sg.useActivePane)(),_=(null==k?void 0:k.type)==="neon";(0,c.useEffect)(function(){w&&g()},[w,g]);var S=w&&h&&y&&_;return(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)(ta.View,{children:S?(0,u.jsxs)(sv.PopoverTrigger,{isOpen:S,onOpenChange:b,label:"Database toggle tour",placement:"bottom",arrow:!0,offset:4,children:[(0,u.jsx)("div",{children:(0,u.jsx)(sS,{selectedDatabase:n,databases:r,onSelect:t,setIsCreateDatabaseOpen:s,hasDevelopmentDatabase:d})}),(0,u.jsx)(sC,{dismissDatabaseTour:m})]}):(0,u.jsx)(sS,{selectedDatabase:n,databases:r,onSelect:t,setIsCreateDatabaseOpen:s,hasDevelopmentDatabase:d})}),(0,u.jsx)(sm.Modal,{fitContent:!0,isOpen:a,onRequestClose:function(){return s(!1)},children:(0,u.jsxs)(tP.Surface,{children:[(0,u.jsx)(to.Header,{level:1,variant:"subheadBig",children:"Create a Database"}),(0,u.jsx)(ta.View,{gap:8,clsx:sb.default.wrapper,children:(0,u.jsx)(sh,{onAgentMessageSent:function(){return s(!1)}})})]})})]})}var sT=e.i(121817),sE=e.i(61313),sR=function(e){var t=e.onSelectDatabase,n=e.selectedDatabase,r=e.databases,i=e.onShowAllDatabases,o=n8(),a=o.selectedPage,s=o.selectedTab,l=n9(),c=l.refreshCurrentContext,d=l.refreshing;return(0,u.jsxs)(ta.View,{justify:"space-between",row:!0,px:8,py:4,align:"center",className:sE.default.selectorBar,children:[(0,u.jsxs)(ta.View,{row:!0,align:"center",children:[(0,u.jsx)(e9.Button,{variant:"nofill",text:"All Databases",onClick:i}),"overview-page"===a?null:(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)(rr.default,{}),(0,u.jsx)(sj,{onSelect:t,selectedDatabase:n,databases:r})]})]}),"drizzle-studio"===s?null:(0,u.jsx)(e9.Button,{iconLeft:d?(0,u.jsx)(tu.default,{}):(0,u.jsx)(sT.default,{}),variant:"nofill",text:"Refresh",size:"small",onClick:c})]})},sI=e.i(412160);function sA(){var e=(0,eI._)(["\n  fragment CurrentUserUsageBasedBillingSummary on CurrentUser {\n    __typename\n    usageBasedBilling {\n      __typename\n      ... on UserUsageBasedBillingSummary {\n        capabilities {\n          canUseUsageBasedBilling\n          explanation\n          hasPaymentMethod\n        }\n      }\n      ... on UnauthorizedError {\n        message\n      }\n      ... on UserError {\n        message\n      }\n      ... on ServiceUnavailable {\n        message\n      }\n    }\n  }\n"]);return sA=function(){return e},e}var sP=(0,eA.gql)(sA());function sD(){var e=(0,eI._)(["\n  query DatabaseFrozen {\n    currentUser {\n      id\n      userSubscriptionType\n      ...CurrentUserUsageBasedBillingSummary\n    }\n  }\n  ","\n"]);return sD=function(){return e},e}var sO={},sN=(0,eA.gql)(sD(),sP),sM=e.i(341126),sL=e.i(199674),sB=e.i(202068);function sV(){var e=(0,eI._)(["\n  fragment DatabaseIsEphemeralReasonUser on CurrentUser {\n    id\n    ...UserPlanStateCurrentUser\n    isMemberOfAnyOrg\n  }\n  ","\n"]);return sV=function(){return e},e}function sF(){var e=(0,eI._)(["\n  query GetDatabaseIsEphemeralReasonUser {\n    currentUser {\n      id\n      ...DatabaseIsEphemeralReasonUser\n    }\n  }\n  ","\n"]);return sF=function(){return e},e}var sU={},sG=(0,eA.gql)(sV(),sB.UserPlanStateCurrentUserFragmentDoc),s$=(0,eA.gql)(sF(),sG),sz=e.i(596139),sH=e.i(530310),sW=e.i(703505),sq=(0,tA.cssRecord)({emphasis:[e6.rcss.fontWeight.medium,e6.rcss.flex.shrink(1)],row:[e6.rcss.rowWithGap(8),e6.rcss.align.center],rowText:[e6.rcss.flex.shrink(1)]});function sK(e){var t=e.title,n=e.isFrozen,r=e.scheduledFreezeTime,i=e.scheduledDeletionTime,o=new Date,a=r?(0,sL.differenceInDays)(new Date(r),o):-1,s=i?(0,sL.differenceInDays)(new Date(i),o):-1;return(0,u.jsxs)(ta.View,{gap:4,children:[(0,u.jsx)(ta.View,{pr:2,row:!0,gap:4,align:"center",justify:"space-between",children:(0,u.jsx)(to.Text,{css:sq.emphasis,children:void 0===t?"Upgrade for a permanent database":t})}),(0,u.jsx)(to.Text,{variant:"small",children:"Databases created on your free Starter plan are temporary."}),(0,u.jsxs)(ta.View,{pt:2,gap:8,children:[n?(0,u.jsxs)(ta.View,{css:sq.row,children:[(0,u.jsx)(sH.default,{size:16}),(0,u.jsx)(to.Text,{css:sq.rowText,variant:"small",children:"Your database has been paused, preventing further edits."})]}):null,!n&&a>-1?(0,u.jsxs)(ta.View,{css:sq.row,children:[(0,u.jsx)(sH.default,{size:16}),(0,u.jsxs)(to.Text,{css:sq.rowText,variant:"small",children:[(0,u.jsxs)("span",{css:sq.emphasis,children:["In ",a," days:"]})," ","Your database will be paused, preventing further edits."]})]}):null,s>-1?(0,u.jsxs)(ta.View,{css:sq.row,children:[(0,u.jsx)(sW.default,{size:16}),(0,u.jsxs)(to.Text,{css:sq.rowText,variant:"small",children:[(0,u.jsxs)("span",{css:sq.emphasis,children:["In ",s," days:"]})," ","Your database will be permanently deleted."]})]}):null]})]})}function sY(e){var t=e.isFrozen,n=e.scheduledFreezeTime,r=e.scheduledDeletionTime,i=(0,sl.useReplUrl)();return!function(){var e,t,n,r=(0,e3.useCurrentUserStoredOrgContext)().orgId,i=(e={},t=(0,a._)({},sU,e),eP.useQuery(s$,t)),o=i.data;if(i.loading)return!1;var s=(null==o||null==(n=o.currentUser)?void 0:n.__typename)==="CurrentUser"?o.currentUser:void 0;return!(null==s?void 0:s.isMemberOfAnyOrg)&&!(null==s?void 0:s.userSubscriptionType)&&void 0===r}()?null:(0,u.jsx)(ta.View,{children:(0,u.jsx)(nl.StatusBanner,{text:(0,u.jsxs)(ta.View,{children:[(0,u.jsx)(sK,{isFrozen:t,scheduledFreezeTime:n,scheduledDeletionTime:r}),(0,u.jsx)(ta.View,{pt:12,pb:4,children:(0,u.jsx)(az.default,{context:"workspace_ephemeral_postgres_database_banner",text:"Upgrade to Replit ".concat(sz.corePlanName),colorway:"brand",variant:"outlined",redirectPath:i})})]})})})}var sQ=e.i(531603),sX=e.i(774792),sJ=(0,tA.cssRecord)({cta:[e6.rcss.width("100%")],ctaStatusBanner:[e6.rcss.textAlign.left]});function sZ(e){var t=e.loading,n=e.ubbExplanation,r=e.hasPaymentMethod,i=e.handleOnUnpause,o=e.refetchUbbCapabilitiesQueryData,a=e.setShowPaymentMethodForm,s=e.showPaymentMethodForm,l=e.setShowSupportForm,c=e.replId,d=(0,aF.useIsInBonsaiWebview)(),f=(0,sl.useReplUrl)(),p=(0,e3.useCurrentUserStoredOrgContext)(),h=p.orgId,g=p.orgRole,m=p.orgSlug;if(void 0!==h)if(g!==rg.SystemOrgGroupType.SystemAdmins)return(0,u.jsx)(nl.StatusBanner,{text:"Your database has been frozen. Please contact your organization admin to address outstanding invoices",colorway:"warning",icon:(0,u.jsx)(sd.default,{}),css:sJ.ctaStatusBanner});else{var x=m?"".concat((0,sM.orgLinks)({slug:m}).settings.href,"/billing"):"#";return(0,u.jsx)(nl.StatusBanner,{text:"Your database has been frozen. Address outstanding invoices to unfreeze it",colorway:"warning",icon:(0,u.jsx)(sd.default,{}),css:sJ.ctaStatusBanner,action:(0,u.jsx)(sI.default,{href:x,children:(0,u.jsx)(e9.Button,{colorway:"warning",text:"View invoices"})})})}return n===rg.UserUsageBasedBillingCapabilitiesExplanation.NeedsSubscription||n===rg.UserUsageBasedBillingCapabilitiesExplanation.NeedsSubscriptionOrPaymentMethod?d?(0,u.jsx)(nl.StatusBanner,{text:"You need a subscription to use PostgreSQL databases. Navigate to Account > Billing to upgrade.",colorway:"warning",icon:(0,u.jsx)(sd.default,{}),css:sJ.ctaStatusBanner}):(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)(az.default,{context:"workspace_postgresql_pane",text:"Upgrade your plan to unpause database",css:sJ.cta,colorway:"primary",variant:"outlined",disabled:s,onPlanCheckoutComplete:o,modalHeadingText:"Upgrade your plan to unpause database",redirectPath:f}),(0,u.jsx)(e9.Button,{variant:"nofill",colorway:"primary",text:"or add a payment method",css:sJ.cta,disabled:s,loading:t,iconLeft:(0,u.jsx)(sX.default,{}),onClick:function(){return a()}})]}):n===rg.UserUsageBasedBillingCapabilitiesExplanation.NeedsSmsVerification?(0,u.jsx)(aV,{context:rg.SmsVerificationContext.Neon,onSuccess:o}):n===rg.UserUsageBasedBillingCapabilitiesExplanation.NeedsPaymentMethod?d?(0,u.jsx)(nl.StatusBanner,{text:"You have used all free usage for this month. Check your email for more information or contact support.",colorway:"warning",icon:(0,u.jsx)(sd.default,{}),css:sJ.ctaStatusBanner}):(0,u.jsx)(e9.Button,{colorway:"primary",text:"Add a payment method",css:sJ.cta,disabled:s,loading:t,iconLeft:(0,u.jsx)(sX.default,{}),onClick:function(){return a()}}):n===rg.UserUsageBasedBillingCapabilitiesExplanation.NeedsUnbanning?(0,u.jsx)(su.StatusBannerButton,{text:"Your account currently has restrictions on use PostgreSQL databases. We're here to help! Please reach out to support@replit.com for assistance.",colorway:"warning",iconLeft:(0,u.jsx)(sd.default,{}),css:sJ.ctaStatusBanner,onClick:function(){return l()}}):n===rg.UserUsageBasedBillingCapabilitiesExplanation.InsufficientBudget?(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)(nl.StatusBanner,{text:"You've reached your monthly usage budget. Increase your budget to unpause your database.",colorway:"warning",icon:(0,u.jsx)(sd.default,{}),css:sJ.ctaStatusBanner}),(0,u.jsx)(ss.UsageBudget,{onUpdateSuccess:o,replId:c})]}):(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)(e9.Button,{colorway:"primary",onClick:i,text:"Unpause database",loading:t,css:sJ.cta}),!1===r?(0,u.jsx)(su.StatusBannerButton,{text:"Add a payment method to avoid downtime",colorway:"warning",iconLeft:(0,u.jsx)(sd.default,{}),css:sJ.ctaStatusBanner,onClick:function(){return d?null:a()}}):null]})}function s0(e){var t=e.neonDatabase,n=e.replId;return t.isEphemeral?(0,u.jsx)(sY,{isFrozen:t.isFrozen,scheduledFreezeTime:t.scheduledFreezeTime,scheduledDeletionTime:t.scheduledDeletionTime}):(0,u.jsx)(s1,{replId:n,neonProjectId:t.projectId})}function s1(e){var t,n,r,i=e.replId,o=e.neonProjectId,d=(0,l._)((0,c.useState)(!1),2),f=d[0],p=d[1],h=(0,l._)((0,c.useState)(!1),2),g=h[0],m=h[1],x=(0,aG.default)().showError,y=(t={notifyOnNetworkStatusChange:!0,onError:function(e){x(e.message)}},n=(0,a._)({},sO,t),eP.useQuery(sN,n)),b=y.loading,w=y.data,k=y.refetch,_=(0,l._)((0,rm.useUnfreezeNeonDatabaseMutation)({refetchQueries:[{query:rh.GetNeonDatabasesDocument,variables:{input:{replId:i}}}],onError:function(e){x("Error when unfreezing Neon database: ".concat(e.message)),a2({action:"unfreeze",success:!1})},update:function(e,t){var n,r=t.data,l=e.readQuery({query:rh.GetNeonDatabasesDocument,variables:{input:{replId:i}}});(null==r?void 0:r.unfreezeNeonDatabase.__typename)==="UnfreezeNeonDatabaseResult"&&(null==l||null==(n=l.getNeonDatabases)?void 0:n.__typename)==="GetNeonDatabasesResult"&&e.writeQuery({query:rh.GetNeonDatabasesDocument,variables:{input:{replId:i}},data:{__typename:"RootQueryType",getNeonDatabases:{__typename:"GetNeonDatabasesResult",databases:l.getNeonDatabases.databases.map(function(e){return e.projectId===o?(0,s._)((0,a._)({},e),{isFrozen:!1}):e})}}})},onCompleted:function(e){if((null==e?void 0:e.unfreezeNeonDatabase.__typename)!=="UnfreezeNeonDatabaseResult"){x("Error: Unfreezes Neon Database failed."),a2({action:"unfreeze",success:!1});return}(null==e?void 0:e.unfreezeNeonDatabase.success)?a2({action:"unfreeze",success:!0}):(x("Error: Unfreezes Neon Database failed."),a2({action:"unfreeze",success:!1}))}}),2),S=_[0],C=_[1].loading,j=(null==w||null==(r=w.currentUser)?void 0:r.usageBasedBilling.__typename)==="UserUsageBasedBillingSummary"?w.currentUser.usageBasedBilling.capabilities:null;return(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)(sm.Modal,{isOpen:g,onRequestClose:function(){return m(!1)},children:(0,u.jsx)(sQ.default,{onRequestClose:function(){return m(!1)}})}),(0,u.jsx)(ta.View,{gap:8,children:(0,u.jsx)(sZ,{replId:i,loading:b||C,ubbExplanation:null==j?void 0:j.explanation,hasPaymentMethod:null==j?void 0:j.hasPaymentMethod,handleOnUnpause:function(){S({variables:{input:{replId:i,neonProjectId:o}}})},refetchUbbCapabilitiesQueryData:k,setShowPaymentMethodForm:function(){return p(!0)},showPaymentMethodForm:f,setShowSupportForm:function(){return m(!0)}})})]})}var s2=e.i(3382),s3=t8.loadingStyle.backgroundPulse(tL.tokens.backgroundHigher,tL.tokens.backgroundHighest);function s4(e){var t=e.database,n=e.replId,r=e.connectionString,i=(0,rn.useGetTables)({connectionString:r}),o=i.tables,a=i.loading;n7("overview-tab",i.refetch);var s="neon"===t.kind&&t.isFrozen;return(0,u.jsx)(u.Fragment,{children:(0,u.jsxs)(ta.View,{gap:8,pt:1,children:[s?(0,u.jsx)(s0,{neonDatabase:t,replId:n}):null,(0,u.jsxs)(ta.View,{gap:8,children:[(0,u.jsx)(to.Text,{variant:"subheadDefault",children:"Tables"}),(0,u.jsx)(s8,{tables:o,tablesLoading:a})]})]})})}var s8=function(e){var t=e.tables,n=e.tablesLoading,r=n8(),i=r.selectTab,o=r.selectSchema,a=r.selectTable;return n?(0,u.jsx)(s5,{}):0===t.length?(0,u.jsx)(to.Text,{children:"You don't have any tables in this database yet."}):(0,u.jsx)(ta.View,{className:s2.default.tableGrid,children:t.map(function(e){return(0,u.jsx)(rs,{name:e.name,storage:"".concat(e.estimatedRows.toString()," rows"),onClick:function(){i("drizzle-studio"),o("public"),a(e.name)}},e.name)})})},s5=function(){return(0,u.jsx)(ta.View,{clsx:[s2.default.tableGrid,s2.default.skeletonDelayed],children:Array.from({length:2}).map(function(e,t){return(0,u.jsxs)(ta.View,{row:!0,align:"center",justify:"space-between",p:12,className:s2.default.skeletonItem,children:[(0,u.jsxs)(ta.View,{row:!0,align:"center",gap:12,children:[(0,u.jsx)(ta.View,{css:s3,className:s2.default.skeletonIcon}),(0,u.jsxs)(ta.View,{gap:4,children:[(0,u.jsx)(ta.View,{css:s3,className:s2.default.skeletonName}),(0,u.jsx)(ta.View,{css:s3,className:s2.default.skeletonStorage})]})]}),(0,u.jsx)(ta.View,{css:s3,className:s2.default.skeletonChevron})]},"skeleton-".concat(t))})})},s6=e.i(344481);function s9(e){var t=e.totalUsageBytes,n=e.maxUsageBytes,r=e.loading;return(0,u.jsxs)(ta.View,{gap:4,children:[(0,u.jsx)(to.Text,{variant:"subheadDefault",children:"Storage Used"}),(0,u.jsx)(ta.View,{pt:8,pb:4,children:(0,u.jsx)(t5.MeasureBar,{current:t,total:n,loading:r,tooltipHidden:!0})}),(0,u.jsxs)(ta.View,{row:!0,align:"center",justify:"space-between",pb:4,children:[(0,u.jsxs)(to.Text,{variant:"small",color:"dimmer",children:["Total usage: ",nW(t)]}),(0,u.jsxs)(to.Text,{variant:"small",color:"dimmer",children:["Max usage: ",nW(n)]})]})]})}var s7=(0,tA.cssRecord)({remove:[e6.rcss.py(8)]}),le=function(e){var t=e.replId,n=e.neonDatabase,r=(0,aG.default)().showError,i=(0,l._)((0,rm.useDeleteNeonDatabaseMutation)({refetchQueries:[{query:rh.GetNeonDatabasesDocument,variables:{input:{replId:t}}}],update:function(e,n,r){var i=n.data,o=r.variables;if(null==i||!i.deleteNeonDatabase||"success"in i.deleteNeonDatabase){var a=e.readQuery({query:rh.GetNeonDatabasesDocument,variables:{input:{replId:t}}});o&&(null==a?void 0:a.getNeonDatabases.__typename)==="GetNeonDatabasesResult"&&e.writeQuery({query:rh.GetNeonDatabasesDocument,variables:{input:{replId:t}},data:{__typename:"RootQueryType",getNeonDatabases:{__typename:"GetNeonDatabasesResult",databases:a.getNeonDatabases.databases.filter(function(e){return e.databaseId!==o.input.databaseId})}}})}}}),2),o=i[0],a=i[1].loading,s=(0,c.useCallback)(function(){p(!0)},[]),u=(0,c.useCallback)(function(){return(0,eT._)(function(){var e,i,a;return(0,Y._)(this,function(s){switch(s.label){case 0:return[4,o({variables:{input:{replId:t,databaseId:n.databaseId}}})];case 1:if(i=(e=s.sent()).data,a=e.errors,p(!1),a&&a.length>0)return r("Error when deleting Neon database: ".concat(null==a?void 0:a.join())),a2({action:"removed",success:!1}),[2];if((null==i?void 0:i.deleteNeonDatabase.__typename)!=="DeleteNeonDatabaseResult")return r("Error: ".concat(null==i?void 0:i.deleteNeonDatabase.message)),a2({action:"removed",success:!1}),[2];return(null==i?void 0:i.deleteNeonDatabase.success)?a2({action:"removed",success:!0}):(r("Error: Delete Neon Database failed."),a2({action:"removed",success:!1})),[2]}})})()},[o,n.databaseId,t,r]),d=(0,l._)((0,c.useState)(!1),2),f=d[0],p=d[1];return{isPendingDelete:f,cancelDelete:(0,c.useCallback)(function(){p(!1)},[]),removeDatabase:u,deleteLoading:a,handleRemoveDatabaseClick:s}},lt=function(e){var t=le({replId:e.replId,neonDatabase:e.neonDatabase}),n=t.isPendingDelete,r=t.cancelDelete,i=t.removeDatabase,o=t.deleteLoading,a=t.handleRemoveDatabaseClick;return(0,u.jsx)(u.Fragment,{children:n||o?(0,u.jsxs)(tP.Surface,{p:8,gap:8,elevated:!0,children:[(0,u.jsx)(to.Text,{children:"Removing this database will permanently destroy all the data."}),(0,u.jsx)(nl.StatusBanner,{icon:(0,u.jsx)(sd.default,{}),colorway:"warning",text:"This action cannot be undone."}),(0,u.jsx)(e9.Button,{text:"Yes, Remove Database",colorway:"negative",disabled:o,iconLeft:(0,u.jsx)(sW.default,{}),onClick:i}),(0,u.jsx)(e9.Button,{autoFocus:!0,text:"Cancel",disabled:o,onClick:r})]}):(0,u.jsx)(e9.Button,{css:s7.remove,text:"Remove Database",disabled:o,iconLeft:(0,u.jsx)(sW.default,{}),onClick:a})})};function ln(e){var t=e.database,n=(0,tw.default)(),r=(0,rn.useGetDatabaseSize)(t),i=r.databaseSize,o=r.loading;return n7("settings-tab",r.refetch),(0,u.jsxs)(ta.View,{gap:12,children:[(0,u.jsxs)(ta.View,{gap:12,children:["neon"===t.kind&&(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)(s6.DatabaseSettingsHistoryRetentionSection,{neonDatabase:t}),(0,u.jsx)(s6.DatabaseSettingsRestoreSection,{neonDatabase:t})]}),(0,u.jsx)(s9,{loading:o,totalUsageBytes:i,maxUsageBytes:t.maxSizeBytes}),(0,u.jsxs)(ta.View,{gap:2,children:[(0,u.jsx)(to.Text,{variant:"subheadDefault",children:"Environment variables"}),(0,u.jsx)(se,{database:t})]})]}),"neon"===t.kind&&(0,u.jsx)(lt,{replId:n,neonDatabase:t})]})}var lr=e.i(788401),li=e.i(161322),lo=(0,p.atom)(!0),la=function(){return(0,li.useSetAtom)(lo)},ls=e.i(927158),ll=(0,e.i(864558).default)(function(){return e.A(279490).then(function(e){return e.DrizzleStudio_DO_NOT_USE_OR_YOU_WILL_BE_FIRED})},{loadableGenerated:{modules:[594244]},ssr:!1}),lu=function(e){var t,n;return{queryFn:null!=(t=(0,ls.usePid2Callback)(function(t){return function(n){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],i=arguments.length>2?arguments[2]:void 0;return(0,eT._)(function(){var o;return(0,Y._)(this,function(a){switch(a.label){case 0:return[4,t.database.rawExecuteQuery.rpc({connectionString:e,sql:n,params:r,options:{mode:null==i?void 0:i.mode}})];case 1:if(!(o=a.sent()).ok){if("UNEXPECTED_DISCONNECT"===o.payload.code||"CANCEL"===o.payload.code)return[2,[]];throw Error(o.payload.message)}return[2,o.payload.rows]}})})()}},[e]))?t:function(){return(0,eT._)(function(){return(0,Y._)(this,function(e){return[2,[]]})})()},transactionFn:null!=(n=(0,ls.usePid2Callback)(function(t){return function(n){return(0,eT._)(function(){var r;return(0,Y._)(this,function(i){switch(i.label){case 0:return[4,t.database.rawExecuteTransaction.rpc({connectionString:e,queries:n})];case 1:if(!(r=i.sent()).ok){if("UNEXPECTED_DISCONNECT"===r.payload.code||"CANCEL"===r.payload.code)return[2,[]];throw Error(r.payload.message)}return[2,r.payload]}})})()}},[e]))?n:function(){return(0,eT._)(function(){return(0,Y._)(this,function(e){return[2,[]]})})()}}};function lc(e){var t=e.connectionString,n=e.databaseId,r=e.selectedSchema,i=e.selectedTable,o=e.readonly,a=lu(t),s=a.queryFn,l=a.transactionFn;return(0,tk.useTrackEffect)(e8.events.DRIZZLE_STUDIO_USED,{action:"opened"}),(0,u.jsx)(ll,{databaseId:"".concat(n.toString(),"-").concat(t),queryFn:s,transactionFn:l,selectedSchema:void 0===r?null:r,selectedTable:void 0===i?null:i,readonly:void 0!==o&&o})}var ld=e.i(112767),lf=e.i(292297),lp=e.i(363201),lh=e.i(67810),lg=function(e){var t=e.selectedDatabase,n=(0,tw.default)(),r=n8(),i=r.selectedTab,o=r.selectTab,a=r.selectedSchema,s=r.selectedTable,l=(0,li.useAtomValue)(lo),c=la(),d="neon"===t.kind?(0,lr.normalizeConnectionString)(t):t.connectionString,f="neon"!==t.kind||"production"!==t.type;return(0,u.jsxs)(ti.Tabs,{className:lh.default.wrapper,onSelectionChange:o,selectedKey:i,children:[(0,u.jsxs)(ti.TabList,{className:lh.default.tabList,withDividers:!1,children:[(0,u.jsx)(ti.Tab,{id:"overview",iconLeft:(0,u.jsx)(lp.default,{}),children:"Overview"}),(0,u.jsx)(ti.Tab,{id:"drizzle-studio",iconLeft:(0,u.jsx)(lf.default,{}),isDisabled:"neon"===t.kind&&t.isFrozen,children:"My Data"}),(0,u.jsx)(ti.Tab,{id:"settings",iconLeft:(0,u.jsx)(tp.default,{}),children:"Settings"})]}),(0,u.jsxs)(ta.View,{className:lh.default.tabPanels,children:[(0,u.jsx)(ti.TabPanel,{id:"overview",className:lh.default.overviewTabPanel,children:(0,u.jsx)(ta.View,{className:lh.default.content,children:(0,u.jsx)(s4,{database:t,replId:n,connectionString:d})})}),(0,u.jsx)(ti.TabPanel,{id:"drizzle-studio",className:lh.default.studioTabPanel,children:(0,u.jsxs)(ta.View,{className:lh.default.content,children:[!f&&(0,u.jsx)(nl.StatusBanner,{text:l?"You're viewing your database in read-only.":"Any changes made here will immediately impact your live application.",variant:"default",colorway:l?void 0:"primary",action:(0,u.jsxs)(ta.View,{row:!0,align:"center",gap:8,children:[(0,u.jsx)(to.Text,{variant:"small",children:"Enable Editing"}),(0,u.jsx)(ld.Switch,{"aria-labelledby":"enable-editing",isSelected:!l,onChange:function(e){c(!e)}})]})}),(0,u.jsx)(lc,{connectionString:d,databaseId:t.databaseId,selectedSchema:a,selectedTable:s,readonly:!f&&l})]})}),(0,u.jsx)(ti.TabPanel,{id:"settings",className:lh.default.settingsTabPanel,children:(0,u.jsx)(ta.View,{className:lh.default.content,children:(0,u.jsx)(ln,{database:t})})})]})]})},lm=function(e){var t,n=e.databases,r=n8(),i=r.selectedPage,o=r.selectPage,a=r.selectedDatabaseId,s=(0,l._)((0,c.useState)(a&&null!=(t=n.find(function(e){return e.databaseId===a}))?t:n[0]),2),d=s[0],f=s[1],p=la();return(0,c.useEffect)(function(){return function(){p(!0)}},[p]),(0,c.useEffect)(function(){n.length>0&&!n.some(function(e){return e.databaseId===d.databaseId})&&f(n[0])},[n,d]),(0,u.jsx)(rt,{children:(0,u.jsxs)(ta.View,{row:!1,style:{height:"100%",overflow:"hidden"},children:[(0,u.jsx)(sR,{onSelectDatabase:f,selectedDatabase:d,databases:n,onShowAllDatabases:function(){o("overview-page")}}),(0,u.jsx)(lv,{selectedPage:i,databases:n,onSelectDatabase:f,selectedDatabase:d})]})})},lv=function(e){var t=e.selectedPage,n=e.databases,r=e.onSelectDatabase,i=e.selectedDatabase;switch(t){case"overview-page":return(0,u.jsx)(rd,{databases:n,onSelectDatabase:r});case"db-page":return(0,u.jsx)(lg,{selectedDatabase:i,onSelectDatabase:r})}},lx=e.i(845822);e.i(947095),e.i(431601);var ly=(0,t4.css)({filter:"drop-shadow(0px 2px 6px rgba(0, 0, 0, 0.15))"});function lb(e){var t=e.height,n=void 0===t?44:t;return(0,u.jsxs)("svg",{width:56*n/44,height:n,viewBox:"0 0 56 44",fill:"none",xmlns:"http://www.w3.org/2000/svg",css:ly,children:[(0,u.jsx)("path",{d:"M7 42.2858L8 32.6684H14L15 42.2858H24L26 27.1837H32L34 42.2858H43L45 21.699H52L55 3.71436H56V43.0001H1V42.2858H7Z",fill:"url(#paint0_linear_3629_241)"}),(0,u.jsx)("path",{d:"M55 3.71436L52 21.699H45L43 42.2858H34L32 27.1837H26L24 42.2858H15L14 32.6684H8L7 42.2858H1",stroke:"#57ABFF",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),(0,u.jsx)("defs",{children:(0,u.jsxs)("linearGradient",{id:"paint0_linear_3629_241",x1:"28.5",y1:"3.71436",x2:"28.5",y2:"43.0001",gradientUnits:"userSpaceOnUse",children:[(0,u.jsx)("stop",{stopColor:"#0079F2"}),(0,u.jsx)("stop",{offset:"0.395833",stopColor:"#0079F2"}),(0,u.jsx)("stop",{offset:"0.958333",stopColor:"#0079F2",stopOpacity:"0"})]})})]})}function lw(){return(0,u.jsxs)("svg",{width:"56",height:"44",viewBox:"0 0 56 44",fill:"none",xmlns:"http://www.w3.org/2000/svg",css:ly,children:[(0,u.jsxs)("g",{clipPath:"url(#clip0_3629_246)",children:[(0,u.jsx)("rect",{x:"0.5",y:"9.5",width:"55",height:"19",rx:"5.5",fill:"#2B3245"}),(0,u.jsx)("g",{filter:"url(#filter0_dii_3629_246)",children:(0,u.jsx)("path",{d:"M3 15C3 13.3431 4.34315 12 6 12H20C20.5523 12 21 12.4477 21 13V25C21 25.5523 20.5523 26 20 26H6C4.34315 26 3 24.6569 3 23V15Z",fill:"#0079F2"})}),(0,u.jsx)("g",{filter:"url(#filter1_dii_3629_246)",children:(0,u.jsx)("rect",{x:"23",y:"12",width:"12",height:"14",rx:"1",fill:"#0079F2"})}),(0,u.jsx)("g",{filter:"url(#filter2_dii_3629_246)",children:(0,u.jsx)("rect",{x:"37",y:"12",width:"8",height:"14",rx:"1",fill:"#0079F2"})}),(0,u.jsx)("rect",{x:"0.5",y:"9.5",width:"55",height:"19",rx:"5.5",stroke:"#3C445C"})]}),(0,u.jsxs)("defs",{children:[(0,u.jsxs)("filter",{id:"filter0_dii_3629_246",x:"-3",y:"6",width:"30",height:"26",filterUnits:"userSpaceOnUse",colorInterpolationFilters:"sRGB",children:[(0,u.jsx)("feFlood",{floodOpacity:"0",result:"BackgroundImageFix"}),(0,u.jsx)("feColorMatrix",{in:"SourceAlpha",type:"matrix",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0",result:"hardAlpha"}),(0,u.jsx)("feOffset",{}),(0,u.jsx)("feGaussianBlur",{stdDeviation:"3"}),(0,u.jsx)("feComposite",{in2:"hardAlpha",operator:"out"}),(0,u.jsx)("feColorMatrix",{type:"matrix",values:"0 0 0 0 0.341176 0 0 0 0 0.670588 0 0 0 0 1 0 0 0 0.5 0"}),(0,u.jsx)("feBlend",{mode:"normal",in2:"BackgroundImageFix",result:"effect1_dropShadow_3629_246"}),(0,u.jsx)("feBlend",{mode:"normal",in:"SourceGraphic",in2:"effect1_dropShadow_3629_246",result:"shape"}),(0,u.jsx)("feColorMatrix",{in:"SourceAlpha",type:"matrix",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0",result:"hardAlpha"}),(0,u.jsx)("feMorphology",{radius:"2",operator:"dilate",in:"SourceAlpha",result:"effect2_innerShadow_3629_246"}),(0,u.jsx)("feOffset",{dy:"-2"}),(0,u.jsx)("feGaussianBlur",{stdDeviation:"1"}),(0,u.jsx)("feComposite",{in2:"hardAlpha",operator:"arithmetic",k2:"-1",k3:"1"}),(0,u.jsx)("feColorMatrix",{type:"matrix",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.1 0"}),(0,u.jsx)("feBlend",{mode:"normal",in2:"shape",result:"effect2_innerShadow_3629_246"}),(0,u.jsx)("feColorMatrix",{in:"SourceAlpha",type:"matrix",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0",result:"hardAlpha"}),(0,u.jsx)("feMorphology",{radius:"2",operator:"dilate",in:"SourceAlpha",result:"effect3_innerShadow_3629_246"}),(0,u.jsx)("feOffset",{dy:"2"}),(0,u.jsx)("feGaussianBlur",{stdDeviation:"1"}),(0,u.jsx)("feComposite",{in2:"hardAlpha",operator:"arithmetic",k2:"-1",k3:"1"}),(0,u.jsx)("feColorMatrix",{type:"matrix",values:"0 0 0 0 1 0 0 0 0 1 0 0 0 0 1 0 0 0 0.1 0"}),(0,u.jsx)("feBlend",{mode:"normal",in2:"effect2_innerShadow_3629_246",result:"effect3_innerShadow_3629_246"})]}),(0,u.jsxs)("filter",{id:"filter1_dii_3629_246",x:"17",y:"6",width:"24",height:"26",filterUnits:"userSpaceOnUse",colorInterpolationFilters:"sRGB",children:[(0,u.jsx)("feFlood",{floodOpacity:"0",result:"BackgroundImageFix"}),(0,u.jsx)("feColorMatrix",{in:"SourceAlpha",type:"matrix",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0",result:"hardAlpha"}),(0,u.jsx)("feOffset",{}),(0,u.jsx)("feGaussianBlur",{stdDeviation:"3"}),(0,u.jsx)("feComposite",{in2:"hardAlpha",operator:"out"}),(0,u.jsx)("feColorMatrix",{type:"matrix",values:"0 0 0 0 0.341176 0 0 0 0 0.670588 0 0 0 0 1 0 0 0 0.5 0"}),(0,u.jsx)("feBlend",{mode:"normal",in2:"BackgroundImageFix",result:"effect1_dropShadow_3629_246"}),(0,u.jsx)("feBlend",{mode:"normal",in:"SourceGraphic",in2:"effect1_dropShadow_3629_246",result:"shape"}),(0,u.jsx)("feColorMatrix",{in:"SourceAlpha",type:"matrix",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0",result:"hardAlpha"}),(0,u.jsx)("feMorphology",{radius:"2",operator:"dilate",in:"SourceAlpha",result:"effect2_innerShadow_3629_246"}),(0,u.jsx)("feOffset",{dy:"-2"}),(0,u.jsx)("feGaussianBlur",{stdDeviation:"1"}),(0,u.jsx)("feComposite",{in2:"hardAlpha",operator:"arithmetic",k2:"-1",k3:"1"}),(0,u.jsx)("feColorMatrix",{type:"matrix",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.1 0"}),(0,u.jsx)("feBlend",{mode:"normal",in2:"shape",result:"effect2_innerShadow_3629_246"}),(0,u.jsx)("feColorMatrix",{in:"SourceAlpha",type:"matrix",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0",result:"hardAlpha"}),(0,u.jsx)("feMorphology",{radius:"2",operator:"dilate",in:"SourceAlpha",result:"effect3_innerShadow_3629_246"}),(0,u.jsx)("feOffset",{dy:"2"}),(0,u.jsx)("feGaussianBlur",{stdDeviation:"1"}),(0,u.jsx)("feComposite",{in2:"hardAlpha",operator:"arithmetic",k2:"-1",k3:"1"}),(0,u.jsx)("feColorMatrix",{type:"matrix",values:"0 0 0 0 1 0 0 0 0 1 0 0 0 0 1 0 0 0 0.1 0"}),(0,u.jsx)("feBlend",{mode:"normal",in2:"effect2_innerShadow_3629_246",result:"effect3_innerShadow_3629_246"})]}),(0,u.jsxs)("filter",{id:"filter2_dii_3629_246",x:"31",y:"6",width:"20",height:"26",filterUnits:"userSpaceOnUse",colorInterpolationFilters:"sRGB",children:[(0,u.jsx)("feFlood",{floodOpacity:"0",result:"BackgroundImageFix"}),(0,u.jsx)("feColorMatrix",{in:"SourceAlpha",type:"matrix",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0",result:"hardAlpha"}),(0,u.jsx)("feOffset",{}),(0,u.jsx)("feGaussianBlur",{stdDeviation:"3"}),(0,u.jsx)("feComposite",{in2:"hardAlpha",operator:"out"}),(0,u.jsx)("feColorMatrix",{type:"matrix",values:"0 0 0 0 0.341176 0 0 0 0 0.670588 0 0 0 0 1 0 0 0 0.5 0"}),(0,u.jsx)("feBlend",{mode:"normal",in2:"BackgroundImageFix",result:"effect1_dropShadow_3629_246"}),(0,u.jsx)("feBlend",{mode:"normal",in:"SourceGraphic",in2:"effect1_dropShadow_3629_246",result:"shape"}),(0,u.jsx)("feColorMatrix",{in:"SourceAlpha",type:"matrix",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0",result:"hardAlpha"}),(0,u.jsx)("feMorphology",{radius:"2",operator:"dilate",in:"SourceAlpha",result:"effect2_innerShadow_3629_246"}),(0,u.jsx)("feOffset",{dy:"-2"}),(0,u.jsx)("feGaussianBlur",{stdDeviation:"1"}),(0,u.jsx)("feComposite",{in2:"hardAlpha",operator:"arithmetic",k2:"-1",k3:"1"}),(0,u.jsx)("feColorMatrix",{type:"matrix",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.1 0"}),(0,u.jsx)("feBlend",{mode:"normal",in2:"shape",result:"effect2_innerShadow_3629_246"}),(0,u.jsx)("feColorMatrix",{in:"SourceAlpha",type:"matrix",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0",result:"hardAlpha"}),(0,u.jsx)("feMorphology",{radius:"2",operator:"dilate",in:"SourceAlpha",result:"effect3_innerShadow_3629_246"}),(0,u.jsx)("feOffset",{dy:"2"}),(0,u.jsx)("feGaussianBlur",{stdDeviation:"1"}),(0,u.jsx)("feComposite",{in2:"hardAlpha",operator:"arithmetic",k2:"-1",k3:"1"}),(0,u.jsx)("feColorMatrix",{type:"matrix",values:"0 0 0 0 1 0 0 0 0 1 0 0 0 0 1 0 0 0 0.1 0"}),(0,u.jsx)("feBlend",{mode:"normal",in2:"effect2_innerShadow_3629_246",result:"effect3_innerShadow_3629_246"})]}),(0,u.jsx)("clipPath",{id:"clip0_3629_246",children:(0,u.jsx)("rect",{width:"56",height:"44",fill:"white"})})]})]})}var lk=e.i(457214),l_=function(){var e=(0,l._)((0,c.useState)(!1),2),t=e[0],n=e[1];return(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)(sm.Modal,{isOpen:t,onRequestClose:function(){return n(!1)},children:(0,u.jsx)(sQ.default,{onRequestClose:function(){return n(!1)}})}),(0,u.jsx)(no.default,{pane:{type:"neon"},maxWidth:450,body:(0,u.jsxs)(ta.View,{gap:16,children:[(0,u.jsxs)(ta.View,{clsx:lk.default.detailsItem,children:[(0,u.jsx)(lw,{}),(0,u.jsx)(to.Text,{clsx:lk.default.detailsText,children:"Add a database to store data related to your application. Save and search your information easily."})]}),(0,u.jsxs)(ta.View,{clsx:lk.default.detailsItem,children:[(0,u.jsx)(lb,{}),(0,u.jsxs)(to.Text,{clsx:lk.default.detailsText,children:["Replit ",sz.corePlanName," members get $",lx.CORE_FLEXIBLE_SPEND_USD," in monthly credits to cover usage costs (",(0,u.jsx)("a",{href:"https://docs.replit.com/cloud-services/about-usage-based-billing#1-postgresql-usage-metrics",target:"_blank",rel:"noopener",children:"see pricing details"}),"). You only pay for what you use."]})]})]}),action:(0,u.jsx)(ta.View,{gap:8,children:(0,u.jsx)(sh,{onShowSupportForm:function(){return n(!0)}})})})]})},lS=function(e){var t=e.databases;return t.length>0?(0,u.jsx)(lm,{databases:t}):(0,u.jsx)(l_,{})};let lC=function(){var e=n8(),t=e.loading,n=e.databases;return t?(0,u.jsx)(no.default,{pane:{type:"neon"},maxWidth:450,loading:!0}):(0,u.jsx)(lS,{databases:n})};var lj=d.Type.Object({type:d.Type.Literal("neon"),data:d.Type.Optional(d.Type.Object({openAtDatabase:n2},{additionalProperties:!0}))}),lT={Content:function(e){var t=e.pane.data,n=e.options;return(0,u.jsx)(n4,{initialOpenAtDatabase:null==t?void 0:t.openAtDatabase,performPaneOperation:n.performPaneOperation,children:(0,u.jsx)(lC,{})})},Icon:function(e){var t=e.size;return(0,u.jsx)(nf.IconContext.Provider,{value:{color:tL.tokens.blueStrongest,size:t},children:(0,u.jsx)(lf.default,{})})},getTitle:function(){return"Database"},description:"Stores structured data such as user profiles, game scores, and product catalogs.",category:ew.PaneCategory.CloudServices,decode:function(e){return f.Value.Decode(lj,e)}};function lE(){var e=(0,eI._)(["\n  fragment ObjectStorageBucket on Bucket {\n    id\n    externalId\n    name\n  }\n"]);return lE=function(){return e},e}function lR(){var e=(0,eI._)(["\n  query ObjectStoragePane(\n    $replId: String!\n    $bucketsAfter: String\n    $bucketsCount: Int\n  ) {\n    currentUser {\n      id\n    }\n    getRepl(id: $replId) {\n      ... on Repl {\n        id\n        org {\n          id\n        }\n        authorizations {\n          createObjectBucket {\n            isAuthorized\n            code\n            message\n          }\n          editObjectBucket {\n            isAuthorized\n            code\n            message\n          }\n        }\n        buckets(after: $bucketsAfter, count: $bucketsCount) {\n          ... on BucketConnection {\n            __typename\n            items {\n              ...ObjectStorageBucket\n            }\n            pageInfo {\n              nextCursor\n            }\n          }\n          ... on UnauthorizedError {\n            __typename\n            message\n          }\n        }\n        defaultBucket {\n          ... on Bucket {\n            ...ObjectStorageBucket\n          }\n          ... on Error {\n            message\n          }\n          ... on NotFoundError {\n            message\n          }\n          ... on UnauthorizedError {\n            message\n          }\n          ... on UserError {\n            message\n          }\n        }\n      }\n    }\n  }\n  ","\n"]);return lR=function(){return e},e}function lI(){var e=(0,eI._)(["\n  mutation ObjectStoragePaneCreateBucket($input: CreateBucketInput!) {\n    createBucket(input: $input) {\n      ... on Bucket {\n        ...ObjectStorageBucket\n      }\n      ... on Error {\n        message\n      }\n      ... on NotFoundError {\n        message\n      }\n      ... on UnauthorizedError {\n        message\n      }\n      ... on UserError {\n        message\n      }\n    }\n  }\n  ","\n"]);return lI=function(){return e},e}e.s(["neonUI",()=>lT],275222);var lA={},lP=(0,eA.gql)(lE()),lD=(0,eA.gql)(lR(),lP),lO=(0,eA.gql)(lI(),lP);function lN(e){var t=(0,a._)({},lA,e);return eD.useMutation(lO,t)}var lM=e.i(255444);function lL(){var e=(0,eI._)(["\n  query CreateBucketName($teamId: Int, $name: String) {\n    bucketName: replTitle(teamId: $teamId, title: $name)\n  }\n"]);return lL=function(){return e},e}var lB={},lV=(0,eA.gql)(lL()),lF=e.i(818503),lU=(0,tA.cssRecord)({createBucketButton:[e6.rcss.flex.growAndShrink(1),e6.rcss.justify.center,e6.rcss.textAlign.center],labeledInput:[e6.rcss.textAlign.left],row:[e6.rcss.flex.growAndShrink(1),e6.rcss.pt(16),e6.rcss.rowWithGap(16),{flexBasis:"300px"}],wrapper:[e6.rcss.flex.wrap]});function lG(e){var t,n,r,i,o,s,d,f,p,h,g,m,x,y,b=e.isOpen,w=e.loading,k=e.handleCreateBucket,_=e.onRequestClose,S=(n=(t={}).preferredName,r=t.teamId,o=(i=(0,l._)((0,c.useState)(""),2))[0],s=i[1],d=(0,c.useRef)(null),f=(0,c.useRef)(!1),m=(p={variables:{name:n,teamId:r},fetchPolicy:"network-only",nextFetchPolicy:"cache-first",ssr:!1},h=(0,a._)({},lB,p),g=eP.useQuery(lV,h)).data,x=g.previousData,y=(null==m?void 0:m.bucketName)||(null==x?void 0:x.bucketName),(0,c.useEffect)(function(){!y||f.current||s(y)},[y]),{name:o,setName:(0,c.useCallback)(function(e){f.current=!0,s(e.slice(0,60))},[]),nameInputRef:d}),C=S.name,j=S.setName,T=S.nameInputRef,E=(0,tw.default)();return(0,u.jsx)(ta.View,{children:(0,u.jsx)(sm.Modal,{fitContent:!0,isOpen:b,onRequestClose:_,children:(0,u.jsxs)(tP.Surface,{children:[(0,u.jsx)(to.Header,{level:1,variant:"subheadBig",children:"Create a Bucket"}),(0,u.jsxs)(ta.View,{css:lU.wrapper,row:!0,children:[(0,u.jsx)(ta.View,{css:lU.row,children:(0,u.jsx)(l$,{name:C,setName:j,nameInputRef:T,disabled:w})}),(0,u.jsx)(ta.View,{css:lU.row,children:(0,u.jsx)(e9.Button,{css:lU.createBucketButton,text:w?"Creating bucket...":"Create bucket",onClick:function(){return k({name:C,replId:E})},colorway:"primary",iconLeft:w?(0,u.jsx)(tu.default,{}):(0,u.jsx)(td.default,{}),disabled:w})})]})]})})})}function l$(e){var t=e.name,n=e.setName,r=e.nameInputRef,i=e.disabled,o=(0,a3.useIdSeed)();return(0,u.jsxs)(ta.View,{css:lU.labeledInput,grow:!0,shrink:!0,gap:8,children:[(0,u.jsx)(lF.Label,{htmlFor:o("bucketName"),children:"Name"}),(0,u.jsx)(tB.Input,{spellCheck:!1,id:o("bucketName"),disabled:i,onChange:function(e){n(e.currentTarget.value)},value:t,ref:r,placeholder:"Name your Bucket"})]})}var lz=e.i(711300),lH=e.i(634203),lW=e.i(35877),lq=e.i(747304);function lK(e,t){var n=(0,lq._)(e,t,"update");if(n.set){if(!n.get)throw TypeError("attempted to read set only private field");return"__destrWrapper"in n||(n.__destrWrapper={set value(v){n.set.call(e,v)},get value(){return n.get.call(e)}}),n.__destrWrapper}if(!n.writable)throw TypeError("attempted to set read only private field");return n}var lY=function e(t){(0,_._)(this,e),(0,C._)(this,"value",void 0),(0,C._)(this,"next",void 0),this.value=t},lQ=new WeakMap,lX=new WeakMap,lJ=new WeakMap,lZ=function(){function e(){(0,_._)(this,e),(0,lH._)(this,lQ,{writable:!0,value:void 0}),(0,lH._)(this,lX,{writable:!0,value:void 0}),(0,lH._)(this,lJ,{writable:!0,value:void 0}),this.clear()}return(0,S._)(e,[{key:"enqueue",value:function(e){var t=new lY(e);(0,lz._)(this,lQ)?(0,lz._)(this,lX).next=t:(0,lW._)(this,lQ,t),(0,lW._)(this,lX,t),lK(this,lJ).value++}},{key:"dequeue",value:function(){var e=(0,lz._)(this,lQ);if(e)return(0,lW._)(this,lQ,(0,lz._)(this,lQ).next),lK(this,lJ).value--,e.value}},{key:"peek",value:function(){if((0,lz._)(this,lQ))return(0,lz._)(this,lQ).value}},{key:"clear",value:function(){(0,lW._)(this,lQ,void 0),(0,lW._)(this,lX,void 0),(0,lW._)(this,lJ,0)}},{key:"size",get:function(){return(0,lz._)(this,lJ)}},{key:Symbol.iterator,value:function(){var e;return(0,Y._)(this,function(t){switch(t.label){case 0:e=(0,lz._)(this,lQ),t.label=1;case 1:if(!e)return[3,3];return[4,e.value];case 2:return t.sent(),e=e.next,[3,1];case 3:return[2]}})}}]),e}();function l0(e){if(!((Number.isInteger(e)||e===1/0)&&e>0))throw TypeError("Expected `concurrency` to be a number from 1 and up")}var l1=e.i(995683),l2=e.i(837399),l3=e.i(386594),l4=d.Type.Object({id:d.Type.String(),name:d.Type.String(),contentType:d.Type.Optional(d.Type.String()),timeCreated:d.Type.String(),size:d.Type.String()}),l8=d.Type.Array(l4),l5="file",l6=((r={})[r.Direct=1]="Direct",r[r.Multipart=2]="Multipart",r);function l9(e){return"".concat(e.status," - ").concat(e.statusText)}function l7(e){return(0,eT._)(function(e){var t,n,r,i;return(0,Y._)(this,function(o){switch(t=e.bucketExternalId,n=e.objectName,r=e.file,void 0===(i=e.uploadMethod)?1:i){case 1:return[2,function(e){return(0,eT._)(function(e){var t,n,r,i,o;return(0,Y._)(this,function(a){switch(a.label){case 0:return t=e.bucketExternalId,n=e.objectName,r=e.file,i=encodeURIComponent(n),[4,fetch("/object-storage/upload/storage/v1/b/".concat(t,"/o?uploadType=media&name=").concat(i),{method:"POST",credentials:"same-origin",headers:{"X-Requested-With":"XMLHttpRequest"},body:r})];case 1:if(!(o=a.sent()).ok)throw Error("Failed to upload object: ".concat(l9(o)));return[2]}})}).apply(this,arguments)}({bucketExternalId:t,objectName:n,file:r})];case 2:return[2,function(e){return(0,eT._)(function(e){var t,n,r,i,o,a,s,l,u,c;return(0,Y._)(this,function(d){switch(d.label){case 0:return t=e.bucketExternalId,n=e.objectName,r=e.file,[4,(0,l3.readFileAsArrayBuffer)(r)];case 1:return i=d.sent(),a=(o=l1.default.from(i)).toBuffer(),s=encodeURIComponent(n),[4,function(e){return(0,eT._)(function(e){var t,n,r,i,o,a;return(0,Y._)(this,function(s){switch(s.label){case 0:return t=e.bucketExternalId,n=e.encodedObjectName,r=e.file,[4,fetch("/object-storage/".concat(t,"/").concat(n,"?uploads"),{method:"POST",credentials:"same-origin",headers:{"Content-Length":"0","Content-Type":r.type,"X-Requested-With":"XMLHttpRequest"}})];case 1:if(!(i=s.sent()).ok)throw Error("Failed to initiate multipart upload: ".concat(l9(i)));return[4,i.text()];case 2:if(o=s.sent(),!(a=new DOMParser().parseFromString(o,"text/xml").getElementsByTagName("UploadId")[0].textContent))throw Error("Failed to initiate multipart upload: missing UploadId");return[2,a]}})}).apply(this,arguments)}({bucketExternalId:t,encodedObjectName:s,file:r})];case 2:var f,p,h,g,m,x,y,b;return l=d.sent(),l0(f=5),p=new lZ,h=0,g=function(){h<f&&p.size>0&&(p.dequeue()(),h++)},m=function(){h--,g()},x=function(e,t,n){return(0,eT._)(function(){var r;return(0,Y._)(this,function(i){switch(i.label){case 0:t(r=(0,eT._)(function(){return(0,Y._)(this,function(t){return[2,e.apply(void 0,(0,U._)(n))]})})()),i.label=1;case 1:return i.trys.push([1,3,,4]),[4,r];case 2:case 3:return i.sent(),[3,4];case 4:return m(),[2]}})})()},y=function(e,t,n){new Promise(function(e){p.enqueue(e)}).then(x.bind(void 0,e,t,n)),(0,eT._)(function(){return(0,Y._)(this,function(e){switch(e.label){case 0:return[4,Promise.resolve()];case 1:return e.sent(),h<f&&g(),[2]}})})()},Object.defineProperties(b=function(e){for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return new Promise(function(t){y(e,t,n)})},{activeCount:{get:function(){return h}},pendingCount:{get:function(){return p.size}},clearQueue:{value:function(){p.clear()}},concurrency:{get:function(){return f},set:function(e){l0(e),f=e,queueMicrotask(function(){for(;h<f&&p.size>0;)g()})}}}),u=b,[4,Promise.all(Array(Math.ceil(o.length/0x2000000)).fill(0).map(function(e,n){var r=a.subarray(0x2000000*n,(n+1)*0x2000000);return u(function(){return function(e){return(0,eT._)(function(e){var t,n,r,i,o,a,s;return(0,Y._)(this,function(l){switch(l.label){case 0:return t=e.bucketExternalId,n=e.encodedObjectName,r=e.partNumber,i=e.uploadId,o=e.chunk,[4,fetch("/object-storage/".concat(t,"/").concat(n,"?partNumber=").concat(r,"&uploadId=").concat(i),{method:"PUT",credentials:"same-origin",headers:{"Content-Length":o.length.toString(),"Content-Type":"text/xml","X-Requested-With":"XMLHttpRequest"},body:o})];case 1:if(!(a=l.sent()).ok)throw Error("Failed to upload chunk: ".concat(l9(a)));if(!(s=a.headers.get("x-upload-etag")))throw Error("Failed to upload chunk: missing x-upload-etag");return[2,{partNumber:r,etag:s}]}})}).apply(this,arguments)}({bucketExternalId:t,encodedObjectName:s,partNumber:n+1,uploadId:l,chunk:r})})}))];case 3:return c=d.sent(),[4,function(e){return(0,eT._)(function(e){var t,n,r,i,o,a,s,l;return(0,Y._)(this,function(u){switch(u.label){case 0:return t=e.bucketExternalId,n=e.encodedObjectName,r=e.uploadId,i=e.parts,a=(o=document.implementation.createDocument("","",null)).createElement("CompleteMultipartUpload"),i.forEach(function(e){var t=o.createElement("Part"),n=o.createElement("PartNumber");n.textContent=e.partNumber.toString(),t.appendChild(n);var r=o.createElement("ETag");r.textContent=e.etag,t.appendChild(r),a.appendChild(t)}),o.appendChild(a),s=new XMLSerializer().serializeToString(o),[4,fetch("/object-storage/".concat(t,"/").concat(n,"?uploadId=").concat(r),{method:"POST",credentials:"same-origin",headers:{"Content-Length":s.length.toString(),"Content-Type":"application/xml","X-Requested-With":"XMLHttpRequest"},body:s})];case 1:if(!(l=u.sent()).ok)throw Error("Failed to complete multipart upload: ".concat(l9(l)));return[2]}})}).apply(this,arguments)}({bucketExternalId:t,encodedObjectName:s,uploadId:l,parts:c})];case 4:return d.sent(),[2]}})}).apply(this,arguments)}({bucketExternalId:t,objectName:n,file:r})]}return[2]})}).apply(this,arguments)}function ue(e){return(0,eT._)(function(e){var t,n,r;return(0,Y._)(this,function(i){switch(i.label){case 0:return t=e.bucketExternalId,n=encodeURIComponent(e.objectName),[4,fetch("/object-storage/storage/v1/b/".concat(t,"/o/").concat(n),{method:"DELETE",credentials:"same-origin",headers:{"X-Requested-With":"XMLHttpRequest"}})];case 1:if(!(r=i.sent()).ok)throw Error("Failed to delete object: ".concat(l9(r)));return[2]}})}).apply(this,arguments)}var ut=e.i(131141),un=e.i(15053),ur=(0,p.atom)(new Map);function ui(e){var t=e.items,n=e.objects,r=new Set(t.map(function(e){return e.name})),i=n.filter(function(e){return!r.has(e.name)});return(0,U._)(t).concat((0,U._)(i))}var uo=(0,p.atom)(null,function(e,t,n){var r=n.bucketExternalId,i=n.objects,o=n.nextPageToken,a=n.isSearch;t(ur,function(e){return(0,ut.produce)(e,function(t){var n,s,l=e.get(r),u=t.get(r);if(!u)return void t.set(r,{items:i,nextPageToken:o,isLoading:!1});var c=ui({items:u.items,objects:i}),d=u.search;if(a){u.search=d={items:ui({items:null!=(s=null==d?void 0:d.items)?s:[],objects:i}),currentPageToken:null==l||null==(n=l.search)?void 0:n.currentPageToken,nextPageToken:o},u.items=c,u.isLoading=!1;return}u.items=c,u.search=void 0,u.currentPageToken=null==l?void 0:l.nextPageToken,u.nextPageToken=o,u.isLoading=!1})})}),ua=(0,p.atom)(null,function(e,t,n){var r=n.bucketExternalId,i=n.isLoading;t(ur,function(e){return(0,ut.produce)(e,function(e){var t=e.get(r);t?t.isLoading=i:e.set(r,{items:[],isLoading:i})})})}),us=(0,p.atom)(null,function(e,t,n){var r=n.bucketExternalId,i=n.name,o=n.contentType,a=n.size,s={id:"optimistic-"+(0,un.v4)(),name:i,contentType:o,size:a,timeCreated:new Date().toISOString(),optimisticallyInserted:!0};t(ur,function(e){return(0,ut.produce)(e,function(e){var t=e.get(r);if(!t)return void e.set(r,{items:[s],isLoading:!1});var n=t.items.find(function(e){return e.name===i});n?Object.assign(n,s):t.items.push(s)})})}),ul=(0,p.atom)(null,function(e,t,n){var r=n.name,i=n.bucketExternalId,o=n.isPendingDeletion,a=n.isOptimisticallyInserted;t(ur,function(e){return(0,ut.produce)(e,function(e){var t=e.get(i);if(!t)throw Error("Bucket not found when updating object");var n=t.items.findIndex(function(e){return e.name===r});if(-1===n)throw Error("Bucket not found when updating object");void 0!==o&&(t.items[n].isPendingDeletion=o),void 0!==a&&(t.items[n].optimisticallyInserted=a)})})}),uu=(0,p.atom)(null,function(e,t,n){var r=n.name,i=n.bucketExternalId;t(ur,function(e){return(0,ut.produce)(e,function(e){var t=e.get(i);if(!t)throw Error("Bucket not found when removing object");var n=t.search;if(n){n.items=n.items.filter(function(e){return e.name!==r});return}e.set(i,{items:t.items.filter(function(e){return e.name!==r}),isLoading:t.isLoading,nextPageToken:t.nextPageToken,search:n})})})}),uc=new Intl.Collator;function ud(e){return e.sort(function(e,t){return uc.compare(e.displayName,t.displayName)})}var uf=[1e3,2500,5e3];function up(){var e=(0,li.useAtomValue)(ur),t=(0,li.useSetAtom)(uo),n=(0,li.useSetAtom)(ua),r=(0,l._)((0,c.useState)(!1),2),i=r[0],o=r[1],a=(0,l._)((0,c.useState)(1e3),2),s=a[0],u=a[1];return{fetchObjects:(0,c.useCallback)(function(r){var i=r.bucketExternalId,a=r.matchGlob,l=r.loadMorePageToken,u=r.isNewBucket,c=r.onError;return(0,eT._)(function(){var r,d,p,h,g;return(0,Y._)(this,function(m){switch(m.label){case 0:if(u)return t({bucketExternalId:i,objects:[],isSearch:a}),[2];o(!0),m.label=1;case 1:return m.trys.push([1,3,4,5]),n({bucketExternalId:i,isLoading:!0}),d=e.get(i),p=a?null==d||null==(r=d.search)?void 0:r.currentPageToken:null==d?void 0:d.currentPageToken,[4,function(e){return(0,eT._)(function(e){var t,n,r,i,o,a,s,l,u,c;return(0,Y._)(this,function(d){switch(d.label){case 0:return t=e.bucketExternalId,n=e.pageToken,i=void 0===(r=e.maxResults)?1e3:r,o=e.matchGlob,a=new URLSearchParams({maxResults:i.toString()}),n&&a.append("pageToken",n),o&&a.append("matchGlob","**".concat(o,"**")),[4,fetch("/object-storage/storage/v1/b/".concat(t,"/o?").concat(a.toString()),{method:"GET",credentials:"same-origin"})];case 1:if(!(s=d.sent()).ok)throw Error("Failed to get objects: ".concat(l9(s)));return[4,s.json()];case 2:if(c=null!=(u=(l=d.sent()).items)?u:[],!f.Value.Check(l8,c))throw(0,l2.validationErrors)(l8,c);return[2,{items:c,nextPageToken:l.nextPageToken}]}})}).apply(this,arguments)}({bucketExternalId:i,pageToken:null!=l?l:p,matchGlob:a,maxResults:s})];case 2:return t({bucketExternalId:i,objects:(h=m.sent()).items,nextPageToken:h.nextPageToken,isSearch:a}),[3,5];case 3:return g=m.sent(),n5.captureException(g,{tags:{bucketExternalId:i,action:"fetchObjects"}}),null==c||c((0,R._)(g,Error)?g:Error("Failed to fetch objects")),[3,5];case 4:return n({bucketExternalId:i,isLoading:!1}),o(!1),[7];case 5:return[2]}})})()},[t,n,e,s]),setMaxResults:u,maxResults:s,loading:i}}function uh(){var e=(0,l._)((0,c.useState)(!1),2),t=e[0],n=e[1],r=(0,li.useSetAtom)(us),i=(0,li.useSetAtom)(uu),o=(0,li.useSetAtom)(ul);return{uploadFiles:function(e){return(0,eT._)(function(e){var t,a,s,l,u;return(0,Y._)(this,function(c){switch(c.label){case 0:t=e.bucketExternalId,a=e.files,s=e.targetFolder,l=e.onError,n(!0),c.label=1;case 1:return c.trys.push([1,3,,4]),[4,Promise.all(a.map(function(e){return(0,eT._)(function(){var n,a;return(0,Y._)(this,function(l){switch(l.label){case 0:n=s+(e.webkitRelativePath||e.dirPath||e.name),r({bucketExternalId:t,name:n,contentType:e.type,size:null==e?void 0:e.size.toString()}),a=e.size>0x1e00000?l6.Multipart:l6.Direct,l.label=1;case 1:return l.trys.push([1,3,,4]),[4,l7({bucketExternalId:t,objectName:n,file:e,uploadMethod:a})];case 2:return l.sent(),o({bucketExternalId:t,name:n,isOptimisticallyInserted:!1}),[3,4];case 3:return l.sent(),i({bucketExternalId:t,name:n}),[3,4];case 4:return[2]}})})()}))];case 2:return c.sent(),[3,4];case 3:return u=c.sent(),null==l||l(u),[3,4];case 4:return n(!1),[2]}})}).apply(this,arguments)},loading:t}}function ug(){var e=(0,eI._)(["\n  query UserBuckets($input: CurrentUserBucketsInput!) {\n    currentUser {\n      id\n      buckets(input: $input) {\n        ... on BucketConnection {\n          __typename\n          items {\n            ...ObjectStorageBucket\n          }\n          pageInfo {\n            hasNextPage\n            nextCursor\n          }\n        }\n      }\n    }\n  }\n  ","\n"]);return ug=function(){return e},e}function um(){var e=(0,eI._)(["\n  query OrgBuckets($orgId: String!, $input: OrgBucketsInput!) {\n    currentUser {\n      id\n      org(orgId: $orgId) {\n        ... on Org {\n          id\n          buckets(input: $input) {\n            ... on BucketConnection {\n              __typename\n              items {\n                ...ObjectStorageBucket\n              }\n              pageInfo {\n                hasNextPage\n                nextCursor\n              }\n            }\n            ... on Error {\n              message\n            }\n          }\n        }\n        ... on Error {\n          message\n        }\n      }\n    }\n  }\n  ","\n"]);return um=function(){return e},e}function uv(){var e=(0,eI._)(["\n  mutation AddReplBucket($input: AddReplBucketInput!) {\n    addReplBucket(input: $input) {\n      __typename\n      ... on Bucket {\n        ...ObjectStorageBucket\n      }\n      ... on NotFoundError {\n        message\n      }\n      ... on UnauthorizedError {\n        message\n      }\n      ... on UserError {\n        message\n      }\n    }\n  }\n  ","\n"]);return uv=function(){return e},e}var ux={},uy=(0,eA.gql)(ug(),lP),ub=(0,eA.gql)(um(),lP),uw=(0,eA.gql)(uv(),lP),uk=e.i(255615),u_=e.i(654647),uS=e.i(178339),uC=e.i(85742),uj=(0,tA.cssRecord)({error:[e6.rcss.color.accentNegativeStronger],button:[e6.rcss.reset.button,e6.rcss.viewStyle,aM.interactive.nofill,e6.rcss.display.inlineFlex,{borderColor:aM.interactive.outlined.borderColor},e6.rcss.flex.growAndShrink(1)],select:[e6.rcss.display.flex,e6.rcss.flex.growAndShrink(1)],selectDisabled:[{backgroundColor:tL.tokens.backgroundHigher}],popover:[e6.rcss.width("max-content"),e6.rcss.overflow("auto"),e6.rcss.p(1),e6.rcss.minWidth(240)],labeledInput:[e6.rcss.minWidth(250)],listbox:[e6.rcss.maxHeight(300),e6.rcss.minWidth(300),e6.rcss.overflow("auto")],dropdownItemAndContainer:[e6.rcss.flex.row,e6.rcss.align.center,aM.interactive.listItem,e6.rcss.px(8),e6.rcss.py(4)],selectedItemAndContainer:[e6.rcss.px(8),e6.rcss.py(4),e6.rcss.justify.spaceBetween,e6.rcss.align.center,e6.rcss.rowWithGap(8)],selectedBucketName:[e6.rcss.align.center,e6.rcss.textAlign.left,e6.rcss.rowWithGap(8)],bucketName:[e6.rcss.textAlign.left,e6.rcss.rowWithGap(8)],loading:[e6.rcss.minWidth(200),e6.rcss.display.flex,e6.rcss.flex.grow(1),t8.loadingStyle.backgroundPulse(tL.tokens.backgroundHighest,tL.tokens.backgroundHigher)]});function uT(e){var t=e.buckets,n=e.error,r=e.loading,i=e.onChange,o=e.onLoadMore,a=e.selectedBucketId,s=(0,c.useId)();return(0,u.jsxs)(ta.View,{grow:!0,shrink:!0,children:[(0,u.jsx)(uP,{buckets:t,loading:r,selectedBucketId:a,onLoadMore:o,onSelectionChange:function(e){"string"==typeof e&&i(e)}}),n?(0,u.jsx)(ta.View,{css:uj.error,"aria-live":"polite","aria-atomic":"true",id:s,children:(0,u.jsx)("span",{children:n})}):null]})}var uE=(0,tA.cssRecord)({self:[uj.dropdownItemAndContainer,e6.rcss.justify.spaceBetween,{backgroundColor:tL.tokens.interactiveBackground}]});function uR(){return(0,u.jsx)(ta.View,{css:uj.selectDisabled,children:(0,u.jsx)(ta.View,{css:uj.selectedItemAndContainer,children:(0,u.jsx)(ta.View,{css:uj.selectedBucketName,children:(0,u.jsx)(to.Text,{color:"dimmer",variant:"text",children:"No buckets available to add"})})})})}function uI(e){var t=e.title;return(0,u.jsxs)(ta.View,{css:uj.selectedItemAndContainer,children:[(0,u.jsx)(ta.View,{css:uj.selectedBucketName,children:(0,u.jsx)(to.Text,{variant:"text",children:t})}),(0,u.jsx)(sy.default,{})]})}function uA(e){var t=e.bucketName,n=e.selected;return(0,u.jsxs)(ta.View,{css:n?uE.self:uj.dropdownItemAndContainer,children:[(0,u.jsx)(ta.View,{css:uj.bucketName,align:"center",children:(0,u.jsx)(to.Text,{variant:"text",color:n?"default":"dimmer",children:t})}),(0,u.jsx)(ta.View,{pl:8,align:"center",row:!0,children:n?(0,u.jsx)(sx.default,{}):null})]})}function uP(e){var t=e.buckets,n=e.loading,r=e.selectedBucketId,i=e.onLoadMore,o=e.onSelectionChange,a=(0,a3.useIdSeed)(),s=(0,c.useMemo)(function(){return t.find(function(e){return e.id===r})},[t,r]);return(0,u.jsxs)(ta.View,{css:uj.labeledInput,grow:!0,shrink:!0,gap:8,children:[(0,u.jsx)(lF.Label,{htmlFor:a("bucket"),children:"Bucket"}),n?(0,u.jsx)(tB.Input,{css:uj.loading,disabled:!0}):(0,u.jsxs)(uS.Select,{css:uj.select,id:a("bucket"),onSelectionChange:o,"aria-label":"Bucket Select",children:[(0,u.jsx)(uk.Button,{css:uj.button,isDisabled:!s,children:s?(0,u.jsx)(uI,{title:s.name}):(0,u.jsx)(uR,{})}),(0,u.jsx)(sv.RawPopover,{css:uj.popover,background:"default",placement:"bottom left",children:(0,u.jsx)(uC.ListBox,{css:uj.listbox,onLoadMore:i,children:t.map(function(e){var t=e.id,n=e.name;return(0,u.jsx)(u_.ListBoxItem,{id:t,textValue:n,children:(0,u.jsx)(uA,{bucketName:n,selected:t===r})},t)})})})]})]})}var uD=(0,tA.cssRecord)({addBucketButton:[e6.rcss.flex.growAndShrink(1),e6.rcss.justify.center,e6.rcss.textAlign.center],row:[e6.rcss.flex.growAndShrink(1),e6.rcss.pt(16),e6.rcss.rowWithGap(16),{flexBasis:"300px"}],wrapper:[e6.rcss.flex.wrap]});function uO(e){var t,n,r,i,o,d,f,p,h,g,m,x,y,b,w,k,_,S,C,j,T,E,R,I,A,P=e.excludeBucketIds,D=e.isOpen,O=e.onBucketAdded,N=e.onError,M=e.onRequestClose,L=e.orgId,B=(0,l._)((0,c.useState)(),2),V=B[0],F=B[1],G=(0,tw.default)(),$=(h=(t={onError:N,orgId:L}).orgId,x=(m=(n={fetchPolicy:"network-only",onError:g=t.onError,skip:void 0!==h,ssr:!1,variables:{input:uN}},r=(0,a._)({},ux,n),eP.useQuery(uy,r))).data,y=m.fetchMore,b=m.loading,w=(0,c.useCallback)(function(){var e,t,n;y({variables:{input:(0,s._)((0,a._)({},uN),{after:null==x||null==(n=x.currentUser)||null==(t=n.buckets)||null==(e=t.pageInfo)?void 0:e.nextCursor})},updateQuery:function(e,t){if(!(null==(o=t.fetchMoreResult)||null==(i=o.currentUser)||null==(r=i.buckets)?void 0:r.items))return e;var n=(0,a._)({},t.fetchMoreResult);if(null==(s=n.currentUser)?void 0:s.buckets){var r,i,o,s,l,u,c,d=null!=(c=null==e||null==(u=e.currentUser)||null==(l=u.buckets)?void 0:l.items)?c:[],f=n.currentUser.buckets.items;n.currentUser.buckets.items=(0,U._)(f).concat((0,U._)(d))}return n}})},[y,x]),_=(k=(i={fetchPolicy:"network-only",onError:g,skip:void 0===h,ssr:!1,variables:{input:uN,orgId:h||""}},o=(0,a._)({},ux,i),eP.useQuery(ub,o))).data,S=k.fetchMore,C=k.loading,T=(null==(j=(null==_||null==(d=_.currentUser)?void 0:d.org.__typename)==="Org"?null==_||null==(f=_.currentUser)?void 0:f.org:void 0)?void 0:j.buckets.__typename)==="BucketConnection"?null==j?void 0:j.buckets:void 0,E=(0,c.useCallback)(function(){S({variables:{input:(0,s._)((0,a._)({},uN),{after:null==T?void 0:T.pageInfo.nextCursor})},updateQuery:function(e,t){var n,r,i=t.fetchMoreResult,o=null==i?void 0:i.currentUser;if((null==o?void 0:o.__typename)!=="CurrentUser")return e;var l=null==i||null==(n=i.currentUser)?void 0:n.org;if((null==l?void 0:l.__typename)!=="Org")return e;var u=l.buckets;if("BucketConnection"!==u.__typename)return e;var c=null==e||null==(r=e.currentUser)?void 0:r.org;if((null==c?void 0:c.__typename)!=="Org")return i;var d=c.buckets;return"BucketConnection"!==d.__typename?i:(0,s._)((0,a._)({},i),{currentUser:(0,s._)((0,a._)({},o),{__typename:"CurrentUser",org:(0,s._)((0,a._)({},l),{__typename:"Org",buckets:(0,s._)((0,a._)({},u),{__typename:"BucketConnection",items:(0,U._)(u.items).concat((0,U._)(d.items))})})})})}})},[S,T]),R=(0,c.useCallback)(function(){h?E():w()},[h,E,w]),{buckets:h?null==T?void 0:T.items:null==x||null==(p=x.currentUser)?void 0:p.buckets.items,fetchMore:R,loading:C||b}),z=$.buckets,H=$.fetchMore,W=$.loading;(0,c.useEffect)(function(){!V&&z&&z.length>1&&F(z[0].id)},[V,z]);var q=(0,c.useMemo)(function(){return z?z.filter(function(e){return!(null!=P?P:[]).includes(e.id)}):[]},[z,P]);(0,c.useEffect)(function(){!V&&q&&q.length>0&&F(q[0].id)},[q,V]);var K=(0,l._)((I={variables:{input:{bucketId:null!=V?V:"",replId:G}}},A=(0,a._)({},ux,I),eD.useMutation(uw,A)),2),Y=K[0],Q=K[1].loading;return(0,u.jsx)(ta.View,{children:(0,u.jsx)(sm.Modal,{fitContent:!0,isOpen:D,onRequestClose:M,children:(0,u.jsxs)(tP.Surface,{children:[(0,u.jsx)(to.Header,{level:1,variant:"subheadBig",children:"Choose a Bucket"}),(0,u.jsxs)(ta.View,{css:uD.wrapper,row:!0,children:[(0,u.jsx)(ta.View,{css:uD.row,children:(0,u.jsx)(uT,{buckets:q,loading:W,onChange:F,onLoadMore:H,selectedBucketId:V})}),(0,u.jsx)(ta.View,{css:uD.row,children:(0,u.jsx)(e9.Button,{css:uD.addBucketButton,text:Q?"Adding Bucket to Repl...":"Add Bucket to Repl",onClick:function(){Y({onCompleted:function(e){var t="Bucket"===e.addReplBucket.__typename?e.addReplBucket:null;t?(O(t,!1),F(void 0)):N(Error("Failed to create bucket"))},onError:N})},colorway:"primary",iconLeft:Q||W?(0,u.jsx)(tu.default,{}):(0,u.jsx)(td.default,{}),disabled:Q||!V})})]})]})})})}var uN={count:10},uM=e.i(119468),uL=e.i(276822),uB=e.i(545453),uV=e.i(595974),uF=e.i(916271),uU=e.i(679668),uG=e.i(762995),u$=e.i(844357),uz=[{icon:(0,u.jsx)(uG.default,{}),title:"JavaScript",value:"js"},{icon:(0,u.jsx)(u$.default,{}),title:"Python",value:"py"},{icon:(0,u.jsx)(nE.default,{}),title:"All other languages",value:"other"}],uH={js:{packagerConfigLanguage:"nodejs",description:(0,u.jsx)(uF.default,{components:{code:function(e){return(0,u.jsx)(uL.default,(0,a._)({language:"json"},e))}},children:"This library supports Bun, Deno, and Node.js. It is not recommended for browser-based applications.\n  \nFor more information, see the [SDK Reference](https://docs.replit.com/cloud-services/storage-and-databases/object-storage/typescript-api-reference/)."}),packageName:"@replit/object-storage",commands:[{label:"Import Object Store Library",code:"const { Client } = require('@replit/object-storage');\nconst client = new Client();\n"},{label:"Download an object as text (i.e. JSON)",code:"const { ok, value: textValue, error } = await client.downloadAsText('file.json');\nif (!ok) {\n    // ... handle error ...\n}\n"},{label:"Download an object as its raw byte representation (i.e. images)",code:"const { ok, value: bytesValue, error } = await client.downloadAsBytes('file.png');\nif (!ok) {\n    // ... handle error ...\n}\n"},{label:"Download an object by streaming the object's contents (i.e. streaming data over an API)",code:"const { ok, value: stream, error } = await client.downloadAsStream('file.json');\nif (!ok) {\n    // ... handle error ...\n}\n"},{label:"Download an object to the filesystem",code:"const { ok, error } = await client.downloadToFilename('file.json', destFilename);\nif (!ok) {\n    // ... handle error ...\n}\n"},{label:"List the objects in the bucket",code:"const { ok, value, error } = await client.list();\nif (!ok) {\n    // ... handle error ...\n}\n"},{label:"Upload an object from text (i.e. JSON)",code:"const { ok, error } = await client.uploadFromText('file.json', data);\nif (!ok) {\n    // ... handle error ...\n}\n"},{label:"Upload an object from its byte representation (i.e. images)",code:"const { ok, error } = await client.uploadFromBytes('file.png', data);\nif (!ok) {\n    // ... handle error ...\n}\n"},{label:"Upload an object from the filesystem",code:"const { ok, error } = await client.uploadFromFilename('file.json', srcFilename);\nif (!ok) {\n    // ... handle error ...\n}\n"},{label:"Upload an object from a stream (i.e. streaming data over an API)",code:"const { ok, error } = await client.uploadFromStream('file.json', stream);\nif (!ok) {\n    // ... handle error ...\n}\n"},{label:"Delete an object from the bucket",code:"const { ok, error } = await client.delete('file.json');\nif (!ok) {\n    // ... handle error ...\n}\n"}]},py:{packagerConfigLanguage:"python3",description:(0,u.jsx)(uF.default,{components:{code:function(e){return(0,u.jsx)(uL.default,(0,a._)({language:"json"},e))}},children:"For more information, see the [SDK Reference](https://docs.replit.com/cloud-services/storage-and-databases/object-storage/python-api-reference/)."}),packageName:"replit-object-storage",commands:[{label:"Import Object Store Library",code:"from replit.object_storage import Client\nclient = Client()"},{label:"Download an object as text (i.e. JSON)",code:'client.download_as_text("file.json")'},{label:"Download an object as its raw byte representation (i.e. images)",code:'client.download_as_bytes("file.png")'},{label:"Download an object to the filesystem",code:'client.download_to_filename("file.json", dest_filename)'},{label:"List the objects in the bucket",code:"client.list()"},{label:"Upload an object from text (i.e. JSON)",code:'client.upload_from_text("file.json", data)'},{label:"Upload an object from its byte representation (i.e. images)",code:'client.upload_from_bytes("file.png", data)'},{label:"Upload an object from the filesystem",code:'client.upload_from_filename("file.json", src_filename)'},{label:"Delete an object from the bucket",code:'client.delete("file.json")'}]},other:{description:(0,u.jsx)(uF.default,{components:{code:function(e){return(0,u.jsx)(uL.default,(0,a._)({language:"json"},e))}},children:'\nYou can use the [Google Cloud client libraries](https://cloud.google.com/storage/docs/reference/libraries#use) to interact with your bucket in any of the supported languages.\n\nIf there isn\'t a client library for your language of choice, you can use the [JSON API](https://cloud.google.com/storage/docs/json_api).\n\nWith both the client libraries and the JSON API, only blob/file/object APIs are authorized.\n\n## Authorization\n\n### Client libraries\n\n1. Create a JSON file with these contents in your project root directory, `google_application_credentials.json`\n\n```\n{\n  "type": "external_account",\n  "audience": "replit",\n  "credential_source": {\n    "url": "http://127.0.0.1:1106/credential"\n  },\n  "token_url": "http://127.0.0.1:1106/token"\n}\n```\n\n2. Set the `GOOGLE_APPLICATION_CREDENTIALS` environment variable to `"google_application_credentials.json"`\n3. Set the `GCLOUD_PROJECT` environment variable to `""`\n\n### JSON API\n\n1. Issue a `POST` request to `http://127.0.0.1:1106/token`\n\n## Bucket Selection\nUsing Google Cloud APIs or libraries directly requires a bucket name parameter to be specified on all requests. This field is interchangeable with your bucket\'s ID within Replit App Storage.\n\nTo get the ID of the default bucket for your App or Deployment, issue a `GET` request to `http://127.0.0.1:1106/object-storage/default-bucket`\n'}),commands:[]}},uW=(0,tA.cssRecord)({statusBanner:[e6.rcss.maxWidth("fit-content")]});function uq(e){var t=e.onError,n=(0,l._)((0,c.useState)("js"),2),r=n[0],i=n[1],o=(0,aG.default)().showConfirm,s=(0,nw.default)().packager,d=(0,uB.usePackagerConfigs)().configs,f=(0,uV.useGetInstalledPackages)(),p=(0,l._)((0,c.useState)(!1),2),h=p[0],g=p[1],m=d.find(function(e){return e.language===uH[r].packagerConfigLanguage}),x=!!(uH[r].packagerConfigLanguage&&uH[r].packageName&&m),y=!!(m&&f(m.id).some(function(e){return e.name===uH[r].packageName})),b=(0,l._)((0,c.useState)(!1),2),w=b[0],k=b[1],_=uz.find(function(e){return e.value===r}),S=w||y;return(0,c.useLayoutEffect)(function(){var e=!0,t=!1,n=void 0;try{for(var r,o=uz[Symbol.iterator]();!(e=(r=o.next()).done);e=!0){var a=function(){var e=r.value;if(uH[e.value].packagerConfigLanguage&&d.find(function(t){return t.language===uH[e.value].packagerConfigLanguage}))return i(e.value),{v:void 0}}();if("object"===(0,uM._)(a))return a.v}}catch(e){t=!0,n=e}finally{try{e||null==o.return||o.return()}finally{if(t)throw n}}i("other")},[]),(0,u.jsxs)(ta.View,{gap:16,children:[(0,u.jsx)(ta.View,{row:!0,gap:0,children:(0,u.jsx)(uU.Select,{"aria-label":"Select programming language",items:uz,selectedItem:_,initialSelectedItem:uz[0],onChange:function(e){k(!1),i(e.value)}})}),uH[r].description?uH[r].description:null,!S&&x?(0,u.jsx)(e9.Button,{onClick:function(){return(0,eT._)(function(){return(0,Y._)(this,function(e){switch(e.label){case 0:if(!x)return t(Error("Package not available for selected language")),[2];return g(!0),[4,s.addPackages([{name:uH[r].packageName}])];case 1:return e.sent()?(o("Installed ".concat(uH[r].packageName," package")),k(!0)):t(Error("Failed to install ".concat(uH[r].packageName," package"))),[2]}})})()},text:"Install ".concat(uH[r].packageName," package"),colorway:"primary",loading:h}):null,_&&S?(0,u.jsx)(nl.StatusBanner,{text:"Package installed",colorway:"positive",css:uW.statusBanner}):null,uH[r].commands.map(function(e){return(0,u.jsxs)(ta.View,{gap:6,children:[(0,u.jsx)(to.Text,{children:e.label}),(0,u.jsx)(uF.default,{components:{code:function(e){return(0,u.jsx)(uL.default,(0,a._)({language:r},e))}},children:"```\n".concat(e.code)})]},e.label)})]})}function uK(){var e=(0,eI._)(["\n  query ObjectStorageReplOrg($replId: String!) {\n    getRepl(id: $replId) {\n      ... on Repl {\n        id\n        org {\n          id\n        }\n      }\n    }\n  }\n"]);return uK=function(){return e},e}var uY={},uQ=(0,eA.gql)(uK()),uX=(0,tA.cssRecord)({ctaStatusBanner:[e6.rcss.textAlign.left],cta:[e6.rcss.width("100%"),e6.rcss.maxWidth(320),{marginLeft:"auto",marginRight:"auto"}],payment:[e6.rcss.borderRadius(12),e6.rcss.textAlign.left,e6.rcss.shadow(2)]});function uJ(e){var t=e.children,n=e.createBucketAuthz,r=e.actionDescription,i=e.refetchAuthzQueryData,o=e.loading,a=e.replId,s=(0,l._)((0,c.useState)(!1),2),d=s[0],f=s[1],p=(0,l._)((0,c.useState)(!1),2),h=p[0],g=p[1];return(0,u.jsxs)(u.Fragment,{children:[(0,u.jsxs)(ta.View,{gap:8,children:[(0,u.jsx)(uZ,{replId:a,mainActionCTA:t,showPaymentMethodForm:d,setShowPaymentMethodForm:function(){return f(!0)},setShowSupportForm:function(){return g(!0)},createBucketAuthz:n,actionDescription:r,refetchAuthzQueryData:i,loading:o}),d?(0,u.jsx)(tP.Surface,{elevated:!0,css:uX.payment,p:16,children:(0,u.jsx)(a$.NewPaymentMethodForm,{onClose:function(){return(0,eT._)(function(){return(0,Y._)(this,function(e){switch(e.label){case 0:return f(!1),[4,i()];case 1:return e.sent(),[2]}})})()},context:"workspace_object_storage_pane"})}):null]}),(0,u.jsx)(sm.Modal,{isOpen:h,onRequestClose:function(){return g(!1)},children:(0,u.jsx)(sQ.default,{onRequestClose:function(){return g(!1)}})})]})}function uZ(e){var t=e.mainActionCTA,n=e.showPaymentMethodForm,r=e.setShowPaymentMethodForm,i=e.setShowSupportForm,o=e.createBucketAuthz,a=e.actionDescription,s=e.refetchAuthzQueryData,l=e.loading,c=e.replId,d=(0,aF.useIsInBonsaiWebview)(),f=(0,sl.useReplUrl)();if(!o)return null;if(!o.isAuthorized&&d)return(0,u.jsx)(nl.StatusBanner,{text:o.message,colorway:"warning",icon:(0,u.jsx)(sd.default,{}),css:uX.ctaStatusBanner});switch(o.code){case rg.ReplAuthorizationCode.RequiresActiveSubscription:return(0,u.jsx)(ta.View,{gap:8,align:"center",children:(0,u.jsx)(az.default,{context:"workspace_object_storage_pane",text:"Upgrade your plan to ".concat(a),css:uX.cta,colorway:"primary",variant:"default",disabled:n,onPlanCheckoutComplete:s,modalHeadingText:"Upgrade your plan to ".concat(a),redirectPath:f})});case rg.ReplAuthorizationCode.RequiresPaymentMethodOrSubscription:return(0,u.jsxs)(ta.View,{gap:8,align:"center",children:[(0,u.jsx)(az.default,{context:"workspace_object_storage_pane",text:"Upgrade your plan to ".concat(a),css:uX.cta,colorway:"primary",variant:"default",disabled:n,onPlanCheckoutComplete:s,modalHeadingText:"Upgrade your plan to ".concat(a),redirectPath:f}),(0,u.jsx)(e9.Button,{variant:"nofill",colorway:"primary",text:"or add a payment method",css:uX.cta,disabled:n,loading:l,iconLeft:(0,u.jsx)(sX.default,{}),onClick:function(){return r()}})]});case rg.ReplAuthorizationCode.RequiresSmsVerification:return(0,u.jsx)(aV,{context:rg.SmsVerificationContext.ObjectStorage,onSuccess:s});case rg.ReplAuthorizationCode.RequiresPaymentMethod:return(0,u.jsx)(e9.Button,{colorway:"primary",text:"Add a payment method",css:uX.cta,disabled:n,loading:l,iconLeft:(0,u.jsx)(sX.default,{}),onClick:function(){return r()}});case rg.ReplAuthorizationCode.RequiresUnbanning:return(0,u.jsx)(su.StatusBannerButton,{text:"Your account is not currently allowed to ".concat(a,". We're here to help! Please reach out to support@replit.com for assistance."),colorway:"warning",iconLeft:(0,u.jsx)(sd.default,{}),css:uX.ctaStatusBanner,onClick:function(){return i()}});case rg.ReplAuthorizationCode.InsufficientBudget:return(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)(nl.StatusBanner,{text:"You've reached your monthly usage budget. Increase your budget to ".concat(a,"."),colorway:"warning",icon:(0,u.jsx)(sd.default,{}),css:uX.ctaStatusBanner}),(0,u.jsx)(ss.UsageBudget,{onUpdateSuccess:s,replId:c})]});case rg.ReplAuthorizationCode.FeatureDisabled:case rg.ReplAuthorizationCode.FeatureUnsupportedForReplitTeams:case rg.ReplAuthorizationCode.FeatureUnsupportedForTeamsEdu:case rg.ReplAuthorizationCode.FeatureUnsupportedForTeamsFree:case rg.ReplAuthorizationCode.FeatureUnsupportedForTeamsPro:case rg.ReplAuthorizationCode.InsufficientPermissions:case rg.ReplAuthorizationCode.InsufficientQuota:case rg.ReplAuthorizationCode.RequiresActiveTeamsSubscription:case rg.ReplAuthorizationCode.PaymentDelinquent:case rg.ReplAuthorizationCode.RequiresEmailVerification:return(0,u.jsx)(nl.StatusBanner,{text:o.message,colorway:"warning",icon:(0,u.jsx)(sd.default,{}),css:uX.ctaStatusBanner});case rg.ReplAuthorizationCode.Authorized:case rg.ReplAuthorizationCode.AuthorizedQuota:return(0,u.jsx)(u.Fragment,{children:t});case rg.ReplAuthorizationCode.RequiresEnterprisePlan:return;default:(0,rw.default)(o.code)}}var u0=e.i(751273),u1=e.i(211397),u2=e.i(793579),u3=[{imageUrl:"/public/images/object-storage/objects-in-bucket.svg",text:"Keep your app's uploads safe and organized. Store photos, videos, and documents in easy-to-use storage 'buckets'.",altText:"An image and a file going into a bucket"},{imageUrl:"/public/images/object-storage/upload-to-cloud.svg",text:"Perfect for apps where people upload files  like photo galleries, portfolios, or forms with attachments.",altText:"Images being uploaded to a cloud"},{imageUrl:"/public/images/object-storage/share-same-bucket.svg",text:"Your files work in both development and production automatically, so what you test is what your users see.",altText:"Development icon and deployment icon sharing a bucket"}],u4=(0,tA.cssRecord)({action:[e6.rcss.width("100%"),e6.rcss.maxWidth(320),e6.rcss.px(32),{marginLeft:"auto",marginRight:"auto"}],rowText:[e6.rcss.flex.growAndShrink(1),e6.rcss.textAlign.left]});function u8(e){var t,n,r,i,o=e.createBucketAuthz,s=e.editBucketAuthz,d=e.refetchAuthzQueryData,f=e.onBucketAdded,p=e.onError,h=e.innerRef,g=(0,l._)((0,c.useState)(!1),2),m=g[0],x=g[1],y=(0,c.useCallback)(function(){return x(!1)},[]),b=(0,c.useCallback)(function(){return x(!0)},[]),w=(0,l._)((0,c.useState)(!1),2),k=w[0],_=w[1],S=(0,c.useCallback)(function(){return _(!1)},[]),C=(0,c.useCallback)(function(){return _(!0)},[]),j=(0,tw.default)(),T=(t={variables:{replId:j}},n=(0,a._)({},uY,t),eP.useQuery(uQ,n)).data,E=(null==T?void 0:T.getRepl.__typename)==="Repl"?null==(r=T.getRepl.org)?void 0:r.id:void 0,R=(0,l._)(lN(),2),I=R[0],A=R[1].loading;return(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)(uO,{isOpen:m,onBucketAdded:f,onError:p,onRequestClose:y,orgId:E}),(0,u.jsx)(lG,{isOpen:k,loading:A,handleCreateBucket:function(e){I({variables:{input:e},onCompleted:function(e){var t="Bucket"===e.createBucket.__typename?e.createBucket:null;t?f(t):p(Error("Failed to create bucket"))},onError:p})},onRequestClose:S}),(0,u.jsx)(no.default,{pane:{type:"objectStorage"},maxWidth:450,body:u3.map(function(e,t){return(0,u.jsxs)(ta.View,{row:!0,gap:16,children:[(0,u.jsx)(ta.View,{children:(0,u.jsx)(u1.default,{src:e.imageUrl,width:44,height:44,alt:e.altText})}),(0,u.jsx)(to.Text,{css:u4.rowText,children:e.text})]},t)}),innerRef:h,action:(0,u.jsxs)(uJ,{replId:j,createBucketAuthz:o,actionDescription:"create a bucket",refetchAuthzQueryData:d,loading:A,children:[(0,u.jsx)(e9.Button,{css:u4.action,text:A?"Creating bucket...":"Create new bucket",onClick:C,colorway:"primary",iconLeft:A?(0,u.jsx)(tu.default,{}):(0,u.jsx)(td.default,{}),disabled:A}),(0,u.jsx)(ta.View,{children:(0,u.jsx)(u0.Tooltip,{isDisabled:null==s?void 0:s.isAuthorized,tooltip:null!=(i=null==s?void 0:s.message)?i:"You are not authorized to edit buckets",delay:"default",placement:"bottom-start",children:(0,u.jsx)(e9.Button,{css:u4.action,text:"Use an existing bucket",onClick:b,iconLeft:(0,u.jsx)(u2.default,{}),disabled:A||!(null==s?void 0:s.isAuthorized)})})})]})})]})}var u5=e.i(274014),u6=e.i(790486),u9=e.i(672963),u7=e.i(822243),ce=e.i(848415),ct=e.i(288148),cn=function(e){var t=e.folderPath,n=e.onDropNativeFiles,r=(0,l._)((0,ce.useDrop)(function(){return{accept:[l5,ct.NativeTypes.FILE],drop:function(e){return"files"in e&&n(e.files),{name:t}},collect:function(e){return{isOver:!!e.isOver()}}}}),2);return{isDraggedOver:r[0].isOver,drop:r[1]}},cr=function(e){var t=e.currentFolder,n=e.onDropNativeFiles,r=(0,l._)((0,ce.useDrop)(function(){return{accept:[ct.NativeTypes.FILE],drop:function(e,t){t.didDrop()||e.dirContent.then(function(e){n(e)})},collect:function(e){return{isOverCurrent:e.isOver({shallow:!0})}}}},[t]),2);return{isOverCurrent:r[0].isOverCurrent,drop:r[1]}},ci=e.i(934226),co=e.i(123850),ca=e.i(272461),cs=e.i(136540),cl=e.i(12034),cu=e.i(257811),cc=e.i(557862),cd=e.i(399063),cf=e.i(757390),cp=e.i(761922),ch=e.i(41803),cg=e.i(243074),cm=e.i(842435),cv=e.i(810975),cx=e.i(658975),cy=e.i(542825),cb="1px dashed ".concat(tL.tokens.accentPrimaryDefault),cw=e6.container.min(500),ck=(0,co.createCssVarTokens)(["bodyOutline","bodyMarginBottom"]),c_=ck.cssVars,cS=ck.styleTokens,cC=(0,tA.cssRecord)({buttons:[(0,C._)({},cw,[e6.rcss.rowWithGap(8)])],tableWrapper:[e6.rcss.borderRadius(4),{outline:cS.bodyOutline,marginBottom:cS.bodyMarginBottom}],tableHeader:[e6.rcss.position.sticky,e6.rcss.top(0),e6.rcss.textAlign.left,e6.rcss.zIndex(1),e6.rcss.backgroundColor.backgroundDefault],tableHeaderMainColumn:[e6.rcss.textAlign.left,e6.rcss.p(4)],footer:[e6.rcss.mb(8),e6.rcss.pt(8),e6.rcss.flex.growAndShrink(1)],loadMoreButton:[e6.rcss.flex.growAndShrink(1)],pageSizeSelect:[e6.rcss.minWidth(75),{borderTopRightRadius:"".concat(tL.tokens.space4," !important"),borderBottomRightRadius:"".concat(tL.tokens.space4," !important")}]});function cj(e){var t,n,r,i,o,d,f,p,h,g,m,x,y,b,w=e.bucketExternalId,k=e.onOpenCommandsTab,_=e.onError,S=(0,l._)((0,c.useState)(""),2),j=S[0],T=S[1],E=(0,li.useAtomValue)(ur).get(w),R=null!=(y=null==E?void 0:E.isLoading)&&y,I=(0,l._)((0,c.useState)(""),2),A=I[0],P=I[1],D=(n=(t={searchQuery:j,bucketState:E,currentFolder:A}).bucketState,r=t.currentFolder,(0,c.useMemo)(function(){if(!n)return{displayedItems:[],nextPageToken:void 0,total:0};var e=n.items,t=n.search,i=n.nextPageToken,o=t?t.items:e,l=t?t.nextPageToken:i,u=t?t.items.length:e.length,c=[],d=new Map,f=!0,p=!1,h=void 0;try{for(var g,m=o[Symbol.iterator]();!(f=(g=m.next()).done);f=!0){var x=g.value;if(x.name.startsWith(r)&&x.name!==r){var y=x.name.slice(r.length);if(!y.includes("/")){c.push((0,s._)((0,a._)({},x),{isFolder:!1,displayName:y}));continue}var b=y.split("/")[0];if(d.get(b)||d.set(b,{isFolder:!0,name:r+b+"/",displayName:b}),x.name===r+b+"/"){var w=d.get(b);if(!w)throw Error("Folder should have been added to map");w.optimisticallyInserted=x.optimisticallyInserted,w.isPendingDeletion=x.isPendingDeletion}}}}catch(e){p=!0,h=e}finally{try{f||null==m.return||m.return()}finally{if(p)throw h}}var k=ud(Array.from(d.values())),_=ud(c);return{displayedItems:(0,U._)(k).concat((0,U._)(_)),nextPageToken:l,total:u}},[n,r])),O=D.displayedItems,N=D.nextPageToken,M=D.total,L=!!N,B=(0,c.useMemo)(function(){return[{accessorKey:"name",header:"Name",size:500},{accessorKey:"added",header:"Added",size:200},{accessorKey:"size",header:"Size",size:200}]},[]),V=(0,u5.useReactTable)({data:O,columns:B,getCoreRowModel:(0,u5.getCoreRowModel)()}),F=V.getRowModel().rows,G=(0,c.useRef)(null),$=(0,u6.useVirtualizer)({count:L?F.length+1:F.length,getScrollElement:function(){return G.current},estimateSize:function(){return 34},overscan:20}),z=up(),H=z.fetchObjects,W=z.maxResults,q=z.setMaxResults,K=(o=(i=(0,l._)((0,c.useState)(!1),2))[0],d=i[1],f=(0,li.useSetAtom)(us),p=(0,li.useSetAtom)(ul),h=(0,li.useSetAtom)(uu),{createFolder:function(e){return(0,eT._)(function(e){var t,n,r,i,o,a,s;return(0,Y._)(this,function(l){switch(l.label){case 0:if(t=e.bucketExternalId,n=e.folderName,r=e.currentFolder,i=e.onError,n.includes("/"))return null==i||i(Error("Folder name cannot contain a forward slash")),[2];d(!0),f({bucketExternalId:t,name:o=r+n+"/",contentType:"text/plain",size:"0"}),a=new File([""],n,{type:"text/plain"}),l.label=1;case 1:return l.trys.push([1,3,,4]),[4,l7({bucketExternalId:t,objectName:o,file:a})];case 2:return l.sent(),p({bucketExternalId:t,name:o,isOptimisticallyInserted:!1}),[3,4];case 3:return s=l.sent(),null==i||i(s),h({bucketExternalId:t,name:o}),[3,4];case 4:return d(!1),[2]}})}).apply(this,arguments)},loading:o}).createFolder,Q=uh().uploadFiles,X=(0,c.useRef)(null),J=(0,c.useRef)(null),Z=(0,l._)((0,c.useState)(!1),2),ee=Z[0],et=Z[1],en=(0,l._)((0,c.useState)(null),2),er=en[0],ei=en[1],eo=cr({currentFolder:A,onDropNativeFiles:function(e){Q({bucketExternalId:w,files:e,targetFolder:A,onError:_})}}),ea=eo.isOverCurrent,es=eo.drop,el=function(e){T(e),""===e&&H({bucketExternalId:w,onError:_})},eu=!(O&&O.length);return(0,u.jsxs)(u.Fragment,{children:[(0,u.jsxs)(ta.View,{grow:!0,shrink:!0,children:[(0,u.jsxs)(ta.View,{css:cC.buttons,gap:8,children:[(0,u.jsxs)(ta.View,{row:!0,gap:8,children:[(0,u.jsx)(e9.Button,{onClick:function(){X.current&&X.current.click()},text:"Upload files",colorway:"primary",iconLeft:(0,u.jsx)(ch.default,{})}),(0,u.jsx)(e9.Button,{onClick:function(){J.current&&J.current.click()},text:"Upload folder",colorway:"primary",iconLeft:(0,u.jsx)(cv.default,{})})]}),(0,u.jsxs)(ta.View,{grow:!0,row:!0,gap:8,justify:"space-between",children:[(0,u.jsx)(e9.Button,{onClick:function(){return et(!0)},text:"Create folder",iconLeft:(0,u.jsx)(cm.default,{})}),(0,u.jsx)(ta.View,{grow:!0,children:(0,u.jsx)(tt.SearchBar,{value:j,onChange:function(e){return el(e.target.value)},onKeyDown:function(e){"Escape"===e.key&&el(""),"Enter"===e.key&&H({bucketExternalId:w,matchGlob:j,onError:_})},onClear:function(){return el("")},disabled:R})}),(0,u.jsx)(e9.Button,{onClick:function(){return H({bucketExternalId:w,matchGlob:j,onError:_})},text:"Refresh",loading:R,iconLeft:(0,u.jsx)(sT.default,{})})]})]}),(0,u.jsxs)(ta.View,{row:!0,gap:8,align:"center",justify:"space-between",children:[(0,u.jsx)(cU,{currentFolder:A,bucketExternalId:w,setCurrentFolder:P,onError:_}),(0,u.jsx)(ta.View,{children:R?(0,u.jsx)(tu.default,{size:12}):(0,u.jsxs)(to.Text,{color:"dimmer",variant:"small",children:[L?"Loaded":"Total"," ",M]})})]}),(0,u.jsx)(ta.View,{innerRef:es,css:cC.tableWrapper,grow:!0,shrink:!0,style:(b={},(0,C._)(b,c_.bodyOutline,(m=(g={isOverCurrent:ea,isEmpty:eu}).isOverCurrent,x=g.isEmpty,m?cb:x?"1px dashed ".concat(tL.tokens.outlineDefault):void 0)),(0,C._)(b,c_.bodyMarginBottom,ea||eu?tL.tokens.space8:void 0),b),children:!eu||ee?(0,u.jsx)("div",{ref:G,className:"container",style:{overflow:"auto",flex:"1 1 auto"},children:(0,u.jsx)("div",{style:{height:"".concat($.getTotalSize(),"px")},children:(0,u.jsxs)("table",{style:{width:"100%"},children:[(0,u.jsx)("thead",{css:cC.tableHeader,children:V.getHeaderGroups().map(function(e){return(0,u.jsx)("tr",{children:e.headers.map(function(e){return(0,u.jsx)("th",{css:cC.tableHeaderMainColumn,colSpan:e.colSpan,style:{width:e.getSize()},children:(0,u5.flexRender)(e.column.columnDef.header,e.getContext())},e.id)})},e.id)})}),(0,u.jsxs)("tbody",{children:[ee?(0,u.jsx)(cz,{onCreateFolder:function(e){et(!1),K({bucketExternalId:w,folderName:e,currentFolder:A,onError:_})},onCanceled:function(){return et(!1)}}):null,$.getVirtualItems().map(function(e,t){if(e.index>F.length-1)return(0,u.jsx)("tr",{style:{height:"".concat(e.size,"px"),transform:"translateY(".concat(e.start-t*e.size,"px)")},children:(0,u.jsx)("td",{colSpan:3,children:(0,u.jsxs)(ca.Group,{css:cC.footer,children:[(0,u.jsx)(e9.Button,{css:cC.loadMoreButton,onClick:function(){return H({bucketExternalId:w,matchGlob:j,loadMorePageToken:N,onError:_})},text:R?"":"Load more",iconLeft:R?(0,u.jsx)(tu.default,{}):void 0,loading:R,disabled:R||!L}),(0,u.jsx)(cl.Select,{css:cC.pageSizeSelect,isDisabled:R||!L,"aria-label":"Select page size",selectedKey:W.toString(),onSelectionChange:function(e){return q(Number(e))},items:uf.map(function(e){return{id:e.toString()}}),children:function(e){return(0,u.jsx)(uC.ListBoxItem,{label:e.id},e.id)}})]})})},e.key.toString());var n=O[e.index];return n?n.isFolder?(0,u.jsx)(cI,{index:t,virtualRow:e,item:n,setCurrentFolder:P,onDeleteClick:ei,bucketExternalId:w,onError:_},n.name):(0,u.jsx)(cA,{index:t,virtualRow:e,item:n,bucketExternalId:w,onDeleteClick:ei,onError:_},n.name):null})]})]})})}):(0,u.jsx)(u.Fragment,{children:R?(0,u.jsx)(ta.View,{align:"center",justify:"center",style:{flex:1},children:(0,u.jsx)(tu.default,{})}):(0,u.jsx)(cK,{onOpenCommandsTab:k})})}),(0,u.jsx)(ci.UploadInputs,{fileUploadInputRef:X,dirUploadInputRef:J,uploadFiles:function(e){return Q({bucketExternalId:w,files:e.files,targetFolder:A,onError:_})}})]}),(0,u.jsx)(cW,{bucketExternalId:w,requestedDeleteItem:er,onRequestClose:function(){return ei(null)},onError:_})]})}var cT=(0,co.createCssVarTokens)(["rowOutline","rowOpacity","rowTextDecoration","rowCursor"]),cE=cT.cssVars,cR=cT.styleTokens;function cI(e){var t,n=e.index,r=e.virtualRow,i=e.item,o=e.bucketExternalId,a=e.setCurrentFolder,s=e.onDeleteClick,l=e.onError,c=uh().uploadFiles,d=(0,aG.default)().showConfirm,f=cn({folderPath:i.name,onDropNativeFiles:function(e){d('Uploading files to "'.concat(i.name,'"')),c({bucketExternalId:o,files:e,targetFolder:i.name,onError:l})}}),p=f.isDraggedOver,h=f.drop;return(0,u.jsx)(cN,{index:n,virtualRow:r,item:i,ref:h,onDeleteClick:function(){return s(i)},icon:(0,u.jsx)(cg.default,{}),timeCreatedCell:"-",sizeCell:"-",style:(t={},(0,C._)(t,cE.rowOutline,p?cb:void 0),(0,C._)(t,cE.rowCursor,"pointer"),t),onClick:function(){return a(i.name)},onKeyDown:function(e){"Enter"===e.key&&a(i.name)}})}function cA(e){var t,n,r,i,o,a,s,d,f,p,h,g=e.index,m=e.virtualRow,x=e.item,y=e.bucketExternalId,b=e.onDeleteClick,w=e.onError,k=encodeURIComponent(x.name),_="/object-storage/storage/v1/b/".concat(y,"/o/").concat(k,"?alt=media"),S=!!(x.optimisticallyInserted||x.isPendingDeletion),j=(n=(t=(0,l._)((0,c.useState)(!1),2))[0],r=t[1],i=(0,li.useSetAtom)(ul),o=(0,li.useSetAtom)(us),a=(0,li.useSetAtom)(uu),{loading:n,moveObject:function(e){return(0,eT._)(function(e){var t,n,s,l,u,c,d;return(0,Y._)(this,function(f){switch(f.label){case 0:t=e.bucketExternalId,n=e.object,s=e.destinationFolder,l=e.onError,u=e.onSuccess,r(!0),c=s+n.name.split("/").pop(),i({bucketExternalId:t,name:n.name,isPendingDeletion:!0}),o({bucketExternalId:t,name:c,contentType:n.contentType,size:n.size}),f.label=1;case 1:return f.trys.push([1,4,,5]),[4,function(e){return(0,eT._)(function(e){var t,n,r,i,o,a,s;return(0,Y._)(this,function(l){switch(l.label){case 0:return t=e.sourceBucketExternalId,n=e.destinationBucketExternalId,r=e.sourceObjectName,i=e.destinationObjectName,o=encodeURIComponent(r),a=encodeURIComponent(i),[4,fetch("/object-storage/storage/v1/b/".concat(t,"/o/").concat(o,"/copyTo/b/").concat(n,"/o/").concat(a),{method:"POST",credentials:"same-origin",headers:{"X-Requested-With":"XMLHttpRequest"}})];case 1:if(!(s=l.sent()).ok)throw Error("Failed to copy object: ".concat(l9(s)));return[2]}})}).apply(this,arguments)}({destinationBucketExternalId:t,sourceBucketExternalId:t,sourceObjectName:n.name,destinationObjectName:c})];case 2:return f.sent(),[4,ue({bucketExternalId:t,objectName:n.name})];case 3:return f.sent(),a({bucketExternalId:t,name:n.name}),i({bucketExternalId:t,name:c,isOptimisticallyInserted:!1}),null==u||u(),[3,5];case 4:return d=f.sent(),null==l||l(d),i({bucketExternalId:t,name:n.name,isPendingDeletion:!1}),a({bucketExternalId:t,name:c}),[3,5];case 5:return r(!1),[2]}})}).apply(this,arguments)}}).moveObject,T=(0,aG.default)().showConfirm,E=(d=(s={item:x,disableDrag:S,onDropOverFolder:function(e){return j({bucketExternalId:y,object:x,destinationFolder:e,onSuccess:function(){T('Moved "'.concat(x.name,'" to "').concat(e,'"'))},onError:w})}}).item,f=s.disableDrag,p=s.onDropOverFolder,{isDragging:(h=(0,l._)((0,u7.useDrag)(function(){return{type:l5,canDrag:!f,item:function(){return{name:d.name,type:l5}},collect:function(e){return{isDragging:!!e.isDragging()}},end:function(e,t){var n=t.getDropResult();n&&n&&p(n.name)}}},[f]),2))[0].isDragging,drag:h[1]}),R=E.isDragging,I=E.drag;return(0,u.jsx)(cN,{index:g,virtualRow:m,item:x,ref:I,onDeleteClick:function(){return b(x)},icon:(0,u.jsx)(cH,{contentType:x.contentType}),timeCreatedCell:(0,u.jsx)(cu.Timestamp,{date:x.timeCreated}),sizeCell:nW(Number(x.size),{isKib:!0,isKibNotation:!0}),style:(0,C._)({},cE.rowOpacity,R?.5:void 0),additionalActionButtons:(0,u.jsx)(u.Fragment,{children:(0,u.jsx)(cs.IconButton,{alt:"Download",css:cD.rowActionButton,children:(0,u.jsx)("a",{download:x.displayName,href:_,css:e6.rcss.color.foregroundDefault,children:(0,u.jsx)(cf.default,{})})})})})}var cP=(0,tA.cssRecord)({row:[e6.rcss.position.relative,e6.rcss.borderRadius(4),{outline:cR.rowOutline,outlineOffset:-1,opacity:cR.rowOpacity,cursor:cR.rowCursor,":hover":{background:"".concat(tL.tokens.backgroundHigher," !important")},":hover #action-buttons":{display:"flex"},":focus":{outline:"2px solid ".concat(tL.tokens.accentPrimaryDefault)}}],text:[e6.rcss.flex.shrink(1)]}),cD=(0,tA.cssRecord)({row:[cP.row],pendingRow:[cP.row,e6.rcss.color.foregroundDimmest],tableData:[e6.rcss.p(4),{":first-of-type":{borderTopLeftRadius:4,borderBottomLeftRadius:4},":last-of-type, :nth-last-of-type(2)":{borderTopRightRadius:4,borderBottomRightRadius:4}}],text:cP.text,strikeThroughText:[cP.text,{textDecoration:"line-through"}],actionButtonTableData:[e6.rcss.position.relative],rowActionButtonGroup:[e6.rcss.position.absolute,e6.rcss.right(0),e6.rcss.top(0),e6.rcss.bottom(0),e6.rcss.rowWithGap(4),e6.rcss.align.center,e6.rcss.backgroundColor.backgroundHigher,{display:"none",borderTopRightRadius:4,borderBottomRightRadius:4}],rowActionButton:[aM.interactive.filled],loadingTableData:[e6.rcss.position.relative],loadingIconWrapper:[e6.rcss.position.absolute,e6.rcss.right(4),e6.rcss.top(0),e6.rcss.bottom(0),e6.rcss.justify.center],loadingIcon:[{borderRadius:"50%"},e6.rcss.backgroundColor.backgroundDefault]}),cO=function(){var e=(0,l._)((0,c.useState)(!1),2),t=e[0],n=e[1],r=(0,l._)((0,c.useState)(null),2),i=r[0],o=r[1];return(0,c.useEffect)(function(){if(null!==i){var e=function(){n(i.offsetWidth<i.scrollWidth||i.offsetHeight<i.scrollHeight)};e();var t=new ResizeObserver(e);return t.observe(i),function(){return t.disconnect()}}},[i]),{attachObserver:o,isOverflowing:t}},cN=(0,c.forwardRef)(function(e,t){var n=e.index,r=e.virtualRow,i=e.item,o=e.onDeleteClick,l=e.icon,c=e.timeCreatedCell,d=e.sizeCell,f=e.style,p=e.onClick,h=e.onKeyDown,g=e.additionalActionButtons,m=i.isPendingDeletion?cD.strikeThroughText:cD.text,x=i.optimisticallyInserted||i.isPendingDeletion,y=cO(),b=y.attachObserver,w=y.isOverflowing;return(0,u.jsxs)("tr",{style:(0,s._)((0,a._)({},f),{height:"".concat(r.size,"px"),transform:"translateY(".concat(r.start-n*r.size,"px)"),background:r.index%2==0?"color-mix(in srgb, ".concat(tL.tokens.backgroundDefault," 60%, ").concat(tL.tokens.backgroundRoot,")"):void 0}),ref:t,tabIndex:0,css:x?cD.pendingRow:cD.row,onClick:p,onKeyDown:h,children:[(0,u.jsx)("td",{css:cD.tableData,children:(0,u.jsx)(u0.Tooltip,{isDisabled:!w,tooltip:i.displayName,children:(0,u.jsxs)(ta.View,{row:!0,gap:8,align:"center",children:[l,(0,u.jsx)(to.Text,{multiline:!0,maxLines:1,css:m,ref:b,children:i.displayName})]})})}),(0,u.jsx)("td",{css:cD.tableData,children:(0,u.jsx)(to.Text,{multiline:!0,maxLines:1,css:m,children:c})}),(0,u.jsx)("td",{css:cD.tableData,children:(0,u.jsx)(to.Text,{multiline:!0,maxLines:1,css:m,children:d})}),x?null:(0,u.jsx)("td",{css:cD.actionButtonTableData,children:(0,u.jsxs)(ta.View,{css:cD.rowActionButtonGroup,px:4,id:"action-buttons",children:[g,(0,u.jsx)(cs.IconButton,{onClick:o,alt:"Delete",css:cD.rowActionButton,children:(0,u.jsx)(sW.default,{color:tL.tokens.accentNegativeDefault})})]})}),x?(0,u.jsx)("td",{css:cD.loadingTableData,children:(0,u.jsx)(ta.View,{css:cD.loadingIconWrapper,children:(0,u.jsx)(tu.default,{css:cD.loadingIcon})})}):null]},i.name)}),cM=(0,co.createCssVarTokens)(["breadcrumbOutline","breadcrumbTextColor"]),cL=cM.cssVars,cB=cM.styleTokens,cV=(0,tA.cssRecord)({breadcrumb:[{color:cB.breadcrumbTextColor,outline:cB.breadcrumbOutline}]}),cF=function(e){var t=e.split("/").filter(function(e){return""!==e}),n=t.map(function(e,n){return{folderName:e,path:t.slice(0,n+1).join("/")+"/"}});return[{folderName:"Objects",path:""}].concat((0,U._)(n))};function cU(e){var t=e.currentFolder,n=e.bucketExternalId,r=e.setCurrentFolder,i=e.onError,o=cF(t);return(0,u.jsx)(ta.View,{pt:12,pb:4,row:!0,gap:2,align:"center",children:o.map(function(e,t){var a=e.folderName,s=e.path,l=t===o.length-1;return(0,u.jsxs)(c.Fragment,{children:[(0,u.jsx)(cG,{folderPath:s,folderName:a,bucketExternalId:n,onClick:function(){return r(s)},isLastBreadcrumb:l,onError:i}),l?null:(0,u.jsx)(to.Text,{color:"dimmest",children:"/"})]},s)})})}function cG(e){var t,n=e.folderPath,r=e.folderName,i=e.bucketExternalId,o=e.onClick,a=e.isLastBreadcrumb,s=e.onError,l=uh().uploadFiles,c=cn({folderPath:n,onDropNativeFiles:function(e){return l({bucketExternalId:i,files:e,targetFolder:n,onError:s})}}),d=c.isDraggedOver,f=c.drop;return(0,u.jsx)(e9.Button,{ref:f,text:r,variant:"nofill",onClick:o,iconLeft:(0,u.jsx)(cg.default,{}),size:"small",disabled:a,style:(t={},(0,C._)(t,cL.breadcrumbTextColor,a?tL.tokens.foregroundDefault:void 0),(0,C._)(t,cL.breadcrumbOutline,d?cb:void 0),t),css:cV.breadcrumb})}var c$=(0,tA.cssRecord)({icon:[e6.rcss.height(24),e6.rcss.width(24),e6.rcss.center]});function cz(e){var t=e.onCreateFolder,n=e.onCanceled,r=(0,l._)((0,c.useState)(""),2),i=r[0],o=r[1],a=(0,u9.default)(n,[]);return(0,u.jsx)("tr",{children:(0,u.jsx)("td",{colSpan:3,children:(0,u.jsxs)(ta.View,{innerRef:a,row:!0,gap:8,align:"center",children:[(0,u.jsx)(ta.View,{css:c$.icon,children:(0,u.jsx)(cg.default,{})}),(0,u.jsx)(tB.Input,{value:i,autoFocus:!0,onChange:function(e){return o(e.target.value)},onKeyDown:function(e){"Enter"===e.key&&(t(i),o("")),"Escape"===e.key&&n()},autoCapitalize:"off",autoComplete:"off",autoCorrect:"off"})]})})})}function cH(e){var t=e.contentType;return t?t.startsWith("image/")?(0,u.jsx)(cx.default,{}):t.startsWith("video/")?(0,u.jsx)(cd.default,{}):t.startsWith("audio/")?(0,u.jsx)(cy.default,{}):(0,u.jsx)(cp.default,{}):(0,u.jsx)(cp.default,{})}function cW(e){var t,n,r,i,o,a,s,d,f,p,h,g=e.bucketExternalId,m=e.requestedDeleteItem,x=e.onRequestClose,y=e.onError,b=(n=(t=(0,l._)((0,c.useState)(!1),2))[0],r=t[1],i=(0,li.useSetAtom)(ul),o=(0,li.useSetAtom)(uu),{loading:n,deleteObject:function(e){return(0,eT._)(function(e){var t,n,a,s;return(0,Y._)(this,function(l){switch(l.label){case 0:t=e.bucketExternalId,n=e.objectName,a=e.onError,r(!0),i({bucketExternalId:t,name:n,isPendingDeletion:!0}),l.label=1;case 1:return l.trys.push([1,3,,4]),[4,ue({bucketExternalId:t,objectName:n})];case 2:return l.sent(),o({bucketExternalId:t,name:n}),[3,4];case 3:return s=l.sent(),null==a||a(s),i({bucketExternalId:t,name:n,isPendingDeletion:!1}),[3,4];case 4:return r(!1),[2]}})}).apply(this,arguments)}}).deleteObject,w=(s=(a=(0,l._)((0,c.useState)(!1),2))[0],d=a[1],f=(0,li.useSetAtom)(ul),p=(0,li.useSetAtom)(uu),h=(0,li.useAtomValue)(ur),{loading:s,deleteFolder:function(e){return(0,eT._)(function(e){var t,n,r,i,o,a,s;return(0,Y._)(this,function(l){switch(l.label){case 0:t=e.bucketExternalId,n=e.folderPath,r=e.onError,d(!0),a=(null!=(o=null==(i=h.get(t))?void 0:i.items)?o:[]).filter(function(e){return e.name.startsWith(n)}),l.label=1;case 1:return l.trys.push([1,3,,4]),[4,Promise.all(a.map(function(e){return(0,eT._)(function(){return(0,Y._)(this,function(n){switch(n.label){case 0:f({bucketExternalId:t,name:e.name,isPendingDeletion:!0}),n.label=1;case 1:return n.trys.push([1,3,,4]),[4,ue({bucketExternalId:t,objectName:e.name})];case 2:return n.sent(),p({bucketExternalId:t,name:e.name}),[3,4];case 3:return n.sent(),f({bucketExternalId:t,name:e.name,isPendingDeletion:!1}),[3,4];case 4:return[2]}})})()}))];case 2:return l.sent(),[3,4];case 3:return s=l.sent(),null==r||r(s),[3,4];case 4:return d(!1),[2]}})}).apply(this,arguments)}}).deleteFolder;return(0,u.jsx)(sm.Modal,{isOpen:!!m,onRequestClose:x,children:m?(0,u.jsx)(cc.default,{name:m.displayName,description:'"'.concat(m.displayName,'" ').concat(m.isFolder?" and all its contents":""),entityType:m.isFolder?"folder":"file",hideModal:x,delete:function(){return(0,eT._)(function(){return(0,Y._)(this,function(e){switch(e.label){case 0:if(!(null==m?void 0:m.isFolder))return[3,2];return[4,w({bucketExternalId:g,folderPath:m.name,onError:y})];case 1:return e.sent(),x(),[2];case 2:if(!m)return[3,4];return[4,b({bucketExternalId:g,objectName:m.name,onError:y})];case 3:e.sent(),x(),e.label=4;case 4:return[2]}})})()}}):null})}var cq=(0,tA.cssRecord)({wrapper:[e6.rcss.center,e6.rcss.colWithGap(16),e6.rcss.flex.grow(1),e6.rcss.justify.center,e6.rcss.borderRadius(4),e6.rcss.mb(8)],textWrapper:[e6.rcss.center,e6.rcss.colWithGap(4)],text:[e6.rcss.center],textButton:[e6.rcss.color.accentPrimaryStronger]});function cK(e){var t=e.onOpenCommandsTab;return(0,u.jsx)(ta.View,{css:cq.wrapper,children:(0,u.jsxs)(ta.View,{css:cq.textWrapper,children:[(0,u.jsx)(to.Text,{variant:"subheadBig",children:"No objects"}),(0,u.jsxs)(ta.View,{css:cq.text,children:[(0,u.jsx)(to.Text,{children:"Drag and drop or click to upload,"}),(0,u.jsxs)(ta.View,{row:!0,gap:4,align:"center",children:[(0,u.jsx)(to.Text,{children:"or"}),(0,u.jsx)(e9.Button,{variant:"underlinedOnHover",colorway:"primary",onClick:t,text:"upload using commands",css:cq.textButton})]})]})]})})}function cY(){var e=(0,eI._)(["\n  mutation ObjectStorageSettingsDeleteBucket($input: DeleteBucketInput!) {\n    deleteBucket(input: $input) {\n      ... on Bucket {\n        id\n      }\n      ... on Error {\n        message\n      }\n      ... on NotFoundError {\n        message\n      }\n      ... on UnauthorizedError {\n        message\n      }\n      ... on UserError {\n        message\n      }\n    }\n  }\n"]);return cY=function(){return e},e}function cQ(){var e=(0,eI._)(["\n  mutation ObjectStorageSettingsRemoveReplBucket(\n    $input: RemoveReplBucketInput!\n  ) {\n    removeReplBucket(input: $input) {\n      __typename\n      ... on Bucket {\n        ...ObjectStorageBucket\n      }\n      ... on NotFoundError {\n        message\n      }\n      ... on UnauthorizedError {\n        message\n      }\n      ... on UserError {\n        message\n      }\n    }\n  }\n  ","\n"]);return cQ=function(){return e},e}var cX={},cJ=(0,eA.gql)(cY()),cZ=(0,eA.gql)(cQ(),lP),c0=e.i(258941),c1=e.i(283110);function c2(e){var t,n,r=e.bucketId,i=e.bucketExternalId,o=e.onSettingsUpdate,s=e.onError,d=(0,tw.default)(),f=(0,l._)((0,c.useState)(!1),2),p=f[0],h=f[1],g=function(){return h(!1)},m=(0,l._)((0,c.useState)(!1),2),x=m[0],y=m[1],b=function(){return y(!1)},w=(0,l._)((t=(0,a._)({},cX,void 0),eD.useMutation(cJ,t)),2),k=w[0],_=w[1].loading,S=(0,l._)((n=(0,a._)({},cX,void 0),eD.useMutation(cZ,n)),2),C=S[0],j=S[1].loading;return(0,u.jsxs)(u.Fragment,{children:[(0,u.jsxs)(ta.View,{gap:32,children:[(0,u.jsx)(ta.View,{gap:12,children:(0,u.jsxs)(ta.View,{gap:6,children:[(0,u.jsx)(to.Text,{variant:"subheadDefault",children:"Bucket ID"}),(0,u.jsx)(uF.default,{children:"```\n".concat(i)})]})}),(0,u.jsxs)(ta.View,{gap:12,children:[(0,u.jsxs)(ta.View,{gap:6,children:[(0,u.jsx)(e9.Button,{text:j?"Removing Bucket from Repl...":"Remove Bucket from Repl",loading:j,css:e6.rcss.color.accentNegativeStronger,onClick:function(){return y(!0)}}),(0,u.jsx)(to.Text,{color:"dimmest",children:"Your Repl will no longer be able to access this bucket. No data will be deleted and you can re-add this bucket at any time."})]}),(0,u.jsxs)(ta.View,{gap:6,children:[(0,u.jsx)(e9.Button,{text:_?"Deleting":"Delete Bucket",loading:_,iconLeft:(0,u.jsx)(sW.default,{color:tL.tokens.accentNegativeStronger}),css:e6.rcss.color.accentNegativeStronger,onClick:function(){return h(!0)}}),(0,u.jsx)(to.Text,{color:"dimmest",children:"You cannot undo this action."})]})]})]}),(0,u.jsx)(sm.Modal,{isOpen:x,onRequestClose:b,children:(0,u.jsx)(c0.default,{prompt:"Remove Bucket?",desc:"This action will revoke this Repl's access to this bucket.",onCancel:b,confirmText:"Remove Bucket",icon:(0,u.jsx)(c1.default,{}),onConfirm:function(){C({variables:{input:{bucketId:r,replId:d}},onError:s,onCompleted:function(e){"Bucket"===e.removeReplBucket.__typename?o({type:"removeBucket",data:{bucketId:r}}):s(Error("Failed to remove bucket: "+e.removeReplBucket.message))}}),b()}})}),(0,u.jsx)(sm.Modal,{isOpen:p,onRequestClose:g,children:(0,u.jsx)(cc.default,{name:"bucket",description:"this bucket and all its contents",entityType:"bucket",hideModal:g,delete:function(){return k({variables:{input:{bucketId:r}},onError:s,onCompleted:function(e){"Bucket"===e.deleteBucket.__typename?o({type:"deleteBucket",data:{bucketId:r}}):s(Error("Failed to delete bucket: "+e.deleteBucket.message))}})}})})]})}var c3=e.i(988676),c4=e.i(788124),c8=e.i(797706),c5=[{icon:(0,u.jsx)(c8.default,{}),title:"Objects",value:"objects"},{icon:(0,u.jsx)(nE.default,{}),title:"Commands",value:"commands"},{icon:(0,u.jsx)(tp.default,{}),title:"Settings",value:"settings"}],c6=(0,tA.cssRecord)({controlSeparator:[e6.rcss.color.outlineDefault,e6.rcss.px(8)],panels:[e6.rcss.flex.column,e6.rcss.px(8),e6.rcss.pt(12),e6.rcss.flex.growAndShrink(1)],objectTabPanel:[e6.rcss.flex.column,e6.rcss.flex.growAndShrink(1)]}),c9=function(){var e,t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=n.onError,i=n.onCompleted,o=(0,tw.default)(),s=(0,c.useCallback)(function(e){if((null==e?void 0:e.getRepl.__typename)==="Repl")try{return function(e){if("Repl"!==e.__typename)throw Error("Failed to fetch bucket data");var t,n=e.buckets;if(n&&"BucketConnection"!==n.__typename)throw Error(n.message);var r=null!=(t=null==n?void 0:n.items)?t:[];if(!r.length)return{buckets:r};var i=e.defaultBucket;if(i)if("Bucket"===i.__typename)return{initialBucket:i,buckets:r};else throw Error(i.message);return{initialBucket:r[0],buckets:r}}(e.getRepl)}catch(e){null==r||r(e)}},[]),u=(e={variables:{replId:o,bucketsCount:10},fetchPolicy:"cache-and-network",ssr:!1,onCompleted:function(e){if((null==e?void 0:e.getRepl.__typename)==="Repl"){var t=s(e);t&&(null==i||i(t))}}},t=(0,a._)({},lA,e),eP.useQuery(lD,t)),d=u.data,f=u.loading,p=u.error,h=u.refetch,g=(0,l._)((0,c.useState)(d?s(d):void 0),2),m=g[0],x=g[1];return(0,c.useEffect)(function(){d&&x(s(d))},[s,d]),{buckets:null==m?void 0:m.buckets,initialBucket:null==m?void 0:m.initialBucket,data:d,loading:f,error:p,refetch:h}};function c7(e){var t=e.buckets,n=e.onRequestAddBucket,r=e.onRequestCreateBucket,i=e.onSelect,o=e.selectedBucketId,a=(0,c.useMemo)(function(){if(t&&o)return t.find(function(e){return e.id===o})},[t,o]);return a&&t?(0,u.jsx)(ta.View,{children:(0,u.jsxs)(te.PopupMenu,{label:a.name,items:t,trigger:(0,u.jsx)(e9.Button,{size:"default",variant:"nofill",text:a.name,iconRight:(0,u.jsx)(sy.default,{size:12})}),children:[t.map(function(e){return(0,u.jsx)(te.MenuItem,{icon:(0,u.jsx)(sx.default,{visibility:e.id===a.id?"visible":"hidden"}),id:e.id,label:e.name,onAction:e.id!==a.id?function(){i(e)}:void 0},e.id)}),(0,u.jsx)(te.Separator,{}),(0,u.jsx)(te.MenuItem,{icon:(0,u.jsx)(td.default,{}),id:"create-new",label:"Create new bucket",onAction:r},"create-new"),(0,u.jsx)(te.MenuItem,{icon:(0,u.jsx)(u2.default,{}),id:"add-existing",label:"Add an existing bucket",onAction:n},"add-existing")]})}):(0,u.jsx)(ta.View,{children:(0,u.jsx)(e9.Button,{size:"default",variant:"nofill",text:"Loading...",iconRight:(0,u.jsx)(sy.default,{size:12})})})}function de(e){var t=e.onSelect,n=e.selectedView,r=(0,c.useMemo)(function(){return c5.find(function(e){return e.value===n})},[n]);return r?(0,u.jsx)(ta.View,{children:(0,u.jsx)(te.PopupMenu,{onAction:function(e){var n=c5.find(function(t){return t.value===e});n&&t(n.value)},label:r.title,items:c5,trigger:(0,u.jsx)(e9.Button,{size:"default",variant:"nofill",text:r.title,iconLeft:r.icon,iconRight:(0,u.jsx)(sy.default,{size:12})}),children:function(e){return(0,u.jsx)(te.MenuItem,{icon:e.icon,id:e.value,label:e.title},e.value)}})}):null}var dt=d.Type.Object({type:d.Type.Literal("objectStorage")}),dn={Content:function(){var e,t,n,r=(0,l._)((0,c.useState)(),2),i=r[0],o=r[1],a=(0,c.useMemo)(function(){return null==i?void 0:i.map(function(e){return e.id})},[i]),s=(0,l._)((0,c.useState)(),2),d=s[0],f=s[1],p=(0,l._)((0,c.useState)("objects"),2),h=p[0],g=p[1],m=(0,l._)((0,c.useState)(!1),2),x=m[0],y=m[1],b=(0,c.useCallback)(function(){return y(!1)},[]),w=(0,c.useCallback)(function(){return y(!0)},[]),k=(0,l._)((0,c.useState)(!1),2),_=k[0],S=k[1],C=(0,c.useCallback)(function(){return S(!1)},[]),j=(0,c.useCallback)(function(){return S(!0)},[]),T=(0,li.useAtomValue)(ur).get(null!=(t=null==d?void 0:d.externalId)?t:""),E=up(),R=E.fetchObjects,I=E.loading,A=(0,c.useCallback)(function(e){f(e),g("objects"),R({bucketExternalId:e.externalId})},[R]),P=(0,nw.default)().dotReplit;(0,c.useEffect)(function(){d&&P.updateDotReplit([(0,lM.setObjectStorageDefaultBucketId)(d.externalId)])},[d,P]);var D=(0,aG.default)(),O=D.showConfirm,N=D.showError,M=function(e){N(e.message),n5.withScope(function(t){t.setTag("object-storage-pane",!0),n5.captureException(e)})},L=c9({onError:M,onCompleted:function(e){var t=e.buckets,n=e.initialBucket;o(t),!d&&n&&(f(n),R({bucketExternalId:null==n?void 0:n.externalId}))}}),B=L.data,V=L.loading,F=L.error,G=L.refetch,$=(0,l._)(lN(),2),z=$[0],H=$[1].loading,W=(0,c.useCallback)(function(e){var t=!(arguments.length>1)||void 0===arguments[1]||arguments[1];o(function(t){return t?[e].concat((0,U._)(t)):[e]}),f(e),G(),R({bucketExternalId:e.externalId,isNewBucket:t})},[R,G]),q=(0,c.useCallback)(function(e){var t=(null!=i?i:[]).filter(function(t){return t.id!==e});if(o(t),0===t.length){f(void 0),g("objects"),P.updateDotReplit([{path:"objectStorage",op:"remove"}]);return}f(t[0]),R({bucketExternalId:t[0].externalId}),g("objects")},[R,i,P]),K=(null==B?void 0:B.getRepl.__typename)==="Repl"?B.getRepl.authorizations.createObjectBucket:void 0,Q=(null==B?void 0:B.getRepl.__typename)==="Repl"?B.getRepl.authorizations.editObjectBucket:void 0,X=(null==B?void 0:B.getRepl.__typename)==="Repl"?null==(e=B.getRepl.org)?void 0:e.id:void 0;if(F)return(0,u.jsx)(ta.View,{p:16,children:(0,u.jsx)(nl.StatusBanner,{text:'Error: "'.concat(F.message,'". The issue has been logged and the Replit team will look into it.'),colorway:"negative"})});if(V&&!i)return(0,u.jsx)(no.default,{pane:{type:"objectStorage"},maxWidth:450,loading:!0});if(!d)return(0,u.jsx)(u8,{createBucketAuthz:K,editBucketAuthz:Q,refetchAuthzQueryData:G,onBucketAdded:function(e){var t=!(arguments.length>1)||void 0===arguments[1]||arguments[1];return(0,eT._)(function(){return(0,Y._)(this,function(n){return W(e,t),[2]})})()},onError:M});switch(h){case"objects":n=I&&void 0===T?(0,u.jsx)(nj,{}):(0,u.jsx)(ta.View,{css:c6.objectTabPanel,children:(0,u.jsx)(c4.default,{children:(0,u.jsx)(cj,{bucketExternalId:d.externalId,onOpenCommandsTab:function(){g("commands")},onError:M})})});break;case"commands":n=(0,u.jsx)(ta.View,{children:(0,u.jsx)(uq,{onError:M})});break;case"settings":n=(0,u.jsx)(ta.View,{children:(0,u.jsx)(c2,{bucketId:d.id,bucketExternalId:d.externalId,onSettingsUpdate:function(e){("deleteBucket"===e.type||"removeBucket"===e.type)&&q(e.data.bucketId),"deleteBucket"===e.type&&O("Bucket deleted successfully"),"removeBucket"===e.type&&O("Bucket removed from Repl successfully")},onError:M})})}return(0,u.jsxs)(ta.View,{grow:!0,shrink:!0,children:[(0,u.jsx)(uO,{excludeBucketIds:null!=a?a:[],isOpen:x,onBucketAdded:function(e){b(),W(e,!1),O("Bucket added to Repl successfully")},onError:M,onRequestClose:b,orgId:X}),(0,u.jsx)(lG,{isOpen:_,loading:H,handleCreateBucket:function(e){z({variables:{input:{name:e.name,replId:e.replId}},onCompleted:function(e){var t="Bucket"===e.createBucket.__typename?e.createBucket:null;t?(C(),W(t),O("Bucket created successfully")):M(Error("Failed to create bucket"))},onError:M})},onRequestClose:C}),(0,u.jsxs)(ta.View,{px:8,py:4,align:"center",row:!0,children:[(0,u.jsx)(c7,{buckets:i,onRequestAddBucket:w,onRequestCreateBucket:j,onSelect:A,selectedBucketId:null==d?void 0:d.id}),(0,u.jsx)(to.Text,{css:c6.controlSeparator,variant:"small",children:"/"}),(0,u.jsx)(de,{onSelect:g,selectedView:h})]}),(0,u.jsx)(c3.DividerH,{}),(0,u.jsx)(ta.View,{css:c6.panels,children:n})]})},Icon:function(e){var t=e.size;return(0,u.jsx)(nf.IconContext.Provider,{value:{color:tL.tokens.tealStrongest,size:t},children:(0,u.jsx)(c8.default,{})})},getTitle:function(){return"App Storage"},description:"App Storage is Replit's built-in object storage that lets your app easily host and save uploads like images, videos, and documents.",category:ew.PaneCategory.CloudServices,decode:function(e){return f.Value.Decode(dt,e)}};e.s(["objectStorageUI",()=>dn],401455);var dr=e.i(921211),di=e.i(314531),da=e.i(262206),ds=e.i(926118),dl=e.i(384401),du=e.i(290446),dc=e.i(482824),dd=e.i(283023),df=e.i(62534);function dp(e){var t=(0,c.useRef)(null),n=(0,c.useRef)([]);function r(){t.current&&clearTimeout(t.current),n.current=[]}function i(t){e({type:"success",shortcut:t.length>1?[t[0],t[1]]:t[0]}),r()}return{onKeyDown:function(r){var o=t.current,a=n.current;r.preventDefault(),r.stopPropagation(),o&&clearTimeout(o);var s=(0,da.getPartialKeyCombination)(r);if(s){if((0,da.isPrefix)(s))return void e({type:"update",recorded:a.length?[a[0],s]:[s]});if(a.length>0&&"Enter"===s)return void i(a);a.push(s),e({type:"update",recorded:a}),t.current=setTimeout(function(){return i(a)},600*(2!==a.length))}},startRecording:function(){r(),e({type:"start"})},stopRecording:function(){r(),e({type:"stop"})}}}var dh=(0,tA.cssRecord)({row:[e6.rcss.minHeight(28)],right:[e6.rcss.position.relative,e6.rcss.flex.grow(1),e6.rcss.flex.shrink(0)],recordingRow:[e6.rcss.flex.column,e6.rcss.align.center,e6.rcss.justify.end],recordingRowKeys:[e6.rcss.position.relative],recordingRowPlaceholder:[e6.rcss.display.flex,e6.rcss.align.baseline,e6.rcss.rowWithGap(4),{fontStyle:"italic"}],keys:[e6.rcss.display.inlineFlex,e6.rcss.rowWithGap(12)],secondaryText:[e6.rcss.display.flex,e6.rcss.flex.row,e6.rcss.align.center,e6.rcss.rowWithGap(4)],secondaryTextId:[e6.rcss.flex.grow(1),e6.rcss.flex.shrink(0)],secondaryTextDescription:[e6.rcss.flex.grow(0),e6.rcss.flex.shrink(1),e6.rcss.color.foregroundDimmest]}),dg=(0,tA.cssRecord)({input:[{opacity:0,width:1}],searchingText:[{fontStyle:"italic"}]});function dm(e){var t,n,r,i,o=e.command,a=e.filter,s=e.shortcutsToCommands,d=e.onViewShortcutConflicts,f=(0,dl.useMapKeybinding)(),p=(0,dl.useUnmapKeybinding)(),h=(0,dl.useDefaultKeyCombo)(o.id),m=(0,l._)((0,c.useState)(null),2),x=m[0],y=m[1],b=dp(function(e){switch(e.type){case"start":return void y({recorded:[]});case"stop":return void y(null);case"update":return void y({recorded:e.recorded});case"success":var t=(0,da.parseKeyCombo)(e.shortcut);if(!t||f(o.id,t))return void y(null);y(null);return;case"error":return void y(function(t){var n;return{error:e.message,recorded:null!=(n=null==t?void 0:t.recorded)?n:[]}})}}),w=b.stopRecording,k=b.startRecording,_=b.onKeyDown,S=(0,u9.default)(function(){return w()},[]),C=!!x;dk(C);var j=null!=(i=null==x?void 0:x.recorded)?i:[],T=null==x?void 0:x.error,E=a.length>0,R=null==(t=di.default.match(a,o.name))?void 0:t.ranges,I=null==(n=di.default.match(a,o.id))?void 0:n.ranges,A=(null==o?void 0:o.description)?null==(r=di.default.match(a,o.description))?void 0:r.ranges:void 0,P=(0,g.default)(function(){return a.replaceAll('"',"").split("-").map(function(e){return e.toLowerCase()})},[a]);return(0,u.jsxs)(ta.View,{gap:8,"data-testid":o.id,children:[(0,u.jsxs)(ta.View,{css:dh.row,row:!0,gap:8,align:"center",children:[(0,u.jsxs)(ta.View,{grow:0,shrink:!0,gap:2,children:[(0,u.jsx)(du.HighlightMatches,{text:o.name,highlight:R,dimmed:E}),(0,u.jsxs)(to.Text,{variant:"small",css:dh.secondaryText,multiline:!1,children:[E?(0,u.jsx)(du.HighlightMatches,{css:dh.secondaryTextId,text:o.id,highlight:I,dimmed:E}):null,o.description?(0,u.jsxs)(u.Fragment,{children:[E?(0,u.jsx)(to.Text,{color:"dimmest",multiline:!1,children:""}):null,(0,u.jsx)(du.HighlightMatches,{css:dh.secondaryTextDescription,text:o.description,highlight:A,dimmed:E})]}):null]})]}),(0,u.jsxs)(ta.View,{innerRef:C?S:void 0,css:dh.right,row:!0,gap:16,align:"center",justify:"end",children:[C?(0,u.jsx)(dr.FocusScope,{autoFocus:!0,restoreFocus:!0,children:(0,u.jsx)("input",{onKeyDown:_,css:dg.input})}):null,o.shortcut&&!C&&s.length>1?(0,u.jsx)(cs.IconButton,{"data-testid":"View conflicts",alt:"View conflicts",onClick:function(){(0,c.startTransition)(function(){o.shortcut&&d(dv([o.shortcut]))})},children:(0,u.jsx)(sd.default,{color:tL.tokens.foregroundDimmer})}):null,o.shortcut&&!C?(0,u.jsx)(ds.KeyComboBlocks,{small:!0,keyCombo:o.shortcut,match:P}):null,o.shortcut||C?null:(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)(e9.Button,{size:"small",variant:"outlined",iconLeft:(0,u.jsx)(td.default,{}),text:"Add shortcut",onClick:function(){return k()}}),h?(0,u.jsx)(cs.IconButton,{alt:"Reset",onClick:function(){return f(o.id,h)},children:(0,u.jsx)(sT.default,{})}):null]}),C?(0,u.jsx)(ta.View,{css:dh.recordingRow,children:(0,u.jsxs)(ta.View,{row:!0,gap:8,align:"center",children:[(0,u.jsx)(ta.View,{css:dh.recordingRowKeys,children:j.length>0?(0,u.jsx)(ta.View,{css:dh.keys,children:j.map(function(e,t){return(0,u.jsx)(ds.KeyComboBlocks,{small:!0,keyCombo:e},"".concat(e,"-").concat(t))})}):(0,u.jsx)(to.Text,{multiline:!1,color:"dimmest",css:dh.recordingRowPlaceholder,children:"Recording"})}),(0,u.jsx)(cs.IconButton,{alt:"Stop",onClick:function(){return w()},children:(0,u.jsx)(dC,{})})]})}):null,o.shortcut&&!C?(0,u.jsxs)(ta.View,{row:!0,gap:4,children:[h&&h!==o.shortcut?(0,u.jsx)(cs.IconButton,{alt:"Reset",onClick:function(){return f(o.id,h)},children:(0,u.jsx)(sT.default,{})}):null,(0,u.jsx)(cs.IconButton,{alt:"Change",onClick:function(){return k()},children:(0,u.jsx)(dd.default,{})}),(0,u.jsx)(cs.IconButton,{alt:"Remove",onClick:function(){return p(o.id)},children:(0,u.jsx)(sW.default,{})})]}):null]})]}),T?(0,u.jsx)(nl.StatusBanner,{icon:(0,u.jsx)(sd.default,{}),colorway:"warning",text:T,closable:!0,closeAction:function(){return y(function(e){var t;return{recorded:null!=(t=null==e?void 0:e.recorded)?t:[]}})}}):null]})}function dv(e){var t=e.flat();return t.length>1?t.map(function(e){return dv([e])}).join(" "):(0,da.keyCombinationOrPrefixToKeys)(t[0]).map(function(e){return'"'.concat(e,'"')}).join("-").replaceAll(" ","space")}var dx=(0,tA.cssRecord)({surface:[e6.rcss.borderRadius(8),e6.rcss.colWithGap(12)]});function dy(e){var t=e.search,n=e.setSearch,r=(0,c.useRef)(null),i=(0,l._)((0,c.useState)(!1),2),o=i[0],a=i[1];dk(o);var s=dp(function(e){var t,i,o;switch(e.type){case"start":a(!0),n(""),null==r||null==(t=r.current)||t.focus();return;case"stop":case"error":a(!1),null==r||null==(i=r.current)||i.focus(),null==r||null==(o=r.current)||o.select();return;case"success":return void n(dv([e.shortcut]));case"update":return void n(dv(e.recorded))}}),d=s.stopRecording,f=s.startRecording,p=s.onKeyDown;return(0,u.jsxs)(ta.View,{row:!0,gap:8,align:"center",children:[(0,u.jsx)(dr.FocusScope,{children:(0,u.jsx)(tB.Input,{ref:r,placeholder:o?"Searching with pressed keys. Press Escape to exit":"Type to search keyboard shortcuts",onBlur:o?d:void 0,onChange:function(e){n(e.currentTarget.value)},onKeyDown:o?function(e){"Escape"===e.key?d():p(e)}:void 0,value:t})}),(0,u.jsx)(ta.View,{row:!0,gap:4,align:"center",children:o?(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)(to.Text,{color:"dimmest",css:dg.searchingText,multiline:!1,children:"Searching"}),(0,u.jsx)(cs.IconButton,{alt:"Stop Recording",onClick:d,children:(0,u.jsx)(dC,{})})]}):(0,u.jsx)(cs.IconButton,{alt:"Record Keys",onClick:f,children:(0,u.jsx)(df.default,{})})}),(0,u.jsx)(cs.IconButton,{alt:"Clear Input",disabled:0===t.length,onClick:function(){var e;n(""),null==r||null==(e=r.current)||e.focus()},children:(0,u.jsx)(dc.default,{})})]})}function db(){var e=(0,l._)((0,c.useState)(""),2),t=e[0],n=e[1],r=(0,c.useDeferredValue)(t);return(0,u.jsxs)(ta.View,{p:0,gap:8,children:[(0,u.jsx)(dy,{search:t,setSearch:n}),(0,u.jsx)(dw,{search:r,setSearch:n})]})}var dw=(0,c.memo)(function(e){var t=e.search,n=e.setSearch,r=(0,dl.useKeyBindings)(),i=(0,g.default)(function(){return(0,U._)(r.values())},[r]),o=(0,c.useMemo)(function(){return di.default.filter(t,i,{extract:function(e){var t="".concat(e.name," ").concat(e.id);return e.description&&(t+=" ".concat(e.description)),e.shortcut&&(t+=" ".concat(dv([e.shortcut]))),t}})},[t,i]),a=(0,c.useMemo)(function(){return o.reduce(function(e,t){var n=t.original,r=n.shortcut;if(!r)return e;var i=e.get(r);return i?i.push(n):i=[n],e.set(r,i),e},new Map)},[o]);return o.length>0?(0,u.jsx)(tP.Surface,{css:dx.surface,pt:8,children:o.map(function(e,r){var i;return(0,u.jsxs)(c.Fragment,{children:[r>0?(0,u.jsx)(tP.Surface,{elevated:!0,style:{height:1}}):null,(0,u.jsx)(dm,{command:e.original,filter:t,shortcutsToCommands:null!=(i=a.get(e.original.shortcut))?i:[],onViewShortcutConflicts:n})]},e.original.id)})}):null});function dk(e){var t="You have unsaved changes";(0,c.useEffect)(function(){var n=function(e){return e.preventDefault(),e.returnValue=t,t};if(e)return window.addEventListener("beforeunload",n),function(){window.removeEventListener("beforeunload",n)}},[e])}var d_=(0,t4.keyframes)("0%{transform:scale(1);}40%{transform:scale(1.3);}100%{transform:scale(1);}"),dS=(0,tA.cssRecord)({background:[{animationName:d_,animation:"".concat(d_," 2s cubic-bezier(0.4, 0, 0.6, 1) infinite"),boxShadow:"0 0 10px ".concat(tL.tokens.redStronger)},e6.rcss.height(11),e6.rcss.width(11),e6.rcss.borderRadius("full"),e6.rcss.position.absolute],container:[e6.rcss.position.relative,e6.rcss.align.center,e6.rcss.justify.center],icon:[{zIndex:1}]});function dC(){return(0,u.jsxs)(ta.View,{css:dS.container,children:[(0,u.jsx)(ts.default,{css:dS.icon,color:tL.tokens.redStronger}),(0,u.jsx)(ta.View,{css:dS.background})]})}function dj(){var e=(0,a3.useIdSeed)()("keyboard_shortcuts");return(0,u.jsxs)(ta.View,{gap:12,children:[(0,u.jsx)(ta.View,{tag:"label",htmlFor:e}),(0,u.jsx)(db,{})]})}var dT=e.i(556088),dE=e.i(61524),dR=e.i(670413),dI=e.i(332441);function dA(){var e=(0,eI._)(["\n  query AiDeveloperSection {\n    currentUser {\n      id\n      isStaff: hasRole(role: REPLIT_STAFF)\n    }\n  }\n"]);return dA=function(){return e},e}e.i(33699);var dP={},dD=(0,eA.gql)(dA()),dO=e.i(63846),dN=e.i(17886),dM=e.i(952098),dL=e.i(416143);e.i(660670);var dB=e.i(170039),dV=e.i(810206),dF=e.i(624782),dU=(0,t4.css)([e6.rcss.height(18)]);function dG(){return(0,u.jsx)(dF.Pill,{css:dU,text:"Staff-only",colorway:"warning"})}var d$=(0,dO.getAiEndpoint)(),dz=(0,dM.getCurrentChortEndpoint)(),dH=dO.endpointOverride?[{title:"override",value:dO.endpointOverride}]:Array.from((0,U._)(Object.entries(dL.AiEndpoints)).concat([["custom",""]]),function(e){return{title:e[0],value:e[1]}}),dW=dB.CHORT_ENVIRONMENT_HOST_OVERRIDE?[{title:"override",value:dB.CHORT_ENVIRONMENT_HOST_OVERRIDE}]:Array.from([["automatic",""]].concat((0,U._)(Object.entries(dB.CHORT_ENDPOINTS)),[["custom",""]]),function(e){return{title:e[0],value:e[1]}}),dq=(0,dN.isEnvProduction)()||dO.endpointOverride?dH[0]:dH[1],dK=dW[0];function dY(){var e,t=(0,l._)((0,c.useState)(!Object.values(dH).map(function(e){return e.value}).includes(d$)),2),n=t[0],r=t[1],i=(0,l._)((0,c.useState)(""),2),o=i[0],a=i[1];return(0,u.jsx)(dV.Section,{id:"chatServiceEndpoint",title:(0,u.jsxs)(u.Fragment,{children:[(0,u.jsxs)(ta.View,{row:!0,gap:8,align:"center",justify:"start",children:[(0,u.jsx)(to.Text,{multiline:!1,children:"AI Chat Service Endpoint"}),(0,u.jsx)(dG,{})]}),(0,u.jsxs)(ta.View,{gap:8,children:[(0,u.jsxs)(to.Text,{variant:"small",color:"dimmest",children:["Current chat endpoint: ",d$]}),(0,u.jsx)(to.Text,{variant:"small",color:"dimmest",children:"Reloading window is required for change to take effect."})]})]}),children:(0,u.jsxs)(ta.View,{gap:12,children:[(0,u.jsx)(uU.Select,{"aria-label":"Select AI chat service endpoint",css:[e6.rcss.minWidth(184)],initialSelectedItem:null!=(e=dH.find(function(e){return e.value===d$}))?e:d$?dH[dH.length-1]:dq,onChange:function(e){(null==e?void 0:e.title)!=="custom"?((0,dO.setAiEndpoint)(e.value),r(!1),window.location.reload()):r(!0)},items:dH}),n?(0,u.jsxs)(ta.View,{row:!0,gap:4,children:[(0,u.jsx)(tB.Input,{value:o,onChange:function(e){a(e.target.value)},onKeyDown:function(e){"Enter"===e.key&&(0,dO.setAiEndpoint)(o)}}),(0,u.jsx)(cs.IconButton,{alt:"Update custom url",onClick:function(){(0,dO.setAiEndpoint)(o),window.location.reload()},children:d$!==o?(0,u.jsx)(sT.default,{}):(0,u.jsx)(sx.default,{})})]}):null]})})}function dQ(){var e,t=(0,l._)((0,c.useState)(!Object.values(dW).map(function(e){return e.value}).includes(dz)),2),n=t[0],r=t[1],i=null===dB.CHORT_ENVIRONMENT_HOST_OVERRIDE&&null===(0,dB.getChortLocalEndpointOverride)(),o=(0,l._)((0,c.useState)(""),2),a=o[0],s=o[1];return(0,u.jsx)(dV.Section,{id:"chortServiceEndpoint",title:(0,u.jsxs)(u.Fragment,{children:[(0,u.jsxs)(ta.View,{row:!0,gap:8,align:"center",justify:"start",children:[(0,u.jsx)(to.Text,{multiline:!1,children:"Chort Service Endpoint"}),(0,u.jsx)(dG,{})]}),(0,u.jsxs)(ta.View,{gap:8,children:[(0,u.jsxs)(to.Text,{variant:"small",color:"dimmest",children:["Current chort endpoint: ",dz]}),(0,u.jsx)(to.Text,{variant:"small",color:"dimmest",children:"Reloading window is required for change to take effect."})]})]}),children:(0,u.jsxs)(ta.View,{gap:12,children:[(0,u.jsx)(uU.Select,{"aria-label":"Select code generation service endpoint",css:[e6.rcss.minWidth(184)],items:dW,initialSelectedItem:i?dK:null!=(e=dW.find(function(e){return e.value===dz}))?e:dK,onChange:function(e){(null==e?void 0:e.title)!=="custom"&&(null==e?void 0:e.title)!=="automatic"?((0,dB.setChortLocalEndpointOverride)(e.value),r(!1),window.location.reload()):(null==e?void 0:e.title)==="automatic"?((0,dB.setChortLocalEndpointOverride)(null),r(!1),window.location.reload()):r(!0)}}),n?(0,u.jsxs)(ta.View,{row:!0,gap:4,children:[(0,u.jsx)(tB.Input,{value:a,onChange:function(e){s(e.target.value)},onKeyDown:function(e){"Enter"===e.key&&(0,dB.setChortLocalEndpointOverride)(a)}}),(0,u.jsx)(cs.IconButton,{alt:"Update custom url",onClick:function(){(0,dB.setChortLocalEndpointOverride)(a),window.location.reload()},children:dz!==a?(0,u.jsx)(sT.default,{}):(0,u.jsx)(sx.default,{})})]}):null]})})}function dX(){var e,t,n=(e=(0,a._)({},dP,void 0),eP.useQuery(dD,e)).data;return(null==n||null==(t=n.currentUser)?void 0:t.isStaff)?(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)(dY,{}),(0,u.jsx)(dQ,{})]}):null}function dJ(){var e=(0,eI._)(["\n  query CodeSuggestionPreferences($replId: String!) {\n    currentUser {\n      id\n      userSubscriptionType\n    }\n    getRepl(id: $replId) {\n      ... on Repl {\n        id\n        org {\n          id\n        }\n      }\n    }\n  }\n"]);return dJ=function(){return e},e}var dZ={},d0=(0,eA.gql)(dJ()),d1=e.i(973519);function d2(e){var t=e.context,n=e.text,r=(0,d1.useGlobalModal)().show;return(0,u.jsx)(e9.Button,{text:void 0===n?"Activate":n,colorway:"primary",onClick:function(){return(0,eT._)(function(){return(0,Y._)(this,function(e){switch(e.label){case 0:return[4,r("MembershipPurchaseModal",{analyticsContext:{upgrade:{context:t}}})];case 1:return e.sent(),[2]}})})()}})}var d3=e.i(807290),d4=e.i(641209);function d8(){var e,t,n,r,i=(n={variables:{replId:(0,tw.default)()}},r=(0,a._)({},dZ,n),eP.useQuery(d0,r)).data,o=(null==i||null==(e=i.currentUser)?void 0:e.userSubscriptionType)===rg.UserSubscriptionTypeEnum.HackerPro,s=(null==i?void 0:i.getRepl.__typename)==="Repl"&&null!=(t=i.getRepl.org)&&!!t.id,c=(0,aF.isInBonsaiWebview)((0,rp.useRouter)()),d=(0,d3.useIsTeamWithAiDisabled)().isTeamWithAiDisabled,f=(0,dE.usePreferences)("codeSuggestion"),p=f.preferences,h=f.update;return d?null:(0,u.jsxs)(ta.View,{gap:12,children:[(0,u.jsx)(d4.EditorSettingBox,{currentValue:p.codeSuggestion,update:function(e){var t=h(e),n=!0,r=!1,i=void 0;try{for(var o,a=Object.entries(e)[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var s=(0,l._)(o.value,2),u=s[0],c=s[1];(0,e4.track)(e8.events.SETTINGS_TOGGLED,{settingChanged:u,updatedValue:c})}}catch(e){r=!0,i=e}finally{try{n||null==a.return||a.return()}finally{if(r)throw i}}return t},setting:dT.userPreferences.codeSuggestion,title:(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)(ta.View,{row:!0,gap:8,align:"center",children:(0,u.jsx)(to.Text,{multiline:!1,children:"AI Code Completion"})}),(0,u.jsxs)(to.Text,{variant:"small",color:"dimmest",children:["Code completion provides inline ghost text suggestions while you code.",(0,u.jsx)("br",{}),"Press tab or swipe right on your mobile device to accept."]})]})}),s||o||c?null:(0,u.jsxs)(ta.View,{row:!0,gap:8,align:"center",justify:"space-between",children:[(0,u.jsx)(to.Text,{children:"Upgrade for full access to Replit AI"}),(0,u.jsx)(d2,{text:"Upgrade to Replit ".concat(sz.corePlanName),context:"workspace_settings_pane"})]})]})}var d5=e.i(808229);function d6(e){return e.slice().sort(function(e,t){return e-t})}var d9=(0,tA.cssRecord)({ruler:[e6.rcss.borderRadius(8)],remove:[e6.rcss.borderRadius(4)],title:[e6.rcss.pr(8),e6.rcss.overflow("visible"),e6.rcss.flex.shrink(0)],body:[e6.rcss.flex.wrapReverse,e6.rcss.align.start,e6.rcss.justify.end,e6.rcss.flex.growAndShrink(1),{gap:tL.tokens.space4}],list:[e6.rcss.flex.wrap,e6.rcss.flex.growAndShrink(1),e6.rcss.align.end,e6.rcss.justify.end,{gap:tL.tokens.space4}]});function d7(e){var t=e.pos,n=e.onRemove;return(0,u.jsxs)(tP.Surface,{css:d9.ruler,py:4,px:8,row:!0,gap:4,align:"center",elevated:!0,children:[(0,u.jsx)(to.Text,{multiline:!1,children:t}),(0,u.jsx)(cs.IconButton,{css:d9.remove,alt:"Remove ruler",onClick:n,children:(0,u.jsx)(dc.default,{})})]})}function fe(){var e=(0,l._)((0,c.useState)(!1),2),t=e[0],n=e[1],r=(0,l._)((0,c.useState)(80),2),i=r[0],o=r[1],a=(0,c.useRef)(null),s=(0,c.useRef)(null),d=-1===i,f=i>=0&&i<=1e3,p=(0,dE.usePreferences)("rulers"),h=p.preferences,g=p.update,m=d6(h.rulers);return(0,u.jsx)(dV.Section,{id:"rulers",title:(0,u.jsx)(to.Text,{css:d9.title,multiline:!1,children:"Rulers"}),children:(0,u.jsxs)(ta.View,{css:d9.body,row:!0,children:[(0,u.jsx)(ta.View,{css:d9.list,row:!0,children:m.map(function(e,t){return(0,u.jsx)(d7,{pos:e,onRemove:function(){g({rulers:m.filter(function(e,n){return n!==t})})}},t)})}),t?(0,u.jsxs)(ta.View,{row:!0,gap:4,align:"center",children:[(0,u.jsx)(tB.Input,{ref:a,type:"number",style:{width:d?"6ch":i.toString().length+5.5+"ch"},value:i>=0?i.toString():"",onChange:function(e){if(""===e.target.value)o(-1);else{var t=parseInt(e.target.value,10);isNaN(t)||o(t)}},onKeyDown:function(e){"Escape"===e.key?(o(80),n(!1)):"Enter"===e.key&&f&&(g({rulers:d6((0,U._)(m).concat([i]))}),n(!1),o(80))},onBlur:function(e){e.relatedTarget!==s.current&&(n(!1),o(80))},onFocus:function(e){e.target.select()},autoFocus:!0}),(0,u.jsx)(e9.Button,{ref:s,text:"Accept",colorway:"primary",iconLeft:(0,u.jsx)(sx.default,{}),disabled:!f,onClick:function(){f&&(g({rulers:d6((0,U._)(m).concat([i]))}),n(!1),o(80))},onBlur:function(e){e.relatedTarget!==a.current&&(n(!1),o(80))}})]}):(0,u.jsx)(u.Fragment,{children:m.length>=10?null:(0,u.jsx)(e9.Button,{text:"Add Ruler",iconLeft:(0,u.jsx)(td.default,{}),onClick:function(){return n(!0)}})})]})})}var ft=(0,tA.cssRecord)({container:[(0,C._)({},dV.COLUMN_LAYOUT_BREAKPOINT,[e6.rcss.colWithGap(8)])],switchWrapper:[e6.rcss.rowWithGap(8),e6.rcss.align.center,e6.rcss.justify.end,(0,C._)({},dV.COLUMN_LAYOUT_BREAKPOINT,[e6.rcss.flex.rowReverse])],switchLabel:[(0,C._)({},dV.COLUMN_LAYOUT_BREAKPOINT,[e6.rcss.ml(8)])]});function fn(){var e=(0,dE.usePreferences)("showLeadingWhitespace","showTrailingWhitespace","showEnclosedWhitespace","showSelectedWhitespace"),t=e.preferences,n=e.update;return(0,u.jsxs)(ta.View,{css:ft.container,row:!0,justify:"space-between",align:"start",children:[(0,u.jsxs)(ta.View,{grow:!0,shrink:!0,children:[(0,u.jsx)(to.Text,{children:"Show Whitespace"}),(0,u.jsx)(to.Text,{multiline:!0,variant:"small",color:"dimmest",children:"Make whitespace characters visible, such as tabs and spaces."})]}),(0,u.jsxs)(ta.View,{gap:12,children:[(0,u.jsxs)(ta.View,{css:ft.switchWrapper,tag:"label",children:[(0,u.jsx)(to.Text,{variant:"small",css:ft.switchLabel,children:"Leading"}),(0,u.jsx)(ld.Switch,{"aria-label":"Show leading whitespace",isSelected:t.showLeadingWhitespace,onChange:function(e){n({showLeadingWhitespace:e})}})]}),(0,u.jsxs)(ta.View,{css:ft.switchWrapper,tag:"label",children:[(0,u.jsx)(to.Text,{variant:"small",css:ft.switchLabel,children:"Enclosed"}),(0,u.jsx)(ld.Switch,{"aria-label":"Show enclosed whitespace",isSelected:t.showEnclosedWhitespace,onChange:function(e){n({showEnclosedWhitespace:e})}})]}),(0,u.jsxs)(ta.View,{css:ft.switchWrapper,tag:"label",children:[(0,u.jsx)(to.Text,{variant:"small",css:ft.switchLabel,children:"Trailing"}),(0,u.jsx)(ld.Switch,{"aria-label":"Show trailing whitespace",isSelected:t.showTrailingWhitespace,onChange:function(e){n({showTrailingWhitespace:e})}})]}),(0,u.jsxs)(ta.View,{css:ft.switchWrapper,tag:"label",children:[(0,u.jsx)(to.Text,{variant:"small",css:ft.switchLabel,children:"Selected"}),(0,u.jsx)(ld.Switch,{"aria-label":"Show selected whitespace",isSelected:t.showSelectedWhitespace,onChange:function(e){n({showSelectedWhitespace:e})}})]})]})]})}var fr=e.i(838124),fi=e.i(721321),fo=e.i(224996),fa=e.i(918208);function fs(e){var t=e.setting,n=e.currentValue,r=e.update;return(0,u.jsx)(dV.Section,{title:(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)(to.Text,{multiline:!1,children:t.name}),(0,u.jsx)(to.Text,{variant:"small",color:"dimmest",children:t.description})]}),id:t.id,children:(0,u.jsx)(fi.ButtonGroup,{name:"Agent Position",value:n,onChange:function(e){r({agentPosition:e})},row:!0,children:t.options.map(function(e){return(0,u.jsx)(fi.ButtonGroupItem,{id:e.id,value:e.editorPreferencesValue,icon:"leftSidebar"===e.editorPreferencesValue?(0,u.jsx)(fo.default,{}):(0,u.jsx)(fa.default,{})},e.id)})})})}var fl=e.i(333932),fu=e.i(703774),fc=e.i(900876),fd=e.i(360877),ff=e.i(347647);function fp(){var e,t,n,r,i,o=(0,fu.useTheme)(),a=o.theme,s=o.setActiveTheme,d=(0,fl.useThemesSwitcherCurrentUserInstalledThemesQuery)({variables:{input:{}}}).data,f=(0,fl.useThemesSwitcherCurrentUserAuthoredThemesQuery)({variables:{input:{}}}).data,p=(null==d||null==(t=d.currentUser)||null==(e=t.installedThemes)?void 0:e.__typename)==="InstalledThemeConnection"?d.currentUser.installedThemes.items.map(function(e){return e.customTheme}):[],h=(null==f||null==(r=f.currentUser)||null==(n=r.authoredThemes)?void 0:n.__typename)==="CustomThemeConnection"?f.currentUser.authoredThemes.items:[],g=function(e){("number"==typeof e||"replitSpooky"===e)&&s(e)},m=(0,l._)((0,c.useState)(!1),2),x=m[0],y=m[1],b=(0,c.useRef)("replitSpooky"===a.id);if(!(p.length>0||h.length>0||b.current))return(0,u.jsxs)(fi.ButtonGroup,{name:"Theme",value:a.id,onChange:s,row:!0,children:[(0,u.jsx)(fi.ButtonGroupItem,{id:"replitLight",value:"replitLight",text:"Light",icon:(0,u.jsx)(ff.default,{})}),(0,u.jsx)(fi.ButtonGroupItem,{id:"replitDark",value:"replitDark",text:"Dark",icon:(0,u.jsx)(fc.default,{})})]});var w=null!=(i=({replitLight:(0,u.jsx)(ff.default,{}),replitDark:(0,u.jsx)(fc.default,{})})[a.id])?i:(0,u.jsx)(fd.default,{});return(0,u.jsxs)(sv.PopoverTrigger,{isOpen:x,onOpenChange:y,label:"Home",placement:"bottom start",children:[(0,u.jsx)(e9.Button,{iconLeft:w,iconRight:(0,u.jsx)(sy.default,{}),text:a.name}),(0,u.jsxs)(te.Menu,{"aria-label":"Themes",children:[(0,u.jsx)(fh,{icon:(0,u.jsx)(ff.default,{}),label:"Light",onAction:function(){return s("replitLight")},right:"replitLight"===a.id?(0,u.jsx)(sx.default,{}):void 0}),(0,u.jsx)(fh,{icon:(0,u.jsx)(fc.default,{}),label:"Dark",onAction:function(){return s("replitDark")},right:"replitDark"===a.id?(0,u.jsx)(sx.default,{}):void 0}),(0,u.jsx)(fh,{label:"Spooky",onAction:function(){return s("replitSpooky")},right:"replitSpooky"===a.id?(0,u.jsx)(sx.default,{}):void 0}),h.map(function(e){return(0,u.jsx)(fh,{label:e.title,onAction:function(){return g(e.id)},right:a.id===e.id?(0,u.jsx)(sx.default,{}):void 0},e.id)}),p.map(function(e){return(0,u.jsx)(fh,{label:e.title,onAction:function(){return g(e.id)},right:a.id===e.id?(0,u.jsx)(sx.default,{}):void 0},e.id)})]})]})}function fh(e){var t;return(0,u.jsxs)(te.BaseMenuItem,{textValue:e.label,onAction:e.onAction,children:[(0,u.jsx)(nf.IconProvider,{size:16,children:e.icon}),(0,u.jsx)(te.MenuItemLabel,{children:e.label}),null!=(t=e.right)?t:null]})}var fg=e.i(467495);function fm(){return(0,u.jsx)("div",{className:fg.default.divider})}function fv(){var e=(0,dE.usePreferences)("fontSize","minimapDisplay","wrapping","keyboardHandler","multiselectModifierKey","showFileTreeGitStatus","codeIntelligence","codeActionsOnSave","formatOnSave","semanticTokens","accessibleTerminal","shellBellAudio","webviewAutoOpenOnPortOpened","agentAudioNotification","agentPushNotification","agentPosition","assistantPushNotification","forwardPortsAutomatically","acceptSuggestionOnCommitCharacter","enableCloseBracketMatching"),t=e.preferences,n=e.update,r=(0,aF.isInBonsaiWebview)((0,rp.useRouter)()),i=(0,aF.useIsInMobileWorkspace)(),o=(0,fr.useIsExtensionRepl)(),l=(0,dI.useIsMac)(),c=(0,si.useFlag)({controlName:"flag-lsp-semantic-tokens",logFlagToAnalytics:!1}),d=function(e){Object.keys(e).forEach(function(t){var n=e[t];(0,e4.track)(e8.events.SETTINGS_TOGGLED,{settingChanged:t,updatedValue:n})}),n(e)};if(!t)return null;var f=(0,s._)((0,a._)({},dT.userPreferences.multiselectModifierKey),{options:dT.userPreferences.multiselectModifierKey.options.map(function(e){return(0,s._)((0,a._)({},e),{title:(0,dR.getKeyCharTextForPlatform)("cmdOrCtrlKey"===e.id?dR.KeyChar.CMD_OR_CTRL_KEY:dR.KeyChar.ALT_KEY,l)})})});return(0,u.jsxs)(ta.View,{gap:6,pb:32,children:[(0,u.jsxs)(dV.CollapsibleSection,{title:"Agent & Assistant",defaultExpanded:!0,children:[r?null:(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)(fs,{setting:dT.userPreferences.agentPosition,update:d,currentValue:t.agentPosition}),(0,u.jsx)(fm,{})]}),(0,u.jsx)(d4.EditorSettingBox,{setting:dT.userPreferences.agentAudioNotification,update:d,currentValue:t.agentAudioNotification}),(0,u.jsx)(fm,{}),(0,u.jsx)(d4.EditorSettingBox,{setting:dT.userPreferences.agentPushNotification,update:d,currentValue:t.agentPushNotification}),(0,u.jsx)(fm,{}),(0,u.jsx)(d4.EditorSettingBox,{setting:dT.userPreferences.assistantPushNotification,update:d,currentValue:t.assistantPushNotification}),(0,u.jsx)(fm,{})]}),(0,u.jsxs)(dV.CollapsibleSection,{title:"App Preview",defaultExpanded:!0,children:[(0,u.jsx)(dV.Section,{id:"webviewAutoOpenOnPortOpened",title:(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)(to.Text,{children:o?"Automatic Preview (unavailable in this Repl)":"Automatic Preview"}),(0,u.jsx)(to.Text,{variant:"small",color:"dimmest",children:"Open a web preview automatically when a port is open"}),o?(0,u.jsx)(ta.View,{pt:8,children:(0,u.jsx)(nl.StatusBanner,{colorway:"orange",text:'This preference is unavailable in Extension Apps. To view custom tools in dev mode, click the "Preview" button in Extension Devtools instead.'})}):null]}),children:(0,u.jsx)(ld.Switch,{"aria-label":"Automatic Webview",isSelected:t.webviewAutoOpenOnPortOpened,isDisabled:o,onChange:function(e){d({webviewAutoOpenOnPortOpened:e})}})}),(0,u.jsx)(fm,{}),(0,u.jsx)(d4.EditorSettingBox,{setting:dT.userPreferences.forwardPortsAutomatically,update:d,currentValue:t.forwardPortsAutomatically}),(0,u.jsx)(fm,{})]}),(0,u.jsxs)(dV.CollapsibleSection,{title:"Appearance",defaultExpanded:!0,children:[(0,u.jsx)(d4.EditorSettingBox,{setting:dT.userPreferences.fontSize,update:d,currentValue:t.fontSize}),r?null:(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)(fm,{}),(0,u.jsx)(dV.Section,{id:"theme",title:"Theme",children:(0,u.jsx)(fp,{})})]}),(0,u.jsx)(fm,{})]}),(0,u.jsxs)(dV.CollapsibleSection,{title:"Code Editing",defaultExpanded:!1,children:[(0,u.jsx)(d8,{}),(0,u.jsx)(fm,{}),(0,u.jsx)(dV.Section,{id:"acceptSuggestionOnCommitCharacter",title:(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)(to.Text,{children:"Accept Suggestion on Commit Character"}),(0,u.jsxs)(to.Text,{variant:"small",color:"dimmest",children:["Controls whether suggestions should be accepted on commit characters. For example, in JavaScript, the semi-colon (",(0,u.jsx)("code",{children:";"}),") can be a commit character that accepts the suggestion and types the character."]})]}),children:(0,u.jsx)(ld.Switch,{"aria-label":"Accept suggestion on commit character",isSelected:t.acceptSuggestionOnCommitCharacter,onChange:function(e){d({acceptSuggestionOnCommitCharacter:e})}})}),(0,u.jsx)(fm,{}),(0,u.jsx)(dV.Section,{id:"enableCloseBracketMatching",title:(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)(to.Text,{children:"Auto close brackets"}),(0,u.jsx)(to.Text,{variant:"small",color:"dimmest",children:"Controls whether the editor should automatically close brackets after the user adds an opening bracket."})]}),children:(0,u.jsx)(ld.Switch,{"aria-label":"Auto close brackets",isSelected:t.enableCloseBracketMatching,onChange:function(e){d({enableCloseBracketMatching:e})}})}),(0,u.jsx)(fm,{}),(0,u.jsx)(d4.EditorSettingBox,{setting:dT.userPreferences.wrapping,update:d,currentValue:t.wrapping}),(0,u.jsx)(fm,{}),(0,u.jsx)(d5.default,{}),(0,u.jsx)(fm,{}),i?null:(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)(d4.EditorSettingBox,{setting:dT.userPreferences.minimap,update:d,currentValue:t.minimapDisplay}),(0,u.jsx)(fm,{})]}),(0,u.jsx)(d4.EditorSettingBox,{setting:dT.userPreferences.codeIntelligence,update:d,currentValue:t.codeIntelligence}),(0,u.jsx)(fm,{}),c&&t.codeIntelligence?(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)(d4.EditorSettingBox,{setting:dT.userPreferences.semanticTokens,update:d,currentValue:t.semanticTokens}),(0,u.jsx)(fm,{})]}):null,(0,u.jsx)(fn,{}),(0,u.jsx)(fm,{})]}),(0,u.jsxs)(dV.CollapsibleSection,{title:"Advanced Developer Settings",defaultExpanded:!1,children:[(0,u.jsx)(fe,{}),(0,u.jsx)(fm,{}),(0,u.jsx)(d4.EditorSettingBox,{setting:dT.userPreferences.keyboardHandler,update:d,currentValue:t.keyboardHandler}),(0,u.jsx)(fm,{}),(0,u.jsx)(d4.EditorSettingBox,{setting:f,update:d,currentValue:t.multiselectModifierKey}),(0,u.jsx)(fm,{}),(0,u.jsx)(d4.EditorSettingBox,{setting:dT.userPreferences.showFileTreeGitStatus,update:d,currentValue:t.showFileTreeGitStatus}),(0,u.jsx)(dX,{}),(0,u.jsx)(fm,{}),(0,u.jsx)(d4.EditorSettingBox,{setting:dT.userPreferences.accessibleTerminal,update:d,currentValue:t.accessibleTerminal}),(0,u.jsx)(fm,{}),(0,u.jsx)(d4.EditorSettingBox,{setting:dT.userPreferences.shellBellAudio,update:d,currentValue:t.shellBellAudio})]})]})}var fx=e.i(846445);function fy(e){var t=e.defaultTabKey,n=(0,aF.useIsInMobileWorkspace)();return(0,u.jsxs)(ta.View,{clsx:fx.default.root,p:16,gap:16,grow:!0,shrink:!0,children:[(0,u.jsxs)(ta.View,{justify:"center",gap:2,children:[(0,u.jsx)(to.Header,{variant:"subheadBig",level:3,children:"User Settings"}),(0,u.jsx)(to.Text,{variant:"small",color:"dimmest",children:"The following settings apply to your account and will be used across all your Apps."})]}),n?(0,u.jsx)(fv,{}):(0,u.jsxs)(ti.Tabs,{defaultSelectedKey:void 0===t?"workspace":t,children:[(0,u.jsxs)(ti.TabList,{withDividers:!1,children:[(0,u.jsx)(ti.Tab,{id:"workspace",children:"Workspace"}),(0,u.jsx)(ti.Tab,{id:"shortcuts",children:"Keyboard shortcuts"})]}),(0,u.jsxs)(ti.TabPanels,{children:[(0,u.jsx)(ti.TabPanel,{id:"workspace",clsx:fx.default.tabPanel,children:(0,u.jsx)(fv,{})}),(0,u.jsx)(ti.TabPanel,{id:"shortcuts",clsx:fx.default.tabPanel,children:(0,u.jsx)(dj,{})})]})]})]})}var fb=d.Type.Object({type:d.Type.Literal("preferences"),data:d.Type.Optional(d.Type.Object({tab:d.Type.Optional(d.Type.Union([d.Type.Literal("workspace"),d.Type.Literal("shortcuts"),d.Type.Number()]))}))}),fw={Content:function(e){var t,n=e.pane.data;return(null==n?void 0:n.tab)===1?t="shortcuts":(null==n?void 0:n.tab)===0||(null==n?void 0:n.tab)==="workspace"?t="workspace":(null==n?void 0:n.tab)==="shortcuts"&&(t="shortcuts"),(0,u.jsx)(fy,{defaultTabKey:t})},Icon:function(e){var t=e.size;return(0,u.jsx)(nf.IconContext.Provider,{value:{color:tL.tokens.greyStrongest,size:t},children:(0,u.jsx)(tp.default,{})})},getTitle:function(){return"User Settings"},description:"Configure personal editor preferences and workspace settings which apply to all Apps",category:ew.PaneCategory.Other,decode:function(e){return f.Value.Decode(fb,e)}};e.s(["preferencesUI",()=>fw],921009);var fk=e.i(750936);function f_(){var e=(0,eI._)(["\n  fragment ProjectMergeSectionRepl on Repl {\n    id\n    title\n  }\n"]);return f_=function(){return e},e}function fS(){var e=(0,eI._)(["\n  fragment ProjectMergeSectionCurrentUser on CurrentUser {\n    id\n  }\n"]);return fS=function(){return e},e}var fC=(0,eA.gql)(f_()),fj=(0,eA.gql)(fS());function fT(){var e=(0,eI._)(["\n  fragment ReplToReplMergeOrg on Org {\n    id\n    slug\n  }\n"]);return fT=function(){return e},e}function fE(){var e=(0,eI._)(["\n  fragment ReplMergeRelatedRepl on Repl {\n    id\n    url\n    nextPagePathname\n    ...ReplSelectorRepl\n  }\n  ","\n"]);return fE=function(){return e},e}function fR(){var e=(0,eI._)(["\n  fragment ReplToReplMergeProject on Project {\n    id\n    mainRepl {\n      id\n      ...ReplMergeRelatedRepl\n    }\n  }\n  ","\n"]);return fR=function(){return e},e}function fI(){var e=(0,eI._)(["\n  fragment ReplToReplMergeCurrentRepl on Repl {\n    id\n    ...ProjectMergeSectionRepl\n  }\n  ","\n"]);return fI=function(){return e},e}function fA(){var e=(0,eI._)(["\n  query ReplToReplMergeGetRelatedRepls($id: String!) {\n    getRepl(id: $id) {\n      __typename\n      ... on Repl {\n        id\n        project {\n          id\n          repls {\n            items {\n              ...ReplMergeRelatedRepl\n            }\n          }\n        }\n      }\n    }\n  }\n  ","\n"]);return fA=function(){return e},e}var fP=(0,eA.gql)(fT()),fD=(0,eA.gql)(fE(),fk.ReplSelectorReplFragmentDoc),fO=(0,eA.gql)(fR(),fD),fN=(0,eA.gql)(fI(),fC);function fM(){var e=(0,eI._)(["\n  query ProjectPane($id: String!) {\n    getRepl(id: $id) {\n      __typename\n      ... on Repl {\n        id\n        ...ReplToReplMergeCurrentRepl\n        project {\n          ...ReplToReplMergeProject\n          org {\n            ...ReplToReplMergeOrg\n          }\n        }\n      }\n    }\n    currentUser {\n      ...ProjectMergeSectionCurrentUser\n    }\n  }\n  ","\n  ","\n  ","\n  ","\n"]);return fM=function(){return e},e}(0,eA.gql)(fA(),fD),e.s(["ReplMergeRelatedReplFragmentDoc",()=>fD,"ReplToReplMergeCurrentReplFragmentDoc",()=>fN,"ReplToReplMergeOrgFragmentDoc",()=>fP,"ReplToReplMergeProjectFragmentDoc",()=>fO],494948);var fL={},fB=(0,eA.gql)(fM(),fN,fO,fP,fj);function fV(e){var t=(0,a._)({},fL,e);return eP.useQuery(fB,t)}e.s(["useProjectPaneQuery",()=>fV],932287)},538667,183187,172588,432052,e=>{"use strict";var t,n=e.i(297083),r=e.i(878420),i=e.i(64386),o=e.i(530658),a=e.i(817556),s=e.i(389959),l=e.i(467612),u=e.i(597865),c=e.i(529810),d=e.i(264887),f=e.i(875259),p=function(){var e=(0,o._)((0,s.useReducer)(function(){return Math.random()},Math.random()),2);return[e[0],e[1]]},h=function(e){var t=e.ours,r=e.theirs,i=(0,o._)(p(),2),l=i[0],c=i[1],f=(0,u.default)(function(e){return(0,n._)(function(){var n,i,s,l,u,c,d;return(0,a._)(this,function(a){switch(a.label){case 0:return[4,Promise.all([e.log({max:100,revRange:t}),null!==r?e.log({max:100,revRange:"".concat(t,"..").concat(r)}):null,null!==r?e.log({max:100,revRange:"".concat(r,"..").concat(t)}):null])];case 1:if(n=a.sent(),s=(i=(0,o._)(n,3))[0],l=i[1],u=i[2],s.error)return[2,s];if(null==l?void 0:l.error)return[2,l];if(null==u?void 0:u.error)return[2,u];return[2,{error:null,both:s.commits,theirs:null!=(c=null==l?void 0:l.commits)?c:[],ours:null!=(d=null==u?void 0:u.commits)?d:[]}]}})})()},[t,r,l]);return[(0,s.useMemo)(function(){return null===f?{error:null}:f.error?f:{error:null,both:(0,d.filterKnownCommits)(f.both,f.theirs,f.ours),theirs:f.theirs,ours:f.ours}},[f]),c]},g=function(){var e=(0,c.default)().git,t=(0,o._)((0,s.useState)({loading:!1,error:null}),2),r=t[0],i=t[1];return[(0,s.useCallback)(function(t){var r=t.remote,o=t.branch,s=t.allowConflicts,u=void 0!==s&&s;return(0,n._)(function(){var t;return(0,a._)(this,function(n){switch(n.label){case 0:return i({loading:!0,error:null}),[4,e.pull({mode:l.GitPullMode.MERGE,allowConflicts:u,experimental_override_remote:{name:r,branch:o}})];case 1:return(t=n.sent()).error?i({loading:!1,error:t.error}):(i({loading:!1,error:null}),e.forceRefresh()),[2]}})})()},[e]),r]},m=function(e){var t,l,c,d,m,x,y,b,w,k,_,S,C,j,T,E=e.selectedReplId,R=(0,f.useSetupRemoteForReplId)(null!=E?E:null),I=(0,o._)(g(),2),A=I[0],P=I[1],D=(0,o._)((l=(t=(0,o._)(p(),2))[0],c=t[1],[(0,u.default)(function(e){return(0,n._)(function(){var t;return(0,a._)(this,function(n){switch(n.label){case 0:return[4,e.getRepositoryState()];case 1:return(t=n.sent()).error,[2,t]}})})()},[l]),c]),2),O=D[0],N=D[1],M=(0,o._)((m=(d=(0,o._)(p(),2))[0],x=d[1],[(0,u.default)(function(e){return(0,n._)(function(){var t;return(0,a._)(this,function(n){switch(n.label){case 0:return[4,e.status()];case 1:return(t=n.sent()).error,[2,t]}})})()},[m]),x]),1)[0],L=(0,o._)(h({ours:"main",theirs:E?(0,f.remoteBranchForRepl)({replId:E,branch:"main"}):null}),2),B=L[0],V=L[1],F=(0,o._)((b=(y={remoteName:E?(0,f.remoteNameForRepl)(E):null,onCompleted:function(){N(),V()}}).remoteName,w=y.onCompleted,_=(k=(0,o._)((0,s.useState)(!1),2))[0],S=k[1],j=(C=(0,o._)(p(),2))[0],T=C[1],(0,u.default)(function(e){return(0,n._)(function(){var t;return(0,a._)(this,function(n){switch(n.label){case 0:if(!b)return[2,{error:null}];return S(!0),[4,e.fetch({remote:b})];case 1:return t=n.sent(),S(!1),null==t.error&&w(),[2,t]}})})()},[b,j]),[_,T]),2);return{state:O,status:M,commits:B,isFetching:F[0],refetch:F[1],remote:R,pull:{state:P,doPull:function(e){"Success"===R.state&&A((0,i._)((0,r._)({},e),{remote:R.remote.name}))}}}},x=(0,s.createContext)(null);function y(){var e=(0,s.useContext)(x);if(null===e)throw Error("useProjectGitState must be used inside a ProjectGitStateProvider");return e}e.s(["ProjectGitStateContext",()=>x,"useProjectGitState",()=>y,"useProjectGitStateHooks",()=>m],538667);var b=e.i(886513),w=e.i(346715),k=e.i(276385),_=e.i(695784),S=e.i(569384),C=e.i(973245),j=e.i(304277);e.i(566901);var T=e.i(494948);function E(){var e=(0,S._)(["\n  fragment ProjectReplsComboBoxRepl on Repl {\n    id\n    ...ReplMergeRelatedRepl\n  }\n  ","\n"]);return E=function(){return e},e}function R(){var e=(0,S._)(["\n  query ProjectReplsComboBox($id: String!, $replsInput: ProjectReplsInput!) {\n    getRepl(id: $id) {\n      __typename\n      ... on Repl {\n        id\n        project {\n          id\n          mainRepl {\n            ...ProjectReplsComboBoxRepl\n          }\n          repls(input: $replsInput) {\n            items {\n              ...ProjectReplsComboBoxRepl\n            }\n            pageInfo {\n              nextCursor\n              hasNextPage\n            }\n          }\n        }\n      }\n    }\n  }\n  ","\n"]);return R=function(){return e},e}var I={},A=(0,C.gql)(E(),T.ReplMergeRelatedReplFragmentDoc),P=(0,C.gql)(R(),A),D=e.i(162914),O=e.i(98816),N=e.i(222342),M=e.i(125674),L=e.i(446530),B=e.i(613355),V=e.i(714165),F=e.i(880321),U=e.i(85742),G=e.i(624782),$=e.i(960178),z=e.i(625484),H=(0,L.cssRecord)({replSelector:[B.rcss.minWidth(300)],item:[B.rcss.display.grid,B.rcss.overflow("hidden"),{gap:4,gridAutoRows:"min-content",gridAutoFlow:"row",whiteSpace:"nowrap",textOverflow:"ellipsis"}]}),W=function(e){var t,l,u=e.replId,c=e.onSelect,d=e.selectedReplId,f=(0,b._)(e,["replId","onSelect","selectedReplId"]),p=(0,o._)((0,s.useState)(""),2),h=p[0],g=p[1],m=(0,D.default)(h,250),x=(0,N.default)().showError,y=(0,o._)((0,s.useState)({options:[],mainRepl:null,nextCursor:null}),2),S=y[0],C=y[1],T=(t={variables:{id:u,replsInput:{count:10,filters:{title:{search:m}}}},ssr:!1,fetchPolicy:"cache-and-network",notifyOnNetworkStatusChange:!0,onCompleted:function(e){var t,n,r,i=e&&"Repl"===e.getRepl.__typename&&(null==(t=e.getRepl.project)?void 0:t.__typename)==="Project"?e.getRepl.project:null,o=(null==i?void 0:i.repls.__typename)==="ReplConnection"?i.repls:null;i&&o||x("Something went wrong loading Apps - please try again."),C({mainRepl:null!=(n=null==i?void 0:i.mainRepl)?n:null,nextCursor:(null==o?void 0:o.pageInfo.hasNextPage)&&o.pageInfo.nextCursor?o.pageInfo.nextCursor:null,options:null!=(r=null==o?void 0:o.items)?r:[]})}},l=(0,r._)({},I,t),j.useQuery(P,l)),E=T.loading,R=T.refetch,A=T.networkStatus,L=(0,M.default)(function(){var e=S.mainRepl,t=S.options.filter(function(e){return e.id!==u});return""===m&&e&&e.id!==u?[e].concat((0,w._)(t.filter(function(t){return t.id!==e.id}))):t},[S,u,m]),B=(0,o._)((0,s.useState)(!1),2),W=B[0],q=B[1];(0,s.useEffect)(function(){if(!W){var e=L.find(function(e){return e.id===d});e&&(q(!0),""===h&&g(e.title))}},[W,h,d,L]);var K=(0,O.default)(c),Y=(0,s.useCallback)(function(e){var t=L.find(function(t){return t.id===e});t&&(K.current(t),g(t.title))},[L,K]);return(0,k.jsx)(F.ComboBox,(0,i._)((0,r._)({menuTrigger:"focus",inputValue:h,onInputChange:function(e){g(e)},onSelectionChange:Y,items:L,selectedKey:d,css:H.replSelector,isLoading:E,allowsEmptyCollection:!0,onLoadMore:function(){return(0,n._)(function(){var e,t,n,o,s,l;return(0,a._)(this,function(a){switch(a.label){case 0:if(!(S.nextCursor&&A!==_.NetworkStatus.fetchMore))return[3,2];return t=S.options,[4,R({id:u,replsInput:{count:10,filters:{title:{search:m}},cursor:S.nextCursor}})];case 1:(o=(n=a.sent())&&"Repl"===n.data.getRepl.__typename&&(null==(e=n.data.getRepl.project)?void 0:e.__typename)==="Project"&&"ReplConnection"===n.data.getRepl.project.repls.__typename?n.data.getRepl.project.repls:null)||x("Something went wrong loading Apps - please try again."),l=null!=(s=null==o?void 0:o.items)?s:[],C((0,i._)((0,r._)({},S),{nextCursor:(null==o?void 0:o.pageInfo.hasNextPage)&&o.pageInfo.nextCursor?o.pageInfo.nextCursor:null,options:t.concat(l)})),a.label=2;case 2:return[2]}})})()},emptyMessage:"No Apps found",maxHeight:200},f),{children:function(e){var t,n,r,i;return(0,k.jsxs)(U.BaseListBoxItem,{textValue:e.title,children:[(0,k.jsx)(V.Avatar,{src:null!=(r=null==(t=e.owner)?void 0:t.image)?r:"",username:null!=(i=null==(n=e.owner)?void 0:n.username)?i:"Unknown User",size:24}),(0,k.jsxs)(z.View,{css:H.item,children:[(0,k.jsx)($.Text,{children:e.title}),(0,k.jsxs)(z.View,{row:!0,gap:8,align:"center",children:[(0,k.jsx)($.Text,{children:e.owner?"@".concat(e.owner.username):""}),S.mainRepl&&S.mainRepl.id===e.id?(0,k.jsx)(G.Pill,{text:"Main Repl",variant:"filled"}):null]})]})]})}}))};e.s(["ProjectReplsComboBox",()=>W],183187);var q=e.i(937500),K=e.i(753950),Y=e.i(486161),Q=e.i(930856),X=e.i(221250),J=e.i(205104),Z=e.i(331148),ee=e.i(933974),et=e.i(296223),en=e.i(480028),er=e.i(88619),ei=e.i(136540),eo=e.i(630818),ea=e.i(396776),es=e.i(929872),el=e.i(369948),eu=e.i(576073),ec=e.i(462783),ed=e.i(940745),ef=e.i(42458),ep=[{"& > span:first-child-of-type":[B.rcss.flex.grow(1),B.rcss.textAlign.left]},{"& > span":[B.rcss.flex.shrink(1)]},B.rcss.height("auto"),B.rcss.p(8),B.rcss.fontWeight.medium,B.rcss.backgroundColor.backgroundHigher,B.rcss.flex.row,B.rcss.align.center,B.rcss.justify.spaceBetween,B.rcss.overflow("hidden"),B.rcss.cursor.pointer],eh=(0,L.cssRecord)({buttonFolded:[ep,B.rcss.borderRadius(8)],buttonUnfolded:[ep,B.rcss.borderRadius(8,8,0,0)],rowContainer:[B.rcss.position.relative,B.rcss.zIndex(1),B.rcss.overflow("hidden")],diffContainer:[B.rcss.borderRadius(8)],bodyContainer:[B.rcss.borderRadius(0,0,8,8),B.rcss.p(8),B.rcss.display.flex,B.rcss.flex.row,B.rcss.flex.wrap,B.rcss.align.center,B.rcss.justify.center,B.rcss.backgroundColor.backgroundDefault,B.rcss.border({color:en.tokens.outlineDimmer,direction:"bottom"}),B.rcss.border({color:en.tokens.outlineDimmer,direction:"left"}),B.rcss.border({color:en.tokens.outlineDimmer,direction:"right"})],noChangesContainer:[B.rcss.py(8),B.rcss.px(8),B.rcss.center,B.rcss.width("100%")],innerContainer:[B.rcss.display.flex,B.rcss.align.center],splitContainer:[B.rcss.display.flex,B.rcss.flex.row,B.rcss.justify.spaceBetween,B.rcss.maxWidth("100%"),B.rcss.align.center],splitChild:[{flexBasis:"50%"}]}),eg=function(e){var t=e.folded,n=void 0!==t&&t,r=e.setFolded,i=e.diff,o="".concat(i.initial.path,"/").concat(i.initial.filename),a="".concat(i.final.path,"/").concat(i.final.filename);return(0,k.jsxs)(z.View,{css:n?eh.buttonFolded:eh.buttonUnfolded,onClick:function(){return r(!n)},children:[(0,k.jsxs)(z.View,{css:[eh.rowContainer,B.rcss.flex.shrink(1)],align:"center",row:!0,gap:8,children:["RENAMED"===i.status||"COPIED"===i.status?(0,k.jsxs)(k.Fragment,{children:[(0,k.jsx)(eo.default,{path:o}),(0,k.jsx)($.Text,{multiline:!1,children:i.initial.filename}),""===i.initial.path?null:(0,k.jsx)($.Text,{multiline:!1,color:"dimmest",css:[B.rcss.fontWeight.normal],maxLines:1,children:i.initial.path}),(0,k.jsx)(el.default,{}),(0,k.jsx)(eo.default,{path:a}),(0,k.jsx)($.Text,{multiline:!1,children:i.final.filename}),""===i.final.path?null:(0,k.jsx)($.Text,{multiline:!1,color:"dimmest",css:[B.rcss.fontWeight.normal],children:i.final.path})]}):(0,k.jsxs)(k.Fragment,{children:[(0,k.jsx)(eo.default,{path:a}),(0,k.jsx)($.Text,{multiline:!1,children:i.final.filename}),""===i.final.path?null:(0,k.jsx)($.Text,{multiline:!1,color:"dimmest",css:[B.rcss.fontWeight.normal],children:i.final.path})]}),(0,k.jsx)(er.CopyIconButton,{textToCopy:a,tooltipText:"Copy Full Path",tooltipPlacement:"bottom-end"})]}),(0,k.jsxs)(z.View,{css:eh.rowContainer,align:"center",row:!0,gap:8,children:[(0,k.jsx)(ee.CommitFileType,{type:i.status}),(0,k.jsx)(ei.IconButton,{alt:n?"Collapse diff":"Expand diff",onClick:function(){return r(!n)},children:n?(0,k.jsx)(eu.default,{}):(0,k.jsx)(ec.default,{})})]})]})},em=function(e){var t=e.diff,n=e.splitOrUnified,r=e.extensions;return"Split"===n?(0,k.jsx)(Q.default,{a:{filePath:t.initial.filename,doc:t.initial.content},b:{filePath:t.final.filename,doc:t.final.content,extensions:r},collapseUnchanged:{},style:{width:"100%"}}):(0,k.jsx)(X.default,{filePath:t.final.filename,initialDoc:t.final.content,extensions:[Y.InlineDiff.of(K.Text.of(t.initial.content.split("\n")))],readOnly:!0,style:{width:"100%"}})},ev=function(e){return(0,J.isMedia)(e)?"media":(0,J.isOTFile)(e)?"ot":"binary"},ex=function(e){var t=e.content,n=e.type,r=e.filename,i=e.extensions;switch(n){case"media":return(0,k.jsx)(z.View,{css:[{display:"flex",height:"100%"}],children:(0,k.jsx)(et.Viewer,{src:(0,et.getMediaSrc)(t,(0,J.getMediaMime)(r)),fileName:r,mime:(0,J.getMediaMime)(r)})});case"ot":return(0,k.jsx)(X.default,{filePath:r,initialDoc:t,readOnly:!0,style:{width:"100%"},extensions:i});default:return(0,k.jsx)($.Text,{color:"dimmest",multiline:!1,children:"This binary file has changed."})}},ey=function(e){var t=e.diff,n=e.splitOrUnified,r=e.extensions;if(t.initial.content===t.final.content)return(0,k.jsx)(z.View,{css:eh.noChangesContainer,children:(0,k.jsx)($.Text,{color:"dimmest",multiline:!1,children:"There are no changes to show."})});if("DELETED"===t.status)return(0,k.jsx)(z.View,{css:eh.noChangesContainer,children:(0,k.jsx)($.Text,{color:"dimmest",multiline:!1,children:"This file has been deleted."})});var i=(0,Z.default)(q.Buffer.from(t.initial.content))?"binary":ev(t.initial.filename),o=(0,Z.default)(q.Buffer.from(t.final.content))?"binary":ev(t.final.filename);if("binary"===i||"binary"===o)return(0,k.jsx)(z.View,{css:eh.noChangesContainer,children:(0,k.jsx)($.Text,{color:"dimmest",multiline:!1,children:"This binary file has changed."})});if("ADDED"===t.status)switch(o){case"media":return(0,k.jsx)(z.View,{css:eh.noChangesContainer,children:(0,k.jsx)(z.View,{css:eh.innerContainer,children:(0,k.jsx)(et.Viewer,{src:(0,et.getMediaSrc)(t.final.content,(0,J.getMediaMime)(t.final.filename)),fileName:t.final.filename,mime:(0,J.getMediaMime)(t.final.filename)})})});case"ot":return(0,k.jsx)(z.View,{css:eh.noChangesContainer,children:(0,k.jsx)(X.default,{filePath:t.final.filename,initialDoc:t.final.content,readOnly:!0,style:{width:"100%"},extensions:r})});default:return(0,k.jsx)(z.View,{css:eh.noChangesContainer,children:(0,k.jsx)($.Text,{color:"dimmest",multiline:!1,children:"This binary file has been added."})})}return"ot"===i&&"ot"===o?(0,k.jsx)(em,{diff:t,splitOrUnified:n,extensions:r}):(0,k.jsxs)(z.View,{css:eh.splitContainer,p:8,children:[(0,k.jsx)(z.View,{css:eh.splitChild,align:"center",justify:"center",children:(0,k.jsx)(ex,{content:t.initial.content,type:i,filename:t.initial.filename,extensions:r})}),(0,k.jsx)(z.View,{css:eh.splitChild,children:(0,k.jsx)(ex,{content:t.final.content,type:o,filename:t.final.filename,extensions:r})})]})},eb=function(e){var t=e.diff,l=e.fetchDiffFileContents,u=e.splitOrUnified,c=(0,o._)((0,s.useState)({expanded:!1,loading:!1,content:null,error:null}),2),d=c[0],f=c[1];return(0,k.jsxs)(z.View,{css:eh.diffContainer,grow:!0,children:[(0,k.jsx)(eg,{folded:!d.expanded,setFolded:function(e){return(0,n._)(function(){var n;return(0,a._)(this,function(o){switch(o.label){case 0:if(f((0,i._)((0,r._)({},d),{expanded:!e,loading:null==d.content})),e)return[3,2];return[4,l(t)];case 1:n=o.sent(),f(function(e){return(0,i._)((0,r._)({},e),{loading:!1,error:n.error?n.error:null,content:null==n.error?{initial:n.content.base,final:n.content.head}:null})}),o.label=2;case 2:return[2]}})})()},diff:t}),d.expanded?(0,k.jsxs)(es.Surface,{css:eh.bodyContainer,elevated:!0,children:[d.error?(0,k.jsx)(ea.StatusBanner,{colorway:"negative",icon:(0,k.jsx)(ef.default,{}),text:d.error}):null,d.loading?(0,k.jsx)(z.View,{p:8,children:(0,k.jsx)(ed.default,{})}):null,d.content?(0,k.jsx)(ey,{diff:(0,i._)((0,r._)({},t),{initial:(0,i._)((0,r._)({},t.initial),{content:d.content.initial}),final:(0,i._)((0,r._)({},t.final),{content:d.content.final})}),splitOrUnified:u}):null]}):null]},t.id)};e.s(["DiffViewer",()=>eb],172588);var ew=((t={}).Git="Git",t.Fs="Fs",t);function ek(e){return(0,n._)(function(e){var t,r,i;return(0,a._)(this,function(o){switch(o.label){case 0:if(t=e.file,r=e.fs,i=e.git,"Fs"!==t.type)return[3,2];return[4,function(e){return(0,n._)(function(e){var t,n;return(0,a._)(this,function(r){switch(r.label){case 0:return t=e.path,[4,e.fs.readFile(t,{fromDisk:!0})];case 1:if((n=r.sent()).error)return[2,{content:null,error:n.error}];return[2,{content:n.content.toString("utf8"),error:null}]}})}).apply(this,arguments)}({path:t.path,fs:r})];case 1:case 3:return[2,o.sent()];case 2:return[4,i.getFileContents({path:t.path,revision:t.revision,convertToBase64:(0,J.isMedia)(t.path)})]}})}).apply(this,arguments)}function e_(e){return(0,n._)(function(){var t,n,r,i,s,l,u,c,d,f,p;return(0,a._)(this,function(a){switch(a.label){case 0:return t=e.fs,n=e.git,r=e.base,i=e.head,c=Promise.all,[4,ek({git:n,fs:t,file:i})];case 1:return d=[a.sent()],[4,ek({git:n,fs:t,file:r})];case 2:return[4,c.apply(Promise,[d.concat([a.sent()])])];case 3:if(l=(s=o._.apply(void 0,[a.sent(),2]))[0],(u=s[1]).error)return[2,{error:"fetchFileContentsForDiff could not fetch base file from ".concat(r.type," for ").concat(r.path),content:null}];if(l.error)return[2,{error:"fetchFileContentsForDiff could not fetch base file from ".concat(i.type," for ").concat(i.path),content:null}];return[2,{error:null,content:{base:null!=(f=u.content)?f:"",head:null!=(p=l.content)?p:""}}]}})})()}e.s(["FetchFileType",()=>ew,"fetchFileContentsForDiff",()=>e_],432052)},598534,e=>{"use strict";var t=e.i(297083),n=e.i(530658),r=e.i(346715),i=e.i(817556),o=e.i(972291);function a(e){switch(e){case"A":return o.GitCommitFileType.ADDED;case"C":return o.GitCommitFileType.COPIED;case"D":return o.GitCommitFileType.DELETED;case"M":return o.GitCommitFileType.MODIFIED;case"R":return o.GitCommitFileType.RENAMED;case"T":return o.GitCommitFileType.TYPE_CHANGED;case"X":default:return o.GitCommitFileType.UNKNOWN;case"B":return o.GitCommitFileType.BROKEN}}function s(e){return Array.from(e.matchAll(c)).map(function(e){var t=(0,n._)(e,4),r=t[1],i=t[2];return{path:t[3],originalPath:i,type:a(r)}})}function l(e){return Array.from(e.matchAll(u)).map(function(e){var t=(0,n._)(e,3),r=t[1];return{path:t[2],type:a(r)}})}var u=/([ADMUXBT])\0([^\0]+)/g,c=/([RC])\d*\0([^\0]+)\0([^\0]+)/g;function d(e,n){return(0,t._)(function(){var a,u,c;return(0,i._)(this,function(d){switch(d.label){case 0:return[4,(0,t._)(function(){var t;return(0,i._)(this,function(r){switch(r.label){case 0:return[4,e("git log -1 --pretty=%P ".concat(n))];case 1:if((t=r.sent()).error)return[2,!1];return[2,t.output.trim().length>0]}})})()];case 1:if(!d.sent())return[2,(0,t._)(function(){var t,r,a,s,l,u,c,d,f;return(0,i._)(this,function(i){switch(i.label){case 0:return[4,e("git ls-tree --name-only -r ".concat(n),{serviceMethod:"git-get-files-for-commit"})];case 1:if((t=i.sent()).error)return[2,t];r=[],a=t.output.split("\n").filter(Boolean),s=!0,l=!1,u=void 0;try{for(c=a[Symbol.iterator]();!(s=(d=c.next()).done);s=!0)f=d.value,r.push({path:f,type:o.GitCommitFileType.ADDED})}catch(e){l=!0,u=e}finally{try{s||null==c.return||c.return()}finally{if(l)throw u}}return[2,{files:r,error:null}]}})})()];return[4,e("git diff-tree --no-commit-id --name-status -z -r -C --find-copies-harder -M ".concat(n),{serviceMethod:"git-get-files-for-commit"})];case 2:if((a=d.sent()).error)return[2,a];return u=s(a.output),c=l(a.output),[2,{files:(0,r._)(u).concat((0,r._)(c)),error:null}]}})})()}e.s(["default",()=>d,"getChangedFilesExcludingRenamesAndCopies",()=>l,"getRenamedOrCopiedFiles",()=>s])},986091,301736,773422,25082,e=>{"use strict";var t=e.i(276385),n=e.i(297083),r=e.i(530658),i=e.i(817556),o=e.i(389959),a=e.i(125674),s=e.i(529810),l=e.i(172588),u=e.i(432052),c=e.i(878420),d=e.i(64386),f=e.i(346715),p=e.i(15053),h=e.i(598534),g=e.i(205104),m=e.i(825118),x=e.i(569910),y=e.i(597865),b={z:!0,findCopies:!0,findCopiesHarder:!0,findRenames:!0,nameStatus:!0},w={z:"-z",findCopies:"--find-copies",findCopiesHarder:"--find-copies-harder",findRenames:"--find-renames",nameStatus:"--name-status"},k=e.i(972291),_=e.i(234961),S=e.i(538667);function C(e){switch(e){case _.GitStatusChangedFileType.UNMODIFIED:return null;case _.GitStatusChangedFileType.MODIFIED:return k.GitCommitFileType.MODIFIED;case _.GitStatusChangedFileType.TYPE_CHANGED:return k.GitCommitFileType.TYPE_CHANGED;case _.GitStatusChangedFileType.DELETED:return k.GitCommitFileType.DELETED;case _.GitStatusChangedFileType.RENAMED:return k.GitCommitFileType.RENAMED;case _.GitStatusChangedFileType.COPIED:return k.GitCommitFileType.COPIED;case _.GitStatusChangedFileType.UNTRACKED:case _.GitStatusChangedFileType.UNMERGED:case _.GitStatusChangedFileType.ADDED:return k.GitCommitFileType.ADDED;default:(0,x.default)(e)}}var j=e.i(51054),T=e.i(960178),E=e.i(625484),R=e.i(304662),I=e.i(189373),A=e.i(940745),P=function(e,t){return""===e?t:"".concat(e,"/").concat(t)};function D(e,t){return t.filter(function(t){var n="".concat(t.final.path,"/").concat(t.final.filename),r="".concat(t.initial.path,"/").concat(t.initial.filename);return n.toLowerCase().includes(e.toLowerCase())||r.toLowerCase().includes(e.toLowerCase())})}function O(e){var n=e.children,r=e.headerContent;return(0,t.jsxs)(E.View,{gap:16,children:[(0,t.jsxs)(E.View,{row:!0,gap:8,align:"center",justify:"space-between",children:[(0,t.jsx)(T.Header,{level:2,variant:"subheadDefault",children:"Changed Files"}),r]}),n]})}function N(e){var _,N,M,L,B,V,F=(0,s.default)(),U=F.fs,G=F.git,$=(0,r._)((0,o.useState)(""),2),z=$[0],H=$[1],W=(0,r._)((0,o.useState)("Split"),2),q=W[0],K=W[1],Y=(_={type:"revisionToRevisionDiff",head:e.head,base:e.base},N=(0,d._)((0,c._)({},_),{flags:(0,d._)((0,c._)({},b),{nameStatus:!0})}),M=(0,y.default)(function(e){return(0,n._)(function(){var t,n;return(0,i._)(this,function(r){switch(r.label){case 0:return t=function(e){var t,n=e.base,r=null!=(t=e.flags)?t:b,i=["git","diff"];switch(Object.keys(r).forEach(function(e){w[e]&&i.push(w[e])}),e.type){case"revisionToRevisionDiff":i.push("".concat(n,"...").concat(e.head));break;case"revisionToIndexDiff":i.push("--staged",n);break;default:(0,x.default)(e)}return i}(N),[4,e.escapeHatchGitExecRead(t.join(" "),{serviceMethod:"useGitDiff"})];case 1:if((n=r.sent()).error||null===n.output)return[2,{error:m.GitErrors.UNKNOWN}];return[2,{diff:n.output,error:null}]}})})()}),L=(0,a.default)(function(){return null==M?{loading:!0,error:null,data:null}:M.error?{loading:!1,error:M.error,data:null}:{loading:!1,error:null,data:M.diff}},[M]),(0,a.default)(function(){if(null==L||L.loading)return{loading:!0,error:null,data:null};if(L.error)return{loading:!1,error:L.error,data:null};var e,t=null!=(e=L.data)?e:"",n=(0,h.getRenamedOrCopiedFiles)(t),r=(0,h.getChangedFilesExcludingRenamesAndCopies)(t);return{loading:!1,error:null,data:Array.from(new Set((0,f._)(n).concat((0,f._)(r)))).filter(function(e){return["DELETED","ADDED","MODIFIED","COPIED","RENAMED","TYPE_CHANGED"].includes(e.type)}).map(function(e){var t,n;return{id:(0,p.v4)(),status:e.type,initial:{filename:(0,g.getFileName)(null!=(t=e.originalPath)?t:e.path),path:(0,g.getParentPath)(null!=(n=e.originalPath)?n:e.path)},final:{filename:(0,g.getFileName)(e.path),path:(0,g.getParentPath)(e.path)}}})}},[L])),Q=(0,a.default)(function(){var e;return D(z,null!=(e=Y.data)?e:[])},[z,Y]),X=function(t){return(0,n._)(function(){return(0,i._)(this,function(n){switch(n.label){case 0:return[4,(0,u.fetchFileContentsForDiff)({git:G,fs:U,base:{type:u.FetchFileType.Git,revision:e.base,path:P(t.initial.path,t.initial.filename)},head:{type:u.FetchFileType.Git,revision:e.head,path:P(t.final.path,t.final.filename)}})];case 1:return[2,n.sent()]}})})()},J=(B=(0,S.useProjectGitState)().status,V=(0,a.default)(function(){return B&&null==B.error?B.changes:[]},[B]),(0,a.default)(function(){return V.map(function(e){var t,n,r,i,o=null!=(r=null!=(n=C(e.type.worktree))?n:C(e.type.index))?r:k.GitCommitFileType.UNKNOWN,a=null!=(i=null==(t=e.source)?void 0:t.path)?i:e.path;return{id:(0,p.v4)(),status:o,initial:{filename:(0,g.getFileName)(a),path:(0,g.getParentPath)(a)},final:{filename:(0,g.getFileName)(e.path),path:(0,g.getParentPath)(e.path)}}})},[V])),Z=(0,a.default)(function(){return D(z,J)},[z,J]),ee=function(e){return(0,n._)(function(){return(0,i._)(this,function(t){switch(t.label){case 0:return[4,(0,u.fetchFileContentsForDiff)({git:G,fs:U,base:{type:u.FetchFileType.Git,revision:"HEAD",path:P(e.initial.path,e.initial.filename)},head:{type:u.FetchFileType.Fs,path:P(e.final.path,e.final.filename)}})];case 1:return[2,t.sent()]}})})()};return Y.loading?(0,t.jsx)(O,{children:(0,t.jsx)(A.default,{})}):Y.error||null==Y.data?(0,t.jsx)(O,{children:(0,t.jsx)(T.Text,{children:"Something went wrong. Please try another Repl."})}):0===Y.data.length&&0===J.length?(0,t.jsx)(O,{children:(0,t.jsxs)(E.View,{row:!0,gap:4,align:"center",children:[(0,t.jsx)(I.default,{}),(0,t.jsx)(T.Text,{children:"No changes to merge"})]})}):(0,t.jsx)(O,{headerContent:(0,t.jsxs)(E.View,{row:!0,gap:8,children:[(0,t.jsx)(R.SplitOrUnifiedDiffButton,{value:q,onChange:K}),(0,t.jsx)(j.SearchBar,{value:z,onChange:function(e){H(e.target.value)},onClear:function(){H("")},loading:!1,placeholder:"Filter changed files"})]}),children:(0,t.jsxs)(E.View,{gap:12,children:[Z.length?(0,t.jsxs)(E.View,{gap:8,children:[(0,t.jsx)(T.Header,{level:3,variant:"text",color:"dimmer",children:"Uncommitted Changes"}),Z.map(function(e){return(0,t.jsx)(l.DiffViewer,{diff:e,splitOrUnified:q,fetchDiffFileContents:ee},e.id)})]}):null,Q.length?(0,t.jsxs)(E.View,{gap:8,children:[(0,t.jsx)(T.Header,{level:3,variant:"text",color:"dimmer",children:"Committed Changes"}),Q.map(function(e){return(0,t.jsx)(l.DiffViewer,{diff:e,splitOrUnified:q,fetchDiffFileContents:X},e.id)})]}):null]})})}var M=e.i(875259),L=function(e){var n=e.selectedRepl,r=e.isMainRepl,i=(0,M.remoteBranchForRepl)({replId:n.id,branch:"main"}),o="HEAD";return(0,t.jsx)(N,{base:r?o:i,head:r?i:o})};e.s(["ChangesSection",()=>L],986091);var B=e.i(396776),V=e.i(363201);function F(){var e=(0,r._)((0,o.useState)(!1),2),n=e[0],i=e[1],a=(0,s.default)().fs;return(0,o.useEffect)(function(){var e=!1,t=a.watchPathStat(".gitignore",{onNewStat:function(t){e||i(!t.exists)},onError:function(){}});return function(){e=!0,t()}},[a]),n?(0,t.jsx)(B.StatusBanner,{icon:(0,t.jsx)(V.default,{}),text:(0,t.jsxs)(T.Text,{children:["This project does not have a .gitignore file. It is recommended that all projects have a .gitignore file. You can find templates for .gitignore files for different languages"," ",(0,t.jsx)("a",{href:"https://github.com/github/gitignore",target:"_blank",rel:"noopener noreferrer",children:"here"}),"."]})}):null}e.s(["GitIgnoreWarning",()=>F],301736);var U=e.i(412160),G=e.i(10581),$=e.i(185591);function z(e){var r=e.selectedRepl,o=(0,y.default)(function(e){return(0,n._)(function(){var t;return(0,i._)(this,function(n){switch(n.label){case 0:return[4,e.getRepositoryState()];case 1:if((t=n.sent()).error)return[2,{error:null,message:"Something went wrong, this Repl's git state could not be read. Please make sure there is still a .git folder."}];if(t.state!==G.GitRepositoryState.CLEAN)return[2,{error:null,message:"This Repl has uncommitted changes. This will prevent any merges. Please undo or commit your changes before leaving the Repl."}];return[2,{error:null,message:null}]}})})()}),a=null==o?void 0:o.message;return(0,t.jsxs)(E.View,{gap:12,children:[(0,t.jsx)(T.Header,{level:2,variant:"subheadDefault",children:"Main Repl"}),(0,t.jsxs)(T.Text,{children:["You are in the main Repl for the project. If you want to merge in changes, head to"," ",r?(0,t.jsx)(U.default,(0,d._)((0,c._)({target:"_blank"},(0,$.replLinkProps)(r,{initialPaneType:"project"})),{children:r.title})):"a fork","."]}),a?(0,t.jsx)(B.StatusBanner,{icon:(0,t.jsx)(V.default,{}),colorway:"negative",text:a}):null]})}e.s(["MainReplSection",()=>z],773422);var H=e.i(569384),W=e.i(973245),q=e.i(304277);e.i(566901);var K=e.i(655366);function Y(){var e=(0,H._)(["\n  query PushToRemoteRepl($id: String!) {\n    getRepl(id: $id) {\n      ... on Repl {\n        id\n        title\n        ...CrosisContextRepl\n      }\n    }\n    currentUser {\n      id\n      ...CrosisContextCurrentUser\n    }\n  }\n  ","\n  ","\n"]);return Y=function(){return e},e}var Q={},X=(0,W.gql)(Y(),K.CrosisContextReplFragmentDoc,K.CrosisContextCurrentUserFragmentDoc);function J(e){var t=(0,c._)({},Q,e);return q.useQuery(X,t)}e.s(["usePushToRemoteReplQuery",()=>J],25082)},556171,e=>{"use strict";function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.session,r=e.askpass,i=e.author,o=e.committer,a={GIT_AUTHOR_NAME:"",GIT_AUTHOR_EMAIL:"",GIT_COMMITTER_NAME:"",GIT_COMMITTER_EMAIL:"",GIT_ASKPASS:"replit-git-askpass",GIT_PAGER:"",GIT_EDITOR:"",PAGER:"",EDITOR:""};if(void 0!==t&&(a.REPLIT_SESSION=t,a.REPLIT_ASKPASS_PID2_SESSION=t),void 0!==r&&(a.GIT_ASKPASS=r),i){a.GIT_AUTHOR_NAME=i.username,a.GIT_COMMITTER_NAME=i.username;var s=n(i);a.GIT_AUTHOR_EMAIL=s,a.GIT_COMMITTER_EMAIL=s,o&&(a.GIT_COMMITTER_NAME=o.username,a.GIT_COMMITTER_EMAIL=n(o))}return a}function n(e){if("id"in e)return"".concat(e.id,"-").concat(e.username,"@users.noreply.replit.com");if("email"in e)return e.email;throw Error("Invalid user")}e.s(["createGitServiceEnvironmentVariables",()=>t])},760890,e=>{"use strict";var t=e.i(297083),n=e.i(346715),r=e.i(817556),i=e.i(825118),o=e.i(861392),a=e.i(627557);function s(e,s){return(0,t._)(function(e,t){var s,l,u,c,d;return(0,r._)(this,function(r){switch(r.label){case 0:if(s=t.name,l=t.url,c=void 0!==(u=t.fetch)&&u,s=(0,a.removeRemoteRefsPath)(s),!(0,o.isValidRemoteName)(s))return[2,{error:i.GitErrors.INVALID_REFERENCE,extras:{remote:s}}];return s=(0,a.wrapInSingleQuotes)(s),l=(0,a.wrapInSingleQuotes)(l),[4,e(["git remote add"].concat((0,n._)(c?["-f"]:[]),[s,l]).join(" "),{serviceMethod:"git-add-remote"})];case 1:if((d=r.sent()).error)return[2,d];return[2,{didFetch:d.output.includes("Updating"),error:null}]}})}).apply(this,arguments)}e.s(["gitAddRemote",()=>s],760890)},480539,52221,598016,387539,118711,370451,861683,e=>{"use strict";var t=e.i(297083),n=e.i(817556),r=e.i(825118),i=e.i(861392),o=e.i(625108);function a(e,a){return(0,t._)(function(){var t,s,l,u,c,d;return(0,n._)(this,function(n){switch(n.label){case 0:if(t=(a=(0,i.getFullBranchName)(a)).startsWith("refs/heads/"),s=a.startsWith("refs/remotes/"),t)return[3,2];return l=s?a:"refs/remotes/".concat(a),[4,e("git show-ref --verify ".concat(l),{serviceMethod:"git-branch-exists"})];case 1:if(!(u=n.sent()).error)return[2,{exists:!0,ref:(0,o.parseGitRef)(l),error:null}];if(u.error!==r.GitErrors.INVALID_REFERENCE)return[2,u];n.label=2;case 2:if(s)return[3,4];return c=t?a:"refs/heads/".concat(a),[4,e("git show-ref --verify ".concat(c),{serviceMethod:"git-branch-exists"})];case 3:if(!(d=n.sent()).error)return[2,{exists:!0,ref:(0,o.parseGitRef)(c),error:null}];if(d.error!==r.GitErrors.INVALID_REFERENCE)return[2,d];n.label=4;case 4:return[2,{exists:!1,ref:null,error:null}]}})})()}e.s(["default",()=>a],52221),e.s(["gitBranchExists",()=>a],480539);var s=e.i(627557);function l(e,r,o){return(0,t._)(function(){var t,a,l;return(0,n._)(this,function(n){switch(n.label){case 0:if((0,i.isSameBranchRef)(r,o)){if(r=(0,i.getQualifiedBranchName)(r,!0),o=(0,i.getQualifiedBranchName)(o),r===o)return[2,{canMerge:!0,error:null}]}else r=(0,i.getQualifiedBranchName)(r),o=(0,i.getQualifiedBranchName)(o);return r=(0,s.wrapInSingleQuotes)(r),o=(0,s.wrapInSingleQuotes)(o),t="git merge-base ".concat(r," ").concat(o),a='git merge-tree "$('.concat(t,')" ').concat(r," ").concat(o),[4,e("set -eo pipefail; (".concat(a," | ").concat("( (grep -q -e '^+<* \\.our$' && echo '1') || echo '0')",") || test $? -eq 141"),{serviceMethod:"git-can-merge-branches"})];case 1:if((l=n.sent()).error)return[2,l];return[2,{canMerge:"0"===l.output,error:null}]}})})()}e.s(["default",()=>l],598016),e.s(["gitCanMergeBranches",()=>l],387539);var u=e.i(530658),c=e.i(346715),d=e.i(960933);function f(e,r){return(0,t._)(function(){var t,i;return(0,n._)(this,function(n){switch(n.label){case 0:return[4,e(function(e){var t=e.message,n=e.trailers,r=e.files,i=e.allowEmpty,o=e.noVerify,a=["--allow-empty-message","--cleanup=whitespace","--no-edit","--quiet","-m ".concat((0,s.wrapInSingleQuotes)(t))];if(n){var l=!0,d=!1,f=void 0;try{for(var p,h=Object.entries(n)[Symbol.iterator]();!(l=(p=h.next()).done);l=!0){var g=(0,u._)(p.value,2),m=g[0],x=g[1],y=(0,s.wrapInSingleQuotes)("".concat(m,":").concat((0,s.formatTrailer)(x)));a.push("--trailer ".concat(y))}}catch(e){d=!0,f=e}finally{try{l||null==h.return||h.return()}finally{if(d)throw f}}}return(void 0===i||i)&&a.push("--allow-empty"),(void 0===o||o)&&a.push("--no-verify"),r&&a.push.apply(a,["--only","--"].concat((0,c._)(r.map(s.wrapInSingleQuotes)))),"git --literal-pathspecs commit ".concat(a.join(" "))}(r),{serviceMethod:"git-commit"})];case 1:if((t=n.sent()).error)return[2,t];return[4,e("git rev-parse HEAD",{serviceMethod:"git-commit"})];case 2:if((i=n.sent()).error)return[2,i];return[2,{hash:i.output,error:null}]}})})()}d.Type.Object({message:d.Type.String(),trailers:d.Type.Optional(d.Type.Record(d.Type.String(),d.Type.String())),noVerify:d.Type.Optional(d.Type.Boolean()),files:d.Type.Optional(d.Type.Array(d.Type.String())),allowEmpty:d.Type.Optional(d.Type.Boolean())}),e.s(["gitCommit",()=>f],118711);var p=e.i(705705),h=e.i(878420);function g(e,o){return(0,t._)(function(){var l,u,c,d,f;return(0,n._)(this,function(g){switch(g.label){case 0:return[4,a(e,o=(0,i.getFullBranchName)(o,!0))];case 1:if((l=g.sent()).error)return[2,l];if(!l.exists)return[2,{error:r.GitErrors.INVALID_REFERENCE,extras:{branch:o}}];if(u={guess:!1},l.ref.type!==p.GitRefType.REMOTE_BRANCH)return[3,3];return d=l.ref.branch,[4,a(e,"refs/heads/".concat(d))];case 2:if((f=g.sent()).error)return[2,f];return f.exists?c=f.ref:(u.track=!0,u.newBranch=d,c=l.ref),[3,4];case 3:c=l.ref,g.label=4;case 4:var m;return m=(0,h._)({branchRef:c},u),[2,(0,t._)(function(){var t,r;return(0,n._)(this,function(n){switch(n.label){case 0:return t=["--quiet"],m.guess||t.push("--no-guess"),(m.newBranch&&void 0===m.track||m.track)&&t.push("--track"),m.force&&t.push("-f"),m.newBranch&&t.push("-b",m.newBranch),t.push((0,s.wrapInSingleQuotes)(m.branchRef.name),"--"),[4,e("git checkout ".concat(t.join(" ")),{serviceMethod:"git-checkout"})];case 1:if((r=n.sent()).error)return[2,r];return[2,{ok:!0,error:null}]}})})()]}})})()}function m(e,i){return(0,t._)(function(e,t){var i,o,l,u,c,d,f,h,m,x,y;return(0,n._)(this,function(n){switch(n.label){case 0:return i=t.name,l=void 0===(o=t.startPoint)?"HEAD":o,u=t.track,d=void 0!==(c=t.checkout)&&c,[4,a(e,i=(0,s.removeBranchRefsPath)(i))];case 1:if((f=n.sent()).error)return[2,f];if(f.exists)return[2,{error:r.GitErrors.BRANCH_ALREADY_EXISTS,extras:{branch:i}}];if("HEAD"===l){if(!0===u)return[2,{error:r.GitErrors.INVALID_REFERENCE,extras:{branch:i}}];u=!1}if(!1===u)return[3,3];return[4,a(e,l)];case 2:if((h=n.sent()).error)return[2,h];if(!h.exists&&!0===u)return[2,{error:r.GitErrors.INVALID_REFERENCE,extras:{branch:i}}];h.exists&&h.ref.type===p.GitRefType.REMOTE_BRANCH&&void 0===u&&(u=!0),n.label=3;case 3:return m=["--quiet",u?"--track":"--no-track",(0,s.wrapInSingleQuotes)(i),(0,s.wrapInSingleQuotes)(l)],[4,e("git branch ".concat(m.join(" ")),{serviceMethod:"git-create-branch"})];case 4:if((x=n.sent()).error)return[2,x];if(!d)return[3,6];return[4,g(e,i)];case 5:if((y=n.sent()).error)return[2,y];n.label=6;case 6:return[2,{error:null}]}})}).apply(this,arguments)}d.Type.Object({branchRef:d.Type.Union([p.GitBranchRefSchema,p.GitRemoteBranchRefSchema]),guess:d.Type.Optional(d.Type.Boolean()),newBranch:d.Type.Optional(d.Type.String()),track:d.Type.Optional(d.Type.Boolean()),force:d.Type.Optional(d.Type.Boolean())}),e.s(["default",()=>g],370451),e.s(["gitCreateBranch",()=>m],861683)},200437,633386,997229,e=>{"use strict";var t=e.i(297083),n=e.i(346715),r=e.i(817556),i=e.i(960933),o=e.i(627557);function a(e){return(0,t._)(function(e){var t,i,a,s,l,u=arguments;return(0,r._)(this,function(r){switch(r.label){case 0:return t=u.length>1&&void 0!==u[1]?u[1]:{},i=["--quiet"],t.depth&&(a=t.deepen?"--deepen":"--depth",i.push("".concat(a,"=").concat(t.depth))),t.remote?i.push((0,o.wrapInSingleQuotes)(t.remote)):i.push("--all"),!1===t.tags&&i.push("--no-tags"),t.refs&&t.refs.length>0&&(s=i).push.apply(s,(0,n._)(t.refs)),[4,e("git fetch ".concat(i.join(" ")),{serviceMethod:"git-fetch"})];case 1:if((l=r.sent()).error)return[2,l];return[2,{error:null}]}})}).apply(this,arguments)}i.Type.Object({remote:i.Type.Optional(i.Type.String()),depth:i.Type.Optional(i.Type.Number()),deepen:i.Type.Optional(i.Type.Boolean()),tags:i.Type.Optional(i.Type.Boolean()),refs:i.Type.Optional(i.Type.Array(i.Type.String()))}),e.s(["default",()=>a],633386),e.s(["gitFetch",()=>a],200437);var s=e.i(625108),l=["main","master","trunk","dev","develop","development","staging","prod","production"].map(function(e){return'if [ $(git rev-parse --verify --quiet "heads/'.concat(e,'") ]; then\n      echo "refs/heads/').concat(e,'"\n    fi')}).join("\n"),u='\ngit remote | while IFS= read -r remote; do\n  if [ -z "$remote" ]; then continue; fi\n  if [ "$remote" = "gitsafe-backup" ]; then continue; fi\n  branch="$('.concat('\nif [ -f ".git/refs/remotes/$remote/HEAD" ]; then\n  echo "$(sed -e "s/^ref: refs\\/remotes\\/$remote\\///" < .git/refs/remotes/$remote/HEAD)"\nelse\n  remote_result="$(git ls-remote --symref "$remote" HEAD)"\n  if [ -z "$remote_result" ]; then\n    echo ""\n  else\n    branch_name="$(\n      echo "$remote_result" | \\\n      head -1 | \\\n      awk \'{print $2}\' | \\\n      sed -e "s/^refs\\/heads\\///"\n    )"\n    git remote set-head "$remote" "$branch_name" >&2\n    echo "$branch_name"\n  fi\nfi\n'.trim(),')"\n  if [ -z "$branch" ]; then continue; fi\n  echo "refs/remotes/$remote/$branch"\n  if [ $(git rev-parse --verify --quiet "heads/$branch") ]; then\n    echo "refs/heads/$branch"\n  fi\ndone\n').concat(l,"\n").trim();function c(e){return(0,t._)(function(){var t;return(0,r._)(this,function(r){switch(r.label){case 0:return[4,e(u,{serviceMethod:"git-find-default-branches"})];case 1:if((t=r.sent()).error)return[2,t];return[2,{refs:(0,n._)(new Set((0,o.splitTrimFilter)(t.output,"\n"))).map(function(e){return(0,s.parseGitRef)(e)}),error:null}]}})})()}e.s(["gitFindDefaultBranches",()=>c],997229)},221856,e=>{"use strict";var t=e.i(297083),n=e.i(530658),r=e.i(817556),i=e.i(825118),o=e.i(861392),a=e.i(627557),s=e.i(680183),l=e.i(167193);function u(e,u){return(0,t._)(function(){var t,c,d,f,p,h,g,m,x,y,b,w;return(0,r._)(this,function(r){switch(r.label){case 0:if(u=(0,o.getQualifiedBranchName)(u,!0),!(0,o.isValidBranchName)(u))return[2,{error:i.GitErrors.INVALID_REFERENCE,extras:{branch:u}}];return t=(0,a.removeBranchRefsPath)(u),d=(c=(0,n._)((0,a.splitRemoteFromBranch)(u),2))[0],f=c[1],p=["refs/heads/".concat(t),"refs/remotes/*/".concat(t)],d&&f&&(p.push("refs/heads/".concat(f)),p.push("refs/remotes/".concat(d,"/").concat(f))),[4,(0,l.default)(e,{pattern:p})];case 1:if((h=r.sent()).error)return[2,h];if(0===h.branches.length)return[2,{error:i.GitErrors.INVALID_REFERENCE,extras:{branch:u}}];g=!0,m=!1,x=void 0;try{for(y=h.branches[Symbol.iterator]();!(g=(b=y.next()).done);g=!0)if((w=b.value).type!==s.GitBranchType.REMOTE&&w.name===t||d&&f&&w.type!==s.GitBranchType.LOCAL&&w.remote===d&&w.name===f)return[2,{branch:w,error:null}]}catch(e){m=!0,x=e}finally{try{g||null==y.return||y.return()}finally{if(m)throw x}}return[2,{error:i.GitErrors.INVALID_REFERENCE,extras:{branch:u}}]}})})()}e.s(["gitGetBranch",()=>u],221856)},879737,721035,846849,126416,520779,e=>{"use strict";var t=e.i(297083),n=e.i(530658),r=e.i(817556),i=e.i(960933),o=e.i(627557),a=e.i(972291),s=/(?:(?:[ADMTU]\0[^\0]+?)|(?:[RC][0-9]+\0[^\0]+?\0[^\0]+?))(?=\0|$)/g,l=/([ACDMRTU])([0-9]+)?\0([^\0]+?)(?:\0([^\0]+?))?$/;function u(e,i){return(0,t._)(function(){var t,u,c,d,f,p,h,g,m,x,y,b,w,k,_;return(0,r._)(this,function(r){switch(r.label){case 0:return t="".concat((0,o.wrapInSingleQuotes)(i.a)," ").concat((0,o.wrapInSingleQuotes)(i.b)),u=["--name-status","-z","-M"],i.copies&&u.push("-C","-C"),[4,e("git diff ".concat(u.join(" ")," ").concat(t))];case 1:if((c=r.sent()).error)return[2,c];d=[],f=!0,p=!1,h=void 0;try{for(g=c.output.matchAll(s)[Symbol.iterator]();!(f=(m=g.next()).done);f=!0)(x=(0,n._)(m.value,1)[0].match(l))&&(b=(y=(0,n._)(x,5))[1],w=y[3],k=y[4],_=function(e){switch(e){case"A":case"U":return a.GitCommitFileType.ADDED;case"C":return a.GitCommitFileType.COPIED;case"D":return a.GitCommitFileType.DELETED;case"M":return a.GitCommitFileType.MODIFIED;case"R":return a.GitCommitFileType.RENAMED;case"T":return a.GitCommitFileType.TYPE_CHANGED;default:throw Error("Unknown file type: ".concat(e))}}(b),d.push(_===a.GitCommitFileType.RENAMED||_===a.GitCommitFileType.COPIED?{type:_,path:k,originalPath:w}:{type:_,path:w}))}catch(e){p=!0,h=e}finally{try{f||null==g.return||g.return()}finally{if(p)throw h}}return[2,{files:d,error:null}]}})})()}i.Type.Object({a:i.Type.String(),b:i.Type.String(),copies:i.Type.Optional(i.Type.Boolean())}),e.s(["gitGetChangesBetweenCommits",()=>u],879737);var c=e.i(878420),d=e.i(64386),f=e.i(825118),p=e.i(625108),h=["only","separator=".concat("%x1e"),"key_value_separator=".concat("%x1d")].join(","),g='--format="format:'+["%D","%H","%P","%an","%ae","%at","%cn","%ce","%ct","%s","%b","%(trailers:".concat(h,")"),"%N"].join("%x1f")+'"';function m(e){var t=e.trimStart().split("\x1f"),r=(0,n._)(t,13),i=r[0],a=r[1],s=r[2],l=r[3],u=r[4],c=r[5],d=r[6],f=r[7],h=r[8],g=r[9],m=r[10],x=r[11],y=r[12],b=[],w=s?s.split(" "):null,k=!1,_=!0,S=!1,C=void 0;try{for(var j,T=(0,o.splitTrimFilter)(i,",")[Symbol.iterator]();!(_=(j=T.next()).done);_=!0){var E=j.value;if("grafted"===E){k=!0;continue}b.push((0,p.parseGitRef)(E))}}catch(e){S=!0,C=e}finally{try{_||null==T.return||T.return()}finally{if(S)throw C}}var R={name:l,email:u,date:1e3*parseInt(c,10)},I={name:d,email:f,date:1e3*parseInt(h,10)},A=g?g.trim():"",P=m?m.trim():"",D=!1,O=Object.fromEntries((0,o.splitTrimFilter)(x,"\x1e").map(function(e){var t=e.indexOf("\x1d"),n=-1===t?e:e.slice(0,t),r=-1===t?"":e.slice(t+1);if(P&&!D){D=!0;var i=P.lastIndexOf(n+":");-1!==(i=-1===i?P.lastIndexOf(n+"="):i)&&(P=P.slice(0,i).trim())}return[n,(0,o.parseTrailer)(r)]})),N=y&&""!==y.trim()?y.trim():void 0;return{refs:b,hash:a,parents:w,grafted:k,author:R,committer:I,subject:A,body:P,trailers:O,notes:N}}function x(e){return(0,t._)(function(e){var t,n=arguments;return(0,r._)(this,function(r){switch(r.label){case 0:var i,a,s,l,u,c,d;return[4,e((s=void 0===(a=(i=n.length>1&&void 0!==n[1]?n[1]:{}).max)?25:a,l=i.skip,u=i.revRange,c=i.path,d=["-z","--decorate=full","--full-history",g],s=Math.max(1,Math.min(s,200)),d.push("-n ".concat(s)),l&&d.push("--skip ".concat(l)),u&&d.push(u),d.push("--"),c&&d.push(c),"git log ".concat(d.join(" "))),{serviceMethod:"git-log"})];case 1:if((t=r.sent()).error){if(t.error===f.GitErrors.NO_COMMITS)return[2,{commits:[],error:null}];return[2,t]}return[2,{commits:(0,o.splitTrimFilter)(t.output,"\0").map(m),error:null}]}})}).apply(this,arguments)}function y(e,n){return(0,t._)(function(){var t,i;return(0,r._)(this,function(r){switch(r.label){case 0:if(!n.commit)return[2,{error:f.GitErrors.INVALID_REFERENCE,extras:{commit:n.commit}}];return[4,x(e,{max:1,revRange:n.commit})];case 1:if((t=r.sent()).error)return[2,t];if(0===t.commits.length)return[2,{error:f.GitErrors.INVALID_REFERENCE,extras:{commit:n.commit}}];return i=t.commits[0],[2,(0,d._)((0,c._)({},i),{error:null})]}})})()}i.Type.Object({max:i.Type.Optional(i.Type.Integer()),skip:i.Type.Optional(i.Type.Integer()),revRange:i.Type.Optional(i.Type.String()),path:i.Type.Optional(i.Type.String())}),e.s(["default",()=>x],721035),i.Type.Object({commit:i.Type.String()}),e.s(["gitGetCommit",()=>y],846849);var b=["git diff -z --name-only --diff-filter=U","echo -n ".concat("\x1f"),"{ git grep -z -l -E '<{7,}|={7,}|>{7,}' || exit $(( $? == 1 ? 0 : $? )); }"].join(" && ");function w(e){return(0,t._)(function(){var t,i,a,s,l,u,c,d,f,p,h;return(0,r._)(this,function(r){switch(r.label){case 0:return[4,e(b,{serviceMethod:"git-get-conflicting-files"})];case 1:if((t=r.sent()).error)return[2,t];if(a=(i=(0,n._)(t.output.split("\x1f").map(function(e){return(0,o.splitTrimFilter)(e,"\0")}),2))[0],s=i[1],!a.length)return[2,{files:new Map,error:null}];l=new Map,u=!0,c=!1,d=void 0;try{for(f=a[Symbol.iterator]();!(u=(p=f.next()).done);u=!0)h=p.value,l.set(h,!s.includes(h))}catch(e){c=!0,d=e}finally{try{u||null==f.return||f.return()}finally{if(c)throw d}}return[2,{files:l,error:null}]}})})()}function k(e,n){return(0,t._)(function(e,t){var n,i,a,s,l,u;return(0,r._)(this,function(r){switch(r.label){case 0:if(n=t.path,i=t.convertToBase64,s=void 0===(a=t.revision)?"HEAD":a,""===n)return[2,{content:null,error:null}];return l=(0,o.wrapInSingleQuotes)("".concat(s,":").concat(n)),[4,e(i?"git --no-pager show ".concat(l," | base64"):"git --no-pager show ".concat(l),{verbatim:!0,serviceMethod:"git-get-file-contents"})];case 1:if((u=r.sent()).error){if(u.error===f.GitErrors.PATH_MATCHED_NO_FILES)return[2,{content:null,error:null}];return[2,u]}return[2,{content:u.output,error:null}]}})}).apply(this,arguments)}e.s(["gitGetConflictingFiles",()=>w],126416),e.s(["gitGetFileContents",()=>k],520779)},878907,e=>{"use strict";var t=e.i(598534);e.s(["gitGetFilesForCommit",()=>t.default])},809713,428169,351892,410347,349472,401580,766787,685804,679495,679258,177050,147373,363790,167310,271520,125666,e=>{"use strict";var t,n,r=e.i(297083),i=e.i(817556),o=e.i(825118),a=e.i(627557),s=e.i(10581);function l(e,t){return"{ ".concat(e,"; } > /dev/null 2>&1 && echo -n '").concat(t,"' && exit 0")}var u=[l("! git rev-parse --is-inside-work-tree",s.GitRepositoryState.NOT_INITIALIZED),l('[ "$(! git rev-parse HEAD -- 2>&1)" = "fatal: bad revision \'HEAD\'" ]',s.GitRepositoryState.ON_UNBORN_BRANCH),l("! git cat-file -e HEAD",s.GitRepositoryState.HEAD_MISSING),l("! git ls-tree HEAD > /dev/null 2>&1",s.GitRepositoryState.TREE_CORRUPTED),l("git rev-parse -q --verify MERGE_HEAD",s.GitRepositoryState.MERGING),l("[ -d '.git/rebase-apply' ] && [ -f '.git/rebase-apply/applying' ]",s.GitRepositoryState.APPLYING_MAILBOX),l("[ -d '.git/rebase-apply' ] || [ -d '.git/rebase-merge' ]",s.GitRepositoryState.REBASING),l("git rev-parse -q --verify REVERT_HEAD",s.GitRepositoryState.REVERTING),l("git rev-parse -q --verify CHERRY_PICK_HEAD",s.GitRepositoryState.CHERRY_PICKING),l("[ -f '.git/BISECT_LOG' ]",s.GitRepositoryState.BISECTING),l("! git symbolic-ref -q HEAD",s.GitRepositoryState.DETACHED_HEAD),l("[ -f '.git/index.lock' ]",s.GitRepositoryState.INDEX_LOCKED),l("[ -f '.git/config.lock' ]",s.GitRepositoryState.CONFIG_LOCKED),"git update-index -q --refresh > /dev/null || exit $?",l('{ ! git diff-files --quiet; } || [ -n "$(git ls-files --others --exclude-standard)" ]',s.GitRepositoryState.DIRTY_WORKTREE),l("! git diff-index --cached --quiet HEAD --",s.GitRepositoryState.DIRTY_INDEX),'echo -n "CLEAN"'].join(";");function c(e){return(0,r._)(function(){var t,n,r;return(0,i._)(this,function(i){switch(i.label){case 0:return[4,e(u,{serviceMethod:"git-get-repository-state"})];case 1:if((t=i.sent()).error)return[2,t];if(!(t.output in s.GitRepositoryState))return[2,{error:o.GitErrors.UNKNOWN,extras:{output:t.output}}];return r=function(e){switch(e){case s.GitRepositoryState.NOT_INITIALIZED:case s.GitRepositoryState.ON_UNBORN_BRANCH:return s.GitRepositoryStateType.INITIALIZING;case s.GitRepositoryState.MERGING:case s.GitRepositoryState.REBASING:case s.GitRepositoryState.REVERTING:case s.GitRepositoryState.CHERRY_PICKING:case s.GitRepositoryState.APPLYING_MAILBOX:case s.GitRepositoryState.BISECTING:case s.GitRepositoryState.INDEX_LOCKED:case s.GitRepositoryState.CONFIG_LOCKED:return s.GitRepositoryStateType.INTERMEDIATE;case s.GitRepositoryState.DIRTY_WORKTREE:case s.GitRepositoryState.DIRTY_INDEX:case s.GitRepositoryState.CLEAN:return s.GitRepositoryStateType.NORMAL;case s.GitRepositoryState.DETACHED_HEAD:return s.GitRepositoryStateType.DETACHED_HEAD;case s.GitRepositoryState.HEAD_MISSING:case s.GitRepositoryState.TREE_CORRUPTED:return s.GitRepositoryStateType.HEAD_MISSING}}(n=t.output),[2,{state:n,type:r,error:null}]}})})()}function d(e){return(0,r._)(function(){var t,n,r,l,u,d,f;return(0,i._)(this,function(i){switch(i.label){case 0:return[4,c(e)];case 1:if((t=i.sent()).error)return[2,t];if((n=t.state)!==s.GitRepositoryState.MERGING)return[2,{error:o.GitErrors.INVALID_STATE,extras:{state:n,expected:[s.GitRepositoryState.MERGING]}}];return[4,e("cat '.git/MERGE_HEAD'",{serviceMethod:"git-get-merging-refs"})];case 2:if((r=i.sent()).error)return[2,r];if(!(l=(0,a.splitTrimFilter)(r.output,"\n")).length)return[2,{commits:[],branches:[],error:null}];return u="{ grep -F '".concat(l.join("\n"),"' || exit 0; }"),[4,e("".concat('git for-each-ref --format="%(objectname)	%(refname)" refs/heads/ refs/remotes/'," | ").concat(u),{serviceMethod:"git-get-merging-refs"})];case 3:if((d=i.sent()).error)return[2,d];if(!d.output)return[2,{commits:l,branches:[],error:null}];return f=(0,a.splitTrimFilter)(d.output,"\n").map(function(e){return e.split("	")[1]}).map(a.removeBranchRefsPath),[2,{commits:l,branches:f,error:null}]}})})()}e.s(["gitGetMergingRefs",()=>d],809713);var f=e.i(530658);function p(e){return(0,r._)(function(){var t,n,r,o,s,l,u,c,d,p,h,g,m,x;return(0,i._)(this,function(i){switch(i.label){case 0:return[4,e("git remote -v",{serviceMethod:"git-get-remotes"})];case 1:if((t=i.sent()).error)return[2,t];if(""===t.output)return[2,{remotes:new Map,error:null}];n=new Map,r=!0,o=!1,s=void 0;try{for(l=(0,a.splitTrimFilter)(t.output,"\n")[Symbol.iterator]();!(r=(u=l.next()).done);r=!0)c=u.value,p=(d=(0,f._)(c.split(/\s+/),3))[0],h=d[1],g=d[2],p&&h&&g&&"gitsafe-backup"!==p&&(x=null!=(m=n.get(p))?m:{name:p,fetch:"",push:""},"(fetch)"===g?(x.fetch=h,""===x.push&&(x.push=h),n.set(p,x)):"(push)"===g&&(x.push=h,""===x.fetch&&(x.fetch=h),n.set(p,x)))}catch(e){o=!0,s=e}finally{try{r||null==l.return||l.return()}finally{if(o)throw s}}return[2,{remotes:n,error:null}]}})})()}e.s(["gitGetRemotes",()=>p],428169),e.s(["gitGetRepositoryState",()=>c],351892);var h=e.i(878420),g=e.i(64386),m=e.i(960933);m.Type.Object({gitsafeBackupUrl:m.Type.Optional(m.Type.String())});var x='git commit --allow-empty --no-edit --quiet -m "Initial commit"',y='git add -A && git commit --allow-empty --no-edit --quiet -m "Initial commit"';function b(e,t,n){return(0,r._)(function(e){var t,n,a,l,u,d,f,p,m,b,w,k,_,S,C,j,T,E,R=arguments;return(0,i._)(this,function(I){switch(I.label){case 0:return a=void 0===(n=(t=R.length>1&&void 0!==R[1]?R[1]:{}).initialCommit)||n,u=void 0===(l=t.includeAllInitialFiles)||l,f=void 0===(d=t.gitsafeBackupUrl)?"git://gitsafe:5418/backup.git":d,p=R.length>2?R[2]:void 0,m=R.length>3?R[3]:void 0,b=(0,g._)((0,h._)({},p),{serviceMethod:"git-init"}),[4,c(e)];case 1:if((w=I.sent()).error)return[2,w];if(w.type!==s.GitRepositoryStateType.INITIALIZING)return[2,{error:o.GitErrors.ALREADY_INITIALIZED}];if(w.state!==s.GitRepositoryState.ON_UNBORN_BRANCH)return[3,4];if(!a)return[3,3];return[4,e(u?y:x,b)];case 2:if((k=I.sent()).error)return[2,k];I.label=3;case 3:return[2,{error:null}];case 4:return[4,e(["git init --quiet","git checkout --quiet --no-progress -b main"],b)];case 5:if((_=I.sent()).error)return[2,_];return[4,e("git remote add gitsafe-backup ".concat(f),b)];case 6:if((S=I.sent()).error)return[2,S];return[4,e("git config remote.gitsafe-backup.skipFetchAll true",b)];case 7:if((C=I.sent()).error)return[2,C];if(!a)return[3,10];return[4,e(u?y:x,b)];case 8:if((j=I.sent()).error)return[2,j];return[4,function(e,t){return(0,r._)(function(e){var t,n,r,o,a,s=arguments;return(0,i._)(this,function(i){switch(i.label){case 0:return n=void 0===(t=(s.length>1&&void 0!==s[1]?s[1]:{}).gitsafeBackupUrl)?"git://gitsafe:5418/backup.git":t,[4,e("git remote get-url gitsafe-backup",r=s.length>2?s[2]:void 0)];case 1:if(!i.sent().error)return[3,3];return[4,e("git remote add gitsafe-backup ".concat(n),r)];case 2:if((o=i.sent()).error)return[2,o];i.label=3;case 3:return[4,e("git push --quiet gitsafe-backup HEAD:main",r)];case 4:if((a=i.sent()).error)return[2,a];return[2,{error:null}]}})}).apply(this,arguments)}(e,{},b)];case 9:(T=I.sent()).error&&m&&(E=Error("Gitsafe error during git init: ".concat(T.error)),m.captureSentryError(E),m.log("Gitsafe error during git init: ".concat(T.error))),I.label=10;case 10:return[2,{error:null}]}})}).apply(this,arguments)}function w(e){return(0,r._)(function(){var t;return(0,i._)(this,function(n){switch(n.label){case 0:return[4,e("git rev-parse --is-inside-work-tree",{serviceMethod:"git-is-initialized"})];case 1:if((t=n.sent()).error){if(t.error===o.GitErrors.NOT_INITIALIZED)return[2,{initialized:!1,error:null}];return[2,t]}return[2,{initialized:"true"===t.output,error:null}]}})})()}function k(e){return(0,r._)(function(){var t,n;return(0,i._)(this,function(r){switch(r.label){case 0:return[4,e("if [ -f '.git/FETCH_HEAD' ]; then stat -c %Y '.git/FETCH_HEAD'; fi",{serviceMethod:"git-last-fetched"})];case 1:if((t=r.sent()).error)return[2,t];if(!t.output||isNaN(n=parseInt(t.output,10)))return[2,{lastFetched:null,error:null}];return[2,{lastFetched:new Date(n*=1e3),error:null}]}})})()}m.Type.Object({initialCommit:m.Type.Optional(m.Type.Boolean()),includeAllInitialFiles:m.Type.Optional(m.Type.Boolean()),gitsafeBackupUrl:m.Type.Optional(m.Type.String())}),e.s(["gitInit",()=>b],410347),e.s(["gitIsInitialized",()=>w],349472),e.s(["gitLastFetched",()=>k],401580);var _=e.i(167193);e.s(["gitListBranches",()=>_.default],766787);var S=e.i(721035);function C(e){return(0,r._)(function(e){var t,n=arguments;return(0,i._)(this,function(r){switch(r.label){case 0:return[4,e(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=[];return e.cached&&t.push("--cached"),e.deleted&&t.push("--deleted"),e.modified&&t.push("--modified"),e.others&&t.push("--others"),e.ignored&&t.push("--ignored"),e.directory&&t.push("--directory"),e.noEmptyDirectory&&t.push("--no-empty-directory"),"git ls-files ".concat(t.join(" "))}(n.length>1&&void 0!==n[1]?n[1]:{}),{serviceMethod:"git-ls-files"})];case 1:if((t=r.sent()).error)return[2,t];return[2,{files:t.output.split("\n").filter(function(e){return e.length>0}),error:null}]}})}).apply(this,arguments)}e.s(["gitLog",()=>S.default],685804),e.s(["gitLsFiles",()=>C],679495);var j=e.i(861392),T=e.i(52221),E=e.i(598016);function R(e,t){return(0,r._)(function(e,t){var n,r,l,u,d,f,p,h,g;return(0,i._)(this,function(i){switch(i.label){case 0:return n=t.branch,r=t.message,u=void 0!==(l=t.allowConflicts)&&l,[4,c(e)];case 1:if((d=i.sent()).error)return[2,d];if(f=d.state,d.type!==s.GitRepositoryStateType.NORMAL||f===s.GitRepositoryState.DIRTY_WORKTREE||f===s.GitRepositoryState.DIRTY_INDEX)return[2,{error:o.GitErrors.INVALID_STATE,extras:{state:f,expected:[s.GitRepositoryStateType.NORMAL]}}];return[4,(0,T.default)(e,n)];case 2:if((p=i.sent()).error)return[2,p];if(!p.exists)return[2,{error:o.GitErrors.INVALID_REFERENCE,extras:{branch:n}}];if(u)return[3,4];return[4,(0,E.default)(e,n,"HEAD")];case 3:if((h=i.sent()).error)return[2,h];if(!h.canMerge)return[2,{error:o.GitErrors.MERGE_CONFLICT}];i.label=4;case 4:var m,x,y,b;return x=(m={branch:n,message:r}).branch,y=m.message,x=(0,j.getFullBranchName)(x),b=["--quiet","--no-edit","--no-ff","--overwrite-ignore","--commit"],y&&b.push("-m",(0,a.wrapInSingleQuotes)(y)),b.push((0,a.wrapInSingleQuotes)(x)),[4,e("git merge ".concat(b.join(" ")),{serviceMethod:"git-merge"})];case 5:if((g=i.sent()).error!==o.GitErrors.MERGE_CONFLICT)return[3,8];if(u)return[3,7];return[4,e("git merge --abort")];case 6:return i.sent(),[2,g];case 7:return[2,{hasConflicts:!0,error:null}];case 8:if(g.error)return[2,g];return[2,{hasConflicts:!1,error:null}]}})}).apply(this,arguments)}function I(e){return(0,r._)(function(){var t;return(0,i._)(this,function(n){switch(n.label){case 0:return[4,e("git merge --abort",{serviceMethod:"git-merge-abort"})];case 1:if((t=n.sent()).error)return[2,t];return[2,{error:null}]}})})()}function A(e){return(0,r._)(function(){var t;return(0,i._)(this,function(n){switch(n.label){case 0:return[4,e("GIT_EDITOR=: git merge --continue",{serviceMethod:"git-merge-continue"})];case 1:if((t=n.sent()).error)return[2,t];return[2,{error:null}]}})})()}e.s(["gitMerge",()=>R],679258),e.s(["gitMergeAbort",()=>I],177050),e.s(["gitMergeContinue",()=>A],147373);var P=e.i(234961),D="# branch.oid ",O="# branch.head ",N="# branch.upstream ",M="# branch.ab ",L="# stash ",B=/^(\S)(\S) (\S{4}) (\S+) (\S+) (\S+) (\S+) (\S+) (.*)$/,V=/^([RC])([0-9]+) (.+?)\t(.+)$/,F=/^(\S)(\S) (\S{4}) (\S+) (\S+) (\S+) (\S+) (\S+) (\S+) (\S+) (.*)$/,U=/([RC][0-9]+ .+?)\0(.+?(?:\0|$))/g,G=((t=G||{}).ORDINARY="1",t.RENAMED_OR_COPIED="2",t.UNMERGED="u",t.UNTRACKED="?",t.IGNORED="!",t);function $(e){return(0,r._)(function(){var t,n,r,o,s,l,u,c,d,p,h,g,m,x,y,b,w,k,_,S,C,j;return(0,i._)(this,function(i){switch(i.label){case 0:return t=null,n=null,r=null,o=0,s=[],l=["-z","--porcelain=v2","--branch","--show-stash","--untracked-files=all"],[4,e("git status ".concat(l.join(" ")),{serviceMethod:"git-status"})];case 1:if((u=i.sent()).error)return[2,u];c=u.output.replaceAll(U,"$1	$2"),d=(0,a.splitTrimFilter)(c,"\0"),p=!0,h=!1,g=void 0;try{for(m=d[Symbol.iterator]();!(p=(x=m.next()).done);p=!0)(y=x.value).startsWith("#")?y.startsWith(D)?(b=y.substring(D.length),"(initial)"!==b&&(t=b)):y.startsWith(O)?(w=y.substring(O.length),"(detached)"!==w&&(n=w)):y.startsWith(N)?(k=y.substring(N.length),"(not queried)"!==k&&(r={branch:k,ahead:0,behind:0})):y.startsWith(M)?r&&(S=(_=(0,f._)(y.substring(M.length).split(" ").map(function(e){return Math.abs(parseInt(e,10))}),2))[0],C=_[1],r.ahead=S,r.behind=C):y.startsWith(L)&&(o=parseInt(y.substring(L.length),10)):(j=function(e){var t=e[0];switch(e=e.substring(2),t){case"!":default:return null;case"?":return{type:{index:P.GitStatusChangedFileType.UNTRACKED,worktree:P.GitStatusChangedFileType.UNTRACKED},path:e,staged:!1,unmerged:!1};case"u":var n=e.match(F);if(!n)return null;var r=(0,f._)(n,12),i=r[1],o=r[2],a=r[11],s=z(i),l=z(o),u=s!==P.GitStatusChangedFileType.UNMODIFIED;return{type:{index:s,worktree:l},path:a,staged:u,unmerged:!0};case"1":case"2":var c=e.match(B);if(!c)return null;var d=(0,f._)(c,10),p=d[1],h=d[2],g=d[9],m=z(p),x=z(h),y=m!==P.GitStatusChangedFileType.UNMODIFIED;if("1"===t)return{type:{index:m,worktree:x},path:g,staged:y,unmerged:!1};if("2"===t){var b=g.match(V);if(!b)return null;var w=(0,f._)(b,5),k=w[1],_=w[2],S=w[3],C=w[4];return{type:{index:m,worktree:x},path:S,staged:y,unmerged:!1,source:{type:function(e){switch(e){case"R":default:return P.GitStatusChangedFileType.RENAMED;case"C":return P.GitStatusChangedFileType.COPIED}}(k),score:parseInt(_,10),path:C}}}return null}}(y),null!==j&&s.push(j))}catch(e){h=!0,g=e}finally{try{p||null==m.return||m.return()}finally{if(h)throw g}}return[2,{commit:t,branch:n,upstream:r,stashes:o,changes:s,error:null}]}})})()}function z(e){switch(e){case".":default:return P.GitStatusChangedFileType.UNMODIFIED;case"M":return P.GitStatusChangedFileType.MODIFIED;case"T":return P.GitStatusChangedFileType.TYPE_CHANGED;case"A":return P.GitStatusChangedFileType.ADDED;case"D":return P.GitStatusChangedFileType.DELETED;case"R":return P.GitStatusChangedFileType.RENAMED;case"C":return P.GitStatusChangedFileType.COPIED;case"U":return P.GitStatusChangedFileType.UNMERGED}}function H(e){return(0,r._)(function(e){var t,n,r,s,l,u,c,d,p,h=arguments;return(0,i._)(this,function(i){switch(i.label){case 0:return t=h.length>1&&void 0!==h[1]?h[1]:{},[4,$(e)];case 1:if((n=i.sent()).error)return[2,n];if(!n.branch)return[2,{error:o.GitErrors.HEAD_DETACHED}];if(!n.upstream&&!t.experimental_override_remote||(s=(r=(0,f._)(t.experimental_override_remote?[t.experimental_override_remote.name,t.experimental_override_remote.branch]:(0,a.splitRemoteFromBranch)(n.upstream.branch),2))[0],l=r[1],!s||!l))return[2,{error:o.GitErrors.UPSTREAM_NOT_SET}];if(n.changes.length>0)return[2,{error:o.GitErrors.DIRTY_WORKTREE}];if("FF_ONLY"===(c=null!=(u=t.mode)?u:"FF_ONLY")&&n.upstream&&n.upstream.ahead>0)return[2,{error:o.GitErrors.MERGE_CONFLICT}];switch("FF_ONLY"!==c&&n.upstream&&0===n.upstream.ahead&&(c="FF_ONLY"),d=["--quiet","--no-edit"],c){case"FF_ONLY":d.push("--no-rebase","--ff-only");break;case"MERGE":d.push("--no-rebase","--ff");break;case"REBASE":d.push("--rebase")}return d.push((0,a.wrapInSingleQuotes)(s),(0,a.wrapInSingleQuotes)(l)),[4,e("git pull ".concat(d.join(" ")),{serviceMethod:"git-pull"})];case 2:if((p=i.sent()).error!==o.GitErrors.MERGE_CONFLICT)return[3,8];if(t.allowConflicts)return[2,{hasConflicts:!0,error:null}];switch(c){case"MERGE":return[3,3];case"REBASE":return[3,5]}return[3,7];case 3:return[4,e("git merge --abort",{serviceMethod:"git-pull"})];case 4:case 6:return i.sent(),[3,7];case 5:return[4,e("git rebase --abort",{serviceMethod:"git-pull"})];case 7:return[2,p];case 8:if(p.error)return[2,p];return[2,{hasConflicts:!1,error:null}]}})}).apply(this,arguments)}e.s(["default",()=>$],363790),(n={}).FF_ONLY="FF_ONLY",n.MERGE="MERGE",n.REBASE="REBASE",e.s(["gitPull",()=>H],167310);var W=e.i(705705),q=e.i(633386);function K(e){return(0,r._)(function(e){var t,n,r,s,l,u,c,d,p,h,g,m,x=arguments;return(0,i._)(this,function(i){switch(i.label){case 0:return t=x.length>1&&void 0!==x[1]?x[1]:{},[4,$(e)];case 1:if((n=i.sent()).error)return[2,n];if(!n.branch)return[2,{error:o.GitErrors.HEAD_DETACHED}];if(r=null,s=null,t.publish){if(n.upstream)return[2,{error:o.GitErrors.BRANCH_ALREADY_EXISTS,extras:{branch:n.upstream}}];r=t.publish.remote,s=null!=(l=t.publish.name)?l:n.branch,r=(0,a.removeBranchRefsPath)(r),s=(0,a.removeBranchRefsPath)(s)}else{if(!n.upstream)return[2,{error:o.GitErrors.UPSTREAM_NOT_SET}];if(!t.force&&n.upstream.behind>0)return[2,{error:o.GitErrors.PUSH_REJECTED}];r=(u=(0,f._)((0,a.splitRemoteFromBranch)(n.upstream.branch),2))[0],s=u[1]}if(!r||!s)return[2,{error:o.GitErrors.UPSTREAM_NOT_SET}];if(t.force)return[3,3];return[4,(0,q.default)(e,{remote:r})];case 2:if((c=i.sent()).error)return[2,c];i.label=3;case 3:if(!t.publish)return[3,5];return d="refs/remotes/".concat(r,"/").concat(s),[4,(0,T.default)(e,d)];case 4:if((p=i.sent()).error)return[2,p];if(p.exists&&p.ref.type===W.GitRefType.REMOTE_BRANCH)return[2,{error:o.GitErrors.BRANCH_ALREADY_EXISTS,extras:{branch:s}}];i.label=5;case 5:return h=["--quiet"],t.force&&!t.publish&&h.push("--force-with-lease"),t.publish&&h.push("--set-upstream"),g="refs/heads/".concat(n.branch,":refs/heads/").concat(s),h.push((0,a.wrapInSingleQuotes)(r),(0,a.wrapInSingleQuotes)(g)),[4,e("git push ".concat(h.join(" ")),{serviceMethod:"git-push"})];case 6:if((m=i.sent()).error)return[2,m];return[2,{error:null}]}})}).apply(this,arguments)}function Y(e,t){return(0,r._)(function(){var n;return(0,i._)(this,function(r){switch(r.label){case 0:if(t=(0,a.removeRemoteRefsPath)(t),!(0,j.isValidRemoteName)(t))return[2,{error:o.GitErrors.INVALID_REFERENCE,extras:{remote:t}}];return[4,e("git remote rm ".concat((0,a.wrapInSingleQuotes)(t)),{serviceMethod:"git-remove-remote"})];case 1:if((n=r.sent()).error)return[2,n];return[2,{error:null}]}})})()}e.s(["gitPush",()=>K],271520),e.s(["gitRemoveRemote",()=>Y],125666)},37038,923137,521047,319723,299571,345462,579876,e=>{"use strict";var t=e.i(398220);e.s(["gitRestoreCommit",()=>t.default],37038);var n=e.i(297083),r=e.i(817556),i=e.i(627557),o=e.i(234961),a=e.i(363790);function s(e,t,s){return(0,n._)(function(){var n,l,u,c,d,f,p,h,g,m,x,y,b,w,k;return(0,r._)(this,function(r){switch(r.label){case 0:if("string"==typeof t){if(""===t)return[2,{error:null}];t=[t]}if(!0!==t&&0===t.length)return[2,{error:null}];if(void 0===s)return[3,2];return n=["--quiet","--no-overlay","--worktree","--source=".concat(s),!0===t?".":"-- ".concat(t.join(" "))],[4,e("git --literal-pathspecs restore ".concat(n.join(" ")),{serviceMethod:"git-restore-files"})];case 1:if((l=r.sent()).error)return[2,l];return[2,{error:null}];case 2:return[4,(0,a.default)(e)];case 3:if((u=r.sent()).error)return[2,u];c=[],d=[],f=!0,p=!1,h=void 0;try{for(g=u.changes[Symbol.iterator]();!(f=(m=g.next()).done);f=!0)if(x=m.value,!0===t||t.includes(x.path))switch(x.type.worktree){case o.GitStatusChangedFileType.UNMODIFIED:continue;case o.GitStatusChangedFileType.UNTRACKED:c.push((0,i.wrapInSingleQuotes)(x.path));break;default:d.push((0,i.wrapInSingleQuotes)(x.path))}}catch(e){p=!0,h=e}finally{try{f||null==g.return||g.return()}finally{if(p)throw h}}if(0===c.length&&0===d.length&&void 0===s)return[2,{error:null}];return y=[],c.length&&(b=["--quiet","--force","--",c.join(" ")],y.push("git --literal-pathspecs clean ".concat(b.join(" ")))),d.length&&(w=["--quiet","--no-overlay","--worktree","-- ".concat(d.join(" "))],y.push("git --literal-pathspecs restore ".concat(w.join(" ")))),[4,e(y,{serviceMethod:"git-restore-files"})];case 4:if((k=r.sent()).error)return[2,k];return[2,{error:null}]}})})()}function l(e,t){return(0,n._)(function(e,t){var n,o,a,s;return(0,r._)(this,function(r){switch(r.label){case 0:return n=t.upstream,o=t.branchName,a=["--set-upstream-to",n],o&&a.push((0,i.wrapInSingleQuotes)(o)),[4,e("git branch ".concat(a.join(" ")),{serviceMethod:"git-set-branch-upstream"})];case 1:if((s=r.sent()).error)return[2,s];return[2,{error:null}]}})}).apply(this,arguments)}e.s(["gitRestoreFiles",()=>s],923137),e.s(["gitSetBranchUpstream",()=>l],521047);var u=e.i(825118),c=e.i(861392);function d(e,t){return(0,n._)(function(e,t){var n,o,a;return(0,r._)(this,function(r){switch(r.label){case 0:if(n=t.remote,o=t.url,n=(0,i.removeRemoteRefsPath)(n),!(0,c.isValidRemoteName)(n))return[2,{error:u.GitErrors.INVALID_REFERENCE,extras:{remote:n}}];if(!(0,c.isValidRemoteUrl)(o))return[2,{error:u.GitErrors.INVALID_REFERENCE,extras:{url:o}}];return n=(0,i.wrapInSingleQuotes)(n),o=(0,i.wrapInSingleQuotes)(o),[4,e("git remote set-url ".concat(n," ").concat(o),{serviceMethod:"git-set-remote-url"})];case 1:if((a=r.sent()).error)return[2,a];return[2,{error:null}]}})}).apply(this,arguments)}e.s(["gitSetRemoteURL",()=>d],319723);var f=e.i(960933);function p(e,t){return(0,n._)(function(){var n,o;return(0,r._)(this,function(r){switch(r.label){case 0:if(!(n=function(e){if("all"in e)return e.all?["git add -A"]:["git reset -q -- ."];var t=e.add,n=e.reset;if(!(null==t?void 0:t.length)&&!(null==n?void 0:n.length))return null;var r=[];if(t){var o=t.map(i.wrapInSingleQuotes).join(" ");r.push("git --literal-pathspecs add -- ".concat(o))}if(n){var a=n.map(i.wrapInSingleQuotes).join(" ");r.push("git --literal-pathspecs reset -q -- ".concat(a))}return r}(t)))return[2,{error:null}];return[4,e(n,{serviceMethod:"git-stage-files"})];case 1:if((o=r.sent()).error)return[2,o];return[2,{error:null}]}})})()}f.Type.Union([f.Type.Object({all:f.Type.Boolean()}),f.Type.Object({add:f.Type.Optional(f.Type.Array(f.Type.String())),reset:f.Type.Optional(f.Type.Array(f.Type.String()))})]),e.s(["gitStageFiles",()=>p],299571),e.s(["gitStatus",()=>a.default],345462);var h=e.i(370451);e.s(["gitSwitchBranch",()=>h.default],579876)},940395,e=>{"use strict";var t=e.i(904851),n=e.i(90659),r=e.i(721281),i=e.i(530658),o=function(){function e(n,i){(0,t._)(this,e),(0,r._)(this,"cache",void 0),(0,r._)(this,"lastInvalidation",void 0),(0,r._)(this,"ttl",void 0),(0,r._)(this,"debounceTime",void 0),this.cache=new Map,this.lastInvalidation=0,this.ttl=n,this.debounceTime=i}return(0,n._)(e,[{key:"has",value:function(e){return this.cache.has(e)}},{key:"get",value:function(e){var t=this.cache.get(e);if(!t)throw Error("No value found for key: ".concat(e));return t.result}},{key:"set",value:function(e,t){var n=this,r=this.cache.get(e);r&&(clearTimeout(r.timeout),this.cache.delete(e));var i={result:t,timeout:setTimeout(function(){return n.cache.delete(e)},this.ttl),pending:!0};t.finally(function(){return i.pending=!1}),this.cache.set(e,i)}},{key:"invalidate",value:function(){if(!(Date.now()-this.lastInvalidation<this.debounceTime)){var e=new Map,t=!0,n=!1,r=void 0;try{for(var o,a=this.cache[Symbol.iterator]();!(t=(o=a.next()).done);t=!0){var s=(0,i._)(o.value,2),l=s[0],u=s[1];u.pending?e.set(l,u):clearTimeout(u.timeout)}}catch(e){n=!0,r=e}finally{try{t||null==a.return||a.return()}finally{if(n)throw r}}this.cache=e,this.lastInvalidation=Date.now()}}},{key:"clear",value:function(){var e=!0,t=!1,n=void 0;try{for(var r,i=this.cache.values()[Symbol.iterator]();!(e=(r=i.next()).done);e=!0){var o=r.value;clearTimeout(o.timeout)}}catch(e){t=!0,n=e}finally{try{e||null==i.return||i.return()}finally{if(t)throw n}}this.cache.clear(),this.lastInvalidation=0}}]),e}();e.s(["default",()=>o])},354507,e=>{"use strict";var t=e.i(297083),n=e.i(530658),r=e.i(346715),i=e.i(817556),o=e.i(906368),a=e.i(223808),s=e.i(556171),l=e.i(760890),u=e.i(480539),c=e.i(387539),d=e.i(118711),f=e.i(861683),p=e.i(791675),h=e.i(200437),g=e.i(997229),m=e.i(221856),x=e.i(879737),y=e.i(846849),b=e.i(126416),w=e.i(520779),k=e.i(878907),_=e.i(809713),S=e.i(428169),C=e.i(351892),j=e.i(410347),T=e.i(349472),E=e.i(401580),R=e.i(766787),I=e.i(685804),A=e.i(679495),P=e.i(679258),D=e.i(177050),O=e.i(147373),N=e.i(167310),M=e.i(271520),L=e.i(125666),B=e.i(37038),V=e.i(923137),F=e.i(521047),U=e.i(319723),G=e.i(299571),$=e.i(345462),z=e.i(579876),H=e.i(866408);e.i(792e3);var W=e.i(8808),q=e.i(836102),K=e.i(904851),Y=e.i(90659),Q=e.i(721281),X=e.i(825118),J=e.i(968263),Z=e.i(826771),ee=e.i(664152),et=e.i(940395),en=e.i(322606),er=function(){function e(n){var r=this,a=n.container,s=n.getEnv,l=n.awaitPromise;(0,K._)(this,e),(0,Q._)(this,"queue",void 0),(0,Q._)(this,"cache",void 0),(0,Q._)(this,"running",void 0),this.cache=new et.default(3e4,2e3),this.running=(0,Z.observableValue)(!1),this.queue=[],a.openChannel({service:"exec"},function(e){var n=e.channel,a=function(e,r){return(0,t._)(function(){var a,u,c;return(0,i._)(this,function(d){switch(d.label){case 0:if(0===e.length)throw Error("Expected at least one command");if(!l)return[3,2];return[4,l];case 1:d.sent(),d.label=2;case 2:var f;return a=Date.now(),[4,(u=["bash","-c",Array.isArray(e)?e.join(" && "):e],f=s(),(0,t._)(function(){var e,t,a,s,l,c,d;return(0,i._)(this,function(i){switch(i.label){case 0:if("open"!==n.status)return[2,{output:"JS Error\nchannel closed before command was run",error:X.GitErrors.CHANNEL_CLOSED}];i.label=1;case 1:return i.trys.push([1,3,,4]),e="",t=n.onCommand(function(t){null!==t.output&&void 0!==t.output&&(e+=t.output)}),a=void 0,(s=Promise.race([new Promise(function(e){return a=setTimeout(e,9e4)}),n.request({exec:{env:f,args:u,noUserEnv:!0}})])).finally(function(){t(),clearTimeout(a)}),[4,s];case 2:if(void 0===(l=i.sent()))return ee.logger.error("Git request timed out.",{appService:"git",command:u,gitEnv:JSON.stringify(f),TIMEOUT:9e4,verbatim:null==r?void 0:r.verbatim,serviceMethod:null==r?void 0:r.serviceMethod,extraEnv:null==r?void 0:r.env}),[2,{output:e,error:X.GitErrors.TIMEOUT}];if(!l.ok&&l.channelClosed)return[2,{output:"JS Error\nchannel closed during command execution",error:X.GitErrors.CHANNEL_CLOSED}];if(l.error||!l.ok)return[2,{output:c="".concat(l.error,"\n").concat(e),error:(0,X.gitErrorFromOutput)(c)}];return[2,{output:e,error:null}];case 3:return d=i.sent(),o.withScope(function(e){e.setTag("service","git"),e.setExtra("command",u),e.setExtra("env",f),r&&e.setExtra("options",r),o.captureException(d)}),[2,{output:"JS Error\n".concat(String(d)),error:X.GitErrors.UNKNOWN_NOT_GIT}];case 4:return[2]}})})())];case 3:if(c=d.sent(),(0,en.emitGitDebugEvent)(e,c,!1,a),c.error)return[2,{error:c.error}];return[2,{output:(null==r?void 0:r.verbatim)?c.output:c.output.trim(),error:null}]}})})()},u=function(e,t){if(0===e.length)throw Error("Expected at least one command");var n=Array.isArray(e)?e.join(" && "):e;if(r.cache.has(n)){var i=r.cache.get(n);return i.then(function(t){(0,en.emitGitDebugEvent)(e,t,!0)}),i}var o=a(n,t);return r.cache.set(n,o),o},c=function(e,t){return r.cache.clear(),a(e,t)},d=function(){return(0,t._)(function(){var e;return(0,i._)(this,function(t){switch(t.label){case 0:if(!(this.queue.length>0)||"open"!==n.status)return[3,7];if(!(e=this.queue.shift()))return[3,6];if("read"!==e.type)return[3,2];return[4,e.fn(u)];case 1:case 3:return t.sent(),[3,6];case 2:if("write"!==e.type)return[3,4];return[4,e.fn(c)];case 4:return[4,e.fn(a)];case 5:t.sent(),t.label=6;case 6:return[3,0];case 7:return 0===this.queue.length&&this.running.set(!1),[2]}})}).call(r)};return r.running.current&&d(),r.running.subscribe(function(e){e&&d()})})}return(0,Y._)(e,[{key:"add",value:function(e,n){var r=(0,J.default)();return this.queue.push({type:n,fn:function(n){return(0,t._)(function(){var t;return(0,i._)(this,function(i){switch(i.label){case 0:return[4,e(n)];case 1:return t=i.sent(),r.resolve(t),[2]}})})()}}),this.running.current||this.running.set(!0),r.promise}},{key:"wrap",value:function(e,t){var n=this;if("function"!=typeof e)throw Error("Expected a function");return function(){for(var i=arguments.length,o=Array(i),a=0;a<i;a++)o[a]=arguments[a];return n.add(function(t){return e.apply(void 0,[t].concat((0,r._)(o)))},t)}}}]),e}(),ei=e.i(240913),eo=e.i(903381),ea=".git";function es(e){var K,Y=e.container,Q=e.fs,X=e.provideProfiles,J=void 0===X?q.default:X,Z=(0,H.default)();Z.setMaxListeners(1/0);var ee=(0,s.createGitServiceEnvironmentVariables)(),et=!1,en=new Map,es=null,el=Y.getContext(),eu=function(e){return(0,t._)(function(){var t,r;return(0,i._)(this,function(i){switch(i.label){case 0:return[4,J({defaultUsername:null==el||null==(t=el.currentUser)?void 0:t.username,defaultUserId:null==el||null==(r=el.currentUser)?void 0:r.id,onProfiles:function(t){var r,i=!0,a=!1,s=void 0;try{for(var l,u=t[Symbol.iterator]();!(i=(l=u.next()).done);i=!0){var c=(0,n._)(l.value,2),d=c[0],f=c[1];en.set(d,f),Z.emit(p.GitEvent.NEW_PROFILE)}}catch(e){a=!0,s=e}finally{try{i||null==u.return||u.return()}finally{if(a)throw s}}t.has(p.GitProfileProvider.GITHUB)||en.delete(p.GitProfileProvider.GITHUB),t.has(p.GitProfileProvider.GITLAB)||en.delete(p.GitProfileProvider.GITLAB),t.has(p.GitProfileProvider.BITBUCKET)||en.delete(p.GitProfileProvider.BITBUCKET);var h=en.get(p.GitProfileProvider.REPLIT_DEFAULT),g=en.get(p.GitProfileProvider.GITHUB),m=en.get(p.GitProfileProvider.BITBUCKET),x=en.get(p.GitProfileProvider.GITLAB),y=null!=(r=null!=g?g:m)?r:x;if(es&&!e&&(e=es.provider),e===p.GitProfileProvider.GITHUB&&g)es=g;else if(e===p.GitProfileProvider.BITBUCKET&&m)es=m;else if(e===p.GitProfileProvider.GITLAB&&x)es=x;else if(e===p.GitProfileProvider.REPLIT_DEFAULT&&h)es=h;else if(y)es=y;else{if(!h)return void o.captureException(Error("No default profile found"));es=h}Z.emit(p.GitEvent.CHANGED_PROFILE)}})];case 1:return[2,i.sent()]}})})()},ec=new er({container:Y,getEnv:function(){return ee},awaitPromise:eu()});Z.on(p.GitEvent.FS_CHANGE,function(){return ec.cache.invalidate()}),Z.on(p.GitEvent.FORCED_REFRESH,function(){return ec.cache.invalidate()}),Z.on(p.GitEvent.NEW_PROFILE,function(){return ec.cache.invalidate()}),Z.on(p.GitEvent.CHANGED_PROFILE,function(){return ec.cache.invalidate()});var ed=function(){var e,t=Y.getContext(),n=null==t||null==(e=t.currentUser)?void 0:e.id;if(null!=n){var r="[init]\ndefaultBranch = main\n[user]\n";""!==ee.GIT_AUTHOR_EMAIL&&(r+="email = ".concat(ee.GIT_AUTHOR_EMAIL.replace(/'/g,"'\"'\"'"),"\n")),""!==ee.GIT_AUTHOR_NAME&&(r+="name = ".concat(ee.GIT_AUTHOR_NAME.replace(/'/g,"'\"'\"'"),"\n"));var i="/run/replit/user/".concat(n,"/.config/git");null!=n&&Y.exec("bash","-c","tmpf=$(mktemp); mkdir -p ".concat(i," && echo '").concat(r,'\' > "$tmpf" && mv "$tmpf" ').concat("".concat(i,"/config")))}};return Y.onConnectionStateChanged(function(e){e===W.ConnectionState.CONNECTED&&ed()}),Z.on(p.GitEvent.CHANGED_PROFILE,function(){null!=es&&(ee=(0,s.createGitServiceEnvironmentVariables)({session:K,author:{username:es.name,email:es.email}}),ed())}),{getEnv:function(){return ee},setSession:function(e){K=e,ee=(0,s.createGitServiceEnvironmentVariables)({session:K,author:es?{username:es.name,email:es.email}:void 0}),Z.emit(p.GitEvent.FORCED_REFRESH)},getProfiles:function(){return Array.from(en.values())},hasProfile:function(e){return en.has(e)},getProfile:function(e){var t=en.get(e);if(!t)throw Error("Fetched a profile that has not been setup!");return t},addProfile:function(e){en.set(e.provider,e),Z.emit(p.GitEvent.NEW_PROFILE)},getCurrentProfile:function(){return es},setCurrentProfile:function(e){var t=en.get(e);if(!t)throw Error("Can't set a non-existent profile!");es=t,ee=(0,s.createGitServiceEnvironmentVariables)({session:K,author:{username:t.name,email:t.email}}),Z.emit(p.GitEvent.CHANGED_PROFILE)},onProfileAdded:function(e){var t=function(){e(Array.from(en.values()))};return Z.on(p.GitEvent.NEW_PROFILE,t),function(){Z.off(p.GitEvent.NEW_PROFILE,t)}},onCurrentProfileChanged:function(e){var t=function(){e(es)};return Z.on(p.GitEvent.CHANGED_PROFILE,t),function(){Z.off(p.GitEvent.CHANGED_PROFILE,t)}},refreshProfiles:function(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).preferredProvider;return eu(e)},onRefresh:function(e){if(!et){var n,o,s,l,u,c,d,f,h,g,m,x;n=!1,o=!1,s=function(){return Z.emit(p.GitEvent.FS_CHANGE)},c=(l={wait:1e3,cooldown:5e3,maxWait:5e3}).wait,d=l.cooldown,f=l.maxWait,h=null,g=!1,m=(0,a.default)(function(e){return h=setTimeout(function(){return h=null},d),g=!1,u=s.apply(void 0,(0,r._)(e))},c,{maxWait:f}),(x=function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return null!==h?u:(g||(g=!0),m(t))}).cancel=function(){null!==h?(clearTimeout(h),h=null):(m.cancel(),g=!1)},x.flush=function(){return null!==h?(clearTimeout(h),h=null,u):m.flush()},x.isPending=function(){return g},x.isInCooldown=function(){return null!==h},(0,t._)(function(){var e;return(0,i._)(this,function(t){return e=!0,Q.watchDir(ei.ROOT_PATH,{onChange:function(t){!n&&t.find(function(e){return e.filename===ea&&e.type===eo.FileType.Directory})&&(function(){if(!n){n=!0;var e=!0;Q.watchDir(ea,{onChange:function(){e?e=!1:x()},onMoveOrDelete:function(){n=!1,x()},onError:function(e,t){n=!1,RegExp(".+permission denied","im").test(e.message)||Y.unrecoverableError(e,t)}})}}(),e||x()),e&&(e=!1)},onError:function(e,t){return Y.unrecoverableError(e,t)}}),[2]})})(),Q.onStatusChange(function(e){n&&(e===eo.FsStatus.Syncing&&x.isInCooldown()?o=!0:e===eo.FsStatus.Clean&&(o||x(),o=!1))}),et=!0}var y=function(){return e(p.GitEvent.FS_CHANGE)},b=function(){return e(p.GitEvent.FORCED_REFRESH)},w=function(){return e(p.GitEvent.NEW_PROFILE)},k=function(){return e(p.GitEvent.CHANGED_PROFILE)};return Z.on(p.GitEvent.FS_CHANGE,y),Z.on(p.GitEvent.FORCED_REFRESH,b),Z.on(p.GitEvent.NEW_PROFILE,w),Z.on(p.GitEvent.CHANGED_PROFILE,k),function(){Z.off(p.GitEvent.FS_CHANGE,y),Z.off(p.GitEvent.FORCED_REFRESH,b),Z.off(p.GitEvent.NEW_PROFILE,w),Z.off(p.GitEvent.CHANGED_PROFILE,k)}},forceRefresh:function(){Z.emit(p.GitEvent.FORCED_REFRESH)},isBusy:function(){return ec.running.current},onBusyChange:function(e){var t=!1,n=(0,a.default)(e,200);return ec.running.subscribe(function(e){t&&!e?(n(!1),t=!1):!t&&e&&(n(!0),t=!0)})},init:ec.wrap(j.gitInit,"write"),isInitialized:ec.wrap(T.gitIsInitialized,"read"),lsFiles:ec.wrap(A.gitLsFiles,"read"),status:ec.wrap($.gitStatus,"read"),log:ec.wrap(I.gitLog,"read"),findDefaultBranches:ec.wrap(g.gitFindDefaultBranches,"read"),listBranches:ec.wrap(R.gitListBranches,"read"),setBranchUpstream:ec.wrap(F.gitSetBranchUpstream,"write"),stageFiles:ec.wrap(G.gitStageFiles,"write"),commit:ec.wrap(d.gitCommit,"write"),switchBranch:ec.wrap(z.gitSwitchBranch,"write"),branchExists:ec.wrap(u.gitBranchExists,"read"),createBranch:ec.wrap(f.gitCreateBranch,"write"),getRemotes:ec.wrap(S.gitGetRemotes,"read"),fetch:ec.wrap(h.gitFetch,"write"),canMergeBranches:ec.wrap(c.gitCanMergeBranches,"read"),pull:ec.wrap(N.gitPull,"write"),push:ec.wrap(M.gitPush,"write"),getRepositoryState:ec.wrap(C.gitGetRepositoryState,"read"),getFileContents:ec.wrap(w.gitGetFileContents,"read"),addRemote:ec.wrap(l.gitAddRemote,"write"),removeRemote:ec.wrap(L.gitRemoveRemote,"write"),setRemoteURL:ec.wrap(U.gitSetRemoteURL,"write"),getBranch:ec.wrap(m.gitGetBranch,"read"),restoreFiles:ec.wrap(V.gitRestoreFiles,"write"),lastFetched:ec.wrap(E.gitLastFetched,"read"),merge:ec.wrap(P.gitMerge,"write"),mergeContinue:ec.wrap(O.gitMergeContinue,"write"),mergeAbort:ec.wrap(D.gitMergeAbort,"write"),getConflictingFiles:ec.wrap(b.gitGetConflictingFiles,"read"),getMergingRefs:ec.wrap(_.gitGetMergingRefs,"read"),getFilesForCommit:ec.wrap(k.gitGetFilesForCommit,"read"),getCommit:ec.wrap(y.gitGetCommit,"read"),restoreCommit:ec.wrap(B.gitRestoreCommit,"write"),escapeHatchGitExecRead:ec.wrap(function(e){for(var t=arguments.length,n=Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];return e.apply(void 0,(0,r._)(n))},"read"),escapeHatchGitExecWrite:ec.wrap(function(e){for(var t=arguments.length,n=Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];return e.apply(void 0,(0,r._)(n))},"write"),getChangesBetweenCommits:ec.wrap(x.gitGetChangesBetweenCommits,"read")}}e.s(["default",()=>es],354507)},752394,e=>{"use strict";var t=e.i(297083),n=e.i(167626),r=e.i(817556),i=e.i(862927);e.i(878420);var o=e.i(569384),a=e.i(973245);function s(){var e=(0,o._)(["\n  query GitAuth {\n    currentUser {\n      id\n      gitHubInfo {\n        accessToken\n      }\n      gitHubInfoV2 {\n        accessToken\n      }\n      bitbucketInfo {\n        accessToken\n      }\n    }\n  }\n"]);return s=function(){return e},e}e.i(304277),e.i(566901);var l=(0,a.gql)(s()),u=e.i(960933),c=u.Type.Object({id:u.Type.String(),user_id:u.Type.Number(),ssh_hostname:u.Type.String(),token:u.Type.String()}),d=e.i(968323),f=e.i(173738),p=e.i(664152),h=e.i(344188),g=["http:","https:","vscode:"];function m(e){return(0,t._)(function(e){var t,n;return(0,r._)(this,function(r){switch(r.label){case 0:return t=e.replId,[4,(0,d.tryCatchAsync)(function(){return(0,h.postJson)("/data/repls/".concat(t,"/get_ssh_token"))})];case 1:if((n=r.sent()).error)return[2,{type:"error",message:n.error.toString()}];if(!i.Value.Check(c,n.value))return[2,{type:"error",message:"Invalid JSON"}];return[2,{type:"success",data:n.value}]}})}).apply(this,arguments)}function x(){return(0,t._)(function(){var e;return(0,r._)(this,function(t){switch(t.label){case 0:if(!f.apolloClient)throw Error("Expected apollo");return[4,f.apolloClient.query({query:l})];case 1:if(!(null==(e=t.sent().data)?void 0:e.currentUser))throw Error("Expected current user");return[2,e.currentUser]}})})()}function y(){(0,n._)(document.activeElement,HTMLElement)&&document.activeElement.blur()}function b(e){var n=e.container,i=e.fs,o=e.openMultipleFiles,a=e.openMultipleURLs,s=e.enableReplspaceSshTokenPassthrough,l=new Set,u=!1,c=null;return n.openChannel({service:"open",name:"open"},function(e){e.channel.onCommand(function(e){if("replspaceApiOpenMultipleFiles"===e.body){if(!e.replspaceApiOpenMultipleFiles)throw Error("Expected replspaceApiOpenMultipleFiles");var t=e.replspaceApiOpenMultipleFiles,n=t.files,r=t.urls.flatMap(function(e){var t;try{t=new URL(e)}catch(e){return[]}return g.includes(t.protocol)?[t]:[]});o&&n.length>0&&(y(),o({paths:n})),a&&r.length>0&&(y(),a({urls:r.map(function(e){return e.toString()})}))}})}),n.openChannel({service:"git",name:"git"},function(e){var n=e.channel;return n.onCommand(function(e){return(0,t._)(function(){var t,a,s,d,f,h,g,m,b,w,k,_,S,C,j,T,E,R,I,A,P,D,O,N,M,L,B;return(0,r._)(this,function(r){switch(r.label){case 0:switch(e.body){case"replspaceApiOpenFile":return[3,1];case"replspaceApiGetGitHubToken":return[3,7];case"replspaceApiGetBitbucketToken":return[3,9]}return[3,11];case 1:if(!e.replspaceApiOpenFile)throw Error("Expected replspaceApiOpenFile");if(a=(t=e.replspaceApiOpenFile).file,s=t.waitForClose,d=t.nonce,o)return[3,3];if(!a.endsWith(".git/COMMIT_EDITMSG"))return s&&n.send({replspaceApiCloseFile:{file:a,nonce:d}}),window.alert("tried to open ".concat(a," but failed")),[2];return f=window.prompt("Enter a commit message"),[4,i.writeFile(a,null!=f?f:"")];case 2:if(r.sent(),!s)return[2];return[3,5];case 3:if(y(),o({paths:[a]}),!s||!c)return[2];return[4,c(a)];case 4:r.sent(),r.label=5;case 5:return[4,i.flush()];case 6:if(r.sent(),"open"!==n.status)return[2];return n.send({replspaceApiCloseFile:{file:a,nonce:d}}),[2];case 7:if(!e.replspaceApiGetGitHubToken)throw Error("Expected replspaceApiGetGitHubToken");return h=function(){var t;"open"===n.status&&n.send({replspaceApiGitHubToken:{token:"",nonce:null==(t=e.replspaceApiGetGitHubToken)?void 0:t.nonce}})},[4,x()];case 8:if(null==(g=r.sent()).gitHubInfoV2&&null==g.gitHubInfo)return h(),[2];if(!l.size)return h(),p.logger.error("Got a replspaceApiGetGitHubToken command but no confirm listener is set up"),[2];if(m=function(){var t,r,i,o;"open"===n.status&&n.send({replspaceApiGitHubToken:{token:null!=(o=null==(t=g.gitHubInfoV2)?void 0:t.accessToken)?o:null==(r=g.gitHubInfo)?void 0:r.accessToken,nonce:null==(i=e.replspaceApiGetGitHubToken)?void 0:i.nonce}})},u)return m(),[2];b=!1,w=function(){var e=!0,t=!1,n=void 0;try{for(var r,i=l[Symbol.iterator]();!(e=(r=i.next()).done);e=!0)(0,r.value)(null)}catch(e){t=!0,n=e}finally{try{e||null==i.return||i.return()}finally{if(t)throw n}}},k=!0,_=!1,S=void 0;try{for(C=l[Symbol.iterator]();!(k=(j=C.next()).done)&&(T=j.value,!b);k=!0)T(function(e){var t=!(arguments.length>1)||void 0===arguments[1]||arguments[1];if(!b){if(b=!0,!e){h(),w();return}t&&(u=e),m(),w()}})}catch(e){_=!0,S=e}finally{try{k||null==C.return||C.return()}finally{if(_)throw S}}return[2];case 9:if(!e.replspaceApiGetBitbucketToken)throw Error("Expected replspaceApiGetBitbucketToken");return E=function(){var t;"open"===n.status&&n.send({replspaceApiBitbucketToken:{token:"",nonce:null==(t=e.replspaceApiGetBitbucketToken)?void 0:t.nonce}})},[4,x()];case 10:if(null==(R=r.sent()).bitbucketInfo)return E(),[2];if(!l.size)return E(),p.logger.error("Got a replspaceApiGetBitbucketToken command but no confirm listener is set up"),[2];if(I=function(){var t,r;"open"===n.status&&n.send({replspaceApiBitbucketToken:{token:null==(t=R.bitbucketInfo)?void 0:t.accessToken,nonce:null==(r=e.replspaceApiGetBitbucketToken)?void 0:r.nonce}})},u)return I(),[2];A=!1,P=function(){var e=!0,t=!1,n=void 0;try{for(var r,i=l[Symbol.iterator]();!(e=(r=i.next()).done);e=!0)(0,r.value)(null)}catch(e){t=!0,n=e}finally{try{e||null==i.return||i.return()}finally{if(t)throw n}}},D=!0,O=!1,N=void 0;try{for(M=l[Symbol.iterator]();!(D=(L=M.next()).done)&&(B=L.value,!A);D=!0)B(function(e){var t=!(arguments.length>1)||void 0===arguments[1]||arguments[1];if(!A){if(A=!0,!e){E(),P();return}t&&(u=e),I(),P()}})}catch(e){O=!0,N=e}finally{try{D||null==M.return||M.return()}finally{if(O)throw N}}r.label=11;case 11:return[2]}})})()}),function(){}}),void 0!==s&&s&&n.openChannel({service:"sshtoken",name:"sshtoken"},function(e){var n=e.channel;n.onCommand(function(e){return(0,t._)(function(){var t,i,o,a,s,l;return(0,r._)(this,function(r){switch(r.label){case 0:if(!e.replspaceApiSSHTokenGetRequest)throw Error("Expected replspaceApiSSHTokenGetRequest");return i=(t=e.replspaceApiSSHTokenGetRequest).nonce,o=t.replid,a=function(e){"open"===n.status&&n.send({replspaceApiSSHTokenGetResponse:e})},s=function(){a({token:"",nonce:i})},[4,m({replId:o})];case 1:if(l=r.sent(),"open"!==n.status)return[2];if("error"===l.type)return s(),p.logger.error(l.message),[2];return a({token:l.data.token,nonce:i,sshHostname:l.data.ssh_hostname}),[2]}})})()})}),{onConfirmSendToken:function(e){var t=function(t){return e(t)};return l.add(t),function(){l.delete(t)}},setWaitForFileClose:function(e){c=e}}}e.s(["default",()=>b,"fetchReplSshToken",()=>m],752394)},837416,e=>{"use strict";var t,n=e.i(878420),r=e.i(64386),i=e.i(530658),o=e.i(276385),a=e.i(389959),s=e.i(825118),l=e.i(10581),u=e.i(97349),c=e.i(538667),d=e.i(183187),f=e.i(986091),p=e.i(301736),h=e.i(773422),g=e.i(297083),m=e.i(817556),x=e.i(569910),y=e.i(222342),b=e.i(611361),w=e.i(906368),k=e.i(25082),_=e.i(467612),S=e.i(629712),C=e.i(792e3),j=e.i(170784),T=e.i(354507),E=e.i(752394),R=e.i(529810),I=e.i(875259),A=e.i(446530),P=e.i(613355),D=e.i(428596),O=e.i(140487),N=e.i(127227),M=e.i(818503),L=e.i(396776),B=e.i(960178),V=e.i(751273),F=e.i(625484),U=e.i(363201),G=e.i(940745),$=e.i(42458),z=(0,A.cssRecord)({infoIcon:[P.rcss.color.foregroundDimmer,{marginTop:3}],infoMessage:{flex:1}}),H=((t=H||{}).CannotMerge="CannotMerge",t.NothingToMerge="NothingToMerge",t.OnlyUncommittedChanges="OnlyUncommittedChanges",t.UncommittedAndCommittedChanges="UncommittedAndCommittedChanges",t.OnlyCommittedChanges="OnlyCommittedChanges",t),W=function(){var e,t,n=(0,c.useProjectGitState)(),r=n.commits,i=n.state;if((null==i?void 0:i.error)!=null||!(null==i?void 0:i.type)||i.type!==l.GitRepositoryStateType.NORMAL||(null==i?void 0:i.state)==null||null!=r.error||!(null==r?void 0:r.ours))return"CannotMerge";var o=i.state===l.GitRepositoryState.DIRTY_WORKTREE||i.state===l.GitRepositoryState.DIRTY_INDEX,a=!!((null==r||null==(e=r.ours)?void 0:e.length)&&(null==r||null==(t=r.ours)?void 0:t.length)>0);return o&&!a?"OnlyUncommittedChanges":o&&a?"UncommittedAndCommittedChanges":!o&&a?"OnlyCommittedChanges":"NothingToMerge"};function q(e){var t,n,r,c,d,f,p,h,A,P,H,q,K,Y,Q,X,J,Z,ee,et,en,er=e.sourceRepl,ei=e.destinationRepl,eo=e.projectId,ea=e.mainReplId,es=e.orgId,el=e.currentUser,eu=(0,y.default)().showError,ec=(0,D.useIdSeed)()("includeUncommittedChanges"),ed=(0,i._)((0,a.useState)(!1),2),ef=ed[0],ep=ed[1],eh=(0,i._)((n=(t={destinationReplId:ei.id,sourceReplId:er.id,onSuccess:function(e){var t=e.didAutoCommit;(0,u.trackProjectsFeatureUsed)({action:"merge",orgId:es,projectId:eo,autoCommitEnabled:t,sourceReplType:er.id===ea?"mainRepl":"devRepl",destinationReplType:ei.id===ea?"mainRepl":"devRepl"})}}).sourceReplId,r=t.destinationReplId,c=t.onSuccess,d=(0,R.default)().git,f=(0,a.useRef)(null),h=(p=(0,i._)((0,a.useState)(!1),2))[0],A=p[1],H=(P=(0,y.default)()).showError,q=P.showConfirm,K=(0,k.usePushToRemoteReplQuery)({variables:{id:r}}),Y=(0,a.useCallback)(function(){if(!K.data)return null;var e=K.data,t=e.getRepl,n=e.currentUser;if(!n||"Repl"!==t.__typename)return null;if(f.current)if(f.current.replId===t.id&&f.current.currentUserId===n.id)return f.current;else f.current.container.close();var r=(0,C.default)({onUnrecoverableError:function(e){w.captureException(e,{tags:{projects:!0},extra:{replid:t.id}})}});r.connect({context:(0,j.createConnectContext)({repl:t,currentUser:n}),getMinimumRetryDelayMs:function(){return 0}});var i=(0,S.default)({container:r}),o=(0,T.default)({container:r,fs:i}),a=(0,E.default)({container:r,fs:i,enableReplspaceSshTokenPassthrough:!0});return f.current={container:r,git:o,fs:i,replspace:a,replId:t.id,currentUserId:n.id},f.current},[K.data]),(0,a.useEffect)(function(){if(f.current){var e=f.current.container;return function(){e.close()}}},[]),[(0,a.useCallback)(function(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{autoCommit:!1}).autoCommit;return(0,g._)(function(){var t,r,i,o,a,u,f,p,h;return(0,m._)(this,function(x){switch(x.label){case 0:if(null==(r=(null==(t=K.data)?void 0:t.getRepl.__typename)==="Repl"?K.data.getRepl:null))return H("Please try again."),[2];i=r.title,A(!0),x.label=1;case 1:if(x.trys.push([1,7,8,9]),!e)return[3,3];return[4,function(e){return(0,g._)(function(e){var t,n,r;return(0,m._)(this,function(i){switch(i.label){case 0:return t=e.git,n=e.commitMessage,[4,t.stageFiles({all:!0})];case 1:if(i.sent().error)return[2,{success:!1,error:"Could not commit your changes"}];return[4,t.getRepositoryState()];case 2:if((r=i.sent()).error)return[2,{success:!1,error:"Could not commit your changes"}];if(r.state!==l.GitRepositoryState.DIRTY_INDEX)return[3,4];return[4,t.commit({message:n})];case 3:if(i.sent().error)return[2,{success:!1,error:"Could not commit your changes"}];i.label=4;case 4:return[2,{success:!0,error:null}]}})}).apply(this,arguments)}({git:d,commitMessage:e.message})];case 2:if((o=x.sent()).error)return H(o.error),[2];x.label=3;case 3:if(!(a=Y()))return H('Could not merge: the "'.concat(i,'" Repl could not be reached, please try again.')),[2];return[4,(u=a.git).getRepositoryState()];case 4:if((f=x.sent()).error)return H('Could not merge: the "'.concat(i,"\" Repl's git state could not be read, please try again.")),[2];if(f.state!==l.GitRepositoryState.CLEAN)return H('Could not merge: the "'.concat(i,'" Repl has uncommitted changes, please open that repl and commit or reset any changes.')),[2];return[4,(0,I.setupRemoteForReplId)({git:u,replId:n})];case 5:if(x.sent().error)return H('Could not merge: the "'.concat(i,'" Repl could not be reached, please try again.')),[2];return[4,u.pull({experimental_override_remote:{name:(0,I.remoteNameForRepl)(n),branch:"main"},allowConflicts:!1,mode:_.GitPullMode.REBASE})];case 6:if((p=x.sent()).error){switch(p.error){case s.GitErrors.MERGE_CONFLICT:h="this would result in a merge conflict. Get the latest changes in your repl, then try again.";break;case s.GitErrors.DIRTY_WORKTREE:h='the "'.concat(i,'" Repl has uncommitted changes, please open that repl and commit or reset any changes.');break;case s.GitErrors.HEAD_DETACHED:h='the "'.concat(i,'" Repl is on an unknown branch, please open that repl and checkout a branch before merging.');break;default:h='please check the "'.concat(i,'" Repl or try again.')}return H("Could not merge: ".concat(h)),[2]}return q("Changes pushed!"),d.forceRefresh(),null==c||c({didAutoCommit:!!e}),[3,9];case 7:return x.sent(),H("Could not merge: something went wrong, please try again."),[3,9];case 8:return A(!1),[7];case 9:return[2]}})})()},[K,Y,n,H,q,d,c]),{loading:h}]),2),eg=eh[0],em=eh[1].loading,ev=(J=(Q={replId:ei.id,orgId:es,projectId:eo,currentUserId:el.id}).replId,Z=Q.orgId,ee=Q.projectId,et=Q.currentUserId,Object.values(null!=(X=(0,b.useProjectPresenceUsersByRepl)({orgId:Z,projectId:ee})[J])?X:{}).filter(function(e){return e.id!==et})),ex=W(),ey="NothingToMerge"===ex||"CannotMerge"===ex||em,eb="Automatic commit for ".concat(er.title);switch(ex){case"NothingToMerge":en="You do not have any commits to merge in yet";break;case"CannotMerge":en="You cannot merge right now";break;case"OnlyUncommittedChanges":case"UncommittedAndCommittedChanges":case"OnlyCommittedChanges":en="Your changes will be pulled into ".concat(ei.title);break;default:(0,x.default)(ex)}return(0,o.jsxs)(F.View,{gap:8,children:[ev.length>0?(0,o.jsx)(L.StatusBanner,{icon:(0,o.jsx)($.default,{}),colorway:"orange",text:"".concat(ei.title," has active coders (@").concat(ev[0].username).concat(ev.length>1?" and others":"","). Merging may disrupt ongoing work.")}):null,(0,o.jsx)(V.Tooltip,{tooltip:en,isDisabled:null===en,placement:"top",maxWidth:300,children:(0,o.jsx)(O.Button,{colorway:"primary",text:"Merge changes into ".concat(ei.title),disabled:ey,onClick:function(){return(0,g._)(function(){return(0,m._)(this,function(e){switch(e.label){case 0:switch(ex){case"NothingToMerge":return[3,1];case"CannotMerge":return[3,2];case"OnlyCommittedChanges":return[3,3];case"UncommittedAndCommittedChanges":return[3,5];case"OnlyUncommittedChanges":return[3,7]}return[3,9];case 1:return eu("No changes to merge"),[3,10];case 2:return eu("You cannot merge right now"),[3,10];case 3:return[4,eg({autoCommit:!1})];case 4:case 6:case 8:return e.sent(),[3,10];case 5:return[4,eg({autoCommit:!!ef&&{message:eb}})];case 7:return[4,eg({autoCommit:{message:eb}})];case 9:(0,x.default)(ex),e.label=10;case 10:return[2]}})})()},loading:em,iconLeft:em?(0,o.jsx)(G.default,{}):void 0})}),"OnlyUncommittedChanges"===ex?(0,o.jsxs)(F.View,{row:!0,gap:6,children:[(0,o.jsx)(U.default,{css:z.infoIcon}),(0,o.jsx)(B.Text,{color:"dimmer",css:z.infoMessage,children:"All changes are uncommitted, so they will be automatically committed when you merge"})]}):null,"UncommittedAndCommittedChanges"===ex?(0,o.jsxs)(F.View,{row:!0,gap:6,children:[(0,o.jsx)(N.Checkbox,{id:ec,checked:ef,onChange:ep}),(0,o.jsx)(M.Label,{htmlFor:ec,children:(0,o.jsx)(B.Text,{color:"dimmer",children:"Include uncommitted changes in merge"})}),(0,o.jsx)(V.Tooltip,{tooltip:"Any changes you have not committed will be automatically committed and merged",delay:"default",children:(0,o.jsx)(U.default,{css:z.infoIcon})})]}):null]})}var K=e.i(541793),Y=e.i(569384),Q=e.i(973245),X=e.i(304277);function J(){var e=(0,Y._)(["\n  query ProjectCommitGraphRemoteRepl($id: String!) {\n    getRepl(id: $id) {\n      ... on Repl {\n        id\n        title\n      }\n    }\n  }\n"]);return J=function(){return e},e}e.i(566901);var Z={},ee=(0,Q.gql)(J()),et=e.i(46654),en=e.i(691490),er=e.i(730792),ei=e.i(607278),eo=(0,A.cssRecord)({input:[P.rcss.py(0),P.rcss.minHeight(24),P.rcss.pl(12)]}),ea=function(){var e=(0,R.default)().git;return(0,a.useCallback)(function(t){return(0,g._)(function(){return(0,m._)(this,function(n){switch(n.label){case 0:return[4,e.stageFiles({all:!0})];case 1:return n.sent(),[4,e.commit({message:t,allowEmpty:!1})];case 2:return n.sent(),e.forceRefresh(),[2]}})})()},[e])},es=function(e){var t=e.onDone,n=(0,i._)((0,a.useState)(""),2),r=n[0],s=n[1],l=ea(),u=(0,i._)((0,a.useState)(!1),2),c=u[0],d=u[1];return(0,o.jsx)(ei.Input,{autoFocus:!0,autoCapitalize:"off","aria-label":"Commit message",placeholder:"cmd+enter to commit",onKeyDown:function(e){return(0,g._)(function(){return(0,m._)(this,function(n){switch(n.label){case 0:if(!("Enter"===e.key&&e.metaKey))return[3,2];return e.stopPropagation(),e.preventDefault(),d(!0),[4,l(r)];case 1:n.sent(),d(!1),n.label=2;case 2:return"Escape"===e.key&&(s(""),t()),[2]}})})()},onChange:function(e){s(e.target.value)},disabled:c,onBlur:t,css:eo.input})},el=e.i(721281),eu=e.i(480028),ec=e.i(754873),ed=(0,e.i(123850).createCssVarTokens)(["commit-text-foreground","commit-extended-text-foreground","commit-graph-color","segment-grid-area"]),ef=ed.cssVars,ep=ed.styleTokens,eh=[P.rcss.position.absolute,{top:6,left:3,width:10,height:10,borderRadius:"50%"}],eg=(0,A.cssRecord)({graph:[P.rcss.display.grid,{gridTemplateAreas:'\n        "title-left title-left"\n        "action-left action-left"\n        "left left"\n        "spacer title-right"\n        "spacer action-right"\n        "spacer right"\n        "split-left split-right"\n        "common common"',gridTemplateColumns:"minmax(16px, min-content) 1fr",gridTemplateRows:"min-content ".repeat(8).trim()},(0,el._)({},P.container.min("tabletMin"),{gridTemplateAreas:'\n          "title-left title-right"\n          "action-left action-right"\n          "left right" \n          "split-left split-right"  \n          "common common"',gridTemplateColumns:"1fr 1fr",gridTemplateRows:"min-content ".repeat(5).trim()})],segment:[P.rcss.flex.column,P.rcss.align.start,P.rcss.justify.end,{listStyleType:"none",gridArea:ep["segment-grid-area"],minWidth:0,maxWidth:"100%"}],action:[{gridArea:ep["segment-grid-area"]}],title:[{gridArea:ep["segment-grid-area"]}],commit:[{minWidth:0,maxWidth:"100%"},{'&[data-interactive="true"]':[ec.interactive.nofill,P.rcss.border({width:0})]}],decoration:[P.rcss.position.relative,{height:"100%",width:16}],commitDot:[eh,{backgroundColor:ep["commit-graph-color"]}],commitDotUntracked:[eh,{"&:before":[eh,{boxSizing:"border-box",top:-2,left:-2,content:'""',border:"2px dashed ".concat(ep["commit-graph-color"])}],border:"2px solid ".concat(eu.tokens.accentPrimaryStronger)}],line:[{marginLeft:"auto",marginRight:"auto",position:"absolute",width:"2px",left:"calc(50% - ".concat(1,"px)"),height:"calc(100% - ".concat(8,"px)"),backgroundColor:ep["commit-graph-color"],transform:"translateY(".concat(15,"px)")},{background:"linear-gradient(to top, transparent 0%,  ".concat(ep["commit-graph-color"]," ").concat(10,"px)")},{"li:last-child  &":{height:"calc(100% - ".concat(15,"px)"),background:"none",backgroundColor:ep["commit-graph-color"]}}],commitColumn:[P.rcss.viewStyle,P.rcss.colWithGap(8),P.rcss.minHeight(24),{minWidth:0,maxWidth:"calc(100% - ".concat(16,"px)"),overflow:"hidden"}],commitMessage:[{color:ep["commit-text-foreground"]}],commitDescription:[{color:ep["commit-extended-text-foreground"]}],splitLeft:[{gridArea:"split-left",position:"relative",height:16,width:"100%"}],splitRight:[{gridArea:"split-right",position:"relative",height:16,width:16}],curveRight:[P.rcss.position.absolute,{bottom:0,left:7,borderRadius:"100% 0 0 0",borderTop:"2px solid ".concat(ep["commit-graph-color"]),borderLeft:"2px solid ".concat(ep["commit-graph-color"]),height:9,width:9}],curveUp:[P.rcss.position.absolute,{top:0,left:0,borderRadius:"0 0 100% 0",borderBottom:"2px solid ".concat(ep["commit-graph-color"]),borderRight:"2px solid ".concat(ep["commit-graph-color"]),height:9,width:9}],fullLine:[{position:"absolute",width:2,height:"100%",left:7,backgroundColor:ep["commit-graph-color"]}],sidewaysLine:[{position:"absolute",width:"calc(100% - ".concat(16,"px)"),height:2,left:16,top:7,backgroundColor:ep["commit-graph-color"]}],compactLine:[P.rcss.height("100%"),P.rcss.position.relative,{gridArea:"spacer"},(0,el._)({},P.container.min("tabletMin"),{display:"none"})]}),em=function(e){var t=e.children,n=e.hasLeft,r=e.hasRight;return(0,o.jsxs)(F.View,{css:eg.graph,children:[t,(0,o.jsx)(eb,{hasLeft:n,hasRight:r}),(0,o.jsx)("div",{css:eg.compactLine,children:(0,o.jsx)("div",{css:eg.decoration,children:(0,o.jsx)("div",{css:eg.fullLine,style:n?(0,el._)({},ef["commit-graph-color"],eu.tokens.accentPrimaryDefault):{}})})})]})},ev=function(e){var t,n,r=e.children,i=e.area,s=e.title,l=e.action;if(!a.Children.count(r))return null;var u="common"===i?(t={},(0,el._)(t,ef["segment-grid-area"],i),(0,el._)(t,ef["commit-graph-color"],eu.tokens.outlineDefault),(0,el._)(t,ef["commit-text-foreground"],eu.tokens.foregroundDimmer),(0,el._)(t,ef["commit-extended-text-foreground"],eu.tokens.foregroundDimmest),t):(n={},(0,el._)(n,ef["segment-grid-area"],i),(0,el._)(n,ef["commit-graph-color"],eu.tokens.accentPrimaryDefault),(0,el._)(n,ef["commit-text-foreground"],eu.tokens.accentPrimaryStrongest),(0,el._)(n,ef["commit-extended-text-foreground"],eu.tokens.foregroundDimmest),n);return(0,o.jsxs)(o.Fragment,{children:["common"===i?null:(0,o.jsx)(ey,{area:i,children:s}),"common"===i?null:(0,o.jsx)(ex,{area:i,children:l}),(0,o.jsx)(F.View,{style:u,tag:"ol",css:eg.segment,"aria-label":i,children:r})]})},ex=function(e){var t=e.children,n=e.area,r=(0,el._)({},ef["segment-grid-area"],"action-".concat(n));return(0,o.jsx)(F.View,{style:r,css:eg.action,py:4,row:!0,gap:8,children:t})},ey=function(e){var t=e.children,n=e.area,r=(0,el._)({},ef["segment-grid-area"],"title-".concat(n));return(0,o.jsx)(F.View,{style:r,css:eg.title,children:"string"==typeof t?(0,o.jsx)(B.Header,{level:3,variant:"subheadDefault",color:"dimmer",children:t}):t})},eb=function(e){var t=e.hasLeft,n=e.hasRight,r=(0,el._)({},ef["commit-graph-color"],t?eu.tokens.accentPrimaryDefault:"transparent"),i=(0,el._)({},ef["commit-graph-color"],n?eu.tokens.accentPrimaryDefault:"transparent");return t||n?(0,o.jsxs)(o.Fragment,{children:[(0,o.jsxs)("div",{css:eg.splitLeft,children:[(0,o.jsxs)("div",{css:eg.decoration,children:[(0,o.jsx)("div",{css:eg.line,"data-line":!0,style:r}),(0,o.jsx)("div",{css:eg.fullLine,"data-full-line":!0,style:r})]}),(0,o.jsx)("div",{css:eg.curveRight,style:i}),(0,o.jsx)("div",{css:eg.sidewaysLine,style:i})]}),(0,o.jsx)("div",{css:eg.splitRight,style:i,children:(0,o.jsx)("div",{css:eg.curveUp})})]}):null},ew=function(e){var t=e.onClick,n=e.children,r=e.className;return t?(0,o.jsx)(O.BaseButton,{className:r,onPress:t,css:P.rcss.reset.button,children:n}):(0,o.jsx)("div",{className:r,children:n})},ek=function(e){var t=e.message,n=e.description,r=e.type,i=e.onClick;return(0,o.jsxs)(F.View,{tag:"li",css:eg.commit,pr:8,row:!0,align:"start",justify:"start","data-interactive":!!i,children:[(0,o.jsxs)("div",{css:eg.decoration,children:[(0,o.jsx)("div",{css:eg.line}),(0,o.jsx)("div",{css:"working"===r?eg.commitDotUntracked:eg.commitDot})]}),(0,o.jsxs)(ew,{onClick:i,css:eg.commitColumn,children:[(0,o.jsx)(B.Text,{multiline:!1,css:eg.commitMessage,style:"working"===r?(0,el._)({},ef["commit-text-foreground"],eu.tokens.accentPrimaryStronger):{},children:t}),n?(0,o.jsx)(B.Text,{css:eg.commitDescription,children:n}):null]})]})},e_=function(){var e=(0,i._)((0,a.useState)(!1),2),t=e[0],n=e[1];return t?(0,o.jsx)("li",{children:(0,o.jsx)(es,{onDone:function(){return n(!1)}})}):(0,o.jsx)(ek,{type:"working",message:"uncommitted changes",onClick:function(){return n(!0)}})},eS=function(e){var t,r,i,a,s,u,d,f,p,h,g,m=(h={variables:{id:e.selectedRepl.id}},g=(0,n._)({},Z,h),X.useQuery(ee,g)).data,x=(0,c.useProjectGitState)(),y=x.state,b=x.commits,w=(null==y?void 0:y.error)?null:null!=(d=null==y?void 0:y.state)?d:null,k=(null==y?void 0:y.error)?null:null!=(f=null==y?void 0:y.type)?f:null,_=(null==m||null==(t=m.getRepl)?void 0:t.__typename)==="Repl"&&m.getRepl.title||"Remote",S=((p=k===l.GitRepositoryStateType.NORMAL&&w!==l.GitRepositoryState.CLEAN,true),p);if(null==b?void 0:b.error)return(0,o.jsx)(B.Text,{children:b.error});var C=!!(null==b||null==(r=b.theirs)?void 0:r.length),j=!!(null==b||null==(i=b.ours)?void 0:i.length)||S;return(0,o.jsxs)(em,{hasLeft:C,hasRight:j,children:[C?(0,o.jsx)(ev,{area:"left",title:_,children:null==b||null==(a=b.theirs)?void 0:a.map(function(e){return(0,o.jsx)(ek,{message:e.subject,description:"".concat(e.author.name,", ").concat((0,et.ago)(e.author.date))},e.hash)})}):null,j?(0,o.jsxs)(ev,{area:"right",title:"My workspace",children:[S?(0,o.jsx)(e_,{}):null,null==b||null==(s=b.ours)?void 0:s.map(function(e){return(0,o.jsx)(ek,{message:e.subject,description:"".concat(e.author.name,", ").concat((0,et.ago)(e.author.date))},e.hash)})]}):null,(0,o.jsx)(ev,{area:"common",children:null==b||null==(u=b.both)?void 0:u.map(function(e){return(0,o.jsx)(ek,{message:e.subject,description:"".concat(e.author.name,", ").concat((0,et.ago)(e.author.date))},e.hash)})})]})},eC=function(e){var t=(0,i._)((0,a.useState)(function(){return(0,K.createStore)()}),1)[0];return(0,o.jsxs)(er.GitPaneErrorContext.Provider,{value:t,children:[(0,o.jsx)(en.default,{}),(0,o.jsx)(eS,(0,n._)({},e))]})},ej=e.i(136540),eT=e.i(848969),eE=e.i(185591),eR=e.i(496019),eI=e.i(230999),eA=e.i(189373),eP=e.i(243914),eD=e.i(121817),eO=e.i(902846),eN=(0,A.cssRecord)({header:[P.rcss.border({color:eu.tokens.outlineDimmest,direction:"bottom"})],headerLeft:[P.rcss.flex.wrap,P.rcss.align.center,{flex:1}],comboBoxAndActions:[P.rcss.flex.wrap,P.rcss.flex.shrink(1)],iconButton:[P.rcss.color.foregroundDimmer,P.rcss.hover(P.rcss.color.foregroundDefault)],swapIcon:[P.rcss.color.foregroundDimmest,{rotate:"90deg"}],warnings:[{"&:empty":P.rcss.display.none}],toggle:[P.rcss.minWidth(123)],errorView:[P.rcss.rowWithGap(8),P.rcss.justify.center],viewSection:[P.rcss.px(8),P.rcss.py(12),{":not(:last-of-type)":P.rcss.border({color:eu.tokens.outlineDimmest,direction:"bottom"})}]}),eM=function(e){var t=e.selectedRepl,n=e.currentRepl,r=e.remoteResult,i=e.tab,a=e.isMainRepl;return t?"Loading"===r.state?(0,o.jsx)(G.default,{}):"Error"===r.state?(0,o.jsx)(B.Text,{children:"Something went wrong, please try again."}):"changes"===i?(0,o.jsx)(f.ChangesSection,{selectedRepl:t,isMainRepl:a}):(0,o.jsx)(eC,{selectedRepl:t,currentRepl:n}):(0,o.jsx)(B.Text,{children:"Select a Repl to compare against your current Repl."})},eL=(0,a.forwardRef)(function(e,t){var f,g,m,x,y,b=e.repl,w=e.project,k=e.openGitPane,_=e.org,S=e.currentUser,C=!!w.mainRepl&&b.id===w.mainRepl.id,j=(0,i._)((0,a.useState)(C?null:null!=(g=w.mainRepl)?g:null),2),T=j[0],E=j[1],R=(0,i._)((0,a.useState)("changes"),2),I=R[0],A=R[1],P=function(){return A("changes"===I?"commits":"changes")};(0,a.useEffect)(function(){(0,u.trackProjectsFeatureUsed)({action:"tabOpened",orgId:_.id,projectId:w.id,tab:I,replType:C?"mainRepl":"devRepl"})},[I,w,_,C]);var D=(0,c.useProjectGitStateHooks)({selectedReplId:null!=(m=null==T?void 0:T.id)?m:null}),N=D.isFetching,M=D.refetch,V=D.state,U=D.remote,z=D.pull,H=z.doPull,W=z.state,K=W.error,Y=W.loading,Q=(null==V?void 0:V.error)?null:null!=(x=null==V?void 0:V.state)?x:null;return(0,o.jsx)(c.ProjectGitStateContext.Provider,{value:D,children:(0,o.jsxs)(F.View,{innerRef:t,children:[(0,o.jsxs)(F.View,{css:eN.header,p:8,row:!0,gap:2,children:[(0,o.jsxs)(F.View,{css:eN.headerLeft,row:!0,gap:8,children:["changes"===I?(0,o.jsx)(O.Button,{css:eN.toggle,text:"Changes",iconLeft:(0,o.jsx)(eA.default,{}),iconRight:(0,o.jsx)(eO.default,{css:eN.swapIcon}),onClick:P},"toggle"):(0,o.jsx)(O.Button,{css:eN.toggle,text:"Commits",iconLeft:(0,o.jsx)(eI.default,{}),iconRight:(0,o.jsx)(eO.default,{css:eN.swapIcon}),onClick:P},"toggle"),(0,o.jsx)(B.Text,{color:"dimmer",multiline:!0,children:"compared against"}),(0,o.jsxs)(F.View,{css:eN.comboBoxAndActions,row:!0,gap:8,children:[(0,o.jsx)(d.ProjectReplsComboBox,{"aria-label":"Select a Repl",replId:b.id,selectedReplId:null!=(y=null==T?void 0:T.id)?y:null,onSelect:E}),(0,o.jsxs)(F.View,{row:!0,gap:0,align:"center",children:[(0,o.jsx)(ej.IconButton,{alt:"Pull",onClick:function(){H({branch:"main"}),(0,u.trackProjectsFeatureUsed)({action:"pull",orgId:_.id,projectId:w.id,replType:C?"mainRepl":"devRepl"})},disabled:Y||C,css:eN.iconButton,children:N?(0,o.jsx)(G.default,{}):(0,o.jsx)(eR.default,{})}),T?(0,o.jsx)(eT.IconButtonLink,(0,r._)((0,n._)({alt:"Go to ".concat(T.title),target:"_blank"},(0,eE.replLinkProps)(T,{initialPaneType:"project"})),{css:eN.iconButton,children:(0,o.jsx)(eP.default,{})})):null]})]})]}),(0,o.jsx)(F.View,{pt:4,row:!0,gap:8,children:(0,o.jsx)(ej.IconButton,{alt:"Fetch",onClick:M,disabled:"Success"!==U.state,css:eN.iconButton,children:N?(0,o.jsx)(G.default,{}):(0,o.jsx)(eD.default,{})})})]}),(0,o.jsxs)(F.View,{css:eN.warnings,p:8,gap:12,children:[K===s.GitErrors.DIRTY_WORKTREE?(0,o.jsx)(F.View,{css:eN.errorView,children:(0,o.jsx)(L.StatusBanner,{colorway:"negative",icon:(0,o.jsx)($.default,{}),text:"You have uncommitted changes. Please commit them before pulling."})}):null,K===s.GitErrors.MERGE_CONFLICT?(0,o.jsxs)(F.View,{css:eN.errorView,children:[(0,o.jsx)(L.StatusBanner,{colorway:"negative",icon:(0,o.jsx)($.default,{}),text:"There were conflicts in the changes you are trying to pull. Click to resolve them."}),(0,o.jsx)(O.Button,{text:"Resolve Manually",onClick:function(){k(),H({branch:"main",allowConflicts:!0}),(0,u.trackProjectsFeatureUsed)({projectId:w.id,orgId:_.id,action:"pullWithConflicts",replType:C?"mainRepl":"devRepl"})},colorway:"negative"})]}):null,Q===l.GitRepositoryState.MERGING?(0,o.jsx)(L.StatusBanner,{colorway:"primary",text:"Merge in progress"}):null,Q===l.GitRepositoryState.REBASING?(0,o.jsx)(L.StatusBanner,{colorway:"primary",text:"Rebase in progress"}):null,(0,o.jsx)(p.GitIgnoreWarning,{})]}),C?(0,o.jsx)(F.View,{css:eN.viewSection,children:(0,o.jsx)(h.MainReplSection,{selectedRepl:null!=T?T:void 0})}):null,!C&&T?(0,o.jsx)(F.View,{css:eN.viewSection,children:(0,o.jsx)(q,{destinationRepl:T,sourceRepl:b,projectId:w.id,mainReplId:null==(f=w.mainRepl)?void 0:f.id,orgId:_.id,currentUser:S})}):null,(0,o.jsx)(F.View,{css:eN.viewSection,children:(0,o.jsx)(eM,{currentRepl:b,selectedRepl:T,remoteResult:U,isMainRepl:C,tab:I})})]})})});e.s(["ReplToReplMerge",()=>eL],837416)},367017,124116,349602,e=>{"use strict";var t=e.i(276385),n=e.i(960933),r=e.i(862927),i=e.i(389959),o=e.i(932287),a=e.i(222342),s=e.i(207237),l=e.i(537548),u=e.i(86159),c=e.i(883117),d=e.i(837416),f=e.i(654781),p=e.i(446530),h=e.i(613355),g=e.i(960178),m=e.i(625484),x=e.i(940745),y=(0,p.cssRecord)({container:[h.rcss.p(8)]});function b(e){var n,r,p=e.isActive,h=e.performPaneOperation,b=(0,u.useSetTourStepTarget)(l.projectsTour.id,l.StepIds.ProjectPane),w=(0,s.default)(),k=(0,f.useInitProjectSshConfig)(),_=(0,o.useProjectPaneQuery)({variables:{id:w}}),S=_.data,C=_.loading,j=_.error,T=(null==S?void 0:S.getRepl.__typename)==="Repl"?S.getRepl:null,E=(null==S?void 0:S.currentUser)?S.currentUser:null,R=(null==T||null==(n=T.project)?void 0:n.__typename)==="Project"?T.project:null,I=(null==R||null==(r=R.org)?void 0:r.__typename)==="Org"?R.org:null,A=(0,a.default)().showError,P="error"===k.state?k.error:null;return((0,i.useEffect)(function(){P&&A(P)},[A,P]),(0,c.useGitRefreshWhenIsActive)(p),C||"loading"===k.state)?(0,t.jsx)(m.View,{p:16,row:!0,gap:8,justify:"center",children:(0,t.jsx)(x.default,{})}):I&&R?!j&&T&&E?(0,t.jsx)(d.ReplToReplMerge,{ref:b,repl:T,project:R,org:I,openGitPane:function(){return h({operation:"open",pane:{type:"git"}})},currentUser:E}):(0,t.jsx)(m.View,{css:y.container,children:(0,t.jsx)(g.Text,{children:"Something went wrong, please try again."})}):(0,t.jsx)(m.View,{css:y.container,children:(0,t.jsx)(g.Text,{children:"This Repl is not a project!"})})}e.i(282890);var w=e.i(716636),k=e.i(754896),_=n.Type.Object({type:n.Type.Literal("project")}),S={Content:function(e){var n=e.options,r=n.isActive,i=n.performPaneOperation;return(0,t.jsx)(b,{isActive:r,performPaneOperation:i})},Icon:function(){return(0,t.jsx)(k.default,{})},getTitle:function(){return"Project"},description:"Manage changes in your Project and sync or merge changes across Apps in the Project",category:w.PaneCategory.WorkspaceFeatures,decode:function(e){return r.Value.Decode(_,e)}};e.s(["projectUI",()=>S],367017);var C=n.Type.Object({type:n.Type.Literal("replitAuth")}),j=function(e){return r.Value.Decode(C,e)};e.s(["decode",()=>j],124116);var T=e.i(878420),E=e.i(569384),R=e.i(973245),I=e.i(304277);e.i(566901);var A=e.i(951262);function P(){var e=(0,E._)(["\n  query ReplitAuth($id: String!) {\n    getRepl(id: $id) {\n      ... on Repl {\n        id\n        title\n        iconUrl\n        hasAuthUsers\n        authorizations {\n          editMetadata {\n            isAuthorized\n          }\n          manageAuth {\n            isAuthorized\n            code\n            message\n          }\n        }\n        authProviderConfig {\n          ... on AuthProviderConfig {\n            id\n            minimizedProviders\n          }\n        }\n      }\n    }\n  }\n"]);return P=function(){return e},e}function D(){var e=(0,E._)(["\n  query ReplitAuthUsers(\n    $id: String!\n    $count: Int\n    $after: String\n    $orderBy: ReplitAuthUserOrderByInput\n    $filter: ReplitAuthUserFilterInput\n  ) {\n    getRepl(id: $id) {\n      ... on Repl {\n        id\n        authUsers(\n          count: $count\n          after: $after\n          orderBy: $orderBy\n          filter: $filter\n        ) {\n          items {\n            id\n            banned\n            timeCreated\n            lastLoggedIn\n            displayName\n            image\n            email\n            userId\n          }\n          pageInfo {\n            hasNextPage\n            nextCursor\n          }\n        }\n      }\n    }\n  }\n"]);return D=function(){return e},e}function O(){var e=(0,E._)(["\n  mutation UpdateRepl($input: UpdateReplInput!) {\n    updateRepl(input: $input) {\n      repl {\n        id\n        title\n        iconUrl\n      }\n    }\n  }\n"]);return O=function(){return e},e}function N(){var e=(0,E._)(["\n  mutation UpdateReplitAuthProviderConfig(\n    $input: UpdateReplitAuthProviderConfigInput!\n  ) {\n    updateReplitAuthProviderConfig(input: $input) {\n      ... on AuthProviderConfig {\n        id\n        minimizedProviders\n      }\n    }\n  }\n"]);return N=function(){return e},e}function M(){var e=(0,E._)(["\n  mutation UpdateReplitAuthUserBanStatus(\n    $input: UpdateReplitAuthUserBanStatusInput!\n  ) {\n    updateReplitAuthUserBanStatus(input: $input) {\n      ... on UpdateReplitAuthUserBanStatusOutput {\n        success\n        message\n        user {\n          id\n          banned\n        }\n      }\n      ... on NotFoundError {\n        message\n      }\n      ... on UnauthorizedError {\n        message\n      }\n    }\n  }\n"]);return M=function(){return e},e}var L={},B=(0,R.gql)(P());function V(e){var t=(0,T._)({},L,e);return I.useQuery(B,t)}var F=(0,R.gql)(D());function U(e){var t=(0,T._)({},L,e);return I.useQuery(F,t)}(0,R.gql)(O());var G=(0,R.gql)(N());function $(e){var t=(0,T._)({},L,e);return A.useMutation(G,t)}var z=(0,R.gql)(M());function H(e){var t=(0,T._)({},L,e);return A.useMutation(z,t)}e.s(["useReplitAuthQuery",()=>V,"useReplitAuthUsersQuery",()=>U,"useUpdateReplitAuthProviderConfigMutation",()=>$,"useUpdateReplitAuthUserBanStatusMutation",()=>H],349602)},783742,e=>{"use strict";var t=e.i(276385);e.i(282890);var n=e.i(716636),r=e.i(124116),i=e.i(530658),o=e.i(412160),a=e.i(389959),s=e.i(349602),l=e.i(761201),u=e.i(207237),c=e.i(297083),d=e.i(346715),f=e.i(817556),p=e.i(737362),h=e.i(222342),g=e.i(142365),m=e.i(213733),x=e.i(858248),y=e.i(709485),b=e.i(445016),w=e.i(795903),k=e.i(468095),_=e.i(604963),S=e.i(552144),C=e.i(363201);function j(e){var n=e.openPane,r=(0,k.useSendAgentMessage)({openPane:n}),o=(0,i._)((0,a.useState)(!1),2),s=o[0],l=o[1],u=(0,a.useCallback)(function(e){r("Add Replit Auth to my app",e),l(!1)},[r]);return(0,t.jsxs)(_.PopoverTrigger,{isOpen:s,onOpenChange:l,label:"Ask Agent options",placement:"bottom start",children:[(0,t.jsx)(S.StatusBannerButton,{iconLeft:(0,t.jsx)(C.default,{}),text:"Replit Auth is not configured. Click set up with Agent, and log into your app once with Replit Auth to configure.",colorway:"primary",onClick:function(){return l(!0)}}),(0,t.jsx)(w.SendAgentMessageMenu,{onClick:u})]})}var T=e.i(480028),E=e.i(446530),R=e.i(613355),I=e.i(428596),A=e.i(140487),P=e.i(127227),D=e.i(607278),O=e.i(929872),N=e.i(960178),M=e.i(625484),L=e.i(836224),B=e.i(848295),V=e.i(523579),F=e.i(689707),U=e.i(940745),G=e.i(355744),$=e.i(690472),z=(0,E.cssRecord)({loadingContainer:[R.rcss.height("100%")],sectionContainer:[R.rcss.mb(24)],providerItem:[R.rcss.gap(8)],form:[R.rcss.p(0)],sectionTitle:[R.rcss.mb(16)],sectionSubtitle:[R.rcss.mb(16)],providerIconContainer:[R.rcss.mr(8),R.rcss.flex.row,R.rcss.align.center],errorText:[{color:T.tokens.foregroundDefault}],configContent:[{maxWidth:430}],pageTitle:[R.rcss.mb(16)],saveButton:[R.rcss.mt(16)]}),H=[{id:"google",label:"Google",icon:(0,t.jsx)(F.default,{size:16})},{id:"github",label:"GitHub",icon:(0,t.jsx)(V.default,{size:16})},{id:"x",label:"X",icon:(0,t.jsx)($.default,{size:16})},{id:"apple",label:"Apple",icon:(0,t.jsx)(B.default,{size:16})},{id:"email",label:"Email",icon:(0,t.jsx)(G.default,{size:16})}];function W(e){var n=e.replId,r=e.hasAuthUsers,o=e.openPane,l=(0,s.useReplitAuthQuery)({variables:{id:n}}),u=l.data,w=l.loading,k=(0,h.default)(),_=k.showError,S=k.showConfirm,C=(0,i._)((0,a.useState)(""),2),T=C[0],E=C[1],B=(0,i._)((0,a.useState)([]),2),V=B[0],F=B[1],G=(0,I.useIdSeed)(),$=(0,a.useRef)(void 0),W=(0,a.useRef)([]);(0,g.useTrackEffect)(y.events.AUTH_PANE_USED,{action:"Configure Tab Viewed",replId:n});var q=(0,i._)((0,p.useWorkspaceHeaderReplInfoUpdateReplMutation)({onError:function(e){return _((0,m.default)(e.message))},onCompleted:function(e){S("App info updated successfully");var t=e.updateRepl.repl;t&&"url"in t&&t.url&&t.url!==$.current&&(window.history.replaceState(null,"",t.url+window.location.search+window.location.hash),$.current=t.url)}}),1)[0],K=(0,i._)((0,s.useUpdateReplitAuthProviderConfigMutation)({onError:function(e){_((0,m.default)(e.message))},onCompleted:function(e){e.updateReplitAuthProviderConfig&&"AuthProviderConfig"===e.updateReplitAuthProviderConfig.__typename?(S("Login providers updated"),W.current=(0,d._)(V)):_("Failed to update login providers")}}),2),Y=K[0],Q=K[1].loading,X=(0,a.useCallback)(function(){if((null==u?void 0:u.getRepl)&&"Repl"===u.getRepl.__typename){E(u.getRepl.title||""),"url"in u.getRepl&&"string"==typeof u.getRepl.url&&($.current=u.getRepl.url);var e=u.getRepl.authProviderConfig,t=H.map(function(e){return e.id});e&&"AuthProviderConfig"===e.__typename&&e.minimizedProviders&&(t=t.filter(function(t){return!e.minimizedProviders.includes(t)})),F(t),W.current=(0,d._)(t)}},[u]);(0,a.useEffect)(function(){u&&X()},[u,X]);var J=function(){(0,x.track)(y.events.AUTH_PANE_USED,{action:"App Info Saved",appName:T}),q({variables:{input:{id:n,title:T}}})},Z=function(e){F(function(t){return t.includes(e)?t.filter(function(t){return t!==e}):(0,d._)(t).concat([e])})};if(w)return(0,t.jsx)(M.View,{css:z.loadingContainer,row:!0,justify:"center",align:"center",children:(0,t.jsx)(U.default,{size:24})});var ee=(null==u?void 0:u.getRepl)&&"Repl"===u.getRepl.__typename?u.getRepl:null;return ee?(0,t.jsxs)(M.View,{css:z.configContent,gap:12,children:[!1===r&&(0,t.jsx)(j,{openPane:o}),(0,t.jsx)(N.Text,{variant:"subheadBig",css:z.pageTitle,children:"Configure your log in screen"}),(0,t.jsxs)(M.View,{css:z.sectionContainer,children:[(0,t.jsx)(N.Text,{css:z.sectionTitle,variant:"subheadDefault",children:"App info"}),(0,t.jsx)("form",{css:z.form,onSubmit:function(e){e.preventDefault(),J()},children:(0,t.jsx)(M.View,{align:"stretch",gap:16,children:(0,t.jsxs)(O.Surface,{background:"default",gap:16,children:[(0,t.jsx)(M.View,{children:(0,t.jsxs)(M.View,{gap:4,children:[(0,t.jsxs)(M.View,{row:!0,justify:"space-between",align:"end",children:[(0,t.jsx)("label",{htmlFor:G("app-name"),children:(0,t.jsx)(N.Text,{variant:"small",color:"dimmer",multiline:!1,children:"Name"})}),(0,t.jsx)(L.default,{maxLength:60,value:T,hideLabel:!0})]}),(0,t.jsx)(D.Input,{value:T,onChange:function(e){return E(e.target.value)},onBlur:J,placeholder:"Your app name",maxLength:60,id:G("app-name")})]})}),(0,t.jsx)(b.default,{replId:n,authz:{isAuthorized:ee&&ee.authorizations.editMetadata.isAuthorized},initialIconUrl:ee.iconUrl||"",originIconUrl:""})]})})})]}),(0,t.jsxs)(M.View,{css:z.sectionContainer,children:[(0,t.jsx)(N.Text,{css:z.sectionTitle,variant:"subheadDefault",children:"Log in providers"}),(0,t.jsx)(N.Text,{multiline:!0,css:z.sectionSubtitle,children:"Choose which login options to display prominently. Unchecked options will appear in a dropdown menu."}),(0,t.jsx)(M.View,{gap:12,children:H.map(function(e){return(0,t.jsxs)(M.View,{css:z.providerItem,row:!0,align:"center",children:[(0,t.jsx)(P.Checkbox,{checked:V.includes(e.id),onChange:function(){return Z(e.id)},id:G("provider-".concat(e.id))}),(0,t.jsx)("label",{htmlFor:G("provider-".concat(e.id)),children:(0,t.jsxs)(M.View,{css:R.rcss.flex.row,align:"center",children:[(0,t.jsx)(M.View,{css:z.providerIconContainer,children:e.icon}),(0,t.jsx)(N.Text,{children:e.label})]})})]},e.id)})}),(0,t.jsx)(M.View,{css:z.saveButton,children:(0,t.jsx)(A.Button,{onClick:function(){return(0,c._)(function(){var e;return(0,f._)(this,function(t){switch(t.label){case 0:return e=H.map(function(e){return e.id}).filter(function(e){return!V.includes(e)}),(0,x.track)(y.events.AUTH_PANE_USED,{action:"Login Providers Saved",selectedProviders:V,minimizedProviders:e}),[4,Y({variables:{input:{replId:n,minimizedProviders:e}}})];case 1:return t.sent(),[2]}})})()},text:"Save providers",colorway:"primary",loading:Q,disabled:Q})})]})]}):(0,t.jsx)(M.View,{children:(0,t.jsx)(N.Text,{css:z.errorText,children:"Error loading app information."})})}var q=e.i(721281),K=e.i(878420),Y=e.i(64386),Q=e.i(162914),X=e.i(714165),J=e.i(136540),Z=e.i(249373),ee=e.i(734582),et=e.i(601059),en=e.i(739521),er=e.i(624782),ei=e.i(51054),eo=e.i(272119),ea=e.i(423828),es=e.i(257811),el=e.i(71754),eu=e.i(196353),ec=e.i(353384),ed={userId:"USER_ID",name:"NAME",username:"USERNAME",added:"LAST_LOGIN",email:"EMAIL"},ef=[{key:"userId",label:"User ID",isRowHeader:!0,className:"userIdColumn",allowSorting:!1},{key:"email",label:"Email",className:"emailColumn",allowSorting:!0},{key:"name",label:"Name",className:"nameColumn",allowSorting:!0},{key:"lastLoggedIn",label:"Last logged in",className:"lastLoggedInColumn",allowSorting:!0},{key:"actions",label:"",alignment:"end",className:"actionsColumn"}],ep=(0,E.cssRecord)({wrapper:[R.rcss.height("100%"),R.rcss.display.flex,R.rcss.flex.column],container:[R.rcss.flex.column,R.rcss.flex.grow(1),R.rcss.height("100%")],headerTitle:[R.rcss.mb(16),R.rcss.flex.row,R.rcss.align.center,R.rcss.gap(8)],tableWrapper:[R.rcss.flex.column,R.rcss.flex.growAndShrink(1),R.rcss.minHeight(0),R.rcss.overflow("hidden")],table:[R.rcss.width("100%"),R.rcss.height("100%"),R.rcss.container("table"),R.rcss.flex.grow(1),{"& .userIdColumn":{minWidth:100,maxWidth:200,width:"15%"},"& .nameColumn":{minWidth:200,maxWidth:350,width:"20%"},"& .emailColumn":(0,q._)({minWidth:200,maxWidth:350,width:"25%"},R.container.max(800,"table"),[{display:"none"}]),"& .lastLoggedInColumn":{minWidth:150,maxWidth:200,width:"10%"},"& .actionsColumn":{width:"10%"}}],searchContainer:[R.rcss.mb(16),{width:"fit-content"}]}),eh=(0,E.cssRecord)({modalContent:[R.rcss.flex.column,R.rcss.gap(16)],detailsRow:[R.rcss.flex.column,R.rcss.gap(4)],label:[R.rcss.color.foregroundDefault,{fontSize:T.tokens.fontSizeSmall,lineHeight:T.tokens.lineHeightDefault,fontWeight:T.tokens.fontWeightMedium}],value:[R.rcss.gap(8),R.rcss.color.foregroundDimmer,{fontSize:T.tokens.fontSizeDefault,lineHeight:T.tokens.lineHeightDefault}],buttonsContainer:[R.rcss.gap(8)]}),eg=(0,E.cssRecord)({title:[R.rcss.mb(16)]});function em(e,t){var n=(0,h.default)(),r=n.showConfirm,o=n.showError,a=(0,i._)((0,s.useUpdateReplitAuthUserBanStatusMutation)(),1)[0];return function(){return(0,c._)(function(){var n,i;return(0,f._)(this,function(s){switch(s.label){case 0:if(!t)return[2];s.label=1;case 1:return s.trys.push([1,3,,4]),(0,x.track)(y.events.AUTH_PANE_USED,{action:t.banned?"User Unbanned":"User Banned",userId:t.userId}),[4,a({variables:{input:{replId:e,userId:Number(t.userId),action:t.banned?"UNBAN":"BAN"}},update:function(e,n){var r=n.data;(null==r?void 0:r.updateReplitAuthUserBanStatus.__typename)==="UpdateReplitAuthUserBanStatusOutput"&&r.updateReplitAuthUserBanStatus.success&&e.modify({id:e.identify({__typename:"ReplitAuthUser",id:t.id}),fields:{banned:function(){return!t.banned}}})}})];case 2:return(null==(i=null==(n=s.sent().data)?void 0:n.updateReplitAuthUserBanStatus)?void 0:i.__typename)==="UpdateReplitAuthUserBanStatusOutput"&&i.success?r(i.message):(null==i?void 0:i.__typename)==="NotFoundError"||(null==i?void 0:i.__typename)==="UnauthorizedError"?o(i.message):o("Failed to update ban status"),[3,4];case 3:return s.sent(),o("Failed to update ban status"),[3,4];case 4:return[2]}})})()}}function ev(e){var n,r=e.replId,o=e.hasAuthUsers,l=e.openPane,u=(0,i._)((0,a.useState)(""),2),p=u[0],h=u[1],m=(0,i._)((0,a.useState)(null),2),b=m[0],w=m[1],k=(0,i._)((0,a.useState)(!1),2),_=k[0],S=k[1],C=(0,i._)((0,a.useState)({field:"LAST_LOGIN",direction:"DESC"}),2),T=C[0],E=C[1],R=(0,a.useRef)(null),I=(0,Q.default)(p,500);(0,g.useTrackEffect)(y.events.AUTH_PANE_USED,{action:"Users Tab Viewed",replId:r}),(0,g.useTrackEffectWithPredicate)(y.events.AUTH_PANE_USED,{action:"Users Searched"},function(){return!!I},[I]);var A=(0,s.useReplitAuthUsersQuery)({variables:{id:r,count:50,orderBy:T,filter:I?{search:I}:void 0},fetchPolicy:"cache-and-network",notifyOnNetworkStatusChange:!0,ssr:!1}),P=A.data,D=A.loading,L=A.error,B=A.fetchMore,V=(0,a.useMemo)(function(){if((null==P?void 0:P.getRepl)&&"Repl"===P.getRepl.__typename&&P.getRepl.authUsers)return P.getRepl.authUsers},[P]),F=(0,a.useMemo)(function(){var e;return null!=(e=null==V?void 0:V.items)?e:[]},[V]),U=null!=(n=null==V?void 0:V.pageInfo.hasNextPage)&&n,G=(0,a.useMemo)(function(){return F.some(function(e){return e.email})},[F]),$=(0,a.useMemo)(function(){return ef.filter(function(e){return"email"!==e.key||G})},[G]),z=(0,a.useCallback)(function(){return(0,c._)(function(){return(0,f._)(this,function(e){switch(e.label){case 0:if(D||!U)return[2];return[4,B({variables:{id:r,count:50,after:null==V?void 0:V.pageInfo.nextCursor,orderBy:T,filter:I?{search:I}:void 0},updateQuery:function(e,t){var n,r,i=t.fetchMoreResult;if((null==(n=i.getRepl)?void 0:n.__typename)!=="Repl"||!i.getRepl.authUsers)return e;var o=(null==(r=e.getRepl)?void 0:r.__typename)==="Repl"&&e.getRepl.authUsers?e.getRepl.authUsers.items:[],a=(0,d._)(o).concat((0,d._)(i.getRepl.authUsers.items));return(0,Y._)((0,K._)({},i),{getRepl:(0,Y._)((0,K._)({},i.getRepl),{authUsers:(0,Y._)((0,K._)({},i.getRepl.authUsers),{items:a})})})}})];case 1:return e.sent(),[2]}})})()},[D,U,B,r,null==V?void 0:V.pageInfo.nextCursor,T,I]),H=(0,a.useCallback)(function(e){if(e.column){var t=ed[e.column]||"LAST_LOGIN",n="ascending"===e.direction?"ASC":"DESC";(0,x.track)(y.events.AUTH_PANE_USED,{action:"Users Sorted",sortField:t,sortDirection:n}),E({field:t,direction:n})}},[]),W=(0,a.useMemo)(function(){return null!==b&&F.find(function(e){return e.userId===b})||null},[F,b]);return(0,t.jsx)("div",{ref:R,css:ep.wrapper,children:(0,t.jsxs)(M.View,{css:ep.container,gap:12,children:[!o&&(0,t.jsx)(j,{openPane:l}),(0,t.jsxs)(M.View,{css:ep.headerTitle,children:[(0,t.jsx)(ec.default,{size:24}),(0,t.jsx)(N.Text,{variant:"subheadBig",children:"Users"})]}),(0,t.jsx)(M.View,{css:ep.searchContainer,children:(0,t.jsx)(ei.SearchBar,{placeholder:"Search users",value:p,onChange:function(e){return h(e.target.value)},onClear:function(){h("")}})}),(0,t.jsx)(O.Surface,{css:ep.tableWrapper,elevated:!0,children:(0,t.jsx)(ee.IndexTable,{css:ep.table,autoLayout:!0,title:"Authenticated Users",columns:$,items:F,selectionMode:"none",selectionBehavior:"replace",loading:D,loadingPlaceholder:{numRows:50,height:36},errorMessage:null==L?void 0:L.message,emptyState:(0,t.jsx)(Z.default,{title:D?"Loading users...":"No users",description:function(){if(!D)return I?"No users match your search criteria.":"Users who log in to your app will appear here."}(),illustration:(0,t.jsx)(ec.default,{size:24})}),canLoadMore:U,onLoadMore:z,isLoadingMore:V&&D,onSortChange:H,children:function(e){return(0,t.jsxs)(ea.TableRow,{id:e.id,children:[(0,t.jsx)(eo.TableCell,{className:"userIdColumn",children:(0,t.jsx)(N.Text,{children:e.userId})},"userId-".concat(e.id)),G?(0,t.jsx)(eo.TableCell,{className:"emailColumn",children:(0,t.jsx)(N.Text,{children:e.email||""})},"email-".concat(e.id)):null,(0,t.jsx)(eo.TableCell,{className:"nameColumn",children:(0,t.jsxs)(M.View,{row:!0,align:"center",gap:8,children:[(0,t.jsx)(X.Avatar,{src:e.image||null,username:e.displayName||"",size:20}),(0,t.jsx)(N.Text,{children:e.displayName||""}),e.banned?(0,t.jsx)(er.Pill,{text:"Banned",colorway:"negative",variant:"muted",compact:!0}):null]})},"name-".concat(e.id)),(0,t.jsx)(eo.TableCell,{className:"lastLoggedInColumn",children:e.lastLoggedIn?(0,t.jsx)(es.Timestamp,{date:e.lastLoggedIn,dateFormat:"relative"}):"Never"},"lastLoggedIn-".concat(e.id)),(0,t.jsx)(eo.TableCell,{className:"actionsColumn",children:(0,t.jsx)(ex,{user:e,onViewDetails:function(){w(e.userId),S(!0)},replId:r})},"actions-".concat(e.id))]},e.id)}})}),W?(0,t.jsx)(ey,{user:W,isOpen:_,onClose:function(){S(!1),w(null)},portalContainer:R.current,replId:r}):null]})})}var ex=function(e){var n=e.user,r=e.onViewDetails,i=em(e.replId,n);return(0,t.jsx)(M.View,{row:!0,justify:"end",children:(0,t.jsxs)(et.PopupMenu,{placement:"bottom end",trigger:(0,t.jsx)(J.IconButton,{alt:"Actions",children:(0,t.jsx)(eu.default,{})}),children:[(0,t.jsx)(et.MenuItem,{label:"View details",onAction:function(){(0,x.track)(y.events.AUTH_PANE_USED,{action:"User Details Viewed",userId:n.userId}),r()}}),(0,t.jsx)(et.MenuItem,{label:n.banned?"Unban user":"Ban user",onAction:i})]})})};function ey(e){var n=e.user,r=e.isOpen,i=e.onClose,o=e.portalContainer,a=em(e.replId,n);return n?(0,t.jsx)(en.Modal,{isOpen:r,onRequestClose:i,portalContainer:o,children:(0,t.jsxs)(M.View,{css:eh.modalContent,children:[(0,t.jsxs)(M.View,{row:!0,align:"center",gap:8,css:eg.title,children:[(0,t.jsx)(X.Avatar,{src:n.image||null,username:n.displayName||"",size:32}),(0,t.jsx)(N.Text,{variant:"subheadBig",children:n.displayName||""}),n.banned?(0,t.jsx)(er.Pill,{colorway:"negative",text:"Banned",variant:"muted"}):null]}),(0,t.jsxs)(M.View,{css:eh.detailsRow,children:[(0,t.jsx)(N.Text,{css:eh.label,children:"User ID"}),(0,t.jsx)(N.Text,{css:eh.value,children:n.userId})]}),n.displayName?(0,t.jsxs)(M.View,{css:eh.detailsRow,children:[(0,t.jsx)(N.Text,{css:eh.label,children:"Name"}),(0,t.jsx)(N.Text,{css:eh.value,children:n.displayName})]}):null,n.email?(0,t.jsxs)(M.View,{css:eh.detailsRow,children:[(0,t.jsx)(N.Text,{css:eh.label,children:"Email"}),(0,t.jsx)(N.Text,{css:eh.value,children:n.email})]}):null,(0,t.jsxs)(M.View,{css:eh.detailsRow,children:[(0,t.jsx)(N.Text,{css:eh.label,children:"Account created"}),(0,t.jsx)(N.Text,{css:eh.value,children:(0,t.jsx)(es.Timestamp,{dateFormat:"absolute",absoluteFormat:{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"},date:new Date(n.timeCreated)})})]}),(0,t.jsxs)(M.View,{css:eh.detailsRow,children:[(0,t.jsx)(N.Text,{css:eh.label,children:"Last login"}),(0,t.jsx)(N.Text,{css:eh.value,children:(null==n?void 0:n.lastLoggedIn)?(0,t.jsx)(es.Timestamp,{dateFormat:"absolute",absoluteFormat:{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"},date:new Date(n.lastLoggedIn)}):"Never"})]}),(0,t.jsx)(M.View,{row:!0,justify:"start",css:eh.buttonsContainer,children:(0,t.jsx)(A.Button,{text:n.banned?"Unban User":"Ban User",onClick:a,colorway:n.banned?"primary":"negative",iconLeft:n.banned?void 0:(0,t.jsx)(el.default,{})})})]})}):(i(),null)}var eb=e.i(848969),ew=e.i(396776),ek=e.i(545969),e_=e.i(49304),eS=e.i(357399),eC=e.i(42458),ej=(0,E.cssRecord)({container:[R.rcss.flex.column,R.rcss.flex.growAndShrink(1),R.rcss.height("100%")],header:[R.rcss.border({color:T.tokens.outlineDimmest,width:1,direction:"bottom"}),R.rcss.overflowX("auto"),R.rcss.overflowY("hidden")],help:[R.rcss.border({color:T.tokens.outlineDimmest,width:1,direction:"bottom"})],tabs:[R.rcss.flex.growAndShrink(1),{height:"100%",'[role="tablist"]':{height:"100%"}}],body:[R.rcss.overflowY("auto")],content:[R.rcss.maxHeight("100%")],centered:[R.rcss.flex.column,R.rcss.justify.center,R.rcss.align.center,R.rcss.height("100%"),R.rcss.p(16)],bannerWrapper:[R.rcss.width("fit-content")],loadingContainer:[R.rcss.flex.column,R.rcss.justify.center,R.rcss.align.center,R.rcss.height("100%")]});function eT(e){var n,r,c,d=e.performPaneOperation,f=(0,u.default)(),p=(0,i._)((0,a.useState)("users"),2),h=p[0],g=p[1],m=(0,a.useCallback)(function(e){return d({operation:"open",pane:e})},[d]),x=(0,s.useReplitAuthQuery)({variables:{id:f}}),y=x.data,b=x.loading,w=(null==y||null==(n=y.getRepl)?void 0:n.__typename)==="Repl"?y.getRepl:null,k=null==w?void 0:w.hasAuthUsers;return b?(0,t.jsx)(M.View,{css:ej.loadingContainer,children:(0,t.jsx)(U.default,{})}):(null==w||null==(c=w.authorizations)||null==(r=c.manageAuth)?void 0:r.isAuthorized)?(0,t.jsxs)(M.View,{css:ej.container,children:[(0,t.jsxs)(M.View,{css:ej.header,row:!0,justify:"space-between",children:[(0,t.jsx)("div",{css:ej.tabs,children:(0,t.jsx)(ek.Tabs,{selectedKey:h,onSelectionChange:function(e){return g(e)},children:(0,t.jsxs)(ek.TabList,{"aria-label":"Authentication Options",children:[(0,t.jsx)(ek.Tab,{id:"users",children:(0,t.jsxs)(M.View,{row:!0,align:"center",gap:8,children:[(0,t.jsx)(ec.default,{size:16})," Users"]})}),(0,t.jsx)(ek.Tab,{id:"configure",children:(0,t.jsxs)(M.View,{row:!0,align:"center",gap:8,children:[(0,t.jsx)(eS.default,{size:16})," Configure"]})})]})})}),(0,t.jsx)(M.View,{row:!0,css:ej.help,align:"center",children:(0,t.jsx)(eb.IconButtonLink,{alt:"Visit the Replit Auth documentation to learn more.",target:"_blank",href:l.LINKS_DOCS.REPLIT_AUTH,children:(0,t.jsx)(e_.default,{})})})]}),(0,t.jsx)(O.Surface,{css:ej.body,elevated:!1,grow:!0,shrink:!0,children:(0,t.jsx)(M.View,{css:ej.content,p:16,children:"users"===h?(0,t.jsx)(ev,{replId:f,hasAuthUsers:k,openPane:m}):(0,t.jsx)(W,{replId:f,hasAuthUsers:k,openPane:m})})})]}):(0,t.jsx)(M.View,{css:ej.centered,children:(0,t.jsxs)(M.View,{css:ej.bannerWrapper,gap:8,children:[(0,t.jsx)(ew.StatusBanner,{colorway:"warning",icon:(0,t.jsx)(eC.default,{}),text:"You are not authorized to manage Auth."}),(0,t.jsx)(o.default,{href:l.LINKS_DOCS.REPLIT_AUTH,target:"_blank",rel:"noopener",children:"Visit the Replit Auth documentation to learn more."})]})})}var eE=e.i(606867),eR=e.i(362874),eI={Content:function(e){var n=e.options;return(0,t.jsx)(eT,{performPaneOperation:n.performPaneOperation})},Icon:function(e){var n=e.size;return(0,t.jsx)(eE.IconContext.Provider,{value:{color:T.tokens.orangeStrongest,size:n},children:(0,t.jsx)(eR.default,{color:T.tokens.limeStrongest})})},getTitle:function(){return"Auth"},description:"Let users log in to your App using a prebuilt login page",category:n.PaneCategory.CloudServices,decode:r.decode};e.s(["replitAuthUI",()=>eI],783742)},249041,602259,272553,e=>{"use strict";var t,n=e.i(276385),r=e.i(960933),i=e.i(862927),o=e.i(394212),a=e.i(297083),s=e.i(721281),l=e.i(878420),u=e.i(530658),c=e.i(817556),d=e.i(389959),f=e.i(255615),p=e.i(625251),h=e.i(47503),g=e.i(207237),m=e.i(858248),x=e.i(709485),y=e.i(299798),b=e.i(927158),w=e.i(529810),k=e.i(106020),_=e.i(937500),S=e.i(877212),C=e.i(970187),j=e.i(924908),T=e.i(230776),E=e.i(417120),R=e.i(330666),I=e.i(346574),A=e.i(61524),P=e.i(649960),D=e.i(670413),O=e.i(441329),N=e.i(909478);e.i(429225);var M=e.i(84396),L=e.i(646067),B=e.i(541793),V=e.i(161322),F=e.i(15053),U=e.i(188507),G=e.i(51553),$=e.i(291607);e.i(925218);var z=e.i(641555),H=e.i(967629),W=e.i(613355),q=e.i(140487),K=e.i(136540),Y=e.i(625484),Q=e.i(121817),X=(0,B.atom)(0),J=(0,B.atom)(function(e){return e(X)<=$.COMPACT_WIDTH?"compact":"normal"}),Z="\x1b[0J",ee="\x1b[0m",et=(0,H.css)([W.rcss.position.absolute,W.rcss.left(8),W.rcss.right(0),W.rcss.zIndex(5)]);function en(e){var t,r,i,o,s,l,f,p,h,g,y,b,w=e.lineNumber,k=e.paneHeight,_=e.shell,S=e.sendToShellChannel,C=e.onClose,T=(0,d.useMemo)(function(){return null==_?void 0:_._term},[_]),E=(0,d.useMemo)(function(){var e,t=null==T?void 0:T._core;return null!=(e=null==t?void 0:t._renderService.dimensions.css.cell)?e:{width:0,height:0}},[T]),R=(0,d.useRef)(""),I=(0,d.useRef)(!1),A=(0,d.useRef)(null),D=(0,u._)((0,d.useState)(64),2),O=D[0],N=D[1],M=(0,d.useRef)(null),L=(0,d.useCallback)(function(e){return N(e.height)},[N]),H=(t=(0,j.useChatter)(),i=(r=(0,u._)((0,d.useState)(null),2))[0],o=r[1],l=(s=(0,u._)((0,d.useState)(!1),2))[0],f=s[1],p=(0,d.useCallback)(function(e){return(0,a._)(function(){var n,r;return(0,c._)(this,function(i){switch(i.label){case 0:return f(!0),[4,t.sessions.create({sessionType:U.SessionType.INLINE_CHAT})];case 1:if(!(n=i.sent()).ok)return f(!1),[2,n];return o(r=n.payload),[4,r.appendEvent({kind:"shellSuggestion",message:e,modelType:U.ModelType.BASIC})];case 2:return i.sent(),[2]}})})()},[t]),h=(0,d.useCallback)(function(){return(0,a._)(function(){return(0,c._)(this,function(e){switch(e.label){case 0:if(!i)return[3,2];return[4,i.abortLastEvent()];case 1:e.sent(),f(!1),e.label=2;case 2:return[2]}})})()},[i]),y=(g=(0,z.useObservableMemo)(function(){return null==i?void 0:i.reduce(er,1)},[i],{default:{message:"",completed:!1}})).message,b=g.completed,(0,d.useEffect)(function(){b&&f(!1)},[b]),{sendMessage:p,stopMessage:h,loading:l,message:y,completed:b}),W=H.sendMessage,en=H.stopMessage,ei=H.message,eo=H.loading,ea=H.completed;(0,d.useEffect)(function(){if(0===ei.length){R.current="";return}R.current!==ei&&(I.current&&(_.write("\x1b[u"),_.write(Z)),_.write("\x1b[s"),_.write("\x1b[0;90m"),_.write(ei.replaceAll("\n","\r\n").trim()),_.write(ee),I.current=!0,R.current=ei)},[_,ei]);var es=(0,d.useCallback)(function(){(0,m.track)(x.events.AI_INLINE_EVENT,{action:"generation_stopped",intent_type:"generate",source:"shell"}),en(),I.current&&(_.write("\x1b[u"),_.write(Z),_.write(ee)),C()},[_,en,C]);(0,d.useEffect)(function(){return _.onData(function(){en(),C()}).dispose},[_,en,C]);var el=(0,$.useInputState)({id:(0,F.v4)(),inputRef:M,loading:eo,onSubmit:function(){eh?ep():((0,m.track)(x.events.AI_INLINE_EVENT,{action:"message_sent",intent_type:"generate",source:"shell",message_content:eu}),eg())},onClose:es}),eu=el.value,ec=el.setValue,ed=el.onKeyDown,ef=el.escPressed,ep=(0,d.useCallback)(function(){I.current&&ei?(_.write("\x1b[u"),_.write(Z),_.write(ee),S(ei),(0,m.track)(x.events.AI_INLINE_EVENT,{action:"suggestion_accepted",intent_type:"generate",source:"shell"}),C()):es()},[ei,_,S,C,es]),eh=ea&&A.current===eu,eg=(0,d.useCallback)(function(){A.current=eu,(0,m.track)(x.events.AI_INLINE_EVENT,{action:"message_sent",intent_type:"generate",source:"shell",message_content:eu}),W(eu)},[W,eu]),em=E.height*(w+1)+8,ev="top";em+O>k&&(ev="bottom",em=k-E.height*(w+1)+4);var ex=(0,G.useIsAiClientConnected)(),ey=(0,u._)((0,d.useState)(function(){return(0,B.createStore)()}),1)[0],eb=(0,V.useSetAtom)(X,{store:ey}),ew=(0,V.useAtomValue)(J,{store:ey}),ek=(0,P.default)(function(e){return eb(e.width)});return(0,n.jsx)(Y.View,{css:et,style:{top:"top"===ev?em:void 0,bottom:"bottom"===ev?em:void 0},children:(0,n.jsxs)($.PocketContainer,{requestMeasure:L,type:"generateCode",isCodeMirrorPocket:!1,innerRef:ek,children:[(0,n.jsx)($.Input,{value:eu,inputRef:M,onChange:function(e){return ec(e.currentTarget.value)},placeholder:"Enter a prompt to generate a shell command",onKeyDown:ed,autoFocus:!0}),(0,n.jsxs)($.Footer,{children:[(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)($.ModeLabel,{type:"generateCode"}),ea?(0,n.jsx)(K.IconButton,{alt:"Rerun the same prompt",onClick:function(){return eg()},size:12,colorway:"grey",children:(0,n.jsx)(Q.default,{})}):null]}),eh?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(q.Button,{variant:"outlined",size:"small",text:"Reject",onClick:function(){(0,m.track)(x.events.AI_INLINE_EVENT,{action:"suggestion_rejected",intent_type:"generate",source:"shell"}),es()}}),(0,n.jsx)(q.Button,{size:"small",text:"Accept",colorway:"blurple",onClick:ep,dataCy:"ghostwriter-inline-accept-suggestion"})]}):(0,n.jsx)($.Submit,{escPressed:ef,connecting:!ex,loading:eo,disabled:!eu||!eu.trim(),promptPresentation:"normal"===ew,onClick:function(){eo?((0,m.track)(x.events.AI_INLINE_EVENT,{action:"generation_stopped",intent_type:"generate",source:"shell",message_content:eu}),en()):((0,m.track)(x.events.AI_INLINE_EVENT,{action:"message_sent",intent_type:"generate",source:"shell",message_content:eu}),eg())}})]})]})})}var er={direction:"reverse",state:{message:"",completed:!1},reducer:function(e,t){var n;e.sender.type===U.UserType.AI&&(null==(n=e.contents.contents)?void 0:n.$kind)==="shellSuggestionEventContents"&&e.contents.contents.shellSuggestionEventContents.content&&(t.message=e.contents.contents.shellSuggestionEventContents.content,t.completed=e.state===U.EventState.COMPLETE)}},ei=e.i(978799);function eo(e){var t=e.portsOpenedByThisShell,r=e.performPaneOperation,i=e.onClose,o=(0,w.default)().ports,a=(0,d.useCallback)(function(e){o.updateDotReplitPortsMapping(e,void 0)},[o]),s=(0,d.useCallback)(function(e){o.tryExposingPortAutomatically(e)},[o]);return(0,n.jsx)(ei.PortInfo,{configurations:t.map(function(e){return e.configuration}),openWebview:function(){r({operation:"open",secondary:!0,pane:{type:"webview",data:{ports:t.length>0?{type:"local",port:t[0].configuration.localPort}:void 0}}})},openNetworkingTool:function(){r({operation:"open",secondary:!0,pane:{type:"developer",data:{tab:["networking"]}}})},onClose:function(){null==i||i()},onDontExposePort:function(){1===t.length&&a(t[0].configuration.localPort)},onDoExposePort:function(){1===t.length&&s(t[0].configuration.localPort)}})}var ea=e.i(926587),es=e.i(337805),el=e.i(446530),eu=(0,H.css)([W.rcss.height("100%"),W.rcss.overflow("hidden"),{"& .xterm":[W.rcss.pl(8),W.rcss.pt(8),W.rcss.pb(4),W.rcss.height("100%")]}]),ec=(0,el.cssRecord)({container:[W.rcss.height("100%"),{"&:focus-within .controls":{opacity:1}}],xterm:eu,xtermWithBorderRadius:[eu,{"& .xterm-viewport":[W.rcss.borderRadius(0,0,8,8)]}]}),ed=(0,H.css)([W.rcss.position.absolute,W.rcss.flex.row,W.rcss.top(8),W.rcss.right(8),W.rcss.height(30),W.rcss.align.center,W.rcss.zIndex(8),{opacity:0}]);function ef(e){var t,r,i=e.shell,o=e.shellMetadata,s=e.sendToShellChannel,l=e.shellRef,f=e.className,p=e.openSearchAndReplace,h=e.openAssistantWithMessage,g=e.openAgentWithMessage,m=e.performPaneOperation,x=e.isGeneratePromptVisible,y=e.currentPromptLineNumber,b=e.onOpenGeneratePrompt,w=e.onCloseGeneratePrompt,k=e.searchState,_=e.setSearchState,S=(0,A.usePreferences)("accessibleTerminal").preferences.accessibleTerminal,C=(0,E.useIsAgentOptimisticallyWorking)(),j=(0,N.useOpenedPortsMatchingCgroup)(null!=(t=null==o?void 0:o.cgroup)?t:void 0);i&&k.isSearching&&(r=(0,n.jsx)(ea.SearchWidget,{searchValue:k.searchText,setSearchValue:function(e){_({isSearching:!0,searchText:e})},findPrevious:i.findPrevious,findNext:i.findNext,exit:function(){return _({isSearching:!1})}}));var T=(0,O.useIsInMobileWorkspace)(),B=(0,M.useContextMenu)().onContextMenu,V=(0,L.useGetShellContextMenuCommand)({xterm:i,isWorkflowsTerminal:!1,openShellSearch:function(e){_({isSearching:!0,searchText:e})},openSearchAndReplace:p,openGeneratePrompt:b}),F=(0,d.useCallback)(function(e){return(0,a._)(function(){return(0,c._)(this,function(t){return g((0,I.shellMessagePrompt)(e)),[2]})})()},[g]);(0,es.useTerminalSelectionPopover)({xterm:i,onAskAssistant:function(e){h((0,I.shellMessagePrompt)(e))},onAskAgent:F,isAgentBusy:C}),(0,d.useEffect)(function(){null==i||i.fit()},[i,j]);var U=(0,u._)((0,d.useState)(0),2),G=U[0],$=U[1],z=(0,P.default)(function(e){$(e.height)},{type:"throttle",wait:200});return(0,n.jsxs)(Y.View,{className:f,innerRef:z,css:ec.container,onKeyDown:function(e){"f"===e.key&&(0,D.getCmdOrCtrl)(e)&&(_({isSearching:!0,searchText:""}),e.preventDefault())},children:[!S&&(0,n.jsx)(R.VisuallyHidden,{children:'Enable "Accessible Terminal" in Workspace Settings to use a screen reader with the shell.'}),(0,n.jsxs)(Y.View,{css:[W.rcss.coverContainer,W.rcss.flex.column],onClick:function(){x&&(w(),null==i||i.focus())},children:[(0,n.jsx)(Y.View,{css:[T?ec.xterm:ec.xtermWithBorderRadius,W.rcss.flex.growAndShrink(1),x?{pointerEvents:"none",filter:"opacity(0.75)"}:null],innerRef:l,onContextMenu:function(e){return B(e,{command:V})}}),(0,n.jsx)(eo,{portsOpenedByThisShell:j,performPaneOperation:m,onClose:function(){null==i||i.focus(),null==i||i.fit()}})]}),i&&x?(0,n.jsx)(en,{lineNumber:y,paneHeight:G,shell:i,sendToShellChannel:s,onClose:function(){w(),i.focus()}}):null,i?(0,n.jsx)(Y.View,{className:"controls",css:ed,children:r}):null]})}var ep=e.i(468095),eh=e.i(95661),eg=(0,H.css)([W.rcss.position.relative,W.rcss.height("100%")]);function em(e){var t=e.shellId,r=e.paneId,i=e.performPaneOperation,s=e.userId,l=e.xterm,f=e.xtermRef,p=e.currentPromptLineNumber,h=e.isGeneratePromptVisible,g=e.onOpenGeneratePrompt,b=e.onCloseGeneratePrompt,w=e.searchState,k=e.setSearchState,R=(0,u._)((0,d.useState)(void 0),2),I=R[0],A=R[1],P=(0,d.useCallback)(function(e){i({operation:"open",secondary:!0,pane:{type:"searchReplace",data:{initialQuery:e}}})},[i]),D=(0,d.useCallback)(function(e){i({operation:"open",secondary:!0,pane:e})},[i]),O=(0,eh.useSendAssistantMessageInNewSessionAndOpenChatPane)({openPane:D}),N=(0,C.useAssistantChatMode)().assistantMode,M=(0,ep.useSendAgentMessage)({openPane:D}),L=(0,S.useSupportsAgent)(),B=(0,j.useChatter)(),V=(0,E.useIsAgentOptimisticallyWorking)(),F=(0,d.useCallback)(function(e){(0,m.track)(x.events.ASSISTANT_USED,{action:"message_sent",assistant_mode:N,message_content:e,message_source:"shell",is_agent_repl:L}),O(e)},[N,L,O]),U=(0,d.useCallback)(function(e){return(0,a._)(function(){var t,n;return(0,c._)(this,function(r){switch(r.label){case 0:if(!V)return[3,3];return t=(0,T.packContentsForQueuedMessage)({text:e,attachedFiles:[]}),[4,B.queue.enqueue({contents:t})];case 1:return r.sent(),[4,B.sessions.agent.current.once()];case 2:return D({type:"agentChat",data:{sessionId:null==(n=r.sent())?void 0:n.id}}),[3,4];case 3:M(e,{createNewSession:!1}),r.label=4;case 4:return(0,m.track)(x.events.AGENT_USED,{action:V?"message_queued":"message_sent",message_content:e,message_source:"shell",is_agent_repl:L}),[2]}})})()},[V,L,B,M,D]),G=(0,d.useRef)(null);(0,y.usePid2)(function(e,n){var i=n.signal;return(0,a._)(function(){var n,u,d,f,p,h;return(0,c._)(this,function(g){return l?(u=(n=e.shellExec.connect.stream({id:t,userId:s,processViewId:r,size:l.getSize()},{signal:i})).reqWritable,d=n.resReadable,G.current=f=function(e){u.write({$kind:"stdin",stdin:new Uint8Array(_.Buffer.from(e))})},p=l.onResize(function(n){return(0,a._)(function(){return(0,c._)(this,function(i){switch(i.label){case 0:return[4,e.shellExec.resize.rpc({id:t,userId:s,processViewId:r,size:n})];case 1:return i.sent(),[2]}})})()}),h=l.onData(f),l.write("\x1bc"),(0,a._)(function(){var e,t,n,r,i,a,s;return(0,c._)(this,function(u){switch(u.label){case 0:e=!1,t=!1,u.label=1;case 1:u.trys.push([1,6,7,12]),r=(0,o._)(d),u.label=2;case 2:return[4,r.next()];case 3:if(!(e=!(i=u.sent()).done))return[3,5];if(!(a=i.value).ok)return l.clear(),[2];"output"===a.payload.$kind&&l.write(a.payload.output),u.label=4;case 4:return e=!1,[3,2];case 5:return[3,12];case 6:return s=u.sent(),t=!0,n=s,[3,12];case 7:if(u.trys.push([7,,10,11]),!(e&&null!=r.return))return[3,9];return[4,r.return()];case 8:u.sent(),u.label=9;case 9:return[3,11];case 10:if(t)throw n;return[7];case 11:return[7];case 12:return[2]}})})(),[2,function(){G.current=null,u.close(),p.dispose(),h.dispose()}]):[2]})})()},[l,t,s,r]),(0,y.usePid2)(function(e,n){var r=n.signal;return(0,a._)(function(){var n,i,a,s,l,u,d,f;return(0,c._)(this,function(c){switch(c.label){case 0:n=e.shellExec.monitor.subscribe({id:t},{signal:r}).resReadable,i=!1,a=!1,c.label=1;case 1:c.trys.push([1,6,7,12]),l=(0,o._)(n),c.label=2;case 2:return[4,l.next()];case 3:if(!(i=!(u=c.sent()).done))return[3,5];if(!(d=u.value).ok)if("NO_PROCESS_MATCHING_ID"===d.payload.code)return[3,4];else return[3,5];"NotStarted"!==d.payload.state&&d.payload.cgroupPath&&A({cgroup:d.payload.cgroupPath}),c.label=4;case 4:return i=!1,[3,2];case 5:return[3,12];case 6:return f=c.sent(),a=!0,s=f,[3,12];case 7:if(c.trys.push([7,,10,11]),!(i&&null!=l.return))return[3,9];return[4,l.return()];case 8:c.sent(),c.label=9;case 9:return[3,11];case 10:if(a)throw s;return[7];case 11:return[7];case 12:return[2]}})})()},[t]);var $=(0,d.useCallback)(function(e){return!!G.current&&(G.current(e),!0)},[G]);return(0,n.jsx)(Y.View,{css:eg,children:(0,n.jsx)(ef,{shell:l,shellMetadata:I,shellRef:f,performPaneOperation:i,currentPromptLineNumber:p,isGeneratePromptVisible:h,sendToShellChannel:$,openSearchAndReplace:P,openAssistantWithMessage:F,openAgentWithMessage:U,onOpenGeneratePrompt:g,onCloseGeneratePrompt:b,searchState:w,setSearchState:k})})}var ev=e.i(759025),ex=e.i(782672),ey=e.i(384401);e.i(282890);var eb=e.i(66718);e.i(545082);var ew=e.i(663762),ek=e.i(259493),e_=e.i(210481),eS=e.i(480028),eC=e.i(754873),ej=e.i(601059),eT=e.i(960178),eE=e.i(751273),eR=e.i(73213),eI=e.i(576073),eA=e.i(283110),eP=e.i(940745),eD=e.i(952030),eO=e.i(793579),eN=e.i(703505),eM=(0,el.cssRecord)({wrapper:[W.rcss.height("100%"),W.rcss.flex.column],headerWrapper:[W.rcss.border({direction:"bottom",color:eS.tokens.outlineDimmest}),W.rcss.height(28)],failureWrapper:[W.rcss.color.accentNegativeStronger],terminalWrapper:[W.rcss.height("100%"),W.rcss.flex.growAndShrink(1)],shellListItemWrapper:[W.rcss.width("100%"),W.rcss.overflow("hidden")],shellListButton:[W.rcss.viewStyle,W.rcss.reset.button,W.rcss.p(2),W.rcss.height(22),W.rcss.rowWithGap(8),W.rcss.align.center,eC.reactAriaInteractive.nofill,W.rcss.flex.shrink(1),{transitionProperty:"background-color, box-shadow, opacity",opacity:.8}],shellListButtonLabel:[W.rcss.display.flex,W.rcss.align.center,W.rcss.rowWithGap(8),W.rcss.flex.shrink(1)],shellListItem:[W.rcss.display.flex,W.rcss.rowWithGap(8),W.rcss.borderRadius(),W.rcss.px(6),W.rcss.py(4),W.rcss.align.center,W.rcss.color.foregroundDefault,W.rcss.cursor.pointer,{transitionProperty:"background-color, box-shadow",backgroundColor:"transparent",borderWidth:1,borderStyle:"solid",borderColor:"transparent",outline:"2px solid ".concat(eS.tokens.accentPrimaryDefault),outlineOffset:"-2px",outlineColor:"transparent"},{"&[data-hovered],&[data-focused]":{backgroundColor:eS.tokens.interactiveBackground},"&[data-selected]":{backgroundColor:eS.tokens.interactiveBackgroundActive},"&[aria-disabled]":{color:eS.tokens.foregroundDimmest,cursor:"not-allowed"}}],shellListItemText:[W.rcss.font.code,W.rcss.fontSize(eS.tokens.fontSizeSmall),W.rcss.flex.shrink(0)],shellListItemCommand:[W.rcss.font.code,W.rcss.fontSize(eS.tokens.fontSizeSmall),W.rcss.flex.growAndShrink(1),{whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"}],shellListCurrentText:[W.rcss.fontSize(eS.tokens.fontSizeSmall),W.rcss.color.greyDefault],shellListNotRunningText:[W.rcss.fontSize(eS.tokens.fontSizeSmall),W.rcss.color.greyDefault],runningShellsCountBadge:[W.rcss.width(18),W.rcss.height(18),W.rcss.align.center,W.rcss.justify.center,W.rcss.backgroundColor.backgroundHighest,W.rcss.borderRadius("full"),W.rcss.fontSize(eS.tokens.fontSizeSmall)]});function eL(e){var t,r,i,o,a,c,f,p,y,b,_,S,C,j,T,E,R,I,A,P,D,O,N,M,L,B,V,F,U,G,$,z,H,W,q,K,Q=e.paneId,X=e.performPaneOperation,J=e.emitPaneMetrics,Z=e.initialPwd,ee=e.initialCmd,et=e.isActive,en=(0,u._)((0,d.useState)({state:"not-connected"}),2),er=en[0],ei=en[1],eo="connected"===er.state?er.id:void 0,ea=(0,h.useCurrentUserId)(),es=(0,d.useCallback)(function(e){return ei({state:"connected",id:e})},[ei]),el=(i=(t={isActive:et,performPaneOperation:X,emitPaneMetrics:J}).performPaneOperation,o=t.emitPaneMetrics,a=t.isActive,c=(0,d.useCallback)(function(e){i({operation:"open",secondary:!0,pane:{type:(0,eb.getPaneTypeForFile)(e),data:e}})},[i]),f=(0,d.useCallback)(function(e,t){i({operation:"open",secondary:!0,pane:{type:"webview",data:{ports:{type:"local",path:e,port:t}}}})},[i]),p=(0,w.default)().fs,y=(0,g.default)(),b=(0,d.useRef)(null),_=(0,d.useRef)(""),C=(S=(0,u._)((0,d.useState)(0),2))[0],j=S[1],E=(T=(0,u._)((0,d.useState)(!1),2))[0],R=T[1],I=(0,d.useRef)(!1),A=(0,ev.useInBandFinalTermMessages)({onFTCSState:function(e){var t=e.state;t===ev.FTCSState.CommandExecuted&&(I.current=!0),t===ev.FTCSState.CommandFinished&&(I.current=!1),b.current=t},onOpenGeneratePrompt:function(){I.current||R(!0)},onUpdateCurrentPromptLineNumber:j}),P=(0,d.useCallback)(function(e,t){if(t.startsWith("A")){var n=t.replace(/^A;/,"");(0,m.track)(x.events.SHELL_COMMAND_EVALED,{context:n,replId:y,api:"pid2",pwd:_.current})}t.startsWith("B")&&(_.current=t.replace(/^B;/,""))},[y]),D=(0,d.useCallback)(function(e){return i({operation:"open",pane:e,secondary:!0})},[i]),N=(O=(0,u._)((0,e_.default)({openFile:c,listFiles:p.listFiles,openWebview:f,onInBandOSCMessages:(r={},(0,s._)(r,ev.FTCS_OSC_ID,A),(0,s._)(r,82,P),r),openPane:D,emitPaneMetrics:o}),2))[0],M=O[1],L=(0,d.useCallback)(function(){I.current||((0,m.track)(x.events.AI_SHELL_CONTEXT_MENU_GENERATE_CLICKED),R(!0))},[]),B=(0,d.useCallback)(function(){R(!1)},[]),V=(0,d.useId)(),F="scope-shell-".concat(V),(0,ey.useCommandScope)(F,a),(0,ey.useCommandBinding)(function(){return[ev.generateWithAIInShellCommand.id,{run:function(){I.current||R(!0)},scope:F,bubble:!1}]},[R]),(0,ek.useSetFocusTarget)(function(){return N},[N]),G=(U=(0,u._)((0,d.useState)({isSearching:!1}),2))[0],$=U[1],z=(0,d.useCallback)(function(){var e;$({isSearching:!0,searchText:null!=(e=null==N?void 0:N._term.getSelection())?e:""})},[N]),H=(0,d.useCallback)(function(){$({isSearching:!1})},[]),W=(0,d.useCallback)(function(){G.isSearching?H():z()},[z,H,G]),q=(0,d.useCallback)(function(){null==N||N.clear()},[N]),K=(0,d.useMemo)(function(){return[{match:k.matchLabel,data:{type:"action",label:"Clear Shell",icon:(0,n.jsx)(eN.default,{}),run:q}},{match:k.matchLabel,data:{type:"action",label:"Find in Shell",icon:(0,n.jsx)(eO.default,{}),run:z}}]},[z,q]),(0,ek.useSetPaneBindings)(function(){return{commands:[{commands:K}],type:"shell"}},[K]),{xterm:N,xtermRef:M,searchState:G,setSearchState:$,toggleSearch:W,isGeneratePromptVisible:E,currentPromptLineNumber:C,onOpenGeneratePrompt:L,onCloseGeneratePrompt:B,clearShell:q});return(0,n.jsxs)(Y.View,{css:eM.wrapper,children:[(0,n.jsx)(eB,{step:er,setStep:ei,shellId:eo,initialCmd:ee,initialPwd:Z,switchShellSession:es,toggleSearch:el.toggleSearch,clearShell:el.clearShell}),(0,n.jsxs)(Y.View,{css:eM.terminalWrapper,children:[ea&&void 0!==eo?(0,n.jsx)(em,(0,l._)({shellId:eo,paneId:Q,performPaneOperation:X,userId:ea},el)):null,"errored"===er.state?(0,n.jsx)(Y.View,{css:eM.failureWrapper,p:8,children:"Failed to load the Shell."}):null]})]})}function eB(e){var t=e.shellId,r=e.step,i=e.setStep,o=e.initialPwd,s=e.initialCmd,l=e.switchShellSession,u=e.toggleSearch,f=e.clearShell,p=(0,d.useRef)(!1),h=(0,b.usePid2Callback)(function(e){return function(t){return(0,a._)(function(){var n;return(0,c._)(this,function(r){switch(r.label){case 0:if(p.current)return[2];return p.current=!0,[4,e.shellExec.spawn.rpc({cmd:"bash",cwd:(null==t?void 0:t.restoreFromPaneState)?o:void 0,initialCmd:(null==t?void 0:t.restoreFromPaneState)?s:void 0,autoCleanup:!0})];case 1:return(n=r.sent()).ok?i({state:"connected",id:n.payload.id}):"UNEXPECTED_DISCONNECT"===n.payload.code?i({state:"not-connected"}):i({state:"errored"}),p.current=!1,[2]}})})()}},[i,o,s]),g=(0,b.usePid2Callback)(function(e){return function(){return(0,a._)(function(){return(0,c._)(this,function(n){switch(n.label){case 0:if(!t)return[3,2];return[4,e.shellExec.kill.rpc({id:t})];case 1:n.sent(),n.label=2;case 2:return[2]}})})()}},[t]);return(0,n.jsxs)(Y.View,{css:eM.headerWrapper,grow:0,shrink:0,align:"center",justify:"space-between",row:!0,gap:4,px:4,children:[(0,n.jsxs)(Y.View,{grow:!0,shrink:!0,row:!0,gap:2,align:"center",children:[(0,n.jsx)(eV,{shellId:t,spawnShell:h,switchShellSession:l,step:r}),(0,n.jsx)(eG,{})]}),(0,n.jsxs)(Y.View,{shrink:0,row:!0,gap:4,align:"center",children:[(0,n.jsx)(K.IconButton,{alt:"Search in Shell",onClick:function(){u()},children:(0,n.jsx)(eO.default,{color:eS.tokens.foregroundDimmest})}),(0,n.jsx)(K.IconButton,{alt:"Clear Output",onClick:function(){f()},children:(0,n.jsx)(eN.default,{color:eS.tokens.foregroundDimmest})}),(0,n.jsx)(K.IconButton,{alt:"Kill Shell",disabled:void 0===g,onClick:function(){null==g||g()},children:(0,n.jsx)(eA.default,{color:eS.tokens.foregroundDimmest})})]})]})}function eV(e){var t=e.step,r=e.shellId,i=e.spawnShell,s=e.switchShellSession,l=(0,u._)((0,d.useState)([]),2),h=l[0],g=l[1],m=h.find(function(e){return e.id===r});return((0,y.usePid2)(function(e,t){var n=t.signal;return(0,a._)(function(){var t,r,i,a,s,l,u,d;return(0,c._)(this,function(c){switch(c.label){case 0:t=e.shellExec.monitorAll.subscribe({},{signal:n}).resReadable,r=!1,i=!1,c.label=1;case 1:c.trys.push([1,6,7,12]),s=(0,o._)(t),c.label=2;case 2:return[4,s.next()];case 3:if(!(r=!(l=c.sent()).done))return[3,5];if(!(u=l.value).ok)return[2];g(u.payload.processes.filter(function(e){return"Running"===e.state})),c.label=4;case 4:return r=!1,[3,2];case 5:return[3,12];case 6:return d=c.sent(),i=!0,a=d,[3,12];case 7:if(c.trys.push([7,,10,11]),!(r&&null!=s.return))return[3,9];return[4,s.return()];case 8:c.sent(),c.label=9;case 9:return[3,11];case 10:if(i)throw a;return[7];case 11:return[7];case 12:return[2]}})})()},[]),(0,d.useEffect)(function(){"not-connected"===t.state&&(null==i||i({restoreFromPaneState:!0}))},[i,t.state]),(0,d.useEffect)(function(){"connected"!==t.state||h.find(function(e){return e.id===r})||(h.length>0?s(h[0].id):null==i||i())},[r,h,i,t.state,s]),m&&"Running"===m.state)?(0,n.jsx)(n.Fragment,{children:(0,n.jsxs)(ej.PopupMenu,{trigger:(0,n.jsxs)(f.Button,{css:eM.shellListButton,children:[(0,n.jsx)(eI.default,{size:12}),(0,n.jsx)(Y.View,{css:eM.shellListButtonLabel,children:(0,n.jsx)(eU,{shellState:m})}),(0,n.jsx)(eF,{userIdsToProcessViewIds:m.userIdsToProcessViewIds}),h.length>1?(0,n.jsx)(eE.Tooltip,{tooltip:"".concat(h.length," Shells are running"),children:(0,n.jsx)(Y.View,{css:eM.runningShellsCountBadge,children:h.length})}):null]}),children:[h.filter(function(e){return"Running"===e.state}).sort(function(e,t){var n,r;return("Running"===e.state&&null!=(n=e.idx)?n:0)-("Running"===t.state&&null!=(r=t.idx)?r:0)}).map(function(e){var t,r=null!=(t=e.command)?t:e.previousCommand,i=e.cwd.replace(/^\/home\/runner/,"~"),o="".concat(i).concat(r?": ".concat(r):""),a=e.id===m.id;return(0,n.jsxs)(p.MenuItem,{css:eM.shellListItem,onAction:function(){s(e.id)},textValue:o,children:[(0,n.jsx)(eU,{shellState:e}),a?(0,n.jsx)(eT.Text,{css:eM.shellListCurrentText,children:"Current"}):null,(0,n.jsx)(eF,{userIdsToProcessViewIds:e.userIdsToProcessViewIds})]},e.id)}),(0,n.jsx)(ej.Separator,{}),(0,n.jsx)(ej.MenuItem,{label:"New Shell",icon:(0,n.jsx)(eD.default,{}),onAction:function(){null==i||i()}})]})}):null}function eF(e){var t=e.userIdsToProcessViewIds,r=(0,ew.useActiveUsers)(),i=(0,d.useMemo)(function(){var e;return null!=(e=Object.keys(null!=t?t:{}).map(function(e){return parseInt(e,10)}).map(function(e){return r.find(function(t){return t.id===e})}).filter(Boolean))?e:[]},[t,r]);return 0===i.length?null:(0,n.jsx)(Y.View,{grow:0,shrink:0,row:!0,gap:4,align:"center",children:i.map(function(e){return(0,n.jsx)(eR.default,{user:e,size:16},e.id)})})}function eU(e){var t,r=e.shellState;if("Running"!==r.state)return(0,n.jsx)(eT.Text,{css:eM.shellListNotRunningText,children:"Not Running"});var i=void 0!==r.command||void 0!==r.previousCommand;return(0,n.jsxs)(Y.View,{css:eM.shellListItemWrapper,row:!0,children:[(0,n.jsx)(eT.Text,{css:eM.shellListItemText,children:r.cwd.replace(/^\/home\/runner/,"~")}),i?(0,n.jsxs)(n.Fragment,{children:[":",(0,n.jsx)(eT.Text,{css:eM.shellListItemCommand,style:{color:void 0===r.command?eS.tokens.greyDefault:void 0},children:null!=(t=r.command)?t:r.previousCommand})]}):null]})}function eG(){return(0,ex.useNixError)()?(0,n.jsx)(eE.Tooltip,{tooltip:"The environment is rebuilding in the background due to a change in configuration files",children:(0,n.jsx)(eP.default,{color:eS.tokens.foregroundDimmest})}):null}var e$=e.i(341727),ez=e.i(716636),eH=e.i(606867),eW=e.i(342574),eq=r.Type.Object({type:r.Type.Literal("shell"),data:r.Type.Optional(r.Type.Object({initialPwd:r.Type.Optional(r.Type.String()),initialCmd:r.Type.Optional(r.Type.String())}))}),eK={Content:function(e){var t,r,i=e.pane,o=e.options;return(0,e$.default)().didConnectOnce?(0,n.jsx)(eL,{paneId:o.paneId,isActive:o.isActive,initialPwd:null==(t=i.data)?void 0:t.initialPwd,initialCmd:null==(r=i.data)?void 0:r.initialCmd,performPaneOperation:o.performPaneOperation,emitPaneMetrics:o.emitPaneMetrics}):null},Icon:function(e){var t=e.size;return(0,n.jsx)(eH.IconContext.Provider,{value:{color:eS.tokens.blueStrongest,size:t},children:(0,n.jsx)(eW.default,{})})},getTitle:function(){return"Shell"},description:"Directly access your App through a command line interface (CLI)",category:ez.PaneCategory.WorkspaceFeatures,decode:function(e){return i.Value.Decode(eq,e)}};e.s(["shellUI",()=>eK],249041);var eY=e.i(346715),eQ=e.i(761201),eX=["youtube.com","youtube-nocookie.com","vimeo.com","wistia.com","sadanandpai.github.io"],eJ=function(e){try{var t=new URL(e).hostname;return eX.some(function(e){return t===e||t.endsWith("."+e)})}catch(e){return!1}},eZ=e.i(559073),e0=r.Type.Object({type:r.Type.Literal("videoPlayer"),data:r.Type.Object({embedUrl:r.Type.String(),title:r.Type.String()})}),e1={Content:function(e){var t=e.pane.data;return(0,n.jsx)(e2,{title:t.title,embedUrl:t.embedUrl})},Icon:function(e){var t=e.size;return(0,n.jsx)(eZ.default,{size:t})},getTitle:function(e){return e.data.title},category:ez.PaneCategory.Other,decode:function(e){return i.Value.Decode(e0,e)}};function e2(e){var t,r=e.embedUrl,i=e.borderRadius,o=e.title;return eJ(r)?(0,n.jsx)("iframe",{title:o,src:r,frameBorder:"0",css:[W.rcss.coverContainer,(t=W.rcss).borderRadius.apply(t,(0,eY._)(void 0===i?[0,0,8,8]:i))]}):(0,n.jsxs)("div",{children:["Only YouTube, Vimeo, and Wistia videos are supported."," ",(0,n.jsx)("a",{href:eQ.COMMUNITY_URL,target:"_blank",children:"Request more formats here."})]})}e.s(["videoPlayerUI",()=>e1],602259);var e3=e.i(267103),e4=e.i(848327),e8=e.i(712516),e5=e.i(965153),e6=e.i(396776),e9=e.i(916271),e7=e.i(88358),te=(0,el.cssRecord)({toolButton:[W.rcss.display.inlineBlock],actionContent:[W.rcss.width(450),W.rcss.maxWidth("100%"),W.rcss.colWithGap(16)]});function tt(e){var t=e.openNetworkingTool;return(0,n.jsx)(e8.default,{pane:{type:"vnc"},bodyText:(0,n.jsxs)(eT.Text,{multiline:!0,children:["No VNC server is currently running with compatible ports available to view. Try running your App, and check the"," ",(0,n.jsx)(q.Button,{css:te.toolButton,text:"Networking tool",iconLeft:(0,n.jsx)(e7.default,{}),size:"small",onClick:t})," ","to ensure ports are being forwarded correctly."]})})}function tn(){return(0,n.jsx)(e8.default,{pane:{type:"vnc"},bodyText:(0,n.jsx)(eT.Text,{multiline:!0,children:"VNC is unavailable as the Agent is testing your App."})})}function tr(e){var t=e.vncUrl,r=e.onRetry;return(0,n.jsx)(e8.default,{pane:{type:"vnc"},action:(0,n.jsxs)(Y.View,{css:te.actionContent,children:[(0,n.jsx)(e6.StatusBanner,{colorway:"warning",text:(0,n.jsxs)(n.Fragment,{children:["There was an error connecting to the server",t?(0,n.jsxs)(n.Fragment,{children:[" at ",(0,n.jsx)("br",{}),t]}):""]})}),t?(0,n.jsx)(e5.AccordionItem,{headerContent:"Diagnosis",children:(0,n.jsx)(Y.View,{p:8,gap:8,children:(0,n.jsx)(e9.default,{children:"If you see a connection error, it's possible that your internet service provider (ISP) has security settings blocking the URL shown above.\n\nPlease contact your ISP and ask them to unblock the URL. Here are the support links for common ISPs:\n\n- [Xfinity](https://www.xfinity.com/support/articles/report-blocked-website)\n- [Spectrum.net](https://www.spectrum.net/support/forms/unblock_site)\n      "})})}):null,(0,n.jsx)(q.Button,{iconLeft:(0,n.jsx)(Q.default,{}),text:"Refresh connection",onClick:r})]})})}var ti=e.i(739521),to=e.i(557154),ta=((t=ta||{}).Connecting="Connecting",t.Connected="Connected",t.Disconnected="Disconnected",t.Errored="Errored",t),ts=(0,el.cssRecord)({root:[W.rcss.position.relative,W.rcss.height("100%"),W.rcss.width("100%")],target:[W.rcss.height("100%"),W.rcss.width("100%")],overlay:[W.rcss.coverContainer,W.rcss.backgroundColor.backgroundDefault,{"&:empty":[W.rcss.display.none]}]}),tl={direction:"reverse",state:{isActive:!1},reducer:function(e,t){var n;if((null==(n=e.contents.contents)?void 0:n.$kind)==="subagentRunning"){var r,i=e.contents.contents.subagentRunning;if((null==i||null==(r=i.contents)?void 0:r.$kind)==="uiTestingSubagentEventContents")return t.isActive=e.state===U.EventState.IN_PROGRESS,!1}}};function tu(e){var t,r,i,o,a=e.openNetworkingTool,s=(0,N.useIsVNCPortOpened)(),l=(r=(0,j.useChatter)(),i=(0,e3.useObservable)(r.sessions.agent.current),null!=(t=null==(o=(0,z.useObservableMemo)(function(){return null==i?void 0:i.reduce(tl,100).result},[i]))?void 0:o.isActive)&&t);return s?l?(0,n.jsx)(tn,{}):(0,n.jsx)(tc,{}):(0,n.jsx)(tt,{openNetworkingTool:a})}function tc(){var e=(0,u._)((0,d.useState)(void 0),2),t=e[0],r=e[1],i=(0,u._)((0,d.useState)(!1),2),o=i[0],a=i[1],s=(0,d.useCallback)(function(){a(!0)},[a]),l=(0,e4.useNoVNC)({password:t,setPassword:r,handlePromptForPassword:s,vncOptions:{scaleViewport:!0,resizeSession:!0,viewOnly:!1}}),c=l.status,f=l.vncUrl,p=l.vncEl,h=l.connect;return(0,n.jsxs)(Y.View,{"data-cy":"vnc",css:ts.root,children:[(0,n.jsx)("div",{ref:p,css:ts.target,"data-cy":"vnc-output-".concat(c.toLowerCase())}),(0,n.jsxs)(Y.View,{css:ts.overlay,children:["Connecting"===c?(0,n.jsx)(e8.default,{pane:{type:"vnc"},loading:!0}):null,"Disconnected"===c?(0,n.jsx)(e8.default,{pane:{type:"vnc"},bodyText:"Disconnected"}):null,"Errored"===c?(0,n.jsx)(tr,{vncUrl:f,onRetry:h}):null]}),(0,n.jsx)(ti.Modal,{isOpen:o,onRequestClose:function(){return a(!1)},children:(0,n.jsx)(to.default,{prompt:"Password",desc:"The output is password protected, please input it",placeholder:"VNC Password",type:"text",onCancel:function(){return a(!1)},onConfirm:function(e){r(e),a(!1)}})})]})}var td=e.i(115357),tf=r.Type.Object({type:r.Type.Literal("vnc")}),tp={Content:function(e){var t=e.options.performPaneOperation,r=(0,d.useCallback)(function(){return t({operation:"open",secondary:!0,pane:{type:"developer",data:{tab:["networking"]}}})},[t]);return(0,n.jsx)(Y.View,{grow:!0,shrink:!0,children:(0,n.jsx)(tu,{openNetworkingTool:r})})},Icon:function(e){var t=e.size;return(0,n.jsx)(td.default,{size:t})},getTitle:function(){return"VNC"},description:"View your app's desktop screen output",category:ez.PaneCategory.WorkspaceFeatures,decode:function(e){return i.Value.Decode(tf,e)}};e.s(["vncUI",()=>tp],272553)},882303,e=>{"use strict";var t=e.i(276385),n=e.i(960933),r=e.i(862927),i=e.i(999292);e.i(282890);var o=e.i(716636),a=e.i(480028),s=e.i(606867),l=e.i(559073),u=n.Type.Object({type:n.Type.Literal("workflows")}),c={Content:function(){return(0,t.jsx)(i.default,{})},Icon:function(e){var n=e.size;return(0,t.jsx)(s.IconContext.Provider,{value:{color:a.tokens.greenStrongest,size:n},children:(0,t.jsx)(l.default,{})})},getTitle:function(){return"Workflows"},description:"Configure different ways to run your App",category:o.PaneCategory.WorkspaceFeatures,decode:function(e){return r.Value.Decode(u,e)}};e.s(["workflowsUI",()=>c])},958600,e=>{e.v({root:"Search-module__WdCIWq__root"})},378430,e=>{e.v({header:"Filetree-module__ge4tiq__header",root:"Filetree-module__ge4tiq__root"})},147955,e=>{e.v({content:"index-module__O-X0oa__content",emptyState:"index-module__O-X0oa__emptyState",filetreeButton:"index-module__O-X0oa__filetreeButton",root:"index-module__O-X0oa__root"})},376513,e=>{e.v({container:"PoweredBy-module__lDn-cG__container",hounddogLogo:"PoweredBy-module__lDn-cG__hounddogLogo",semgrepLogo:"PoweredBy-module__lDn-cG__semgrepLogo"})},997574,e=>{e.v({severity:"SeverityIcon-module__PAUhHq__severity"})},218174,e=>{e.v({actionButton:"VulnerabilityActions-module__4c6x0W__actionButton",actionButtonPrimary:"VulnerabilityActions-module__4c6x0W__actionButtonPrimary",fullWidth:"VulnerabilityActions-module__4c6x0W__fullWidth"})},940518,e=>{e.v({filePath:"MaliciousVulnerability-module__wa25vq__filePath",isExpanded:"MaliciousVulnerability-module__wa25vq__isExpanded",maliciousVulnerabilityCode:"MaliciousVulnerability-module__wa25vq__maliciousVulnerabilityCode",vulnerability:"MaliciousVulnerability-module__wa25vq__vulnerability",vulnerabilityHeader:"MaliciousVulnerability-module__wa25vq__vulnerabilityHeader"})},732691,e=>{e.v({dependencyVulnerabilityGroup:"DependencyVulnerability-module__49J-9W__dependencyVulnerabilityGroup",dependencyVulnerabilityName:"DependencyVulnerability-module__49J-9W__dependencyVulnerabilityName",isExpanded:"DependencyVulnerability-module__49J-9W__isExpanded",vulnerability:"DependencyVulnerability-module__49J-9W__vulnerability",vulnerabilityHeader:"DependencyVulnerability-module__49J-9W__vulnerabilityHeader"})},656161,e=>{e.v({filePath:"HoundDogVulnerability-module__CQ_3yG__filePath",hounddogVulnerabilityCode:"HoundDogVulnerability-module__CQ_3yG__hounddogVulnerabilityCode",isExpanded:"HoundDogVulnerability-module__CQ_3yG__isExpanded",vulnerability:"HoundDogVulnerability-module__CQ_3yG__vulnerability",vulnerabilityHeader:"HoundDogVulnerability-module__CQ_3yG__vulnerabilityHeader"})},31741,e=>{e.v({analysisVulnerabilityCode:"SASTVulnerability-module__-8u26G__analysisVulnerabilityCode",filePath:"SASTVulnerability-module__-8u26G__filePath",isExpanded:"SASTVulnerability-module__-8u26G__isExpanded",vulnerability:"SASTVulnerability-module__-8u26G__vulnerability",vulnerabilityHeader:"SASTVulnerability-module__-8u26G__vulnerabilityHeader"})},481121,e=>{e.v({ignoredIssuesContainer:"index-module__f-J0sW__ignoredIssuesContainer",ignoredIssuesText:"index-module__f-J0sW__ignoredIssuesText",lastScanSummaryContainer:"index-module__f-J0sW__lastScanSummaryContainer",lastScanSummaryText:"index-module__f-J0sW__lastScanSummaryText",root:"index-module__f-J0sW__root",scanSettingSurface:"index-module__f-J0sW__scanSettingSurface",scanSettingTitleText:"index-module__f-J0sW__scanSettingTitleText"})},638311,e=>{e.v({stepContainer:"StepItem-module__P9w8vW__stepContainer",stepNumber:"StepItem-module__P9w8vW__stepNumber",title:"StepItem-module__P9w8vW__title"})},209065,e=>{e.v({editBotTokenButton:"TelegramConnectionSection-module__elEOTa__editBotTokenButton",hidden:"TelegramConnectionSection-module__elEOTa__hidden",inactiveContainer:"TelegramConnectionSection-module__elEOTa__inactiveContainer",stepsContainer:"TelegramConnectionSection-module__elEOTa__stepsContainer"})},990929,e=>{e.v({container:"AutoscaleConfigEditor-module__iR3aEW__container"})},1470,(e,t,n)=>{var r=e.r(365738),i=1/0,o=0/0,a=/^\s+|\s+$/g,s=/^[-+]0x[0-9a-f]+$/i,l=/^0b[01]+$/i,u=/^0o[0-7]+$/i,c=/^(?:0|[1-9]\d*)$/,d=parseInt,f=Object.prototype.toString,p=Math.ceil,h=Math.max;function g(e){var t=void 0===e?"undefined":r._(e);return!!e&&("object"==t||"function"==t)}function m(e){return e?(e=function(e){if("number"==typeof e)return e;if((void 0===(t=e)?"undefined":r._(t))=="symbol"||t&&(void 0===t?"undefined":r._(t))=="object"&&"[object Symbol]"==f.call(t))return o;if(g(e)){var t,n="function"==typeof e.valueOf?e.valueOf():e;e=g(n)?n+"":n}if("string"!=typeof e)return 0===e?e:+e;e=e.replace(a,"");var i=l.test(e);return i||u.test(e)?d(e.slice(2),i?2:8):s.test(e)?o:+e}(e))===i||e===-i?(e<0?-1:1)*17976931348623157e292:e==e?e:0:0===e?e:0}t.exports=function(e,t,n){n&&"number"!=typeof n&&function(e,t,n){if(!g(n))return!1;var i,o,a,s,l,u,d,p=void 0===t?"undefined":r._(t);return("number"==p?!!(null!=(i=n)&&"number"==typeof(o=i.length)&&o>-1&&o%1==0&&o<=0x1fffffffffffff&&"[object Function]"!=(s=g(a=i)?f.call(a):"")&&"[object GeneratorFunction]"!=s&&(d=null==(d=n.length)?0x1fffffffffffff:d)&&("number"==typeof t||c.test(t))&&t>-1&&t%1==0&&t<d):"string"==p&&t in n)&&(l=n[t],l===(u=e)||l!=l&&u!=u)}(e,t,n)&&(t=n=void 0),e=m(e),void 0===t?(t=e,e=0):t=m(t),n=void 0===n?e<t?1:-1:m(n);for(var i=e,o=t,a=n,s=void 0,l=-1,u=h(p((o-i)/(a||1)),0),d=Array(u);u--;)d[s?u:++l]=i,i+=a;return d}},627950,e=>{e.v({connectionContainer:"SlackConnectorSetupUI-module__WV9B6G__connectionContainer",inlineCode:"SlackConnectorSetupUI-module__WV9B6G__inlineCode",statusContainer:"SlackConnectorSetupUI-module__WV9B6G__statusContainer"})},860302,e=>{e.v({hidden:"SlackConnectionSection-module__rwhQgq__hidden",radiusDefault:"SlackConnectionSection-module__rwhQgq__radiusDefault"})},835109,491637,342424,379790,197486,878284,942859,487517,648518,62279,546345,304484,264646,802436,620365,912467,147255,475868,977424,847630,397837,e=>{"use strict";var t,n,r,i,o,a=e.i(309968),s=e.i(94063),l=e.i(79998),u=e.i(880569),c=e.i(162540),d=e.i(676702),f=e.i(751367),p=e.i(876899),h=e.i(900396),g=e.i(118022),m=e.i(866585),x=e.i(221721),y=e.i(110066),b=e.i(637972),w=e.i(224986),k=e.i(466638),_=e.i(138071),S=e.i(275222),C=e.i(401455),j=e.i(921009),T=e.i(367017),E=e.i(783742),R=e.i(782370),I=e.i(249041),A=e.i(602259),P=e.i(272553),D=e.i(236906),O=e.i(882303),N=e.i(878420),M=e.i(64386),L=e.i(886513),B=e.i(530658),V=e.i(276385),F=e.i(389959),U=e.i(960933),G=e.i(862927),$=e.i(541793),z=e.i(205104),H=e.i(346715),W=e.i(484035),q=e.i(529810),K=e.i(282007),Y=e.i(564169);e.i(282890);var Q=e.i(66718),X=e.i(259493),J=e.i(62424),Z=e.i(493602),ee=e.i(144619),et=e.i(296223),en=e.i(185511),er=e.i(294468),ei=e.i(297083),eo=e.i(817556),ea=e.i(903381),es=e.i(61524),el=e.i(207237);e.i(429225);var eu=e.i(84396),ec=e.i(779830),ed=e.i(160290),ef=e.i(483570),ep=e.i(1736),eh=e.i(312421),eg=e.i(714312),em=e.i(939040);e.i(545082);var ev=e.i(423111),ex=e.i(965863),ey=e.i(710078),eb=e.i(274526),ew=e.i(721281),ek=e.i(6560),e_=e.i(480028),eS=e.i(625484),eC=e.i(980338),ej=e.i(793579),eT=e.i(958600),eE=(0,e_.cvarsFrom)("Search.module.css",["--input-height"]),eR={type:"context",icon:(0,V.jsx)(ej.default,{}),label:"",description:"Search..."};function eI(e){var t=e.openFile,n=(0,q.default)().fs,r=(0,ex.useGetRecentFiles)(),i=(0,ep.useShouldHideFileInWorkspace)(),o=(0,F.useMemo)(function(){var e=(0,ek.createFindOrCreateFileCommand)({openFile:function(e){return t(e.path)},fs:n,shouldHideFile:i,getRecentFiles:r});return e.data=eR,delete e.match,e},[t,n,i,r]);return(0,V.jsx)(eS.View,{clsx:eT.default.root,style:(0,ew._)({},eE.inputHeight,"32px"),children:(0,V.jsx)(eC.CommandBar,{fullWidth:!0,command:o,openOnInput:!0,compact:!0})})}var eA=e.i(136540),eP=e.i(739521),eD=e.i(929872),eO=e.i(960178),eN=e.i(557862),eM=e.i(419735),eL=e.i(842435),eB=e.i(849803),eV=e.i(378430);function eF(e){var t,n,r,i,o,a,s,l,u,c,d,f,p,h,g,m,x,y,b,w=e.openFile,k=e.currentPath,_=e.onClose,S=(n=(t={openFile:w,currentPath:k}).openFile,r=t.currentPath,i=(0,el.default)(),a=(o=(0,B._)((0,F.useState)(null),2))[0],s=o[1],l=(0,eh.useTrackOpenFile)(),u=(0,ep.useShouldHideFileInWorkspace)(!0),c=(0,F.useCallback)(function(e){return!u(e.filename)},[u]),d=(0,q.default)().fs,f="cmdOrCtrlKey"===(0,es.usePreferences)("multiselectModifierKey").preferences.multiselectModifierKey?"cmdOrCtrlKey":"altKey",p=(0,ex.useGetRecentFiles)(),h=(0,F.useCallback)(function(e){return(0,eg.getFileExtensionSuggestions)(e,p)},[p]),g=(0,eu.useContextMenu)().onContextMenu,m=(0,eb.useGetContextMenuCommand)(),x=(0,ev.useSetFileRenameInProgress)(),y=(0,ed.useFiletree)({fs:d,filter:c,fontSize:13,onFileSelect:function(e){var t=e.path;n(t),l(t)},onCreate:function(e){e.type===ea.FileType.File&&n(e.path)},multiselectModifierKey:f,onConflicts:function(e){return s({type:"conflicts",data:e})},onDeleteNodes:function(e){return s({type:"deleteNode",data:e})},onContextMenu:function(e,t){return g(e,{command:m(t,y)})},autocomplete:h,localCacheKey:i+":sidebar",onFileRenameStart:x,onFileRenameEnd:function(){return x(null)}}),b=(0,ef.useFileTreeGitStatus)(),(0,F.useEffect)(function(){return y.setFileStatus(b)},[y,b]),(0,F.useEffect)(function(){(0,ei._)(function(){return(0,eo._)(this,function(e){switch(e.label){case 0:if(null===r)return y.select(null),[2];return[4,y.select({path:r,type:ea.FileType.File})];case 1:if(e.sent(),r!=r)return[2];return y.scrollToPath(r),[2]}})})()},[r,y]),{filetree:y,activeModal:a,closeModal:function(){return s(null)}}),C=S.filetree,j=S.activeModal,T=S.closeModal;return(0,V.jsxs)(V.Fragment,{children:[(0,V.jsxs)(eD.Surface,{clsx:eV.default.root,children:[(0,V.jsxs)(eS.View,{clsx:eV.default.header,align:"center",justify:"space-between",row:!0,children:[(0,V.jsxs)(eS.View,{row:!0,gap:2,align:"center",children:[(0,V.jsx)(eA.IconButton,{size:28,alt:"Close files",onClick:_,children:(0,V.jsx)(eB.default,{})}),(0,V.jsx)(eO.Text,{variant:"small",children:"Files"})]}),(0,V.jsxs)(eS.View,{row:!0,justify:"end",align:"center",children:[(0,V.jsx)(eA.IconButton,{size:28,alt:"New file",dataCy:"filetree-add-file",onClick:function(){C.create(ea.FileType.File)},children:(0,V.jsx)(eM.default,{})}),(0,V.jsx)(eA.IconButton,{size:28,alt:"New folder",onClick:function(){C.create(ea.FileType.Directory)},children:(0,V.jsx)(eL.default,{})}),(0,V.jsx)(ec.RootActions,{size:28,filetree:C})]})]}),(0,V.jsxs)(eS.View,{grow:!0,shrink:!0,children:[(0,V.jsx)(eI,{openFile:w}),(0,V.jsx)(eS.View,{grow:!0,shrink:!0,children:(0,V.jsx)(ed.Filetree,{store:C.store})})]})]}),(0,V.jsxs)(eP.Modal,{isOpen:!!j,onRequestClose:T,children:[(null==j?void 0:j.type)==="conflicts"?(0,V.jsx)(ey.default,{paths:j.data.conflicts.map(function(e){return e.path}),onCancel:T,onConfirm:function(){var e=j.data;"move"===e.type?C.move({nodes:e.nodes,to:e.to,overwrite:!0}):C.upload({files:e.files,parentPath:e.to,overwrite:!0}),T()}}):null,(null==j?void 0:j.type)==="deleteNode"?(0,V.jsx)(eN.default,(0,M._)((0,N._)({},(0,em.getDeleteText)(j.data.nodes)),{delete:function(){return j.data.confirm()},hideModal:T})):null]})]})}var eU=e.i(959406),eG=e.i(827759),e$=e.i(927496),ez=e.i(147955);function eH(e){var t,n,r=e.performPaneOperation,i=null!=(n=null==(t=e.data)?void 0:t.path)?n:null,o=(0,B._)((0,F.useState)(!i),2),a=o[0],s=o[1],l=(0,F.useCallback)(function(e){r({operation:"replace",pane:(0,eU.getPaneForFile)(e)})},[r]),u=(0,en.useFileCommands)({path:i,performPaneOperation:r});(0,X.useSetPaneBindings)(function(){if(u)return{commands:[{commands:u?(0,H._)(u):[]}]}},[u]);var c=(0,Y.useCodeEditorView)();return(0,V.jsxs)(eS.View,{clsx:ez.default.root,grow:!0,shrink:!0,row:!0,children:[a?(0,V.jsx)(eF,{onClose:function(){return s(!1)},openFile:l,currentPath:null!=i?i:null}):null,(0,V.jsxs)(eS.View,{clsx:ez.default.root,grow:!0,shrink:!0,children:[(0,V.jsxs)(eG.Header,{children:[(0,V.jsxs)(eG.HeaderLeft,{noPadding:!a,children:[a?null:(0,V.jsx)(eA.IconButton,{size:28,alt:"Open files",onClick:function(){return s(!0)},clsx:ez.default.filetreeButton,children:(0,V.jsx)(e$.default,{})}),i?(0,V.jsx)(V.Fragment,{children:a?(0,V.jsx)(V.Fragment,{children:c?(0,V.jsx)(W.CodeNav,{view:c}):null}):(0,V.jsx)(ee.FileBreadcrumbs,{path:i,onFileClick:l,children:c?(0,V.jsx)(W.CodeNav,{view:c}):null})}):null]}),(0,V.jsx)(eG.HeaderRight,{children:i?(0,V.jsx)(J.FileActions,{path:i,performPaneOperation:e.performPaneOperation,isReadOnly:e.isReadOnly}):null})]}),(0,V.jsx)(eS.View,{grow:!0,shrink:!0,clsx:ez.default.content,children:(0,V.jsx)(eW,(0,N._)({},e))})]})]})}function eW(e){var t,n,r,i,o,a=(0,q.default)().fs,s=e.performPaneOperation,l=e.data,d=null!=(r=null==(t=e.data)?void 0:t.path)?r:null,f=null!=(i=null==(n=e.data)?void 0:n.type)?i:(0,Q.getPaneTypeForFile)({path:d}),p=void 0,h=void 0;(null==l?void 0:l.type)==="codeEditor"&&(p=l.line,h=l.col);var g=(0,F.useMemo)(function(){return{line:p,col:h}},[p,h]),m=(0,F.useCallback)(function(){s({operation:"replace",pane:{type:"codeEditor",data:{path:d}}})},[s,d]);if(!d)return(0,V.jsx)(eS.View,{clsx:ez.default.emptyState,align:"center",justify:"center",children:(0,V.jsx)(eO.Text,{color:"dimmest",children:"No file open"})});switch(f){case"media":return(0,V.jsx)(er.Content,{centered:!0,children:(0,V.jsx)(et.default,{filePath:d,fs:a})});case"binary":return(0,V.jsx)(u.BinaryPaneContent,{path:d});case"draw":return(0,V.jsxs)(er.Content,{children:[(0,V.jsx)(K.default,{fs:a,filePath:d})," "]});default:return(0,V.jsxs)(V.Fragment,{children:[(0,V.jsx)(Z.default,{filePath:d,isHidden:null!=(o=e.isHidden)&&o,deeplink:g,onDeeplinkUpdated:m,hideMobileKeyboardToolbar:!0,performPaneOperation:e.performPaneOperation},d),(0,V.jsx)(c.PaneActions,{path:d,performPaneOperation:e.performPaneOperation})]})}}var eq=e.i(716636),eK=e.i(630818),eY=e.i(718610),eQ=U.Type.String({minLength:1}),eX=U.Type.Object({type:U.Type.Literal("codeEditor"),path:U.Type.Union([eQ,U.Type.Null()]),line:U.Type.Optional(U.Type.Number()),col:U.Type.Optional(U.Type.Number())}),eJ=U.Type.Object({type:U.Type.Optional(U.Type.Union([U.Type.Literal("draw"),U.Type.Literal("media"),U.Type.Literal("binary"),U.Type.Literal("markdown"),U.Type.Literal("csv")])),path:eQ}),eZ=U.Type.Object({type:U.Type.Literal("file"),data:U.Type.Optional(U.Type.Union([eX,eJ]))}),e0={Content:function(e){var t=e.options,n=(0,L._)(e,["options"]),r=t.performPaneOperation,i=(0,B._)((0,F.useState)(function(){return(0,$.createStore)()}),1)[0];return(0,V.jsx)(Y.CodeEditorViewContext.Provider,{value:i,children:(0,V.jsx)(eH,(0,M._)((0,N._)({isReadOnly:!1,isHidden:t.isHidden},n.pane),{performPaneOperation:r}))})},Icon:function(e){var t=e.size,n=e.pane.data;return(null==n?void 0:n.path)?(0,V.jsx)(eK.default,{path:n.path,size:t}):(0,V.jsx)(eY.default,{size:t})},getTitle:function(e){var t;return(null==(t=e.data)?void 0:t.path)?(0,z.getFileName)(e.data.path):"Code"},category:eq.PaneCategory.WorkspaceFeatures,decode:function(e){return G.Value.Decode(eZ,e)},description:"View and edit files"},e1=e.i(877212),e2=e.i(924908);e.i(925218);var e3=e.i(267103),e4=((t={}).DEPLOYMENT_PANE_COVER_PAGE="deployment_pane_cover_page",t.DEPLOYMENT_PANE_FINAL_PAGE="deployment_pane_final_page",t.REDEPLOY_PANE="redeploy_pane",t.SECURITY_SCANNER_PANE="security_scanner_pane",t),e8=((n={}).Dependency="dependency",n.Analysis="analysis",n.Malicious="malicious",n.Hounddog="hounddog",n),e5=e.i(858248),e6=e.i(709485),e9=e.i(394212),e7=e.i(906368),te=e.i(993796),tt=e.i(299798),tn=e.i(927158),tr=e.i(852819),ti=(0,$.atom)(null),to=(0,$.atom)(null),ta=(0,$.atom)(!0),ts=(0,$.atom)(!0);function tl(){return(0,tr.useSet)(ti)}var tu=e.i(569910),tc=((r={}).INFO="info",r.LOW="low",r.MODERATE="moderate",r.HIGH="high",r.CRITICAL="critical",r);function td(e){var t=e.toLowerCase();switch(t){case"info":case"low":case"moderate":case"high":case"critical":return t;case"medium":return"moderate";default:throw Error("Unknown severity: ".concat(e))}}function tf(e){(0,e5.track)(e6.events.SECURITY_SCAN,{action:"run_scan_clicked",context:e})}var tp=((i={}).Fixed="fixed",i.Pending="pending",i);function th(e){return!e||"fixed"===e.status}function tg(e){return e.type!==e8.Dependency||e.fix.available&&!e.fix.breakingChanges&&"npm"===e.ecosystem}var tm=function(e,t){var n=t.filter(function(e){var t=td("string"==typeof e.severity?e.severity:e.severity.level);return t===tc.CRITICAL||t===tc.HIGH}).map(function(e){var t,n;return"dependencyAudit"===e.kind?(t=e.id,n="npm"):"hounddog"===e.kind?(t=e.hash,n="hounddog"):(t=e.fingerprint,n="sast"===e.kind?"opengrep":"replit"),(0,M._)((0,N._)({},e),{severity:td("string"==typeof e.severity?e.severity:e.severity.level),id:t,source:n})}),r=[];e.forEach(function(e){var t=n.find(function(t){return t.id===e.id});switch(e.status){case"fixed":t&&r.push({id:e.id,status:"pending"});break;case"pending":t||r.push({id:e.id,status:"fixed"});break;default:(0,tu.default)(e.status)}});var i=n.map(function(e){var t,n,r=e.kind;switch(r){case"dependencyAudit":return n=e.fix&&e.fix.available?e.fix.requiresMajorUpdate?{available:!0,breakingChanges:!0,version:{name:e.package.name,version:e.fix.version,isSemVerMajor:!0}}:{available:!0,breakingChanges:!1}:{available:!1},{type:e8.Dependency,id:e.id,status:"pending",ecosystem:e.package.ecosystem,severity:e.severity,name:e.package.name,source:e.source,isDirect:null==(t=e.dependency)?void 0:t.isDirect,currentVersion:e.package.version,fix:n,ignored:e.ignored};case"sast":return{type:e8.Analysis,id:e.fingerprint,name:e.checkId,status:"pending",message:e.message,location:e.location,severity:td(e.severity),source:"opengrep",ignored:e.ignored};case"maliciousFile":return{type:e8.Malicious,id:e.fingerprint,name:e.name,status:"pending",paths:e.paths,message:"".concat(e.description," ").concat(e.mitigation),severity:td(e.severity),source:"replit",ignored:e.ignored};case"hounddog":return{type:e8.Hounddog,id:e.hash,name:e.ruleIds.join(", "),status:"pending",message:e.message,location:e.location,ruleIds:e.ruleIds,privacyViolations:e.privacyViolations,remediationStrategy:e.remediationStrategy,remediationSummary:e.remediationSummary,remediationPrompt:e.remediationPrompt,severity:td(e.severity),source:"hounddog",ignored:e.ignored};default:(0,tu.default)(r)}}),o=e.map(function(e){var t=i.find(function(t){return t.id===e.id}),n=r.find(function(t){return t.id===e.id});return n?(0,M._)((0,N._)({},e,t),{status:n.status}):(0,M._)((0,N._)({},e,t),{status:e.status})});return(0,H._)(o).concat((0,H._)(i.filter(function(t){return!e.find(function(e){return e.id===t.id})})))},tv=new Set;function tx(){var e=(0,te.useFlag)({controlName:"flag-hounddog-scan",default:!1}),t=(0,B._)((0,F.useState)(!1),2),n=t[0],r=t[1],i=(0,B._)((0,F.useState)(!1),2),o=i[0],a=i[1],s=(0,F.useRef)(null),l=(0,tr.useGet)(ta),u=(0,tr.useGet)(ts),c=(0,F.useRef)(null),d=(0,tr.useValue)(ti),f=tl(),p=(0,tr.useValue)(to),h=(0,tr.useSet)(to),g=(0,tr.useValue)(ta),m=(0,tr.useSet)(ta),x=(0,tr.useValue)(ts),y=(0,tr.useSet)(ts),b=(0,F.useCallback)(function(){if(s.current){var t=l(),n=u(),r=[];n&&(r=["dependencyAudit","maliciousFile","sast"]),e&&t&&r.push("hounddog"),s.current.write({kind:"start-scan",scanners:r}),a(!0)}},[l,u,e]);(0,tt.usePid2)(function(t,n){return(0,ei._)(function(t,n){var r,i,o,d,p,g,m,x,y,b,w,k,_;return(0,eo._)(this,function(S){switch(S.label){case 0:r=n.signal,i=l(),o=u(),d=[],o&&(d=["dependencyAudit","maliciousFile","sast"]),e&&i&&d.push("hounddog"),g=(p=t.securityScan.scan.stream({scanners:d},{signal:r})).resReadable,s.current=p.reqWritable,m=!1,x=!1,S.label=1;case 1:S.trys.push([1,6,7,12]),b=function(){var e=k.value;if(!e.ok)return"UNEXPECTED_DISCONNECT"===e.payload.code||"CANCEL"===e.payload.code?"break":("extras"in e.payload&&e.payload.extras&&"scanId"in e.payload.extras&&e.payload.extras.scanId!==c.current||(e7.withScope(function(t){t.setTag("securityScan",!0),t.setExtra("riverError",e.payload),e7.captureException(Error("Unhandled error during security scan"))}),a(!1),f([])),"continue");var t=e.payload;return"started"===t.kind?(c.current=t.scanId,a(!0),"continue"):null!==c.current&&t.scanId!==c.current?"continue":void(f(function(e){return tm(null!=e?e:[],t.results)}),h(new Date),a(!1),!tv.has(t.scanId)&&(tv.add(t.scanId),function(e){try{var t=[],n=[],r=[],i=[];e.forEach(function(e){var o=e.kind;switch(o){case"dependencyAudit":t.push(e);break;case"sast":n.push(e);break;case"maliciousFile":r.push(e);break;case"hounddog":i.push(e);break;default:(0,tu.default)(o)}});try{var o,a=(o={},(0,ew._)(o,tc.INFO,[]),(0,ew._)(o,tc.LOW,[]),(0,ew._)(o,tc.MODERATE,[]),(0,ew._)(o,tc.HIGH,[]),(0,ew._)(o,tc.CRITICAL,[]),(0,ew._)(o,"majorBumpLibs",[]),o);t.forEach(function(e){var t;a[td(e.severity.level)].push(e.package.name),(null==(t=e.fix)?void 0:t.requiresMajorUpdate)&&a.majorBumpLibs.push(e.package.name)}),(0,e5.track)(e6.events.DEPENDENCY_AUDIT_COMPLETED,{vulnerabilities:a})}catch(e){e7.withScope(function(t){t.setTag("securityScan",!0),t.setTag("scanType","dependency"),t.setExtra("originalError",e),e7.captureException(Error("Error tracking dependency audit"))})}try{var s,l=(s={},(0,ew._)(s,tc.INFO,[]),(0,ew._)(s,tc.LOW,[]),(0,ew._)(s,tc.MODERATE,[]),(0,ew._)(s,tc.HIGH,[]),(0,ew._)(s,tc.CRITICAL,[]),s);n.forEach(function(e){l[td(e.severity)].push({checkId:e.checkId,path:e.location.path,message:e.message.slice(0,100)})}),(0,e5.track)(e6.events.SAST_SCAN_COMPLETED,{vulnerabilities:l})}catch(e){e7.withScope(function(t){t.setTag("securityScan",!0),t.setTag("scanType","sast"),t.setExtra("originalError",e),e7.captureException(Error("Error tracking SAST scan"))})}!function(e){try{var t=(o={},(0,ew._)(o,tc.INFO,[]),(0,ew._)(o,tc.LOW,[]),(0,ew._)(o,tc.MODERATE,[]),(0,ew._)(o,tc.HIGH,[]),(0,ew._)(o,tc.CRITICAL,[]),o),n=!0,r=!1,i=void 0;try{for(var o,a,s=e[Symbol.iterator]();!(n=(a=s.next()).done);n=!0){var l=a.value;t[td(l.severity)].push({name:l.name,paths:l.paths})}}catch(e){r=!0,i=e}finally{try{n||null==s.return||s.return()}finally{if(r)throw i}}(0,e5.track)(e6.events.MALICIOUS_FILE_SCAN_COMPLETED,{vulnerabilities:t})}catch(e){e7.withScope(function(t){t.setTag("securityScan",!0),t.setTag("scanType","maliciousFile"),t.setExtra("originalError",e),e7.captureException(Error("Error tracking malicious file scan"))})}}(r),function(e){try{var t=(o={},(0,ew._)(o,tc.INFO,[]),(0,ew._)(o,tc.LOW,[]),(0,ew._)(o,tc.MODERATE,[]),(0,ew._)(o,tc.HIGH,[]),(0,ew._)(o,tc.CRITICAL,[]),o),n=!0,r=!1,i=void 0;try{for(var o,a,s=e[Symbol.iterator]();!(n=(a=s.next()).done);n=!0){var l=a.value;t[td(l.severity)].push({remediationStrategy:l.remediationStrategy,privacyViolations:l.privacyViolations,message:l.message})}}catch(e){r=!0,i=e}finally{try{n||null==s.return||s.return()}finally{if(r)throw i}}(0,e5.track)(e6.events.HOUNDDOG_SCAN_COMPLETED,{vulnerabilities:t})}catch(e){e7.withScope(function(t){t.setTag("securityScan",!0),t.setTag("scanType","hounddog"),t.setExtra("originalError",e),e7.captureException(Error("Error tracking hounddog scan"))})}}(i)}catch(e){e7.withScope(function(t){t.setTag("securityScan",!0),t.setExtra("originalError",e),e7.captureException(Error("Error tracking security scan result"))})}}(t.results)))},w=(0,e9._)(g),S.label=2;case 2:return[4,w.next()];case 3:if(!(m=!(k=S.sent()).done)||"break"===b())return[3,5];S.label=4;case 4:return m=!1,[3,2];case 5:return[3,12];case 6:return _=S.sent(),x=!0,y=_,[3,12];case 7:if(S.trys.push([7,,10,11]),!(m&&null!=w.return))return[3,9];return[4,w.return()];case 8:S.sent(),S.label=9;case 9:return[3,11];case 10:if(x)throw y;return[7];case 11:return[7];case 12:return[2]}})}).apply(this,arguments)},[l,u,f,h,a,e]);var w=(0,tn.usePid2Callback)(function(e){return function(){return(0,ei._)(function(){return(0,eo._)(this,function(t){switch(t.label){case 0:return r(!0),[4,e.securityScan.fixDependencyAudit.rpc({})];case 1:return t.sent(),r(!1),a(!0),b(),[2]}})})()}},[b]);return{flagHoundDogScan:e,runScan:b,scanResult:d,lastScanDate:p,isScanning:o,isUpdatingDependencies:n,updateDependencies:w,privacyScanEnabled:g,setPrivacyScanEnabled:m,securityScanEnabled:x,setSecurityScanEnabled:y}}var ty=e.i(376513);function tb(){var e=tx().flagHoundDogScan;return(0,V.jsxs)(eS.View,{pb:8,pt:16,gap:8,clsx:ty.default.container,children:[(0,V.jsx)(eO.Text,{color:"dimmest",variant:"small",children:"Vulnerability scans are enabled by the following Replit partners:"}),(0,V.jsxs)(eS.View,{gap:16,children:[(0,V.jsxs)(eS.View,{row:!0,align:"center",gap:6,children:[(0,V.jsx)(tw,{}),(0,V.jsx)(eO.Text,{color:"dimmest",variant:"small",children:"Security scans are powered by Semgrep Community Edition."})]}),e?(0,V.jsxs)(eS.View,{row:!0,align:"center",gap:6,children:[(0,V.jsx)(tk,{}),(0,V.jsx)(eO.Text,{color:"dimmest",variant:"small",children:"Privacy scans are powered by HoundDog.ai."})]}):null]}),e?(0,V.jsxs)(eO.Text,{color:"dimmest",variant:"small",children:["Security scanning powered by"," ",(0,V.jsx)("a",{href:"https://semgrep.dev/",target:"_blank",rel:"noopener noreferrer",children:"Semgrep"})," ","and privacy scanning powered by"," ",(0,V.jsx)("a",{href:"https://hounddog.ai/",target:"_blank",rel:"noopener noreferrer",children:"HoundDog.ai"})," ",", both running locally on Replit infrastructure. No code or data is transmitted to any third party, including"," ",(0,V.jsx)("a",{href:"https://semgrep.dev/",target:"_blank",rel:"noopener noreferrer",children:"Semgrep"})," ","or"," ",(0,V.jsx)("a",{href:"https://hounddog.ai/",target:"_blank",rel:"noopener noreferrer",children:"HoundDog.ai"}),"."]}):null]})}function tw(){return(0,V.jsxs)("svg",{clsx:ty.default.semgrepLogo,xmlns:"http://www.w3.org/2000/svg",version:"1.1",viewBox:"0 0 1670 252",children:[(0,V.jsxs)("g",{fill:"#13bf95",children:[(0,V.jsx)("path",{d:"m412-4e-7c55.22847 0 100 44.77153 100 100 0 55.22847-44.77153 100-100 100s-100-44.77153-100-100c1e-3 -22.75534 7.76297-44.82984 22.00391-62.57812 5.79468 6.661495 7.89062 10.6061 13.99609 20.57812h3.5c-3.0923-7.636258-7.63896-15.06492-13.76367-24.96093 18.96049-21.03049 45.94792-33.03689 74.26367-33.03906zm0 44c-30.92795 0-56 25.07205-56 56 0 30.92795 25.07205 56 56 56s56-25.07205 56-56c0-30.92794-25.07205-56-56-56z"}),(0,V.jsx)("path",{d:"m256 0c-55.22841 0-100 44.77158-100 100 8e-3 22.74213 7.76844 44.80216 22 62.54102 0.04153-0.05203 0.07004-0.09276 0.11133-0.14454 0.01252 0.01556 0.02458 0.03133 0.03711 0.04688 0.96022-1.20705 1.88357-2.443 2.78711-3.69336 4.19703-5.49557 7.10017-10.10355 9.92773-17.07812 0.25397-0.55649 0.51186-1.11021 0.75586-1.67188h3.38086c-0.72386 2.98756-1.74037 5.91654-2.99414 8.88477-2.79519 5.99462-6.2697 12.37905-9.80078 18.10937-0.05698 0.09227-0.10092 0.17302-0.1582 0.26563 18.94128 20.83966 45.79173 32.72679 73.95312 32.74023 28.16139-0.01344 55.01184-11.90057 73.95312-32.74023-0.05728-0.09261-0.10122-0.17336-0.1582-0.26563-3.53108-5.73032-7.00559-12.11475-9.80078-18.10937-1.25377-2.96823-2.27028-5.89721-2.99414-8.88477h3.38086c0.244 0.56167 0.50189 1.11539 0.75586 1.67188 2.82756 6.97457 5.7307 11.58255 9.92773 17.07812 0.90354 1.25036 1.82689 2.48631 2.78711 3.69336 0.01253-0.01555 0.02459-0.03132 0.03711-0.04688 0.04129 0.05178 0.0698 0.09251 0.11133 0.14454 14.23156-17.73886 21.992-39.79889 22-62.54102 0-55.22842-44.77159-100-100-100zm0 44c30.92792 0 56 25.07208 56 56 0 30.92792-25.07208 56-56 56s-56-25.07208-56-56c0-0.966497 0.02388-1.926386 0.07227-2.880859 1.49985-29.58868 25.96631-53.11914 55.92773-53.11914z"}),(0,V.jsx)("path",{d:"m100 0c-55.22848 0-100 44.77152-100 100 0 55.22847 44.77152 100 100 100 55.22847 0 100-44.77153 100-100-1e-3 -22.75534-7.76297-44.82984-22.00391-62.57812-5.79468 6.661495-7.89062 10.6061-13.99609 20.57812h-3.5c3.0923-7.636258 7.63896-15.06492 13.76367-24.96093-18.96049-21.03049-45.94792-33.03689-74.26367-33.03906zm0 44c30.92795 0 56 25.07205 56 56 0 30.92795-25.07205 56-56 56-30.92795 0-56-25.07205-56-56 0-30.92795 25.07205-56 56-56z"})]}),(0,V.jsxs)("g",{fill:"currentColor",children:[(0,V.jsx)("path",{d:"M659.55109 194.4763q-15.41724 0-28.48243-3.92117-13.0652-4.18248-23.51636-12.02494-10.45116-8.10366-18.55228-19.8669l20.64231-23.52687q12.8032 18.0379 24.82438 25.09587 12.01918 6.79666 27.96042 6.79666 9.40715 0 16.98426-2.87559 7.57802-2.87548 12.01918-8.10365 4.44227-5.22817 4.44227-11.76394 0-4.70538-1.56782-8.62645-1.56783-4.18258-4.96488-7.31947-3.39705-3.13698-8.36183-5.75097-4.96487-2.87558-11.49717-4.96677-6.5326-2.09119-14.89423-3.39838-14.11021-3.13698-24.82437-7.84216-10.45116-4.70528-17.76827-11.763938-7.05521-7.058063-10.45116-16.207914-3.39705-9.149252-3.39705-20.389893 0-11.23994 4.96487-20.650891 4.96488-9.672049 13.58721-16.729911 8.62313-7.058063 20.38131-10.7179437Q648.83763 6 662.16483 6q14.89423 0 26.6534 3.6596807 12.01919 3.6596803 21.16533 10.9789423 9.14573 7.058062 15.41723 17.513907l-21.16532 20.650891q-5.48748-8.365056-12.01918-13.854927-6.2714-5.751069-14.11022-8.626454-7.83922-2.875585-16.46225-2.875585-9.66835 0-16.98426 3.136984-7.0552 2.875584-11.23517 8.103557-4.18096 5.228172-4.18096 12.286935 0 5.228172 2.09033 9.672049 2.35164 4.182478 6.5326 7.58076 4.44227 3.398382 11.49717 6.012468 7.05521 2.614186 16.46225 4.443977 14.37122 3.136983 25.60839 8.103557 11.49718 4.705375 19.3363 11.239938 8.10062 6.53527 12.01918 14.90092 4.18096 8.36506 4.18096 18.03791 0 17.7759-8.36182 30.84684-8.10063 12.80893-23.25536 19.86689-15.15523 6.79666-35.80054 6.79666z"}),(0,V.jsx)("path",{d:"M815.75346 194.4763q-21.42632 0-37.88957-8.88785-16.46225-9.14925-25.8694-24.83487-9.14573-15.94591-9.14573-36.33581 0-16.20791 5.22617-29.539839 5.22618-13.33193 14.37122-23.003879 9.40715-9.933547 22.21034-15.16192 13.0652-5.489571 28.22143-5.489571 13.58721 0 25.08538 5.228173 11.75818 4.966773 20.38131 14.115925 8.62313 8.887853 13.0652 21.174888 4.70357 12.286933 4.44227 26.663863l-.26129 11.50294h-111.8317l-6.01009-21.69789h92.50341l-3.91966 4.44398v-6.01247q-.78393-8.365057-5.48749-14.639924-4.70357-6.535166-12.01918-10.194946-7.05521-3.92108-15.67824-3.92108-13.5872 0-22.73334 5.228173-9.14574 4.966674-14.11022 14.900921-4.70357 9.933546-4.70357 24.311876 0 13.85492 5.74869 24.04987 6.01009 10.19495 16.72225 15.94591 10.71317 5.48958 24.82438 5.48958 9.92975 0 18.29028-3.13699 8.36183-3.39838 18.29028-11.76394l14.63322 20.6509q-6.5327 6.27376-15.67824 10.97894-9.14574 4.70537-19.07429 7.31946-9.92975 2.61418-19.5973 2.61418z"}),(0,V.jsx)("path",{d:"M899.25473 191.86632V54.367045h29.52845v28.493849l-4.96487 2.614086q2.35163-6.796664 6.794-12.808932 4.70357-6.012468 11.23517-10.717943 6.5327-4.705376 14.11021-7.319362 7.57752-2.613986 15.41724-2.614086 11.49717 0 20.1203 3.921079 8.88457 3.659681 14.63327 11.239941 6.01 7.58076 8.8845 19.344898l-4.7036-.784246 1.8291-4.443977q3.1357-6.012468 8.1006-11.23994 5.2262-5.489571 11.7582-9.41065 6.5325-4.182478 13.8492-6.273767 7.3166-2.352688 14.1102-2.352688 15.6782 0 25.8694 6.273767 10.1901 6.273767 15.4172 19.082899 5.2262 12.808933 5.2262 31.630837v82.86656h-29.7905V111.0948q0-11.239946-2.8745-18.298908-2.8744-7.058863-8.6231-10.455945-5.7487-3.659681-14.8943-3.659681-6.794 0-13.0652 2.352688-6.0101 2.352687-10.4511 6.535165-4.4423 4.182478-7.0553 9.933448-2.3519 5.489573-2.3519 12.286933v82.08157h-29.78842V110.5725q0-10.19495-3.13565-17.252911-2.87445-7.319461-8.62313-10.978942-5.74869-3.659681-14.11022-3.659681-6.794 0-12.80319 2.352688-6.01009 2.352687-10.45116 6.535165-4.44227 3.92108-7.05521 9.672049-2.35163 5.489572-2.35163 12.024932v82.60457z"}),(0,V.jsx)("path",{d:"M1199.1093 251.996q-14.8942 0-29.7905-4.70527-14.8942-4.70538-24.3003-12.02494l10.9741-22.48188q5.2262 3.92118 12.0192 6.79666 7.0553 3.13699 14.6332 4.70528 7.8393 1.82989 15.6783 1.82989 14.1102 0 23.5163-4.70538 9.4071-4.44397 14.1103-13.59293 4.9648-8.88775 4.9648-22.21988v-25.61886l3.6583 1.56849q-1.3066 8.36505-8.6231 15.68492-7.0554 7.31946-17.7683 12.02493-10.7132 4.44388-21.9494 4.44388-19.3362 0-34.7545-9.14925-15.1552-9.14925-24.0403-25.09587-8.6233-15.94592-8.6233-36.59781t8.6233-36.596804q8.6231-16.207914 23.7783-25.356866 15.1552-9.41065 34.2325-9.41065 7.8393 0 15.1553 2.091189 7.3165 1.82989 13.5872 5.228172 6.2711 3.398382 10.9741 7.58076 4.9647 4.182478 8.1004 8.887753 3.1357 4.705375 3.9196 8.887853l-6.0101 2.091189.2613-31.892831h29.0055V182.98707q0 16.46891-4.9647 29.27784-4.7036 12.80893-14.1102 21.69789-9.1458 8.88785-22.4724 13.33193Q1215.829 252 1199.1038 252Zm1.0452-84.43455q12.2812 0 21.6883-5.75097 9.6684-5.75107 14.8943-15.68492 5.2261-9.93355 5.2261-23.26588 0-13.07093-5.4873-23.265874-5.2263-10.194946-14.6333-15.945916-9.407-5.75107-21.6883-5.75107-12.0192 0-21.4263 6.012469-9.4071 5.751069-14.6332 15.945915-5.2262 10.194946-5.2262 23.003876 0 13.07093 5.2262 23.26588 5.2261 9.93355 14.6332 15.68492 9.4071 5.75097 21.4263 5.75097z"}),(0,V.jsx)("path",{d:"M1297.8108 191.86632V54.367045h29.2664l.5227 43.392771-3.6583-9.933548q2.8743-10.194946 9.9297-18.298903 7.0552-8.365056 16.2013-13.070931 9.1458-4.966674 18.8133-4.966674 4.4423 0 8.6231.784206 4.1809.784206 6.5327 1.82989l-7.8393 32.15383q-3.1356-1.307093-7.0552-2.091189-3.9196-1.045594-7.8392-1.045594-6.794 0-13.0652 2.614086-6.0102 2.614186-10.7132 7.319461-4.4424 4.443877-7.3165 10.71794-2.6131 6.01247-2.6131 13.33193v74.76161z"}),(0,V.jsx)("path",{d:"M1454.2132 194.4763q-21.4264 0-37.8896-8.88785-16.4623-9.14925-25.8684-24.83487-9.1458-15.94591-9.1458-36.33581 0-16.20791 5.2261-29.539839 5.2262-13.33193 14.3713-23.003879 9.4071-9.933547 22.2103-15.16192 13.0652-5.489571 28.2204-5.489571 13.5872 0 25.0844 5.228173 11.7582 4.966773 20.3823 14.115925 8.623 8.887853 13.0652 21.174888 4.7036 12.286933 4.4423 26.663863l-.2615 11.50294h-111.8317l-6.0101-21.69789h92.5034l-3.9197 4.44398v-6.01247q-.7839-8.365057-5.4875-14.639924-4.7034-6.535166-12.0191-10.194946-7.0554-3.92108-15.6783-3.92108-13.5872 0-22.7323 5.228173-9.146 4.966674-14.1102 14.900921-4.7036 9.933546-4.7036 24.311876 0 13.85492 5.7487 24.04987 6.0101 10.19495 16.7222 15.94591 10.7132 5.48958 24.8244 5.48958 9.9297 0 18.2903-3.13699 8.3618-3.39838 18.2903-11.76394l14.6332 20.6509q-6.5326 6.27376-15.6782 10.97894-9.1458 4.70537-19.0743 7.31946-9.9297 2.61418-19.5973 2.61418z"}),(0,V.jsx)("path",{d:"M1532.8144 249.37601V54.367045h29.2664l.2611 31.369834-4.7036-2.352688q1.5679-8.103557 8.8846-15.16192 7.3165-7.319361 17.7682-11.763937 10.7132-4.443977 22.2104-4.443977 18.2903 0 32.4025 9.149252 14.3712 9.149251 22.7343 25.095867Q1670 102.20539 1670 122.85628q0 20.65189-8.3617 36.85781-8.1007 15.94591-22.4723 25.35686-14.1102 9.14926-32.1405 9.14926-12.0192 0-23.2564-4.70528-10.9741-4.70527-18.8132-12.28693-7.8393-7.58066-9.6685-15.94592l7.3168-3.65968v91.75351zm68.724-81.81956q11.4972 0 20.3813-5.75097 9.1458-5.75107 14.3712-15.68492 5.2261-10.19495 5.2261-23.26588 0-12.80893-5.2261-22.74288-4.9648-9.933544-14.1102-15.684914-8.8843-5.75097-20.6423-5.75097t-20.9043 5.75097q-8.8845 5.489571-14.1102 15.684914-5.2262 9.93355-5.2262 22.74288 0 13.07093 5.2262 23.26588 5.2262 9.93355 14.1102 15.68492 9.1456 5.75097 20.9043 5.75097z"})]})]})}function tk(){return(0,V.jsxs)("svg",{clsx:ty.default.hounddogLogo,xmlns:"http://www.w3.org/2000/svg",id:"Layer_1","data-name":"Layer 1",viewBox:"0 0 1274.52 320.46",children:[(0,V.jsxs)("defs",{children:[(0,V.jsxs)("radialGradient",{id:"radial-gradient",cx:123.74,cy:181.05,r:367.45,gradientUnits:"userSpaceOnUse",children:[(0,V.jsx)("stop",{offset:0,stopColor:"#45c4d7"}),(0,V.jsx)("stop",{offset:.51,stopColor:"#4f73b8"}),(0,V.jsx)("stop",{offset:.6,stopColor:"#496bad"}),(0,V.jsx)("stop",{offset:.75,stopColor:"#37558e"}),(0,V.jsx)("stop",{offset:.95,stopColor:"#1b325d"}),(0,V.jsx)("stop",{offset:1,stopColor:"#142950"})]}),(0,V.jsx)("style",{children:".cls-1{fill:url(#radial-gradient)}.cls-2{fill:#4f73b8}.cls-3{fill:#53a6dc}"})]}),(0,V.jsx)("path",{d:"M163.34 283.39a188.56 188.56 0 0 1-40.72 22 2.91 2.91 0 0 1-1.05.12 2.72 2.72 0 0 1-1-.12 188.37 188.37 0 0 1-40.75-22 84.59 84.59 0 0 1-17 1.65c-1.72 0-3.43 0-5.15-.14 26.36 23.11 56.33 34 58 34.61a19.33 19.33 0 0 0 12 0c1.65-.58 31.64-11.5 58-34.61-1.73.1-3.45.14-5.12.14a85 85 0 0 1-17.21-1.65ZM242.89 108.65l-9.84-2.36-3.2-.75c-4.46-1.06-23.12-4.91-23.47-5a1.76 1.76 0 0 0-.41 0 1.5 1.5 0 0 0-.32.1.66.66 0 0 0-.15.07s0 0-.09 0-.3.21-.32.21c-.63.49-3.11 5-3.85 9.08a22.1 22.1 0 0 1-9.12 42.22c-.69 0-1.34 0-2-.09-.39 0-.82.06-1.25.08 3.06 3.18 6.11 6.19 8.91 8.83 2.16 2.08 4.3 4.14 6.43 6.21a93.54 93.54 0 0 1 23.67 38.16c.5 1.44 2.09 5.78 3.64 10.26 9.87-37.28 13.84-85.54 15.24-106.19Zm-9.5 57.08a4.8 4.8 0 1 1 4.53-5.09 4.84 4.84 0 0 1-4.53 5.09Zm2.76-17.21a4.81 4.81 0 1 1 4.47-5.07 4.76 4.76 0 0 1-4.47 5.07ZM121.57 18.63a66.23 66.23 0 0 1 63 46.06c7.42 1 14.15 2.23 20.15 3.49a84.77 84.77 0 0 0-166.26 0c6-1.26 12.73-2.48 20.11-3.52a66.21 66.21 0 0 1 63-46.03Z",className:"cls-1"}),(0,V.jsx)("path",{d:"M189.68 113.28a5.09 5.09 0 0 0-.54 0c-.17 0-.37 0-.54.06-.54.06-1 .15-1.55.25s-1 .24-1.53.39c-.24.07-.48.17-.73.25a10.37 10.37 0 0 0-1.39.59 6.67 6.67 0 0 0-.71.34c-.22.12-.49.25-.71.38l-.6.37-.54.37a1.94 1.94 0 0 0-.42.32 4 4 0 0 0-.56.43c-.08.07-.21.16-.3.25s-.38.33-.58.5a16.1 16.1 0 0 0-2.87 3.51 2.34 2.34 0 0 0-.39.66c-.13.22-.23.44-.38.66a3.51 3.51 0 0 1-.22.48c-.07.17-.15.34-.22.5l-.26.66c-.08.16-.11.33-.17.48s-.17.51-.24.75c-.11.42-.21.85-.3 1.28a2.65 2.65 0 0 0-.13.67 9.94 9.94 0 0 0-.15 1.13c0 .54-.06 1.09-.06 1.62a16.71 16.71 0 0 0 2.56 9 17.56 17.56 0 0 0 1.49 2 14.92 14.92 0 0 0 1.23 1.29c.2.18.37.35.58.52a14.48 14.48 0 0 0 1.21 1c.16.1.31.19.48.31a6.34 6.34 0 0 0 .67.42 15.45 15.45 0 0 0 2 1 11.43 11.43 0 0 0 1.67.61c.23.07.45.15.66.2s.65.16 1 .23l.61.12a7.68 7.68 0 0 0 .82.11 16.36 16.36 0 0 0 2 .11 17 17 0 0 0 0-33.93c-.31.08-.57.11-.89.11Zm14.24 17.26a13.17 13.17 0 1 1-13.14-13.17 13.14 13.14 0 0 1 13.14 13.17Z",className:"cls-1"}),(0,V.jsx)("path",{d:"M190.54 138.41a8.19 8.19 0 1 0-8.19-8.19 8.19 8.19 0 0 0 8.19 8.19Z",className:"cls-1"}),(0,V.jsx)("path",{d:"M221.89 210.22a92.09 92.09 0 0 0-23.26-37.52c-2.2-2.14-4.4-4.26-6.64-6.38-6.23-6-13.87-13.55-19.66-21.15-.68-.89-1.33-1.75-1.94-2.63a22.94 22.94 0 0 1 19.46-35.13 22.25 22.25 0 0 1 4.4.43C195.38 104 198 94.93 203 94a4.8 4.8 0 0 1 1.47-.06c2 .21 7.85 1.47 14.8 3.06 7.68 1.76 16.74 3.92 23.56 5.56v-.18a10.37 10.37 0 0 0 .24-1.49 13.52 13.52 0 0 0-7.54-12.38c-.71-.33-11.23-5.12-30.44-9.48l-2.09-.39q-16-2.64-32.39-4.26-23.18-2.28-46.93-2.31H123a486.41 486.41 0 0 0-50.07 2.62Q50.11 77 28 81.51a137.41 137.41 0 0 0-20.39 7A13.51 13.51 0 0 0 0 100.85c0 .32.07 1.15.09 2.42.66 12.15 3.88 65 14.91 110l.81 3.16c.78 3.15 1.64 6.24 2.53 9.27h-.07c.24.88.5 1.75.76 2.61 3.56 11.78 7.75 22.51 12.71 31.23a61 61 0 0 0 3.54 5.69c1.92 2.83 4.51 7.42 6.9 9a5.08 5.08 0 0 0 .61.36 18.13 18.13 0 0 0 1.94.67h.06c4.23 1.22 10.4 1.64 15.54 1.74h2.39c.91 0 1.86 0 2.72-.06a70.49 70.49 0 0 0 7.55-.63l1.51-.2.58-.1c1.3-.22 2.55-.46 3.82-.75a1.16 1.16 0 0 0 .18 0c.45-.12.92-.21 1.36-.33s1-.25 1.46-.39c.31-.1.67-.19 1-.3s.89-.25 1.32-.4a2.7 2.7 0 0 0 .48-.16c.23-.07.43-.13.64-.21.56-.17 1.06-.37 1.56-.56l.24-.09c.73-.26 1.42-.56 2.11-.84a42.54 42.54 0 0 0 4.19-2c1.38-.71 2.74-1.49 4.05-2.33.65-.41 1.31-.85 2-1.29s1.26-.91 1.9-1.37a66.25 66.25 0 0 0 20.2-26c.26.55.56 1.12.8 1.7s.67 1.38 1 2.08.58 1.09.85 1.64c.1.09.1.2.17.31l.71 1.18c.3.53.62 1.05.91 1.57s.64 1.05 1 1.56a65.78 65.78 0 0 0 7.35 9.36c.41.43.82.86 1.26 1.28.81.83 1.7 1.65 2.61 2.45 1.12 1 2.3 1.93 3.49 2.86.46.36.95.69 1.41 1s1.21.85 1.85 1.24l.93.6c.43.28.89.53 1.3.8a3.87 3.87 0 0 0 .49.26 4.87 4.87 0 0 0 .45.27c.57.32 1.13.63 1.73.93.78.4 1.53.78 2.33 1.15l1.6.71c.71.31 1.46.6 2.2.88s1.27.47 1.94.69c.19.06.35.13.5.16.62.21 1.21.4 1.81.57 1.31.4 2.63.74 4 1 .6.13 1.21.27 1.83.39s1.21.21 1.8.33c.84.15 1.74.28 2.61.38.51.08 1 .13 1.51.18 1.83.21 3.69.32 5.6.39.91 0 1.8.06 2.74.06h2.38c5.16-.1 11.31-.52 15.53-1.74a18.49 18.49 0 0 0 1.92-.67 4.3 4.3 0 0 0 .66-.36c2.41-1.62 5-6.18 6.9-9 1.21-1.78 2.4-3.67 3.54-5.69 4.94-8.72 9.13-19.45 12.68-31.23.29-.86.54-1.73.78-2.61a34.44 34.44 0 0 0 .8-3.85 17.2 17.2 0 0 0-1.27-4.59c-.78-2.48-1.7-4.95-2.4-7.01ZM57.18 117a13.66 13.66 0 1 1-13.65 13.67A13.69 13.69 0 0 1 57.18 117Zm151.68 110.24c-.06.2-.13.38-.21.59a1.2 1.2 0 0 1 0 .2v.11c-.47 1.43-.93 2.84-1.42 4.22s-1 2.74-1.47 4.08c-.76 2-1.55 3.92-2.35 5.79-.24.63-.54 1.24-.8 1.84s-.63 1.38-1 2c-.24.5-.45 1-.71 1.48-.46 1-1 1.91-1.45 2.85l-1.49 2.69c-.79 1.29-1.55 2.54-2.37 3.7a.51.51 0 0 1-.13.16.82.82 0 0 0-.11.17 2 2 0 0 1-.19.24 9.3 9.3 0 0 1-1.36 1.57 10.16 10.16 0 0 1-5.5 2.75l-1.43.14a72.12 72.12 0 0 1-8.88.23c-.46 0-1 0-1.45-.08a8.33 8.33 0 0 1-.88-.05c-.68 0-1.34-.1-2-.17-.41 0-.82-.1-1.19-.15a2.52 2.52 0 0 1-.41-.06c-.32 0-.62-.08-.92-.13l-.8-.13c-.43-.08-.87-.15-1.3-.24s-1-.19-1.46-.31c-.8-.18-1.6-.37-2.4-.6l-1.59-.47-.78-.26a2.85 2.85 0 0 0-.33-.13l-.27-.09a14.54 14.54 0 0 1-1.43-.55 3 3 0 0 1-.45-.17c-.37-.14-.76-.31-1.17-.48l-.65-.3c-.28-.13-.58-.26-.84-.41s-.62-.29-.92-.44c-1-.5-1.9-1-2.85-1.61s-2.07-1.35-3.06-2.09a46.49 46.49 0 0 1-4.09-3.48s-.07-.06-.09-.07a48.26 48.26 0 0 1-5.5-6.38 2.94 2.94 0 0 0-.2-.26c-.62-.87-1.19-1.71-1.72-2.58a13.89 13.89 0 0 1-.85-1.41c-.28-.47-.58-.93-.82-1.41s-.51-.94-.77-1.42-.61-1.18-.89-1.77a77.35 77.35 0 0 1-4-10.18c-.17-.53-.32-1.05-.45-1.57s-.24-.81-.33-1.19c-.23-.78-.41-1.54-.56-2.27a15.24 15.24 0 0 1-.47-2.08c-.11-.5-.22-1-.28-1.4-.17-.75-.26-1.42-.37-2v-.09c-.06-.27-.06-.75-.11-1v-.17c3.67-6.41 9.28-16.08 12.75-22.11l.48-.82c3.65-6.35.65-11.55-6.71-11.55h-28.57c-7.32 0-10.34 5.2-6.65 11.55l.47.82c3.46 6 9 15.7 12.73 22.11 0 .12 0 .78-.08.91-1.08 7.35-5.59 28-21.45 39.88-.47.37-1 .72-1.51 1.07s-1 .67-1.47 1c-1 .59-1.94 1.14-2.93 1.65a6.91 6.91 0 0 1-.91.44 8.58 8.58 0 0 1-.86.41 3.62 3.62 0 0 1-.69.31c-.28.14-.6.25-.89.38s-.56.23-.82.34c-.79.31-1.57.58-2.35.83-.45.16-.9.3-1.36.43-.12 0-.26.06-.41.12-.41.12-.88.25-1.36.36s-.79.19-1.2.28-1 .22-1.45.31-.88.19-1.34.25l-.62.11c-.35.06-.67.11-1 .14a3.35 3.35 0 0 1-.47.06l-1.06.13c-.69.09-1.4.15-2.07.19-.3 0-.62.05-.91.07l-1.38.06a72.65 72.65 0 0 1-8.91-.23l-1.42-.14A10.41 10.41 0 0 1 48 257.4a2.12 2.12 0 0 1-.2-.24 3.59 3.59 0 0 0-.25-.33 76.19 76.19 0 0 1-6-10.72 143.7 143.7 0 0 1-7-18c0-.1-.08-.2-.1-.31a5.84 5.84 0 0 0-.2-.59 11.49 11.49 0 0 1-.34-2.71 9.19 9.19 0 0 1 .19-2v-.09c.19-.77.37-1.58.6-2.38s.33-1.36.52-2.05c.24-.85.5-1.73.8-2.61.18-.68.43-1.36.67-2.05a82.09 82.09 0 0 1 20.47-31.88c17.57-17.23 37.94-33.85 37.94-54.1 0-11.1-6.15-23.31-22.2-37.3a484.15 484.15 0 0 1 50.37-2.63q23.92 0 47.32 2.33c-16.35 14.1-22.59 26.4-22.59 37.6 0 20.25 20.37 36.87 38 54.1a82 82 0 0 1 20.42 31.88c.25.69.45 1.37.66 2.05.15.42.26.82.39 1.22.59 2 1.1 3.95 1.51 5.82v.05a12.46 12.46 0 0 1 .18 2 10.64 10.64 0 0 1-.2 2.05 4.86 4.86 0 0 1-.1.73Z",className:"cls-1"}),(0,V.jsx)("path",{d:"M405.37 127v111.91h-27.26v-46.07h-42.46v46.07h-27.23V127h27.23v43.85h42.46V127ZM435.57 234.62a40.66 40.66 0 0 1-16.43-15.94q-6-10.38-6-24.25c0-9.15 2-17.18 6.06-24.17a41.14 41.14 0 0 1 16.56-16 52.82 52.82 0 0 1 47.22 0 41 41 0 0 1 16.59 16c4.06 7 6.07 15 6.07 24.17a46.91 46.91 0 0 1-6.16 24.17 41.49 41.49 0 0 1-16.74 16 50.08 50.08 0 0 1-23.68 5.58 49.13 49.13 0 0 1-23.49-5.56Zm36.83-23.77q5.52-5.73 5.51-16.42c0-7.11-1.8-12.59-5.33-16.42a18.17 18.17 0 0 0-26.42-.09q-5.25 5.66-5.26 16.51 0 10.69 5.2 16.42a16.78 16.78 0 0 0 13 5.75 17.74 17.74 0 0 0 13.3-5.75ZM601.66 149.93v89H574.4v-12.11a30 30 0 0 1-11.27 9.46 34 34 0 0 1-15.72 3.6 35.2 35.2 0 0 1-18-4.56 30.56 30.56 0 0 1-12.07-13.14q-4.34-8.62-4.34-20.26v-52h27.14v48.31c0 6 1.49 10.59 4.58 13.9s7.24 5 12.44 5 9.5-1.67 12.59-5 4.65-7.93 4.65-13.9v-48.3ZM694.07 159.11q9.28 10.13 9.31 27.84v52h-27.11v-48.3c0-6-1.51-10.59-4.61-13.87s-7.24-5-12.44-5-9.38 1.65-12.47 5-4.64 7.92-4.64 13.87v48.3h-27.23v-89h27.23v11.81a29.35 29.35 0 0 1 11.2-9.33 35.41 35.41 0 0 1 15.78-3.43c10.46 0 18.72 3.36 24.98 10.11ZM715.76 170.2a38 38 0 0 1 14.11-15.95 36.74 36.74 0 0 1 19.93-5.57 35.05 35.05 0 0 1 16 3.65 29.4 29.4 0 0 1 11.42 9.9v-41.31h27.26v118h-27.26v-12.76a27.91 27.91 0 0 1-11 10.22 34.28 34.28 0 0 1-16.46 3.82 36.47 36.47 0 0 1-19.93-5.66 38.5 38.5 0 0 1-14.11-16.11q-5.21-10.44-5.2-24.16t5.24-24.07Zm55.8 8.13a19.14 19.14 0 0 0-27.58-.09q-5.7 5.82-5.69 16t5.71 16.2a18.18 18.18 0 0 0 13.77 6 18.39 18.39 0 0 0 13.81-5.91q5.66-5.86 5.66-16.09c-.02-6.81-1.91-12.19-5.68-16.11Z",className:"cls-2"}),(0,V.jsx)("path",{d:"M890.29 127.38a51.08 51.08 0 0 1 21.82 20.71q7.57 13.47 7.55 31.68t-7.55 31.63a50.16 50.16 0 0 1-21.82 20.45q-14.19 7.07-33.66 7.06h-37V120.13h37q19.44 0 33.66 7.25Zm1.46 86.62q12.07-12.19 12.1-34.19t-12.22-34.58c-8.11-8.3-19.75-12.44-35-12.44h-21.45v93.39h21.45q23.07-.04 35.12-12.18ZM947.7 234.78a40.05 40.05 0 0 1-15.7-15.87c-3.77-6.84-5.63-14.81-5.63-23.84s1.92-16.83 5.82-23.68a40 40 0 0 1 15.84-15.78 48.63 48.63 0 0 1 45 0 40.72 40.72 0 0 1 15.9 15.7 47.58 47.58 0 0 1 5.82 23.76 46.52 46.52 0 0 1-6 23.84 41.41 41.41 0 0 1-16.16 15.87 46.58 46.58 0 0 1-22.68 5.58 44.63 44.63 0 0 1-22.21-5.58Zm36.89-10.84a28 28 0 0 0 11.11-11q4.21-7.32 4.21-17.86t-4.12-17.85a27.39 27.39 0 0 0-10.86-10.93 31.18 31.18 0 0 0-29.09 0 26.25 26.25 0 0 0-10.62 10.93c-2.66 4.88-4 10.83-4 17.85s1.24 13.14 3.87 18A26 26 0 0 0 955.56 224a29.51 29.51 0 0 0 14.36 3.59 30.46 30.46 0 0 0 14.67-3.65ZM1083.4 155a33 33 0 0 1 12.65 12.44v-15.9h14.7v89.29a44 44 0 0 1-5.1 21.29 36.09 36.09 0 0 1-14.65 14.59c-6.28 3.51-13.68 5.26-22.06 5.26-11.49 0-21-2.7-28.69-8.12a31.75 31.75 0 0 1-13.52-22.17H1041a22.91 22.91 0 0 0 9.94 12.84c5 3.23 11 4.87 18 4.87 8 0 14.51-2.51 19.55-7.51s7.55-12 7.55-21v-18.39a34.62 34.62 0 0 1-12.74 12.76 37.38 37.38 0 0 1-19.78 5.11 39.67 39.67 0 0 1-36-21.84 49.78 49.78 0 0 1-5.42-23.61c0-8.93 1.77-16.76 5.42-23.52a39.51 39.51 0 0 1 14.88-15.72 41.15 41.15 0 0 1 21.14-5.57 38.93 38.93 0 0 1 19.86 4.9Zm8.66 22.82a27.81 27.81 0 0 0-10.73-11.25 30.4 30.4 0 0 0-29.74-.07 27.73 27.73 0 0 0-10.71 11.16 35.76 35.76 0 0 0-4 17.21 36.64 36.64 0 0 0 4 17.46 28.32 28.32 0 0 0 10.71 11.33 28.86 28.86 0 0 0 14.82 3.9 29.36 29.36 0 0 0 14.92-3.9 27.84 27.84 0 0 0 10.73-11.33 35.59 35.59 0 0 0 4-17.3 35.07 35.07 0 0 0-4-17.17ZM1126.54 237a9.89 9.89 0 0 1 7-16.9 9.22 9.22 0 0 1 6.81 2.87 10.24 10.24 0 0 1 0 14 9.19 9.19 0 0 1-6.81 2.88 9.59 9.59 0 0 1-7-2.85ZM1156 171.39a39.58 39.58 0 0 1 14.91-15.72 41.1 41.1 0 0 1 21.17-5.57c7.64 0 14.3 1.65 19.93 4.94a33 33 0 0 1 12.57 12.44v-15.94h14.69v87.37h-14.69v-16.25a33.82 33.82 0 0 1-12.82 12.66 38.23 38.23 0 0 1-19.86 5 39.49 39.49 0 0 1-21.05-5.74 40.64 40.64 0 0 1-14.85-16.1 50.49 50.49 0 0 1-5.39-23.61q0-13.35 5.39-23.48Zm64.64 6.47a28.3 28.3 0 0 0-10.8-11.25 30.4 30.4 0 0 0-29.74-.07 28 28 0 0 0-10.7 11.16 35.77 35.77 0 0 0-4 17.21 36.65 36.65 0 0 0 4 17.46 28.57 28.57 0 0 0 10.7 11.33 30.3 30.3 0 0 0 29.74 0 28.33 28.33 0 0 0 10.8-11.33 36.26 36.26 0 0 0 3.94-17.3 35.73 35.73 0 0 0-3.94-17.21ZM1257.93 134.47a9.89 9.89 0 0 1 7-16.9 9.06 9.06 0 0 1 6.75 2.87 10.16 10.16 0 0 1 0 14 9 9 0 0 1-6.75 2.86 9.38 9.38 0 0 1-7-2.83Zm14 17.07v87.37h-14.51v-87.37Z",className:"cls-3"})]})}var t_=e.i(131141),tS=e.i(188507),tC=e.i(802088),tj=e.i(751273),tT=e.i(616278),tE=e.i(383748),tR=e.i(363201),tI=e.i(940745),tA=e.i(42458),tP=e.i(997574);function tD(e){var t,n=e.severity,r=e.loading,i=e.resolved,o=e_.tokens.blueDimmest,a=e_.tokens.blueStrongest,s="";switch(n){case tc.LOW:o=e_.tokens.blueDimmest,a=e_.tokens.blueStrongest,t=(0,V.jsx)(tR.default,{}),s="Low severity vulnerability";break;case tc.MODERATE:o=e_.tokens.yellowDimmest,a=e_.tokens.yellowStrongest,t=(0,V.jsx)(tA.default,{}),s="Moderate severity vulnerability";break;case tc.HIGH:o=e_.tokens.orangeDimmest,a=e_.tokens.orangeStrongest,t=(0,V.jsx)(tA.default,{}),s="High severity vulnerability";break;case tc.CRITICAL:o=e_.tokens.redDimmest,a=e_.tokens.redStrongest,t=(0,V.jsx)(tE.default,{}),s="Critical severity vulnerability"}return i&&(o=e_.tokens.accentPositiveDimmest,a=e_.tokens.accentPositiveStrongest,t=(0,V.jsx)(tT.default,{}),s="This vulnerability has been resolved"),r&&(o=e_.tokens.accentPrimaryDimmest,a=e_.tokens.accentPrimaryStrongest,s="Security scan in progress",t=(0,V.jsx)(tI.default,{})),(0,V.jsx)(tj.Tooltip,{tooltip:s,placement:"top",isDisabled:r,children:(0,V.jsx)("div",{clsx:tP.default.severity,style:{background:o,color:a},children:t})})}var tO=e.i(576073),tN=e.i(462783);function tM(e){var t=e.open,n=e.onClick;return(0,V.jsx)(eA.IconButton,{alt:t?"Hide details":"Show details",onClick:n,children:t?(0,V.jsx)(tN.default,{}):(0,V.jsx)(tO.default,{})})}function tL(e){var t=e.expanded,n=e.setExpanded;return(0,V.jsx)(eS.View,{row:!0,grow:!0,align:"center",justify:"end",gap:8,children:(0,V.jsx)(tM,{open:t,onClick:function(){return n(!t)}})})}var tB=e.i(140487),tV=e.i(91720),tF=e.i(264661),tU=e.i(218174);function tG(e){var t=e.onClick;return(0,V.jsx)(eS.View,{clsx:tU.default.fullWidth,children:(0,V.jsx)(tB.Button,{text:"View Agent Session",iconRight:(0,V.jsx)(tF.default,{}),variant:"nofill",size:"small",onClick:t})})}function t$(e){var t=e.disabled,n=e.loading,r=e.onClick;return(0,V.jsx)(eS.View,{clsx:tU.default.fullWidth,children:(0,V.jsx)(tB.Button,{text:"Update automatically",disabled:t,loading:n,size:"small",onClick:r})})}function tz(e){var t=e.disabled,n=e.loading,r=e.tooltip,i=e.onClick;return(0,V.jsx)(eS.View,{clsx:tU.default.fullWidth,children:(0,V.jsx)(tj.Tooltip,{isDisabled:!r,tooltip:r,children:(0,V.jsx)(tB.Button,{text:"Fix with Agent",disabled:t,loading:n,colorway:"primary",size:"small",onClick:i})})})}function tH(e){var t=e.allowIgnore,n=e.disabled,r=e.ignored,i=e.ignoreIssue,o=e.unignoreIssue;return(0,V.jsx)(eS.View,{clsx:tU.default.fullWidth,children:r?(0,V.jsx)(tB.Button,{variant:"outlined",text:"Move to active",size:"small",disabled:n,onClick:function(){return null==o?void 0:o()}}):(0,V.jsx)(tj.Tooltip,{isDisabled:t,tooltip:t?void 0:"This is a critical issue and cannot be hidden.",children:(0,V.jsx)(tB.Button,{variant:"default",text:"Hide",size:"small",disabled:n||!t,onClick:function(){return null==i?void 0:i()}})})})}function tW(e){var t=e.state,n=e.openAgentSession,r=e.onUpdateDependencies,i=e.onFixWithAgent,o=e.disabled,a=e.updatingDependencies,s=e.hasUnresolvedFixableVulns,l=e.ignored,u=e.ignoreIssue,c=e.unignoreIssue,d=e.allowIgnore,f=e.learnMoreUrl,p="";return t.running?p="Agent is currently working on another task":t.fixing?p="Your session is being created":o&&(p="An action is in progress, please wait"),(0,V.jsxs)(eS.View,{row:!0,align:"center",justify:"center",gap:8,pt:8,children:[t.resolved||t.fixing||t.running?null:(0,V.jsx)(eS.View,{grow:!0,clsx:tU.default.actionButton,children:(0,V.jsx)(tH,{allowIgnore:d,disabled:null!=o&&o,ignored:!!d&&l,ignoreIssue:d?u:void 0,unignoreIssue:d?c:void 0})}),n&&t.session?(0,V.jsx)(eS.View,{grow:!0,clsx:tU.default.actionButtonPrimary,children:(0,V.jsx)(tG,{onClick:function(){return n(t.session)}})}):null,r&&s&&!t.session?(0,V.jsx)(eS.View,{grow:!0,clsx:tU.default.actionButton,children:(0,V.jsx)(t$,{disabled:o,loading:a,onClick:function(){return r()}})}):null,!i||t.resolved||t.session||l?null:(0,V.jsx)(eS.View,{grow:!0,clsx:tU.default.actionButtonPrimary,children:(0,V.jsx)(tz,{disabled:o||t.fixing||t.running,loading:t.fixing,tooltip:p,onClick:function(){return i()}})}),!f||i||t.resolved?null:(0,V.jsx)(eS.View,{grow:!0,clsx:tU.default.actionButtonPrimary,children:(0,V.jsx)(tV.ButtonLink,{variant:"outlined",colorway:"primary",href:f,text:"Learn More",noNextLink:!0,target:"_blank",rel:"noopener noreferrer"})})]})}var tq=e.i(940518);function tK(e){var t,n=e.disabled,r=e.state,i=e.openAgentSession,o=e.onFixWithAgent,a=(0,B._)((0,F.useState)(!1),2),s=a[0],l=a[1];return(0,V.jsxs)(eD.Surface,{clsx:tq.default.vulnerability,elevated:!0,p:8,children:[(0,V.jsxs)(eS.View,{clsx:(t={},(0,ew._)(t,tq.default.vulnerabilityHeader,s),(0,ew._)(t,tq.default.isExpanded,!r.resolved||s),t),row:!0,gap:8,align:"center",justify:"space-between",wrap:!r.resolved,shrink:!0,children:[(0,V.jsxs)(eS.View,{row:!0,gap:8,align:"center",shrink:!0,children:[(0,V.jsx)(tD,{severity:r.vulnerability.severity,loading:r.running||r.fixing,resolved:r.resolved}),(0,V.jsx)(eO.Text,{variant:"subheadDefault",color:r.resolved?"dimmer":"default",children:"Detected malicious file vulnerability"})]}),(0,V.jsx)(tL,{expanded:s,setExpanded:l})]}),s?(0,V.jsxs)(eS.View,{gap:8,children:[(0,V.jsx)(eO.Text,{color:"dimmer",variant:"small",children:r.vulnerability.message}),(0,V.jsx)(eS.View,{clsx:tq.default.maliciousVulnerabilityCode,gap:4,children:(0,V.jsx)(eS.View,{gap:8,children:r.vulnerability.paths.map(function(e){return(0,V.jsx)(eS.View,{clsx:tq.default.filePath,children:e},e)})})})]}):null,(0,V.jsx)(tW,{allowIgnore:!1,openAgentSession:i,onFixWithAgent:o?function(){o(r.vulnerability),(0,e5.track)(e6.events.SECURITY_SCAN,{action:"fix_vulnerability_agent",name:r.vulnerability.name,paths:r.vulnerability.paths,type:e8.Malicious})}:void 0,state:r,disabled:n})]})}var tY=e.i(624782),tQ=e.i(530310),tX=e.i(957798);function tJ(e){var t,n=e.type,r=e.loading,i=e.resolved,o=n===e8.Hounddog,a=o?"warning":"negative",s=o?(0,V.jsx)(tQ.default,{size:16,alt:"Privacy scan"}):(0,V.jsx)(tX.default,{size:16,alt:"Security scan"});return r?(s=(0,V.jsx)(tI.default,{size:16,alt:"Fix with agent in progress"}),t="Fix with agent in progress"):i?(s=(0,V.jsx)(tT.default,{size:16,alt:"This vulnerability has been resolved"}),t="This vulnerability has been resolved",a="lime"):t=o?"Privacy risk":"Security vulnerability",(0,V.jsx)(tj.Tooltip,{tooltip:t,placement:"top",children:(0,V.jsx)(tY.Pill,{colorway:a,variant:"filled",text:o?"Privacy":"Security",iconLeft:s})})}var tZ=e.i(634669),t0=e.i(732691);function t1(e){var t,n,r,i=e.disabled,o=e.states,a=e.updatingDependencies,s=e.openAgentSession,l=e.onFixWithAgent,u=e.onUpdateDependencies,c=(0,B._)((0,F.useState)(!1),2),d=c[0],f=c[1],p=(n=null==(t=o.find(function(e){return e.session}))?void 0:t.session,{running:o.some(function(e){return e.running}),fixing:o.some(function(e){return e.fixing}),resolved:o.every(function(e){return e.resolved}),session:null!=n?n:null}),h=o.filter(function(e){return e.type===e8.Dependency}).filter(function(e){return tg(e.vulnerability)}),g=o.filter(function(e){return e.type===e8.Dependency}).filter(function(e){return!tg(e.vulnerability)}),m=h.length>0,x=g.length>0,y=h.some(function(e){return tg(e.vulnerability)&&!th(e.vulnerability)});return m||x?(0,V.jsxs)(eD.Surface,{clsx:t0.default.vulnerability,elevated:!0,p:8,children:[(0,V.jsxs)(eS.View,{clsx:(r={},(0,ew._)(r,t0.default.vulnerabilityHeader,!0),(0,ew._)(r,t0.default.isExpanded,!p.resolved||d),r),row:!0,gap:8,align:"center",justify:"space-between",wrap:!p.resolved,shrink:!0,children:[(0,V.jsxs)(eS.View,{row:!0,gap:8,align:"start",shrink:!0,children:[(0,V.jsx)(tJ,{type:e8.Dependency,loading:p.running||p.fixing,resolved:p.resolved}),(0,V.jsx)(eO.Text,{color:p.resolved?"dimmer":"default",multiline:!1,showTooltipOnTruncate:!0,shrink:1,children:"Outdated dependencies have known vulnerabilities"})]}),(0,V.jsx)(tL,{expanded:d,setExpanded:f})]}),p.resolved&&!d?null:(0,V.jsxs)(eS.View,{gap:16,children:[(0,V.jsx)(eO.Text,{color:"dimmer",variant:"small",children:"There are dependencies that have vulnerabilities and may need to be updated."}),m?(0,V.jsxs)(eS.View,{gap:8,children:[(0,V.jsx)(eO.Text,{color:"dimmer",variant:"small",children:"These dependencies can be updated automatically."}),(0,V.jsx)(eS.View,{clsx:t0.default.dependencyVulnerabilityGroup,gap:4,children:h.map(function(e){var t=e.vulnerability;return(0,V.jsx)(t2,{name:t.name,status:t.status,version:t.currentVersion},t.id)})})]}):null,x?(0,V.jsxs)(eS.View,{gap:8,children:[(0,V.jsxs)(eO.Text,{color:"dimmer",variant:"small",children:["These dependencies may cause issues if updated without making additional changes."," ",l?"You can have the Agent update them for you and make any necessary changes.":null]}),(0,V.jsx)(eS.View,{clsx:t0.default.dependencyVulnerabilityGroup,gap:4,children:g.map(function(e){var t=e.vulnerability;return(0,V.jsx)(t2,{name:t.name,status:t.status,version:t.currentVersion},t.id)})})]}):null]}),(0,V.jsx)(tW,{openAgentSession:s,onUpdateDependencies:u,updatingDependencies:a,onFixWithAgent:l?function(){var e=o.filter(function(e){return e.vulnerability.status!==tp.Fixed}).map(function(e){return e.vulnerability}).filter(function(e){return e.type===e8.Dependency});l(e),(0,e5.track)(e6.events.SECURITY_SCAN,{action:"fix_vulnerability_agent",checkIds:e.map(function(e){return e.id}),type:e8.Dependency})}:void 0,state:p,disabled:i,hasUnresolvedFixableVulns:y,allowIgnore:!1})]}):null}function t2(e){var t=e.name,n=e.status,r=e.version,i=n===tp.Fixed;return(0,V.jsxs)(eS.View,{row:!0,gap:8,align:"center",children:[n!==tp.Fixed?null:(0,V.jsx)(tT.default,{color:e_.tokens.accentPositiveStronger}),n!==tp.Pending?null:(0,V.jsx)(tZ.default,{}),(0,V.jsx)(eO.Text,{color:i?"dimmer":"default",children:(0,V.jsxs)("span",{clsx:t0.default.dependencyVulnerabilityName,children:[t,r?"@".concat(r):null]})})]})}var t3=e.i(409146),t4=e.i(656161);function t8(e){var t,n=e.disabled,r=e.state,i=e.openAgentSession,o=e.onFixWithAgent,a=e.ignoreIssue,s=e.unignoreIssue,l=(0,B._)((0,F.useState)(!1),2),u=l[0],c=l[1],d=r.vulnerability;return(0,V.jsxs)(eD.Surface,{clsx:t4.default.vulnerability,elevated:!0,p:8,children:[(0,V.jsx)(eS.View,{clsx:(t={},(0,ew._)(t,t4.default.vulnerabilityHeader,u),(0,ew._)(t,t4.default.isExpanded,!r.resolved||u),t),gap:8,children:(0,V.jsxs)(eS.View,{row:!0,gap:8,align:"start",justify:"space-between",shrink:!0,children:[(0,V.jsxs)(eS.View,{row:!0,gap:8,align:"start",shrink:!0,clsx:t4.default.titleContainer,children:[(0,V.jsx)(tJ,{type:d.type,loading:r.running||r.fixing,resolved:r.resolved}),(0,V.jsx)(eO.Text,{color:r.resolved?"dimmer":"default",multiline:!1,showTooltipOnTruncate:!0,shrink:1,children:d.message})]}),(0,V.jsx)(tL,{expanded:u,setExpanded:c})]})}),u?(0,V.jsxs)(eS.View,{gap:8,children:[(0,V.jsx)(eO.Text,{color:"dimmer",variant:"small",children:r.vulnerability.message}),(0,V.jsxs)(eS.View,{children:[(0,V.jsx)(eO.Text,{variant:"small",children:"Associated Compliance Framework"}),(0,V.jsx)(eO.Text,{color:"dimmer",variant:"small",children:d.privacyViolations.join(", ")})]}),(0,V.jsxs)(eS.View,{gap:4,children:[(0,V.jsx)(eO.Text,{variant:"small",children:"Remediation Strategy:"}),(0,V.jsx)(eO.Text,{color:"dimmer",variant:"small",children:d.remediationSummary})]}),(0,V.jsxs)(eS.View,{clsx:t4.default.hounddogVulnerabilityCode,gap:4,children:[(0,V.jsxs)(eS.View,{row:!0,align:"center",gap:8,children:[(0,V.jsx)(eK.default,{path:d.location.path,size:16}),(0,V.jsx)(eO.Text,{clsx:t4.default.filePath,color:"dimmest",variant:"small",children:d.location.path})]}),(0,V.jsx)(t3.default,{code:d.location.lines,filePath:d.location.path,fontSize:12,lineNumbersStart:d.location.start.line,lineNumbers:!0})]})]}):null,(0,V.jsx)(tW,{allowIgnore:!0,ignored:d.ignored,ignoreIssue:a,unignoreIssue:s,openAgentSession:i,onFixWithAgent:o&&"deletion"===d.remediationStrategy?function(){o(d),(0,e5.track)(e6.events.SECURITY_SCAN,{action:"fix_vulnerability_agent",checkIds:[r.vulnerability.id],name:r.vulnerability.name,type:e8.Hounddog})}:void 0,learnMoreUrl:"https://docs.hounddog.ai/scanner/sensitive-data-exposure-in-third-party-or-ai-integrations--beyon",state:r,disabled:n})]})}var t5=e.i(31741);function t6(e){var t,n=e.disabled,r=e.state,i=e.openAgentSession,o=e.onFixWithAgent,a=e.ignoreIssue,s=e.unignoreIssue,l=(0,B._)((0,F.useState)(!1),2),u=l[0],c=l[1];return(0,V.jsxs)(eD.Surface,{clsx:t5.default.vulnerability,elevated:!0,p:8,children:[(0,V.jsx)(eS.View,{clsx:(t={},(0,ew._)(t,t5.default.vulnerabilityHeader,u),(0,ew._)(t,t5.default.isExpanded,!r.resolved||u),t),gap:8,children:(0,V.jsxs)(eS.View,{row:!0,gap:8,align:"start",justify:"space-between",shrink:!0,children:[(0,V.jsxs)(eS.View,{row:!0,gap:8,align:"start",shrink:!0,children:[(0,V.jsx)(tJ,{type:r.vulnerability.type,loading:r.running||r.fixing,resolved:r.resolved}),(0,V.jsx)(eO.Text,{color:r.resolved?"dimmer":"default",multiline:!1,showTooltipOnTruncate:!0,shrink:1,children:r.vulnerability.message})]}),(0,V.jsx)(tL,{expanded:u,setExpanded:c})]})}),u?(0,V.jsxs)(eS.View,{gap:8,children:[(0,V.jsx)(eO.Text,{color:"dimmer",variant:"small",children:r.vulnerability.message}),(0,V.jsxs)(eS.View,{clsx:t5.default.analysisVulnerabilityCode,gap:4,children:[(0,V.jsxs)(eS.View,{row:!0,align:"center",gap:8,children:[(0,V.jsx)(eK.default,{path:r.vulnerability.location.path,size:16}),(0,V.jsx)(eO.Text,{clsx:t5.default.filePath,color:"dimmest",variant:"small",children:r.vulnerability.location.path})]}),(0,V.jsx)(t3.default,{code:r.vulnerability.location.lines,filePath:r.vulnerability.location.path,fontSize:12,lineNumbersStart:r.vulnerability.location.start.line,lineNumbers:!0})]})]}):null,(0,V.jsx)(tW,{allowIgnore:!0,ignored:r.vulnerability.ignored,ignoreIssue:a,unignoreIssue:s,openAgentSession:i,onFixWithAgent:o?function(){o(r.vulnerability),(0,e5.track)(e6.events.SECURITY_SCAN,{action:"fix_vulnerability_agent",checkIds:[r.vulnerability.id],name:r.vulnerability.name,type:e8.Analysis})}:void 0,state:r,disabled:n})]})}var t9=e.i(988676);function t7(e,t){return(0,t_.produce)(e,function(n){switch(t.type){case"UPDATE":var r=new Set(e.vulnerabilities.keys()),i=!0,o=!1,a=void 0;try{for(var s,l=t.vulns[Symbol.iterator]();!(i=(s=l.next()).done);i=!0){var u=s.value;r.delete(u.id);var c=n.vulnerabilities.get(u.id);c?(c.vulnerability=u,c.resolved=th(u)):n.vulnerabilities.set(u.id,{type:u.type,vulnerability:u,resolved:th(u),session:null,running:!1,fixing:!1})}}catch(e){o=!0,a=e}finally{try{i||null==l.return||l.return()}finally{if(o)throw a}}var d=!0,f=!1,p=void 0;try{for(var h,g=r[Symbol.iterator]();!(d=(h=g.next()).done);d=!0){var m=h.value;n.vulnerabilities.delete(m)}}catch(e){f=!0,p=e}finally{try{d||null==g.return||g.return()}finally{if(f)throw p}}n.running.id&&r.has(n.running.id)&&(n.running.id=null);break;case"RUNNING":n.running.state=t.state,t.session?n.running.id=t.session.id:n.running.id=null;var x=!0,y=!1,b=void 0;try{for(var w,k=n.vulnerabilities.values()[Symbol.iterator]();!(x=(w=k.next()).done);x=!0){var _,S=w.value;S.running=(null==(_=S.session)?void 0:_.id)===n.running.id}}catch(e){y=!0,b=e}finally{try{x||null==k.return||k.return()}finally{if(y)throw b}}break;case"SESSION_OPENED":n.running.id=t.session.id;var C=!0,j=!1,T=void 0;try{for(var E,R=t.ids[Symbol.iterator]();!(C=(E=R.next()).done);C=!0){var I=E.value,A=n.vulnerabilities.get(I);A&&(A.session=t.session)}}catch(e){j=!0,T=e}finally{try{C||null==R.return||R.return()}finally{if(j)throw T}}break;case"FIXING":var P=!0,D=!1,O=void 0;try{for(var N,M=t.ids[Symbol.iterator]();!(P=(N=M.next()).done);P=!0){var L=N.value,B=n.vulnerabilities.get(L);B&&(B.fixing=t.state)}}catch(e){D=!0,O=e}finally{try{P||null==M.return||M.return()}finally{if(D)throw O}}}})}function ne(e){var t=e.scanResult,n=e.currentAgentSession,r=e.openAgentSession,i=e.onFixWithAgent,o=e.onUpdateDependencies,a=e.isScanning,s=e.isUpdatingDependencies,l=(0,B._)((0,F.useReducer)(t7,null,function(){return{running:{id:null,state:!1},updatingDependencies:!1,vulnerabilities:new Map}}),2),u=l[0],c=l[1],d=(S=tl(),C=(0,tn.usePid2Callback)(function(e){return function(t){var n=t.kind,r=t.fingerprint;return(0,ei._)(function(){return(0,eo._)(this,function(t){return[2,e.securityScan.ignoreScan.rpc({kind:n,fingerprint:r})]})})()}}),j=(0,F.useCallback)(function(e){var t=e.kind,n=e.id;return(0,ei._)(function(){return(0,eo._)(this,function(e){switch(e.label){case 0:if(!C)return[2];return[4,C({kind:t,fingerprint:n})];case 1:if(!e.sent().ok)return[2];return S(function(e){return e?e.map(function(e){return e.id===n?(0,M._)((0,N._)({},e),{ignored:!0}):e}):null}),[2]}})})()},[C,S]),T=(0,tn.usePid2Callback)(function(e){return function(t){var n=t.kind,r=t.fingerprint;return(0,ei._)(function(){return(0,eo._)(this,function(t){return[2,e.securityScan.unignoreScan.rpc({kind:n,fingerprint:r})]})})()}}),{ignoreIssue:j,unignoreIssue:(0,F.useCallback)(function(e){var t=e.kind,n=e.id;return(0,ei._)(function(){return(0,eo._)(this,function(e){switch(e.label){case 0:if(!T)return[2];return[4,T({kind:t,fingerprint:n})];case 1:if(!e.sent().ok)return[2];return S(function(e){return e?e.map(function(e){return e.id===n?(0,M._)((0,N._)({},e),{ignored:!1}):e}):null}),[2]}})})()},[T,S])}),f=d.ignoreIssue,p=d.unignoreIssue;(0,F.useEffect)(function(){c({type:"UPDATE",vulns:t})},[t]);var h=(0,F.useMemo)(function(){if(i)return function(e){return(0,ei._)(function(){var t;return(0,eo._)(this,function(n){switch(n.label){case 0:c({type:"FIXING",ids:Array.isArray(e)?e.map(function(e){return e.id}):[e.id],state:!0}),n.label=1;case 1:return n.trys.push([1,,3,4]),[4,i(e)];case 2:return t=n.sent(),c({type:"SESSION_OPENED",ids:Array.isArray(e)?e.map(function(e){return e.id}):[e.id],session:t}),[2,t];case 3:return c({type:"FIXING",ids:Array.isArray(e)?e.map(function(e){return e.id}):[e.id],state:!1}),[7];case 4:return[2]}})})()}},[i]);(0,tC.useObserver)(null==n?void 0:n.agent.state,{next:function(e){(null==e?void 0:e.state)!==tS.AgentRunState.AGENT_STATE_PAUSED&&(null==e?void 0:e.state)!==tS.AgentRunState.AGENT_STATE_NOT_STARTED?c({type:"RUNNING",session:n,state:!0}):c({type:"RUNNING",session:null,state:!1})}});var g=[],m=[],x=[],y=[],b=[],w=!0,k=!1,_=void 0;try{for(var S,C,j,T,E,R=u.vulnerabilities.values()[Symbol.iterator]();!(w=(E=R.next()).done);w=!0){var I=E.value;I.type===e8.Dependency?I.vulnerability.fix.available?g.push(I):m.push(I):I.type===e8.Analysis?x.push(I):I.type===e8.Malicious?y.push(I):I.type===e8.Hounddog&&b.push(I)}}catch(e){k=!0,_=e}finally{try{w||null==R.return||R.return()}finally{if(k)throw _}}var A=u.running.state;return(0,V.jsxs)(eS.View,{gap:16,children:[(0,V.jsx)(t1,{disabled:a||s||A,states:g,updatingDependencies:s,openAgentSession:r,onFixWithAgent:h,onUpdateDependencies:o}),y.length&&(g.length||m.length)?(0,V.jsx)(t9.DividerH,{}):null,y.map(function(e){return(0,V.jsx)(tK,{disabled:a||s||A,state:e,openAgentSession:r,onFixWithAgent:h},"MaliciousVulnerability-".concat(e.vulnerability.id))}),x.length&&(g.length||m.length||y.length)?(0,V.jsx)(t9.DividerH,{}):null,x.map(function(e){return(0,V.jsx)(t6,{disabled:a||s||A,state:e,openAgentSession:r,onFixWithAgent:h,ignoreIssue:function(){return(0,ei._)(function(){return(0,eo._)(this,function(t){switch(t.label){case 0:return[4,f({kind:"sast",id:e.vulnerability.id})];case 1:return t.sent(),(0,e5.track)(e6.events.SECURITY_SCAN,{action:"hide_issue_clicked",type:"sast",vulnerabilityId:e.vulnerability.id,vulnerabilityName:e.vulnerability.name,severity:e.vulnerability.severity}),[2]}})})()},unignoreIssue:function(){return(0,ei._)(function(){return(0,eo._)(this,function(t){switch(t.label){case 0:return[4,p({kind:"sast",id:e.vulnerability.id})];case 1:return t.sent(),(0,e5.track)(e6.events.SECURITY_SCAN,{action:"unhide_issue_clicked",type:"sast",vulnerabilityId:e.vulnerability.id,vulnerabilityName:e.vulnerability.name,severity:e.vulnerability.severity}),[2]}})})()}},e.vulnerability.id)}),b.length&&(g.length||m.length||y.length||x.length)?(0,V.jsx)(t9.DividerH,{}):null,b.map(function(e){return(0,V.jsx)(t8,{disabled:a||s||A,state:e,openAgentSession:r,onFixWithAgent:h,ignoreIssue:function(){return(0,ei._)(function(){return(0,eo._)(this,function(t){switch(t.label){case 0:return[4,f({kind:"hounddog",id:e.vulnerability.id})];case 1:return t.sent(),(0,e5.track)(e6.events.SECURITY_SCAN,{action:"hide_issue_clicked",type:"hounddog",vulnerabilityId:e.vulnerability.id,vulnerabilityName:e.vulnerability.name,severity:e.vulnerability.severity}),[2]}})})()},unignoreIssue:function(){return(0,ei._)(function(){return(0,eo._)(this,function(t){switch(t.label){case 0:return[4,p({kind:"hounddog",id:e.vulnerability.id})];case 1:return t.sent(),(0,e5.track)(e6.events.SECURITY_SCAN,{action:"unhide_issue_clicked",type:"hounddog",vulnerabilityId:e.vulnerability.id,vulnerabilityName:e.vulnerability.name,severity:e.vulnerability.severity}),[2]}})})()}},"HoundDogVulnerability-".concat(e.vulnerability.id))})]})}var nt=e.i(904851),nn=e.i(90659),nr=e.i(119468),ni=e.i(374106),no=e.i(641555),na=function(){function e(){(0,nt._)(this,e),(0,ew._)(this,"state",void 0),this.state={fixing:!1,currSession:null,prevSession:null}}return(0,nn._)(e,[{key:"startFixWithAgent",value:function(e){var t,n=e.sessionId,r=e.vulns;this.state.fixing&&this.completeFixing(!1),t=this.state.currSession,this.state={fixing:!0,prevSession:t,currSession:{sessionId:n,vulns:r,commits:0,startTime:new Date,endTime:null,fixed:!1}}}},{key:"commit",value:function(e){var t=e.sessionId;!this.state.fixing||t===this.state.currSession.sessionId&&this.state.currSession.commits++}},{key:"hasAgentFixedVulns",value:function(e){if(!this.state.fixing)return!1;var t=this.state.currSession.vulns;return Array.isArray(t)?t.every(function(t){return th(e.find(function(e){return e.id===t.id}))}):th(e.find(function(e){return e.id===t.id}))}},{key:"completeFixing",value:function(e){if(this.state.fixing){var t=(0,M._)((0,N._)({},this.state.currSession),{endTime:new Date,fixed:e});this.state={fixing:!1,currSession:t,prevSession:this.state.prevSession},this.trackAgentFix()}}},{key:"trackAgentFix",value:function(){if(!this.state.fixing&&this.state.currSession){var e=this.state.currSession,t=e.sessionId,n=e.vulns,r=e.commits,i=e.startTime,o=e.endTime,a=e.fixed,s=o.getTime()-i.getTime();(0,e5.track)(e6.events.SECURITY_SCAN,{action:"agent_fix_completed",sessionId:t,vulns:n,commits:r,timeTaken:s,fixed:a,type:Array.isArray(n)?e8.Dependency:n.type})}}},{key:"updateScanResult",value:function(e){this.state.fixing&&this.hasAgentFixedVulns(e)&&this.completeFixing(!0)}},{key:"agentFixFailed",value:function(e){this.state.fixing&&e===this.state.currSession.sessionId&&this.completeFixing(!1)}}]),e}(),ns=e.i(112767),nl=e.i(545969),nu=e.i(257811),nc=e.i(283110),nd=e.i(606867),nf=e.i(357399),np=e.i(481121),nh=U.Type.Object({type:U.Type.Literal("securityScan")}),ng={Content:function(e){var t=e.options.performPaneOperation,n=(0,F.useCallback)(function(e){t({operation:"open",pane:{type:"agentChat",data:{sessionId:e}}})},[t]),r=(0,F.useCallback)(function(e){t({operation:"open",secondary:!1,pane:e})},[t]);return(0,V.jsx)(nm,{openAgentSession:n,openPane:r})},Icon:function(e){var t=e.size;return(0,V.jsx)(nd.IconContext.Provider,{value:{color:e_.tokens.blueStrongest,size:t},children:(0,V.jsx)(tX.default,{})})},getTitle:function(){return"Security Scanner"},description:"Scan your app for vulnerabilities",category:eq.PaneCategory.CloudServices,decode:function(e){return G.Value.Decode(nh,e)}},nm=function(e){var t,n,r,i,o,a,s,l,u,c,d,f,p,h,g=e.openAgentSession,m=e.openPane,x=tx(),y=x.flagHoundDogScan,b=x.scanResult,w=x.lastScanDate,k=x.runScan,_=x.isScanning,S=x.isUpdatingDependencies,C=x.updateDependencies,j=x.securityScanEnabled,T=x.setSecurityScanEnabled,E=x.privacyScanEnabled,R=x.setPrivacyScanEnabled,I=(0,B._)((0,F.useState)(!1),2),A=I[0],P=I[1];(0,F.useEffect)(function(){_||b||k()},[_,k,b]);var D=(0,e1.useSupportsAgent)(),O=(0,e2.useChatter)(),N=(0,e3.useObservable)(O.sessions.agent.current,null),M=(!(t=(0,F.useRef)()).current&&(t.current=new na),n=t.current,i=(r=tx()).isScanning,o=r.runScan,a=r.scanResult,s=r.updateDependencies,l=(0,e2.useChatter)(),c=(u=(0,B._)((0,F.useState)(null),2))[0],d=u[1],f=(0,no.useObservableMemo)(function(){return c?l.sessions.get(c):null},[c,l]),p=(0,no.useObservableMemo)(function(){return null==f?void 0:f.data.select(function(e){return e.readOnly})},[f],{default:!1}),h=(0,F.useCallback)(function(e){return(0,ei._)(function(){var t,r,i,o,a,u,c,f,p,h,m,x,y,b,w,k,_,S,C;return(0,eo._)(this,function(j){switch(j.label){case 0:if(t="",Array.isArray(e))return[3,1];return(r=e.type)===e8.Analysis?t=["A recent security scan returned the following vulnerability alert using static code analysis: ",e.message.split("\n").map(function(e){return"> ".concat(e)}).join("\n"),"> **Location:** `".concat(e.location.path,"` (lines ").concat(e.location.start.line,"-").concat(e.location.end.line,")"),"\n**Instructions:**\n- Examine the code at the specified location to understand the vulnerability context\n- Decide whether the reported issue is real. *Use execution path, context, and impact to judge.*\n- If you have high confidence that it's exploitable, provide the smallest safe patch. Tell the user it is important to test their app before continuing with their deployment.\n- If the issue is a false positive but violates coding best practices, apply the minimal fix to follow recommended patterns. Otherwise, if there's no security risk and the code follows best practices, make no change and explain why."].join("\n"):r===e8.Malicious?t=["A security scan found malicious files matching known supply chain attack signatures:",e.message.split("\n").map(function(e){return"> ".concat(e)}).join("\n"),e.paths.map(function(e){return"> **Malicious File :** `".concat(e,"`")}).join("\n"),"\n**IMMEDIATE ACTION REQUIRED:**\n- **DO NOT EXECUTE** any code from these files\n- Immediately quarantine or delete the malicious files listed above\n- Check if these files are part of compromised npm packages\n- Audit for compromised dependencies and update to clean versions\n\nPlease take these actions and confirm when the malicious files have been removed."].join("\n"):r===e8.Hounddog?t="deletion"===e.remediationStrategy?["A privacy scan detected sensitive data leakage in your code:",e.message.split("\n").map(function(e){return"> ".concat(e)}).join("\n"),"> **Location:** `".concat(e.location.path,"` (lines ").concat(e.location.start.line,"-").concat(e.location.end.line,")"),"\n**Remediation Strategy: REMOVAL**","- ".concat(null!=(i=e.remediationPrompt)?i:e.remediationSummary),"\nPlease review the code and safely remove the sensitive data exposure."].join("\n"):["A privacy scan detected sensitive data leakage in your code:",e.message.split("\n").map(function(e){return"> ".concat(e)}).join("\n"),"> **Location:** `".concat(e.location.path,"` (lines ").concat(e.location.start.line,"-").concat(e.location.end.line,")"),"","**Remediation Strategy**","- ".concat(e.remediationSummary)].filter(Boolean).join("\n"):(0,tu.default)(r),[3,4];case 1:if(o=[],!(a=e.filter(function(e){return e.type===e8.Dependency}).filter(function(e){return e.status===tp.Pending})).length)return[3,3];u=!0,c=!1,f=void 0;try{for(p=a[Symbol.iterator]();!(u=(h=p.next()).done);u=!0)(m=h.value).fix.available&&o.push({name:m.name,from:m.currentVersion,to:m.fix.breakingChanges&&"object"===(0,nr._)(m.fix.version)?m.fix.version.version:void 0})}catch(e){c=!0,f=e}finally{try{u||null==p.return||p.return()}finally{if(c)throw f}}return[4,null==s?void 0:s()];case 2:j.sent(),j.label=3;case 3:x="",y=!0,b=!1,w=void 0;try{for(k=o[Symbol.iterator]();!(y=(_=k.next()).done);y=!0)S=_.value,x+=S.from&&S.to?"".concat(S.name,"@").concat(S.from," -> ").concat(S.name,"@").concat(S.to,"\n"):"".concat(S.name,"\n")}catch(e){b=!0,w=e}finally{try{y||null==k.return||k.return()}finally{if(b)throw w}}x&&(x=x.trim()),x&&(t=["In response to a security scan, the following dependencies were updated:\n```",x,"```\n\nEnsure that the app still works and fix any issues that may have come up."].join("\n")),j.label=4;case 4:if(!t)throw Error("No message to send");return[4,l.sessions.create({sessionType:tS.SessionType.AGENT_SESSION})];case 5:if(!(C=j.sent()).ok)throw C;return C.payload.appendEvent({kind:"message",intent:tS.MessageAction.AGENT,message:t}),g(C.payload.id),n.startFixWithAgent({sessionId:C.payload.id,vulns:e}),d(C.payload.id),[2,C.payload]}})})()},[l,s,g,d,n]),(0,F.useEffect)(function(){a&&n.state.fixing&&n.updateScanResult(a)},[a,n]),(0,F.useEffect)(function(){c&&p&&n.state.fixing&&n.agentFixFailed(c)},[p,c,n]),(0,e2.useChatHook)("received-completed-event",function(e){var t=e.event;(0,ni.isEventAgentToolDataKind)(t,"commitData")&&n.state.fixing&&(n.commit({sessionId:t.sessionId}),i||o())}),{fixWithAgent:h}).fixWithAgent,L=(0,F.useCallback)(function(){k(),tf(e4.SECURITY_SCANNER_PANE)},[k]),U=(0,F.useMemo)(function(){var e;return null!=(e=null==b?void 0:b.filter(function(e){return!e.ignored}))?e:[]},[b]),G=(0,F.useMemo)(function(){var e;return null!=(e=null==b?void 0:b.filter(function(e){return e.ignored}))?e:[]},[b]);return(0,V.jsxs)(eS.View,{justify:"space-between",grow:!0,height:"100%",px:32,py:16,align:"center",clsx:np.default.root,children:[(0,V.jsxs)(eS.View,{gap:16,grow:!0,style:{width:"100%"},children:[(0,V.jsxs)(eS.View,{row:!0,gap:8,align:"start",children:[y?(0,V.jsx)(eO.Text,{variant:"headerDefault",children:"Security and Privacy Scanner"}):(0,V.jsx)(eO.Text,{variant:"headerDefault",children:"Security Scanner"}),(0,V.jsx)(eS.View,{pt:4,children:(0,V.jsx)(tY.Pill,{colorway:"primary",text:"Beta",variant:"filled"})})]}),(0,V.jsxs)(eO.Text,{variant:"small",color:"dimmer",children:["Run a scan to check for potential security risks"," ",y?" and privacy leaks":""," in your application. Scans are typically complete within minutes."," ",(0,V.jsx)("a",{href:"https://docs.replit.com/replit-workspace/workspace-features/security-scanner",target:"_blank",children:"Learn more"})]}),(0,V.jsxs)(eS.View,{row:!0,align:"start",gap:8,children:[(0,V.jsx)(tB.Button,{colorway:"primary",text:_?"Scanning for vulnerabilities":"Run scan",iconLeft:_?(0,V.jsx)(tI.default,{}):(0,V.jsx)(tX.default,{}),loading:_,onClick:L}),y?(0,V.jsx)(tB.Button,{text:"Scan settings",iconLeft:(0,V.jsx)(nf.default,{}),onClick:function(){return P(function(e){return!e})}}):null]}),A?(0,V.jsxs)(eD.Surface,{background:"default",clsx:np.default.scanSettingSurface,p:6,gap:6,children:[(0,V.jsxs)(eS.View,{row:!0,justify:"space-between",children:[(0,V.jsx)(eO.Text,{clsx:np.default.scanSettingTitleText,children:"Scan Settings"}),(0,V.jsx)(eA.IconButton,{alt:"Dismiss scan setting",onClick:function(){return P(!1)},children:(0,V.jsx)(nc.default,{})})]}),(0,V.jsxs)(eS.View,{row:!0,justify:"space-between",children:[(0,V.jsx)(eO.Text,{children:"Enable privacy vulnerability detection"}),(0,V.jsx)(ns.Switch,{size:"small","aria-label":"Enable privacy vulnerability detection",isSelected:E,onChange:function(e){return R(e)}})]}),(0,V.jsxs)(eS.View,{row:!0,justify:"space-between",children:[(0,V.jsx)(eO.Text,{children:"Enable security vulnerability detection"}),(0,V.jsx)(ns.Switch,{size:"small","aria-label":"Enable security vulnerability detection",isSelected:j,onChange:function(e){return T(e)}})]})]}):null,(0,V.jsx)(nl.Tabs,{children:(0,V.jsxs)(eS.View,{pb:8,children:[(0,V.jsxs)(nl.TabList,{withUnderline:!0,children:[(0,V.jsx)(nl.Tab,{id:"active-issues",children:"Active Issues"}),(0,V.jsx)(nl.Tab,{id:"hidden-issues",children:"Hidden Issues"})]}),(0,V.jsxs)(nl.TabPanels,{children:[(0,V.jsxs)(nl.TabPanel,{id:"active-issues",children:[null!==b&&w?(0,V.jsx)(V.Fragment,{children:(0,V.jsx)(nv,{count:b?U.filter(function(e){return e.status===tp.Pending&&(e.type!==e8.Dependency||e.fix.available)}).length:0,timestamp:w,openPane:m})}):null,0===U.length?null:(0,V.jsx)(ne,{isScanning:_,isUpdatingDependencies:S,scanResult:U,currentAgentSession:N,onUpdateDependencies:null!=C?C:void 0,openAgentSession:function(e){return g(e.id)},onFixWithAgent:D?M:void 0})]}),(0,V.jsx)(nl.TabPanel,{id:"hidden-issues",children:(0,V.jsx)(eS.View,{clsx:np.default.ignoredIssuesContainer,children:0===G.length?(0,V.jsx)(V.Fragment,{children:(0,V.jsx)(eO.Text,{className:np.default.ignoredIssuesText,children:"No hidden issues found."})}):(0,V.jsx)(ne,{isScanning:_,isUpdatingDependencies:S,scanResult:G,currentAgentSession:N,onUpdateDependencies:null!=C?C:void 0,openAgentSession:function(e){return g(e.id)},onFixWithAgent:D?M:void 0})})})]})]})})]}),(0,V.jsx)(t9.DividerH,{}),(0,V.jsx)(tb,{})]})};function nv(e){var t=e.count,n=e.timestamp,r=e.openPane,i="No vulnerabilities found.";return 1===t?i="1 potential vulnerability found.":t>1&&(i="".concat(t," potential vulnerabilities found.")),(0,V.jsxs)(eS.View,{gap:4,clsx:np.default.lastScanSummaryContainer,children:[(0,V.jsxs)(eS.View,{row:!0,wrap:!0,gap:4,children:[(0,V.jsx)(eO.Text,{clsx:np.default.lastScanSummaryText,children:i}),0===t?(0,V.jsxs)(eS.View,{gap:4,row:!0,children:[(0,V.jsx)(eO.Text,{color:"dimmer",children:"Ready to deploy?"}),(0,V.jsx)(tB.Button,{colorway:"blue",variant:"underlinedOnHover",text:"Go back to Deployments",onClick:function(){r({type:"deployments"}),(0,e5.track)(e6.events.SECURITY_SCAN,{action:"deployment_pane_redirected"})}})]}):null]}),(0,V.jsxs)(eS.View,{row:!0,children:[(0,V.jsx)(eO.Text,{variant:"small",color:"dimmer",children:"Last ran on"}),"",(0,V.jsx)(nu.Timestamp,{date:n,textVariant:"small",textColor:"dimmer",dateFormat:"absolute"})]})]})}function nx(){return{codeEditor:c.codeEditorUI,webview:D.webviewUI,media:_.mediaUI,binary:u.binaryUI,vnc:P.vncUI,adminPanel:a.adminPanelUI,runnerOutput:R.runnerOutputUI,shell:I.shellUI,envEditor:g.envEditorUI,draw:h.drawUI,git:x.gitUI,diff:p.diffUI,history:y.historyUI,database:w.kvStoreUI,neon:S.neonUI,markdown:k.markdownPreviewUi,csvPreview:d.csvPreviewUI,ghostwriterChat:m.ghostwriterChatUI,objectStorage:C.objectStorageUI,workflows:O.workflowsUI,project:T.projectUI,agentFiles:s.agentFilesUI,integrations:b.integrationsUI,videoPlayer:A.videoPlayerUI,replitAuth:E.replitAuthUI,securityScan:ng,preferences:j.preferencesUI,automations:l.automationsUI,file:e0,developer:f.developerUI}}e.s(["createPaneUIConfig",()=>nx],835109);var ny=e.i(149818),nb=e.i(529131);function nw(e){(0,nb.default)(1,arguments);var t=(0,ny.default)(e);return t.setMinutes(0,0,0),t}var nk=e.i(716499),n_=e.i(998719);function nS(e,t){(0,nb.default)(2,arguments);var n=(0,nk.default)(t);return(0,n_.default)(e,-n)}e.s(["subHours",()=>nS],491637);var nC=e.i(571926),nj=e.i(604957),nT=e.i(100915),nE=e.i(569384),nR=e.i(973245),nI=e.i(304277);function nA(){var e=(0,nE._)(["\n  fragment ReplAnalyticsDurationResult on ReplAnalyticsDuration {\n    __typename\n    results {\n      __typename\n      value\n      count\n    }\n  }\n"]);return nA=function(){return e},e}function nP(){var e=(0,nE._)(["\n  query ReplAnalyticsDuration(\n    $id: String!\n    $input: ReplAnalyticsDurationInput!\n  ) {\n    getRepl(id: $id) {\n      ... on Repl {\n        __typename\n        id\n        analyticsDuration(input: $input) {\n          ... on ReplAnalyticsDuration {\n            ...ReplAnalyticsDurationResult\n          }\n          ... on NotFoundError {\n            __typename\n            message\n          }\n          ... on UserError {\n            __typename\n            message\n          }\n        }\n      }\n      ... on Error {\n        message\n      }\n    }\n  }\n  ","\n"]);return nP=function(){return e},e}e.i(566901);var nD={},nO=(0,nR.gql)(nA()),nN=(0,nR.gql)(nP(),nO),nM=e.i(967629),nL=e.i(703774),nB=e.i(613355),nV=(0,nM.css)([nB.rcss.maxHeight(320),nB.rcss.minHeight(240),{aspectRatio:"2 / 1"}]);function nF(){var e=(0,nL.useTheme)().values;return{animation:{duration:0},backgroundColor:e.global.backgroundHigher,borderColor:e.global.outlineDimmer,borderWidth:1,titleFont:{family:"'IBM Plex Sans', sans-serif"},titleColor:e.global.foregroundDimmest,bodyFont:{family:"'IBM Plex Sans', sans-serif"},bodyColor:e.global.foregroundDimmest,footerFont:{family:"'IBM Plex Sans', sans-serif"},footerColor:e.global.foregroundDimmest,padding:8,cornerRadius:6}}var nU=e.i(6338),nG=e.i(396776),n$=function(e){var t=e.data;nT.Chart.register(nT.BarElement);var n=(0,nL.useTheme)().values;return(0,V.jsx)(nj.Bar,{options:{responsive:!0,maintainAspectRatio:!1,datasets:{bar:{categoryPercentage:1,barPercentage:1}},plugins:{tooltip:nF()},scales:{y:{title:{display:!0,text:"# Requests",color:n.global.foregroundDimmer,font:{family:"'IBM Plex Sans', sans-serif"}},ticks:{font:{family:"'IBM Plex Sans', sans-serif"},color:n.global.foregroundDimmer,callback:function(e){if("number"==typeof e&&Math.floor(e)===e)return e}},grid:{color:n.global.outlineDimmest}},x:{title:{font:{family:"'IBM Plex Sans', sans-serif"},display:!0,text:"Duration (ms)",color:n.global.foregroundDimmer},ticks:{autoSkip:!1,maxRotation:20,color:n.global.foregroundDimmer,font:{family:"'IBM Plex Sans', sans-serif"}},grid:{color:n.global.outlineDimmest}}}},data:{labels:t.results.map(function(e){var t=e.value.replace("ms","").split("-"),n=t[t.length-1];return n.includes("s+")?n.replace("s+","000+"):"< "+n}),datasets:[{borderWidth:0,data:t.results.map(function(e){return e.count}),backgroundColor:Array(t.results.length).fill(n.global.tealDefault)}]}})};let nz=function(e){var t,n,r,i,o=e.replId,a=e.start,s=e.hours,l=(0,B._)((0,F.useState)(void 0),2),u=l[0],c=l[1],d=(t={variables:{id:o,input:{start:a,hours:s,deployment:!0}},ssr:!1,onCompleted:function(e){if("Repl"===e.getRepl.__typename)switch(e.getRepl.analyticsDuration.__typename){case"UserError":case"NotFoundError":c(Error(e.getRepl.analyticsDuration.message))}}},n=(0,N._)({},nD,t),nI.useQuery(nN,n)),f=d.data,p=d.loading,h=d.error;return h&&c(h),(0,V.jsxs)(eS.View,{gap:8,children:[(0,V.jsx)(eO.Text,{variant:"subheadDefault",children:"Request Durations (ms)"}),(0,V.jsxs)(eS.View,{children:[p?(0,V.jsx)(eS.View,{css:[nV,nB.rcss.borderRadius(),nU.loadingStyle.backgroundPulse()]}):null,u?(0,V.jsx)(nG.StatusBanner,{text:u.message,colorway:"negative"}):null,(null==f||null==(r=f.getRepl)?void 0:r.__typename)==="Repl"&&(null==(i=f.getRepl.analyticsDuration)?void 0:i.__typename)==="ReplAnalyticsDuration"?(0,V.jsx)(eS.View,{css:nV,children:(0,V.jsx)(n$,{data:f.getRepl.analyticsDuration})}):null]})]})};var nH=e.i(233760);function nW(){var e=(0,nE._)(["\n  fragment ReplAnalyticsPageViewDataPoint on ReplAnalyticsPageViewsData {\n    __typename\n    timestamp\n    success\n    failure\n  }\n"]);return nW=function(){return e},e}function nq(){var e=(0,nE._)(["\n  fragment ReplAnalyticsPageViews on ReplAnalyticsPageViews {\n    __typename\n    uniques\n    results {\n      ...ReplAnalyticsPageViewDataPoint\n    }\n  }\n  ","\n"]);return nq=function(){return e},e}function nK(){var e=(0,nE._)(["\n  query ReplAnalyticsPageViews(\n    $id: String!\n    $input: ReplAnalyticsPageViewsInput!\n  ) {\n    getRepl(id: $id) {\n      ... on Repl {\n        __typename\n        id\n        analyticsPageViews(input: $input) {\n          ... on ReplAnalyticsPageViews {\n            ...ReplAnalyticsPageViews\n          }\n          ... on NotFoundError {\n            __typename\n            message\n          }\n          ... on UserError {\n            __typename\n            message\n          }\n        }\n      }\n      ... on Error {\n        message\n      }\n    }\n  }\n  ","\n"]);return nK=function(){return e},e}var nY={},nQ=(0,nR.gql)(nW()),nX=(0,nR.gql)(nq(),nQ),nJ=(0,nR.gql)(nK(),nX),nZ=e.i(417751),n0=e.i(814744);nT.Chart.register(nT.CategoryScale,nT.LinearScale,nT.PointElement,nT.LineElement,nT.Tooltip);let n1=function(e){var t=e.labels,n=e.datasets,r=e.maintainAspectRatio,i=e.yAxisLabel,o=e.xAxisLabel,a=e.unit,s=(0,nL.useTheme)().values,l={labels:t.map(function(e){return e.toISOString()}),datasets:n.map(function(e){return(0,M._)((0,N._)({},e),{data:e.data.map(function(e){var t=e.x,n=e.y;return{x:t.toISOString(),y:n}}),pointRadius:.5,tension:.1})})},u=t.length;return(0,V.jsx)(nj.Line,{options:{clip:4,interaction:{mode:"nearest",intersect:!1},transitions:{active:{animation:{duration:0}}},elements:{point:{hoverRadius:4},line:{borderWidth:2}},responsive:!0,maintainAspectRatio:void 0===r||r,plugins:{tooltip:(0,M._)((0,N._)({},nF()),{callbacks:{title:function(e){var t=new Date(e[0].label);return(0,nZ.format)(t,"MMM d, HH:mm (z)")}}})},scales:{y:{title:{display:!0,text:void 0===i?"# Requests":i,color:s.global.foregroundDimmer,font:{family:"'IBM Plex Sans', sans-serif"}},grid:{color:s.global.outlineDimmest},ticks:{font:{family:"'IBM Plex Sans', sans-serif"},color:s.global.foregroundDimmer,callback:function(e){if("number"==typeof e&&Math.floor(e)===e)return a?"".concat(e).concat(a):e}},min:0},x:{title:{display:!0,text:void 0===o?"Time":o,color:s.global.foregroundDimmer,font:{family:"'IBM Plex Sans', sans-serif"}},grid:{color:s.global.outlineDimmest},ticks:{font:{family:"'IBM Plex Sans', sans-serif"},color:s.global.foregroundDimmer,callback:function(e,n){var r=t[n];if(u<=24){if(r.getHours()%4!=0)return;return(0,nZ.format)(r,"HH:mm")}if(r.toISOString()===(0,n0.startOfDay)(r).toISOString())return(0,nZ.format)(r,"MMM d")}}}}},data:l})};var n2=function(e){var t=e.data,n=e.start,r=e.hours,i=(0,nL.useTheme)().values,o=Array(r).fill(0).map(function(e,t){return(0,nH.addHours)(n,t)}),a=t.results.reduce(function(e,t){return e.set(t.timestamp,t),e},new Map),s=[{label:"Connected",data:o.map(function(e){var t;return{y:(null!=(t=a.get(e.toISOString()))?t:{success:0}).success,x:e}}),borderColor:i.global.accentPrimaryStronger,backgroundColor:i.global.accentPrimaryStronger},{label:"Failed",data:o.map(function(e){var t;return{y:(null!=(t=a.get(e.toISOString()))?t:{failure:0}).failure,x:e}}),borderColor:i.global.accentNegativeStronger,backgroundColor:i.global.accentNegativeStronger}];return(0,V.jsx)(n1,{labels:o,datasets:s,maintainAspectRatio:!1})};let n3=function(e){var t,n,r,i,o=e.replId,a=e.start,s=e.hours,l=(0,B._)((0,F.useState)(void 0),2),u=l[0],c=l[1],d=(t={variables:{id:o,input:{start:a,hours:s,deployment:!0}},ssr:!1,onCompleted:function(e){if("Repl"===e.getRepl.__typename)switch(e.getRepl.analyticsPageViews.__typename){case"UserError":case"NotFoundError":c(Error(e.getRepl.analyticsPageViews.message))}}},n=(0,N._)({},nY,t),nI.useQuery(nJ,n)),f=d.data,p=d.loading,h=d.error,g=(null==f||null==(r=f.getRepl)?void 0:r.__typename)==="Repl"&&(null==(i=f.getRepl.analyticsPageViews)?void 0:i.__typename)==="ReplAnalyticsPageViews"?f.getRepl.analyticsPageViews:void 0,m=g?g.uniques:void 0;return h&&c(h),(0,V.jsxs)(eS.View,{gap:8,children:[(0,V.jsxs)(eS.View,{row:!0,align:"center",justify:"space-between",children:[(0,V.jsx)(eO.Text,{variant:"subheadDefault",multiline:!1,children:"Requests"}),m?(0,V.jsxs)(eO.Text,{multiline:!1,children:[(0,V.jsx)("strong",{children:m})," unique IP addresses"]}):null]}),(0,V.jsxs)(eS.View,{children:[p?(0,V.jsx)(eS.View,{css:[nB.rcss.width("100%"),nV,nB.rcss.borderRadius(),nU.loadingStyle.backgroundPulse()]}):null,u?(0,V.jsx)(nG.StatusBanner,{text:u.message,colorway:"negative"}):null,g?(0,V.jsx)(eS.View,{css:nV,children:(0,V.jsx)(n2,{data:g,start:a,hours:s})}):null]})]})};function n4(){var e=(0,nE._)(["\n  fragment ReplAnalyticsTimeSeriesDataPoint on ReplAnalyticsTimeSeriesData {\n    __typename\n    timestamp\n    value\n    count\n    unit\n  }\n"]);return n4=function(){return e},e}function n8(){var e=(0,nE._)(["\n  fragment ReplAnalyticsTimeSeries on ReplAnalyticsTimeSeries {\n    __typename\n    results {\n      ...ReplAnalyticsTimeSeriesDataPoint\n    }\n  }\n  ","\n"]);return n8=function(){return e},e}function n5(){var e=(0,nE._)(["\n  query ReplAnalyticsTimeSeries(\n    $id: String!\n    $input: ReplAnalyticsTimeSeriesInput!\n  ) {\n    getRepl(id: $id) {\n      ... on Repl {\n        __typename\n        id\n        analyticsTimeSeries(input: $input) {\n          ... on ReplAnalyticsTimeSeries {\n            ...ReplAnalyticsTimeSeries\n          }\n          ... on NotFoundError {\n            __typename\n            message\n          }\n          ... on UserError {\n            __typename\n            message\n          }\n        }\n      }\n      ... on Error {\n        message\n      }\n    }\n  }\n  ","\n"]);return n5=function(){return e},e}var n6={},n9=(0,nR.gql)(n4()),n7=(0,nR.gql)(n8(),n9),re=(0,nR.gql)(n5(),n7),rt=e.i(167626),rn=e.i(530929),rr=e.i(781862),ri=e.i(9231),ro=e.i(661998),ra=e.i(254878),rs=e.i(160771),rl=e.i(999128);function ru(e,t,n){(0,nb.default)(2,arguments);var r=n||{},i=r.locale,o=i&&i.options&&i.options.weekStartsOn,a=null==o?0:(0,nk.default)(o),s=null==r.weekStartsOn?a:(0,nk.default)(r.weekStartsOn);if(!(s>=0&&s<=6))throw RangeError("weekStartsOn must be between 0 and 6 inclusively");var l=(0,ny.default)(e),u=(0,nk.default)(t),c=7*((u%7+7)%7<s)+u-l.getUTCDay();return l.setUTCDate(l.getUTCDate()+c),l}var rc=e.i(135518),rd=e.i(273047),rf=e.i(971329),rp=e.i(957289),rh=/^(1[0-2]|0?\d)/,rg=/^(3[0-1]|[0-2]?\d)/,rm=/^(36[0-6]|3[0-5]\d|[0-2]?\d?\d)/,rv=/^(5[0-3]|[0-4]?\d)/,rx=/^(2[0-3]|[0-1]?\d)/,ry=/^(2[0-4]|[0-1]?\d)/,rb=/^(1[0-1]|0?\d)/,rw=/^(1[0-2]|0?\d)/,rk=/^[0-5]?\d/,r_=/^[0-5]?\d/,rS=/^\d/,rC=/^\d{1,2}/,rj=/^\d{1,3}/,rT=/^\d{1,4}/,rE=/^-?\d+/,rR=/^-?\d/,rI=/^-?\d{1,2}/,rA=/^-?\d{1,3}/,rP=/^-?\d{1,4}/,rD=/^([+-])(\d{2})(\d{2})?|Z/,rO=/^([+-])(\d{2})(\d{2})|Z/,rN=/^([+-])(\d{2})(\d{2})((\d{2}))?|Z/,rM=/^([+-])(\d{2}):(\d{2})|Z/,rL=/^([+-])(\d{2}):(\d{2})(:(\d{2}))?|Z/;function rB(e,t,n){var r=t.match(e);if(!r)return null;var i=parseInt(r[0],10);return{value:n?n(i):i,rest:t.slice(r[0].length)}}function rV(e,t){var n=t.match(e);return n?"Z"===n[0]?{value:0,rest:t.slice(1)}:{value:("+"===n[1]?1:-1)*((n[2]?parseInt(n[2],10):0)*36e5+(n[3]?parseInt(n[3],10):0)*6e4+(n[5]?parseInt(n[5],10):0)*1e3),rest:t.slice(n[0].length)}:null}function rF(e,t,n){switch(e){case 1:return rB(rS,t,n);case 2:return rB(rC,t,n);case 3:return rB(rj,t,n);case 4:return rB(rT,t,n);default:return rB(RegExp("^\\d{1,"+e+"}"),t,n)}}function rU(e,t,n){switch(e){case 1:return rB(rR,t,n);case 2:return rB(rI,t,n);case 3:return rB(rA,t,n);case 4:return rB(rP,t,n);default:return rB(RegExp("^-?\\d{1,"+e+"}"),t,n)}}function rG(e){switch(e){case"morning":return 4;case"evening":return 17;case"pm":case"noon":case"afternoon":return 12;default:return 0}}function r$(e,t){var n,r=t>0,i=r?t:1-t;if(i<=50)n=e||100;else{var o=i+50;n=e+100*Math.floor(o/100)-100*(e>=o%100)}return r?n:1-n}var rz=[31,28,31,30,31,30,31,31,30,31,30,31],rH=[31,29,31,30,31,30,31,31,30,31,30,31];function rW(e){return e%400==0||e%4==0&&e%100!=0}let rq={G:{priority:140,parse:function(e,t,n,r){switch(t){case"G":case"GG":case"GGG":return n.era(e,{width:"abbreviated"})||n.era(e,{width:"narrow"});case"GGGGG":return n.era(e,{width:"narrow"});default:return n.era(e,{width:"wide"})||n.era(e,{width:"abbreviated"})||n.era(e,{width:"narrow"})}},set:function(e,t,n,r){return t.era=n,e.setUTCFullYear(n,0,1),e.setUTCHours(0,0,0,0),e},incompatibleTokens:["R","u","t","T"]},y:{priority:130,parse:function(e,t,n,r){var i=function(e){return{year:e,isTwoDigitYear:"yy"===t}};switch(t){case"y":return rF(4,e,i);case"yo":return n.ordinalNumber(e,{unit:"year",valueCallback:i});default:return rF(t.length,e,i)}},validate:function(e,t,n){return t.isTwoDigitYear||t.year>0},set:function(e,t,n,r){var i=e.getUTCFullYear();if(n.isTwoDigitYear){var o=r$(n.year,i);return e.setUTCFullYear(o,0,1),e.setUTCHours(0,0,0,0),e}var a="era"in t&&1!==t.era?1-n.year:n.year;return e.setUTCFullYear(a,0,1),e.setUTCHours(0,0,0,0),e},incompatibleTokens:["Y","R","u","w","I","i","e","c","t","T"]},Y:{priority:130,parse:function(e,t,n,r){var i=function(e){return{year:e,isTwoDigitYear:"YY"===t}};switch(t){case"Y":return rF(4,e,i);case"Yo":return n.ordinalNumber(e,{unit:"year",valueCallback:i});default:return rF(t.length,e,i)}},validate:function(e,t,n){return t.isTwoDigitYear||t.year>0},set:function(e,t,n,r){var i=(0,rl.default)(e,r);if(n.isTwoDigitYear){var o=r$(n.year,i);return e.setUTCFullYear(o,0,r.firstWeekContainsDate),e.setUTCHours(0,0,0,0),(0,rp.default)(e,r)}var a="era"in t&&1!==t.era?1-n.year:n.year;return e.setUTCFullYear(a,0,r.firstWeekContainsDate),e.setUTCHours(0,0,0,0),(0,rp.default)(e,r)},incompatibleTokens:["y","R","u","Q","q","M","L","I","d","D","i","t","T"]},R:{priority:130,parse:function(e,t,n,r){return"R"===t?rU(4,e):rU(t.length,e)},set:function(e,t,n,r){var i=new Date(0);return i.setUTCFullYear(n,0,4),i.setUTCHours(0,0,0,0),(0,rf.default)(i)},incompatibleTokens:["G","y","Y","u","Q","q","M","L","w","d","D","e","c","t","T"]},u:{priority:130,parse:function(e,t,n,r){return"u"===t?rU(4,e):rU(t.length,e)},set:function(e,t,n,r){return e.setUTCFullYear(n,0,1),e.setUTCHours(0,0,0,0),e},incompatibleTokens:["G","y","Y","R","w","I","i","e","c","t","T"]},Q:{priority:120,parse:function(e,t,n,r){switch(t){case"Q":case"QQ":return rF(t.length,e);case"Qo":return n.ordinalNumber(e,{unit:"quarter"});case"QQQ":return n.quarter(e,{width:"abbreviated",context:"formatting"})||n.quarter(e,{width:"narrow",context:"formatting"});case"QQQQQ":return n.quarter(e,{width:"narrow",context:"formatting"});default:return n.quarter(e,{width:"wide",context:"formatting"})||n.quarter(e,{width:"abbreviated",context:"formatting"})||n.quarter(e,{width:"narrow",context:"formatting"})}},validate:function(e,t,n){return t>=1&&t<=4},set:function(e,t,n,r){return e.setUTCMonth((n-1)*3,1),e.setUTCHours(0,0,0,0),e},incompatibleTokens:["Y","R","q","M","L","w","I","d","D","i","e","c","t","T"]},q:{priority:120,parse:function(e,t,n,r){switch(t){case"q":case"qq":return rF(t.length,e);case"qo":return n.ordinalNumber(e,{unit:"quarter"});case"qqq":return n.quarter(e,{width:"abbreviated",context:"standalone"})||n.quarter(e,{width:"narrow",context:"standalone"});case"qqqqq":return n.quarter(e,{width:"narrow",context:"standalone"});default:return n.quarter(e,{width:"wide",context:"standalone"})||n.quarter(e,{width:"abbreviated",context:"standalone"})||n.quarter(e,{width:"narrow",context:"standalone"})}},validate:function(e,t,n){return t>=1&&t<=4},set:function(e,t,n,r){return e.setUTCMonth((n-1)*3,1),e.setUTCHours(0,0,0,0),e},incompatibleTokens:["Y","R","Q","M","L","w","I","d","D","i","e","c","t","T"]},M:{priority:110,parse:function(e,t,n,r){var i=function(e){return e-1};switch(t){case"M":return rB(rh,e,i);case"MM":return rF(2,e,i);case"Mo":return n.ordinalNumber(e,{unit:"month",valueCallback:i});case"MMM":return n.month(e,{width:"abbreviated",context:"formatting"})||n.month(e,{width:"narrow",context:"formatting"});case"MMMMM":return n.month(e,{width:"narrow",context:"formatting"});default:return n.month(e,{width:"wide",context:"formatting"})||n.month(e,{width:"abbreviated",context:"formatting"})||n.month(e,{width:"narrow",context:"formatting"})}},validate:function(e,t,n){return t>=0&&t<=11},set:function(e,t,n,r){return e.setUTCMonth(n,1),e.setUTCHours(0,0,0,0),e},incompatibleTokens:["Y","R","q","Q","L","w","I","D","i","e","c","t","T"]},L:{priority:110,parse:function(e,t,n,r){var i=function(e){return e-1};switch(t){case"L":return rB(rh,e,i);case"LL":return rF(2,e,i);case"Lo":return n.ordinalNumber(e,{unit:"month",valueCallback:i});case"LLL":return n.month(e,{width:"abbreviated",context:"standalone"})||n.month(e,{width:"narrow",context:"standalone"});case"LLLLL":return n.month(e,{width:"narrow",context:"standalone"});default:return n.month(e,{width:"wide",context:"standalone"})||n.month(e,{width:"abbreviated",context:"standalone"})||n.month(e,{width:"narrow",context:"standalone"})}},validate:function(e,t,n){return t>=0&&t<=11},set:function(e,t,n,r){return e.setUTCMonth(n,1),e.setUTCHours(0,0,0,0),e},incompatibleTokens:["Y","R","q","Q","M","w","I","D","i","e","c","t","T"]},w:{priority:100,parse:function(e,t,n,r){switch(t){case"w":return rB(rv,e);case"wo":return n.ordinalNumber(e,{unit:"week"});default:return rF(t.length,e)}},validate:function(e,t,n){return t>=1&&t<=53},set:function(e,t,n,r){return(0,rp.default)(function(e,t,n){(0,nb.default)(2,arguments);var r=(0,ny.default)(e),i=(0,nk.default)(t),o=(0,rd.default)(r,n)-i;return r.setUTCDate(r.getUTCDate()-7*o),r}(e,n,r),r)},incompatibleTokens:["y","R","u","q","Q","M","L","I","d","D","i","t","T"]},I:{priority:100,parse:function(e,t,n,r){switch(t){case"I":return rB(rv,e);case"Io":return n.ordinalNumber(e,{unit:"week"});default:return rF(t.length,e)}},validate:function(e,t,n){return t>=1&&t<=53},set:function(e,t,n,r){return(0,rf.default)(function(e,t){(0,nb.default)(2,arguments);var n=(0,ny.default)(e),r=(0,nk.default)(t),i=(0,rc.default)(n)-r;return n.setUTCDate(n.getUTCDate()-7*i),n}(e,n,r),r)},incompatibleTokens:["y","Y","u","q","Q","M","L","w","d","D","e","c","t","T"]},d:{priority:90,subPriority:1,parse:function(e,t,n,r){switch(t){case"d":return rB(rg,e);case"do":return n.ordinalNumber(e,{unit:"date"});default:return rF(t.length,e)}},validate:function(e,t,n){var r=rW(e.getUTCFullYear()),i=e.getUTCMonth();return r?t>=1&&t<=rH[i]:t>=1&&t<=rz[i]},set:function(e,t,n,r){return e.setUTCDate(n),e.setUTCHours(0,0,0,0),e},incompatibleTokens:["Y","R","q","Q","w","I","D","i","e","c","t","T"]},D:{priority:90,subPriority:1,parse:function(e,t,n,r){switch(t){case"D":case"DD":return rB(rm,e);case"Do":return n.ordinalNumber(e,{unit:"date"});default:return rF(t.length,e)}},validate:function(e,t,n){return rW(e.getUTCFullYear())?t>=1&&t<=366:t>=1&&t<=365},set:function(e,t,n,r){return e.setUTCMonth(0,n),e.setUTCHours(0,0,0,0),e},incompatibleTokens:["Y","R","q","Q","M","L","w","I","d","E","i","e","c","t","T"]},E:{priority:90,parse:function(e,t,n,r){switch(t){case"E":case"EE":case"EEE":return n.day(e,{width:"abbreviated",context:"formatting"})||n.day(e,{width:"short",context:"formatting"})||n.day(e,{width:"narrow",context:"formatting"});case"EEEEE":return n.day(e,{width:"narrow",context:"formatting"});case"EEEEEE":return n.day(e,{width:"short",context:"formatting"})||n.day(e,{width:"narrow",context:"formatting"});default:return n.day(e,{width:"wide",context:"formatting"})||n.day(e,{width:"abbreviated",context:"formatting"})||n.day(e,{width:"short",context:"formatting"})||n.day(e,{width:"narrow",context:"formatting"})}},validate:function(e,t,n){return t>=0&&t<=6},set:function(e,t,n,r){return(e=ru(e,n,r)).setUTCHours(0,0,0,0),e},incompatibleTokens:["D","i","e","c","t","T"]},e:{priority:90,parse:function(e,t,n,r){var i=function(e){var t=7*Math.floor((e-1)/7);return(e+r.weekStartsOn+6)%7+t};switch(t){case"e":case"ee":return rF(t.length,e,i);case"eo":return n.ordinalNumber(e,{unit:"day",valueCallback:i});case"eee":return n.day(e,{width:"abbreviated",context:"formatting"})||n.day(e,{width:"short",context:"formatting"})||n.day(e,{width:"narrow",context:"formatting"});case"eeeee":return n.day(e,{width:"narrow",context:"formatting"});case"eeeeee":return n.day(e,{width:"short",context:"formatting"})||n.day(e,{width:"narrow",context:"formatting"});default:return n.day(e,{width:"wide",context:"formatting"})||n.day(e,{width:"abbreviated",context:"formatting"})||n.day(e,{width:"short",context:"formatting"})||n.day(e,{width:"narrow",context:"formatting"})}},validate:function(e,t,n){return t>=0&&t<=6},set:function(e,t,n,r){return(e=ru(e,n,r)).setUTCHours(0,0,0,0),e},incompatibleTokens:["y","R","u","q","Q","M","L","I","d","D","E","i","c","t","T"]},c:{priority:90,parse:function(e,t,n,r){var i=function(e){var t=7*Math.floor((e-1)/7);return(e+r.weekStartsOn+6)%7+t};switch(t){case"c":case"cc":return rF(t.length,e,i);case"co":return n.ordinalNumber(e,{unit:"day",valueCallback:i});case"ccc":return n.day(e,{width:"abbreviated",context:"standalone"})||n.day(e,{width:"short",context:"standalone"})||n.day(e,{width:"narrow",context:"standalone"});case"ccccc":return n.day(e,{width:"narrow",context:"standalone"});case"cccccc":return n.day(e,{width:"short",context:"standalone"})||n.day(e,{width:"narrow",context:"standalone"});default:return n.day(e,{width:"wide",context:"standalone"})||n.day(e,{width:"abbreviated",context:"standalone"})||n.day(e,{width:"short",context:"standalone"})||n.day(e,{width:"narrow",context:"standalone"})}},validate:function(e,t,n){return t>=0&&t<=6},set:function(e,t,n,r){return(e=ru(e,n,r)).setUTCHours(0,0,0,0),e},incompatibleTokens:["y","R","u","q","Q","M","L","I","d","D","E","i","e","t","T"]},i:{priority:90,parse:function(e,t,n,r){var i=function(e){return 0===e?7:e};switch(t){case"i":case"ii":return rF(t.length,e);case"io":return n.ordinalNumber(e,{unit:"day"});case"iii":return n.day(e,{width:"abbreviated",context:"formatting",valueCallback:i})||n.day(e,{width:"short",context:"formatting",valueCallback:i})||n.day(e,{width:"narrow",context:"formatting",valueCallback:i});case"iiiii":return n.day(e,{width:"narrow",context:"formatting",valueCallback:i});case"iiiiii":return n.day(e,{width:"short",context:"formatting",valueCallback:i})||n.day(e,{width:"narrow",context:"formatting",valueCallback:i});default:return n.day(e,{width:"wide",context:"formatting",valueCallback:i})||n.day(e,{width:"abbreviated",context:"formatting",valueCallback:i})||n.day(e,{width:"short",context:"formatting",valueCallback:i})||n.day(e,{width:"narrow",context:"formatting",valueCallback:i})}},validate:function(e,t,n){return t>=1&&t<=7},set:function(e,t,n,r){return(e=function(e,t){(0,nb.default)(2,arguments);var n=(0,nk.default)(t);n%7==0&&(n-=7);var r=(0,ny.default)(e),i=7*((n%7+7)%7<1)+n-r.getUTCDay();return r.setUTCDate(r.getUTCDate()+i),r}(e,n,r)).setUTCHours(0,0,0,0),e},incompatibleTokens:["y","Y","u","q","Q","M","L","w","d","D","E","e","c","t","T"]},a:{priority:80,parse:function(e,t,n,r){switch(t){case"a":case"aa":case"aaa":return n.dayPeriod(e,{width:"abbreviated",context:"formatting"})||n.dayPeriod(e,{width:"narrow",context:"formatting"});case"aaaaa":return n.dayPeriod(e,{width:"narrow",context:"formatting"});default:return n.dayPeriod(e,{width:"wide",context:"formatting"})||n.dayPeriod(e,{width:"abbreviated",context:"formatting"})||n.dayPeriod(e,{width:"narrow",context:"formatting"})}},set:function(e,t,n,r){return e.setUTCHours(rG(n),0,0,0),e},incompatibleTokens:["b","B","H","K","k","t","T"]},b:{priority:80,parse:function(e,t,n,r){switch(t){case"b":case"bb":case"bbb":return n.dayPeriod(e,{width:"abbreviated",context:"formatting"})||n.dayPeriod(e,{width:"narrow",context:"formatting"});case"bbbbb":return n.dayPeriod(e,{width:"narrow",context:"formatting"});default:return n.dayPeriod(e,{width:"wide",context:"formatting"})||n.dayPeriod(e,{width:"abbreviated",context:"formatting"})||n.dayPeriod(e,{width:"narrow",context:"formatting"})}},set:function(e,t,n,r){return e.setUTCHours(rG(n),0,0,0),e},incompatibleTokens:["a","B","H","K","k","t","T"]},B:{priority:80,parse:function(e,t,n,r){switch(t){case"B":case"BB":case"BBB":return n.dayPeriod(e,{width:"abbreviated",context:"formatting"})||n.dayPeriod(e,{width:"narrow",context:"formatting"});case"BBBBB":return n.dayPeriod(e,{width:"narrow",context:"formatting"});default:return n.dayPeriod(e,{width:"wide",context:"formatting"})||n.dayPeriod(e,{width:"abbreviated",context:"formatting"})||n.dayPeriod(e,{width:"narrow",context:"formatting"})}},set:function(e,t,n,r){return e.setUTCHours(rG(n),0,0,0),e},incompatibleTokens:["a","b","t","T"]},h:{priority:70,parse:function(e,t,n,r){switch(t){case"h":return rB(rw,e);case"ho":return n.ordinalNumber(e,{unit:"hour"});default:return rF(t.length,e)}},validate:function(e,t,n){return t>=1&&t<=12},set:function(e,t,n,r){var i=e.getUTCHours()>=12;return i&&n<12?e.setUTCHours(n+12,0,0,0):i||12!==n?e.setUTCHours(n,0,0,0):e.setUTCHours(0,0,0,0),e},incompatibleTokens:["H","K","k","t","T"]},H:{priority:70,parse:function(e,t,n,r){switch(t){case"H":return rB(rx,e);case"Ho":return n.ordinalNumber(e,{unit:"hour"});default:return rF(t.length,e)}},validate:function(e,t,n){return t>=0&&t<=23},set:function(e,t,n,r){return e.setUTCHours(n,0,0,0),e},incompatibleTokens:["a","b","h","K","k","t","T"]},K:{priority:70,parse:function(e,t,n,r){switch(t){case"K":return rB(rb,e);case"Ko":return n.ordinalNumber(e,{unit:"hour"});default:return rF(t.length,e)}},validate:function(e,t,n){return t>=0&&t<=11},set:function(e,t,n,r){return e.getUTCHours()>=12&&n<12?e.setUTCHours(n+12,0,0,0):e.setUTCHours(n,0,0,0),e},incompatibleTokens:["a","b","h","H","k","t","T"]},k:{priority:70,parse:function(e,t,n,r){switch(t){case"k":return rB(ry,e);case"ko":return n.ordinalNumber(e,{unit:"hour"});default:return rF(t.length,e)}},validate:function(e,t,n){return t>=1&&t<=24},set:function(e,t,n,r){return e.setUTCHours(n<=24?n%24:n,0,0,0),e},incompatibleTokens:["a","b","h","H","K","t","T"]},m:{priority:60,parse:function(e,t,n,r){switch(t){case"m":return rB(rk,e);case"mo":return n.ordinalNumber(e,{unit:"minute"});default:return rF(t.length,e)}},validate:function(e,t,n){return t>=0&&t<=59},set:function(e,t,n,r){return e.setUTCMinutes(n,0,0),e},incompatibleTokens:["t","T"]},s:{priority:50,parse:function(e,t,n,r){switch(t){case"s":return rB(r_,e);case"so":return n.ordinalNumber(e,{unit:"second"});default:return rF(t.length,e)}},validate:function(e,t,n){return t>=0&&t<=59},set:function(e,t,n,r){return e.setUTCSeconds(n,0),e},incompatibleTokens:["t","T"]},S:{priority:30,parse:function(e,t,n,r){return rF(t.length,e,function(e){return Math.floor(e*Math.pow(10,-t.length+3))})},set:function(e,t,n,r){return e.setUTCMilliseconds(n),e},incompatibleTokens:["t","T"]},X:{priority:10,parse:function(e,t,n,r){switch(t){case"X":return rV(rD,e);case"XX":return rV(rO,e);case"XXXX":return rV(rN,e);case"XXXXX":return rV(rL,e);default:return rV(rM,e)}},set:function(e,t,n,r){return t.timestampIsSet?e:new Date(e.getTime()-n)},incompatibleTokens:["t","T","x"]},x:{priority:10,parse:function(e,t,n,r){switch(t){case"x":return rV(rD,e);case"xx":return rV(rO,e);case"xxxx":return rV(rN,e);case"xxxxx":return rV(rL,e);default:return rV(rM,e)}},set:function(e,t,n,r){return t.timestampIsSet?e:new Date(e.getTime()-n)},incompatibleTokens:["t","T","X"]},t:{priority:40,parse:function(e,t,n,r){return rB(rE,e,void 0)},set:function(e,t,n,r){return[new Date(1e3*n),{timestampIsSet:!0}]},incompatibleTokens:"*"},T:{priority:20,parse:function(e,t,n,r){return rB(rE,e,void 0)},set:function(e,t,n,r){return[new Date(n),{timestampIsSet:!0}]},incompatibleTokens:"*"}};var rK=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,rY=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,rQ=/^'([^]*?)'?$/,rX=/''/g,rJ=/\S/,rZ=/[a-zA-Z]/;function r0(e,t){if(t.timestampIsSet)return e;var n=new Date(0);return n.setFullYear(e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate()),n.setHours(e.getUTCHours(),e.getUTCMinutes(),e.getUTCSeconds(),e.getUTCMilliseconds()),n}var r1=e.i(760129),r2=e.i(310158),r3=e.i(674),r4=e.i(767428),r8=e.i(55721),r5=e.i(456317),r6=e.i(980768),r9=e.i(435575),r7=e.i(965078),ie=e.i(671662),it=e.i(771348),ir=e.i(199674),ii=e.i(351263),io=e.i(550470),io=io;function ia(e,t){(0,nb.default)(1,arguments);var n=t||{},r=n.locale,i=r&&r.options&&r.options.weekStartsOn,o=null==i?0:(0,nk.default)(i),a=null==n.weekStartsOn?o:(0,nk.default)(n.weekStartsOn);if(!(a>=0&&a<=6))throw RangeError("weekStartsOn must be between 0 and 6 inclusively");var s=(0,ny.default)(e),l=s.getDay();return s.setDate(s.getDate()-(7*(l<a)+l-a)),s.setHours(0,0,0,0),s}var is=e.i(975676),is=is,il=e.i(410960),il=il,iu={datetime:"MMM d, yyyy, h:mm:ss aaaa",millisecond:"h:mm:ss.SSS aaaa",second:"h:mm:ss aaaa",minute:"h:mm aaaa",hour:"ha",day:"MMM d",week:"PP",month:"MMM yyyy",quarter:"qqq - yyyy",year:"yyyy"};nT._adapters._date.override({_id:"date-fns",formats:function(){return iu},parse:function(e,t){if(null==e)return null;var n=void 0===e?"undefined":(0,nr._)(e);return"number"===n||(0,rt._)(e,Date)?e=(0,ny.default)(e):"string"===n&&(e="string"==typeof t?function(e,t,n,r){(0,nb.default)(3,arguments);var i,o=String(e),a=String(t),s=r||{},l=s.locale||rn.default;if(!l.match)throw RangeError("locale must contain match property");var u=l.options&&l.options.firstWeekContainsDate,c=null==u?1:(0,nk.default)(u),d=null==s.firstWeekContainsDate?c:(0,nk.default)(s.firstWeekContainsDate);if(!(d>=1&&d<=7))throw RangeError("firstWeekContainsDate must be between 1 and 7 inclusively");var f=l.options&&l.options.weekStartsOn,p=null==f?0:(0,nk.default)(f),h=null==s.weekStartsOn?p:(0,nk.default)(s.weekStartsOn);if(!(h>=0&&h<=6))throw RangeError("weekStartsOn must be between 0 and 6 inclusively");if(""===a)if(""===o)return(0,ny.default)(n);else return new Date(NaN);var g={firstWeekContainsDate:d,weekStartsOn:h,locale:l},m=[{priority:10,subPriority:-1,set:r0,index:0}],x=a.match(rY).map(function(e){var t=e[0];return"p"===t||"P"===t?(0,ro.default[t])(e,l.formatLong,g):e}).join("").match(rK),y=[];for(i=0;i<x.length;i++){var b=x[i];!s.useAdditionalWeekYearTokens&&(0,rs.isProtectedWeekYearToken)(b)&&(0,rs.throwProtectedError)(b,a,e),!s.useAdditionalDayOfYearTokens&&(0,rs.isProtectedDayOfYearToken)(b)&&(0,rs.throwProtectedError)(b,a,e);var w=b[0],k=rq[w];if(k){var _=k.incompatibleTokens;if(Array.isArray(_)){for(var S=void 0,C=0;C<y.length;C++){var j=y[C].token;if(-1!==_.indexOf(j)||j===w){S=y[C];break}}if(S)throw RangeError("The format string mustn't contain `".concat(S.fullToken,"` and `").concat(b,"` at the same time"))}else if("*"===k.incompatibleTokens&&y.length)throw RangeError("The format string mustn't contain `".concat(b,"` and any other token at the same time"));y.push({token:w,fullToken:b});var T=k.parse(o,b,l.match,g);if(!T)return new Date(NaN);m.push({priority:k.priority,subPriority:k.subPriority||0,set:k.set,validate:k.validate,value:T.value,index:m.length}),o=T.rest}else{if(w.match(rZ))throw RangeError("Format string contains an unescaped latin alphabet character `"+w+"`");if("''"===b?b="'":"'"===w&&(b=b.match(rQ)[1].replace(rX,"'")),0!==o.indexOf(b))return new Date(NaN);o=o.slice(b.length)}}if(o.length>0&&rJ.test(o))return new Date(NaN);var E=m.map(function(e){return e.priority}).sort(function(e,t){return t-e}).filter(function(e,t,n){return n.indexOf(e)===t}).map(function(e){return m.filter(function(t){return t.priority===e}).sort(function(e,t){return t.subPriority-e.subPriority})}).map(function(e){return e[0]}),R=(0,ny.default)(n);if(isNaN(R))return new Date(NaN);var I=(0,rr.default)(R,(0,ra.default)(R)),A={};for(i=0;i<E.length;i++){var P=E[i];if(P.validate&&!P.validate(I,P.value,g))return new Date(NaN);var D=P.set(I,A,P.value,g);D[0]?(I=D[0],(0,ri.default)(A,D[1])):I=D}return I}(e,t,new Date,this.options):(0,r1.parseISO)(e,this.options)),(0,r2.isValid)(e)?e.getTime():null},format:function(e,t){return(0,nZ.format)(e,t,this.options)},add:function(e,t,n){switch(n){case"millisecond":return(0,r6.default)(e,t);case"second":return(0,r9.addSeconds)(e,t);case"minute":return function(e,t){(0,nb.default)(2,arguments);var n=(0,nk.default)(t);return(0,r6.default)(e,6e4*n)}(e,t);case"hour":return(0,nH.addHours)(e,t);case"day":return(0,r5.addDays)(e,t);case"week":return function(e,t){(0,nb.default)(2,arguments);var n=(0,nk.default)(t);return(0,r8.default)(e,7*n)}(e,t);case"month":return(0,r4.addMonths)(e,t);case"quarter":return function(e,t){(0,nb.default)(2,arguments);var n=(0,nk.default)(t);return(0,r3.default)(e,3*n)}(e,t);case"year":return function(e,t){(0,nb.default)(2,arguments);var n=(0,nk.default)(t);return(0,r3.default)(e,12*n)}(e,t);default:return e}},diff:function(e,t,n){switch(n){case"millisecond":return(0,ii.default)(e,t);case"second":return(0,io.default)(e,t);case"minute":return function(e,t){(0,nb.default)(2,arguments);var n=(0,ii.default)(e,t)/6e4;return n>0?Math.floor(n):Math.ceil(n)}(e,t);case"hour":return function(e,t){(0,nb.default)(2,arguments);var n=(0,ii.default)(e,t)/36e5;return n>0?Math.floor(n):Math.ceil(n)}(e,t);case"day":return(0,ir.differenceInDays)(e,t);case"week":return function(e,t){(0,nb.default)(2,arguments);var n=(0,it.default)(e,t)/7;return n>0?Math.floor(n):Math.ceil(n)}(e,t);case"month":return(0,ie.default)(e,t);case"quarter":return function(e,t){(0,nb.default)(2,arguments);var n=(0,ie.default)(e,t)/3;return n>0?Math.floor(n):Math.ceil(n)}(e,t);case"year":return function(e,t){(0,nb.default)(2,arguments);var n=(0,ny.default)(e),r=(0,ny.default)(t),i=(0,r7.default)(n,r),o=Math.abs(function(e,t){(0,nb.default)(2,arguments);var n=(0,ny.default)(e),r=(0,ny.default)(t);return n.getFullYear()-r.getFullYear()}(n,r));n.setFullYear(1584),r.setFullYear(1584);var a=(0,r7.default)(n,r)===-i,s=i*(o-Number(a));return 0===s?0:s}(e,t);default:return 0}},startOf:function(e,t,n){switch(t){case"second":return function(e){(0,nb.default)(1,arguments);var t=(0,ny.default)(e);return t.setMilliseconds(0),t}(e);case"minute":return function(e){(0,nb.default)(1,arguments);var t=(0,ny.default)(e);return t.setSeconds(0,0),t}(e);case"hour":return nw(e);case"day":return(0,n0.startOfDay)(e);case"week":return ia(e);case"isoWeek":return ia(e,{weekStartsOn:+n});case"month":return function(e){(0,nb.default)(1,arguments);var t=(0,ny.default)(e);return t.setDate(1),t.setHours(0,0,0,0),t}(e);case"quarter":return function(e){(0,nb.default)(1,arguments);var t=(0,ny.default)(e),n=t.getMonth();return t.setMonth(n-n%3,1),t.setHours(0,0,0,0),t}(e);case"year":return function(e){(0,nb.default)(1,arguments);var t=(0,ny.default)(e),n=new Date(0);return n.setFullYear(t.getFullYear(),0,1),n.setHours(0,0,0,0),n}(e);default:return e}},endOf:function(e,t){switch(t){case"second":return function(e){(0,nb.default)(1,arguments);var t=(0,ny.default)(e);return t.setMilliseconds(999),t}(e);case"minute":return function(e){(0,nb.default)(1,arguments);var t=(0,ny.default)(e);return t.setSeconds(59,999),t}(e);case"hour":return function(e){(0,nb.default)(1,arguments);var t=(0,ny.default)(e);return t.setMinutes(59,59,999),t}(e);case"day":return(0,il.default)(e);case"week":return function(e,t){(0,nb.default)(1,arguments);var n=t||{},r=n.locale,i=r&&r.options&&r.options.weekStartsOn,o=null==i?0:(0,nk.default)(i),a=null==n.weekStartsOn?o:(0,nk.default)(n.weekStartsOn);if(!(a>=0&&a<=6))throw RangeError("weekStartsOn must be between 0 and 6 inclusively");var s=(0,ny.default)(e),l=s.getDay();return s.setDate(s.getDate()+((l<a?-7:0)+6-(l-a))),s.setHours(23,59,59,999),s}(e);case"month":return(0,is.default)(e);case"quarter":return function(e){(0,nb.default)(1,arguments);var t=(0,ny.default)(e),n=t.getMonth();return t.setMonth(n-n%3+3,0),t.setHours(23,59,59,999),t}(e);case"year":return function(e){(0,nb.default)(1,arguments);var t=(0,ny.default)(e),n=t.getFullYear();return t.setFullYear(n+1,0,0),t.setHours(23,59,59,999),t}(e);default:return e}}}),nT.Chart.register(nT.CategoryScale,nT.LinearScale,nT.PointElement,nT.LineElement,nT.Title,nT.Tooltip,nT.TimeScale);let ic=function(e){var t,n=e.data,r=e.start,i=e.end,o=e.label,a=e.unit,s=e.xAxisLabel,l=e.yAxisLabel,u=(0,nL.useTheme)().values,c=nF(),d={datasets:[{label:o,data:n,fill:!1,borderColor:u.global.blueDimmer,tension:.1}]},f=(t=Math).max.apply(t,(0,H._)(n.map(function(e){return e.y}))),p=Math.ceil(a===nC.ResourceMonitoringUnit.Percentage?Math.max(f,100):Math.ceil(1.2*f)),h=function(e,t){var n=t.getTime()-e.getTime();if(n<=36e5)return{unit:"minute",stepSize:5};if(n<=216e5)return{unit:"minute",stepSize:30};if(n<=864e5)return{unit:"hour",stepSize:2};if(n<=2592e5)return{unit:"hour",stepSize:6};if(n<=6048e5)return{unit:"hour",stepSize:12};else return{unit:"day",stepSize:1}}(r,i),g=h.unit,m=h.stepSize;return(0,V.jsx)(nj.Line,{data:d,options:{animation:!1,scales:{x:{type:"time",time:{unit:g},title:{display:!0,text:s},min:r.getTime(),max:i.getTime(),ticks:{stepSize:m,color:u.global.foregroundDimmer}},y:{title:{display:!0,text:l},type:"linear",suggestedMax:p,ticks:{font:{family:"'IBM Plex Sans', sans-serif"},color:u.global.foregroundDimmer,callback:function(e){return a?"".concat(e).concat(a):e}},min:0}},maintainAspectRatio:!1,responsive:!0,plugins:{tooltip:(0,N._)({},c)}}})};var id=function(e){var t,n,r,i,o=e.start,a=e.end,s=e.timeSeriesFragment,l=e.xAxisLabel,u=e.yAxisLabel;if(0===s.results.length)return(0,V.jsx)("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",height:"400px"},children:"No Data Available"});var c=(r=(t=s.results)[0].value,{label:r,unit:(i=null==(n=t[0])?void 0:n.unit)?function(e,t){var n=Object.entries(e).find(function(e){var n=(0,B._)(e,2);return n[0],n[1]===t});if(n)return e[n[0]]}(nC.ResourceMonitoringUnit,i):void 0,data:t.map(function(e){return{x:new Date(e.timestamp),y:e.count}})}),d=c.label,f=c.unit,p=c.data;return(0,V.jsx)(ic,{data:p,start:o,end:a,label:d,unit:f,xAxisLabel:l,yAxisLabel:u})},ip=function(e){var t=e.data,n=e.start,r=e.hours,i=e.colorFn,o=Array(r).fill(0).map(function(e,t){return(0,nH.addHours)(n,t)}),a=t.results.reduce(function(e,t){var n,r=t.timestamp,i=t.value,o=t.count,a=null!=(n=e.get(i))?n:new Map;return a.set(r,o),e.set(i,a),e},new Map),s=(0,H._)(a.keys()).map(function(e,t){var n=i(e,t),r=a.get(e);return{label:e,data:o.map(function(e){var t,n=null!=(t=null==r?void 0:r.get(e.toISOString()))?t:0;return{x:new Date(e),y:n}}),borderColor:n,backgroundColor:n}});return(0,V.jsx)(n1,{labels:o,datasets:s,maintainAspectRatio:!1})};let ih=function(e){var t,n,r,i,o=e.replId,a=e.title,s=e.metric,l=e.start,u=e.hours,c=e.colorFn,d=(0,B._)((0,F.useState)(void 0),2),f=d[0],p=d[1],h=(t={variables:{id:o,input:{metric:s,start:l,hours:u,deployment:!0}},ssr:!1,onCompleted:function(e){if("Repl"===e.getRepl.__typename)switch(e.getRepl.analyticsTimeSeries.__typename){case"TooManyRequestsError":p(Error("Too many requests"));break;case"UserError":case"NotFoundError":p(Error(e.getRepl.analyticsTimeSeries.message))}}},n=(0,N._)({},n6,t),nI.useQuery(re,n)),g=h.data,m=h.loading,x=h.error,y=(null==g||null==(r=g.getRepl)?void 0:r.__typename)==="Repl"&&(null==(i=g.getRepl.analyticsTimeSeries)?void 0:i.__typename)==="ReplAnalyticsTimeSeries"?g.getRepl.analyticsTimeSeries:void 0;return x&&p(x),(0,V.jsxs)(eS.View,{gap:8,children:[(0,V.jsx)(eS.View,{row:!0,align:"center",justify:"space-between",children:(0,V.jsx)(eO.Text,{variant:"subheadDefault",multiline:!1,children:a})}),(0,V.jsxs)(eS.View,{children:[m?(0,V.jsx)(eS.View,{css:[nB.rcss.width("100%"),nV,nB.rcss.borderRadius(),nU.loadingStyle.backgroundPulse()]}):null,f?(0,V.jsx)(nG.StatusBanner,{text:f.message,colorway:"negative"}):null,y?(0,V.jsx)(eS.View,{css:nV,children:(0,nC.isResourceMonitoringMetric)(s)?(0,V.jsx)(id,{start:l,end:(0,nH.addHours)(l,u),timeSeriesFragment:y}):(0,V.jsx)(ip,{data:y,start:l,hours:u,colorFn:c})}):null]})]})};e.s(["default",0,ih],342424);var ig=e.i(864558);function im(){var e=(0,nE._)(["\n  fragment ReplAnalyticsTopListResult on ReplAnalyticsTopList {\n    __typename\n    results {\n      __typename\n      value\n      count\n    }\n  }\n"]);return im=function(){return e},e}function iv(){var e=(0,nE._)(["\n  query ReplAnalyticsTopList($id: String!, $input: ReplAnalyticsTopInput!) {\n    getRepl(id: $id) {\n      ... on Repl {\n        __typename\n        id\n        analyticsTopList(input: $input) {\n          ... on ReplAnalyticsTopList {\n            ...ReplAnalyticsTopListResult\n          }\n          ... on NotFoundError {\n            __typename\n            message\n          }\n          ... on UserError {\n            __typename\n            message\n          }\n        }\n      }\n      ... on Error {\n        message\n      }\n    }\n  }\n  ","\n"]);return iv=function(){return e},e}var ix={},iy=(0,nR.gql)(im()),ib=(0,nR.gql)(iv(),iy),iw=e.i(254806),ik=e.i(15260),i_=function(e){var t=e.data,n=e.variant;if(0===t.results.length)return(0,V.jsx)(eO.Text,{multiline:!1,children:"No results"});switch(n){case"map":return(0,V.jsx)(ij,{data:t});case"pie":return(0,V.jsx)(iC,{data:t,devices:!1});case"device-pie":return(0,V.jsx)(iC,{data:t,devices:!0});case"table":return(0,V.jsx)(iS,{data:t})}},iS=function(e){var t=e.data;return nT.Chart.register(nT.ArcElement),(0,V.jsx)(eS.View,{children:t.results.map(function(e,t){return(0,V.jsxs)(eS.View,{css:[{borderBottom:"1px solid ".concat(e_.tokens.outlineDimmest)},{"&:last-of-type":{borderBottom:"none"}}],py:8,row:!0,gap:16,children:[(0,V.jsx)(eS.View,{css:[nB.rcss.maxWidth("90%")],grow:!0,children:(0,V.jsx)(eO.Text,{title:e.value,multiline:!1,children:e.value})}),(0,V.jsx)(eS.View,{children:(0,V.jsx)(eO.Text,{multiline:!1,children:e.count})})]},t)})})},iC=function(e){var t=e.data,n=e.devices,r=(0,nL.useTheme)(),i=r.isDarkColorScheme,o=r.values,a=i?nB.dataViz.categorical:nB.dataViz.categorical.reverse(),s=new Map;return n?t.results.forEach(function(e){var t=e.value,n=e.count,r=t.match(/\(.*\)/);if(r&&r.length){var i=r[0].substring(1,r[0].length-1),o=s.get(i)||0;s.set(i,o+n)}else{var a=s.get("Unknown")||0;s.set("Unknown",a+n)}}):t.results.forEach(function(e){var t=e.value,n=e.count,r=t.replace(/ \(.*\)/,""),i=s.get(r)||0;s.set(r,i+n)}),(0,V.jsx)(eS.View,{css:nV,children:(0,V.jsx)(nj.Pie,{options:{radius:"90%",maintainAspectRatio:!1,plugins:{tooltip:nF()}},data:{labels:(0,H._)(s.keys()),datasets:[{borderWidth:+((0,H._)(s.keys()).length>1),borderColor:o.global.outlineDimmest,data:(0,H._)(s.values()),backgroundColor:Array(s.size).fill(0).map(function(e,t){return a[t%a.length]})}]}})})},ij=function(t){var n=t.data,r=(0,ig.default)(function(){return e.A(590590)},{loadableGenerated:{modules:[568727]},ssr:!1}),i=n.results.map(function(e){return{country:e.value,numHits:e.count}});return(0,V.jsx)(r,{countries:i})};let iT=function(e){var t,n,r,i,o=e.replId,a=e.start,s=e.hours,l=e.metric,u=e.count,c=e.variant,d=void 0===c?"table":c,f=e.expandable,p=(0,nC.getTopListMetricLabel)(l),h=(0,B._)((0,F.useState)(void 0),2),g=h[0],m=h[1],x=(0,B._)((0,F.useState)(!1),2),y=x[0],b=x[1],w=(t={variables:{id:o,input:{metric:l,start:a,hours:s,deployment:!0,count:y?3*u:u}},ssr:!1,onCompleted:function(e){if("Repl"===e.getRepl.__typename)switch(e.getRepl.analyticsTopList.__typename){case"UserError":case"NotFoundError":m(Error(e.getRepl.analyticsTopList.message))}}},n=(0,N._)({},ix,t),nI.useQuery(ib,n)),k=w.data,_=w.loading,S=w.error;return S&&m(S),(0,V.jsxs)(eS.View,{gap:8,children:[(0,V.jsxs)(eS.View,{row:!0,gap:8,children:[(0,V.jsx)(eO.Text,{variant:"subheadDefault",multiline:!1,children:"device-pie"===d?"Top Devices":"Top ".concat(p)}),void 0!==f&&f?(0,V.jsx)(eA.IconButton,{alt:y?"Collapse list":"Expand list",onClick:function(){return b(!y)},children:y?(0,V.jsx)(iw.default,{}):(0,V.jsx)(ik.default,{})}):null]}),(0,V.jsxs)(eS.View,{children:[_?(0,V.jsx)(eS.View,{css:[nB.rcss.height(80),nB.rcss.borderRadius(),nU.loadingStyle.backgroundPulse()]}):null,g?(0,V.jsx)(nG.StatusBanner,{text:g.message,colorway:"negative"}):null,(null==k||null==(r=k.getRepl)?void 0:r.__typename)==="Repl"&&(null==(i=k.getRepl.analyticsTopList)?void 0:i.__typename)==="ReplAnalyticsTopList"?(0,V.jsx)(i_,{variant:d,data:k.getRepl.analyticsTopList}):null]})]})};var iE=e.i(107129),iR=e.i(241703),iI=e.i(32995),iA=e.i(952521),iP=e.i(446530),iD=e.i(601059),iO=[{label:"six hours",key:6},{label:"one day",key:24},{label:"five days",key:120},{label:"one week",key:168},{label:"two weeks",key:336},{label:"thirty days",key:720}],iN={label:"one week",key:168},iM=nB.container.min(600),iL=(0,iP.cssRecord)({fullWidth:(0,ew._)({},iM,{gridColumn:"span 2"})}),iB=(0,iP.cssRecord)({container:[nB.rcss.display.grid,nB.rcss.gap(32),nB.rcss.pb(32),(0,ew._)({},iM,{gridTemplateColumns:"repeat(2, minmax(0, 1fr))"})],fullWidth:iL.fullWidth,map:[iL.fullWidth],pies:[iL.fullWidth,nB.rcss.flex.column,(0,ew._)({gap:32},nB.container.min(480),[nB.rcss.flex.row,{" > *":{flex:1}}])]}),iV=function(e){var t=e.replId,n=(0,B._)((0,F.useState)(iN),2),r=n[0],i=r.key,o=r.label,a=n[1],s=(0,B._)((0,F.useState)(nS(nw(new Date),i-1)),2),l=s[0],u=s[1],c=(0,iA.useDismissibleElement)("deployment-analytics-dot"),d=c.isDone,f=c.setAsDone,p=nS(nw(new Date),23),h=(0,nL.useTheme)().values,g=[h.global.redStronger,h.global.redDimmer,h.global.redStrongest,h.global.redDimmest],m=[h.global.orangeDefault,h.global.orangeDimmer,h.global.orangeStronger,h.global.orangeDimmest],x=[h.global.blueDefault,h.global.blueDimmer,h.global.blueStronger,h.global.blueDimmest],y=[h.global.greenDefault,h.global.greenDimmer,h.global.greenStronger,h.global.greenDimmest];return(0,F.useEffect)(function(){(0,iE.trackDeploymentSectionViewed)({context:iR.Views.Analytics})},[]),(0,F.useEffect)(function(){d||f()},[d,f]),(0,V.jsx)(iI.PaneSection,{children:(0,V.jsxs)(eS.View,{css:iB.container,children:[(0,V.jsx)(eS.View,{css:iB.fullWidth,children:(0,V.jsx)(iD.PopupMenu,{items:iO,label:"Past ".concat(o),onAction:function(e){var t,n="string"==typeof e?parseInt(e,10):e;a(null!=(t=iO.find(function(e){return e.key===n}))?t:iN),u(nS(nw(new Date),n-1))},children:function(e){return(0,V.jsx)(iD.MenuItem,{label:e.label,id:e.key},e.key)}})}),(0,V.jsx)(eS.View,{css:iB.fullWidth,children:(0,V.jsx)(n3,{replId:t,start:l,hours:i})}),(0,V.jsx)(iT,{replId:t,metric:nC.TopListMetrics.Url,start:l,hours:i,count:4,expandable:!0}),(0,V.jsx)(iT,{replId:t,metric:nC.TopListMetrics.Referrer,start:l,hours:i,count:4,expandable:!0}),(0,V.jsx)(ih,{replId:t,title:"HTTP Statuses (24h)",metric:nC.TimeSeriesMetrics.Statuses,start:p,hours:24,colorFn:function(e,t){var n=Number(e);return n<300?y[t%y.length]:n<400?x[t%x.length]:n<500?m[t%m.length]:g[t%g.length]}}),(0,V.jsx)(nz,{replId:t,start:l,hours:i}),(0,V.jsxs)(eS.View,{css:iB.pies,children:[(0,V.jsx)(iT,{replId:t,metric:nC.TopListMetrics.Browser,start:l,hours:i,count:100,variant:"pie"}),(0,V.jsx)(iT,{replId:t,metric:nC.TopListMetrics.Browser,start:l,hours:i,count:100,variant:"device-pie"})]}),(0,V.jsx)(eS.View,{css:iB.map,children:(0,V.jsx)(iT,{replId:t,metric:nC.TopListMetrics.Country,start:l,hours:i,count:100,variant:"map"})})]})})};e.s(["Analytics",()=>iV],379790);var iF=e.i(169252),iU=e.i(664219),iG=e.i(165349);function i$(){var e=(0,nE._)(["\n  query HostingDeploymentConfigRedeploy($id: String!) {\n    hostingDeployment(id: $id) {\n      ... on HostingDeployment {\n        id\n        replitAppSubdomain\n        ignoredSecrets\n        activityLogs(count: 20) {\n          items {\n            id\n            ...HostingActivityLogLine2\n          }\n          pageInfo {\n            hasNextPage\n            nextCursor\n          }\n        }\n        currentBuild {\n          id\n          envVars {\n            name\n            value\n          }\n          suspendedReason\n          machineConfiguration {\n            id\n            label\n            vcpu\n            memory\n            slug\n          }\n          maxMachineInstances\n        }\n        ...DeploymentsDeployOptionsDeployment\n        repl {\n          ...DeploymentsDeployOptionsAuthzRepl\n        }\n      }\n    }\n  }\n  ","\n  ","\n  ","\n"]);return i$=function(){return e},e}var iz={},iH=(0,nR.gql)(i$(),iG.HostingActivityLogLine2FragmentDoc,iU.DeploymentsDeployOptionsDeploymentFragmentDoc,iU.DeploymentsDeployOptionsAuthzReplFragmentDoc),iW=e.i(399344),iq=e.i(914279),iK=e.i(68893),iY=e.i(187505),iQ=e.i(259421),iX=e.i(527225),iJ=(0,iP.cssRecord)({buttonLeft:[nB.rcss.borderRadius(8,0,0,8),nB.rcss.flex.growAndShrink(1)],buttonRight:[nB.rcss.borderRadius(0,8,8,0)]});function iZ(e){var t=e.shouldShow,n=e.onDismissTour,r=(0,iY.useTrackClick)().trackClick,i=(0,B._)((0,F.useState)(!1),2),o=i[0],a=i[1];return(0,V.jsxs)(V.Fragment,{children:[t?(0,V.jsxs)(eS.View,{pb:12,row:!0,gap:2,justify:"center",children:[(0,V.jsx)(tB.Button,{iconLeft:(0,V.jsx)(iX.default,{}),onClick:function(){r({productArea:"publishing",target:"deploy_with_app_button"}),(0,e5.track)(e6.events.DEPLOYMENT_MOBILE_DOWNLOAD_QR_VIEWED),a(!0)},text:"Deploy with the Replit App!",css:iJ.buttonLeft}),(0,V.jsx)(tB.Button,{css:iJ.buttonRight,text:"",iconLeft:(0,V.jsx)(nc.default,{}),onClick:n})]}):null,(0,V.jsx)(eP.Modal,{isOpen:o,onRequestClose:function(){a(!1),n()},children:(0,V.jsx)(iQ.default,{source:"deployment_build_success"})})]})}var i0=e.i(729678),i1=e.i(331820),i2=e.i(686631),i3=e.i(368964),i4=e.i(379334),i8=(0,$.atom)("BOT_TOKEN"),i5="TELEGRAM_BOT_TOKEN",i6=e.i(638311),i9=((o={}).INACTIVE="INACTIVE",o.ACTIVE="ACTIVE",o.COMPLETE="COMPLETE",o);function i7(e){var t=e.state,n=e.number,r=e.title,i=e.children,o=e.numberStyleVariant,a=void 0===o?"no-fill":o,s=e.showChildren,l=(0,L._)(e,["state","number","title","children","numberStyleVariant","showChildren"]);return(0,V.jsx)(eD.Surface,(0,M._)((0,N._)({elevated:"ACTIVE"===t,className:i6.default.stepContainer},l),{children:(0,V.jsxs)(eS.View,{row:!0,gap:8,align:"start",children:["hidden_no_space"===a?null:"COMPLETE"===t?(0,V.jsx)(eS.View,{align:"center",justify:"center",className:i6.default.stepNumber,children:(0,V.jsx)(tT.default,{})}):(0,V.jsx)(eD.Surface,{elevated:"ACTIVE"===t&&"elevated"===a,align:"center",justify:"center",className:i6.default.stepNumber,style:{visibility:"hidden_keep_space"===a?"hidden":"unset"},children:(0,V.jsx)(eO.Text,{variant:"small",color:"ACTIVE"===t?"dimmer":"dimmest",children:n})}),(0,V.jsxs)(eS.View,{align:"start",shrink:1,gap:4,children:[(0,V.jsx)(eO.Text,{className:i6.default.title,color:"ACTIVE"===t?"default":"dimmest",children:r}),s||void 0===s&&"ACTIVE"===t?i:null]})]})}))}var oe=e.i(317388),ot=e.i(245329),on=e.i(283023),or=e.i(841691),oi=e.i(90102),oo=e.i(209065);function oa(){var e=(0,iW.useSecretsService)().watch,t=(0,B._)((0,F.useState)(new Map),2),n=t[0],r=t[1];return(0,F.useEffect)(function(){return e(r)},[e]),null==n?void 0:n.get(i5)}function os(e){var t=e.deployDisabled,n=(0,iW.useSecretsService)(),r=oa();return(0,V.jsx)(ol,{deployDisabled:null!=t&&t,addEntries:n.addEntries,removeEntries:n.removeEntries,existingBotToken:r})}function ol(e){var t=e.deployDisabled,n=e.addEntries,r=e.removeEntries,i=e.existingBotToken,o=(0,tr.useValue)(i8),a=(0,tr.useSet)(i8),s=(0,B._)((0,F.useState)(""),2),l=s[0],u=s[1],c=(0,B._)((0,F.useState)(!0),2),d=c[0],f=c[1],p=!!(0,iW.useDeploymentCurrentBuild)();(0,F.useEffect)(function(){u(function(e){return e||(null!=i?i:"")})},[i]);var h=l.length>0,g=t||"PUBLISH"!==o,m="BOT_TOKEN"===o?i9.ACTIVE:i9.COMPLETE,x=p?"PUBLISH"===o?"Press publish to apply your changes":null:g?"Set up Telegram to enable publishing":"Press publish to share your Telegram agent with the world";return(0,V.jsxs)(V.Fragment,{children:[p?(0,V.jsx)(eO.Text,{variant:"subheadDefault",children:"Telegram connection setup"}):null,(0,V.jsxs)(eS.View,{clsx:[oo.default.stepsContainer,(0,ew._)({},oo.default.inactiveContainer,"PUBLISH"===o)],children:[(0,V.jsx)(i7,{number:1,title:'In Telegram, search for BotFather and click "open"',state:m}),(0,V.jsx)(i7,{number:2,title:'Click "Create a new bot"',state:m}),(0,V.jsx)(i7,{number:3,title:"Follow the prompts to fill out a name, description, and username",state:m}),(0,V.jsx)(i7,{number:4,title:"PUBLISH"===o?"You provided your Telegram bot token":"BotFather will provide you a token. Copy and paste it below",state:m,showChildren:"PUBLISH"===o||void 0,children:"BOT_TOKEN"===o?(0,V.jsxs)(eS.View,{gap:8,py:16,children:[(0,V.jsxs)(eS.View,{row:!0,gap:8,align:"center",children:[(0,V.jsx)(ot.SecretItem,{keyName:"TELEGRAM_BOT_TOKEN",value:l,onChange:function(e){u(e)},readOnly:!1,accountSecrets:[],isSensitive:d,selectedKey:null,onSelectedKeyChange:function(){}}),(0,V.jsx)(eA.IconButton,{alt:d?"Reveal value":"Hide value",onClick:function(){return f(!d)},children:d?(0,V.jsx)(or.default,{}):(0,V.jsx)(oi.default,{})})]}),(0,V.jsx)(tB.Button,{text:"Continue",colorway:"primary",disabled:!h,onClick:function(){n([{key:i5,value:l}]),a("PUBLISH")}})]}):(0,V.jsx)(eA.IconButton,{className:oo.default.editBotTokenButton,onClick:function(){a("BOT_TOKEN"),r(i5)},alt:"Edit bot token",children:(0,V.jsxs)(eS.View,{row:!0,align:"center",gap:8,children:[(0,V.jsx)(tY.Pill,{variant:"muted",text:"TELEGRAM_BOT_TOKEN",iconLeft:(0,V.jsx)(oe.default,{width:10,height:10,color:e_.tokens.foregroundDimmest})}),(0,V.jsx)(on.default,{className:oo.default.hidden,color:e_.tokens.foregroundDimmest})]})})})]}),x?(0,V.jsx)(eO.Text,{color:"PUBLISH"===o?"default":"dimmest",children:x}):null]})}e.s(["TelegramConnectionSection",()=>os,"useTelegramBotTokenSecret",()=>oa],197486);var ou=e.i(137737),oc=e.i(500179),od=e.i(161322),of=e.i(957789),op=e.i(522029),oh=e.i(936239),og=e.i(589910),om=e.i(352767),ov=e.i(990929);function ox(e){var t=e.isAzureDeployment,n=e.onError,r=e.onConfirm,i=e.onCancel,o=(0,od.useAtomValue)(of.cpuValueAtom),a=(0,od.useAtomValue)(of.ramValueAtom),s=(0,od.useAtomValue)(op.maxInstancesValueAtom),l=(0,od.useSetAtom)(of.cpuIndexAtom),u=(0,od.useSetAtom)(of.ramIndexAtom),c=(0,od.useSetAtom)(op.maxInstancesIndexAtom),d=(0,B._)((0,F.useState)(of.CPUValues.indexOf(o)>=0?of.CPUValues.indexOf(o):0),1)[0],f=(0,B._)((0,F.useState)(of.RAMValues.indexOf(a)>=0?of.RAMValues.indexOf(a):0),1)[0],p=(0,B._)((0,F.useState)(op.maxInstancesValues.indexOf(s)>=0?op.maxInstancesValues.indexOf(s):0),1)[0],h=(0,og.useAutoscaleConfigurations)({isAzureDeployment:t,onError:n}),g=h.selectedMachineConfiguration,m=h.machineConfigurations,x=h.loading,y=(0,F.useCallback)(function(){x||!m?n("Cannot confirm while configurations are loading"):g?r(g):n("An error occurred trying to validate selected machine configuration")},[x,r,m,g,n]);return(0,V.jsx)(iI.PaneSection,{className:ov.default.container,children:(0,V.jsxs)(eS.View,{gap:16,children:[(0,V.jsx)(oh.AutoscaleConfigurationBuilder,{machineConfiguration:null,maxMachineInstances:null,disabled:x,toggleEditable:!1,onError:n}),(0,V.jsxs)(eS.View,{row:!0,justify:"space-between",pt:8,children:[(0,V.jsx)(tB.Button,{variant:"outlined",text:"Cancel",iconLeft:(0,V.jsx)(om.default,{}),onClick:function(){l(d),u(f),c(p),i()}}),(0,V.jsx)(tB.Button,{colorway:"primary",text:"Confirm",iconLeft:(0,V.jsx)(tT.default,{}),onClick:y,loading:x})]})]})})}function oy(e){var t=e.value,n=e.onChange,r=e.loading,i=e.disabled,o=e.error;return(0,V.jsxs)(eS.View,{gap:8,children:[(0,V.jsxs)(eS.View,{gap:4,children:[(0,V.jsxs)(eS.View,{row:!0,gap:8,align:"center",children:[(0,V.jsx)(eO.Text,{children:"Build command"}),(0,V.jsx)(eO.Text,{variant:"small",color:"dimmest",children:"Optional"})]}),(0,V.jsx)(eO.Text,{color:"dimmer",variant:"small",multiline:!0,children:"Compiles your app before it deploys"})]}),(0,V.jsx)(ou.CommandInput,{id:"buildCommand",value:t,onChange:n,loading:void 0!==r&&r,disabled:void 0!==i&&i,error:o})]})}e.s(["AutoscaleConfigEditor",()=>ox],878284),e.s(["BuildCommandSection",()=>oy],942859);var ob=e.i(85742),ow=e.i(12034),ok=e.i(993134),o_=e.i(788331),oS=e.i(292297),oC=e.i(115357);function oj(e){var t=e.provider,n=e.setProvider,r=e.recommendedProvider,i=e.excludedProviders,o=(0,iW.useAvailableDeploymentProviders)().deploymentProviders.filter(function(e){return!(null==i?void 0:i.includes(e))}).map(function(e){switch(e){case iF.HostingBuildProvider.Gce:return{id:iF.HostingBuildProvider.Gce,title:"Reserved VM",subtitle:"Always On Servers",description:"Ensures high uptime, minimizing disruptions for apps requiring persistent session data.",icon:(0,V.jsx)(oS.default,{size:16})};case iF.HostingBuildProvider.AzureVm:return{id:iF.HostingBuildProvider.AzureVm,title:"Reserved VM",subtitle:"Always On Servers (Azure)",description:"Ensures high uptime, minimizing disruptions for apps requiring persistent session data.",icon:(0,V.jsx)(oS.default,{size:16})};case iF.HostingBuildProvider.CloudRun:return{id:iF.HostingBuildProvider.CloudRun,title:"Autoscale",subtitle:"Meet demand exactly",description:"Automatically scales from zero to any level of demand.",icon:(0,V.jsx)(o_.default,{size:16})};case iF.HostingBuildProvider.AzureContainerApp:return{id:iF.HostingBuildProvider.AzureContainerApp,title:"Autoscale",subtitle:"Meet demand exactly (Azure)",description:"Automatically scales from zero to any level of demand.",icon:(0,V.jsx)(o_.default,{size:16})};case iF.HostingBuildProvider.Static:return{id:iF.HostingBuildProvider.Static,title:"Static pages",subtitle:"Simple HTML websites",description:"Basic websites with no backend server.",icon:(0,V.jsx)(oC.default,{size:16})};case iF.HostingBuildProvider.Cron:return{id:iF.HostingBuildProvider.Cron,title:"Scheduled",subtitle:"Time-based job scheduler",description:"The easiest way to schedule for your apps to run.",icon:(0,V.jsx)(ok.default,{size:16})};default:return null}}).filter(Boolean),a=o.find(function(e){return e.id===t})||o[0];return(0,V.jsxs)(eS.View,{gap:8,children:[(0,V.jsx)(eO.Text,{children:"Deployment type"}),(0,V.jsx)(eS.View,{style:{maxWidth:"100%"},children:(0,V.jsxs)(eO.Text,{color:"dimmer",variant:"small",multiline:!0,children:["Technology used to publish your app."," ",(0,V.jsx)("a",{target:"_blank",href:"https://docs.replit.com/category/replit-deployments",children:"Learn more"})," "]})}),(0,V.jsx)(ow.Select,{"aria-label":"Deployment type selection",items:o,selectedKey:t,onSelectionChange:function(e){n(e)},children:function(e){var t=r===e.id;return(0,V.jsx)(ob.BaseListBoxItem,{id:e.id,textValue:e.title,children:(0,V.jsx)(eS.View,{gap:8,row:!0,align:"center",justify:"space-between",width:"100%",children:(0,V.jsxs)(eS.View,{row:!0,align:"center",gap:8,children:[e.icon,(0,V.jsx)(eO.Text,{children:e.title}),t?(0,V.jsx)(tY.Pill,{colorway:"primary",text:"Recommended"}):null]})})})}}),(0,V.jsx)(eS.View,{style:{maxWidth:"100%"},children:(0,V.jsx)(eO.Text,{color:"dimmer",variant:"small",multiline:!0,children:a.description})})]})}e.s(["default",()=>oj],487517);var oT=e.i(650853),oE=e.i(546284);e.i(32967);var oR=e.i(837605),oI=e.i(754873),oA=e.i(952030);function oP(e){var t=e.secrets,n=e.otherSecrets,r=new Map,i=!0,o=!1,a=void 0;try{for(var s,l=n[Symbol.iterator]();!(i=(s=l.next()).done);i=!0){var u=(0,B._)(s.value,2),c=u[0],d=u[1];t.has(c)||r.set(c,d)}}catch(e){o=!0,a=e}finally{try{i||null==l.return||l.return()}finally{if(o)throw a}}return{missing:r}}var oD=(0,iP.cssRecord)({root:[nB.rcss.borderRadius(8),{border:"1px solid "+e_.tokens.outlineDimmer}],button:[nB.rcss.reset.button,oI.interactive.nofill,nB.rcss.rowWithGap(8),nB.rcss.align.center,nB.rcss.height(32),nB.rcss.px(8),{border:"0 none",borderBottomLeftRadius:0,borderBottomRightRadius:0}],subtitle:[{borderTop:"1px solid "+e_.tokens.outlineDimmest,top:-1},nB.rcss.py(8),nB.rcss.position.relative]});function oO(e){var t=e.secrets,n=e.otherSecrets,r=e.otherEnvName,i=e.onAddSecret,o=e.initialExpanded,a=oP({secrets:t,otherSecrets:n}).missing,s=(0,B._)((0,F.useState)(o),2),l=s[0],u=s[1],c=0===a.size;if((0,F.useEffect)(function(){c&&u(!1)},[c]),c)return null;var d="".concat(a.size," ").concat((0,oE.default)("secret",a.size)," out of sync"),f=1===a.size?"A ".concat(r," secret is missing from this environment"):"".concat(a.size," ").concat(r," secrets are missing from this environment");return(0,V.jsxs)(eS.View,{css:oD.root,children:[(0,V.jsxs)(eS.View,{css:oD.button,tag:"button",onClick:function(){return u(function(e){return!e})},children:[(0,V.jsxs)(eS.View,{grow:!0,shrink:!0,row:!0,gap:8,align:"center",children:[(0,V.jsx)(tA.default,{color:e_.tokens.orangeDefault}),(0,V.jsx)(eO.Text,{multiline:!1,children:d})]}),l?(0,V.jsx)(tN.default,{}):(0,V.jsx)(tO.default,{})]}),l?(0,V.jsxs)(eS.View,{px:8,pb:8,children:[(0,V.jsx)(eO.Text,{css:oD.subtitle,color:"dimmer",children:f}),(0,V.jsx)(eS.View,{gap:8,children:(0,H._)(a.entries()).map(function(e){var t=(0,B._)(e,2),n=t[0],r=t[1];return(0,V.jsxs)(eS.View,{row:!0,gap:8,children:[(0,V.jsxs)(eS.View,{grow:!0,shrink:!0,row:!0,gap:8,children:[(0,V.jsx)(oR.SecretKey,{value:n}),(0,V.jsx)(oR.SecretValue,{value:r})]}),r?(0,V.jsx)(tB.Button,{iconLeft:(0,V.jsx)(oA.default,{}),variant:"outlined",text:"Add secret",onClick:function(){return i({key:n,value:r})}}):null]},n)})})]}):null]})}function oN(e){var t=e.envVars,n=e.envVarKeys,r=e.updateEnvVarName,i=e.updateEnvVarValue,o=e.removeEnvVar,a=e.addAnEnvVar,s=e.baseDisableState,l=e.devSecrets,u=e.ignoredSecrets,c=e.editReplSecretsAuthorization,d=e.editDeploySecretAuthorization,f=e.optOut,p=e.optIn,h=e.syncToWorkspace,g=e.queryLoading,m=e.replId,x=e.initialSecretsSyncExpanded;return(0,V.jsxs)(eS.View,{gap:12,children:[t.length>0?t.map(function(e,t){var a=e.name,g=e.value;return(0,V.jsx)(ou.EnvVarInput,{index:t,name:a,value:g,updateEnvVarName:function(e){return r(t,e)},updateEnvVarValue:function(e){return i(t,e)},removeEnvVar:function(){return o(t)},disabled:s,otherKeys:n.filter(function(e,n){return n!==t}),devSecrets:l||null,ignoredSecrets:u,canEditDevSecretsDisabledMessage:(null==c?void 0:c.isAuthorized)===!1?c.message:void 0,canEditDeploySecretsDisabledMessage:(null==d?void 0:d.isAuthorized)===!1?d.message:void 0,optOutSyncing:f,optInSyncing:p,syncToWorkspace:h},t)}):null,l&&(null==c?void 0:c.isAuthorized)&&(null==d?void 0:d.isAuthorized)?(0,V.jsx)(oO,{secrets:new Map(t.map(function(e){return[e.name,e.value]})),otherSecrets:l,otherEnvName:"workspace",onAddSecret:function(e){return a({name:e.key,value:e.value})},initialExpanded:x}):null,(0,V.jsx)(tj.Tooltip,{tooltip:null==d?void 0:d.message,isDisabled:null==d?void 0:d.isAuthorized,children:(0,V.jsx)(tB.Button,{onClick:function(){(0,iE.trackDeploymentAddSecretClicked)({replId:m}),a()},text:"Add deployment secret",iconLeft:(0,V.jsx)(oA.default,{}),disabled:g||!(null==d?void 0:d.isAuthorized)})})]})}e.s(["DeploymentSecretsSection",()=>oN],648518);var oM=e.i(810206),oL=e.i(127227),oB=(0,iP.cssRecord)({titleRow:[nB.rcss.gap(8),nB.rcss.align.center]});function oV(){var e=(0,iW.useDeploymentSecurityScanState)(),t=e.enabled,n=e.userCanControl,r=e.isOrgEnforced,i=e.enforcementReason,o=e.setDeploymentSecurityScanEnabled;return(0,V.jsx)(V.Fragment,{children:(0,V.jsx)(oM.Section,{id:"securityScan",title:(0,V.jsxs)(eS.View,{gap:4,children:[(0,V.jsxs)(eS.View,{css:oB.titleRow,row:!0,children:[(0,V.jsx)(eO.Text,{children:"Pre-publishing security scan"}),(0,V.jsx)(tY.Pill,{text:"Beta",colorway:"primary",compact:!0})]}),(0,V.jsxs)(eO.Text,{variant:"small",color:"dimmer",children:["Before publishing your app, run a security scan powered by our partner Semgrep to identify potential vulnerabilities."," ",(0,V.jsx)("a",{target:"_blank",href:"https://docs.replit.com/replit-workspace/workspace-features/security-scanner",children:"Learn more"})]})]}),children:(0,V.jsx)(tj.Tooltip,{isDisabled:!r,tooltip:r?"required"===i?"Security scans are required for this organization.":"Only admins can skip security scans.":"",children:(0,V.jsx)(oL.Checkbox,{name:"Enable security scanning for publishing",checked:t,onChange:o,disabled:!n})})})})}e.s(["default",()=>oV],62279);var oF=e.i(552144);e.i(947095);var oU=e.i(243914),oG=(0,iP.cssRecord)({bannerButton:{span:[nB.rcss.textAlign.left]}});function o$(e){var t=e.deployability,n=e.isRedeploy,r=t.deploy,i=t.redeploy,o=n?i:r;return o.isAuthorized?null:o.code===i3.ReplAuthorizationCode.RequiresActiveTeamsSubscription?(0,V.jsx)(oF.StatusBannerButton,{href:"/teams/new",target:"_blank",text:"".concat(o.message," Click here to get started by creating a new organization."),colorway:"warning",iconLeft:(0,V.jsx)(tA.default,{}),iconRight:(0,V.jsx)(oU.default,{}),css:oG.bannerButton}):(0,V.jsx)(nG.StatusBanner,{text:o.message,colorway:"warning",icon:(0,V.jsx)(tA.default,{})})}var oz=e.i(691302),oH=e.i(697859),oW=e.i(823166);function oq(e){var t,n=e.provider,r=e.machineConfig,i=e.setMachineConfig,o=e.onError,a=e.onEditAutoscaleConfig,s=n===iF.HostingBuildProvider.AzureContainerApp||n===iF.HostingBuildProvider.AzureVm,l=(0,oW.useReservedVmConfigurations)({provider:n,onError:o}),u=l.defaultMachineConfiguration,c=l.machineConfigurations,d=l.loading,f=(0,og.useAutoscaleConfigurations)({isAzureDeployment:s,onError:o}),p=f.defaultMachineConfiguration,h=f.selectedMachineConfiguration,g=f.machineConfigurations;return(0,F.useEffect)(function(){var e;switch(n){case iF.HostingBuildProvider.Gce:case iF.HostingBuildProvider.AzureVm:case iF.HostingBuildProvider.AzureContainerApp:u&&(e=u);break;case iF.HostingBuildProvider.CloudRun:e=h}e&&i(e)},[n,h,u,i]),(0,F.useEffect)(function(){if(null===r)switch(n){case iF.HostingBuildProvider.Gce:case iF.HostingBuildProvider.AzureVm:case iF.HostingBuildProvider.AzureContainerApp:u&&i(u);break;case iF.HostingBuildProvider.CloudRun:g&&h&&i(h)}},[r,n,g,h,u,i]),(0,V.jsxs)(eS.View,{gap:4,children:[(0,V.jsx)(eO.Text,{children:"Machine configuration"}),(0,V.jsx)(eS.View,{style:{maxWidth:"100%"},children:(0,V.jsx)(eO.Text,{color:"dimmer",variant:"small",multiline:!0,children:"The power of the servers running your app"})}),n===iF.HostingBuildProvider.Gce||n===iF.HostingBuildProvider.AzureVm||n===iF.HostingBuildProvider.AzureContainerApp?(0,V.jsx)(oH.MachineConfigurationSelector,{selectedItem:r?(0,M._)((0,N._)({},r),{maxInstances:null!=(t=r.maxInstances)?t:1}):void 0,machineConfigurations:c,disabled:d,onError:o,onChange:i,provider:n,loading:d}):null,n===iF.HostingBuildProvider.CloudRun?(0,V.jsx)(oz.AutoscaleMachineConfiguration2,{onEditAutoscaleConfig:a,defaultMachineConfiguration:p,selectedMachineConfiguration:h,machineConfigurations:null!=g?g:[],isAzureDeployment:s}):null]})}e.s(["default",()=>oq],546345);var oK=e.i(1470),oY=e.i(198992),oQ=e.i(761732),oX=e.i(801127),oJ=e.i(282094),oZ=e.i(965153),o0=(0,iP.cssRecord)({self:[nB.rcss.mt(8)],textButton:[nB.rcss.cursor.pointer,nB.rcss.reset.button,nB.rcss.color.accentPrimaryStronger,nB.rcss.focusRing,nB.rcss.hover(nB.rcss.color.accentPrimaryStrongest),{lineHeight:1.2,":not([disabled])":{cursor:"pointer"}}],tableHeader:[nB.rcss.color.foregroundDimmer,nB.rcss.m(4),nB.rcss.textAlign.left],tableWrapper:[nB.rcss.mb(8),nB.rcss.colWithGap(8),(0,ew._)({},oY.mobileWidthContainerQuery,nB.rcss.rowWithGap(0))],table:[nB.rcss.flex.column,nB.rcss.width("100%"),(0,ew._)({},oY.mobileWidthContainerQuery,[nB.rcss.width("50%"),nB.rcss.colWithGap(6),{"&:first-child":{table:{borderRight:"1px solid "+e_.tokens.outlineDimmer}}}])],ghostRow:[nB.rcss.display.none,(0,ew._)({},oY.mobileWidthContainerQuery,nB.rcss.display.flex)]}),o1=function(e){var t=e.text,n=e.onClick;return(0,V.jsx)("button",{css:o0.textButton,onClick:n,children:t})};function o2(e){var t=e.hasPortsConfigured,n=e.hasPort80Configured,r=e.hasConflictingPorts,i=e.hasLocalhostPort80,o=e.openNetworkingPane;return t?n?r?(0,V.jsx)(nG.StatusBanner,{text:(0,V.jsxs)(V.Fragment,{children:["Potential port conflict. Make sure no External Ports have conflicts in your configuration and that you only have one External Port configured on port :80. Open the"," ",(0,V.jsx)(o1,{text:"Networking pane to resolve.",onClick:o})]}),colorway:"warning"}):i?(0,V.jsx)(nG.StatusBanner,{text:(0,V.jsxs)(V.Fragment,{children:["Hosting your deployment on localhost can cause security or performance issues in some cases. Open the"," ",(0,V.jsx)(o1,{text:"Networking pane to configure.",onClick:o})]}),colorway:"primary"}):(0,V.jsx)(nG.StatusBanner,{text:(0,V.jsxs)(V.Fragment,{children:["Deployment forwarding to External Port :80. Open the"," ",(0,V.jsx)(o1,{text:"Networking pane to configure.",onClick:o})]}),colorway:"primary"}):(0,V.jsx)(nG.StatusBanner,{text:(0,V.jsxs)(V.Fragment,{children:["Potential port issue. Deployments require an External Port configured on port :80. Open the"," ",(0,V.jsx)(o1,{text:"Networking pane to configure.",onClick:o})]}),colorway:"warning"}):(0,V.jsx)(nG.StatusBanner,{text:(0,V.jsxs)(V.Fragment,{children:["No ports configured. Deployments will automatically forward the first Internal Port that opens. Open the"," ",(0,V.jsx)(o1,{text:"Networking pane to configure.",onClick:o})]})})}var o3=function(e){return 80===(0,oX.getExternalPort)(e.configuration)};function o4(e){var t=e.portState,n=(0,oX.getIsLocalhost)(t.configuration),r=(0,oX.getExternalPort)(t.configuration),i=o3(t);return(0,V.jsxs)(V.Fragment,{children:[(0,V.jsxs)(oJ.Column,{width:"50%",children:[(0,V.jsx)(eO.Text,{children:n?"localhost":"0.0.0.0"}),i&&n?(0,V.jsx)(tE.default,{size:16,color:e_.colormap.primary.default}):null]}),(0,V.jsxs)(oJ.Column,{width:"50%",children:[(0,V.jsxs)(eO.Text,{children:[":",r]}),i?(0,V.jsx)(tT.default,{size:16,color:e_.colormap.positive.default}):(0,V.jsx)(nc.default,{size:16,color:e_.colormap.negative.default})]})]})}function o8(e){var t=e.ports,n=e.openNetworkingPane,r=e.onWarningChange,i=(0,oQ.default)(t.portsState),o=(null==i?void 0:i.filter(function(e){return(0,oX.getExternalPort)(e.configuration)}).sort(function(e,t){var n,r;return(null!=(n=(0,oX.getExternalPort)(e.configuration))?n:0)-(null!=(r=(0,oX.getExternalPort)(t.configuration))?r:0)}))||null,a=null==o?void 0:o.find(o3),s=!!a,l=!!(o&&o.length>0),u=!!o&&!!a&&!!(o.filter(o3).length>1||o.some(function(e){return(0,oX.getExternalPort)(e.configuration)===a.configuration.localPort})),c=!!(a&&(0,oX.getIsLocalhost)(a.configuration)),d=l&&!s||u;(0,F.useEffect)(function(){null==r||r(d)},[d,r]);var f=(0,B._)((0,F.useState)(!1),2),p=f[0],h=f[1];return(0,V.jsx)(oZ.AccordionItem,{headerContent:(0,V.jsxs)(eS.View,{gap:4,style:{flex:1,minWidth:0},children:[(0,V.jsxs)(eS.View,{row:!0,gap:8,align:"center",children:[(0,V.jsx)(eO.Text,{children:"Port configuration"}),d?(0,V.jsx)(tA.default,{size:16,color:e_.colormap.warning.strongest}):null]}),(0,V.jsx)(eS.View,{style:{maxWidth:"100%"},children:(0,V.jsx)(eO.Text,{color:"dimmer",variant:"small",multiline:!0,children:"Configure which port your app uses for incoming requests"})})]}),expanded:p,onClick:function(){return h(!p)},children:(0,V.jsxs)(eS.View,{css:o0.self,gap:8,children:[(0,V.jsx)(o2,{hasPortsConfigured:l,hasPort80Configured:s,hasConflictingPorts:u,hasLocalhostPort80:c,openNetworkingPane:n}),(0,V.jsx)(eS.View,{children:(0,V.jsxs)(eS.View,{css:o0.tableWrapper,children:[(0,V.jsxs)(eS.View,{css:o0.table,children:[(0,V.jsx)(eO.Text,{css:o0.tableHeader,children:"Deployment expects:"}),(0,V.jsxs)(oJ.Table,{children:[(0,V.jsxs)(oJ.Row,{children:[(0,V.jsx)(oJ.Column,{header:!0,width:"50%",children:"Host"}),(0,V.jsx)(oJ.Column,{header:!0,width:"50%",children:"External Port"})]}),(0,V.jsxs)(oJ.Row,{children:[(0,V.jsx)(oJ.Column,{width:"50%",children:(0,V.jsx)(eO.Text,{children:"0.0.0.0"})}),(0,V.jsxs)(oJ.Column,{width:"50%",children:[(0,V.jsx)(eO.Text,{children:":80"}),(0,V.jsx)(tT.default,{size:16,color:e_.colormap.positive.default})]})]}),l&&o?(0,oK.default)((null==o?void 0:o.length)-1).map(function(e){return(0,V.jsx)(oJ.Row,{css:o0.ghostRow,children:(0,V.jsx)(oJ.Column,{children:(0,V.jsx)(eO.Text,{children:""})})},e)}):null]})]}),(0,V.jsxs)(eS.View,{css:o0.table,children:[(0,V.jsx)(eO.Text,{css:o0.tableHeader,children:"Your External Port configuration(s):"}),(0,V.jsxs)(oJ.Table,{children:[(0,V.jsxs)(oJ.Row,{children:[(0,V.jsx)(oJ.Column,{header:!0,width:"50%",children:"Host"}),(0,V.jsx)(oJ.Column,{header:!0,width:"50%",children:"External Port"})]}),l?null==o?void 0:o.map(function(e){return(0,V.jsx)(oJ.Row,{children:(0,V.jsx)(o4,{portState:e})},e.configuration.localPort)}):(0,V.jsxs)(oJ.Row,{children:[(0,V.jsx)(oJ.Column,{width:"50%",children:(0,V.jsx)(eO.Text,{children:"-"})}),(0,V.jsx)(oJ.Column,{width:"50%",children:(0,V.jsx)(eO.Text,{children:"-"})})]})]})]})]})})]})})}e.s(["PortConfiguration",()=>o8],304484);var o5=e.i(596139),o6=e.i(968783),o9=e.i(574203),o7=e.i(325990),ae=e.i(428596),at=e.i(721321),an=e.i(987154),ar=(0,iP.cssRecord)({titleRow:[nB.rcss.gap(8),nB.rcss.align.center]});function ai(e){var t=e.privacyMode,n=e.setPrivacyMode,r=e.privatePassword,i=e.setPrivatePassword,o=e.privatePasswordError,a=e.hasExistingPrivatePassword,s=e.isRedeploy,l=(0,o7.useOrgFlag)({controlName:i4.flagEnableDeploymentPrivatePasswords}),u=(0,o6.useCurrentUserStoredOrgContext)(),c=u.loading,d=u.orgId,f=(0,o9.default)(d),p=f.requirePrivateDeployments,h=f.adminOnlyPublicDeployments,g=f.isAdmin,m=!c&&!d,x=p||!g&&h,y=(0,ae.useIdSeed)(),b=y("deployment-privacy-mode"),w=(0,B._)((0,F.useState)(!1),2),k=w[0],_=w[1],S=(0,F.useCallback)(function(e){switch(e){case i3.DeployHostingBuildPrivacyMode.Public:if(x)return;n(e),i(void 0),_(!1);break;case i3.DeployHostingBuildPrivacyMode.Private:n(e),i(void 0),_(!1);break;case i3.DeployHostingBuildPrivacyMode.Password:if(!l)return;n(e);break;default:(0,tu.default)(e)}},[i,n,x,l]),C=(0,F.useCallback)(function(){var e=!k;_(e),e?i(""):i(void 0)},[i,k]);return(0,V.jsx)(V.Fragment,{children:(0,V.jsx)(oM.Section,{id:"privateDeployments",variant:"vertical",title:(0,V.jsxs)(eS.View,{gap:8,children:[(0,V.jsx)(eS.View,{css:ar.titleRow,row:!0,children:(0,V.jsx)(eO.Text,{color:"dimmer",children:"Published App Access"})}),(0,V.jsxs)(eO.Text,{variant:"small",color:"dimmer",children:[m?(0,V.jsx)(V.Fragment,{children:"Limit published app access to team members."}):(0,V.jsxs)(V.Fragment,{children:["Limit published app access to team members who have viewer access.",s?" Visibility changes apply after you publish. ":" "]})," ",(0,V.jsx)("a",{target:"_blank",href:"https://docs.replit.com/cloud-services/deployments/private-deployments",children:"Learn more"})]})]}),children:(0,V.jsxs)(V.Fragment,{children:[(0,V.jsx)(eS.View,{children:(0,V.jsxs)(at.ButtonGroup,{id:b,name:b,value:t,onChange:S,row:!0,stretch:!0,children:[(0,V.jsx)(at.ButtonGroupItem,{id:y("public"),value:i3.DeployHostingBuildPrivacyMode.Public,text:(0,V.jsx)(V.Fragment,{children:(0,V.jsx)(tj.Tooltip,{isDisabled:!x,tooltip:p?"Private publishing is required for this organization.":"Only admins can publish public apps.",children:"Public"})}),icon:(0,V.jsx)(an.default,{}),disabled:!!x}),l?(0,V.jsx)(at.ButtonGroupItem,{id:y("password"),value:i3.DeployHostingBuildPrivacyMode.Password,text:"Password",icon:(0,V.jsx)(tQ.default,{})}):null,(0,V.jsx)(at.ButtonGroupItem,{id:y("private"),value:i3.DeployHostingBuildPrivacyMode.Private,text:(0,V.jsx)(tj.Tooltip,{tooltip:"Private Published Apps are only available on Replit ".concat(o5.replitTeamsPlanName,"."),children:(0,V.jsxs)(eS.View,{row:!0,gap:4,align:"center",justify:"center",children:["Private ",(0,V.jsx)(tY.Pill,{text:"Teams",colorway:"primary",compact:!0})]})}),icon:(0,V.jsx)(tX.default,{})})]})}),l&&t===i3.DeployHostingBuildPrivacyMode.Password?(0,V.jsx)(eS.View,{children:!a||k?(0,V.jsx)(ou.DeploymentPrivatePasswordInput,{value:null!=r?r:"",onChange:i,error:o}):(0,V.jsx)(tB.Button,{text:"Change password",onClick:C,size:"small"})}):null]})})})}function ao(e){var t=e.value,n=e.onChange,r=e.loading,i=e.disabled,o=e.error;return(0,V.jsxs)(eS.View,{gap:8,children:[(0,V.jsx)(eO.Text,{children:"Public directory"}),(0,V.jsx)(eO.Text,{color:"dimmer",variant:"small",multiline:!0,children:"Public directory is the folder where the browser should start when serving your static site"}),(0,V.jsx)(ou.CommandInput,{id:"publicDir",value:t,onChange:n,loading:void 0!==r&&r,disabled:void 0!==i&&i,error:o})]})}function aa(e){var t=e.value,n=e.onChange,r=e.loading,i=e.disabled,o=e.error;return(0,V.jsxs)(eS.View,{gap:8,children:[(0,V.jsxs)(eS.View,{gap:4,children:[(0,V.jsx)(eO.Text,{children:"Run command"}),(0,V.jsx)(eO.Text,{color:"dimmer",variant:"small",multiline:!0,children:"Starts your app after it deploys"})]}),(0,V.jsx)(ou.CommandInput,{id:"runCommand",value:t,onChange:n,loading:void 0!==r&&r,disabled:void 0!==i&&i,error:o})]})}e.s(["default",()=>ai],264646),e.s(["PublicDirectorySection",()=>ao],802436),e.s(["RunCommandSection",()=>aa],620365);var as=e.i(398594),al=e.i(507491),au=e.i(452412),ac=e.i(951262);function ad(){var e=(0,nE._)(["\n  mutation CreateDeployedSlackAgentInstallUrl(\n    $input: CreateDeployedSlackAgentInstallUrlInput!\n  ) {\n    createDeployedSlackAgentInstallUrl(input: $input) {\n      __typename\n      ... on CreateDeployedSlackAgentInstallUrl {\n        installUrl\n      }\n      ... on UserError {\n        message\n      }\n    }\n  }\n"]);return ad=function(){return e},e}var af={},ap=(0,nR.gql)(ad());function ah(){var e=(0,nE._)(["\n  query GetSlackAgentBuilderDeploymentStatus(\n    $connectionId: String!\n    $orgId: String\n  ) {\n    getSlackAgentBuilderDeploymentStatus(\n      connectionId: $connectionId\n      orgId: $orgId\n    ) {\n      __typename\n      ... on SlackAgentBuilderDeploymentStatus {\n        connectionId\n        status\n      }\n      ... on NotFoundError {\n        message\n      }\n      ... on UnauthorizedError {\n        message\n      }\n    }\n  }\n"]);return ah=function(){return e},e}var ag={},am=(0,nR.gql)(ah()),av=e.i(41660),ax=e.i(379846),ay=(0,F.memo)(function(e){var t=e.isOpen,n=e.setIsOpen,r=e.token,i=e.selectedConnector,o=e.onEvent,a=(0,F.useCallback)(function(){n(!1)},[n]),s=(0,F.useMemo)(function(){return{view:"add",hideNavigation:!0,autoConnect:i?i.toLowerCase().replace(/_/g,"-"):void 0}},[i]),l=(0,F.useCallback)(function(e,t){return(0,ei._)(function(){return(0,eo._)(this,function(n){switch(n.label){case 0:return[4,o(e,t)];case 1:return n.sent(),[2]}})})()},[o]);return(0,V.jsx)(ax.EmbedModal,{isOpen:t,onRequestClose:a,maxWidth:400,maxHeight:600,centered:!0,children:(0,V.jsx)(av.ConnectEmbed,{token:r,connectOptions:s,onEvent:l,height:600,baseURL:"https://replit.openint.dev/connect"})})});ay.displayName="AddIntegrationModal";var ab=e.i(283660),aw=e.i(627950),ak={incomplete:"Grant Replit Agent Builder access to your Slack workspace",complete:"Replit Agent Builder installed"},a_={incomplete:"Add your agent to Slack",complete:"Agent added to Slack workspace"},aS={incomplete:"Invite to your Slack channels",complete:"Invited agent to Slack channels"};function aC(e){var t=e.isConnected,n=e.connectionStatusLoading,r=e.state,i=e.onPreconnectClick,o=e.onInstallClick,a=(0,B._)((0,F.useState)(!1),2),s=a[0],l=a[1],u=(0,B._)((0,F.useState)(!1),2),c=u[0],d=u[1],f=(0,B._)((0,F.useState)(!1),2),p=f[0],h=f[1],g=(0,F.useCallback)(function(){i(),l(!0)},[i]),m=(0,F.useCallback)(function(){o(),d(!0)},[o]),x=function(){switch(r){case"PRECONNECT":return{preconnectStepState:i9.ACTIVE,installStepState:i9.INACTIVE,inviteStepState:i9.INACTIVE,publishStepState:i9.INACTIVE};case"INSTALL":return{preconnectStepState:i9.COMPLETE,installStepState:i9.ACTIVE,inviteStepState:i9.INACTIVE,publishStepState:i9.INACTIVE};case"DONE":if(p)return{preconnectStepState:i9.COMPLETE,installStepState:i9.COMPLETE,inviteStepState:i9.COMPLETE,publishStepState:i9.ACTIVE};return{preconnectStepState:i9.COMPLETE,installStepState:i9.COMPLETE,inviteStepState:i9.ACTIVE,publishStepState:i9.COMPLETE}}}(),y=x.preconnectStepState,b=x.installStepState,w=x.inviteStepState,k=x.publishStepState,_=ak[y===i9.COMPLETE?"complete":"incomplete"],S=a_[b===i9.COMPLETE?"complete":"incomplete"],C=aS[w===i9.COMPLETE?"complete":"incomplete"];return(0,V.jsx)(eS.View,{gap:8,children:(0,V.jsxs)(eD.Surface,{className:aw.default.connectionContainer,children:[(0,V.jsxs)(eS.View,{className:aw.default.statusContainer,row:!0,justify:"space-between",align:"center",py:8,px:16,children:[(0,V.jsx)(eO.Text,{children:"Slack connection status"}),(0,V.jsx)(eS.View,{row:!0,gap:8,align:"center",children:n?(0,V.jsxs)(V.Fragment,{children:[(0,V.jsx)(tI.default,{}),(0,V.jsx)(eO.Text,{color:"dimmer",children:"Loading..."})]}):(0,V.jsxs)(V.Fragment,{children:[(0,V.jsx)(ab.default,{size:8,color:t?e_.tokens.greenStronger:e_.tokens.greyStronger}),(0,V.jsx)(eO.Text,{color:"dimmer",children:t?"Connected":"Not connected"})]})})]}),(0,V.jsx)(i7,{state:y,number:1,title:_,p:8,pb:"ACTIVE"===y?16:8,children:(0,V.jsxs)(eS.View,{row:!0,gap:12,children:[(0,V.jsx)(tB.Button,{colorway:"primary",size:"small",iconRight:(0,V.jsx)(oU.default,{}),text:"Add to Slack",onClick:g}),s?(0,V.jsxs)(eS.View,{row:!0,gap:4,align:"center",children:[(0,V.jsx)(tI.default,{color:e_.tokens.foregroundDimmest}),(0,V.jsx)(eO.Text,{color:"dimmest",variant:"small",children:"Waiting for access"})]}):null]})}),(0,V.jsx)(i7,{state:b,number:2,title:S,p:8,pb:"ACTIVE"===b?16:8,children:(0,V.jsxs)(eS.View,{row:!0,gap:12,children:[(0,V.jsx)(tB.Button,{colorway:"primary",size:"small",iconRight:(0,V.jsx)(oU.default,{}),text:"Install agent",onClick:m}),c?(0,V.jsxs)(eS.View,{row:!0,gap:4,align:"center",children:[(0,V.jsx)(tI.default,{color:e_.tokens.foregroundDimmest}),(0,V.jsx)(eO.Text,{color:"dimmest",variant:"small",children:"Waiting for installation"})]}):null]})}),(0,V.jsx)(i7,{state:w,number:3,title:C,p:8,pb:"ACTIVE"===w?16:8,children:(0,V.jsxs)(eS.View,{gap:8,children:[(0,V.jsxs)(eO.Text,{color:"dimmest",children:["Type",(0,V.jsx)(eO.Text,{variant:"code",color:"dimmest",className:aw.default.inlineCode,children:"/invite"})," ","to invite your agent into the channels you want to use it in."]}),(0,V.jsx)(eS.View,{row:!0,children:(0,V.jsx)(tB.Button,{colorway:"primary",size:"small",text:"Continue",onClick:function(){return h(!0)}})})]})}),(0,V.jsx)(i7,{state:k,number:4,title:"Publish",p:8,pb:16,showChildren:!0,children:(0,V.jsx)(eO.Text,{color:"dimmest",multiline:!0,children:t?"Press publish to start using your agent":"Connect to your Slack workspace to enable publishing"})})]})})}var aj=e.i(58261);function aT(){var e=(0,aj.useConnectorContext)(),t=e.connections,n=e.loading,r=(0,el.default)();return{connection:t.find(function(e){var t;return(null==(t=e.repls)?void 0:t.find(function(e){return e.id===r}))&&(e.connectorName===iF.ConnectorName.SlackAgent||e.connectorName===iF.ConnectorName.SlackAgentBuilder)}),loading:n}}e.s(["useIsSlackConnected",()=>aT],912467);var aE=e.i(57613);function aR(){return(0,V.jsx)(aE.default,{bsod:!1,fallback:function(e){return(0,V.jsx)(eS.View,{p:16,children:(0,V.jsx)(nG.StatusBanner,{colorway:"red",text:"An unexpected error occurred while setting up the Slack connection: ".concat(e.message)})})},reportToSentry:!0,origin:"ErrorBoundary: SlackConnectorSetup",children:(0,V.jsx)(aI,{})})}function aI(){var e,t,n,r,i,o,a,s,l,u=aT(),c=u.connection,d=u.loading,f=(0,aj.useConnectorContext)(),p=f.connections,h=f.refetch,g=f.error,m=f.token,x=f.loading,y=(0,el.default)(),b=(0,o6.useCurrentUserStoredOrgContext)().orgId,w=(0,B._)((0,F.useState)(!1),2),k=w[0],_=w[1],S=(0,B._)((0,F.useState)(null),2),C=S[0],j=S[1],T=(0,B._)((0,F.useState)(!1),2),E=T[0],R=T[1],I=(0,F.useRef)(null),A=(0,B._)((e=(0,N._)({},af,void 0),ac.useMutation(ap,e)),1)[0],P=(n=(t={replId:y,orgId:b||null,onConnectionCreated:function(){h()}}).replId,r=t.orgId,i=t.onConnectionCreated,o=(0,B._)((0,al.useCreateConnectionMutation)(),1)[0],{handleConnectionEvent:function(e){return(0,ei._)(function(){return(0,eo._)(this,function(t){switch(t.label){case 0:if("connect.connection-connected"!==e.name)return[3,2];return[4,o({variables:{input:{connectionId:e.data.connection_id,orgId:r||null,replId:n}},update:function(t,n){var r=n.data;if((null==r||null==(i=r.createConnection)?void 0:i.__typename)==="CreateConnection")try{var i,o,a=t.readQuery({query:al.UserConnectorsPageDocument});if((null==a||null==(o=a.currentUser)?void 0:o.__typename)==="CurrentUser"){var s={__typename:"OintConnection",connectionId:e.data.connection_id,connectionName:e.data.connection_id.split("_")[1],connectionType:e.data.connection_id.split("_")[1],iconPath:null,status:"connected",scopes:[],repls:[]};t.writeQuery({query:al.UserConnectorsPageDocument,data:{currentUser:(0,M._)((0,N._)({},a.currentUser),{connectorContext:(0,M._)((0,N._)({},a.currentUser.connectorContext),{connections:(0,H._)(a.currentUser.connectorContext.connections).concat([s])})})}})}}catch(e){}}})];case 1:t.sent(),null==i||i(),t.label=2;case 2:return[2]}})})()}}).handleConnectionEvent;(0,F.useEffect)(function(){if(p.length>0){var e=p.find(function(e){var t;return e.connectorName===iF.ConnectorName.SlackAgentBuilder&&(null==(t=e.repls)?void 0:t.some(function(e){return e.id===y}))});e&&j(e)}},[p,y]);var D=(a={variables:{connectionId:(null==C?void 0:C.connectionId)||"",orgId:b||void 0},skip:!C,pollInterval:2e3*!!E},s=(0,N._)({},ag,a),nI.useQuery(am,s)).data,O=(null==D||null==(l=D.getSlackAgentBuilderDeploymentStatus)?void 0:l.__typename)==="SlackAgentBuilderDeploymentStatus"?D.getSlackAgentBuilderDeploymentStatus.status:null,L=C?"connected"===O?"DONE":"INSTALL":"PRECONNECT";if(g)throw Error("Failed to load connector context");var U=(0,F.useCallback)(function(e,t){return(0,ei._)(function(){return(0,eo._)(this,function(n){switch(n.label){case 0:return I.current=t,[4,P(e)];case 1:return n.sent(),"connect.connection-connected"===e.name&&(_(!1),t(),I.current=null),[2]}})})()},[P]);return((0,F.useEffect)(function(){"connected"===O&&E&&R(!1)},[O,E]),(0,F.useEffect)(function(){return function(){I.current&&I.current()}},[]),x)?(0,V.jsx)(tI.default,{}):(0,V.jsxs)(V.Fragment,{children:[(0,V.jsx)(aC,{isConnected:!!c,connectionStatusLoading:d,state:L,onPreconnectClick:function(){return _(!0)},onInstallClick:function(){return(0,ei._)(function(){var e,t,n,r,i;return(0,eo._)(this,function(o){switch(o.label){case 0:if(!C)return[2];o.label=1;case 1:return o.trys.push([1,3,,4]),[4,A({variables:{input:{connectionId:C.connectionId,replId:y,appName:"Replit Agent",appDescription:"A Replit agent for Slack",orgId:b||void 0}}})];case 2:return(null==(t=(n=o.sent()).data)||null==(e=t.createDeployedSlackAgentInstallUrl)?void 0:e.__typename)==="CreateDeployedSlackAgentInstallUrl"&&(r=n.data.createDeployedSlackAgentInstallUrl.installUrl,window.open(r,"_blank"),R(!0)),[3,4];case 3:throw i=o.sent(),R(!1),i;case 4:return[2]}})})()}}),(0,V.jsx)(ay,{isOpen:k,setIsOpen:_,token:m||"",selectedConnector:"slack-agent-builder",onEvent:U})]})}e.i(653863);var aA=e.i(973519),aP=e.i(488014),aD=e.i(860302);function aO(e){var t=e.onDeleteDeployment,n=aT(),r=n.connection,i=n.loading,o=(0,aj.useConnectorContext)().refetch,a=!!r,s=(0,el.default)(),l=(0,aA.useGlobalModal)().show,u=(0,te.useFlag)({controlName:"flag-new-slack-connector",default:!1}),c=!!(0,iW.useDeploymentCurrentBuild)(),d=(0,F.useCallback)(function(){u||l("SlackConnectorSetupModalDeprecated",{replId:s})},[s,l,u]),f=(0,B._)((0,al.useDeleteConnectionMutation)(),2),p=f[0],h=f[1].loading,g=(0,B._)((0,F.useState)(!1),2),m=g[0],x=g[1],y=(0,B._)((0,F.useState)(!1),2),b=y[0],w=y[1],k=(0,F.useCallback)(function(){c?l("AgentStackDisconnectModal",{onDeleteDeployment:t}):x(!0)},[c,l,t]),_=(0,F.useCallback)(function(){return(0,ei._)(function(){return(0,eo._)(this,function(e){switch(e.label){case 0:if(!r)throw Error("No connection to delete");return w(!0),x(!1),[4,p({variables:{input:{connectionId:r.connectionId}}})];case 1:return e.sent(),[4,o()];case 2:return e.sent(),[2]}})})()},[p,r,o]);if(u&&(!a||b))return(0,V.jsx)(aR,{});var S=h||i?(0,V.jsx)(eS.View,{clsx:(0,ew._)({},aD.default.hidden,i),children:(0,V.jsx)(tB.Button,{variant:"outlined",text:i?"Loading":"Disconnecting",size:"small",iconLeft:(0,V.jsx)(tI.default,{}),disabled:!0})}):a?(0,V.jsx)(eS.View,{children:(0,V.jsx)(tB.Button,{text:"Disconnect",size:"small",variant:"outlined",onClick:k})}):(0,V.jsx)(tB.Button,{text:"Connect to Slack",size:"small",iconLeft:(0,V.jsx)(aP.default,{}),colorway:"primary",onClick:d});return(0,V.jsxs)(eS.View,{gap:8,children:[(0,V.jsx)(eO.Text,{children:"Slack connection status"}),(0,V.jsx)(eD.Surface,{elevated:!0,className:aD.default.radiusDefault,children:(0,V.jsxs)(eS.View,{row:!0,justify:"space-between",align:"center",p:8,children:[(0,V.jsx)(eS.View,{row:!0,gap:8,align:"center",children:i?(0,V.jsxs)(V.Fragment,{children:[(0,V.jsx)(tI.default,{}),(0,V.jsx)(eO.Text,{color:"dimmer",children:"Loading"})]}):(0,V.jsxs)(V.Fragment,{children:[(0,V.jsx)(ab.default,{size:8,color:a?e_.tokens.greenStronger:e_.tokens.greyStronger}),(0,V.jsx)(eO.Text,{color:"dimmer",children:a?"Connected":"Not connected"})]})}),S]})}),a||i?null:(0,V.jsx)(eO.Text,{variant:"small",color:"dimmer",children:"Connect to your Slack workspace to enable publishing."}),(0,V.jsx)(eP.Modal,{isOpen:m,onRequestClose:function(){return x(!1)},children:(0,V.jsx)(au.default,{title:"Disconnect from Slack",confirmLabel:"Yes, disconnect from Slack",isDestructive:!0,onConfirm:_,onCancel:function(){return x(!1)},children:"Are you sure you want to disconnect from Slack? You can reconnect at any time but you may need to request permission from your admin."})})]})}e.s(["default",()=>aO],147255);var aN=e.i(611159),aM=e.i(32144),aL="SCHEDULE_CRON_EXPRESSION",aB="SCHEDULE_CRON_TIMEZONE";function aV(e){return e.some(function(e){return e.name===aL&&null!==e.value&&(0,aN.isValidCron)(e.value)})}var aF=function(e){var t,n,r,i,o=e.envVars,a=e.updateEnvVarValue,s=e.addAnEnvVar,l=e.initialized,u=void 0===(0,iW.useDeploymentCurrentBuild)(),c=(0,F.useRef)(null),d=(0,F.useRef)(null),f=(0,F.useCallback)(function(e){if(null===c.current){var t=o.findIndex(function(e){return e.name===aL});if(-1===t){c.current=o.length,s({name:aL,value:null!=e?e:""});return}c.current=t}a(c.current,null!=e?e:"")},[s,o,a,c]),p=(0,F.useCallback)(function(e){if(null===d.current){var t=o.findIndex(function(e){return e.name===aB});if(-1===t){d.current=o.length,s({name:aB,value:null!=e?e:""});return}d.current=t}a(d.current,null!=e?e:"")},[s,o,a]),h=null!=(r=null==(t=o.find(function(e){return e.name===aL}))?void 0:t.value)?r:null,g=null!=(i=null==(n=o.find(function(e){return e.name===aB}))?void 0:n.value)?i:null,m=(0,aM.useCronExpressionWithTranslation)({initialCrontab:h,initialTimezone:g,onCrontabChange:f,onTimezoneChange:p}),x=m.describeSchedule,y=m.crontab,b=m.timezone,w=m.error,k=m.loading,_=m.scheduleToCronExpression,S=m.cronExpressionToSchedule,C=m.setCrontab,j=m.setTimezone,T=m.handleOnInputChanged,E=m.setTranslationType;return(0,V.jsxs)(eS.View,{gap:8,children:[w?(0,V.jsx)(aM.CronExpressionErrorFallback,{crontab:y,timezone:b,cronLoading:!1,error:w,onCronExpressionChange:C,onTimezoneChange:j}):(0,V.jsx)(aM.CronExpressionInterface,{describeSchedule:x,crontab:y,timezone:b,loading:k,cronLoading:!l,scheduleToCronExpression:_,cronExpressionToSchedule:S,onScheduleDescriptionChange:function(e){return T(e,"scheduleToCronExpression")},onCronExpressionChange:function(e){return T(e,"cronExpressionToSchedule")},onTimezoneChange:j,onScheduleDescriptionFocus:function(){return E("scheduleToCronExpression")},onCronExpressionFocus:function(){return E("cronExpressionToSchedule")}}),u?(0,V.jsx)(eO.Text,{variant:"small",color:"dimmer",children:"Set a schedule to deploy your agent."}):null]})};e.s(["TimeBasedAgentScheduleSection",()=>aF,"hasValidCronExpression",()=>aV],475868);var aU=e.i(976191),aG=e.i(315315),a$=e.i(492267),az=e.i(293265),aH=e.i(503536),aW=e.i(292642),aq=(0,iP.cssRecord)({self:nB.rcss.colWithGap(16),footer:nB.rcss.colWithGap(0),deployButton:nB.rcss.flex.grow(1),statusBanner:[nB.rcss.textBalance,nB.rcss.flex.shrink(1)]}),aK=function(e){var t=e.deploymentId,n=e.replId,r=e.initialSubdomain,i=e.initialProvider,o=e.initialMachineConfig,a=e.secrets,s=e.fs,l=e.ports,u=e.dotReplit,c=e.onDeploy,d=e.onCancel,f=e.onError,p=e.initialSecretsSyncExpanded,h=e.openNetworkingPane,g=e.hasAgentSession,m=e.onViewAction,x=(0,aU.useDeploymentOptionsState)({deploymentId:t,replId:n,initialSubdomain:r,initialProvider:i,initialMachineConfig:o,secrets:a,fs:s,dotReplit:u,onDeploy:c,onError:f,hasAgentSession:g}),y=x.mode,b=x.deployment,w=x.queryLoading,k=x.optionsLoading,_=x.currentBuild,S=x.isRedeploy,C=x.editDeploySecretAuthorization,j=x.editReplSecretsAuthorization,T=x.appType,E=x.subdomain,R=x.validSubdomain,I=x.buildCommand,A=x.runCommand,P=x.runCommandError,D=x.timezone,O=x.timezoneError,N=x.crontab,M=x.crontabError,L=x.envVars,U=x.publicDir,G=x.publicDirError,$=x.timeoutValue,z=x.timeoutUnits,H=x.isPrivate,W=x.privacyMode,q=x.privatePassword,K=x.privatePasswordError,Y=x.hasExistingPrivatePassword,Q=x.ignoredSecrets,X=x.isOverwritingSecrets,J=x.isOverwriteSecretsModalOpen,Z=x.devSecrets,ee=x.orgId,et=x.timeoutValueError,en=x.canCreateNeonProductionDatabaseStateLoading,er=x.provider,ei=x.machineConfig,eo=x.setSubdomain,ea=x.setValidSubdomain,es=x.setBuildCommand,el=x.setRunCommand,eu=x.setTimezone,ec=x.setCrontab,ed=x.setPublicDir,ef=x.setPrivacyMode,ep=x.setPrivatePassword,eh=x.setTimeoutValue,eg=x.setTimeoutUnits,em=x.setTimeoutValueError,ev=x.setIsOverwriteSecretsModalOpen,ex=x.setProvider,ey=x.setMachineConfig,eb=x.createNeonProductionDatabase,ew=x.setCreateNeonProductionDatabase,ek=x.pushDevelopmentDatabaseObjects,e_=x.setPushDevelopmentDatabaseObjects,eC=x.overwriteData,ej=x.setOverwriteData,eT=x.createNeonProductionDatabaseState,eE=x.onAppTypeChanged,eR=x.onSubdomainBlur,eI=x.addAnEnvVar,eA=x.updateEnvVarName,eD=x.updateEnvVarValue,eN=x.removeEnvVar,eM=x.handleDeployClick,eL=x.optOut,eB=x.optIn,eV=x.syncToWorkspace,eF=x.overwriteSecrets,eU=er!==i3.HostingBuildProvider.Cron&&!(null==b?void 0:b.replitAppSubdomain),eG=(0,(0,iW.useDeploymentDeployability)().getDeployabilityByProvider)(er,H),e$=S?eG.redeploy.isAuthorized:eG.deploy.isAuthorized,ez=(0,iW.useDeploymentProvider)({onError:f,dotReplitService:u}),eH=ez.recommendedProvider,eW=ez.loading,eq=k||eW,eK=w||eq||y===iK.DeploymentMode.Preparing||et,eY=(0,a$.useIsAgentStackRepl)().isAgentStackRepl,eQ=(0,az.useAgentStackPlatformType)().agentStackPlatformType,eX=eK||!e$||en||eU&&!R,eJ=function(){m({type:iR.ViewActionType.SendDeploymentLifecycleCommand,payload:{command:iF.SendDeploymentLifecycleCommandType.Destroy}})},eZ=L.map(function(e){return e.name}),e0=(0,V.jsx)(oT.CreateNeonProductionDatabaseToggleSection,{createDatabase:eb,setCreateDatabase:ew,pushDevelopmentDatabaseObjects:ek,setPushDevelopmentDatabaseObjects:e_,overwriteData:eC,setOverwriteData:ej,tooltipText:eT.tooltipText,warningText:eT.warningText,disabled:eT.isDisabled,isRedeploy:S}),e1=(0,V.jsxs)(oc.LabeledSectionWithHover,{id:"envVars",title:"Production app secrets",information:"Secrets, or environment variables, are private keys you can use to access APIs and services",children:[ee?(0,V.jsx)(nG.StatusBanner,{icon:(0,V.jsx)(aW.default,{}),css:aq.statusBanner,colorway:"primary",text:"Secrets now sync automatically with your team's published apps. "+"Production app secrets added before ".concat((0,aG.formatDateTime)(i4.SYNCING_SECRETS_ROLLOUT_DATE.toISOString())," ")+"remain unchanged to avoid disrupting existing workflows. Manage syncing below."}):null,(0,V.jsx)(oN,{envVars:L,envVarKeys:eZ,updateEnvVarName:eA,updateEnvVarValue:eD,removeEnvVar:eN,addAnEnvVar:eI,baseDisableState:eK,devSecrets:Z,ignoredSecrets:Q,editReplSecretsAuthorization:j,editDeploySecretAuthorization:C,optOut:eL,optIn:eB,syncToWorkspace:eV,queryLoading:w,replId:n,initialSecretsSyncExpanded:p})]}),e2=(0,te.useFlag)({controlName:"flag-depl-switcheroo",default:!1})&&i===i3.HostingBuildProvider.Static,e3=(0,B._)((0,F.useState)(!1),2),e4=e3[0],e8=e3[1];if(e4)return(0,V.jsx)(ox,{isAzureDeployment:er===i3.HostingBuildProvider.AzureContainerApp||er===i3.HostingBuildProvider.AzureVm,onError:f,onConfirm:function(e){ey(e),e8(!1)},onCancel:function(){return e8(!1)}});var e5=function(){if(eq)return(0,V.jsxs)(V.Fragment,{children:[(0,V.jsx)(oc.LabeledSectionWithHoverLoading,{}),(0,V.jsx)(oc.LabeledSectionWithHoverLoading,{}),(0,V.jsx)(oc.LabeledSectionWithHoverLoading,{})]});if(eY)switch(eQ){case iF.AgentStackPlatformType.Slack:return(0,V.jsxs)(V.Fragment,{children:[(0,V.jsx)(aO,{onDeleteDeployment:eJ}),e0,e1]});case iF.AgentStackPlatformType.Telegram:return(0,V.jsxs)(V.Fragment,{children:[(0,V.jsx)(os,{}),e0,e1]});case iF.AgentStackPlatformType.TimeBased:return(0,V.jsxs)(V.Fragment,{children:[(0,V.jsx)(aF,{envVars:L,updateEnvVarValue:eD,addAnEnvVar:eI,removeEnvVar:eN,initialized:!eq}),e0,e1]})}var e=er!==i3.HostingBuildProvider.Static,n=er===i3.HostingBuildProvider.Gce,r=er===i3.HostingBuildProvider.Static,i=er===i3.HostingBuildProvider.Cron,o=er===i3.HostingBuildProvider.Gce&&T===i3.DeployHostingBuildAppType.Server||er===i3.HostingBuildProvider.CloudRun,a=er!==i3.HostingBuildProvider.Cron,s=e2&&[i3.HostingBuildProvider.Gce,i3.HostingBuildProvider.AzureVm,i3.HostingBuildProvider.CloudRun,i3.HostingBuildProvider.AzureContainerApp].includes(er);return(0,V.jsxs)(V.Fragment,{children:[i?(0,V.jsx)(as.ScheduledMachineConfiguration,{crontab:N,setCrontab:ec,crontabError:M,timezone:D,setTimezone:eu,timezoneError:O,loading:w,timeoutValue:$,setTimeoutValue:eh,timeoutUnits:z,setTimeoutUnits:eg,setTimeoutValueError:em}):null,eU?(0,V.jsx)(oc.LabeledSectionWithHover,{id:"primaryDomain",title:"Primary domain",information:"You can add more custom domains after publishing",children:(0,V.jsx)(ou.PrimaryDomainInput,{id:"primaryDomain",subdomain:E,provider:er,deploymentId:t||void 0,onChange:eo,onBlur:eR,updateValidity:ea})}):null,a?(0,V.jsx)(ai,{privacyMode:W,setPrivacyMode:ef,privatePassword:q,setPrivatePassword:ep,privatePasswordError:K,hasExistingPrivatePassword:Y,isRedeploy:S}):null,e2?(0,V.jsx)(oj,{provider:er,setProvider:function(e){ey(null),ex(e)},recommendedProvider:eH,excludedProviders:[i3.HostingBuildProvider.Cron]}):null,s?(0,V.jsx)(oq,{provider:er,machineConfig:ei,setMachineConfig:ey,onError:f,onEditAutoscaleConfig:function(){return e8(!0)}}):null,r?(0,V.jsx)(ao,{value:U,onChange:ed,loading:eq,disabled:eK,error:G}):null,(0,V.jsx)(oy,{value:I,onChange:es,loading:eq,disabled:eK}),e?(0,V.jsx)(aa,{value:A,onChange:el,loading:eq,disabled:eK,error:P}):null,e0,e1,n?(0,V.jsx)(oc.LabeledSectionWithHover,{id:"deploymentAppType",title:"App type",information:"Configure your app based on whether it needs to serve traffic from the web.",children:(0,V.jsx)(ou.DeploymentTargetSelector,{appType:T,onChange:eE})}):null,o?(0,V.jsx)(o8,{ports:l,openNetworkingPane:h}):null,(0,V.jsx)(oV,{})]})}();return(0,V.jsxs)(V.Fragment,{children:[(0,V.jsxs)(eS.View,{css:aq.self,children:[e5,(0,V.jsxs)(eS.View,{css:aq.footer,children:[(0,V.jsx)(o$,{deployability:eG,isRedeploy:S}),(0,V.jsxs)(eS.View,{pt:12,row:!0,gap:8,children:[_?(0,V.jsx)(tB.Button,{text:"Cancel",onClick:d}):null,(0,V.jsx)(eS.View,{css:aq.deployButton,children:(0,V.jsx)(tB.Button,{colorway:"primary",onClick:function(){eM(eU)},text:y===iK.DeploymentMode.Preparing&&"Preparing..."||eq&&"Fetching options..."||"Publish",iconLeft:eq||y===iK.DeploymentMode.Preparing?(0,V.jsx)(tI.default,{}):(0,V.jsx)(aH.default,{}),disabled:eX})})]})]})]}),(0,V.jsx)(eP.Modal,{isOpen:J,onRequestClose:function(){X||ev(!1)},children:(0,V.jsxs)(eS.View,{gap:8,children:[(0,V.jsx)(eO.Text,{variant:"subheadBig",children:"Copy secrets from Published app to Development?"}),(0,V.jsx)(eO.Text,{children:"Are you sure you want to copy all of your secrets from Published app to Development? Secrets already present in Development will be overwritten and lost permanently."}),(0,V.jsxs)(eS.View,{pt:8,row:!0,gap:8,justify:"end",children:[(0,V.jsx)(tB.Button,{text:"Cancel",disabled:X,onClick:function(){ev(!1)}}),(0,V.jsx)(tB.Button,{text:"Yes, copy secrets",colorway:"negative",disabled:X,loading:X,onClick:eF})]})]})})]})},aY=(0,iP.cssRecord)({self:nB.rcss.colWithGap(8),ctaGroup:{flexDirection:"row",gap:8,flexWrap:"wrap"},deployOptions:[nB.rcss.borderRadius(8),nB.rcss.border({color:e_.tokens.outlineDimmest})]}),aQ=function(e){var t,n,r,i,o,a,s,l,u,c,d,f,p,h,g,m,x,y,b,w,k=e.deploymentId,_=e.replId,S=e.dotReplit,C=e.fs,j=e.ports,T=e.secrets,E=e.onError,R=e.expanded,I=e.setExpanded,A=e.shouldShowMobileTour,P=e.onDismissMobileTour,D=e.openNetworkingPane,O=e.onResume,M=e.hasAgentSession,L=e.onViewAction,U=(0,iY.useTrackClick)().trackClick,G=(0,iW.useDeployBuild)().redeployWithNoNewOptions,$=(0,iW.useSetDeploymentTriggerSource)(),z=(0,iq.useDeploymentMode)(),H=(i=(t={deploymentId:k,dotReplit:S}).deploymentId,o=t.dotReplit,s=(a=(0,B._)((0,F.useState)(null),2))[0],l=a[1],(0,F.useEffect)(function(){var e=!1;return(0,ei._)(function(){var t;return(0,eo._)(this,function(n){switch(n.label){case 0:return[4,(0,i0.getDotReplitDeploymentConfig)(o)];case 1:if(t=n.sent(),e)return[2];return l(t),[2]}})})(),function(){e=!0}},[o]),u=s,p=(c={variables:{id:i},ssr:!1,fetchPolicy:"cache-and-network"},d=(0,N._)({},iz,c),f=nI.useQuery(iH,d)).data,h=f.loading,g=f.error,m=(null==p||null==(n=p.hostingDeployment)?void 0:n.__typename)==="HostingDeployment"?p.hostingDeployment:null,(null==p||null==(r=p.hostingDeployment)?void 0:r.__typename)==="NotFoundError"?{deployment:null,config:null,error:"Published app not found",loading:!1}:null===u||!m&&h?{data:null,erorr:null,loading:!0}:g||!m?{deployment:null,config:null,error:"Something went wrong",loading:!1}:{deployment:m,config:u,error:null,loading:!1}),W=(0,iW.useDeploymentDeployability)().deployability,q=null==(x=H.deployment)?void 0:x.currentBuild,K=(0,i1.useDevSecrets)({secrets:T,replId:_}).devSecrets,Y=null==(y=H.deployment)?void 0:y.currentBuild.envVars,Q=null==(b=H.deployment)?void 0:b.repl.authorizations.editSecrets.isAuthorized,X=null==(w=H.deployment)?void 0:w.repl.authorizations.editDeploymentSecrets.isAuthorized,J=(0,F.useMemo)(function(){return K&&Y&&Q&&X?oP({secrets:new Map(null==Y?void 0:Y.map(function(e){return[e.name,e.value]})),otherSecrets:K}).missing.size:0},[K,Y,Q,X]);if(H.loading)return null;if(H.error)return(0,V.jsx)(i2.ViewError,{text:H.error});if(R){var Z=null==q?void 0:q.provider;if(!q||!Z||Z===iF.HostingBuildProvider.Extension)return(0,V.jsx)(nG.StatusBanner,{colorway:"warning",icon:(0,V.jsx)(tA.default,{}),text:"Provider not found"});var ee=q.machineConfiguration?{configurationId:q.machineConfiguration.id,configurationLabel:q.machineConfiguration.label,configurationSlug:q.machineConfiguration.slug,maxInstances:q.maxMachineInstances}:null;return(0,V.jsx)(eS.View,{css:aY.deployOptions,p:16,pt:12,children:(0,V.jsx)(aK,{initialSubdomain:"",initialProvider:Z,initialMachineConfig:ee,deploymentId:k,replId:_,fs:C,secrets:T,dotReplit:S,ports:j,onCancel:function(){return I(!1)},onDeploy:function(){return I(!1)},onError:E,initialSecretsSyncExpanded:J>0,openNetworkingPane:D,hasAgentSession:M,onViewAction:L})})}var et=H.loading||!W.redeploy.isAuthorized||z!==iK.DeploymentMode.Ready&&z!==iK.DeploymentMode.Suspended;return(0,V.jsxs)(eS.View,{css:aY.self,children:[(0,V.jsx)(o$,{deployability:W,isRedeploy:!0}),(0,V.jsxs)(eS.View,{css:aY.ctaGroup,children:[(0,V.jsx)(tB.Button,{disabled:et,onClick:function(){return(0,ei._)(function(){return(0,eo._)(this,function(e){switch(e.label){case 0:if(U({productArea:"publishing",target:"republish_button"}),H.loading)return[2];if(z===iK.DeploymentMode.Suspended)return O(),[2];return $("deployments_pane_republish_button"),[4,G({hasAgentSession:M})];case 1:return e.sent(),[2]}})})()},text:z===iK.DeploymentMode.Suspended?"Resume":"Republish",iconLeft:(0,V.jsx)(aH.default,{})}),(0,V.jsx)(tB.Button,{disabled:et,text:"Advanced settings",onClick:function(){U({productArea:"publishing",target:"advanced_settings_button"}),I(!0)},iconLeft:(0,V.jsx)(ik.default,{})}),(0,V.jsx)(tB.Button,{text:"Run security scan",iconLeft:(0,V.jsx)(tF.default,{}),onClick:function(){U({productArea:"publishing",target:"run_security_scan_button"}),L({type:iR.ViewActionType.OpenPane,payload:{type:"securityScan"}}),tf(e4.REDEPLOY_PANE)}}),(0,V.jsx)(iZ,{shouldShow:A,onDismissTour:P})]})]})};e.s(["ConfigRedeploy",()=>aQ],977424);var aX=(0,iP.cssRecord)({line:{width:1,position:"absolute",left:3},circlePast:{position:"absolute",top:10,left:1,width:5,height:5,borderRadius:"100%",opacity:.5}}),aJ=(0,iP.cssRecord)({container:{width:7,position:"relative"},linePast:[aX.line,{backgroundColor:e_.tokens.outlineDimmest,top:15,bottom:-10}],linePresent:[aX.line,{backgroundImage:"linear-gradient(to top, ".concat(e_.tokens.outlineDimmest,", ").concat(e_.tokens.outlineDimmer,")"),top:27,bottom:-10}],lineFuture:[aX.line,{borderRight:"1px dashed "+e_.tokens.outlineDimmer,top:23,bottom:-20}],lineFutureFailClosed:[aX.line,{backgroundColor:e_.tokens.outlineDimmest,top:19,bottom:-20}],lineFutureFailOpen:[aX.line,{borderRight:"1px dashed "+e_.tokens.outlineDimmer,top:22,bottom:-18}],circlePastGreen:[aX.circlePast,nB.rcss.backgroundColor.accentPositiveDefault],circlePastRed:[aX.circlePast,nB.rcss.backgroundColor.accentNegativeDefault],circlePastGray:[aX.circlePast,nB.rcss.backgroundColor.outlineDimmer],circlePresent:[nB.rcss.backgroundColor.accentPrimaryStronger,{position:"absolute",top:20,left:0,width:7,height:7,borderRadius:"100%"}],circleFuture:{position:"absolute",top:12,left:-1,width:9,height:9},circleFutureFailClosed:[nB.rcss.backgroundColor.accentNegativeDefault,{position:"absolute",top:14,left:1,width:5,height:5,borderRadius:"100%",opacity:.6}]});function aZ(e){var t,n;switch(e.type){case"pastSuccess":t=aJ.linePast,n=(0,V.jsx)(eS.View,{css:aJ.circlePastGreen});break;case"pastFail":t=aJ.linePast,n=(0,V.jsx)(eS.View,{css:aJ.circlePastRed});break;case"pastNeutral":t=aJ.linePast,n=(0,V.jsx)(eS.View,{css:aJ.circlePastGray});break;case"present":t=aJ.linePresent,n=(0,V.jsx)(eS.View,{css:aJ.circlePresent});break;case"future":t=aJ.lineFuture,n=(0,V.jsx)("svg",{viewBox:"0 0 9 9",css:aJ.circleFuture,children:(0,V.jsx)("circle",{cx:4.5,cy:4.5,r:4,fill:"none",stroke:e_.tokens.outlineStrongest,strokeDasharray:"2 1"})});break;case"futureFailClosed":t=aJ.lineFutureFailClosed,n=(0,V.jsx)(eS.View,{css:aJ.circleFutureFailClosed});break;case"futureFailOpen":t=aJ.lineFutureFailOpen,n=null}return(0,V.jsxs)(eS.View,{css:aJ.container,children:[(0,V.jsx)(eS.View,{css:t,"data-timeline-line":!0}),n]})}function a0(){var e=(0,nE._)(["\n  query HostingDeployActionHistory(\n    $input: HostingBuildDeployActionHistoryInput!\n  ) {\n    hostingBuildDeployActionHistory(input: $input) {\n      ... on HostingBuildDeployActionHistoryResults {\n        results {\n          ... on HostingBuildDeployLogAction {\n            log\n          }\n          ... on HostingBuildDeployStatusAction {\n            status\n            message\n          }\n        }\n      }\n      ... on NotFoundError {\n        message\n      }\n      ... on UnauthorizedError {\n        message\n      }\n    }\n  }\n"]);return a0=function(){return e},e}e.s(["TimelinePoint",()=>aZ],847630);var a1={},a2=(0,nR.gql)(a0());function a3(e){var t=(0,N._)({},a1,e);return nI.useQuery(a2,t)}e.s(["useHostingDeployActionHistoryQuery",()=>a3],397837)},704726,e=>{e.v({footerMessage:"GeneratingDiffStatementsCompleted-module__A1VvTW__footerMessage",footerMessageHeader:"GeneratingDiffStatementsCompleted-module__A1VvTW__footerMessageHeader",isExpanded:"GeneratingDiffStatementsCompleted-module__A1VvTW__isExpanded",learnMoreLink:"GeneratingDiffStatementsCompleted-module__A1VvTW__learnMoreLink",stageCode:"GeneratingDiffStatementsCompleted-module__A1VvTW__stageCode",stageCodeHeader:"GeneratingDiffStatementsCompleted-module__A1VvTW__stageCodeHeader",warning:"GeneratingDiffStatementsCompleted-module__A1VvTW__warning"})},31200,e=>{e.v({conflictPromptOption:"GeneratingDiffStatementsPaused-module__agBH5a__conflictPromptOption",conflictPromptOptionHighlight:"GeneratingDiffStatementsPaused-module__agBH5a__conflictPromptOptionHighlight",conflictPromptOptionLabel:"GeneratingDiffStatementsPaused-module__agBH5a__conflictPromptOptionLabel"})},779213,e=>{e.v({option:"ValidatingDiffStatementsPaused-module__djmC4a__option",optionLabel:"ValidatingDiffStatementsPaused-module__djmC4a__optionLabel",stageCode:"ValidatingDiffStatementsPaused-module__djmC4a__stageCode"})},253711,e=>{e.v({stageIcon:"StageIcon-module__El_uUq__stageIcon"})},859158,e=>{e.v({isExpanded:"PrepareDatabaseStage-module__M0Jleq__isExpanded",stage:"PrepareDatabaseStage-module__M0Jleq__stage",stageHeader:"PrepareDatabaseStage-module__M0Jleq__stageHeader"})},684340,820593,680250,713547,636567,358637,413655,340766,828454,e=>{"use strict";var t,n=e.i(530658),r=e.i(276385),i=e.i(389959),o=e.i(169252),a=e.i(368964),s=e.i(399344),l=e.i(914279),u=e.i(68893),c=e.i(107129),d=e.i(241703),f=e.i(977424),p=e.i(32995),h=e.i(847630),g=e.i(589910),m=e.i(297083),x=e.i(878420),y=e.i(346715),b=e.i(817556),w=e.i(397837),k=e.i(344677),_=e.i(210481),S=e.i(818976),C=e.i(569384),j=e.i(801562),T=e.i(188507),E=e.i(629536),R=e.i(167626),I=e.i(960933),A=e.i(862927),P=e.i(986194);e.i(877212);var D=e.i(924908);e.i(925218);var O=e.i(267103),N=e.i(802088),M=I.Type.Object({description:I.Type.String(),name:I.Type.Optional(I.Type.String()),type:I.Type.Optional(I.Type.String()),before:I.Type.Optional(I.Type.String()),after:I.Type.Optional(I.Type.String()),file:I.Type.Optional(I.Type.Union([I.Type.String(),I.Type.Null()])),File:I.Type.Optional(I.Type.Object({$kind:I.Type.String(),file:I.Type.String()}))}),L=I.Type.Object({errors:T.HostingDebugSummaryResultSchema.properties.errors,suggestions:I.Type.Array(M)}),B={direction:"forward",state:{result:void 0,completed:!1},reducer:function(e,t){if((0,P.isKind)(e.contents.contents,"hostingDebugSummaryEventContents")&&e.state===T.EventState.COMPLETE&&e.sender.type===T.UserType.AI){var n=(0,P.unkind)(e.contents.contents).result;if(A.Value.Check(L,n))return t.result=n,t.completed=e.state===T.EventState.COMPLETE,!1}}},V=e.i(311106),F=e.i(207237),U=e.i(417120),G=e.i(765890),$=e.i(468095),z=e.i(480028),H=e.i(446530),W=e.i(613355),q=e.i(140487),K=e.i(883002),Y=(0,H.cssRecord)({link:{color:z.tokens.foregroundDefault,textDecoration:"underline",":hover":{color:z.tokens.accentPrimaryStronger}},list:[{listStyle:"inside"}]});function Q(e){var t=e.provider,n=e.onViewApplicationLogs,i=(0,s.useIsMaybeVncRepl)();return(0,r.jsxs)(r.Fragment,{children:["Common issues for promote stage errors can be an error occurring while trying to run your run command, your application exiting unexpectedly, an error on your app server or a provisioning issue.",(0,r.jsx)("br",{}),(0,r.jsx)("br",{}),"Ways to debug:",(0,r.jsxs)("ul",{css:Y.list,children:[i?(0,r.jsx)("li",{children:"This promotion may also be failing due to VNC incompatibilities."}):null,(0,r.jsx)("li",{children:"Make sure your repl runs in the Workspace."}),(0,r.jsxs)("li",{children:["View our"," ",(0,r.jsx)("a",{href:"https://docs.replit.com/cloud-services/deployments/troubleshooting",target:"_blank",css:Y.link,onClick:function(){return(0,c.trackDeploymentSectionViewed)({context:"troubleshooting_doc"})},children:"troubleshooting tips."})]}),t!==a.HostingBuildProvider.Static&&n?(0,r.jsxs)("li",{children:["Look for errors in your application's server logs.",(0,r.jsx)(q.Button,{text:"Logs",size:"small",iconLeft:(0,r.jsx)(K.default,{}),onClick:n,css:W.rcss.display.inlineFlex})," "]}):null,(0,r.jsx)("li",{children:"Look for errors in your deploy logs."})]})]})}function X(){var e=(0,s.useIsMaybeVncRepl)();return(0,r.jsxs)(r.Fragment,{children:["Common issues for build stage errors can be an error occurring while trying to run your build command or an compilation issue with your application code.",(0,r.jsx)("br",{}),(0,r.jsx)("br",{}),"Ways to debug:",(0,r.jsxs)("ul",{css:Y.list,children:[e?(0,r.jsx)("li",{children:"This promotion may also be failing due to VNC incompatibilities."}):null,(0,r.jsx)("li",{children:"Make sure your repl runs in the Workspace."}),(0,r.jsxs)("li",{children:["View our"," ",(0,r.jsx)("a",{href:"https://docs.replit.com/cloud-services/deployments/troubleshooting",target:"_blank",css:Y.link,onClick:function(){return(0,c.trackDeploymentSectionViewed)({context:"troubleshooting_doc"})},children:"troubleshooting tips."})]}),(0,r.jsx)("li",{children:"Look for errors in your deploy logs."})]})]})}var J=e.i(965153),Z=e.i(136540),ee=e.i(929872),et=e.i(960178),en=e.i(751273),er=e.i(625484);e.i(947095);var ei=e.i(576073);e.s(["ChevronDown",()=>ei.default],820593);var ei=ei,eo=e.i(462783),eo=eo,ea=e.i(812432),es=e.i(243914),el=e.i(940745),eu=e.i(42458);function ec(){var e=(0,C._)(["\n      The deployment failed with the following error:\n\n\n      ```\n      ","\n      ```\n      Suggested fixes include:\n\n\n      ```\n      ","\n      ```\n      Can you apply the suggested fixes?\n    "],["\n      The deployment failed with the following error:\\n\\n\n      \\`\\`\\`\n      ","\n      \\`\\`\\`\n      Suggested fixes include:\\n\\n\n      \\`\\`\\`\n      ","\n      \\`\\`\\`\n      Can you apply the suggested fixes?\n    "]);return ec=function(){return e},e}var ed=[W.rcss.cursor.pointer,W.rcss.reset.button,W.rcss.color.foregroundDimmest,W.rcss.focusRing,W.rcss.hover(W.rcss.color.foregroundDefault),{lineHeight:1.2,":not([disabled])":{cursor:"pointer"}}],ef=(0,H.cssRecord)({errorsSection:[W.rcss.colorMixBg(z.tokens.accentNegativeDimmest,"transparent",.3),W.rcss.color.accentNegativeStrongest],errorsSectionTitleText:[W.rcss.color.foregroundDefault],errorsList:[W.rcss.display.flex,W.rcss.colWithGap(4),W.rcss.pt(6),W.rcss.pl(24),{listStyleType:"disc"}],suggestionsSectionAgent:[W.rcss.colorMixBg(z.tokens.blurpleDimmest,"transparent",.15),W.rcss.border({direction:"top",color:z.tokens.outlineDimmer})],aiSuggestionsTitle:[W.rcss.color.blurpleStrongest,W.rcss.align.center],aiSuggestionsList:W.rcss.pl(24),textButton:[ed]});function ep(e){var t,o,a,l,u,d,f,p,h,g,x,y,w,k,_,S=e.title,C=e.debugSummary,T=e.view,E=e.provider,I=e.onViewBuildLogs,A=e.viewingBuildLogs,P=e.viewBuildLogsIcon,M=e.openFile,L=e.openPane,U=(0,F.default)(),G=(0,s.useDeploymentId)(),z=(0,i.useCallback)(function(e){(0,V.sendSentryError)({error:e,context:"useHostingDebugSummary",extras:{replId:U,deploymentId:G,debugSummary:C,view:T,provider:E}})},[C,G,E,U,T]),H=(t=C.sessionId,o=(0,D.useChatter)(),l=(a=(0,n._)((0,i.useState)(),2))[0],u=a[1],f=(d=(0,n._)((0,i.useState)(!0),2))[0],p=d[1],g=(h=(0,n._)((0,i.useState)(!1),2))[0],x=h[1],y=(0,i.useRef)(null),w=(0,i.useCallback)(function(e){p(!1),z(e),x(!0)},[z]),k=(0,O.useObservable)(t?o.sessions.get(t):null),_=(0,i.useMemo)(function(){return null==k?void 0:k.reduce(B,"global").result},[k]),(0,N.useObserver)(_,{next:function(e){e.result&&e.completed&&(u(e.result),y.current&&(clearTimeout(y.current),y.current=null),p(!1))},error:function(e){w((0,R._)(e,Error)?e:Error(String(e)))}}),(0,i.useEffect)(function(){if(f&&k)return y.current=setTimeout(function(){w(Error("Debug summary event timed out while loading."))},3e4),function(){y.current&&(clearTimeout(y.current),y.current=null)}},[f,k,w]),{loading:f,error:g,debugResult:l}),W=H.loading,q=H.debugResult,K=H.error,Y=(0,s.useFsService)().listFiles,Q=(0,n._)((0,i.useState)([]),2),X=Q[0],J=Q[1],Z=(0,$.useSendAgentMessage)({openPane:L}),ee=(0,i.useRef)(!1);return(0,i.useEffect)(function(){G&&q&&!ee.current&&(ee.current=!0,(0,c.trackDebugSummaryUsed)("viewed",{view:T,debugSummary:C,debugResult:q,replId:U,deploymentId:G}),q.suggestions.some(function(e){return!!em(e)})&&Y().then(function(e){e.files&&J(e.files)}))},[q,T,C,U,G,Y]),(0,r.jsx)(eh,{title:S,debugSummary:C,debugResult:q,provider:E,viewingBuildLogs:A,viewBuildLogsIcon:P,loading:W,files:X,error:K,onViewBuildLogs:I,openFile:M,onDebugWithAgent:function(e){return(0,m._)(function(){return(0,b._)(this,function(t){return q&&Z((0,j.default)(ec(),null==q?void 0:q.errors.join("\n"),null==q?void 0:q.suggestions.map(function(e){return"".concat(e.description,"\n")}).join("\n")),e),[2]})})()}})}function eh(e){var t=e.title,n=e.debugSummary,i=e.debugResult,o=e.provider,s=e.viewingBuildLogs,l=e.viewBuildLogsIcon,u=e.loading,c=e.files,d=e.error,f=e.onViewBuildLogs,p=e.openFile,h=e.onDebugWithAgent;return(0,r.jsxs)(ee.Surface,{elevated:!0,children:[(0,r.jsxs)(er.View,{css:ef.errorsSection,p:8,gap:4,children:[(0,r.jsxs)(er.View,{row:!0,gap:12,align:"center",justify:"space-between",children:[(0,r.jsxs)(er.View,{row:!0,gap:8,align:"center",children:[(0,r.jsx)(eu.default,{color:z.tokens.accentNegativeStronger}),(0,r.jsx)(et.Text,{css:ef.errorsSectionTitleText,multiline:!1,children:t})]}),(0,r.jsx)(er.View,{row:!0,gap:0,children:"function"==typeof f?(0,r.jsx)(er.View,{children:(0,r.jsxs)("button",{css:ef.textButton,onClick:f,children:[s?"Hide":"View"," logs"," ",(0,r.jsx)(ev,{viewingBuildLogs:s,viewBuildLogsIcon:l})]})}):null})]}),(0,r.jsxs)(et.Text,{children:[u?(0,r.jsxs)(er.View,{row:!0,gap:4,align:"center",children:[(0,r.jsx)(el.default,{}),(0,r.jsx)(et.Text,{children:"Analyzing error, generating suggestions"})]}):(0,r.jsx)(r.Fragment,{children:i?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(et.Text,{children:"Your deployment attempt had the following errors:"}),(0,r.jsx)("ul",{css:ef.errorsList,children:i.errors.map(function(e){return(0,r.jsx)("li",{children:e},e)})})]}):null}),d?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(et.Text,{children:["An error occurred while loading AI generated suggestions. Please try deploying again or follow the common debugging steps."," "]}),n.type===a.HostingDebugSummaryType.DeploymentBuildError?(0,r.jsx)(X,{}):null,n.type===a.HostingDebugSummaryType.DeploymentPromotionError?(0,r.jsx)(Q,{provider:o}):null]}):null]})]}),!u&&i?(0,r.jsx)(er.View,{css:ef.suggestionsSectionAgent,children:(0,r.jsxs)(er.View,{p:8,gap:8,children:[(0,r.jsx)(eg,{onDebugWithAgent:h}),(0,r.jsx)("ol",{css:ef.aiSuggestionsList,children:i.suggestions.map(function(e,t){return(0,r.jsx)(ey,{suggestion:e,files:c,openFile:p},"".concat(n.id,"-").concat(t))})})]})}):null]})}function eg(e){var t=e.onDebugWithAgent,n=(0,U.useAgentRunState)()===T.AgentRunState.AGENT_STATE_RUNNING;return(0,r.jsxs)(er.View,{css:ef.aiSuggestionsTitle,row:!0,gap:8,children:[(0,r.jsx)(ea.default,{}),(0,r.jsxs)(et.Text,{multiline:!1,style:{flex:"1 1 auto",color:z.tokens.blurpleStrongest},children:[E.AGENT_NAME," suggestions"]}),(0,r.jsx)(en.Tooltip,{tooltip:"".concat(E.AGENT_NAME," is running, please wait until it finishes its current work"),isDisabled:!n,children:(0,r.jsx)(G.SendAgentMessageButtonGroup,{onSendAgentMessage:t,disabled:n,buttonText:"Debug with ".concat(E.AGENT_NAME),menuPrefix:"Debug",colorway:"blurple"})})]})}function em(e){var t,n,r,i;return"File"in e&&(null==(t=e.File)?void 0:t.file)!=="null"&&(null==(n=e.File)?void 0:n.file)!==""?(null==(r=e.File)?void 0:r.file.replace("./",""))||void 0:"file"in e&&"null"!==e.file&&""!==e.file&&(null==(i=e.file)?void 0:i.replace("./",""))||void 0}function ev(e){var t=e.viewingBuildLogs,n=e.viewBuildLogsIcon;return n||(t?(0,r.jsx)(eo.default,{}):(0,r.jsx)(ei.default,{}))}var ex=(0,H.cssRecord)({self:{"[data-accordion-header]":[W.rcss.align.start,W.rcss.flex.growAndShrink(1),W.rcss.rowWithGap(4)]},headerInner:[W.rcss.flex.growAndShrink(1),W.rcss.align.baseline,W.rcss.rowWithGap(4)],description:[W.rcss.textAlign.left,W.rcss.color.foregroundDimmer,W.rcss.rowWithGap(8),W.rcss.flex.growAndShrink(1),W.rcss.justify.spaceBetween],interactiveDescription:[ed,W.rcss.textAlign.left,W.rcss.color.foregroundDimmer,W.rcss.rowWithGap(8),W.rcss.flex.growAndShrink(1),W.rcss.justify.spaceBetween],body:[W.rcss.border(),W.rcss.borderRadius(),W.rcss.mt(4),W.rcss.mb(8),W.rcss.overflow("hidden"),W.rcss.font.code,W.rcss.fontSize("small"),{lineHeight:z.tokens.lineHeightSmall}],before:[W.rcss.color.accentNegativeStrongest,W.rcss.colorMixBg(z.tokens.accentNegativeDimmest,"transparent",.3),W.rcss.px(6),W.rcss.py(2)],after:[W.rcss.color.accentPositiveStrongest,W.rcss.colorMixBg(z.tokens.accentPositiveDimmest,"transparent",.3),W.rcss.px(6)],fileLinkButton:[ed,W.rcss.fontSize("small"),W.rcss.cursor.pointer]});function ey(e){var t=e.suggestion,o=e.files,a=e.openFile,s=(0,i.useRef)(em(t)),l=(0,n._)((0,i.useState)(),2),u=l[0],c=l[1];(0,i.useEffect)(function(){if(s.current&&!u){var e=!0,t=!1,n=void 0;try{for(var r,i=o[Symbol.iterator]();!(e=(r=i.next()).done);e=!0)if(r.value===s.current)return void c(s.current)}catch(e){t=!0,n=e}finally{try{e||null==i.return||i.return()}finally{if(t)throw n}}}},[o,u]);var d=(null==t?void 0:t.after)&&(null==t?void 0:t.after)!=="",f=(null==t?void 0:t.before)&&(null==t?void 0:t.before)!=="";return d||f?(0,r.jsx)("li",{css:ex.self,children:(0,r.jsx)(J.AccordionItem,{toggleOn:"chevron",chevron:"none",headerContent:function(e){var n=e.isExpanded,i=e.toggle;return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(er.View,{css:ex.headerInner,children:[(0,r.jsxs)("button",{css:ex.interactiveDescription,onClick:i,children:[(0,r.jsx)(et.Text,{maxLines:n?void 0:1,style:{color:"inherit"},children:t.description})," "]}),u?(0,r.jsx)("button",{css:ex.fileLinkButton,onClick:function(e){e.stopPropagation(),a({path:u})},children:(0,r.jsxs)(er.View,{row:!0,gap:4,align:"center",css:W.rcss.cursor.pointer,children:[u,(0,r.jsx)(es.default,{size:12})]})}):null]}),(0,r.jsx)(Z.IconButton,{alt:"Show suggestion",onClick:i,children:n?(0,r.jsx)(eo.default,{}):(0,r.jsx)(ei.default,{})})]})},headerProps:{"data-accordion-header":""},children:(0,r.jsxs)(er.View,{css:ex.body,children:[f?(0,r.jsx)(er.View,{css:ex.before,children:(0,r.jsx)("pre",{children:t.before})}):null,d?(0,r.jsx)(er.View,{css:ex.after,children:(0,r.jsx)("pre",{children:t.after})}):null]})})}):(0,r.jsx)("li",{css:ex.self,children:(0,r.jsxs)(er.View,{css:ex.headerInner,children:[(0,r.jsxs)(er.View,{css:ex.description,children:[(0,r.jsx)(et.Text,{style:{color:"inherit"},children:t.description})," "]}),u?(0,r.jsx)("button",{css:ex.fileLinkButton,onClick:function(e){e.stopPropagation(),a({path:u})},children:(0,r.jsxs)(er.View,{row:!0,gap:4,align:"center",children:[u,(0,r.jsx)(es.default,{size:12})]})}):null]})})}var eb=e.i(15260);function ew(e){var t=e.currentStatus,n=e.provider,i=e.logs,o=e.viewBuildLogs,l=e.debugSummary,u=e.openFile,c=e.openPane,f=e.onViewBuildLogs,p=e.onViewApplicationLogs;if((0,s.useDeploymentDeployability)().hasDebugSummariesAuthorization&&l){var h=t===a.HostingBuildStatus.Building?"Build failed":"Promotion failed";return(0,r.jsx)(ep,{title:h,debugSummary:l,view:d.Views.DeploymentInProgress,provider:n,openFile:u,openPane:c})}return t===a.HostingBuildStatus.Building?(0,r.jsx)(eE,{provider:n,logs:i,openFile:u,viewBuildLogs:o,onViewBuildLogs:f}):t===a.HostingBuildStatus.Promoting?(0,r.jsx)(eT,{provider:n,logs:i,openFile:u,viewBuildLogs:o,onViewBuildLogs:f,onViewApplicationLogs:p}):null}function ek(e){var t=e.currentStatus,n=e.provider,i=e.debugSummary,o=e.openFile,l=e.openPane,u=e.onViewApplicationLogs;return(0,s.useDeploymentDeployability)().hasDebugSummariesAuthorization&&i?(0,r.jsx)(ep,{title:"Publishing failed",debugSummary:i,view:"deploy_history_logs",provider:n,openFile:o,openPane:l}):t===a.HostingBuildStatus.Building?(0,r.jsx)(eE,{provider:n,openFile:o}):t===a.HostingBuildStatus.Promoting?(0,r.jsx)(eT,{provider:n,openFile:o,onViewApplicationLogs:u}):null}var e_=(0,H.cssRecord)({self:[W.rcss.borderRadius(4),W.rcss.overflow("hidden"),W.rcss.border({color:z.tokens.outlineDimmer}),W.rcss.mb(6)]});function eS(e){var t=e.title,n=e.debugSummary,i=e.provider,o=e.openFile,a=e.openPane,s=e.onViewBuildLogs;return(0,r.jsx)(er.View,{css:e_.self,children:(0,r.jsx)(ep,{title:t,debugSummary:n,view:d.Views.Deployment,provider:i,onViewBuildLogs:s,viewBuildLogsIcon:(0,r.jsx)(K.default,{}),openFile:o,openPane:a})})}var eC=(0,H.cssRecord)({xtermContainer:[W.rcss.display.flex,W.rcss.pt(12),W.rcss.pl(16),W.rcss.overflow("hidden"),W.rcss.borderRadius(4,4,0,0)],xterm:[W.rcss.width("100%"),W.rcss.maxWidth("100%"),W.rcss.height(200)],xtermButton:W.rcss.borderRadius(0,0,4,4)});function ej(e){var t=e.title,o=e.description,a=e.logs,l=e.viewBuildLogs,u=e.onViewBuildLogs,c=e.openFile,d=(0,S.useTerminalTheme)(),f=(0,s.useFsService)(),p=(0,n._)((0,_.default)({openFile:c,listFiles:f.listFiles}),2),h=p[0],g=p[1],m=(0,i.useRef)(a?a.slice(-5):[]);return(0,i.useEffect)(function(){m.current.length&&m.current.forEach(function(e){null==h||h.write(e)})},[h]),(0,r.jsxs)(ee.Surface,{elevated:!0,p:12,gap:12,children:[(0,r.jsxs)(er.View,{gap:8,children:[(0,r.jsxs)(er.View,{row:!0,gap:8,align:"center",children:[(0,r.jsx)(eu.default,{color:z.tokens.accentNegativeStronger}),(0,r.jsx)(et.Text,{multiline:!1,children:t})]}),(0,r.jsx)(et.Text,{children:o})]}),void 0===l||l?null:(0,r.jsxs)(er.View,{children:[(0,r.jsx)(er.View,{css:eC.xtermContainer,style:{backgroundColor:null==d?void 0:d.background},children:(0,r.jsx)(er.SpecializedView.div,{css:eC.xterm,ref:g})}),(0,r.jsx)(q.Button,{text:"View all",iconLeft:(0,r.jsx)(eb.default,{}),onClick:function(){return null==u?void 0:u()},css:eC.xtermButton})]})]})}function eT(e){return(0,r.jsx)(ej,(0,x._)({title:"Your app failed to promote",description:(0,r.jsx)(Q,{provider:e.provider,onViewApplicationLogs:e.onViewApplicationLogs})},e))}function eE(e){return(0,r.jsx)(ej,(0,x._)({title:"Your app failed to build",description:(0,r.jsx)(X,{})},e))}function eR(e){return(0,r.jsx)(ej,(0,x._)({title:"This build's publish logs have expired",description:(0,r.jsx)(r.Fragment,{children:"No information was found for this build. Publish logs expire after 30 days."})},e))}var eI=e.i(182492),eA=e.i(973245),eP=e.i(304277),eD=e.i(566901),eO=e.i(963084),eN=e.i(951262),eM=e.i(613141);function eL(){var e=(0,C._)(["\n  fragment PendingDomainsRepl on Repl {\n    id\n    pendingDomains {\n      domainName\n      status\n      message\n    }\n  }\n"]);return eL=function(){return e},e}function eB(){var e=(0,C._)(["\n  query PendingDomainsQuery($replId: String!) {\n    getRepl(id: $replId) {\n      ... on Repl {\n        ...PendingDomainsRepl\n      }\n    }\n  }\n  ","\n"]);return eB=function(){return e},e}function eV(){var e=(0,C._)(["\n  subscription PendingDomainsUpdates($replId: String!) {\n    pendingDomainsUpdates(replId: $replId) {\n      id\n      ...PendingDomainsRepl\n    }\n  }\n  ","\n"]);return eV=function(){return e},e}var eF={},eU=(0,eA.gql)(eL()),eG=(0,eA.gql)(eB(),eU);function e$(e){var t=(0,x._)({},eF,e);return eP.useQuery(eG,t)}var ez=(0,eA.gql)(eV(),eU);function eH(e){var t=(0,x._)({},eF,e);return eM.useSubscription(ez,t)}function eW(){var e=(0,C._)(["\n  fragment DomainItemDnsRecord on DnsRecord {\n    id\n    answer\n    type\n    ttl\n    host\n    isProtected\n  }\n"]);return eW=function(){return e},e}function eq(){var e=(0,C._)(["\n  fragment DomainItem on Domain {\n    id\n    status\n    state\n    domain\n    managed\n    timeCreated\n    autorenew\n    dnsRecords {\n      id\n      ...DomainItemDnsRecord\n    }\n  }\n  ","\n"]);return eq=function(){return e},e}function eK(){var e=(0,C._)(["\n  mutation CreateDnsRecord($input: CreateDnsRecordInput!) {\n    createDnsRecord(input: $input) {\n      ... on Error {\n        message\n      }\n      ... on CreateDnsRecordOutput {\n        domain {\n          id\n          ...DomainItem\n        }\n      }\n    }\n  }\n  ","\n"]);return eK=function(){return e},e}function eY(){var e=(0,C._)(["\n  mutation DeleteDnsRecord($input: DeleteDnsRecordInput!) {\n    deleteDnsRecord(input: $input) {\n      ... on Error {\n        message\n      }\n      ... on DeleteDnsRecordOutput {\n        domain {\n          id\n          ...DomainItem\n        }\n      }\n    }\n  }\n  ","\n"]);return eY=function(){return e},e}function eQ(){var e=(0,C._)(["\n  mutation HostingDeploymentsUnlinkDomain(\n    $input: UnlinkHostingDeploymentDomainInput!\n  ) {\n    unlinkHostingDeploymentDomain(input: $input) {\n      ... on HostingDeployment {\n        id\n        domains2 {\n          id\n        }\n        repl {\n          ...PendingDomainsRepl\n        }\n      }\n      ... on Error {\n        message\n      }\n    }\n  }\n  ","\n"]);return eQ=function(){return e},e}function eX(){var e=(0,C._)(["\n  mutation VerifyDomain($input: VerifyDomainInput!) {\n    verifyDomain(input: $input) {\n      ... on Domain {\n        id\n        state\n      }\n    }\n  }\n"]);return eX=function(){return e},e}function eJ(){var e=(0,C._)(["\n  mutation setShouldDomainAutoRenew($input: SetShouldDomainAutoRenewInput!) {\n    setShouldDomainAutoRenew(input: $input) {\n      ... on Error {\n        message\n      }\n      ... on SetShouldDomainAutoRenewResult {\n        domain {\n          id\n          ...DomainItem\n        }\n      }\n    }\n  }\n  ","\n"]);return eJ=function(){return e},e}e.s(["PendingDomainsReplFragmentDoc",()=>eU,"usePendingDomainsQueryQuery",()=>e$,"usePendingDomainsUpdatesSubscription",()=>eH],680250);var eZ={},e0=(0,eA.gql)(eW()),e1=(0,eA.gql)(eq(),e0),e2=(0,eA.gql)(eK(),e1);function e3(e){var t=(0,x._)({},eZ,e);return eN.useMutation(e2,t)}var e4=(0,eA.gql)(eY(),e1);function e8(e){var t=(0,x._)({},eZ,e);return eN.useMutation(e4,t)}var e5=(0,eA.gql)(eQ(),eU);function e6(e){var t=(0,x._)({},eZ,e);return eN.useMutation(e5,t)}var e9=(0,eA.gql)(eX());function e7(e){var t=(0,x._)({},eZ,e);return eN.useMutation(e9,t)}var te=(0,eA.gql)(eJ(),e1);function tt(e){var t=(0,x._)({},eZ,e);return eN.useMutation(te,t)}function tn(){var e=(0,C._)(["\n  fragment Domains2Repl on Repl {\n    id\n    org {\n      id\n    }\n  }\n"]);return tn=function(){return e},e}function tr(){var e=(0,C._)(["\n  fragment HostingDeploymentDomainsHostingDeployment on HostingDeployment {\n    id\n    currentBuild {\n      id\n      status\n    }\n    repl {\n      id\n      title\n      apexProxy\n    }\n    domains2 {\n      id\n      ...DomainItem\n      whois @include(if: $isGlowup) {\n        registrar\n        creationDate\n        expiryDate\n      }\n      currentDnsRecords @include(if: $isGlowup) {\n        A\n        TXT\n      }\n      renewalPriceCents @include(if: $isGlowup)\n    }\n  }\n  ","\n"]);return tr=function(){return e},e}function ti(){var e=(0,C._)(["\n  query Domains2Repl($id: String!) {\n    getRepl(id: $id) {\n      ...Domains2Repl\n    }\n  }\n  ","\n"]);return ti=function(){return e},e}function to(){var e=(0,C._)(["\n  query HostingDeploymentDomains($id: String!, $isGlowup: Boolean!) {\n    hostingDeployment(id: $id) {\n      ... on HostingDeployment {\n        id\n        ...HostingDeploymentDomainsHostingDeployment\n      }\n    }\n  }\n  ","\n"]);return to=function(){return e},e}function ta(){var e=(0,C._)(["\n  mutation LinkHostingDeploymentDomain(\n    $input: LinkHostingDeploymentDomainInput!\n  ) {\n    linkHostingDeploymentDomain(input: $input) {\n      ... on HostingDeployment {\n        id\n        domains2 {\n          ...DomainItem\n        }\n      }\n    }\n  }\n  ","\n"]);return ta=function(){return e},e}e.s(["DomainItemFragmentDoc",()=>e1,"useCreateDnsRecordMutation",()=>e3,"useDeleteDnsRecordMutation",()=>e8,"useHostingDeploymentsUnlinkDomainMutation",()=>e6,"useSetShouldDomainAutoRenewMutation",()=>tt,"useVerifyDomainMutation",()=>e7],713547);var ts={},tl=(0,eA.gql)(tn()),tu=(0,eA.gql)(tr(),e1),tc=(0,eA.gql)(ti(),tl);function td(e){var t=(0,x._)({},ts,e);return eP.useQuery(tc,t)}var tf=(0,eA.gql)(to(),tu);function tp(e){var t=(0,x._)({},ts,e);return eP.useQuery(tf,t)}function th(e){var t=(0,x._)({},ts,e);return eD.useLazyQuery(tf,t)}var tg=(0,eA.gql)(ta(),e1);function tm(e){var t=(0,x._)({},ts,e);return eN.useMutation(tg,t)}function tv(){var e=(0,C._)(["\n  fragment DeploymentSettingsAuthorizations on ReplAuthorizations {\n    addCustomDomain {\n      isAuthorized\n      code\n      message\n    }\n    deleteCustomDomain {\n      isAuthorized\n      code\n      message\n    }\n    deleteDeployment {\n      isAuthorized\n      code\n      message\n    }\n    editDeploymentStatus(provider: $provider) {\n      isAuthorized\n      code\n      message\n    }\n    editDeploymentTier(provider: $provider) {\n      isAuthorized\n      code\n      message\n    }\n  }\n"]);return tv=function(){return e},e}function tx(){var e=(0,C._)(["\n  query HostingDeploymentSettings($id: String!, $isGlowup: Boolean!) {\n    hostingDeployment(id: $id) {\n      ... on HostingDeployment {\n        id\n        ...HostingDeploymentDomainsHostingDeployment\n        currentBuild {\n          id\n          provider\n          suspendedReason\n          machineConfiguration {\n            ...MachineConfiguration\n          }\n          machineJob {\n            ... on HostingBuildMachineJob {\n              failureNotifications\n            }\n          }\n          envVars {\n            name\n            value\n          }\n        }\n      }\n    }\n  }\n  ","\n  ","\n"]);return tx=function(){return e},e}function ty(){var e=(0,C._)(["\n  query HostingDeploymentSettingsAuthz(\n    $replId: String!\n    $provider: HostingBuildProvider!\n  ) {\n    getRepl(id: $replId) {\n      __typename\n      ... on Repl {\n        id\n        authorizations {\n          ...DeploymentSettingsAuthorizations\n        }\n      }\n      ... on Error {\n        message\n      }\n    }\n  }\n  ","\n"]);return ty=function(){return e},e}e.s(["HostingDeploymentDomainsDocument",()=>tf,"HostingDeploymentDomainsHostingDeploymentFragmentDoc",()=>tu,"useDomains2ReplQuery",()=>td,"useHostingDeploymentDomainsLazyQuery",()=>th,"useHostingDeploymentDomainsQuery",()=>tp,"useLinkHostingDeploymentDomainMutation",()=>tm],636567);var tb={},tw=(0,eA.gql)(tv()),tk=(0,eA.gql)(tx(),tu,eO.MachineConfigurationFragmentDoc);function t_(e){var t=(0,x._)({},tb,e);return eP.useQuery(tk,t)}var tS=(0,eA.gql)(ty(),tw);function tC(e){var t=(0,x._)({},tb,e);return eP.useQuery(tS,t)}function tj(e){var t=(0,x._)({},tb,e);return eD.useLazyQuery(tS,t)}e.s(["useHostingDeploymentSettingsAuthzLazyQuery",()=>tj,"useHostingDeploymentSettingsAuthzQuery",()=>tC,"useHostingDeploymentSettingsQuery",()=>t_],358637);var tT=e.i(721281),tE=e.i(6338),tR=e.i(624782),tI=e.i(616278),tA=e.i(993134),tP=e.i(785719),tD=function(e){var t=e.stage,n=e.activeStage,i=e.erroredStage,o=e.pausedStage;return t===i?(0,r.jsx)(eu.default,{alt:"error"}):t<n?(0,r.jsx)(tI.default,{alt:"success"}):t===o?(0,r.jsx)(tP.default,{alt:"paused"}):t===n?(0,r.jsx)(el.default,{alt:"current"}):(0,r.jsx)(tA.default,{alt:"waiting"})},tO=function(e){var t=e.stage,n=e.activeStage,r=e.erroredStage,i=e.pausedStage;return void 0===n?null:t===r?"negative":t<n?"positive":t===i?"orange":t===n?"primary":null},tN=function(e){var t,n=e.stage,o=e.totalStagesWithTitle,a=e.activeStage,s=e.text,l=e.erroredStage,u=e.pausedStage,c=void 0!==a;return(0,r.jsx)(i.Fragment,{children:(0,r.jsx)(tR.Pill,{text:c?s:"",colorway:null!=(t=tO({stage:n,activeStage:a,erroredStage:l,pausedStage:u}))?t:void 0,variant:"filled",css:[c&&a<n&&!l?tE.loadingStyle.foregroundPulse():{},W.rcss.border({color:z.tokens.backgroundHigher}),W.rcss.overflow("hidden"),(0,tT._)({position:"relative",flex:1,height:26,zIndex:o-n,":first-of-type":{paddingLeft:6,paddingRight:6},":not(:first-of-type)":{paddingLeft:24},":not(:last-of-type)":{marginRight:-24}," span":W.rcss.display.none},W.container.min(400),{" span":W.rcss.display.flex,":first-of-type":{paddingLeft:16,paddingRight:0}})],iconRight:c?(0,r.jsx)(tD,{stage:n,activeStage:a,erroredStage:l,pausedStage:u}):void 0})},c&&a<=n&&!l?1:0)},tM=[{id:0,title:"Provision",statusType:o.HostingBuildStatus.Pending},{id:1,title:"Security Scan",statusType:o.HostingBuildStatus.SecurityScanning},{id:2,title:"Build",statusType:o.HostingBuildStatus.Building},{id:3,title:"Bundle",statusType:o.HostingBuildStatus.Running},{id:4,title:"Promote",statusType:o.HostingBuildStatus.Promoting},{id:5,statusType:o.HostingBuildStatus.Success}],tL=[{id:0,title:"Provision",statusType:o.HostingBuildStatus.Pending},{id:1,title:"Build",statusType:o.HostingBuildStatus.Building},{id:2,title:"Bundle",statusType:o.HostingBuildStatus.Running},{id:3,title:"Promote",statusType:o.HostingBuildStatus.Promoting},{id:4,statusType:o.HostingBuildStatus.Success}],tB=tM.filter(function(e){return"title"in e}),tV=tL.filter(function(e){return"title"in e}),tF=function(e,t){return e.find(function(e){return e.statusType===t})},tU=ei,tG=eo,t$=(0,H.cssRecord)({base:{borderRadius:z.tokens.borderRadiusDefault,paddingLeft:6,paddingRight:6,height:24}}),tz=(0,H.cssRecord)({header:[W.rcss.width("100%")],headerLeft:[W.rcss.align.baseline,W.rcss.flex.shrink(1)],started:[W.rcss.rowWithGap(6),W.rcss.flex.growAndShrink(1),W.rcss.justify.end,W.rcss.color.foregroundDimmest],cancel:[t$.base,{'&[data-cancelable="true"]':{opacity:1,width:"auto"},'&[data-cancelable="false"]':{opacity:0,width:0}}],stages:[{zIndex:0}],textButton:[W.rcss.cursor.pointer,W.rcss.reset.button,W.rcss.color.foregroundDimmest,W.rcss.focusRing,W.rcss.hover(W.rcss.color.foregroundDefault),{lineHeight:1.2,":not([disabled])":{cursor:"pointer"}}]});function tH(e){var t,n=e.onCancel,i=e.isCanceling,o=e.provider,s=(0,F.default)(),l="azure_container_app"===o||"azure_vm"===o,u=o&&!l,c=tC({variables:{replId:s,provider:null!=o?o:a.HostingBuildProvider.CloudRun},skip:!u}).data,d=(null==c?void 0:c.getRepl.__typename)==="Repl"?c.getRepl.authorizations.editDeploymentStatus:void 0,f=null!=(t=null==d?void 0:d.isAuthorized)&&t;return u?(0,r.jsx)(en.Tooltip,{isDisabled:f,tooltip:null==d?void 0:d.message,children:(0,r.jsx)(q.Button,{size:"small",text:"Cancel",css:tz.cancel,onClick:n,iconRight:i?(0,r.jsx)(el.default,{}):void 0,disabled:i||!f,"data-cancelable":n?"true":"false"})}):null}var tW=function(e){var t=(0,s.useDeploymentSecurityScanState)().enabled;return(0,r.jsxs)(er.View,{p:16,pt:12,gap:12,children:[(0,r.jsxs)(er.View,{css:tz.header,row:!0,gap:8,justify:"space-between",children:[(0,r.jsxs)(er.View,{css:tz.headerLeft,row:!0,gap:8,children:[(0,r.jsx)(et.Text,{variant:"subheadDefault",multiline:!1,children:"Publishing"}),e.timeStarted&&e.userDisplayName?(0,r.jsxs)(et.Text,{css:tz.started,multiline:!1,maxLines:1,children:["Started ".concat((0,eI.formatDistance)(new Date(e.timeStarted),Date.now(),{addSuffix:!0})," by "),(0,r.jsx)("span",{children:e.userDisplayName})]}):null,e.onCancel?(0,r.jsx)(tH,{onCancel:e.onCancel,isCanceling:e.isCanceling,provider:e.provider}):null]}),(0,r.jsx)(er.View,{row:!0,gap:6,justify:"end",children:e.onViewBuildLogs?(0,r.jsxs)("button",{css:tz.textButton,onClick:e.onViewBuildLogs,children:[e.viewBuildLogs?"Hide":"View"," logs"," ",e.viewBuildLogs?(0,r.jsx)(tG.default,{}):(0,r.jsx)(tU.default,{})]}):null})]}),(0,r.jsx)(er.View,{css:tz.stages,grow:!0,row:!0,children:(t?tB:tV).map(function(t){var n=t.id,i=t.title;return(0,r.jsx)(tN,{stage:n,totalStagesWithTitle:tB.length,text:i,activeStage:e.activeStage,pausedStage:e.pausedStage,erroredStage:e.erroredStage},n)})})]})},tq=e.i(569910),tK=e.i(265957),tY=e.i(409146),tQ=e.i(175526),tX=e.i(841691),tJ=e.i(243074),tZ=e.i(363201),t0=e.i(216373),t1=e.i(491404),t2=e.i(793188),t3=e.i(957798),t4=e.i(704726);function t8(e){var t=e.infoToPrint.toLowerCase();return t.includes("materialized view")?(0,r.jsx)(tX.default,{size:16}):t.includes("primary key")?(0,r.jsx)(t0.default,{size:16}):t.includes("schema")?(0,r.jsx)(tJ.default,{size:16}):t.includes("column")?(0,r.jsx)(K.default,{size:16}):t.includes("table")?(0,r.jsx)(t1.default,{size:16}):(0,r.jsx)(eu.default,{size:16})}function t5(e){var t=e.infoToPrint,n=t.startsWith(" ")?t.substring(2):t;return(0,r.jsxs)(er.View,{row:!0,gap:8,align:"center",shrink:!0,children:[(0,r.jsx)(t8,{infoToPrint:t}),(0,r.jsx)(et.Text,{shrink:!0,variant:"small",children:n})]})}function t6(e){var t=e.infoToPrint,n=t.length>0;return(0,r.jsx)(er.View,{clsx:[t4.default.stageCodeHeader,n&&t4.default.warning],row:!0,align:"center",children:t.length>0?(0,r.jsxs)(er.View,{gap:6,shrink:!0,children:[(0,r.jsxs)(et.Text,{variant:"small",color:"default",children:["Warning, this migration may permanently remove some data from your production database,"," ",(0,r.jsx)("a",{target:"_blank",href:"https://docs.replit.com/cloud-services/storage-and-databases/production-databases#understanding-database-changes-and-deployments",clsx:t4.default.learnMoreLink,children:"learn more"}),":"]}),(0,r.jsx)(er.View,{px:8,gap:6,children:t.map(function(e,t){return(0,r.jsx)(t5,{infoToPrint:e},t)})})]}):(0,r.jsxs)(et.Text,{variant:"small",color:"default",children:["Migrations are generated based on changes made by the agent in your app,"," ",(0,r.jsx)("a",{target:"_blank",href:"https://docs.replit.com/cloud-services/storage-and-databases/production-databases#understanding-database-changes-and-deployments",clsx:t4.default.learnMoreLink,children:"learn more."})]})})}function t9(){var e=(0,n._)((0,i.useState)(!1),2),t=e[0],o=e[1];return(0,r.jsxs)(er.View,{clsx:t4.default.footerMessage,p:8,children:[(0,r.jsxs)(er.View,{clsx:[t4.default.footerMessageHeader,t&&t4.default.isExpanded],row:!0,gap:8,align:"center",justify:"space-between",children:[(0,r.jsx)(tZ.default,{}),(0,r.jsx)(et.Text,{variant:"small",shrink:!0,children:"You may notice a temporary downtime of your deployment. What's happening?"}),(0,r.jsx)(er.View,{row:!0,grow:!0,align:"center",justify:"end",children:(0,r.jsx)(tQ.AccordionButton,{open:t,onClick:function(){return o(!t)}})})]}),t?(0,r.jsxs)(er.View,{px:8,gap:6,children:[(0,r.jsxs)(er.View,{row:!0,gap:8,align:"center",shrink:!0,children:[(0,r.jsx)(t2.default,{}),(0,r.jsx)(et.Text,{shrink:!0,variant:"small",children:"Database changes sometimes require stopping your app temporarily to avoid conflicts during the update process"})]}),(0,r.jsxs)(er.View,{row:!0,gap:8,align:"center",shrink:!0,children:[(0,r.jsx)(t3.default,{}),(0,r.jsx)(et.Text,{shrink:!0,variant:"small",children:"This prevents data loss or corruption that could happen if users were still using the app during the change"})]})]}):null]})}function t7(e){var t=e.infoToPrint,n=e.statementsToExecute,i=e.maybeNonBackwardsCompatible;return(0,r.jsxs)(er.View,{gap:8,children:[(0,r.jsxs)(er.View,{clsx:t4.default.stageCode,gap:4,children:[(0,r.jsx)(t6,{infoToPrint:t}),(0,r.jsx)(er.View,{p:8,children:(0,r.jsx)(tY.default,{code:n.join("\n"),fontSize:12,lineNumbers:!0})})]}),i?(0,r.jsx)(t9,{}):null]})}var ne=e.i(546284),nt=e.i(818503),nn=e.i(734882),nr=e.i(952030),ni=e.i(902846),no=e.i(31200);function na(e){var t=e.conflictPrompt;if("selectPrompt"===t.$kind){var n=t.result.entity,i=n.name,o=n.count,a=n.tableName;return"createUniqueConstraint"===t.result.entity.type?(0,r.jsxs)(r.Fragment,{children:["You're about to add"," ",(0,r.jsx)("span",{clsx:no.default.conflictPromptOptionHighlight,children:i})," unique constraint to the"," ",(0,r.jsx)("span",{clsx:no.default.conflictPromptOptionHighlight,children:a})," ","table, which contains"," ",(0,r.jsx)("span",{clsx:no.default.conflictPromptOptionHighlight,children:o})," ",(0,ne.default)("item",o),". If this statement fails due to any existing data not matching the new constraint, you will receive an error from the database. Do you want to delete all data from"," ",(0,r.jsx)("span",{clsx:no.default.conflictPromptOptionHighlight,children:a})," ","table first?"]}):null}return(0,r.jsxs)(r.Fragment,{children:["Is"," ",(0,r.jsx)("span",{clsx:no.default.conflictPromptOptionHighlight,children:function(e){switch(e.$kind){case"columnConflictPrompt":return e.result.column.name;case"namedConflictPrompt":return e.result.item.name;case"namedWithSchemaConflictPrompt":var t=e.result.item;return"public"!==t.schema&&t.schema?"".concat(t.schema,".").concat(t.name):t.name;case"schemaConflictPrompt":return e.result.schema.name;default:return""}}(t)})," ",function(e){switch(e.$kind){case"columnConflictPrompt":return"column in ".concat(e.result.tableName," table created or renamed from another column?");case"namedConflictPrompt":case"namedWithSchemaConflictPrompt":return"".concat(e.result.entity," created or renamed from another ").concat(e.result.entity,"?");case"schemaConflictPrompt":return"schema created or renamed from another schema?";default:return""}}(t)]})}function ns(e){var t=e.label,n=e.$kind,i=e.isRename,o=e.entityType;return"selectPrompt"===n?(0,r.jsx)(et.Text,{multiline:!0,shrink:!0,children:function(e,t){if("createUniqueConstraint"===t)switch(e){case"no":return"No, add the constraint without deleting data";case"yes":return"Yes, delete all data from the table"}return e}(t,o)}):(0,r.jsxs)(r.Fragment,{children:[i?(0,r.jsx)(ni.default,{}):(0,r.jsx)(nr.default,{}),(0,r.jsx)(et.Text,{multiline:!0,shrink:!0,children:t})]})}function nl(e){var t=e.conflictPrompt,o=e.onSelectConflictPromptOption,a=(0,n._)((0,i.useState)(t.result.options[0]),2),s=a[0],l=a[1],u=(0,n._)((0,i.useState)(!1),2),c=u[0],d=u[1];(0,i.useEffect)(function(){var e=t.result.options;0!==e.length&&(e.find(function(e){return e.id===(null==s?void 0:s.id)})||(l(e[0]),d(!1)))},[t.result.options,null==s?void 0:s.id]);var f=(0,i.useCallback)(function(){return(0,m._)(function(){return(0,b._)(this,function(e){return s&&o&&(d(!0),o({$kind:t.$kind,selectedId:s.id})),[2]})})()},[s,o,t.$kind]);return(0,r.jsxs)(er.View,{gap:12,children:[(0,r.jsx)(et.Text,{color:"dimmer",children:(0,r.jsx)(na,{conflictPrompt:t})}),(0,r.jsx)(nn.RadioGroup,{name:"conflictPrompt",value:s.id,onChange:function(e){var n=e.target.value,r=t.result.options.find(function(e){return e.id===n});r&&l(r)},children:(0,r.jsx)(er.View,{row:!0,gap:8,align:"stretch",wrap:!0,children:t.result.options.map(function(e){return(0,r.jsxs)(er.View,{row:!0,align:"start",clsx:no.default.conflictPromptOption,children:[(0,r.jsx)(nn.Radio,{id:e.id,value:e.id}),(0,r.jsx)(nt.Label,{htmlFor:e.id,clsx:no.default.conflictPromptOptionLabel,children:(0,r.jsx)(er.View,{row:!0,gap:4,align:"start",children:(0,r.jsx)(ns,{$kind:t.$kind,entityType:"selectPrompt"===t.$kind?t.result.entity.type:void 0,isRename:"isRename"in e?e.isRename:void 0,label:e.label})})})]},e.id)})})}),(0,r.jsx)(q.Button,{text:"Submit",colorway:"primary",size:"small",onClick:f,loading:c,disabled:c||0===t.result.options.length})]})}var nu=e.i(968203);function nc(){return(0,r.jsx)(er.View,{gap:8,children:(0,r.jsx)(nu.PrepareDatabaseStageMessage,{text:"How do I test my deployment database?",items:[{text:"Create a deployment preview environment and test your app's functionality with the database changes applied"},{text:"Check that your app still works properly and displays data correctly after the changes"}]})})}var nd=e.i(779213);function nf(e){var t,o=e.statementError,a=e.onOverwriteDataAndDeploy,s=e.onCancel,l=[{id:"overwrite",text:"Copy your development database schema & data to production."},{id:"cancel",text:"Cancel deployment and retry once your schema conflicts are resolved."}],u=(0,n._)((0,i.useState)(l[1]),2),c=u[0],d=u[1],f=(0,n._)((0,i.useState)(!1),2),p=f[0],h=f[1],g=(0,i.useCallback)(function(){return(0,m._)(function(){return(0,b._)(this,function(e){if(!c)return[2];switch(h(!0),c.id){case"cancel":null==s||s();break;case"overwrite":null==a||a()}return[2]})})()},[a,s,c]);return(0,r.jsxs)(er.View,{gap:8,children:[(0,r.jsxs)(er.View,{gap:8,children:[(0,r.jsxs)(et.Text,{color:"dimmer",variant:"small",children:["Your database schema changes conflict with existing production data and could not be applied,"," ",(0,r.jsx)("a",{target:"_blank",href:"https://docs.replit.com/cloud-services/storage-and-databases/production-databases#understanding-database-changes-and-deployments",clsx:nd.default.learnMoreLink,children:"learn more."})," ","To resolve this, you can:"]}),(0,r.jsx)(nn.RadioGroup,{name:"validatingDiffStatementConflictOptions",value:null!=(t=null==c?void 0:c.id)?t:"",onChange:function(e){var t=e.target.value,n=l.find(function(e){return e.id===t});n&&d(n)},children:(0,r.jsx)(er.View,{row:!0,gap:8,align:"stretch",wrap:!0,children:l.map(function(e){return(0,r.jsxs)(er.View,{row:!0,align:"start",clsx:nd.default.option,children:[(0,r.jsx)(nn.Radio,{id:e.id,value:e.id}),(0,r.jsx)(nt.Label,{htmlFor:e.id,clsx:nd.default.optionLabel,children:(0,r.jsx)(er.View,{row:!0,gap:4,align:"start",children:(0,r.jsx)(et.Text,{multiline:!0,shrink:!0,variant:"small",children:e.text})})})]},e.id)})})}),(null==c?void 0:c.id)==="overwrite"?(0,r.jsx)(nu.PrepareDatabaseStageMessage,{text:"What does copying your development schema & data to production actually do?",items:[{text:"Replaces your production database with your development database, overwriting any existing production data."},{text:"Useful during early development when iterating on database schema changes with no sensitive production data."},{text:(0,r.jsxs)(r.Fragment,{children:["This action cannot be undone, but you can always restore your database,"," ",(0,r.jsx)("a",{href:"https://docs.replit.com/cloud-services/storage-and-databases/sql-database#restore-tool",target:"_blank",children:"learn more."})]})}]}):null,(0,r.jsx)(q.Button,{text:(null==c?void 0:c.id)==="overwrite"?"Copy development database and deploy":"Cancel deployment",colorway:"primary",size:"small",onClick:g,loading:p,disabled:p})]}),(0,r.jsx)(er.View,{clsx:nd.default.stageCode,gap:4,children:(0,r.jsx)(er.View,{p:8,children:(0,r.jsx)(tY.default,{code:o,fontSize:12,lineNumbers:!0})})})]})}var np=e.i(396776);function nh(e){var t=e.state,n=e.onSelectConflictPromptOption,i=e.onOverwriteDataAndDeploy,o=e.onCancel;switch(t.type){case tK.PrepareDatabaseStageType.FoundDiff:break;case tK.PrepareDatabaseStageType.GeneratingDiffStatements:switch(t.status){case"paused":var a=t.conflictPrompt;return(0,r.jsx)(nl,{conflictPrompt:a,onSelectConflictPromptOption:n});case"completed":var s=t.infoToPrint,l=t.maybeNonBackwardsCompatible,u=t.statementsToExecute;return(0,r.jsx)(t7,{infoToPrint:s,statementsToExecute:u,maybeNonBackwardsCompatible:l});default:return null}case tK.PrepareDatabaseStageType.ValidatingDiffStatements:switch(t.status){case"paused":var c=t.statementError;return(0,r.jsx)(nf,{statementError:c,onOverwriteDataAndDeploy:i,onCancel:o});case"completed":return(0,r.jsx)(nc,{});default:return null}}}function ng(e){var t=e.state,n=e.onSelectConflictPromptOption,i=e.onOverwriteDataAndDeploy,o=e.onCancel;return(0,r.jsxs)(r.Fragment,{children:[t.errorMessage?(0,r.jsx)(er.View,{pb:6,children:(0,r.jsx)(np.StatusBanner,{text:t.errorMessage,colorway:"warning",icon:(0,r.jsx)(eu.default,{})})}):null,(0,r.jsx)(nh,{state:t,onSelectConflictPromptOption:n,onOverwriteDataAndDeploy:i,onCancel:o})]})}var nm=e.i(947941),nv=e.i(253711);function nx(e){var t=e.status,n="",i="",o=null;switch(t){case"completed":n=z.tokens.accentPositiveDimmest,i=z.tokens.accentPositiveStrongest,o=(0,r.jsx)(tI.default,{});break;case"running":n=z.tokens.accentPrimaryDimmest,i=z.tokens.accentPrimaryStrongest,o=(0,r.jsx)(el.default,{});break;case"paused":n=z.tokens.orangeDimmest,i=z.tokens.orangeStrongest,o=(0,r.jsx)(nm.default,{})}return(0,r.jsx)("div",{clsx:nv.default.stageIcon,style:{background:n,color:i},children:o})}var ny=e.i(859158);function nb(e){var t,o=e.state,a=e.focusedStage,s=e.onApproveAndDeploy,l=e.onCreatePreviewDeploy,u=e.onSelectConflictPromptOption,c=e.onOverwriteDataAndDeploy,d=e.onCancel,f=(o.type===tK.PrepareDatabaseStageType.GeneratingDiffStatements||o.type===tK.PrepareDatabaseStageType.ValidatingDiffStatements)&&a===o.type,p=(0,n._)((0,i.useState)(f),2),h=p[0],g=p[1];(0,i.useEffect)(function(){g(f)},[f]);var m=(o.type===tK.PrepareDatabaseStageType.GeneratingDiffStatements||o.type===tK.PrepareDatabaseStageType.ValidatingDiffStatements)&&"running"!==o.status,x=m&&h,y="completed"===o.status;return(0,r.jsxs)(ee.Surface,{clsx:ny.default.stage,elevated:!0,p:8,children:[(0,r.jsxs)(er.View,{clsx:(t={},(0,tT._)(t,ny.default.stageHeader,x),(0,tT._)(t,ny.default.isExpanded,!y||x),t),row:!0,gap:8,align:"center",justify:"space-between",wrap:!y,shrink:!0,children:[(0,r.jsxs)(er.View,{row:!0,gap:8,align:"center",shrink:!0,children:[(0,r.jsx)(nx,{status:o.status}),(0,r.jsx)(et.Text,{color:y?"dimmer":"default",shrink:!0,children:function(e){var t=e.type,n=e.status;switch(t){case tK.PrepareDatabaseStageType.FoundDiff:return"Development database changes detected";case tK.PrepareDatabaseStageType.GeneratingDiffStatements:switch(n){case tK.PrepareDatabaseBaseStageStateStatus.Running:return"Generating database migrations...";case tK.PrepareDatabaseBaseStageStateStatus.Completed:return"Generated migrations to apply to production database";case tK.PrepareDatabaseBaseStageStateStatus.Paused:return"Detected potential conflicts, please review";case tK.PrepareDatabaseBaseStageStateStatus.Failed:return"Failed to generate database migrations";default:return(0,tq.default)(n)}case tK.PrepareDatabaseStageType.ValidatingDiffStatements:switch(n){case tK.PrepareDatabaseBaseStageStateStatus.Running:return"Validating database migrations...";case tK.PrepareDatabaseBaseStageStateStatus.Completed:return"Database migrations validated successfully";case tK.PrepareDatabaseBaseStageStateStatus.Paused:return"Migrations failed validation, please review";case tK.PrepareDatabaseBaseStageStateStatus.Failed:return"Failed to validate database migrations";default:return(0,tq.default)(n)}default:return(0,tq.default)(t)}}({type:o.type,status:o.status})})]}),(0,r.jsx)(tQ.PrepareDatabaseHeader,{state:o,canExpand:m,expandedToggle:h,onApproveAndDeploy:s,onCreatePreviewDeploy:l,setExpandedToggle:g})]}),x?(0,r.jsx)(ng,{state:o,onSelectConflictPromptOption:u,onOverwriteDataAndDeploy:c,onCancel:d}):null]})}var nw=e.i(394212),nk=e.i(64386),n_=e.i(262664),nS=e.i(424746),nC=e.i(442121);function nj(){var e=(0,C._)(["\n  mutation ValidateDiffStatementsAndPreparePreviewDeploy(\n    $input: CreateHostingPreviewDeployInput!\n  ) {\n    createHostingPreviewDeploy(input: $input) {\n      ... on CreateHostingPreviewDeployResult {\n        preview {\n          id\n          url\n          expiresAt\n        }\n      }\n      ... on Error {\n        message\n      }\n    }\n  }\n"]);return nj=function(){return e},e}function nT(){var e=(0,C._)(["\n  mutation ContinueHostingPreviewDeploy(\n    $input: ContinueHostingPreviewDeployInput!\n  ) {\n    continueHostingPreviewDeploy(input: $input) {\n      ... on ContinueHostingPreviewDeployResult {\n        success\n      }\n      ... on Error {\n        message\n      }\n    }\n  }\n"]);return nT=function(){return e},e}var nE={},nR=(0,eA.gql)(nj()),nI=(0,eA.gql)(nT()),nA=e.i(613007),nP=e.i(379334),nD=e.i(729678),nO=e.i(299798),nN=e.i(988676),nM=(0,H.cssRecord)({self:[W.rcss.borderRadius(0,0,4,4),W.rcss.overflow("hidden")],text:[W.rcss.display.flex,W.rcss.py(12),W.rcss.px(16)],bottom:[W.rcss.borderRadius(0,0,4,4),W.rcss.overflow("hidden")]});function nL(e){var t,o,a,c,d,f,p,h,g,w,k,_,S,C,j,T,E,I,A,P,D,O,N,M,L,B,V,U,G,$,z,H,W,q,K,Y=e.provider,Q=e.activeStage,X=e.pausedStage,J=(o=(t=(0,tK.usePrepareDatabaseState)()).state,a=t.dispatch,c=t.getState,d=(0,n_.useHeliumDevelopmentDatabase)().database,f=(0,nS.useNeonDevelopmentDatabase)().database,p=(0,nS.useNeonProductionDatabase)().database,V=(h=(0,F.default)(),g=(0,nC.useApolloClient)(),w=(0,s.useSecretsService)(),k=(0,s.useDeploymentTimeCreated)(),_=(0,s.useDeploymentCurrentBuild)(),S=(0,nD.useGetSecretsAsDeploymentEntries)({secrets:w,replId:h}),C=(0,nS.useNeonProductionDatabase)().database,T=(j=(0,tK.usePrepareDatabaseState)()).state,E=j.dispatch,I=j.getState,P=(0,n._)((A=(0,x._)({},nE,void 0),eN.useMutation(nR,A)),1)[0],O=(0,n._)((D=(0,x._)({},nE,void 0),eN.useMutation(nI,D)),1)[0],M=(N=(0,tK.getStageByType)(T.stages,tK.PrepareDatabaseStageType.ValidatingDiffStatements))&&N.status===tK.PrepareDatabaseBaseStageStateStatus.Running&&N.previewId,L=N&&N.status===tK.PrepareDatabaseBaseStageStateStatus.Completed&&N.previewId&&N.preview&&"building"===N.preview.status,(0,nA.useGetAgentRollbackPreviewStatusSubscription)({variables:{input:{previewID:N&&N.previewId?N.previewId:null}},skip:!M&&!L,onData:function(e){var t=e.data.data;if(null==t?void 0:t.getAgentRollbackPreviewStatus){var n=t.getAgentRollbackPreviewStatus;"RollbackPreviewOutput"===n.__typename?"success"===n.status&&n.host?E({type:"SET_PREVIEW_DEPLOY",preview:{status:tK.PrepareDatabasePreviewDeployStatus.Ready,url:"https://".concat(n.host),expiresAt:new Date(Date.now()+72e5).toISOString()}}):"fail"===n.status?E({type:"STAGE_ERROR",stage:tK.PrepareDatabaseStageType.ValidatingDiffStatements,errorMessage:"Preview build failed"}):"database-ready"===n.status?N&&"running"===N.status&&N.previewId&&E({type:"COMPLETED",stage:tK.PrepareDatabaseStageType.ValidatingDiffStatements}):"migration-error"===n.status?E({type:"MIGRATION_VALIDATION_ERROR",statementError:n.errorMessage||"Statement error occurred"}):"pending"===n.status&&E({type:"SET_PREVIEW_DEPLOY",preview:{status:tK.PrepareDatabasePreviewDeployStatus.Building}}):("NotFoundError"===n.__typename||"UnauthorizedError"===n.__typename||"UserError"===n.__typename||"ServiceUnavailable"===n.__typename)&&E({type:"STAGE_ERROR",stage:tK.PrepareDatabaseStageType.ValidatingDiffStatements,errorMessage:n.message||"Failed to build preview"})}},onError:function(){E({type:"STAGE_ERROR",stage:tK.PrepareDatabaseStageType.ValidatingDiffStatements,errorMessage:"Failed to monitor preview status"})}}),B={validateDiffStatements:(0,i.useCallback)(function(e){return(0,m._)(function(){var t,n,r,i,o,a,l;return(0,b._)(this,function(u){switch(u.label){case 0:if(t=I().stages,!(n=(0,tK.getStageByType)(t,tK.PrepareDatabaseStageType.GeneratingDiffStatements)))return E({type:"STAGE_ERROR",stage:tK.PrepareDatabaseStageType.ValidatingDiffStatements,errorMessage:"Cannot validate statements without generating diff statements stage"}),[2];if("completed"!==n.status)return E({type:"STAGE_ERROR",stage:tK.PrepareDatabaseStageType.ValidatingDiffStatements,errorMessage:"Cannot validate statements when diff statements stage is not completed"}),[2];if((0,tK.getStageByType)(t,tK.PrepareDatabaseStageType.ValidatingDiffStatements))return E({type:"STAGE_ERROR",stage:tK.PrepareDatabaseStageType.ValidatingDiffStatements,errorMessage:"Cannot validate statements, stage already exists"}),[2];E({type:"SET_STAGE",stageState:{type:tK.PrepareDatabaseStageType.ValidatingDiffStatements,status:tK.PrepareDatabaseBaseStageStateStatus.Running}}),u.label=1;case 1:return u.trys.push([1,5,,6]),[4,S()];case 2:return r=u.sent(),[4,(0,s.determineIgnoredSecretKeys)({deploymentTimeCreated:k,buildTimeCreated:null==_?void 0:_.timeCreated,ignoreSecretsUntil:nP.SYNCING_SECRETS_ROLLOUT_DATE,replId:h,apolloClient:g})];case 3:return i=u.sent(),[4,P({variables:{input:{replId:h,envVars:(0,s.mergeEnvironmentVariables)({currentBuildVars:null==_?void 0:_.envVars,workspaceSecrets:r,ignoredSecretKeys:i})||[],neonProjectId:(null==C?void 0:C.projectId)||void 0,sqlStatementsToExecute:e}}})];case 4:return(null==(o=u.sent().data)?void 0:o.createHostingPreviewDeploy)&&("CreateHostingPreviewDeployResult"===o.createHostingPreviewDeploy.__typename?(a=o.createHostingPreviewDeploy.preview,E({type:"SET_STAGE",stageState:{type:tK.PrepareDatabaseStageType.ValidatingDiffStatements,status:tK.PrepareDatabaseBaseStageStateStatus.Running,previewId:a.id}})):E({type:"STAGE_ERROR",stage:tK.PrepareDatabaseStageType.ValidatingDiffStatements,errorMessage:o.createHostingPreviewDeploy.message||"Failed to create preview"})),[3,6];case 5:return l=u.sent(),E({type:"STAGE_ERROR",stage:tK.PrepareDatabaseStageType.ValidatingDiffStatements,errorMessage:(0,R._)(l,Error)?l.message:"Failed to create preview deploy"}),[3,6];case 6:return[2]}})})()},[h,g,k,_,C,I,S,E,P]),createPreviewDeploy:(0,i.useCallback)(function(e){return(0,m._)(function(){var t,n;return(0,b._)(this,function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),E({type:"SET_PREVIEW_DEPLOY",preview:{status:tK.PrepareDatabasePreviewDeployStatus.Building}}),[4,O({variables:{input:{previewId:e}}})];case 1:if((null==(t=r.sent().data)?void 0:t.continueHostingPreviewDeploy)&&"ContinueHostingPreviewDeployResult"!==t.continueHostingPreviewDeploy.__typename)return E({type:"SET_PREVIEW_DEPLOY",preview:{status:tK.PrepareDatabasePreviewDeployStatus.Failed}}),E({type:"STAGE_ERROR",stage:tK.PrepareDatabaseStageType.ValidatingDiffStatements,errorMessage:t.continueHostingPreviewDeploy.message||"Failed to create preview"}),[2];return[3,3];case 2:return n=r.sent(),E({type:"SET_PREVIEW_DEPLOY",preview:{status:tK.PrepareDatabasePreviewDeployStatus.Failed}}),E({type:"STAGE_ERROR",stage:tK.PrepareDatabaseStageType.ValidatingDiffStatements,errorMessage:(0,R._)(n,Error)?n.message:"Failed to create preview deploy"}),[3,3];case 3:return[2]}})})()},[O,E])}).validateDiffStatements,U=B.createPreviewDeploy,G=(0,s.useDeployBuild)().approveAndDeployDatabaseChanges,$=(0,l.useSetDeploymentMode)(),z=(0,i.useRef)(null),H=(0,i.useCallback)(function(e){z.current&&z.current.write(e)},[]),(0,nO.usePid2)(function(e,t){var n=t.signal;return(0,m._)(function(){var t,r,i,o,s,l,u,c,h,g,m;return(0,b._)(this,function(y){switch(y.label){case 0:if(!f&&!d)return[2];if(a({type:"SET_STAGE",stageState:{type:tK.PrepareDatabaseStageType.GeneratingDiffStatements,status:tK.PrepareDatabaseBaseStageStateStatus.Running}}),!(t=d?d.connectionString:null==f?void 0:f.connectionString))throw Error("Development database connection string not found.");i=(r=e.prepareDatabaseMigrations.generateDiffStatements.stream({sourceConnectionString:t,targetConnectionString:null==p?void 0:p.connectionString},{signal:n})).resReadable,z.current=o=r.reqWritable,s=!1,l=!1,y.label=1;case 1:y.trys.push([1,6,7,12]),c=(0,nw._)(i),y.label=2;case 2:return[4,c.next()];case 3:if(!(s=!(h=y.sent()).done))return[3,5];if(!(g=h.value).ok){if("UNEXPECTED_DISCONNECT"===g.payload.code||"CANCEL"===g.payload.code)return[2];throw Error("[".concat(g.payload.code,"] ").concat(g.payload.message))}switch(g.payload.$kind){case"none":a({type:"COMPLETED",stage:tK.PrepareDatabaseStageType.GeneratingDiffStatements});break;case"diff":a((0,nk._)((0,x._)({},g.payload.result),{type:"COMPLETED",stage:tK.PrepareDatabaseStageType.GeneratingDiffStatements})),V(g.payload.result.statementsToExecute);break;case"columnConflictPrompt":case"namedConflictPrompt":case"namedWithSchemaConflictPrompt":case"schemaConflictPrompt":case"selectPrompt":a({type:"CONFLICT_PROMPT",conflictPrompt:g.payload});break;default:(0,tq.default)(g.payload)}y.label=4;case 4:return s=!1,[3,2];case 5:return[3,12];case 6:return m=y.sent(),l=!0,u=m,[3,12];case 7:if(y.trys.push([7,,10,11]),!(s&&null!=c.return))return[3,9];return[4,c.return()];case 8:y.sent(),y.label=9;case 9:return[3,11];case 10:if(l)throw u;return[7];case 11:return[7];case 12:return o.close(),[2]}})})()},[a,d,f,p,V]),W=(0,i.useCallback)(function(){var e=c(),t=e.id,n=e.stages,r=(0,tK.getStageByType)(n,tK.PrepareDatabaseStageType.GeneratingDiffStatements);if(!r||r.status!==tK.PrepareDatabaseBaseStageStateStatus.Completed)throw Error("Cannot approve and deploy database changes, stage is not completed");var i=r.statementsToExecute;if(!i||0===i.length)throw Error("Could not approve and deploy, no statements to execute");G({prepareDatabaseStateId:t,sqlStatementsToExecute:i})},[G,c]),q=(0,i.useCallback)(function(){return(0,m._)(function(){return(0,b._)(this,function(e){return G({prepareDatabaseStateId:c().id,pushDevelopmentDatabaseObjects:"overwriteData"}),[2]})})()},[G,c]),K=(0,i.useCallback)(function(){var e;c().id&&(a({type:"CANCEL"}),$(u.DeploymentMode.Ready),null==(e=z.current)||e.close())},[a,c,$]),{state:o,getState:c,selectConflictPromptOption:H,createPreviewDeploy:U,approveAndDeploy:W,overwriteDataAndDeploy:q,cancelPreparingDatabase:K}),Z=J.state,ee=J.selectConflictPromptOption,et=J.createPreviewDeploy,en=J.approveAndDeploy,ei=J.overwriteDataAndDeploy,eo=J.cancelPreparingDatabase;return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(tW,{activeStage:Q.id,pausedStage:X,provider:Y,onCancel:eo}),(0,r.jsxs)(er.View,{css:nM.bottom,children:[(0,r.jsx)(nN.DividerH,{}),(0,r.jsx)(er.View,{css:nM.self,children:(0,r.jsx)(er.View,{css:nM.text,children:(0,r.jsx)(er.View,{gap:8,wrap:!0,children:(0,y._)(Z.stages).map(function(e,t){var i=(0,n._)(e,2),o=(i[0],i[1]);return(0,r.jsx)(nb,{state:o,focusedStage:Z.focusedStage,onSelectConflictPromptOption:ee,onCreatePreviewDeploy:et,onApproveAndDeploy:en,onOverwriteDataAndDeploy:ei,onCancel:eo},t)})})})})]})]})}var nB=[W.rcss.borderRadius(),{border:"1px solid ".concat(z.tokens.outlineDimmer)}],nV=(0,H.cssRecord)({container:nB,bottom:[W.rcss.borderRadius(0,0,4,4),W.rcss.overflow("hidden")],logsOpen:[W.rcss.overflow("hidden"),W.rcss.height("auto")],logsClosed:[W.rcss.overflow("hidden"),W.rcss.height(0)],xtermContainer:[W.rcss.display.flex,W.rcss.pt(12),W.rcss.pl(16),W.rcss.overflow("hidden")],xterm:[W.rcss.width("100%"),W.rcss.maxWidth("100%"),W.rcss.height(340)],divider:W.rcss.backgroundColor.outlineDimmer}),nF=function(e){var t=(0,l.useDeploymentMode)();return t===u.DeploymentMode.Preparing?(0,r.jsx)(er.View,{css:nV.container,children:(0,r.jsx)(tW,{})}):t===u.DeploymentMode.PreparingDatabase?(0,r.jsx)(nG,{}):(0,r.jsx)(n$,(0,x._)({},e))},nU=function(){var e=(0,s.useDeploymentSecurityScanState)().enabled;return(0,i.useMemo)(function(){return e?tM:tL},[e])};function nG(){var e=tF(nU(),a.HostingBuildStatus.Pending),t=(0,k.usePauseProvisionStage)()?null==e?void 0:e.id:void 0,n=(0,s.useDeploymentCurrentBuild)();return e?(0,r.jsx)(er.View,{css:nV.container,children:(0,r.jsx)(nL,{provider:null==n?void 0:n.provider,activeStage:e,pausedStage:t})}):null}var n$=function(e){var t,o,l,u,d,f,p,h,g,x,k,C=e.initialBuild,j=e.viewBuildLogsOnLoad,T=e.onViewLogs,E=e.onCanceled,R=e.onError,I=e.openFile,A=e.openPane,P=(0,s.useCancelInProgressDeploymentsBuild)(),D=(0,s.useDeploymentInProgressBuild)(),O=nU(),N=D?{id:D.id,status:D.status,provider:D.provider,timeStarted:D.timeCreated,userDisplayName:D.user.displayName,debugSummary:D.debugSummary}:void 0,M=(0,i.useRef)(C||N),L=(0,w.useHostingDeployActionHistoryQuery)({skip:!(null==(t=M.current)?void 0:t.id),variables:{input:{buildId:null!=(k=null==(o=M.current)?void 0:o.id)?k:""}},fetchPolicy:"network-only",ssr:!1,onCompleted:function(e){if(null==e?void 0:e.hostingBuildDeployActionHistory)switch(e.hostingBuildDeployActionHistory.__typename){case"NotFoundError":break;case"UnauthorizedError":R(e.hostingBuildDeployActionHistory.message);break;case"HostingBuildDeployActionHistoryResults":var t=e.hostingBuildDeployActionHistory.results;if(t&&t.length>0){var n=[],r=[],i=!0,o=!1,a=void 0;try{for(var s,l=t[Symbol.iterator]();!(i=(s=l.next()).done);i=!0){var u=s.value;switch(u.__typename){case"HostingBuildDeployLogAction":n.push(u.log);break;case"HostingBuildDeployStatusAction":r.push(u)}}}catch(e){o=!0,a=e}finally{try{i||null==l.return||l.return()}finally{if(o)throw a}}ea({type:"setHistory",payload:n});var c=!0,d=!1,f=void 0;try{for(var p,h=r[Symbol.iterator]();!(c=(p=h.next()).done);c=!0){var g=p.value;es(g.status,g.debugSummary)}}catch(e){d=!0,f=e}finally{try{c||null==h.return||h.return()}finally{if(d)throw f}}}break;default:R("Unexpected typename.")}},onError:function(e){R(e.message)}}),B=L.loading,V=L.refetch;(0,s.useLatestBuildActionUpdate)(function(e){switch(e.__typename){case"HostingBuildDeployLogAction":ea({type:"addLog",payload:e.log});break;case"HostingBuildDeployStatusAction":es(e.status,e.debugSummary)}});var F=(0,n._)((0,i.useState)(M.current?null==(l=tF(O,M.current.status))?void 0:l.id:void 0),2),U=F[0],G=F[1],$=(0,n._)((0,i.useState)((null==(u=M.current)?void 0:u.status)==="failed"?null==(d=tF(O,null==(f=M.current)?void 0:f.status))?void 0:d.id:void 0),2),z=$[0],H=$[1],W=(0,n._)((0,i.useState)((null==(p=M.current)?void 0:p.debugSummary)||void 0),2),q=W[0],K=W[1],Y=(0,n._)((0,i.useState)(!1),2),Q=Y[0],X=Y[1],J=(0,s.useFsService)(),Z=(0,n._)((0,_.default)({openFile:I,listFiles:J.listFiles}),2),ee=Z[0],et=Z[1],en=(0,S.useTerminalTheme)(),ei=(0,n._)((0,i.useReducer)(function(e,t){switch(t.type){case"setHistory":return ee&&ee.clear(),{allLogs:(0,y._)(t.payload).concat((0,y._)(e.allLogs))};case"addLog":return{allLogs:(0,y._)(e.allLogs).concat([t.payload]),recentLogs:[t.payload]};case"refetchLogs":return ee&&ee.clear(),B||V(),{allLogs:[]}}},{allLogs:[]}),2),eo=ei[0],ea=ei[1],es=function(e,t){if(e===a.HostingBuildStatus.Failed)H(U),t&&K(t);else{var n=tF(O,e);if(!n)return;G(n.id)}},el=(0,n._)((0,i.useState)(j||!1),2),eu=el[0],ec=el[1],ed=function(){ec(!eu),eu||(0,c.trackDeploymentSectionViewed)({context:"deploy_progress_logs"})};(0,i.useEffect)(function(){(0,c.trackDeploymentSectionViewed)({context:"deploy_progress"})},[]),(0,i.useEffect)(function(){var e;(null==(e=M.current)?void 0:e.id)&&D&&D.id!==M.current.id&&(M.current={id:D.id,status:D.status,provider:D.provider,timeStarted:D.timeCreated,userDisplayName:D.user.displayName,debugSummary:D.debugSummary},G(void 0),H(void 0),ea({type:"refetchLogs"}))},[D,null==(h=M.current)?void 0:h.id,V]),(0,i.useEffect)(function(){var e;void 0!==U&&(null==(e=M.current)?void 0:e.status)==="failed"&&H(U)},[U,null==(g=M.current)?void 0:g.status]),(0,i.useEffect)(function(){if(ee){if(eo.recentLogs)return void eo.recentLogs.forEach(function(e){return ee.write(e)});eo.allLogs.forEach(function(e){return ee.write(e)})}},[eo,ee]);var ef=null===(x=O.find(function(e){return e.id===U}))||void 0===x?void 0:x.statusType,ep=ef!==a.HostingBuildStatus.Success&&!z;return M.current?(0,r.jsxs)(er.View,{css:nV.container,children:[(0,r.jsx)(tW,{onCancel:ep?function(){return(0,m._)(function(){return(0,b._)(this,function(e){switch(e.label){case 0:return X(!0),[4,P()];case 1:return e.sent(),E(),[2]}})})()}:void 0,isCanceling:Q,onViewBuildLogs:ed,viewBuildLogs:eu,provider:M.current.provider,timeStarted:M.current.timeStarted,userDisplayName:M.current.userDisplayName,activeStage:U,erroredStage:z}),(0,r.jsxs)(er.View,{css:nV.bottom,children:[(0,r.jsxs)(er.View,{css:eu?nV.logsOpen:nV.logsClosed,children:[(0,r.jsx)(nN.DividerH,{css:nV.divider}),(0,r.jsx)(er.View,{css:nV.xtermContainer,style:{backgroundColor:null==en?void 0:en.background},children:(0,r.jsx)(er.SpecializedView.div,{css:nV.xterm,ref:et})})]}),z&&ef?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(nN.DividerH,{css:nV.divider}),(0,r.jsx)(ew,{currentStatus:ef,provider:M.current.provider,debugSummary:q,logs:eo.allLogs,viewBuildLogs:eu,openFile:I,openPane:A,onViewBuildLogs:ed,onViewApplicationLogs:T})]}):null]})]}):null},nz=e.i(165349),nH=e.i(928838),nW=e.i(198992),nq=((t=nq||{}).Current="current",t),nK=(0,tT._)({},"current",{icon:(0,r.jsx)(function(e){var t=e.color;return(0,r.jsx)(er.View,{css:[{textTransform:"capitalize"}],align:"center",row:!0,gap:8,children:(0,r.jsx)(er.View,{tag:"span",css:[W.rcss.width("8px"),W.rcss.height("8px"),W.rcss.borderRadius("full"),{backgroundColor:t,boxShadow:"0 0 12px ".concat(t)}]})})},{color:z.tokens.blueStronger}),text:"Current deployment"}),nY=function(e){var t=e.activityLogItem.type,n=t in nK&&nK[t];if(!n)return null;var i=n.icon,o=n.text;return(0,r.jsx)(en.Tooltip,{tooltip:o,children:(0,r.jsx)(er.View,{p:8,children:i})})},nQ=e.i(863753),nX=e.i(90102),nX=nX,nJ=(0,H.cssRecord)({title:[W.rcss.fontSize(24),W.rcss.pt(32)],subtitle:[W.rcss.pt(6)],accordionContainer:[W.rcss.pt(24)],accordion:[W.rcss.backgroundColor.backgroundHigher,W.rcss.borderRadius(6)],accordionItem:[W.rcss.px(8),W.rcss.py(2),W.rcss.rowWithGap(8),W.rcss.align.center],tableContainer:[W.rcss.backgroundColor.backgroundDefault,W.rcss.border({color:z.tokens.backgroundHigher}),W.rcss.borderRadius(0,0,6,6),W.rcss.px(12),W.rcss.pb(6)],changedSecretsDisclaimer:[W.rcss.py(8)],table:[W.rcss.width("100%"),{".tr":{display:"flex",width:"100%",flexDirection:"row"},".th":{flexDirection:"row",borderBottom:"1px solid ".concat(z.tokens.outlineDimmest),color:z.tokens.foregroundDimmer},".td":{flexDirection:"row"}}],cell:[W.rcss.fontWeight.normal,W.rcss.fontSize(z.tokens.fontSizeDefault),W.rcss.py(8),W.rcss.display.flex,W.rcss.flex.row,W.rcss.align.center,W.rcss.justify.spaceBetween],secretValue:[W.rcss.pl(4),W.rcss.color.foregroundDefault],noValue:[W.rcss.pl(4),W.rcss.color.foregroundDimmest]}),nZ=function(e){var t=e.buildSecret,n=e.shortSecretLength,i=t.slice(0,void 0===n?8:n);return i.length===t.length?(0,r.jsx)(et.Text,{children:i}):(0,r.jsx)(en.Tooltip,{tooltip:t,children:(0,r.jsxs)(et.Text,{children:[i,"..."]})})};function n0(e){var t=e.secretKey,o=e.build1Secret,a=e.build2Secret,s=e.hideSecret,l=e.selectedSecretsMap,u=e.updateSecretsMap,c=(0,n._)((0,i.useState)(l.get(t)),2),d=c[0],f=c[1],p=function(e){var n=e.buildSecret;return(0,r.jsx)("td",{className:"td",children:(0,r.jsxs)(er.View,{css:nJ.cell,style:{justifyContent:"start"},children:[(0,r.jsx)(nn.Radio,{id:t,value:null!=n?n:"",checked:d===n,onChange:function(){f(n),u({key:t,value:n})}}),n?(0,r.jsx)("span",{css:nJ.secretValue,children:s?"":(0,r.jsx)(nZ,{buildSecret:n})}):(0,r.jsx)("span",{css:nJ.noValue,children:"No Value"})]})})};return(0,r.jsxs)("tr",{children:[(0,r.jsx)("td",{className:"td",children:(0,r.jsx)(er.View,{css:nJ.cell,className:"cell",children:t})}),(0,r.jsx)(p,{buildSecret:o}),(0,r.jsx)(p,{buildSecret:a})]})}var n1=function(e){var t=e.secretKey,n=e.secretValue,i=e.hideSecret;return(0,r.jsxs)("tr",{children:[(0,r.jsx)("td",{className:"td",children:(0,r.jsx)(er.View,{css:nJ.cell,className:"cell",children:t})}),(0,r.jsx)("td",{className:"td",children:(0,r.jsx)("span",{css:nJ.cell,className:"cell",children:i?"":(0,r.jsx)(nZ,{buildSecret:n,shortSecretLength:20})})})]})};let n2=function(e){var t=e.currentBuild,o=e.build,a=e.selectedSecretsMap,s=e.updateSecretsMap,l=(0,n._)((0,i.useState)(!1),2),u=l[0],c=l[1],d=(0,n._)((0,i.useState)(!1),2),f=d[0],p=d[1],h=(0,n._)((0,i.useState)(!0),2),g=h[0],m=h[1],x=(0,n._)((0,i.useState)(!0),2),y=x[0],b=x[1],w=(0,n._)((0,i.useState)(),2),k=w[0],_=w[1];return((0,i.useEffect)(function(){var e,n,r,i,a,l,u,c,d,f=(n=(e={build1Secrets:t.envVars,build2Secrets:o.envVars}).build1Secrets,r=e.build2Secrets,i=new Map,a=new Map,l=new Map,u=new Map,c=new Set,d=new Map,n.forEach(function(e){l.set(e.name,e.value),c.add(e.name)}),r.forEach(function(e){u.set(e.name,e.value),c.add(e.name)}),c.forEach(function(e){var t=l.get(e)||void 0,n=u.get(e)||void 0;t===n?t&&(i.set(e,t),d.set(e,t)):(a.set(e,{build1Value:t,build2Value:n}),d.set(e,t))}),{unchangedSecrets:i,changedSecrets:a,defaultSelectedMap:d});f.defaultSelectedMap.forEach(function(e,t){s({key:t,value:e})}),_(f)},[o.envVars,t.envVars,s]),k&&(0!==k.unchangedSecrets.size||0!==k.changedSecrets.size))?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(er.View,{css:nJ.title,children:"Review Secrets"}),(0,r.jsx)(et.Text,{css:nJ.subtitle,children:"Manage which secrets you would like to preserve from your production deployment or from your rollback target."}),k.changedSecrets.size>0?(0,r.jsx)(er.View,{css:nJ.accordionContainer,children:(0,r.jsx)(J.AccordionItem,{headerContent:(0,r.jsxs)(er.View,{css:nJ.accordionItem,children:[(0,r.jsx)(eu.default,{color:z.tokens.yellowStronger}),k.changedSecrets.size,1===k.changedSecrets.size?" secret is ":" secrets are ","different across deployments"]}),expanded:f,onClick:function(){return p(!f)},css:nJ.accordion,children:(0,r.jsxs)(er.View,{css:nJ.tableContainer,children:[(0,r.jsx)(et.Text,{css:nJ.changedSecretsDisclaimer,children:"Select secret values from either your production environment or rollback environment to copy over in your rollback."}),(0,r.jsxs)("table",{css:nJ.table,children:[(0,r.jsxs)("tr",{children:[(0,r.jsx)("th",{className:"th",style:{width:"40%"},children:(0,r.jsx)(er.View,{css:nJ.cell,children:"Key"})}),(0,r.jsx)("th",{className:"th",style:{width:"30%"},children:(0,r.jsx)(er.View,{css:nJ.cell,children:"Production"})}),(0,r.jsx)("th",{className:"th",style:{width:"30%"},children:(0,r.jsxs)(er.View,{css:nJ.cell,children:["Rollback Build",(0,r.jsx)(Z.IconButton,{alt:y?"Reveal Values":"Hide Values",onClick:function(){b(!y)},children:y?(0,r.jsx)(nX.default,{}):(0,r.jsx)(tX.default,{})})]})})]}),Array.from(k.changedSecrets.entries()).map(function(e){var t=(0,n._)(e,2),i=t[0],o=t[1];return(0,r.jsx)(n0,{secretKey:i,build1Secret:o.build1Value,build2Secret:o.build2Value,hideSecret:y,selectedSecretsMap:a,updateSecretsMap:s},i)})]})]})})}):null,k.unchangedSecrets.size>0?(0,r.jsx)(er.View,{css:nJ.accordionContainer,children:(0,r.jsx)(J.AccordionItem,{headerContent:(0,r.jsxs)(er.View,{css:nJ.accordionItem,children:[(0,r.jsx)(tI.default,{color:z.tokens.accentPositiveStronger}),k.unchangedSecrets.size,1===k.unchangedSecrets.size?" secret is ":" secrets are ","shared across deployments"]}),expanded:u,onClick:function(){return c(!u)},css:nJ.accordion,children:(0,r.jsx)(er.View,{css:nJ.tableContainer,children:(0,r.jsxs)("table",{css:nJ.table,children:[(0,r.jsxs)("tr",{children:[(0,r.jsx)("th",{className:"th",style:{width:"40%"},children:(0,r.jsx)(er.View,{css:nJ.cell,children:"Key"})}),(0,r.jsx)("th",{className:"th",style:{width:"60%"},children:(0,r.jsxs)(er.View,{css:nJ.cell,children:["Rollback Build",(0,r.jsx)(Z.IconButton,{alt:g?"Reveal Values":"Hide Values",onClick:function(){m(!g)},children:g?(0,r.jsx)(nX.default,{}):(0,r.jsx)(tX.default,{})})]})})]}),Array.from(k.unchangedSecrets.entries()).map(function(e,t){var i=(0,n._)(e,2),o=i[0],a=i[1];return(0,r.jsx)(n1,{secretKey:o,secretValue:a,hideSecret:g},t)})]})})})}):null]}):null};var n3=e.i(391222),n4=e.i(650587),n8=e.i(820734),n5=e.i(492267),n6=e.i(714165),n9=e.i(462216),n7=e.i(352767),re=e.i(369948),rt=e.i(644826),rn=ei,rr=eo,ri=e.i(245225);function ro(e){var t=e.type,n=e.view,i=e.provider,o=e.onViewBuildLogs,a=e.openFile,s=e.openPane,l=e.onClickRollback,u=(0,F.default)();return(0,r.jsx)(ry,{replId:u,type:void 0===t?"default":t,view:n,provider:i,onSelect:o,openFile:a,openPane:s,onClickRollback:l})}var ra=tM.filter(function(e){return"title"in e}),rs=(0,H.cssRecord)({root:[{zIndex:0}]});function rl(e){var t=e.activeStage,n=e.erroredStage;return(0,r.jsx)(er.View,{css:rs.root,px:8,pb:8,row:!0,children:ra.map(function(e){return(0,r.jsx)(tN,{stage:e.id,text:e.title,totalStagesWithTitle:ra.length,activeStage:t,erroredStage:n},e.id)})})}var ru=(0,H.cssRecord)({root:[W.rcss.height("100%")],divider:[{marginLeft:8,marginRight:8,borderBottom:"1px solid "+z.tokens.outlineDimmest}],name:[W.rcss.color.foregroundDefault,W.rcss.fontWeight.medium],content:[W.rcss.position.relative],loading:[W.rcss.coverContainer,W.rcss.center],error:[W.rcss.m(8),W.rcss.borderRadius(8),W.rcss.overflow("hidden")],xterm:[W.rcss.coverContainer,{overflow:"hidden",borderBottomLeftRadius:8,borderBottomRightRadius:8,"& > div":[W.rcss.coverContainer,W.rcss.p(8)]}]}),rc=(0,H.cssRecord)({root:[nW.sharedCss.maxWidth],title:[W.rcss.fontSize(24),W.rcss.pt(8)],subheader:[W.rcss.fontSize(14)],content:[W.rcss.position.relative],prodToTargetContainer:[{b:{display:"contents",fontWeight:500}}],prodStatusDot:[W.rcss.width(12),W.rcss.align.center],buildContainer:[W.rcss.borderRadius(),{outline:"1px solid ".concat(z.tokens.outlineDimmer)},W.rcss.backgroundColor.outlineDimmest,W.rcss.width("45%"),W.rcss.height("100%")],buildContainerTitle:[W.rcss.fontSize(16),W.rcss.align.center],buildContainerSubTitle:[W.rcss.color.foregroundDimmer]});function rd(e){var t=e.build,n=e.isCurrentBuild,i=Date.now(),o=(0,eI.formatDistance)(new Date(t.timeCreated),i,{addSuffix:!0}),a=n?(0,r.jsx)(er.View,{css:rc.prodStatusDot,children:(0,r.jsx)(n3.DeploymentStatusDot,{status:t.status})}):(0,r.jsx)(ri.default,{color:z.tokens.outlineStrongest,size:12});return(0,r.jsxs)(er.View,{css:rc.buildContainer,py:12,px:16,gap:8,children:[(0,r.jsxs)(er.View,{css:rc.buildContainerTitle,row:!0,gap:6,children:[a,n?"Production":t.id.slice(0,8)]}),(0,r.jsxs)(er.View,{css:rc.buildContainerSubTitle,row:!0,gap:6,align:"center",children:[(0,r.jsx)(n6.Avatar,{src:t.user.image||null,size:12,username:t.user.username||"",fullName:t.user.fullName||""}),(0,r.jsx)("b",{children:" "+t.user.displayName})," deployed"," "+o]})]})}function rf(e){var t=e.build,o=e.onBack,a=e.onClickRollback,l=e.onError,u=(0,s.useDeploymentCurrentBuild)(),c=(0,n._)((0,i.useState)(new Map),2),d=c[0],f=c[1],p=(0,n4.useIsMobile)();return u?(0,r.jsxs)(er.View,{css:rc.root,pt:12,pb:16,children:[(0,r.jsx)(er.View,{pt:8,pl:8,row:!0,gap:8,align:"center",children:(0,r.jsx)(Z.IconButton,{alt:"Back to timeline",onClick:function(){return o()},children:(0,r.jsx)(n7.default,{})})}),(0,r.jsxs)(er.View,{css:rc.content,grow:!0,shrink:!0,px:8,children:[(0,r.jsx)(er.View,{css:rc.title,children:"Instant Rollback"}),(0,r.jsx)(er.View,{css:rc.subheader,pt:12,children:"Replace your current production with a previously successful deployment."}),(0,r.jsxs)(er.View,{css:rc.prodToTargetContainer,pt:32,children:["Rolling back from ",(0,r.jsx)("b",{children:"production"})," to the following"," ",(0,r.jsx)("b",{children:"rollback target"}),":",(0,r.jsxs)(er.View,{grow:!0,shrink:!0,align:"center",justify:"space-between",pt:16,row:!0,gap:8,children:[(0,r.jsx)(rd,{build:u,isCurrentBuild:!0}),(0,r.jsx)(re.default,{}),(0,r.jsx)(rd,{build:t,isCurrentBuild:!1})]})]}),p?null:(0,r.jsx)(n2,{build:t,currentBuild:u,updateSecretsMap:function(e){var t=e.key,n=e.value;f(d.set(t,n))},selectedSecretsMap:d}),(0,r.jsx)(er.View,{pt:24,children:(0,r.jsx)(q.Button,{text:"Confirm Rollback",iconLeft:(0,r.jsx)(n9.RotateCcw,{}),onClick:function(){var e=[];d.forEach(function(t,n){t&&e.push({name:n,value:t})}),a(e),o()},colorway:"primary"})})]})]}):(l("This deployment does not have a current build to rollback from"),null)}function rp(e){var t=e.build,o=e.onBack,s=e.fs,l=e.openFile,u=e.openPane,c=e.onViewAppLogs,d=(0,n._)((0,_.default)({openFile:l,listFiles:s.listFiles}),2),f=d[0],p=d[1],h=(0,nz.useHostingActivityLogBuildHistoryQuery)({variables:{input:{buildId:t.id}},ssr:!1,fetchPolicy:"cache-and-network"}),g=h.data,m=h.loading,x=(0,i.useMemo)(function(){var e=[],t=g&&"HostingBuildDeployActionHistoryResults"===g.hostingBuildDeployActionHistory.__typename?g.hostingBuildDeployActionHistory.results:null;if(t){var n=void 0,r=void 0,i=void 0,o=!0,s=!1,l=void 0;try{for(var u,c,d=t[Symbol.iterator]();!(o=(c=d.next()).done);o=!0)!function(){var t=c.value;if("HostingBuildDeployLogAction"===t.__typename)return e.push(t.log);tM.some(function(e){return e.statusType===t.status})&&(n=t.status),t.status===a.HostingBuildStatus.Failed&&(r=n)}()}catch(e){s=!0,l=e}finally{try{o||null==d.return||d.return()}finally{if(s)throw l}}var f=n?null==(u=tF(tM,n))?void 0:u.id:void 0;return r&&(i=f),{logs:e,activeStage:f,erroredStage:i,erroredStatus:r}}},[g]);return(0,i.useEffect)(function(){f&&x&&f.write(x.logs.join(""))},[f,x]),(0,r.jsxs)(er.View,{css:ru.root,gap:8,children:[(0,r.jsxs)(er.View,{pt:8,px:8,row:!0,gap:8,align:"center",children:[(0,r.jsx)(Z.IconButton,{alt:"Back to timeline",onClick:function(){return o()},children:(0,r.jsx)(n7.default,{})}),(0,r.jsx)(er.View,{children:(0,r.jsxs)(et.Text,{color:"dimmer",multiline:!1,children:[(0,r.jsx)("span",{css:ru.name,children:t.user.displayName+" "}),(0,nH.getStatusSentenceText)(t.status)]})}),(0,r.jsx)(nQ.ActivityLogTextBuildPill,{build:t})]}),x||m?(0,r.jsxs)(r.Fragment,{children:[(null==x?void 0:x.erroredStatus)?(0,r.jsx)(er.View,{css:ru.error,children:(0,r.jsx)(ek,{currentStatus:x.erroredStatus,provider:t.provider,debugSummary:t.debugSummary,openFile:l,openPane:u,onViewApplicationLogs:c})}):null,(0,r.jsx)(rl,{activeStage:null==x?void 0:x.activeStage,erroredStage:null==x?void 0:x.erroredStage}),(0,r.jsx)(er.View,{css:ru.divider}),(0,r.jsxs)(ee.Surface,{css:ru.content,grow:!0,shrink:!0,p:8,children:[(0,r.jsx)(er.View,{css:ru.xterm,innerRef:p}),m||!f?(0,r.jsx)(er.View,{css:ru.loading,children:(0,r.jsx)(el.default,{color:z.tokens.white,size:24})}):null]})]}):(0,r.jsx)(eR,{provider:t.provider,openFile:l})]})}var rh=(0,H.cssRecord)({item:W.rcss.rowWithGap(12),past:{":last-of-type":{"[data-timeline-line]":{display:"none"}}},future:{":last-of-type":{"[data-timeline-line]":{bottom:-19}}}}),rg=(0,H.cssRecord)({empty:[W.rcss.center,W.rcss.align.stretch],items:[],loadMore:[W.rcss.center],item:[W.rcss.color.foregroundDimmest,W.rcss.hover(W.rcss.color.foregroundDefault),{"&:hover .itemRight":{display:"flex"},"&:hover .itemLine":{display:"flex"}}],itemMainText:[(0,tT._)({},W.container.min(640),W.rcss.flex.growAndShrink(0))],itemLine:[W.rcss.display.none,(0,tT._)({},W.container.min(640),[W.rcss.flex.growAndShrink(1),W.rcss.border({color:z.tokens.outlineDimmest,direction:"top"})])],itemRight:[W.rcss.textAlign.right,W.rcss.display.none],itemPast:[rh.item,rh.past],itemFuture:[rh.item,rh.future],disabledLog:{cursor:"not-allowed"}}),rm=(0,H.cssRecord)({top:W.rcss.rowWithGap(12),button:[W.rcss.reset.button,W.rcss.cursor.pointer,W.rcss.borderRadius(8),W.rcss.display.flex,W.rcss.rowWithGap(6),W.rcss.align.center,W.rcss.px(8),W.rcss.color.foregroundDimmer,W.rcss.height(32),W.rcss.hover(W.rcss.color.foregroundDefault),{'&[data-highlight="true"]':[W.rcss.color.accentNegativeStrongest,W.rcss.backgroundColor.accentNegativeDimmest,W.rcss.border({color:z.tokens.accentNegativeDimmer})]}],info:[W.rcss.flex.growAndShrink(1),{'&[data-open="false"]':W.rcss.pb(6)}],buttonContent:[W.rcss.flex.growAndShrink(1),W.rcss.rowWithGap(8),W.rcss.align.center],failedBuildList:W.rcss.pt(8)});function rv(e){var t=e.items,o=e.upcomingBuildStatus,a=e.view,s=e.provider,c=e.onClick,f=e.openFile,p=e.openPane,g=(0,n._)((0,i.useState)(!1),2),m=g[0],x=g[1],y=(0,l.useDeploymentMode)(),b=t[0],w=b.build.debugSummary,k=y===u.DeploymentMode.Ready&&!o&&a!==d.Views.DeploymentInProgress&&w;return(0,r.jsxs)(er.View,{children:[(0,r.jsxs)(er.View,{css:rm.top,children:[(0,r.jsx)(h.TimelinePoint,{type:m?"futureFailOpen":"futureFailClosed"}),(0,r.jsxs)(er.View,{css:rm.info,"data-open":m,children:[k?(0,r.jsx)(eS,{title:"".concat(t.length," ").concat((0,ne.default)("build",t.length)," failed"),debugSummary:w,onViewBuildLogs:function(){return c(b.build)},openFile:f,provider:s,openPane:p}):null,(0,r.jsxs)("button",{onClick:function(){return x(!m)},css:rm.button,children:[(0,r.jsxs)(er.View,{css:rm.buttonContent,children:[(0,r.jsx)(eb.default,{}),(0,r.jsx)(et.Text,{children:"View all failed builds"}),m?null:(0,r.jsxs)(et.Text,{css:W.rcss.color.foregroundDimmest,variant:"small",children:[t.length>1?"Most recent: ":null,(0,eI.formatDistance)(new Date(t[0].timeCreated),Date.now(),{addSuffix:!0})]})]}),m?(0,r.jsx)(rr.default,{color:z.tokens.foregroundDimmer}):(0,r.jsx)(rn.default,{color:z.tokens.foregroundDimmer})]})]})]}),m?(0,r.jsx)(er.View,{css:rm.failedBuildList,children:t.map(function(e){return(0,r.jsx)(rw,{item:e,onClick:function(){return c(e.build)},type:"future"},e.id)})}):null]})}function rx(e){var t=e.items,o=e.view,l=e.provider,u=e.onClick,c=e.openFile,d=e.openPane,f=(0,n._)((0,i.useState)(!1),2),p=f[0],g=f[1],m=(0,s.useDeploymentDeployability)().hasDebugSummariesAuthorization,x=(0,s.useDeploymentInProgressBuild)(),y=(0,i.useRef)(void 0);(0,i.useEffect)(function(){(null==x?void 0:x.status)!==void 0&&(y.current=null==x?void 0:x.status)},[x,null==x?void 0:x.status]);var b=!x&&y.current!==a.HostingBuildStatus.Building&&y.current!==a.HostingBuildStatus.Success,w=b?z.tokens.accentNegativeStronger:z.tokens.foregroundDimmer;if(0===t.length)return null;var k=t[0];return m&&k.build.debugSummary?(0,r.jsx)(rv,{items:t,upcomingBuildStatus:y.current,view:o,provider:l,onClick:u,openFile:c,openPane:d}):(0,r.jsxs)(er.View,{children:[(0,r.jsxs)(er.View,{css:rm.top,children:[(0,r.jsx)(h.TimelinePoint,{type:p?"futureFailOpen":"futureFailClosed"}),(0,r.jsx)(er.View,{css:rm.info,"data-open":p,children:(0,r.jsxs)("button",{onClick:function(){return g(!p)},css:rm.button,"data-highlight":b,children:[(0,r.jsxs)(er.View,{css:rm.buttonContent,children:[b?(0,r.jsx)(eu.default,{color:z.tokens.accentNegativeStronger}):null,(0,r.jsxs)(et.Text,{children:[t.length," ",(0,ne.default)("build",t.length)," failed"]}),p?null:(0,r.jsxs)(et.Text,{children:[t.length>1?"Most recent: ":null,(0,eI.formatDistance)(new Date(t[0].timeCreated),Date.now(),{addSuffix:!0})]})]}),p?(0,r.jsx)(rr.default,{color:w}):(0,r.jsx)(rn.default,{color:w})]})})]}),p?(0,r.jsx)(er.View,{css:rm.failedBuildList,children:t.map(function(e){return(0,r.jsx)(rw,{item:e,onClick:function(){return u(e.build)},type:"future"},e.id)})}):null]})}function ry(e){var t,n=e.replId,o=e.type,c=void 0===o?"default":o,d=e.view,f=e.provider,p=e.onSelect,h=e.openFile,g=e.openPane,x=e.onClickRollback,y=(0,nz.useHostingDeploymentActivityLogs2Query)({variables:{replId:n,count:20},fetchPolicy:"cache-and-network",ssr:!1}),w=y.data,k=y.previousData,_=y.loading,S=y.error,C=y.fetchMore,j=null!=w?w:k,T=(0,l.useDeploymentMode)(),E=(null==j?void 0:j.getRepl.__typename)==="Repl"?j.getRepl:null,R=(null==E||null==(t=E.hostingDeployment)?void 0:t.__typename)==="HostingDeployment"?E.hostingDeployment:null,I=(0,n5.useIsAgentStackRepl)().isAgentStackRepl,A=function(){return(0,m._)(function(){var e;return(0,b._)(this,function(t){switch(t.label){case 0:if(!(e=null==R?void 0:R.activityLogs.pageInfo.nextCursor))return[2];return[4,C({variables:{after:e,count:20}})];case 1:return t.sent(),[2]}})})()},P=(0,n8.default)({onLoadMore:A,rootMargin:"0px 0px 300px 0px"}).targetRef,D=(0,s.useDeploymentCurrentBuild)(),O=(0,s.useDeploymentInProgressBuild)(),N=(0,i.useRef)(void 0);if((0,i.useEffect)(function(){(null==O?void 0:O.id)!==void 0&&(N.current=null==O?void 0:O.id)},[null==O?void 0:O.id]),_&&!R)return"failureQueue"===c?null:(0,r.jsx)(r_,{});if(!(null==R?void 0:R.activityLogs))return null;var M=R.activityLogs,L=M.items,B=M.pageInfo;if(0===L.length)return null;if(S)return(0,r.jsx)(er.View,{css:rg.empty,pb:8,children:(0,r.jsx)(np.StatusBanner,{colorway:"warning",icon:(0,r.jsx)(eu.default,{}),text:"Something went wrong"})});var V=function(e,t){var n=[],r=(null==t?void 0:t.timeCreated)?new Date(t.timeCreated):null,i=!0,o=!1,s=void 0;try{for(var l,u=e[Symbol.iterator]();!(i=(l=u.next()).done);i=!0){var c=l.value;if(c.type!==a.HostingActivityLogType.Fail||r&&r.getTime()>new Date(c.build.timeCreated).getTime())break;n.push(c)}}catch(e){o=!0,s=e}finally{try{i||null==u.return||u.return()}finally{if(o)throw s}}return n}(L,D);return"failureQueue"===c?(0,r.jsx)(nW.TimelineTransition,{render:V.length>0,initialHeight:44,children:(0,r.jsx)(rx,{items:V,view:d,provider:f,onClick:p,openFile:h,openPane:g})}):(0,r.jsxs)(er.View,{gap:8,"data-history-timeline-items":L.length-V.length,children:[(0,r.jsx)(er.View,{css:rg.items,children:L.map(function(e,t){if(e.build.id===(null==D?void 0:D.id)||t<V.length)return null;var n=!1;return e.isRollbackCandidate&&e.build.status===a.HostingBuildStatus.Success&&!e.build.rollbackSourceBuildId&&x&&T===u.DeploymentMode.Ready&&!I&&(n=!0),(0,r.jsx)(rw,{item:e,onClick:function(){return p(e.build)},onClickRollback:n&&x?function(){return x(e.build)}:void 0},e.id)})}),B.nextCursor?(0,r.jsx)(er.View,{css:rg.loadMore,children:(0,r.jsx)(Z.IconButton,{disabled:_,tooltipBehavior:"hidden",alt:"Show more",onClick:A,ref:P,children:_?(0,r.jsx)(el.default,{}):(0,r.jsx)(rt.default,{})})}):null]})}var rb=function(e){var t=e.onClickRollback,n=e.rollbackTooltip;if((0,n4.useIsMobile)()&&!t)return(0,r.jsx)(r.Fragment,{});var i=void 0===t;return(0,r.jsx)(Z.IconButton,{alt:n,onClick:function(){return t?t():void 0},disabled:i,css:i&&rg.disabledLog,children:(0,r.jsx)(n9.RotateCcw,{})})};function rw(e){var t=e.item,n=e.onClick,i=e.onClickRollback,o=e.timeline,s=e.type,c=t.build.hasDeployLogs,d=!c,f=(0,n4.useIsMobile)(),p=(0,l.useDeploymentMode)(),g="Rollback";i||(g="Cannot roll back, the image for this build is no longer available"),(0,n5.useIsAgentStackRepl)().isAgentStackRepl?g="Rollback is not supported for Agents and Automations":p!==u.DeploymentMode.Ready?g="Cannot roll back while a deployment is in progress":t.build.status!==a.HostingBuildStatus.Success?g="Cannot roll back to a failed build":t.build.rollbackSourceBuildId&&(g="Cannot roll back, already rolled back to this deployment");var m=(0,r.jsxs)(er.View,{css:rg.item,grow:!0,shrink:!0,pl:8,pr:4,pb:12,align:"center",row:!0,gap:8,style:f?{alignItems:"start"}:{},children:[(0,r.jsx)(er.View,{css:rg.itemMainText,grow:!0,shrink:!0,children:(0,r.jsx)(nQ.ActivityLogText,{activityLogItem:t})}),(0,r.jsx)(er.View,{css:rg.itemLine,className:"itemLine"}),(0,r.jsxs)(er.View,{css:rg.itemRight,row:!0,gap:0,justify:"end",style:f?{display:"flex"}:{},className:"itemRight",children:[(0,r.jsx)(nY,{activityLogItem:t}),(0,r.jsx)(rb,{onClickRollback:i,rollbackTooltip:g}),(0,r.jsx)(Z.IconButton,{alt:c?"View deploy logs":"Deploy logs expire after 30 days",onClick:n,disabled:d,css:d&&rg.disabledLog,children:(0,r.jsx)(K.default,{})})]})]});return void 0===o||o?(0,r.jsxs)(er.View,{css:"past"===(void 0===s?"past":s)?rg.itemPast:rg.itemFuture,children:[(0,r.jsx)(h.TimelinePoint,{type:t.type===a.HostingActivityLogType.Fail?"pastFail":"pastSuccess"}),m]}):m}var rk=(0,H.cssRecord)({loading:[{":last-of-type":{"[data-timeline-line]":{display:"none"}}}],loadingItem:[tE.loadingStyle.backgroundPulse(),W.rcss.height(20.4),W.rcss.mt(2),W.rcss.ml(4),W.rcss.flex.growAndShrink(1),W.rcss.borderRadius(6),{opacity:.5,marginBottom:14}]});function r_(){return(0,r.jsx)(er.View,{children:[,,,].fill(0).map(function(e,t){return(0,r.jsxs)(er.View,{css:rk.loading,row:!0,gap:12,children:[(0,r.jsx)(h.TimelinePoint,{type:"pastNeutral"}),(0,r.jsx)(ee.Surface,{elevated:!0,css:rk.loadingItem})]},t)})})}var rS=e.i(823166),rC=e.i(635528),rj=e.i(441329);e.i(653863);var rT=e.i(973519),rE=e.i(806804),rR=e.i(399528),rI=e.i(908410),rA=e.i(134628),rP=e.i(479407),rD=e.i(293265),rO=(0,H.cssRecord)({deploymentInfoWrapper:[{':has( + [data-history-timeline-items="0"])':{"[data-timeline-line]":{display:"none"}}}]}),rN=function(e){var t,m,x,y=e.view,b=e.onLifecycleCommand,w=e.onViewAction,k=e.onError,_=e.openFile,S=e.openPane,C=e.hasAgentSession,j=(0,l.useDeploymentMode)(),T=(0,s.useDeploymentId)(),E=(0,s.useDeploymentCurrentBuild)(),R=(0,s.useDeploymentInProgressBuild)(),I=(0,s.useFsService)(),A=(0,s.useSecretsService)(),P=(0,rj.useIsInBonsaiWebview)(),D=(0,s.useDeployBuild)().rollbackToPreviousBuild,O=(t=(0,rR.useRouter)(),m=(0,rj.doesBonsaiWebviewSupportFeature)(t,"storeReviewPrompt")&&(0,rj.isInBonsaiWebview)(t),x=(0,i.useCallback)(function(e){var t=e.source;m&&(0,rP.sendMessage)({messageType:rA.BridgeMessageType.REQUEST_STORE_REVIEW_PROMPT,source:t},(0,rI.nanoid)())},[m]),(0,i.useMemo)(function(){return{isSupported:m,requestPrompt:x}},[m,x])),N=(0,rT.useGlobalModal)().show,M=void 0!==E,L=(0,F.default)(),B=null==E?void 0:E.provider,V=M&&E.machineConfiguration?{configurationId:E.machineConfiguration.id,configurationLabel:E.machineConfiguration.label,configurationSlug:E.machineConfiguration.slug,maxInstances:null==E?void 0:E.maxMachineInstances}:void 0,U=(0,rE.default)("deployments-pane","deployments-mobile-download"),G=U.shouldDisplay,$=U.dismiss,z=U.register;(0,i.useEffect)(function(){z()},[z]),(0,i.useEffect)(function(){M&&j===u.DeploymentMode.Deploying&&O.requestPrompt({source:"deployProgress"})},[O,M,j]);var H=(null==E?void 0:E.status)&&E.status===a.HostingBuildStatus.Success&&G&&!P,W=(0,n._)((0,i.useState)(!1),2),q=W[0],K=W[1],Y=(0,n._)((0,i.useState)(null),2),Q=Y[0],X=Y[1],J=(0,n._)((0,i.useState)(null),2),Z=J[0],ee=J[1],et=(0,n._)((0,i.useState)(null),2),en=et[0],ei=et[1];(0,i.useEffect)(function(){(0,c.trackDeploymentSectionViewed)({context:d.Views.Deployment})},[]),(0,i.useEffect)(function(){(j===u.DeploymentMode.Preparing||j===u.DeploymentMode.PreparingDatabase||j===u.DeploymentMode.Deploying)&&(y===d.Views.DeploymentInProgress||Z||w({type:d.ViewActionType.ChangeView,payload:{view:d.Views.DeploymentInProgress}}))},[j,y,w,Z]);var eo=(0,i.useRef)(void 0);(0,i.useEffect)(function(){eo.current=null==R?void 0:R.id},[null==R?void 0:R.id]);var ea=(null==E?void 0:E.status)===a.HostingBuildStatus.Success,es=(null==E?void 0:E.id)===eo.current,el=(0,n5.useIsAgentStackRepl)().isAgentStackRepl,eu=(0,rD.useAgentStackPlatformType)().agentStackPlatformType;(0,i.useEffect)(function(){ea&&es&&(w({type:d.ViewActionType.ChangeView,payload:{view:d.Views.Deployment}}),el&&eu===o.AgentStackPlatformType.Slack?N("SlackAgentStackPostDeployModal",{replId:L}):el&&eu===o.AgentStackPlatformType.TimeBased?N("TimeBasedAgentStackPostDeployModal"):el&&eu===o.AgentStackPlatformType.Telegram&&N("TelegramAgentStackPostDeployModal",{replId:L}))},[eu,ea,el,es,w,L,N]);var ec=null==R?void 0:R.status,ed=(0,i.useRef)(ec);(0,i.useEffect)(function(){ec&&(ed.current=ec)},[ec]);var ef=(0,s.useDotReplitService)(),ep=(0,s.usePortsService)();if(Z)return(0,r.jsx)(rp,{build:Z,fs:I,openFile:_,openPane:S,onBack:function(){ee(null)},onViewAppLogs:function(){w({type:d.ViewActionType.ChangeView,payload:{view:d.Views.Logs}})}});if(Q)return(0,r.jsx)(rf,{build:Q,onBack:function(){X(null)},onClickRollback:function(e){D({rollbackCandidateBuildId:Q.id,envVars:e})},onError:function(e){X(null),k(e)}});if(en===a.HostingBuildProvider.CloudRun)return(0,r.jsx)(g.AutoscaleMachineConfiguration,{type:a.HostingBuildProvider.CloudRun,onError:k,onConfirm:function(e){w({type:d.ViewActionType.SendDeploymentLifecycleCommand,payload:{command:a.SendDeploymentLifecycleCommandType.UpdateMachineConfiguration,machineConfigurationId:e.configurationId,maxMachineInstances:e.maxInstances}})},onBack:function(){return ei(null)}});if(en===a.HostingBuildProvider.Gce)return(0,r.jsx)(rS.ReservedVMMachineConfiguration,{type:a.HostingBuildProvider.Gce,initialMachineConfiguration:V,onConfirm:function(e){w({type:d.ViewActionType.SendDeploymentLifecycleCommand,payload:{command:a.SendDeploymentLifecycleCommandType.UpdateMachineConfiguration,machineConfigurationId:e.configurationId,maxMachineInstances:e.maxInstances}})},onBack:function(){return ei(null)},onError:k,provider:null!=B?B:a.HostingBuildProvider.Gce});var eh=!M||!T||j!==u.DeploymentMode.Ready&&j!==u.DeploymentMode.Suspended&&j!==u.DeploymentMode.ProcessingLifecycleCommand;return(0,r.jsx)(r.Fragment,{children:(0,r.jsx)(p.PaneSection,{children:(0,r.jsxs)(er.View,{children:[(0,r.jsxs)(er.View,{row:!0,gap:12,children:[M?(0,r.jsx)(h.TimelinePoint,{type:"future"}):null,(0,r.jsxs)(er.View,{grow:!0,shrink:!0,gap:12,pb:12,children:[eh?null:(0,r.jsx)(f.ConfigRedeploy,{dotReplit:ef,fs:I,secrets:A,ports:ep,deploymentId:T,replId:L,onError:k,expanded:q,setExpanded:K,shouldShowMobileTour:null!=H&&H,onDismissMobileTour:$,openNetworkingPane:function(){w({type:d.ViewActionType.OpenPane,payload:{type:"developer",data:{tab:["networking"]}}})},onResume:function(){b({command:a.SendDeploymentLifecycleCommandType.Resume})},hasAgentSession:C,onViewAction:w}),y===d.Views.DeploymentInProgress?(0,r.jsx)(nF,{openFile:_,openPane:S,viewBuildLogsOnLoad:!M,onViewLogs:function(){w({type:d.ViewActionType.ChangeView,payload:{view:d.Views.Logs}})},onCanceled:function(){w({type:d.ViewActionType.ChangeView,payload:{view:d.Views.Deployment}}),k("Build cancelled")},onError:k}):null]})]}),M&&B?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(ro,{type:"failureQueue",onViewBuildLogs:ee,openFile:_,openPane:S,view:y,provider:B}),(0,r.jsxs)(er.View,{css:rO.deploymentInfoWrapper,row:!0,gap:12,children:[(0,r.jsx)(h.TimelinePoint,{type:"present"}),(0,r.jsx)(er.View,{grow:!0,shrink:!0,gap:12,pb:16,children:(0,r.jsx)(rC.DeploymentInfo,{provider:B,machine:V,onViewBuildLogs:ee,onManageClick:function(){B===a.HostingBuildProvider.CloudRun||B===a.HostingBuildProvider.Gce?ei(B):B===a.HostingBuildProvider.Static&&w({type:d.ViewActionType.ChangeView,payload:{view:d.Views.Settings}})},onViewAction:w})})]}),(0,r.jsx)(ro,{onViewBuildLogs:ee,openFile:_,openPane:S,view:y,provider:B,onClickRollback:function(e){X(e)}})]}):null]})})})};function rM(){var e=(0,C._)(["\n  query LinkablePurchasedDomains {\n    currentUser {\n      id\n      domains(managed: true, onlyUnlinked: true) {\n        items {\n          id\n          domain\n        }\n      }\n    }\n  }\n"]);return rM=function(){return e},e}function rL(){var e=(0,C._)(["\n  mutation LinkPurchasedDomain(\n    $replId: String!\n    $domainName: String!\n    $deploymentId: String!\n  ) {\n    linkReplDomain2(\n      replId: $replId\n      deploymentId: $deploymentId\n      domain: $domainName\n    ) {\n      __typename\n      ... on Repl {\n        id\n      }\n    }\n  }\n"]);return rL=function(){return e},e}e.s(["Deployment",()=>rN],684340);var rB={},rV=(0,eA.gql)(rM());function rF(e){var t=(0,x._)({},rB,e);return eP.useQuery(rV,t)}var rU=(0,eA.gql)(rL());function rG(e){var t=(0,x._)({},rB,e);return eN.useMutation(rU,t)}function r$(){var e=(0,C._)(["\n  mutation BuyDomain($input: BuyDomainInput!) {\n    buyDomain(input: $input) {\n      ... on BuyDomainOutput {\n        scheduled\n      }\n      ... on UserError {\n        message\n      }\n      ... on UnauthorizedError {\n        message\n      }\n    }\n  }\n"]);return r$=function(){return e},e}function rz(){var e=(0,C._)(["\n  query GetPaymentMethod {\n    currentUser {\n      id\n      paymentMethod {\n        ... on Error {\n          message\n        }\n        ... on PaymentMethod {\n          id\n          last4\n        }\n      }\n    }\n  }\n"]);return rz=function(){return e},e}e.s(["LinkablePurchasedDomainsDocument",()=>rV,"useLinkPurchasedDomainMutation",()=>rG,"useLinkablePurchasedDomainsQuery",()=>rF],413655);var rH={},rW=(0,eA.gql)(r$());function rq(e){var t=(0,x._)({},rH,e);return eN.useMutation(rW,t)}var rK=(0,eA.gql)(rz());function rY(e){var t=(0,x._)({},rH,e);return eP.useQuery(rK,t)}function rQ(e){return null==e?"N/A":"$".concat(e.toFixed(2))}function rX(e,t){switch(t.type){case"select_domain":return{step:"confirm",selectedDomain:t.payload,purchaseErrorMessage:null};case"purchase_failed":if(null==e.selectedDomain)throw Error("Selected domain is null");return{step:"confirm",selectedDomain:e.selectedDomain,purchaseErrorMessage:t.payload};case"search":return{step:"search",selectedDomain:null};case"processing":if(null==e.selectedDomain)throw Error("Selected domain is null");return{step:"processing",selectedDomain:e.selectedDomain}}return e}function rJ(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{step:"search",selectedDomain:null},t=(0,n._)((0,i.useReducer)(rX,e),2);return{state:t[0],dispatch:t[1]}}e.s(["useBuyDomainMutation",()=>rq,"useGetPaymentMethodQuery",()=>rY],340766),e.s(["formatPrice",()=>rQ,"useDomainState",()=>rJ],828454)},224119,e=>{e.v({screenReaderOnly:"StaticTable-module__XQhYrW__screenReaderOnly",table:"StaticTable-module__XQhYrW__table",tableCell:"StaticTable-module__XQhYrW__tableCell",tableHeader:"StaticTable-module__XQhYrW__tableHeader",tableRow:"StaticTable-module__XQhYrW__tableRow",tableWrapper:"StaticTable-module__XQhYrW__tableWrapper",tableWrapperBorderless:"StaticTable-module__XQhYrW__tableWrapperBorderless"})},448451,e=>{e.v({buttonsContainer:"ConnectDomain-module__5q3fXq__buttonsContainer",listBoxHeader:"ConnectDomain-module__5q3fXq__listBoxHeader"})},312984,e=>{e.v({dnsTable:"DnsChecker-module__wH6YzW__dnsTable",statusBanner:"DnsChecker-module__wH6YzW__statusBanner",statusText:"DnsChecker-module__wH6YzW__statusText",strikeThrough:"DnsChecker-module__wH6YzW__strikeThrough"})},604425,e=>{e.v({pill:"DomainLinkingProgressBanner-module__WfXoEW__pill"})},869212,e=>{e.v({domainStatusDot:"DomainVerificationStatus-module__bjcnYG__domainStatusDot",statusDotWrapper:"DomainVerificationStatus-module__bjcnYG__statusDotWrapper",statusText:"DomainVerificationStatus-module__bjcnYG__statusText"})},674478,e=>{e.v({accordionCard:"DomainManagement-module__vE8JyW__accordionCard",accordionFooter:"DomainManagement-module__vE8JyW__accordionFooter",addRow:"DomainManagement-module__vE8JyW__addRow",addRowHasMx:"DomainManagement-module__vE8JyW__addRowHasMx",dnsRecordsAccordionHeader:"DomainManagement-module__vE8JyW__dnsRecordsAccordionHeader",dnsRecordsStaticHeader:"DomainManagement-module__vE8JyW__dnsRecordsStaticHeader",key:"DomainManagement-module__vE8JyW__key",sectionRow:"DomainManagement-module__vE8JyW__sectionRow"})},124489,e=>{e.v({hideOnTablet:"DomainRow-module__tHjzwq__hideOnTablet"})},609141,e=>{e.v({buyWrapper:"index-module__wyk3-W__buyWrapper",scrollContainer:"index-module__wyk3-W__scrollContainer"})},855312,(e,t,n)=>{"use strict";var r=/["'&<>]/;t.exports=function(e){var t,n=""+e,i=r.exec(n);if(!i)return n;var o="",a=0,s=0;for(a=i.index;a<n.length;a++){switch(n.charCodeAt(a)){case 34:t="&quot;";break;case 38:t="&amp;";break;case 39:t="&#39;";break;case 60:t="&lt;";break;case 62:t="&gt;";break;default:continue}s!==a&&(o+=n.substring(s,a)),s=a+1,o+=t}return s!==a?o+n.substring(s,a):o}},322945,e=>{e.v({clickable:"StripeConnectionSection-module__8shaba__clickable",container:"StripeConnectionSection-module__8shaba__container",contentBorder:"StripeConnectionSection-module__8shaba__contentBorder",hiddenContent:"StripeConnectionSection-module__8shaba__hiddenContent",sectionDivider:"StripeConnectionSection-module__8shaba__sectionDivider"})},652742,e=>{e.v({clickable:"AdvancedSettings-module__Uy3UFW__clickable",container:"AdvancedSettings-module__Uy3UFW__container",contentBorder:"AdvancedSettings-module__Uy3UFW__contentBorder",hiddenContent:"AdvancedSettings-module__Uy3UFW__hiddenContent",sectionDivider:"AdvancedSettings-module__Uy3UFW__sectionDivider",statusBanner:"AdvancedSettings-module__Uy3UFW__statusBanner"})},694772,e=>{e.v({clickable:"SimpleIntro-module__pzm8kq__clickable",container:"SimpleIntro-module__pzm8kq__container",payment:"SimpleIntro-module__pzm8kq__payment",roundedSurface:"SimpleIntro-module__pzm8kq__roundedSurface",urlContainer:"SimpleIntro-module__pzm8kq__urlContainer"})},918560,985845,969084,104571,150281,251299,12732,e=>{"use strict";var t,n,r,i,o,a,s,l,u,c,d,f,p,h,g,m,x=e.i(530658),y=e.i(276385),b=e.i(389959),w=e.i(358637),k=e.i(368964),_=e.i(107129),S=e.i(241703),C=e.i(32995),j=e.i(686631),T=e.i(346715),E=e.i(199674),R=e.i(636567),I=e.i(413655),A=e.i(379334),P=e.i(399344),D=e.i(297083),O=e.i(817556),N=e.i(340766),M=e.i(569910),L=e.i(412160),B=e.i(828454),V=e.i(406802),F=e.i(480028),U=e.i(446530),G=e.i(613355),$=e.i(140487),z=e.i(136540),H=e.i(624782),W=e.i(11235),q=e.i(929872),K=e.i(960178),Y=e.i(751273),Q=e.i(625484),X=e.i(352767),J=e.i(940745),Z=e.i(42458),ee=(0,U.cssRecord)({scrollArea:[{overflowY:"auto",minHeight:0,maxHeight:"100%"}],primaryActionButton:[G.rcss.width("100%"),G.rcss.py(12),{fontSize:F.tokens.fontSizeDefault}],confirmDetails:[G.rcss.borderRadius(4)],detailRow:[G.rcss.rowWithGap(8),G.rcss.justify.spaceBetween],errorMessage:[G.rcss.borderRadius(4),G.rcss.backgroundColor.accentNegativeDimmest],root:[G.rcss.overflow("hidden")],relativeContainer:[{position:"relative",minHeight:0,maxHeight:"100%"}]});function et(e){var t,n,r,i=e.isBillingInfoLoading,o=e.selectedDomain,a=e.purchaseErrorMessage,s=e.handleBuyDomain,l=e.isPurchasing,u=e.lastFour,c=e.onGoBack,d=(n=(t=(0,x._)((0,b.useState)(!1),2))[0],r=t[1],(0,V.useTimeout)(function(){r(!0)},1e3),n);return i?(0,y.jsxs)(Q.View,{align:"center",p:8,children:[(0,y.jsx)(J.default,{size:16}),(0,y.jsx)(K.Text,{children:"Loading your billing information..."})]}):u?(0,y.jsxs)(Q.View,{p:8,gap:16,css:ee.root,shrink:!0,children:[(0,y.jsxs)(Q.View,{row:!0,gap:8,align:"center",children:[(0,y.jsx)(z.IconButton,{alt:"Go back",onClick:c,children:(0,y.jsx)(X.default,{})}),(0,y.jsx)(K.Header,{level:2,children:"Confirm Domain Purchase"}),(0,y.jsx)(H.Pill,{colorway:"primary",text:"Beta"})]}),(0,y.jsx)(Q.View,{css:ee.relativeContainer,shrink:!0,children:(0,y.jsxs)(Q.View,{gap:16,css:ee.scrollArea,shrink:!0,children:[(0,y.jsxs)(q.Surface,{elevated:!0,gap:8,css:ee.confirmDetails,p:12,children:[(0,y.jsxs)(Q.View,{css:ee.detailRow,children:[(0,y.jsx)(K.Text,{color:"dimmer",children:"Domain:"}),(0,y.jsx)(K.Text,{children:o.domainName})]}),(0,y.jsxs)(Q.View,{css:ee.detailRow,children:[(0,y.jsx)(K.Text,{color:"dimmer",children:"Price:"}),o.years>1?(0,y.jsx)(Y.Tooltip,{tooltip:"Some domains such as .ai must be purchased and renewed in multi-year increments. You will be charged for ".concat(o.years," years up front."),children:(0,y.jsxs)("span",{children:[(0,B.formatPrice)(o.purchasePrice)," for"," ",o.years," years"]})}):(0,y.jsx)(K.Text,{children:(0,B.formatPrice)(o.purchasePrice)})]}),o.renewalPrice?(0,y.jsx)(Y.Tooltip,{tooltip:o.years>1?"Some domains such as .ai must be purchased and renewed in multi-year increments. Your domain will renew every ".concat(o.years," years for the displayed price."):"You can always cancel the renewal later",children:(0,y.jsxs)(Q.View,{css:ee.detailRow,children:[(0,y.jsx)(K.Text,{color:"dimmer",children:o.years>1?"Renewal:":"Annual renewal:"}),(0,y.jsxs)(K.Text,{children:[(0,B.formatPrice)(o.renewalPrice)," ",o.years>1?"every ".concat(o.years," years"):"/year"]})]})}):null,(0,y.jsxs)(Q.View,{css:ee.detailRow,children:[(0,y.jsx)(K.Text,{color:"dimmer",children:"Payment method:"}),(0,y.jsxs)(K.Text,{children:["Your card ending in"," ",(0,y.jsx)(K.Text,{variant:"code",children:u.toString()})]})]})]}),a?(0,y.jsxs)(Q.View,{css:ee.errorMessage,gap:4,p:12,children:[(0,y.jsxs)(Q.View,{row:!0,gap:8,align:"center",children:[(0,y.jsx)(Z.default,{size:16,color:F.tokens.accentNegativeDefault}),(0,y.jsx)(K.Text,{color:"dimmer",children:"Purchase failed"})]}),(0,y.jsx)(K.Text,{color:"dimmer",children:a})]}):null,(0,y.jsx)(Q.View,{justify:"center",children:(0,y.jsx)($.Button,{variant:"default",colorway:"positive",onClick:s,loading:l,text:"Confirm Purchase",disabled:!d,css:ee.primaryActionButton})}),(0,y.jsxs)(W.Prose,{color:"dimmer",variant:"small",children:["Domain purchases are non-refundable. You will be charged immediately for the registration price of"," ",(0,B.formatPrice)(o.purchasePrice)," and every"," ",1===o.years?" year":" ".concat(o.years," years")," ","for the renewal price of ",(0,B.formatPrice)(o.renewalPrice),". Your domain will be available to use immediately. Domain Purchasing on Replit is currently in Beta, and some features may be unavailable. For more information, see our"," ",(0,y.jsx)(L.default,{href:"https://docs.replit.com/cloud-services/deployments/domain-purchasing",target:"_blank",children:"Documentation"}),". For additional help, contact Replit Support."]})]})})]}):(0,y.jsxs)(Q.View,{p:8,children:[(0,y.jsx)(K.Text,{children:"No payment method found"}),(0,y.jsx)(K.Text,{children:"Please add a payment method to your account and return to this screen."})]})}function en(){return(0,y.jsx)(Q.View,{gap:16,pt:16,children:(0,y.jsxs)(Q.View,{align:"center",gap:16,children:[(0,y.jsx)(J.default,{size:32}),(0,y.jsx)(K.Text,{variant:"subheadDefault",children:(0,y.jsx)("strong",{children:"Processing your domain purchase"})})]})})}var er=e.i(878420),ei=e.i(569384),eo=e.i(973245),ea=e.i(304277);function es(){var e=(0,ei._)(["\n  query SearchForDomain($input: SearchDomainsInput!) {\n    searchDomains(input: $input) {\n      ... on DomainSearchOutput {\n        results {\n          domainName\n          sld\n          tld\n          purchasable\n          premium\n          purchasePrice\n          purchaseType\n          renewalPrice\n          years\n        }\n      }\n    }\n  }\n"]);return es=function(){return e},e}e.i(566901);var el={},eu=(0,eo.gql)(es()),ec=e.i(162914),ed=e.i(858248),ef=e.i(709485),ep=e.i(85742),eh=e.i(698043),eg=e.i(498540),em=e.i(616278),ev=e.i(431601),ex=(0,U.cssRecord)({scrollArea:[{display:"flex",flexDirection:"column",overflowY:"auto",minHeight:0,paddingBottom:8,flexShrink:1}],domainResult:[G.rcss.borderRadius(8),G.rcss.border({color:F.tokens.outlineDimmer}),G.rcss.hover([G.rcss.border({color:F.tokens.outlineDefault}),G.rcss.backgroundColor.accentPrimaryDimmest]),G.rcss.mb(8)],noResults:[G.rcss.borderRadius(8),G.rcss.border({color:F.tokens.outlineDimmer}),G.rcss.mb(8)],root:[G.rcss.overflow("hidden")]});function ey(e){var t,n,r,i,o,a,s,l,u,c,d,f=e.suggestedDomain,p=e.onDomainSelect,h=e.onGoBack,g=(n=(t=(0,x._)((0,b.useState)(f||""),2))[0],r=t[1],l=(o={variables:{input:{keyword:i=(0,ec.default)(n,500)}}},a=(0,er._)({},el,o),s=ea.useQuery(eu,a)).data,u=s.loading,c=s.error,d=(null==l?void 0:l.searchDomains)&&"DomainSearchOutput"===l.searchDomains.__typename?l.searchDomains.results.filter(Boolean):[],(0,b.useEffect)(function(){i&&i.length>0&&(0,ed.track)(ef.events.DOMAIN_PURCHASE,{action:"search_performed",searchTerm:i,resultsCount:d.length})},[i,d.length]),{searchTerm:n,setSearchTerm:r,searchResults:d,debouncedSearchTerm:i,loading:u||n!==i,error:c}),m=g.searchTerm,w=g.setSearchTerm,k=g.searchResults,_=g.loading,S=g.error,C=g.debouncedSearchTerm;return(0,y.jsxs)(Q.View,{css:ex.root,gap:8,grow:!0,shrink:!0,px:8,pt:8,children:[(0,y.jsxs)(Q.View,{row:!0,gap:8,align:"center",children:[(0,y.jsx)(z.IconButton,{onClick:h,alt:"Back to domains",children:(0,y.jsx)(X.default,{})}),(0,y.jsx)(K.Header,{level:2,variant:"subheadDefault",children:"Buy a new domain"}),(0,y.jsx)(H.Pill,{colorway:"primary",text:"Beta"})]}),(0,y.jsx)(Q.View,{tag:"label",row:!0,gap:8,align:"center",children:(0,y.jsx)(K.Text,{color:"dimmer",children:"Search for a domain to buy"})}),(0,y.jsxs)(eh.SearchableListBox,{children:[(0,y.jsx)(eg.SearchField,{autoFocus:!0,placeholder:"Search for a domain...",value:m,onChange:function(e){return w(e)}}),(0,y.jsx)(ep.ListBox,{css:ex.scrollArea,onAction:function(e){var t=k.find(function(t){return t.domainName===e});t&&p(t)},items:k,isLoading:_,renderEmptyState:function(){return(0,y.jsxs)(Q.View,{gap:8,align:"stretch",children:[(0,y.jsx)(Q.View,{css:ex.noResults,align:"center",justify:"center",p:16,children:(0,y.jsx)(K.Text,{color:"dimmer",children:C?'No domains found matching "'.concat(C,'"'):"Enter a domain name to search"})}),S?(0,y.jsxs)(Q.View,{row:!0,gap:4,align:"center",justify:"center",children:[(0,y.jsx)(Z.default,{size:12,color:F.tokens.orangeDefault}),(0,y.jsx)(K.Text,{variant:"small",color:"dimmer",children:S.message})]}):null]})},children:function(e){return(0,y.jsxs)(ep.BaseListBoxItem,{textValue:"".concat(e.domainName," - ").concat(e.purchasable?"available":"unavailable"," ").concat(e.years>1?"".concat((0,B.formatPrice)(e.purchasePrice)," for ").concat(e.years," years"):(0,B.formatPrice)(e.purchasePrice)),id:e.domainName,css:ex.domainResult,children:[(0,y.jsxs)(Q.View,{gap:4,grow:!0,children:[(0,y.jsxs)(Q.View,{row:!0,gap:4,align:"center",children:[(0,y.jsx)(K.Text,{children:e.domainName}),e.purchasable?(0,y.jsx)(Q.View,{row:!0,gap:2,align:"center",children:(0,y.jsx)(em.default,{size:12,color:F.tokens.accentPositiveDefault})}):null,e.premium?(0,y.jsx)(ev.default,{size:12,color:F.tokens.accentPrimaryDefault}):null]}),null!=e.renewalPrice&&(0,y.jsx)(K.Text,{variant:"small",color:"dimmer",children:e.years>1?(0,y.jsx)(Y.Tooltip,{tooltip:"Some domains such as .ai must be purchased and renewed in multi-year increments. Your domain will renew every ".concat(e.years," years for the displayed price."),children:(0,y.jsxs)("span",{children:["Renews at ",(0,B.formatPrice)(e.renewalPrice)," every"," ",e.years," years"]})}):(0,y.jsxs)(y.Fragment,{children:["Renews at ",(0,B.formatPrice)(e.renewalPrice),"/yr"]})})]}),(0,y.jsx)(K.Text,{children:e.years>1?(0,y.jsx)(Y.Tooltip,{tooltip:"Some domains such as .ai must be purchased and renewed in multi-year increments. You will be charged for ".concat(e.years," years up front."),children:(0,y.jsxs)("span",{children:[(0,B.formatPrice)(e.purchasePrice)," for ",e.years," ","years"]})}):(0,B.formatPrice)(e.purchasePrice)})]},e.domainName)}})]}),(0,y.jsx)(Q.View,{})]})}var eb=e.i(993796);function ew(e){var t,n,r=(0,N.useGetPaymentMethodQuery)(),i=r.data,o=r.loading,a=(0,B.useDomainState)(),s=a.state,l=a.dispatch,u=(0,eb.useFlag)({controlName:"flag-domains-glowup",default:!1}),c=(0,x._)((0,N.useBuyDomainMutation)({refetchQueries:[{query:R.HostingDeploymentDomainsDocument,variables:{id:e.deploymentId,isGlowup:u}}],awaitRefetchQueries:!0,onCompleted:function(){e.onRequestClose()}}),2),d=c[0],f=c[1].loading;switch(s.step){case"search":return(0,y.jsx)(ey,{suggestedDomain:e.suggestedDomain,onDomainSelect:function(e){(0,ed.track)(ef.events.DOMAIN_PURCHASE,{action:"selected",domainName:e.domainName,tld:e.tld,sld:e.sld,purchasePrice:e.purchasePrice,renewalPrice:e.renewalPrice,years:e.years,premium:e.premium}),l({type:"select_domain",payload:e})},onGoBack:e.onRequestClose});case"confirm":return(0,y.jsx)(et,{lastFour:(null==i||null==(n=i.currentUser)||null==(t=n.paymentMethod)?void 0:t.__typename)==="PaymentMethod"?i.currentUser.paymentMethod.last4:null,isBillingInfoLoading:o,onGoBack:function(){return l({type:"search"})},selectedDomain:s.selectedDomain,purchaseErrorMessage:s.purchaseErrorMessage,handleBuyDomain:function(){return(0,D._)(function(){var t,n;return(0,O._)(this,function(r){switch(r.label){case 0:if(null==s.selectedDomain)return[2];return(0,ed.track)(ef.events.DOMAIN_PURCHASE,{action:"confirmed",sld:s.selectedDomain.sld,tld:s.selectedDomain.tld,domainName:s.selectedDomain.domainName,purchasePrice:s.selectedDomain.purchasePrice,years:s.selectedDomain.years}),l({type:"processing"}),[4,d({variables:{input:{years:s.selectedDomain.years,domainName:s.selectedDomain.domainName,contact:{firstName:"",lastName:"",companyName:"",address1:"",address2:"",city:"",state:"",zip:"",country:"",phone:"",email:""},hostingDeploymentId:e.deploymentId,expectedChargeAmountCents:null!=s.selectedDomain.purchasePrice?Math.round(100*s.selectedDomain.purchasePrice):0}}})];case 1:return(null==(t=(n=r.sent()).data)?void 0:t.buyDomain)&&("BuyDomainOutput"===n.data.buyDomain.__typename&&n.data.buyDomain.scheduled?(0,ed.track)(ef.events.DOMAIN_PURCHASE,{action:"completed",deploymentId:e.deploymentId,domainName:s.selectedDomain.domainName,purchasePrice:s.selectedDomain.purchasePrice,years:s.selectedDomain.years}):"UserError"===n.data.buyDomain.__typename?((0,ed.track)(ef.events.DOMAIN_PURCHASE,{action:"failed",domainName:s.selectedDomain.domainName,sld:s.selectedDomain.sld,tld:s.selectedDomain.tld,error:n.data.buyDomain.message}),l({type:"purchase_failed",payload:n.data.buyDomain.message})):"UnauthorizedError"===n.data.buyDomain.__typename&&((0,ed.track)(ef.events.DOMAIN_PURCHASE,{action:"failed",domainName:s.selectedDomain.domainName,sld:s.selectedDomain.sld,tld:s.selectedDomain.tld,error:n.data.buyDomain.message}),l({type:"purchase_failed",payload:n.data.buyDomain.message}))),[2]}})})()},isPurchasing:f});case"processing":return(0,y.jsx)(en,{});default:(0,M.default)(s)}}var ek=e.i(721281),e_=e.i(713547),eS=e.i(64386),eC=function(e,t){for(var n=e.slice(),r=[],i=t;0!==n.length;){var o=n.pop(),a=o.toLowerCase();if(i.children.has("*")){if(i.children.has("!"+a))break;i=i.children.get("*")}else{if(!1===i.children.has(a))break;i=i.children.get(a)}r.unshift(o)}return r},ej="[a-fA-F\\d:]",eT=function(e){return e&&e.includeBoundaries?"(?:(?<=\\s|^)(?=".concat(ej,")|(?<=").concat(ej,")(?=\\s|$))"):""},eE="(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]\\d|\\d)(?:\\.(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]\\d|\\d)){3}",eR="[a-fA-F\\d]{1,4}",eI="\n(?:\n(?:".concat(eR,":){7}(?:").concat(eR,"|:)|                                    // 1:2:3:4:5:6:7::  1:2:3:4:5:6:7:8\n(?:").concat(eR,":){6}(?:").concat(eE,"|:").concat(eR,"|:)|                             // 1:2:3:4:5:6::    1:2:3:4:5:6::8   1:2:3:4:5:6::8  1:2:3:4:5:6::1.2.3.4\n(?:").concat(eR,":){5}(?::").concat(eE,"|(?::").concat(eR,"){1,2}|:)|                   // 1:2:3:4:5::      1:2:3:4:5::7:8   1:2:3:4:5::8    1:2:3:4:5::7:1.2.3.4\n(?:").concat(eR,":){4}(?:(?::").concat(eR,"){0,1}:").concat(eE,"|(?::").concat(eR,"){1,3}|:)| // 1:2:3:4::        1:2:3:4::6:7:8   1:2:3:4::8      1:2:3:4::6:7:1.2.3.4\n(?:").concat(eR,":){3}(?:(?::").concat(eR,"){0,2}:").concat(eE,"|(?::").concat(eR,"){1,4}|:)| // 1:2:3::          1:2:3::5:6:7:8   1:2:3::8        1:2:3::5:6:7:1.2.3.4\n(?:").concat(eR,":){2}(?:(?::").concat(eR,"){0,3}:").concat(eE,"|(?::").concat(eR,"){1,5}|:)| // 1:2::            1:2::4:5:6:7:8   1:2::8          1:2::4:5:6:7:1.2.3.4\n(?:").concat(eR,":){1}(?:(?::").concat(eR,"){0,4}:").concat(eE,"|(?::").concat(eR,"){1,6}|:)| // 1::              1::3:4:5:6:7:8   1::8            1::3:4:5:6:7:1.2.3.4\n(?::(?:(?::").concat(eR,"){0,5}:").concat(eE,"|(?::").concat(eR,"){1,7}|:))             // ::2:3:4:5:6:7:8  ::2:3:4:5:6:7:8  ::8             ::1.2.3.4\n)(?:%[0-9a-zA-Z]{1,})?                                             // %eth0            %1\n").replace(/\s*\/\/.*$/gm,"").replace(/\n/g,"").trim(),eA=new RegExp("(?:^".concat(eE,"$)|(?:^").concat(eI,"$)")),eP=new RegExp("^".concat(eE,"$")),eD=new RegExp("^".concat(eI,"$")),eO=function(e){return e&&e.exact?eA:RegExp("(?:".concat(eT(e)).concat(eE).concat(eT(e),")|(?:").concat(eT(e)).concat(eI).concat(eT(e),")"),"g")};eO.v4=function(e){return e&&e.exact?eP:RegExp("".concat(eT(e)).concat(eE).concat(eT(e)),"g")},eO.v6=function(e){return e&&e.exact?eD:RegExp("".concat(eT(e)).concat(eI).concat(eT(e)),"g")};var eN=Object.prototype.toString,eM={global:"g",ignoreCase:"i",multiline:"m",dotAll:"s",sticky:"y",unicode:"u"};function eL(e,t){var n,r;(arguments.length>2&&void 0!==arguments[2]?arguments[2]:{}).timeout;try{return(n=function(){return(function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if("[object RegExp]"!==eN.call(e))throw TypeError("Expected a RegExp instance");var n=Object.keys(eM).map(function(n){return("boolean"==typeof t[n]?t[n]:e[n])?eM[n]:""}).join(""),r=new RegExp(t.source||e.source,n);return r.lastIndex="number"==typeof t.lastIndex?t.lastIndex:e.lastIndex,r})(e).test(t)},r=function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return n.apply(void 0,(0,T._)(t))},Object.defineProperty(r,"name",{value:"functionTimeout(".concat(n.name||"<anonymous>",")"),configurable:!0}),r)()}catch(e){throw e}}var eB={timeout:400},eV=new TextEncoder;(t=s||(s={})).Lax="LAX",t.Strict="STRICT",(n=l||(l={})).NoHostname="NO_HOSTNAME",n.DomainMaxLength="DOMAIN_MAX_LENGTH",n.LabelMinLength="LABEL_MIN_LENGTH",n.LabelMaxLength="LABEL_MAX_LENGTH",n.LabelInvalidCharacter="LABEL_INVALID_CHARACTER",n.LastLabelInvalid="LAST_LABEL_INVALID",(r=u||(u={})).ValidIp="VALID_IP",r.ValidDomain="VALID_DOMAIN",r.Error="ERROR";var eF=function(e,t){var n=e.length;return{type:l.LabelMinLength,message:'Label "'.concat(e,'" is too short. Label is ').concat(n," octets long but should be at least ").concat(1,"."),column:t}},eU=function(e,t){var n=e.length;return{type:l.LabelMaxLength,message:'Label "'.concat(e,'" is too long. Label is ').concat(n," octets long but should not be longer than ").concat(63,"."),column:t}},eG=function(e,t,n){return{type:l.LabelInvalidCharacter,message:'Label "'.concat(e,'" contains invalid character "').concat(t,'" at column ').concat(n,"."),column:n}},e$=function(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if("string"!=typeof e)return{type:u.Error,errors:[{type:l.NoHostname,message:"The given input ".concat(String(e)," does not look like a hostname."),column:1}]};if(""===e)return{type:u.ValidDomain,domain:e,labels:[]};var r=e.replace(/^\[|]$/g,""),i=function(e){return!(e.length>45)&&eL(eO.v6({exact:!0}),e,eB)?6:!(e.length>15)&&eL(eO.v4({exact:!0}),e,eB)?4:void 0}(r);if(void 0!==i)return{type:u.ValidIp,ip:r,ipVersion:i};var o="."===e.charAt(e.length-1)?e.slice(0,-1):e,a=new TextEncoder().encode(o);if(a.length>253)return{type:u.Error,errors:[(t=a.length,{type:l.DomainMaxLength,message:'Domain "'.concat(e,'" is too long. Domain is ').concat(t," octets long but should not be longer than ").concat(253,"."),column:t})]};var c=o.split("."),d=n.validation,f=ez[void 0===d?s.Strict:d](c);return f.length>0?{type:u.Error,errors:f}:{type:u.ValidDomain,domain:e,labels:c}},ez=(c={},(0,ek._)(c,s.Lax,function(e){var t=[],n=1,r=!0,i=!1,o=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done);r=!0){var l=a.value,u=eV.encode(l);u.length<1?t.push(eF(l,n)):u.length>63&&t.push(eU(l,n)),n+=l.length+1}}catch(e){i=!0,o=e}finally{try{r||null==s.return||s.return()}finally{if(i)throw o}}return t}),(0,ek._)(c,s.Strict,function(e){var t,n,r=[],i=1,o=!0,a=!1,s=void 0;try{for(var u,c,d=e[Symbol.iterator]();!(o=(c=d.next()).done);o=!0){var f=c.value,p=/[^\da-z-]/i.exec(f);p&&r.push(eG(f,p[0],p.index+1)),f.startsWith("-")?r.push(eG(f,"-",i)):f.endsWith("-")&&r.push(eG(f,"-",i+f.length-1)),f.length<1?r.push(eF(f,i)):f.length>63&&r.push(eU(f,i)),i+=f.length+1,u=f}}catch(e){a=!0,s=e}finally{try{o||null==d.return||d.return()}finally{if(a)throw s}}return void 0!==u&&!1===RegExp("[a-z-]","iu").test(u)&&r.push((t=u,n=i-u.length-1,{type:l.LabelInvalidCharacter,message:'Last label "'.concat(t,'" must not be all-numeric.'),column:n})),r}),c),eH=Symbol("ROOT"),eW=Symbol("CHILD"),eq=function(e,t){var n=e.children.get(t);return void 0===n&&(n={type:eW,label:t,children:new Map,parent:e},e.children.set(t,n)),n},eK=function(e){for(var t={type:eH,children:new Map},n="",r=t,i=t,o=function(){i=eq(r,n),n=""},a=0;a<e.length;a++){var s=e.charAt(a);switch(s){case",":o();continue;case">":o(),r=i;continue;case"|":o(),r=t;continue;case"<":if(r.type===eH)throw Error("Error in serialized trie at position ".concat(a,": Cannot go up, current parent node is already root"));o(),r=r.parent;continue}n+=s}return""!==n&&o(),t},eY=["localhost","local","example","invalid","test"];(i=d||(d={})).Invalid="INVALID",i.Ip="IP",i.Reserved="RESERVED",i.NotListed="NOT_LISTED",i.Listed="LISTED";var eQ=function(e,t){return{subDomains:e.slice(0,Math.max(0,t)),domain:t>=0&&t<e.length?e[t]:void 0,topLevelDomains:e.slice(t+1)}},eX=function(e,t){var n=e$(e,t);if(n.type===u.Error)return{type:d.Invalid,hostname:e,errors:n.errors};if(n.type===u.ValidIp)return{type:d.Ip,hostname:n.ip,ipVersion:n.ipVersion};var r=n.labels,i=n.domain;if(""===e||eY.includes(r[r.length-1]))return{type:d.Reserved,hostname:i,labels:r};f=null!=f?f:eK("ac>com,edu,gov,net,mil,org<ad>nom<ae>co,net,org,sch,ac,gov,mil<aero>airline,airport,accident-investigation,accident-prevention,aerobatic,aeroclub,aerodrome,agents,air-surveillance,air-traffic-control,aircraft,airtraffic,ambulance,association,author,ballooning,broker,caa,cargo,catering,certification,championship,charter,civilaviation,club,conference,consultant,consulting,control,council,crew,design,dgca,educator,emergency,engine,engineer,entertainment,equipment,exchange,express,federation,flight,freight,fuel,gliding,government,groundhandling,group,hanggliding,homebuilt,insurance,journal,journalist,leasing,logistics,magazine,maintenance,marketplace,media,microlight,modelling,navigation,parachuting,paragliding,passenger-association,pilot,press,production,recreation,repbody,res,research,rotorcraft,safety,scientist,services,show,skydiving,software,student,taxi,trader,trading,trainer,union,workinggroup,works<af>gov,com,org,net,edu<ag>com,org,net,co,nom<ai>off,com,net,org<al>com,edu,gov,mil,net,org<am>co,com,commune,net,org<ao>ed,gv,og,co,pb,it<aq,ar>bet,com,coop,edu,gob,gov,int,mil,musica,mutual,net,org,senasa,tur<arpa>e164,in-addr,ip6,iris,uri,urn<as>gov<asia,at>ac>sth<co,gv,or<au>com,net,org,edu>act,catholic,nsw>schools<nt,qld,sa,tas,vic,wa<gov>qld,sa,tas,vic,wa<asn,id,info,conf,oz,act,nsw,nt,qld,sa,tas,vic,wa<aw>com<ax,az>com,net,int,gov,org,edu,info,pp,mil,name,pro,biz<ba>com,edu,gov,mil,net,org<bb>biz,co,com,edu,gov,info,net,org,store,tv<bd>*<be>ac<bf>gov<bg>a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,0,1,2,3,4,5,6,7,8,9<bh>com,edu,net,org,gov<bi>co,com,edu,or,org<biz,bj>africa,agro,architectes,assur,avocats,co,com,eco,econo,edu,info,loisirs,money,net,org,ote,resto,restaurant,tourism,univ<bm>com,edu,gov,net,org<bn>com,edu,gov,net,org<bo>com,edu,gob,int,org,net,mil,tv,web,academia,agro,arte,blog,bolivia,ciencia,cooperativa,democracia,deporte,ecologia,economia,empresa,indigena,industria,info,medicina,movimiento,musica,natural,nombre,noticias,patria,politica,profesional,plurinacional,pueblo,revista,salud,tecnologia,tksat,transporte,wiki<br>9guacu,abc,adm,adv,agr,aju,am,anani,aparecida,app,arq,art,ato,b,barueri,belem,bhz,bib,bio,blog,bmd,boavista,bsb,campinagrande,campinas,caxias,cim,cng,cnt,com,contagem,coop,coz,cri,cuiaba,curitiba,def,des,det,dev,ecn,eco,edu,emp,enf,eng,esp,etc,eti,far,feira,flog,floripa,fm,fnd,fortal,fot,foz,fst,g12,geo,ggf,goiania,gov>ac,al,am,ap,ba,ce,df,es,go,ma,mg,ms,mt,pa,pb,pe,pi,pr,rj,rn,ro,rr,rs,sc,se,sp,to<gru,imb,ind,inf,jab,jampa,jdf,joinville,jor,jus,leg,lel,log,londrina,macapa,maceio,manaus,maringa,mat,med,mil,morena,mp,mus,natal,net,niteroi,nom>*<not,ntr,odo,ong,org,osasco,palmas,poa,ppg,pro,psc,psi,pvh,qsl,radio,rec,recife,rep,ribeirao,rio,riobranco,riopreto,salvador,sampa,santamaria,santoandre,saobernardo,saogonca,seg,sjc,slg,slz,sorocaba,srv,taxi,tc,tec,teo,the,tmp,trd,tur,tv,udi,vet,vix,vlog,wiki,zlg<bs>com,net,org,edu,gov<bt>com,edu,gov,net,org<bv,bw>co,org<by>gov,mil,com,of<bz>com,net,org,edu,gov<ca>ab,bc,mb,nb,nf,nl,ns,nt,nu,on,pe,qc,sk,yk,gc<cat,cc,cd>gov<cf,cg,ch,ci>org,or,com,co,edu,ed,ac,net,go,asso,xn--aroport-bya,int,presse,md,gouv<ck>*,!www<cl>co,gob,gov,mil<cm>co,com,gov,net<cn>ac,com,edu,gov,net,org,mil,xn--55qx5d,xn--io0a7i,xn--od0alg,ah,bj,cq,fj,gd,gs,gz,gx,ha,hb,he,hi,hl,hn,jl,js,jx,ln,nm,nx,qh,sc,sd,sh,sn,sx,tj,xj,xz,yn,zj,hk,mo,tw<co>arts,com,edu,firm,gov,info,int,mil,net,nom,org,rec,web<com,coop,cr>ac,co,ed,fi,go,or,sa<cu>com,edu,org,net,gov,inf<cv>com,edu,int,nome,org<cw>com,edu,net,org<cx>gov<cy>ac,biz,com,ekloges,gov,ltd,mil,net,org,press,pro,tm<cz,de,dj,dk,dm>com,net,org,edu,gov<do>art,com,edu,gob,gov,mil,net,org,sld,web<dz>art,asso,com,edu,gov,org,net,pol,soc,tm<ec>com,info,net,fin,k12,med,pro,org,edu,gov,gob,mil<edu,ee>edu,gov,riik,lib,med,com,pri,aip,org,fie<eg>com,edu,eun,gov,mil,name,net,org,sci<er>*<es>com,nom,org,gob,edu<et>com,gov,org,edu,biz,name,info,net<eu,fi>aland<fj>ac,biz,com,gov,info,mil,name,net,org,pro<fk>*<fm>com,edu,net,org<fo,fr>asso,com,gouv,nom,prd,tm,avoues,cci,greta,huissier-justice<ga,gb,gd>edu,gov<ge>com,edu,gov,org,mil,net,pvt<gf,gg>co,net,org<gh>com,edu,gov,org,mil<gi>com,ltd,gov,mod,edu,org<gl>co,com,edu,net,org<gm,gn>ac,com,edu,gov,org,net<gov,gp>com,net,mobi,edu,org,asso<gq,gr>com,edu,net,org,gov<gs,gt>com,edu,gob,ind,mil,net,org<gu>com,edu,gov,guam,info,net,org,web<gw,gy>co,com,edu,gov,net,org<hk>com,edu,gov,idv,net,org,xn--55qx5d,xn--wcvs22d,xn--lcvr32d,xn--mxtq1m,xn--gmqw5a,xn--ciqpn,xn--gmq050i,xn--zf0avx,xn--io0a7i,xn--mk0axi,xn--od0alg,xn--od0aq3b,xn--tn0ag,xn--uc0atv,xn--uc0ay4a<hm,hn>com,edu,org,net,mil,gob<hr>iz,from,name,com<ht>com,shop,firm,info,adult,net,pro,org,med,art,coop,pol,asso,edu,rel,gouv,perso<hu>co,info,org,priv,sport,tm,2000,agrar,bolt,casino,city,erotica,erotika,film,forum,games,hotel,ingatlan,jogasz,konyvelo,lakas,media,news,reklam,sex,shop,suli,szex,tozsde,utazas,video<id>ac,biz,co,desa,go,mil,my,net,or,ponpes,sch,web<ie>gov<il>ac,co,gov,idf,k12,muni,net,org<xn--4dbrk0ce>xn--4dbgdty6c,xn--5dbhl8d,xn--8dbq2a,xn--hebda8b<im>ac,co>ltd,plc<com,net,org,tt,tv<in>5g,6g,ac,ai,am,bihar,biz,business,ca,cn,co,com,coop,cs,delhi,dr,edu,er,firm,gen,gov,gujarat,ind,info,int,internet,io,me,mil,net,nic,org,pg,post,pro,res,travel,tv,uk,up,us<info,int>eu<io>com<iq>gov,edu,mil,com,org,net<ir>ac,co,gov,id,net,org,sch,xn--mgba3a4f16a,xn--mgba3a4fra<is>net,com,edu,gov,org,int<it>gov,edu,abr,abruzzo,aosta-valley,aostavalley,bas,basilicata,cal,calabria,cam,campania,emilia-romagna,emiliaromagna,emr,friuli-v-giulia,friuli-ve-giulia,friuli-vegiulia,friuli-venezia-giulia,friuli-veneziagiulia,friuli-vgiulia,friuliv-giulia,friulive-giulia,friulivegiulia,friulivenezia-giulia,friuliveneziagiulia,friulivgiulia,fvg,laz,lazio,lig,liguria,lom,lombardia,lombardy,lucania,mar,marche,mol,molise,piedmont,piemonte,pmn,pug,puglia,sar,sardegna,sardinia,sic,sicilia,sicily,taa,tos,toscana,trentin-sud-tirol,xn--trentin-sd-tirol-rzb,trentin-sudtirol,xn--trentin-sdtirol-7vb,trentin-sued-tirol,trentin-suedtirol,trentino-a-adige,trentino-aadige,trentino-alto-adige,trentino-altoadige,trentino-s-tirol,trentino-stirol,trentino-sud-tirol,xn--trentino-sd-tirol-c3b,trentino-sudtirol,xn--trentino-sdtirol-szb,trentino-sued-tirol,trentino-suedtirol,trentino,trentinoa-adige,trentinoaadige,trentinoalto-adige,trentinoaltoadige,trentinos-tirol,trentinostirol,trentinosud-tirol,xn--trentinosd-tirol-rzb,trentinosudtirol,xn--trentinosdtirol-7vb,trentinosued-tirol,trentinosuedtirol,trentinsud-tirol,xn--trentinsd-tirol-6vb,trentinsudtirol,xn--trentinsdtirol-nsb,trentinsued-tirol,trentinsuedtirol,tuscany,umb,umbria,val-d-aosta,val-daosta,vald-aosta,valdaosta,valle-aosta,valle-d-aosta,valle-daosta,valleaosta,valled-aosta,valledaosta,vallee-aoste,xn--valle-aoste-ebb,vallee-d-aoste,xn--valle-d-aoste-ehb,valleeaoste,xn--valleaoste-e7a,valleedaoste,xn--valledaoste-ebb,vao,vda,ven,veneto,ag,agrigento,al,alessandria,alto-adige,altoadige,an,ancona,andria-barletta-trani,andria-trani-barletta,andriabarlettatrani,andriatranibarletta,ao,aosta,aoste,ap,aq,aquila,ar,arezzo,ascoli-piceno,ascolipiceno,asti,at,av,avellino,ba,balsan-sudtirol,xn--balsan-sdtirol-nsb,balsan-suedtirol,balsan,bari,barletta-trani-andria,barlettatraniandria,belluno,benevento,bergamo,bg,bi,biella,bl,bn,bo,bologna,bolzano-altoadige,bolzano,bozen-sudtirol,xn--bozen-sdtirol-2ob,bozen-suedtirol,bozen,br,brescia,brindisi,bs,bt,bulsan-sudtirol,xn--bulsan-sdtirol-nsb,bulsan-suedtirol,bulsan,bz,ca,cagliari,caltanissetta,campidano-medio,campidanomedio,campobasso,carbonia-iglesias,carboniaiglesias,carrara-massa,carraramassa,caserta,catania,catanzaro,cb,ce,cesena-forli,xn--cesena-forl-mcb,cesenaforli,xn--cesenaforl-i8a,ch,chieti,ci,cl,cn,co,como,cosenza,cr,cremona,crotone,cs,ct,cuneo,cz,dell-ogliastra,dellogliastra,en,enna,fc,fe,fermo,ferrara,fg,fi,firenze,florence,fm,foggia,forli-cesena,xn--forl-cesena-fcb,forlicesena,xn--forlcesena-c8a,fr,frosinone,ge,genoa,genova,go,gorizia,gr,grosseto,iglesias-carbonia,iglesiascarbonia,im,imperia,is,isernia,kr,la-spezia,laquila,laspezia,latina,lc,le,lecce,lecco,li,livorno,lo,lodi,lt,lu,lucca,macerata,mantova,massa-carrara,massacarrara,matera,mb,mc,me,medio-campidano,mediocampidano,messina,mi,milan,milano,mn,mo,modena,monza-brianza,monza-e-della-brianza,monza,monzabrianza,monzaebrianza,monzaedellabrianza,ms,mt,na,naples,napoli,no,novara,nu,nuoro,og,ogliastra,olbia-tempio,olbiatempio,or,oristano,ot,pa,padova,padua,palermo,parma,pavia,pc,pd,pe,perugia,pesaro-urbino,pesarourbino,pescara,pg,pi,piacenza,pisa,pistoia,pn,po,pordenone,potenza,pr,prato,pt,pu,pv,pz,ra,ragusa,ravenna,rc,re,reggio-calabria,reggio-emilia,reggiocalabria,reggioemilia,rg,ri,rieti,rimini,rm,rn,ro,roma,rome,rovigo,sa,salerno,sassari,savona,si,siena,siracusa,so,sondrio,sp,sr,ss,suedtirol,xn--sdtirol-n2a,sv,ta,taranto,te,tempio-olbia,tempioolbia,teramo,terni,tn,to,torino,tp,tr,trani-andria-barletta,trani-barletta-andria,traniandriabarletta,tranibarlettaandria,trapani,trento,treviso,trieste,ts,turin,tv,ud,udine,urbino-pesaro,urbinopesaro,va,varese,vb,vc,ve,venezia,venice,verbania,vercelli,verona,vi,vibo-valentia,vibovalentia,vicenza,viterbo,vr,vs,vt,vv<je>co,net,org<jm>*<jo>com,org,net,edu,sch,gov,mil,name<jobs,jp>ac,ad,co,ed,go,gr,lg,ne,or,aichi>aisai,ama,anjo,asuke,chiryu,chita,fuso,gamagori,handa,hazu,hekinan,higashiura,ichinomiya,inazawa,inuyama,isshiki,iwakura,kanie,kariya,kasugai,kira,kiyosu,komaki,konan,kota,mihama,miyoshi,nishio,nisshin,obu,oguchi,oharu,okazaki,owariasahi,seto,shikatsu,shinshiro,shitara,tahara,takahama,tobishima,toei,togo,tokai,tokoname,toyoake,toyohashi,toyokawa,toyone,toyota,tsushima,yatomi<akita>akita,daisen,fujisato,gojome,hachirogata,happou,higashinaruse,honjo,honjyo,ikawa,kamikoani,kamioka,katagami,kazuno,kitaakita,kosaka,kyowa,misato,mitane,moriyoshi,nikaho,noshiro,odate,oga,ogata,semboku,yokote,yurihonjo<aomori>aomori,gonohe,hachinohe,hashikami,hiranai,hirosaki,itayanagi,kuroishi,misawa,mutsu,nakadomari,noheji,oirase,owani,rokunohe,sannohe,shichinohe,shingo,takko,towada,tsugaru,tsuruta<chiba>abiko,asahi,chonan,chosei,choshi,chuo,funabashi,futtsu,hanamigawa,ichihara,ichikawa,ichinomiya,inzai,isumi,kamagaya,kamogawa,kashiwa,katori,katsuura,kimitsu,kisarazu,kozaki,kujukuri,kyonan,matsudo,midori,mihama,minamiboso,mobara,mutsuzawa,nagara,nagareyama,narashino,narita,noda,oamishirasato,omigawa,onjuku,otaki,sakae,sakura,shimofusa,shirako,shiroi,shisui,sodegaura,sosa,tako,tateyama,togane,tohnosho,tomisato,urayasu,yachimata,yachiyo,yokaichiba,yokoshibahikari,yotsukaido<ehime>ainan,honai,ikata,imabari,iyo,kamijima,kihoku,kumakogen,masaki,matsuno,matsuyama,namikata,niihama,ozu,saijo,seiyo,shikokuchuo,tobe,toon,uchiko,uwajima,yawatahama<fukui>echizen,eiheiji,fukui,ikeda,katsuyama,mihama,minamiechizen,obama,ohi,ono,sabae,sakai,takahama,tsuruga,wakasa<fukuoka>ashiya,buzen,chikugo,chikuho,chikujo,chikushino,chikuzen,chuo,dazaifu,fukuchi,hakata,higashi,hirokawa,hisayama,iizuka,inatsuki,kaho,kasuga,kasuya,kawara,keisen,koga,kurate,kurogi,kurume,minami,miyako,miyama,miyawaka,mizumaki,munakata,nakagawa,nakama,nishi,nogata,ogori,okagaki,okawa,oki,omuta,onga,onojo,oto,saigawa,sasaguri,shingu,shinyoshitomi,shonai,soeda,sue,tachiarai,tagawa,takata,toho,toyotsu,tsuiki,ukiha,umi,usui,yamada,yame,yanagawa,yukuhashi<fukushima>aizubange,aizumisato,aizuwakamatsu,asakawa,bandai,date,fukushima,furudono,futaba,hanawa,higashi,hirata,hirono,iitate,inawashiro,ishikawa,iwaki,izumizaki,kagamiishi,kaneyama,kawamata,kitakata,kitashiobara,koori,koriyama,kunimi,miharu,mishima,namie,nango,nishiaizu,nishigo,okuma,omotego,ono,otama,samegawa,shimogo,shirakawa,showa,soma,sukagawa,taishin,tamakawa,tanagura,tenei,yabuki,yamato,yamatsuri,yanaizu,yugawa<gifu>anpachi,ena,gifu,ginan,godo,gujo,hashima,hichiso,hida,higashishirakawa,ibigawa,ikeda,kakamigahara,kani,kasahara,kasamatsu,kawaue,kitagata,mino,minokamo,mitake,mizunami,motosu,nakatsugawa,ogaki,sakahogi,seki,sekigahara,shirakawa,tajimi,takayama,tarui,toki,tomika,wanouchi,yamagata,yaotsu,yoro<gunma>annaka,chiyoda,fujioka,higashiagatsuma,isesaki,itakura,kanna,kanra,katashina,kawaba,kiryu,kusatsu,maebashi,meiwa,midori,minakami,naganohara,nakanojo,nanmoku,numata,oizumi,ora,ota,shibukawa,shimonita,shinto,showa,takasaki,takayama,tamamura,tatebayashi,tomioka,tsukiyono,tsumagoi,ueno,yoshioka<hiroshima>asaminami,daiwa,etajima,fuchu,fukuyama,hatsukaichi,higashihiroshima,hongo,jinsekikogen,kaita,kui,kumano,kure,mihara,miyoshi,naka,onomichi,osakikamijima,otake,saka,sera,seranishi,shinichi,shobara,takehara<hokkaido>abashiri,abira,aibetsu,akabira,akkeshi,asahikawa,ashibetsu,ashoro,assabu,atsuma,bibai,biei,bifuka,bihoro,biratori,chippubetsu,chitose,date,ebetsu,embetsu,eniwa,erimo,esan,esashi,fukagawa,fukushima,furano,furubira,haboro,hakodate,hamatonbetsu,hidaka,higashikagura,higashikawa,hiroo,hokuryu,hokuto,honbetsu,horokanai,horonobe,ikeda,imakane,ishikari,iwamizawa,iwanai,kamifurano,kamikawa,kamishihoro,kamisunagawa,kamoenai,kayabe,kembuchi,kikonai,kimobetsu,kitahiroshima,kitami,kiyosato,koshimizu,kunneppu,kuriyama,kuromatsunai,kushiro,kutchan,kyowa,mashike,matsumae,mikasa,minamifurano,mombetsu,moseushi,mukawa,muroran,naie,nakagawa,nakasatsunai,nakatombetsu,nanae,nanporo,nayoro,nemuro,niikappu,niki,nishiokoppe,noboribetsu,numata,obihiro,obira,oketo,okoppe,otaru,otobe,otofuke,otoineppu,oumu,ozora,pippu,rankoshi,rebun,rikubetsu,rishiri,rishirifuji,saroma,sarufutsu,shakotan,shari,shibecha,shibetsu,shikabe,shikaoi,shimamaki,shimizu,shimokawa,shinshinotsu,shintoku,shiranuka,shiraoi,shiriuchi,sobetsu,sunagawa,taiki,takasu,takikawa,takinoue,teshikaga,tobetsu,tohma,tomakomai,tomari,toya,toyako,toyotomi,toyoura,tsubetsu,tsukigata,urakawa,urausu,uryu,utashinai,wakkanai,wassamu,yakumo,yoichi<hyogo>aioi,akashi,ako,amagasaki,aogaki,asago,ashiya,awaji,fukusaki,goshiki,harima,himeji,ichikawa,inagawa,itami,kakogawa,kamigori,kamikawa,kasai,kasuga,kawanishi,miki,minamiawaji,nishinomiya,nishiwaki,ono,sanda,sannan,sasayama,sayo,shingu,shinonsen,shiso,sumoto,taishi,taka,takarazuka,takasago,takino,tamba,tatsuno,toyooka,yabu,yashiro,yoka,yokawa<ibaraki>ami,asahi,bando,chikusei,daigo,fujishiro,hitachi,hitachinaka,hitachiomiya,hitachiota,ibaraki,ina,inashiki,itako,iwama,joso,kamisu,kasama,kashima,kasumigaura,koga,miho,mito,moriya,naka,namegata,oarai,ogawa,omitama,ryugasaki,sakai,sakuragawa,shimodate,shimotsuma,shirosato,sowa,suifu,takahagi,tamatsukuri,tokai,tomobe,tone,toride,tsuchiura,tsukuba,uchihara,ushiku,yachiyo,yamagata,yawara,yuki<ishikawa>anamizu,hakui,hakusan,kaga,kahoku,kanazawa,kawakita,komatsu,nakanoto,nanao,nomi,nonoichi,noto,shika,suzu,tsubata,tsurugi,uchinada,wajima<iwate>fudai,fujisawa,hanamaki,hiraizumi,hirono,ichinohe,ichinoseki,iwaizumi,iwate,joboji,kamaishi,kanegasaki,karumai,kawai,kitakami,kuji,kunohe,kuzumaki,miyako,mizusawa,morioka,ninohe,noda,ofunato,oshu,otsuchi,rikuzentakata,shiwa,shizukuishi,sumita,tanohata,tono,yahaba,yamada<kagawa>ayagawa,higashikagawa,kanonji,kotohira,manno,marugame,mitoyo,naoshima,sanuki,tadotsu,takamatsu,tonosho,uchinomi,utazu,zentsuji<kagoshima>akune,amami,hioki,isa,isen,izumi,kagoshima,kanoya,kawanabe,kinko,kouyama,makurazaki,matsumoto,minamitane,nakatane,nishinoomote,satsumasendai,soo,tarumizu,yusui<kanagawa>aikawa,atsugi,ayase,chigasaki,ebina,fujisawa,hadano,hakone,hiratsuka,isehara,kaisei,kamakura,kiyokawa,matsuda,minamiashigara,miura,nakai,ninomiya,odawara,oi,oiso,sagamihara,samukawa,tsukui,yamakita,yamato,yokosuka,yugawara,zama,zushi<kochi>aki,geisei,hidaka,higashitsuno,ino,kagami,kami,kitagawa,kochi,mihara,motoyama,muroto,nahari,nakamura,nankoku,nishitosa,niyodogawa,ochi,okawa,otoyo,otsuki,sakawa,sukumo,susaki,tosa,tosashimizu,toyo,tsuno,umaji,yasuda,yusuhara<kumamoto>amakusa,arao,aso,choyo,gyokuto,kamiamakusa,kikuchi,kumamoto,mashiki,mifune,minamata,minamioguni,nagasu,nishihara,oguni,ozu,sumoto,takamori,uki,uto,yamaga,yamato,yatsushiro<kyoto>ayabe,fukuchiyama,higashiyama,ide,ine,joyo,kameoka,kamo,kita,kizu,kumiyama,kyotamba,kyotanabe,kyotango,maizuru,minami,minamiyamashiro,miyazu,muko,nagaokakyo,nakagyo,nantan,oyamazaki,sakyo,seika,tanabe,uji,ujitawara,wazuka,yamashina,yawata<mie>asahi,inabe,ise,kameyama,kawagoe,kiho,kisosaki,kiwa,komono,kumano,kuwana,matsusaka,meiwa,mihama,minamiise,misugi,miyama,nabari,shima,suzuka,tado,taiki,taki,tamaki,toba,tsu,udono,ureshino,watarai,yokkaichi<miyagi>furukawa,higashimatsushima,ishinomaki,iwanuma,kakuda,kami,kawasaki,marumori,matsushima,minamisanriku,misato,murata,natori,ogawara,ohira,onagawa,osaki,rifu,semine,shibata,shichikashuku,shikama,shiogama,shiroishi,tagajo,taiwa,tome,tomiya,wakuya,watari,yamamoto,zao<miyazaki>aya,ebino,gokase,hyuga,kadogawa,kawaminami,kijo,kitagawa,kitakata,kitaura,kobayashi,kunitomi,kushima,mimata,miyakonojo,miyazaki,morotsuka,nichinan,nishimera,nobeoka,saito,shiiba,shintomi,takaharu,takanabe,takazaki,tsuno<nagano>achi,agematsu,anan,aoki,asahi,azumino,chikuhoku,chikuma,chino,fujimi,hakuba,hara,hiraya,iida,iijima,iiyama,iizuna,ikeda,ikusaka,ina,karuizawa,kawakami,kiso,kisofukushima,kitaaiki,komagane,komoro,matsukawa,matsumoto,miasa,minamiaiki,minamimaki,minamiminowa,minowa,miyada,miyota,mochizuki,nagano,nagawa,nagiso,nakagawa,nakano,nozawaonsen,obuse,ogawa,okaya,omachi,omi,ookuwa,ooshika,otaki,otari,sakae,sakaki,saku,sakuho,shimosuwa,shinanomachi,shiojiri,suwa,suzaka,takagi,takamori,takayama,tateshina,tatsuno,togakushi,togura,tomi,ueda,wada,yamagata,yamanouchi,yasaka,yasuoka<nagasaki>chijiwa,futsu,goto,hasami,hirado,iki,isahaya,kawatana,kuchinotsu,matsuura,nagasaki,obama,omura,oseto,saikai,sasebo,seihi,shimabara,shinkamigoto,togitsu,tsushima,unzen<nara>ando,gose,heguri,higashiyoshino,ikaruga,ikoma,kamikitayama,kanmaki,kashiba,kashihara,katsuragi,kawai,kawakami,kawanishi,koryo,kurotaki,mitsue,miyake,nara,nosegawa,oji,ouda,oyodo,sakurai,sango,shimoichi,shimokitayama,shinjo,soni,takatori,tawaramoto,tenkawa,tenri,uda,yamatokoriyama,yamatotakada,yamazoe,yoshino<niigata>aga,agano,gosen,itoigawa,izumozaki,joetsu,kamo,kariwa,kashiwazaki,minamiuonuma,mitsuke,muika,murakami,myoko,nagaoka,niigata,ojiya,omi,sado,sanjo,seiro,seirou,sekikawa,shibata,tagami,tainai,tochio,tokamachi,tsubame,tsunan,uonuma,yahiko,yoita,yuzawa<oita>beppu,bungoono,bungotakada,hasama,hiji,himeshima,hita,kamitsue,kokonoe,kuju,kunisaki,kusu,oita,saiki,taketa,tsukumi,usa,usuki,yufu<okayama>akaiwa,asakuchi,bizen,hayashima,ibara,kagamino,kasaoka,kibichuo,kumenan,kurashiki,maniwa,misaki,nagi,niimi,nishiawakura,okayama,satosho,setouchi,shinjo,shoo,soja,takahashi,tamano,tsuyama,wake,yakage<okinawa>aguni,ginowan,ginoza,gushikami,haebaru,higashi,hirara,iheya,ishigaki,ishikawa,itoman,izena,kadena,kin,kitadaito,kitanakagusuku,kumejima,kunigami,minamidaito,motobu,nago,naha,nakagusuku,nakijin,nanjo,nishihara,ogimi,okinawa,onna,shimoji,taketomi,tarama,tokashiki,tomigusuku,tonaki,urasoe,uruma,yaese,yomitan,yonabaru,yonaguni,zamami<osaka>abeno,chihayaakasaka,chuo,daito,fujiidera,habikino,hannan,higashiosaka,higashisumiyoshi,higashiyodogawa,hirakata,ibaraki,ikeda,izumi,izumiotsu,izumisano,kadoma,kaizuka,kanan,kashiwara,katano,kawachinagano,kishiwada,kita,kumatori,matsubara,minato,minoh,misaki,moriguchi,neyagawa,nishi,nose,osakasayama,sakai,sayama,sennan,settsu,shijonawate,shimamoto,suita,tadaoka,taishi,tajiri,takaishi,takatsuki,tondabayashi,toyonaka,toyono,yao<saga>ariake,arita,fukudomi,genkai,hamatama,hizen,imari,kamimine,kanzaki,karatsu,kashima,kitagata,kitahata,kiyama,kouhoku,kyuragi,nishiarita,ogi,omachi,ouchi,saga,shiroishi,taku,tara,tosu,yoshinogari<saitama>arakawa,asaka,chichibu,fujimi,fujimino,fukaya,hanno,hanyu,hasuda,hatogaya,hatoyama,hidaka,higashichichibu,higashimatsuyama,honjo,ina,iruma,iwatsuki,kamiizumi,kamikawa,kamisato,kasukabe,kawagoe,kawaguchi,kawajima,kazo,kitamoto,koshigaya,kounosu,kuki,kumagaya,matsubushi,minano,misato,miyashiro,miyoshi,moroyama,nagatoro,namegawa,niiza,ogano,ogawa,ogose,okegawa,omiya,otaki,ranzan,ryokami,saitama,sakado,satte,sayama,shiki,shiraoka,soka,sugito,toda,tokigawa,tokorozawa,tsurugashima,urawa,warabi,yashio,yokoze,yono,yorii,yoshida,yoshikawa,yoshimi<shiga>aisho,gamo,higashiomi,hikone,koka,konan,kosei,koto,kusatsu,maibara,moriyama,nagahama,nishiazai,notogawa,omihachiman,otsu,ritto,ryuoh,takashima,takatsuki,torahime,toyosato,yasu<shimane>akagi,ama,gotsu,hamada,higashiizumo,hikawa,hikimi,izumo,kakinoki,masuda,matsue,misato,nishinoshima,ohda,okinoshima,okuizumo,shimane,tamayu,tsuwano,unnan,yakumo,yasugi,yatsuka<shizuoka>arai,atami,fuji,fujieda,fujikawa,fujinomiya,fukuroi,gotemba,haibara,hamamatsu,higashiizu,ito,iwata,izu,izunokuni,kakegawa,kannami,kawanehon,kawazu,kikugawa,kosai,makinohara,matsuzaki,minamiizu,mishima,morimachi,nishiizu,numazu,omaezaki,shimada,shimizu,shimoda,shizuoka,susono,yaizu,yoshida<tochigi>ashikaga,bato,haga,ichikai,iwafune,kaminokawa,kanuma,karasuyama,kuroiso,mashiko,mibu,moka,motegi,nasu,nasushiobara,nikko,nishikata,nogi,ohira,ohtawara,oyama,sakura,sano,shimotsuke,shioya,takanezawa,tochigi,tsuga,ujiie,utsunomiya,yaita<tokushima>aizumi,anan,ichiba,itano,kainan,komatsushima,matsushige,mima,minami,miyoshi,mugi,nakagawa,naruto,sanagochi,shishikui,tokushima,wajiki<tokyo>adachi,akiruno,akishima,aogashima,arakawa,bunkyo,chiyoda,chofu,chuo,edogawa,fuchu,fussa,hachijo,hachioji,hamura,higashikurume,higashimurayama,higashiyamato,hino,hinode,hinohara,inagi,itabashi,katsushika,kita,kiyose,kodaira,koganei,kokubunji,komae,koto,kouzushima,kunitachi,machida,meguro,minato,mitaka,mizuho,musashimurayama,musashino,nakano,nerima,ogasawara,okutama,ome,oshima,ota,setagaya,shibuya,shinagawa,shinjuku,suginami,sumida,tachikawa,taito,tama,toshima<tottori>chizu,hino,kawahara,koge,kotoura,misasa,nanbu,nichinan,sakaiminato,tottori,wakasa,yazu,yonago<toyama>asahi,fuchu,fukumitsu,funahashi,himi,imizu,inami,johana,kamiichi,kurobe,nakaniikawa,namerikawa,nanto,nyuzen,oyabe,taira,takaoka,tateyama,toga,tonami,toyama,unazuki,uozu,yamada<wakayama>arida,aridagawa,gobo,hashimoto,hidaka,hirogawa,inami,iwade,kainan,kamitonda,katsuragi,kimino,kinokawa,kitayama,koya,koza,kozagawa,kudoyama,kushimoto,mihama,misato,nachikatsuura,shingu,shirahama,taiji,tanabe,wakayama,yuasa,yura<yamagata>asahi,funagata,higashine,iide,kahoku,kaminoyama,kaneyama,kawanishi,mamurogawa,mikawa,murayama,nagai,nakayama,nanyo,nishikawa,obanazawa,oe,oguni,ohkura,oishida,sagae,sakata,sakegawa,shinjo,shirataka,shonai,takahata,tendo,tozawa,tsuruoka,yamagata,yamanobe,yonezawa,yuza<yamaguchi>abu,hagi,hikari,hofu,iwakuni,kudamatsu,mitou,nagato,oshima,shimonoseki,shunan,tabuse,tokuyama,toyota,ube,yuu<yamanashi>chuo,doshi,fuefuki,fujikawa,fujikawaguchiko,fujiyoshida,hayakawa,hokuto,ichikawamisato,kai,kofu,koshu,kosuge,minami-alps,minobu,nakamichi,nanbu,narusawa,nirasaki,nishikatsura,oshino,otsuki,showa,tabayama,tsuru,uenohara,yamanakako,yamanashi<xn--4pvxs,xn--vgu402c,xn--c3s14m,xn--f6qx53a,xn--8pvr4u,xn--uist22h,xn--djrs72d6uy,xn--mkru45i,xn--0trq7p7nn,xn--8ltr62k,xn--2m4a15e,xn--efvn9s,xn--32vp30h,xn--4it797k,xn--1lqs71d,xn--5rtp49c,xn--5js045d,xn--ehqz56n,xn--1lqs03n,xn--qqqt11m,xn--kbrq7o,xn--pssu33l,xn--ntsq17g,xn--uisz3g,xn--6btw5a,xn--1ctwo,xn--6orx2r,xn--rht61e,xn--rht27z,xn--djty4k,xn--nit225k,xn--rht3d,xn--klty5x,xn--kltx9a,xn--kltp7d,xn--uuwu58a,xn--zbx025d,xn--ntso0iqx3a,xn--elqq16h,xn--4it168d,xn--klt787d,xn--rny31h,xn--7t0a264c,xn--5rtq34k,xn--k7yn95e,xn--tor131o,xn--d5qv7z876c,kawasaki>*,!city<kitakyushu>*,!city<kobe>*,!city<nagoya>*,!city<sapporo>*,!city<sendai>*,!city<yokohama>*,!city<<ke>ac,co,go,info,me,mobi,ne,or,sc<kg>org,net,com,edu,gov,mil<kh>*<ki>edu,biz,net,org,gov,info,com<km>org,nom,gov,prd,tm,edu,mil,ass,com,coop,asso,presse,medecin,notaires,pharmaciens,veterinaire,gouv<kn>net,org,edu,gov<kp>com,edu,gov,org,rep,tra<kr>ac,co,es,go,hs,kg,mil,ms,ne,or,pe,re,sc,busan,chungbuk,chungnam,daegu,daejeon,gangwon,gwangju,gyeongbuk,gyeonggi,gyeongnam,incheon,jeju,jeonbuk,jeonnam,seoul,ulsan<kw>com,edu,emb,gov,ind,net,org<ky>com,edu,net,org<kz>org,edu,net,gov,mil,com<la>int,net,info,edu,gov,per,com,org<lb>com,edu,gov,net,org<lc>com,net,co,org,edu,gov<li,lk>gov,sch,net,int,com,org,edu,ngo,soc,web,ltd,assn,grp,hotel,ac<lr>com,edu,gov,org,net<ls>ac,biz,co,edu,gov,info,net,org,sc<lt>gov<lu,lv>com,edu,gov,org,mil,id,net,asn,conf<ly>com,net,gov,plc,edu,sch,med,org,id<ma>co,net,gov,org,ac,press<mc>tm,asso<md,me>co,net,org,edu,ac,gov,its,priv<mg>org,nom,gov,prd,tm,edu,mil,com,co<mh,mil,mk>com,org,net,edu,gov,inf,name<ml>com,edu,gouv,gov,net,org,presse<mm>*<mn>gov,edu,org<mo>com,net,org,edu,gov<mobi,mp,mq,mr>gov<ms>com,edu,gov,net,org<mt>com,edu,net,org<mu>com,net,org,gov,ac,co,or<museum,mv>aero,biz,com,coop,edu,gov,info,int,mil,museum,name,net,org,pro<mw>ac,biz,co,com,coop,edu,gov,int,museum,net,org<mx>com,org,gob,edu,net<my>biz,com,edu,gov,mil,name,net,org<mz>ac,adv,co,edu,gov,mil,net,org<na>info,pro,name,school,or,dr,us,mx,ca,in,cc,tv,ws,mobi,co,com,org<name,nc>asso,nom<ne,net,nf>com,net,per,rec,web,arts,firm,info,other,store<ng>com,edu,gov,i,mil,mobi,name,net,org,sch<ni>ac,biz,co,com,edu,gob,in,info,int,mil,net,nom,org,web<nl,no>fhs,vgs,fylkesbibl,folkebibl,museum,idrett,priv,mil,stat,dep,kommune,herad,aa>gs<ah>gs<bu>gs<fm>gs<hl>gs<hm>gs<jan-mayen>gs<mr>gs<nl>gs<nt>gs<of>gs<ol>gs<oslo>gs<rl>gs<sf>gs<st>gs<svalbard>gs<tm>gs<tr>gs<va>gs<vf>gs<akrehamn,xn--krehamn-dxa,algard,xn--lgrd-poac,arna,brumunddal,bryne,bronnoysund,xn--brnnysund-m8ac,drobak,xn--drbak-wua,egersund,fetsund,floro,xn--flor-jra,fredrikstad,hokksund,honefoss,xn--hnefoss-q1a,jessheim,jorpeland,xn--jrpeland-54a,kirkenes,kopervik,krokstadelva,langevag,xn--langevg-jxa,leirvik,mjondalen,xn--mjndalen-64a,mo-i-rana,mosjoen,xn--mosjen-eya,nesoddtangen,orkanger,osoyro,xn--osyro-wua,raholt,xn--rholt-mra,sandnessjoen,xn--sandnessjen-ogb,skedsmokorset,slattum,spjelkavik,stathelle,stavern,stjordalshalsen,xn--stjrdalshalsen-sqb,tananger,tranby,vossevangen,afjord,xn--fjord-lra,agdenes,al,xn--l-1fa,alesund,xn--lesund-hua,alstahaug,alta,xn--lt-liac,alaheadju,xn--laheadju-7ya,alvdal,amli,xn--mli-tla,amot,xn--mot-tla,andebu,andoy,xn--andy-ira,andasuolo,ardal,xn--rdal-poa,aremark,arendal,xn--s-1fa,aseral,xn--seral-lra,asker,askim,askvoll,askoy,xn--asky-ira,asnes,xn--snes-poa,audnedaln,aukra,aure,aurland,aurskog-holand,xn--aurskog-hland-jnb,austevoll,austrheim,averoy,xn--avery-yua,balestrand,ballangen,balat,xn--blt-elab,balsfjord,bahccavuotna,xn--bhccavuotna-k7a,bamble,bardu,beardu,beiarn,bajddar,xn--bjddar-pta,baidar,xn--bidr-5nac,berg,bergen,berlevag,xn--berlevg-jxa,bearalvahki,xn--bearalvhki-y4a,bindal,birkenes,bjarkoy,xn--bjarky-fya,bjerkreim,bjugn,bodo,xn--bod-2na,badaddja,xn--bdddj-mrabd,budejju,bokn,bremanger,bronnoy,xn--brnny-wuac,bygland,bykle,barum,xn--brum-voa,telemark>bo,xn--b-5ga<nordland>bo,xn--b-5ga,heroy,xn--hery-ira<bievat,xn--bievt-0qa,bomlo,xn--bmlo-gra,batsfjord,xn--btsfjord-9za,bahcavuotna,xn--bhcavuotna-s4a,dovre,drammen,drangedal,dyroy,xn--dyry-ira,donna,xn--dnna-gra,eid,eidfjord,eidsberg,eidskog,eidsvoll,eigersund,elverum,enebakk,engerdal,etne,etnedal,evenes,evenassi,xn--eveni-0qa01ga,evje-og-hornnes,farsund,fauske,fuossko,fuoisku,fedje,fet,finnoy,xn--finny-yua,fitjar,fjaler,fjell,flakstad,flatanger,flekkefjord,flesberg,flora,fla,xn--fl-zia,folldal,forsand,fosnes,frei,frogn,froland,frosta,frana,xn--frna-woa,froya,xn--frya-hra,fusa,fyresdal,forde,xn--frde-gra,gamvik,gangaviika,xn--ggaviika-8ya47h,gaular,gausdal,gildeskal,xn--gildeskl-g0a,giske,gjemnes,gjerdrum,gjerstad,gjesdal,gjovik,xn--gjvik-wua,gloppen,gol,gran,grane,granvin,gratangen,grimstad,grong,kraanghke,xn--kranghke-b0a,grue,gulen,hadsel,halden,halsa,hamar,hamaroy,habmer,xn--hbmer-xqa,hapmir,xn--hpmir-xqa,hammerfest,hammarfeasta,xn--hmmrfeasta-s4ac,haram,hareid,harstad,hasvik,aknoluokta,xn--koluokta-7ya57h,hattfjelldal,aarborte,haugesund,hemne,hemnes,hemsedal,more-og-romsdal>heroy,sande<xn--mre-og-romsdal-qqb>xn--hery-ira,sande<hitra,hjartdal,hjelmeland,hobol,xn--hobl-ira,hof,hol,hole,holmestrand,holtalen,xn--holtlen-hxa,hornindal,horten,hurdal,hurum,hvaler,hyllestad,hagebostad,xn--hgebostad-g3a,hoyanger,xn--hyanger-q1a,hoylandet,xn--hylandet-54a,ha,xn--h-2fa,ibestad,inderoy,xn--indery-fya,iveland,jevnaker,jondal,jolster,xn--jlster-bya,karasjok,karasjohka,xn--krjohka-hwab49j,karlsoy,galsa,xn--gls-elac,karmoy,xn--karmy-yua,kautokeino,guovdageaidnu,klepp,klabu,xn--klbu-woa,kongsberg,kongsvinger,kragero,xn--krager-gya,kristiansand,kristiansund,krodsherad,xn--krdsherad-m8a,kvalsund,rahkkeravju,xn--rhkkervju-01af,kvam,kvinesdal,kvinnherad,kviteseid,kvitsoy,xn--kvitsy-fya,kvafjord,xn--kvfjord-nxa,giehtavuoatna,kvanangen,xn--kvnangen-k0a,navuotna,xn--nvuotna-hwa,kafjord,xn--kfjord-iua,gaivuotna,xn--givuotna-8ya,larvik,lavangen,lavagis,loabat,xn--loabt-0qa,lebesby,davvesiida,leikanger,leirfjord,leka,leksvik,lenvik,leangaviika,xn--leagaviika-52b,lesja,levanger,lier,lierne,lillehammer,lillesand,lindesnes,lindas,xn--linds-pra,lom,loppa,lahppi,xn--lhppi-xqa,lund,lunner,luroy,xn--lury-ira,luster,lyngdal,lyngen,ivgu,lardal,lerdal,xn--lrdal-sra,lodingen,xn--ldingen-q1a,lorenskog,xn--lrenskog-54a,loten,xn--lten-gra,malvik,masoy,xn--msy-ula0h,muosat,xn--muost-0qa,mandal,marker,marnardal,masfjorden,meland,meldal,melhus,meloy,xn--mely-ira,meraker,xn--merker-kua,moareke,xn--moreke-jua,midsund,midtre-gauldal,modalen,modum,molde,moskenes,moss,mosvik,malselv,xn--mlselv-iua,malatvuopmi,xn--mlatvuopmi-s4a,namdalseid,aejrie,namsos,namsskogan,naamesjevuemie,xn--nmesjevuemie-tcba,laakesvuemie,nannestad,narvik,narviika,naustdal,nedre-eiker,akershus>nes<buskerud>nes<nesna,nesodden,nesseby,unjarga,xn--unjrga-rta,nesset,nissedal,nittedal,nord-aurdal,nord-fron,nord-odal,norddal,nordkapp,davvenjarga,xn--davvenjrga-y4a,nordre-land,nordreisa,raisa,xn--risa-5na,nore-og-uvdal,notodden,naroy,xn--nry-yla5g,notteroy,xn--nttery-byae,odda,oksnes,xn--ksnes-uua,oppdal,oppegard,xn--oppegrd-ixa,orkdal,orland,xn--rland-uua,orskog,xn--rskog-uua,orsta,xn--rsta-fra,hedmark>os,valer,xn--vler-qoa<hordaland>os<osen,osteroy,xn--ostery-fya,ostre-toten,xn--stre-toten-zcb,overhalla,ovre-eiker,xn--vre-eiker-k8a,oyer,xn--yer-zna,oygarden,xn--ygarden-p1a,oystre-slidre,xn--ystre-slidre-ujb,porsanger,porsangu,xn--porsgu-sta26f,porsgrunn,radoy,xn--rady-ira,rakkestad,rana,ruovat,randaberg,rauma,rendalen,rennebu,rennesoy,xn--rennesy-v1a,rindal,ringebu,ringerike,ringsaker,rissa,risor,xn--risr-ira,roan,rollag,rygge,ralingen,xn--rlingen-mxa,rodoy,xn--rdy-0nab,romskog,xn--rmskog-bya,roros,xn--rros-gra,rost,xn--rst-0na,royken,xn--ryken-vua,royrvik,xn--ryrvik-bya,rade,xn--rde-ula,salangen,siellak,saltdal,salat,xn--slt-elab,xn--slat-5na,samnanger,vestfold>sande<sandefjord,sandnes,sandoy,xn--sandy-yua,sarpsborg,sauda,sauherad,sel,selbu,selje,seljord,sigdal,siljan,sirdal,skaun,skedsmo,ski,skien,skiptvet,skjervoy,xn--skjervy-v1a,skierva,xn--skierv-uta,skjak,xn--skjk-soa,skodje,skanland,xn--sknland-fxa,skanit,xn--sknit-yqa,smola,xn--smla-hra,snillfjord,snasa,xn--snsa-roa,snoasa,snaase,xn--snase-nra,sogndal,sokndal,sola,solund,songdalen,sortland,spydeberg,stange,stavanger,steigen,steinkjer,stjordal,xn--stjrdal-s1a,stokke,stor-elvdal,stord,stordal,storfjord,omasvuotna,strand,stranda,stryn,sula,suldal,sund,sunndal,surnadal,sveio,svelvik,sykkylven,sogne,xn--sgne-gra,somna,xn--smna-gra,sondre-land,xn--sndre-land-0cb,sor-aurdal,xn--sr-aurdal-l8a,sor-fron,xn--sr-fron-q1a,sor-odal,xn--sr-odal-q1a,sor-varanger,xn--sr-varanger-ggb,matta-varjjat,xn--mtta-vrjjat-k7af,sorfold,xn--srfold-bya,sorreisa,xn--srreisa-q1a,sorum,xn--srum-gra,tana,deatnu,time,tingvoll,tinn,tjeldsund,dielddanuorri,tjome,xn--tjme-hra,tokke,tolga,torsken,tranoy,xn--trany-yua,tromso,xn--troms-zua,tromsa,romsa,trondheim,troandin,trysil,trana,xn--trna-woa,trogstad,xn--trgstad-r1a,tvedestrand,tydal,tynset,tysfjord,divtasvuodna,divttasvuotna,tysnes,tysvar,xn--tysvr-vra,tonsberg,xn--tnsberg-q1a,ullensaker,ullensvang,ulvik,utsira,vadso,xn--vads-jra,cahcesuolo,xn--hcesuolo-7ya35b,vaksdal,valle,vang,vanylven,vardo,xn--vard-jra,varggat,xn--vrggt-xqad,vefsn,vaapste,vega,vegarshei,xn--vegrshei-c0a,vennesla,verdal,verran,vestby,vestnes,vestre-slidre,vestre-toten,vestvagoy,xn--vestvgy-ixa6o,vevelstad,vik,vikna,vindafjord,volda,voss,varoy,xn--vry-yla5g,vagan,xn--vgan-qoa,voagat,vagsoy,xn--vgsy-qoa0j,vaga,xn--vg-yiab,ostfold>valer<xn--stfold-9xa>xn--vler-qoa<<np>*<nr>biz,info,gov,edu,org,net,com<nu,nz>ac,co,cri,geek,gen,govt,health,iwi,kiwi,maori,mil,xn--mori-qsa,net,org,parliament,school<om>co,com,edu,gov,med,museum,net,org,pro<onion,org,pa>ac,gob,com,org,sld,edu,net,ing,abo,med,nom<pe>edu,gob,nom,mil,org,com,net<pf>com,org,edu<pg>*<ph>com,net,org,gov,edu,ngo,mil,i<pk>ac,biz,com,edu,fam,gkp,gob,gog,gok,gon,gop,gos,gov,net,org,web<pl>com,net,org,aid,agro,atm,auto,biz,edu,gmina,gsm,info,mail,miasta,media,mil,nieruchomosci,nom,pc,powiat,priv,realestate,rel,sex,shop,sklep,sos,szkola,targi,tm,tourism,travel,turystyka,gov>ap,griw,ic,is,kmpsp,konsulat,kppsp,kwp,kwpsp,mup,mw,oia,oirm,oke,oow,oschr,oum,pa,pinb,piw,po,pr,psp,psse,pup,rzgw,sa,sdn,sko,so,sr,starostwo,ug,ugim,um,umig,upow,uppo,us,uw,uzs,wif,wiih,winb,wios,witd,wiw,wkz,wsa,wskr,wsse,wuoz,wzmiuw,zp,zpisdn<augustow,babia-gora,bedzin,beskidy,bialowieza,bialystok,bielawa,bieszczady,boleslawiec,bydgoszcz,bytom,cieszyn,czeladz,czest,dlugoleka,elblag,elk,glogow,gniezno,gorlice,grajewo,ilawa,jaworzno,jelenia-gora,jgora,kalisz,kazimierz-dolny,karpacz,kartuzy,kaszuby,katowice,kepno,ketrzyn,klodzko,kobierzyce,kolobrzeg,konin,konskowola,kutno,lapy,lebork,legnica,lezajsk,limanowa,lomza,lowicz,lubin,lukow,malbork,malopolska,mazowsze,mazury,mielec,mielno,mragowo,naklo,nowaruda,nysa,olawa,olecko,olkusz,olsztyn,opoczno,opole,ostroda,ostroleka,ostrowiec,ostrowwlkp,pila,pisz,podhale,podlasie,polkowice,pomorze,pomorskie,prochowice,pruszkow,przeworsk,pulawy,radom,rawa-maz,rybnik,rzeszow,sanok,sejny,slask,slupsk,sosnowiec,stalowa-wola,skoczow,starachowice,stargard,suwalki,swidnica,swiebodzin,swinoujscie,szczecin,szczytno,tarnobrzeg,tgory,turek,tychy,ustka,walbrzych,warmia,warszawa,waw,wegrow,wielun,wlocl,wloclawek,wodzislaw,wolomin,wroclaw,zachpomor,zagan,zarow,zgora,zgorzelec<pm,pn>gov,co,org,edu,net<post,pr>com,net,org,gov,edu,isla,pro,biz,info,name,est,prof,ac<pro>aaa,aca,acct,avocat,bar,cpa,eng,jur,law,med,recht<ps>edu,gov,sec,plo,com,org,net<pt>net,gov,org,edu,int,publ,com,nome<pw>co,ne,or,ed,go,belau<py>com,coop,edu,gov,mil,net,org<qa>com,edu,gov,mil,name,net,org,sch<re>asso,com,nom<ro>arts,com,firm,info,nom,nt,org,rec,store,tm,www<rs>ac,co,edu,gov,in,org<ru,rw>ac,co,coop,gov,mil,net,org<sa>com,net,org,gov,med,pub,edu,sch<sb>com,edu,gov,net,org<sc>com,gov,net,org,edu<sd>com,net,org,edu,med,tv,gov,info<se>a,ac,b,bd,brand,c,d,e,f,fh,fhsk,fhv,g,h,i,k,komforb,kommunalforbund,komvux,l,lanbib,m,n,naturbruksgymn,o,org,p,parti,pp,press,r,s,t,tm,u,w,x,y,z<sg>com,net,org,gov,edu,per<sh>com,net,gov,org,mil<si,sj,sk,sl>com,net,edu,gov,org<sm,sn>art,com,edu,gouv,org,perso,univ<so>com,edu,gov,me,net,org<sr,ss>biz,com,edu,gov,me,net,org,sch<st>co,com,consulado,edu,embaixada,mil,net,org,principe,saotome,store<su,sv>com,edu,gob,org,red<sx>gov<sy>edu,gov,net,mil,com,org<sz>co,ac,org<tc,td,tel,tf,tg,th>ac,co,go,in,mi,net,or<tj>ac,biz,co,com,edu,go,gov,int,mil,name,net,nic,org,test,web<tk,tl>gov<tm>com,co,org,net,nom,gov,mil,edu<tn>com,ens,fin,gov,ind,info,intl,mincom,nat,net,org,perso,tourism<to>com,gov,net,org,edu,mil<tr>av,bbs,bel,biz,com,dr,edu,gen,gov,info,mil,k12,kep,name,net,org,pol,tel,tsk,tv,web,nc>gov<<tt>co,com,org,net,biz,info,pro,int,coop,jobs,mobi,travel,museum,aero,name,gov,edu<tv,tw>edu,gov,mil,com,net,org,idv,game,ebiz,club,xn--zf0ao64a,xn--uc0atv,xn--czrw28b<tz>ac,co,go,hotel,info,me,mil,mobi,ne,or,sc,tv<ua>com,edu,gov,in,net,org,cherkassy,cherkasy,chernigov,chernihiv,chernivtsi,chernovtsy,ck,cn,cr,crimea,cv,dn,dnepropetrovsk,dnipropetrovsk,donetsk,dp,if,ivano-frankivsk,kh,kharkiv,kharkov,kherson,khmelnitskiy,khmelnytskyi,kiev,kirovograd,km,kr,kropyvnytskyi,krym,ks,kv,kyiv,lg,lt,lugansk,luhansk,lutsk,lv,lviv,mk,mykolaiv,nikolaev,od,odesa,odessa,pl,poltava,rivne,rovno,rv,sb,sebastopol,sevastopol,sm,sumy,te,ternopil,uz,uzhgorod,uzhhorod,vinnica,vinnytsia,vn,volyn,yalta,zakarpattia,zaporizhzhe,zaporizhzhia,zhitomir,zhytomyr,zp,zt<ug>co,or,ac,sc,go,ne,com,org<uk>ac,co,gov,ltd,me,net,nhs,org,plc,police,sch>*<<us>dni,fed,isa,kids,nsn,ak>k12,cc,lib<al>k12,cc,lib<ar>k12,cc,lib<as>k12,cc,lib<az>k12,cc,lib<ca>k12,cc,lib<co>k12,cc,lib<ct>k12,cc,lib<dc>k12,cc,lib<de>cc<fl>k12,cc,lib<ga>k12,cc,lib<gu>k12,cc,lib<hi>cc,lib<ia>k12,cc,lib<id>k12,cc,lib<il>k12,cc,lib<in>k12,cc,lib<ks>k12,cc,lib<ky>k12,cc,lib<la>k12,cc,lib<ma>k12>pvt,chtr,paroch<cc,lib<md>k12,cc,lib<me>k12,cc,lib<mi>k12,cc,lib,ann-arbor,cog,dst,eaton,gen,mus,tec,washtenaw<mn>k12,cc,lib<mo>k12,cc,lib<ms>k12,cc,lib<mt>k12,cc,lib<nc>k12,cc,lib<nd>cc,lib<ne>k12,cc,lib<nh>k12,cc,lib<nj>k12,cc,lib<nm>k12,cc,lib<nv>k12,cc,lib<ny>k12,cc,lib<oh>k12,cc,lib<ok>k12,cc,lib<or>k12,cc,lib<pa>k12,cc,lib<pr>k12,cc,lib<ri>cc,lib<sc>k12,cc,lib<sd>cc,lib<tn>k12,cc,lib<tx>k12,cc,lib<ut>k12,cc,lib<vi>k12,cc,lib<vt>k12,cc,lib<va>k12,cc,lib<wa>k12,cc,lib<wi>k12,cc,lib<wv>cc<wy>k12,cc,lib<<uy>com,edu,gub,mil,net,org<uz>co,com,net,org<va,vc>com,net,org,gov,mil,edu<ve>arts,bib,co,com,e12,edu,firm,gob,gov,info,int,mil,net,nom,org,rar,rec,store,tec,web<vg,vi>co,com,k12,net,org<vn>ac,ai,biz,com,edu,gov,health,id,info,int,io,name,net,org,pro,angiang,bacgiang,backan,baclieu,bacninh,baria-vungtau,bentre,binhdinh,binhduong,binhphuoc,binhthuan,camau,cantho,caobang,daklak,daknong,danang,dienbien,dongnai,dongthap,gialai,hagiang,haiduong,haiphong,hanam,hanoi,hatinh,haugiang,hoabinh,hungyen,khanhhoa,kiengiang,kontum,laichau,lamdong,langson,laocai,longan,namdinh,nghean,ninhbinh,ninhthuan,phutho,phuyen,quangbinh,quangnam,quangngai,quangninh,quangtri,soctrang,sonla,tayninh,thaibinh,thainguyen,thanhhoa,thanhphohochiminh,thuathienhue,tiengiang,travinh,tuyenquang,vinhlong,vinhphuc,yenbai<vu>com,edu,net,org<wf,ws>com,net,org,gov,edu<yt,xn--mgbaam7a8h,xn--y9a3aq,xn--54b7fta0cc,xn--90ae,xn--mgbcpq6gpa1a,xn--90ais,xn--fiqs8s,xn--fiqz9s,xn--lgbbat1ad8j,xn--wgbh1c,xn--e1a4c,xn--qxa6a,xn--mgbah1a3hjkrd,xn--node,xn--qxam,xn--j6w193g>xn--55qx5d,xn--wcvs22d,xn--mxtq1m,xn--gmqw5a,xn--od0alg,xn--uc0atv<xn--2scrj9c,xn--3hcrj9c,xn--45br5cyl,xn--h2breg3eve,xn--h2brj9c8c,xn--mgbgu82a,xn--rvc1e0am3e,xn--h2brj9c,xn--mgbbh1a,xn--mgbbh1a71e,xn--fpcrj9c3d,xn--gecrj9c,xn--s9brj9c,xn--45brj9c,xn--xkc2dl3a5ee0h,xn--mgba3a4f16a,xn--mgba3a4fra,xn--mgbtx2b,xn--mgbayh7gpa,xn--3e0b707e,xn--80ao21a,xn--q7ce6a,xn--fzc2c9e2c,xn--xkc2al3hye2a,xn--mgbc0a9azcg,xn--d1alf,xn--l1acc,xn--mix891f,xn--mix082f,xn--mgbx4cd0ab,xn--mgb9awbf,xn--mgbai9azgqp6j,xn--mgbai9a5eva00b,xn--ygbi2ammx,xn--90a3ac>xn--o1ac,xn--c1avg,xn--90azh,xn--d1at,xn--o1ach,xn--80au<xn--p1ai,xn--wgbl6a,xn--mgberp4a5d4ar,xn--mgberp4a5d4a87g,xn--mgbqly7c0a67fbc,xn--mgbqly7cvafr,xn--mgbpl2fh,xn--yfro4i67o,xn--clchc0ea0b2g2a9gcd,xn--ogbpf8fl,xn--mgbtf8fl,xn--o3cw4h>xn--12c1fe0br,xn--12co0c3b4eva,xn--h3cuzk1di,xn--o3cyx2a,xn--m3ch0j3a,xn--12cfi8ixb8l<xn--pgbs0dh,xn--kpry57d,xn--kprw13d,xn--nnx388a,xn--j1amh,xn--mgb2ddes,xxx,ye>com,edu,gov,net,mil,org<za>ac,agric,alt,co,edu,gov,grondar,law,mil,net,ngo,nic,nis,nom,org,school,tm,web<zm>ac,biz,co,com,edu,gov,info,mil,net,org,sch<zw>ac,co,gov,mil,org<aaa,aarp,abb,abbott,abbvie,abc,able,abogado,abudhabi,academy,accenture,accountant,accountants,aco,actor,ads,adult,aeg,aetna,afl,africa,agakhan,agency,aig,airbus,airforce,airtel,akdn,alibaba,alipay,allfinanz,allstate,ally,alsace,alstom,amazon,americanexpress,americanfamily,amex,amfam,amica,amsterdam,analytics,android,anquan,anz,aol,apartments,app,apple,aquarelle,arab,aramco,archi,army,art,arte,asda,associates,athleta,attorney,auction,audi,audible,audio,auspost,author,auto,autos,aws,axa,azure,baby,baidu,banamex,band,bank,bar,barcelona,barclaycard,barclays,barefoot,bargains,baseball,basketball,bauhaus,bayern,bbc,bbt,bbva,bcg,bcn,beats,beauty,beer,bentley,berlin,best,bestbuy,bet,bharti,bible,bid,bike,bing,bingo,bio,black,blackfriday,blockbuster,blog,bloomberg,blue,bms,bmw,bnpparibas,boats,boehringer,bofa,bom,bond,boo,book,booking,bosch,bostik,boston,bot,boutique,box,bradesco,bridgestone,broadway,broker,brother,brussels,build,builders,business,buy,buzz,bzh,cab,cafe,cal,call,calvinklein,cam,camera,camp,canon,capetown,capital,capitalone,car,caravan,cards,care,career,careers,cars,casa,case,cash,casino,catering,catholic,cba,cbn,cbre,center,ceo,cern,cfa,cfd,chanel,channel,charity,chase,chat,cheap,chintai,christmas,chrome,church,cipriani,circle,cisco,citadel,citi,citic,city,claims,cleaning,click,clinic,clinique,clothing,cloud,club,clubmed,coach,codes,coffee,college,cologne,commbank,community,company,compare,computer,comsec,condos,construction,consulting,contact,contractors,cooking,cool,corsica,country,coupon,coupons,courses,cpa,credit,creditcard,creditunion,cricket,crown,crs,cruise,cruises,cuisinella,cymru,cyou,dabur,dad,dance,data,date,dating,datsun,day,dclk,dds,deal,dealer,deals,degree,delivery,dell,deloitte,delta,democrat,dental,dentist,desi,design,dev,dhl,diamonds,diet,digital,direct,directory,discount,discover,dish,diy,dnp,docs,doctor,dog,domains,dot,download,drive,dtv,dubai,dunlop,dupont,durban,dvag,dvr,earth,eat,eco,edeka,education,email,emerck,energy,engineer,engineering,enterprises,epson,equipment,ericsson,erni,esq,estate,eurovision,eus,events,exchange,expert,exposed,express,extraspace,fage,fail,fairwinds,faith,family,fan,fans,farm,farmers,fashion,fast,fedex,feedback,ferrari,ferrero,fidelity,fido,film,final,finance,financial,fire,firestone,firmdale,fish,fishing,fit,fitness,flickr,flights,flir,florist,flowers,fly,foo,food,football,ford,forex,forsale,forum,foundation,fox,free,fresenius,frl,frogans,frontier,ftr,fujitsu,fun,fund,furniture,futbol,fyi,gal,gallery,gallo,gallup,game,games,gap,garden,gay,gbiz,gdn,gea,gent,genting,george,ggee,gift,gifts,gives,giving,glass,gle,global,globo,gmail,gmbh,gmo,gmx,godaddy,gold,goldpoint,golf,goo,goodyear,goog,google,gop,got,grainger,graphics,gratis,green,gripe,grocery,group,gucci,guge,guide,guitars,guru,hair,hamburg,hangout,haus,hbo,hdfc,hdfcbank,health,healthcare,help,helsinki,here,hermes,hiphop,hisamitsu,hitachi,hiv,hkt,hockey,holdings,holiday,homedepot,homegoods,homes,homesense,honda,horse,hospital,host,hosting,hot,hotels,hotmail,house,how,hsbc,hughes,hyatt,hyundai,ibm,icbc,ice,icu,ieee,ifm,ikano,imamat,imdb,immo,immobilien,inc,industries,infiniti,ing,ink,institute,insurance,insure,international,intuit,investments,ipiranga,irish,ismaili,ist,istanbul,itau,itv,jaguar,java,jcb,jeep,jetzt,jewelry,jio,jll,jmp,jnj,joburg,jot,joy,jpmorgan,jprs,juegos,juniper,kaufen,kddi,kerryhotels,kerrylogistics,kerryproperties,kfh,kia,kids,kim,kindle,kitchen,kiwi,koeln,komatsu,kosher,kpmg,kpn,krd,kred,kuokgroup,kyoto,lacaixa,lamborghini,lamer,lancaster,land,landrover,lanxess,lasalle,lat,latino,latrobe,law,lawyer,lds,lease,leclerc,lefrak,legal,lego,lexus,lgbt,lidl,life,lifeinsurance,lifestyle,lighting,like,lilly,limited,limo,lincoln,link,lipsy,live,living,llc,llp,loan,loans,locker,locus,lol,london,lotte,lotto,love,lpl,lplfinancial,ltd,ltda,lundbeck,luxe,luxury,madrid,maif,maison,makeup,man,management,mango,map,market,marketing,markets,marriott,marshalls,mattel,mba,mckinsey,med,media,meet,melbourne,meme,memorial,men,menu,merckmsd,miami,microsoft,mini,mint,mit,mitsubishi,mlb,mls,mma,mobile,moda,moe,moi,mom,monash,money,monster,mormon,mortgage,moscow,moto,motorcycles,mov,movie,msd,mtn,mtr,music,nab,nagoya,navy,nba,nec,netbank,netflix,network,neustar,new,news,next,nextdirect,nexus,nfl,ngo,nhk,nico,nike,nikon,ninja,nissan,nissay,nokia,norton,now,nowruz,nowtv,nra,nrw,ntt,nyc,obi,observer,office,okinawa,olayan,olayangroup,ollo,omega,one,ong,onl,online,ooo,open,oracle,orange,organic,origins,osaka,otsuka,ott,ovh,page,panasonic,paris,pars,partners,parts,party,pay,pccw,pet,pfizer,pharmacy,phd,philips,phone,photo,photography,photos,physio,pics,pictet,pictures,pid,pin,ping,pink,pioneer,pizza,place,play,playstation,plumbing,plus,pnc,pohl,poker,politie,porn,pramerica,praxi,press,prime,prod,productions,prof,progressive,promo,properties,property,protection,pru,prudential,pub,pwc,qpon,quebec,quest,racing,radio,read,realestate,realtor,realty,recipes,red,redstone,redumbrella,rehab,reise,reisen,reit,reliance,ren,rent,rentals,repair,report,republican,rest,restaurant,review,reviews,rexroth,rich,richardli,ricoh,ril,rio,rip,rocks,rodeo,rogers,room,rsvp,rugby,ruhr,run,rwe,ryukyu,saarland,safe,safety,sakura,sale,salon,samsclub,samsung,sandvik,sandvikcoromant,sanofi,sap,sarl,sas,save,saxo,sbi,sbs,scb,schaeffler,schmidt,scholarships,school,schule,schwarz,science,scot,search,seat,secure,security,seek,select,sener,services,seven,sew,sex,sexy,sfr,shangrila,sharp,shell,shia,shiksha,shoes,shop,shopping,shouji,show,silk,sina,singles,site,ski,skin,sky,skype,sling,smart,smile,sncf,soccer,social,softbank,software,sohu,solar,solutions,song,sony,soy,spa,space,sport,spot,srl,stada,staples,star,statebank,statefarm,stc,stcgroup,stockholm,storage,store,stream,studio,study,style,sucks,supplies,supply,support,surf,surgery,suzuki,swatch,swiss,sydney,systems,tab,taipei,talk,taobao,target,tatamotors,tatar,tattoo,tax,taxi,tci,tdk,team,tech,technology,temasek,tennis,teva,thd,theater,theatre,tiaa,tickets,tienda,tips,tires,tirol,tjmaxx,tjx,tkmaxx,tmall,today,tokyo,tools,top,toray,toshiba,total,tours,town,toyota,toys,trade,trading,training,travel,travelers,travelersinsurance,trust,trv,tube,tui,tunes,tushu,tvs,ubank,ubs,unicom,university,uno,uol,ups,vacations,vana,vanguard,vegas,ventures,verisign,versicherung,vet,viajes,video,vig,viking,villas,vin,vip,virgin,visa,vision,viva,vivo,vlaanderen,vodka,volvo,vote,voting,voto,voyage,wales,walmart,walter,wang,wanggou,watch,watches,weather,weatherchannel,webcam,weber,website,wed,wedding,weibo,weir,whoswho,wien,wiki,williamhill,win,windows,wine,winners,wme,wolterskluwer,woodside,work,works,world,wow,wtc,wtf,xbox,xerox,xihuan,xin,xn--11b4c3d,xn--1ck2e1b,xn--1qqw23a,xn--30rr7y,xn--3bst00m,xn--3ds443g,xn--3pxu8k,xn--42c2d9a,xn--45q11c,xn--4gbrim,xn--55qw42g,xn--55qx5d,xn--5su34j936bgsg,xn--5tzm5g,xn--6frz82g,xn--6qq986b3xl,xn--80adxhks,xn--80aqecdr1a,xn--80asehdb,xn--80aswg,xn--8y0a063a,xn--9dbq2a,xn--9et52u,xn--9krt00a,xn--b4w605ferd,xn--bck1b9a5dre4c,xn--c1avg,xn--c2br7g,xn--cck2b3b,xn--cckwcxetd,xn--cg4bki,xn--czr694b,xn--czrs0t,xn--czru2d,xn--d1acj3b,xn--eckvdtc9d,xn--efvy88h,xn--fct429k,xn--fhbei,xn--fiq228c5hs,xn--fiq64b,xn--fjq720a,xn--flw351e,xn--fzys8d69uvgm,xn--g2xx48c,xn--gckr3f0f,xn--gk3at1e,xn--hxt814e,xn--i1b6b1a6a2e,xn--imr513n,xn--io0a7i,xn--j1aef,xn--jlq480n2rg,xn--jvr189m,xn--kcrx77d1x4a,xn--kput3i,xn--mgba3a3ejt,xn--mgba7c0bbn0a,xn--mgbab2bd,xn--mgbca7dzdo,xn--mgbi4ecexp,xn--mgbt3dhd,xn--mk1bu44c,xn--mxtq1m,xn--ngbc5azd,xn--ngbe9e0a,xn--ngbrx,xn--nqv7f,xn--nqv7fs00ema,xn--nyqy26a,xn--otu796d,xn--p1acf,xn--pssy2u,xn--q9jyb4c,xn--qcka1pmc,xn--rhqv96g,xn--rovu88b,xn--ses554g,xn--t60b56a,xn--tckwe,xn--tiq49xqyj,xn--unup4y,xn--vermgensberater-ctb,xn--vermgensberatung-pwb,xn--vhquv,xn--vuq861b,xn--w4r85el8fhu5dnra,xn--w4rs40l,xn--xhq521b,xn--zfr164b,xyz,yachts,yahoo,yamaxun,yandex,yodobashi,yoga,yokohama,you,youtube,yun,zappos,zara,zero,zip,zone,zuerich"),p=null!=p?p:eK("krd>co,edu<pl>art,gliwice,krakow,poznan,wroc,zakopane,beep,ecommerce-shop,cfolks,dfirma,dkonto,you2,shoparena,homesklep,sdscloud,unicloud,krasnik,leczna,lubartow,lublin,poniatowa,swidnik,co,torun,simplesite,myspreadshop,gda,gdansk,gdynia,med,sopot,bielsko<us>de>lib<cloudns,drud,is-by,land-4-sale,stuff-4-sale,heliohost,enscaled>phx<mircloud,ngo,golffan,noip,pointto,freeddns,srv>gh,gl<platterp,servername<dev>12chars,panel,autocode,lcl>*<lclstage>*<stg>*<stgstage>*<pages,r2,workers,curv,deno,deno-staging,deta,evervault>relay<fly,githubpreview,gateway>*<is-a,iserv,runcontainers,localcert>user>*<<loginline,barsy,mediatech,modx,ngrok,ngrok-free,is-cool,is-not-a,localplayer,xmit,platter-app,replit>archer,bones,canary,global,hacker,id,janeway,kim,kira,kirk,odo,paris,picard,pike,prerelease,reed,riker,sisko,spock,staging,sulu,tarpit,teams,tucker,wesley,worf<crm>d>*<w>*<wa>*<wb>*<wc>*<wd>*<we>*<wf>*<<vercel,webhare>*<<it>12chars,blogspot,ibxos,iliadboxos,neen>jc<tim>open>jelastic>cloud<<<16-b,32-b,64-b,123homepage,myspreadshop,syncloud<pro>12chars,cloudns,dnstrace>bci<barsy,ngrok<ua>cc,inf,ltd,cx,ie,biz,co,pp,v<to>611,oya,x0,quickconnect>direct<vpnplus<com>a2hosted,cpserver,adobeaemcloud>dev>*<<africa,airkitapps,airkitapps-au,aivencloud,kasserver,amazonaws>af-south-1>execute-api,emrappui-prod,emrnotebooks-prod,emrstudio-prod,dualstack>s3,s3-accesspoint,s3-website<s3,s3-accesspoint,s3-object-lambda,s3-website,aws-cloud9>webview-assets<cloud9>vfs,webview-assets<<ap-east-1>execute-api,emrappui-prod,emrnotebooks-prod,emrstudio-prod,dualstack>s3,s3-accesspoint<s3,s3-accesspoint,s3-object-lambda,s3-website,aws-cloud9>webview-assets<cloud9>vfs,webview-assets<<ap-northeast-1>execute-api,emrappui-prod,emrnotebooks-prod,emrstudio-prod,dualstack>s3,s3-accesspoint,s3-website<s3,s3-accesspoint,s3-object-lambda,s3-website,analytics-gateway,aws-cloud9>webview-assets<cloud9>vfs,webview-assets<<ap-northeast-2>execute-api,emrappui-prod,emrnotebooks-prod,emrstudio-prod,dualstack>s3,s3-accesspoint,s3-website<s3,s3-accesspoint,s3-object-lambda,s3-website,analytics-gateway,aws-cloud9>webview-assets<cloud9>vfs,webview-assets<<ap-northeast-3>execute-api,emrappui-prod,emrnotebooks-prod,emrstudio-prod,dualstack>s3,s3-accesspoint,s3-website<s3,s3-accesspoint,s3-object-lambda,s3-website,aws-cloud9>webview-assets<cloud9>vfs,webview-assets<<ap-south-1>execute-api,emrappui-prod,emrnotebooks-prod,emrstudio-prod,dualstack>s3,s3-accesspoint,s3-website<s3,s3-accesspoint,s3-object-lambda,s3-website,analytics-gateway,aws-cloud9>webview-assets<cloud9>vfs,webview-assets<<ap-south-2>execute-api,emrappui-prod,emrnotebooks-prod,emrstudio-prod,dualstack>s3,s3-accesspoint<s3,s3-accesspoint,s3-object-lambda,s3-website<ap-southeast-1>execute-api,emrappui-prod,emrnotebooks-prod,emrstudio-prod,dualstack>s3,s3-accesspoint,s3-website<s3,s3-accesspoint,s3-object-lambda,s3-website,analytics-gateway,aws-cloud9>webview-assets<cloud9>vfs,webview-assets<<ap-southeast-2>execute-api,emrappui-prod,emrnotebooks-prod,emrstudio-prod,dualstack>s3,s3-accesspoint,s3-website<s3,s3-accesspoint,s3-object-lambda,s3-website,analytics-gateway,aws-cloud9>webview-assets<cloud9>vfs,webview-assets<<ap-southeast-3>execute-api,emrappui-prod,emrnotebooks-prod,emrstudio-prod,dualstack>s3,s3-accesspoint<s3,s3-accesspoint,s3-object-lambda,s3-website<ap-southeast-4>execute-api,emrappui-prod,emrnotebooks-prod,emrstudio-prod,dualstack>s3,s3-accesspoint<s3,s3-accesspoint,s3-object-lambda,s3-website<ca-central-1>execute-api,emrappui-prod,emrnotebooks-prod,emrstudio-prod,dualstack>s3,s3-accesspoint,s3-accesspoint-fips,s3-fips,s3-website<s3,s3-accesspoint,s3-accesspoint-fips,s3-fips,s3-object-lambda,s3-website,aws-cloud9>webview-assets<cloud9>vfs,webview-assets<<ca-west-1>execute-api,emrappui-prod,emrnotebooks-prod,emrstudio-prod,dualstack>s3,s3-accesspoint,s3-accesspoint-fips,s3-fips,s3-website<s3,s3-accesspoint,s3-accesspoint-fips,s3-fips,s3-website<eu-central-1>execute-api,emrappui-prod,emrnotebooks-prod,emrstudio-prod,dualstack>s3,s3-accesspoint,s3-website<s3,s3-accesspoint,s3-object-lambda,s3-website,analytics-gateway,aws-cloud9>webview-assets<cloud9>vfs,webview-assets<<eu-central-2>execute-api,emrappui-prod,emrnotebooks-prod,emrstudio-prod,dualstack>s3,s3-accesspoint<s3,s3-accesspoint,s3-object-lambda,s3-website<eu-north-1>execute-api,emrappui-prod,emrnotebooks-prod,emrstudio-prod,dualstack>s3,s3-accesspoint<s3,s3-accesspoint,s3-object-lambda,s3-website,aws-cloud9>webview-assets<cloud9>vfs,webview-assets<<eu-south-1>execute-api,emrappui-prod,emrnotebooks-prod,emrstudio-prod,dualstack>s3,s3-accesspoint,s3-website<s3,s3-accesspoint,s3-object-lambda,s3-website,aws-cloud9>webview-assets<cloud9>vfs,webview-assets<<eu-south-2>execute-api,emrappui-prod,emrnotebooks-prod,emrstudio-prod,dualstack>s3,s3-accesspoint<s3,s3-accesspoint,s3-object-lambda,s3-website<eu-west-1>execute-api,emrappui-prod,emrnotebooks-prod,emrstudio-prod,dualstack>s3,s3-accesspoint,s3-website<s3,s3-accesspoint,s3-deprecated,s3-object-lambda,s3-website,analytics-gateway,aws-cloud9>webview-assets<cloud9>vfs,webview-assets<<eu-west-2>execute-api,emrappui-prod,emrnotebooks-prod,emrstudio-prod,dualstack>s3,s3-accesspoint<s3,s3-accesspoint,s3-object-lambda,s3-website,aws-cloud9>webview-assets<cloud9>vfs,webview-assets<<eu-west-3>execute-api,emrappui-prod,emrnotebooks-prod,emrstudio-prod,dualstack>s3,s3-accesspoint,s3-website<s3,s3-accesspoint,s3-object-lambda,s3-website,aws-cloud9>webview-assets<cloud9>vfs,webview-assets<<il-central-1>execute-api,emrappui-prod,emrnotebooks-prod,emrstudio-prod,dualstack>s3,s3-accesspoint<s3,s3-accesspoint,s3-object-lambda,s3-website,aws-cloud9>webview-assets<cloud9>vfs<<me-central-1>execute-api,emrappui-prod,emrnotebooks-prod,emrstudio-prod,dualstack>s3,s3-accesspoint<s3,s3-accesspoint,s3-object-lambda,s3-website<me-south-1>execute-api,emrappui-prod,emrnotebooks-prod,emrstudio-prod,dualstack>s3,s3-accesspoint<s3,s3-accesspoint,s3-object-lambda,s3-website,aws-cloud9>webview-assets<cloud9>vfs,webview-assets<<sa-east-1>execute-api,emrappui-prod,emrnotebooks-prod,emrstudio-prod,dualstack>s3,s3-accesspoint,s3-website<s3,s3-accesspoint,s3-object-lambda,s3-website,aws-cloud9>webview-assets<cloud9>vfs,webview-assets<<us-east-1>execute-api,emrappui-prod,emrnotebooks-prod,emrstudio-prod,dualstack>s3,s3-accesspoint,s3-accesspoint-fips,s3-fips,s3-website<s3,s3-accesspoint,s3-accesspoint-fips,s3-deprecated,s3-fips,s3-object-lambda,s3-website,analytics-gateway,aws-cloud9>webview-assets<cloud9>vfs,webview-assets<<us-east-2>execute-api,emrappui-prod,emrnotebooks-prod,emrstudio-prod,dualstack>s3,s3-accesspoint,s3-accesspoint-fips,s3-fips<s3,s3-accesspoint,s3-accesspoint-fips,s3-deprecated,s3-fips,s3-object-lambda,s3-website,analytics-gateway,aws-cloud9>webview-assets<cloud9>vfs,webview-assets<<us-gov-east-1>execute-api,emrappui-prod,emrnotebooks-prod,emrstudio-prod,dualstack>s3,s3-accesspoint,s3-accesspoint-fips,s3-fips<s3,s3-accesspoint,s3-accesspoint-fips,s3-fips,s3-object-lambda,s3-website<us-gov-west-1>execute-api,emrappui-prod,emrnotebooks-prod,emrstudio-prod,dualstack>s3,s3-accesspoint,s3-accesspoint-fips,s3-fips<s3,s3-accesspoint,s3-accesspoint-fips,s3-fips,s3-object-lambda,s3-website<us-west-1>execute-api,emrappui-prod,emrnotebooks-prod,emrstudio-prod,dualstack>s3,s3-accesspoint,s3-accesspoint-fips,s3-fips,s3-website<s3,s3-accesspoint,s3-accesspoint-fips,s3-fips,s3-object-lambda,s3-website,aws-cloud9>webview-assets<cloud9>vfs,webview-assets<<us-west-2>execute-api,emrappui-prod,emrnotebooks-prod,emrstudio-prod,dualstack>s3,s3-accesspoint,s3-accesspoint-fips,s3-fips,s3-website<s3,s3-accesspoint,s3-accesspoint-fips,s3-deprecated,s3-fips,s3-object-lambda,s3-website,analytics-gateway,aws-cloud9>webview-assets<cloud9>vfs,webview-assets<<compute>*<compute-1>*<airflow>af-south-1>*<ap-east-1>*<ap-northeast-1>*<ap-northeast-2>*<ap-northeast-3>*<ap-south-1>*<ap-south-2>*<ap-southeast-1>*<ap-southeast-2>*<ap-southeast-3>*<ap-southeast-4>*<ca-central-1>*<ca-west-1>*<eu-central-1>*<eu-central-2>*<eu-north-1>*<eu-south-1>*<eu-south-2>*<eu-west-1>*<eu-west-2>*<eu-west-3>*<il-central-1>*<me-central-1>*<me-south-1>*<sa-east-1>*<us-east-1>*<us-east-2>*<us-west-1>*<us-west-2>*<<s3,s3-1,s3-ap-east-1,s3-ap-northeast-1,s3-ap-northeast-2,s3-ap-northeast-3,s3-ap-south-1,s3-ap-southeast-1,s3-ap-southeast-2,s3-ca-central-1,s3-eu-central-1,s3-eu-north-1,s3-eu-west-1,s3-eu-west-2,s3-eu-west-3,s3-external-1,s3-fips-us-gov-east-1,s3-fips-us-gov-west-1,s3-global>accesspoint>mrap<<s3-me-south-1,s3-sa-east-1,s3-us-east-2,s3-us-gov-east-1,s3-us-gov-west-1,s3-us-west-1,s3-us-west-2,s3-website-ap-northeast-1,s3-website-ap-southeast-1,s3-website-ap-southeast-2,s3-website-eu-west-1,s3-website-sa-east-1,s3-website-us-east-1,s3-website-us-gov-west-1,s3-website-us-west-1,s3-website-us-west-2,elb>*<<amazoncognito>af-south-1>auth<ap-east-1>auth<ap-northeast-1>auth<ap-northeast-2>auth<ap-northeast-3>auth<ap-south-1>auth<ap-south-2>auth<ap-southeast-1>auth<ap-southeast-2>auth<ap-southeast-3>auth<ap-southeast-4>auth<ca-central-1>auth<ca-west-1>auth<eu-central-1>auth<eu-central-2>auth<eu-north-1>auth<eu-south-1>auth<eu-south-2>auth<eu-west-1>auth<eu-west-2>auth<eu-west-3>auth<il-central-1>auth<me-central-1>auth<me-south-1>auth<sa-east-1>auth<us-east-1>auth,auth-fips<us-east-2>auth,auth-fips<us-gov-west-1>auth-fips<us-west-1>auth,auth-fips<us-west-2>auth,auth-fips<<amplifyapp,awsapprunner>*<awsapps,elasticbeanstalk>af-south-1,ap-east-1,ap-northeast-1,ap-northeast-2,ap-northeast-3,ap-south-1,ap-southeast-1,ap-southeast-2,ap-southeast-3,ca-central-1,eu-central-1,eu-north-1,eu-south-1,eu-west-1,eu-west-2,eu-west-3,il-central-1,me-south-1,sa-east-1,us-east-1,us-east-2,us-gov-east-1,us-gov-west-1,us-west-1,us-west-2<awsglobalaccelerator,siiites,appspacehosted,appspaceusercontent,on-aptible,myasustor,balena-devices,betainabox,boutir,bplaced,cafjs,canva-apps,cdn77-storage,br,cn,de,eu,jpn,mex,ru,sa,uk,us,za,clever-cloud>services>*<<dnsabr,jdevcloud,wpdevcloud,cf-ipfs,cloudflare-ipfs,trycloudflare,co,customer-oci>*,oci>*<ocp>*<ocs>*<<builtwithdark,datadetect>demo,instance<dattolocal,dattorelay,dattoweb,mydatto,ddns5,digitaloceanspaces>*<discordsays,discordsez,drayddns,dreamhosters,durumis,mydrobo,blogdns,cechire,dnsalias,dnsdojo,doesntexist,dontexist,doomdns,dyn-o-saur,dynalias,dyndns-at-home,dyndns-at-work,dyndns-blog,dyndns-free,dyndns-home,dyndns-ip,dyndns-mail,dyndns-office,dyndns-pics,dyndns-remote,dyndns-server,dyndns-web,dyndns-wiki,dyndns-work,est-a-la-maison,est-a-la-masion,est-le-patron,est-mon-blogueur,from-ak,from-al,from-ar,from-ca,from-ct,from-dc,from-de,from-fl,from-ga,from-hi,from-ia,from-id,from-il,from-in,from-ks,from-ky,from-ma,from-md,from-mi,from-mn,from-mo,from-ms,from-mt,from-nc,from-nd,from-ne,from-nh,from-nj,from-nm,from-nv,from-oh,from-ok,from-or,from-pa,from-pr,from-ri,from-sc,from-sd,from-tn,from-tx,from-ut,from-va,from-vt,from-wa,from-wi,from-wv,from-wy,getmyip,gotdns,hobby-site,homelinux,homeunix,iamallama,is-a-anarchist,is-a-blogger,is-a-bookkeeper,is-a-bulls-fan,is-a-caterer,is-a-chef,is-a-conservative,is-a-cpa,is-a-cubicle-slave,is-a-democrat,is-a-designer,is-a-doctor,is-a-financialadvisor,is-a-geek,is-a-green,is-a-guru,is-a-hard-worker,is-a-hunter,is-a-landscaper,is-a-lawyer,is-a-liberal,is-a-libertarian,is-a-llama,is-a-musician,is-a-nascarfan,is-a-nurse,is-a-painter,is-a-personaltrainer,is-a-photographer,is-a-player,is-a-republican,is-a-rockstar,is-a-socialist,is-a-student,is-a-teacher,is-a-techie,is-a-therapist,is-an-accountant,is-an-actor,is-an-actress,is-an-anarchist,is-an-artist,is-an-engineer,is-an-entertainer,is-certified,is-gone,is-into-anime,is-into-cars,is-into-cartoons,is-into-games,is-leet,is-not-certified,is-slick,is-uberleet,is-with-theband,isa-geek,isa-hockeynut,issmarterthanyou,likes-pie,likescandy,neat-url,saves-the-whales,selfip,sells-for-less,sells-for-u,servebbs,simple-url,space-to-rent,teaches-yoga,writesthisblog,ddnsfree,ddnsgeek,giize,gleeze,kozow,loseyourip,ooguy,theworkpc,mytuleap,tuleap-partners,encoreapi,evennode>eu-1,eu-2,eu-3,eu-4,us-1,us-2,us-3,us-4<onfabrica,fastly-edge,fastly-terrarium,fastvps-server,mydobiss,firebaseapp,fldrv,forgeblocks,framercanvas,freebox-os,freeboxos,freemyip,aliases121,gentapps,gentlentapis,githubusercontent,0emm>*<appspot>r>*<<blogspot,codespot,googleapis,googlecode,pagespeedmobilizer,publishproxy,withgoogle,withyoutube,grayjayleagues,hatenablog,hatenadiary,herokuapp,herokussl,gr,smushcdn,wphostedmail,wpmucdn,pixolino,apps-1and1,live-website,amscompute,dopaas,hosted-by-previder>paas<hosteur>rag-cloud,rag-cloud-ch<ik-server>jcloud,jcloud-ver-jpc<jelastic>demo<kilatiron,massivegrid>paas<wafaicloud>jed,lon,ryd<webadorsite,joyent>cns>*<<ktistory,lpusercontent,linode>members,nodebalancer>*<<linodeobjects>*<linodeusercontent>ip<barsycenter,barsyonline,mazeplay,miniserver,atmeta,fbsbx>apps<meteorapp>eu<hostedpi,mythic-beasts>caracal,customer,fentiger,lynx,ocelot,oncilla,onza,sphinx,vs,x,yali<nospamproxy>cloud<4u,nfshost,ar,hu,kr,no,qc,uy,3utilities,blogsyte,ciscofreak,damnserver,ddnsking,ditchyourip,dnsiskinky,dynns,geekgalaxy,health-carereform,homesecuritymac,homesecuritypc,myactivedirectory,mysecuritycamera,myvnc,net-freaks,onthewifi,point2this,quicksytes,securitytactics,servebeer,servecounterstrike,serveexchange,serveftp,servegame,servehalflife,servehttp,servehumour,serveirc,servemp3,servep2p,servepics,servequake,servesarcasm,stufftoread,unusualperson,workisboring,001www,ddnslive,myiphost,observableusercontent>static<simplesite,orsites,operaunite,authgear-staging,authgearapps,skygearapp,outsystemscloud,ownprovider,pgfog,pagexl,gotpantheon,paywhirl>*<upsunapp,platter-app,postman-echo,prgmr>xen<pythonanywhere>eu<qa2,alpha-myqnapcloud,dev-myqnapcloud,mycloudnas,mynascloud,myqnapcloud,qualifioapp,ladesk,qbuser,quipelements>*<rackmaze,rhcloud,onrender,render>app<180r,dojin,sakuratan,sakuraweb,x0,code>builder>*<dev-builder>*<stg-builder>*<<salesforce>platform>code-builder-stg>test>001>*<<<<<logoip,scrysec,firewall-gateway,myshopblocks,myshopify,shopitsite,1kapp,appchizi,applinzi,sinaapp,vipsinaapp,bounty-full>alpha,beta<streamlitapp,try-snowplow,playstation-cloud,myspreadshop,w-corp-staticblitz,w-credentialless-staticblitz,w-staticblitz,stackhero-network,stdlib>api<strapiapp>media<streak-link,streaklinks,streakusercontent,temp-dns,dsmynas,familyds,mytabit,tb-hosting>site<reservd,thingdustdata,bloxcms,townnews-staging,typeform>pro<hk,it,vultrobjects>*<wafflecell,hotelwithflight,reserve-online,cprapid,pleskns,remotewd,wiardweb>pages<wixsite,wixstudio,messwithdns,woltlab-demo,wpenginepowered>js<xnbay>u2,u2-local<yolasite<vodka>aaa<io>on-acorn>*<apigee,b-data,banzaicloud>app,backyards>*<<beagleboard,bitbucket,bluebite,boxfuse,brave>s>*<<browsersafetymark,bigv>uk0<cleverapps,dappnode>dyndns<darklang,definima,dedyn,drud,fh-muenster,shw,forgerock>id<github,gitlab,lolipop,hasura-app,hostyhosting,hypernode,moonscale>*<beebyte>paas<beebyteapp>sekd1<jele,unispace>cloud-fr1<webthings,loginline,barsy,azurecontainer>*<ngrok>ap,au,eu,in,jp,sa,us<nodeart>stage<pantheonsite,dyn53,pstmn>mock<protonet,qcx>sys>*<<qoto,vaporcloud,myrdbx,rb-hosting>site<on-k3s>*<on-rio>*<readthedocs,resindevice,resinstaging>devices<hzc,sandcats,scrypted>client<shiftedit,mo-siemens,lair>apps<stolos>*<spacekit,musician,utwente,s5y>*<edugit,telebit,thingdust>dev>cust,reservd<disrec>cust,reservd<prod>cust<testing>cust,reservd<<tickets,upli,2038,webflow,webflowtest,editorx,wixstudio,basicserver,virtualserver<biz>activetrail,cloudns,jozi,dyndns,for-better,for-more,for-some,for-the,selfip,webhop,orx,mmafan,myftp,no-ip,dscloud<app>adaptable,beget>*<clerk,clerkstage,wnext,csb>preview<platform0,deta,ondigitalocean,easypanel,encr,evervault>relay<expo>staging<edgecompute,fireweb,flutterflow,framer,hosted>*<run>*<web,hasura,loginline,messerli,netfy,netlify,ngrok,ngrok-free,developer>*<noop,northflank>*<upsun>*<replit>id<snowflake>*,privatelink>*<<streamlit,storipress,telebit,typedream,vercel,bookonline,wdh>preview<zeabur<live>aem,hlx,ewp>*<<net>adobeaemcloud,adobeio-static,adobeioruntime,akadns,akamai,akamai-staging,akamaiedge,akamaiedge-staging,akamaihd,akamaihd-staging,akamaiorigin,akamaiorigin-staging,akamaized,akamaized-staging,edgekey,edgekey-staging,edgesuite,edgesuite-staging,alwaysdata,myamaze,cloudfront,appudo,atlassian-dev>prod>cdn<<myfritz,onavstack,shopselect,blackbaudcdn,boomla,bplaced,square7,cdn77>r<cdn77-ssl,gb,hu,jp,se,uk,clickrising,dns-cloud,dns-dynamic,cloudaccess,cloudflare>cdn<cloudflareanycast>cdn<cloudflarecn>cdn<cloudflareglobal>cdn<feste-ip,knx-server,static-access,cryptonomic>*<dattolocal,mydatto,debian,definima,at-band-camp,blogdns,broke-it,buyshouses,dnsalias,dnsdojo,does-it,dontexist,dynalias,dynathome,endofinternet,from-az,from-co,from-la,from-ny,gets-it,ham-radio-op,homeftp,homeip,homelinux,homeunix,in-the-band,is-a-chef,is-a-geek,isa-geek,kicks-ass,office-on-the,podzone,scrapper-site,selfip,sells-it,servebbs,serveftp,thruhere,webhop,casacam,dynu,dynv6,twmail,ru,channelsdvr>u<fastly>freetls,map,prod>a,global<ssl>a,b,global<<fastlylb>map<edgeapp,keyword-on,live-on,server-on,cdn-edges,localcert,localhostcert,heteml,cloudfunctions,iobb,moonscale,in-dsl,in-vpn,apps-1and1,ipifony,cloudjiffy>fra1-de,west1-us<elastx>jls-sto1,jls-sto2,jls-sto3<faststacks,massivegrid>paas>fr-1,lon-1,lon-2,ny-1,ny-2,sg-1<<saveincloud>jelastic,nordeste-idc<scaleforce>j<tsukaeru>jelastic<kinghost,uni5,krellian,ggff,barsy,memset,azure-api,azure-mobile,azureedge,azurefd,azurestaticapps>1,2,3,4,5,6,7,centralus,eastasia,eastus2,westeurope,westus2<azurewebsites,cloudapp,trafficmanager,windows>core>blob<servicebus<mynetname>sn<bounceme,ddns,eating-organic,mydissent,myeffect,mymediapc,mypsx,mysecuritycamera,nhlfan,no-ip,pgafan,privatizehealthinsurance,redirectme,serveblog,serveminecraft,sytes,dnsup,hicam,now-dns,ownip,vpndns,cloudycluster,ovh>hosting>*<webpaas>*<<rackmaze,myradweb,in,squares,schokokeks,firewall-gateway,seidat,senseering,siteleaf,mafelo,myspreadshop,vps-host>jelastic>atl,njs,ric<<srcf>soc,user<supabase,dsmynas,familyds,tailscale>beta<ts>c>*<<torproject>pages<reserve-online,community-pro,meinforum,yandexcloud>storage,website<za<page>aem,hlx,hlx3,translated,codeberg,prvcy,rocky,magnet,pdns,plesk<eu>airkitapps,mycd,cloudns,dogado>jelastic<barsy,wellbeingzone,spdns,transurl>*<diskstation<ca>barsy,awdev>*<co,blogspot,no-ip,myspreadshop,box<estate>compute>*<<network>alces>*<co,arvo,azimuth,tlon<org>altervista,pimienta,poivron,potager,sweetpepper,cdn77>c,rsc<cdn77-secure>origin>ssl<<ae,certmgr,cloudns,ddnss,duckdns,tunk,blogdns,blogsite,boldlygoingnowhere,dnsalias,dnsdojo,doesntexist,dontexist,doomdns,dvrdns,dynalias,dyndns>go,home<endofinternet,endoftheinternet,from-me,game-host,gotdns,hobby-site,homedns,homeftp,homelinux,homeunix,is-a-bruinsfan,is-a-candidate,is-a-celticsfan,is-a-chef,is-a-geek,is-a-knight,is-a-linux-user,is-a-patsfan,is-a-soxfan,is-found,is-lost,is-saved,is-very-bad,is-very-evil,is-very-good,is-very-nice,is-very-sweet,isa-geek,kicks-ass,misconfused,podzone,readmyblog,selfip,sellsyourhome,servebbs,serveftp,servegame,stuff-4-sale,webhop,accesscam,camdvr,freeddns,mywire,webredirect,twmail,eu>al,asso,at,au,be,bg,ca,cd,ch,cn,cy,cz,de,dk,edu,ee,es,fi,fr,gr,hr,hu,ie,il,in,int,is,it,jp,kr,lt,lu,lv,mc,me,mk,mt,my,net,ng,nl,no,nz,paris,pl,pt,q-a,ro,ru,se,si,sk,tr,uk,us<fedorainfracloud,fedorapeople,fedoraproject>cloud,os>app<stg>os>app<<<freedesktop,hatenadiary,hepforge,in-dsl,in-vpn,js,barsy,mayfirst,bmoattachments,cable-modem,collegefan,couchpotatofries,hopto,mlbfan,myftp,mysecuritycamera,nflfan,no-ip,read-books,ufcfan,zapto,dynserv,now-dns,is-local,httpbin,pubtls,jpn,my-firewall,myfirewall,spdns,small-web,dsmynas,familyds,teckids>s3<tuxfamily,diskstation,hk,us,toolforge,wmcloud,wmflabs,za<cn>com>amazonaws>cn-north-1>execute-api,emrappui-prod,emrnotebooks-prod,emrstudio-prod,dualstack>s3,s3-accesspoint,s3-website<s3,s3-accesspoint,s3-deprecated,s3-object-lambda,s3-website<cn-northwest-1>execute-api,emrappui-prod,emrnotebooks-prod,emrstudio-prod,dualstack>s3,s3-accesspoint<s3,s3-accesspoint,s3-object-lambda,s3-website<compute>*<airflow>cn-north-1>*<cn-northwest-1>*<<eb>cn-north-1,cn-northwest-1<elb>*<<sagemaker>cn-north-1>notebook,studio<cn-northwest-1>notebook,studio<<<canva-apps,canvasite>my>*<<myqnapcloud,sh>as<quickconnect>direct<<aws>sagemaker>ap-northeast-1>labeling,notebook,studio<ap-northeast-2>labeling,notebook,studio<ap-south-1>labeling,notebook,studio<ap-southeast-1>labeling,notebook,studio<ap-southeast-2>labeling,notebook,studio<ca-central-1>labeling,notebook,notebook-fips,studio<eu-central-1>labeling,notebook,studio<eu-west-1>labeling,notebook,studio<eu-west-2>labeling,notebook,studio<us-east-1>labeling,notebook,notebook-fips,studio<us-east-2>labeling,notebook,notebook-fips,studio<us-west-2>labeling,notebook,notebook-fips,studio<af-south-1>notebook,studio<ap-east-1>notebook,studio<ap-northeast-3>notebook,studio<ap-south-2>notebook<ap-southeast-3>notebook,studio<ap-southeast-4>notebook<ca-west-1>notebook,notebook-fips<eu-central-2>notebook<eu-north-1>notebook,studio<eu-south-1>notebook,studio<eu-south-2>notebook,studio<eu-west-3>notebook,studio<il-central-1>notebook,studio<me-central-1>notebook,studio<me-south-1>notebook,studio<sa-east-1>notebook,studio<us-gov-east-1>notebook,notebook-fips,studio,studio-fips<us-gov-west-1>notebook,notebook-fips,studio,studio-fips<us-west-1>notebook,notebook-fips,studio<experiments>*<<repost>private>*<<<online>eero,eero-stage,websitebuilder,barsy<si>f5,gitapp,gitpage,blogspot<jp>ne>aseinet>user<gehirn,ivory,mail-box,mints,mokuren,opal,sakura,sumomo,topaz<buyshop,fashionstore,handcrafted,kawaiishop,supersale,theshop,0am,0g0,0j0,0t0,mydns,pgw,wjg,usercontent,angry,babyblue,babymilk,backdrop,bambina,bitter,blush,boo,boy,boyfriend,but,candypop,capoo,catfood,cheap,chicappa,chillout,chips,chowder,chu,ciao,cocotte,coolblog,cranky,cutegirl,daa,deca,deci,digick,egoism,fakefur,fem,flier,floppy,fool,frenchkiss,girlfriend,girly,gloomy,gonna,greater,hacca,heavy,her,hiho,hippy,holy,hungry,icurus,itigo,jellybean,kikirara,kill,kilo,kuron,littlestar,lolipopmc,lolitapunk,lomo,lovepop,lovesick,main,mods,mond,mongolian,moo,namaste,nikita,nobushi,noor,oops,parallel,parasite,pecori,peewee,penne,pepper,perma,pigboat,pinoko,punyu,pupu,pussycat,pya,raindrop,readymade,sadist,schoolbus,secret,staba,stripper,sub,sunnyday,thick,tonkotsu,under,upper,velvet,verse,versus,vivian,watson,weblike,whitesnow,zombie,blogspot,hateblo,hatenablog,hatenadiary,2-d,bona,crap,daynight,eek,flop,halfmoon,jeez,matrix,mimoza,netgamers,nyanta,o0o0,rdy,rgr,rulez,sakurastorage>isk01>s3<isk02>s3<<saloon,sblo,skr,tank,uh-oh,undo,webaccel>rs,user<websozai,xii<vc>gv>d<0e,mydns<eus>party>user<<link>myfritz,cyon,nftstorage>ipfs<mypep,dweb>*<<ws>advisor>*<cloud66,dyndns,mypets<cloud>banzai>*<elementor,encoway>eu<statics>*<ravendb,axarnet>es-1<diadem,jelastic>vip<jele,jenv-aruba>aruba>eur>it1<<it1<keliweb>cs<oxa>tn,uk<primetel>uk<reclaim>ca,uk,us<trendhosting>ch,de<jotelulu,kuleuven,linkyard,magentosite>*<observablehq,perspecta,vapor,on-rancher>*<scw>baremetal>fr-par-1,fr-par-2,nl-ams-1<fr-par>cockpit,fnc>functions<k8s>nodes<s3,s3-website,whm<instances>priv,pub<k8s,nl-ams>cockpit,k8s>nodes<s3,s3-website,whm<pl-waw>cockpit,k8s>nodes<s3,s3-website<scalebook,smartlabeling<servebolt,onstackit>runs<sensiosite>*<trafficplex,unison-services,urown,voorloper,zap<ec>base,official<shop>base,hoplix,barsy,barsyonline<gay>pages<la>bnr<sh>bip,hashbang,platform>ent,eu,us<now<je>of<ch>square7,cloudns,cloudscale>cust,lpg>objects<rma>objects<<blogspot,flow>ae>alp1<appengine<linkyard-cloud,gotdns,dnsking,123website,myspreadshop,firenet>*,svc>*<<12hp,2ix,4lima,lima-city<de>bplaced,square7,com,cosidns>dyn<dnsupdater,dynamisches-dns,internet-dns,l-o-g-i-n,ddnss>dyn,dyndns<dyn-ip24,dyndns1,home-webserver>dyn<myhome-server,dnshome,fuettertdasnetz,isteingeek,istmein,lebtimnetz,leitungsen,traeumtgerade,frusky>*<goip,blogspot,xn--gnstigbestellen-zvb,xn--gnstigliefern-wob,hs-heilbronn>it>pages<<dyn-berlin,in-berlin,in-brb,in-butter,in-dsl,in-vpn,iservschule,mein-iserv,schulplattform,schulserver,test-iserv,keymachine,git-repos,lcube-server,svn-repos,barsy,123webseite,logoip,firewall-gateway,my-gateway,my-router,spdns,speedpartner>customer<myspreadshop,taifun-dns,12hp,2ix,4lima,lima-city,dd-dns,dray-dns,draydns,dyn-vpn,dynvpn,mein-vigor,my-vigor,my-wan,syno-ds,synology-diskstation,synology-ds,uberspace>*<virtual-user,virtualuser,community-pro,diskussionsbereich<hr>brendly>shop<blogspot,free<rs>brendly>shop<blogspot,ua,barsy,ox<am>radio,blogspot<fm>radio,user>*<<uk>co>bytemark>dh,vm<blogspot,layershift>j<barsy,barsyonline,retrosnub>cust<nh-serv,no-ip,wellbeingzone,adimo,myspreadshop<gov>api,campaign,service<conn,copro,hosp,independent-commission,independent-inquest,independent-inquiry,independent-panel,independent-review,public-inquiry,royal-commission,pymnt,org>glug,lug,lugs,affinitylottery,raffleentry,weeklylottery<barsy,nimsite<site>canva>my>*<<cloudera>*<convex,cyon,fnwk,folionetwork,fastvps,jele,jouwweb,lelux,loginline,barsy,notion,omniwe,opensocial,madethis,platformsh>*<tst>*<byen,srht,novecore,wpsquared<ac>drr,feedback,forms<ai>uwu,framer<co>carrd,crd,otap>*<com>blogspot<leadpages,lpages,mypi,n4t,xmit>*<firewalledreplit>id<repl>id<supabase<mp>ju<cz>contentproxy9>rsc<realm,e4,blogspot,co,metacentrum>cloud>*<custom<muni>cloud>flt,usr<<<bz>za,mydns,gsj<se>com,blogspot,conf,iopsys,123minsida,itcouldbewor,myspreadshop<group>discourse<team>discourse,jelastic<cc>cleverapps,cloudns,ftpaccess,game-server,myphotos,scrapping,twmail,csx,fantasyleague,spawn>instances<<tech>cleverapps<asia>cloudns,daemon,dix<be>cloudns,webhosting,blogspot,interhostsolutions>cloud<kuleuven>ezproxy<123website,myspreadshop,transurl>*<<cl>cloudns,blogspot<club>cloudns,jele,barsy<cx>cloudns,ath,info,assessments,calculators,funnels,paynow,quizzes,researched,tests<in>cloudns,blogspot,barsy,web,supabase<info>cloudns,dynamic-dns,barrel-of-knowledge,barrell-of-knowledge,dyndns,for-our,groks-the,groks-this,here-for-more,knowsitall,selfip,webhop,barsy,mayfirst,dvrcam,ilovecollege,no-ip,forumz,nsupdate,dnsupdate,v-info<nz>cloudns,co>blogspot<<ph>cloudns<pw>cloudns,x443<me>c66,craft,daplie>localhost<edgestack,filegear,glitch,filegear-sg,lohmus,barsy,mcdir,mcpe,brasilia,ddns,dnsfor,hopto,loginto,noip,webhop,soundcast,tcp4,vp4,diskstation,dscloud,i234,myds,synology,transip>site<yombo,nohost<zone>cloud66,hs,triton>*<stackit,lima<host>cloudaccess,freesite,easypanel,fastvps,myfast,tempurl,wpmudev,jele,mircloud,wp2,half<gdn>cnpy<nl>co,hosting-cluster,blogspot,gov,khplay,123website,myspreadshop,transurl>*<cistron,demon<no>co,blogspot,123hjemmeside,myspreadshop<ru>ac,edu,gov,int,mil,test,eurodir,adygeya,bashkiria,bir,cbg,com,dagestan,grozny,kalmykia,kustanai,marine,mordovia,msk,mytis,nalchik,nov,pyatigorsk,spb,vladikavkaz,vladimir,blogspot,na4u,mircloud,regruhosting>jelastic<myjino>hosting>*<landing>*<spectrum>*<vps>*<<cldmail>hb<mcdir>vps<mcpre,net,org,pp,lk3,ras<email>crisp>on<tawk>p<tawkto>p<<dk>biz,co,firm,reg,store,blogspot,123hjemmeside,myspreadshop<earth>dapps>*,bzz>*<<<kg>us<id>my>rss>*<<flap,co>blogspot<forte<solutions>diher>*<<th>online,shop<fi>dy,blogspot,xn--hkkinen-5wa,iki,cloudplatform>fi<datacenter>demo,paas<kapsi,123kotisivu,myspreadshop<name>her>forgot<his>forgot<<nu>merseine,mine,shacknet,enterprisecloud<tv>better-than,dyndns,on-the-web,worse-than,from,sakura<rocks>myddns,stackit,lima-city,webspace<xyz>blogsite,localzone,crafting,zapto,telebit>*<<one>onred>staging<kin>*<service,homelink<tw>com>mymailer<url,mydns,blogspot<camp>emf>at<<ht>rt<cool>elementor,de<fr>en-root,fbx-os,fbxos,freebox-os,freeboxos,blogspot,goupile,123siteweb,on-web,chirurgiens-dentistes-en-france,dedibox,aeroport,avocat,chambagri,chirurgiens-dentistes,experts-comptables,medecin,notaires,pharmacien,port,veterinaire,myspreadshop,ynh<su>abkhazia,adygeya,aktyubinsk,arkhangelsk,armenia,ashgabad,azerbaijan,balashov,bashkiria,bryansk,bukhara,chimkent,dagestan,east-kazakhstan,exnet,georgia,grozny,ivanovo,jambyl,kalmykia,kaluga,karacol,karaganda,karelia,khakassia,krasnodar,kurgan,kustanai,lenug,mangyshlak,mordovia,msk,murmansk,nalchik,navoi,north-kazakhstan,nov,obninsk,penza,pokrovsk,sochi,spb,tashkent,termez,togliatti,troitsk,tselinograd,tula,tuva,vladikavkaz,vladimir,vologda<space>myfast,heiyu,app-ionos,uber,xs4all<media>framer<photos>framer<website>framer<wiki>framer<at>funkfeuer>wien<futurecms>*,ex>*<in>*<<futurehosting,futuremailing,ortsinfo>ex>*<kunden>*<<co>blogspot<biz,info,123webseite,priv,myspreadshop,12hp,2ix,4lima,lima-city<ms>lab,minisite<work>corpnet<community>nog,ravendb,myforum<ro>co,shop,blogspot,barsy<design>graphic,bss<ae>blogspot<al>blogspot<ar>com>blogspot<<au>com>blogspot,cloudlets>mel<myspreadshop<<ba>blogspot,rs<bg>blogspot,barsy<bj>blogspot<br>com>blogspot,simplesite<leg>ac,al,am,ap,ba,ce,df,es,go,ma,mg,ms,mt,pa,pb,pe,pi,pr,rj,rn,ro,rr,rs,sc,se,sp,to<<by>com>blogspot<mycloud,mediatech<cf>blogspot<cv>blogspot<cy>com>blogspot,scaleforce>j<<<ee>com>blogspot<<eg>com>blogspot<<es>com>blogspot<123miweb,myspreadshop<goog>cloud,translate,usercontent>*<<gr>blogspot,barsy,simplesite<hk>blogspot,secaas,inc,ltd<hu>blogspot<ie>blogspot,myspreadshop<il>co>blogspot,ravpage,mytabit,tabitorder<<is>blogspot<ke>co>blogspot<<kr>blogspot<li>blogspot,caa<lt>blogspot<lu>blogspot,123website<md>blogspot,ir<mk>blogspot<mr>blogspot<mt>com>blogspot<<mx>blogspot<my>blogspot<ng>com>blogspot<col,firm,gen,ltd,ngo<pe>blogspot<pt>blogspot,123paginaweb<qa>blogspot<re>blogspot,can<sg>blogspot,enscaled<sk>blogspot<sn>blogspot<td>blogspot<tr>com>blogspot<<ug>blogspot<uy>com>blogspot<<vn>blogspot<za>co>blogspot<<digital>cloudapps>london<<ci>fin<run>hs,development,ravendb,servers,build>*<code>*<database>*<migration>*<onporter,repl,stackit,val>express,web<wix<st>helioho,kirara,noho<pub>id>*<kin>*<barsy<gl>biz<scot>edu,gov>service<<so>sch,surveys<kz>jcloud,kazteleport>upaas<<tn>orangecloud<gg>kaas,stackit,panel>daemon<<systems>knightpoint<events>koobin,co<direct>libp2p<business>co<education>co<financial>co<place>co<technology>co<bs>we<services>loginline<menu>barsy,barsyonline<mobi>barsy,dscloud<store>barsy,sellfy,shopware,storebase<support>barsy<health>hra<casa>nabu>ui<<pizza>ngrok<news>noticeable<top>now-dns,ntdll,wadl>*<<ovh>nerdpol<mn>nyc<ong>obl<lol>omg<hosting>opencraft<orange>tech<pm>own,name<codes>owo>*<<lc>oy<games>pley,sheezy<bn>co<today>prequalifyme<builders>cloudsite<basketball>aus,nz<edu>rit>git-pages<<xn--p1acf>xn--90amc,xn--j1aef,xn--j1ael8b,xn--h1ahn,xn--j1adp,xn--c1avg,xn--80aaa0cvac,xn--h1aliz,xn--90a1af,xn--41a<mom>ind<farm>storj<pictures>1337<rip>clan<tf>sch<wf>biz,sch<yt>org<management>router<academy>official<faith>ybo<party>ybo<review>ybo<science>ybo<trade>ybo");var o=eC(r,f),a=eC(r,p);if(0===o.length&&0===a.length)return{type:d.NotListed,hostname:i,labels:r};var s=r.length-Math.max(a.length,o.length)-1,l=r.length-o.length-1;return Object.assign({type:d.Listed,hostname:i,labels:r,icann:eQ(r,l)},eQ(r,s))},eJ=["","@"];function eZ(e){var t=eX(e);if(t.type===d.Listed){var n=t.icann.subDomains;return n.length>0?n.join("."):"@"}var r=e.split(".").slice(0,-2).join(".");return""===r?"@":r}var e0=e.i(610357),e1=e.i(123850),e2=e.i(607278),e3=e.i(51606),e4=(0,e1.createCssVarTokens)(["paddingRight"]),e8=e4.cssVars,e5=e4.styleTokens,e6=(0,U.cssRecord)({inputWrapper:[G.rcss.position.relative,G.rcss.flex.growAndShrink(1),{input:[{paddingRight:e5.paddingRight}]}],copyButton:[G.rcss.position.absolute,G.rcss.top("50%"),G.rcss.right(4),{transform:"translateY(-50%)"}]});function e9(e){var t=(0,x._)((0,b.useState)(!1),2),n=t[0],r=t[1];return(0,b.useEffect)(function(){if(n){var e=setTimeout(function(){r(!1)},1e3);return function(){return clearTimeout(e)}}},[n]),(0,y.jsxs)(Q.View,{css:e6.inputWrapper,style:(0,ek._)({},e8.paddingRight,e.value?"36px":"8px"),children:[(0,y.jsx)(e2.Input,(0,eS._)((0,er._)({},e),{onClick:function(e){return e.currentTarget.select()}})),e.value?(0,y.jsx)(z.IconButton,{css:e6.copyButton,alt:"Copy",tooltipBehavior:"hidden",onClick:function(){e.value&&((0,e0.default)(e.value),r(!0))},children:n?(0,y.jsx)(em.default,{}):(0,y.jsx)(e3.default,{})}):null]})}var e7=(0,U.cssRecord)({root:[G.rcss.flex.column,(h={gap:8},(0,ek._)(h,G.container.min("mobileMax"),[G.rcss.flex.row,{"& > div:nth-of-type(1)":{maxWidth:50},"& > div:nth-of-type(2)":{width:"30%"}}]),(0,ek._)(h,"label",[G.rcss.color.foregroundDimmer,{fontSize:F.tokens.fontSizeSmall}]),h)],col:[G.rcss.colWithGap(4),G.rcss.flex.growAndShrink(1)],records:[G.rcss.borderRadius(12),(0,ek._)({},G.container.min("mobileMax"),G.rcss.colWithGap(12))],divider:(0,ek._)({display:"flex",height:1,backgroundColor:F.tokens.outlineDimmest},G.container.min("mobileMax"),G.rcss.display.none)});function te(e){var t=eZ(e.hostname);return(0,y.jsxs)(Q.View,{css:e7.root,children:[(0,y.jsxs)(Q.View,{css:e7.col,children:[(0,y.jsx)(Q.View,{tag:"label",children:"Type"}),(0,y.jsx)(e2.Input,{value:e.type,readOnly:!0})]}),(0,y.jsxs)(Q.View,{css:e7.col,children:[(0,y.jsx)(Q.View,{tag:"label",children:"Hostname"}),(0,y.jsx)(e9,{value:t,readOnly:!0})]}),(0,y.jsxs)(Q.View,{css:e7.col,children:[(0,y.jsx)(Q.View,{tag:"label",children:"Record"}),(0,y.jsx)(e9,{value:e.record,readOnly:!0})]})]})}function tt(e){var t="replit-verify=".concat(e.replId);return(0,y.jsxs)(q.Surface,{background:"default",css:e7.records,px:12,pt:8,pb:16,gap:16,children:[(0,y.jsx)(te,{hostname:e.hostname,type:"A",record:e.apexProxy}),(0,y.jsx)(Q.View,{css:e7.divider}),(0,y.jsx)(te,{hostname:e.hostname,type:"TXT",record:t})]})}var tn="https://docs.replit.com/cloud-services/deployments/custom-domains",tr=e.i(222342),ti=e.i(88619),to=e.i(939562),ta=e.i(887877),ts=e.i(818503),tl=e.i(604963),tu=e.i(12034),tc=e.i(112767),td=e.i(795581),tf=e.i(462783),tp=e.i(283023),th=e.i(121817),tg=e.i(703505),tm=e.i(504908),tv=(0,U.cssRecord)({root:[G.rcss.colWithGap(8),G.rcss.borderRadius(8),G.rcss.pl(8),G.rcss.pr(4),G.rcss.height(32),G.rcss.justify.center]}),tx=(0,U.cssRecord)({root:tv.root,rootExpanded:[tv.root,G.rcss.height("auto"),G.rcss.pt(4),G.rcss.pb(12),G.rcss.justify.start],domainRow:[G.rcss.reset.button,G.rcss.rowWithGap(8),G.rcss.align.center,G.rcss.justify.spaceBetween],domainWrapper:[G.rcss.color.accentPrimaryStronger,{a:G.rcss.hover(G.rcss.color.accentPrimaryStrongest)}],statusDot:[G.rcss.borderRadius("full"),G.rcss.width(6),G.rcss.height(6)],buttons:[G.rcss.flex.column,G.rcss.justify.spaceBetween,(g={gap:8},(0,ek._)(g,G.container.min("mobileMax"),G.rcss.flex.row),(0,ek._)(g,"button",[G.rcss.flex.growAndShrink(1)]),g)],deleteButton:[G.rcss.mt(16)]}),ty={verified:{color:F.tokens.accentPositiveDefault,text:"Verified"},verifying:{color:F.tokens.orangeDefault,text:"Verifying"},temporal_verification:{color:F.tokens.orangeDefault,text:"Verifying"},pushed_to_goval:{color:F.tokens.orangeDefault,text:"Verifying"},failed:{color:F.tokens.accentNegativeDefault,text:"Failed"},expired:{color:F.tokens.accentNegativeDefault,text:"Expired"},purchased:{color:F.tokens.accentPositiveDefault,text:"Purchased"}};function tb(e){var t=e.domain,n=(0,x._)((0,e_.useSetShouldDomainAutoRenewMutation)({onCompleted:function(e){"SetShouldDomainAutoRenewResult"!==e.setShouldDomainAutoRenew.__typename&&o(e.setShouldDomainAutoRenew.message)}}),2),r=n[0],i=n[1].loading,o=(0,tr.default)().showError;return(0,y.jsx)(tc.Switch,{isSelected:t.autorenew,onChange:function(e){r({variables:{input:{domainId:t.id,shouldAutoRenew:e}}})},isReadOnly:i,children:(0,y.jsx)(K.Text,{children:"Auto renew before expiration"})})}function tw(e){var t,n,r,i=e.domain,o=e.deploymentId,a=e.authorizations,s=(0,x._)((0,e_.useHostingDeploymentsUnlinkDomainMutation)(),2),l=s[0],u=s[1].loading,c=(0,x._)((0,e_.useCreateDnsRecordMutation)(),2),d=c[0],f=c[1].loading,p=(0,x._)((0,e_.useDeleteDnsRecordMutation)(),2),h=p[0],g=p[1].loading,m=(0,tr.default)().showError,w=(0,x._)((0,b.useState)("collapsed"),2),k=w[0],_=w[1],S=(0,x._)((0,b.useState)(!1),2),C=S[0],j=S[1],T=(null!=(n=a.deleteCustomDomain)?n:{isAuthorized:!0,message:""}).isAuthorized;return(0,y.jsxs)(q.Surface,{elevated:!0,css:"collapsed"!==k?tx.rootExpanded:tx.root,children:[(0,y.jsxs)(Q.View,{css:tx.domainRow,style:{borderBottomLeftRadius:"collapsed"!==k?0:void 0,borderBottomRightRadius:"collapsed"!==k?0:void 0},children:[(0,y.jsxs)(Q.View,{css:tx.domainWrapper,shrink:!0,row:!0,gap:8,align:"center",children:[(0,y.jsx)(K.Text,{multiline:!1,children:(0,y.jsx)("a",{target:"_blank",href:"".concat(i.domain.startsWith("http://")||i.domain.startsWith("https://")?"":"https://").concat(i.domain),children:i.domain})}),(0,y.jsxs)(Q.View,{row:!0,gap:4,align:"center",children:[(0,y.jsx)(Q.View,{css:tx.statusDot,style:{backgroundColor:ty[i.state].color}}),(0,y.jsx)(K.Text,{color:"dimmer",variant:"small",children:ty[i.state].text})]})]}),(0,y.jsxs)(Q.View,{row:!0,children:[(0,y.jsx)(ti.CopyIconButton,{textToCopy:i.domain,tooltipSuccessText:"Copy link"}),(0,y.jsx)(z.IconButton,{alt:"Edit",onClick:function(){j(!1),_(function(e){return"collapsed"===e?"dns":"collapsed"})},disabled:f||g,children:"collapsed"===k?(0,y.jsx)(tp.default,{}):(0,y.jsx)(tf.default,{})})]})]}),"dns"===k?(0,y.jsxs)(Q.View,{pl:4,pr:8,gap:12,children:[(0,y.jsx)(tC,{domain:i,items:null!=(r=null==(t=i.dnsRecords)?void 0:t.filter(Boolean))?r:[],hostingDeploymentId:o,handleDelete:function(e){h({variables:{input:{domainId:i.id,recordId:e}}})}}),(0,y.jsx)($.Button,{text:"Add DNS record",onClick:function(){_("add")}}),(0,y.jsxs)(tl.PopoverTrigger,{elevated:!0,label:"Disconnect domain",isOpen:C,onOpenChange:j,children:[(0,y.jsx)($.Button,{iconLeft:(0,y.jsx)(tm.default,{}),size:"small",disabled:!T||u,variant:"outlined",colorway:"negative",text:"Disconnect ".concat(i.domain," from this app"),css:tx.deleteButton,onClick:function(){return j(!0)}}),(0,y.jsxs)(Q.View,{gap:4,p:8,children:[(0,y.jsx)(K.Text,{children:"When you disconnect this domain, it will be available to link to your other apps."}),(0,y.jsxs)(K.Text,{children:["Would you like to disconnect ",i.domain," from this app?"]}),(0,y.jsx)($.Button,{iconLeft:(0,y.jsx)(tm.default,{}),text:"Yes, disconnect",disabled:u,colorway:"negative",onClick:function(){return(0,D._)(function(){var e;return(0,O._)(this,function(t){switch(t.label){case 0:return[4,l({variables:{input:{hostingDeploymentDomainId:i.id}},refetchQueries:[{query:I.LinkablePurchasedDomainsDocument}]})];case 1:if((e=t.sent()).errors)return m("Something went wrong"),[2];if(!e.data)return[2];if("HostingDeployment"!==e.data.unlinkHostingDeploymentDomain.__typename)return m(e.data.unlinkHostingDeploymentDomain.message),[2];return j(!1),[2]}})})()}})]})]}),(0,y.jsx)(tb,{domain:i})]}):null,"add"===k?(0,y.jsx)(Q.View,{pl:4,pr:8,gap:12,children:(0,y.jsx)(tS,{domain:i.domain,loading:f||g,handleSubmit:function(e){return(0,D._)(function(){var t;return(0,O._)(this,function(n){switch(n.label){case 0:return[4,d({variables:{input:{domainId:i.id,host:e.host,type:e.type,answer:e.answer,priority:"MX"===e.type?e.priority:void 0}}})];case 1:if((t=n.sent()).errors)return m("Something went wrong"),[2];if(!t.data)return[2];return"CreateDnsRecordOutput"===t.data.createDnsRecord.__typename?_("dns"):m(t.data.createDnsRecord.message),[2]}})})()},handleBack:function(){_("dns")}})}):null]})}var tk=[{label:"A",value:"A"},{label:"TXT",value:"TXT"},{label:"MX",value:"MX"},{label:"CNAME",value:"CNAME"}],t_=(0,U.cssRecord)({hostField:[G.rcss.flex.growAndShrink(1)],select:[G.rcss.minWidth(120)]});function tS(e){var t=e.handleSubmit,n=e.handleBack,r=e.loading,i=e.domain,o=(0,x._)((0,b.useState)(""),2),a=o[0],s=o[1],l=(0,x._)((0,b.useState)("@"),2),u=l[0],c=l[1],d=(0,x._)((0,b.useState)(""),2),f=d[0],p=d[1],h=(0,x._)((0,b.useState)("10"),2),g=h[0],m=h[1],w="MX"===a?"mail.".concat(i):"CNAME"===a?"target.example.com":"Your value here";return(0,y.jsxs)(ta.Form,{gap:8,onSubmit:function(e){e.preventDefault(),t({type:a,host:u,answer:f,priority:"MX"===a?Number(g):void 0})},children:[(0,y.jsxs)(Q.View,{row:!0,gap:4,align:"start",children:[(0,y.jsx)(tu.Select,{isRequired:!0,label:"Type",items:tk,css:t_.select,placeholder:"Select type",selectedKey:a,onSelectionChange:function(e){return s(e)},children:function(e){return(0,y.jsx)(ep.ListBoxItem,{id:e.value,label:e.label},e.value)}}),(0,y.jsxs)(td.TextField,{css:t_.hostField,isRequired:!0,children:[(0,y.jsx)(ts.Label,{children:"Hostname"}),(0,y.jsx)(e2.Input,{placeholder:"@",value:u,onChange:function(e){return c(e.target.value)}}),(0,y.jsx)(to.FieldError,{})]}),"MX"===a?(0,y.jsxs)(td.TextField,{isRequired:!0,css:t_.select,children:[(0,y.jsx)(ts.Label,{children:"Priority"}),(0,y.jsx)(e2.Input,{type:"number",min:0,max:65535,placeholder:"10",value:g,onChange:function(e){return m(e.target.value)}}),(0,y.jsx)(to.FieldError,{})]}):null]}),(0,y.jsxs)(td.TextField,{isRequired:!0,children:[(0,y.jsx)(ts.Label,{children:"Record"}),(0,y.jsx)(e2.Input,{placeholder:w,value:f,onChange:function(e){return p(e.target.value)}}),(0,y.jsx)(to.FieldError,{})]}),(0,y.jsx)($.Button,{text:"Add",type:"submit",loading:r}),(0,y.jsx)($.Button,{text:"Back",onClick:n,loading:r})]})}function tC(e){var t=e.domain,n=e.items,r=e.hostingDeploymentId,i=e.handleDelete;return(0,y.jsx)(Q.View,{gap:4,css:tx.rootExpanded,children:n.map(function(e){return(0,y.jsx)(tj,{item:e,domain:t,hostingDeploymentId:r,handleDelete:i},e.id)})})}function tj(e){var t,n,r,i,o,a=e.item,s=e.domain,l=e.hostingDeploymentId,u=e.handleDelete,c=(0,x._)((0,b.useState)(!1),2),d=c[0],f=c[1],p=(n=null!=(t=a.host)?t:"",!!("TXT"===a.type&&l&&eJ.includes(n)&&a.answer==="replit-verify=".concat(l)||"A"===a.type&&l&&eJ.includes(n))),h=null!=(r=a.host)?r:"",g=h?"".concat(h,".").concat(s.domain):s.domain;return(0,y.jsxs)(Q.View,{row:!0,gap:4,align:"center",children:[(0,y.jsx)(Q.View,{grow:!0,children:(0,y.jsx)(te,{type:null!=(i=a.type)?i:"",record:null!=(o=a.answer)?o:"",hostname:g})}),(0,y.jsxs)(tl.PopoverTrigger,{elevated:!0,placement:"bottom right",label:"Delete DNS record",isOpen:d,onOpenChange:f,children:[(0,y.jsx)(z.IconButton,{css:tx.deleteButton,alt:"Delete",onClick:function(){return f(!0)},children:(0,y.jsx)(tg.default,{})}),(0,y.jsxs)(Q.View,{gap:4,p:8,children:[(0,y.jsx)(K.Text,{children:p?"Deleting Replit managed DNS records may cause your domain to stop working properly. Are you sure you want to continue?":"Are you sure you want to delete this DNS record?"}),(0,y.jsx)($.Button,{text:"Delete",onClick:function(){u(a.id),f(!1)},iconLeft:(0,y.jsx)(tg.default,{})})]})]})]},a.id)}function tT(e){var t=e.domain,n=e.deploymentId,r=e.replId,i=e.apexProxy,o=e.authorizations,a=(0,x._)((0,b.useState)(!1),2),s=a[0],l=a[1],u=(0,x._)((0,b.useState)(!1),2),c=u[0],d=u[1],f=(0,eb.useFlag)({controlName:"flag-domains-glowup",default:!1}),p=(0,x._)((0,R.useHostingDeploymentDomainsLazyQuery)({variables:{id:n,isGlowup:f},fetchPolicy:"network-only",ssr:!1}),2),h=p[0],g=p[1].loading,m=(0,x._)((0,e_.useHostingDeploymentsUnlinkDomainMutation)(),2),w=m[0],_=m[1].loading,S=(0,x._)((0,e_.useVerifyDomainMutation)(),2),C=S[0],j=S[1].loading,T=t.state===k.HostingDeploymentDomainState.Failed,E=o.addCustomDomain,I=E.isAuthorized,A=E.message,P=o.deleteCustomDomain,D=P.isAuthorized,O=P.message;return(0,y.jsxs)(q.Surface,{elevated:!0,css:s?tx.rootExpanded:tx.root,children:[(0,y.jsxs)(Q.View,{css:tx.domainRow,style:{borderBottomLeftRadius:s?0:void 0,borderBottomRightRadius:s?0:void 0},children:[(0,y.jsxs)(Q.View,{css:tx.domainWrapper,shrink:!0,row:!0,gap:8,align:"center",children:[(0,y.jsx)(K.Text,{multiline:!1,children:(0,y.jsx)("a",{target:"_blank",href:"".concat(t.domain.startsWith("http://")||t.domain.startsWith("https://")?"":"https://").concat(t.domain),children:t.domain})}),(0,y.jsxs)(Q.View,{row:!0,gap:4,align:"center",children:[(0,y.jsx)(Q.View,{css:tx.statusDot,style:{backgroundColor:ty[t.state].color}}),(0,y.jsx)(K.Text,{color:"dimmer",variant:"small",children:ty[t.state].text})]})]}),(0,y.jsxs)(Q.View,{row:!0,children:[(0,y.jsx)(ti.CopyIconButton,{textToCopy:t.domain,tooltipSuccessText:"Copy link"}),(0,y.jsx)(Y.Tooltip,{tooltip:A,isDisabled:I,children:(0,y.jsx)(z.IconButton,{alt:"Edit",disabled:!I,tooltipBehavior:"hidden",onClick:function(){d(!1),l(function(e){return!e})},css:G.rcss.color.foregroundDimmer,children:s?(0,y.jsx)(tf.default,{}):(0,y.jsx)(tp.default,{})})})]})]}),s?(0,y.jsx)(Q.View,{pl:4,pr:8,gap:12,children:c?(0,y.jsxs)(y.Fragment,{children:[(0,y.jsx)(K.Text,{children:"Are you sure you want to unlink this domain?"}),(0,y.jsxs)(Q.View,{css:tx.buttons,children:[(0,y.jsx)($.Button,{size:"small",variant:"outlined",text:"Cancel",onClick:function(){d(!1)}}),(0,y.jsx)($.Button,{size:"small",disabled:_,text:"Yes, unlink "+t.domain,colorway:"negative",onClick:function(){w({variables:{input:{hostingDeploymentDomainId:t.id}}})}})]})]}):(0,y.jsxs)(y.Fragment,{children:[(0,y.jsxs)(Q.View,{gap:6,children:[T?(0,y.jsxs)(y.Fragment,{children:[(0,y.jsxs)(Q.View,{row:!0,gap:6,align:"center",children:[(0,y.jsx)(Z.default,{}),(0,y.jsx)(K.Text,{children:"DNS Error"})]}),(0,y.jsxs)(K.Text,{children:["Failed to link domain",t.status?": ".concat(t.status.endsWith(".")?t.status.slice(0,-1):t.status):null,". Make sure your domain's DNS settings have these records."," ",(0,y.jsx)("a",{target:"_blank",href:tn,children:"Learn more"})]})]}):(0,y.jsxs)(K.Text,{color:"dimmer",children:["Add these records to your domain's"," ",(0,y.jsx)("strong",{css:G.rcss.color.foregroundDefault,children:"DNS settings"}),". This may take up to 48 hours to fully apply."," ",(0,y.jsx)("a",{target:"_blank",href:tn,children:"Learn more"})]}),(0,y.jsx)(tt,{hostname:t.domain,apexProxy:i,replId:r})]}),(0,y.jsxs)(Q.View,{css:tx.buttons,children:[(0,y.jsx)($.Button,{iconLeft:g||j?(0,y.jsx)(J.default,{}):(0,y.jsx)(th.default,{}),size:"small",text:T?"Retry linking":"Check status",onClick:function(){T?C({variables:{input:{hostingDeploymentDomainId:t.id}}}):h()}}),(0,y.jsx)(Y.Tooltip,{isDisabled:D,tooltip:O,children:(0,y.jsx)($.Button,{iconLeft:(0,y.jsx)(tg.default,{}),size:"small",disabled:_||!D,text:T?"Remove domain":"Unlink domain",colorway:"negative",onClick:function(){d(!0)}})})]})]})}):null]})}function tE(e){var t=e.domain,n=e.deploymentId,r=e.replId,i=e.apexProxy,o=e.authorizations;return t.managed?(0,y.jsx)(tw,{domain:t,deploymentId:n,authorizations:o}):(0,y.jsx)(tT,{domain:t,deploymentId:n,replId:r,apexProxy:i,authorizations:o})}var tR=e.i(207237),tI=e.i(952030),tA=(0,U.cssRecord)({item:[G.rcss.borderRadius(8)]});function tP(e){var t,n,r=e.deploymentId,i=e.refetchDomainsQuery,o=(0,tR.default)(),a=(0,I.useLinkablePurchasedDomainsQuery)({fetchPolicy:"cache-and-network",ssr:!1}),s=a.data,l=a.refetch,u=null==s||null==(n=s.currentUser)||null==(t=n.domains)?void 0:t.items,c=(0,x._)((0,I.useLinkPurchasedDomainMutation)(),2),d=c[0],f=c[1].loading;if(!(null==u?void 0:u.length))return null;var p=function(e){return(0,D._)(function(){return(0,O._)(this,function(t){switch(t.label){case 0:return[4,d({variables:{replId:o,domainName:e,deploymentId:r}})];case 1:return t.sent(),i(),l(),[2]}})})()};return(0,y.jsxs)(y.Fragment,{children:[(0,y.jsxs)(Q.View,{row:!0,align:"center",gap:8,children:[(0,y.jsx)(K.Text,{variant:"subheadDefault",children:"Available to link:"}),f?(0,y.jsx)(J.default,{}):null]}),(0,y.jsx)(Q.View,{gap:8,tag:"ul",children:u.map(function(e){return(0,y.jsx)(tD,{loading:f,domain:e.domain,handleLink:p},e.id)})}),(0,y.jsxs)(K.Text,{variant:"small",color:"dimmer",children:["View all your purchased domains on your"," ",(0,y.jsx)(L.default,{href:"/account#domains",target:"_blank",children:"account"})," ","page."]})]})}function tD(e){var t=e.domain,n=e.handleLink,r=e.loading,i=(0,x._)((0,b.useState)(!1),2),o=i[0],a=i[1];return(0,y.jsxs)(q.Surface,{tag:"li",css:tA.item,elevated:!0,row:!0,px:8,py:4,align:"center",justify:"space-between",children:[(0,y.jsx)(K.Text,{children:t}),(0,y.jsxs)(tl.PopoverTrigger,{placement:"bottom right",isOpen:o&&!r,onOpenChange:a,label:"Link domain",children:[(0,y.jsx)(z.IconButton,{onClick:function(){return a(!0)},alt:"Link",children:(0,y.jsx)(tI.default,{})}),(0,y.jsxs)(Q.View,{gap:8,p:8,children:[(0,y.jsxs)(K.Text,{children:["Point ",t," to this deployment?"]}),(0,y.jsx)($.Button,{onClick:function(){n(t),a(!1)},text:"Yes",loading:r})]})]})]})}var tO=e.i(904667),tN=e.i(369948),tM=e.i(947794),tL=e.i(292642),tB=(0,U.cssRecord)({root:[G.rcss.borderRadius(8),G.rcss.border({color:F.tokens.outlineDimmer})],labelRow:[G.rcss.rowWithGap(8),G.rcss.align.center],labelText:[G.rcss.flex.growAndShrink(1)],controls:[{"& > button":[G.rcss.flex.growAndShrink(1)]}]}),tV=function(e){try{return new URL(e.startsWith("http")?e:"https://".concat(e)).hostname.toLowerCase()}catch(t){return e.trim().toLowerCase()}};function tF(e){var t=(0,x._)((0,b.useState)([]),2),n=t[0],r=t[1],i=(0,x._)((0,R.useLinkHostingDeploymentDomainMutation)({onCompleted:function(){e.onAdd()}}),2),o=i[0],a=i[1].loading;return(0,y.jsx)(Q.View,{css:tB.root,p:8,children:0===n.length?(0,y.jsx)(tU,{onCancel:e.onCancel,onSubmit:function(e){r(e)}}):(0,y.jsx)(tG,{onCancel:e.onCancel,onSubmit:function(){o({variables:{input:{hostingDeploymentId:e.deploymentId,domain:n[0]}}})},domains:n,apexProxy:e.apexProxy,deploymentId:e.deploymentId,isLinkingDomains:a,replId:e.replId})})}function tU(e){var t=e.onSubmit,n=e.onCancel,r=(0,b.useId)(),i=(0,x._)((0,b.useState)(!0),2),o=i[0],a=i[1],s=(0,x._)((0,b.useState)(void 0),2),l=s[0],u=s[1];return(0,y.jsxs)(Q.View,{tag:"form",gap:16,onSubmit:function(e){e.preventDefault();var n=new FormData(e.currentTarget).get("domain");(n=tV(n),(0,tO.default)(n))?t([n]):u("Enter a valid domain")},children:[(0,y.jsxs)(Q.View,{gap:8,children:[(0,y.jsx)(Q.View,{tag:"label",htmlFor:r+"input",css:tB.labelRow,children:(0,y.jsx)(K.Text,{color:"dimmer",children:"First, enter your domain"})}),(0,y.jsx)(e2.Input,{name:"domain",id:r+"input",autoFocus:!0,placeholder:"example.com",onChange:function(e){a(""===e.currentTarget.value.trim()),u(void 0)}}),l?(0,y.jsxs)(Q.View,{row:!0,gap:4,align:"center",children:[(0,y.jsx)(Z.default,{size:12,color:F.tokens.orangeDefault}),(0,y.jsx)(K.Text,{variant:"small",children:l})]}):null]}),(0,y.jsxs)(Q.View,{css:tB.controls,row:!0,gap:8,justify:"space-between",children:[(0,y.jsx)($.Button,{type:"button",text:"Cancel",onClick:n}),(0,y.jsx)($.Button,{iconRight:(0,y.jsx)(tN.default,{}),colorway:"primary",type:"submit",disabled:o||void 0!==l,text:"Next"})]})]})}function tG(e){var t=e.onSubmit,n=e.onCancel,r=e.domains,i=e.apexProxy,o=e.deploymentId,a=e.isLinkingDomains,s=e.replId,l=(0,b.useRef)(null);return(0,b.useEffect)(function(){l.current&&l.current.focus()},[]),(0,y.jsx)(Q.View,{gap:16,children:(0,y.jsxs)(Q.View,{gap:8,children:[(0,y.jsx)(t$,{replId:s,apexProxy:i,deploymentId:o,domains:r}),(0,y.jsxs)(Q.View,{css:tB.controls,row:!0,gap:8,justify:"space-between",children:[(0,y.jsx)($.Button,{type:"button",text:"Cancel",onClick:n,disabled:a}),(0,y.jsx)($.Button,{iconRight:a?(0,y.jsx)(J.default,{}):(0,y.jsx)(tL.default,{}),colorway:"primary",type:"submit",text:r.length>1?"Link domains":"Link domain",ref:l,onClick:function(){return t()},disabled:a})]})]})})}function t$(e){var t=e.domains.map(function(t){return{A:{hostname:t,record:e.apexProxy},TXT:{hostname:t,record:"replit-verify=".concat(e.replId)}}});return(0,y.jsxs)(Q.View,{gap:8,children:[(0,y.jsxs)(Q.View,{css:tB.labelRow,children:[(0,y.jsx)(tM.default,{color:F.tokens.foregroundDimmest}),(0,y.jsxs)(K.Text,{multiline:!0,css:tB.labelText,children:["Next, add the following records to your domain's DNS settings."," ",(0,y.jsx)("a",{target:"_blank",href:tn,children:"Learn more"})]}),(0,y.jsx)(ti.CopyButton,{textToCopy:JSON.stringify(t,null,2),text:"JSON",showIcon:!0,size:"small"})]}),(0,y.jsx)(Q.View,{gap:8,children:e.domains.map(function(t){return(0,y.jsx)(tt,{apexProxy:e.apexProxy,hostname:t,replId:e.replId},t)})})]})}var tz=e.i(680250),tH=e.i(993134),tW=e.i(283110),tq=(0,U.cssRecord)({root:[G.rcss.borderRadius(8),G.rcss.minHeight(32)],domainMessage:[G.rcss.color.foregroundDimmer]});function tK(e){var t=e.domainName,n=e.status,r=e.message;return(0,y.jsxs)(q.Surface,{elevated:!0,css:tq.root,pl:8,pr:4,py:4,children:[(0,y.jsxs)(Q.View,{row:!0,gap:8,align:"center",justify:"start",children:[(0,y.jsx)(K.Text,{multiline:!1,children:t}),(0,y.jsxs)(Q.View,{row:!0,align:"center",gap:4,children:[function(e){switch(e){case"pending":default:return(0,y.jsx)(tH.default,{color:F.tokens.foregroundDimmer});case"success":return(0,y.jsx)(em.default,{color:F.tokens.accentPositiveDefault});case"fail":return(0,y.jsx)(tW.default,{color:F.tokens.accentNegativeDefault})}}(n),(0,y.jsx)(K.Text,{color:"dimmer",variant:"small",children:function(e){switch(e){case"pending":return"Processing...";case"dns-verifying":return"Verifying DNS...";case"success":return"Domain purchased successfully";case"fail":return"Purchase failed";default:return e}}(n)})]})]}),r?(0,y.jsx)(K.Text,{variant:"small",css:tq.domainMessage,children:r}):null]})}function tY(e){var t=e.refetchDomainsQuery,n=e.omitDomains,r=(0,x._)((0,b.useState)(new Set),2),i=r[0],o=r[1],a=(0,tR.default)(),s=(0,tz.usePendingDomainsQueryQuery)({variables:{replId:a},fetchPolicy:"cache-and-network",ssr:!1}).data;(0,tz.usePendingDomainsUpdatesSubscription)({variables:{replId:a},onData:function(e){var n,r,a=e.data;if(a&&(null==(r=a.data)||null==(n=r.pendingDomainsUpdates)?void 0:n.pendingDomains)){var s=a.data.pendingDomainsUpdates.pendingDomains.filter(function(e){return"success"===e.status}).map(function(e){return e.domainName}),l=new Set((0,T._)(i).concat((0,T._)(s)));l.size>i.size&&t(),o(l)}}});var l=(0,b.useMemo)(function(){var e;return(null==s||null==(e=s.getRepl)?void 0:e.__typename)!=="Repl"?null:s.getRepl.pendingDomains.filter(function(e){return!n.has(e.domainName)&&"fail"!==e.status})},[s,n]);return l&&0!==l.length?(0,y.jsx)(Q.View,{gap:8,children:l.map(function(e){var t;return n.has(e.domainName)?null:(0,y.jsx)(tK,{domainName:e.domainName,status:e.status,message:null!=(t=e.message)?t:void 0},e.domainName)})}):null}var tQ=e.i(396776),tX=e.i(363201),tJ=e.i(530310),tZ=(0,U.cssRecord)({primaryDomain:[G.rcss.borderRadius(8),G.rcss.height(32)],primaryDomainLink:[G.rcss.flex.shrink(1),G.rcss.color.accentPrimaryStronger,{a:G.rcss.hover(G.rcss.color.accentPrimaryStrongest)}],domainPostPurchaseInfo:[G.rcss.borderRadius(8),G.rcss.border()],buyWrapper:[G.rcss.height("100%"),G.rcss.overflow("hidden")],scrollContainer:[G.rcss.overflow("auto")]});function t0(e){var t,n,r,i,o,a,s=e.deployment,l=e.authorizations,u=e.viewData,c=(0,tR.default)(),d=(0,R.useDomains2ReplQuery)({variables:{id:c}}),f=d.data,p=d.loading,h=(null==f||null==(t=f.getRepl)?void 0:t.__typename)==="Repl"&&!!(null==(n=f.getRepl.org)?void 0:n.id),g=(0,x._)((0,b.useState)(!1),2),m=g[0],w=g[1],_=(0,x._)((0,b.useState)(!!(null==u?void 0:u.buyDomain)),2),S=_[0],C=_[1],j=(0,x._)((0,b.useState)(void 0),2),D=j[0],O=j[1],N=(0,I.useLinkablePurchasedDomainsQuery)({fetchPolicy:"cache-and-network",ssr:!1}).data,M=null==N||null==(i=N.currentUser)||null==(r=i.domains)?void 0:r.items,L=(0,R.useHostingDeploymentDomainsQuery)({variables:{id:s.id,isGlowup:!1},fetchPolicy:"cache-and-network",ssr:!1,pollInterval:D,onCompleted:function(e){var t,n;O((null==(t=e.hostingDeployment)?void 0:t.__typename)==="HostingDeployment"&&(null==(n=e.hostingDeployment.domains2)?void 0:n.some(function(e){return e.state===k.HostingDeploymentDomainState.Verifying}))?3e4:void 0)}}).refetch,B=(null==s||null==(o=s.domains2)?void 0:o.length)?s.domains2:null,V=(0,b.useMemo)(function(){return new Set((0,T._)((null!=B?B:[]).map(function(e){return e.domain})).concat((0,T._)((null!=M?M:[]).map(function(e){return e.domain}))).map(function(e){return e}))},[B,M]),U=(null==s?void 0:s.currentBuild.status)===k.HostingBuildStatus.Success,z=null==s?void 0:s.repl.apexProxy,W=(0,P.useDeploymentCurrentBuild)();if(S&&z)return(0,y.jsx)(Q.View,{css:tZ.buyWrapper,gap:8,children:(0,y.jsx)(ew,{suggestedDomain:null==s?void 0:s.repl.title,deploymentId:s.id,onRequestClose:function(){return C(!1)}})});var X=function(){var e,t,n,r,i,o=(null==W||null==(e=W.repl.hostingDeployment)?void 0:e.__typename)==="HostingDeployment"?null==(t=W.repl.hostingDeployment)?void 0:t.replitAppSubdomain:void 0;if(!o&&(null==W||null==(n=W.repl.owner)?void 0:n.username)&&(o="".concat(W.repl.slug,"-").concat(W.repl.owner.username)),o)return"".concat(o).concat((null==(i=window)||null==(r=i.location)?void 0:r.hostname)!=="replit.com"?".staging":"",".").concat(A.DEPLOYMENTS_DEFAULT_DOMAIN)}(),J=l.addCustomDomain,ee=J.isAuthorized,et=J.message;return(0,y.jsx)(Q.View,{css:tZ.buyWrapper,gap:8,children:(0,y.jsxs)(Q.View,{css:tZ.scrollContainer,shrink:!0,children:[(0,y.jsx)(Q.View,{py:12,children:(0,y.jsx)(K.Text,{variant:"subheadDefault",children:"Domains"})}),(0,y.jsxs)(Q.View,{gap:8,children:[(0,y.jsxs)(q.Surface,{elevated:!0,css:tZ.primaryDomain,justify:"space-between",align:"center",pl:8,pr:4,row:!0,gap:4,children:[(0,y.jsx)(K.Text,{multiline:!1,css:tZ.primaryDomainLink,children:(0,y.jsx)("a",{href:"https://".concat(X),target:"_blank",rel:"noreferrer noopener",children:X})}),(0,y.jsxs)(Q.View,{row:!0,align:"center",children:[(0,y.jsx)(ti.CopyIconButton,{textToCopy:null!=X?X:""}),(0,y.jsx)(Y.Tooltip,{tooltip:t1,children:(0,y.jsx)(tJ.default,{"aria-label":t1,color:F.tokens.foregroundDimmer,css:G.rcss.m(4)})})]})]}),B&&s?(0,y.jsx)(Q.View,{gap:8,children:B.map(function(e){return(0,y.jsx)(Q.View,{children:(0,y.jsx)(tE,{apexProxy:s.repl.apexProxy,deploymentId:s.id,domain:e,authorizations:l,replId:s.repl.id})},e.domain)})}):null,(0,y.jsx)(tY,{refetchDomainsQuery:function(){L()},omitDomains:V}),(0,y.jsx)(tP,{deploymentId:s.id,refetchDomainsQuery:L}),(null==(a=s.domains2)?void 0:a.some(function(e){return e.managed&&5>(0,E.differenceInDays)(new Date,new Date(e.timeCreated))}))?(0,y.jsxs)(q.Surface,{px:8,py:8,elevated:!0,css:tZ.domainPostPurchaseInfo,children:[(0,y.jsxs)(Q.View,{row:!0,align:"center",gap:8,children:[(0,y.jsx)(tX.default,{}),(0,y.jsx)(K.Text,{children:"Congratulations on your new domain!"})]}),(0,y.jsx)(Q.View,{pl:24,children:(0,y.jsx)(K.Text,{variant:"small",children:"You may see a temporary error when accessing your domain that usually resolves within a few minutes after purchasing. If the problem persists longer than 48 hours, please contact Replit Support."})})]}):null,m&&z?(0,y.jsx)(tF,{apexProxy:z,deploymentId:s.id,onAdd:function(){return w(!1)},onCancel:function(){return w(!1)},replId:s.repl.id}):null,U?null:(0,y.jsx)(tQ.StatusBanner,{colorway:"warning",icon:(0,y.jsx)(Z.default,{}),text:"You must successfully publish your project before linking a domain"}),!1===m?(0,y.jsxs)(Q.View,{row:!0,gap:8,children:[(0,y.jsx)(Y.Tooltip,{tooltip:h?"Custom domain purchasing is coming soon to org-owned Apps.":et,isDisabled:ee&&!h,children:(0,y.jsx)($.Button,{disabled:!U||!ee||h||p,iconLeft:(0,y.jsx)(tI.default,{}),text:"Buy a new domain",onClick:function(){(0,ed.track)(ef.events.DOMAIN_PURCHASE,{action:"flow_opened",suggestedDomain:null==s?void 0:s.repl.title}),C(!0)},variant:"outlined",size:"small",iconRight:(0,y.jsx)(H.Pill,{compact:!0,colorway:"primary",text:"Beta"})})}),(0,y.jsx)(Y.Tooltip,{tooltip:et,isDisabled:ee,children:(0,y.jsx)($.Button,{disabled:!U||!ee,iconLeft:(0,y.jsx)(tI.default,{}),text:"Manually connect from another registrar",onClick:function(){w(!0)},variant:"outlined",size:"small"})})]}):null]})]})})}var t1="The primary domain always ends in replit.app. To change, you must unpublish your app and publish again.",t2=e.i(951262),t3=e.i(613141);function t4(){var e=(0,ei._)(["\n  fragment DomainsGlowupRepl on Repl {\n    id\n    org {\n      id\n    }\n  }\n"]);return t4=function(){return e},e}function t8(){var e=(0,ei._)(["\n  fragment DomainVerificationStatus on Domain {\n    state\n  }\n"]);return t8=function(){return e},e}function t5(){var e=(0,ei._)(["\n  fragment DomainsGlowupDomain on Domain {\n    id\n    state\n    domain\n    managed\n    ...DomainVerificationStatus\n    dnsRecords {\n      id\n      answer\n      type\n      host\n    }\n    whois {\n      registrar\n      creationDate\n      expiryDate\n    }\n    currentDnsRecords {\n      A\n      TXT\n    }\n    renewalPriceCents\n    autorenew\n    timeCreated\n  }\n  ","\n"]);return t5=function(){return e},e}function t6(){var e=(0,ei._)(["\n  fragment DomainsGlowupHostingDeployment on HostingDeployment {\n    id\n    currentBuild {\n      id\n      status\n    }\n    repl {\n      id\n      title\n      apexProxy\n    }\n    domains2 {\n      ...DomainsGlowupDomain\n    }\n  }\n  ","\n"]);return t6=function(){return e},e}function t9(){var e=(0,ei._)(["\n  query DomainsGlowupRepl($id: String!) {\n    getRepl(id: $id) {\n      ...DomainsGlowupRepl\n    }\n  }\n  ","\n"]);return t9=function(){return e},e}function t7(){var e=(0,ei._)(["\n  query DomainsGlowupHostingDeploymentDomains(\n    $id: String!\n    $isGlowup: Boolean!\n  ) {\n    hostingDeployment(id: $id) {\n      ... on HostingDeployment {\n        id\n        ...HostingDeploymentDomainsHostingDeployment\n      }\n    }\n  }\n  ","\n"]);return t7=function(){return e},e}function ne(){var e=(0,ei._)(["\n  query DomainsGlowupPrefetchLinkablePurchasedDomains {\n    currentUser {\n      id\n      domains(managed: true, onlyUnlinked: true) {\n        items {\n          id\n          domain\n        }\n      }\n    }\n  }\n"]);return ne=function(){return e},e}var nt={},nn=(0,eo.gql)(t4()),nr=(0,eo.gql)(t8()),ni=(0,eo.gql)(t5(),nr);(0,eo.gql)(t6(),ni);var no=(0,eo.gql)(t9(),nn),na=(0,eo.gql)(t7(),R.HostingDeploymentDomainsHostingDeploymentFragmentDoc),ns=(0,eo.gql)(ne());function nl(){var e=(0,ei._)(["\n  fragment DomainLinkingStatus on DomainLinkingStatus {\n    domainId\n    domainName\n    currentPhase\n    currentStatus\n    message\n    updatedAt\n  }\n"]);return nl=function(){return e},e}function nu(){var e=(0,ei._)(["\n  fragment DomainLinkingStatusesRepl on Repl {\n    id\n    domainLinkingStatuses {\n      ...DomainLinkingStatus\n    }\n  }\n  ","\n"]);return nu=function(){return e},e}function nc(){var e=(0,ei._)(["\n  fragment DomainsGlowupLinkablePurchasedDomains on CurrentUser {\n    domains(managed: true, onlyUnlinked: true) {\n      items {\n        id\n        domain\n      }\n    }\n  }\n"]);return nc=function(){return e},e}function nd(){var e=(0,ei._)(["\n  fragment DomainsGlowupMinimalHostingDeploymentDomains on HostingDeployment {\n    id\n    domains2 {\n      id\n      domain\n    }\n  }\n"]);return nd=function(){return e},e}function nf(){var e=(0,ei._)(["\n  query DomainsGlowupDomainManagementLinkablePurchasedDomains {\n    currentUser {\n      id\n      ...DomainsGlowupLinkablePurchasedDomains\n    }\n  }\n  ","\n"]);return nf=function(){return e},e}function np(){var e=(0,ei._)(["\n  mutation DomainsGlowupUnlinkDomain(\n    $input: UnlinkHostingDeploymentDomainInput!\n  ) {\n    unlinkHostingDeploymentDomain(input: $input) {\n      ... on HostingDeployment {\n        id\n        ...DomainsGlowupMinimalHostingDeploymentDomains\n        repl {\n          ...PendingDomainsRepl\n        }\n      }\n      ... on Error {\n        message\n      }\n    }\n  }\n  ","\n  ","\n"]);return np=function(){return e},e}function nh(){var e=(0,ei._)(["\n  mutation DomainsGlowupDeleteDnsRecord($input: DeleteDnsRecordInput!) {\n    deleteDnsRecord(input: $input) {\n      ... on Error {\n        message\n      }\n      ... on DeleteDnsRecordOutput {\n        domain {\n          id\n          dnsRecords {\n            id\n          }\n        }\n      }\n    }\n  }\n"]);return nh=function(){return e},e}function ng(){var e=(0,ei._)(["\n  mutation DomainsGlowupSetShouldAutoRenew(\n    $input: SetShouldDomainAutoRenewInput!\n  ) {\n    setShouldDomainAutoRenew(input: $input) {\n      ... on Error {\n        message\n      }\n      ... on SetShouldDomainAutoRenewResult {\n        domain {\n          id\n          autorenew\n        }\n      }\n    }\n  }\n"]);return ng=function(){return e},e}function nm(){var e=(0,ei._)(["\n  mutation DomainsGlowupVerifyDomain($input: VerifyDomainInput!) {\n    verifyDomain(input: $input) {\n      ... on Domain {\n        ...DomainsGlowupDomain\n      }\n    }\n  }\n  ","\n"]);return nm=function(){return e},e}function nv(){var e=(0,ei._)(["\n  mutation DomainsGlowupCreateDnsRecord($input: CreateDnsRecordInput!) {\n    createDnsRecord(input: $input) {\n      ... on Error {\n        message\n      }\n      ... on CreateDnsRecordOutput {\n        domain {\n          id\n          ...DomainsGlowupDomain\n        }\n      }\n    }\n  }\n  ","\n"]);return nv=function(){return e},e}function nx(){var e=(0,ei._)(["\n  query DomainsGlowupReplLinkingStatuses($replId: String!) {\n    getRepl(id: $replId) {\n      ... on Repl {\n        ...DomainLinkingStatusesRepl\n      }\n    }\n  }\n  ","\n"]);return nx=function(){return e},e}function ny(){var e=(0,ei._)(["\n  subscription DomainsGlowupDomainLinkingStatusUpdates($replId: String!) {\n    domainLinkingStatusUpdates(replId: $replId) {\n      ...DomainLinkingStatusesRepl\n    }\n  }\n  ","\n"]);return ny=function(){return e},e}var nb={},nw=(0,eo.gql)(nl()),nk=(0,eo.gql)(nu(),nw),n_=(0,eo.gql)(nc()),nS=(0,eo.gql)(nd()),nC=(0,eo.gql)(nf(),n_),nj=(0,eo.gql)(np(),nS,tz.PendingDomainsReplFragmentDoc),nT=(0,eo.gql)(nh()),nE=(0,eo.gql)(ng());(0,eo.gql)(nm(),ni);var nR=(0,eo.gql)(nv(),ni),nI=(0,eo.gql)(nx(),nk),nA=(0,eo.gql)(ny(),nk),nP=e.i(886513),nD=e.i(341190),nO=e.i(654647);function nN(){var e=(0,ei._)(["\n  query DomainsGlowupConnectDomainLinkablePurchasedDomains {\n    currentUser {\n      id\n      ...DomainsGlowupLinkablePurchasedDomains\n    }\n  }\n  ","\n"]);return nN=function(){return e},e}function nM(){var e=(0,ei._)(["\n  mutation DomainsGlowupLinkExternalDomain(\n    $input: LinkHostingDeploymentDomainInput!\n    $isGlowup: Boolean = true\n  ) {\n    linkHostingDeploymentDomain(input: $input) {\n      ... on HostingDeployment {\n        ...HostingDeploymentDomainsHostingDeployment\n      }\n      ... on ServiceUnavailable {\n        message\n      }\n      ... on UnauthorizedError {\n        message\n      }\n      ... on NotFoundError {\n        message\n      }\n      ... on UserError {\n        message\n      }\n      ... on Error {\n        message\n      }\n    }\n  }\n  ","\n"]);return nM=function(){return e},e}function nL(){var e=(0,ei._)(["\n  mutation DomainsGlowupLinkPurchasedDomain(\n    $replId: String!\n    $domainName: String!\n    $deploymentId: String!\n    $isGlowup: Boolean = true\n  ) {\n    linkReplDomain2(\n      replId: $replId\n      deploymentId: $deploymentId\n      domain: $domainName\n    ) {\n      __typename\n      ... on Repl {\n        id\n        hostingDeployment {\n          ...HostingDeploymentDomainsHostingDeployment\n        }\n      }\n      ... on ServiceUnavailable {\n        message\n      }\n      ... on UnauthorizedError {\n        message\n      }\n      ... on NotFoundError {\n        message\n      }\n      ... on Error {\n        message\n      }\n    }\n  }\n  ","\n"]);return nL=function(){return e},e}var nB={},nV=(0,eo.gql)(nN(),n_),nF=(0,eo.gql)(nM(),R.HostingDeploymentDomainsHostingDeploymentFragmentDoc),nU=(0,eo.gql)(nL(),R.HostingDeploymentDomainsHostingDeploymentFragmentDoc),nG=e.i(224119);function n$(e){var t;return(0,y.jsx)(Q.View,{clsx:(t={},(0,ek._)(t,nG.default.tableWrapper,!e.noBorder),(0,ek._)(t,nG.default.tableWrapperBorderless,e.noBorder),t),children:(0,y.jsx)("table",{className:nG.default.table,children:e.children})})}function nz(e){var t=e.children;return(0,y.jsx)(q.Surface,{elevated:!0,tag:"tr",clsx:nG.default.tableHeader,children:t})}function nH(e){var t=e.children,n=(0,nP._)(e,["children"]);return(0,y.jsx)("tr",(0,eS._)((0,er._)({},n),{clsx:[nG.default.tableRow,n.className],children:t}))}function nW(e){var t=e.children,n=(0,nP._)(e,["children"]);return(0,y.jsx)("td",(0,eS._)((0,er._)({},n),{clsx:[nG.default.tableCell,n.className],children:t}))}function nq(e){var t=e.children,n=(0,nP._)(e,["children"]);return(0,y.jsx)("span",(0,eS._)((0,er._)({},n),{clsx:[nG.default.screenReaderOnly,n.className],children:t}))}function nK(e){var t=(0,x._)((0,b.useState)(!1),2),n=t[0],r=t[1];return(0,b.useEffect)(function(){if(n){var e=setTimeout(function(){r(!1)},1e3);return function(){return clearTimeout(e)}}},[n]),(0,y.jsxs)(Q.View,{row:!0,align:"center",justify:"space-between",gap:8,children:[(0,y.jsx)(K.Text,{variant:"small",children:e.value}),(0,y.jsx)(z.IconButton,{alt:"Copy",tooltipBehavior:"hidden",onClick:function(){(0,e0.default)(e.value),r(!0)},children:n?(0,y.jsx)(em.default,{}):(0,y.jsx)(e3.default,{})})]})}function nY(e){var t;return(0,y.jsxs)(n$,{noBorder:null!=(t=e.noBorder)&&t,children:[(0,y.jsxs)(nz,{children:[(0,y.jsx)("th",{children:(0,y.jsx)(K.Text,{variant:"small",color:"dimmer",children:"Type"})}),(0,y.jsx)("th",{children:(0,y.jsx)(K.Text,{variant:"small",color:"dimmer",children:"Hostname"})}),(0,y.jsx)("th",{children:(0,y.jsx)(K.Text,{variant:"small",color:"dimmer",children:"Record"})}),e.actions?(0,y.jsx)("th",{children:(0,y.jsx)(nq,{children:"Actions"})}):null]}),e.dnsRecords.map(function(t){return(0,y.jsxs)(nH,{children:[(0,y.jsx)(nW,{children:t.type}),(0,y.jsx)(nW,{children:e.showCopyButton?(0,y.jsx)(nK,{value:t.hostname}):t.hostname}),(0,y.jsx)(nW,{width:"100%",children:e.showCopyButton?(0,y.jsx)(nK,{value:t.record}):t.record}),e.actions?(0,y.jsx)(nW,{children:e.actions(t)}):null]},t.id)})]})}function nQ(e){var t="replit-verify=".concat(e.replId),n=eZ(e.hostname);return[{id:"A-".concat(n),type:"A",hostname:n,record:e.apexProxy},{id:"TXT-".concat(n),type:"TXT",hostname:n,record:t}]}var nX=e.i(922463),nJ=e.i(880321),nZ=e.i(987154),n0=e.i(448451);function n1(e){var t=e.trim().toLowerCase();if(""===t)return t;t.startsWith("http://")||t.startsWith("https://")||(t="https://".concat(t));try{return new URL(t).hostname.toLowerCase()}catch(e){return t}}function n2(e){var t,n,r=(0,x._)((0,b.useState)(null),2),i=r[0],o=r[1],a=(0,tr.default)().showError,s=(0,x._)((t={awaitRefetchQueries:!0,refetchQueries:[{query:na,variables:{id:e.deploymentId,isGlowup:!0}}],onCompleted:function(t){return(0,D._)(function(){var n;return(0,O._)(this,function(r){return(null==t?void 0:t.linkHostingDeploymentDomain.__typename)!=="HostingDeployment"?a(null!=(n=null==t?void 0:t.linkHostingDeploymentDomain.message)?n:"Something went wrong when linking your purchased domain"):e.onAdd(),[2]})})()},onError:function(e){a(e.message)}},n=(0,er._)({},nB,t),t2.useMutation(nF,n)),2),l=s[0],u=s[1].loading;function c(){i&&l({variables:{input:{hostingDeploymentId:e.deploymentId,domain:i.domain}}})}return(0,y.jsxs)(Q.View,{gap:8,grow:!0,shrink:!0,children:[(0,y.jsxs)(Q.View,{row:!0,gap:8,align:"center",children:[(0,y.jsx)(z.IconButton,{onClick:e.onBack,alt:"Back to domains",disabled:u,children:(0,y.jsx)(X.default,{})}),(0,y.jsx)(K.Header,{level:2,variant:"subheadDefault",children:"Connect your own domain"})]}),(0,y.jsxs)(Q.View,{py:12,px:16,gap:24,children:[(0,y.jsx)(n3,(0,eS._)((0,er._)({},e),{enteredDomainDetails:i,setEnteredDomainDetails:o,linkExternalDomainToDeployment:c,isLinkingExternalDomain:u})),i?(0,y.jsx)(n4,(0,eS._)((0,er._)({},e),{enteredDomainDetails:i,setEnteredDomainDetails:o,linkExternalDomainToDeployment:c,isLinkingExternalDomain:u})):null]})]})}function n3(e){var t,n,r,i,o,a,s=e.enteredDomainDetails,l=e.setEnteredDomainDetails,u=(0,nP._)(e,["enteredDomainDetails","setEnteredDomainDetails"]),c=(0,b.useId)(),d=(0,x._)((0,b.useState)(void 0),2),f=d[0],p=d[1],h=(0,b.useRef)(null),g=(0,x._)((0,b.useState)(null!=(o=null==s?void 0:s.domain)?o:""),2),m=g[0],w=g[1],k=(0,x._)((t=(0,er._)({},nB,void 0),t2.useMutation(nU,t)),2),_=k[0],S=k[1].loading,C=(n=(0,er._)({},nB,void 0),ea.useQuery(nV,n)).data,j=(0,tr.default)().showError,T=(null!=(a=null==C||null==(i=C.currentUser)||null==(r=i.domains)?void 0:r.items)?a:[]).map(function(e){return e.domain}),E=""===m,R=T.includes(n1(m)),I=E||void 0!==f||S,A=function(){l(null)},P=(0,nX.usePrevious)(s);return(0,b.useEffect)(function(){if(P&&null===s){var e;null==(e=h.current)||e.focus()}},[s,P]),(0,y.jsxs)(ta.Form,{gap:24,onSubmit:function(e){if(e.preventDefault(),!S){var t,n=m;if("string"!=typeof n||(n=n1(n),!(0,tO.default)(n)))return void p("Enter a valid domain");(w(n),R)?(t=n,(0,D._)(function(){var e,n,r,i;return(0,O._)(this,function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),[4,_({variables:{domainName:t,deploymentId:u.deploymentId,replId:u.replId},awaitRefetchQueries:!0,refetchQueries:[{query:nV}]})];case 1:if((null==(e=(n=o.sent()).data)?void 0:e.linkReplDomain2.__typename)!=="Repl")return j(null!=(i=null==(r=n.data)?void 0:r.linkReplDomain2.message)?i:"Something went wrong when linking your purchased domain"),[2];return u.onAdd(),[3,3];case 2:return o.sent(),j("Something went wrong when linking your purchased domain"),[3,3];case 3:return[2]}})})()):l({domain:n})}},children:[(0,y.jsxs)(Q.View,{gap:10,children:[(0,y.jsx)(Q.View,{htmlFor:c+"domain-input",tag:"label",row:!0,gap:8,align:"center",children:(0,y.jsx)(K.Text,{color:"dimmer",children:"Enter the domain you want to connect to your project"})}),(0,y.jsx)(nJ.ComboBox,(0,eS._)((0,er._)({ref:h,"aria-label":"Select a domain",allowsCustomValue:!0,id:c+"domain-input",placeholder:"example.com",inputValue:m,icon:null===s?(0,y.jsx)(nZ.default,{}):void 0,menuTrigger:"focus",onInputChange:function(e){w(e),p(void 0)},name:"domain",allowsEmptyCollection:!1},null!==s?{isDisabled:!0,triggerIcon:(0,y.jsx)(tp.default,{}),triggerButtonProps:{onClick:function(){A()}}}:0===T.length?{triggerButtonProps:{style:{display:"none"}}}:{}),{children:T.length>0?(0,y.jsxs)(nO.ListBoxSection,{children:[(0,y.jsx)(nD.Header,{clsx:n0.default.listBoxHeader,children:"Or choose from domains you own on Replit"}),T.map(function(e){return(0,y.jsx)(ep.ListBoxItem,{label:e,id:e},e)})]}):null})),f?(0,y.jsxs)(Q.View,{row:!0,gap:4,align:"center",children:[(0,y.jsx)(Z.default,{size:12,color:F.tokens.orangeDefault}),(0,y.jsx)(K.Text,{variant:"small",children:f})]}):null]}),s?null:(0,y.jsxs)(Q.View,{row:!0,gap:12,clsx:n0.default.buttonsContainer,children:[(0,y.jsx)($.Button,{type:"button",text:"Cancel",onClick:u.onBack}),(0,y.jsx)($.Button,{disabled:I,text:S?"Linking":R?"Connect Domain":"Next",iconRight:S?void 0:(0,y.jsx)(tN.default,{}),loading:S,colorway:"primary",type:"submit"})]})]},s?"entered":"not-entered")}function n4(e){var t=e.enteredDomainDetails,n=e.setEnteredDomainDetails,r=(0,nP._)(e,["enteredDomainDetails","setEnteredDomainDetails"]),i=(0,b.useRef)(null);return(0,b.useEffect)(function(){i.current&&i.current.focus()},[]),(0,y.jsxs)(Q.View,{gap:24,children:[(0,y.jsxs)(Q.View,{gap:12,children:[(0,y.jsxs)(Q.View,{gap:8,py:8,children:[(0,y.jsx)(K.Text,{variant:"subheadDefault",children:"DNS Records"}),(0,y.jsxs)(K.Text,{children:["Next, add the following records to your domain's DNS settings."," ",(0,y.jsx)(L.default,{href:"https://docs.replit.com/cloud-services/deployments/custom-domains",target:"_blank",rel:"noopener",children:"Learn more"})]})]}),(0,y.jsx)(nY,{dnsRecords:nQ({replId:r.replId,apexProxy:r.apexProxy,hostname:t.domain}),showCopyButton:!0},t.domain)]}),(0,y.jsxs)(Q.View,{row:!0,gap:12,clsx:n0.default.buttonsContainer,children:[(0,y.jsx)($.Button,{text:"Cancel",onClick:function(){n(null)},disabled:r.isLinkingExternalDomain}),(0,y.jsx)($.Button,{text:"Link",iconRight:(0,y.jsx)(tN.default,{}),colorway:"primary",ref:i,disabled:r.isLinkingExternalDomain,onClick:r.linkExternalDomainToDeployment,loading:r.isLinkingExternalDomain})]})]})}var n8=e.i(167626),n5=e.i(585092),n6=e.i(643009),n9=e.i(645632),n7=e.i(312984),re=function(e){return e.replace(/^["']|["']$/g,"")};function rt(e){var t,n,r,i,o=(0,x._)((0,b.useState)(!1),2),a=o[0],s=o[1],l=(0,x._)(nQ({replId:e.dns.replId,apexProxy:e.dns.apexProxy,hostname:e.dns.hostname}),2),u=l[0],c=l[1],d=u.record,f=c.record,p="replit-verify=".concat(e.deploymentId),h=eZ(e.dns.hostname),g=null!=(r=null==(t=e.dns.currentDnsRecords)?void 0:t.A)?r:[],m=null!=(i=null==(n=e.dns.currentDnsRecords)?void 0:n.TXT)?i:[],w=[];if(g.length>1)return null;var k=g.includes(d);if(!k&&g.length>0?g.forEach(function(e){e!==d&&w.push({type:"A",hostname:h,record:e})}):k||w.push({type:"A",hostname:h,record:"(missing)"}),!m.some(function(e){var t=re(e);return t===f||t===p})){var _=!1;m.length>0&&m.forEach(function(e){var t=re(e);(function(e){var t,n=e.toLowerCase(),r="replit-verify";if(n.startsWith("replit-verify="))return!0;var i=n.indexOf("=");if((t=-1!==i?n.substring(0,i):n.substring(0,r.length+5)).length<5||t.length>25)return!1;var o=n5.default.get(t,r),a=Math.max(t.length,r.length),s=Math.abs(t.length-r.length);return 1-o/a>=.7&&s<=5})(t)&&t!==f&&t!==p&&(w.push({type:"TXT",hostname:h,record:t}),_=!0)}),_||w.push({type:"TXT",hostname:h,record:"(missing)"})}return 0===w.length?null:(0,y.jsx)(Q.View,{clsx:n7.default.statusBanner,gap:12,p:8,children:(0,y.jsxs)(Q.View,{gap:8,children:[(0,y.jsx)(K.Text,{variant:"small",clsx:n7.default.statusText,children:"The DNS settings for your custom domain do not match the DNS records listed above. Please verify your domain's configuration on the DNS provider website."}),a?(0,y.jsxs)(Q.View,{gap:8,children:[(0,y.jsx)(K.Text,{variant:"small",clsx:n7.default.statusText,children:"Below are the incorrect records that need to be updated. Note that DNS records can take up to 48 hours to update."}),(0,y.jsxs)("table",{clsx:n7.default.dnsTable,children:[(0,y.jsx)("thead",{children:(0,y.jsxs)("tr",{children:[(0,y.jsx)("th",{children:"Type"}),(0,y.jsx)("th",{children:"Hostname"}),(0,y.jsx)("th",{children:"Record"})]})}),(0,y.jsx)("tbody",{children:w.map(function(e,t){return(0,y.jsxs)("tr",{children:[(0,y.jsx)("td",{children:e.type}),(0,y.jsx)("td",{children:e.hostname}),(0,y.jsx)("td",{clsx:n7.default.strikeThrough,children:e.record})]},"".concat(e.type,"-").concat(t))})})]})]}):null,(0,y.jsx)(Q.View,{align:"start",children:(0,y.jsx)($.Button,{size:"small",shrink:!0,onClick:function(){(0,ed.track)(ef.events.DOMAIN_MANAGEMENT,{action:"dns_checker_viewed",domainName:e.dns.hostname,domainId:e.domainId,isInitiative:"glowup"}),s(!a)},"aria-label":a?"Show less":"Show more",iconLeft:a?(0,y.jsx)(n9.default,{}):(0,y.jsx)(n6.default,{}),text:a?"Show less":"Show more",colorway:"negative"})})]})})}var rn=e.i(6338),rr=e.i(604425),ri={"checking-dns":{label:"DNS Record Checks",step:0},"configuring-routing":{label:"Routing Update",step:1},"issuing-cert":{label:"SSL Certificate",step:2}},ro=["checking-dns","configuring-routing","issuing-cert"],ra=function(e){var t=e.stepIndex,n=e.activeStep;return t===e.erroredStep?(0,y.jsx)(Z.default,{alt:"error"}):void 0!==n&&t<n?(0,y.jsx)(em.default,{alt:"success"}):t===n?(0,y.jsx)(J.default,{alt:"current"}):(0,y.jsx)(tH.default,{alt:"waiting"})},rs=function(e){var t=e.stepIndex,n=e.activeStep,r=e.erroredStep;return void 0===n?null:t===r?"negative":t<n?"positive":t===n?"primary":null},rl=function(e,t){return{zIndex:t-e}},ru=rn.loadingStyle.foregroundPulse(),rc=["checking-dns","configuring-routing","issuing-cert"];function rd(){return(0,y.jsx)(q.Surface,{background:"default",children:(0,y.jsx)(Q.View,{row:!0,children:rc.map(function(e,t){return(0,y.jsx)(b.Fragment,{children:(0,y.jsx)(H.Pill,{text:"",variant:"filled",clsx:rr.default.pill,style:rl(t,rc.length),css:ru})},e)})})})}function rf(e){var t,n,r,i=e.status,o=i.currentPhase,a=i.currentStatus,s=null==(t=ri[o])?void 0:t.step;void 0!==s&&("failed"===a?(r=s,n=s):"in-progress"===a||"pending"===a?n=s:"completed"===a&&(n=s+1));var l=void 0!==n;return(0,y.jsx)(q.Surface,{background:"default",children:(0,y.jsx)(Q.View,{row:!0,children:ro.map(function(e){var t,i=ri[e],o=i.step;return(0,y.jsx)(b.Fragment,{children:(0,y.jsx)(H.Pill,{text:l?i.label:"",colorway:null!=(t=rs({stepIndex:o,activeStep:n,erroredStep:r}))?t:void 0,variant:"filled",clsx:rr.default.pill,style:rl(o,ro.length),iconRight:l?(0,y.jsx)(ra,{stepIndex:o,activeStep:n,erroredStep:r}):void 0})},e)})})})}var rp=e.i(869212);function rh(e){var t=e.state,n=e.customMessage,r={verified:{color:F.tokens.accentPositiveDefault,text:"Verified"},verifying:{color:F.tokens.orangeDefault,text:"Verifying"},temporal_verification:{color:F.tokens.orangeDefault,text:"Verifying"},pushed_to_goval:{color:F.tokens.orangeDefault,text:"Verifying"},failed:{color:F.tokens.accentNegativeDefault,text:"Failed"},expired:{color:F.tokens.accentNegativeDefault,text:"Expired"},purchased:{color:F.tokens.accentPositiveDefault,text:"Purchased"}};return(0,y.jsxs)(Q.View,{align:"center",gap:6,row:!0,children:[(0,y.jsx)("span",{clsx:rp.default.statusDotWrapper,children:(0,y.jsx)(Q.View,{clsx:rp.default.domainStatusDot,style:{backgroundColor:r[t].color}})}),(0,y.jsx)(Q.View,{clsx:rp.default.statusText,children:(0,y.jsx)(K.Text,{variant:"small",color:"dimmest",multiline:!0,children:null!=n?n:r[t].text})})]})}var rg=e.i(311106),rm=e.i(965153),rv=e.i(258941),rx=e.i(988676),ry=e.i(601059),rb=e.i(739521),rw=e.i(257811),rk=e.i(549762),r_=e.i(254806),rS=e.i(15260),rC=e.i(352701),rj=e.i(674478),rT=(0,y.jsx)(y.Fragment,{children:""}),rE=[{label:"A",value:"A"},{label:"TXT",value:"TXT"},{label:"MX",value:"MX"},{label:"CNAME",value:"CNAME"}];function rR(e){var t,n,r,i,o,a,s=(0,x._)((0,b.useState)(!1),2),l=s[0],u=s[1],c=(t={variables:{replId:(null==(r=e.dns)?void 0:r.replId)||""},skip:!(null==(i=e.dns)?void 0:i.replId),fetchPolicy:"cache-and-network",ssr:!1},n=(0,er._)({},nb,t),ea.useQuery(nI,n)),d=c.data,f=c.loading,p=(null==d?void 0:d.getRepl)&&"domainLinkingStatuses"in d.getRepl?null==(o=d.getRepl.domainLinkingStatuses)?void 0:o.find(function(t){return t.domainId===e.domain.id}):void 0,h=!p,g=f&&(null==(a=e.dns)?void 0:a.replId)&&!p;return(0,y.jsxs)(Q.View,{gap:32,p:24,children:[(0,y.jsx)(Q.View,{row:!0,gap:8,align:"center",children:(0,y.jsx)($.Button,{size:"small",variant:"outlined",iconLeft:(0,y.jsx)(rk.default,{}),text:"Back",onClick:e.onBack})}),(0,y.jsxs)(Q.View,{gap:16,children:[(0,y.jsxs)(Q.View,{row:!0,gap:8,align:"center",justify:"space-between",py:8,children:[(0,y.jsxs)(Q.View,{gap:6,grow:!0,children:[(0,y.jsx)(K.Text,{variant:"headerDefault",children:e.domain.domain}),h?(0,y.jsx)(rh,{state:e.domain.state}):null]}),(0,y.jsx)(ry.PopupMenu,{"aria-label":"Domain options",trigger:(0,y.jsx)(z.IconButton,{alt:"More options",children:(0,y.jsx)(rC.default,{})}),children:(0,y.jsx)(rI,(0,eS._)((0,er._)({},e),{onOpen:function(){return u(!0)}}))})]}),g?(0,y.jsx)(rd,{}):null,g||!p||h?null:(0,y.jsx)(rf,{status:p}),(0,y.jsx)(rx.DividerH,{}),(0,y.jsxs)(Q.View,{gap:12,children:[(0,y.jsxs)(Q.View,{gap:32,children:[(0,y.jsx)(q.Surface,{background:"default",gap:16,children:e.domain.managed?(0,y.jsx)(rP,(0,er._)({},e)):(0,y.jsx)(rD,(0,er._)({},e))}),e.domain.managed?(0,y.jsx)(rO,(0,er._)({},e)):(0,y.jsx)(rM,(0,er._)({},e))]}),e.dns&&!e.domain.managed&&"verified"!==e.domain.state?(0,y.jsx)(rt,{deploymentId:e.deploymentId,dns:e.dns,domainId:e.domain.id}):null]})]}),(0,y.jsx)(rA,(0,eS._)((0,er._)({},e),{isOpen:l,onRequestClose:function(){return u(!1)}}))]})}function rI(e){return(0,y.jsx)(ry.MenuItem,{label:"Disconnect this domain",isDestructive:!0,icon:(0,y.jsx)(tm.default,{}),onAction:e.onOpen})}function rA(e){var t,n,r=(0,tr.default)().showError,i=(0,x._)((t={awaitRefetchQueries:!0,refetchQueries:[{query:nC}],onCompleted:function(t){var n,i=t.unlinkHostingDeploymentDomain;(null==i?void 0:i.__typename)==="UnauthorizedError"||(null==i?void 0:i.__typename)==="NotFoundError"||(null==i?void 0:i.__typename)==="ServiceUnavailable"?r(i.message):(e.onRequestClose(),null==(n=e.onBack)||n.call(e))}},n=(0,er._)({},nb,t),t2.useMutation(nj,n)),2),o=i[0],a=i[1].loading;return(0,y.jsx)(rb.Modal,{isOpen:e.isOpen,onRequestClose:e.onRequestClose,centered:!0,maxWidth:480,children:(0,y.jsx)(rv.default,{prompt:"Disconnect this domain?",desc:(0,y.jsxs)(Q.View,{gap:8,children:[(0,y.jsxs)(K.Text,{children:["You are about to disconnect ",(0,y.jsx)("b",{children:e.domain.domain})," from this deployment. Your site will no longer be accessible at this domain."]}),e.domain.managed?(0,y.jsx)(K.Text,{children:"It will still be available to link to your other apps."}):null]}),confirmText:"Disconnect",danger:!0,icon:(0,y.jsx)(tm.default,{}),loading:a,onCancel:e.onRequestClose,onConfirm:function(){o({variables:{input:{hostingDeploymentDomainId:e.domain.id}}})}})})}function rP(e){var t,n,r,i,o=(0,tr.default)().showError,a=(0,x._)((t={onCompleted:function(e){"SetShouldDomainAutoRenewResult"!==e.setShouldDomainAutoRenew.__typename&&o(e.setShouldDomainAutoRenew.message)}},n=(0,er._)({},nb,t),t2.useMutation(nE,n)),2),s=a[0],l=a[1].loading;return(0,y.jsxs)(Q.View,{clsx:rj.default.sectionRow,row:!0,gap:70,py:8,children:[(0,y.jsxs)(Q.View,{gap:8,children:[(0,y.jsxs)(Q.View,{row:!0,gap:8,align:"center",justify:"space-between",children:[(0,y.jsx)(K.Text,{variant:"text",clsx:rj.default.key,children:"Provider"}),(0,y.jsx)(K.Text,{children:"Replit"})]}),(0,y.jsxs)(Q.View,{row:!0,gap:8,align:"center",justify:"space-between",children:[(0,y.jsx)(K.Text,{variant:"text",clsx:rj.default.key,children:"Age"}),(null==(r=e.domain.whois)?void 0:r.creationDate)?(0,y.jsx)(rw.Timestamp,{date:new Date(e.domain.whois.creationDate),dateFormat:"relative"}):(0,y.jsx)(y.Fragment,{children:rT})]})]}),(0,y.jsxs)(Q.View,{gap:8,grow:!0,shrink:!0,children:[(0,y.jsxs)(Q.View,{row:!0,gap:8,align:"center",justify:"space-between",children:[(0,y.jsx)(K.Text,{variant:"text",clsx:rj.default.key,children:e.domain.autorenew?"Renewal date":"Expiration date"}),(null==(i=e.domain.whois)?void 0:i.expiryDate)?(0,y.jsx)(rw.Timestamp,{date:new Date(e.domain.whois.expiryDate),dateFormat:"absolute",absoluteFormat:{year:"numeric",month:"short",day:"numeric"}}):(0,y.jsx)(K.Text,{children:rT})]}),(0,y.jsxs)(Q.View,{row:!0,gap:8,align:"center",justify:"space-between",children:[(0,y.jsx)(K.Text,{variant:"text",clsx:rj.default.key,children:"Renewal price"}),(0,y.jsx)(K.Text,{children:"number"==typeof e.domain.renewalPriceCents?"$".concat((e.domain.renewalPriceCents/100).toFixed(2)):rT})]}),(0,y.jsxs)(Q.View,{row:!0,gap:8,align:"center",justify:"space-between",children:[(0,y.jsx)(K.Text,{variant:"text",clsx:rj.default.key,children:"Auto renewal"}),(0,y.jsx)(tc.Switch,{size:"small",isSelected:e.domain.autorenew,onChange:function(t){s({variables:{input:{domainId:e.domain.id,shouldAutoRenew:t}}})},isReadOnly:l,"aria-label":"Toggle auto renewal"})]})]})]})}function rD(e){var t,n,r,i,o,a,s,l=(null==(n=e.domain.whois)||null==(t=n.registrar)?void 0:t.trim())||null;return l&&(null!=(s=null==(o=e.dns)||null==(i=o.currentDnsRecords)||null==(r=i.A)?void 0:r.length)?s:0)>1&&(l+=" (Proxy)"),(0,y.jsxs)(Q.View,{clsx:rj.default.sectionRow,row:!0,gap:70,py:8,children:[(0,y.jsx)(Q.View,{gap:8,children:(0,y.jsxs)(Q.View,{row:!0,gap:8,align:"center",justify:"space-between",children:[(0,y.jsx)(K.Text,{variant:"text",clsx:rj.default.key,children:"Provider"}),(0,y.jsx)(K.Text,{children:null!=l?l:"Unknown"})]})}),(0,y.jsx)(Q.View,{gap:8,children:(0,y.jsxs)(Q.View,{row:!0,gap:8,align:"center",justify:"space-between",children:[(0,y.jsx)(K.Text,{variant:"text",clsx:rj.default.key,children:"Age"}),(null==(a=e.domain.whois)?void 0:a.creationDate)?(0,y.jsx)(rw.Timestamp,{date:new Date(e.domain.whois.creationDate),dateFormat:"relative"}):(0,y.jsx)(K.Text,{children:rT})]})})]})}function rO(e){var t=(0,x._)((0,b.useState)(null),2),n=t[0],r=t[1];return(0,y.jsxs)(Q.View,{clsx:rj.default.accordionCard,children:[(0,y.jsx)(rm.AccordionItem,{chevron:"none",round:!1,headerContent:function(e){var t=e.isExpanded;return(0,y.jsxs)(Q.View,{clsx:rj.default.dnsRecordsAccordionHeader,grow:!0,children:[(0,y.jsxs)(Q.View,{gap:2,grow:!0,children:[(0,y.jsx)(K.Text,{children:"DNS Records"}),(0,y.jsx)(K.Text,{variant:"small",color:"dimmer",children:"Manually configure your domains DNS records"})]}),t?(0,y.jsx)(r_.default,{}):(0,y.jsx)(rS.default,{})]})},defaultExpanded:!1,variant:"compact",children:e.dns?(0,y.jsxs)(y.Fragment,{children:[(0,y.jsx)(nY,{dnsRecords:e.domain.dnsRecords.map(function(t){var n,r=null!=(n=t.host)?n:"",i=eZ(r?"".concat(r,".").concat(e.domain.domain):e.domain.domain);return{id:String(t.id),type:t.type,hostname:i,record:t.answer}}),noBorder:!0,actions:function(e){return(0,y.jsx)(z.IconButton,{alt:"Delete this record",onClick:function(){return r(e)},children:(0,y.jsx)(tg.default,{})})}}),(0,y.jsx)(rB,(0,er._)({},e))]}):null}),(0,y.jsx)(rN,(0,eS._)((0,er._)({},e),{record:n,isOpen:!!n,onRequestClose:function(){return r(null)}}))]})}function rN(e){var t,n=(0,x._)((t=(0,er._)({},nb,void 0),t2.useMutation(nT,t)),2),r=n[0],i=n[1].loading,o=(0,tr.default)().showError;return e.record?(0,y.jsx)(rb.Modal,{isOpen:e.isOpen,onRequestClose:e.onRequestClose,centered:!0,maxWidth:480,children:(0,y.jsx)(rv.default,{prompt:"Delete this record?",desc:(0,y.jsxs)(K.Text,{children:["You are about to delete the ",e.record.type," record for"," ",(0,y.jsx)("b",{children:e.record.hostname}),". This action cannot be undone."]}),confirmText:"Delete",danger:!0,icon:(0,y.jsx)(tg.default,{}),loading:i,onCancel:e.onRequestClose,onConfirm:function(){return(0,D._)(function(){var t;return(0,O._)(this,function(n){switch(n.label){case 0:if(!e.record)return[2];n.label=1;case 1:return n.trys.push([1,3,4,5]),[4,r({variables:{input:{domainId:e.domain.id,recordId:Number(e.record.id)}}})];case 2:if((t=n.sent()).errors||!t.data)return o("Something went wrong"),[2];if("DeleteDnsRecordOutput"!==t.data.deleteDnsRecord.__typename)return o(t.data.deleteDnsRecord.message),[2];return[3,5];case 3:return n.sent(),o("Something went wrong"),[2];case 4:return e.onRequestClose(),[7];case 5:return[2]}})})()}})}):null}function rM(e){if(!e.dns)return null;var t=nQ(e.dns);return(0,y.jsx)(Q.View,{clsx:rj.default.accordionCard,children:(0,y.jsxs)(Q.View,{children:[(0,y.jsx)(Q.View,{clsx:rj.default.dnsRecordsStaticHeader,grow:!0,children:(0,y.jsxs)(Q.View,{gap:2,grow:!0,children:[(0,y.jsx)(K.Text,{children:"DNS Records"}),(0,y.jsxs)(K.Text,{variant:"small",color:"dimmer",children:["Add the following records to your domain's DNS settings."," ",(0,y.jsx)(L.default,{href:"https://docs.replit.com/cloud-services/deployments/custom-domains",target:"_blank",rel:"noopener",children:"Learn more"})]})]})}),e.dns?(0,y.jsx)(nY,{dnsRecords:t,showCopyButton:!0,noBorder:!0}):null]})})}function rL(e,t){var n=e.trim();if(n===t)return{error:'Use "@" instead of "'.concat(t,'" for the root domain'),userMessage:'You cannot use "'.concat(t,'" as the hostname. Use "@" instead if you want to configure the root domain.')};if(n.endsWith(".".concat(t))){var r=n.slice(0,-(t.length+1));return{error:'Use just "'.concat(r,'" without "').concat(t,'"'),userMessage:'Do not include "'.concat(t,'" in the hostname. Use just "').concat(r,'" instead of "').concat(n,'".')}}return{error:null}}function rB(e){var t,n=(0,x._)((0,b.useState)(!1),2),r=n[0],i=n[1],o=(0,x._)((0,b.useState)(null),2),a=o[0],s=o[1],l=(0,x._)((0,b.useState)(null),2),u=l[0],c=l[1],d="MX"===a,f=(0,tr.default)().showError,p=(0,x._)((t=(0,er._)({},nb,void 0),t2.useMutation(nR,t)),2),h=p[0],g=p[1].loading;return r?(0,y.jsxs)(ta.Form,{onSubmit:function(t){return(0,D._)(function(){var n,r,o,a,l,u,p,g,m;return(0,O._)(this,function(x){switch(x.label){case 0:if(t.preventDefault(),r=(n=new FormData(t.target)).get("type"),o=n.get("hostname"),a=n.get("priority"),l=n.get("record"),"string"!=typeof r||""===r.trim())return f("Type is required"),[2];if("string"!=typeof o||""===o.trim())return f("Hostname is required"),[2];if((u=rL(o,e.domain.domain)).error)return u.userMessage&&f(u.userMessage),c(u.error),[2];if("string"!=typeof l||""===l.trim())return f("Record is required"),[2];if(p=d?Number(a):void 0,d){if(void 0===p||isNaN(p))return f("Priority must be provided as a number"),[2];if(p<0||p>65535)return f("Priority must be between 0 and 65535"),[2]}x.label=1;case 1:return x.trys.push([1,3,,4]),[4,h({variables:{input:{domainId:e.domain.id,host:o,type:r,answer:l,priority:p}}})];case 2:if((g=x.sent()).errors)return f("Something went wrong"),[2];if(!g.data)return[2];if("CreateDnsRecordOutput"!==g.data.createDnsRecord.__typename)return f(g.data.createDnsRecord.message),[2];return i(!1),s(null),c(null),[3,4];case 3:return m=x.sent(),(0,rg.sendSentryError)({error:(0,n8._)(m,Error)?m:Error(String(m)),context:"createDnsRecord",extras:{domainId:e.domain.id,hostname:o,type:r,record:l,priority:p}}),f("An unexpected error occurred. Please try again."),[3,4];case 4:return[2]}})})()},p:8,clsx:rj.default.accordionFooter,gap:12,children:[(0,y.jsxs)(Q.View,{clsx:[rj.default.addRow,(0,ek._)({},rj.default.addRowHasMx,d)],gap:12,align:"start",children:[(0,y.jsx)(Q.View,{children:(0,y.jsx)(tu.Select,{label:"Type",items:rE,placeholder:"Select type",onSelectionChange:function(e){s(e?String(e):null)},name:"type",isInvalid:!1,children:function(e){return(0,y.jsx)(ep.ListBoxItem,{id:e.value,label:e.label},e.value)}})}),(0,y.jsx)(Q.View,{children:(0,y.jsxs)(td.TextField,{isInvalid:!!u,children:[(0,y.jsx)(ts.Label,{children:"Hostname"}),(0,y.jsx)(e2.Input,{placeholder:"@",name:"hostname",autoComplete:"off",required:!0,onChange:function(t){c(rL(t.target.value,e.domain.domain).error)}}),(0,y.jsx)(to.FieldError,{children:u})]})}),d?(0,y.jsx)(Q.View,{children:(0,y.jsxs)(td.TextField,{children:[(0,y.jsx)(ts.Label,{children:"Priority"}),(0,y.jsx)(e2.Input,{placeholder:"10",type:"number",min:0,max:65535,name:"priority",autoComplete:"off",required:!0})]})}):null,(0,y.jsx)(Q.View,{grow:!0,children:(0,y.jsxs)(td.TextField,{children:[(0,y.jsx)(ts.Label,{children:"Record"}),(0,y.jsx)(e2.Input,{name:"record",autoComplete:"off",required:!0})]})})]}),(0,y.jsxs)(Q.View,{row:!0,justify:"end",align:"center",gap:8,children:[(0,y.jsx)($.Button,{variant:"nofill",text:"Cancel",onClick:function(){i(!1),s(null),c(null)},type:"button",disabled:g}),(0,y.jsx)($.Button,{text:g?"Adding...":"Add record",type:"submit",loading:g,disabled:g})]})]}):(0,y.jsx)(Q.View,{p:8,align:"end",clsx:rj.default.accordionFooter,children:(0,y.jsx)($.Button,{text:"Add DNS record",variant:"nofill",iconLeft:(0,y.jsx)(tI.default,{}),onClick:function(){s(null),i(!0),c(null)}})})}var rV=e.i(357399),rF=e.i(124489);function rU(){return(0,y.jsxs)(nz,{children:[(0,y.jsx)("th",{children:(0,y.jsx)(K.Text,{variant:"small",color:"dimmer",children:"Name"})}),(0,y.jsx)("th",{className:rF.default.hideOnTablet,children:(0,y.jsx)(K.Text,{variant:"small",color:"dimmer",children:"Registered With"})}),(0,y.jsx)("th",{children:(0,y.jsx)(nq,{children:"Actions"})})]})}function rG(e){var t=e.name,n=e.registrar,r=e.registrarTruncate,i=e.status,o=e.customMessage,a=e.isPrimaryDomain,s=void 0!==a&&a,l=e.isPendingDomain,u=void 0!==l&&l,c=e.onManage,d=s||u;return(0,y.jsxs)(nH,{children:[(0,y.jsx)(nW,{children:(0,y.jsxs)(Q.View,{gap:4,children:[(0,y.jsx)(K.Text,{children:t}),i?(0,y.jsx)(rh,{state:i,customMessage:o}):null]})}),(0,y.jsx)(nW,{clsx:rF.default.hideOnTablet,children:(0,y.jsx)(K.Text,{color:"dimmest",variant:"small",multiline:!r,showTooltipOnTruncate:!!r,children:null!=n?n:"N/A"})}),(0,y.jsx)(nW,{children:(0,y.jsx)(Q.View,{align:"center",justify:"center",p:12,children:(0,y.jsx)(Y.Tooltip,{tooltip:s?"The primary domain cannot be modified unless you unpublish the app and publish again.":u?"This domain is currently being configured.":void 0,isDisabled:!d,children:(0,y.jsx)($.Button,{text:"Manage",iconLeft:(0,y.jsx)(rV.default,{}),disabled:d,onClick:c,size:"small"})})})})]})}function r$(){var e=(0,ei._)(["\n  query DomainsGlowupPendingDomains($replId: String!) {\n    getRepl(id: $replId) {\n      ... on Repl {\n        ...PendingDomainsRepl\n      }\n    }\n  }\n  ","\n"]);return r$=function(){return e},e}function rz(){var e=(0,ei._)(["\n  subscription DomainsGlowupPendingDomainsUpdates($replId: String!) {\n    pendingDomainsUpdates(replId: $replId) {\n      id\n      ...PendingDomainsRepl\n    }\n  }\n  ","\n"]);return rz=function(){return e},e}var rH={},rW=(0,eo.gql)(r$(),tz.PendingDomainsReplFragmentDoc),rq=(0,eo.gql)(rz(),tz.PendingDomainsReplFragmentDoc);function rK(e){var t,n,r,i=e.refetchDomainsQuery,o=e.omitDomains,a=(0,x._)((0,b.useState)(new Set),2)[1],s=(0,tR.default)(),l=(t={variables:{replId:s},fetchPolicy:"cache-and-network",ssr:!1},n=(0,er._)({},rH,t),ea.useQuery(rW,n)).data;r=(0,er._)({},rH,{variables:{replId:s},onData:function(e){var t,n,r=e.data;if(r&&(null==(n=r.data)||null==(t=n.pendingDomainsUpdates)?void 0:t.pendingDomains)){var o=r.data.pendingDomainsUpdates.pendingDomains.filter(function(e){return"success"===e.status}).map(function(e){return e.domainName});a(function(e){var t=new Set((0,T._)(e).concat((0,T._)(o)));return t.size>e.size&&i(),t})}}}),t3.useSubscription(rq,r);var u=(0,b.useMemo)(function(){var e;return(null==l||null==(e=l.getRepl)?void 0:e.__typename)!=="Repl"?null:l.getRepl.pendingDomains.filter(function(e){return!o.has(e.domainName)&&"fail"!==e.status})},[l,o]);return u&&0!==u.length?(0,y.jsx)(y.Fragment,{children:u.map(function(e){var t;return(0,y.jsx)(rG,{name:e.domainName,status:"verifying",customMessage:null!=(t=e.message)?t:"Processing request",isPendingDomain:!0},e.domainName)})}):null}var rY=e.i(142365),rQ=e.i(609141);function rX(e){var t,n,r,i,o,a,s,l,u,c,d,f,p,h,g=e.deployment,m=e.authorizations,w=e.viewData,k=(0,tR.default)(),_=(t={variables:{id:k}},n=(0,er._)({},nt,t),ea.useQuery(no,n)),S=_.data,C=_.loading,j=(null==S||null==(l=S.getRepl)?void 0:l.__typename)==="Repl"&&!!(null==(u=S.getRepl.org)?void 0:u.id),R=(0,x._)((0,b.useState)(!!(null==w?void 0:w.buyDomain)),2),I=R[0],D=R[1],O=(0,x._)((0,b.useState)(!1),2),N=O[0],M=O[1],L=(0,x._)((0,b.useState)(new Set),2),B=L[0],V=L[1],F=(r={variables:{id:g.id,isGlowup:!0},fetchPolicy:"cache-and-network",ssr:!1},i=(0,er._)({},nt,r),ea.useQuery(na,i)).refetch;o=(0,er._)({},nb,{variables:{replId:k},onData:function(e){var t,n,r=e.data,i=e.client;if(null==r||null==(n=r.data)||null==(t=n.domainLinkingStatusUpdates)?void 0:t.domainLinkingStatuses){var o=r.data.domainLinkingStatusUpdates.domainLinkingStatuses,a=new Set(o.map(function(e){return e.domainId}));B.forEach(function(e){if(!a.has(e)){var t=null==z?void 0:z.find(function(t){return t.id===e}),n=(null==t?void 0:t.state)==="verifying"||(null==t?void 0:t.state)==="temporal_verification"||(null==t?void 0:t.state)==="pushed_to_goval";t&&n&&i.cache.modify({id:i.cache.identify({__typename:"Domain",id:e}),fields:{state:function(){return"verified"}}})}}),V(a),o.some(function(e){return"completed"===e.currentStatus||"failed"===e.currentStatus})&&F()}}}),t3.useSubscription(nA,o);var U=(a={fetchPolicy:"cache-and-network",ssr:!1},s=(0,er._)({},nt,a),ea.useQuery(ns,s)).data,G=null==U||null==(d=U.currentUser)||null==(c=d.domains)?void 0:c.items,z=(null==g?void 0:g.__typename)==="HostingDeployment"?g.domains2:void 0,H=(0,b.useMemo)(function(){return new Set((0,T._)((null!=z?z:[]).map(function(e){return e.domain})).concat((0,T._)((null!=G?G:[]).map(function(e){return e.domain}))).map(function(e){return e}))},[z,G]),W=(null==g?void 0:g.currentBuild.status)==="success",q=null==g?void 0:g.repl.apexProxy,X=null==z?void 0:z.some(function(e){return e.managed&&5>(0,E.differenceInDays)(new Date,new Date(e.timeCreated))}),J=(0,x._)((0,b.useState)(null),2),ee=J[0],et=J[1],en=ee&&null!=(f=null==z?void 0:z.find(function(e){return e.id===ee}))?f:null,ei=(0,P.useDeploymentCurrentBuild)(),eo=ei?function(e){var t=(null==(n=e.repl.hostingDeployment)?void 0:n.__typename)==="HostingDeployment"?null==(r=e.repl.hostingDeployment)?void 0:r.replitAppSubdomain:void 0;if(!t&&(null==(i=e.repl.owner)?void 0:i.username)&&(t="".concat(e.repl.slug,"-").concat(e.repl.owner.username)),t){var n,r,i,o,a,s=(null==(a=window)||null==(o=a.location)?void 0:o.hostname)!=="replit.com";return"".concat(t).concat(s?".staging":"",".").concat(A.DEPLOYMENTS_DEFAULT_DOMAIN)}}(ei):void 0,es=m.addCustomDomain,el=es.isAuthorized,eu=es.message;return((0,rY.useTrackEffect)(ef.events.DOMAIN_MANAGEMENT,{action:"page_landing",deploymentId:g.id,domainCount:null!=(p=null==z?void 0:z.length)?p:0,hasCustomDomains:null!=(h=null==z?void 0:z.some(function(e){return!e.managed}))&&h,isInitiative:"glowup"}),I&&q)?(0,y.jsx)(Q.View,{clsx:rQ.default.buyWrapper,gap:8,children:(0,y.jsx)(ew,{suggestedDomain:null==g?void 0:g.repl.title,deploymentId:g.id,onRequestClose:function(){D(!1)}})}):en?(0,y.jsx)(Q.View,{css:rQ.default.scrollContainer,gap:8,children:(0,y.jsx)(rR,{domain:en,onBack:function(){return et(null)},deploymentId:g.id,dns:q?{replId:k,apexProxy:q,hostname:en.domain,currentDnsRecords:en.currentDnsRecords}:void 0})}):N&&q?(0,y.jsx)(Q.View,{clsx:rQ.default.buyWrapper,gap:8,px:4,pt:8,children:(0,y.jsx)(n2,{apexProxy:q,deploymentId:g.id,replId:k,onAdd:function(){return M(!1)},onBack:function(){return M(!1)}})}):(0,y.jsxs)(Q.View,{gap:16,clsx:rQ.default.scrollContainer,shrink:!0,px:8,children:[(0,y.jsxs)(Q.View,{justify:"space-between",py:12,row:!0,align:"center",children:[(0,y.jsx)(K.Text,{variant:"subheadDefault",children:"Domains"}),(0,y.jsxs)(Q.View,{shrink:!0,gap:8,row:!0,children:[(0,y.jsx)(Y.Tooltip,{tooltip:j?"Custom domain purchasing is coming soon to org-owned Apps.":eu,isDisabled:el&&!j,children:(0,y.jsx)($.Button,{text:"Buy a new domain",variant:"outlined",size:"small",onClick:function(){(0,ed.track)(ef.events.DOMAIN_MANAGEMENT,{action:"buy_domain_clicked",deploymentId:g.id,suggestedDomain:null==g?void 0:g.repl.title,isInitiative:"glowup"}),D(!0)},disabled:!W||!el||j||C})}),(0,y.jsx)(Y.Tooltip,{tooltip:eu,isDisabled:el,children:(0,y.jsx)($.Button,{disabled:!W||!el,text:"Connect your own domain",variant:"outlined",size:"small",onClick:function(){(0,ed.track)(ef.events.DOMAIN_MANAGEMENT,{action:"link_domain_clicked",deploymentId:g.id,suggestedDomain:null==g?void 0:g.repl.title,isInitiative:"glowup"}),M(!0)}})})]})]}),W?null:(0,y.jsx)(tQ.StatusBanner,{colorway:"warning",icon:(0,y.jsx)(Z.default,{}),text:"You must successfully publish your project before linking a domain"}),(0,y.jsxs)(n$,{children:[(0,y.jsx)(rU,{}),eo?(0,y.jsx)(rG,{name:eo,isPrimaryDomain:!0}):null,null==z?void 0:z.map(function(e){var t,n,r,i,o,a=null!=(i=null==(t=e.whois)?void 0:t.registrar)?i:null;return a&&(null!=(o=null==(r=e.currentDnsRecords)||null==(n=r.A)?void 0:n.length)?o:0)>1&&(a+=" (Proxy)"),(0,y.jsx)(rG,{name:e.domain,registrar:e.managed?"Replit":null!=a?a:"Unknown",status:e.state,onManage:function(){(0,ed.track)(ef.events.DOMAIN_MANAGEMENT,{action:"manage_clicked",domainName:e.domain,domainId:e.id,domainState:e.state,managed:!!e.managed,isInitiative:"glowup"}),et(e.id)}},e.id)}),(0,y.jsx)(rK,{refetchDomainsQuery:F,omitDomains:H})]}),X?(0,y.jsx)(rJ,{}):null]})}function rJ(){return(0,y.jsx)(tQ.StatusBanner,{icon:(0,y.jsx)(tX.default,{}),title:"Congratulations on your new domain!",text:"You may see a temporary error when accessing your domain that usually resolves within a few minutes after purchasing. Contact Replit Support if this persists longer than 48 hours."})}var rZ=(0,U.cssRecord)({domains2Container:[G.rcss.height("100%"),G.rcss.overflowY("hidden")]}),r0={addCustomDomain:{__typename:"ReplAuthorization",isAuthorized:!1,code:k.ReplAuthorizationCode.InsufficientPermissions,message:"Loading"},deleteCustomDomain:{__typename:"ReplAuthorization",isAuthorized:!1,code:k.ReplAuthorizationCode.InsufficientPermissions,message:"Loading"}};function r1(e){var t=e.deploymentId,n=e.viewData;return t?(0,y.jsx)(r2,{deploymentId:t,viewData:n}):(0,y.jsx)(C.PaneSection,{children:(0,y.jsx)(tQ.StatusBanner,{colorway:"warning",icon:(0,y.jsx)(Z.default,{}),text:"Deployment not found"})})}function r2(e){var t,n,r=e.deploymentId,i=e.viewData;(0,b.useEffect)(function(){(0,_.trackDeploymentSectionViewed)({context:S.Views.Domains})},[]);var o=(0,x._)((0,w.useHostingDeploymentSettingsAuthzLazyQuery)(),2),a=o[0],s=o[1],l=s.data,u=s.error,c=(0,eb.useFlag)({controlName:"flag-domains-glowup",default:!1}),d=(0,w.useHostingDeploymentSettingsQuery)({variables:{id:r,isGlowup:c},ssr:!1,fetchPolicy:"cache-and-network",onCompleted:function(e){var t;(null==e||null==(t=e.hostingDeployment)?void 0:t.__typename)==="HostingDeployment"&&a({variables:{replId:e.hostingDeployment.repl.id,provider:e.hostingDeployment.currentBuild.provider}})}}),f=d.data,p=d.loading,h=d.error,g=(null==f||null==(t=f.hostingDeployment)?void 0:t.__typename)==="HostingDeployment"?f.hostingDeployment:void 0;if(h)return(0,y.jsx)(j.ViewError,{text:h.message});if(p||!g)return(0,y.jsx)(C.PaneSection,{centered:!0,children:(0,y.jsx)(j.ViewLoading,{})});if(g.currentBuild.provider===k.HostingBuildProvider.Cron)return(0,y.jsx)(C.PaneSection,{children:(0,y.jsx)(tQ.StatusBanner,{colorway:"warning",text:"Domains are not supported for scheduled jobs"})});var m=(null==l||null==(n=l.getRepl)?void 0:n.__typename)==="Repl"?l.getRepl.authorizations:r0;return(0,y.jsxs)(C.PaneSection,{maxWidth:!0,clsx:c?void 0:rZ.domains2Container,children:[u?(0,y.jsx)(tQ.StatusBanner,{colorway:"negative",text:u.message}):null,(0,y.jsx)(c?rX:t0,{deployment:g,authorizations:m,viewData:i})]})}e.s(["Domains",()=>r1],918560);var r3=e.i(302973),r4=e.i(131141);function r8(){var e=(0,ei._)(["\n  fragment ReplLogLine2 on ReplLog {\n    __typename\n    timestamp\n    line\n    level\n    isFromReplit\n    deploymentId\n    executionId\n    buildId\n  }\n"]);return r8=function(){return e},e}function r5(){var e=(0,ei._)(["\n  query HostingDeploymentLogs2(\n    $replId: String!\n    $deploymentId: String!\n    $executionId: String\n    $start: DateTime\n    $end: DateTime\n    $message: String\n    $level: LogLevel\n    $limit: Int\n  ) {\n    getRepl(id: $replId) {\n      ... on Repl {\n        id\n        __typename\n        hostingDeploymentLogs(\n          deploymentId: $deploymentId\n          executionId: $executionId\n          start: $start\n          end: $end\n          message: $message\n          level: $level\n          limit: $limit\n        ) {\n          ... on ReplLogs {\n            result {\n              ...ReplLogLine2\n            }\n          }\n          ... on NotFoundError {\n            message\n          }\n          ... on ServiceUnavailable {\n            message\n          }\n        }\n      }\n      ... on Error {\n        message\n      }\n    }\n  }\n  ","\n"]);return r5=function(){return e},e}function r6(){var e=(0,ei._)(["\n  subscription HostingDeploymentLogUpdates(\n    $input: HostingDeploymentLogUpdatesInput!\n  ) {\n    hostingDeploymentLogUpdates(input: $input) {\n      ...ReplLogLine2\n    }\n  }\n  ","\n"]);return r6=function(){return e},e}var r9={},r7=(0,eo.gql)(r8()),ie=(0,eo.gql)(r5(),r7),it=(0,eo.gql)(r6(),r7),ir=e.i(180703),ii=e.i(649960),io=(0,b.createContext)(null),ia=function(){var e=(0,b.useContext)(io);if(!e)throw Error("Expected log context in context");return e},is=function(e){var t,n,r,i,o=e.deploymentId,a=e.replId,s=e.executionId,l=e.openFile,u=(0,x._)((0,b.useState)(null),2),c=u[0],d=u[1],f=(0,x._)((0,b.useState)([]),2),p=f[0],h=f[1],g=(0,x._)((0,b.useState)(),2),m=g[0],y=g[1],w=(0,x._)((0,b.useState)({message:"",executionId:s,start:null,end:null,level:null}),2),k=w[0],_=w[1],S=(0,b.useCallback)(function(){return _({message:"",executionId:s,start:null,end:null,level:null})},[s]),C=(0,x._)((0,b.useState)(!0),2),j=C[0],E=C[1],R=(0,x._)((0,b.useState)(!1),2),I=R[0],A=R[1],P=(0,x._)((0,b.useState)(!1),2),N=P[0],M=P[1],L=(0,x._)((0,b.useState)(!1),2),B=L[0],V=L[1],F=(0,x._)((0,ir.default)("deployments-logs-color",!0),2),U=F[0],G=F[1],$=(0,b.useRef)(!1),z=(0,ii.default)(function(e){var t=e.width;if(void 0!==t){var n=t>500;M(n),$.current||($.current=!0,A(n))}}),H=(0,r3.getLocalTimeZone)(),W=(t={ssr:!1,fetchPolicy:"network-only",variables:{deploymentId:o,replId:a,executionId:k.executionId?"d-scheduled-".concat(o,"-").concat(k.executionId):void 0,limit:k.start||k.end?1e3:100,level:k.level,message:k.message,start:null==(r=k.start)?void 0:r.toDate(H).toISOString(),end:null==(i=k.end)?void 0:i.toDate(H).toISOString()},onError:function(){y("Something went wrong"),h([])},onCompleted:function(e){if("hostingDeploymentLogs"in e.getRepl)if("ReplLogs"===e.getRepl.hostingDeploymentLogs.__typename){y(void 0);var t=e.getRepl.hostingDeploymentLogs.result,n=(0,T._)(t).reverse();if(!c)if(t.length>0){var r=new Date(t[0].timestamp);r.setSeconds(r.getSeconds()+1),d(r.toISOString())}else d(new Date().toISOString());h(n)}else y(e.getRepl.hostingDeploymentLogs.message),h([])}},n=(0,er._)({},r9,t),ea.useQuery(ie,n)),q=W.loading,K=W.fetchMore,Y=W.subscribeToMore,Q=W.variables;(0,b.useEffect)(function(){q&&d(null)},[q]),(0,b.useEffect)(function(){d(null),Z.current=!1,X.current=null},[k,o,a,s]),(0,b.useEffect)(function(){var e,t;if(c)return Y({document:it,variables:{input:{deploymentId:o,executionId:s,message:k.message,start:k.end?null==(e=k.start)?void 0:e.toDate(H).toISOString():c,end:null==(t=k.end)?void 0:t.toDate(H).toISOString(),level:k.level||void 0}},updateQuery:function(e,t){var n=t.subscriptionData;return(0,r4.produce)(e,function(e){if(!("hostingDeploymentLogs"in e.getRepl))return e;if("ReplLogs"===e.getRepl.hostingDeploymentLogs.__typename){var t=n.data.hostingDeploymentLogUpdates;(0===e.getRepl.hostingDeploymentLogs.result.length||t.timestamp>=e.getRepl.hostingDeploymentLogs.result[0].timestamp)&&e.getRepl.hostingDeploymentLogs.result.unshift(t)}return e})}})},[Y,o,s,q,k,c,H]);var X=(0,b.useRef)(null),J=(0,b.useRef)(!1),Z=(0,b.useRef)(!1),ee=(0,b.useCallback)(function(){return(0,D._)(function(){var e,t,n,r,i;return(0,O._)(this,function(o){switch(o.label){case 0:if(e=X.current?Math.abs(X.current.getTime()-Date.now()):0,k.start||k.end||q||X.current&&e<500||Z.current||J.current||0===p.length)return[2];return(t=new Date(p[0].timestamp)).setSeconds(t.getSeconds()-1),n=t.toISOString(),J.current=!0,[4,K({variables:(0,eS._)((0,er._)({},Q),{end:n})})];case 1:return r=o.sent().data,J.current=!1,"hostingDeploymentLogs"in r.getRepl&&"ReplLogs"===r.getRepl.hostingDeploymentLogs.__typename&&(X.current=new Date,0===r.getRepl.hostingDeploymentLogs.result.length?Z.current=!0:(i=r.getRepl.hostingDeploymentLogs.result,h(function(e){for(var t=[],n=i.length-1;n>=0;n--)(0===e.length||i[n].timestamp<e[0].timestamp)&&t.push(i[n]);return(0,T._)(t).concat((0,T._)(e))}))),[2]}})})()},[K,q,p,Q,k.start,k.end]);return(0,b.useMemo)(function(){return{logs:p,loading:q,error:m,fetchPage:ee,isLive:j,setIsLive:E,isExpanded:I,setIsExpanded:A,filter:k,setFilter:_,clearFilter:S,deploymentId:o,containerRef:z,isWide:N,isWrapped:B,setIsWrapped:V,openFile:l,isColorful:U,setIsColorful:G}},[S,z,o,m,ee,k,U,I,j,N,B,q,p,l,G])},il=e.i(143003),iu=e.i(790486),ic=e.i(906368),id=e.i(417751),ip=e.i(760129),ih=e.i(933572),ig=e.i(301141),im=(0,U.cssRecord)({root:[G.rcss.transition.none,G.rcss.reset.button,G.rcss.flex.row,G.rcss.align.center,G.rcss.font.code,G.rcss.fontSize(12),G.rcss.textAlign.left,G.rcss.position.absolute,G.rcss.top(0),G.rcss.left(0),G.rcss.width("100%"),G.rcss.color.foregroundDefault,G.rcss.border({color:F.tokens.outlineDimmest,direction:"bottom"}),G.rcss.highRes({borderWidth:.5}),{outline:"none",userSelect:"auto","--cell-background":"".concat(F.tokens.backgroundDefault),"&:hover":{backgroundColor:F.tokens.interactiveBackground,"--cell-background":"".concat(F.tokens.interactiveBackground),".copy":{display:"block"}},'&[data-error="true"]':[G.rcss.colorMixBg(F.tokens.accentNegativeDimmest,"transparent"),{borderBottomColor:F.tokens.accentNegativeDimmest,boxShadow:"0 -1px 0 0 "+F.tokens.accentNegativeDimmest,"&:hover":{"--cell-background":"".concat(F.tokens.accentNegativeDimmest),backgroundColor:"var(--cell-background) !important"},"&:active":{boxShadow:"0 -1px 0 0 "+F.tokens.accentPrimaryDefault}},G.rcss.highRes({boxShadow:"0 -0.5px 0 0 "+F.tokens.accentNegativeDimmest,"&:active":{boxShadow:"0 -0.5px 0 0 "+F.tokens.accentPrimaryDefault}})]}],primaryCell:[G.rcss.display.block,G.rcss.pl(6),G.rcss.py(6),G.rcss.pr(4),G.rcss.flex.growAndShrink(1),G.rcss.minHeight(26),{whiteSpace:"nowrap",'&[data-wrapped="true"]':{whiteSpace:"normal"},'&[data-new-flag="false"]':{cursor:"pointer",overflow:"hidden",textOverflow:"ellipsis",'&[data-wrapped="true"]':{whiteSpace:"normal"}},a:{color:"inherit","&:hover":{textDecoration:"underline"}}}],secondaryCell:[G.rcss.p(6),G.rcss.color.foregroundDimmest,G.rcss.truncate,{'&[data-error="true"]':G.rcss.color.accentNegativeStrongest}],copyColumn:[{display:"none",position:"absolute",top:"50%",zIndex:1,left:"calc(var(--width) + var(--scroll-left-offset))",transform:"translate(-100%, -50%)"}],copyButton:[{backgroundColor:"var(--cell-background) !important",color:"inherit"}]}),iv=(0,b.memo)(function(e){var t=e.log,n=e.y,r=e.height,i=e.resizeRef,o=e.index,a=e.isScrolling,s=e.columns,l=ia(),u=l.isWrapped,c=l.isColorful&&t.level===k.LogLevel.Error&&["INFO","DEBUG","TRACE"].every(function(e){return!t.line.includes(e)}),d=(0,b.useMemo)(function(){return(0,ig.default)(t.line)},[t.line]);return(0,y.jsxs)("div",{tabIndex:0,role:"button",title:d,css:im.root,style:{height:r,transform:"translateY(".concat(n,"px)")},"data-error":c,children:[s.map(function(e,n){var r=n===s.length-1,a=e.renderCell(t);return(0,y.jsx)(Q.View,{css:r?im.primaryCell:im.secondaryCell,style:{width:e.width},innerRef:r?i:void 0,"data-index":o,"data-error":c,"data-wrapped":u,children:a},e.key)}),(0,y.jsx)("span",{css:im.copyColumn,className:"copy",children:!a&&(0,y.jsx)(ti.CopyIconButton,{textToCopy:d,tooltipDisable:!0,css:im.copyButton})})]})}),ix=e.i(904851),iy=e.i(90659),ib=e.i(367024),iw=e.i(855312),ik={black:"#2e3436",red:"#cc0000",green:"#4e9a06",yellow:"#c4a000",blue:"#3465a4",magenta:"#75507b",cyan:"#06989a",white:"#d3d7cf","bright-black":"#555753","bright-red":"#ef2929","bright-green":"#8ae234","bright-yellow":"#fce94f","bright-blue":"#729fcf","bright-magenta":"#ad7fa8","bright-cyan":"#34e2e2","bright-white":"#eeeeec"},i_=/^(?:\x1b\[([\x3c-\x3f]?)([\d;]*)([\x20-\x2f]?[\x40-\x7e]))|(?:\x1b\[[\x20-\x7e]*([\x00-\x1f:]))/,iS=/^\x1b\]8;[\x20-\x3a\x3c-\x7e]*;([\x21-\x7e]{0,512})(?:(?:\x1b\\)|(?:\x07))([\x20-\x7e]+)\x1b\]8;;(?:(?:\x1b\\)|(?:\x07))/,iC=/(?:(\x1b\\)|(\x07))|([\x00-\x06]|[\x08-\x1a]|[\x1c-\x1f])/g,ij=function(){function e(t){(0,ix._)(this,e),this.lastIndex=0,this.input=t}return(0,iy._)(e,[{key:"next",value:function(){var e=this.input.substring(this.lastIndex),t=e.length;if(0===t)return{value:null,done:!0};var n={kind:0,text:"",url:""},r=e.indexOf("\x1b");if(-1===r)return n.kind=1,n.text=e,this.lastIndex+=t,{value:n,done:!1};if(r>0)return n.kind=1,n.text=e.slice(0,r),this.lastIndex+=r,{value:n,done:!1};if(t<3)return{value:null,done:!0};var i=e.charAt(1);if("["!==i&&"]"!==i&&"("!==i)return n.kind=2,n.text=e[0],this.lastIndex+=1,{value:n,done:!1};if("["===i){var o=e.match(i_);return null===o?{value:null,done:!0}:(o[4]?(n.kind=2,n.text=e[0],this.lastIndex+=1):(""!==o[1]||"m"!==o[3]?n.kind=3:n.kind=4,n.text=o[2],this.lastIndex+=o[0].length),{value:n,done:!1})}if("]"===i){if(t<4)return{value:null,done:!0};if("8"!==e.charAt(2)||";"!==e.charAt(3))return n.kind=2,n.text=e[0],this.lastIndex+=1,{value:n,done:!1};var a=new RegExp(iC),s=a.exec(e);if(null===s)return{value:null,done:!0};if(s[3])return n.kind=2,n.text=e[0],this.lastIndex+=1,{value:n,done:!1};var l=a.exec(e);if(null===l)return{value:null,done:!0};if(l[3])return n.kind=2,n.text=e[0],this.lastIndex+=1,{value:n,done:!1};var u=e.match(iS);return null===u?(n.kind=2,n.text=e[0],this.lastIndex+=1):(n.kind=5,n.url=u[1],n.text=u[2],this.lastIndex+=u[0].length),{value:n,done:!1}}return"("===i?(n.kind=3,this.lastIndex+=3,{value:n,done:!1}):{value:null,done:!0}}},{key:Symbol.iterator,value:function(){return this}}]),e}(),iT=Array(14);iT[0]="background-color",iT[1]="color",iT[2]="font-family",iT[3]="font-size",iT[4]="font-style",iT[5]="font-weight",iT[6]="opacity",iT[7]="outline",iT[8]="text-decoration",iT[9]="text-decoration-color",iT[10]="text-decoration-line",iT[11]="text-decoration-style",iT[12]="vertical-align",iT[13]="visibility";var iE=function(){function e(){(0,ix._)(this,e),this.attrArray=Array(14),this._size=0}return(0,iy._)(e,[{key:"get",value:function(e){return this.attrArray[e]}},{key:"set",value:function(e,t){var n=this.attrArray[e];this.attrArray[e]=t,void 0===n&&void 0!==t&&(this._size+=1)}},{key:"delete",value:function(e){var t=this.attrArray[e];this.attrArray[e]=void 0,void 0!==t&&(this._size-=1)}},{key:"update",value:function(e){for(var t in e)if(e.hasOwnProperty(t)){var n=e[t];this.attrArray[t]=n,void 0!==n&&(this._size+=1)}}},{key:"clear",value:function(){this.attrArray.fill(void 0),this._size=0}},{key:"size",get:function(){return this._size}},{key:"toString",value:function(){var e="";return this.attrArray.forEach(function(t,n){void 0!==t&&(e+="".concat(iT[n],":").concat(t,";"))}),e}}],[{key:"delete",value:function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return function(e){t.forEach(function(t){e.delete(t)})}}},{key:"appendVal",value:function(e,t){return function(n){var r=n.get(e),i=r?r.split(" "):[];i.includes(t)||i.push(t),n.set(e,i.join(" "))}}},{key:"removeVal",value:function(e,t){return function(n){var r=n.get(e),i=r?r.split(" "):[];(i=i.filter(function(e){return e!==t})).length?n.set(e,i.join(" ")):n.delete(e)}}}]),e}();(0,ib.default)(),(0,ib.default)({onlyFirst:!0});var iR=Array(108);iR[0]={5:"var(--ansi-bold-font-weight, 600)"},iR[1]={5:"var(--ansi-bold-font-weight, 600)"},iR[2]={6:"var(--ansi-dim-opacity, 0.7)"},iR[3]={4:"italic"},iR[4]=iE.appendVal(8,"underline"),iR[8]={13:"hidden"},iR[9]=iE.appendVal(8,"line-through"),iR[10]=iE.delete(2),iR[11]={2:"var(--ansi-font-1)"},iR[12]={2:"var(--ansi-font-2)"},iR[13]={2:"var(--ansi-font-3)"},iR[14]={2:"var(--ansi-font-4)"},iR[15]={2:"var(--ansi-font-5)"},iR[16]={2:"var(--ansi-font-6)"},iR[17]={2:"var(--ansi-font-7)"},iR[18]={2:"var(--ansi-font-8)"},iR[19]={2:"var(--ansi-font-9)"},iR[21]={10:"underline",11:"double"},iR[22]=iE.delete(5),iR[23]=iE.delete(4),iR[24]=iE.removeVal(8,"underline"),iR[28]=iE.delete(13),iR[29]=iE.removeVal(8,"line-through"),iR[30]={1:"var(--ansi-black, ".concat(ik.black,")")},iR[31]={1:"var(--ansi-red, ".concat(ik.red,")")},iR[32]={1:"var(--ansi-green, ".concat(ik.green,")")},iR[33]={1:"var(--ansi-yellow, ".concat(ik.yellow,")")},iR[34]={1:"var(--ansi-blue, ".concat(ik.blue,")")},iR[35]={1:"var(--ansi-magenta, ".concat(ik.magenta,")")},iR[36]={1:"var(--ansi-cyan, ".concat(ik.cyan,")")},iR[37]={1:"var(--ansi-white, ".concat(ik.white,")")},iR[39]=iE.delete(1),iR[40]={0:"var(--ansi-black, ".concat(ik.black,")")},iR[41]={0:"var(--ansi-red, ".concat(ik.red,")")},iR[42]={0:"var(--ansi-green, ".concat(ik.green,")")},iR[43]={0:"var(--ansi-yellow, ".concat(ik.yellow,")")},iR[44]={0:"var(--ansi-blue, ".concat(ik.blue,")")},iR[45]={0:"var(--ansi-magenta, ".concat(ik.magenta,")")},iR[46]={0:"var(--ansi-cyan, ".concat(ik.cyan,")")},iR[47]={0:"var(--ansi-white, ".concat(ik.white,")")},iR[49]=iE.delete(0),iR[51]={7:"var(--ansi-frame-outline, 1px solid)"},iR[53]=iE.appendVal(8,"overline"),iR[54]=iE.delete(7),iR[55]=iE.removeVal(8,"overline"),iR[59]=iE.delete(9),iR[73]={12:"super",3:"var(--ansi-superscript-font-size, 80%)"},iR[74]={12:"sub",3:"var(--ansi-subscript-font-size, 80%)"},iR[75]=iE.delete(12,3),iR[90]={1:"var(--ansi-bright-black, ".concat(ik["bright-black"],")")},iR[91]={1:"var(--ansi-bright-red, ".concat(ik["bright-red"],")")},iR[92]={1:"var(--ansi-bright-green, ".concat(ik["bright-green"],")")},iR[93]={1:"var(--ansi-bright-yellow, ".concat(ik["bright-yellow"],")")},iR[94]={1:"var(--ansi-bright-blue, ".concat(ik["bright-blue"],")")},iR[95]={1:"var(--ansi-bright-magenta, ".concat(ik["bright-magenta"],")")},iR[96]={1:"var(--ansi-bright-cyan, ".concat(ik["bright-cyan"],")")},iR[97]={1:"var(--ansi-bright-white, ".concat(ik["bright-white"],")")},iR[100]={0:"var(--ansi-bright-black, ".concat(ik["bright-black"],")")},iR[101]={0:"var(--ansi-bright-red, ".concat(ik["bright-red"],")")},iR[102]={0:"var(--ansi-bright-green, ".concat(ik["bright-green"],")")},iR[103]={0:"var(--ansi-bright-yellow, ".concat(ik["bright-yellow"],")")},iR[104]={0:"var(--ansi-bright-blue, ".concat(ik["bright-blue"],")")},iR[105]={0:"var(--ansi-bright-magenta, ".concat(ik["bright-magenta"],")")},iR[106]={0:"var(--ansi-bright-cyan, ".concat(ik["bright-cyan"],")")},iR[107]={0:"var(--ansi-bright-white, ".concat(ik["bright-white"],")")};var iI=Array(16);function iA(e){switch(e){case"38":return 1;case"48":return 0;case"58":return 9;default:throw Error("not implemented")}}iI[0]="black",iI[1]="red",iI[2]="green",iI[3]="yellow",iI[4]="blue",iI[5]="magenta",iI[6]="cyan",iI[7]="white",iI[8]="bright-black",iI[9]="bright-red",iI[10]="bright-green",iI[11]="bright-yellow",iI[12]="bright-blue",iI[13]="bright-magenta",iI[14]="bright-cyan",iI[15]="bright-white";var iP=function(){function e(){(0,ix._)(this,e)}return(0,iy._)(e,[{key:"toHtml",value:function(e){var t=new iE,n="",r=!1;return Array.from(new ij(e)).forEach(function(e){switch(e.kind){case 1:n+=(0,iw.default)(e.text);break;case 4:r&&(n+="</span>",r=!1),/^(38|48|58);(2|5);/.test(e.text)?"2"===e.text[3]?function(e,t){var n=e.text.split(";");if(5===n.length){var r=iA(n[0]),i=(0,x._)(n,5),o=i[2],a=i[3],s=i[4];t.set(r,"rgb(".concat(o,",").concat(a,",").concat(s,")"))}}(e,t):function(e,t){var n=e.text.split(";");if(3===n.length){var r=iA(n[0]),i=parseInt(n[2],10);if(0<=i&&i<=15){var o=iI[i];t.set(r,"var(--ansi-".concat(o,", ").concat(ik[o],")"))}else if(16<=i&&i<=231){var a=i-16,s=[0,95,135,175,215,255],l=s[a/36%6|0],u=s[a/6%6|0],c=s[a%6];t.set(r,"rgb(".concat(l,",").concat(u,",").concat(c,")"))}else if(232<=i&&i<=255){var d=8+(i-232)*10;t.set(r,"var(--ansi-gray-".concat(256-i,", rgb(").concat(d,",").concat(d,",").concat(d,"))"))}}}(e,t):e.text.split(";").forEach(function(e){var n=parseInt(e||"0",10);if(0===n)return void t.clear();var r=iR[n];r&&("function"==typeof r?r(t):t.update(r))}),t.size&&(n+='<span style="'.concat(t.toString(),'">'),r=!0)}}),r&&(n+="</span>"),n}}]),e}(),iD=e.i(432869),iO=new iP,iN=function(e){var t,n,r,i=e.log,o=e.files,a=ia().openFile,s=i.line;s=i.level===k.LogLevel.Error?(0,ig.default)(i.line):iO.toHtml(i.line);var l=(0,x._)((0,b.useState)([]),2),u=l[0],c=l[1];(0,b.useEffect)(function(){(0,iD.getLinks)(s,function(){return Promise.resolve(o)}).then(function(e){return c(e)})},[o,s]);var d=(0,b.useCallback)(function(e){e.preventDefault();var t=e.target;t.dataset.file&&a({path:t.dataset.file})},[a]);return(0,y.jsx)("div",{dangerouslySetInnerHTML:{__html:(t=s,u.sort(function(e,t){return e.from-t.from}),n="",r=0,u.forEach(function(e){n+=t.slice(r,e.from);var i=t.slice(e.from,e.to);n+='<a href="#" data-file="'.concat(e.file,'">').concat(i,"</a>"),r=e.to}),n+=t.slice(r))},onKeyDown:d,onClick:d})},iM=e.i(673920),iL=e.i(441329),iB=e.i(376363),iV=e.i(818976);e.i(947095);var iF=function(e){var t=e.scrollRef,n=e.scrollBottomRef,r=(0,b.useRef)(!1);return(0,iM.useEffectOnce)(function(){t.current&&setTimeout(function(){n.current&&((0,iB.default)(n.current),r.current=!0)},0)}),{didInitialScroll:r}},iU=function(e){var t=e.didInitialScroll,n=e.itemHeight,r=e.scrollRef,i=ia(),o=i.fetchPage,a=i.setIsLive,s=(0,x._)((0,b.useState)(!1),2),l=s[0],u=s[1],c=(0,x._)((0,b.useState)(0),2),d=c[0],f=c[1],p=(0,x._)((0,b.useState)(0),2),h=p[0],g=p[1],m=(0,b.useRef)(),y=(0,b.useRef)(!1);(0,b.useEffect)(function(){r.current&&f(r.current.offsetWidth-r.current.clientWidth)},[r]);var w=(0,b.useCallback)(function(e){(m.current||l)&&clearTimeout(m.current),u(!0),m.current=setTimeout(function(){u(!1),g(e.scrollLeft)},100)},[l]);return{scrollHandler:(0,b.useCallback)(function(e){return(0,D._)(function(){var r,i,s,l,u,c,d;return(0,O._)(this,function(f){switch(f.label){case 0:if(!(r=e.currentTarget)||y.current)return[2];if(w(r),i=r.scrollHeight,s=r.scrollTop,a(u=i-(l=r.clientHeight)===s),c=20*n,!(!u&&s<c&&i>l&&t.current))return[3,5];y.current=!0,f.label=1;case 1:return f.trys.push([1,3,,4]),[4,o()];case 2:return f.sent(),[3,4];case 3:return d=f.sent(),ic.captureException(d),[3,4];case 4:y.current=!1,f.label=5;case 5:return[2]}})})()},[w,a,n,t,o]),isScrolling:l,scrollLeftOffset:h-d}},iG=function(e){var t=e.scrollRef,n=e.scrollBottomRef,r=ia(),i=r.loading,o=r.logs,a=r.isLive,s=r.isWrapped,l=(0,b.useRef)(0),u=(0,b.useRef)(o[0]),c=(0,b.useCallback)(function(){n.current&&(0,iB.default)(n.current)},[n]);(0,b.useEffect)(function(){var e=t.current;if(e&&!i&&0!==o.length){if(a)e.scrollHeight>e.clientHeight&&c();else if(u.current&&u.current.timestamp>o[0].timestamp){var n=e.scrollHeight;if(n!==l.current){var r=n-l.current,s=e.scrollTop;e.scrollTo({top:s+r,behavior:"instant"})}}u.current=o[0],l.current=e.scrollHeight}},[a,i,o,t,c]);var d=(0,b.useRef)(s);(0,b.useEffect)(function(){a&&d.current!==s&&(c(),d.current=s)},[a,s,c])},i$=(0,U.cssRecord)({root:[{overflow:"auto"},G.rcss.flex.growAndShrink(1)],virtualTable:[G.rcss.width("100%"),G.rcss.position.relative],tableHeader:[G.rcss.display.flex,G.rcss.flex.row,G.rcss.backgroundColor.backgroundDefault,G.rcss.position.sticky,G.rcss.zIndex(1),G.rcss.top(0),G.rcss.border({color:F.tokens.outlineDimmest,direction:"bottom"})],columnHeader:[G.rcss.color.foregroundDimmer,G.rcss.fontSize(12),{lineHeight:"18px"},G.rcss.px(6),G.rcss.justify.center],infoTooltip:[G.rcss.display.flex,G.rcss.align.center,G.rcss.gap(4),{lineHeight:0}],bottomAnchor:[G.rcss.position.absolute,G.rcss.bottom(0),G.rcss.left(0),G.rcss.right(0)]}),iz=function(){var e=ia().isColorful,t=(0,iV.useTerminalTheme)();return(0,b.useMemo)(function(){var n={};if(t){var r=!0,i=!1,o=void 0;try{for(var a,s=Object.entries(t)[Symbol.iterator]();!(r=(a=s.next()).done);r=!0){var l=(0,x._)(a.value,2),u=l[0],c=l[1];n["--ansi-".concat((0,ih.default)(u))]=e?c:"currentColor"}}catch(e){i=!0,o=e}finally{try{r||null==s.return||s.return()}finally{if(i)throw o}}}return n},[e,t])};function iH(){var e=ia(),t=e.loading,n=e.error,r=e.logs,i=e.isExpanded,o=e.isWrapped,a=e.isWide,s=!!(t||n),l=(0,b.useRef)(null),u=(0,b.useRef)(null),c=(0,iL.useIsInBonsaiWebview)(),d=iz(),f=c?44:26,p=(0,iu.useVirtualizer)({count:(null==r?void 0:r.length)||0,getScrollElement:function(){return l.current},estimateSize:function(){return f},overscan:10,measureElement:function(e){return e.getBoundingClientRect().height},rangeExtractor:function(e){var t=new Set([0].concat((0,T._)((0,il.defaultRangeExtractor)(e))));return(0,T._)(t)}});iG({scrollRef:l,scrollBottomRef:u});var h=iU({didInitialScroll:iF({scrollRef:l,scrollBottomRef:u}).didInitialScroll,itemHeight:f,scrollRef:l}),g=h.scrollHandler,m=h.isScrolling,w=h.scrollLeftOffset,_=(0,P.useDeploymentCurrentBuild)(),S=(null==_?void 0:_.provider)===k.HostingBuildProvider.Cron,C=(0,b.useMemo)(function(){var e;return 8*(e=Math).max.apply(e,(0,T._)((null==r?void 0:r.map(function(e){return e.line.length}))||[]))},[r]),j=(0,P.useFsService)().listFiles,E=(0,x._)((0,b.useState)([]),2),R=E[0],I=E[1];(0,b.useEffect)(function(){j().then(function(e){e.files&&I(e.files)})},[j]);var A=(0,iL.useIsInBonsaiWebview)(),D=(0,b.useMemo)(function(){return[{key:"time",title:(0,y.jsxs)("span",{css:i$.infoTooltip,children:["Time",!A&&(0,y.jsx)(Y.Tooltip,{tooltip:"Logs persist for up to 30 days",css:i$.infoTooltip,children:(0,y.jsx)(tX.default,{size:12})})]}),width:a?173:115,renderCell:function(e){var t=(0,ip.parseISO)(e.timestamp);return(0,id.format)(t,a?"yyyy-MM-dd HH:mm:ss.SS":"MM-dd HH:mm:ss")}},i&&{key:"build",title:"Deployment",width:75,renderCell:function(e){var t=e.buildId.split("-");return t?t[0]:e.buildId}},S&&{key:"run",title:"Run",width:50,renderCell:function(e){var t,n=null==(t=e.executionId)?void 0:t.split("-");return n?n[n.length-1]:""}},i&&{key:"source",title:"Source",width:57,renderCell:function(e){return e.isFromReplit?"System":"User"}},{width:o?void 0:C,key:"log",title:"Log",renderCell:function(e){return(0,y.jsx)(iN,{files:R,log:e})}}].filter(Boolean)},[R,S,i,A,a,o,C]),O=(0,b.useMemo)(function(){return D.reduce(function(e,t){return e+(t.width||0)},0)},[D]);return(0,y.jsx)(Q.View,{innerRef:l,css:i$.root,onScroll:g,children:(0,y.jsxs)(Q.View,{style:(0,er._)({height:p.getTotalSize(),minWidth:O,"--scroll-left-offset":"".concat(w,"px")},d),css:i$.virtualTable,children:[(0,y.jsx)(Q.View,{css:i$.tableHeader,children:D.map(function(e){return(0,y.jsx)(Q.View,{tag:"div",css:i$.columnHeader,style:{width:e.width,flex:e.width?void 0:1,height:f},children:e.title},e.key)})}),p.getVirtualItems().map(function(e){var t=r[e.index];return t?(0,y.jsx)(iv,{log:t,height:e.size,y:e.start,resizeRef:p.measureElement,index:e.index,disabled:s,isScrolling:m,columns:D},e.key.toString()):null}),(0,y.jsx)("div",{ref:u,css:i$.bottomAnchor})]})})}var iW=(0,U.cssRecord)({root:[G.rcss.flex.grow(1)],noLogsText:[G.rcss.textAlign.center],viewError:[G.rcss.pt(0)]});function iq(){var e=ia(),t=e.logs,n=e.error;return e.loading?(0,y.jsx)(C.PaneSection,{css:iW.root,centered:!0,children:(0,y.jsx)(j.ViewLoading,{})}):0===t.length?(0,y.jsxs)(y.Fragment,{children:[n?(0,y.jsx)(j.ViewError,{css:iW.viewError,text:n}):null,(0,y.jsx)(C.PaneSection,{css:iW.root,children:(0,y.jsxs)(Q.View,{pt:4,gap:8,children:[(0,y.jsx)(K.Text,{css:iW.noLogsText,children:"No logs are available."}),(0,y.jsxs)(K.Text,{color:"dimmer",css:iW.noLogsText,children:["Having trouble?"," ",(0,y.jsx)("a",{href:"https://docs.replit.com/cloud-services/deployments/troubleshooting",onClick:function(){return(0,_.trackDeploymentSectionViewed)({context:"troubleshooting_doc"})},target:"_blank",children:"Troubleshooting tips"})]})]})})]}):(0,y.jsx)(iH,{})}var iK=e.i(17036),iY=e.i(54819),iQ=(0,U.cssRecord)({buttonGroup:[G.rcss.flex.row,G.rcss.rowWithGap(1),{button:{"&:not(:first-child)":{borderTopLeftRadius:0,borderBottomLeftRadius:0},"&:not(:last-child)":{borderTopRightRadius:0,borderBottomRightRadius:0}}}]});function iX(e){var t=e.onClear,n=e.label,r=e.buttonProps,i=e.children,o=t?"primary":void 0,a=(0,x._)((0,b.useState)(!1),2),s=a[0],l=a[1];return(0,y.jsxs)(iY.Group,{css:iQ.buttonGroup,children:[(0,y.jsxs)(tl.PopoverTrigger,{label:n,isOpen:s,onOpenChange:l,background:"higher",children:[(0,y.jsx)($.Button,(0,er._)({colorway:o},r)),i]}),t?(0,y.jsx)($.Button,{colorway:o,text:"",iconLeft:(0,y.jsx)(tW.default,{}),onClick:t}):null]})}var iJ=e.i(820593),iZ=(0,U.cssRecord)({section:[G.rcss.gap(8)],dateRangeInputs:[G.rcss.display.grid,G.rcss.gap(8),G.rcss.align.center,{gridTemplateColumns:"min-content 200px",gridAutoFlow:"row",gridAutoRows:"1fr"}]}),i0=function(){var e=ia(),t=e.filter,n=e.setFilter;return(0,y.jsxs)(Q.View,{css:iZ.dateRangeInputs,children:[(0,y.jsx)(ts.Label,{variant:"text",children:"Start"}),(0,y.jsx)(iK.default,{granularity:"minute",hourCycle:24,value:t.start,onChange:function(e){n(function(t){var n=(0,eS._)((0,er._)({},t),{start:e});return e&&t.end&&e.compare(t.end)>0&&(n.end=null),n})}}),(0,y.jsx)(ts.Label,{variant:"text",children:"End"}),(0,y.jsx)(iK.default,{granularity:"minute",hourCycle:24,value:t.end,onChange:function(e){n(function(t){var n=(0,eS._)((0,er._)({},t),{end:e});return e&&t.start&&0>e.compare(t.start)&&(n.start=null),n})}})]})},i1=function(){var e=ia(),t=e.filter,n=e.setFilter,r=(0,r3.getLocalTimeZone)(),i=t.start||t.end,o="Date",a=t.start&&(0,id.format)(t.start.toDate(r),"M/d/yy"),s=t.end&&(0,id.format)(t.end.toDate(r),"M/d/yy");return a&&s?o="".concat(a," to ").concat(s):a?o="Start ".concat(a):s&&(o="End ".concat(s)),(0,y.jsx)(iX,{label:"Date range",onClear:i?function(){return n(function(e){return(0,eS._)((0,er._)({},e),{start:null,end:null})})}:void 0,buttonProps:{text:o,iconRight:i?void 0:(0,y.jsx)(iJ.ChevronDown,{})},children:(0,y.jsx)(Q.View,{css:iZ.section,p:8,children:(0,y.jsx)(i0,{})})})},i2=function(){var e=ia(),t=e.filter,n=e.setFilter,r=(0,x._)((0,b.useState)(t.executionId),2),i=r[0],o=r[1];return(0,b.useEffect)(function(){o(t.executionId)},[t.executionId]),(0,y.jsx)(e2.Input,{placeholder:"*****",value:i||"",onChange:function(e){var t=e.target.value;o(t),t&&5!==t.length||n(function(e){return(0,eS._)((0,er._)({},e),{executionId:t})})},onBlur:function(){return n(function(e){return(0,eS._)((0,er._)({},e),{executionId:i})})},onKeyDown:function(e){"Enter"===e.key&&n(function(e){return(0,eS._)((0,er._)({},e),{executionId:i})})}})},i3=function(){var e=ia(),t=e.filter,n=e.setFilter;return(0,y.jsx)(iX,{onClear:t.executionId?function(){return n(function(e){return(0,eS._)((0,er._)({},e),{executionId:null})})}:void 0,label:"Run ID",buttonProps:{text:t.executionId?"Run: ".concat(t.executionId):"Run ID",iconRight:t.executionId?void 0:(0,y.jsx)(iJ.ChevronDown,{})},children:(0,y.jsx)(Q.View,{p:8,children:(0,y.jsx)(td.TextField,{children:(0,y.jsx)(i2,{})})})})},i4=e.i(428596),i8=e.i(127227),i5=e.i(51054),i6=e.i(806002),i9=function(){var e=(0,P.useDeploymentCurrentBuild)();return(null==e?void 0:e.provider)===k.HostingBuildProvider.Cron},i7=(0,U.cssRecord)({root:[{"> *:first-child":G.rcss.flex.grow(1)}],divider:G.rcss.backgroundColor.outlineDimmer,section:[G.rcss.p(8),G.rcss.gap(8)],clearFilterButton:[G.rcss.borderRadius(0),G.rcss.width("fit-content")]}),oe=function(){var e=ia(),t=e.filter,n=e.setFilter,r=function(){n(function(e){return(0,eS._)((0,er._)({},e),{level:e.level===k.LogLevel.Error?null:k.LogLevel.Error})})};return(0,y.jsx)($.Button,{colorway:t.level===k.LogLevel.Error?"primary":void 0,text:"Errors only",iconLeft:(0,y.jsx)(i8.Checkbox,{onChange:r,checked:t.level===k.LogLevel.Error}),onClick:r})},ot=function(){var e=i9();return(0,y.jsxs)(y.Fragment,{children:[(0,y.jsx)(oe,{}),(0,y.jsx)(i1,{}),e&&(0,y.jsx)(i3,{})]})},on=function(){var e=ia(),t=e.filter,n=e.setFilter,r=e.clearFilter,i=i9(),o=!!(t.message||t.level||t.start||t.end||t.executionId),a=(0,i4.useIdSeed)();return(0,y.jsx)(iX,{label:"Filter",buttonProps:{text:"",iconLeft:(0,y.jsx)(i6.default,{})},onClear:o?r:void 0,children:(0,y.jsxs)(Q.View,{children:[(0,y.jsxs)(Q.View,{p:8,row:!0,gap:8,children:[(0,y.jsx)(i8.Checkbox,{name:"Filter by errors only",id:a("errors-only"),checked:t.level===k.LogLevel.Error,onChange:function(e){return n(function(t){return(0,eS._)((0,er._)({},t),{level:e?k.LogLevel.Error:null})})}}),(0,y.jsx)("label",{htmlFor:a("errors-only"),children:"Errors only"})]}),i?(0,y.jsxs)(y.Fragment,{children:[(0,y.jsx)(rx.DividerH,{css:i7.divider}),(0,y.jsx)(Q.View,{css:i7.section,children:(0,y.jsxs)(td.TextField,{children:[(0,y.jsx)(ts.Label,{color:"dimmer",children:"Run ID"}),(0,y.jsx)(i2,{})]})})]}):null,(0,y.jsx)(rx.DividerH,{css:i7.divider}),(0,y.jsxs)(Q.View,{css:i7.section,children:[(0,y.jsx)(ts.Label,{color:"dimmer",children:"Date range"}),(0,y.jsx)(i0,{})]}),(0,y.jsx)(rx.DividerH,{css:i7.divider}),(0,y.jsx)($.Button,{variant:"nofill",onClick:function(){return r()},text:"Clear all filters",alignment:"start",css:i7.clearFilterButton})]})})};function or(){var e=ia(),t=e.filter,n=e.setFilter,r=e.isWide,i=(0,x._)((0,b.useState)(t.message),2),o=i[0],a=i[1];return(0,b.useEffect)(function(){a(t.message)},[t.message]),(0,y.jsxs)(Q.View,{css:i7.root,p:8,row:!0,gap:8,children:[(0,y.jsx)(i5.SearchBar,{placeholder:"Search",value:o,onChange:function(e){a(e.target.value),""===e.target.value&&n(function(e){return(0,eS._)((0,er._)({},e),{message:""})})},onBlur:function(){return n(function(e){return(0,eS._)((0,er._)({},e),{message:o})})},onClear:function(){n(function(e){return(0,eS._)((0,er._)({},e),{message:""})})},onKeyDown:function(e){"Enter"===e.key&&n(function(e){return(0,eS._)((0,er._)({},e),{message:o})})}}),r?(0,y.jsx)(ot,{}):(0,y.jsx)(on,{})]})}var oi=e.i(606867);function oo(e){return(0,y.jsx)(oi.default,(0,eS._)((0,er._)({},e),{viewBox:"0 0 16 16",fill:"none",children:(0,y.jsx)("path",{stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",d:"M4.5 11.5H10A3.5 3.5 0 0013.5 8v0A3.5 3.5 0 0010 4.5H2.5m2 7L7 9m-2.5 2.5L7 14"})}))}var oa=e.i(496019),os=e.i(360877),ol=(0,U.cssRecord)({root:[G.rcss.border({color:F.tokens.outlineDimmest,direction:"top"}),G.rcss.height(29)],group:[G.rcss.display.flex,G.rcss.rowWithGap(8)],button:[G.rcss.color.foregroundDefault,G.rcss.borderRadius(0),G.rcss.height("100%")],liveIndicatorWrapper:[G.rcss.width(16),G.rcss.height(16),G.rcss.display.flex,G.rcss.align.center,G.rcss.justify.center],liveIndicator:[G.rcss.width(6),G.rcss.height(6),G.rcss.borderRadius("full"),G.rcss.backgroundColor.accentPositiveStronger],checkboxWrapper:[G.rcss.display.flex,G.rcss.align.center,G.rcss.rowWithGap(4),G.rcss.cursor.pointer],checkbox:[{input:[G.rcss.width(16),G.rcss.height(16)]}]});function ou(){var e=ia(),t=e.isLive,n=e.setIsLive,r=e.isExpanded,i=e.setIsExpanded,o=e.isWrapped,a=e.setIsWrapped,s=e.isColorful,l=e.setIsColorful,u=(0,i4.useIdSeed)();return(0,y.jsxs)(Q.View,{css:ol.root,row:!0,gap:8,justify:"space-between",children:[(0,y.jsxs)(Q.View,{css:ol.group,children:[(0,y.jsx)($.Button,{iconLeft:r?(0,y.jsx)(r_.default,{rotate:90}):(0,y.jsx)(rS.default,{rotate:90}),onClick:function(){return i(function(e){return!e})},variant:"nofill",text:r?"Collapse":"Expand",css:ol.button}),(0,y.jsxs)("label",{css:ol.checkboxWrapper,htmlFor:u("wrap"),children:[(0,y.jsx)(i8.Checkbox,{id:u("wrap"),checked:o,onChange:function(){return a(function(e){return!e})},css:ol.checkbox}),(0,y.jsx)(oo,{}),(0,y.jsx)("span",{children:"Wrap"})]}),(0,y.jsxs)("label",{css:ol.checkboxWrapper,htmlFor:u("colorful"),children:[(0,y.jsx)(i8.Checkbox,{id:u("colorful"),checked:s,onChange:function(){return l(function(e){return!e})},css:ol.checkbox}),(0,y.jsx)(os.default,{}),(0,y.jsx)("span",{children:"Colors"})]})]}),(0,y.jsx)(Q.View,{css:ol.group,children:(0,y.jsx)($.Button,{iconLeft:t?(0,y.jsx)(Q.View,{css:ol.liveIndicatorWrapper,children:(0,y.jsx)(Q.View,{css:ol.liveIndicator})}):(0,y.jsx)(oa.default,{}),onClick:function(){return n(function(e){return!e})},variant:"nofill",text:"Live",css:ol.button})})]})}var oc=(0,U.cssRecord)({root:[G.rcss.overflow("hidden")],header:[{borderBottom:"1px solid ".concat(F.tokens.outlineDimmest)}]}),od=function(e){var t=e.deploymentId,n=e.replId,r=e.executionId,i=e.onBack,o=e.openFile;return t?(0,y.jsx)(of,{deploymentId:t,replId:n,executionId:r,onBack:i,openFile:o}):(0,y.jsx)(C.PaneSection,{children:(0,y.jsx)(tQ.StatusBanner,{colorway:"warning",icon:(0,y.jsx)(Z.default,{}),text:"Deployment not found"})})};function of(e){var t=e.deploymentId,n=e.replId,r=e.executionId,i=e.onBack,o=is({deploymentId:t,replId:n,executionId:r,openFile:e.openFile});return(0,iM.useEffectOnce)(function(){(0,_.trackDeploymentSectionViewed)({context:S.Views.Logs})}),(0,y.jsx)(io.Provider,{value:o,children:(0,y.jsxs)(Q.View,{css:oc.root,grow:!0,shrink:!0,innerRef:o.containerRef,children:[i?(0,y.jsx)(Q.View,{css:oc.header,p:6,gap:8,children:(0,y.jsx)(Q.View,{row:!0,gap:8,align:"center",justify:"space-between",children:(0,y.jsx)(z.IconButton,{alt:"Back",onClick:i,children:(0,y.jsx)(X.default,{})})})}):null,(0,y.jsx)(or,{}),(0,y.jsx)(iq,{}),(0,y.jsx)(ou,{})]})})}e.s(["Logs",()=>od],985845),e.s([],969084);var op=e.i(491637),oh=e.i(571926),og=e.i(342424),om=e.i(703774),ov=[{label:"one hour",key:1},{label:"six hours",key:6},{label:"one day",key:24},{label:"three days",key:72},{label:"one week",key:168}],ox={label:"one hour",key:1},oy=G.container.min(600),ob=(0,U.cssRecord)({fullWidth:(0,ek._)({},oy,{gridColumn:"span 2"})}),ow=(0,U.cssRecord)({container:(0,ek._)({display:"grid",gap:32},oy,{gridTemplateColumns:"repeat(2, minmax(0, 1fr))"}),fullWidth:ob.fullWidth}),ok=function(e){var t=e.replId,n=(0,x._)((0,b.useState)(ox),2),r=n[0],i=r.key,o=r.label,a=n[1],s=(0,op.subHours)(new Date,i),l=(0,om.useTheme)().values,u=oS(s,o_(i));return(0,y.jsx)(C.PaneSection,{children:(0,y.jsxs)(Q.View,{css:ow.container,children:[(0,y.jsx)(Q.View,{css:ow.fullWidth,children:(0,y.jsx)(ry.PopupMenu,{items:ov,label:"Past ".concat(o),onAction:function(e){var t,n="string"==typeof e?parseInt(e,10):e;a(null!=(t=ov.find(function(e){return e.key===n}))?t:ox)},children:function(e){return(0,y.jsx)(ry.MenuItem,{label:e.label,id:e.key},e.key)}})}),(0,y.jsx)(Q.View,{css:ow.fullWidth,children:(0,y.jsx)(og.default,{replId:t,title:"CPU Utilization",metric:oh.TimeSeriesMetrics.CPU,start:u,hours:i,colorFn:function(){return l.global.redDefault}})}),(0,y.jsx)(Q.View,{css:ow.fullWidth,children:(0,y.jsx)(og.default,{replId:t,title:"Memory Utilization",metric:oh.TimeSeriesMetrics.Memory,start:u,hours:i,colorFn:function(){return l.global.redDefault}})})]})})},o_=function(e){return e<=1?6e5:e<=6?18e5:e<=24?72e5:216e5},oS=function(e,t){var n=e.getTime()%t;return new Date(e.getTime()-n)};e.s(["ResourceMonitoring",()=>ok],104571);var oC=e.i(682070),oC=oC;function oj(){var e=(0,ei._)(["\n  query ScheduledJobListExecution($deploymentId: String!) {\n    scheduledJobListExecutions(input: { deploymentId: $deploymentId }) {\n      __typename\n      ... on ScheduledJobListExecutionsResults {\n        results {\n          id\n          startedAt\n          endedAt\n          status\n        }\n      }\n      ... on UnauthorizedError {\n        message\n      }\n      ... on NotFoundError {\n        message\n      }\n      ... on UserError {\n        message\n      }\n      ... on Error {\n        message\n      }\n    }\n  }\n"]);return oj=function(){return e},e}function oT(){var e=(0,ei._)(["\n  mutation CancelScheduledJobExecution(\n    $deploymentId: String!\n    $executionId: String!\n  ) {\n    cancelScheduledJobExecution(\n      input: { deploymentId: $deploymentId, executionId: $executionId }\n    ) {\n      __typename\n      ... on CancelScheduledJobExecutionResult {\n        execution {\n          id\n          startedAt\n          endedAt\n          status\n        }\n      }\n      ... on UnauthorizedError {\n        message\n      }\n      ... on NotFoundError {\n        message\n      }\n      ... on UserError {\n        message\n      }\n      ... on Error {\n        message\n      }\n    }\n  }\n"]);return oT=function(){return e},e}var oE={},oR=(0,eo.gql)(oj()),oI=(0,eo.gql)(oT()),oA=e.i(791134),oP=e.i(71754),oD=e.i(883002),oO=(0,U.cssRecord)({root:[G.rcss.overflow("hidden")],executionListHeader:[{borderBottom:"1px solid ".concat(F.tokens.outlineDimmest)}],executionList:[{overflow:"auto"},G.rcss.flex.growAndShrink(1)],executionListRows:{width:"100%",position:"relative"},executionItem:[G.rcss.rowWithGap(8),G.rcss.align.center,G.rcss.fontSize(12),G.rcss.px(8),{position:"absolute",top:0,left:0,width:"100%",borderBottom:"1px solid ".concat(F.tokens.outlineDimmest),color:F.tokens.foregroundDimmer}],executionItemStatusDot:[G.rcss.width("6px"),G.rcss.height("6px"),G.rcss.borderRadius("full"),G.rcss.flex.shrink(0),G.rcss.pr(4)],executionItemDistance:[G.rcss.minWidth(100)],executionItemTimestamp:[G.rcss.minWidth(90)],executionItemRunTime:[G.rcss.minWidth(60)],executionItemStatus:[G.rcss.minWidth(100),{textTransform:"capitalize"}],executionItemActions:[{marginLeft:"auto"}],noExecutionsText:[G.rcss.textAlign.center],maxResultsMessage:[G.rcss.fontSize(12),G.rcss.color.foregroundDimmest]});function oN(e){var t=e.deploymentId,n=e.replId,r=e.openFile,i=(0,x._)((0,b.useState)(),2),o=i[0],a=i[1];return t?o?(0,y.jsx)(od,{replId:n,deploymentId:t,executionId:o,onBack:function(){return a(void 0)},openFile:r}):(0,y.jsx)(oM,{deploymentId:t,onViewExecutionLogs:function(e){var t=e.split("-");a(t[t.length-1])}}):(0,y.jsx)(C.PaneSection,{children:(0,y.jsx)(tQ.StatusBanner,{colorway:"warning",icon:(0,y.jsx)(Z.default,{}),text:"Deployment not found"})})}function oM(e){var t,n,r,i,o,a=e.deploymentId,s=e.onViewExecutionLogs,l=(0,x._)((0,b.useState)([]),2),u=l[0],c=l[1],d=(0,x._)((0,b.useState)(!1),2),f=d[0],p=d[1],h=(0,x._)((0,b.useState)(),2),g=h[0],m=h[1],w=(t={variables:{deploymentId:a},onError:function(e){m(e)},onCompleted:function(e){(null==e?void 0:e.scheduledJobListExecutions.__typename)==="ScheduledJobListExecutionsResults"&&c(e.scheduledJobListExecutions.results)}},n=(0,er._)({},oE,t),ea.useQuery(oR,n)),k=w.loading,C=w.refetch,j=(0,x._)((r={onError:function(e){m(e)},onCompleted:function(e){var t=e.cancelScheduledJobExecution;"CancelScheduledJobExecutionResult"===t.__typename&&c(function(e){return e.map(function(e){return e.id===t.execution.id?t.execution:e})})}},i=(0,er._)({},oE,r),t2.useMutation(oI,i)),2),E=j[0],R=j[1].loading,I=!!(k||R||f||g);return(0,iM.useEffectOnce)(function(){k||C(),(0,_.trackDeploymentSectionViewed)({context:S.Views.Schedule})}),(0,y.jsxs)(Q.View,{css:oO.root,grow:!0,shrink:!0,children:[(0,y.jsxs)(Q.View,{css:oO.executionListHeader,p:6,gap:8,children:[g?(0,y.jsx)(tQ.StatusBanner,{colorway:"warning",icon:(0,y.jsx)(Z.default,{}),text:null!=(o=g.message)?o:"Something went wrong"}):null,(0,y.jsxs)(Q.View,{row:!0,gap:8,align:"center",justify:"space-between",children:[(0,y.jsx)(oA.ExecuteScheduledJobButton,{disabled:I,onSuccessfulExecution:function(e){c(function(t){return[e].concat((0,T._)(t)).slice(0,50)})}}),(0,y.jsx)(z.IconButton,{alt:"Refresh",disabled:I,onClick:function(){I||(p(!0),C().finally(function(){p(!1)}))},children:f?(0,y.jsx)(J.default,{}):(0,y.jsx)(th.default,{})})]})]}),(0,y.jsx)(oL,{executions:u,loading:k,disabled:I,onExecutionItemAction:function(e){switch(e.type){case"cancel":E({variables:{deploymentId:a,executionId:e.payload.id}});break;case"logs":s(e.payload.id)}}})]})}function oL(e){var t=e.executions,n=e.loading,r=e.disabled,i=e.onExecutionItemAction,o=(0,b.useRef)(null),a=(0,iL.useIsInBonsaiWebview)()?44:28,s=(0,iu.useVirtualizer)({count:t.length,getScrollElement:function(){return o.current},estimateSize:function(){return a},overscan:10});return n?(0,y.jsx)(C.PaneSection,{centered:!0,children:(0,y.jsx)(j.ViewLoading,{})}):0===t.length?(0,y.jsx)(C.PaneSection,{children:(0,y.jsxs)(Q.View,{pt:4,gap:8,children:[(0,y.jsx)(K.Text,{css:oO.noExecutionsText,children:"No runs yet..."}),(0,y.jsxs)(K.Text,{color:"dimmer",css:oO.noExecutionsText,children:["Having trouble?"," ",(0,y.jsx)("a",{href:"https://docs.replit.com/cloud-services/deployments/troubleshooting",onClick:function(){return(0,_.trackDeploymentSectionViewed)({context:"troubleshooting_doc"})},target:"_blank",children:"Troubleshooting tips"})]})]})}):(0,y.jsx)(Q.View,{innerRef:o,css:oO.executionList,children:(0,y.jsx)(Q.View,{style:{height:s.getTotalSize()},css:oO.executionListRows,children:s.getVirtualItems().map(function(e){var n=t[e.index];return(0,y.jsx)(oU,{execution:n,height:e.size,y:e.start,index:e.index,onAction:i,disabled:r},e.key.toString())})})})}var oB=(m={},(0,ek._)(m,k.ScheduledJobExecutionStatus.Done,F.tokens.accentPositiveDefault),(0,ek._)(m,k.ScheduledJobExecutionStatus.Running,F.tokens.orangeStronger),(0,ek._)(m,k.ScheduledJobExecutionStatus.Failed,F.tokens.accentNegativeDefault),(0,ek._)(m,k.ScheduledJobExecutionStatus.Cancelled,F.tokens.greyDefault),(0,ek._)(m,k.ScheduledJobExecutionStatus.Unrecognized,F.tokens.greyDefault),m);function oV(e){var t=e.status,n=t in oB?oB[t]:F.tokens.greyDefault;return(0,y.jsx)(Q.View,{tag:"span",css:oO.executionItemStatusDot,style:{backgroundColor:n,boxShadow:"0 0 8px ".concat(n)}})}var oF=((o=oF||{}).Cancel="cancel",o.Logs="logs",o);function oU(e){var t=e.execution,n=e.y,r=e.height,i=e.index,o=e.onAction,a=e.disabled,s=(null==t?void 0:t.endedAt)?(new Date(t.endedAt).valueOf()-new Date(t.startedAt).valueOf())/1e3:null;return(0,y.jsxs)(y.Fragment,{children:[(0,y.jsxs)(Q.View,{title:t.id,css:oO.executionItem,style:{height:r,transform:"translateY(".concat(n,"px)")},children:[(0,y.jsx)(oV,{status:t.status}),(0,y.jsx)(Q.View,{css:oO.executionItemDistance,children:(0,oC.default)(new Date(t.startedAt),Date.now(),{addSuffix:!0})}),(0,y.jsxs)(Q.View,{css:oO.executionItemTimestamp,children:[new Date(t.startedAt).toLocaleString("en-US",{month:"short",day:"2-digit"}),", ",new Date(t.startedAt).toLocaleString("en-US",{hour:"2-digit",minute:"2-digit",hourCycle:"h23"})]}),(0,y.jsx)(Q.View,{css:oO.executionItemRunTime,children:s?"".concat(s,"s"):"-"}),(0,y.jsx)(Q.View,{css:oO.executionItemStatus,children:t.status}),(0,y.jsxs)(Q.View,{css:oO.executionItemActions,row:!0,gap:8,align:"center",children:[t.status===k.ScheduledJobExecutionStatus.Running?(0,y.jsx)(z.IconButton,{alt:"Cancel",size:12,disabled:a,onClick:function(){return o({type:"cancel",payload:{id:t.id}})},children:(0,y.jsx)(oP.default,{})}):null,(0,y.jsx)(z.IconButton,{alt:"Logs",size:18,disabled:a,onClick:function(){return o({type:"logs",payload:{id:t.id}})},children:(0,y.jsx)(oD.default,{})})]})]}),49===i?(0,y.jsx)(Q.View,{title:t.id,css:oO.executionItem,style:{height:r,transform:"translateY(".concat(n+r,"px)")},children:(0,y.jsx)(K.Text,{css:oO.maxResultsMessage,children:"Only the most recent 50 runs are displayed currently"})}):null]})}e.s(["Schedule",()=>oN],150281);var oG=e.i(198992),o$=e.i(452412),oz=e.i(914279),oH=e.i(68893),oW=e.i(187505),oq=e.i(492267),oK=e.i(785719),oY=e.i(978669),oQ=e.i(353371),oX=(0,U.cssRecord)({container:G.rcss.colWithGap(24),pauseAndResumeButtons:G.rcss.colWithGap(8),sectionContainer:G.rcss.colWithGap(8),sectionButton:[G.rcss.color.accentNegativeStrongest,G.rcss.transition.snappy,(0,ek._)({backgroundColor:F.tokens.interactiveBackground,borderColor:"transparent"},G.selectors.hover,{borderColor:"transparent"})]}),oJ=function(e){var t=e.hideResume,n=e.hideSuspend,r=e.onLifecycleCommand,i=e.authorizations,o=(0,oW.useTrackClick)().trackClick,a=(0,oz.useDeploymentMode)(),s=(0,P.useDeploymentCurrentBuild)(),l=(0,x._)((0,b.useState)(!1),2),u=l[0],c=l[1],d=!(0,eb.useFlag)({controlName:"flag-depl-switcheroo",default:!1}),f=i.editDeploymentStatus,p=f.isAuthorized,h=f.message,g=(null==s?void 0:s.provider)==="azure_container_app"||(null==s?void 0:s.provider)==="azure_vm",m=(null==s?void 0:s.status)===k.HostingBuildStatus.Resuming,w=(null==s?void 0:s.status)===k.HostingBuildStatus.Suspending,_=(null==s?void 0:s.status)===k.HostingBuildStatus.Suspended,S=m||w||a===oH.DeploymentMode.ProcessingLifecycleCommand||a===oH.DeploymentMode.Deploying,C=!g&&!(void 0!==t&&t)&&(_||m)&&(null==s?void 0:s.hasImageTag),j=!g&&!(void 0!==n&&n)&&!_&&!m&&(w||a===oH.DeploymentMode.Deploying||a===oH.DeploymentMode.Ready)&&(null==s?void 0:s.hasImageTag);return(0,y.jsx)(y.Fragment,{children:(0,y.jsxs)(Q.View,{css:oX.container,children:[C||j?(0,y.jsxs)(Q.View,{css:oX.pauseAndResumeButtons,children:[C?(0,y.jsxs)(y.Fragment,{children:[(0,y.jsx)(Y.Tooltip,{tooltip:h,isDisabled:p,children:(0,y.jsx)($.Button,{text:m?"Resuming":"Resume",onClick:function(){o({productArea:"publishing",target:"resume_button"}),r({command:k.SendDeploymentLifecycleCommandType.Resume})},loading:m,disabled:S||!p,iconLeft:m?(0,y.jsx)(J.default,{}):(0,y.jsx)(oY.default,{})})}),(0,y.jsx)(K.Text,{color:"dimmer",children:"Your app will become accessible to users again"})]}):null,j?(0,y.jsxs)(y.Fragment,{children:[(0,y.jsx)(Y.Tooltip,{tooltip:h,isDisabled:p,children:(0,y.jsx)($.Button,{text:"Pause",onClick:function(){o({productArea:"publishing",target:"pause_button"}),r({command:k.SendDeploymentLifecycleCommandType.Suspend})},loading:w,disabled:S||!p,iconLeft:w?(0,y.jsx)(J.default,{}):(0,y.jsx)(oK.default,{})})}),(0,y.jsx)(K.Text,{color:"dimmer",children:"Your billing will continue, but all users will lose access to your app"})]}):null]}):null,d?(0,y.jsx)(oZ,{setIsDestroying:c,onLifecycleCommand:r,authorizations:i}):null,(0,y.jsx)(o0,{isDestroying:u,setIsDestroying:c,onLifecycleCommand:r,authorizations:i})]})})};function oZ(e){var t=e.setIsDestroying,n=e.onLifecycleCommand,r=e.authorizations,i=(0,oW.useTrackClick)().trackClick,o=(0,x._)((0,b.useState)(!1),2),a=o[0],s=o[1],l=r.deleteDeployment,u=l.isAuthorized,c=l.message;return(0,oq.useIsAgentStackRepl)().isAgentStackRepl?null:(0,y.jsxs)(y.Fragment,{children:[(0,y.jsxs)(Q.View,{css:oX.sectionContainer,children:[(0,y.jsx)(Y.Tooltip,{tooltip:c,isDisabled:u,children:(0,y.jsx)($.Button,{text:"Change deployment type",onClick:function(){i({productArea:"publishing",target:"change_deployment_type_button"}),s(!0)},disabled:!u,iconLeft:(0,y.jsx)(oQ.default,{})})}),(0,y.jsx)(K.Text,{color:"dimmer",children:"To change your deployment type, you will need to unpublish and publish again."})]}),(0,y.jsx)(rb.Modal,{isOpen:a,onRequestClose:function(){return s(!1)},children:(0,y.jsx)(o$.default,{confirmLabel:"Yes, unpublish my app",title:"Change Deployment Type",isDestructive:!0,onConfirm:function(){t(!0),s(!1),n({command:k.SendDeploymentLifecycleCommandType.Destroy})},onCancel:function(){return s(!1)},children:"To change your deployment type, you will need to unpublish and publish again. This will destroy your published app and any associated published app tiers, saved replit.app domain and published app history. You can always come back and republish your App again."})})]})}function o0(e){var t=e.isDestroying,n=e.setIsDestroying,r=e.onLifecycleCommand,i=e.authorizations,o=(0,oW.useTrackClick)().trackClick,a=(0,x._)((0,b.useState)(!1),2),s=a[0],l=a[1],u=i.deleteDeployment,c=u.isAuthorized,d=u.message;return(0,y.jsxs)(y.Fragment,{children:[(0,y.jsxs)(Q.View,{css:oX.sectionContainer,children:[(0,y.jsx)(Y.Tooltip,{tooltip:d,isDisabled:c,children:(0,y.jsx)($.Button,{text:"Shut down",colorway:"negative",variant:"outlined",css:oX.sectionButton,onClick:function(){o({productArea:"publishing",target:"shut_down_button"}),l(!0)},disabled:t||!c,iconLeft:(0,y.jsx)(tg.default,{})})}),(0,y.jsx)(K.Text,{color:"dimmer",children:"Your published app billing will be canceled, and it will cease to exist"})]}),(0,y.jsx)(rb.Modal,{isOpen:s,onRequestClose:function(){return l(!1)},children:(0,y.jsx)(o$.default,{confirmLabel:"Yes, unpublish my app",title:"Delete Published App",isDestructive:!0,onConfirm:function(){n(!0),l(!1),r({command:k.SendDeploymentLifecycleCommandType.Destroy})},onCancel:function(){return l(!1)},children:"This will destroy your published app and any associated published app tiers, saved replit.app domain and published app history. You can always come back and republish your repl again."})})]})}var o1=e.i(259421),o2=e.i(527225);function o3(e){var t=e.shouldShowDownloadQR,n=(0,oW.useTrackClick)().trackClick,r=(0,x._)((0,b.useState)(t),2),i=r[0],o=r[1];return(0,y.jsx)(Q.View,{children:(0,y.jsxs)(Q.View,{gap:8,children:[(0,y.jsx)($.Button,{iconLeft:(0,y.jsx)(o2.default,{}),text:"Install the Replit App",onClick:function(){n({productArea:"publishing",target:"install_replit_app_button"}),o(function(e){var t=!e;return t&&(0,ed.track)(ef.events.DEPLOYMENT_MOBILE_DOWNLOAD_QR_VIEWED),t})}}),i?(0,y.jsx)(o1.default,{source:"deployment_settings"}):null]})})}var o4=e.i(589910);function o8(){var e=(0,ei._)(["\n  query AutoscaleUsageSectionCurrentUser {\n    currentUser {\n      id\n      usageInterval {\n        ... on UsageInterval {\n          startDate\n          endDate\n          resources {\n            autoscaleComputeUnits {\n              usage\n            }\n          }\n        }\n      }\n    }\n  }\n"]);return o8=function(){return e},e}var o5={},o6=(0,eo.gql)(o8()),o9=e.i(912790),o7=(0,U.cssRecord)({root:[G.rcss.borderRadius(8),{outline:"1px solid transparent"}],outerRow:[G.rcss.rowWithGap(12),G.rcss.align.center]}),ae=function(e){var t,n=e.machineConfiguration,r=(t=(0,er._)({},o5,void 0),ea.useQuery(o6,t)).data,i=(0,b.useMemo)(function(){return function(e){var t,n,r=e.data;if((null==r||null==(t=r.currentUser)?void 0:t.__typename)==="CurrentUser"){var i=null==r||null==(n=r.currentUser)?void 0:n.usageInterval;if(i&&"UsageInterval"===i.__typename){var o=i.resources.autoscaleComputeUnits.usage,a=(0,o9.toDisplaySize)(o,{resourceUsageType:"ComputeUnits"}),s=new Date(i.endDate).toLocaleString("default",{month:"short",day:"numeric"});return{description:"".concat(a," used this billing period"),renewalInfo:"Renews ".concat(s," ")}}}}({data:r})},[r]),o=(0,oq.useIsAgentStackRepl)().isAgentStackRepl,a=(0,b.useMemo)(function(){if(null!=n)return"Autoscale (".concat(n.label,")")},[n]);if(!a||!i)return(0,y.jsx)(Q.View,{justify:"center",row:!0,children:(0,y.jsx)(J.default,{})});var s=e.authorizations.editDeploymentTier,l=s.isAuthorized,u=s.message;return(0,y.jsxs)(q.Surface,{elevated:!0,css:o7.root,p:8,pt:12,gap:4,children:[(0,y.jsxs)(Q.View,{css:o7.outerRow,children:[(0,y.jsx)(Q.View,{grow:!0,shrink:!0,gap:4,children:a?(0,y.jsx)(K.Text,{multiline:!1,children:a}):null}),o?null:(0,y.jsx)(z.IconButton,{alt:l?"Edit":u,disabled:!l,onClick:e.onEditAutoscaleMachineConfiguration,children:(0,y.jsx)(tp.default,{})})]}),i?(0,y.jsxs)(y.Fragment,{children:[(0,y.jsxs)(Q.View,{css:o7.outerRow,children:[(0,y.jsx)(K.Text,{multiline:!1,children:i.description}),(0,y.jsx)(K.Text,{color:"dimmer",multiline:!1,children:i.renewalInfo})]}),(0,y.jsx)(Q.View,{css:o7.outerRow,children:(0,y.jsx)(L.default,{href:"/usage",prefetch:!1,role:"button",children:"View account resource limits"})})]}):null]})},at=e.i(368487);function an(){var e=(0,ei._)(["\n  mutation NotificationsSectionUpdateFailureNotifications(\n    $input: UpdateMachineJobFailureNotificationInput!\n  ) {\n    updateMachineJobFailureNotification(input: $input) {\n      ... on UnauthorizedError {\n        message\n      }\n      ... on NotFoundError {\n        message\n      }\n      ... on UserError {\n        message\n      }\n      ... on UpdateMachineJobFailureNotificationResult {\n        failureNotifications\n      }\n    }\n  }\n"]);return an=function(){return e},e}var ar={},ai=(0,eo.gql)(an()),ao=e.i(721321),aa=e.i(555765),as=e.i(367777),al=(0,U.cssRecord)({container:[G.rcss.colWithGap(8)]});function au(e){var t,n,r=e.replId,i=e.isCurrentBuildSuccess,o=e.areFailureNotificationsEnabled,a=(0,x._)((0,b.useState)(o),2),s=a[0],l=a[1],u=(0,x._)((0,b.useState)(void 0),2),c=u[0],d=u[1],f=(0,x._)((t={onCompleted:function(e){var t=e.updateMachineJobFailureNotification;((null==t?void 0:t.__typename)==="NotFoundError"||(null==t?void 0:t.__typename)==="UnauthorizedError"||(null==t?void 0:t.__typename)==="UserError")&&(d(t.message),l(function(e){return!e}))}},n=(0,er._)({},ar,t),t2.useMutation(ai,n)),1)[0],p=function(e){d(void 0),f({variables:{input:{replId:r,failureNotifications:e}}}),l(e)};return(0,y.jsxs)(Q.View,{children:[c?(0,y.jsx)(tQ.StatusBanner,{text:c,colorway:"warning"}):null,(0,y.jsxs)(Y.Tooltip,{isDisabled:i,tooltip:"Most recent build failed. Republish successfully before enabling notifications",placement:"top-end",css:al.container,children:[(0,y.jsxs)(ao.ButtonGroup,{disabled:!i,tag:"fieldset",name:"notification-switch",value:s?"enabled":"disabled",onChange:function(e){p("enabled"===e)},row:!0,primary:!0,stretch:!0,children:[(0,y.jsx)(ao.ButtonGroupItem,{id:"failure-notifications-disabled",value:"disabled",text:"Disabled",icon:(0,y.jsx)(as.default,{})}),(0,y.jsx)(ao.ButtonGroupItem,{id:"failure-notifications-enabled",value:"enabled",text:"Enabled",icon:(0,y.jsx)(aa.default,{})})]}),(0,y.jsx)(K.Text,{color:"dimmer",children:"Send email and push notifications when a scheduled job fails"})]})]})}var ac=(0,U.cssRecord)({container:[oG.sharedCss.maxWidth,G.rcss.py(8)],usageContainer:G.rcss.colWithGap(16),header:G.rcss.pb(8),paddedHeader:G.rcss.pb(12)}),ad=function(e){var t=e.deploymentId,n=e.onLifecycleCommand,r=e.onError;return t?(0,y.jsx)(ap,{deploymentId:t,onLifecycleCommand:n,onError:r}):(0,y.jsx)(C.PaneSection,{children:(0,y.jsx)(tQ.StatusBanner,{colorway:"warning",icon:(0,y.jsx)(Z.default,{}),text:"Published app not found"})})},af={__typename:"ReplAuthorizations",addCustomDomain:{__typename:"ReplAuthorization",isAuthorized:!1,code:k.ReplAuthorizationCode.InsufficientPermissions,message:"Loading"},deleteCustomDomain:{__typename:"ReplAuthorization",isAuthorized:!1,code:k.ReplAuthorizationCode.InsufficientPermissions,message:"Loading"},deleteDeployment:{__typename:"ReplAuthorization",isAuthorized:!1,code:k.ReplAuthorizationCode.InsufficientPermissions,message:"Loading"},editDeploymentStatus:{__typename:"ReplAuthorization",isAuthorized:!1,code:k.ReplAuthorizationCode.InsufficientPermissions,message:"Loading"},editDeploymentTier:{__typename:"ReplAuthorization",isAuthorized:!1,code:k.ReplAuthorizationCode.InsufficientPermissions,message:"Loading"}};function ap(e){var t,n,r,i,o,a=(0,iL.useIsInBonsaiWebview)(),s=(0,x._)((0,b.useState)(!1),2),l=s[0],u=s[1];(0,b.useEffect)(function(){(0,_.trackDeploymentSectionViewed)({context:S.Views.Settings})},[]);var c=(0,x._)((0,w.useHostingDeploymentSettingsAuthzLazyQuery)(),2),d=c[0],f=c[1],p=f.data,h=f.error,g=(0,eb.useFlag)({controlName:"flag-domains-glowup",default:!1}),m=(0,w.useHostingDeploymentSettingsQuery)({variables:{id:e.deploymentId,isGlowup:g},ssr:!1,fetchPolicy:"cache-and-network",onCompleted:function(e){var t;(null==e||null==(t=e.hostingDeployment)?void 0:t.__typename)==="HostingDeployment"&&d({variables:{replId:e.hostingDeployment.repl.id,provider:e.hostingDeployment.currentBuild.provider}})}}),T=m.data,E=m.loading,R=m.error,I=(null==T||null==(t=T.hostingDeployment)?void 0:t.__typename)==="HostingDeployment"?T.hostingDeployment:void 0;if(l&&(null==I?void 0:I.currentBuild.provider)===k.HostingBuildProvider.CloudRun)return(0,y.jsx)(o4.AutoscaleMachineConfiguration,{type:k.HostingBuildProvider.CloudRun,onError:e.onError,onConfirm:function(t){e.onLifecycleCommand({command:k.SendDeploymentLifecycleCommandType.UpdateMachineConfiguration,machineConfigurationId:t.configurationId,maxMachineInstances:t.maxInstances})},onBack:function(){return u(!1)}});if(R)return(0,y.jsx)(j.ViewError,{text:R.message});if(E||!I)return(0,y.jsx)(C.PaneSection,{centered:!0,children:(0,y.jsx)(j.ViewLoading,{})});var A=I.currentBuild,P=null!=(i=null==A?void 0:A.machineConfiguration)?i:void 0,D=(null==p||null==(n=p.getRepl)?void 0:n.__typename)==="Repl"?p.getRepl.authorizations:af;return(0,y.jsx)(C.PaneSection,{children:(0,y.jsxs)(Q.View,{css:ac.container,gap:32,children:[h?(0,y.jsx)(tQ.StatusBanner,{colorway:"negative",text:h.message}):void 0,A.provider===k.HostingBuildProvider.CloudRun?(0,y.jsxs)(Q.View,{children:[(0,y.jsx)(K.Text,{variant:"subheadDefault",css:ac.header,children:"Resource usage"}),(0,y.jsx)(Q.View,{css:ac.usageContainer,children:(0,y.jsx)(ae,{machineConfiguration:P,onEditAutoscaleMachineConfiguration:function(){return u(!0)},authorizations:D})})]}):null,(0,y.jsxs)(Q.View,{children:[(0,y.jsx)(K.Text,{variant:"subheadDefault",css:ac.paddedHeader,children:"Manage published app"}),(0,y.jsx)(at.DeploymentSuspendedReason,{}),(0,y.jsx)(oJ,{onLifecycleCommand:e.onLifecycleCommand,authorizations:D})]}),A.provider===k.HostingBuildProvider.Cron?(0,y.jsxs)(Q.View,{children:[(0,y.jsx)(K.Text,{variant:"subheadDefault",css:ac.paddedHeader,children:"Scheduled Job Notifications"}),(0,y.jsx)(au,{replId:I.repl.id,isCurrentBuildSuccess:I.currentBuild.status===k.HostingBuildStatus.Success,areFailureNotificationsEnabled:null!=(o=null==(r=I.currentBuild.machineJob)?void 0:r.failureNotifications)&&o})]}):null,a?null:(0,y.jsxs)(Q.View,{children:[(0,y.jsx)(K.Text,{variant:"subheadDefault",css:ac.paddedHeader,children:"Publish on the go"}),(0,y.jsx)(o3,{shouldShowDownloadQR:!1})]})]})})}e.s(["Settings",()=>ad],251299);var ah=e.i(169252);function ag(){var e=(0,ei._)(["\n  fragment DeploymentsNewDeploymentRepl on Repl {\n    id\n    slug\n    lastUsedSubdomain\n    owner {\n      ... on User {\n        id\n        username\n      }\n      ... on Team {\n        id\n        username\n      }\n    }\n    org {\n      __typename\n      id\n      slug\n      type\n    }\n  }\n"]);return ag=function(){return e},e}function am(){var e=(0,ei._)(["\n  query DeploymentsNewDeployment($replId: String!) {\n    getRepl(id: $replId) {\n      ... on Repl {\n        id\n        ...DeploymentsNewDeploymentRepl\n      }\n      ... on Error {\n        message\n      }\n    }\n  }\n  ","\n"]);return am=function(){return e},e}function av(){var e=(0,ei._)(["\n  query DeploymentsPaneIntro($id: String!) {\n    getRepl(id: $id) {\n      ... on Repl {\n        id\n        owner {\n          __typename\n          ... on Team {\n            id\n          }\n        }\n        ...DeploymentsNewDeploymentRepl\n      }\n      ... on Error {\n        message\n      }\n    }\n  }\n  ","\n"]);return av=function(){return e},e}var ax={},ay=(0,eo.gql)(ag()),ab=(0,eo.gql)(am(),ay);(0,eo.gql)(av(),ay);var aw=e.i(967963),ak=e.i(596139),a_=e.i(597865),aS=((a={}).NO_REMOTE="NO_REMOTE",a.UNPUSHED_BRANCH="UNPUSHED_BRANCH",a.UNCOMMITTED_CHANGES="UNCOMMITTED_CHANGES",a.UNPUSHED_COMMITS="UNPUSHED_COMMITS",a);function aC(){var e=(0,ei._)(["\n  mutation StripeConnectionDeleteStripeConnection(\n    $input: DeleteConnectionInput!\n  ) {\n    deleteConnection(input: $input) {\n      ... on DeleteConnection {\n        success\n      }\n    }\n  }\n"]);return aC=function(){return e},e}function aj(){var e=(0,ei._)(["\n  mutation StripeConnectionCreateStripeConnection(\n    $input: CreateConnectionInput!\n  ) {\n    createConnection(input: $input) {\n      ... on CreateConnection {\n        connectionId\n      }\n    }\n  }\n"]);return aj=function(){return e},e}var aT={},aE=(0,eo.gql)(aC()),aR=(0,eo.gql)(aj()),aI=e.i(58261);function aA(){var e=(0,aI.useConnectorContext)(),t=e.connections,n=e.loading,r=(0,tR.default)(),i=t.find(function(e){var t;return e.connectorName===ah.ConnectorName.Stripe&&"development"===e.environment&&(null==(t=e.repls)?void 0:t.some(function(e){return e.id===r}))}),o=t.find(function(e){var t;return e.connectorName===ah.ConnectorName.Stripe&&"production"===e.environment&&(null==(t=e.repls)?void 0:t.some(function(e){return e.id===r}))});return{hasStripeSandboxConnection:!!i,hasStripeConnection:!!o,stripeConnection:o,stripeSandboxConnection:i,loading:n}}var aP=e.i(810206),aD=e.i(283660),aO=e.i(322945),aN=function(e){var t=e.syncSandboxWithLive,n=e.setSyncSandboxWithLive;return(0,y.jsx)(aP.Section,{id:"syncSandboxWithLive",title:(0,y.jsxs)(Q.View,{gap:4,children:[(0,y.jsxs)(Q.View,{row:!0,gap:8,align:"center",children:[(0,y.jsx)(K.Text,{color:"dimmer",children:"Sync live account with sandbox"}),(0,y.jsx)(H.Pill,{text:"Recommended",colorway:"positive",variant:"muted",compact:!0})]}),(0,y.jsx)(K.Text,{variant:"small",color:"dimmer",children:"Automatically sync your sandbox products and prices to your live account."})]}),children:(0,y.jsx)(tc.Switch,{isSelected:t,onChange:n,"aria-label":"Sync sandbox with live account"})})};function aM(e){var t,n,r,i,o=e.syncSandboxWithLive,a=e.setSyncSandboxWithLive,s=aA(),l=s.hasStripeConnection,u=s.stripeConnection,c=s.loading,d=(0,aI.useConnectorContext)(),f=d.connectorConfigs,p=d.refetch,h=(0,tR.default)(),g=(0,x._)((0,b.useState)("INPUT"),2),m=g[0],w=g[1],k=(0,x._)((0,b.useState)(""),2),_=k[0],S=k[1],C=(0,x._)((0,b.useState)(""),2),j=C[0],T=C[1],E=(0,x._)((0,b.useState)(null),2),R=E[0],I=E[1],A=(0,x._)((0,b.useState)(!1),2),P=A[0],N=A[1],M=(0,x._)((t={onCompleted:function(e){return(0,D._)(function(){var t;return(0,O._)(this,function(n){switch(n.label){case 0:if((null==e||null==(t=e.createConnection)?void 0:t.__typename)!=="CreateConnection")return[3,2];return[4,p()];case 1:return n.sent(),w("CONNECTED"),[3,3];case 2:I("Failed to create connection"),w("INPUT"),n.label=3;case 3:return[2]}})})()},onError:function(e){I(e.message||"Failed to connect to Stripe"),w("INPUT")}},n=(0,er._)({},aT,t),t2.useMutation(aR,n)),1)[0],L=(0,x._)((r={onCompleted:function(e){return(0,D._)(function(){var t;return(0,O._)(this,function(n){switch(n.label){case 0:if((null==e||null==(t=e.deleteConnection)?void 0:t.__typename)!=="DeleteConnection")return[3,2];return[4,p()];case 1:return n.sent(),w("INPUT"),S(""),T(""),[3,3];case 2:I("Failed to disconnect from Stripe"),w("INPUT"),n.label=3;case 3:return[2]}})})()},onError:function(e){I(e.message||"Failed to disconnect from Stripe"),w("INPUT")}},i=(0,er._)({},aT,r),t2.useMutation(aE,i)),1)[0],B=f.find(function(e){return"STRIPE"===e.connectorName}),V=_.length>0&&j.length>0,U=(0,b.useCallback)(function(){B&&V&&(w("CONNECTING"),I(null),M({variables:{input:{connectorConfigId:B.id,settings:{publishable:_,secret:j,mcp:"test"},replId:h}}}))},[M,B,_,j,h,V]),G=(0,b.useCallback)(function(){(null==u?void 0:u.connectionId)&&(w("DISCONNECTING"),I(null),L({variables:{input:{connectionId:u.connectionId}}}))},[L,u]);return c?(0,y.jsxs)(Q.View,{gap:8,align:"center",p:16,children:[(0,y.jsx)(J.default,{}),(0,y.jsx)(K.Text,{color:"dimmer",children:"Loading Stripe connection..."})]}):l?(0,y.jsxs)(Q.View,{className:aO.default.container,children:[(0,y.jsxs)(Q.View,{row:!0,justify:"space-between",align:"center",p:8,className:aO.default.clickable,onClick:function(){return N(!P)},children:[(0,y.jsx)(Q.View,{gap:4,style:{flex:1,minWidth:0},children:(0,y.jsx)(K.Text,{children:"Live Stripe account status"})}),(0,y.jsxs)(Q.View,{row:!0,gap:8,align:"center",children:[(0,y.jsxs)(Q.View,{row:!0,gap:4,align:"center",children:[(0,y.jsx)(aD.default,{size:8,color:F.tokens.greenStronger}),(0,y.jsx)(K.Text,{color:"dimmer",variant:"small",children:"Connected"})]}),(0,y.jsx)(z.IconButton,{alt:P?"Show connection details":"Hide connection details",onClick:function(){return N(!P)},children:P?(0,y.jsx)(rS.default,{color:F.tokens.foregroundDimmer}):(0,y.jsx)(r_.default,{color:F.tokens.foregroundDimmer})})]})]}),(0,y.jsxs)(Q.View,{p:8,gap:12,className:P?aO.default.hiddenContent:aO.default.contentBorder,children:[(0,y.jsxs)(Q.View,{gap:4,children:[(0,y.jsx)(K.Text,{variant:"small",children:"Live publishable key"}),(0,y.jsx)(e2.Input,{value:"pk_live_123_123",disabled:!0,type:"password"})]}),(0,y.jsxs)(Q.View,{gap:4,children:[(0,y.jsx)(K.Text,{variant:"small",children:"Live secret key"}),(0,y.jsx)(e2.Input,{value:"sk_live_123_123",disabled:!0,type:"password"})]}),(0,y.jsx)(Q.View,{className:aO.default.sectionDivider}),(0,y.jsx)(aN,{syncSandboxWithLive:o,setSyncSandboxWithLive:a}),(0,y.jsx)($.Button,{text:"DISCONNECTING"===m?"Disconnecting...":"Disconnect",onClick:G,disabled:"DISCONNECTING"===m,loading:"DISCONNECTING"===m,colorway:"negative",stretch:!0})]})]}):B?(0,y.jsx)(Q.View,{gap:8,children:(0,y.jsxs)(Q.View,{className:aO.default.container,children:[(0,y.jsxs)(Q.View,{row:!0,justify:"space-between",align:"center",p:8,className:aO.default.clickable,onClick:function(){return N(!P)},children:[(0,y.jsxs)(Q.View,{gap:4,style:{flex:1,minWidth:0},children:[(0,y.jsx)(K.Text,{children:"Connect your live Stripe account"}),(0,y.jsx)(K.Text,{color:"dimmer",variant:"small",multiline:!0,children:"Add your live Stripe API keys to start processing payments in production."})]}),(0,y.jsx)(z.IconButton,{alt:P?"Show connection form":"Hide connection form",onClick:function(){return N(!P)},children:P?(0,y.jsx)(rS.default,{color:F.tokens.foregroundDimmer}):(0,y.jsx)(r_.default,{color:F.tokens.foregroundDimmer})})]}),(0,y.jsxs)(Q.View,{p:8,gap:12,className:P?aO.default.hiddenContent:aO.default.contentBorder,children:[R?(0,y.jsx)(q.Surface,{p:8,children:(0,y.jsx)(K.Text,{variant:"small",color:"dimmer",children:R})}):null,(0,y.jsxs)(Q.View,{gap:4,children:[(0,y.jsx)(K.Text,{variant:"small",children:"Live Publishable Key"}),(0,y.jsx)(e2.Input,{placeholder:"pk_live_...",type:"password",value:_,onChange:function(e){return S(e.target.value)},disabled:"CONNECTING"===m})]}),(0,y.jsxs)(Q.View,{gap:4,children:[(0,y.jsx)(K.Text,{variant:"small",children:"Live Secret Key"}),(0,y.jsx)(e2.Input,{placeholder:"sk_live_...",type:"password",value:j,onChange:function(e){return T(e.target.value)},disabled:"CONNECTING"===m})]}),(0,y.jsx)(Q.View,{className:aO.default.sectionDivider}),(0,y.jsx)(aN,{syncSandboxWithLive:o,setSyncSandboxWithLive:a}),(0,y.jsx)($.Button,{text:"CONNECTING"===m?"Connecting...":"Connect",onClick:U,disabled:!V||"CONNECTING"===m,loading:"CONNECTING"===m,colorway:"primary",stretch:!0})]})]})}):null}var aL=e.i(197486),aB=e.i(365692),aV=e.i(137737),aF=e.i(942859),aU=e.i(487517),aG=e.i(648518),a$=e.i(62279),az=e.i(546345),aH=e.i(802436),aW=e.i(620365),aq=e.i(398594),aK=e.i(315315),aY=e.i(304484),aQ=e.i(938024),aX=e.i(652742);function aJ(e){var t=e.isOpen,n=e.onToggle,r=e.ports,i=e.openNetworkingPane,o=e.openSecretsPane,a=e.replId,s=e.provider,l=e.setProvider,u=e.onError,c=e.initialSecretsSyncExpanded,d=e.machineConfig,f=e.setMachineConfig,p=e.onEditAutoscaleConfig,h=e.appType,g=e.onAppTypeChanged,m=e.recommendedProvider,w=e.runCommandError,_=e.publicDirError,S=e.crontabError,C=e.timezoneError,j=e.setTimeoutValueError,T=e.buildCommand,E=e.setBuildCommand,R=e.runCommand,I=e.setRunCommand,P=e.publicDir,D=e.setPublicDir,O=e.timezone,N=e.setTimezone,M=e.crontab,L=e.setCrontab,B=e.timeoutValue,V=e.setTimeoutValue,U=e.timeoutUnits,G=e.setTimeoutUnits,$=e.envVars,H=e.ignoredSecrets,W=e.addAnEnvVar,q=e.updateEnvVarName,Y=e.updateEnvVarValue,X=e.removeEnvVar,J=e.optOut,ee=e.optIn,et=e.syncToWorkspace,en=e.optionsLoading,er=e.queryLoading,ei=e.baseDisableState,eo=e.envVarKeys,ea=e.editReplSecretsAuthorization,es=e.editDeploySecretAuthorization,el=e.devSecrets,eu=e.orgId,ec=(0,x._)((0,b.useState)(!1),2),ed=ec[0],ef=ec[1],ep=(0,x._)((0,b.useState)(!1),2),eh=ep[0],eg=ep[1],em=(0,x._)((0,b.useState)(!1),2),ev=em[0],ex=em[1],ey=(0,x._)((0,b.useState)(!1),2),eb=ey[0],ew=ey[1],ek=[k.HostingBuildProvider.Gce,k.HostingBuildProvider.AzureVm,k.HostingBuildProvider.CloudRun,k.HostingBuildProvider.AzureContainerApp].includes(s),e_=h!==k.DeployHostingBuildAppType.Static,eS=s===k.HostingBuildProvider.Gce||s===k.HostingBuildProvider.AzureVm,eC=h===k.DeployHostingBuildAppType.Static,ej=s===k.HostingBuildProvider.Cron,eT=h===k.DeployHostingBuildAppType.Server||h===k.DeployHostingBuildAppType.CloudRun;(0,b.useEffect)(function(){var e=!!(w||_||S||C);eg(ed),ex(e),(ed||e)&&!eb&&!t&&n(),ew(ed||e)},[s,ed,t,n,eb,w,_,S,C]);var eE=(0,x._)((0,b.useState)(!1),2),eR=eE[0],eI=eE[1];return(0,y.jsxs)(Q.View,{className:aX.default.container,children:[(0,y.jsxs)(Q.View,{row:!0,justify:"space-between",align:"center",p:8,className:aX.default.clickable,onClick:n,children:[(0,y.jsxs)(Q.View,{gap:4,style:{flex:1,minWidth:0},children:[(0,y.jsxs)(Q.View,{row:!0,gap:8,align:"center",children:[(0,y.jsx)(K.Text,{children:"Advanced settings"}),ev?(0,y.jsx)(aQ.default,{size:16,color:F.colormap.negative.default}):null,eh?(0,y.jsx)(Z.default,{size:16,color:F.colormap.warning.strongest}):null]}),(0,y.jsx)(K.Text,{color:"dimmer",variant:"small",multiline:!0,children:"Manually configure machine settings, secrets, build commands, ports, and more."})]}),(0,y.jsx)(z.IconButton,{alt:t?"Hide settings":"Show settings",onClick:n,children:t?(0,y.jsx)(r_.default,{color:F.tokens.foregroundDimmer}):(0,y.jsx)(rS.default,{color:F.tokens.foregroundDimmer})})]}),(0,y.jsxs)(Q.View,{p:8,gap:4,className:t?aX.default.contentBorder:aX.default.hiddenContent,children:[(0,y.jsx)(aU.default,{provider:s,setProvider:l,recommendedProvider:m}),ek?(0,y.jsxs)(y.Fragment,{children:[(0,y.jsx)(Q.View,{className:aX.default.sectionDivider}),(0,y.jsx)(az.default,{provider:s,machineConfig:d,setMachineConfig:f,onError:u,onEditAutoscaleConfig:p})]}):null,ej?(0,y.jsxs)(y.Fragment,{children:[(0,y.jsx)(Q.View,{className:aX.default.sectionDivider}),(0,y.jsx)(Q.View,{gap:4,children:(0,y.jsx)(aq.ScheduledMachineConfiguration,{crontab:M,setCrontab:L,crontabError:S,timezone:O,setTimezone:N,timezoneError:C,timeoutValue:B,setTimeoutValue:V,timeoutUnits:U,setTimeoutUnits:G,setTimeoutValueError:j,loading:en})})]}):null,eC?(0,y.jsxs)(y.Fragment,{children:[(0,y.jsx)(Q.View,{className:aX.default.sectionDivider}),(0,y.jsx)(aH.PublicDirectorySection,{value:P,onChange:D,error:_})]}):null,(0,y.jsx)(Q.View,{className:aX.default.sectionDivider}),(0,y.jsx)(aF.BuildCommandSection,{value:T,onChange:E}),e_?(0,y.jsxs)(y.Fragment,{children:[(0,y.jsx)(Q.View,{className:aX.default.sectionDivider}),(0,y.jsx)(aW.RunCommandSection,{value:R,onChange:I,error:w})]}):null,(0,y.jsx)(function(){return(0,y.jsxs)(y.Fragment,{children:[(0,y.jsx)(Q.View,{className:aX.default.sectionDivider}),(0,y.jsx)(rm.AccordionItem,{headerContent:(0,y.jsxs)(Q.View,{style:{flex:1,minWidth:0},gap:4,children:[(0,y.jsx)(K.Text,{children:"Deployment secrets"}),(0,y.jsxs)(K.Text,{color:"dimmer",variant:"small",multiline:!0,children:["Private keys your apps use to access APIs and services."," ",o?(0,y.jsx)("a",{href:"#",onClick:function(e){e.preventDefault(),o()},style:{color:"var(--color-primary-default)"},children:"Manage your development secrets"}):null]}),eu?(0,y.jsx)(tQ.StatusBanner,{icon:(0,y.jsx)(tL.default,{}),css:aX.default.statusBanner,colorway:"primary",text:"Secrets now sync automatically with your team's deployments. "+"Deployment secrets added before ".concat((0,aK.formatDateTime)(A.SYNCING_SECRETS_ROLLOUT_DATE.toISOString())," ")+"remain unchanged to avoid disrupting existing workflows. Manage syncing below."}):null]}),expanded:eR,onClick:function(){eI(!eR)},children:(0,y.jsx)(Q.View,{pt:8,children:(0,y.jsx)(aG.DeploymentSecretsSection,{envVars:$,envVarKeys:eo,updateEnvVarName:q,updateEnvVarValue:Y,removeEnvVar:X,addAnEnvVar:W,baseDisableState:ei,devSecrets:el,ignoredSecrets:H,editReplSecretsAuthorization:ea,editDeploySecretAuthorization:es,optOut:J,optIn:ee,syncToWorkspace:et,queryLoading:er,replId:a,initialSecretsSyncExpanded:c})})})]})},{}),eT?(0,y.jsxs)(y.Fragment,{children:[(0,y.jsx)(Q.View,{className:aX.default.sectionDivider}),r&&i?(0,y.jsx)(aY.PortConfiguration,{ports:r,openNetworkingPane:i,onWarningChange:ef}):null]}):null,eS?(0,y.jsxs)(y.Fragment,{children:[(0,y.jsx)(Q.View,{className:aX.default.sectionDivider}),(0,y.jsxs)(Q.View,{gap:8,children:[(0,y.jsxs)(Q.View,{gap:4,children:[(0,y.jsx)(K.Text,{children:"App type"}),(0,y.jsx)(K.Text,{variant:"small",color:"dimmer",children:"Configure your app based on whether it needs to serve traffic from the web."})]}),(0,y.jsx)(aV.DeploymentTargetSelector,{appType:h,onChange:g})]})]}):null,(0,y.jsx)(Q.View,{className:aX.default.sectionDivider}),(0,y.jsx)(a$.default,{})]})]})}var aZ=e.i(650853),a0=e.i(823166),a1=e.i(147255),a2=e.i(912467),a3=e.i(475868),a4=e.i(976191),a8=e.i(968783),a5=e.i(574203),a6=e.i(845228),a9=e.i(293265),a7=e.i(878284),se=e.i(399528),st=e.i(827305),sn=e.i(292672),sr=e.i(341126),si=e.i(418725),so=e.i(40253),sa=e.i(702069),ss=e.i(552144),sl=e.i(899323),su=e.i(503536),sc=e.i(264661),sd=(0,U.cssRecord)({cta:[G.rcss.width("100%"),G.rcss.maxWidth(320),{marginLeft:"auto",marginRight:"auto"}],ctaContainer:[G.rcss.colWithGap(8),G.rcss.align.center],ctaStatusBanner:[G.rcss.textAlign.left],disabledBanner:[G.rcss.py(6),{alignSelf:"center"}]});function sf(e){var t=e.provider,n=e.isDeployable,r=e.isDeployableCode,i=e.isDeployableExplanation,o=e.loading,a=e.refetchDeployabilityQueryData,s=e.setShowPaymentMethodForm,l=e.isPaymentMethodFormShown,u=e.setShowSupportForm,c=e.replId,d=e.org,f=e.onViewAction,p=(0,se.useRouter)(),h=(0,iL.isInBonsaiWebview)(p),g=(0,sn.useBonsaiUnsupportedAuthzCodes)({isOrg:null!=d}),m=function(){f({type:S.ViewActionType.OpenPane,payload:{type:"git"}})};if(e.blockDeploymentForMissingGitRemote)if(e.blockDeploymentForMissingGitRemote===aS.NO_REMOTE)return(0,y.jsx)($.Button,{text:"Git remote required. Add a remote repository to publish your app",colorway:"warning",iconRight:(0,y.jsx)(sc.default,{}),css:sd.ctaStatusBanner,onClick:m});else{if(e.blockDeploymentForMissingGitRemote===aS.UNPUSHED_BRANCH)return(0,y.jsx)($.Button,{text:"Your branch is not pushed. Push your branch to publish your app",colorway:"warning",iconRight:(0,y.jsx)(sc.default,{}),css:sd.ctaStatusBanner,onClick:m});if(e.blockDeploymentForMissingGitRemote===aS.UNCOMMITTED_CHANGES)return(0,y.jsx)($.Button,{colorway:"warning",text:"You have uncommitted changes. Commit and push your changes to publish",iconRight:(0,y.jsx)(sc.default,{}),css:sd.ctaStatusBanner,onClick:m});if(e.blockDeploymentForMissingGitRemote===aS.UNPUSHED_COMMITS)return(0,y.jsx)($.Button,{text:"You have unpushed commits. Push your commits to publish your app",colorway:"warning",iconRight:(0,y.jsx)(sc.default,{}),css:sd.ctaStatusBanner,onClick:m});(0,M.default)(e.blockDeploymentForMissingGitRemote)}if(!n&&h&&g.includes(r))return(0,y.jsx)(tQ.StatusBanner,{text:i,colorway:"grey",css:sd.disabledBanner});var x=function(){if(d){var e=(0,sr.orgLinks)(d).settings.href.toString()+"/billing";window.open(e,"_blank");return}s()};switch(r){case k.ReplAuthorizationCode.RequiresActiveSubscription:return(0,y.jsx)(Q.View,{css:sd.ctaContainer,children:(0,y.jsx)(si.default,{context:"workspace_hosting_pane",text:"Upgrade your plan to publish",css:sd.cta,colorway:"primary",variant:"default",disabled:l,onPlanCheckoutComplete:a,modalHeadingText:"Upgrade your plan to publish"})});case k.ReplAuthorizationCode.RequiresPaymentMethodOrSubscription:return(0,y.jsxs)(Q.View,{css:sd.ctaContainer,children:[(0,y.jsx)(si.default,{context:"workspace_hosting_pane",text:"Upgrade your plan to publish",css:sd.cta,colorway:"primary",variant:"default",disabled:l,onPlanCheckoutComplete:a,modalHeadingText:"Upgrade your plan to publish"}),(0,y.jsx)($.Button,{variant:"nofill",colorway:"primary",text:"or add a payment method",css:sd.cta,disabled:l,loading:o,iconLeft:(0,y.jsx)(sl.default,{}),onClick:x})]});case k.ReplAuthorizationCode.RequiresSmsVerification:return(0,y.jsx)(st.default,{context:k.SmsVerificationContext.Deployments,onSuccess:a});case k.ReplAuthorizationCode.RequiresPaymentMethod:return(0,y.jsx)($.Button,{colorway:"primary",text:"Add a payment method",css:sd.cta,disabled:l,loading:o,iconLeft:(0,y.jsx)(sl.default,{}),onClick:x});case k.ReplAuthorizationCode.PaymentDelinquent:return(0,y.jsx)(so.PaymentDelinquentButton,{onClick:x});case k.ReplAuthorizationCode.RequiresUnbanning:return(0,y.jsx)(ss.StatusBannerButton,{text:"Your account currently has restrictions on publishing. We're here to help! Please reach out to support@replit.com for assistance.",colorway:"warning",iconLeft:(0,y.jsx)(Z.default,{}),css:sd.ctaStatusBanner,onClick:function(){return u()}});case k.ReplAuthorizationCode.InsufficientBudget:return(0,y.jsxs)(y.Fragment,{children:[(0,y.jsx)(tQ.StatusBanner,{text:"You've reached your monthly usage budget. Increase your budget to continue publishing.",colorway:"warning",icon:(0,y.jsx)(Z.default,{}),css:sd.ctaStatusBanner}),(0,y.jsx)(sa.UsageBudget,{onUpdateSuccess:a,replId:c})]});case k.ReplAuthorizationCode.FeatureDisabled:case k.ReplAuthorizationCode.FeatureUnsupportedForReplitTeams:case k.ReplAuthorizationCode.FeatureUnsupportedForTeamsEdu:case k.ReplAuthorizationCode.FeatureUnsupportedForTeamsFree:case k.ReplAuthorizationCode.FeatureUnsupportedForTeamsPro:case k.ReplAuthorizationCode.InsufficientPermissions:case k.ReplAuthorizationCode.InsufficientQuota:case k.ReplAuthorizationCode.RequiresActiveTeamsSubscription:case k.ReplAuthorizationCode.RequiresEmailVerification:if(r===k.ReplAuthorizationCode.InsufficientQuota&&"static"===t)return(0,y.jsxs)(Q.View,{css:sd.ctaContainer,children:[(0,y.jsx)(tQ.StatusBanner,{text:"You have reached the maximum number of Static published apps available on your plan.",colorway:"grey",css:sd.disabledBanner}),(0,y.jsx)(si.default,{context:"workspace_hosting_pane",text:"Upgrade your plan to publish",css:sd.cta,colorway:"primary",variant:"default",disabled:l,onPlanCheckoutComplete:a,modalHeadingText:"Upgrade your plan to publish"})]});return(0,y.jsx)(tQ.StatusBanner,{text:i,colorway:"grey",css:sd.disabledBanner});case k.ReplAuthorizationCode.Authorized:case k.ReplAuthorizationCode.AuthorizedQuota:return(0,y.jsx)($.Button,{colorway:"primary",onClick:e.handleDeployClick,iconLeft:e.optionsLoading||e.mode===oH.DeploymentMode.Preparing?(0,y.jsx)(J.default,{}):(0,y.jsx)(su.default,{}),text:e.mode===oH.DeploymentMode.Preparing&&"Preparing..."||e.optionsLoading&&"Fetching options..."||"Publish",disabled:e.disabled});case k.ReplAuthorizationCode.RequiresEnterprisePlan:return;default:(0,M.default)(r)}}var sp=e.i(264646),sh=e.i(91720),sg=e.i(531603),sm=e.i(442060),sm=sm,sv=e.i(903283),sv=sv,sx=e.i(576073),sy=e.i(821488),sb=e.i(729015),sw=e.i(694772);function sk(e){var t=(0,P.useDotReplitService)(),n=(0,P.useDeploymentProvider)({onError:e.onError,dotReplitService:t}),r=n.recommendedProvider,i=n.loading,o=e.initialView===S.Views.ReservedVMTierSelection?k.HostingBuildProvider.Gce:null!=r?r:k.HostingBuildProvider.CloudRun,a=o===k.HostingBuildProvider.AzureContainerApp||o===k.HostingBuildProvider.AzureVm,s=(0,o4.useAutoscaleConfigurations)({isAzureDeployment:a,onError:e.onError}),l=s.defaultMachineConfiguration,u=s.loading,c=(0,a0.useReservedVmConfigurations)({provider:o,skip:i,onError:e.onError}),d=c.defaultMachineConfiguration,f=c.loading,p=(0,aB.getRecommendedProviderMachineConfiguration)({recommendedProvider:r,defaultAutoscaleConfiguration:l,defaultRvmMachineConfiguration:d});return!e.initialView&&i||u||f?(0,y.jsx)(C.PaneSection,{centered:!0,children:(0,y.jsx)(j.ViewLoading,{})}):(0,y.jsx)(s_,(0,eS._)((0,er._)({},e),{initialSelectedProvider:o,recommendedProvider:r,defaultMachine:null!=p?p:null,isAzureDeployment:a}))}function s_(e){var t,n,r,i,o=e.deploymentId,a=e.replId,s=e.onError,l=e.onDeploy,u=e.onViewAction,c=e.initialSelectedProvider,d=e.recommendedProvider,f=e.hasAgentSession,p=e.defaultMachine,h=e.isAzureDeployment,g=(0,P.useFsService)(),m=(0,P.useSecretsService)(),w=(0,P.useDotReplitService)(),_=(0,P.usePortsService)(),T=(0,eb.useFlag)({controlName:"flag-make-more-money",default:!1}),E=(0,x._)((0,b.useState)(!1),2),R=E[0],I=E[1],A=(0,x._)((0,b.useState)(!1),2),N=A[0],M=A[1],L=(t={variables:{replId:a},fetchPolicy:"no-cache",onError:function(e){return s(e.message)}},n=(0,er._)({},ax,t),ea.useQuery(ab,n)),B=L.data,V=L.loading,F=(null==B?void 0:B.getRepl.__typename)==="Repl"?B.getRepl:null,U=F?F.lastUsedSubdomain||(0,aw.getQualifiedReplSubdomain)({replSlug:F.slug,username:null==(r=F.owner)?void 0:r.username}):"",G=(0,a4.useDeploymentOptionsState)({deploymentId:o,replId:a,initialSubdomain:U,initialProvider:c,initialMachineConfig:p,secrets:m,fs:g,dotReplit:w,onDeploy:l,onError:s,hasAgentSession:f}),H=G.mode,W=G.deployment,Y=G.queryLoading,X=G.optionsLoading,J=G.isRedeploy,Z=G.editDeploySecretAuthorization,ee=G.editReplSecretsAuthorization,et=G.appType,en=G.subdomain,ei=G.validSubdomain,eo=G.buildCommand,es=G.runCommand,el=G.runCommandError,eu=G.timezoneError,ec=G.crontabError,ed=G.envVars,ef=G.timezone,ep=G.crontab,eh=G.timeoutValue,eg=G.timeoutUnits,em=G.devSecrets,ev=G.privatePassword,ex=G.privatePasswordError,ey=G.hasExistingPrivatePassword,ew=G.orgId,ek=G.publicDir,e_=G.publicDirError,eS=G.isPrivate,eC=G.privacyMode,ej=G.syncSandboxWithLive,eT=G.ignoredSecrets,eE=G.isOverwriteSecretsModalOpen,eR=G.timeoutValueError,eI=G.canCreateNeonProductionDatabaseStateLoading,eA=G.isOverwritingSecrets,eP=G.provider,eD=G.machineConfig,eO=G.setAppType,eN=G.setSubdomain,eM=G.setValidSubdomain,eL=G.setBuildCommand,eB=G.setRunCommand,eV=G.setRunCommandError,eF=G.setTimezone,eU=G.setTimezoneError,eG=G.setCrontab,e$=G.setCrontabError,ez=G.setEnvVars,eH=G.setPublicDir,eW=G.setPublicDirError,eq=G.setTimeoutValue,eK=G.setTimeoutUnits,eY=G.setTimeoutValueError,eQ=G.setPrivacyMode,eX=G.setPrivatePassword,eJ=G.setSyncSandboxWithLive,eZ=G.setIgnoredSecrets,e0=G.setIsOverwriteSecretsModalOpen,e1=G.setProvider,e2=G.setMachineConfig,e3=G.createNeonProductionDatabase,e4=G.setCreateNeonProductionDatabase,e8=G.pushDevelopmentDatabaseObjects,e5=G.setPushDevelopmentDatabaseObjects,e6=G.overwriteData,e9=G.setOverwriteData,e7=G.createNeonProductionDatabaseState,te=G.hasNeonDevelopmentDatabase,tt=G.onAppTypeChanged,tn=G.onSubdomainBlur,tr=G.addAnEnvVar,ti=G.updateEnvVarName,to=G.updateEnvVarValue,ta=G.removeEnvVar,ts=G.handleDeployClick,tl=G.optOut,tu=G.optIn,tc=G.syncToWorkspace,td=G.overwriteSecrets;(0,b.useEffect)(function(){eV(void 0),eW(void 0),e$(void 0),eU(void 0),eY(!1),eP===k.HostingBuildProvider.CloudRun||eP===k.HostingBuildProvider.AzureContainerApp?eO(k.DeployHostingBuildAppType.CloudRun):eP===k.HostingBuildProvider.Gce||eP===k.HostingBuildProvider.AzureVm?eO(k.DeployHostingBuildAppType.Server):eP===k.HostingBuildProvider.Static?eO(k.DeployHostingBuildAppType.Static):eP===k.HostingBuildProvider.Cron&&eO(k.DeployHostingBuildAppType.Cron)},[eP,eO,e2,eV,eW,e$,eU,eY]);var tp=(0,x._)((0,b.useState)(!1),2),th=tp[0],tg=tp[1],tm=(0,x._)((0,b.useState)(!1),2),tv=tm[0],tx=tm[1],ty=(0,P.useDeploymentDeployability)(),tb=ty.getDeployabilityByProvider,tw=ty.refetch,tk=tb(eP,eS),t_=(0,a5.default)(ew),tS=(0,a8.useCurrentUserStoredOrgContext)().orgRole,tC=(0,a_.default)(function(e){return(0,D._)(function(){var t,n,r,i;return(0,O._)(this,function(o){switch(o.label){case 0:return[4,e.getRemotes()];case 1:if((n=o.sent()).error)return[2,{error:n.error}];if(!(n.remotes.size>0))return[2,{reason:"NO_REMOTE",error:null}];return[4,e.status()];case 2:if((r=o.sent()).error)return[2,{error:r.error}];if(!r.upstream)return[2,{reason:"UNPUSHED_BRANCH",error:null}];if(r.changes.length>0)return[2,{reason:"UNCOMMITTED_CHANGES",error:null}];if((null!=(i=null==(t=r.upstream)?void 0:t.ahead)?i:0)>0)return[2,{reason:"UNPUSHED_COMMITS",error:null}];return[2,{reason:null,error:null}]}})})()}),tj=(0,b.useMemo)(function(){return ew&&t_.requireGitRemoteBeforeDeployment&&tC&&!tC.error&&(!t_.adminOnlyGitRemoteBeforeDeploymentBypass||tS!==ah.SystemOrgGroupType.SystemAdmins)?tC.reason:null},[ew,t_.requireGitRemoteBeforeDeployment,t_.adminOnlyGitRemoteBeforeDeploymentBypass,tS,tC]),tT=J?tk.redeploy:tk.deploy,tE=tT.isAuthorized,tR=tT.code,tI=tT.message,tA=(0,oq.useIsAgentStackRepl)().isAgentStackRepl,tP=(0,a9.useAgentStackPlatformType)().agentStackPlatformType,tD=tR!==ah.ReplAuthorizationCode.RequiresActiveSubscription,tO=(0,x._)((0,b.useState)(!tD),2),tN=tO[0],tM=tO[1],tL=eP!==k.HostingBuildProvider.Cron&&!(null==W?void 0:W.replitAppSubdomain)&&!tA,tB=eP!==k.HostingBuildProvider.Cron&&!tA&&tD,tV=!!(0,a2.useIsSlackConnected)().connection,tF=tA&&tP===k.AgentStackPlatformType.Slack,tU=tA&&tP===k.AgentStackPlatformType.Telegram,tG=tA&&tP===k.AgentStackPlatformType.TimeBased,t$=aA(),tz=t$.hasStripeSandboxConnection,tH=t$.hasStripeConnection,tW=Y||X||H===oH.DeploymentMode.Preparing||eR,tq=tW||!tE||eI,tK=(0,a3.hasValidCronExpression)(ed),tY=(0,eb.useFlag)({controlName:"flag-deploy-without-agent-stack-connection",default:!1}),tQ=!!(0,aL.useTelegramBotTokenSecret)(),tX=!!tq||!!tL&&!ei||!!tA&&tP===k.AgentStackPlatformType.Slack&&!tV&&!tY||!!tA&&tP===k.AgentStackPlatformType.TimeBased&&!tK&&!tY||!!tA&&tP===k.AgentStackPlatformType.Telegram&&!tQ&&!tY||!!T&&!!tz&&!tH||!1,tJ=ed.map(function(e){return e.name}),tZ=(0,b.useCallback)(function(){return(0,D._)(function(){return(0,O._)(this,function(e){switch(e.label){case 0:return[4,tw()];case 1:return e.sent(),[2]}})})()},[tw]),t0=F&&(null==(i=F.owner)?void 0:i.__typename)==="Team"?{id:F.owner.id.toString(),slug:F.owner.username}:void 0,t1=function(){if(!tA)return"Publish your app";switch(tP){case k.AgentStackPlatformType.Slack:return"Publish to Slack";case k.AgentStackPlatformType.Telegram:return"Publish to Telegram";case k.AgentStackPlatformType.TimeBased:return"Publish Automation";default:return"Publish your app"}}(),t2=function(){if(!tA)return null;switch(tP){case k.AgentStackPlatformType.Slack:return"Ready to put your agent to work? Publish it to your Slack workspace in just a few steps.";case k.AgentStackPlatformType.Telegram:return"Ready to put your agent to work? Publish it to your Telegram chat in just a few steps.";case k.AgentStackPlatformType.TimeBased:return"Ready to put your agent to work? Set a time-based trigger to automate your agent.";default:return null}}();return V?(0,y.jsx)(j.ViewLoading,{}):R?(0,y.jsx)(a7.AutoscaleConfigEditor,{isAzureDeployment:h,onError:s,onConfirm:function(e){e2(e),I(!1)},onCancel:function(){return I(!1)}}):(0,y.jsxs)(C.PaneSection,{children:[(0,y.jsx)(rb.Modal,{isOpen:tv,onRequestClose:function(){return tx(!1)},children:(0,y.jsx)(sg.default,{onRequestClose:function(){return tx(!1)}})}),(0,y.jsxs)(Q.View,{className:sw.default.container,children:[(0,y.jsxs)(Q.View,{gap:8,children:[(0,y.jsx)(K.Text,{variant:"headerDefault",children:t1}),t2?(0,y.jsx)(K.Text,{children:t2}):null]}),tL||tB?(0,y.jsxs)(Q.View,{className:sw.default.urlContainer,children:[tL?(0,y.jsxs)(y.Fragment,{children:[(0,y.jsx)(K.Text,{children:"Primary URL"}),(0,y.jsx)(K.Text,{color:"dimmer",variant:"small",children:"You can add your own custom domain after publishing your app."}),(0,y.jsx)(aV.PrimaryDomainInput,{id:"primaryDomain",subdomain:en,provider:eP,deploymentId:o||void 0,onChange:eN,onBlur:tn,updateValidity:eM})]}):null,tB?(0,y.jsx)(sp.default,{privacyMode:eC,setPrivacyMode:eQ,privatePassword:ev,setPrivatePassword:eX,privatePasswordError:ex,hasExistingPrivatePassword:ey,isRedeploy:J}):null]}):null,tF?(0,y.jsx)(a1.default,{onDeleteDeployment:function(){u({type:S.ViewActionType.SendDeploymentLifecycleCommand,payload:{command:ah.SendDeploymentLifecycleCommandType.Destroy}})}}):null,tU?(0,y.jsx)(aL.TelegramConnectionSection,{deployDisabled:tX}):null,tG?(0,y.jsx)(a3.TimeBasedAgentScheduleSection,{envVars:ed,updateEnvVarValue:to,addAnEnvVar:tr,removeEnvVar:ta,initialized:!X}):null,T&&tz?(0,y.jsx)(aM,{syncSandboxWithLive:ej,setSyncSandboxWithLive:eJ}):null,(0,y.jsx)(sf,{provider:eP,isDeployable:tE,isDeployableCode:tR,isDeployableExplanation:tI,loading:V||X,handleDeployClick:function(){return ts(tL)},refetchDeployabilityQueryData:tZ,setShowPaymentMethodForm:function(){return tg(!0)},isPaymentMethodFormShown:th,setShowSupportForm:function(){return tx(!0)},org:t0,replId:a,optionsLoading:X,mode:H,disabled:tX,blockDeploymentForMissingGitRemote:tj,onViewAction:u}),!tA&&tD?(0,y.jsx)(aZ.CreateNeonProductionDatabaseToggleSection,{createDatabase:e3,setCreateDatabase:e4,pushDevelopmentDatabaseObjects:e8,setPushDevelopmentDatabaseObjects:e5,tooltipText:e7.tooltipText,warningText:e7.warningText,disabled:e7.isDisabled,isRedeploy:J,overwriteData:e6,setOverwriteData:e9,hasNeonDevelopmentDatabase:te}):null,!tA&&tD?(0,y.jsx)(aJ,{isOpen:N,onToggle:function(){return M(!N)},ports:_,openNetworkingPane:function(){u({type:S.ViewActionType.OpenPane,payload:{type:"developer",data:{tab:["networking"]}}})},openSecretsPane:function(){u({type:S.ViewActionType.OpenPane,payload:{type:"envEditor"}})},replId:a,provider:eP,setProvider:e1,onError:s,initialSecretsSyncExpanded:!1,machineConfig:eD,setMachineConfig:e2,onEditAutoscaleConfig:function(){return I(!0)},appType:et,onAppTypeChanged:tt,onViewAction:u,recommendedProvider:d,runCommandError:el,publicDirError:e_,crontabError:ec,timezoneError:eu,setTimeoutValueError:eY,buildCommand:eo,setBuildCommand:eL,runCommand:es,setRunCommand:eB,publicDir:ek,setPublicDir:eH,envVars:ed,setEnvVars:ez,ignoredSecrets:eT,setIgnoredSecrets:eZ,addAnEnvVar:tr,updateEnvVarName:ti,updateEnvVarValue:to,removeEnvVar:ta,optOut:tl,optIn:tu,syncToWorkspace:tc,optionsLoading:X,queryLoading:Y,baseDisableState:tW,envVarKeys:tJ,editReplSecretsAuthorization:ee,editDeploySecretAuthorization:Z,timezone:ef,setTimezone:eF,crontab:ep,setCrontab:eG,timeoutValue:eh,setTimeoutValue:eq,timeoutUnits:eg,setTimeoutUnits:eK,devSecrets:em,orgId:ew},eP):null,tA?null:(0,y.jsxs)(q.Surface,{elevated:!0,px:8,py:4,className:sw.default.roundedSurface,children:[(0,y.jsxs)(Q.View,{row:!0,justify:"space-between",align:"center",py:8,className:sw.default.clickable,onClick:function(){return tM(!tN)},children:[(0,y.jsxs)(Q.View,{row:!0,gap:8,align:"center",children:[(0,y.jsx)(sv.default,{}),(0,y.jsx)(K.Text,{children:"What does publishing do?"})]}),(0,y.jsx)(z.IconButton,{alt:tN?"Hide info":"Show info",onClick:function(){return tM(!tN)},children:tN?(0,y.jsx)(tf.default,{}):(0,y.jsx)(sx.default,{})})]}),tN?(0,y.jsxs)(Q.View,{gap:16,p:16,children:[(0,y.jsxs)(Q.View,{row:!0,gap:12,children:[(0,y.jsx)(Q.View,{pt:2,children:(0,y.jsx)(nZ.default,{})}),(0,y.jsxs)(Q.View,{style:{flex:1,minWidth:0},children:[(0,y.jsx)(K.Text,{multiline:!0,children:"Publishing your app makes it available for anyone to use"}),(0,y.jsx)(K.Text,{color:"dimmer",variant:"small",multiline:!0,children:"Your friends and users around the world can visit your app through your primary URL."})]})]}),(0,y.jsxs)(Q.View,{row:!0,gap:12,children:[(0,y.jsx)(Q.View,{pt:2,children:(0,y.jsx)(sy.default,{})}),(0,y.jsxs)(Q.View,{style:{flex:1,minWidth:0},children:[(0,y.jsxs)(K.Text,{multiline:!0,children:["Costs are included in ",ak.corePlanName," subscriptions"]}),(0,y.jsx)(K.Text,{color:"dimmer",variant:"small",multiline:!0,children:"Costs vary depending on the type of technology used to publish your app."})]})]}),(0,y.jsxs)(Q.View,{gap:8,row:!0,justify:"end",children:[(0,y.jsx)(sh.ButtonLink,{iconLeft:(0,y.jsx)(sb.default,{}),text:"Watch video",size:"small",href:"https://www.youtube.com/watch?v=OqSbgBMoTm0",target:"_blank"}),(0,y.jsx)(sh.ButtonLink,{iconLeft:(0,y.jsx)(sm.default,{}),text:"Learn more",size:"small",href:"https://docs.replit.com/category/replit-deployments",target:"_blank"})]})]}):null]})]}),th?(0,y.jsx)(q.Surface,{elevated:!0,className:sw.default.payment,p:16,children:(0,y.jsx)(a6.NewPaymentMethodForm,{onClose:function(){return(0,D._)(function(){return(0,O._)(this,function(e){switch(e.label){case 0:return tg(!1),[4,tZ()];case 1:return e.sent(),[2]}})})()},context:"workspace_hosting_pane"})}):null,(0,y.jsx)(rb.Modal,{isOpen:eE,onRequestClose:function(){eA||e0(!1)},children:(0,y.jsxs)(Q.View,{gap:8,children:[(0,y.jsx)(K.Text,{variant:"subheadBig",children:"Copy secrets from Deployment to Development?"}),(0,y.jsx)(K.Text,{children:"Are you sure you want to copy all of your secrets from Deployment to Development? Secrets already present in Development will be overwritten and lost permanently."}),(0,y.jsxs)(Q.View,{pt:8,row:!0,gap:8,justify:"end",children:[(0,y.jsx)($.Button,{text:"Cancel",disabled:eA,onClick:function(){e0(!1)}}),(0,y.jsx)($.Button,{text:"Yes, copy secrets",colorway:"negative",disabled:eA,loading:eA,onClick:td})]})]})})]})}e.s(["SimpleIntroLoader",()=>sk],12732)},544880,410270,e=>{"use strict";var t=e.i(878420),n=e.i(64386),r=e.i(530658),i=e.i(119468),o=e.i(276385),a=e.i(389959),s=e.i(960933),l=e.i(862927),u=e.i(399344),c=e.i(914279),d=e.i(68893),f=e.i(297083),p=e.i(346715),h=e.i(817556),g=e.i(368964),m=e.i(241703),x=e.i(32995),y=e.i(379790),b=e.i(684340),w=e.i(918560);e.i(969084);var k=e.i(985845),_=e.i(104571),S=e.i(150281),C=e.i(251299),j=e.i(12732),T=e.i(207237),E=e.i(952521),R=e.i(522821),I=e.i(492267),A=e.i(509908),P=e.i(480028),D=e.i(446530),O=e.i(754873),N=e.i(613355),M=e.i(140487),L=e.i(624782),B=e.i(929872),V=e.i(625484),F=(0,D.cssRecord)({root:[{borderBottom:"1px solid ".concat(P.tokens.outlineDimmest)}],inner:[N.rcss.position.relative],tabs:[N.rcss.overflowX("auto"),N.rcss.pl(8)],tab:[O.interactive.nofill,N.rcss.borderRadius(0),N.rcss.px(12),N.rcss.position.relative,{transition:"none",height:38,marginRight:1,"::after":{content:'""',display:"block",position:"absolute",right:-2,width:1,height:16,backgroundColor:P.tokens.outlineDimmest},"&:last-child":{marginRight:0,"::after":{display:"none"}}}],dot:[N.rcss.position.absolute,N.rcss.borderRadius(16),N.rcss.width(8),N.rcss.height(8),N.rcss.backgroundColor.accentPrimaryStronger,{top:8,right:8}]}),U=function(e){var t=e.tabs,n=e.value,r=e.onClick;return(0,o.jsx)(B.Surface,{css:F.root,children:(0,o.jsx)(V.View,{css:F.inner,children:(0,o.jsx)(V.View,{css:F.tabs,row:!0,align:"center",children:t.map(function(e){return(0,o.jsxs)(V.View,{css:N.rcss.position.relative,children:[(0,o.jsx)(M.Button,{style:{borderBottom:"1px solid "+(n===e.value?P.tokens.foregroundDefault:"transparent")},css:F.tab,text:e.label,iconLeft:e.icon,iconRight:e.beta?(0,o.jsx)(L.Pill,{text:"Beta",colorway:"grey"}):void 0,onClick:function(){return r(e)}}),e.showDot?(0,o.jsx)(V.View,{css:F.dot}):null]},e.value)})})})})};e.s(["PaneTabs",()=>U],410270);var G=e.i(396776),$=e.i(782514),z=e.i(438073),H=e.i(993134),W=e.i(503536),q=e.i(987154),K=e.i(883002),Y=e.i(357399),Q=e.i(651499),X=e.i(42458),J=[g.HostingBuildProvider.Gce,g.HostingBuildProvider.CloudRun,g.HostingBuildProvider.Cron],Z=(0,D.cssRecord)({root:[{height:"100%"},N.rcss.overflow("hidden"),N.rcss.position.relative],content:[N.rcss.overflow("auto"),N.rcss.flex.growAndShrink(1),N.rcss.position.relative]}),ee=function(e){var t,n,i,s,l=e.onViewUpdate,P=e.onError,D=e.refetch,O=e.openFile,N=e.openPane,M=e.initialView,L=e.error,B=function(e){ev({type:m.ViewActionType.SendDeploymentLifecycleCommand,payload:e})},F=(0,T.default)(),ee=(0,u.useDeploymentId)(),et=(0,u.useDeploymentInProgressBuild)(),en=(0,u.useDeploymentCurrentBuild)(),er=(0,u.useFsService)(),ei=(0,c.useDeploymentMode)()===d.DeploymentMode.PreparingDatabase,eo="string"==typeof ee,ea=void 0===et&&!eo,es=(0,R.useActiveAgentSessionId)(),el=!!es,eu=(0,I.useIsAgentStackRepl)().isAgentStackRepl,ec=(0,r._)((0,a.useState)(function(){return et?m.Views.DeploymentInProgress:ea?m.Views.Intro:m.Views.Deployment}),2),ed=ec[0],ef=ec[1],ep=(0,r._)((0,a.useState)(void 0),2),eh=ep[0],eg=ep[1];(0,a.useEffect)(function(){(et||ei)&&ef(m.Views.DeploymentInProgress)},[et,ei]);var em=(0,u.useSendDeploymentLifecycleCommand)(),ev=function(e){return(0,f._)(function(){var t;return(0,h._)(this,function(n){switch(n.label){case 0:switch(l(),e.type){case m.ViewActionType.SendDeploymentLifecycleCommand:return[3,1];case m.ViewActionType.ChangeView:return[3,3];case m.ViewActionType.OpenPane:return[3,4]}return[3,7];case 1:return[4,em(e.payload)];case 2:if(n.sent(),e.payload.command===g.SendDeploymentLifecycleCommandType.Destroy)return ef(m.Views.Intro),D(),[2];return e.payload.command===g.SendDeploymentLifecycleCommandType.UpdateMachineConfiguration&&D(),ef(m.Views.Deployment),[3,8];case 3:return ef(e.payload.view),eg(e.payload.data),[3,8];case 4:if("codeEditor"!==(t=e.payload).type||".replit"!==t.data.path)return[3,6];return[4,er.stat(".replit")];case 5:if(!n.sent().exists)return P("Could not find .replit configuration file."),[2];n.label=6;case 6:return N(t),[3,8];case 7:return[3,8];case 8:return[2]}})})()},ex=(t=null==en?void 0:en.provider,i=(n=(0,E.useDismissibleElement)("deployment-analytics-dot")).isLoading,s=n.isDone,(0,a.useMemo)(function(){return[{value:m.Views.Deployment,label:"Overview",icon:(0,o.jsx)(W.default,{})}].concat((0,p._)(t&&t===g.HostingBuildProvider.Cron&&!eu?[{value:m.Views.Schedule,label:"Schedule",icon:(0,o.jsx)(H.default,{})}]:[]),(0,p._)(t!==g.HostingBuildProvider.Static?[{value:m.Views.Logs,label:"Logs",icon:(0,o.jsx)(K.default,{})}]:[]),(0,p._)(t&&t!==g.HostingBuildProvider.Cron&&!eu?[{value:m.Views.Analytics,label:"Analytics",icon:(0,o.jsx)(z.default,{}),showDot:!i&&!s}]:[]),(0,p._)(t&&J.includes(t)&&!eu?[{value:m.Views.ResourceMonitoring,label:"Resources",icon:(0,o.jsx)(Q.default,{}),beta:!1}]:[]),(0,p._)(t&&t!==g.HostingBuildProvider.Cron&&!eu?[{value:m.Views.Domains,label:"Domains",icon:(0,o.jsx)(q.default,{})}]:[]),[{value:m.Views.Settings,label:"Manage",icon:(0,o.jsx)(Y.default,{})}])},[s,i,t,eu]));return ed===m.Views.Intro?(0,o.jsxs)(V.View,{css:Z.content,children:[L?(0,o.jsx)(x.PaneSection,{children:(0,o.jsx)(G.StatusBanner,{colorway:"warning",icon:(0,o.jsx)(X.default,{}),text:L})}):null,(0,o.jsx)(j.SimpleIntroLoader,{deploymentId:null,initialView:M,onViewAction:ev,onError:P,onDeploy:function(){ev({type:m.ViewActionType.ChangeView,payload:{view:m.Views.DeploymentInProgress}}),es&&(0,A.trackAgentAnalyticsEvent)({action:"deploying_app",sessionId:es})},replId:F,hasAgentSession:el})]}):(0,o.jsxs)(V.View,{css:Z.root,children:[ex?(0,o.jsx)(U,{onClick:function(e){ev({type:m.ViewActionType.ChangeView,payload:{view:e.value}})},tabs:ex,value:ed===m.Views.DeploymentInProgress?m.Views.Deployment:ed}):null,(0,o.jsxs)(V.View,{css:Z.content,children:[L?(0,o.jsx)(x.PaneSection,{children:(0,o.jsx)(G.StatusBanner,{colorway:"warning",icon:(0,o.jsx)(X.default,{}),text:L})}):null,(0,o.jsxs)($.TrackingHierarchyProvider,{hierarchy:{view:ed},children:[ed===m.Views.Analytics?(0,o.jsx)(y.Analytics,{replId:F}):null,ed===m.Views.Logs?(0,o.jsx)(k.Logs,{replId:F,deploymentId:ee,openFile:O}):null,ed===m.Views.ResourceMonitoring?(0,o.jsx)(_.ResourceMonitoring,{replId:F}):null,ed===m.Views.Settings?(0,o.jsx)(C.Settings,{onError:P,deploymentId:ee,onLifecycleCommand:B}):null,ed===m.Views.Deployment||ed===m.Views.DeploymentInProgress?(0,o.jsx)(b.Deployment,{view:ed,refetch:D,onViewAction:ev,onError:P,openFile:O,openPane:N,onLifecycleCommand:B,hasAgentSession:el}):null,ed===m.Views.Schedule?(0,o.jsx)(S.Schedule,{replId:F,deploymentId:ee,openFile:O}):null,ed===m.Views.Domains?(0,o.jsx)(w.Domains,{deploymentId:ee,viewData:eh}):null]})]})]})},et=e.i(712516);function en(e){var t=e.initialView,n=e.flow,i=e.onViewUpdate,s=e.openFile,l=e.openPane,f=e.tabsNavRef,p=(0,u.useRefetchDeployment)(),h=(0,c.useDeploymentMode)(),g=(0,u.useDeploymentError)(),m=(0,r._)((0,a.useState)(null),2),x=m[0],y=m[1];return h===d.DeploymentMode.Loading?(0,o.jsx)(et.default,{pane:{type:"deployments"},headerText:"Publish to production",loading:!0}):(0,o.jsx)(ee,{tabsNavRef:f,initialView:t,onViewUpdate:function(){x&&y(null),i()},onError:y,refetch:p,openFile:s,openPane:l,error:x||g,flow:n})}e.i(282890);var er=e.i(66718),ei=e.i(716636),eo=e.i(548364),ea=e.i(259493),es=e.i(606867),el=s.Type.Object({skipIntro:s.Type.Optional(s.Type.Boolean()),isAgentDeployment:s.Type.Optional(s.Type.Boolean())}),eu=s.Type.Object({type:s.Type.Literal("deployments"),data:s.Type.Optional(s.Type.Object({view:s.Type.Enum(m.Views)})),flow:s.Type.Optional(el)}),ec={Content:function(e){var s=e.pane,l=s.data,u=s.flow,c=e.options.performPaneOperation,d=(0,a.useRef)(function(e){if(e&&(void 0===e?"undefined":(0,i._)(e))==="object"&&"view"in e&&e.view===m.Views.ReservedVMTierSelection)return m.Views.ReservedVMTierSelection}(l)),f=(0,a.useCallback)(function(e){return c({operation:"open",secondary:!0,pane:{type:(0,er.getPaneTypeForFile)(e),data:e}})},[c]),p=(0,r._)((0,a.useState)(null),2),h=p[0],g=p[1],x=(0,eo.useDeploymentCommands)().getDeploymentCommand;(0,ea.useSetPaneBindings)(function(){var e={type:"deployments",getTabs:h?h.getTabs:function(){return null},setTab:h?h.setTab:function(){}},r=x();return r?(0,n._)((0,t._)({},e),{commands:[{commands:[r]}]}):e},[h,x]);var y=(0,a.useCallback)(function(e){c({operation:"open",pane:e,secondary:!0})},[c]);return(0,o.jsx)(en,{tabsNavRef:g,initialView:d.current,onViewUpdate:function(){d.current&&(d.current=void 0,c({operation:"replace",pane:{type:"deployments"}}))},openFile:f,openPane:y,flow:u})},Icon:function(e){var t=e.size;return(0,o.jsx)(es.IconContext.Provider,{value:{color:P.tokens.greenStrongest,size:t},children:(0,o.jsx)(W.default,{})})},getTitle:function(){return"Publishing"},description:"Publish a live, stable, public version of your App, unaffected by the changes you make in the workspace",category:ei.PaneCategory.CloudServices,decode:function(e){return l.Value.Decode(eu,e)}};e.s(["deploymentsUI",()=>ec],544880)},643041,e=>{"use strict";var t=e.i(276385);e.i(282890);var n=e.i(716636),r=e.i(960178),i=e.i(625484),o=e.i(42458),a={Content:function(){return(0,t.jsx)(i.View,{style:{padding:32},children:(0,t.jsx)(r.Text,{variant:"text",multiline:!1,children:"Sorry, this feature is not supported."})})},Icon:function(){return(0,t.jsx)(o.default,{})},getTitle:function(){return"Unsupported"},category:n.PaneCategory.Other,decode:function(){return{type:"commands",data:{autoFocus:!1}}}};e.s(["unsupportedUI",()=>a])},387948,94366,924748,825606,e=>{"use strict";var t=e.i(346715),n=e.i(389959),r=e.i(642049),i=e.i(729122);function o(e){var o=e.handleOpenPane,a=(0,i.useWorkflowsRunState)(),s=(0,n.useRef)(new Set);(0,n.useEffect)(function(){if(a){Object.values(a).forEach(function(e){var t;if(e.step===r.WorkflowStateStep.RUNNING&&(null==(t=e.workflow.metadata)?void 0:t.outputType)!==void 0&&!s.current.has(e.runId)){var n=e.workflow.metadata.outputType;switch(s.current.add(e.runId),n){case"webview":o("webview");break;case"console":o("runnerOutput");break;case"vnc":o("vnc");break;case"automations":o("automations")}}});var e,n=new Set(Object.keys(a));e=s.current,s.current=new Set((0,t._)(e).filter(function(e){return n.has(e)}))}},[o,a])}e.s(["default",()=>o],387948);var a=e.i(530658),s=e.i(878420),l=e.i(569384),u=e.i(973245),c=e.i(951262);function d(){var e=(0,l._)(["\n  mutation ReplFsUpdated($replId: String!) {\n    updateReplTimeUpdated(id: $replId) {\n      ... on Repl {\n        id\n        timeUpdated\n      }\n    }\n  }\n"]);return d=function(){return e},e}var f={},p=(0,u.gql)(d()),h=e.i(644920);e.i(792e3);var g=e.i(8808),m=e.i(529810);function x(){var e,t,r,i,o,l,u,d=(0,a._)((e=(0,s._)({},f,void 0),c.useMutation(p,e)),1)[0],x=(0,m.default)().fs,y=(i=(0,m.default)().container,l=(o=(0,a._)((0,n.useState)(null!=(r=null==(t=i.getContext())?void 0:t.repl)?r:null),2))[0],u=o[1],(0,n.useEffect)(function(){return i.onConnectionStateChanged(function(e){var t,n;e===g.ConnectionState.CONNECTED&&u(null!=(n=null==(t=i.getContext())?void 0:t.repl)?n:null)})},[u,i]),l),b=null==y?void 0:y.authorizations.editFileContents.isAuthorized,w=null==y?void 0:y.id;(0,n.useEffect)(function(){if(b&&w){var e=(0,h.default)(function(){return d({variables:{replId:w}})},{wait:6e4,maxWait:6e5}),t=x.onStatusChange(function(){e()});return function(){e.isScheduled()&&e.flush(),t()}}},[x,w,b,d])}e.s(["default",()=>x],94366);var y=e.i(924004),b=e.i(664152);function w(e){var t,r,i,o,s,l=(t=(0,m.default)().container,i=(r=(0,a._)((0,n.useState)(null),2))[0],o=r[1],(0,n.useEffect)(function(){if(t)return t.onConnectionStateChanged(function(){o(t.getConnectionMetadata())})},[t]),s=i,(0,n.useMemo)(function(){return s?(0,y.parseToken)(s.token):null},[s]));(0,n.useEffect)(function(){if(e){var t,n,r,i=(null==(t=e.origin)?void 0:t.__typename)==="Repl"?e.origin.id:null,o={id:e.id,slug:e.slug,originId:i,rootOriginReplUrl:e.rootOriginReplUrl,rootOriginReplReleaseId:null==(r=e.source)||null==(n=r.release)?void 0:n.id,tokenCluster:null==l?void 0:l.cluster};return(0,b.updateReplContext)(o),function(){(0,b.removeReplContext)()}}},[e,l])}e.s(["default",()=>w],924748);var k=e.i(15053),_=e.i(613141);function S(){var e=(0,l._)(["\n  subscription StartOrgReplPresenceSession(\n    $input: StartOrgReplPresenceSessionInput!\n  ) {\n    startOrgReplPresenceSession(input: $input)\n  }\n"]);return S=function(){return e},e}function C(){var e=(0,l._)(["\n  mutation PingOrgReplPresenceSession(\n    $input: PingOrgReplPresenceSessionInput!\n  ) {\n    pingOrgReplPresenceSession(input: $input)\n  }\n"]);return C=function(){return e},e}var j={},T=(0,u.gql)(S()),E=(0,u.gql)(C()),R=e.i(207237),I=e.i(873379);function A(){var e,t,r,i=arguments.length>0&&void 0!==arguments[0]&&arguments[0],o=(0,R.default)(),l=(0,n.useRef)((0,k.v4)()),u=(0,m.default)().container,d=(0,I.default)(u),f=(0,a._)((e=(0,s._)({},j,void 0),c.useMutation(E,e)),1)[0],p=d!==g.ConnectionState.CONNECTED||i;(0,n.useEffect)(function(){var e=!1;if(!p&&d===g.ConnectionState.CONNECTED){var t=null;return function n(){f({variables:{input:{sessionId:l.current}},onCompleted:function(){e||(t=setTimeout(n,1e4))}})}(),function(){e=!0,t&&clearTimeout(t)}}},[d,l,f,p]),t={variables:{input:{replId:o,sessionId:l.current}},skip:p},r=(0,s._)({},j,t),_.useSubscription(T,r)}e.s(["useOrgReplPresenceSession",()=>A],825606)},391542,e=>{"use strict";var t=e.i(389959),n=e.i(170784),r=e.i(122965);function i(e){var i=e.repl,o=e.currentUser,a=e.container,s=(0,r.useFlaggedRetrier)(),l=(0,n.useMemoizedConnectContext)(i&&o?{repl:i,currentUser:o}:null);(0,t.useEffect)(function(){if(a&&l)return a.connect({context:l,getMinimumRetryDelayMs:s}),function(){a.close()}},[l,a,s])}e.s(["default",()=>i])},984826,563209,708648,596378,143480,905890,681850,349467,402434,326333,8812,239296,829960,387524,646325,416406,440560,752310,741740,927938,551544,136780,604026,e=>{"use strict";var t=e.i(399528),n=e.i(389959),r=e.i(15053),i=e.i(529810),o=e.i(302861);function a(){var e=(0,t.useRouter)(),a=(0,i.default)().container,s=(0,o.useIsLogging)(),l=(0,o.useSetIsLogging)(),u=(0,o.useAddLog)();(0,n.useEffect)(function(){e.query.debug&&"undefined"!==e.query.debug&&l(!0)},[l,e.query.debug]),(0,n.useEffect)(function(){if(s)return a.client().onDebugLog(function(e){if("log"===e.type){var t={name:e.log.channel.name,service:null};if("string"==typeof e.log.channel.service)t.service=e.log.channel.service;else if(e.log.channel.service){var n=a.getContext();n&&(t.service=e.log.channel.service(n))}u({id:(0,r.v4)(),channel:t,dir:e.log.direction,cmd:e.log.cmd,stringifiedCmd:JSON.stringify(e.log.cmd),timestamp:window.performance.now()})}})},[s,a,u])}e.s(["default",()=>a],984826);var s=e.i(530658),l=e.i(368964),u=e.i(188507),c=e.i(986194),d=e.i(877212),f=e.i(165680),p=e.i(924908);e.i(925218);var h=e.i(267103),g=e.i(641555),m=e.i(993796),x=e.i(98816),y=e.i(215969),b=e.i(782672),w=e.i(45442),k=e.i(913811),_=e.i(533742),S=e.i(417120),C=e.i(297083),j=e.i(878420),T=e.i(64386),E=e.i(817556),R=e.i(112942),I=e.i(559491),A=e.i(230776),P=e.i(509908),D={direction:"reverse",state:{latestUserResponseEventId:void 0},reducer:function(e,t){if(e.sender.type===u.UserType.AI){var n=e.contents.contents;if((0,c.isKind)(n,"agentTimelineEventContents")){var r=n.agentTimelineEventContents,i=r.toolData;if("user_response"===r.toolName&&(null==i?void 0:i.$kind)==="messageData")return t.latestUserResponseEventId=e.id,!1}}}};function O(){var e,t,r,o,a,c=(0,p.useChatter)(),d=(0,h.useObservable)(c.sessions.agent.current),O=(0,h.useObservable)(null==d?void 0:d.agent.state),N=(0,f.useAgentPausedByUser)(),M=(0,w.useAgentSettings)().settings,L=(null==M?void 0:M.chatMode)===l.AgentChatMode.Discussion,B=(0,b.default)(),V=(0,g.useObservableMemo)(function(){return null==d?void 0:d.reduce(D,100)},[d],{default:{latestUserResponseEventId:void 0}}),F=(0,y.useIsUserMessageMostRecentEvent)({sessionId:null==d?void 0:d.id}),U=(0,_.useSendMessage)(null!=d?d:null).sendMessage,G=(0,g.useObservableMemo)(function(){return c.queue.state.select(function(e){return e[0]})},[c]),$=(0,x.default)(G),z=(0,n.useRef)(void 0),H=(0,k.useIsEditingQueueItem)(),W=(null==O?void 0:O.state)===u.AgentRunState.AGENT_STATE_PAUSED||(null==O?void 0:O.state)===u.AgentRunState.AGENT_STATE_NOT_STARTED||(null==O?void 0:O.state)===u.AgentRunState.AGENT_STATE_UNKNOWN,q=(e=(0,p.useChatter)(),r=null==(t=(0,h.useObservable)(e.sessions.agent.current))?void 0:t.id,o=(0,i.default)().fs,a=(0,m.useFlag)({controlName:"flag-queue-royal-flush",default:!1}),(0,n.useCallback)(function(t){return(0,C._)(function(){var n,i,s;return(0,E._)(this,function(l){switch(l.label){case 0:if(!r)return[2];if((0,P.trackAgentQueueAnalyticsEvent)({action:"queue_message_sent_automatically",messageText:t.contents.content,sessionId:r}),!a)return[3,2];return[4,e.queue.flush({ids:[t.id],session:r})];case 1:case 4:return l.sent(),[2];case 2:return[4,(0,A.unpackContentsFromQueuedMessage)({contents:t.contents,readFile:o.readFile})];case 3:return i=(n=l.sent()).agentConfig?(0,R.convertAgentSettingsFromGQLToAiChat)(n.agentConfig):void 0,s=(0,I.normalizeTargetedElement)(n.webviewTargetedElement),U((0,T._)((0,j._)({},n),{agentConfig:i,webviewTargetedElement:s})),[4,e.queue.flush({ids:[t.id]})]}})})()},[r,o.readFile,U,e,a])),K=(0,S.useIsAgentWorking)(),Y=(0,s._)((0,n.useState)(!1),2),Q=Y[0],X=Y[1],J=(0,m.useFlag)({controlName:"flag-server-side-queue-autoplay",default:!1});(0,n.useEffect)(function(){K&&X(!0)},[K]),(0,n.useEffect)(function(){(null==B?void 0:B.status)!=="ok"||L||!Q||!W||N||H||!V||void 0===V.latestUserResponseEventId||V.latestUserResponseEventId===z.current||F||J||!$.current||q($.current)},[W,N,H,V,F,Q,q,$,B,L,J])}e.s(["useQueueAutoPlay",()=>O],563209);var N=e.i(374106),M=e.i(968783),L=e.i(664152);function B(e){return!!e&&e===u.StackBlueprint.STACK_BLUEPRINT_FULLSTACK_JS}var V=e.i(248011);function F(){var e,t,r,i=(e=(0,n.useRef)(new Map),t=(0,n.useRef)(new Map),r=(0,n.useRef)(null),{addMessage:function(n,i){if(e.current.set(i,n),L.logger.info("user message received",{eventId:i,sessionId:n.sessionId,sender:n.sender,created:n.created,agentRunning:(null==(o=r.current)?void 0:o.state)===u.AgentRunState.AGENT_STATE_RUNNING}),r.current&&(null==(a=r.current.reason)?void 0:a.$kind)!=="waitingOnPlanApproval"){var o,a,s=setTimeout(function(){var o;e.current.delete(i),L.logger.info("user message ghosted",{eventId:i,sessionId:n.sessionId,sender:n.sender,created:n.created,duration:Date.now()-n.created.getTime(),agentRunning:(null==(o=r.current)?void 0:o.state)===u.AgentRunState.AGENT_STATE_RUNNING}),t.current.delete(i)},r.current.state===u.AgentRunState.AGENT_STATE_PAUSED?3e4:6e4);t.current.set(i,s)}},acknowledgeMessage:function(n){var r=n.eventId,i=n.acknowledged,o=e.current.get(r);if(o){var a=i.getTime()-o.created.getTime();L.logger.info("user message acknowledged",{eventId:r,timeToAcknowledge:a,sessionId:o.sessionId,sender:o.sender,created:o.created,acknowledged:i});var s=t.current.get(r);s&&(clearTimeout(s),t.current.delete(r)),e.current.delete(r)}},agentStateChanged:function(e){if((null==(i=r.current)||null==(n=i.reason)?void 0:n.$kind)!=="waitingOnPlanApproval"||e.state!==u.AgentRunState.AGENT_STATE_RUNNING){var n,i,o,a=null==(o=e.reason)?void 0:o.$kind;if("userPaused"===a||"waitingOnPlanApproval"===a){(function(){var e=!0,n=!1,r=void 0;try{for(var i,o=t.current.entries()[Symbol.iterator]();!(e=(i=o.next()).done);e=!0){var a=(0,s._)(i.value,2),l=a[0],u=a[1];clearTimeout(u),t.current.delete(l)}}catch(e){n=!0,r=e}finally{try{e||null==o.return||o.return()}finally{if(n)throw r}}})(),r.current=e;return}r.current=e}}}),o=i.addMessage,a=i.acknowledgeMessage,l=i.agentStateChanged,d=(0,M.useIsCurrentOrgEnterprise)();(0,p.useChatHook)("agent-state-changed",function(e){l(e.state);var t,n=null==(t=e.state.reason)?void 0:t.$kind;if(n){var r=new Map([["userPaused","user_paused"],["waitingOnPlanApproval","waiting_on_plan_approval"],["waitingOnUserResponse","waiting_on_user_input"],["rateLimited","quota_reached"],["error","agent_error_encountered"],["stepLimitExceeded","step_limit_exceeded"]]).get(n);r&&(0,P.trackAgentAnalyticsEvent)({action:r,sessionId:e.sessionId,isEnterprise:d})}});var f=(0,V.useIsFreemiumStarterPlanUsersOwnRepl)().isFreemiumStarterPlanUsersOwnRepl?"starter":void 0;(0,p.useChatHook)("received-event",function(e){var t=e.event,n=t.sessionId;if((0,N.isEventContentsKind)(t,"agentPlanEventContents")&&t.state===u.EventState.IN_PROGRESS){var r=t.contents.contents,i=(0,c.unkind)(r);t.sender.type===u.UserType.AI&&i.requiresApproval&&(0,P.trackAgentPlanningAnalyticsEvent)({action:"plan_proposal_started",sessionId:n,planId:i.planId,planSupportsVisualPreview:B(i.stackBlueprint),stackBlueprint:i.stackBlueprint,isEnterprise:d})}}),(0,p.useChatHook)("received-completed-event",function(e){var t=e.event,n=t.sessionId;if((0,N.isEventContentsKind)(t,"messageEventContents")&&o({sender:t.sender.id,sessionId:n,created:t.created},t.id),(0,N.isEventContentsKind)(t,"agentPlanEventContents")){var r=t.contents.contents,i=(0,c.unkind)(r);t.sender.type===u.UserType.AI&&i.requiresApproval&&(0,P.trackAgentPlanningAnalyticsEvent)({action:"plan_proposal_completed",sessionId:n,planId:i.planId,planSupportsVisualPreview:B(i.stackBlueprint),stackBlueprint:i.stackBlueprint,isEnterprise:d})}if((0,N.isEventContentsKind)(t,"rapidBuildStarted")?(0,P.trackAgentAnalyticsEvent)({action:"rapid_build_started",sessionId:n,isEnterprise:d}):(0,N.isEventContentsKind)(t,"rapidBuildConcluded")&&(0,P.trackAgentAnalyticsEvent)({action:"rapid_build_concluded",sessionId:n,isEnterprise:d}),(0,N.isEventContentsKind)(t,"agentTimelineEventContents")){var s=(0,c.unkind)(t.contents.contents),l=s.toolData;switch(s.toolName){case"mark_current_step_as_succeeded":return(0,P.trackAgentAnalyticsEvent)({action:"step_completed",sessionId:n,replOwnerPlanName:f,isEnterprise:d});case"mark_current_step_as_failed":return(0,P.trackAgentAnalyticsEvent)({action:"step_failed",sessionId:n,replOwnerPlanName:f,isEnterprise:d})}if(l)switch(l.$kind){case"commitData":return(0,P.trackAgentAnalyticsEvent)({action:"checkpoint_created",sessionId:n,freeCheckpoint:l.commitData.billingRate===u.CommitBillingRate.ZERO_RATED,replOwnerPlanName:f,hasUbbV2:!0,checkpointPrice:l.commitData.usageCents,isEnterprise:d});case"agentPlanStepBegin":var p=l.agentPlanStepBegin.planStep,h=p.id,g=p.name,m=p.blueprints;return(0,P.trackAgentPlanningAnalyticsEvent)({action:"plan_step_started",stepId:h,stepName:g,stepBlueprints:m,sessionId:n,isEnterprise:d});case"blueprintsSetup":var x=l.blueprintsSetup.blueprintData;return(0,P.trackAgentAnalyticsEvent)({action:"blueprints_setup",blueprints:x.map(function(e){return e.name}),sessionId:n,replOwnerPlanName:f,isEnterprise:d});case"searchIntegrationsData":var y=l.searchIntegrationsData,b=y.query,w=y.numResults;return(0,P.trackAgentAnalyticsEvent)({action:"integration_searched",sessionId:n,integrationSearchQuery:b,integrationSearchNumResults:w,replOwnerPlanName:f,isEnterprise:d});case"acknowledgeUserMessage":var k=l.acknowledgeUserMessage.eventIds,_=!0,S=!1,C=void 0;try{for(var j,T=k[Symbol.iterator]();!(_=(j=T.next()).done);_=!0){var E=j.value;a({eventId:E,acknowledged:new Date})}}catch(e){S=!0,C=e}finally{try{_||null==T.return||T.return()}finally{if(S)throw C}}}}})}e.s(["useAgentTracking",()=>F],708648);var U=e.i(530448),G=e.i(162914),$=e.i(441329),z=e.i(927158),H=e.i(432902),W=e.i(982829),q=e.i(729122);function K(){var e=(0,d.useSupportsAgent)(),t=(0,S.useIsAgentWorking)(),r=(0,q.useRunInfo)(),i=r.isRunning,o=r.isWorkflowsLoading,a=(0,q.useRunButton)(),l=(0,$.useIsInMobileWorkspace)(),u=(0,q.useWorkflows)(),c=(0,q.useTriggerLocalRun)(),f=(0,s._)((0,n.useState)(!1),2),p=f[0],h=f[1],g=(0,G.default)(p,200),m=(0,s._)((0,n.useState)(!0),2),x=m[0],y=m[1],b=(0,n.useMemo)(function(){return u.length>0&&!o},[o,u.length]),w=(0,n.useMemo)(function(){var e=u.find(function(e){return e.name===a});if(!e)return!1;var t="agent"===e.author,n=(0,q.workflowOpensPort)(e,u);return t&&n},[a,u]),k=(0,z.usePid2Callback)(function(e){return function(t){return l||c(W.RunReason.AUTO_RUN),e.workflows.agentStartRunWorkflow.rpc({name:t})}},[c,l]);(0,n.useEffect)(function(){if(e&&g&&x&&b&&k&&a){if(i||!w||t)return void y(!1);y(!1),k(a)}},[o,k,e,i,w,x,b,g,a,t]);var _=(0,n.useCallback)(function(e){h(e===U.ConnectionState.CONNECTED),e===U.ConnectionState.CONNECTED&&y(!0)},[]);(0,H.default)(_)}e.s(["default",()=>K],596378);var Y=e.i(759967);function Q(e){var t=e.isAgentReplInConfig,r=e.isExpertModeInConfig,i=(0,Y.useIsExpertMode)(),o=(0,x.default)(i),a=(0,Y.useSetIsExpertMode)(),l=(0,s._)((0,n.useState)(!1),2),u=l[0],c=l[1],d=(0,m.useFlag)({controlName:"flag-agent-everywhere"});(0,n.useEffect)(function(){if(d&&u){if((r||!t)&&void 0===o.current)return void a(!0);if(t&&void 0===o.current)return void a(!1)}},[o,a,d,t,r,u]);var f=(0,z.usePid2Callback)(function(e){return function(){return e.agentReplConfig.getReplConfig.rpc({})}},[]),p=(0,z.usePid2Callback)(function(e){return function(t){return(0,C._)(function(){return(0,E._)(this,function(n){return[2,e.agentReplConfig.updateReplConfig.rpc({expertMode:t})]})})()}},[]);(0,n.useEffect)(function(){d&&void 0===o.current&&f&&(u||(0,C._)(function(){var e;return(0,E._)(this,function(t){switch(t.label){case 0:return[4,f()];case 1:if(!1===(e=t.sent()).ok&&"NOT_FOUND"===e.payload.code)return c(!0),[2];if(!1===e.ok)return[2];return c(!0),void 0!==e.payload.expertMode&&a(e.payload.expertMode),[2]}})})())},[f,d,a,o,u]),(0,n.useEffect)(function(){(0,C._)(function(){return(0,E._)(this,function(e){switch(e.label){case 0:if(!d||!p||void 0===i||!u||t&&!1===i)return[2];return[4,p(i)];case 1:return e.sent(),[2]}})})()},[d,u,t,i,p])}e.s(["useAutoSetExpertMode",()=>Q],143480);var X=e.i(906368);function J(){(0,p.useChatHook)("agent-state-changed",function(e){var t,n,r,i;X.addBreadcrumb({category:"chatter",message:"Agent state changed to ".concat((r=function(e){switch(e){case u.AgentRunState.AGENT_STATE_NOT_STARTED:return"Not started";case u.AgentRunState.AGENT_STATE_PAUSED:return"Paused";case u.AgentRunState.AGENT_STATE_PAUSING:return"Pausing";case u.AgentRunState.AGENT_STATE_RUNNING:return"Running";case u.AgentRunState.AGENT_STATE_UNKNOWN:default:return"Unknown"}}((t=e.state).state),i=null==(n=t.reason)?void 0:n.$kind,"".concat(r," (reason: ").concat(i,")"))),level:"info"})}),(0,p.useChatHook)("client-created-session",function(e){X.addBreadcrumb({category:"chatter",message:"Client created ".concat(function(e){switch(e){case u.SessionType.CHAT:return"Assistant";case u.SessionType.INLINE_CHAT:return"Assistant (inline)";case u.SessionType.AGENT_SESSION:return"Agent";default:return"Unknown"}}(e.request.sessionType)," session ").concat(e.session.id),data:e.request,level:"info"})}),(0,p.useChatHook)("client-updated-session",function(e){X.addBreadcrumb({category:"chatter",message:"Client updated session ".concat(e.session.id),data:e.request,level:"info"})}),(0,p.useChatHook)("session-graph-fetched",function(e){X.addBreadcrumb({category:"chatter",message:"Session graph fetched for session ".concat(e.session.id," (size: ").concat(e.size,")"),level:"info"})}),(0,p.useChatHook)("unexpected-disconnect",function(e){X.addBreadcrumb({category:"chatter",message:"Unexpected disconnect: ".concat(e.error.message),level:"error"})}),(0,p.useChatHook)("unhandled-exception",function(e){X.addBreadcrumb({category:"chatter",message:"Unhandled exception: ".concat(e.error.message),data:e.error,level:"error"})})}e.s(["useChatterSentryBreadcrumbs",()=>J],905890);var Z=e.i(612651),ee=e.i(909478),et=e.i(134405),en=e.i(345863);function er(){var e=(0,et.useVisualPreviewStateInputs)(),t=(0,et.useVisualPreviewState)(),n=(0,et.useAgentAwareWebviewStateInputs)(),r=(0,et.useAgentAwareWebviewState)(),o=(0,q.useRunInfo)(),a=(0,i.default)().ports,s=(0,ee.useOpenedAndForwardedPorts)(a).map(function(e){return(0,Z.default)(e,["processInfo"])});(0,en.usePreviewStateTracker)({agentAwareWebviewState:r,agentAwareWebviewStateInputs:n,visualPreviewState:t,visualPreviewStateInputs:e,runInfo:o,openedAndForwardedPorts:s})}e.s(["useDebugPreviewStateTracking",()=>er],681850);var ei=e.i(316699),eo=e.i(169252),ea=e.i(569384),es=e.i(973245),el=e.i(951262);function eu(){var e=(0,ea._)(["\n  mutation EndLiveActivity($input: EndLiveActivityInput!) {\n    endLiveActivity(input: $input) {\n      ... on EndLiveActivityResult {\n        activitiesEnded\n      }\n      ... on LiveActivitiesNotSupported {\n        message\n      }\n    }\n  }\n"]);return eu=function(){return e},e}var ec={},ed=(0,es.gql)(eu()),ef=e.i(207237);function ep(){var e,t=(0,ef.default)(),r=(0,s._)((e=(0,j._)({},ec,void 0),el.useMutation(ed,e)),1)[0],i=(0,n.useRef)(!1),o=(0,n.useCallback)(function(){return(0,C._)(function(){var e;return(0,E._)(this,function(n){switch(n.label){case 0:if(i.current||"visible"!==document.visibilityState)return[2];return[4,r({variables:{input:{replId:t,step:eo.AgentLiveActivityStep.AppReady}}})];case 1:return i.current=(null==(e=n.sent().data)?void 0:e.endLiveActivity.__typename)==="LiveActivitiesNotSupported",[2]}})})()},[r,t]);(0,n.useEffect)(function(){var e=(0,ei.default)(o,6e4,{trailing:!0});return e(),document.addEventListener("visibilitychange",e),function(){document.removeEventListener("visibilitychange",e),e.cancel()}},[o,t])}e.s(["default",()=>ep],349467),e.i(792e3);var eh=e.i(8808);function eg(){var e=(0,i.default)().container;(0,n.useEffect)(function(){var t=function(){e.getConnectionState()===eh.ConnectionState.CONNECTED&&e.focus()};return window.addEventListener("focus",t),function(){window.removeEventListener("focus",t)}},[e])}e.s(["default",()=>eg],402434);var em=e.i(613141);function ev(){var e=(0,ea._)(["\n  subscription RegisterReplConnection($replId: String!) {\n    replConnection(replId: $replId)\n  }\n"]);return ev=function(){return e},e}var ex={},ey=(0,es.gql)(ev()),eb=e.i(873379);function ew(){var e,t,n=(0,ef.default)(),r=(0,i.default)().container;e={variables:{replId:n},skip:(0,eb.default)(r)!==eh.ConnectionState.CONNECTED},t=(0,j._)({},ex,e),em.useSubscription(ey,t)}e.s(["useLiveViewReplConnection",()=>ew],326333);var ek=e.i(276385),e_=e.i(222342),eS=e.i(389320),eC=e.i(967629),ej=e.i(613355),eT=e.i(140487),eE=e.i(216373),eR=(0,eC.css)([ej.rcss.mt(8)]);function eI(e){var t=e.onOpenEnvEditor,r=(0,eS.default)(),i=(0,e_.default)(),o=(0,n.useRef)(!1);(0,n.useEffect)(function(){if(r&&!o.current){var e=i.showNotice((0,ek.jsxs)(ek.Fragment,{children:[(0,ek.jsx)("div",{children:"This App contains secrets that are missing values."}),(0,ek.jsx)("div",{children:"Add values to ensure the App runs as expected."}),(0,ek.jsx)("div",{children:(0,ek.jsx)(eT.Button,{size:"small",iconLeft:(0,ek.jsx)(eE.default,{}),css:eR,colorway:"primary",onClick:function(){t(),i.hideMessage(e)},text:"Manage secrets"})})]}),1e4);o.current=!0}},[r])}e.s(["useMissingSecretToast",()=>eI],8812),e.i(242933);var eA=e.i(279606),eP=e.i(802088),eD=e.i(424746);function eO(){var e=(0,eD.useRefetchDatabasesLazy)("development").refetch,t=(0,p.useChatter)(),r=(0,h.useObservable)(t.sessions.agent.current),i=(0,n.useMemo)(function(){return null==r?void 0:r.reduce(eN,1)},[r]),o=null==r?void 0:r.agent.state,a=(0,n.useMemo)(function(){return o&&i?eA.Observable.combine(o,i):null},[o,i]),l=(0,n.useCallback)(function(t){var n=(0,s._)(t,2),r=n[0];n[1].createdDatabase&&(null==r?void 0:r.state)===u.AgentRunState.AGENT_STATE_RUNNING&&e()},[e]);(0,eP.useObserver)(a,{next:l})}var eN={direction:"reverse",state:{createdDatabase:!1},reducer:function(e,t){if(e.sender.type!==u.UserType.AI)return!1;var n=e.contents.contents;if((null==n?void 0:n.$kind)!=="agentTimelineEventContents")return!1;var r=n.agentTimelineEventContents.toolData;return(null==r?void 0:r.$kind)==="createPostgresqlDatabaseData"&&(t.lastCreationEventId!==e.id&&(t.createdDatabase=!0,t.lastCreationEventId=e.id),!1)}};e.s(["default",()=>eO],239296),e.i(33699);var eM=e.i(400081);function eL(){var e=(0,eM.usePid2InternalsContextDoNotUseOrYouWillBeFired)();(0,n.useEffect)(function(){},[e])}e.s(["default",()=>eL],829960);var eB=e.i(394212),eV=e.i(167626),eF=e.i(299798),eU=e.i(752394);function eG(){(0,eV._)(document.activeElement,HTMLElement)&&document.activeElement.blur()}function e$(e){var t=e.fs,r=e.openMultipleFiles,i=e.openMultipleURLs,o=e.waitForFileClose,a=e.isMobileWorkspace,s=void 0!==a&&a,l=(0,x.default)(o),u=(0,n.useCallback)(function(e){var n=e.filename,i=e.waitForClose;return(0,C._)(function(){var e;return(0,E._)(this,function(o){switch(o.label){case 0:if(!s)return[3,2];if(!n.endsWith(".git/COMMIT_EDITMSG"))return r({paths:[n]}),[2];return e=window.prompt("Enter a commit message"),[4,t.writeFile(n,null!=e?e:"")];case 1:case 4:return o.sent(),[2];case 2:if(eG(),r({paths:[n]}),!i||!l.current)return[2];return[4,l.current(n)];case 3:return o.sent(),[4,t.flush()]}})})()},[t,s,r,l]);(0,eF.usePid2)(function(e,t){var n=t.session,o=t.signal;return(0,C._)(function(){var t,a,s,l,c,d,f,p,h,g,m,x,y,b;return(0,E._)(this,function(w){switch(w.label){case 0:a=(t=e.replspaceApi.init.stream({session:n.from},{signal:o})).reqWritable,s=t.resReadable,l=!1,c=!1,w.label=1;case 1:w.trys.push([1,12,13,18]),f=(0,eB._)(s),w.label=2;case 2:return[4,f.next()];case 3:if(!(l=!(p=w.sent()).done))return[3,11];if(!(h=p.value).ok)return[3,10];switch(h.payload.$kind){case"openFile":return[3,4];case"openMultipleFiles":return[3,6];case"openMultipleURLs":return[3,7];case"getSSHToken":return[3,8]}return[3,10];case 4:return[4,u(h.payload)];case 5:return w.sent(),h.payload.waitForClose&&a.write({$kind:"closeFile",filename:h.payload.filename,nonce:h.payload.nonce}),[3,10];case 6:return h.payload.files.length>0&&(eG(),r({paths:h.payload.files})),[3,10];case 7:return h.payload.urls.length>0&&(eG(),i({urls:h.payload.urls})),[3,10];case 8:return m=(g=h.payload).nonce,x=g.replId,[4,(0,eU.fetchReplSshToken)({replId:x})];case 9:return"success"!==(y=w.sent()).type?a.write({$kind:"sshToken",nonce:m,error:y.message}):a.write({$kind:"sshToken",nonce:m,token:y.data.token,SSHHostname:y.data.ssh_hostname}),[3,10];case 10:return l=!1,[3,2];case 11:return[3,18];case 12:return b=w.sent(),c=!0,d=b,[3,18];case 13:if(w.trys.push([13,,16,17]),!(l&&null!=f.return))return[3,15];return[4,f.return()];case 14:w.sent(),w.label=15;case 15:return[3,17];case 16:if(c)throw d;return[7];case 17:return[7];case 18:return[2]}})})()},[i,r,u])}e.s(["default",()=>e$],387524);var ez=e.i(346715),eH=e.i(642049),eW=e.i(644920),eq=e.i(887616),eK=e.i(615166);function eY(){var e=(0,eq.default)(),t=(0,i.default)().ports,o=(0,n.useRef)(new Map),a=(0,n.useRef)(new Set),l=(0,n.useRef)(new Map),u=(0,n.useRef)(null),c=(0,z.usePid2Callback)(function(e){return function(){return(0,C._)(function(){var t,n,r,i,a,l,u,c,d,f;return(0,E._)(this,function(p){switch(p.label){case 0:t=!0,n=!1,r=void 0,p.label=1;case 1:p.trys.push([1,6,7,8]),i=o.current.entries()[Symbol.iterator](),p.label=2;case 2:if(t=(a=i.next()).done)return[3,5];if(u=(l=(0,s._)(a.value,2))[0],0===(c=l[1]).length)return[3,4];return d=(0,ez._)(c),o.current.set(u,[]),[4,e.agentToolWebviewLogs.store.rpc({logs:d,paneId:"expo-".concat(u)})];case 3:p.sent(),p.label=4;case 4:return t=!0,[3,2];case 5:return[3,8];case 6:return f=p.sent(),n=!0,r=f,[3,8];case 7:try{t||null==i.return||i.return()}finally{if(n)throw r}return[7];case 8:return[2]}})})()}},[]);(0,n.useEffect)(function(){if(e){if(!c){u.current=null;return}u.current=(0,eW.default)(c,{wait:100})}},[e,c]);var d=(0,n.useCallback)(function(e,t){o.current.has(e)||o.current.set(e,[]);var n,r=o.current.get(e);r&&r.push({message:t,method:"console.log"}),null==(n=u.current)||n.call(u)},[]);(0,n.useEffect)(function(){if(e)return t.portsState.subscribe(function(e){if(e){var t=e.filter(eK.isProbablyExpoPort);(function(e,t,n){var r=!0,i=!1,o=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done);r=!0){var l=a.value.configuration.localPort;t.has(l)||(t.add(l),n(l,"[Expo detected on port ".concat(l,"] Starting to capture logs...")))}}catch(e){i=!0,o=e}finally{try{r||null==s.return||s.return()}finally{if(i)throw o}}})(t,a.current,d),function(e,t,n){var r=new Set(e.map(function(e){return e.configuration.localPort})),i=!0,o=!1,a=void 0;try{for(var s,l=t[Symbol.iterator]();!(i=(s=l.next()).done);i=!0){var u=s.value;r.has(u)||(t.delete(u),n.delete(u))}}catch(e){o=!0,a=e}finally{try{i||null==l.return||l.return()}finally{if(o)throw a}}}(t,a.current,o.current)}})},[e,t.portsState,d]);var f=(0,n.useCallback)(function(e,t){return(0,C._)(function(){var n,i,o,a,s,u,c,f,p,h,g,m,x,y;return(0,E._)(this,function(b){switch(b.label){case 0:n=new AbortController,l.current.set(e.taskKey,{abort:n,portNumbers:e.portNumbers}),b.label=1;case 1:b.trys.push([1,14,15,16]),i=t.workflows.connectToTask.stream({runId:e.runId,taskIdx:e.taskIdx,userId:0,processViewId:(0,r.v4)()},{signal:n.signal}).resReadable,o=new TextDecoder,a="",s=!1,u=!1,b.label=2;case 2:b.trys.push([2,7,8,13]),f=(0,eB._)(i),b.label=3;case 3:return[4,f.next()];case 4:if(!(s=!(p=b.sent()).done)||(g=!(h=p.value).ok&&("UNEXPECTED_DISCONNECT"===h.payload.code||"CANCEL"===h.payload.code),m=!h.ok&&"NO_MATCHING_TASK_STATE"===h.payload.code,g||m))return[3,6];if(!h.ok)throw Error("[".concat(h.payload.code,"] ").concat(h.payload.message));if("output"!==h.payload.$kind)return[3,5];a=function(e,t,n,r,i){var o=(t+=n.decode(e,{stream:!0})).split("\n"),a=o.pop()||"",s=!0,l=!1,u=void 0;try{for(var c,d=o[Symbol.iterator]();!(s=(c=d.next()).done);s=!0){var f=c.value;if(f.trim()){var p=!0,h=!1,g=void 0;try{for(var m,x=r[Symbol.iterator]();!(p=(m=x.next()).done);p=!0){var y=m.value;i(y,f)}}catch(e){h=!0,g=e}finally{try{p||null==x.return||x.return()}finally{if(h)throw g}}}}}catch(e){l=!0,u=e}finally{try{s||null==d.return||d.return()}finally{if(l)throw u}}return a}(h.payload.chunk,a,o,e.portNumbers,d),b.label=5;case 5:return s=!1,[3,3];case 6:return[3,13];case 7:return x=b.sent(),u=!0,c=x,[3,13];case 8:if(b.trys.push([8,,11,12]),!(s&&null!=f.return))return[3,10];return[4,f.return()];case 9:b.sent(),b.label=10;case 10:return[3,12];case 11:if(u)throw c;return[7];case 12:return[7];case 13:return function(e,t,n){if(e.trim()){var r=!0,i=!1,o=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done);r=!0){var l=a.value;n(l,e)}}catch(e){i=!0,o=e}finally{try{r||null==s.return||s.return()}finally{if(i)throw o}}}}(a+=o.decode(),e.portNumbers,d),[3,16];case 14:if(y=b.sent(),(0,eV._)(y,Error)&&"AbortError"===y.name)return[2];throw y;case 15:return l.current.delete(e.taskKey),[7];case 16:return[2]}})})()},[d]);(0,eF.usePid2)(function(t,n){var r=n.signal;return(0,C._)(function(){var n,i,o,u,c,d,p,h,g;return(0,E._)(this,function(m){switch(m.label){case 0:if(!e)return[2];n=t.workflows.runState.subscribe({},{signal:r}).resReadable,r.addEventListener("abort",function(){var e=!0,t=!1,n=void 0;try{for(var r,i=l.current.values()[Symbol.iterator]();!(e=(r=i.next()).done);e=!0)r.value.abort.abort()}catch(e){t=!0,n=e}finally{try{e||null==i.return||i.return()}finally{if(t)throw n}}l.current.clear()}),i=!1,o=!1,m.label=1;case 1:m.trys.push([1,6,7,12]),c=(0,eB._)(n),m.label=2;case 2:return[4,c.next()];case 3:if(!(i=!(d=m.sent()).done))return[3,5];if(!(p=d.value).ok)return[3,4];h=p.payload.state,function(e,t,n,r,i){var o=!0,a=!1,s=void 0;try{for(var l,u=e[Symbol.iterator]();!(o=(l=u.next()).done);o=!0){var c=l.value,d=function(e,t){if(!e)return null;var n=!0,r=!1,i=void 0;try{for(var o,a=Object.values(e)[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var s=o.value,l=s.tasks.findIndex(function(e){if(e.state!==eH.TaskState.RUNNING)return!1;var n=e.metadata;return!!(null==n?void 0:n.openPorts)&&n.openPorts.some(function(e){return e.port===t})});if(-1!==l){var u=s.tasks[l].metadata;if(u.openPorts){var c=u.openPorts.map(function(e){return e.port});return{runId:s.runId,taskIdx:l,taskKey:"".concat(s.runId,"-").concat(l),portNumbers:c}}}}}catch(e){r=!0,i=e}finally{try{n||null==a.return||a.return()}finally{if(r)throw i}}return null}(t,c);d&&(n.has(d.taskKey)||i(d,r))}}catch(e){a=!0,s=e}finally{try{o||null==u.return||u.return()}finally{if(a)throw s}}}(Array.from(a.current),h,l.current,t,f),function(e,t){var n=!0,r=!1,i=void 0;try{for(var o,a=t.entries()[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var l=(0,s._)(o.value,2),u=l[0],c=l[1];!function(e,t){return!!e&&Object.values(e).some(function(e){return e.tasks.some(function(n,r){return"".concat(e.runId,"-").concat(r)===t&&n.state===eH.TaskState.RUNNING})})}(e,u)&&(c.abort.abort(),t.delete(u))}}catch(e){r=!0,i=e}finally{try{n||null==a.return||a.return()}finally{if(r)throw i}}}(h,l.current),m.label=4;case 4:return i=!1,[3,2];case 5:return[3,12];case 6:return g=m.sent(),o=!0,u=g,[3,12];case 7:if(m.trys.push([7,,10,11]),!(i&&null!=c.return))return[3,9];return[4,c.return()];case 8:m.sent(),m.label=9;case 9:return[3,11];case 10:if(o)throw u;return[7];case 11:return[7];case 12:return[2]}})})()},[e,f])}e.s(["default",()=>eY],646325);var eQ=e.i(402880);function eX(){var e=(0,s._)((0,eQ.useGetAgentFreeUsageLazyQuery)({fetchPolicy:"network-only",ssr:!1}),1)[0];(0,p.useChatHook)("received-completed-event",function(t){var n,r=t.event.contents.contents;(0,c.isKind)(r,"agentTimelineEventContents")&&(null==(n=r.agentTimelineEventContents.toolData)?void 0:n.$kind)==="commitData"&&e()})}e.s(["useSyncAgentFreemiumUsage",()=>eX],416406);var eJ=e.i(886513),eZ=e.i(145864),e0=e.i(149448);function e1(){var e=(0,p.useChatter)(),t=(0,g.useObservableMemo)(function(){return e.sessions.agent.current},[e.sessions],{default:void 0}),r=(0,g.useObservableMemo)(function(){return e.sessions.agent.all.list.map(function(e){return e[e.length-1]})},[e.sessions],{default:void 0}),i=(0,g.useObservableMemo)(function(){return e.sessions.agent.all.list.select(function(e){return e.length>1})},[e.sessions],{default:!1}),o=(0,eZ.useSetAgentPlanApprovalState)(),a=(0,eZ.useAgentPlanApprovalState)(),s=(0,eZ.useSetProposedPlan)(),l=(0,eZ.useSetApprovedPlan)(),c=(0,S.useAgentRunState)(),d=(0,e0.useLastEvent)(null!=r?r:null),f=(0,n.useRef)(!1),m=(0,n.useMemo)(function(){return(null==d?void 0:d.event)&&(0,N.isEventContentsKind)(null==d?void 0:d.event,"agentPlanEventContents")?(f.current=!0,!0):!!((null==d?void 0:d.event)&&(0,N.isEventContentsKind)(null==d?void 0:d.event,"agentTimelineEventContents"))&&"end_of_run_summary"===d.event.contents.contents.agentTimelineEventContents.toolName&&!0===f.current||(f.current=!1,!1)},[d]),x=(0,n.useMemo)(function(){return null==r?void 0:r.reduce(e2,"global")},[r]),y=(0,h.useObservable)(null==x?void 0:x.result,{proposedPlan:void 0,approvedPlan:void 0}),b=y.proposedPlan,w=y.approvedPlan;(0,n.useEffect)(function(){if(t){if(i)return void o("approved");if("approved"!==a&&"revising"!==a){if(w){o("approved"),l(w),s(b);return}b&&(b.eventState===u.EventState.IN_PROGRESS?m?o("generating"):o("iterating"):m?o("awaiting-approval"):o("iterating"),s(b))}}},[a,c,b,o,m,s,i,t,w,l])}var e2={direction:"reverse",state:{proposedPlan:void 0,approvedPlan:void 0,approvedPlanEventId:void 0},reducer:function(e,t){if((0,N.isEventContentsKind)(e,"approvePlanEventContents")){var n=e.contents.contents;t.approvedPlanEventId=(0,c.unkind)(n).planEventId}if((0,N.isEventContentsKind)(e,"agentPlanEventContents")){var r,i=(0,c.unkind)(e.contents.contents),o=i.objective,a=i.stackBlueprint,s=i.planId,l=(0,eJ._)(i,["objective","stackBlueprint","planId"]),d=(0,T._)((0,j._)({},l),{planId:s,stackBlueprint:a,eventCreatedAt:e.created,eventState:e.state,objective:o.description,supportsVisualPreview:B(a),eventId:e.id});if(e.id===t.approvedPlanEventId)return t.proposedPlan=d,t.approvedPlan=(0,T._)((0,j._)({},d),{requiresApproval:!1}),!1;if(d.requiresApproval)return t.proposedPlan=d,!1;if(t.approvedPlan=d,t.proposedPlan&&(null==(r=t.proposedPlan)?void 0:r.eventState)===u.EventState.COMPLETE)return!1}}};e.s(["useSyncAgentInitialPlanningState",()=>e1],440560);var e3=e.i(400082);function e4(){var e=(0,i.default)().git,t=(0,e3.usePid2Session)();(0,n.useEffect)(function(){e.setSession(null==t?void 0:t.from)},[e,null==t?void 0:t.from])}function e8(){(0,n.useEffect)(function(){var e=null;return!function t(){if(window.performance.memory){var n=window.performance.memory,r=n.jsHeapSizeLimit,i=n.totalJSHeapSize,o=n.usedJSHeapSize,a=window.performance.now();L.logger.info("perf:browser_memory",{jsHeapSizeLimit:r,totalJSHeapSize:i,usedJSHeapSize:o,timeElapsed:a}),e=setTimeout(t,-(5*Math.log(Math.random())*6e4))}}(),function(){e&&clearTimeout(e)}},[])}e.s(["default",()=>e4],752310),e.s(["default",()=>e8],741740);var e5=e.i(61524),e6=e.i(858248),e9=e.i(709485),e7=new Set([3e3,3001,3002,3003,3306,4e3,4200,5e3,5432,5173,6e3,6800,7e3,7001,8e3,8008,8080,8081,8888,9e3,9001,1e4,25565,25577,8887,27017,27018]);function te(){var e=(0,i.default)().container,t=(0,e5.usePreferences)("webviewAutoOpenOnPortOpened").preferences.webviewAutoOpenOnPortOpened,r=(0,ef.default)();(0,n.useEffect)(function(){return e.onPortOpened(function(e){var n=e.port,i=e.address,o=e.isForwarded,a=e.isVnc,s=e.externalPort;o?(0,e6.track)(e9.events.WORKSPACE,{action:"port_opened",type:a?"vnc":"webview",replId:r,port:n,externalPort:s,address:i,webviewAutoOpenOnPortOpened:t}):(0,e6.track)(e9.events.WORKSPACE,{action:"unforwarded_port_opened",port:n,isCommon:e7.has(n),address:i,type:a?"vnc":"webview",replId:r,externalPort:s})})},[e,r,t])}e.s(["default",()=>te],927938);var tt=e.i(561979),tn=e.i(827444),tr=e.i(641326),ti=e.i(924004),to=new Set;function ta(e){var t=e.workspaceType,r=(0,ef.default)(),o=(0,i.default)(),a=o.dotReplit,s=o.container;(0,n.useEffect)(function(){if(!to.has(r)){to.add(r);var e=a.watch(function(n){if(!n.error||n.error!==tr.DotReplitErrors.Disconnected){try{var r=s.getConnectionMetadata();if(!r||!r.token)throw Error("Expected token in measure call.");!function(e){var t=e.workspaceType,n=e.parsedToken,r=!!window.performance.getEntriesByName(tn.performanceMarks.pageNavStart,"mark").length,i={ssr:!r,workspaceType:t,tokenCluster:n.cluster},o="time to code";window.performance.measure(o,r?tn.performanceMarks.pageNavStart:void 0);var a=window.performance.getEntriesByName(o,"measure")[0];if(!a)return L.logger.info("Could not obtain measure for time to code",i);var s="page invisible fetch connection metadata",l=a.duration;window.performance.getEntriesByName(tn.performanceMarks.fetchConnectionMetadataPageInvisibleStart,"mark").length&&(window.performance.measure(s,tn.performanceMarks.fetchConnectionMetadataPageInvisibleStart,tn.performanceMarks.fetchConnectionMetadataPageInvisibleEnd),l-=window.performance.getEntriesByName(s,"measure")[0].duration,window.performance.clearMeasures(s),window.performance.clearMarks(tn.performanceMarks.fetchConnectionMetadataPageInvisibleStart),window.performance.clearMarks(tn.performanceMarks.fetchConnectionMetadataPageInvisibleEnd)),L.logger.time("time to code minus page invisible",l,i),L.logger.time("time to code with page invisible",a.duration,i),window.performance.clearMeasures(o),tt.datadogRum.addTiming("time_to_code_minus_page_invisible",l),tt.datadogRum.addTiming("time_to_code_with_page_invisible",a.duration)}({workspaceType:t,parsedToken:(0,ti.parseToken)(r.token)})}catch(e){L.logger.info("Could not measure time to code",{workspaceType:t,e:e,dotReplitResult:n.error?n.error:"success"})}e()}});return e}},[r,t,a,s])}function ts(){var e=(0,ea._)(["\n  subscription WorkspaceUserCanWrite($replId: String!) {\n    currentUserCanWrite(replId: $replId)\n  }\n"]);return ts=function(){return e},e}e.s(["default",()=>ta],551544);var tl={},tu=(0,es.gql)(ts()),tc=e.i(903381),td=e.i(33740);function tf(){var e,t,r=(0,i.default)().fs,o=(e={variables:{replId:(0,ef.default)()}},t=(0,j._)({},tl,e),em.useSubscription(tu,t)).data,a=(null==o?void 0:o.currentUserCanWrite)===!1;(0,n.useEffect)(function(){a&&window.location.reload()},[a]);var s=(0,n.useCallback)(function(){return a||r.getStatus()===tc.FsStatus.Clean?td.PreventNavigationOptions.NavigateAnyway:td.PreventNavigationOptions.PromptUser},[r,a]);(0,td.default)({shouldPreventNavCb:s})}e.s(["default",()=>tf],136780);var tp=e.i(223808);e.i(545082);var th=e.i(423111);function tg(e){!function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:500;(0,n.useEffect)(function(){if(null!=t)return t.portsState.subscribe((0,tp.default)(function(t){if(null!=t){var n=!0,r=!1,i=void 0;try{for(var o,a=t[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var s=o.value;if(s.isOpen&&!s.configuration.isVnc)return void e.set(!0)}}catch(e){r=!0,i=e}finally{try{n||null==a.return||a.return()}finally{if(r)throw i}}e.set(!1)}},r))},[t,e,r])}((0,th.useWebviewPortOpenedObservable)(),e)}e.s(["default",()=>tg],604026)},945710,169637,e=>{"use strict";var t=e.i(530658),n=e.i(389959),r=e.i(316699),i=e.i(649960);e.i(86159),e.i(545082);var o=e.i(423111);function a(e){var t=e.targetElement,r=e.activeTourStep,i=e.goToNextStep,a=e.setTourPausedReason,s=(0,o.useWebviewPortOpenedObservable)(),l=(0,n.useRef)(void 0),u=(0,n.useCallback)(function(){(null==r?void 0:r.waitToAdvanceOn)==="webviewPortOpened"?(a("async"),l.current=s.subscribe(function(e){e&&a("user")})):i()},[null==r?void 0:r.waitToAdvanceOn,i,a,s]);(0,n.useEffect)(function(){if(null!=t&&null!=r&&r.advanceOnTargetClick)return t.addEventListener("click",u),function(){var e;t.removeEventListener("click",u),null==(e=l.current)||e.call(l),l.current=void 0}},[t,r,u])}function s(e){var o=(0,t._)((0,n.useState)(null),2),a=o[0],s=o[1],l=(0,i.default)(function(){e&&s({rect:e.getBoundingClientRect(),docWidth:document.documentElement.clientWidth,docHeight:document.documentElement.clientHeight})},{type:"throttle",wait:100});return(0,n.useEffect)(function(){e&&l(e)},[e,l]),(0,n.useEffect)(function(){if(e){var t=(0,r.default)(function(){s({rect:e.getBoundingClientRect(),docWidth:document.documentElement.clientWidth,docHeight:document.documentElement.clientHeight})},100);return window.addEventListener("resize",t),window.addEventListener("scroll",t),function(){window.removeEventListener("resize",t),window.removeEventListener("scroll",t),t.cancel()}}},[e]),a}e.s(["useElementDomInfo",()=>s,"useTourStepClickInteraction",()=>a],945710);var l=e.i(878420),u=e.i(276385),c=e.i(971131),d=e.i(967629),f=e.i(480028),p=e.i(613355).DefaultModalZIndex-1;function h(e){var t=e.targetElement,n=e.transparent,r=e.disableAnimation,i=s(t);if(null==i||null==t)return null;var o=(0,d.css)({backgroundColor:n?"transparent":f.tokens.backgroundOverlay,zIndex:p,position:"fixed",transition:r?"all":"all 0.5s ease-out"});return(0,c.createPortal)((0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)("div",{id:"wat",css:[g((0,l._)({side:"left-top"},i)),o]}),(0,u.jsx)("div",{css:[g((0,l._)({side:"top-right"},i)),o]}),(0,u.jsx)("div",{css:[g((0,l._)({side:"right-bottom"},i)),o]}),(0,u.jsx)("div",{css:[g((0,l._)({side:"bottom-left"},i)),o]})]}),document.body)}function g(e){var t=e.side,n=e.rect,r=e.docWidth,i=e.docHeight;switch(t){case"left-top":return(0,d.css)({top:0,left:0,width:Math.max(0,n.left),height:Math.max(0,n.bottom)});case"top-right":return(0,d.css)({top:0,right:0,width:"calc(".concat(r,"px - ").concat(Math.max(0,n.left),"px)"),height:Math.max(0,n.top)});case"right-bottom":return(0,d.css)({bottom:0,right:0,width:"calc(".concat(r,"px - ").concat(Math.max(0,n.right),"px)"),height:"calc(".concat(i,"px - ").concat(Math.max(0,n.top),"px)")});case"bottom-left":return(0,d.css)({bottom:0,left:0,width:Math.max(0,n.right),height:"calc(".concat(i,"px - ").concat(Math.max(0,n.bottom),"px)")})}}e.s(["TourApertureOverlay",()=>h,"TourApertureOverlayZIndex",()=>p],169637)},425188,e=>{"use strict";var t=e.i(530658),n=e.i(276385),r=e.i(389959),i=e.i(161322),o=e.i(969664),a=e.i(98816),s=e.i(441329),l=e.i(945710),u=e.i(169637),c=e.i(109858),d=e.i(86159),f=e.i(739521),p=e.i(690821);function h(){var e,t,r=(0,d.useTourModal)(),i=r.activeStep,o=r.goto,a=r.totalSteps,s=r.currentStepIndex,l=r.done;if(null==i)return null;var u=null!=(t=null==(e=i.modalConfig)?void 0:e.width)?t:320;return(0,n.jsx)(f.Modal,{preventClose:!0,isOpen:!0,onRequestClose:function(){},centered:!0,maxWidth:"fit-content",noPadding:!0,transparent:!0,children:(0,n.jsx)(p.Tour,{title:i.hideTitle?void 0:i.title,"aria-label":i.title,subtitle:i.subtitle,icon:i.icon,content:function(){return(0,n.jsx)(n.Fragment,{children:"function"==typeof i.content?(0,n.jsx)(i.content,{}):i.content})},hideCloseButton:i.hideCloseButton,hideNavigation:i.hideNavigation,onDismiss:function(){return l()},currentStepIndex:s,onCurrentStepChange:o,totalSteps:a,cypressCloseData:"tour-popover-close-button",compact:!0,colorway:i.colorway,containerStyle:{width:u}})})}var g=e.i(878420),m=e.i(64386),x=e.i(971131),y=e.i(32988),b=e.i(672963),w=e.i(649960),k=e.i(446530),_=e.i(613355);e.i(399144);var S=u.TourApertureOverlayZIndex+1;(0,k.cssRecord)({inlinePlaceholder:[_.rcss.visibility.hidden,{pointerEvents:"none"}],portal:[_.rcss.position.absolute,_.rcss.zIndex(S)]});var C=e.i(480028),j=e.i(751273);function T(e){var i,o=e.targetElement,a=e.activeStep,s=e.goto,l=e.currentStepIndex,u=e.totalSteps,c=e.done,d=e.disableAnimation,f=e.placement,h=e.offset,k=e.cypressCloseData,_=e.onClickOutside,T=e.innerRef,E=e.width,R=e.colorway,I=void 0===R?"primary":R,A=e.doneText,P=e.hideIfPopperReferenceHidden,D=(0,t._)((0,r.useState)(null),2),O=D[0],N=D[1],M=(0,t._)((0,r.useState)(null),2),L=M[0],B=M[1],V=(0,y.usePopper)(o,O,{placement:void 0===f?"right":f,modifiers:[{name:"arrow",options:{element:L,padding:8}},{name:"offset",options:{offset:void 0===h?[0,16]:h}},{name:"preventOverflow",options:{padding:8}},{name:"flip",options:{fallbackPlacements:["top","bottom","left","right"]}},{name:"computeStyles",options:{adaptive:!1}}]}),F=(0,r.useCallback)(function(){var e;null==(e=V.update)||e.call(V)},[V]),U=(0,w.default)(F,{type:"throttle",wait:100});(0,r.useEffect)(function(){U(o)},[o,U]),(0,r.useImperativeHandle)(T,function(){return{updatePosition:function(){F()}}});var G=(0,b.default)(function(){_&&_()},[_]);return(0,x.createPortal)((0,n.jsxs)("div",(0,m._)((0,g._)({ref:function(e){G.current=e,N(e)},style:V.styles.popper,css:(0,g._)({transition:d?"all":"all 0.5s ease-out",zIndex:S+1,width:null!=E?E:320},void 0===P||P?{'&[data-popper-reference-hidden="true"]':{visibility:"hidden",pointerEvents:"none"}}:{})},V.attributes.popper),{children:[(0,n.jsx)(p.Tour,{title:a.title,subtitle:a.subtitle,icon:a.icon,content:a.content,onDismiss:c,currentStepIndex:l,onCurrentStepChange:s,totalSteps:u,cypressCloseData:void 0===k?"tour-popover-close-button":k,hideCloseButton:a.hideCloseButton,hideNavigation:a.hideNavigation,colorway:null!=(i=a.colorway)?i:I,doneText:A}),(0,n.jsx)("span",{style:V.styles.arrow,css:[j.arrowCss,{"&::after":I&&!1!==a.colorway?{backgroundColor:C.colormap[I].dimmest,border:"1px solid "+C.colormap[I].dimmer}:{backgroundColor:C.tokens.backgroundDefault,border:"1px solid "+C.tokens.backgroundHighest}}],ref:B})]})),document.body)}var E=c.tourContext.Provider;function R(e){var d,f,p=e.children,g=e.tour,m=e.onStep,x=e.onDone,y=e.colorway,b=(0,s.useIsInMobileWorkspace)(),w=(0,t._)((0,r.useState)(function(){return(0,c.createTourStore)({tour:g})}),1)[0],k=(0,i.useAtomValue)(c.activeStepAtom,{store:w}),_=(0,i.useAtomValue)(c.currentStepIndexAtom,{store:w});if(-1===_)throw Error("Current tour step is not in tour steps");var S=(0,t._)((0,o.useTourServiceDismissTourMutation)({variables:{name:g.id},optimisticResponse:{__typename:"RootMutationType",markTourAsSeen2:{__typename:"TourSeen",id:g.id,seen:!0}}}),1)[0],C=(0,i.useSetAtom)(c.isDoneAtom,{store:w}),j=(0,r.useRef)();(0,r.useEffect)(function(){j.current=k},[k]);var R=(0,i.useSetAtom)(c.gotoAtom,{store:w}),I=(0,i.useAtomValue)(c.currentStepElementAtom,{store:w}),A=(0,i.useAtomValue)(c.showStepAtom,{store:w}),P=(0,i.useSetAtom)(c.restartAtom,{store:w});window.startTour=function(){console.log("starting tour:",g.id,"from",g.steps[0].id),P()};var D=(0,i.useAtomValue)(c.filteredCurrentStepIndexAtom,{store:w}),O=(0,i.useAtomValue)(c.totalStepsAtom,{store:w}),N=(0,a.default)(m),M=(0,a.default)(x);(0,r.useEffect)(function(){return w.sub(c.activeStepIdAtom,function(){var e,t=w.get(c.activeStepIdAtom);t&&(null==(e=N.current)||e.call(N,t))})},[w,N,M]);var L=(0,r.useRef)(!1);(0,r.useEffect)(function(){var e;L.current||!k||k.id===g.steps[0].id&&(null==(e=N.current)||e.call(N,k.id),L.current=!0)},[k,N,g]),(0,r.useEffect)(function(){return w.sub(c.isDoneAtom,function(){var e,t=w.get(c.isDoneAtom),n=w.get(c.activeStepIdAtom);t&&(n&&(null==(e=M.current)||e.call(M,n)),S())})},[w,S,M]);var B=(0,o.useTourServiceToursSeenQuery)({variables:{tours:g.id},onCompleted:function(e){var t;w.set(c.isDoneAtom,!!(null==e||null==(t=e.currentUser)?void 0:t.toursSeen[0].seen))}}).loading,V=(0,i.useSetAtom)(c.isLoadingAtom,{store:w});(0,r.useEffect)(function(){V(B)},[V,B]);var F=(0,i.useAtomValue)(c.activeStepAtom,{store:w}),U=(0,i.useSetAtom)(c.nextAtom,{store:w}),G=(0,i.useAtomValue)(c.tourPausedReasonAtom,{store:w}),$=(0,i.useSetAtom)(c.tourPausedReasonAtom,{store:w});if((0,l.useTourStepClickInteraction)({targetElement:I,activeTourStep:F,goToNextStep:U,setTourPausedReason:$}),!A||!k)return(0,n.jsx)(E,{value:w,children:p});if(k.isModal)return(0,n.jsxs)(E,{value:w,children:[(0,n.jsx)(h,{}),p]});var z=0===_||!!(null==(d=j.current)?void 0:d.isModal)||!!(null==(f=g.options)?void 0:f.disableAnimation);return(0,n.jsxs)(E,{value:w,children:[I?(0,n.jsxs)(n.Fragment,{children:["user"===G?null:(0,n.jsx)(u.TourApertureOverlay,{targetElement:I,transparent:k.hideOverlay||"async"===G,disableAnimation:z}),!k.hideTooltip&&(0,n.jsx)(T,{targetElement:I,activeStep:k,currentStepIndex:D,done:function(){return C(!0)},goto:function(e){R(e+_-D)},totalSteps:O,disableAnimation:z,colorway:y,doneText:g.doneText,hideIfPopperReferenceHidden:!b})]}):null,p]})}e.s(["TourRoot",()=>R],425188)},416558,17609,79958,e=>{"use strict";var t,n,r=e.i(297083),i=e.i(878420),o=e.i(530658),a=e.i(817556),s=e.i(866408);function l(e){return(0,r._)(function(e){var t,n;return(0,a._)(this,function(r){return t=e.container,n=e.service,[2,new Promise(function(e){var r=t.openChannel({service:n},function(t){return e([t.channel,r]),r})})]})}).apply(this,arguments)}var u=((t={}).OUTPUT="OUTPUT",t.ERROR="ERROR",t.STATE_CHANGED="STATE_CHANGED",t.CHANNEL_OPENED="CHANNEL_OPENED",t);function c(e){var t=e.container,n=(0,s.default)(),c=null;function d(){return(0,r._)(function(){return(0,a._)(this,function(e){return c&&"open"===c.status?[2,c]:[2,new Promise(function(e){n.once(u.CHANNEL_OPENED,function(t){e(t)})})]})})()}function f(){return(0,r._)(function(){return(0,a._)(this,function(e){return[2,l({container:t,service:"nix"})]})})()}return t.openChannel({service:"nix"},function(e){var t=e.channel;return c=t,n.emit(u.CHANNEL_OPENED,t),function(){c=null}}),{searchPackages:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,r._)(function(){var n,r,s,l;return(0,a._)(this,function(a){switch(a.label){case 0:return[4,f()];case 1:return r=(n=o._.apply(void 0,[a.sent(),2]))[0],s=n[1],[4,r.request({nixPackageSearchRequest:(0,i._)({query:e},t)})];case 2:if((l=a.sent()).channelClosed)return[2,{error:"Channel closed",packages:null}];if(s(),l.error)return[2,{error:l.error,packages:null}];if(!l.nixPackageSearchResponse)return[2,{error:"Response expected but none received",packages:null}];return[2,{packages:l.nixPackageSearchResponse.packages,error:null}]}})})()},listPackages:function(){return(0,r._)(function(){var e,t,n,r;return(0,a._)(this,function(i){switch(i.label){case 0:return[4,f()];case 1:return t=(e=o._.apply(void 0,[i.sent(),2]))[0],n=e[1],[4,t.request({nixPackageListRequest:{}})];case 2:if((r=i.sent()).channelClosed)return[2,{error:"Channel closed",packages:null}];if(n(),r.error)return[2,{error:r.error,packages:null}];if(!r.nixPackageListResponse)return[2,{error:"Response expected but none received",packages:null}];return[2,{packages:r.nixPackageListResponse.packages,error:null}]}})})()},getChannels:function(){return(0,r._)(function(){var e,t,n,r;return(0,a._)(this,function(i){switch(i.label){case 0:return[4,f()];case 1:return t=(e=o._.apply(void 0,[i.sent(),2]))[0],n=e[1],[4,t.request({nixChannelsRequest:{}})];case 2:if((r=i.sent()).channelClosed)return[2,{error:"Channel closed",channels:null}];if(n(),r.error)return[2,{error:r.error,channels:null}];if(!r.nixChannelsResponse)return[2,{error:"Response expected but none received",channels:null}];return[2,{channels:r.nixChannelsResponse.channels,error:null}]}})})()},getLatestStableChannel:function(){return(0,r._)(function(){var e,t,n,r;return(0,a._)(this,function(i){switch(i.label){case 0:return[4,f()];case 1:return t=(e=o._.apply(void 0,[i.sent(),2]))[0],n=e[1],[4,t.request({nixChannelLatestStableRequest:{}})];case 2:if((r=i.sent()).channelClosed)return[2,{error:"Channel closed",channel:null}];if(n(),r.error)return[2,{error:r.error,channel:null}];if(!r.nixChannelLatestStableResponse)return[2,{error:"Response expected but none received",channel:null}];return[2,{channel:r.nixChannelLatestStableResponse.channel,error:null}]}})})()},addPackages:function(e){return(0,r._)(function(){var t;return(0,a._)(this,function(n){switch(n.label){case 0:return[4,d()];case 1:return[4,n.sent().request({nixPackageAddRequest:{packages:e}})];case 2:if((t=n.sent()).channelClosed)return[2,"channel closed"];if(t.error)return[2,t.error];if(!t.nixPackageAddResponse)return[2,"response expected but non received"];return[2,null]}})})()},removePackages:function(e){return(0,r._)(function(){var t;return(0,a._)(this,function(n){switch(n.label){case 0:return[4,d()];case 1:return[4,n.sent().request({nixPackageRemoveRequest:{packages:e}})];case 2:if((t=n.sent()).channelClosed)return[2,"channel closed"];if(t.error)return[2,t.error];if(!t.nixPackageRemoveResponse)return[2,"response expected but non received"];return[2,null]}})})()},packageInfo:function(e){return(0,r._)(function(){var t;return(0,a._)(this,function(n){switch(n.label){case 0:return[4,d()];case 1:return[4,n.sent().request({nixPackageInfoRequest:{name:e}})];case 2:if((t=n.sent()).channelClosed)return[2,{package:null,error:"channel closed"}];if(t.error)return[2,{package:null,error:t.error}];if(!t.nixPackageInfoResponse)return[2,{package:null,error:"response expected but non received"}];if(!t.nixPackageInfoResponse.package)return[2,{package:null,error:"package not found"}];return[2,{package:t.nixPackageInfoResponse.package,error:null}]}})})()}}}e.s(["default",()=>c],416558);var d=e.i(906368),f=e.i(626430),p=e.i(709485),h=e.i(104375),g=e.i(968323),m=((n={}).OUTPUT="OUTPUT",n.ERROR="ERROR",n.STATE_CHANGED="STATE_CHANGED",n.CHANNEL_OPENED="CHANNEL_OPENED",n);function x(e){var t=e.container,n=e.forceTrace,i=e.track,u=(0,s.default)(),c=new Map;function x(e){var t=c.get(e);return t||(t={packagerChannel:null,didCallOpenChannel:!1,closeChannel:null},c.set(e,t)),t}function y(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return(0,r._)(function(){var r,i,s;return(0,a._)(this,function(a){switch(a.label){case 0:return[4,l({container:t,service:"packager3"})];case 1:if(i=(r=o._.apply(void 0,[a.sent(),2]))[0],s=r[1],!e)return[3,3];return[4,i.request({packageSetPackagerRequest:{packagerId:e}})];case 2:a.sent(),a.label=3;case 3:if("open"!==i.status){if(n>5)throw Error("Failed to getAnonymousPackagerChannel");return[2,y(e,n+1)]}return[2,[i,s]]}})})()}function b(e){return(0,r._)(function(){var n;return(0,a._)(this,function(r){return((n=x(e)).didCallOpenChannel||function(e){var n=x(e);if(n.didCallOpenChannel)throw Error("Already called open channel");n.didCallOpenChannel=!0,n.closeChannel=t.openChannel({service:"packager3",name:e||"packager",action:f.api.OpenChannel.Action.ATTACH_OR_CREATE},function(t){var r=t.channel;return r.onCommand(function(t){if(null!=t.state){var n=t.state===f.api.State.Running;u.emit(m.STATE_CHANGED,n,e)}else null!=t.output?u.emit(m.OUTPUT,t.output,e):null!=t.error&&u.emit(m.ERROR,t.error,e)}),e?r.request({packageSetPackagerRequest:{packagerId:e}}).then(function(){n.packagerChannel=r,u.emit(m.CHANNEL_OPENED,r,e)}):(n.packagerChannel=r,u.emit(m.CHANNEL_OPENED,r,e)),function(){n.packagerChannel=null}})}(e),n.packagerChannel&&"open"===n.packagerChannel.status)?[2,n.packagerChannel]:[2,new Promise(function(t){u.once(m.CHANNEL_OPENED,function(n,r){r===e&&t(n)})})]})})()}return{addPackages:function(e,t){return(0,r._)(function(){var n,r,o,s;return(0,a._)(this,function(a){switch(a.label){case 0:return[4,b(t)];case 1:if("open"!==(r=a.sent()).status)return[2,!1];return o=e.map(function(e){return{name:e.name,spec:e.version}}),[4,r.request({packageAdd:{pkgs:o,useNewResponse:!0}})];case 2:if((s=a.sent()).channelClosed||s.error)return[2,!1];return(null==(n=s.packageAddResponse)?void 0:n.installedSystemDependencies)&&i&&i(p.events.PACKAGER_INSTALLED_SYSTEM_DEPENDENCIES,{packagerId:t}),[2,!0]}})})()},removePackages:function(e,t){return(0,r._)(function(){var n,r,i;return(0,a._)(this,function(o){switch(o.label){case 0:return[4,b(t)];case 1:if("open"!==(n=o.sent()).status)return[2,!1];return r=e.map(function(e){return{name:e}}),[4,n.request({packageRemove:{pkgs:r}})];case 2:if((i=o.sent()).channelClosed)return[2,!1];return[2,!!i.ok]}})})()},searchPackages:function(e,t){return(0,r._)(function(){var n,r,i,s;return(0,a._)(this,function(a){switch(a.label){case 0:return[4,y(t)];case 1:return r=(n=o._.apply(void 0,[a.sent(),2]))[0],i=n[1],[4,r.request({packageSearch:{query:e}})];case 2:if((s=a.sent()).channelClosed)return[2,[]];if(i(),"packageSearchResp"===s.body&&s.packageSearchResp)return[2,s.packageSearchResp.results||[]];return d.captureException(Error("Unknown packager3 command ".concat(s.body,". ")+"Expected packageSearchResp. Received error: ".concat(s.error))),[2,[]]}})})()},fetchPackageInfo:function(e,t){return(0,r._)(function(){var n,r,i,s;return(0,a._)(this,function(a){switch(a.label){case 0:return[4,y(t)];case 1:return r=(n=o._.apply(void 0,[a.sent(),2]))[0],i=n[1],[4,r.request({packageInfo:{pkg:{name:e}}})];case 2:if((s=a.sent()).channelClosed)return[2,void 0];if(i(),"packageInfoResp"===s.body&&s.packageInfoResp)return[2,s.packageInfoResp.pkg||void 0];return d.captureException(Error("Unknown packager3 command ".concat(s.body,". ")+"Expected packageInfoResp. Received error: ".concat(s.error))),[2,void 0]}})})()},installPackages:function(e,t){var o=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return(0,r._)(function(){return(0,a._)(this,function(s){return[2,(0,h.startSpanFromContext)(e,"packager.installPackages",function(e){return(0,r._)(function(){var r,s,l;return(0,a._)(this,function(a){switch(a.label){case 0:return[4,b(t)];case 1:if("open"!==(r=a.sent()).status)return[2,(0,g.Err)("ChannelClosed")];return[4,r.request({packageInstall:{useNewResponse:!0,disableGuess:o},traceInfo:(0,h.getTraceInfo)(e),forceTrace:n})];case 2:if((s=a.sent()).error)return[2,(0,g.Err)(s.error)];if(s.channelClosed)return[2,(0,g.Err)("ChannelClosed")];if(!(l=s.packageInstallResponse))return[2,(0,g.Err)("No package install response found")];return l.installedSystemDependencies&&i&&i(p.events.PACKAGER_INSTALLED_SYSTEM_DEPENDENCIES,{packagerId:t}),[2,(0,g.Ok)(l)]}})})()})]})})()},listSpecfile:function(e){return(0,r._)(function(){var t,n,r,i,s,l,u;return(0,a._)(this,function(a){switch(a.label){case 0:return[4,y(e)];case 1:return n=(t=o._.apply(void 0,[a.sent(),2]))[0],r=t[1],[4,n.request({packageListSpecfile:{}})];case 2:if((i=a.sent()).channelClosed)return[2,{packages:null,error:"channel closed"}];switch(r(),i.body){case"error":return[2,{packages:null,error:"list specfile failed: ".concat(i.error)}];case"packageListSpecfileResp":if(!(l=null==(s=i.packageListSpecfileResp)?void 0:s.pkgs))return[2,{packages:null,error:"list specfile returned an empty response"}];return[2,{packages:l,error:null}];default:return u="Unknown packager3 listSpecFile command ".concat(i.body,". ")+"Expected error or packageListSpecfileResp",d.captureException(Error(u)),[2,{packages:null,error:u}]}}})})()},getPackagerIds:function(){return Array.from(c.keys())},clearPackager:function(e){var t=c.get(e);(null==t?void 0:t.closeChannel)&&t.closeChannel(),c.delete(e)},onOutput:function(e){return u.on(m.OUTPUT,e),function(){u.removeListener(m.OUTPUT,e)}},onError:function(e){return u.on(m.ERROR,e),function(){u.removeListener(m.ERROR,e)}},onStateChanged:function(e){return u.on(m.STATE_CHANGED,e),function(){u.removeListener(m.STATE_CHANGED,e)}}}}e.s(["default",()=>x],17609);var y=e.i(904851),b=e.i(90659),w=e.i(119468),k=Object.defineProperty,_=function(e,t,n){var r;return r=(void 0===t?"undefined":(0,w._)(t))!=="symbol"?t+"":t,r in e?k(e,r,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[r]=n,n},S=function(){function e(t,n){(0,y._)(this,e),_(this,"_headers"),_(this,"_isValueQuoted",!1),_(this,"_row",[]),_(this,"_value",""),_(this,"_wasLastQuote",!1),_(this,"_rowNum",0),_(this,"_writeRow"),this._headers=n,this._writeRow=t}return(0,b._)(e,[{key:"process",value:function(e){var t,n;return t=this,n=function(){var t,n,r;return(0,a._)(this,function(i){if(0===e.length)return[2];for(n=0;n<e.length;n++){if(r=e[n],null==t&&0===this._value.length&&'"'===r){this._isValueQuoted=!0,t=n+1;continue}if(null==t&&(t=n),this._isValueQuoted){if(this._wasLastQuote){switch(r){case'"':this._value+=0===n?'"':e.slice(t,n);break;case"\r":case"\n":this._isValueQuoted=!1,0!==n&&(this._value+=e.slice(t,n-1)),this._finalizeValue(!0);break;case",":this._isValueQuoted=!1,0!==n&&(this._value+=e.slice(t,n-1)),this._finalizeValue();break;default:throw Error('invalid "')}this._wasLastQuote=!1,t=null;continue}this._wasLastQuote='"'===r;continue}if(","===r){this._value+=e.slice(t,n),this._finalizeValue(),t=null;continue}if("\n"===r||"\r"===r){this._value+=e.slice(t,n),t=null,this._finalizeValue(!0);continue}if('"'===r)throw Error("Unexpected quote character")}return null!=t&&(this._value+=e.slice(t,this._wasLastQuote?-1:e.length)),[2]})},new Promise(function(e,r){var i=function(e){try{a(n.next(e))}catch(e){r(e)}},o=function(e){try{a(n.throw(e))}catch(e){r(e)}},a=function(t){return t.done?e(t.value):Promise.resolve(t.value).then(i,o)};a((n=n.apply(t,null)).next())})}},{key:"flush",value:function(){if(this._value||0!==this._row.length)try{this._finalizeValue(!0)}catch(e){throw Error("invalid EOF: ".concat(e.message))}}},{key:"headers",value:function(){return this._headers}},{key:"_finalizeValue",value:function(e){if((this._row.length||!e||this._value)&&(this._row.push(this._value),this._value="",this._wasLastQuote=!1,e)){var t=++this._rowNum;if(!this._headers){this._headers=this._row,this._row=[];return}if(this._headers&&this._row.length!==this._headers.length)throw Error("Invalid count of columns in row ".concat(t));for(var n={},r=0;r<this._headers.length;r++)n[this._headers[r]]=this._row[r];this._writeRow(n),this._row=[]}}}]),e}();e.s(["CSVParser",()=>S],79958)},336777,e=>{"use strict";var t=e.i(297083),n=e.i(817556),r=e.i(906368),i=e.i(79958),o=e.i(626430),a=e.i(843754);function s(e){var s,l=e.container,u=e.toolchain;function c(e){return(0,t._)(function(){return(0,n._)(this,function(r){return e&&(s=void 0),s||(s=new Promise(function(e){return(0,t._)(function(){var t,r;return(0,n._)(this,function(n){switch(n.label){case 0:if(null==(r=u.modules)||null==(t=r.current)?void 0:t.some(function(e){return e.id.startsWith("postgresql")}))return[3,2];return[4,u.addModule("postgresql-16")];case 1:return n.sent(),e(),[3,3];case 2:e(),n.label=3;case 3:return[2]}})})()})),[2]})})()}return{ensureNixPsqlModuleInstalled:c,run:function(e){var s=e.query,u=e.connectionString;return(0,t._)(function(){var e,t,d,f,p,h,g,m,x,y,b;return(0,n._)(this,function(n){switch(n.label){case 0:return[4,c()];case 1:n.sent(),e=(0,a.default)({container:l}),t=[],d=null,f=new i.CSVParser(function(e){return t.push(e)}),p=null,h=!1,g=new Promise(function(t){var n=e.onStateChanged(function(e){var r=e.state,i=e.stderrBuffer;if(r===o.api.State.Running){h=!0;return}h&&(p=i,n(),t())})}),e.onOutput(function(e){try{f.process(e)}catch(t){d||(d=t,r.captureException(t,function(t){return t.setExtra("chunk",e)}))}}),n.label=2;case 2:return n.trys.push([2,,5,6]),[4,e.request({args:["psql",u,"--csv","--command",s],splitStderr:!0})];case 3:return m=n.sent(),[4,g];case 4:return n.sent(),m.error&&!p&&(p=m.error),f.flush(),[3,6];case 5:return e.dispose(),[7];case 6:if(p)return[2,{columns:f.headers(),rows:t,error:p}];if(d)return x=d.message,[2,{columns:null!=(y=f.headers())?y:[],rows:t,error:x}];return[2,{columns:null!=(b=f.headers())?b:[],rows:t,error:null}]}})})()}}}e.s(["default",()=>s])},259788,788222,444815,e=>{"use strict";var t,n=e.i(822658),r=e.i(546544),i=e.i(817221),o=function(e){var t=e.configurationSupport;return{textDocument:{synchronization:{dynamicRegistration:!0,didSave:!0},signatureHelp:{dynamicRegistration:!0,signatureInformation:{documentationFormat:["markdown","plaintext"]}},publishDiagnostics:{relatedInformation:!0,tagSupport:{valueSet:[1,2]}},formatting:{dynamicRegistration:!0},documentSymbol:{dynamicRegistration:!0,hierarchicalDocumentSymbolSupport:!0,symbolKind:{valueSet:i.default}},semanticTokens:{dynamicRegistration:!0,requests:{range:!0,full:{delta:!0}},tokenTypes:r.KNOWN_SEMANTIC_TOKENS,tokenModifiers:r.KNOWN_SEMANTIC_TOKEN_MODIFIERS,formats:[n.TokenFormat.Relative],overlappingTokenSupport:!0,multilineTokenSupport:!0,serverCancelSupport:!0,augmentsSyntaxTokens:!0},definition:{dynamicRegistration:!0,linkSupport:!0},typeDefinition:{dynamicRegistration:!0},implementation:{dynamicRegistration:!0},references:{dynamicRegistration:!0},rename:{dynamicRegistration:!0,prepareSupport:!0},completion:{dynamicRegistration:!0,contextSupport:!0,completionItem:{commitCharactersSupport:!0,documentationFormat:["markdown","plaintext"],labelDetailsSupport:!0,resolveSupport:{properties:["detail","documentation"]},snippetSupport:!0},completionList:{itemDefaults:["commitCharacters"]}},codeAction:{resolveSupport:{properties:["edit"]},dataSupport:!0,dynamicRegistration:!0,isPreferredSupport:!0,codeActionLiteralSupport:{codeActionKind:{valueSet:Object.values(n.CodeActionKind)}}},hover:{dynamicRegistration:!0,contentFormat:["markdown","plaintext"]}},workspace:{applyEdit:!0,didChangeConfiguration:t.clientToServer||t.serverToClient?{dynamicRegistration:!0}:void 0,configuration:t.serverToClient,semanticTokens:{refreshSupport:!0},executeCommand:{dynamicRegistration:!0},workspaceEdit:{documentChanges:!0,resourceOperations:[n.ResourceOperationKind.Create,n.ResourceOperationKind.Delete,n.ResourceOperationKind.Rename]}}}};e.s(["createClientCapabilities",()=>o],259788);var a=e.i(937500),s=e.i(904851),l=e.i(90659),u=e.i(721281),c=e.i(167626),d=e.i(906368),f=e.i(664152),p=new TextEncoder,h=new TextDecoder,g=(t=/[a-z\d_-]+: [a-z\d_ :;.,/"'?!(){}[\]@<>=+*#$&`|~^%-]+/.source,RegExp("(".concat(t,"\\r\\n)*(").concat(t,")$"),"i")),m=function(){function e(t){(0,s._)(this,e),(0,u._)(this,"onMessage",void 0),(0,u._)(this,"buffer",void 0),(0,u._)(this,"headers",void 0),this.onMessage=t,this.buffer=new Uint8Array,this.read=this.read.bind(this)}return(0,l._)(e,[{key:"consumeHeaders",value:function(){var e=function(e){var t=e.findIndex(function(t,n){return 13===t&&10===e[n+1]&&13===e[n+2]&&10===e[n+3]});if(-1!==t){var n=h.decode(e.slice(0,t)),r=n.match(g);if(!r)throw f.logger.error("Failed to parse LSP header, no matches",{fragment:n}),Error("Unable to match header, text: ".concat(n));var i=Object.create(null),o=r[0].split("\r\n"),a=!0,s=!1,l=void 0;try{for(var u,c=o[Symbol.iterator]();!(a=(u=c.next()).done);a=!0){var d=u.value,p=d.indexOf(":");if(-1===p)throw f.logger.error("Failed to parse LSP header, missing colon",{fragment:n}),Error('Message header must separate key and value using ":"');var m=d.substr(0,p),x=d.substr(p+1).trim();if("Content-Length"===m){var y=parseInt(x,10);if(isNaN(y))throw f.logger.error("Failed to parse LSP header, NaN content length",{fragment:n}),Error("Content-Length value must be a number.");i[m]=parseInt(x,10)}else i[m]=x}}catch(e){s=!0,l=e}finally{try{a||null==c.return||c.return()}finally{if(s)throw l}}if(null==i["Content-Length"])throw f.logger.error("Failed to parse LSP header, no Content-Length",{fragment:n}),Error("Header must provide a Content-Length property.");return{headerLength:t,value:i}}}(this.buffer);if(e)return this.buffer=this.buffer.slice(e.headerLength+4),e}},{key:"read",value:function(e){for(this.buffer=(t=this.buffer,n=p.encode(e),(r=new Uint8Array(t.length+n.length)).set(t),r.set(n,t.length),r);null!=(i=this.headers)?i:this.headers=this.consumeHeaders();){var t,n,r,i,o=this.headers.value["Content-Length"];if(this.buffer.length<o)return;var s=function(e,t,n){var r=h.decode(e.slice(0,t));try{return{json:JSON.parse(r),buffer:e.slice(t)}}catch(u){var i=a.Buffer.from(e).toString();if((0,c._)(u,SyntaxError)&&"Unexpected end of JSON input"===u.message){f.logger.info("Failed to parse LSP message, falling back to json parsing",{buffer:i,length:t,rpcContent:r,attempt:"original-length",headers:JSON.stringify(n)});var o=function(e,t){for(var n=0,r=0,i=!1,o=0;o<e.length+1;o++){if(0!==o&&!n&&!r&&!i)return o;var a=e[o];switch(a){case 92:o++;continue;case 34:i=!i;continue}if(!i)switch(a){case 123:n++;break;case 125:n--;break;case 91:r++;break;case 93:r--}}return -1}(e,0);if(-1!==o){var s=e.slice(0,o),l=h.decode(s);try{return{json:JSON.parse(l),buffer:e.slice(o)}}catch(e){f.logger.error("Failed to parse LSP message",{givenError:e,buffer:i,length:t,rpcContent:r,attempt:"recomputed-length"})}}}else f.logger.error("Failed to parse LSP message",{givenError:u,buffer:i,length:t,rpcContent:r,attempt:"content-length"});return{json:void 0,buffer:e.slice(t)}}}(this.buffer,o,this.headers),l=s.json,u=s.buffer;if(this.headers=void 0,this.buffer=u,void 0!==l)try{this.onMessage(l)}catch(e){d.captureException(e)}}}}]),e}();e.s(["MessageReader",()=>m],788222);var x=e.i(878420),y=e.i(64386),b=function(){function e(){(0,s._)(this,e)}return(0,l._)(e,[{key:"supports",value:function(e){return e.includes("css-language-server")}},{key:"onResponse",value:function(e,t){return"textDocument/hover"===e?this.onHover(t):t}},{key:"onHover",value:function(e){if("error"in e)return e;var t=e.result;return"cancelled"in e&&!1!==e.cancelled||!t?e:(Array.isArray(t.contents)&&(t.contents={kind:"markdown",value:["```html",t.contents[0],"```",t.contents[1],""].join("\n")}),(0,y._)((0,x._)({},e),{result:t}))}}]),e}(),w=function(){function e(){(0,s._)(this,e)}return(0,l._)(e,[{key:"supports",value:function(e){return"module:dotnet-7.0/languageServer:omni-sharp"===e}},{key:"onResponse",value:function(e,t){switch(e){case"textDocument/codeAction":return this.onCodeAction(t);case"textDocument/completion":return this.onCompletion(t)}return t}},{key:"onCodeAction",value:function(e){return"error"in e&&-32801===e.error.code?{cancelled:!0,result:null}:e}},{key:"onCompletion",value:function(e){return"error"in e&&-32801===e.error.code?{cancelled:!0,result:null}:e}}]),e}(),k=[new(function(){function e(){(0,s._)(this,e)}return(0,l._)(e,[{key:"supports",value:function(e){return e.includes("typescript-language-server")}},{key:"onResponse",value:function(e,t){return"textDocument/completion"===e?this.onCompletion(t):t}},{key:"onCompletion",value:function(e){if("error"in e||"cancelled"in e&&!1!==e.cancelled)return e;var t=e.result;if(!t)return e;Array.isArray(t)&&(t={isIncomplete:!1,items:t});for(var n=0;n<t.items.length;n++){var r=t.items[n];r.sortText&&r.sortText.startsWith("")&&(r.sortText=r.sortText.replace("",""))}return(0,y._)((0,x._)({},e),{result:t})}}]),e}()),new b,new w];function _(e){var t=!0,n=!1,r=void 0;try{for(var i,o=k[Symbol.iterator]();!(t=(i=o.next()).done);t=!0){var a=i.value;if(a.supports(e))return a}}catch(e){n=!0,r=e}finally{try{t||null==o.return||o.return()}finally{if(n)throw r}}return new S}var S=function(){function e(){(0,s._)(this,e)}return(0,l._)(e,[{key:"supports",value:function(){return!0}},{key:"onResponse",value:function(e,t){return t}}]),e}();e.s(["getQuirkHandler",()=>_],444815)},886383,e=>{"use strict";var t,n=e.i(297083),r=e.i(530658),i=e.i(346715),o=e.i(817556),a=e.i(992785);e.i(694906);var s=e.i(627720),l=e.i(626430),u=e.i(664152),c=e.i(52425),d=e.i(937500),f=e.i(878420),p=e.i(64386),h=e.i(886513),g=e.i(119468),m=e.i(906368),x=e.i(619593),y=e.i(502379),b=e.i(446692),w=e.i(866408),k=e.i(272391),_=e.i(259788),S=e.i(788222),C=e.i(444815),j=e.i(577811);function T(e,t){var n,r;return null!=(r=null==(n=b.FileTypeRepository.from(e))?void 0:n.id)?r:t}var E=((t=E||{}).INITIALIZED="INITIALIZED",t.READY="READY",t.DIAGNOSTICS="DIAGNOSTICS",t.SERVER_STATE_CHANGE="SERVER_STATE_CHANGE",t.SERVER_HEALTH_CHANGE="SERVER_HEALTH_CHANGE",t.SERVER_CAPABILITIES_CHANGE="SERVER_CAPABILITIES_CHANGE",t.REQUEST="REQUEST",t.RESPONSE="RESPONSE",t.CANCEL_REQUEST="CANCEL_REQUEST",t.SEND_NOTIFICATION="SEND_NOTIFICATION",t.RECEIVE_NOTIFICATION="RECEIVE_NOTIFICATION",t.SEMANTIC_TOKENS_REFRESH="SEMANTIC_TOKENS_REFRESH",t);function R(){return Math.floor(0x7fffffff*Math.random())}function I(e){var t=JSON.stringify((0,p._)((0,f._)({},e),{jsonrpc:"2.0"})),n=d.Buffer.byteLength(t,"utf8");return"Content-Length: ".concat(n,"\r\n\r\n").concat(t)}function A(e,t){var n,r,i,o,s,l;return t&&t?!!(0,a.default)(null==e?void 0:e.fileTypeAttrs,t.fileTypeAttrs)&&!!(0,a.default)(null==e||null==(n=e.config)?void 0:n.startCommand,null==(r=t.config)?void 0:r.startCommand)&&!!(0,a.default)(null==e||null==(i=e.config)?void 0:i.initializationOptionsJson,null==(o=t.config)?void 0:o.initializationOptionsJson)&&!!(0,a.default)(null==e||null==(s=e.config)?void 0:s.configurationJson,null==(l=t.config)?void 0:l.configurationJson):!!t==!!t}function P(e){var t=e.container,d=e.toolchain,b=e.fs,E=e.enableMultipleLSPClientsPerFile,P=void 0!==E&&E,D=new Map,O=new Map,N={},M=!0;function L(e){var t=N[e];if(!t)throw Error("LSPNix: removeLanguage called with lspId never configured");var n=t.client;if(n){t.client=null,n.destroy();var i=!0,o=!1,a=void 0;try{for(var s,l=D[Symbol.iterator]();!(i=(s=l.next()).done);i=!0){var u=(0,r._)(s.value,2),c=u[0],d=u[1],f=O.get(c);if(f){f.delete(n),O.set(c,f);var p=!0,h=!1,g=void 0;try{for(var m,x=d[Symbol.iterator]();!(p=(m=x.next()).done);p=!0)(0,m.value)(Array.from(f))}catch(e){h=!0,g=e}finally{try{p||null==x.return||x.return()}finally{if(h)throw g}}}}}catch(e){o=!0,a=e}finally{try{i||null==l.return||l.return()}finally{if(o)throw a}}}t.closeChannel(),delete N[e]}function B(e,t){if(N[e])throw Error("LSPNix: addLanguage called with lspId already configured");N[e]={client:null,option:t,closeChannel:function(){}},M&&G(e)}var V=new Map;function F(e){if(!M)return!1;var t=N[e];return!!t&&!t.client}function U(e,t,n){new Date().getTime()-n.getTime()<5e3?t<3?setTimeout(function(){F(e)&&G(e,t+1)},1e3*Math.pow(2,t)):u.logger.error("LSP server is crash-looping. Giving up.",{lspId:e,appService:"lspnix"}):setTimeout(function(){F(e)&&G(e)})}function G(e){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return(0,n._)(function(){var d,E,L,B,F,G,$;return(0,o._)(this,function(z){switch(z.label){case 0:if(!M)throw Error("LSPNix: Called startClient while not enabled");if(!N[e])throw Error("LSPNix: No config found for lspId: ".concat(e));if(!V.get(e))return[3,2];return[4,V.get(e)];case 1:if(z.sent())return[2];z.label=2;case 2:if(E=(d=N[e]).client,d.closeChannel,L=d.option,E)throw Error("LSPNix: A previous client is already set for language: ".concat(e));return B=function(){},F=new Promise(function(e){B=e}),V.set(e,F),G=[],$=t.openChannel({service:"lsp2",skip:function(e){var t=e.repl.language,n=t.startsWith("nix")||t.startsWith("html");return n||(u.logger.error("Skipped opening lsp channel for non-nix repl",{language:t,appService:"lspnix"}),B(null)),!n}},function(d){var E=d.channel,F=null,z=!1,H=function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(!z){z=!0,t||(B(null),V.delete(e)),G.forEach(function(e){return e()}),null==F||F.destroy(),(null==(a=N[e])?void 0:a.client)===F&&(N[e].client=null),t&&M||$();var n=!0,i=!1,o=void 0;try{for(var a,s,l=D[Symbol.iterator]();!(n=(s=l.next()).done);n=!0){var u=(0,r._)(s.value,2),c=u[0],d=u[1],f=O.get(c);if(f&&F&&f.has(F)){f.delete(F),f.size?O.set(c,f):O.delete(c);var p=!0,h=!1,g=void 0;try{for(var m,x=d[Symbol.iterator]();!(p=(m=x.next()).done);p=!0)(0,m.value)(Array.from(f))}catch(e){h=!0,g=e}finally{try{p||null==x.return||x.return()}finally{if(h)throw g}}}}}catch(e){i=!0,o=e}finally{try{n||null==l.return||l.return()}finally{if(i)throw o}}}};if("open"!==E.status)return void u.logger.error("LSPNix got a channel that wasn't open. This is expected to be impossible.",{lspId:e,appService:"lspnix"});var W=new Date;return E.request({startLSP:{languageServerId:e}}).then(function(d){if(!d.ok)return void u.logger.error("LSP server failed to start",{lspId:e,appService:"lspnix",serverError:d.error});if(M&&N[e]){G.push(E.onCommand(function(t){t.state===l.api.State.Stopped&&(u.logger.error("LSP server unexpectedly disconnected",{lspId:e,appService:"lspnix"}),H(),M&&U(e,i,W))}));var $=0;(function e(t,r){return(0,n._)(function(){var n;return(0,o._)(this,function(i){switch(i.label){case 0:return[4,t.exec("pwd")];case 1:if(null!==(n=i.sent()).error){if(!r())return[2,{error:Error("LSPNix: Could not get working directory "+n.error),workingDirectory:null}];return[2,e(t,r)]}return[2,{error:null,workingDirectory:n.output.replace("\n","")}]}})})()})(t,function(){return $++<5&&M&&A(N[e].option,L)&&"open"===E.status}).then(function(t){if(!N[e])return void u.logger.info("LSPNix: lsp map changed while getting working directory",{lspId:e,appService:"lspnix"});if(!A(N[e].option,L))return void u.logger.info("LSPNix: configuration changed while getting working directory",{lspId:e,appService:"lspnix"});if("open"!==E.status)return void u.logger.error("LSPNix: channel wasn't open after getting working directory",{lspId:e,appService:"lspnix"});if(t.error)return void u.logger.error("LSPNix: failed to get working directory",{lspId:e,appService:"lspnix",originalError:null==(d=t.error)?void 0:d.message});if(F=function(e){var t,r=e.connection,i=e.isSupportedFile,s=e.clientId,l=e.clientName,c=e.getWorkspaceConfiguration,d=e.onWorkspaceConfigurationChange,b=e.applyWorkspaceEdit,E=(0,w.default)();E.setMaxListeners(1/0);var A=null,P=j.ServerState.OFFLINE,D=j.ServerHealth.NOT_READY,O=null,N=!1,M=new Map,L=new Map,B=null;function V(e){if(!A)throw Error("Expected rootUri");var t=e.slice(A.length+1);try{return decodeURIComponent(t)}catch(e){throw m.withScope(function(n){n.setExtra("fragment_to_decode",t),m.captureException(e)}),e}}function F(e){if(!A)throw Error("Expected rootUri");if(e.startsWith("/"))throw Error("Path must be relative. Got: ".concat(e));return A+"/"+e}function U(e){P!==e&&(P!==j.ServerState.INITIALIZED&&G(j.ServerHealth.NOT_READY),P=e,E.emit("SERVER_STATE_CHANGE",P))}function G(e){D!==e&&(D=e,E.emit("SERVER_HEALTH_CHANGE",D))}function $(e){E.emit("SEND_NOTIFICATION",e),r.write(I(e))}function z(e){return(0,n._)(function(){var t,n,i,a,l,c,d,g;return(0,o._)(this,function(o){if(a=void 0===(i=(n=void 0===(t=e.options)?{}:t).id)?R():i,l=n.signal,c=n.tap,d=(0,h._)(e,["options"]),!Number.isInteger(a))throw Error("Request ID must be an integer");return r.didClose()?[2,Promise.resolve({result:null,cancelled:!0})]:(E.emit("REQUEST",{id:a,data:d}),null==l||l.addEventListener("abort",function(){W(a)},{once:!0}),r.write(I((0,p._)((0,f._)({},d),{id:a}))),null===B&&(B=setTimeout(function(){G(j.ServerHealth.STALLED)},3e4)),g=new Promise(function(e){L.set(a,{requestData:d,resolve:e})}),c&&c(g),[2,g.then(function(e){null!==B&&(clearTimeout(B),B=null),P!==j.ServerState.INITIALIZED||e.cancelled||G(j.ServerHealth.READY);var t=(0,C.getQuirkHandler)(s).onResponse(d.method,e);if("error"in t){var n=t.error,r=n.code,i=n.message,o=n.data;u.logger.error("LSP request failed",{code:r,lspId:s,errorMessage:i,data:JSON.stringify(o),requestData:d})}return t})])})})()}function H(e,t){r.write(I((0,p._)((0,f._)({},t),{id:e})))}function W(e){var t=L.get(e);t&&(E.emit("CANCEL_REQUEST",e),t.resolve({result:null,cancelled:!0}),L.delete(e),$({method:"$/cancelRequest",params:{id:e}}))}var q=0,K=new S.MessageReader(function(e){var t=L.get(e.id);if(e.id&&t){var n=t.resolve;L.delete(e.id);var r=e.result,i=e.error;if((void 0!==r||i)&&E.emit("RESPONSE",e),void 0!==r){q=0,n({result:r,cancelled:!1});return}if(i){q++,n({error:i}),q>20&&(u.logger.error("LSP experienced 20 consecutive errors. Setting server health to 'BROKEN",{lspId:s}),G(j.ServerHealth.BROKEN),q=0);return}throw u.logger.error("LSP response message contained neither error nor result"),new k.default("Expected either message or error in LSP response").setExtra("message",JSON.stringify(e))}var o=e.method;if("client/registerCapability"===o){var l=e.params.registrations;if(!l||!Array.isArray(l))throw Error("Expected registrations array");l.forEach(function(e){var t=e.method;if(!t)throw Error("Expected registration method");if(!O)throw Error("Expected server capabilities");var n=e.registerOptions||!0;switch(t){case"textDocument/definition":O.definitionProvider=!0;break;case"textDocument/typeDefinition":O.typeDefinitionProvider=!0;break;case"textDocument/implementation":O.implementationProvider=!0;break;case"textDocument/references":O.referencesProvider=!0;break;case"textDocument/hover":O.hoverProvider=!0;break;case"textDocument/semanticTokens":O.semanticTokensProvider=n;break;case"textDocument/completion":O.completionProvider=n;break;case"textDocument/formatting":O.documentFormattingProvider=n;break;case"textDocument/rename":O.renameProvider=n;break;case"textDocument/codeAction":O.codeActionProvider=n;break;case"textDocument/signatureHelp":O.signatureHelpProvider=n;break;case"textDocument/didSave":if("number"==typeof O.textDocumentSync)break;O.textDocumentSync=(0,p._)((0,f._)({},O.textDocumentSync||{}),{save:n});break;case"textDocument/willSaveWaitUntil":if("number"==typeof O.textDocumentSync)break;O.textDocumentSync=(0,p._)((0,f._)({},O.textDocumentSync||{}),{willSave:!0});break;case"textDocument/didChange":if("number"==typeof O.textDocumentSync)break;O.textDocumentSync=(0,p._)((0,f._)({},O.textDocumentSync||{}),{change:n});break;case"textDocument/didOpen":case"textDocument/didClose":if("number"==typeof O.textDocumentSync)break;O.textDocumentSync=(0,p._)((0,f._)({},O.textDocumentSync||{}),{openClose:!0});break;case"workspace/executeCommand":O.executeCommandProvider=n;break;default:u.logger.info("Unexpected dynamically registered capability in LSP client",{method:t})}E.emit("SERVER_CAPABILITIES_CHANGE",O)}),H(e.id,{result:null,cancelled:!1});return}if("workspace/applyEdit"===o)return void b(e.params).then(function(t){H(e.id,{result:t,cancelled:!1})});if("textDocument/publishDiagnostics"===o){var d=V(e.params.uri),h=M.get(d);if(!h)return;var g=e.params.diagnostics;if((0,a.default)(h.diagnostics,g))return;h.diagnostics=g,E.emit("DIAGNOSTICS",{path:d,diagnostics:g});return}if("workspace/configuration"===o){var m,y=e.params,w=Array(y.items.length).fill(null),_=null!=(m=null==c?void 0:c())?m:null;_&&(w=y.items.map(function(e){return e.section?(0,x.default)(_,e.section):_})),H(e.id,{result:w,cancelled:!1})}("window/logMessage"===o||"telemetry/event"===o)&&E.emit("RECEIVE_NOTIFICATION",e),"workspace/semanticTokens/refresh"===o&&E.emit("SEMANTIC_TOKENS_REFRESH")});function Y(e){if(!O)throw Error("Expected client to be initialized");if(!O[e])throw Error("LSP Server does not support ".concat(e.replace(/Provider$/,"")));return O[e]}function Q(e){return A&&e?e.filter(function(e){return"uri"in e?e.uri.startsWith(A):e.targetUri.startsWith(A)}):e}r.read(K.read);var X=function(){};return{initialize:function(e){return(0,n._)(function(e){var n,r,i,a;return(0,o._)(this,function(o){switch(o.label){case 0:return n=e.pwd,r=e.initializationOptions,U(j.ServerState.INITIALIZING),A="file://".concat(n),[4,z({method:"initialize",params:{initializationOptions:r,capabilities:(0,_.createClientCapabilities)({configurationSupport:{serverToClient:!!c,clientToServer:!!d}}),processId:null,rootUri:A,workspaceFolders:[{name:A,uri:A}]}})];case 1:if("error"in(i=o.sent()))throw Error("Something went wrong initializing the LSP client: ".concat(i.error.message));if(i.cancelled)throw Error("Initialize request cancelled");if(!i.result)throw Error("Expected result in initialize request");return $({method:"initialized",params:{}}),O=i.result.capabilities,t=i.result.serverInfo,E.emit("SERVER_CAPABILITIES_CHANGE",O),U(j.ServerState.INITIALIZED),d&&(X=d(function(e){$({method:"workspace/didChangeConfiguration",params:{settings:e}})})),c&&(a=c())&&$({method:"workspace/didChangeConfiguration",params:{settings:a}}),[2]}})}).apply(this,arguments)},generateId:R,notify:{didOpen:function(e,t){if(!i(e))throw Error("Path not supported");var n,r=M.get(e);if(r&&0!==r.buffers){r.buffers++,M.set(e,r);return}var o=null!=(n=null==r?void 0:r.version)?n:0;M.set(e,{version:o,buffers:1,diagnostics:[]}),$({method:"textDocument/didOpen",params:{textDocument:{uri:F(e),languageId:T(e,s),text:t,version:o}}})},didChange:function(e,t){var n=M.get(e);if(!n)throw Error('Document for "'.concat(e,'" is not open'));n.version++,$({method:"textDocument/didChange",params:{textDocument:{uri:F(e),version:n.version},contentChanges:t}})},didSave:function(e){if(!M.get(e))throw Error('Document for "'.concat(e,'" is not open'));Y("textDocumentSync"),$({method:"textDocument/didSave",params:{textDocument:{uri:F(e)}}})},didClose:function(e){var t=M.get(e);if(!t)throw Error('Document for "'.concat(e,'" is not open'));t.buffers--,t.buffers>0||($({method:"textDocument/didClose",params:{textDocument:{uri:F(e)}}}),M.delete(e))},cancelRequest:function(e){W(e)}},request:{completion:function(e,t,n,r){return Y("completionProvider"),z({options:r,method:"textDocument/completion",params:{textDocument:{uri:F(e)},position:t,context:n}})},resolveCompletionItem:function(e){if(!Y("completionProvider").resolveProvider)throw Error("LSP Server does not support resolving completion items");return z({method:"completionItem/resolve",params:e})},signatureHelp:function(e,t,n){return z({options:n,method:"textDocument/signatureHelp",params:{textDocument:{uri:F(e)},position:t}})},hover:function(e,t,n){return z({options:n,method:"textDocument/hover",params:{textDocument:{uri:F(e)},position:t}})},codeActions:function(e,t,n,r){var i=M.get(e);if(!i)throw Error("Document for path ".concat(e," is not open."));var o=i.diagnostics.filter(function(e){return(0,y.isOverlapping)(e.range,t)});return z({method:"textDocument/codeAction",params:{textDocument:{uri:F(e)},range:t,context:(0,p._)((0,f._)({},r),{diagnostics:o})},options:n})},resolveCodeAction:function(e){return z({method:"codeAction/resolve",params:e})},executeCommand:function(e,t){return z({method:"workspace/executeCommand",params:{command:e,arguments:t}})},format:function(e,t){return Y("documentFormattingProvider"),z({method:"textDocument/formatting",params:{textDocument:{uri:F(e)},options:t}})},formatRange:function(e,t,n){return Y("documentRangeFormattingProvider"),z({method:"textDocument/rangeFormatting",params:{textDocument:{uri:F(e)},range:t,options:n}})},findDefinitions:function(e,t,r){var i=!(arguments.length>3)||void 0===arguments[3]||arguments[3];return(0,n._)(function(){var n,a;return(0,o._)(this,function(o){switch(o.label){case 0:return Y("definitionProvider"),[4,z({options:r,method:"textDocument/definition",params:{textDocument:{uri:F(e)},position:t}})];case 1:if(!1!==(n=o.sent()).cancelled)return[2,n];return(a=n.result)&&i&&(a=Q(Array.isArray(a)?a:[a])),[2,(0,p._)((0,f._)({},n),{result:a})]}})})()},findTypeDefinitions:function(e,t,r){var i=!(arguments.length>3)||void 0===arguments[3]||arguments[3];return(0,n._)(function(){var n,a;return(0,o._)(this,function(o){switch(o.label){case 0:return Y("typeDefinitionProvider"),[4,z({options:r,method:"textDocument/typeDefinition",params:{textDocument:{uri:F(e)},position:t}})];case 1:if(!1!==(n=o.sent()).cancelled)return[2,n];return(a=n.result)&&i&&(a=Q(Array.isArray(a)?a:[a])),[2,(0,p._)((0,f._)({},n),{result:a})]}})})()},findImplementations:function(e,t,r){var i=!(arguments.length>3)||void 0===arguments[3]||arguments[3];return(0,n._)(function(){var n,a;return(0,o._)(this,function(o){switch(o.label){case 0:return Y("implementationProvider"),[4,z({options:r,method:"textDocument/implementation",params:{textDocument:{uri:F(e)},position:t}})];case 1:if(!1!==(n=o.sent()).cancelled)return[2,n];return(a=n.result)&&i&&(a=Q(Array.isArray(a)?a:[a])),[2,(0,p._)((0,f._)({},n),{result:a})]}})})()},findReferences:function(e,t,n){return Y("referencesProvider"),z({method:"textDocument/references",params:{textDocument:{uri:F(e)},position:t,context:n}})},rename:function(e,t,n,r){return Y("renameProvider"),z({options:r,method:"textDocument/rename",params:{textDocument:{uri:F(e)},position:t,newName:n}})},prepareRename:function(e,t){var n=Y("renameProvider");if("boolean"==typeof n||!n.prepareProvider)throw Error("LSP server does not support prepare rename");return z({method:"textDocument/prepareRename",params:{textDocument:{uri:F(e)},position:t}})},documentHighlights:function(e,t,r){return(0,n._)(function(){return(0,o._)(this,function(n){switch(n.label){case 0:return[4,z({options:r,method:"textDocument/documentHighlight",params:{position:t,textDocument:{uri:F(e)}}})];case 1:return[2,n.sent()]}})})()},documentSymbol:function(e,t){return(0,n._)(function(){var n;return(0,o._)(this,function(r){switch(r.label){case 0:return[4,z({options:t,method:"textDocument/documentSymbol",params:{textDocument:{uri:F(e)}}})];case 1:if(!("result"in(n=r.sent())))return[2,n];if(n.result)return[2,{result:n.result,cancelled:!1}];return[2]}})})()}},semanticTokensFull:function(e,t){if(!Y("semanticTokensProvider").full)throw Error("LSP server does not support full semantic tokens");return z({options:t,method:"textDocument/semanticTokens/full",params:{textDocument:{uri:F(e)}}})},semanticTokensDelta:function(e,t,n){var r=Y("semanticTokensProvider");if(!(null==r?void 0:r.full)||"object"!==(0,g._)(r.full)||!r.full.delta)throw Error("LSP server does not support delta semantic tokens");return z({options:n,method:"textDocument/semanticTokens/full/delta",params:{textDocument:{uri:F(e)},previousResultId:t}})},semanticTokensRange:function(e,t,n){if(!Y("semanticTokensProvider").range)throw Error("LSP server does not support range semantic tokens");return z({options:n,method:"textDocument/semanticTokens/range",params:{textDocument:{uri:F(e)},range:t}})},onDiagnostics:(0,w.createAddListener)(E,"DIAGNOSTICS"),onServerStateChange:(0,w.createAddListener)(E,"SERVER_STATE_CHANGE"),onServerHealthChange:(0,w.createAddListener)(E,"SERVER_HEALTH_CHANGE"),onServerCapabilitiesChange:(0,w.createAddListener)(E,"SERVER_CAPABILITIES_CHANGE"),onRequest:(0,w.createAddListener)(E,"REQUEST"),onResponse:(0,w.createAddListener)(E,"RESPONSE"),onCancelRequest:(0,w.createAddListener)(E,"CANCEL_REQUEST"),onSendNotification:(0,w.createAddListener)(E,"SEND_NOTIFICATION"),onReceiveNotification:(0,w.createAddListener)(E,"RECEIVE_NOTIFICATION"),onSemanticTokensRefresh:(0,w.createAddListener)(E,"SEMANTIC_TOKENS_REFRESH"),shutdown:function(){for(var e in U(j.ServerState.EXITING),M.clear(),L)W(Number(e));X(),z({method:"shutdown"}).then(function(){$({method:"exit"}),U(j.ServerState.EXITED),E.removeAllListeners()})},isDestroyed:function(){return N},destroy:function(){for(var e in N=!0,M.clear(),L)W(Number(e));X(),U(j.ServerState.EXITED),E.removeAllListeners()},getServerState:function(){return P},getServerHealth:function(){return D},getServerCapabilities:function(){return O},getServerInfo:function(){return t},getDiagnostics:function(e){var t=M.get(e);if(!t)throw Error("File with path ".concat(e," is not open."));return t.diagnostics},isOpen:function(e){return M.has(e)},documentUriToPath:V,pathToDocumentURI:F,isSupportedFile:i,getLanguageId:function(e){return T(e,s)},clientId:s,clientName:l}}({connection:{read:function(e){"open"===E.status&&E.onCommand(function(t){t.output&&e(t.output)})},write:function(e){if("open"!==E.status){(null==F?void 0:F.isDestroyed())&&u.logger.error("LSPNix: tried to write to channel but the lsp client is already destroyed");return}E.send({input:e})},didClose:function(){return"open"!==E.status}},clientId:e,clientName:N[e].option.name,isSupportedFile:function(e){return(0,s.isFileSupported)(e,L)},applyWorkspaceEdit:function(e){var t=e.edit;return(0,n._)(function(){return(0,o._)(this,function(e){return F?[2,(0,c.applyWorkspaceEdit)({edit:t,fs:b,client:F})]:[2,{applied:!1}]})})()},getWorkspaceConfiguration:function(){if(!(null==(e=L.config)?void 0:e.configurationJson))return null;var e,t=null;try{t=JSON.parse(L.config.configurationJson)}catch(e){u.logger.error("Failed to parse LSP workspace configuration",{configurationJson:L.config.configurationJson})}return t}}),null==(l=L.config)?void 0:l.initializationOptionsJson)try{$=JSON.parse(L.config.initializationOptionsJson)}catch(e){u.logger.error("Failed to parse LSP initializationOptions",{initializationOptionsJson:L.config.initializationOptionsJson})}var l,d,$,z=F.initialize({pwd:t.workingDirectory,initializationOptions:$}).catch(function(t){if((null==t?void 0:t.message)!=="Initialize request cancelled")throw u.logger.error("LSPNix: failed to initialize client",{lspId:e,appService:"lspnix",originalError:null==t?void 0:t.message}),t});G.push(F.onServerHealthChange(function(t){if(t===j.ServerHealth.BROKEN&&(u.logger.info("LSP: Server health broken",{lspId:e}),H(),M)){u.logger.info("LSP: retrying after server health broken",{lspId:e}),U(e,i,W);return}}),F.onServerStateChange(function(t){return(0,n._)(function(){var n,i,a,l,c,d,f,p,h,g,m,x,y,b,w;return(0,o._)(this,function(o){switch(o.label){case 0:if("open"!==E.status)return u.logger.info("LSPNix: channel wasn't open on state change",{lspId:e,appService:"lspnix",state:t}),H(),[2];if(!F)return u.logger.info("LSPNix: client was null on state change. This should never happen",{lspId:e,appService:"lspnix",state:t}),H(),[2];if(!A(N[e].option,L))return u.logger.info("LSPNix: configuration changed and received state change",{lspId:e,appService:"lspnix",state:t}),H(),[2];if(t===j.ServerState.EXITED)return u.logger.info("LSP server exited via 'exit' notification",{lspId:e,appService:"lspnix"}),H(),[2];if(t!==j.ServerState.INITIALIZED)return[2];return[4,z];case 1:if(o.sent(),"open"!==E.status)return u.logger.info("LSPNix: channel wasn't open after initialization",{lspId:e,appService:"lspnix"}),H(),[2];B(F),V.delete(e),N[e].client=F,n=!0,i=!1,a=void 0;try{for(l=D[Symbol.iterator]();!(n=(c=l.next()).done);n=!0)if((f=(d=(0,r._)(c.value,2))[0],p=d[1],(0,s.isFileSupported)(f,L))&&(h=O.get(f),P||!h||!h.size)){g=h?h.add(F):new Set([F]),O.set(f,g),m=!0,x=!1,y=void 0;try{for(b=p[Symbol.iterator]();!(m=(w=b.next()).done);m=!0)(0,w.value)(Array.from(g))}catch(e){x=!0,y=e}finally{try{m||null==b.return||b.return()}finally{if(x)throw y}}}}catch(e){i=!0,a=e}finally{try{n||null==l.return||l.return()}finally{if(i)throw a}}return[2]}})})()}))})}}),function(e){H(e.willReconnect)}}),N[e].closeChannel=$,[2]}})})()}function $(e){var t=null==e?void 0:e.languageServers;if(!t||0===t.length){var n=!0,r=!1,i=void 0;try{for(var o,a=Object.keys(N)[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var s=o.value;L(s)}}catch(e){r=!0,i=e}finally{try{n||null==a.return||a.return()}finally{if(r)throw i}}return}var l={},u=!0,c=!1,d=void 0;try{for(var f,p=t[Symbol.iterator]();!(u=(f=p.next()).done);u=!0){var h=f.value;l[h.id]=h}}catch(e){c=!0,d=e}finally{try{u||null==p.return||p.return()}finally{if(c)throw d}}var g=!0,m=!1,x=void 0;try{for(var y,b=Object.keys(N)[Symbol.iterator]();!(g=(y=b.next()).done);g=!0){var w=y.value;l[w]||L(w)}}catch(e){m=!0,x=e}finally{try{g||null==b.return||b.return()}finally{if(m)throw x}}var k=!0,_=!1,S=void 0;try{for(var C,j=Object.keys(l)[Symbol.iterator]();!(k=(C=j.next()).done);k=!0){var T=C.value,E=N[T],R=l[T];if(!E){B(T,R);continue}A(E.option,R)||(L(T),B(T,R))}}catch(e){_=!0,S=e}finally{try{k||null==j.return||j.return()}finally{if(_)throw S}}}return(0,n._)(function(){var e;return(0,o._)(this,function(t){try{e=d.configs.current,$(e),d.configs.subscribe($)}catch(e){u.logger.error("LSP initialization failed: "+e.message)}return[2]})})(),{restart:function(e){if(M){var t=N[e];if(t){if(t.client){var n=!0,i=!1,o=void 0;try{for(var a,s,l=D[Symbol.iterator]();!(n=(s=l.next()).done);n=!0){var u=(0,r._)(s.value,2),c=u[0],d=u[1],f=O.get(c);if(f){f.delete(t.client),O.set(c,f);var p=!0,h=!1,g=void 0;try{for(var m,x=d[Symbol.iterator]();!(p=(m=x.next()).done);p=!0)(0,m.value)(Array.from(f))}catch(e){h=!0,g=e}finally{try{p||null==x.return||x.return()}finally{if(h)throw g}}}}}catch(e){i=!0,o=e}finally{try{n||null==l.return||l.return()}finally{if(i)throw o}}}t.closeChannel(),null==(a=t.client)||a.destroy(),t.client=null,G(e)}}},disable:function(){if(M){M=!1;var e=!0,t=!1,n=void 0;try{for(var i,o=Object.values(N)[Symbol.iterator]();!(e=(i=o.next()).done);e=!0){var a=i.value;a.closeChannel(),null==(c=a.client)||c.destroy(),a.client=null;var s=!0,l=!1,u=void 0;try{for(var c,d,f=D[Symbol.iterator]();!(s=(d=f.next()).done);s=!0){var p=(0,r._)(d.value,2),h=p[0],g=p[1];if(O.has(h)){O.delete(h);var m=!0,x=!1,y=void 0;try{for(var b,w=g[Symbol.iterator]();!(m=(b=w.next()).done);m=!0)(0,b.value)([])}catch(e){x=!0,y=e}finally{try{m||null==w.return||w.return()}finally{if(x)throw y}}}}}catch(e){l=!0,u=e}finally{try{s||null==f.return||f.return()}finally{if(l)throw u}}}}catch(e){t=!0,n=e}finally{try{e||null==o.return||o.return()}finally{if(t)throw n}}}},enable:function(){if(!M){M=!0;var e=!0,t=!1,n=void 0;try{for(var r,i=Object.keys(N)[Symbol.iterator]();!(e=(r=i.next()).done);e=!0){var o=r.value;G(o)}}catch(e){t=!0,n=e}finally{try{e||null==i.return||i.return()}finally{if(t)throw n}}}},onClient:function(e,t){D.has(e)||D.set(e,[]),null==(c=D.get(e))||c.push(t);var n=!1,r=[],o=O.get(e);if(o&&o.size)r.push.apply(r,(0,i._)(Array.from(o)));else{var a=!0,l=!1,u=void 0;try{for(var c,d,f=Object.values(N)[Symbol.iterator]();!(a=(d=f.next()).done);a=!0){var p=d.value;if((0,s.isFileSupported)(e,p.option)&&p.client&&(r.push(p.client),!P))break}}catch(e){l=!0,u=e}finally{try{a||null==f.return||f.return()}finally{if(l)throw u}}}return Promise.resolve().then(function(){!n&&r.length&&t(r)}),function(){n=!0;var r,i=null!=(r=D.get(e))?r:[];D.set(e,i.filter(function(e){return e!==t}))}}}}e.s(["createLSPNixService",()=>P],886383)},61200,e=>{"use strict";var t,n=e.i(297083),r=e.i(817556),i=e.i(992785),o=e.i(866408),a=e.i(205104),s=e.i(346715),l=e.i(626430),u=((t={}).USER_JOIN="USER_JOIN",t.USER_LEAVE="USER_LEAVE",t.USERS_UPDATE="USERS_UPDATE",t.USER_OPENED_FILE="USER_OPENED_FILE",t.FOLLOWED_USER_CHANGED="FOLLOWED_USER_CHANGED",t.FOLLOWING_USERS_CHANGED="FOLLOWING_USERS_CHANGED",t),c=e.i(520839);function d(e){var t=e.container,d=e.onCommand,f=e.getColorForUser,p=(0,o.default)();p.setMaxListeners(1/0);var h=[],g=null,m=[],x={},y=null;function b(){return(0,n._)(function(){return(0,r._)(this,function(e){return y?[2,y]:[2,new Promise(function(e){p.once(u.USERS_UPDATE,function(){if(!y)throw Error("Expected presenceChannel to be set");e(y)})})]})})()}function w(e){(0,i.default)(g,e)||(g=e,p.emit(u.FOLLOWED_USER_CHANGED,e))}function k(){return(0,n._)(function(){var e,t;return(0,r._)(this,function(n){switch(n.label){case 0:if(!g)throw Error("No user to unfollow");return e=g,w(null),[4,b()];case 1:return t=n.sent(),e.sessions.forEach(function(e){t.send({unfollowUser:{session:e.id}})}),[2]}})})()}return t.openChannel({service:"presence",name:"presencer"},function(e){var t=e.channel;return t.onCommand(function(e){null==d||d(e);var t={cmd:e,emitter:p,activeUsers:h,userIdToFile:x,followedUser:g,setFollowedUser:w,followingUsers:m,getColorForUser:f};switch(e.body){case"roster":!function(e){var t=e.cmd,n=e.emitter,r=e.activeUsers,i=e.userIdToFile,o=e.followedUser,a=e.followingUsers,l=e.setFollowedUser,d=e.getColorForUser,f=t.roster;if(f){var p=f.user,h=f.files;if(p&&h){var g=new Set;if(r.splice(0,r.length),p.forEach(function(e){if(e.id&&e.name&&e.roles&&!g.has(e.id)){var t=h.filter(function(t){return t.userId===e.id}).map(function(e){if(!e.session||!e.timestamp)throw Error("Expected session and associated with user");return{id:e.session,activeFile:e.file||null,timestamp:(0,c.convertTimestampToNumber)(e.timestamp)}}),n=null==d?void 0:d({userId:e.id});r.push({id:e.id,username:e.name,roles:e.roles,color:null!=n?n:(0,c.getLeastUsedColor)(r),sessions:t}),g.add(e.id)}}),r.forEach(function(e){i[e.id]=(0,c.getActiveFileForUser)(e)}),n.emit(u.USERS_UPDATE,(0,s._)(r)),a.filter(function(e){return!r.some(function(t){return t.id===e.id})}).forEach(function(e){var t=a.indexOf(e);-1!==t&&(a.splice(t,1),n.emit(u.FOLLOWING_USERS_CHANGED,{followingUsers:(0,s._)(a),user:e,type:"unfollow"}))}),o){if(!r.some(function(e){return e.id===o.id}))return l(null);var m=i[o.id];n.emit(u.USER_OPENED_FILE,{user:o,file:m})}}}}(t);break;case"join":!function(e){var t=e.cmd,n=e.emitter,r=e.activeUsers,i=e.userIdToFile,o=e.getColorForUser,a=t.join;if(a.id&&a.name&&a.roles&&a.session){var d=r.find(function(e){return e.id===a.id}),f=Math.floor(Date.now()/1e3),p=l.google.protobuf.Timestamp.create({seconds:f}),h=(0,c.convertTimestampToNumber)(p);if(d)d.sessions.push({id:a.session,activeFile:null,timestamp:h});else{var g=null==o?void 0:o({userId:a.id}),m={id:a.id,username:a.name,roles:a.roles,color:null!=g?g:(0,c.getLeastUsedColor)(r),sessions:[{id:a.session,activeFile:null,timestamp:h}]};i[a.id]=null,r.push(m),n.emit(u.USER_JOIN,m),n.emit(u.USERS_UPDATE,(0,s._)(r))}}}(t);break;case"part":!function(e){var t=e.cmd,n=e.emitter,r=e.activeUsers,i=e.userIdToFile,o=e.followedUser,a=e.followingUsers,l=e.setFollowedUser;if(t.part&&t.part.id&&t.part.session){var d=t.part,f=d.id,p=d.session,h=r.findIndex(function(e){return e.id===f}),g=r[h];if(1===g.sessions.length){r.splice(h,1),delete i[g.id],n.emit(u.USER_LEAVE,g),n.emit(u.USERS_UPDATE,(0,s._)(r)),o&&l(null);var m=a.findIndex(function(e){return e.id===g.id});-1!==m&&(a.splice(m,1),n.emit(u.FOLLOWING_USERS_CHANGED,{followingUsers:(0,s._)(a),user:g,type:"unfollow"}))}else{g.sessions=g.sessions.filter(function(e){return e.id!==p});var x=(0,c.getActiveFileForUser)(g);i[g.id]!==x&&(i[g.id]=x,n.emit(u.USER_OPENED_FILE,{user:g,file:x}))}}}(t);break;case"fileOpened":!function(e){var t=e.emitter,n=e.cmd,r=e.activeUsers,i=e.userIdToFile;if(n.fileOpened){var o=n.fileOpened,a=o.userId,s=o.file,l=o.timestamp,d=o.session,f=s||null;if(!a||!l)throw Error("Expected userId and timestamp associated with file opened command");var p=r.find(function(e){return e.id===a});if(!p)throw Error("Expected user with ID ".concat(a));var h=p.sessions.find(function(e){return e.id===d});if(!h)throw Error("Expected session with ID ".concat(h));h.activeFile=f,h.timestamp=(0,c.convertTimestampToNumber)(l),i[a]=f,t.emit(u.USER_OPENED_FILE,{user:p,file:f})}}(t);break;case"followUser":!function(e){var t=e.cmd,n=e.emitter,r=e.activeUsers,i=e.followingUsers,o=t.followUser;if(!o.session)throw Error("Expected session associated with follow user");var a=o.session,l=(0,c.getUserForSession)(a,r);i.some(function(e){return e.id===l.id})||(i.push(l),n.emit(u.FOLLOWING_USERS_CHANGED,{followingUsers:(0,s._)(i),user:l,type:"follow"}))}(t);break;case"unfollowUser":!function(e){var t=e.cmd,n=e.emitter,r=e.activeUsers,i=e.followingUsers,o=t.unfollowUser;if(!o.session)throw Error("Expected session associated with follow user");var a=o.session,l=(0,c.getUserForSession)(a,r),d=i.findIndex(function(e){return e.id===l.id});-1!==d&&(i.splice(d,1),n.emit(u.FOLLOWING_USERS_CHANGED,{followingUsers:(0,s._)(i),user:l,type:"unfollow"}))}(t);break;case"sessionTimestampUpdated":!function(e){var t=e.cmd,n=e.emitter,r=e.activeUsers,i=e.userIdToFile,o=t.sessionTimestampUpdated;if(!o.session||!o.timestamp)throw Error("Expected session and tiemstamp associated with update");var a=o.session,s=(0,c.getUserForSession)(a,r),l=i[s.id],d=s.sessions.find(function(e){return e.id===a});if(!d)throw Error("Expected user ".concat(s.id," to have a session with ID ").concat(a));d.timestamp=(0,c.convertTimestampToNumber)(o.timestamp);var f=d.activeFile;f!==l&&(i[s.id]=f,n.emit(u.USER_OPENED_FILE,{user:s,file:f}))}(t)}}),y=t,function(){y=null}}),{onUserLeave:function(e){return p.on(u.USER_LEAVE,e),function(){p.removeListener(u.USER_LEAVE,e)}},onUserJoin:function(e){return p.on(u.USER_JOIN,e),function(){p.removeListener(u.USER_LEAVE,e)}},onActiveUsersChange:function(e){return p.on(u.USERS_UPDATE,e),function(){p.removeListener(u.USERS_UPDATE,e)}},onUserOpenedFile:function(e){return p.on(u.USER_OPENED_FILE,e),function(){p.removeListener(u.USER_OPENED_FILE,e)}},onFollowedUserChanged:function(e){return p.on(u.FOLLOWED_USER_CHANGED,e),function(){p.removeListener(u.FOLLOWED_USER_CHANGED,e)}},onFollowingUsersChanged:function(e){return p.on(u.FOLLOWING_USERS_CHANGED,e),function(){p.removeListener(u.FOLLOWING_USERS_CHANGED,e)}},getActiveFileForUser:function(e){var t=x[e];if(void 0===t)throw Error("Expected file for user with ID ".concat(e," to be defined"));return t},updateOpenFile:function(e){return(0,n._)(function(){return(0,r._)(this,function(t){switch(t.label){case 0:return[4,b()];case 1:return t.sent().send({openFile:{file:e}}),[2]}})})()},updateSessionTimestamp:function(){return(0,n._)(function(){return(0,r._)(this,function(e){switch(e.label){case 0:return[4,b()];case 1:return e.sent().send({updateSessionTimestamp:{}}),[2]}})})()},followUser:function(e){return(0,n._)(function(){var t,n;return(0,r._)(this,function(r){switch(r.label){case 0:if((null==g?void 0:g.username)===e)throw Error("Already following user with username ".concat(e));if(!g)return[3,2];return[4,k()];case 1:r.sent(),r.label=2;case 2:return[4,b()];case 3:if(t=r.sent(),!(n=h.find(function(t){return t.username===e})))return[2];return w(n),n.sessions.forEach(function(e){t.send({followUser:{session:e.id}})}),[2]}})})()},unfollowUser:k,getActiveUsers:function(){return h},getFollowedUser:function(){return g},getFollowingUsers:function(){return m},getUserIdToFile:function(){return x},getPathToUserIds:function(){var e=new Map;return h.forEach(function(t){var n=t.id,r=x[n];r&&function t(n,r){if(""!==n){e.has(n)||e.set(n,[]);var i,o=e.get(n);if(!o)throw Error("Expected user Ids");o.some(function(e){return e===r})||(null==(i=e.get(n))||i.push(r),t((0,a.getParentPath)(n),r))}}(r,n)}),e}}}e.s(["default",()=>d],61200)},508545,e=>{"use strict";var t=e.i(878420),n=e.i(64386),r=e.i(530658),i=e.i(389959),o=e.i(231693),a=e.i(104375),s=e.i(19004),l=e.i(416558),u=e.i(17609),c=e.i(336777),d=e.i(748855),f=e.i(858248),p=e.i(792e3),h=e.i(534518),g=e.i(354507),m=e.i(886383),x=e.i(801127),y=e.i(61200),b=e.i(752394);e.i(242933);var w=e.i(790164),k=e.i(297083),_=e.i(721281),S=e.i(817556),C=e.i(906368),j=e.i(935835),T=e.i(709485);function E(e){var E=(0,r._)((0,i.useState)(null),2),R=E[0],I=E[1];return(0,i.useEffect)(function(){var i,E,R,A,P,D,O,N,M,L,B,V,F,U,G,$,z,H,W,q,K,Y,Q,X,J,Z=function(e){var t=o.context.active();if(e.openTelemetryTracing)return(0,a.createSpanFromContext)(t,"workspace.useCreateServices")}(e),ee=(E=(i=(0,n._)((0,t._)({},e),{ctx:null==Z?void 0:Z.childCtx})).onUnrecoverableError,R=i.openMultipleFiles,A=i.openMultipleURLs,P=i.enableMultipleLSPClientsPerFile,D=i.enableReplspaceSshTokenPassthrough,O=i.onPresenceCommand,N=i.getColorForUser,M=i.openTelemetryTracing,L=i.ctx,B=(0,p.default)({onUnrecoverableError:E,ctx:L}),V=(0,h.default)({container:B}),F=(0,y.default)({container:B,onCommand:O,getColorForUser:N}),U=(0,s.default)({container:B,fs:V,ctx:L}),G=(0,l.default)({container:B}),$=(0,d.default)({container:B,dotReplit:U}),z=(0,u.default)({container:B,forceTrace:M,track:f.track}),H=(0,b.default)({container:B,fs:V,openMultipleFiles:R,openMultipleURLs:A,enableReplspaceSshTokenPassthrough:D}),W=(0,x.createPortsService)({container:B,dotReplit:U}),q=(0,m.createLSPNixService)({container:B,toolchain:$,fs:V,enableMultipleLSPClientsPerFile:void 0!==P&&P}),K=(0,g.default)({container:B,fs:V}),Y=(0,c.default)({container:B,toolchain:$}),X=(Q={container:B}).container,J=Q.sendTrackingEvents,{presence:F,packager:z,container:B,fs:V,dotReplit:U,nixService:G,lspnix:q,git:K,psql:Y,replspaceApi:H,toolchain:$,ports:W,secrets:function(e){var i,o=e.container,a=e.observable,s=e.track,l=new Promise(function(e){return i=e});function u(e){return(0,k._)(function(){var t,n;return(0,S._)(this,function(r){switch(r.label){case 0:return[4,l];case 1:return t=r.sent(),a.set(Array.isArray(e)?new Map(e.map(function(e){return[e.key,e.value]})):e),[4,t.request({secretsSetRequest:{contents:j.default.serialize(a.current)}})];case 2:if((n=r.sent()).error)throw Error(n.error);return null==s||s(T.events.SECRETS_USED,{action:"replaceAll"}),[2]}})})()}return o.openChannel({service:"secrets",name:"secretser",skip:function(){return!1}},function(e){var t;return(t=e.channel).onCommand(function(e){if(e.secretsGetResponse){var t=e.secretsGetResponse.contents;if(t){var n=j.default.parse(t);!function(e,t){if(e.size!==t.size)return!1;var n=!0,i=!1,o=void 0;try{for(var a,s=e[Symbol.iterator]();!(n=(a=s.next()).done);n=!0){var l=(0,r._)(a.value,2),u=l[0],c=l[1];if(!t.has(u)||t.get(u)!==c)return!1}}catch(e){i=!0,o=e}finally{try{n||null==s.return||s.return()}finally{if(i)throw o}}return!0}(a.current,n)&&a.set(n)}}}),t.request({secretsGetRequest:{}}).then(function(e){e.channelClosed||(e.error&&C.withScope(function(t){t.setTag("service","secrets"),C.captureException(Error("failed to initialize secrets: "+e.error))}),i(t))}),function(){l=new Promise(function(e){return i=e})}}),{addEntries:function(e){return(0,k._)(function(){var t,n,i,o,c,d,f,p,h,g,m,x,y,b,w,k,_;return(0,S._)(this,function(S){switch(S.label){case 0:return[4,l];case 1:if(S.sent(),t=new Map(a.current),Array.isArray(e)){n=!0,i=!1,o=void 0;try{for(c=e[Symbol.iterator]();!(n=(d=c.next()).done);n=!0)p=(f=d.value).key,h=f.value,t.set(p,h)}catch(e){i=!0,o=e}finally{try{n||null==c.return||c.return()}finally{if(i)throw o}}}else{g=!0,m=!1,x=void 0;try{for(y=e[Symbol.iterator]();!(g=(b=y.next()).done);g=!0)k=(w=(0,r._)(b.value,2))[0],_=w[1],t.set(k,_)}catch(e){m=!0,x=e}finally{try{g||null==y.return||y.return()}finally{if(m)throw x}}}return[4,u(t)];case 2:return S.sent(),null==s||s(T.events.SECRETS_USED,{action:"addEntries"}),[2]}})})()},removeEntries:function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return(0,k._)(function(){var e,n,r,i,o,c,d,f;return(0,S._)(this,function(p){switch(p.label){case 0:return[4,l];case 1:if(p.sent(),0===(e=t.filter(function(e){return a.current.has(e)})).length)return[2];n=new Map(a.current),r=!0,i=!1,o=void 0;try{for(c=e[Symbol.iterator]();!(r=(d=c.next()).done);r=!0)f=d.value,n.delete(f)}catch(e){i=!0,o=e}finally{try{r||null==c.return||c.return()}finally{if(i)throw o}}return[4,u(n)];case 2:return p.sent(),null==s||s(T.events.SECRETS_USED,{action:"removeEntries"}),[2]}})})()},read:function(){return(0,k._)(function(){var e,t,n=arguments;return(0,S._)(this,function(r){switch(r.label){case 0:return e=n.length>0&&void 0!==n[0]?n[0]:{skipCache:!1},[4,l];case 1:if(t=r.sent(),!e.skipCache)return[2,new Map(a.current)];return[4,t.request({secretsGetRequest:{}})];case 2:return r.sent(),[2,new Map(a.current)]}})}).apply(this,arguments)},replaceAll:u,watch:function(e){var t=!1,n=null;return l.then(function(){t||(n=a.subscribe(e))}),function(){t=!0,null==n||n()}},replaceAllExternalSecrets:function(e){return(0,k._)(function(){var r;return(0,S._)(this,function(i){switch(i.label){case 0:return[4,l];case 1:return[4,i.sent().request({externalSecretsSetRequest:{externalSecrets:Array.isArray(e)?e.reduce(function(e,r){return(0,n._)((0,t._)({},e),(0,_._)({},r.key,r.url))},{}):Object.fromEntries(e)}})];case 2:if((r=i.sent()).error)throw Error(r.error);return[2]}})})()}}}({container:X,observable:new w.ObservableState(new Map),track:void 0===J||J?f.track:void 0})});return null==Z||Z.span.end(),I(ee),function(){I(null),setTimeout(function(){ee.container.destroy()},500)}},[e]),R}e.s(["useCreateServices",()=>E],508545)},468448,e=>{"use strict";var t=e.i(276385),n=e.i(412160),r=e.i(399528),i=e.i(761201),o=e.i(956111),a=e.i(613355),s=e.i(739521),l=e.i(960178),u=e.i(625484);function c(){var e=(0,r.useRouter)(),c=(0,o.useQueryParam)("didMigrateToNix","boolean");return(0,t.jsx)(s.Modal,{isOpen:c,onRequestClose:function(){(0,o.updatePathWithQueryParams)({router:e,params:[{mode:"delete",key:"didMigrateToNix"}]})},centered:!0,children:(0,t.jsxs)(u.View,{gap:16,children:[(0,t.jsx)(l.Header,{level:1,variant:"headerDefault",children:"We've upgraded your App!"}),(0,t.jsxs)(l.Text,{children:["Your App is now using"," ",(0,t.jsx)(n.default,{href:"https://blog.replit.com/nix",children:"the latest infrastructure"})," ","which unlocks powerful new features."]}),(0,t.jsxs)(u.SpecializedView.ul,{css:a.rcss.colWithGap(4),children:[(0,t.jsx)(u.SpecializedView.li,{children:(0,t.jsxs)(l.Text,{children:[""," ",(0,t.jsx)(n.default,{href:i.LINKS_DOCS.DEPENDENCY_MANAGEMENT,children:"Use 80,000+ system dependencies"})," ","(linux packages) out of the box."]})}),(0,t.jsx)(u.SpecializedView.li,{children:(0,t.jsxs)(l.Text,{children:[""," ",(0,t.jsx)(n.default,{href:"https://docs.replit.com/replit-workspace/configuring-repl",children:"Configure your App"})," ","with more capabilities."]})}),(0,t.jsx)(u.SpecializedView.li,{children:(0,t.jsxs)(l.Text,{children:[""," ",(0,t.jsx)(n.default,{href:i.LINKS_DOCS.DEPENDENCY_MANAGEMENT,children:"Check out this doc"})," ","for a deep dive."]})})]}),(0,t.jsxs)(l.Text,{variant:"small",css:{fontStyle:"italic"},children:["Any overwritten files have been backed up to the same file name with a .backup suffix. If you have any questions, please visit"," ",(0,t.jsx)(n.default,{href:"https://replit.com/community",children:"replit.com/community"})," ","to get help."]}),(0,t.jsx)(l.Text,{multiline:!1,children:"Thank you for your patience"})]})})}e.s(["default",()=>c])},748965,e=>{"use strict";var t=e.i(530658),n=e.i(276385),r=e.i(389959),i=e.i(530448),o=e.i(19379),a=e.i(873379),s=e.i(529810),l=e.i(446530),u=e.i(613355),c=e.i(140487),d=e.i(739521),f=e.i(960178),p=e.i(625484),h=(0,l.cssRecord)({splitContainer:[u.rcss.mt(8)],text:[u.rcss.mt(8)]}),g=function(){var e=(0,t._)((0,r.useState)(navigator.onLine),2),n=e[0],i=e[1];return(0,r.useEffect)(function(){var e=function(){i(navigator.onLine)};return window.addEventListener("online",e),window.addEventListener("offline",e),function(){window.removeEventListener("online",e),window.removeEventListener("offline",e)}},[]),n},m=function(){var e=(0,s.default)().container,l=(0,t._)((0,r.useState)(!1),2),u=l[0],m=l[1],x=(0,r.useRef)(!1),y=(0,a.default)(e),b=(0,r.useMemo)(function(){return y===i.ConnectionState.CONNECTED},[y]),w=(0,o.usePageVisibility)(),k=g(),_=(0,r.useCallback)(function(){m(!1)},[]),S=(0,r.useCallback)(function(){location.reload()},[]);return(0,r.useEffect)(function(){if(!x.current&&!b&&w&&k){var e=setTimeout(function(){m(!0),x.current=!0},6e4);return function(){return clearTimeout(e)}}},[b,w,k]),(0,n.jsx)(d.Modal,{isOpen:u,onRequestClose:_,maxWidth:360,centered:!0,children:(0,n.jsxs)(p.View,{gap:8,children:[(0,n.jsx)(f.Header,{level:2,variant:"subheadBig",children:"You are disconnected"}),(0,n.jsx)(f.Text,{css:h.text,children:"Your connection to the server has been lost and reconnection attempts have failed. Please refresh the page to continue."}),(0,n.jsxs)(p.View,{css:h.splitContainer,row:!0,gap:8,justify:"space-between",children:[(0,n.jsx)(c.Button,{text:"Cancel",onClick:_}),(0,n.jsx)(p.View,{row:!0,gap:8,children:(0,n.jsx)(c.Button,{text:"Refresh",onClick:S,colorway:"blue"})})]})]})})};e.s(["DisconnectedModal",()=>m])},982243,e=>{"use strict";e.i(33699);var t=e.i(276385),n=e.i(412160),r=e.i(399528),i=e.i(878420),o=e.i(569384),a=e.i(973245),s=e.i(304277);function l(){var e=(0,o._)(["\n  query NotAllowedModal {\n    currentUser {\n      id\n      isStaff: hasRole(role: REPLIT_STAFF)\n    }\n  }\n"]);return l=function(){return e},e}e.i(566901);var u={},c=(0,a.gql)(l()),d=e.i(761201),f=e.i(207237),p=e.i(480028),h=e.i(446530),g=e.i(613355),m=e.i(140487),x=e.i(739521),y=e.i(960178),b=e.i(751273),w=e.i(625484),k=e.i(925001),_=(0,h.cssRecord)({staffHelpers:[g.rcss.border({color:p.tokens.accentNegativeDefault,width:1,style:"solid"}),g.rcss.overflow("hidden")]});e.s(["default",0,function(e){var o,a,l,p=e.isOpen,h=(0,r.useRouter)(),g=(o={skip:!p},a=(0,i._)({},u,o),s.useQuery(c,a)).data,S=(0,f.default)(),C=null==g||null==(l=g.currentUser)?void 0:l.isStaff;return(0,t.jsx)(x.Modal,{preventClose:!0,isOpen:p,centered:!0,onRequestClose:function(){},maxWidth:600,children:(0,t.jsxs)(w.View,{gap:32,children:[(0,t.jsx)(w.View,{row:!0,gap:16,align:"center",children:(0,t.jsx)(y.Header,{css:{width:"fit-content"},level:2,variant:"headerDefault",children:"You cant run this Repl right now."})}),(0,t.jsxs)(w.View,{gap:16,children:[(0,t.jsxs)(y.Text,{children:["It may be temporarily unavailable or it may have violated our"," ",(0,t.jsx)(n.default,{href:d.LINKS_LEGAL.TERMS_OF_SERVICE,children:"Terms of Service"}),"."]}),(0,t.jsx)(y.Text,{children:"If you are the owner of this Repl and believe you should be able to run it, you can try again later or contact support."}),C?(0,t.jsxs)(w.View,{css:_.staffHelpers,gap:8,children:[(0,t.jsxs)(w.View,{row:!0,gap:8,children:[(0,t.jsx)(b.Tooltip,{tooltip:"You are seeing this functionality because you have special permissions.",children:(0,t.jsx)(k.default,{})}),(0,t.jsx)(y.Header,{level:3,children:"Debug Info"})]}),(0,t.jsx)(w.View,{children:(0,t.jsxs)(y.Text,{children:["Repl ID ",S," is not allowed to run. This is most likely due to a policy takedown."]})}),(0,t.jsx)(w.View,{children:(0,t.jsxs)(y.Text,{multiline:!1,children:[(0,t.jsx)(n.default,{href:"https://us5.datadoghq.com/logs?query=%40replid%3A".concat(S),children:"All datadog logs"})," ",""," ",(0,t.jsx)(n.default,{href:"https://us5.datadoghq.com/logs?query=%40replid%3A".concat(S,"+taking+down"),children:"Takedown-specific logs"})]})})]}):null]}),(0,t.jsxs)(w.View,{row:!0,gap:16,justify:"end",children:[(0,t.jsx)(m.Button,{text:"Reload",onClick:function(){window.location.reload()}}),(0,t.jsx)(m.Button,{text:"Leave",onClick:function(){h.push("/home","~/")}})]})]})})}],982243)},678814,268999,e=>{"use strict";var t=e.i(346715),n=e.i(276385),r=e.i(943618),i=e.i(965863);function o(e){var o,a=e.repl,s=function(){for(var e=arguments.length,n=Array(e),r=0;r<e;r++)n[r]=arguments[r];return(0,t._)(n.filter(Boolean)).concat(["Replit"]).join(" - ")}((0,i.useActiveFile)(),null==a||null==(o=a.project)?void 0:o.title,a.title);return(0,n.jsx)(r.default,{children:(0,n.jsx)("title",{children:s},"title")})}e.s(["default",()=>o],678814);var a=e.i(721281),s=e.i(878420),l=e.i(64386),u=e.i(530658),c=e.i(412160),d=e.i(389959),f=e.i(269990),p=e.i(222342),h=e.i(207237),g=e.i(341126),m=e.i(700582),x=e.i(446530),y=e.i(613355),b=e.i(140487),w=e.i(91720),k=e.i(739521),_=e.i(960178),S=e.i(625484),C=(0,x.cssRecord)({self:[y.rcss.container("root")],actions:[(0,a._)({},y.container.max(475,"root"),[y.rcss.colWithGap(8),y.rcss.align.end])],buttons:[(0,a._)({},y.container.max(350,"root"),[y.rcss.colWithGap(8),y.rcss.align.end])]}),j=function(){var e=(0,h.default)(),t=(0,f.useConvertedToProjectModalQuery)({variables:{id:e},ssr:!1,context:{noBatch:!0},pollInterval:6e4}),r=t.data,i=t.previousData,o=(0,p.default)(),a=o.showConfirm,x=o.showError,y=(0,u._)((0,m.useCreateProjectFork)({onFork:function(){a("Repl forked, redirecting...")},onError:function(){x("Error creating fork - please try again")}}),2),j=y[0],T=y[1].loading,E=(null==r?void 0:r.getRepl.__typename)==="Repl"?r.getRepl:null,R=(null==i?void 0:i.getRepl.__typename)==="Repl"?i.getRepl:null,I=(null==E?void 0:E.org)?E.org:null,A=(null==E?void 0:E.project)?E.project:null,P=(0,u._)((0,d.useState)(!1),2),D=P[0],O=P[1];return((0,d.useEffect)(function(){var t,n,r,i;if((null==E||null==(t=E.project)?void 0:t.mainRepl)&&R&&E.project.mainRepl.id===e)return(null==(r=R.project)||null==(n=r.mainRepl)?void 0:n.id)&&R.project.mainRepl.id===e||(i=setTimeout(function(){O(!0)},6e3)),function(){i&&clearTimeout(i)}},[e,E,R]),E&&I&&A)?(0,n.jsx)(k.Modal,{isOpen:D,onRequestClose:function(){return O(!1)},centered:!0,children:(0,n.jsxs)(S.View,{css:C.self,gap:16,children:[(0,n.jsx)(_.Header,{level:2,variant:"subheadBig",children:"This Repl is now part of a Project"}),(0,n.jsxs)(_.Text,{children:["This Repl is now the source of truth for a Project called"," ",A.title,". Continued development in this Repl may lead to unexpected changes."]}),(0,n.jsxs)(S.View,{css:C.actions,row:!0,gap:8,justify:"space-between",align:"center",children:[(0,n.jsx)(c.default,{href:"https://docs.replit.com/teams/projects/overview",target:"_blank",children:(0,n.jsx)(_.Text,{children:"Learn more"})}),(0,n.jsxs)(S.View,{css:C.buttons,row:!0,gap:8,children:[(0,n.jsx)(b.Button,{text:"Work in a new fork",onClick:function(){T||j({orgId:I.id,repl:E,forkSource:"convertedToProjectModal"})},disabled:T,loading:T}),(0,n.jsx)(w.ButtonLink,(0,l._)((0,s._)({colorway:"primary"},(0,g.orgProjectLink)({org:I,projectId:A.id})),{text:"Visit Project dashboard"}))]})]})]})}):null},T=function(e){return e.repl.org?(0,n.jsx)(j,{}):null};e.s(["ConvertedToProjectModal",()=>T],268999)},732964,718632,e=>{"use strict";var t=e.i(394212),n=e.i(297083),r=e.i(530658),i=e.i(817556),o=e.i(276385),a=e.i(389959),s=e.i(960933),l=e.i(862927),u=e.i(207237),c=e.i(344188),d=e.i(858248),f=e.i(709485),p=e.i(299798),h=e.i(262962),g=e.i(140487),m=e.i(739521),x=e.i(960178),y=e.i(625484),b=e.i(616278),w=s.Type.Object({targetReplId:s.Type.String(),sourceReplId:s.Type.String(),bucketId:s.Type.String()});function k(){var e=(0,r._)((0,a.useState)(null),2),s=e[0],k=e[1],_=(0,u.default)(),S=(0,h.useCurrentUser)();return(0,p.usePid2)(function(e,r){var o=r.session,a=r.signal;return(0,n._)(function(){var n,r,s,u,p,h,g,m,x,y;return(0,i._)(this,function(i){switch(i.label){case 0:if(!_||!S)return[2];r=(n=e.replspaceApi.init.stream({session:o.from},{signal:a})).resReadable,s=n.reqWritable,u=!1,p=!1,i.label=1;case 1:i.trys.push([1,6,7,12]),g=function(){var e=x.value;if(!e.ok||"requestDefaultBucketAccess"!==e.payload.$kind)return"continue";var t=e.payload.nonce;(0,d.track)(f.events.MODAL_VIEWED,{modalName:"default_bucket_access_modal"}),k(function(){return function(e){if(!e){k(null),s.write({$kind:"allowDefaultBucketAccess",nonce:t,result:{status:"error",message:"user canceled"}});return}(0,c.postJson)("/object-storage/replit/allowDefaultBucketAccess/targetRepl/".concat(encodeURIComponent(_),"/sourceRepl/Dotfiles.").concat(encodeURIComponent(S.username)),{}).then(function(e){l.Value.Check(w,e)?s.write({$kind:"allowDefaultBucketAccess",nonce:t,result:{status:"ok",targetReplId:e.targetReplId,sourceReplId:e.sourceReplId,bucketId:e.bucketId}}):s.write({$kind:"allowDefaultBucketAccess",nonce:t,result:{status:"error",message:JSON.stringify(l.Value.Errors(w,e))}})}).catch(function(e){s.write({$kind:"allowDefaultBucketAccess",nonce:t,result:{status:"error",message:"".concat(e)}})}).finally(function(){k(null)})}})},m=(0,t._)(r),i.label=2;case 2:return[4,m.next()];case 3:if(!(u=!(x=i.sent()).done))return[3,5];g(),i.label=4;case 4:return u=!1,[3,2];case 5:return[3,12];case 6:return y=i.sent(),p=!0,h=y,[3,12];case 7:if(i.trys.push([7,,10,11]),!(u&&null!=m.return))return[3,9];return[4,m.return()];case 8:i.sent(),i.label=9;case 9:return[3,11];case 10:if(p)throw h;return[7];case 11:return[7];case 12:return s.close(),[2]}})})()},[_,S]),(0,o.jsx)(m.Modal,{isOpen:"function"==typeof s,onRequestClose:function(){null==s||s(!1),(0,d.track)(f.events.DEFAULT_BUCKET_ACCESS_MODAL_ACCEPTED,{response:"close"}),k(null)},children:(0,o.jsxs)(y.View,{gap:16,children:[(0,o.jsx)(x.Header,{variant:"headerDefault",level:3,children:"Allow Dotfiles App Storage Bucket access"}),(0,o.jsx)(x.Text,{children:"Do you want the App Storage bucket associated with your Dotfiles Repl to be accessible in this Repl? If your Dotfiles Repl has any secrets, they will be accessible to this Repl too."}),(0,o.jsx)(x.Text,{children:"If you did not install the Replit dotfiles support, you should deny this."}),(0,o.jsxs)(y.View,{justify:"end",row:!0,gap:16,children:[(0,o.jsx)(g.Button,{onClick:function(){null==s||s(!1),(0,d.track)(f.events.DEFAULT_BUCKET_ACCESS_MODAL_ACCEPTED,{response:"deny"}),k(null)},text:"Deny"}),(0,o.jsx)(g.Button,{onClick:function(){null==s||s(!0),(0,d.track)(f.events.DEFAULT_BUCKET_ACCESS_MODAL_ACCEPTED,{response:"confirm"}),k(null)},iconLeft:(0,o.jsx)(b.default,{}),text:"Allow for this Repl",colorway:"primary"})]})]})})}e.s(["DefaultBucketAccessConfirmModal",()=>k],732964);var _=e.i(686356),S=e.i(791675),C=e.i(993796),j=e.i(836102),T=e.i(529810),E=e.i(278505);function R(){var e=(0,T.default)().replspaceApi,s=(0,r._)((0,a.useState)(null),2),l=s[0],u=s[1],c=(0,r._)((0,a.useState)(null),2),h=c[0],w=c[1],k=(0,r._)((0,a.useState)(!1),2),R=k[0],I=k[1],A=(0,_.useGitServiceCurrentUserQuery)().data,P=(null==A?void 0:A.currentUser)||void 0,D=(0,E.useGitHubImportMode)(),O=(0,C.useFlag)({controlName:"flag-github-connection-migration",default:!1});return(0,a.useEffect)(function(){return e.onConfirmSendToken(function(e){e&&(0,d.track)(f.events.MODAL_VIEWED,{modalName:"git_token_modal"}),w(function(){return e})})},[e]),(0,p.usePid2)(function(e,r){var o=r.session,a=r.signal;return(0,n._)(function(){var n,r,s,l,c,p,h,g,m,x;return(0,i._)(this,function(i){switch(i.label){case 0:r=(n=e.replspaceApi.init.stream({session:o.from},{signal:a})).reqWritable,s=n.resReadable,l=!1,c=!1,i.label=1;case 1:i.trys.push([1,6,7,12]),h=function(){var e=m.value;if(e.ok&&"getGithubToken"===e.payload.$kind){var t,n,i,o,a=e.payload.nonce,s=void 0;if(!(s=O?null!=(n=null==P||null==(t=P.gitHubInfoV2)?void 0:t.accessToken)?n:void 0:null!=(o=null==P||null==(i=P.gitHubInfo)?void 0:i.accessToken)?o:void 0))return r.write({$kind:"githubToken",nonce:a}),"continue";if(R||D)return r.write({$kind:"githubToken",token:s,nonce:a}),"continue";(0,d.track)(f.events.MODAL_VIEWED,{modalName:"git_token_modal"}),u(S.GitProfileProvider.GITHUB),w(function(){return function(e){if(!e){w(null),u(null),r.isWritable()&&r.write({$kind:"githubToken",nonce:a});return}r.isWritable()&&r.write({$kind:"githubToken",token:s,nonce:a}),w(null),u(null),I(!0)}})}if(e.ok&&"getBitbucketToken"===e.payload.$kind){var l,c,p=e.payload.nonce,h=null!=(c=null==P||null==(l=P.bitbucketInfo)?void 0:l.accessToken)?c:void 0;if(!h)return r.write({$kind:"bitbucketToken",nonce:p}),"continue";if(R)return r.write({$kind:"bitbucketToken",token:h,nonce:p}),"continue";(0,d.track)(f.events.MODAL_VIEWED,{modalName:"git_token_modal"}),u(S.GitProfileProvider.BITBUCKET),w(function(){return function(e){if(!e){w(null),u(null),r.isWritable()&&r.write({$kind:"bitbucketToken",nonce:p});return}r.isWritable()&&r.write({$kind:"bitbucketToken",token:h,nonce:p}),w(null),u(null),I(!0)}})}if(e.ok&&"getGitlabToken"===e.payload.$kind){var g,x,y=e.payload.nonce,b=null!=(x=null==P||null==(g=P.gitLabInfo)?void 0:g.accessToken)?x:void 0;if(!b)return r.write({$kind:"gitlabToken",nonce:y}),"continue";if(R)return r.write({$kind:"gitlabToken",token:b,nonce:y}),"continue";(0,d.track)(f.events.MODAL_VIEWED,{modalName:"git_token_modal"}),u(S.GitProfileProvider.GITLAB),w(function(){return function(e){if(!e){w(null),u(null),r.isWritable()&&r.write({$kind:"gitlabToken",nonce:y});return}r.isWritable()&&r.write({$kind:"gitlabToken",token:b,nonce:y}),w(null),u(null),I(!0)}})}},g=(0,t._)(s),i.label=2;case 2:return[4,g.next()];case 3:if(!(l=!(m=i.sent()).done))return[3,5];h(),i.label=4;case 4:return l=!1,[3,2];case 5:return[3,12];case 6:return x=i.sent(),c=!0,p=x,[3,12];case 7:if(i.trys.push([7,,10,11]),!(l&&null!=g.return))return[3,9];return[4,g.return()];case 8:i.sent(),i.label=9;case 9:return[3,11];case 10:if(c)throw p;return[7];case 11:return[7];case 12:return[2]}})})()},[P,R,D,O]),(0,o.jsx)(m.Modal,{isOpen:"function"==typeof h,onRequestClose:function(){(0,d.track)(f.events.GIT_TOKEN_MODAL_ACCEPTED,{response:"close"}),null==h||h(!1)},children:(0,o.jsxs)(y.View,{gap:16,children:[(0,o.jsxs)(x.Header,{variant:"headerDefault",level:3,children:["Pass"," ",l?(0,j.providerEnumToDisplayName)(l):"Git"," ","Credentials"]}),(0,o.jsxs)(x.Text,{children:["It looks like you're trying to connect to your"," ",l?(0,j.providerEnumToDisplayName)(l):"remote Git"," ","repository. Authorize this session to use your credentials?"]}),(0,o.jsx)(x.Text,{children:"If you did not initiate a git command, you should deny this."}),(0,o.jsxs)(y.View,{justify:"end",row:!0,gap:16,children:[(0,o.jsx)(g.Button,{onClick:function(){(0,d.track)(f.events.GIT_TOKEN_MODAL_ACCEPTED,{response:"deny"}),null==h||h(!1)},text:"Deny"}),(0,o.jsx)(g.Button,{onClick:function(){(0,d.track)(f.events.GIT_TOKEN_MODAL_ACCEPTED,{response:"confirm"}),null==h||h(!0)},iconLeft:(0,o.jsx)(b.default,{}),text:"Confirm for this session",colorway:"primary"})]})]})})}e.s(["GitInShellConfirmModal",()=>R],718632)},745844,e=>{"use strict";var t=e.i(276385),n=e.i(967629);function r(){return(0,t.jsx)(n.Global,{styles:[{body:{overflow:"hidden"}}]})}e.s(["HideBodyOverflow",()=>r])},80366,e=>{"use strict";var t=e.i(276385),n=e.i(399528),r=e.i(389959),i=e.i(265140),o=e.i(871203),a=e.i(993796),s=e.i(956111),l=e.i(119322),u=e.i(185591);function c(e,t){return!!e&&("ReplRedirect"===e.__typename||"ReplSubscriptionExpired"===e.__typename||!e.authorizations.editFileContents.isAuthorized||!(0,s.parseQueryParam)(t.query.skipNixMigration,"boolean")&&(0,o.shouldMigrateReplToNix)(e))}function d(e){var o=(0,n.useRouter)(),s=(0,a.useFlag)({controlName:"flag-migrate-html"}),d=(0,i.useHandleReplRedirectionQuery)({variables:{replId:e.replId},fetchPolicy:"no-cache",ssr:!1}).data,f=(null==d?void 0:d.getRepl)&&("Repl"===d.getRepl.__typename||"ReplRedirect"===d.getRepl.__typename||"ReplSubscriptionExpired"===d.getRepl.__typename)?d.getRepl:null;if((0,r.useEffect)(function(){if(f&&c(f,o)){if("ReplSubscriptionExpired"===f.__typename){var e,t,n=f.replId,r=f.isOwner,i=null==(e=o.query.replUrl)?void 0:e.toString(),a=null!=(t=null==i?void 0:i.split("/")[1].slice(1))?t:"",s=o.asPath.indexOf("#"),l=s<0?o.asPath:o.asPath.slice(0,s);o.replace({pathname:"/expiredPrivateRepl",query:{isOwner:r,ownerUsername:a,replId:n}},l);return}if("ReplRedirect"===f.__typename){window.location.href=f.replUrl;return}if(!f.authorizations.editFileContents.isAuthorized){var d=(0,u.replViewLinkProps)(f),p=d.href,h=d.as;o.replace(p,h);return}window.location.reload()}},[f,o,s]),c(f,o)){var p="";return"ReplRedirect"===f.__typename?p="Repl moved, redirecting":"ReplSubscriptionExpired"===f.__typename?p="Subscription expired, redirecting":f.authorizations.editFileContents.isAuthorized&&(p="Your Repl requires an upgrade, please wait"),(0,t.jsx)(l.default,{reason:p})}return null}e.s(["default",()=>d])}]);

//# debugId=5e3c085d-1532-e9bf-752a-ba86bedec92d
//# sourceMappingURL=dc58e71189771ac7.js.map