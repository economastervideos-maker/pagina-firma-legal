;!function(){try { var e="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof global?global:"undefined"!=typeof window?window:"undefined"!=typeof self?self:{},n=(new e.Error).stack;n&&((e._debugIds|| (e._debugIds={}))[n]="70e6788d-73c8-1bb6-57af-04821dd969e6")}catch(e){}}();
(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,74032,e=>{e.v({"fade-in":"LoadingState-module___WZova__fade-in",header:"LoadingState-module___WZova__header",loadingAnimation:"LoadingState-module___WZova__loadingAnimation",root:"LoadingState-module___WZova__root"})},680189,e=>{e.v({flippedIcon:"workspaceTour-module__-kv3kW__flippedIcon",iconSurface:"workspaceTour-module__-kv3kW__iconSurface"})},224373,e=>{e.v({grip:"ResizeHandle-module__nCKbhG__grip",left:"ResizeHandle-module__nCKbhG__left",right:"ResizeHandle-module__nCKbhG__right",root:"ResizeHandle-module__nCKbhG__root"})},491694,e=>{e.v({root:"Search-module__fSv4Tq__root"})},926415,e=>{e.v({content:"index-module__d5R9Kq__content",header:"index-module__d5R9Kq__header",root:"index-module__d5R9Kq__root",title:"index-module__d5R9Kq__title"})},695337,e=>{e.v({surface:"KeyboardShortcutsModal-module__Tz_71q__surface"})},918218,e=>{e.v({right:"ExpandAgentButton-module__Sr5bZG__right",root:"ExpandAgentButton-module__Sr5bZG__root",show:"ExpandAgentButton-module__Sr5bZG__show"})},576779,e=>{e.v({animationWrapper:"FigmaImport-module__p8csWa__animationWrapper",overlay:"FigmaImport-module__p8csWa__overlay",progressBarContainer:"FigmaImport-module__p8csWa__progressBarContainer",progressBarFill:"FigmaImport-module__p8csWa__progressBarFill",progressBarTrack:"FigmaImport-module__p8csWa__progressBarTrack"})},60166,e=>{e.v({agent:"RunStatusButton-module__27k_5G__agent",agentStatusIcon:"RunStatusButton-module__27k_5G__agentStatusIcon",root:"RunStatusButton-module__27k_5G__root",running:"RunStatusButton-module__27k_5G__running"})},700283,e=>{e.v({flipped:"FiletreeButton-module__3d0q-a__flipped"})},317941,e=>{e.v({avatar:"index-module__PnN-4a__avatar",inviteDialog:"index-module__PnN-4a__inviteDialog",remainingCountButton:"index-module__PnN-4a__remainingCountButton",stacked:"index-module__PnN-4a__stacked"})},384132,e=>{e.v({emptySpacer:"NavMenu-module__rNmZaG__emptySpacer",menu:"NavMenu-module__rNmZaG__menu",repl:"NavMenu-module__rNmZaG__repl",usage:"NavMenu-module__rNmZaG__usage"})},342571,e=>{e.v({desktopAppWindowsOs:"index-module__IZzwWa__desktopAppWindowsOs",desktopDragRegion:"index-module__IZzwWa__desktopDragRegion",left:"index-module__IZzwWa__left",planningHeader:"index-module__IZzwWa__planningHeader",planningHeaderLeft:"index-module__IZzwWa__planningHeaderLeft",planningTimeline:"index-module__IZzwWa__planningTimeline",right:"index-module__IZzwWa__right"})},375032,e=>{e.v({"fade-out":"Border-module__AS8LXG__fade-out",pulse:"Border-module__AS8LXG__pulse",root:"Border-module__AS8LXG__root"})},231927,e=>{e.v({container:"index-module__4PIZ9q__container",interactionBlanket:"index-module__4PIZ9q__interactionBlanket",root:"index-module__4PIZ9q__root"})},33171,e=>{e.v({closeButton:"Tab-module__U4WksG__closeButton",tab:"Tab-module__U4WksG__tab",tabButton:"Tab-module__U4WksG__tabButton",title:"Tab-module__U4WksG__title"})},13891,e=>{e.v({desktopAppWindowsOs:"index-module__QGsN1W__desktopAppWindowsOs",dragArea:"index-module__QGsN1W__dragArea",dropPreview:"index-module__QGsN1W__dropPreview",newTab:"index-module__QGsN1W__newTab",newTabIconButton:"index-module__QGsN1W__newTabIconButton",newTabTextButton:"index-module__QGsN1W__newTabTextButton",tabBar:"index-module__QGsN1W__tabBar",tabs:"index-module__QGsN1W__tabs"})},248611,e=>{e.v({surface:"index-module__3SVBeW__surface"})},357210,e=>{e.v({grip:"ResizeHandle-module__D5nG1G__grip",root:"ResizeHandle-module__D5nG1G__root",stacked:"ResizeHandle-module__D5nG1G__stacked"})},861781,e=>{e.v({root:"index-module__mWTpga__root"})},755181,e=>{e.v({contentContainer:"Workspace-module__bV5fda__contentContainer",desktopApp:"Workspace-module__bV5fda__desktopApp"})},838720,e=>{e.v({emailVerificationWrapper:"replEnvironmentDesktop-module__rxGmJG__emailVerificationWrapper",surface:"replEnvironmentDesktop-module__rxGmJG__surface"})},453926,e=>{"use strict";var t,n,r,i,a,o,s,l,u,c,d,p,f,h,g,m=e.i(276385),v=e.i(399528),x=e.i(878420),y=e.i(569384),w=e.i(973245),b=e.i(304277),j=e.i(566901),_=e.i(552207);function S(){var e=(0,y._)(["\n  query ReplEnvironmentDesktop(\n    $replId: String!\n    $environment: KeybindingsEnvironmentEnum!\n    $platform: KeybindingsPlatformEnum!\n  ) {\n    getRepl(id: $replId) {\n      ... on Repl {\n        id\n        ...ReplEnvironmentDesktopRepl\n      }\n      ... on Error {\n        message\n      }\n    }\n    currentUser {\n      id\n      isVerified\n      ...ReplEnvironmentDesktopCurrentUser\n      keybindings(environment: $environment, platform: $platform) {\n        keybindings\n      }\n    }\n  }\n  ","\n  ","\n"]);return S=function(){return e},e}var I={},C=(0,w.gql)(S(),_.ReplEnvironmentDesktopReplFragmentDoc,_.ReplEnvironmentDesktopCurrentUserFragmentDoc),k=e.i(82464),E=e.i(993796),T=e.i(911185),P=e.i(721281),R=e.i(872734),A=e.i(480028),D=e.i(660614),V=e.i(929872),O=e.i(625484),F=e.i(219577),M=e.i(751299),L=e.i(74032),G=(0,A.cvarsFrom)("LoadingState.module.css",["--header-height"]);function U(e){return(0,m.jsxs)(V.Surface,{style:(0,P._)({},G.headerHeight,F.APP_HEADER_HEIGHT+"px"),clsx:L.default.root,children:[(0,m.jsx)(V.Surface,{row:!0,clsx:L.default.header,justify:"space-between",px:6,children:(0,m.jsxs)(O.View,{row:!0,align:"center",children:[(0,m.jsx)(R.default,{}),(0,m.jsx)(M.NavMenu,{children:(0,m.jsx)(m.Fragment,{})})]})}),(0,m.jsx)(O.View,{grow:!0,shrink:!0,align:"center",justify:"center",clsx:L.default.loadingAnimation,children:e.animation?(0,m.jsx)(D.default,{height:100}):null})]})}var N=e.i(530658),B=e.i(389959),W=e.i(951262);function z(){var e=(0,y._)(["\n  mutation SaveReplLayoutState($input: SetReplLayoutStateInput!) {\n    setReplLayoutState(input: $input) {\n      ... on Repl {\n        id\n        layoutState\n      }\n    }\n  }\n"]);return z=function(){return e},e}var H={},q=(0,w.gql)(z()),K=e.i(877212),$=e.i(204203),Q=e.i(787182),Y=e.i(921521),X=e.i(125674),J=e.i(441329),Z=e.i(956111),ee=e.i(400081),et=e.i(42783),en=e.i(346715),er=e.i(297083),ei=e.i(817556),ea=e.i(541793),eo=e.i(161322),es=e.i(858248),el=e.i(709485),eu=e.i(971131),ec=(0,ea.atom)(!1),ed=(0,ea.atom)(null,function(e,t,n){e(ec)?(0,eu.flushSync)(function(){t(ep,null),t(ec,!1)}):(n&&t(ep,n),t(ec,!0))}),ep=(0,ea.atom)(null),ef=(0,ea.atom)([]),eh=e.i(814563),eg=e.i(223808);e.i(242933);var em=e.i(424360);e.i(925218);var ev=e.i(372988),ex=e.i(960933),ey=ex.Type.String();ex.Type.String();var ew=ex.Type.Object({width:ex.Type.Number(),height:ex.Type.Number()}),eb=ex.Type.Object({x:ex.Type.Number(),y:ex.Type.Number()}),ej=ex.Type.Intersect([eb,ew]),e_=ex.Type.Object({top:ex.Type.Number(),bottom:ex.Type.Number(),left:ex.Type.Number(),right:ex.Type.Number()}),eS=ex.Type.Object({id:ex.Type.String(),type:ex.Type.Literal("paneGroup"),panes:ex.Type.Array(ey),percent:ex.Type.Number(),activeIndex:ex.Type.Number()}),eI=ex.Type.Object({id:ex.Type.String(),type:ex.Type.Literal("floatingPaneGroup"),panes:ex.Type.Array(ey),activeIndex:ex.Type.Number(),rect:ej}),eC=ex.Type.Recursive(function(e){return ex.Type.Object({type:ex.Type.Literal("split"),stacked:ex.Type.Boolean(),children:ex.Type.Array(ex.Type.Union([eS,e])),percent:ex.Type.Number()})});ex.Type.Union([eS,eC]);var ek=ex.Type.Object({tiling:ex.Type.Union([eC,eS,ex.Type.Null()]),floating:ex.Type.Array(eI)});ex.Type.Union([ex.Type.Literal("left"),ex.Type.Literal("right")]),ex.Type.Object({inset:ex.Type.Optional(e_),size:ew,gap:ex.Type.Number(),headerHeight:ex.Type.Number()});var eE=ex.Type.Union([ex.Type.Literal("above"),ex.Type.Literal("below"),ex.Type.Literal("leftOf"),ex.Type.Literal("rightOf")]);function eT(e,t){var n,r,i,a,o={width:n=.5*t.width,height:r=.5*t.height,x:t.x+(t.width-n)/2,y:t.y+(t.height-r)/2};if(i=e.x,a=e.y,i>o.x&&i<o.x+o.width&&a>o.y&&a<o.y+o.height)return{dropLocation:"middle",previewRect:t};var s={x:t.x+t.width/2,y:t.y+t.height/2},l=.3*t.width,u=s.x-l/2;if(e.x>=u&&e.x<=u+l){var c=e.y<=s.y?"above":"below",d=t.height/2;return{dropLocation:c,previewRect:{x:t.x,y:"above"===c?t.y:t.y+d,width:t.width,height:d}}}var p=e.x<=s.x?"leftOf":"rightOf",f=t.width/2;return{dropLocation:p,previewRect:{x:"leftOf"===p?t.x:t.x+f,y:t.y,width:f,height:t.height}}}ex.Type.Union([eE,ex.Type.Literal("replace")]),ex.Type.Union([ex.Type.Literal("up"),ex.Type.Literal("left"),ex.Type.Literal("right"),ex.Type.Literal("down")]);var eP={height:0,width:0};function eR(e){if(e.length<1)throw Error("Expected a path with a parent");return e.slice(0,-1)}function eA(e){return"floatingPaneGroup"!==e.type}e.s(["getParentPath",()=>eR,"isTiledNode",()=>eA],319105);var eD=e.i(633600),eV=e.i(119468);function eO(e,t){var n=(0,eD._)(t),r=n[0],i=n.slice(1);if("floating"===r){if(!e.floating)return null;var a=i[0];if("number"!=typeof a)throw Error("Expected floatingIndex");var o=e.floating[a];if(!o)throw Error("Expected paneGroup");return o}if("tiling"!==r)throw Error("Expected tiling path");var s=e.tiling;if(!s)return null;var l=s,u=i.length,c=0,d=!0,p=!1,f=void 0;try{for(var h,g=i[Symbol.iterator]();!(d=(h=g.next()).done);d=!0){var m=h.value;if("paneGroup"===l.type)break;if("number"!=typeof m)throw Error("Expected number");c++,l=l.children[m]}}catch(e){p=!0,f=e}finally{try{d||null==g.return||g.return()}finally{if(p)throw f}}return u===c?l:null}function eF(e,t){var n=e.floating.find(function(e){return e.panes.includes(t)});if(n)return{index:n.panes.indexOf(t),paneGroup:n,paneGroupPath:["floating",e.floating.indexOf(n)],floating:!0};var r=e.tiling;if(!r)return null;for(var i=[{paneGroupPath:["tiling"],parent:null,grandparent:null,node:r}];i.length;){var a=i.shift();if(!a)throw Error("Expected item");if("split"===a.node.type){var o=!0,s=!1,l=void 0;try{for(var u,c=a.node.children[Symbol.iterator]();!(o=(u=c.next()).done);o=!0){var d=u.value;i.push({grandparent:a.parent,parent:a.node,node:d,paneGroupPath:(0,en._)(a.paneGroupPath).concat([a.node.children.indexOf(d)])})}}catch(e){s=!0,l=e}finally{try{o||null==c.return||c.return()}finally{if(s)throw l}}}else if(a.node.panes.includes(t))return{paneGroupPath:a.paneGroupPath,paneGroup:a.node,parent:a.parent,grandparent:a.grandparent,index:a.node.panes.indexOf(t),floating:!1}}return null}function eM(e,t){var n=e.tiling;return n?function e(t,n,r){if("paneGroup"===t.type)return{paneGroup:t,path:r};var i=0,a=t.children.length-1;return"topRight"!==n||t.stacked?"bottomRight"===n?i=a:"bottomLeft"===n&&t.stacked&&(i=a):i=a,e(t.children[i],n,(0,en._)(r).concat([i]))}(n,t,["tiling"]):null}function eL(e,t){var n=e.tiling,r=e.floating,i=(0,en._)(r);for(n&&i.push(n);i.length;){var a=i.shift();if(!a)throw Error("Expected item");if("split"===a.type)i.push.apply(i,(0,en._)(a.children));else if(a.id===t)return a}return null}function eG(e,t){var n=e.tiling;if(null===n)return null;for(var r=[[n,["tiling"]]];r.length;){var i=function(){var e=r.shift();if(!e)throw Error("Expected item");var n=(0,N._)(e,2),i=n[0],a=n[1];return"split"!==i.type?"continue":i.children.some(function(e){return"paneGroup"===e.type&&e.id===t})?{v:{node:i,path:a}}:void i.children.forEach(function(e,t){r.push([e,(0,en._)(a).concat([t])])})}();if("object"===(0,eV._)(i))return i.v}return null}function eU(e,t){var n=eF(e,t);if((null==n?void 0:n.paneGroup.type)==="paneGroup"){var r=eG(e,n.paneGroup.id);if(r){var i=r.node.children,a=i.indexOf(n.paneGroup);return a<i.length-1?i[a+1]:i[a-1]}}return null}function eN(e){var t=e.relativeTo,n=e.rects,r=e.direction,i=n.get(t);if(!i)throw Error("Expected relativeTo rect to be included in rects");var a=null,o=!0,s=!1,l=void 0;try{for(var u,c=n[Symbol.iterator]();!(o=(u=c.next()).done);o=!0){var d=(0,N._)(u.value,2),p=d[0],f=d[1];if(p===t)continue;var h=function(e){var t=e.from,n=e.other;switch(e.direction){case"above":return t.y-n.y;case"below":return n.y-t.y;case"rightOf":return n.x-t.x;case"leftOf":return t.x-n.x}}({from:i,other:f,direction:r});if(("leftOf"!==r&&"above"!==r||!(h<=0))&&("rightOf"!==r&&"below"!==r||!(h<0))){var g=function(e,t,n){var r=(0,N._)("x"===n?[[e.x,e.x+e.width],[t.x,t.x+t.width]]:[[e.y,e.y+e.height],[t.y,t.y+t.height]],2),i=r[0],a=r[1],o=Math.max(i[0],a[0]);return Math.min(i[1],a[1])-o}(i,f,"leftOf"===r||"rightOf"===r?"y":"x");!(g<=0)&&(!a||a.distance>h||a.distance===h&&a.overlap<g)&&(a={key:p,rect:f,distance:h,overlap:g})}}}catch(e){s=!0,l=e}finally{try{o||null==c.return||c.return()}finally{if(s)throw l}}return(null==a?void 0:a.key)||null}var eB={top:0,bottom:0,left:0,right:0};function eW(e,t){var n=t.inside,r=t.minVisibleX,i=t.minVisibleY,a=-e.width+r,o=n.width-r,s=n.height-i;return{x:Math.min(Math.max(a,e.x),o),y:Math.min(Math.max(0,e.y),s)}}function ez(e,t){var n=void 0===t.activeIndex?0:t.activeIndex;if(t.isFloating)return void e.floating.push({id:t.id,type:"floatingPaneGroup",panes:t.panes,activeIndex:n,rect:t.rect});var r=null;if(Array.isArray(t.relativeTo))r=t.relativeTo;else{var i=eF(e,t.relativeTo);if(!i)throw Error("Expected pane");r=i.paneGroupPath}if(null===r)throw Error("Expected relativeTo");if("tiling"!==r[0])throw Error("Expected tiling path");var a=t.placement,o=t.panes,s=t.percent,l="above"===a||"below"===a,u="rightOf"===a||"below"===a;if(!e.tiling&&1===r.length){e.tiling={id:t.id,type:"paneGroup",percent:100,panes:o,activeIndex:n};return}if(!e.tiling)throw Error("Expected tiling");var c=eO(e,r);if(!c||!eA(c))throw Error("Expected tiled node");if(1===r.length&&"replace"===a){e.tiling={id:t.id,type:"paneGroup",percent:100,panes:o,activeIndex:n};return}if(1===r.length&&"paneGroup"===e.tiling.type){var d=[e.tiling];e.tiling={type:"split",percent:100,stacked:l,children:d},eH({id:t.id,insertIndex:+!!u,panes:o,children:d,percent:s,activeIndex:n});return}if(1===r.length&&"split"===e.tiling.type){if(!!e.tiling.stacked==!!l)return void eH({id:t.id,panes:o,percent:s,activeIndex:n,insertIndex:u?e.tiling.children.length:0,children:e.tiling.children});var p={id:t.id,panes:o,type:"paneGroup",percent:void 0===s?50:s,activeIndex:n},f=u?[c,p]:[p,c];return c.percent=100-p.percent,void(e.tiling={type:"split",stacked:l,children:f,percent:100})}if(0===r.length)throw Error("Expected relativeTo length");var h=eO(e,eR(r));if((null==h?void 0:h.type)!=="split")throw Error("Expected split parent");if("replace"===a){var g=h.children.indexOf(c);h.children.splice(g,1,{id:t.id,panes:o,percent:c.percent,type:"paneGroup",activeIndex:n});return}if(!!h.stacked==!!l){var m=h.children.indexOf(c);eH({id:t.id,panes:o,percent:s,activeIndex:n,insertIndex:u?m+1:m,children:h.children});return}if(!!h.stacked!=!!l){var v={id:t.id,panes:o,type:"paneGroup",percent:void 0===s?50:s,activeIndex:n},x=u?[c,v]:[v,c],y=c.percent;c.percent=100-v.percent;var w=h.children.indexOf(c);h.children[w]={type:"split",stacked:l,children:x,percent:y};return}}function eH(e){var t=e.id,n=e.percent,r=e.children,i=e.panes,a=e.insertIndex,o=e.activeIndex;if(void 0!==n){var s=(100-n)/100;r.forEach(function(e){e.percent=e.percent*s}),r.splice(a,0,{id:t,panes:i,type:"paneGroup",percent:n,activeIndex:o});return}var l=r.reduce(function(e,t){return e+t.percent},0)/r.length,u=100/(100+l);r.forEach(function(e){e.percent=e.percent*u}),r.splice(a,0,{id:t,panes:i,type:"paneGroup",percent:l*u,activeIndex:o})}function eq(e,t){var n=eL(e,t.paneGroupId);if(!n)throw Error("Expected paneGroup");!function(e,t){var n,r=t.index,i=t.paneIds,a=t.activate;if(void 0!==r&&r>e.panes.length)throw Error("Invalid index");var o=void 0===r?e.panes.length:r;(n=e.panes).splice.apply(n,[o,0].concat((0,en._)(i))),(void 0===a||a)&&(e.activeIndex=o)}(n,t)}function eK(e,t){e.panes.splice(t,1),0===e.activeIndex||t>e.activeIndex||(e.activeIndex=e.activeIndex-1)}function e$(e,t){var n=eF(e,t);if(!n)throw Error("Expected pane");if(n.floating){if(1===n.paneGroup.panes.length){var r=n.paneGroupPath[1];if("number"!=typeof r)throw Error("Expected floatingIndex");eQ(e,["floating",r])}else eK(n.paneGroup,n.index);return}var i=n.paneGroup,a=n.paneGroupPath,o=n.parent;if(!i)throw Error("paneGroup eith paneId not found: "+t);var s=i.panes.indexOf(t);if(-1===s)throw Error("Expected paneIndex");if(!o&&1===i.panes.length){e.tiling=null;return}i.panes.length>1?eK(i,s):eQ(e,a)}function eQ(e,t){var n=(0,eD._)(t),r=n[0],i=n.slice(1);if("tiling"===r&&0===i.length){e.tiling=null;return}if("floating"===r&&0===i.length){e.floating=[];return}var a=eO(e,t);if(!a)throw Error("Expected node");if("floatingPaneGroup"===a.type){var o=e.floating.indexOf(a);if(-1===o)throw Error("Expected paneGroupIndex");e.floating.splice(o,1);return}var s=eR(t),l=eO(e,s);if((null==l?void 0:l.type)!=="split")throw Error("Expected split");var u=l.children.indexOf(a);if(-1===u)throw Error("Expected paneGroupIndex");var c=l.children;if(c.splice(u,1),c.length>1){var d=100/c.reduce(function(e,t){return e+t.percent},0);c.forEach(function(e){e.percent=e.percent*d});return}var p=(0,N._)(c,1)[0],f=s.length>1?eO(e,eR(s)):null;if(!f){p.percent=100,e.tiling=p;return}if("split"!==f.type)throw Error("Expected split");var h=f.children.indexOf(l);if(-1===h)throw Error("Expected parentIndex");p.percent=l.percent,f.children[h]=p}function eY(e,t){var n=t.paneGroupPath,r=t.rect,i=eO(e,n);if((null==i?void 0:i.type)!=="paneGroup")throw Error("Expected paneGroup");eQ(e,n),ez(e,{id:i.id,isFloating:!0,panes:i.panes,rect:r,activeIndex:i.activeIndex})}function eX(e,t){var n="floatingIndex"in t?e.floating[t.floatingIndex]:eO(e,t.paneGroupPath);if(!n||!("panes"in n))throw Error("Expected paneGroup");e$(e,t.paneId);var r=void 0===t.index?n.panes.length:t.index;n.panes.splice(r,0,t.paneId),t.activate?n.activeIndex=r:n.activeIndex>=r&&n.activeIndex++}function eJ(e,t){var n=t.leftPath,r=t.percent,i=t.snapPercent,a=void 0===i?0:i,o=eO(e,n);if(!o||!eA(o))throw Error("Expected leftNode");var s=eO(e,eR(n));if((null==s?void 0:s.type)!=="split")throw Error("Expected splitNode");var l=s.children.indexOf(o);if(-1===l)throw Error("Expected leftNodeIndex");var u=l+1,c=s.children[u];if(!c)throw Error("Expected rightNode");if(r<=a){if(o.percent=0,r<0&&l>0)for(var d=Math.abs(r),p=l-1;d>0;){var f=s.children[p];if(f.percent>d){f.percent-=d;break}if(d-=f.percent,f.percent=0,0===p)break;p--}var h=s.children.reduce(function(e,t){return t===c?e:e+t.percent},0);c.percent=100-h;return}var g=o.percent+c.percent,m=s.children.slice(l).reduce(function(e,t){return e+t.percent},0);if(r>g-a){if(o.percent=Math.min(m,Math.max(g,r)),c.percent=0,r>g&&u<s.children.length-1)for(var v=r-g,x=u+1;v>0;){var y=s.children[x];if(y.percent>v){y.percent-=v;break}if(v-=y.percent,y.percent=0,x===s.children.length-1)break;x++}return}var w=o.percent-r;c.percent=c.percent+w,o.percent=r}e.i(319105);var eZ=e.i(131141),e0=(0,ea.atom)([]),e1=(0,ea.atom)([]),e2=(0,ea.atom)([]),e4={x:0,y:0,width:0,height:0},e8={type:"commands",data:{autoFocus:!1}},e3=(0,eh.atomFamily)(function(e){return(0,ea.atom)({paneId:e,type:"tile",rectAtom:(0,ea.atom)((0,x._)({},e4)),dataAtom:(0,ea.atom)((0,x._)({},e8)),isHidden:!1,isCommitted:!1,highlight:!1})}),e6=(0,ea.atom)(function(e){return e(e0).map(function(t){return e(e3(t))})}),e5=(0,ea.atom)(function(e){return e(e6).filter(function(e){return!e.isHidden})}),e9=(0,ea.atom)(function(e){return e(e6).filter(function(e){return e.isHidden})}),e7=(0,ea.atom)(function(e){return e(e2).map(function(t){return e(tt(t))})}),te=(0,eh.atomFamily)(function(e){return(0,ea.atom)({handleId:e,rect:e4,stacked:!1,parentPath:["tiling"],leftPath:["tiling"],rightPath:["tiling"]})}),tt=(0,eh.atomFamily)(function(e){return(0,ea.atom)({id:e,rectAtom:(0,ea.atom)((0,x._)({},e4)),panes:[],path:["tiling"],activeIndex:0})}),tn=(0,ea.atom)(function(){return 34}),tr=(0,ea.atom)({x:0,y:0,width:0,height:0});e.i(282890);var ti=e.i(66718),ta=(0,ea.atom)(null),to=(0,ea.atom)(null,function(e,t,n){n!==e(ta)&&t(ta,n)}),ts=(0,ea.atom)(null,function(e,t,n){var r=e3(n);e(r).isCommitted||t(r,function(e){return(0,eZ.produce)(e,function(e){e.isCommitted=!0})})}),tl=(0,ea.atom)(function(e){var t=e(ta);if(!t)return null;var n=e(e3(t)),r=e(n.dataAtom);return"markdown"===r.type?r.data.path:(0,ti.isFilePane)(r)&&r.data.path||null}),tu=e.i(992785),tc=e.i(568817);ex.Type.Object({width:ex.Type.Number({minimum:0}),isOpen:ex.Type.Boolean()});var td=(0,ea.atom)({width:180,isOpen:!1}),tp=(0,ea.atom)(function(e){return e(td).isOpen}),tf=(0,ea.atom)(function(e){var t=e(td);return t.isOpen?t.width:0}),th=(0,ea.atom)(!0),tg=(0,ea.atom)(!1),tm=(0,ea.atom)({tiling:null,floating:[]}),tv=(0,ea.atom)(function(e){return e(e6).filter(function(t){return(0,ti.isFilePane)(e(t.dataAtom))})}),tx=(0,ea.atom)(function(e){var t=!0,n=!1,r=void 0;try{for(var i,a=e(e6)[Symbol.iterator]();!(t=(i=a.next()).done);t=!0){var o=i.value;if(!o.isCommitted&&(0,ti.isFilePane)(e(o.dataAtom)))return o.paneId}}catch(e){n=!0,r=e}finally{try{t||null==a.return||a.return()}finally{if(n)throw r}}return null}),ty=(0,ea.atom)(function(e){var t=!0,n=!1,r=void 0;try{for(var i,a=e(e6)[Symbol.iterator]();!(t=(i=a.next()).done);t=!0){var o=i.value;if(!o.isCommitted&&!(0,ti.isFilePane)(e(o.dataAtom)))return o.paneId}}catch(e){n=!0,r=e}finally{try{t||null==a.return||a.return()}finally{if(n)throw r}}return null}),tw=(0,ea.atom)(function(e){var t=[],n=!0,r=!1,i=void 0;try{for(var a,o=e(e5)[Symbol.iterator]();!(n=(a=o.next()).done);n=!0){var s=a.value;t.push([s.paneId,e(s.dataAtom)])}}catch(e){r=!0,i=e}finally{try{n||null==o.return||o.return()}finally{if(r)throw i}}return t}),tb=(0,ea.atom)([]),tj=(0,ea.atom)(function(e){var t=[],n=!0,r=!1,i=void 0;try{for(var a,o=e(e9)[Symbol.iterator]();!(n=(a=o.next()).done);n=!0){var s=a.value;t.push([s.paneId,e(s.dataAtom)])}}catch(e){r=!0,i=e}finally{try{n||null==o.return||o.return()}finally{if(r)throw i}}return t}),t_=(0,ea.atom)(function(e){var t=[],n=!0,r=!1,i=void 0;try{for(var a,o=e(e6)[Symbol.iterator]();!(n=(a=o.next()).done);n=!0){var s=a.value;t.push([s.paneId,e(s.dataAtom)])}}catch(e){r=!0,i=e}finally{try{n||null==o.return||o.return()}finally{if(r)throw i}}return t}),tS=(0,ea.atom)(function(e){return e(t_).length}),tI=(0,ea.atom)(function(e){var t=e(tr);return!!(t.width&&t.height)}),tC=(0,ea.atom)(null),tk=(0,ea.atom)(null,function(e,t,n){var r=e(e6).find(function(t){var r=e(t.dataAtom);return(0,ti.isFilePane)(r)?n===(0,ti.getFilePathForPane)(r):"markdown"===r.type&&n===r.data.path});r&&(t(to,r.paneId),t(ts,r.paneId))}),tE=(0,ea.atom)(null);function tT(e,t){var n=e.x,r=e.y;return n>t.x&&n<t.x+t.width&&r>t.y&&r<t.y+t.height}function tP(e,t){var n,r,i,a,o,s,l,u,c,d=(r=(n={point:e,rect:t}).rect,i=n.point,a=r.height>r.width?r.width/r.height:1,o=r.width>r.height?r.height/r.width:1,s=(i.x-r.x)*o,(c=Math.min(s,l=(r.x+r.width-i.x)*o,u=(i.y-r.y)*a,(r.y+r.height-i.y)*a))===s?"left":c===l?"right":c===u?"top":"bottom"),p={x:t.x,y:t.y,width:t.width,height:t.height},f="below";return"top"===d?(p.height=t.height/2,f="above"):"bottom"===d?(p.height=t.height/2,p.y=t.y+t.height/2,f="below"):"left"===d?(p.width=t.width/2,p.x=t.x,f="leftOf"):"right"===d&&(p.width=t.width/2,p.x=t.x+t.width/2,f="rightOf"),{placement:f,rect:p}}function tR(e){return"handle:"+e.leftPath.join(":")}function tA(e){return(0,X.default)(function(){return(0,eh.selectAtom)(e,function(e){return{width:e.width,height:e.height}},function(e,t){return e.height===t.height&&e.width===t.width})},[e])}function tD(e){return(0,X.default)(function(){return(0,eh.selectAtom)(e,function(e){return{x:e.x,y:e.y}},function(e,t){return e.x===t.x&&e.y===t.y})},[e])}var tV=ex.Type.Object({type:ex.Type.Literal("centered")}),tO=ex.Type.Object({type:ex.Type.Literal("sidebar"),width:ex.Type.Number({minimum:300})}),tF=(0,ea.atom)("leftSidebar"),tM=(0,ea.atom)(function(e){return"leftSidebar"===e(tF)?"agent-filetree":"filetree-agent"});ex.Type.Union([tO,tV]);var tL=(0,ea.atom)({type:"sidebar",width:450});(0,eh.selectAtom)(tL,function(e){return null!==e});var tG=(0,eh.selectAtom)(tL,function(e){return"centered"===e.type});(0,ea.atom)(!0);var tU=(0,ea.atom)(6),tN=(0,ea.atom)(0),tB=(0,ea.atom)(function(e){var t=e(td),n=e(tU),r=n+e(tN),i=e(tM),a=e(tL),o=t.isOpen?t.width+2*n:n,s=n+("sidebar"===a.type?a.width:450)+("sidebar"===a.type&&0===a.width?0:n);return{top:r,bottom:n,left:"agent-filetree"===i?s:o,right:"agent-filetree"===i?o:s}}),tW=(0,ea.atom)(function(e){var t=e(tn),n=e(tU),r=e(tr);return{headerHeight:t,inset:e(tB),gap:n,size:{width:r.width,height:r.height}}}),tz=(0,ea.atom)(null,function(e,t,n){t(tr,n),t(tq,e(tm))});function tH(e,t){return(0,tu.default)(e,t)}var tq=(0,ea.atom)(null,function(e,t,n){var r=function(n){var r=n.paneId,i=n.rect,a=n.type,o=n.isHidden;s.delete(r);var l=e3(r),u=e(l);tH(e(u.rectAtom),i)||t(u.rectAtom,i);var c=(0,eZ.produce)(u,function(e){e.paneId=r,e.type=a,e.isHidden=o});tH(u,c)||t(l,c)},i=e(e0),a=e(e1),o=e(e2),s=new Set(i),l=new Set(a),u=new Set(o),c=function(e,t){var n=t.size,r=t.gap,i=t.headerHeight,a=t.inset,o=void 0===a?eB:a,s=[],l=[],u=[],c=[],d=null,p={x:o.left,y:o.top,width:n.width-(o.left+o.right),height:n.height-(o.top+o.bottom)},f=e.tiling;if((null==f?void 0:f.type)==="paneGroup"){var h={x:p.x,y:p.y+i,width:p.width,height:p.height-i},g={x:h.x,y:h.y-i,width:h.width,height:i};c.push({id:f.id,rect:g,panes:f.panes,activeIndex:f.activeIndex,path:["tiling"]}),l.push.apply(l,(0,en._)(f.panes.map(function(e,t){return{paneId:e,rect:h,active:t===f.activeIndex}})))}else f&&f.children.forEach(function(t,n){return function t(n,a,o,s){var p,f,h,g=a.children.indexOf(n),m=a.children.length,v=a.stacked?o.height:o.width,x=(p=o.width,f=o.height,h=n.percent/100,a.stacked?f=(v-(r*(m-1)+i*m))*h+i:p=(v-r*(m-1))*h,{width:p,height:f}),y=x.width,w=x.height,b=function(){var e=o.x,t=o.y;if(0===g)return{x:e,y:t};if(!d)throw Error("Expected previousRect");return a.stacked?t=d.y+d.height+r:e=d.x+d.width+r,{x:e,y:t}}(),j={x:b.x,y:b.y,height:w,width:y};if(d=j,"paneGroup"===n.type){var _={x:j.x,y:j.y+i,width:j.width,height:j.height-i},S={x:_.x,y:_.y-i,width:_.width,height:i};c.push({id:n.id,rect:S,panes:n.panes,activeIndex:n.activeIndex,path:s}),l.push.apply(l,(0,en._)(n.panes.map(function(e,t){return{paneId:e,rect:_,active:t===n.activeIndex}})))}else n.children.forEach(function(e,r){return t(e,n,j,(0,en._)(s).concat([r]))});if(0!==g){var I={x:j.x-(a.stacked?0:r),y:j.y-(a.stacked?r:0),width:a.stacked?j.width:r,height:a.stacked?r:j.height},C=eR(s),k=(0,en._)(C).concat([g-1]),E=eO(e,k);if(!E||!eA(E))throw Error("Expected leftNode");var T=void 0;0===E.percent?T="left":0===n.percent&&(T="right"),u.push({parentPath:C,leftPath:k,rightPath:s,stacked:a.stacked,rect:I,snapped:T})}}(t,f,p,["tiling",n])});var m={x:p.x-o.left,y:p.y-o.top,width:p.width+o.left+o.right,height:p.height+o.top+o.bottom};return e.floating.forEach(function(e,t){var n=eW(e.rect,{inside:m,minVisibleX:2*i,minVisibleY:i}),r={height:i,width:e.rect.width,x:n.x,y:n.y},a={x:n.x,y:n.y+i,width:e.rect.width,height:Math.max(e.rect.height-i,0)};c.push({id:e.id,rect:r,panes:e.panes,activeIndex:e.activeIndex,path:["floating",t]}),s.push.apply(s,(0,en._)(e.panes.map(function(t,n){return{paneId:t,rect:a,active:n===e.activeIndex}})))}),{tiles:l,gutters:u,headers:c,floating:s}}(n,e(tW)),d=c.tiles,p=c.floating,f=c.gutters,h=c.headers,g=f.map(tR);tH(a,g)||t(e1,g);var m=(0,en._)(d).concat((0,en._)(p)).map(function(e){return e.paneId});tH(i,m)||t(e0,(0,tc.default)(m,{existing:i,getKey:function(e){return e}}));var v=[];h.forEach(function(n){u.delete(n.id);var r=tt(n.id),i=e(r);v.push(n.id),tH(e(i.rectAtom),n.rect)||t(i.rectAtom,n.rect);var a=(0,eZ.produce)(i,function(e){e.panes=n.panes,e.activeIndex=n.activeIndex,e.path=n.path});tH(i,a)||t(r,a)}),tH(o,v)||t(e2,v),d.forEach(function(e){r({paneId:e.paneId,rect:e.rect,isHidden:!e.active,type:"tile"})}),p.forEach(function(e){r({paneId:e.paneId,rect:e.rect,isHidden:!e.active,type:"floating"})}),f.forEach(function(n){var r={handleId:tR(n),rect:n.rect,parentPath:n.parentPath,leftPath:n.leftPath,rightPath:n.rightPath,stacked:n.stacked,snapped:n.snapped};l.delete(r.handleId);var i=te(r.handleId);tH(e(i),r)||t(i,r)}),s.forEach(e3.remove),l.forEach(te.remove),u.forEach(tt.remove);var x=e(ta);x&&s.has(x)&&t(ta,null),t(tm,n)}),tK=e.i(869226),t$=e.i(719518),tQ=e.i(15053),tY=e.i(173738),tX=e.i(282453),tJ=(0,ea.atom)(null),tZ=(0,ea.atom)(null,function(e,t,n){tX.default.set(t4(n.popupId),Date.now()+6048e5),tX.default.set(t2(n.popupId),n.state);var r=!0,i=!1,a=void 0;try{for(var o,s=tX.default.keys().filter(function(e){return e.startsWith(t1)})[Symbol.iterator]();!(r=(o=s.next()).done);r=!0){var l=o.value,u=tX.default.get(l);if("number"==typeof u&&u<Date.now()){var c=l.split(":")[1];tX.default.remove(t4(c)),tX.default.remove(t2(c))}}}catch(e){i=!0,a=e}finally{try{r||null==s.return||s.return()}finally{if(i)throw a}}}),t0=(0,ea.atom)(function(e){return!!e(tJ)}),t1="popup-id-ttl:";function t2(e){return"".concat("popup-id-data:").concat(e)}function t4(e){return"".concat(t1).concat(e)}var t8=(0,ea.atom)(function(e){var t=e(tm),n={};e(e6).forEach(function(t){n[t.paneId]=e(t.dataAtom)});var r=e(tL),i=(null==r?void 0:r.type)==="sidebar"?{width:r.width}:void 0,a=e(td);return{layout:t,data:n,agent:i,filetree:a.isOpen?a:void 0}}),t3=(0,ea.atom)(null),t6=(0,ea.atom)(null),t5=(0,ea.atom)(null),t9=(0,ea.atom)(null,function(e,t,n){return(0,er._)(function(){var r,i,a,o,s,l,u;return(0,ei._)(this,function(c){switch(c.label){case 0:var d;if((r=e(t6))&&!r.retry||r&&Date.now()-r.timestamp<6e4||!e(tI)||(i=e(t8),a=n.replId,o=e(t3),!n.force&&(0,tu.default)(o,i)))return[2];if(s=e(tJ))return t(tZ,{popupId:s,state:i}),t(t3,i),[2];return t(t5,l=(0,tQ.v4)()),[4,(d=i,(0,er._)(function(){var e,t;return(0,ei._)(this,function(n){switch(n.label){case 0:t=void 0,n.label=1;case 1:return n.trys.push([1,3,,4]),[4,null===tY.apolloClient||void 0===tY.apolloClient?void 0:tY.apolloClient.mutate({mutation:q,variables:{input:{replId:a,state:d}}})];case 2:return t=n.sent(),[3,4];case 3:return n.sent(),[2,{success:!1,retry:!0}];case 4:if((null==t||null==(e=t.data)?void 0:e.setReplLayoutState.__typename)==="Repl")return[2,{success:!0,retry:void 0}];return[2,{success:!1,retry:!1}]}})})())];case 1:if(u=c.sent(),e(t5)!==l)return[2];if(t(t5,null),u.retry)return t(t6,{timestamp:Date.now(),retry:!0}),[2];if(!u.success)return t(t6,{timestamp:Date.now(),retry:!1}),[2];return t(t3,i),[2]}})})()}),t7=(0,ea.atom)(null,function(e,t,n){var r=n.data,i=n.layout,a=n.type;Object.entries(r).forEach(function(n){var r=(0,N._)(n,2),i=r[0],a=r[1],o=e3(i);t(o,(0,eZ.produce)(e(o),function(e){e.isCommitted=!0})),t(e(o).dataAtom,a)}),t(tm,i),t(tq,i),t(tE,a),t(t3,e(t8))}),ne=(0,ea.atom)(!1),nt=(0,ea.atom)(function(e){return e(ne)?e(ta):null}),nn=(0,ea.atom)(null,function(e,t,n){t(to,n),t(ne,!0)}),nr=(0,ea.atom)(null,function(e,t,n){t(ne,!0);var r=eL(e(tm),n.paneGroupId);if(!r){var i=Error("Expected paneGroup");throw t(tC,{error:i,tags:{layoutstate:!0},origin:"Layout: state/maximize/maximizePaneGroupAtom"}),i}var a=r.panes[r.activeIndex];if(!a){var o=Error("Expected paneId");throw t(tC,{error:o,tags:{layoutstate:!0},origin:"Layout: state/maximize/maximizePaneGroupAtom"}),o}t(to,a)}),ni=(0,ea.atom)(null,function(e,t){e(t0)||t(ne,!1)}),na=(0,ea.atom)(null,function(e,t,n){e(nt)===n?t(ni):t(nn,n)}),no=(0,ea.atom)(null,function(e,t,n){var r=eL(e(tm),n.paneGroupId);if(!r){var i=Error("Expected paneGroup");throw t(tC,{error:i,tags:{layoutstate:!0},origin:"Layout: state/maximize/toggleMaximizePaneGroupAtom"}),i}var a=r.panes[r.activeIndex];if(!a){var o=Error("Expected paneId");throw t(tC,{error:o,tags:{layoutstate:!0},origin:"Layout: state/maximize/toggleMaximizePaneGroupAtom"}),o}t(na,a)}),ns=(0,ea.atom)(function(e){var t=e(tr),n=t.width+t.x,r=-t.x,i=e(tU);return{x:r,width:n,y:i,height:t.height-i}}),nl=(0,ea.atom)(function(e){var t=e(tn),n=e(ns);return{x:n.x,y:n.y,width:n.width,height:t}}),nu=(0,ea.atom)(function(e){var t=e(tn),n=e(ns);return{x:n.x,y:n.y+t,width:n.width,height:n.height-t}}),nc=e.i(408880),nd=(0,ea.atom)(null,function(e,t,n){var r=eL(e(tm),n);if(!r)return null;t(to,r.panes[r.activeIndex])}),np=(0,ea.atom)(null,function(e,t,n){var r=e(tm),i=eF(r,n);if(!i)throw Error("Expected pane");var a=!i.paneGroup.panes.some(function(e){return e!==n}),o=n===e(ta),s=eU(r,n),l=(0,eZ.produce)(r,function(e){try{e$(e,n)}catch(e){throw t(tC,{error:e,tags:{layoutstate:!0},origin:"Layout: state/removePane/removePaneAtom"}),e}});if(t(tq,l),a&&e(ne)&&!e(t0)&&t(ne,!1),o&&(a||t(nd,i.paneGroup.id),a&&s)){do"split"===s.type&&(s=s.children[0]);while("paneGroup"!==s.type)t(nd,s.id)}}),nf=(0,ea.atom)(null,function(e,t,n){var r=e(tm),i=eF(r,n),a=null==i?void 0:i.paneGroup.panes.filter(function(e){return e!==n});if(null==a?void 0:a.length){var o=(0,eZ.produce)(r,function(e){try{var n=!0,r=!1,i=void 0;try{for(var o,s=a[Symbol.iterator]();!(n=(o=s.next()).done);n=!0){var l=o.value;e$(e,l)}}catch(e){r=!0,i=e}finally{try{n||null==s.return||s.return()}finally{if(r)throw i}}}catch(e){throw t(tC,{error:e,tags:{layoutstate:!0},origin:"Layout: state/removePane/removePaneAtom"}),e}});t(tq,o)}}),nh=(0,ea.atom)(null,function(e,t,n){var r=e(tm),i=eF(r,n);i&&t(tq,(0,eZ.produce)(r,function(e){var t=!1,r=!0,a=!1,o=void 0;try{for(var s,l=i.paneGroup.panes[Symbol.iterator]();!(r=(s=l.next()).done);r=!0){var u=s.value;t&&e$(e,u),u===n&&(t=!0)}}catch(e){a=!0,o=e}finally{try{r||null==l.return||l.return()}finally{if(a)throw o}}}))}),ng=(0,ea.atom)(null,function(e,t,n){var r=e(tm),i=eL(r,n.paneGroupId);if(!i){var a=Error("Expected pane group");throw t(tC,{error:a,tags:{layoutstate:!0},origin:"Layout: state/splits/removePaneGroupAtom"}),a}var o=(0,eZ.produce)(r,function(e){try{i.panes.forEach(function(t){e$(e,t)})}catch(e){throw t(tC,{error:e,tags:{layoutstate:!0},origin:"Layout: state/splits/removePaneGroupAtom"}),e}});e(ne)&&!e(t0)&&t(ne,!1),t(tq,o)}),nm=(0,ea.atom)(null,function(e,t,n){var r=e(tm),i=eF(r,n.paneId);if(!i){var a=Error("Expected relativeToPane");throw t(tC,{error:a,tags:{layoutstate:!0},origin:"Layout: state/splits/splitPaneAtom"}),a}var o=(0,tQ.v4)();t(e(e3(o)).dataAtom,{type:"commands",data:{autoFocus:!!n.autoFocus}});var s=(0,eZ.produce)(r,function(e){try{ez(e,{id:(0,tQ.v4)(),isFloating:!1,placement:n.placement,relativeTo:i.paneGroupPath,panes:[o]})}catch(e){throw t(tC,{error:e,tags:{layoutstate:!0},origin:"Layout: state/splits/splitPaneAtom"}),e}});t(tq,s),t(to,o)}),nv=(0,ea.atom)(null,function(e,t,n){var r=e(tm),i=(0,tQ.v4)();t(e(e3(i)).dataAtom,n.pane),(0,ti.isToolPane)(n.pane)&&t(ts,i);var a=(0,eZ.produce)(r,function(e){try{ez(e,{id:(0,tQ.v4)(),isFloating:!1,placement:n.placement,relativeTo:n.relativeTo,panes:[i],percent:n.percent})}catch(e){throw t(tC,{error:e,tags:{layoutstate:!0},origin:"Layout: state/splits/insertSplitPaneAtom"}),e}});return t(tq,a),i}),nx=(0,ea.atom)(null,function(e,t,n){var r=e(tm);t(tq,(0,eZ.produce)(r,function(e){eJ(e,{leftPath:n.leftPath,percent:n.percent})}))}),ny=e.i(965863),nw=(0,ea.atom)(null,function(e,t,n){if(0===n.panes.length){var r=Error("Expect at least one pane");throw t(tC,{error:r,origin:"Layout: state/insertPaneGroup/insertPaneGroupAtom"}),r}var i=e(tm),a=n.panes.map(function(){return(0,tQ.v4)()}),o=(0,eZ.produce)(i,function(e){try{ez(e,{id:(0,tQ.v4)(),panes:a,relativeTo:n.relativeTo||["tiling"],placement:n.placement,percent:n.percent})}catch(e){throw t(tC,{error:e,tags:{layoutstate:!0},origin:"Layout: state/insertPaneGroup/insertPaneGroupAtom"}),e}});if(t(tq,o),n.panes.forEach(function(n,r){var i=a[r];t(e(e3(i)).dataAtom,n),(0,ti.isToolPane)(n)&&t(ts,i);var o=(0,ti.isSingleton)(n.type)?e(e6).find(function(t){return e(t.dataAtom).type===n.type&&t.paneId!==i}):null;o&&t(np,o.paneId)}),n.commit){var s=!0,l=!1,u=void 0;try{for(var c,d=a[Symbol.iterator]();!(s=(c=d.next()).done);s=!0){var p=c.value;t(ts,p)}}catch(e){l=!0,u=e}finally{try{s||null==d.return||d.return()}finally{if(l)throw u}}}return n.makeActive&&t(to,a[0]),a}),nb={top:"above",left:"leftOf",right:"rightOf",bottom:"below"},nj=(0,ea.atom)(null,function(e,t,n){t(nv,{pane:n.pane,relativeTo:["tiling"],placement:nb[n.edge]})}),n_=(0,ea.atom)(null,function(e,t,n){var r=e(tm),i=(0,tQ.v4)(),a=(0,tQ.v4)(),o=(0,eZ.produce)(r,function(e){try{ez(e,{id:a,panes:[i],isFloating:!0,rect:n.rect})}catch(e){throw t(tC,{error:e,tags:{layoutstate:!0},origin:"Layout: state/insertPaneGroup/insertFloatingPaneGroupAtom"}),e}});return t(tq,o),t(e(e3(i)).dataAtom,n.pane),(0,ti.isToolPane)(n.pane)&&t(ts,i),n.makeActive&&(t(to,i),n.makeModal&&t(ny.modalPaneGroupIdAtom,a)),i}),nS=(0,ea.atom)(null,function(e,t,n){var r=n.paneId,i=n.activate,a=e(tm);if("tile"===e(e3(r)).type?t(tq,(0,eZ.produce)(a,function(e){try{!function(e,t){var n=eF(e,t.paneId);if(n){var r=n.paneGroupPath;n.paneGroup.activeIndex=n.index;var i=r.map(function(e,t){return r.slice(0,t+1)}),a=!0,o=!1,s=void 0;try{for(var l,u=i[Symbol.iterator]();!(a=(l=u.next()).done);a=!0){var c=l.value,d=eO(e,c);if(!d)throw Error("Expected node");if("floatingPaneGroup"===d.type)throw Error("Expected tiled pane");if(1!==c.length){var p=c[c.length-1];if("number"!=typeof p)throw Error("Expected number");var f=eO(e,eR(c));if((null==f?void 0:f.type)!=="split")throw Error("Expected split");var h=f.stacked?t.minPercentVertical:t.minPercentHorizontal;if(!(d.percent>=h)){var g=p===f.children.length-1,m=g?(0,en._)(c.slice(0,-1)).concat([p-1]):c,v=g?f.children[p-1].percent-(h-d.percent):h;eJ(e,{leftPath:m,percent:v})}}}}catch(e){o=!0,s=e}finally{try{a||null==u.return||u.return()}finally{if(o)throw s}}}}(e,{paneId:r,minPercentHorizontal:30,minPercentVertical:20})}catch(e){throw t(tC,{error:e,origin:"Layout: revealPaneAtom/revealTiledPane"}),e}})):t(tq,(0,eZ.produce)(a,function(e){try{!function(e,t){var n=eF(e,t.paneId);if(n){var r=n.paneGroup;if("floatingPaneGroup"!==r.type)throw Error("Expected floatingPaneGroup");r.activeIndex=n.index,r.rect.width=Math.max(r.rect.width,t.minWidth),r.rect.height=Math.max(r.rect.height,t.minHeight)}}(e,{paneId:r,minWidth:200,minHeight:140})}catch(e){throw t(tC,{error:e,origin:"Layout: revealPaneAtom/revealFloatingPane"}),e}})),!i){var o=eF(a,r),s=e(ta);if(!o)throw Error("Expected pane");if(!s)return;var l=eF(a,s);if(!l)throw Error("Expected active pane");if(l.paneGroup.id!==o.paneGroup.id)return}t(to,r)}),nI=(0,ea.atom)(null),nC=(0,eh.selectAtom)(nI,function(e){return null!==e}),nk=(0,ea.atom)(null,function(e,t,n){t(nI,n),requestAnimationFrame(function(){t(nI,null)})}),nE=(0,ea.atom)(null),nT=(0,ea.atom)(null),nP=(0,eh.selectAtom)(nT,Boolean),nR=(0,ea.atom)(null,function(e,t,n){switch(n.type){case"start":var r=e(tL);if("sidebar"!==r.type)return;t(nT,{startWidth:r.width});break;case"update":var i=e(nT);if(!i)return;var a=e(tM),o=i.startWidth+n.moveDelta.x*("filetree-agent"===a?-1:1),s=.5*e(tr).width;t(tL,function(e){return(0,eZ.produce)(e,function(e){"sidebar"===e.type&&(o<300?e.width=300-o>150?0:300:o>s?e.width=s:e.width=o)})}),t(tq,e(tm));break;case"end":var l=e(tL);if("sidebar"!==l.type)return;var u=e(nT);if(t(nT,null),l.width>0&&l.width<300&&u){var c={width:l.width}.width>u.startWidth;t(nA,(0,x._)({type:"sidebar"},c?{width:450}:{width:300}))}}}),nA=(0,ea.atom)(null,function(e,t,n){t(nk,{headers:new Map(e(e2).map(function(e){return[e,{snappiness:400}]})),panes:new Map(e(e0).map(function(e){return[e,{snappiness:400}]}))}),t(tL,n),t(tq,e(tm))}),nD=(0,ea.atom)(null,function(e,t,n){t(nA,{type:"sidebar",width:450*!!n})}),nV=(0,eh.selectAtom)(tL,function(e){return"sidebar"===e.type&&0===e.width}),nO=(0,ea.atom)(null,function(e,t,n){t(nA,"centered"===n?{type:n}:{type:"sidebar",width:450})}),nF=(0,ea.atom)(null,function(e,t,n){t(nD,!0);var r=e(nE);null==r||r.setSessionId(null!=n?n:null),null==r||r.focusInput()}),nM=(0,ea.atom)(null,function(e,t,n){if(0===n.panes.length)return[];var r=e(tm),i=n.panes.map(function(){return(0,tQ.v4)()}),a=(0,eZ.produce)(r,function(e){try{eq(e,{paneIds:i,activate:n.activate,paneGroupId:n.paneGroupId,index:n.index})}catch(e){throw t(tC,{error:e,tags:{layoutstate:!0},origin:"Layout: state/tabs/insertPanesAtom"}),e}});return t(tq,a),n.panes.forEach(function(r,a){var o=i[a];t(e(e3(o)).dataAtom,r);var s=(0,ti.isSingleton)(r.type)?e(e6).find(function(t){return e(t.dataAtom).type===r.type&&t.paneId!==o}):null;s&&t(np,s.paneId),(n.commit||(0,ti.isToolPane)(r))&&t(ts,o)}),n.activate&&t(nS,{paneId:(0,N._)(i,1)[0],activate:!0}),i}),nL=(0,ea.atom)(null,function(e,t,n){var r,i=n.pane,a=n.activate,o=n.commit,s=n.placement;if("agentChat"===i.type)return void t(nF,null==(r=i.data)?void 0:r.sessionId);var l=e(tm);if(!l.tiling){var u=t(nv,{pane:i,relativeTo:["tiling"],placement:"replace"});return a&&t(to,u),u}if("after"===s.type){var c=eF(l,s.paneId);if(c){var d=(0,N._)(t(nM,{panes:[i],paneGroupId:c.paneGroup.id,index:c.index+1,activate:a}),1)[0];return a&&t(to,d),d}}if("secondary"===s.type&&s.relativeTo){var p=eU(l,s.relativeTo);if(p){if("paneGroup"===p.type){var f=(0,N._)(t(nM,{panes:[i],paneGroupId:p.id,activate:a}),1)[0];return a&&t(to,f),f}var h=t(nv,{pane:i,relativeTo:s.relativeTo,placement:"rightOf"});return a&&t(to,h),h}var g=eF(l,s.relativeTo);if((null==g?void 0:g.paneGroup.type)==="floatingPaneGroup"){var m=e(e3(s.relativeTo)),v=e(m.rectAtom);return t(n_,{rect:{x:v.x+v.width,y:v.y,width:v.width,height:v.height},pane:i,makeActive:a})}}var x=t(nv,{pane:i,relativeTo:["tiling"],placement:"rightOf"});return a&&t(to,x),o&&t(ts,x),x}),nG=e.i(903381),nU=(0,ea.atom)(null,function(e,t,n){var r;t(e(e3(n.paneId)).dataAtom,n.pane),(n.makeActive||n.reveal)&&t(nS,{paneId:n.paneId,activate:null!=(r=n.makeActive)&&r}),(n.commit||(0,ti.isToolPane)(n.pane))&&t(ts,n.paneId)}),nN=((t={}).EXACT="EXACT",t.FUZZY="FUZZY",t.NONE="NONE",t);function nB(e,t){return(null==e?void 0:e.ports)||(null==t?void 0:t.ports)?(null==e?void 0:e.ports)&&!(null==t?void 0:t.ports)||!(null==e?void 0:e.ports)&&(null==t?void 0:t.ports)?"FUZZY":(null==e?void 0:e.ports)&&(null==t?void 0:t.ports)&&e.ports.port!==t.ports.port?"NONE":(null==e?void 0:e.ports)&&(null==t?void 0:t.ports)&&e.ports.port===t.ports.port?e.ports.path===t.ports.path?"EXACT":"FUZZY":"NONE":"EXACT"}var nW=(0,ea.atom)(null,function(e,t,n){var r=e(tm),i=eF(r,n);if(!i){var a=Error("Expected selectedPane");throw t(tC,{error:a,tags:{layoutstate:!0},origin:"Layout: state/tabs/selectTabAtom"}),a}t(tt(i.paneGroup.id),function(e){return(0,eZ.produce)(e,function(e){e.activeIndex=i.index})});var o=!0,s=!1,l=void 0;try{for(var u,c=i.paneGroup.panes[Symbol.iterator]();!(o=(u=c.next()).done);o=!0){var d=u.value,p=e3(d);t(p,function(e){return(0,eZ.produce)(e,function(e){e.isHidden=e.paneId!==n})})}}catch(e){s=!0,l=e}finally{try{o||null==c.return||c.return()}finally{if(s)throw l}}t(tm,(0,eZ.produce)(r,function(e){try{var r=eF(e,n);if(!(null==r?void 0:r.paneGroup))throw Error("Expected pane group");var i=r.paneGroup,a=i.panes.indexOf(n);if(-1===a)throw Error("Expected index");i.activeIndex=a}catch(e){throw t(tC,{error:e,tags:{layoutstate:!0},origin:"Layout: state/tabs/selectTabAtom"}),e}})),0===e(e(e3(n)).rectAtom).width?t(nS,{paneId:n,activate:!0}):t(to,n)}),nz=(0,ea.atom)(null,function(e,t,n){var r=e(tm),i=eM(r,"topRight"),a=eM(r,"topLeft");if(!i||!a||!r.tiling){var o=t(nv,{pane:n,relativeTo:["tiling"],placement:"replace"});t(ts,o);return}if("paneGroup"===r.tiling.type){var s=t(nv,{pane:n,relativeTo:["tiling"],placement:"rightOf"});t(ts,s);return}if("split"===r.tiling.type&&2===r.tiling.children.length&&"paneGroup"===r.tiling.children[1].type){var l=r.tiling.stacked,u=t(nv,{pane:n,relativeTo:i.path,placement:l?"rightOf":"above"});t(ts,u);return}t(nM,{panes:[n],paneGroupId:i.paneGroup.id,commit:!0})}),nH=(0,ea.atom)(null,function(e,t,n){if(!e(e6).find(function(t){var r=e(t.dataAtom);return"webview"===r.type&&nB(n,r.data)!==nN.NONE}))return void t(nz,{type:"webview",data:n})}),nq=(0,ea.atom)(null,function(e,t,n){var r=e(tm),i=(0,eZ.produce)(r,function(e){var r=eF(e,n.paneId);if(!r){var i=Error("Expected pane");throw t(tC,{error:i,tags:{layoutstate:!0},origin:"Layout: state/tabs/movePaneAtom"}),i}var a=eL(e,n.toPaneGroupId);if(!a){var o=Error("Expected toPaneGroup");throw t(tC,{error:o,tags:{layoutstate:!0},origin:"Layout: state/tabs/movePaneAtom"}),o}var s=1===r.paneGroup.panes.length,l=!a.panes.includes(n.paneId);if(!s||l)try{e$(e,n.paneId),eq(e,{paneIds:[n.paneId],paneGroupId:n.toPaneGroupId,index:n.index}),l&&t(ts,n.paneId)}catch(e){throw t(tC,{error:e,tags:{layoutstate:!0},origin:"Layout: state/tabs/movePaneAtom"}),e}});t(tq,i)}),nK=(0,ea.atom)(null,function(e,t,n){var r=e(ta);if(r){var i=e(tm),a=eF(i,r);if(a){var o=a.paneGroup,s=eN({relativeTo:r,rects:new Map(e(e6).filter(function(e){return!e.isHidden}).map(function(t){return[t.paneId,e(t.rectAtom)]})),direction:n}),l=s?eF(i,s):null;if(l)return void t(nq,{paneId:r,toPaneGroupId:l.paneGroup.id});var u=o.panes.find(function(e){return e!==r});u&&t(tq,(0,eZ.produce)(i,function(e){e$(e,r),ez(e,{id:(0,tQ.v4)(),relativeTo:u,panes:[r],placement:n})}))}}}),n$=(0,ea.atom)(!1),nQ=(0,ea.atom)(null,function(e,t,n){var r=e(tv).map(function(t){return{paneId:t.paneId,path:(0,ti.getFilePathForPane)(e(t.dataAtom))}}).filter(function(e){return n===e.path}),i=[],a=e(tm),o=(0,eZ.produce)(a,function(e){var n=!0,a=!1,o=void 0;try{for(var s,l=r[Symbol.iterator]();!(n=(s=l.next()).done);n=!0){var u=s.value.paneId,c=eF(e,u);if(!c){var d=Error("Expected pane");throw t(tC,{error:d,tags:{layoutstate:!0},origin:"Layout: state/tabs/removePanesForFileAtom"}),d}c.floating||1!==c.paneGroup.panes.length?e$(e,u):i.push(u)}}catch(e){a=!0,o=e}finally{try{n||null==l.return||l.return()}finally{if(a)throw o}}}),s=!0,l=!1,u=void 0;try{for(var c,d=i[Symbol.iterator]();!(s=(c=d.next()).done);s=!0){var p=c.value;t(nU,{paneId:p,pane:{type:"commands",data:{autoFocus:!1}}})}}catch(e){l=!0,u=e}finally{try{s||null==d.return||d.return()}finally{if(l)throw u}}t(tq,o)}),nY=(0,ea.atom)(null,function(e,t,n){var r=n.node.path;if(n.eventType===nG.ChangeEventType.Delete)return void t(nQ,r);var i=e(tv).filter(function(t){return(0,ti.getFilePathForPane)(e(t.dataAtom))===r}),a={type:(0,ti.getPaneTypeForFile)({path:n.to}),data:{path:n.to}},o=!0,s=!1,l=void 0;try{for(var u,c=i[Symbol.iterator]();!(o=(u=c.next()).done);o=!0){var d=u.value.paneId;t(nU,{paneId:d,pane:a})}}catch(e){s=!0,l=e}finally{try{o||null==c.return||c.return()}finally{if(s)throw l}}}),nX=(0,ea.atom)(null,function(e,t,n){var r=e(ta),i=e(tm);if(r){var a=eF(i,r);if(a)return void t(nM,{panes:n,paneGroupId:null==a?void 0:a.paneGroup.id,activate:!0,index:a.index+n.length})}var o=eM(i,"topLeft");if(o)return void t(nM,{activate:!0,paneGroupId:o.paneGroup.id,index:o.paneGroup.activeIndex+n.length,panes:n});var s=i.floating.length?i.floating[0]:null;s?t(nM,{activate:!0,paneGroupId:s.id,index:s.activeIndex+n.length,panes:n}):t(nw,{panes:n,placement:"leftOf",makeActive:!0,relativeTo:["tiling"]})}),nJ=(0,ea.atom)(null,function(e,t){t(nX,[{type:"commands",data:{autoFocus:!0}}])}),nZ=(0,ea.atom)(null,function(e,t){var n=e(ta);return!!n&&(t(np,n),!0)}),n0=(0,ea.atom)(null,function(e,t,n){var r=e(ta);if(r){var i=function(e,t){var n=t.paneId,r=t.dir,i=eF(e,n);if(i){var a=i.index,o=i.paneGroup.panes;return"previous"===r?o[0===a?o.length-1:a-1]:o[a===o.length-1?0:a+1]}}(e(tm),{paneId:r,dir:n});i&&t(nW,i)}}),n1=(0,ea.atom)(null,function(e,t,n){var r=n.paneId,i=n.pane;t(nU,{paneId:r,pane:i});var a=(0,ti.isSingleton)(i.type)?e(e6).find(function(t){return e(t.dataAtom).type===i.type&&t.paneId!==r}):null;if(a){var o=eF(e(tm),a.paneId);if(!(null==o?void 0:o.floating)&&(null==o?void 0:o.paneGroup.panes.length)===1)return void t(nU,{paneId:a.paneId,pane:{type:"commands",data:{autoFocus:!1}}});t(np,a.paneId)}}),n2=(0,ea.atom)(null,function(e,t,n){var r=e(e(e3(n.b)).dataAtom);t(nU,{paneId:n.a,pane:r});var i=eF(e(tm),n.b);(null==i?void 0:i.floating)||(null==i?void 0:i.paneGroup.panes.length)!==1?t(np,n.b):t(n1,{paneId:n.b,pane:{type:"commands",data:{autoFocus:!1}}})}),n4=(0,ea.atom)(null,function(e,t,n){var r=e3(n);t(r,function(e){return(0,eZ.produce)(e,function(e){e.highlight=!0})}),setTimeout(function(){t(r,function(e){return(0,eZ.produce)(e,function(e){e.highlight=!1})})},200)}),n8=(0,ea.atom)(null,function(e,t,n){if("agentChat"===n.pane.type){var r;t(nF,null==(r=n.pane.data)?void 0:r.sessionId);return}var i=e(tm),a=n.activate,o=void 0===a||a,s=n.update,l=void 0===s||s,u=function(r){return r.paneId===e(ta)&&t(n4,r.paneId),(o||n.reveal)&&t(nW,r.paneId),l&&t(nU,{paneId:r.paneId,pane:n.pane,makeActive:o,reveal:n.reveal}),r.paneId};if("diff"===n.pane.type){var c=e(e6).find(function(t){var r=e(t.dataAtom);return(0,nc.default)(r,n.pane)});if(c)return u(c)}if("webview"===n.pane.type){var d=e(e6).filter(function(t){return"webview"===e(t.dataAtom).type}),p=d.find(function(t){var r=e(t.dataAtom);return"webview"===r.type&&"webview"===n.pane.type&&nB(r.data,n.pane.data)!==nN.NONE});if(p)return u(p);if(d.length>0)return u(d[0])}var f=e(e6).find(function(t){return e(t.dataAtom).type===n.pane.type});if((0,ti.isSingleton)(n.pane.type)&&f)return u(f);var h=eM(i,"topRight");if(!h)return t(nw,{panes:[n.pane],placement:"rightOf",relativeTo:["tiling"],makeActive:o,commit:n.commit})[0];var g=h.paneGroup.panes.find(function(t){var n=e(e3(t));if(n.isHidden)return!1;var r=e(n.dataAtom);return!n.isCommitted&&!(0,ti.isFilePaneType)(r.type)});if(g)return t(nU,{paneId:g,pane:n.pane,makeActive:o,reveal:n.reveal}),g;var m=!!n.commit||o,v=t(nM,{panes:[n.pane],paneGroupId:h.paneGroup.id,activate:m,commit:n.commit});return n.reveal&&t(nS,{paneId:v[0],activate:m}),v[0]}),n3=e.i(151386),n6=(0,ea.atom)(!1),n5=(0,ea.atom)(!1),n9=(0,B.createContext)(null);function n7(e){var t,n,r,i=e.children,a=e.savedLayoutState,o=e.popupId,s=e.initialPane,l=e.agentCenteredLayout,u=void 0!==l&&l,c=e.agentLayoutVariation,d=e.agentPosition,p=void 0===d?"leftSidebar":d,f=e.isTouring,h=void 0!==f&&f,g=(0,n3.useFilePaneFlag)(),x=(t=(0,v.useRouter)(),n=(0,J.isInBonsaiWebview)(t),r=(0,J.doesBonsaiWebviewSupportFeature)(t,"workspace2"),n&&!r?6:F.APP_HEADER_HEIGHT),y=(0,Y.default)(),w=(0,N._)((0,B.useState)(function(){var e,t,n=(0,ea.createStore)();if(n.set(tF,p),n.set(n5,g),n.set(n6,y),n.set(tN,y?x:0),y||n.set(tr,{width:window.innerWidth,height:window.innerHeight,x:0,y:0}),o&&(n.set(tJ,o),n.set(ne,!0)),h)n.set(td,{width:180,isOpen:!0});else if(null==a?void 0:a.filetree){var r,i=(r=a.filetree.width,Math.min(Math.round(.4*window.innerWidth),r));n.set(td,{width:i,isOpen:i>0})}if(u)n.set(tL,{type:"centered"});else{var l,d,f=null!=(d=null==a||null==(l=a.agent)?void 0:l.width)?d:null;n.set(tL,{type:"sidebar",width:null===f?450:Math.min(Math.round(.5*window.innerWidth),f)})}var m=null!=a?a:(e=(0,tQ.v4)(),t={type:"split-with-console"===c?"runnerOutput":"split-with-automations"===c?"automations":"webview"},{data:(0,P._)({},e,t),layout:{floating:[],tiling:{type:"paneGroup",panes:[e],activeIndex:0,id:(0,tQ.v4)(),percent:100}},type:"default"});return n.set(t7,m),null!=s&&(n.get(e5).some(function(e){return n.get(e.dataAtom).type===(null==s?void 0:s.type)})||n.set(n8,{pane:s,commit:!0})),n}),1)[0];return(0,m.jsx)(n9.Provider,{value:w,children:i})}function re(){var e=(0,B.useContext)(n9);if(!e)throw Error("Expected store in context");return e}function rt(e){return(0,eo.useAtomValue)(e,{store:re()})}function rn(e){return(0,ev.useCreateObservableAtom)(e,re())}var rr=function(e){return(0,eo.useSetAtom)(e,{store:re()})};function ri(e){return(0,t$.useAtomCallback)((0,B.useCallback)(function(t){return t(e)},[e]),{store:re()})}var ra=e.i(323049),ro=e.i(446530),rs=e.i(123850),rl=(0,ea.atom)(null),ru=(0,rs.createCssVarTokens)(["backgroundColor","borderRadius","zIndex","border","opacity","visibility","width","height","x","y","innerScale","innerOpacity"]),rc=ru.cssVars,rd=ru.styleTokens,rp=(0,eh.selectAtom)(rl,function(e){return(0,P._)({},rc.border,(null==e?void 0:e.type)==="detachPreview"&&e.progress<.98?"1px dashed ".concat(A.tokens.foregroundDefault):"1px solid ".concat(A.tokens.accentPrimaryDefault))},tu.default),rf=(0,eh.selectAtom)(rl,function(e){return null==e?void 0:e.rect},tu.default),rh=(0,eh.selectAtom)(rf,function(e){var t;return e?(t={},(0,P._)(t,rc.width,e.width+"px"),(0,P._)(t,rc.height,e.height+"px"),t):null},tu.default),rg=(0,eh.selectAtom)(rf,function(e){var t;return e?(t={},(0,P._)(t,rc.x,e.x+"px"),(0,P._)(t,rc.y,e.y+"px"),t):null},tu.default),rm=(0,eh.selectAtom)(rl,function(e){var t,n;return e?"detachPreview"===e.type?(t={},(0,P._)(t,rc.zIndex,ra.zIndexLevels.detachPreview.toString()),(0,P._)(t,rc.borderRadius,"100%"),(0,P._)(t,rc.backgroundColor,"transparent"),t):(n={},(0,P._)(n,rc.zIndex,ra.zIndexLevels.dropPreview.toString()),(0,P._)(n,rc.borderRadius,"8px"),(0,P._)(n,rc.backgroundColor,A.tokens.accentPrimaryDimmer),n):null},tu.default),rv=(0,eh.selectAtom)(rl,function(e){var t,n,r;return e?"detachPreview"===e.type?(n={},(0,P._)(n,rc.opacity,(.5*e.progress).toString()),(0,P._)(n,rc.visibility,"visible"),n):(r={},(0,P._)(r,rc.opacity,"0.2"),(0,P._)(r,rc.visibility,"visible"),r):(t={},(0,P._)(t,rc.opacity,"0"),(0,P._)(t,rc.visibility,"hidden"),t)},tu.default),rx=(0,eh.selectAtom)(rl,function(e){return(0,P._)({},rc.innerOpacity,(null==e?void 0:e.type)==="detachPreview"?"0.5":"0")},tu.default),ry=(0,eh.selectAtom)(rl,function(e){return(0,P._)({},rc.innerScale,(null==e?void 0:e.type)==="detachPreview"?e.progress.toString():"1")},tu.default),rw=(0,ro.cssRecord)({root:[{position:"absolute",pointerEvents:"none",opacity:rd.opacity,width:rd.width,height:rd.height,transform:"translate(".concat(rd.x,", ").concat(rd.y,")"),backgroundColor:rd.backgroundColor,borderRadius:rd.borderRadius,border:rd.border,zIndex:rd.zIndex,visibility:rd.visibility,transition:"transform 140ms, width 140ms, height 140ms, border-radius 140ms, opacity 140ms ease-out 200ms","@media (prefers-reduced-motion: reduce)":{transitionDuration:"0ms"}}],inner:[{width:"100%",height:"100%",borderRadius:"100%",background:"radial-gradient(transparent, ".concat(A.tokens.backgroundHighest,")"),opacity:rd.innerOpacity,transform:"scale(".concat(rd.innerScale,")")}]}),rb=(0,B.memo)(function(){var e=(0,B.useRef)(null);(0,tK.useStyleSet)(e,rn(rg)),(0,tK.useStyleSet)(e,rn(rh)),(0,tK.useStyleSet)(e,rn(rp)),(0,tK.useStyleSet)(e,rn(rm)),(0,tK.useStyleSet)(e,rn(rv));var t=(0,B.useRef)(null);return(0,tK.useStyleSet)(t,rn(rx)),(0,tK.useStyleSet)(t,rn(ry)),(0,m.jsx)("div",{ref:e,css:rw.root,children:(0,m.jsx)("div",{ref:t,css:rw.inner})})}),rj=(0,ea.atom)(function(e){var t=e(td),n=e(tr),r=e(tU),i=e(tn)+r,a=t.width,o=t.isOpen,s={y:i,width:a,isOpen:o,opacity:+!!o,height:n.height-i};return"agent-filetree"===e(tM)?(0,x._)({x:o?n.width-a-r:n.width},s):(0,x._)({x:o?r:-(a+r)},s)}),r_=(0,ea.atom)(function(e){var t=e(td),n=e(tU);return t.isOpen?{isOpen:!0,width:n}:{isOpen:!1,width:n}}),rS=(0,ea.atom)(function(e){var t=e(rj),n=e(tM),r=e(tL),i=e(tU),a="sidebar"===r.type?r.width:450;switch(n){case"filetree-agent":return{left:t.isOpen?t.width+2*i:i,right:i+a+i};case"agent-filetree":return{right:t.isOpen?t.width+2*i:i,left:i+a+i}}return{right:i,left:t.isOpen?t.width+i:i}}),rI=(0,ea.atom)(null,function(e,t){t(rl,{type:"dropPreview",rect:e(rk)})}),rC=(0,ea.atom)(null,function(e,t,n){t(rl,null),t(n$,!1),t(nw,{panes:n.panes,placement:"leftOf",makeActive:!0,relativeTo:["tiling"]})}),rk=(0,ea.atom)(function(e){if(e(t0))return e(ns);var t=e(tN),n=e(tr),r=e(tU),i=e(tn),a=e(rS),o=i+t+r;return{x:a.left,y:o,width:n.width-a.left-a.right,height:n.height-o-r}}),rE=(0,ea.atom)(null),rT=(0,ea.atom)(null,function(e,t){var n=e(td);t(rE,{startWidth:n.width,startIsOpen:n.isOpen})}),rP=(0,ea.atom)(function(e){return!!e(rE)}),rR=(0,ea.atom)(null,function(e,t,n){var r=e(rE);if(r){var i=n*("agent-filetree"===e(tM)?-1:1),a=.4*e(tr).width,o=Math.min(Math.max(r.startWidth+i,0),a),s=i>0;0===o&&s?o=140:!s&&o<140&&140-o>20&&(o=0),t(td,function(e){return(0,eZ.produce)(e,function(e){e.width=o,0===o?e.isOpen=!1:e.isOpen=r.startIsOpen})}),r.startIsOpen&&t(tq,e(tm))}}),rA=(0,ea.atom)(null,function(e,t){var n=e(td),r=e(rE);n.isOpen||t(td,function(e){return(0,eZ.produce)(e,function(e){var t;e.width=null!=(t=null==r?void 0:r.startWidth)?t:140})}),t(rE,null)});function rD(){var e=(0,y._)(["\n  query FiletypeAssociations {\n    currentUser {\n      id\n      filetypeAssociations\n    }\n  }\n"]);return rD=function(){return e},e}function rV(){var e=(0,y._)(["\n  mutation SetFiletypeAssociation($input: FiletypeAssociationInput!) {\n    setFiletypeAssociation(input: $input) {\n      ... on UserFiletypeAssociations {\n        associations\n      }\n      ... on UnauthorizedError {\n        message\n      }\n      ... on UserError {\n        message\n      }\n      ... on Error {\n        message\n      }\n    }\n  }\n"]);return rV=function(){return e},e}var rO={},rF=(0,w.gql)(rD()),rM=(0,w.gql)(rV()),rL=(0,ea.atom)({}),rG=(0,ea.atom)(null),rU=(0,ea.atom)(null,function(e,t,n){(0,tu.default)(n,e(rL))||t(rL,n)}),rN=(0,ea.atom)(null,function(e,t,n){return(0,er._)(function(){var r,i,a,o,s,l;return(0,ei._)(this,function(u){switch(u.label){case 0:r=e(rL),t(rU,(0,eZ.produce)(r,function(e){n.newAssociation?e[n.fileExtension]={extensionId:n.newAssociation.extensionId,fileHandlerId:n.newAssociation.fileHandlerId}:delete e[n.fileExtension]})),u.label=1;case 1:return u.trys.push([1,3,,4]),[4,null===tY.apolloClient||void 0===tY.apolloClient?void 0:tY.apolloClient.mutate({mutation:rM,variables:{input:n}})];case 2:if((null==(o=u.sent())||null==(a=o.data)||null==(i=a.setFiletypeAssociation)?void 0:i.__typename)!=="UserFiletypeAssociations")throw Error("Failed to set Filetype Association: "+(null==o||null==(l=o.data)||null==(s=l.setFiletypeAssociation)?void 0:s.message));return[3,4];case 3:return u.sent(),t(rL,r),[3,4];case 4:return[2]}})})()}),rB=1920/1020,rW=(0,ea.atom)(null,function(e,t,n){var r,i,a,o,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{location:"bottomRight"},l=e(e6).find(function(t){return e(t.dataAtom).type===n.type});if(l){t(nU,{paneId:l.paneId,pane:n}),s.commit&&t(ts,l.paneId);return}var u=e(tr),c=e(tn),d=t(n_,{pane:n,rect:"bottomRight"===s.location?{width:r=Math.min(600,u.width),height:i=Math.min(600/rB+c,u.height),x:u.width-r,y:u.height-i}:(o=Math.min((a=Math.min(600,u.width))/rB+c,u.height),{width:a,height:o,x:(u.width-a)/2,y:(u.height-o)/2})});s.commit&&t(ts,d)}),rz=(0,ea.atom)(null,function(e,t,n){e(e6).filter(function(t){return e(t.dataAtom).type===n}).forEach(function(e){return t(np,e.paneId)})}),rH=(0,ea.atom)(null),rq=(0,ea.atom)(null,function(e,t,n){if("end"===n.type)return void t(rH,null);if("update"===n.type){var r=e(rH);if(!r){var i=Error("Expected tilingResize");throw t(tC,{error:i,tags:{layoutstate:!0},origin:"Layout: state/resizeTiling"}),i}var a=r.stacked,o=r.leftPath,s=r.startPercent,l=r.resizeDistance,u=r.initialLayout,c=r.snapPercent,d=s+(a?n.moveDelta.y:n.moveDelta.x)/l*100,p=e(tr);d/100*p.width<240&&(d=240/p.width*100),t(tq,(0,eZ.produce)(u,function(e){eJ(e,{leftPath:o,percent:d,snapPercent:c})}));return}var f=e(tm),h=n.stacked?window.innerHeight:window.innerWidth,g=eO(f,n.leftPath);if(!g||!eA(g)){var m=Error("Expected left node");throw t(tC,{error:m,tags:{layoutstate:!0},origin:"Layout: state/resizeTiling"}),m}var v=eR(n.leftPath),x=g.percent,y=null;try{y=function(e){var t=e.layout,n=e.splitPath,r=e.tilingOptions,i=function(e,t){var n=t.splitPath,r=eO(e,n);if(!r||"split"!==r.type)throw Error("Expected split node");for(var i=100,a=eR(n);a.length;){var o=eO(e,a);if(!o)break;a=eR(a),"split"===o.type&&o.stacked===r.stacked&&(i*=o.percent/100)}return i}(t,{splitPath:n}),a=eO(t,n);if((null==a?void 0:a.type)!=="split")throw Error("Expected split node");var o=r.size,s=r.gap,l=r.headerHeight,u=r.inset,c=void 0===u?{top:0,bottom:0,left:0,right:0}:u,d=a.children.length,p=a.stacked?s*(d-1)+l*d:s*(d-1);return i/100*((a.stacked?o.height-(c.top+c.bottom):o.width-(c.left+c.right))-p)}({splitPath:v,layout:f,tilingOptions:e(tW)})}catch(e){throw t(tC,{error:e,tags:{layoutstate:!0},origin:"Layout: state/resizeTiling"}),e}if(null===y)throw Error("Expected resizeDistance");t(rH,{stacked:n.stacked,leftPath:n.leftPath,startPercent:x,resizeDistance:y,snapPercent:30/h*100,initialLayout:f})});function rK(e){return(0,X.default)(function(){return te(e)},[e])}function r$(e){var t=rK(e);return(0,X.default)(function(){return(0,eh.selectAtom)(t,function(e){return e.rect})},[t])}function rQ(e){return(0,X.default)(function(){return(0,ea.atom)(function(t){var n=t(rH);return!!n&&e===tR({leftPath:n.leftPath})})},[e])}function rY(e){var t=rK(e);return(0,X.default)(function(){return(0,eh.selectAtom)(t,function(e){return e.stacked})},[t])}var rX=e.i(64386),rJ=function(e){var t=e.container,n=e.sidebarWidths,r=e.gap,i=t.width-n.left-n.right,a=t.width-100-i/2,o=(t.height-r)/2-100;return{middle:{rect:{x:0,y:0,width:0,height:0},paneId:null,visible:!1},above:{visible:!1,rect:{x:a,y:0,width:200,height:100}},below:{visible:!1,rect:{x:a,y:t.height-100-r,width:200,height:100}},leftOf:{visible:!1,rect:{x:n.left+r,y:o,width:100,height:200}},rightOf:{visible:!1,rect:{x:t.width-100-r,y:o,width:100,height:200}}}},rZ=["above","rightOf","leftOf","below","middle"],r0=(0,ea.atom)(null),r1=(0,ea.atom)(function(e){var t=e(r0);if(!t)return null;var n=eL(e(tm),t.paneGroupId);return n&&n.panes[n.activeIndex]||null}),r2=(0,eh.selectAtom)(r0,function(e){return null==e?void 0:e.dropPoints}),r4=(0,ea.atom)(null,function(e,t,n){if(!e(ne)){var r=e(tr),i=eL(e(tm),n.paneGroupId);if(!i){var a=Error("Expected paneGroup");throw t(tC,{error:a,origin:"Layout: state/paneGroupDragAndDrop/dragStartAtom"}),a}var o=e(e3(i.panes[i.activeIndex])),s=e(o.rectAtom),l=e(tn),u={x:s.x,y:s.y-l,width:s.width,height:s.height+l},c=n.mouse.x-(r.x+s.x),d=e(tU),p=new Map(e(e2).filter(function(e){return e!==i.id}).map(function(e){return[e,{snappiness:400}]}));t(nk,{panes:new Map(e(e0).filter(function(e){return e!==o.paneId}).map(function(e){return[e,{snappiness:400}]})),headers:p}),t(r0,{startType:o.type,startPoint:{x:n.mouse.x-r.x,y:n.mouse.y-r.y},paneGroupId:n.paneGroupId,transformOriginX:Math.round(c)+"px",scale:1,fromRect:u,movedAtAll:!1,dropPoints:"floating"===o.type?rJ({container:r,sidebarWidths:e(rS),gap:d}):null})}}),r8=(0,ea.atom)(null,function(e,t,n){if(!e(ne)){var r=e(r0);if(!r)return void t(rl,null);var i=n.delta,a=r.paneGroupId,o=r.fromRect,s=e(tm),l=eL(e(tm),a);if(!l){var u=Error("Expected paneGroup");throw t(tC,{error:u,origin:"Layout: state/paneGroupDragAndDrop/dragUpdateAtom"}),u}var c=l.panes[l.activeIndex],d=eF(s,c);if(!d){var p=Error("Expected pane");throw t(tC,{error:p,tags:{layoutstate:!0},origin:"Layout: state/paneGroupDragAndDrop/dragUpdateAtom"}),p}var f=e3(c),h=tt(d.paneGroup.id),g=e(tn),m=Math.max(Math.abs(i.x),Math.abs(i.y)),v=m>=50,x=m>0;if(v&&!d.floating){var y=e(f).rectAtom,w=e(y),b=(0,eZ.produce)(s,function(e){try{eY(e,{paneGroupPath:d.paneGroupPath,rect:{x:w.x+i.x,y:w.y-g+i.y,width:w.width,height:w.height+g}})}catch(e){throw t(tC,{error:e,tags:{layoutstate:!0},origin:"Layout: state/paneGroupDragAndDrop/dragUpdateAtom"}),e}});t(nk,{headers:new Map(e(e2).filter(function(e){return e!==d.paneGroup.id}).map(function(e){return[e,{snappiness:400}]})),panes:new Map(e(e0).filter(function(e){return e!==c}).map(function(e){return[e,{snappiness:400}]}))}),t(tq,b),t(r6,n.mouse);return}var j=e(h),_=e(f);l.id===e(ny.modalPaneGroupIdAtom)&&t(ny.modalPaneGroupIdAtom,null);var S="floating"===r.startType?eW({x:o.x+i.x,y:o.y+i.y,width:o.width,height:o.height},{inside:e(tr),minVisibleX:2*g,minVisibleY:g}):{x:o.x+i.x,y:o.y+i.y},I=S.x,C=S.y;if(t(j.rectAtom,function(e){return(0,eZ.produce)(e,function(e){e.x=I,e.y=C})}),t(_.rectAtom,function(e){return(0,eZ.produce)(e,function(e){e.x=I,e.y=C+g})}),!v&&!d.floating){var k=r.startPoint,E=1-.7*(1-Math.sqrt(1-Math.pow(m/50,2)));t(rl,{type:"detachPreview",rect:{x:k.x-50,y:k.y-50,width:100,height:100},progress:m/50}),t(r0,(0,eZ.produce)(r,function(e){e.scale=E,e.movedAtAll=e.movedAtAll||x}));return}var T=e(tU);if(r.dropPoints)return void t(r0,function(t){return(0,eZ.produce)(t,function(t){(null==t?void 0:t.dropPoints)&&function(e,t){var n=t.container,r=t.gap,i=t.sidebarWidths,a=t.headerHeight,o=t.paneRects,s=t.mouse,l={x:s.x-n.x,y:s.y-n.y},u=null,c=null;if(o.length){var d=!0,p=!1,f=void 0;try{for(var h,g=o[Symbol.iterator]();!(d=(h=g.next()).done);d=!0){var m=(0,N._)(h.value,2),v=m[0],x=m[1],y={x:x.x-r/2,y:x.y-r/2-a,width:x.width+r,height:x.height+r+a};if(tT(s,y)){u=v,c=x;break}}}catch(e){p=!0,f=e}finally{try{d||null==g.return||g.return()}finally{if(p)throw f}}if(e.middle.visible=!!c,c){var w={width:Math.min(100,c.width),height:Math.min(100,c.height)};e.middle.paneId=u,e.middle.rect={x:c.x+c.width/2-w.width/2,y:c.y-a+(c.height+a)/2-w.height/2-r,width:w.width,height:w.height+a/2}}}else{var b={x:n.x+i.left+r,y:n.y,width:n.width-r-i.left-i.right-r,height:n.height},j={width:Math.min(100,b.width),height:Math.min(100,b.height)};e.middle.rect={x:b.x+b.width/2-j.width/2,y:b.height/2-j.height/2,width:j.width,height:j.height},e.middle.visible=!0}var _=null,S=!0,I=!1,C=void 0;try{for(var k,E=rZ[Symbol.iterator]();!(S=(k=E.next()).done);S=!0){var T=k.value,P=e[T].rect;if(tT(l,P)){_=T;break}}}catch(e){I=!0,C=e}finally{try{S||null==E.return||E.return()}finally{if(I)throw C}}var R=!0,A=!1,D=void 0;try{for(var V,O=rZ[Symbol.iterator]();!(R=(V=O.next()).done);R=!0){var F=V.value;e[F].visible=!_||F===_}}catch(e){A=!0,D=e}finally{try{R||null==O.return||O.return()}finally{if(A)throw D}}}(t.dropPoints,{paneRects:e(r3),container:e(tr),sidebarWidths:e(rS),headerHeight:e(tn),gap:T,mouse:n.mouse})})});if(!d.floating)throw Error("Expected floating pane");t(r6,n.mouse)}}),r3=(0,ea.atom)(function(e){return e(e6).filter(function(e){return"tile"===e.type&&!e.isHidden}).map(function(t){return[t.paneId,e(t.rectAtom)]})}),r6=(0,ea.atom)(null,function(e,t,n){var r=e(tn),i=e(tr),a=e(r3),o=e(tU),s=function(e){var t=e.views,n=e.mouse,r=e.container,i=e.headerHeight,a=e.sidebarWidths,o=e.gap,s={x:Math.min(Math.max(n.x-r.x,1),r.width-1),y:Math.min(Math.max(n.y-r.y,1),r.height-1)},l=!0,u=!1,c=void 0;try{for(var d,p=t[Symbol.iterator]();!(l=(d=p.next()).done);l=!0){var f=(0,N._)(d.value,2),h=f[0],g=f[1],m={x:g.x,y:g.y-i,width:g.width,height:i},v={x:m.x-o/2,y:m.y-o/2,width:m.width+o,height:i+o/2};if(tT(s,v))return{dropPreview:m,drop:{type:"insert",paneId:h}};var x={x:g.x,y:g.y-i,width:g.width,height:g.height+i},y={x:x.x-o/2,y:x.y-o/2,width:x.width+o,height:x.height+o};if(tT(s,y)){var w=tP(s,x);return{dropPreview:w.rect,drop:{type:"split",relativeTo:h,placement:w.placement}}}}}catch(e){u=!0,c=e}finally{try{l||null==p.return||p.return()}finally{if(u)throw c}}var b=tP(s,{x:a.left,y:0,width:r.width-a.left-a.right,height:r.height});return{dropPreview:b.rect,drop:{type:"split",relativeTo:["tiling"],placement:b.placement}}}({views:a,container:i,mouse:n,headerHeight:r,sidebarWidths:e(rS),gap:o}),l=s.drop;t(rl,{type:"dropPreview",rect:s.dropPreview}),t(r0,function(e){return(0,eZ.produce)(e,function(e){e&&(e.drop=l,e.movedAtAll=!0)})})}),r5=(0,ea.atom)(null,function(e,t,n){var r=n.delta;if(!e(ne)){t(rl,null);var i=e(r0);if(i){var a=i.paneGroupId,o=i.drop,s=i.fromRect,l=e(tm),u=eL(e(tm),a);if(!u){var c=Error("Expected paneGroup");throw t(tC,{error:c,origin:"Layout: state/paneGroupDragAndDrop/dragEndAtom"}),c}var d=u.panes[u.activeIndex],p=eF(l,d);if(!p){var f=Error("Expected pane");throw t(tC,{error:f,tags:{layoutstate:!0},origin:"Layout: state/paneGroupDragAndDrop/dragEndAtom"}),f}var h=(0,eZ.produce)(l,function(n){if(!o&&p.floating&&"floating"===i.startType){var a=eO(n,p.paneGroupPath);if((null==a?void 0:a.type)!=="floatingPaneGroup")return;var l=e(tn),u=eW({x:s.x+r.x,y:s.y+r.y,width:s.width,height:s.height},{inside:e(tr),minVisibleX:2*l,minVisibleY:l}),c=u.x,f=u.y;a.rect.x=c,a.rect.y=f;return}if(o){if(p.paneGroup.panes.forEach(function(e){t(ts,e)}),"split"===o.type){if(null===n.tiling){var h=(0,tQ.v4)();try{ez(n,{id:(0,tQ.v4)(),panes:[h],placement:"leftOf",relativeTo:["tiling"]})}catch(e){throw t(tC,{error:e,tags:{layoutstate:!0},origin:"Layout: state/paneGroupDragAndDrop/dragEndAtom"}),e}}try{!function(e,t){var n=t.from,r=t.to,i=t.placement,a=eF(e,n);if(!a)throw Error("Expected fromPane");var o=a.paneGroup,s=o.panes,l=o.activeIndex;eQ(e,a.paneGroupPath),ez(e,{id:a.paneGroup.id,relativeTo:r,panes:s,placement:i,activeIndex:l})}(n,{from:d,to:o.relativeTo,placement:o.placement})}catch(e){throw t(tC,{error:e,tags:{layoutstate:!0},origin:"Layout: state/paneGroupDragAndDrop/dragEndAtom"}),e}return}var g=eF(n,o.paneId);p.paneGroup.panes.forEach(function(e){eX(n,{paneId:e,paneGroupPath:(null==g?void 0:g.paneGroupPath)||["tiling"],activate:!1})})}});t(r0,null),t(tq,h),(null==o?void 0:o.type)==="insert"&&t(nW,d)}}}),r9=(0,ea.atom)(function(e){var t=e(tL);switch(t.type){case"sidebar":return 0===t.width;case"centered":return!1}}),r7=(0,ea.atom)(function(e){var t=e(tL);switch(t.type){case"sidebar":return e(r9)?"collapsed":"sidebar";case"centered":return t.type}}),ie=(0,ea.atom)(function(e){var t=e(tL),n=e(tn),r=e(tr),i=e(tM),a=n+e(tU),o=r.height-a;switch(t.type){case"sidebar":var s=e(tU),l={width:t.width,height:o,y:a};switch(i){case"filetree-agent":return(0,x._)({x:r.width-t.width-s},l);case"agent-filetree":return(0,x._)({x:0===t.width?0:s},l);default:return{x:0,y:0,width:0,height:0}}case"centered":return{x:0,y:a,width:r.width,height:o}}});function it(e){var t=e.rect,n=e.insets,r=e.agentFiltreeOrder,i=e.gap,a=e.paneGroupId,o=e.topLeftPaneGroup,s=e.topRightPaneGroup,l=e.sidebar,u=e.agent,c=e.agentRect,d=e.container,p=t.x,f=t.width;if(n.left>0&&(null==o?void 0:o.id)===a&&(p=n.left,"filetree-agent"===r?l.isOpen&&l.x+l.width+i>=n.left&&(p=t.x):"agent-filetree"===r&&(null==u?void 0:u.type)==="sidebar"&&c.x+c.width>n.left&&(p=t.x),f=t.width-(p-t.x)),n.right>0&&(null==s?void 0:s.id)===a){if("agent-filetree"===r){var h=d.width-(l.x+l.width),g=l.isOpen?h+l.width+i:0;g<=n.right&&(f-=n.right-(g-i))}else if("filetree-agent"===r&&(null==u?void 0:u.type)==="sidebar"){var m=u.width+i+i;m<=n.right&&(f-=n.right-m)}}return{x:p,width:f}}var ir=(0,ea.atom)({left:0,right:0}),ii=(0,ea.atom)(null,function(e,t,n,r){t(ir,function(e){return(0,rX._)((0,x._)({},e),(0,P._)({},n,r))}),t(tq,e(tm))}),ia=(0,ea.atom)(function(e){var t,n,r=e(tm),i=e(nr),a={topLeft:null==(t=eM(r,"topLeft"))?void 0:t.paneGroup,topRight:null==(n=eM(r,"topRight"))?void 0:n.paneGroup};if(!a.topLeft||!a.topRight)return{left:0,right:0,leftPaneWidth:0,rightPaneWidth:0};if(i===a.topLeft||i===a.topRight){var o=e(nu).width;return{left:o,right:o,leftPaneWidth:o,rightPaneWidth:o}}var s={left:e(tt(a.topLeft.id)),right:e(tt(a.topRight.id))},l={left:e(s.left.rectAtom),right:e(s.right.rectAtom)},u={insets:e(ir),agentFiltreeOrder:e(tM),gap:e(tU),topLeftPaneGroup:a.topLeft,topRightPaneGroup:a.topRight,sidebar:e(rj),agent:e(tL),agentRect:e(ie),container:e(tr)},c={left:it((0,rX._)((0,x._)({},u),{rect:l.left,paneGroupId:a.topLeft.id})),right:it((0,rX._)((0,x._)({},u),{rect:l.right,paneGroupId:a.topRight.id}))};return{leftPaneWidth:l.left.width,left:c.left.width,rightPaneWidth:l.right.width,right:c.right.width}});function io(e){var t=id(e);return(0,X.default)(function(){return(0,ea.atom)(function(n){if(n(t))return n(nl);var r,i,a=n(tm),o=n(tt(e)),s=n(o.rectAtom),l={topLeft:null==(r=eM(a,"topLeft"))?void 0:r.paneGroup,topRight:null==(i=eM(a,"topRight"))?void 0:i.paneGroup},u=n(tU),c=it({rect:s,insets:n(ir),agentFiltreeOrder:n(tM),gap:u,paneGroupId:e,topLeftPaneGroup:l.topLeft||null,topRightPaneGroup:l.topRight||null,sidebar:n(rj),agent:n(tL),agentRect:n(ie),container:n(tr)});if("floating"===o.path[0]){var d=s.y-u,p=s.height+u+1;return(0,rX._)((0,x._)({},s,c),{y:d,height:p})}return(0,x._)({},s,c)})},[t,e])}function is(e){var t=il(e),n=io(e);return(0,X.default)(function(){var r=(0,ea.atom)(function(r){var i,a,o,s=r(n),l=r(t)||(null==(o=r(nI))||null==(a=o.headers)||null==(i=a.get(e))?void 0:i.dropState)?"transform":"top-left";return{x:s.x,y:s.y,positioning:l}});return(0,eh.selectAtom)(r,function(e){return e},tu.default)},[t,e,n])}function il(e){return(0,X.default)(function(){return(0,ea.atom)(function(t){var n=t(r0);return n&&e===n.paneGroupId?n:null})},[e])}function iu(e){var t=il(e);return(0,X.default)(function(){return(0,eh.selectAtom)(t,function(e){var t;return null!=(t=null==e?void 0:e.scale)?t:1})},[t])}function ic(e){return(0,X.default)(function(){return(0,eh.selectAtom)(tm,function(t){return eL(t,e)})},[e])}function id(e){var t=ic(e);return(0,X.default)(function(){return(0,ea.atom)(function(e){if(e(t0))return!0;if(!e(ne))return!1;var n=e(t);if(!n)return!1;var r=e(ta);return!!r&&n.panes.includes(r)})},[t])}function ip(e){var t=tt(e);return(0,X.default)(function(){return(0,eh.selectAtom)(t,function(e){return"floating"===e.path[0]})},[t])}var ih=e.i(205104),ig=e.i(780671),im=(0,ea.atom)(null,function(e,t,n){var r,i=n.path,a=e(tm),o=(0,x._)({},n);if(!o.opener){var s=e(rL),l=(0,ig.getFileExtension)(i);if(l){var u=s[l];if(u){var c=e(tb).find(function(e){return e.extension.extensionId===u.extensionId});c&&(o.opener={paneType:"extension",extensionFileHandler:c,supports:function(){return!0}})}}}if(o.newPane)return void t(nj,{pane:iv(o),edge:null!=(r=o.newPaneEdge)?r:"left"});var d=eM(a,"topLeft");if(!d)return void t(nv,{pane:iv(o),relativeTo:["tiling"],placement:"replace"});var p=e(e6).find(function(t){var n,r=e(t.dataAtom);return(0,ti.isFilePane)(r)?i===(0,ti.getFilePathForPane)(r):!!((null==(n=o.opener)?void 0:n.paneType)==="extension"&&(0,ti.isExtensionPane)(r))&&r.data.filePath===i&&o.opener.extensionFileHandler.extension.installationId===r.data.installationId||"markdown"===r.type&&i===r.data.path});if(p&&!o.newTab){var f=e(p.dataAtom);if((0,ti.isFilePane)(f)||"markdown"===f.type){t(nW,p.paneId),t(nU,{paneId:p.paneId,pane:iv((0,x._)({opener:{paneType:f.type}},o))});return}if((0,ti.isExtensionPane)(f))return void t(nW,p.paneId)}var h=d.paneGroup,g=eM(a,"topRight");if(g&&(h=g.paneGroup),o.newTab)return void t(nM,{panes:[iv(o)],paneGroupId:h.id,activate:!0,commit:!0,index:h.activeIndex+1});var m=e(e6).find(function(t){return!t.isCommitted&&((0,ti.isFilePane)(e(t.dataAtom))||"markdown"===e(t.dataAtom).type)});if(m){t(nU,{paneId:m.paneId,pane:iv(o)}),t(nW,m.paneId);return}var v=e(tv).find(function(t){var n=e(t.dataAtom);return"codeEditor"===n.type&&""===(0,ti.getFilePathForPane)(n)});if(v){t(nU,{paneId:v.paneId,pane:iv(o)}),t(nW,v.paneId);return}var y=h.panes.find(function(t){var n=e(e3(t));return"commands"===e(n.dataAtom).type});if(y){t(nU,{paneId:y,pane:iv(o)}),t(e3(y),function(e){return(0,eZ.produce)(e,function(e){e.isCommitted=!1})}),t(nW,y);return}t(nM,{panes:[iv(o)],paneGroupId:h.id,activate:!0})});function iv(e){var t=e.path,n=e.col,r=e.line,i=e.opener;if(!(null==i?void 0:i.paneType)&&(0,ih.isMarkdownFile)(t.toLowerCase()))return{type:"markdown",data:{path:t}};if(!(null==i?void 0:i.paneType)&&(0,ih.isCsvFile)(t.toLowerCase()))return{type:"csvPreview",data:{path:t}};var a=(null==i?void 0:i.paneType)||(0,ti.getPaneTypeForFile)({path:t});if("codeEditor"===a)return{type:"codeEditor",data:{path:t,col:n,line:r}};if("extension"===a){var o=i.extensionFileHandler;return{type:"extension",data:{filePath:t,extensionId:o.extension.extensionId,installationId:o.extension.installationId,name:o.extension.manifest.name,baseUrl:o.extension.baseUrl,path:o.handler}}}return"markdown"===a?{type:"markdown",data:{path:t}}:{type:a,data:{path:t}}}var ix=(0,ea.atom)(null,function(e,t,n){var r=n.paths.map(function(e){var t=e.match(/(.+?)(:(\d+))?(:(\d+))?$/);if(!t)return!1;var n=[t[1],void 0!==t[3]&&parseInt(t[3],10),void 0!==t[5]&&parseInt(t[5],10)],r=n[0],i=n[1],a=n[2];return{type:(0,ti.getPaneTypeForFile)({path:r}),data:{path:r,line:i,col:a}}}).filter(Boolean),i=r.length-1,a=e(ta);r.forEach(function(e,n){return(0,er._)(function(){return(0,ei._)(this,function(r){return t(nL,{pane:e,activate:i===n,placement:{type:"secondary",relativeTo:a}}),[2]})})()})}),iy=(0,ea.atom)(null,function(e,t,n){var r=n.urls.map(function(e){var t;try{t=new URL(e)}catch(e){return!1}return"0.0.0.0"===t.hostname||"localhost"===t.hostname?{ports:{type:"local",path:t.pathname,port:parseInt(t.port,10)}}:(window.open(e,"_blank"),!1)}).filter(Boolean);if(0!==r.length){var i=!0,a=!1,o=void 0;try{for(var s,l=r[Symbol.iterator]();!(i=(s=l.next()).done);i=!0){var u=s.value;t(nH,u)}}catch(e){a=!0,o=e}finally{try{i||null==l.return||l.return()}finally{if(a)throw o}}}}),iw=(0,ea.atom)(null,function(e,t,n){if(!e(ne)){var r=e(tr),i=n.pageX,a=n.pageY,o=e(e3(n.over)),s=eT({x:i-r.x,y:a-r.y},e(o.rectAtom)).previewRect;t(n$,!0),t(rl,{type:"dropPreview",rect:s})}}),ib=(0,ea.atom)(null,function(e,t,n){if(!e(ne)){var r=e(tr),i=n.pageX,a=n.pageY,o=n.over,s=e(e3(o)),l=eT({x:i-r.x,y:a-r.y},e(s.rectAtom)).dropLocation;t(rl,null),t(n$,!1);var u=e(tm);if("newPaneGroup"===n.type){if("middle"===l){var c=eF(u,s.paneId);if(!c)return;t(nM,{panes:n.panes,paneGroupId:c.paneGroup.id,activate:!0,index:c.index+1});return}t(nw,{panes:n.panes,placement:l,makeActive:!0,relativeTo:s.paneId});return}var d=o;if("middle"===l){if(d===n.paneId)return;var p=eF(u,s.paneId);if(!p)return;t(nq,{paneId:n.paneId,toPaneGroupId:p.paneGroup.id,index:p.index+1});return}if(d===n.paneId){var f=eF(u,n.paneId);if(!f){var h=Error("Expected pane");throw t(tC,{error:h,tags:{layoutstate:!0},origin:"Layout: state/paneDragAndDrop/expectedPane"}),h}if(f.floating)throw Error("Expected paneGroup");var g=f.paneGroup.panes.find(function(e){return e!==n.paneId});if(!g)return;d=g}var m=(0,eZ.produce)(u,function(e){try{e$(e,n.paneId),ez(e,{id:(0,tQ.v4)(),panes:[n.paneId],relativeTo:d,placement:l}),t(ts,n.paneId)}catch(e){throw t(tC,{error:e,tags:{layoutstate:!0},origin:"Layout: state/paneDragAndDrop/updatedLayout"}),e}});t(tq,m)}});function ij(e){var t=(0,X.default)(function(){return(0,ea.atom)(function(t){return!!t(t0)||!!t(ne)&&t(ta)===e})},[e]);return(0,X.default)(function(){return(0,ea.atom)(function(n){if(n(t))return n(nu);var r=n(e3(e));return n(r.rectAtom)})},[e,t])}function i_(e){return(0,X.default)(function(){return(0,ea.atom)(function(t){var n=t(r0);return n&&e===t(r1)?n:null})},[e])}function iS(e){var t=i_(e);return(0,X.default)(function(){return(0,eh.selectAtom)(t,function(e){var t;return null!=(t=null==e?void 0:e.scale)?t:1})},[t])}function iI(e){return(0,X.default)(function(){return(0,ea.atom)(function(t){return t(t(e3(e)).dataAtom)})},[e])}function iC(e){return(0,X.default)(function(){return(0,ea.atom)(function(t){return!!t(tG)||t(e3(e)).isHidden})},[e])}function ik(e){return(0,X.default)(function(){return(0,eh.selectAtom)(e3(e),function(e){return"floating"===e.type})},[e])}var iE=(0,ea.atom)(null),iT=(0,ea.atom)(function(e){var t=e(iE);if(!t)return null;if("sidebar"===t.target)return{target:"sidebar"};var n=eF(e(tm),t.paneId);if(!n)return null;var r=n.paneGroup;return{target:"pane",paneGroupId:r.id,activeIndex:r.activeIndex,panes:r.panes.map(function(t){var n=e(e3(t));return[n.paneId,e(n.dataAtom)]})}}),iP=(0,ea.atom)(function(e){var t=e(iT);if(!t)return null;if("sidebar"===t.target)return{target:"sidebar"};var n=t.paneGroupId,r=t.activeIndex;return{target:"pane",paneId:t.panes[r][0],paneGroupId:n}}),iR=(0,ea.atom)(function(e){var t=e(iE);if(!t||"sidebar"===t.target)return null;if(e(nt)===t.paneId)return e(nu);var n=e(e3(t.paneId)),r=e(n.rectAtom),i=e(tn);return{x:Math.round(r.x),y:Math.round(r.y-i),width:Math.round(r.width),height:Math.round(r.height+i)}}),iA=(0,ea.atom)(null,function(e,t,n){var r=e(ta),i=null!=n?n:r;if(i){t(iE,{target:"pane",paneId:i}),i!==r&&t(to,i);return}var a=eM(e(tm),"topLeft"),o=a?a.paneGroup.panes[a.paneGroup.activeIndex]:null;if(o)return void t(iE,{target:"pane",paneId:o})}),iD=(0,ea.atom)(null,function(e,t){var n=e(iE);n&&(t(iE,null),"sidebar"!==n.target&&t(nS,{paneId:n.paneId,activate:!0}))}),iV=(0,ea.atom)(null,function(e,t){if(e(iT))return void t(iD);var n=e(ta);if(n)return void t(iA,n);var r=eM(e(tm),"topLeft"),i=r?r.paneGroup.panes[r.paneGroup.activeIndex]:null;if(i)return void t(iA,i)}),iO=(0,ea.atom)(function(e){return null!==e(iE)}),iF=(0,ea.atom)(null,function(e,t){t(iE,null)}),iM=(0,ea.atom)(null,function(e,t,n){var r=e(ta);if(!(!r||e(nt))){var i=eN({relativeTo:r,rects:new Map(e(e6).filter(function(e){return!e.isHidden}).map(function(t){return[t.paneId,e(t.rectAtom)]})),direction:n});i&&(t(ta,i),e(iE)&&t(iE,{target:"pane",paneId:i}))}}),iL=(0,ea.atom)(null,function(e,t,n){var r=e(iT);null===r||"sidebar"!==r.target&&t(tq,(0,eZ.produce)(e(tm),function(e){!function(e,t){var n=t.paneGroupId,r=t.direction,i=eL(e,n),a=eG(e,n);if((null==i?void 0:i.type)==="paneGroup"&&a){var o=a.node.children.indexOf(i);if(-1===o)throw Error("Expected index");var s=(0,en._)(a.path).concat([o]),l="down"===r||"right"===r,u=0===o,c=o===a.node.children.length-1,d=a.node.stacked===("up"===r||"down"===r),p=a.path.length>2;if(d&&!((c&&l||u&&!l)&&p))return function(e,t,n){var r=e.indexOf(t);if(-1===r)throw Error("Expected item to be in array");if(1!==e.length){var i=r===e.length-1;if("forward"===n&&i){e.pop(),e.unshift(t);return}if("back"===n&&0===r){e.shift(),e.push(t);return}var a="forward"===n?1:-1;e[r]=e[r+a],e[r+a]=t}}(a.node.children,i,l?"forward":"back");var f=(v=eG(e,i.id))?function e(t,n){var r=n.path,i=n.forwards,a=n.vertical,o=eO(t,r);if((null==o?void 0:o.type)!=="split")return null;var s=eR(r);if(0===s.length)return null;var l=eO(t,s);if((null==l?void 0:l.type)!=="split")return null;if(l.stacked!==a)return e(t,{path:s,forwards:i,vertical:a});var u=l.children.indexOf(o),c=0===u;if(!(u===l.children.length-1&&i||c&&!i)){var d=u+(i?1:-1),p=l.children[d],f=l.children[u];return p?{other:f,node:p,parent:l,path:(0,en._)(s).concat([d])}:null}if(1===s.length){var h=c&&!i?l.children.length-1:0;return{parent:l,other:l.children[u],path:(0,en._)(s).concat([h]),node:l.children[h]}}return e(t,{path:s,forwards:i,vertical:a})}(e,{path:v.path,forwards:"down"===r||"right"===r,vertical:"up"===r||"down"===r}):null;if(f){var h=s.slice(0,f.path.length+("paneGroup"===f.node.type?2:1));if("tiling"!==h[0])throw Error("Expected tiling path");var g=eO(e,h);if(!g||"floatingPaneGroup"===g.type)throw Error("Expected adjacentNode");if("split"!==f.other.type)throw Error("Expected split");var m=function(e,t){var n=e.indexOf(t),r=0,i=!0,a=!1,o=void 0;try{for(var s,l=e.slice(0,n)[Symbol.iterator]();!(i=(s=l.next()).done);i=!0){var u=s.value.percent;r+=u}}catch(e){a=!0,o=e}finally{try{i||null==l.return||l.return()}finally{if(a)throw o}}return{start:r,end:r+t.percent}}(f.other.children,g);if("paneGroup"===f.node.type){var v,x,y,w=(x={start:0,end:100},y=!f.parent.stacked,m.start-x.start<x.end-m.end?y?"above":"rightOf":y?"below":"leftOf");eQ(e,(0,en._)(a.path).concat([o])),ez(e,{placement:w,id:i.id,panes:i.panes,activeIndex:i.activeIndex,percent:i.percent,relativeTo:f.path});return}var b=function(e,t){var n=e.children,r=e.stacked,i="above",a=0,o=0,s=0,l=0,u=!0,c=!1,d=void 0;try{for(var p,f=n[Symbol.iterator]();!(u=(p=f.next()).done);u=!0){var h=p.value,g={start:s,end:s+h.percent},m=Math.max(0,Math.min(t.end,g.end)-Math.max(t.start,g.start));m>l&&(l=m,a=o,i=t.start-g.start<g.end-t.end?r?"above":"rightOf":r?"below":"leftOf"),s+=h.percent,o++}}catch(e){c=!0,d=e}finally{try{u||null==f.return||f.return()}finally{if(c)throw d}}return{placement:i,index:a}}(f.node,m),j=b.index,_=b.placement;eQ(e,(0,en._)(a.path).concat([o])),ez(e,{placement:_,id:i.id,panes:i.panes,activeIndex:i.activeIndex,percent:i.percent,relativeTo:(0,en._)(f.path).concat([j])})}}}(e,{paneGroupId:r.paneGroupId,direction:n.direction})}))}),iG={width:120,height:120},iU=(0,ea.atom)(null),iN=(0,ea.atom)(null,function(e,t,n){var r=e(tm);if("end"===n.type){t(iU,null),t(tq,r);return}if("update"===n.type){var i=e(iU);if(!i){var a=Error("Expected floatingResizeState");throw t(tC,{error:a,tags:{layoutstate:!0},origin:"Layout: state/resizeFloating"}),a}var o=e(tn),s=function(e,t){var n=t.edge,r=t.delta,i=t.minSize,a=void 0===i?eP:i,o=(0,x._)({},e),s=a.height,l=a.width;if("top"===n||"topLeft"===n||"topRight"===n){var u=e.height-r.y;o.height=Math.max(u,s),u<s?o.y=e.y+e.height-s:o.y=e.y+r.y}else("bottom"===n||"bottomLeft"===n||"bottomRight"===n)&&(o.height=Math.max(e.height+r.y,s));if("right"===n||"bottomRight"===n||"topRight"===n)o.width=Math.max(e.width+r.x,l);else if("left"===n||"bottomLeft"===n||"topLeft"===n){var c=e.width-r.x;o.width=Math.max(c,l),c<l?o.x=e.x+e.width-l:o.x=e.x+r.x}return o}(i.rectStart,{delta:n.moveDelta,edge:i.edge,minSize:iG}),l=i.paneId,u=(0,eZ.produce)(r,function(e){var n=e.floating.find(function(e){return e.panes.includes(l)});if(!n){var r=Error("Expected floating");throw t(tC,{error:r,tags:{layoutstate:!0},origin:"Layout: state/resizeFloating"}),r}var i=n.rect;i.x=s.x,i.y=s.y-o,i.width=s.width,i.height=s.height+o});t(tq,u);return}var c=e(e6).find(function(e){return e.paneId===n.paneId});if(!c){var d=Error("Expected pane");throw t(tC,{error:d,tags:{layoutstate:!0},origin:"Layout: state/resizeFloating"}),d}t(to,n.paneId),t(iU,{paneId:n.paneId,edge:n.edge,rectStart:e(c.rectAtom)})}),iB=(0,ea.atom)(null,function(e,t,n){var r=e(tm),i=e(e3(n)),a=i.rectAtom,o=i.type,s=e(a),l=eF(r,n);if(!l){var u=Error("Expected pane");throw t(tC,{error:u,tags:{layoutstate:!0},origin:"Layout: state/toggleFloating"}),u}if("tile"===o)return void t(tq,(0,eZ.produce)(r,function(e){eY(e,{paneGroupPath:l.paneGroupPath,rect:{x:s.x-16,y:s.y-16,width:s.width,height:s.height}})}));l.paneGroup.id===e(ny.modalPaneGroupIdAtom)&&t(ny.modalPaneGroupIdAtom,null);var c=e(e6).filter(function(e){return"tile"===e.type&&!e.isHidden}),d=e(tn),p={x:s.x+s.width/2,y:s.y+s.height/2},f=c.find(function(t){var n=e(t.rectAtom);return tT(p,{x:n.x,y:n.y-d,width:n.width,height:n.height+d})});f?(t(tq,(0,eZ.produce)(r,function(e){var t=eF(e,f.paneId);l.paneGroup.panes.forEach(function(n){eX(e,{paneId:n,paneGroupPath:(null==t?void 0:t.paneGroupPath)||["tiling"],activate:!1})})})),t(nW,l.paneGroup.panes[l.paneGroup.activeIndex])):t(tq,(0,eZ.produce)(r,function(e){!function(e,t){var n=t.paneGroupPath,r=t.placement,i=t.to,a=eO(e,n);if((null==a?void 0:a.type)!=="floatingPaneGroup")throw Error("Expected floatingPaneGroup");if(eQ(e,n),null===i){e.tiling={id:a.id,panes:a.panes,percent:100,type:"paneGroup",activeIndex:a.activeIndex};return}ez(e,{id:a.id,relativeTo:i,panes:a.panes,activeIndex:a.activeIndex,placement:r})}(e,{paneGroupPath:l.paneGroupPath,to:["tiling"],placement:"leftOf"})}))}),iW=(0,ea.atom)(null),iz=(0,ea.atom)(function(e){var t=e(iW);return t&&e(e6).find(function(n){var r=e(n.dataAtom);return"videoPlayer"===r.type&&r.data.embedUrl===(null==t?void 0:t.embedUrl)})||null}),iH=(0,ea.atom)(function(e){var t=e(iz);return t&&!t.isHidden?t:null}),iq=(0,ea.atom)(null,function(e,t,n){t(iW,n);var r,i="videoPlayer";n?t(rW,{type:i,data:{title:null!=(r=n.title)?r:"Tutorial",embedUrl:n.embedUrl}},{commit:!0,location:"center"}):t(rz,i)}),iK=(0,ea.atom)(null,function(e,t){var n=e(iz);if(null==n?void 0:n.isHidden){t(nW,n.paneId),t(ts,n.paneId);return}var r=e(iW);r&&t(iq,r)}),i$=(0,ea.atom)(function(e){return e(e6).find(function(t){return"tutorial"===e(t.dataAtom).type})||null}),iQ=(0,ea.atom)(null,function(e,t){var n=e(i$);(null==n?void 0:n.isHidden)?t(nW,n.paneId):t(nw,{panes:[{type:"tutorial"}],placement:"leftOf",percent:25,relativeTo:["tiling"],makeActive:!1,commit:!0})}),iY=(0,ea.atom)(function(e){return!!(e(r0)||e(iU)||e(rH)||e(n$)||e(rP)||e(nP))}),iX=(0,ea.atom)(null,function(e,t,n){t(tF,n),t(tq,e(tm))}),iJ=(0,ea.atom)(null,function(e,t,n){setTimeout(function(){t(iZ,!1)},400),t(nO,n)}),iZ=(0,ea.atom)(!1),i0=(0,ea.atom)(null,function(e,t,n){t(nk,{headers:new Map(e(e2).map(function(e){return[e,{snappiness:400}]})),panes:new Map(e(e0).map(function(e){return[e,{snappiness:400}]}))}),t(td,function(e){return(0,eZ.produce)(e,function(e){e.isOpen=null!=n?n:!e.isOpen,n&&0===e.width&&(e.width=180)})}),t(tq,e(tm))}),i1=(0,ea.atom)(null,function(e,t,n){var r=e(tm),i=e(ta)===n.to,a=(0,eZ.produce)(r,function(e){try{e$(e,n.from);var r=eF(e,n.to);r&&(eq(e,{paneIds:[n.from],activate:i,paneGroupId:r.paneGroup.id,index:r.index}),e$(e,n.to))}catch(e){throw t(tC,{error:e,tags:{layoutstate:!0},origin:"Layout: state/removePane/removePaneAtom"}),e}});t(tq,a)}),i2=e.i(98816),i4=(0,ea.atom)(function(e){if(e(iO)||e(ec))return null;var t=e(ta);if(!t)return null;var n=e(e3(t)),r=e(n.dataAtom),i=n.paneId+r.type;return(0,ti.isFilePane)(r)&&(i+=r.data.path),i}),i8=e.i(613355),i3=e.i(998583),i6=e.i(221121),i5=e.i(224996),i9=e.i(918208),i7=e.i(149028),ae=(0,ea.atom)(null,function(e,t,n){if(null===n){t(rl,null),t(r0,function(e){return e?(0,eZ.produce)(e,function(e){e.drop=null}):e});return}t(r0,function(e){return e?(0,eZ.produce)(e,function(e){!function(e,t){if("edge"===t.type||"emptyLayout"===t.type){e.drop={type:"split",relativeTo:["tiling"],placement:"edge"===t.type?t.position:"replace"};return}var n=t.paneId;if("middle"===t.position){e.drop={type:"insert",paneId:n};return}e.drop={type:"split",relativeTo:n,placement:t.position}}(e,n)}):e});var r=e(tr),i=e(tn),a=e(tf),o=e(tU);if("pane"===n.type){var s=e(e3(n.paneId)),l=e(s.rectAtom);t(rl,{type:"dropPreview",rect:{x:l.x,y:l.y-i,width:l.width,height:l.height+i}});return}"emptyLayout"===n.type?t(rl,{type:"dropPreview",rect:function(e){var t=e.container,n=e.sidebarWidth,r=e.gap,i=e.location,a={x:n+r,y:0,width:t.width-n-2*r,height:t.height-r},o=a.x,s=a.y,l=a.width,u=a.height;switch(i){case"middle":return a;case"leftOf":return{x:o,y:s,width:l/2,height:u};case"rightOf":return{x:o+l/2,y:s,width:l/2,height:u};case"above":return{x:o,y:s,width:l,height:u/2};case"below":return{x:o,y:s+u/2,width:l,height:u/2}}}({container:r,sidebarWidth:a,location:n.position,gap:o})}):t(rl,{type:"dropPreview",rect:function(e,t){var n=t.container,r=t.sidebarWidth,i=t.position,a=t.gap,o={x:r+a,y:0,width:n.width-r-2*a,height:n.height-a};if((null==e?void 0:e.type)!=="split"){switch(i){case"above":case"below":o.height=o.height/2,"below"===i&&(o.y+=o.height);break;case"rightOf":case"leftOf":o.width=o.width/2,"rightOf"===i&&(o.x+=o.width)}return o}if(e.stacked){switch(i){case"above":o.height=o.height*(e.children[0].percent/100)/2;break;case"below":o.height=o.height*(e.children[e.children.length-1].percent/100)/2,o.y=n.height-o.height;break;case"leftOf":o.width=o.width/2;break;case"rightOf":o.width=o.width/2,o.x=n.width-o.width-a}return o}switch(i){case"above":o.height=o.height/2;break;case"below":o.height=o.height/2,o.y=n.height-o.height-a;break;case"leftOf":o.width=o.width*(e.children[0].percent/100)/2;break;case"rightOf":o.width=o.width*(e.children[e.children.length-1].percent/100)/2,o.x=n.width-o.width}return o}(e(tm).tiling,{container:r,sidebarWidth:a,position:n.position,gap:o})})}),at=(0,rs.createCssVarTokens)(["opacity","width","height","transform","pointerEvents"]),an=at.cssVars,ar=at.styleTokens,ai=(0,ro.cssRecord)({dropPoint:[i8.rcss.center,i8.rcss.top(0),i8.rcss.left(0),i8.rcss.position.absolute,{zIndex:ra.zIndexLevels.overlay,cursor:"grabbing",width:ar.width,height:ar.height,transform:ar.transform,opacity:"var(".concat(an.opacity,", 0)"),pointerEvents:ar.pointerEvents,transition:"opacity 200ms ease-out 200ms","&:hover":{color:A.tokens.accentPrimaryStronger}}]}),aa={above:(0,m.jsx)(i7.default,{}),below:(0,m.jsx)(i6.default,{}),leftOf:(0,m.jsx)(i5.default,{}),rightOf:(0,m.jsx)(i9.default,{}),middle:(0,m.jsx)(i3.default,{})};function ao(e){var t=(0,B.useRef)(null),n=(0,B.useMemo)(function(){return(0,eh.selectAtom)(r2,function(t){return null==t?void 0:t[e]})},[e]),r=(0,B.useMemo)(function(){return(0,eh.selectAtom)(n,function(e){return e?(0,P._)({},an.transform,"translate(".concat(e.rect.x,"px, ").concat(e.rect.y,"px)")):null},tu.default)},[n]);(0,tK.useStyleSet)(t,rn(r));var i=(0,B.useMemo)(function(){return(0,eh.selectAtom)(n,function(e){var t;return e?(t={},(0,P._)(t,an.width,e.rect.width+"px"),(0,P._)(t,an.height,e.rect.height+"px"),t):null},tu.default)},[n]);(0,tK.useStyleSet)(t,rn(i));var a=(0,B.useMemo)(function(){return(0,eh.selectAtom)(n,function(e){var t;return t={},(0,P._)(t,an.opacity,(null==e?void 0:e.visible)?"1":"0"),(0,P._)(t,an.pointerEvents,(null==e?void 0:e.visible)?"all":"none"),t},tu.default)},[n]);return(0,tK.useStyleSet)(t,rn(a)),t}function as(){var e=ao("middle"),t=rr(ae),n=ri((0,B.useMemo)(function(){return(0,eh.selectAtom)(r2,function(e){var t;return null!=(t=null==e?void 0:e.middle.paneId)?t:null})},[]));return(0,m.jsx)(O.View,{css:ai.dropPoint,innerRef:e,onMouseEnter:function(){var e=n(),r="middle";t(e?{type:"pane",position:r,paneId:e}:{type:"emptyLayout",position:r})},onMouseLeave:function(){return t(null)},children:(0,m.jsx)(i3.default,{size:32})})}function al(e){var t=e.position,n=ao(t),r=rr(ae);return(0,m.jsx)(O.View,{css:ai.dropPoint,innerRef:n,onMouseEnter:function(){return r({type:"edge",position:t})},onMouseLeave:function(){return r(null)},children:(0,B.cloneElement)(aa[t],{size:32})})}var au=(0,B.memo)(function(){return(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)(al,{position:"above"}),(0,m.jsx)(al,{position:"below"}),(0,m.jsx)(al,{position:"leftOf"}),(0,m.jsx)(al,{position:"rightOf"}),(0,m.jsx)(as,{})]})}),ac=(0,ea.atom)(null);function ad(e){return rt((0,X.default)(function(){return(0,ea.atom)(function(t){var n=t(e3(e));return t(n.dataAtom)})},[e]))}function ap(){var e=re();return(0,B.useCallback)(function(t){var n=e.get(e3(t));return{pane:e.get(n.dataAtom),isCommitted:n.isCommitted}},[e])}function af(){var e=rr(to),t=rr(ts);return(0,X.default)(function(){return function(n,r){(null==r?void 0:r.commit)&&t(n),e(n)}},[t,e])}function ah(){return rr(n8)}var ag=(0,ea.atom)(null,function(e,t){t(n$,!1)});function am(){return rr(im)}function av(){return{maximizePane:rr(nn),maximizePaneGroup:rr(nr),restoreMaximizedPaneGroup:rr(ni),toggleMaximizePane:rr(na),toggleMaximizedPaneGroup:rr(no)}}function ax(e){var t,n,r=(t=tt(e),{activeIndexAtom:(0,X.default)(function(){return(0,ea.atom)(function(e){return e(t).activeIndex})},[t]),pathAtom:(0,X.default)(function(){return(0,eh.selectAtom)(t,function(e){return e.path},tu.default)},[t]),panesAtom:(0,X.default)(function(){return(0,eh.selectAtom)(t,function(e){return e.panes},tu.default)},[t]),activeFileAtom:(0,X.default)(function(){return(0,ea.atom)(function(e){var n=e(t),r=e(e3(n.panes[n.activeIndex])),i=e(r.dataAtom);return(0,ti.isFilePane)(i)?(0,ti.getFilePathForPane)(i):null})},[t])}),i=r.activeIndexAtom,a=r.pathAtom,o=r.panesAtom;return{activeIndex:rn(i),path:rn(a),panes:rn(o),activeTabPaneId:rn((n=tt(e),(0,X.default)(function(){return(0,ea.atom)(function(e){var t=e(n);return e(e3(t.panes[t.activeIndex])).paneId})},[n])))}}function ay(e){var t,n,r,i,a,o,s,l,u,c,d=ij(e),p=tA(d),f=tD(d),h=iS(e),g=(t=i_(e),(0,X.default)(function(){return(0,ea.atom)(function(n){var r,i,a,o,s,l=n(t);if(l)return null!=(o=l.transformOriginX)?o:"0px";var u=null==(a=n(nI))||null==(i=a.panes)||null==(r=i.get(e))?void 0:r.dropState;return null!=(s=null==u?void 0:u.transformOrginX)?s:"0x"})},[t,e])),m=(n=ij(e),(0,X.default)(function(){return(0,ea.atom)(function(e){var t=e(n),r=e(tr);return{x:Math.round(r.x+t.x),y:Math.round(r.y+t.y)}})},[n])),v=iC(e),y=(0,X.default)(function(){return(0,ea.atom)(function(t){var n,r,i,a=t(e3(e));if(a.isHidden)return ra.zIndexLevels.hiddenPane;var o=e===t(ta);return t(nt)===e?ra.zIndexLevels.maximizedPane:e===t(r1)||(null==(i=t(nI))||null==(r=i.panes)||null==(n=r.get(e))?void 0:n.dropState)?ra.zIndexLevels.draggingPane:"floating"===a.type?o?ra.zIndexLevels.floatingPaneActive:ra.zIndexLevels.floatingPane:o?ra.zIndexLevels.tiledPaneActive:ra.zIndexLevels.tiledPane})},[e]),w=(0,X.default)(function(){return(0,ea.atom)(function(t){var n,r,i=t(nI);return null!=(r=null==i||null==(n=i.panes)?void 0:n.get(e))&&r})},[e]),b=(r=iI(e),(0,X.default)(function(){return(0,eh.selectAtom)(r,function(e){return e.type})},[r])),j=ik(e),_=(0,X.default)(function(){return(0,ea.atom)(function(t){var n,r=null==(n=eF(t(tm),e))?void 0:n.paneGroup;return!!r&&r.id===t(ny.modalPaneGroupIdAtom)})},[e]),S=(0,X.default)(function(){return(0,ea.atom)(function(t){return t(ta)===e})},[e]),I=(0,X.default)(function(){return(0,ea.atom)(function(t){return t(ta)===e})},[e]),C=(0,X.default)(function(){return(0,eh.selectAtom)(e3(e),function(e){return e.isCommitted})},[e]),k=iI(e),E=(i=ik(e),a=i_(e),(0,X.default)(function(){return(0,ea.atom)(function(e){return e(ne)?null:e(a)?"dragging":e(i)?"floating":"tiled"})},[i,a])),T=(o=i_(e),(0,X.default)(function(){return(0,ea.atom)(function(t){var n,r,i;return!!t(o)||!!(null==(i=t(nI))||null==(r=i.panes)||null==(n=r.get(e))?void 0:n.dropState)})},[o,e])),P=(s=i_(e),(0,X.default)(function(){return(0,eh.selectAtom)(s,function(e){var t;return null!=(t=null==e?void 0:e.movedAtAll)&&t})},[s])),R=(0,X.default)(function(){return(0,ea.atom)(function(t){if((null==(n=t(tm).tiling)?void 0:n.type)!=="paneGroup")return!1;var n,r,i=null==(r=eF(t(tm),e))?void 0:r.paneGroup;return!!i&&1===i.panes.length})},[e]),A=(l=ij(e),u=iS(e),c=iC(e),(0,X.default)(function(){return(0,ea.atom)(function(e){var t=e(c);return(0,rX._)((0,x._)({},e(l)),{scale:e(u),opacity:+!t})})},[l,u,c])),D=(0,X.default)(function(){return(0,ea.atom)(function(t){return t(nt)===e})},[e]);return{properties:rn(A),size:rn(p),position:rn(f),scale:rn(h),paneType:rn(b),transformOriginXAtom:rn(g),viewportInset:rn(m),zIndex:rn(y),disableInteractions:rn(iY),getTransitionEnabled:ri(w),data:rn(k),isFloating:rn(j),isModal:rn(_),isActive:rn(S),isActivePane:rn(I),isCommitted:rn(C),isHidden:rn(v),isBeingDragged:rn(T),hasMovedWhileDragging:rn(P),headerHeight:rn(tn),border:rn(E),isOnlyPane:rn(R),isMaximized:rn(D)}}function aw(e){var t,n,r,i,a,o,s,l,u,c=tA(io(e)),d=is(e),p=iu(e),f=(n=il(e),(0,X.default)(function(){return(0,ea.atom)(function(t){var r,i,a,o,s,l=t(n);if(l)return null!=(o=l.transformOriginX)?o:"0px";var u=null==(a=t(nI))||null==(i=a.headers)||null==(r=i.get(e))?void 0:r.dropState;return null!=(s=null==u?void 0:u.transformOrginX)?s:"0x"})},[n,e])),h=(r=il(e),i=id(e),a=ip(e),t=ic(e),o=(0,X.default)(function(){return(0,ea.atom)(function(e){var n=e(ta);if(!n)return!1;var r=e(t);return!!r&&r.panes.includes(n)})},[t]),(0,X.default)(function(){return(0,ea.atom)(function(t){var n,s,l;return t(i)?ra.zIndexLevels.maximizedHeader:t(r)||(null==(l=t(nI))||null==(s=l.headers)||null==(n=s.get(e))?void 0:n.dropState)?ra.zIndexLevels.draggingHeader:t(a)?t(o)?ra.zIndexLevels.floatingHeaderActive:ra.zIndexLevels.floatingHeader:ra.zIndexLevels.tiledHeader})},[r,i,a,o,e])),g=(0,X.default)(function(){return(0,ea.atom)(function(t){var n,r,i=t(nI);return null!=(r=null==i||null==(n=i.headers)?void 0:n.get(e))&&r})},[e]),m=id(e),v=ip(e),y=(0,X.default)(function(){return(0,ea.atom)(function(t){return t(ny.modalPaneGroupIdAtom)===e})},[e]),w=(0,X.default)(function(){return(0,ea.atom)(function(t){var n;return(null==(n=t(r0))?void 0:n.paneGroupId)===e})},[e]);return{properties:rn((s=io(e),l=iu(e),u=is(e),(0,X.default)(function(){return(0,ea.atom)(function(e){var t=e(tG);return(0,rX._)((0,x._)({},e(s)),{scale:e(l),positioning:e(u).positioning,opacity:+!t})})},[s,l,u]))),size:rn(c),position:rn(d),scale:rn(p),transformOriginX:rn(f),zIndex:rn(h),getTransitionEnabled:ri(g),isMaximized:rn(m),isFloating:rn(v),isModal:rn(y),isBeingDragged:rn(w)}}function ab(){return{view:rn(rj),resizeHandleView:rn(r_),isOpen:rn(tp),toggle:rr(i0),resize:{start:rr(rT),update:rr(rR),end:rr(rA)},getTransitionEnabled:ri(nC)}}function aj(){var e=rn(ie),t=rn(tU),n=rn(r7),r=rr(nR),i=rr(nD);return{rect:e,gutter:t,displayState:n,collapsedWidth:0,getTransitionEnabled:ri(nC),resizeSidebar:r,toggle:i,setChatRef:rr(nE),agentFiletreeOrder:rn(tM),setAgentPosition:rr(iX),headerHeight:rn(tn),isCollapsed:rn(nV)}}var a_=(0,eh.selectAtom)(tm,function(e){var t=e.tiling;return(null==t?void 0:t.type)==="paneGroup"&&1===t.panes.length}),aS=e.i(106020),aI=e.i(292849),aC=e.i(827456),ak=e.i(259493);function aE(e){var t=e.currentPaneId,n=e.type,r=(0,aC.usePaneUIContext)(),i=rr(n2),a=rr(nW),o=(0,ny.useGetPanes)(),s=(0,ak.useGetPaneBindings)(),l=t?"Move existing tab here":"Jump to existing tab";return(0,B.useCallback)(function(e){var u=e.searchQuery;return(0,er._)(function(){var e,c,d,p,f,h,g,v,x,y,w,b,j,_,S,I,C,k,E,T,P,R,A,D,V;return(0,ei._)(this,function(O){switch(O.label){case 0:if(e=o(),!(c=t?e.filter(function(e){return(0,N._)(e,1)[0]!==t}):e).length||!u&&"files"===n)return[2,[]];d=new Map,p=[],f=!0,h=!1,g=void 0;try{for(v=c[Symbol.iterator]();!(f=(x=v.next()).done);f=!0)(y=(0,N._)(x.value,2))[0],w=y[1],(0,ti.isFilePane)(w)&&w.data.path&&p.push(w.data.path)}catch(e){h=!0,g=e}finally{try{f||null==v.return||v.return()}finally{if(h)throw g}}return[4,(0,aI.filterFiles)(u,p)];case 1:b=O.sent(),j=!0,_=!1,S=void 0;try{for(I=b[Symbol.iterator]();!(j=(C=I.next()).done);j=!0)k=C.value,d.set(k.path,{score:k.score,ranges:k.ranges})}catch(e){_=!0,S=e}finally{try{j||null==I.return||I.return()}finally{if(_)throw S}}E=[],T=!0,P=!1,R=void 0;try{for(A=function(){var e=(0,N._)(V.value,2),o=e[0],u=e[1],c=(0,ti.isToolPane)(u);if("tools"===n&&!c||"tools"===n&&"commands"===u.type||"files"===n&&c)return"continue";var p=(0,ti.isFilePane)(u)?u.data.path:null,f=p?d.get(p):null;if("deployments"===u.type){var h=s(o);if((null==h?void 0:h.type)==="deployments"){var g=h.getTabs();if(g)return E.push({match:aS.fzfMatchLabel,data:{type:"context",label:r.getTitle(u),icon:(0,m.jsx)(r.Icon,{pane:u})},commands:function(){return g.map(function(e){return{match:aS.fzfMatchLabel,data:{key:o+e.id,type:"action",label:e.label,icon:(0,m.jsx)(e.Icon,{size:16}),run:function(){a(o),h.setTab(e.id)}}}})}}),"continue"}}var v=p&&f?function(){return{score:f.score,render:(0,aI.createFileMatchRender)({path:p,ranges:f.ranges,description:l})}}:aS.fzfMatchLabel,x=r.getTitle(u),y=r.Icon({pane:u});E.push({match:v,data:{key:o,type:"action",label:x,icon:y,run:function(){return t?i({a:t,b:o}):a(o)},description:l}})},D=c[Symbol.iterator]();!(T=(V=D.next()).done);T=!0)A()}catch(e){P=!0,R=e}finally{try{T||null==D.return||D.return()}finally{if(P)throw R}}return[2,E]}})})()},[t,o,r,a,i,s,l,n])}var aT=e.i(333980),aP=e.i(927989),aR=e.i(794633),aA=e.i(32109),aD=e.i(384401),aV=e.i(888330),aO=e.i(615778),aF=e.i(44239),aM="Search";function aL(){var e=(0,eo.useSetAtom)(ed);return(0,B.useCallback)(function(t){e(t)},[e])}var aG=e.i(262206),aU=e.i(739521),aN=e.i(980338),aB={id:"toggleGlobalCommandBarCommand",name:"Toggle Commandbar",description:"Opens or closes the command bar",default:(0,aG.defaultKeyCombo)({cmdOrCtrl:!0,key:"k"})};function aW(e){var t=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{enabled:!0}).enabled,n=(0,eo.useSetAtom)(ef);(0,B.useEffect)(function(){if(t&&null!==e)return n(function(t){return(0,en._)(t).concat([e])}),function(){n(function(t){return t.filter(function(t){return t!==e})})}},[n,e,t])}var az=(0,ro.cssRecord)({surface:[i8.rcss.maxHeight("70vh"),i8.rcss.borderRadius(8)]});let aH=(0,B.memo)(function(){var e,t,n,r,i,a,o,s,l,u,c,d=(0,eo.useAtomValue)(ec),p=aL(),f=(e=ah(),t=(0,B.useCallback)(function(t){(0,es.track)(el.events.TOOL_OPENED,{source:"Command Bar",tool:t.pane.type}),e(t)},[e]),n=(0,aC.usePaneUIContext)(),r=(0,aR.useToolPanes)(),i=(0,ny.useGetPanes)(),a=(0,B.useCallback)(function(){var e=i().map(function(e){var t=(0,N._)(e,2);return(t[0],t[1]).type}),a=[],o=!0,s=!1,l=void 0;try{for(var u,c=r[Symbol.iterator]();!(o=(u=c.next()).done);o=!0)!function(){var r=u.value;if(!((0,ti.isSingleton)(r.type)&&e.includes(r.type))){var i=n.getTitle(r),o=n.Icon({pane:r});a.push({match:(0,aT.matchToolPane)({pane:r,aliases:aP.paneAliases.get(r.type)}),data:{key:"extension"===r.type?"extension-".concat(r.data.installationId,"-").concat(r.data.path):void 0,type:"action",label:i,description:n.getDescription(r,{short:!0}),icon:o,run:function(){t({pane:r})}}})}}()}catch(e){s=!0,l=e}finally{try{o||null==c.return||c.return()}finally{if(s)throw l}}return a},[r,t,i,n]),o=aE({type:"tools"}),s=(0,aD.useKeyCombo)("toggleGlobalCommandBarCommand"),l=(0,X.default)(function(){return{type:"context",icon:(0,m.jsx)(aO.default,{}),label:"",description:aM,keyboardShortcut:s}},[s]),u=(0,X.default)(function(){return(0,ea.atom)(function(e){var t=e(ef),n={data:{type:"context",label:aV.toolsCommandLabel,icon:(0,m.jsx)(aF.default,{})},commands:function(e){var t=e.searchQuery;return(0,er._)(function(){return(0,ei._)(this,function(e){switch(e.label){case 0:return[4,o({searchQuery:t})];case 1:return[2,en._.apply(void 0,[e.sent()]).concat((0,en._)(a()))]}})})()}};return{data:l,commands:function(){return(0,en._)(t).concat([n])}}})},[a,l,o]),c=(0,X.default)(function(){return(0,ea.atom)(function(e){var t=e(u),n=e(ep);return n?[t,n]:t})},[u]),(0,eo.useAtomValue)(c)),h=(0,aD.useKeyCombo)(aB.id);return(0,m.jsx)(aU.Modal,{hideCloseButton:!0,isOpen:d,onRequestClose:p,noPadding:!0,skipTransition:!0,topPadding:8,children:(0,m.jsx)(V.Surface,{css:az.surface,children:(0,m.jsx)(aN.CommandBar,{keyboardShortcut:h,onAction:function(){return p()},command:f,autoFocus:!0})})})});var aq=e.i(692043);function aK(){var e=(0,y._)(["\n  query ExtensionStore($replId: String!, $userId: Int) {\n    extensionList(includeNonBlessed: true, userId: $userId) {\n      ...TopLevelExtension\n      installation(replId: $replId) {\n        ...TopLevelExtensionInstallation\n      }\n    }\n  }\n  ","\n  ","\n"]);return aK=function(){return e},e}var a$=(0,w.gql)(aK(),aq.TopLevelExtensionFragmentDoc,aq.TopLevelExtensionInstallationFragmentDoc),aQ=e.i(761201),aY=e.i(253344),aX=e.i(47503),aJ=e.i(207237),aZ=e.i(140487),a0=e.i(960178),a1=(0,ro.cssRecord)({container:i8.rcss.colWithGap(24)});function a2(e){var t=e.fileExtension,n=e.onCancel,r=e.onConfirm;return(0,m.jsxs)(O.View,{css:a1.container,children:[(0,m.jsx)(a0.Header,{level:1,variant:"headerDefault",children:"Make this extension default?"}),(0,m.jsxs)(a0.Text,{children:["Do you want to use this extension to open ",t," files by default? You can always use another file opener by right clicking on the file and opening it with something else"]}),(0,m.jsxs)(O.View,{row:!0,gap:12,justify:"end",children:[(0,m.jsx)(aZ.Button,{onClick:function(){return n()},text:"Cancel"}),(0,m.jsx)(aZ.Button,{colorway:"positive",onClick:function(){return r()},text:"Yes, use this extension by default"})]})]})}var a4=e.i(222342);function a8(){var e=(0,ny.useGetActivePaneId)(),t=ri(tw),n=ri(tj),r=ri(t8),i=rr(nL),a=rr(nS),o=rr(nU),s=ri(tx),l=ri(ty),u=ri(ne);return(0,B.useCallback)(function(c){var d=c.pane,p=c.activate,f=c.updateOnReveal,h=e(),g=(0,ti.isFilePane)(d)?s():l();g||(g=function(e){var t,n,r=e.panes,i=e.pane;if((0,ti.isFilePane)(i)){var a,o,s=i.data.path;return null!=(o=null==(a=r.find(function(e){var t=(0,N._)(e,2)[1];return(0,ti.isFilePane)(t)&&t.data.path===s}))?void 0:a[0])?o:null}if((0,ti.isExtensionPane)(i))return null!=(u=null==(l=r.find(function(e){var t=(0,N._)(e,2)[1];return!!(0,ti.isExtensionPane)(t)&&t.data.installationId===i.data.installationId&&t.data.path===i.data.path&&t.data.filePath===i.data.filePath}))?void 0:l[0])?u:null;if("diff"===i.type){var l,u,c,d=r.find(function(e){var t=(0,N._)(e,2),n=(t[0],t[1]);return"diff"===n.type&&(0,tu.default)(n.data,i.data)});return null!=(c=null==d?void 0:d[0])?c:null}return(0,ti.isSingleton)(i.type)&&null!=(n=null==(t=r.find(function(e){return(0,N._)(e,2)[1].type===i.type}))?void 0:t[0])?n:null}({panes:(0,en._)(t()).concat((0,en._)(n())),pane:d}));var m=u();if(g&&h){var v,x,y=r().layout,w=null==(v=eF(y,h))?void 0:v.paneGroup,b=null==(x=eF(y,g))?void 0:x.paneGroup;if(!m||(null==w?void 0:w.id)===(null==b?void 0:b.id))return(void 0===f||f)&&o({paneId:g,pane:d}),a({paneId:g,activate:p}),g}var j=c.placement;return m&&null!=h?j={type:"after",paneId:h}:(null==j?void 0:j.type)!=="secondary"||j.relativeTo||(j={type:"secondary",relativeTo:h}),i({pane:d,activate:p,placement:j})},[e,s,l,i,t,n,r,u,a,o])}var a3=e.i(778203);function a6(){var e,t=am(),n=(0,ny.useActivatePane)(),r=(e=(0,ny.useObservableActiveFile)(),(0,X.default)(function(){return function(t){return e.subscribe(t)}},[e])),i=(0,ny.useGetActiveFile)(),a=(0,a4.default)(),o=a8(),s=(0,ny.useGetActivePaneId)(),l=ri(t8),u=rr(t7),c=(0,a3.default)(),d=(0,i2.default)(c),p=(0,B.useCallback)(function(e){o({pane:{type:"extension",data:{extensionId:e.extensionId,installationId:e.installationId,baseUrl:e.baseUrl,path:e.path,name:e.name}},activate:!0,placement:{type:"secondary",relativeTo:s()}})},[o,s]);return(0,X.default)(function(){return{openFile:t,watchActiveFile:r,getActiveFile:i,activatePane:n,toasts:a,revealOrInsertTool:p,getLayoutState:l,setLayoutState:u,getSshConfig:function(){return d.current}}},[t,r,i,n,a,p,l,u,d])}var a5=e.i(475032),a9=e.i(529810);e.i(244719);var a7=e.i(667279),oe=e.i(196380),ot=e.i(100811),on=e.i(9293),or=e.i(530448),oi=e.i(409792),oa=e.i(343252),oo=e.i(873379),os=e.i(557964),ol=e.i(167626),ou=((n={}).RAW="RAW",n.PROXY="PROXY",n.THROW="THROW",n.HANDLER="HANDLER",n),oc=((r={}).GET="GET",r.SET="SET",r.APPLY="APPLY",r.CONSTRUCT="CONSTRUCT",r.ENDPOINT="ENDPOINT",r.RELEASE="RELEASE",r),od=Symbol("Comlink.proxy"),op=Symbol("Comlink.endpoint"),of=Symbol("Comlink.releaseProxy"),oh=Symbol("Comlink.thrown"),og=function(e){return(void 0===e?"undefined":(0,eV._)(e))==="object"&&null!==e||"function"==typeof e},om=new Map([["proxy",{canHandle:function(e){return og(e)&&e[od]},serialize:function(e){var t=new MessageChannel,n=t.port1,r=t.port2;return ov(e,n),[r,[r]]},deserialize:function(e){var t;return e.start(),function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){},i=!1,a=new Proxy(r,{get:function(r,o){if(oy(i),o===of)return function(){return oI(t,{type:oc.RELEASE,path:n.map(function(e){return e.toString()})}).then(function(){ox(t),i=!0})};if("then"===o){if(0===n.length)return{then:function(){return a}};var s=oI(t,{type:oc.GET,path:n.map(function(e){return e.toString()})}).then(oS);return s.then.bind(s)}return e(t,(0,en._)(n).concat([o]))},set:function(e,r,a){oy(i);var o=(0,N._)(o_(a),2),s=o[0],l=o[1];return oI(t,{type:oc.SET,path:(0,en._)(n).concat([r]).map(function(e){return e.toString()}),value:s},l).then(oS)},apply:function(r,a,o){oy(i);var s=n[n.length-1];if(s===op)return oI(t,{type:oc.ENDPOINT}).then(oS);if("bind"===s)return e(t,n.slice(0,-1));var l=(0,N._)(ow(o),2),u=l[0],c=l[1];return oI(t,{type:oc.APPLY,path:n.map(function(e){return e.toString()}),argumentList:u},c).then(oS)},construct:function(e,r){oy(i);var a=(0,N._)(ow(r),2),o=a[0],s=a[1];return oI(t,{type:oc.CONSTRUCT,path:n.map(function(e){return e.toString()}),argumentList:o},s).then(oS)}});return a}(e,[],t)}}],["throw",{canHandle:function(e){return og(e)&&oh in e},serialize:function(e){var t=e.value;return[(0,ol._)(t,Error)?{isError:!0,value:{message:t.message,name:t.name,stack:t.stack}}:{isError:!1,value:t},[]]},deserialize:function(e){if(e.isError)throw Object.assign(Error(e.value.message),e.value);throw e.value}}]]);function ov(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:self,n=arguments.length>2?arguments[2]:void 0;function r(i){if(i&&i.data&&(!n||i.origin===n.origin&&i.source===n.source)){var a,o=(0,x._)({path:[]},i.data),s=o.id,l=o.type,u=o.path,c=(i.data.argumentList||[]).map(oS);try{var d=u.slice(0,-1).reduce(function(e,t){return e[t]},e),p=u.reduce(function(e,t){return e[t]},e);switch(l){case oc.GET:a=p;break;case oc.SET:d[u.slice(-1)[0]]=oS(i.data.value),a=!0;break;case oc.APPLY:a=p.apply(d,c);break;case oc.CONSTRUCT:var f=(0,os._)(p,(0,en._)(c));a=oj(f);break;case oc.ENDPOINT:var h,g,m=new MessageChannel,v=m.port1,y=m.port2;ov(e,y),h=v,g=[v],ob.set(h,g),a=h;break;case oc.RELEASE:a=void 0;break;default:return}}catch(e){a=(0,P._)({value:e},oh,0)}Promise.resolve(a).catch(function(e){return(0,P._)({value:e},oh,0)}).then(function(e){var n=(0,N._)(o_(e),2),i=n[0],a=n[1];t.postMessage((0,rX._)((0,x._)({},i),{id:s}),a),l===oc.RELEASE&&(t.removeEventListener("message",r),ox(t))})}}return t.addEventListener("message",r),t.start&&t.start(),function(){t.removeEventListener("message",r),ox(t)}}function ox(e){"MessagePort"===e.constructor.name&&e.close()}function oy(e){if(e)throw Error("Proxy has been released and is not useable")}function ow(e){var t,n=e.map(o_);return[n.map(function(e){return e[0]}),(t=n.map(function(e){return e[1]}),Array.prototype.concat.apply([],t))]}var ob=new WeakMap;function oj(e){return Object.assign(e,(0,P._)({},od,!0))}function o_(e){var t=!0,n=!1,r=void 0;try{for(var i,a=om[Symbol.iterator]();!(t=(i=a.next()).done);t=!0){var o=(0,N._)(i.value,2),s=o[0],l=o[1];if(l.canHandle(e)){var u=(0,N._)(l.serialize(e),2),c=u[0],d=u[1];return[{type:ou.HANDLER,name:s,value:c},d]}}}catch(e){n=!0,r=e}finally{try{t||null==a.return||a.return()}finally{if(n)throw r}}return[{type:ou.RAW,value:e},ob.get(e)||[]]}function oS(e){switch(e.type){case ou.HANDLER:return om.get(e.name).deserialize(e.value);case ou.RAW:return e.value}}function oI(e,t,n){return new Promise(function(r){var i=[,,,,].fill(0).map(function(){return Math.floor(Math.random()*Number.MAX_SAFE_INTEGER).toString(16)}).join("-");e.addEventListener("message",function t(n){n.data&&n.data.id&&n.data.id===i&&(e.removeEventListener("message",t),r(n.data))}),e.start&&e.start(),e.postMessage((0,x._)({id:i},t),n)})}var oC=e.i(623059),ok=Symbol("timeout"),oE=e.i(881476);function oT(){var e=(0,y._)(["\n  fragment InitialCurrentUserData on CurrentUser {\n    id\n    username\n    image\n    bio\n  }\n"]);return oT=function(){return e},e}function oP(){var e=(0,y._)(["\n  fragment SocialCurrentUserData on CurrentUser {\n    url\n    socials {\n      id\n      url\n      type\n    }\n    firstName\n    lastName\n    displayName\n    fullName\n    followCount\n    followerCount\n  }\n"]);return oP=function(){return e},e}function oR(){var e=(0,y._)(["\n  fragment RolesCurrentUserData on CurrentUser {\n    roles {\n      id\n      name\n      key\n      tagline\n    }\n  }\n"]);return oR=function(){return e},e}function oA(){var e=(0,y._)(["\n  fragment PlanCurrentUserData on CurrentUser {\n    isUserHacker: subscriptionIsType(subscriptionType: HACKER)\n    ...CoreSubscriptionPlanStatus\n  }\n  ","\n"]);return oA=function(){return e},e}function oD(){var e=(0,y._)(["\n  fragment SocialUserData on User {\n    url\n    socials {\n      id\n      url\n      type\n    }\n    firstName\n    lastName\n    displayName\n    fullName\n    followCount\n    followerCount\n  }\n"]);return oD=function(){return e},e}function oV(){var e=(0,y._)(["\n  fragment RolesUserData on User {\n    roles {\n      id\n      name\n      key\n      tagline\n    }\n  }\n"]);return oV=function(){return e},e}function oO(){var e=(0,y._)(["\n  fragment PlanUserData on User {\n    isUserHacker: subscriptionIsType(subscriptionType: HACKER)\n    isUserPro: subscriptionIsType(subscriptionType: HACKER_PRO)\n  }\n"]);return oO=function(){return e},e}function oF(){var e=(0,y._)(["\n  fragment InitialReplData on Repl {\n    id\n    url\n    title\n    description\n    timeCreated\n    slug\n    isPrivate\n  }\n"]);return oF=function(){return e},e}function oM(){var e=(0,y._)(["\n  fragment SocialReplData on Repl {\n    likeCount\n    publicForkCount\n    iconUrl\n    imageUrl\n  }\n"]);return oM=function(){return e},e}function oL(){var e=(0,y._)(["\n  fragment InitialUserData on User {\n    id\n    username\n    image\n    bio\n  }\n"]);return oL=function(){return e},e}function oG(){var e=(0,y._)(["\n  fragment OwnerData on Repl {\n    owner {\n      __typename\n      ... on User {\n        ...InitialUserData\n      }\n      ... on Team {\n        id\n        username\n        image\n        description\n      }\n    }\n  }\n  ","\n"]);return oG=function(){return e},e}function oU(){var e=(0,y._)(["\n  fragment MultiplayersData on Repl {\n    multiplayers {\n      ...InitialUserData\n    }\n  }\n  ","\n"]);return oU=function(){return e},e}function oN(){var e=(0,y._)(["\n  query extensionPortCurrentUser(\n    $includeSocialData: Boolean! = false\n    $includeRoles: Boolean! = false\n    $includePlan: Boolean! = false\n  ) {\n    user: currentUser {\n      ...InitialCurrentUserData\n      ...SocialCurrentUserData @include(if: $includeSocialData)\n      ...RolesCurrentUserData @include(if: $includeRoles)\n      ...PlanCurrentUserData @include(if: $includePlan)\n    }\n  }\n  ","\n  ","\n  ","\n  ","\n"]);return oN=function(){return e},e}function oB(){var e=(0,y._)(["\n  query extensionPortUserByUsername(\n    $username: String!\n    $includeSocialData: Boolean! = false\n    $includeRoles: Boolean! = false\n    $includePlan: Boolean! = false\n  ) {\n    userByUsername(username: $username) {\n      ...InitialUserData\n      ...SocialUserData @include(if: $includeSocialData)\n      ...RolesUserData @include(if: $includeRoles)\n      ...PlanUserData @include(if: $includePlan)\n    }\n  }\n  ","\n  ","\n  ","\n  ","\n"]);return oB=function(){return e},e}function oW(){var e=(0,y._)(["\n  query extensionPortUserById(\n    $id: Int!\n    $includeSocialData: Boolean! = false\n    $includeRoles: Boolean! = false\n    $includePlan: Boolean! = false\n  ) {\n    user(id: $id) {\n      ...InitialUserData\n      ...SocialUserData @include(if: $includeSocialData)\n      ...RolesUserData @include(if: $includeRoles)\n      ...PlanUserData @include(if: $includePlan)\n    }\n  }\n  ","\n  ","\n  ","\n  ","\n"]);return oW=function(){return e},e}function oz(){var e=(0,y._)(["\n  query currentUserEditorPreferences {\n    currentUser {\n      id\n      workspacePreferences\n    }\n  }\n"]);return oz=function(){return e},e}function oH(){var e=(0,y._)(["\n  query extensionPortReplById(\n    $id: String!\n    $includeSocialData: Boolean! = false\n    $includeOwner: Boolean! = false\n    $includeMultiplayers: Boolean! = false\n  ) {\n    getRepl(id: $id) {\n      __typename\n      ... on Repl {\n        ...InitialReplData\n        ...SocialReplData @include(if: $includeSocialData)\n        ...OwnerData @include(if: $includeOwner)\n        ...MultiplayersData @include(if: $includeMultiplayers)\n      }\n      ... on ReplRedirect {\n        replUrl\n      }\n    }\n  }\n  ","\n  ","\n  ","\n  ","\n"]);return oH=function(){return e},e}function oq(){var e=(0,y._)(["\n  query extensionPortReplByUrl(\n    $url: String!\n    $includeSocialData: Boolean! = false\n    $includeOwner: Boolean! = false\n    $includeMultiplayers: Boolean! = false\n  ) {\n    getRepl(url: $url) {\n      __typename\n      ... on Repl {\n        ...InitialReplData\n        ...SocialReplData @include(if: $includeSocialData)\n        ...OwnerData @include(if: $includeOwner)\n        ...MultiplayersData @include(if: $includeMultiplayers)\n      }\n    }\n  }\n  ","\n  ","\n  ","\n  ","\n"]);return oq=function(){return e},e}var oK=(0,w.gql)(oT()),o$=(0,w.gql)(oP()),oQ=(0,w.gql)(oR()),oY=(0,w.gql)(oA(),oE.CoreSubscriptionPlanStatusFragmentDoc),oX=(0,w.gql)(oD()),oJ=(0,w.gql)(oV()),oZ=(0,w.gql)(oO()),o0=(0,w.gql)(oF()),o1=(0,w.gql)(oM()),o2=(0,w.gql)(oL()),o4=(0,w.gql)(oG(),o2),o8=(0,w.gql)(oU(),o2),o3=(0,w.gql)(oN(),oK,o$,oQ,oY),o6=(0,w.gql)(oB(),o2,oX,oJ,oZ),o5=(0,w.gql)(oW(),o2,oX,oJ,oZ),o9=(0,w.gql)(oz()),o7=(0,w.gql)(oH(),o0,o1,o4,o8),se=(0,w.gql)(oq(),o0,o1,o4,o8);function st(e){return function(t){return(0,er._)(function(){var n,r;return(0,ei._)(this,function(i){switch(i.label){case 0:return[4,null===tY.apolloClient||void 0===tY.apolloClient?void 0:tY.apolloClient.query({query:e,variables:t||void 0})];case 1:if(null==(n=i.sent())?void 0:n.data)return[2,n.data];throw Error(null==n||null==(r=n.error)?void 0:r.message)}})})()}}var sn=e.i(862927);function sr(e,t){var n={};for(var r in t)"function"==typeof t[r]&&(n[r]=function(e,t){return function(){for(var n=arguments.length,r=Array(n),i=0;i<n;i++)r[i]=arguments[i];var a=!0,o=!1,s=void 0;try{for(var l,u=e[Symbol.iterator]();!(a=(l=u.next()).done);a=!0)(0,l.value)()}catch(e){o=!0,s=e}finally{try{a||null==u.return||u.return()}finally{if(o)throw s}}return t.apply(void 0,(0,en._)(r))}}(e,t[r]));return n}function si(e,t){return function(){var n=e.store.get(e.extensionStateAtom),r=!0,i=!1,a=void 0;try{for(var o,s=t[Symbol.iterator]();!(r=(o=s.next()).done);r=!0){var l=o.value;if(!n.scopes.has(l)){var u="Scope not declared in extension.json: ".concat(l);e.logger.warn("".concat(u,". In the future this will throw an error"))}}}catch(e){i=!0,a=e}finally{try{r||null==s.return||s.return()}finally{if(i)throw a}}}}var sa=ex.Type.Record(ex.Type.String(),ex.Type.String({minLength:1})),so=e.i(336106);function ss(){var e=(0,y._)(["\n  query ExtensionApiAuthToken($installationId: String!) {\n    extensionInstallationById(id: $installationId) {\n      ... on ExtensionInstallation {\n        id\n        token\n      }\n    }\n  }\n"]);return ss=function(){return e},e}e.i(33699);var sl=(0,w.gql)(ss());function su(e){return{registerCommand:function(t,n){return(0,er._)(function(){var r,i,a;return(0,ei._)(this,function(o){switch(o.label){case 0:if(n)return[3,2];return e.logger.warn("registerCommand: calling registerCommand with a single argument is deprecated. Pass a {commandId, contributions} object as the first command."),r=t,[4,(0,ot.parseCommandProxyToExtensionCommand)(r,e)];case 1:if(!(a=o.sent()).data.id)throw Error("Command: expected id to be defined");if(!("contributions"in a.data))throw Error("Command: In ".concat(a.data.id,", contributions should be an array"));return 0===a.data.contributions.length&&e.logger.warn("Command: ".concat(a.data.id," has no contributions")),(i={commandId:a.data.id,contributions:a.data.contributions}).contributions||(e.logger.warn("Command: '".concat(a.data.id,"' has no contributions")),i.contributions=[]),[3,4];case 2:return i=t,r=n,[4,(0,ot.parseCommandProxyToExtensionCommand)(r,e)];case 3:a=o.sent(),o.label=4;case 4:return e.store.set(a7.registerExtensionCreateCommandAtom,{extensionStateAtom:e.extensionStateAtom,createCommand:{id:(0,aY.asExtensionCommandId)(i.commandId),contributions:i.contributions,create:function(){return(0,er._)(function(){return(0,ei._)(this,function(e){return[2,a]})})()}}}),[2]}})})()},registerCreateCommand:function(t,n){return(0,er._)(function(){var r,i;return(0,ei._)(this,function(a){if(!t.commandId||""===t.commandId)throw Error("Attempted to register command without id");if(!t.contributions||!Array.isArray(t.contributions))throw Error("Command: In ".concat(t.commandId,", contributions should be an array"));return 0===t.contributions.length&&e.logger.warn("Command: ".concat(t.commandId," has no contributions")),(r=t.contributions.filter(function(e){return!(e in oC.ContributionType)})).length>0&&e.logger.warn("Command: ".concat(t.commandId," has unrecognized contributions: ").concat(r.join(", "),". Valid contributions are ").concat(Object.values(oC.ContributionType))),i={id:(0,aY.asExtensionCommandId)(t.commandId),contributions:t.contributions,create:function(t){var r=t.path;return(0,er._)(function(){var t;return(0,ei._)(this,function(i){switch(i.label){case 0:return[4,Promise.race([n({path:r}),new Promise(function(e){return setTimeout(function(){return e(null)},50)})])];case 1:if(null===(t=i.sent()))return[2,null];return[2,(0,ot.parseCommandProxyToExtensionCommand)(t,e)]}})})()}},e.store.set(a7.registerExtensionCreateCommandAtom,{extensionStateAtom:e.extensionStateAtom,createCommand:i}),[2]})})()}}}function sc(e){return function(){if(!e.store.get(e.extensionStateAtom).enableExperimentalApi)throw Error("Experimental APIs are not enabled. (If you are the developer, please add the `experimental-api` scope to your extension.json)")}}var sd=e.i(995683),sp=e.i(703631);function sf(e){return e.error?{error:e.error,success:!1}:{success:!0,error:null}}var sh=e.i(968323),sg=e.i(12291),sm=e.i(664152),sv=function(e,t){var n=e.extension,r=t.showMessage,i=t.hideMessage,a=t.hideAllMessages,o=function(e){return function(t){var i,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:4e3,o=arguments.length>2?arguments[2]:void 0,u=Date.now();u-l>=6e4&&(l=u,s=0);var c=null!=(i=n.manifest.name.trim())?i:"Unknown Extension";s<10?(r({content:(0,m.jsxs)(m.Fragment,{children:[t,(0,m.jsx)("div",{children:(0,m.jsx)(a0.Text,{variant:"small",children:c})})]}),type:e,time:a>1e4?1e4:a,style:o}),s++):sm.logger.error("Extension reached showMessage throttle limit",{extensionId:n.extensionId,extensionName:n.manifest.name,content:t})}},s=0,l=Date.now();return{showConfirm:o("confirm"),showError:o("error"),showNotice:o("notice"),showWarning:o("warning"),hideMessage:i,hideAllMessages:a}},sx=e.i(412284),sy=e.i(703774);function sw(e){var t=e.extension,n=e.sandboxUrl,r=e.sandboxTitle,i=e.paneId,a=e.environmentAPIs,o=e.filePath,s=(0,B.useRef)(null),l=(0,aJ.default)(),u=(0,aX.useCurrentUserId)(),c=(0,a9.default)(),d=(0,B.useRef)(),p=(0,sx.useExtensionsStore)(),f=(0,a7.useExtensionStateAtom)(null==t?void 0:t.installationId),h=(0,sy.useTheme)(),g=(0,B.useRef)(h),m=(0,B.useRef)([]);g.current=h;var v=(0,X.default)(function(){return{}},[]),y=(0,oo.default)(c.container),w=(0,N._)((0,B.useState)(!1),2),b=w[0],j=w[1];(0,B.useEffect)(function(){y===or.ConnectionState.CONNECTED&&j(!0)},[y]),(0,B.useEffect)(function(){m.current.forEach(function(e){return e(h.theme)})},[h.theme]),(0,B.useEffect)(function(){return function(){d.current&&d.current()}},[]);var _=(0,B.useCallback)(function(){try{var e=new URL(n);if("https:"===e.protocol)return!0;return!1}catch(e){return!1}},[n]),S=(0,B.useCallback)(function(){!s.current||!_()||t&&f&&u&&(d.current&&d.current(),d.current=function(e){var t=e.extensionIframe,n=new URL(t.src).origin,r=function(e){var t,n,r,i,a,o,s,l,u,c,d,p=e.filePath,f=e.replId,h=e.environmentAPIs,g=e.logger.createLogger({api:"debug"});return(0,rX._)((0,x._)({filePath:p},(t=e.services.fs,n=e.logger.createLogger({api:"fs"}),sr([si(e,["read"])],(0,x._)({readFile:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"utf8";return(0,er._)(function(){var r,i;return(0,ei._)(this,function(a){switch(a.label){case 0:return r=(0,sp.normalizePath)(e),[4,t.readFile(r)];case 1:var o;if((i=a.sent()).error)return[2,{error:i.error,content:null}];return[2,{error:null,content:(o=i.content,"utf8"===n?o.toString():"binary"===n?o.toBuffer():o)}]}})})()},readDir:function(e){return(0,er._)(function(){var n,r;return(0,ei._)(this,function(i){switch(i.label){case 0:return n=(0,sp.normalizePath)(e),[4,t.readDir(n)];case 1:if((r=i.sent()).error)return[2,{error:r.error,children:null}];return[2,{error:null,children:r.children}]}})})()},watchFile:function(e,r){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"binary",a=(0,sp.normalizePath)(e);(0,ih.isOTFile)(a)&&n.warn("Extension used watchFile on a text file. This works, but watchTextFile is preferred.");var o=t.watchFile(a,{onChange:function(e){"utf8"===i?r.onChange(e.toString("utf8")):r.onChange(e.asBuffer)},onError:function(e){r.onError(e.message)},onMoveOrDelete:function(e){r.onMoveOrDelete({eventType:e.eventType,node:e.node})}});return oj(function(){o()})},watchDir:function(e,n){var r=(0,sp.normalizePath)(e),i=t.watchDir(r,{onChange:function(t){n.onChange(t.map(function(t){return{path:(0,sp.asDir)(e)+t.filename,type:t.type}}))},onError:function(e){n.onError(e)},onMoveOrDelete:function(e){n.onMoveOrDelete(e)}});return oj(function(){i()})}},sr([si(e,["write-exec"])],{createDir:function(e){return(0,er._)(function(){var n;return(0,ei._)(this,function(r){switch(r.label){case 0:return n=(0,sp.normalizePath)(e),[4,t.createDir(n)];case 1:return[2,sf(r.sent())]}})})()},deleteDir:function(e){return(0,er._)(function(){var n;return(0,ei._)(this,function(r){switch(r.label){case 0:return n=(0,sp.normalizePath)(e),[4,t.deleteDir(n)];case 1:return[2,sf(r.sent())]}})})()},writeFile:function(e,n){return(0,er._)(function(){var r,i,a;return(0,ei._)(this,function(o){switch(o.label){case 0:if(r=(0,sp.normalizePath)(e),"string"!=typeof n)return[3,1];return i=n,[3,4];case 1:if(!(0,ol._)(n,Blob))return[3,3];return a=sd.default.from,[4,n.arrayBuffer()];case 2:return i=a.apply(sd.default,[o.sent()]),[3,4];case 3:i=sd.default.from(n),o.label=4;case 4:return[4,t.writeFile(r,i)];case 5:return[2,sf(o.sent())]}})})()},deleteFile:function(e){return(0,er._)(function(){var n;return(0,ei._)(this,function(r){switch(r.label){case 0:return n=(0,sp.normalizePath)(e),[4,t.deleteFile(n)];case 1:return[2,sf(r.sent())]}})})()},copyFile:function(e,n){return(0,er._)(function(){var r;return(0,ei._)(this,function(i){switch(i.label){case 0:return r=(0,sp.normalizePath)(e),[4,t.copyFile(r,n)];case 1:return[2,sf(i.sent())]}})})()},move:function(e,n){return(0,er._)(function(){var r,i,a;return(0,ei._)(this,function(o){switch(o.label){case 0:return r=(0,sp.normalizePath)(e),[4,t.stat(r)];case 1:if(!(i=o.sent()).exists)return[2,{error:"File or directory does not exist",success:!1}];if(i.type!==nG.FileType.File)return[3,3];return[4,t.moveFile(r,n)];case 2:return a=o.sent(),[3,5];case 3:return[4,t.moveDir(r,n)];case 4:a=o.sent(),o.label=5;case 5:return[2,sf(a)]}})})()},watchTextFile:function(e,r){(0,ih.isOTFile)(e)||n.warn("It appears that you are trying to use watchTextFile on a non-OT file. Please use fs.watchFile instead");var i=t.watchTextFile(e,{onReady:function(e){var t=e.fetchChanges,n=e.initialContent,i=e.transformSelection,a=e.updateSelections,o=e.version,s=e.writeChange;r.onReady(oj({writeChange:s,fetchChanges:t,initialContent:n,version:o,transformSelection:i,updateSelections:a}))},onChange:function(e){var t=e.latestContent,n=e.changeSource,i=e.changes,a=e.version;return(0,er._)(function(){return(0,ei._)(this,function(e){return r.onChange({latestContent:t.toString(),version:a,changeSource:n,changes:i.toJSON()}),[2]})})()},onError:function(e){r.onError(e.message)},onMoveOrDelete:function(e){r.onMoveOrDelete({eventType:e.eventType,node:e.node})}});return oj(function(){i()})}})))),function(e){var t=e.services.container,n=null;function r(){return(0,er._)(function(){var e;return(0,ei._)(this,function(r){switch(r.label){case 0:if(n)return[2];return[4,t.exec("bash","-c","echo $REPLIT_DB_URL")];case 1:if((e=r.sent()).error||!e.output)throw Error("unable to find REPLIT_DB_URL");return n=e.output.trim(),[2]}})})()}return sr([si(e,["repldb:read"])],(0,x._)({getReplDbValue:function(e){return(0,er._)(function(){return(0,ei._)(this,function(i){switch(i.label){case 0:return[4,r()];case 1:return i.sent(),[4,t.exec("curl","-s","".concat(n,"/").concat(e))];case 2:return[2,i.sent().output]}})})()},listReplDbKeys:function(e){return(0,er._)(function(){var i;return(0,ei._)(this,function(a){switch(a.label){case 0:return[4,r()];case 1:return a.sent(),[4,t.exec("curl","-s","".concat(n,"?prefix=").concat(e))];case 2:if((i=a.sent()).error||!i.output)return[2,{error:i.error}];return[2,{keys:i.output.split("\n")}]}})})()}},sr([si(e,["repldb:write"])],{setReplDbValue:function(e,i){return(0,er._)(function(){return(0,ei._)(this,function(a){switch(a.label){case 0:return[4,r()];case 1:return a.sent(),[4,t.exec("curl",n,"-s","-d","".concat(e,"=").concat(i))];case 2:return a.sent(),[2]}})})()},deleteReplDbKey:function(e){return(0,er._)(function(){var i;return(0,ei._)(this,function(a){switch(a.label){case 0:return[4,r()];case 1:return a.sent(),[4,t.exec("curl","-s","-XDELETE","".concat(n,"/").concat(e))];case 2:if((i=a.sent()).error||!i.output)return[2,{error:i.error}];return[2,{keys:i.output.split("\n")}]}})})()}})))}(e),{watchActiveFile:function(e){return oj(r.environmentAPIs.watchActiveFile(e))},openFile:(r=e).environmentAPIs.openFile,getActiveFile:function(){return r.environmentAPIs.getActiveFile()}},(i=e.getThemeContext,a=e.onThemeChange,{getCurrentTheme:function(){return i().theme},getCurrentThemeValues:function(){return i().theme.values.global},onThemeChange:function(e){var t=a(e);return oj(function(){t()})},onThemeChangeValues:function(e){var t=a(function(t){return e(t.values.global)});return oj(function(){t()})}}),sv(e,h.toasts),{currentUser:st(o3),userById:st(o5),userByUsername:st(o6),currentRepl:function(e){return st(o7)((0,x._)({id:f},e))},replById:st(o7),replByUrl:st(se)},(o=e.services.container.client(),s=e.logger.createLogger({api:"exec"}),(0,x._)({},sr([si(e,["write-exec"])],{exec:function(e){return(0,er._)(function(){var t,n,r,i;return(0,ei._)(this,function(a){switch(a.label){case 0:return[4,e.args];case 1:return t=a.sent(),[4,e.env];case 2:if(n=a.sent(),s.info("exec: [".concat(t.join(", "),"]"),{environmentVariables:n}),!sn.Value.Check(sa,n))throw Error("Invalid environment variables");return[4,e.splitStderr];case 3:return r=a.sent(),i=function(){},[2,oj({dispose:function(){i()},promise:new Promise(function(a){i=o.openChannel({service:"exec"},function(o){var l=o.channel;l.onCommand(function(t){r?t.output?e.onOutput(t.output):t.stderr&&e.onStdErr(t.stderr):t.output&&e.onOutput(t.output)}),l.request({exec:{args:t,env:n,splitStderr:!!r}}).then(function(t){if(t.ok)return void a({exitCode:0,error:null});if(t.channelClosed){var n="Channel closed before command's execution finished";e.onError(n),a({exitCode:null,error:n});return}if("open"===l.status&&i(),t.error){var r,o,s=Number(null==(o=t.error)||null==(r=o.match(/-?[0-9]+/g))?void 0:r[0]);a({exitCode:"number"==typeof s?s:null,error:t.error});return}throw Error("Unknown error")}).catch(function(t){s.error("exec: threw crosis error:\n".concat(String(t||"")));var n="exec() failed due to internal error. See console for details.";e.onError(n),a({error:n,exitCode:null})})})})})]}})})()}}))),(l=e.extension,u=e.paneId,c=e.environmentAPIs,d=!1,{activatePane:function(){u&&(c.activatePane(u),d||(d=!0,(0,es.track)(el.events.EXTENSION_USED,{action:"used",extensionId:l.extensionId,extensionName:l.manifest.name})))}})),{commands:{registerCommand:function(t,n){return(0,er._)(function(){var r;return(0,ei._)(this,function(i){switch(i.label){case 0:if(!t.commandId||""===t.commandId)throw Error("Attempted to register command without id");if(!t.contributions||!Array.isArray(t.contributions))throw Error("Command: In ".concat(t.commandId,", contributions should be an array"));return 0===t.contributions.length&&e.logger.warn("Command: ".concat(t.commandId," has no contributions")),[4,(0,ot.parseCommandProxyToExtensionCommand)(n,e)];case 1:return r=i.sent(),e.store.set(a7.registerExtensionCreateCommandAtom,{extensionStateAtom:e.extensionStateAtom,createCommand:{id:t.commandId,contributions:t.contributions,create:function(){return(0,er._)(function(){return(0,ei._)(this,function(e){return[2,r]})})()}}}),[2]}})})()},registerCreateCommand:function(t,n){return(0,er._)(function(){var r,i;return(0,ei._)(this,function(a){if(!t.commandId||""===t.commandId)throw Error("Attempted to register command without id");if(!t.contributions||!Array.isArray(t.contributions))throw Error("Command: In ".concat(t.commandId,", contributions should be an array"));return 0===t.contributions.length&&e.logger.warn("Command: ".concat(t.commandId," has no contributions")),(r=t.contributions.filter(function(e){return!(e in oC.ContributionType)})).length>0&&e.logger.warn("Command: ".concat(t.commandId," has unrecognized contributions: ").concat(r.join(", "),". Valid contributions are ").concat(Object.values(oC.ContributionType))),i={id:t.commandId,contributions:t.contributions,create:function(t){var r=t.path;return(0,er._)(function(){var t;return(0,ei._)(this,function(i){switch(i.label){case 0:return[4,Promise.race([n({path:r}),new Promise(function(e){return setTimeout(function(){return e(ok)},50)})])];case 1:if(null===(t=i.sent()))return[2,null];if(t===ok)return e.logger.warn("Command took too long to create. When using registerCreateCommand, you must return a command within ".concat(50,"ms")),[2,null];return[2,(0,ot.parseCommandProxyToExtensionCommand)(t,e)]}})})()}},e.store.set(a7.registerExtensionCreateCommandAtom,{extensionStateAtom:e.extensionStateAtom,createCommand:i}),[2]})})()}},experimental:(0,rX._)((0,x._)({},sr([sc(e)],{hasExperimentalApi:function(){return!0}})),{editor:sr([sc(e)],(0,x._)({},{getPreferences:function(){return(0,er._)(function(){var e,t,n,r;return(0,ei._)(this,function(i){switch(i.label){case 0:return[4,null===tY.apolloClient||void 0===tY.apolloClient?void 0:tY.apolloClient.query({query:o9})];case 1:if(null==(n=i.sent())||null==(t=n.data)||null==(e=t.currentUser)?void 0:e.workspacePreferences)return[2,(0,so.getUserPreferences)(n.data.currentUser.workspacePreferences)];throw Error(null==n||null==(r=n.error)?void 0:r.message)}})})()}})),commands:sr([sc(e)],(0,x._)({},su(e))),auth:sr([sc(e)],(0,x._)({},{getAuthToken:function(){return(0,er._)(function(){var t,n;return(0,ei._)(this,function(r){switch(r.label){case 0:if(e.extension.isLocal)return[2,[btoa(JSON.stringify({alg:"none",typ:"JWT",local:!0,key:"there-is-no-key-for-local-extensions"})),btoa(JSON.stringify({installationId:e.extension.installationId,extensionId:e.extension.extensionId,userId:e.userId,origin:"https://staging.replit.com"})),"this-is-a-locally-generated-jwt-that-will-fail-verification-to-avoid-being-used-accidentally-in-prod-so-please-check-the-header-for-whether-this-is-a-local-extension"].join(".")];return[4,null===tY.apolloClient||void 0===tY.apolloClient?void 0:tY.apolloClient.query({query:sl,variables:{installationId:e.extension.installationId}})];case 1:if(!(null==(t=r.sent())?void 0:t.data))throw Error("Failed to authenticate: something went wrong");if("NotFoundError"===(n=t.data.extensionInstallationById).__typename)throw Error("Failed to authenticate: invalid installation ID");if("ExtensionInstallation"!==n.__typename||!n.token)throw Error("Failed to authenticate: something went wrong");return[2,n.token]}})})()}})),internal:sr([sc(e)],(0,x._)({},su(e)))}),internal:function(e){var t,n,r;return e.store.get(e.extensionStateAtom).enableInternalApi?{hasInternalApi:function(){return!0},ghostwriter:{},container:(t=e.services.container,{getConnectionState:function(){return t.getConnectionState()},onConnectionStateChanged:function(e){var n=t.onConnectionStateChanged(e);return oj(function(){n()})}}),layout:{revealOrInsertTool:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=e.logger.createLogger({api:"revealOrInsertTool"});if(!e.extension.manifest.tools)return void n.warn("No tools defined in extension manifest");if(e.extension.manifest.tools.length<t+1)return void n.warn("Tool index out of bounds");var r=e.extension.manifest.tools[t],i=r.name||e.extension.manifest.name,a=r.handler;e.environmentAPIs.revealOrInsertTool({extensionId:e.extension.extensionId,installationId:e.extension.installationId,baseUrl:e.extension.baseUrl,path:a,name:i})},getLayoutState:function(){return e.environmentAPIs.getLayoutState()},setLayoutState:function(t){return e.environmentAPIs.setLayoutState(t)}},secrets:(n=e.services.secrets,{setSecret:function(e){return(0,er._)(function(e){var t,r;return(0,ei._)(this,function(i){switch(i.label){case 0:return t=e.key,r=e.value,[4,n.addEntries([{key:t,value:r}])];case 1:return i.sent(),[2,(0,sh.Ok)(!0)]}})}).apply(this,arguments)},getSecret:function(e){return(0,er._)(function(){var t;return(0,ei._)(this,function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,n.read()];case 1:return[2,sh.Ok.apply(void 0,[r.sent().get(e.key)])];case 2:return t=r.sent(),[2,(0,sh.Err)(t)];case 3:return[2]}})})()},getReferenceCode:function(e){return(0,er._)(function(){return(0,ei._)(this,function(t){return[2,(0,sg.getEnvCodeForLanguage)(e.filePath,e.key)]})})()}}),dotReplit:{getConfig:(r=e.services.dotReplit).getConfig,update:r.updateDotReplit},ssh:{getSshConfig:function(){return(0,er._)(function(){return(0,ei._)(this,function(t){return[2,e.environmentAPIs.getSshConfig()]})})()}},commands:su(e)}:null}(e),debug:{info:function(e,t){return g.info(e,t)},warn:function(e,t){return g.warn(e,t)},error:function(e,t){return g.error(e,t)}},handshake:function(t){return(0,er._)(function(){var n,r,i,a;return(0,ei._)(this,function(o){switch(o.label){case 0:return[4,null==t?void 0:t.clientName];case 1:return r=null!=(n=o.sent())?n:"(unset)",[4,null==t?void 0:t.clientVersion];case 2:return a=null!=(i=o.sent())?i:"(unset)",(0,es.track)(el.events.EXTENSION_USED,{action:"sandbox_initialized",clientName:r,clientVersion:a,extensionId:e.extension.extensionId,extensionName:e.extension.manifest.name,installationId:e.extension.installationId}),(0,er._)(function(){var t,n,i;return(0,ei._)(this,function(o){switch(o.label){case 0:if(!e.extension.isLocal||"@replit/extensions"!==r)return[2];return[4,e.services.container.exec("sh","-c","npm view @replit/extensions --json version 2>/dev/null")];case 1:if((n=o.sent()).error)throw n.error;if(!n.output)throw Error("No output from npm");if((i=JSON.parse(null==(t=n.output)?void 0:t.trim()))===a)return[2];return e.logger.warn("There is a new version of @replit/extensions available. You are using ".concat(a,", but the latest version is ").concat(i),{clientVersion:a,latestVersion:i}),[2]}})})(),[2,{success:!0}]}})})()}})}(e);if(!t.contentWindow)throw Error("No contentWindow");var i=ov(r,function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:self,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"*";return{postMessage:function(t,r){e.postMessage(t,n,r)},addEventListener:t.addEventListener.bind(t),removeEventListener:t.removeEventListener.bind(t)}}(t.contentWindow,self,n),{origin:n,source:t.contentWindow}),a=function(r){if(r.origin===n&&t.contentWindow===r.source){var i=r.data;i.payload&&e.logger.warn("Extension sent deprecated postMessage",i)}};return window.addEventListener("message",a),function(){i(),window.removeEventListener("message",a)}}({extension:t,extensionIframe:s.current,services:c,paneId:i,replId:l,getThemeContext:function(){return g.current},onThemeChange:function(e){return m.current.push(e),function(){m.current.splice(m.current.indexOf(e),1)}},store:p,extensionStateAtom:f,environmentAPIs:a,filePath:o,logger:t.logger.createLogger({sandboxUrl:n,sandboxTitle:r}),userId:u,ghostwriter:v}))},[u,g,c,_,i,p,f,a,l,o,t,n,r,v]);return{isValidExtensionPaneUrl:_,didConnectOnce:b,getIframeProps:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,rX._)((0,x._)({title:r,src:n},oi.default,e),{ref:(0,oa.mergeRefs)([s,e.ref],{breadcrumb:"client/workspace/extensions/sandbox/useExtensionSandbox.tsx:191"}),onLoad:function(t){S(),e.onLoad&&e.onLoad(t)}})},reloadSandbox:(0,B.useCallback)(function(){if(s.current){var e=s.current.src;s.current.src=e}},[])}}function sb(e){var t=e.extension,n=e.environmentAPIs;if(!t.manifest.background)throw Error("ExtensionBackground loaded without a background script defined in manifest");var r=(0,a7.useExtensionStateAtom)(t.installationId),i=sw({extension:t,sandboxUrl:(0,on.getAssetUrl)(t.baseUrl,t.manifest.background.page),sandboxTitle:"Extension Background: "+t.manifest.name,environmentAPIs:n,paneId:null,filePath:null}),a=i.didConnectOnce,o=i.isValidExtensionPaneUrl,s=i.getIframeProps;return o()&&a&&r?(0,m.jsx)("iframe",(0,x._)({},s({css:{width:"0px",height:"0px",border:"none"}}))):null}var sj=e.i(838124),s_=e.i(557154),sS=e.i(934565),sI=e.i(952030),sC=e.i(373764);function sk(){var e,t,n,r,i,a=(0,aJ.default)(),o=(0,aX.useCurrentUserId)(),s=(0,a9.default)().container,l=(0,a5.default)(s).url,u=(0,sj.useIsExtensionRepl)(),c=(0,oe.useInstallExtension)(),d=ah(),p=(0,oe.useInstallExtensionLocallyByURL)(),f=(0,oe.useLoadExtension)(),h=(0,oe.useInitializeExtensionSystem)();(0,sj.useSyncReplConfigIsExtension)();var g=(0,a7.useExtensions)(),v=a6(),y=(0,N._)((0,B.useState)(!1),2),w=y[0],j=y[1];(0,B.useEffect)(function(){a&&o&&h({replId:a,userId:o})},[a,o,h]);var _=(0,a7.useFileHandlers)(),S=rr(tb);(0,B.useEffect)(function(){S(_)},[_,S]);var I=rr(rN);n=(e=(0,x._)({},rO,void 0),b.useQuery(rF,e)).data,r=rr(rU),i=null==n||null==(t=n.currentUser)?void 0:t.filetypeAssociations,(0,B.useEffect)(function(){i&&r(i)},[r,i]);var C=rt(rG),k=rr(rG),E=function(e){var t=e.filterUser;return function(e){var n=e.active;return(0,er._)(function(){var e,r;return(0,ei._)(this,function(i){switch(i.label){case 0:if(!n)return[2,[]];return[4,null===tY.apolloClient||void 0===tY.apolloClient?void 0:tY.apolloClient.query({query:a$,variables:{replId:a,userId:t?o:void 0}})];case 1:if(!(e=i.sent())||e.error||!(r=e.data.extensionList))return[2,[]];return[2,r.map(function(e){var t;return{match:aS.matchLabel,data:{type:"action",label:e.name,icon:(0,m.jsx)(sC.default,{}),description:null!=(t=e.description)?t:"",run:function(){e.url&&(e.installation?f({installationId:(0,aY.asInstallationId)(e.installation.id)}):c({replId:a,extensionId:(0,aY.asExtensionId)(e.id)}))}}}})]}})})()}},T=(0,a7.useExtensionCommands)(oC.ContributionType.CommandBar);return aW({data:{type:"group",key:"Extensions",description:"Commands from Extensions"},commands:function(){return(0,er._)(function(){var e;return(0,ei._)(this,function(t){switch(t.label){case 0:return e=[{data:{}}],[4,Promise.all(T.map(function(t){return(0,er._)(function(){var n;return(0,ei._)(this,function(r){switch(r.label){case 0:return[4,t.create({path:e})];case 1:if(!(n=r.sent()))return[2,null];return[2,(0,ot.wrapExtensionCommand)(n,{path:e})]}})})()}))];case 1:return[2,t.sent().filter(Boolean)]}})})()}},{enabled:!0}),aW({match:aS.matchLabel,commands:function(e){return e.active||""!==e.searchQuery?[{match:aS.matchLabel,data:{type:"action",label:"Extension Devtools",icon:(0,m.jsx)(sI.default,{}),description:"Manage and deploy this Repl as an extension",run:function(){d({pane:{type:"extensionDevtools"}})}}},{match:aS.matchLabel,data:{type:"action",label:"URL",icon:(0,m.jsx)(sI.default,{}),description:"Add an extension by URL",run:function(){j(!0)}}},{match:aS.matchLabel,data:{type:"action",label:"From this Repl",icon:(0,m.jsx)(sI.default,{}),description:"Load this Repl as an extension",run:function(){l&&p(l)}}},{match:aS.matchLabel,data:{type:"context",label:"My Extensions",icon:(0,m.jsx)(sC.default,{}),description:"Browse extensions you have created"},commands:E({filterUser:!0})},{match:aS.matchLabel,data:{type:"action",label:"Docs",icon:(0,m.jsx)(sS.default,{}),description:"Read the Extensions docs",run:function(){window.open(aQ.LINKS_DOCS.EXTENSIONS,"_blank","noopener")}}}]:[]},data:{type:"context",label:"Extensions",icon:(0,m.jsx)(sC.default,{}),description:"Manage extensions"}},{enabled:u}),(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)(aU.Modal,{isOpen:w,onRequestClose:function(){return j(!1)},children:(0,m.jsx)(s_.default,{prompt:"Add an extension by URL",desc:"Insert extension url",placeholder:"https://example-extension.replit.app",type:"text",onCancel:function(){return j(!1)},onConfirm:function(e){p(e)}})}),(0,m.jsx)(aU.Modal,{isOpen:!!C,onRequestClose:function(){return k(null)},children:C?(0,m.jsx)(a2,{fileExtension:C.fileExtension,extensionId:C.extensionId,fileHandlerId:C.fileHandlerId,onCancel:function(){return k(null)},onConfirm:function(){return(0,er._)(function(){var e;return(0,ei._)(this,function(t){switch(t.label){case 0:return e=C.fileExtension,[4,I({fileExtension:e,newAssociation:{extensionId:C.extensionId,fileHandlerId:C.fileHandlerId}})];case 1:return t.sent(),k(null),[2]}})})()}}):null}),g.map(function(e){return e.manifest.background?(0,m.jsx)(sb,{environmentAPIs:v,extension:e},e.installationId):null})]})}var sE=e.i(127227),sT=e.i(292297),sP=e.i(761922);function sR(){var e=(0,a9.default)().fs,t=(0,N._)((0,B.useState)(!1),2),n=t[0],r=t[1],i=(0,N._)((0,B.useState)(!1),2),a=i[0],o=i[1],s=(0,B.useId)();(0,B.useEffect)(function(){if(!a)return e.onDiskQuotaExceeded(function(){r(!0)})},[e,a]);var l=(0,B.useCallback)(function(){r(!1)},[r]);return(0,m.jsx)(aU.Modal,{isOpen:n,onRequestClose:l,children:(0,m.jsx)(O.View,{gap:24,children:(0,m.jsxs)(O.View,{gap:24,children:[(0,m.jsxs)(a0.Header,{level:3,variant:"headerDefault",children:["Oops! This Repl's disk is full"," ",(0,m.jsx)(sT.default,{color:A.tokens.accentNegativeDefault,size:20})]}),(0,m.jsxs)(a0.Text,{variant:"subheadDefault",children:["Please free up space by deleting some files. You can open the file tree by clicking the ",(0,m.jsx)(sP.default,{})," icon on the left."]}),(0,m.jsx)(a0.Text,{children:"You can check how much space you are using from the Repl Resources section under the file tree."}),(0,m.jsxs)(O.View,{row:!0,gap:8,tag:"label",children:[(0,m.jsx)(sE.Checkbox,{id:s,checked:a,onChange:o}),(0,m.jsx)(a0.Text,{variant:"small",children:"Do not show this message again for this session."})]}),(0,m.jsx)(aZ.Button,{onClick:l,text:"Close"})]})})})}var sA=e.i(816639),sD=e.i(989740),sV=e.i(679668),sO=e.i(515791);function sF(){var e=rr(nY),t=(0,sD.default)({moveOrDeleteFile:e}),n=t.isConverging,r=t.didContentsDiverge,i=t.showMoreDetail,a=t.failedFiles,o=t.failedFilesOptions,s=t.selectedFile,l=t.setSelectedFile,u=t.reviewingPrompt,c=t.onChoice,d=t.local,p=t.remote,f=[i8.rcss.minHeight("7em"),i8.rcss.maxHeight("50vh"),i8.rcss.overflowY("auto"),{"> div":{display:"flex",alignItems:"stretch",width:"100%",height:"100%"},"> div > .cm-editor":{flex:"1 1 auto",width:"100%"}}];return(0,m.jsx)(aU.Modal,{css:[{maxHeight:"90%"}],preventClose:!0,maxWidth:"90%",isOpen:r,onRequestClose:function(){},children:(0,m.jsxs)(O.View,{gap:24,children:[(0,m.jsx)(a0.Header,{level:3,variant:"headerDefault",children:"Replit is out of sync!"}),(0,m.jsxs)(a0.Text,{children:["Sometimes Replit has trouble making sure everyone's code is the same. Let us know which version of"," ",a.length>1?"these files":"this file"," you'd like to keep."," ",a.length>1?(0,m.jsxs)("strong",{children:["There are ",a.length," files impacted by this."]}):""]}),n?(0,m.jsx)(sO.default,{}):(0,m.jsxs)(m.Fragment,{children:[o.length?(0,m.jsx)(sV.Select,{"aria-label":"Select file with diverged contents",initialSelectedItem:o[0],selectedItem:o.find(function(e){return e.path===s}),items:o,onChange:function(e){l(e.path)}}):null,i?(0,m.jsxs)(O.View,{css:[i8.rcss.backgroundColor.redDimmest,i8.rcss.font.code],pt:16,p:8,row:!0,gap:16,justify:"start",align:"center",children:[(0,m.jsx)(a0.Text,{variant:"subheadDefault",multiline:!1,children:"Debug View"}),(0,m.jsxs)(a0.Text,{multiline:!1,children:["Divergence type: ",null==u?void 0:u.case]})]}):null,(0,m.jsxs)(O.View,{row:!0,gap:8,children:[(0,m.jsxs)(O.View,{css:[{flexBasis:0}],grow:!0,shrink:!0,children:[(0,m.jsx)(a0.Text,{variant:"subheadDefault",multiline:!1,children:"My changes"}),(0,m.jsx)(V.Surface,{elevated:!0,grow:!0,shrink:!0,py:8,children:(0,m.jsx)(O.View,{css:f,children:(0,m.jsx)(sA.DiffComponent,{diffViewer:d})})}),(0,m.jsxs)(O.View,{pt:16,children:[(0,m.jsx)(a0.Text,{css:[i8.rcss.textAlign.center],children:"This might disrupt other people's work or create unexpected bugs."}),(0,m.jsx)(aZ.Button,{onClick:function(){c("local")},text:"Reset to Mine"})]})]}),(0,m.jsxs)(O.View,{css:[{flexBasis:0}],grow:!0,shrink:!0,children:[(0,m.jsx)(a0.Text,{variant:"subheadDefault",multiline:!1,children:"Shared changes"}),(0,m.jsx)(V.Surface,{elevated:!0,grow:!0,shrink:!0,py:8,children:(0,m.jsx)(O.View,{css:f,children:(0,m.jsx)(sA.DiffComponent,{diffViewer:p})})}),(0,m.jsxs)(O.View,{pt:16,justify:"end",children:[(0,m.jsx)(a0.Text,{css:[i8.rcss.textAlign.center],children:"This is the safest option and won't disrupt other's work."}),(0,m.jsx)(aZ.Button,{onClick:function(){c("remote")},text:"Sync to Shared",colorway:"primary"})]})]})]})]})]})})}var sM=e.i(260924),sL=e.i(317919),sG=e.i(703916);e.i(312917);var sU=e.i(675186),sN=e.i(387491);function sB(e,t){var n=(0,i2.default)(t);return(0,B.useMemo)(function(){var t,r;return t="current"in e?new em.Multicast(function(t){return t.next(e.current),e.subscribe(function(e){return t.next(e)})}):e,r=function(){return n.current()},new em.Multicast(function(e){var n=null,i=null,a=null,o=null,s=t.subscribe(function(t){null==n||n.stop(),i&&(clearTimeout(i),i=null);var s=r();if(!s&&o&&(s=o),!1===s){a=t,e.next(t);return}o=s;var l=!0===s?{}:s,u=l.snappiness,c=void 0===u?400:u,d=l.ramp,p=l.delay,f=void 0===p?0:p,h=0,g={};for(var m in t)g[m]=a&&m in a?a[m]:t[m];n=new sU.AnimationLoop(function(n,r){for(var i in h+=n,t){if("number"!=typeof g[i]||"number"!=typeof t[i]){g[i]=t[i];continue}var s=g[i],l=t[i],u=s>=0&&s<=1&&l>=0&&l<=1?.001:void 0;g[i]=(0,sN.damp)({current:s,target:l,elapsed:h,delta:n,snappiness:c,ramp:d,minStepSize:u})}e.next((0,x._)({},g)),(0,tu.default)(g,t)&&(o=null,a=t,r())}),f>0?i=setTimeout(function(){i=null,null==n||n.start()},f):n.start()});return function(){null==n||n.stop(),i&&clearTimeout(i),s()}})},[e,n])}var sW=e.i(86159),sz=e.i(160290),sH=e.i(710078),sq=e.i(939040),sK=e.i(779830),s$=e.i(629536),sQ=e.i(709867),sY=e.i(812432),sX=e.i(718610),sJ=e.i(503536),sZ=e.i(709263),s0=e.i(406345),s1=e.i(634669),s2=e.i(919015),s4=e.i(733257),s8=e.i(362874),s3=e.i(680189),s6=((i={}).Welcome="Welcome",i.AiFirstWorkspace="AiFirstWorkspace",i.Assistant="Assistant",i.Agent="Agent",i.SidebarDock="SidebarDock",i.Run="Run",i.Deploy="Deploy",i.NewTab="NewTab",i.Filetree="Filetree",i),s5=(0,ro.cssRecord)({tooltipContainer:[i8.rcss.width("100%"),i8.rcss.maxWidth(300),i8.rcss.position.relative,i8.rcss.colWithGap(8),i8.rcss.pb(8)],textContent:[i8.rcss.width("100%"),{wordBreak:"break-word",overflowWrap:"anywhere"}]}),s9={id:"AiFirstWorkspace",title:"Welcome to the workspace",isModal:!0,content:function(){return(0,m.jsx)(O.View,{css:s5.tooltipContainer,"data-cy":"workspace-tour-welcome",children:(0,m.jsx)(a0.Text,{css:s5.textContent,children:"This is where you will turn your ideas to reality. Lets take a look around!"})})},colorway:!1},s7={id:"AiFirstWorkspace",title:"Welcome back to Replit!",isModal:!0,content:function(){return(0,m.jsx)(O.View,{css:s5.tooltipContainer,"data-cy":"workspace-tour-welcome",children:(0,m.jsx)(a0.Text,{css:s5.textContent,children:"Weve moved a few things around, making the workspace more focused to keep you in flow. Lets explore the changes!"})})},colorway:!1},le={id:"Agent",title:"Meet Replit ".concat(s$.AGENT_NAME),icon:function(){return(0,m.jsx)(sY.default,{size:16})},content:function(){return(0,m.jsxs)(O.View,{css:s5.tooltipContainer,children:[(0,m.jsx)(a0.Text,{css:s5.textContent,children:"Agent is a creative partner that builds apps for you. You can customize it to fit your needs with these menus:"}),(0,m.jsx)(lt,{icon:(0,m.jsx)(s1.default,{}),title:"Agent Modes",description:"Switch between ".concat(sQ.BUILD_MODE_LABEL,", ").concat(sQ.PLAN_MODE_LABEL,", and ").concat(sQ.EDIT_MODE_LABEL,".")}),(0,m.jsx)(lt,{icon:(0,m.jsx)(sZ.default,{}),title:"Tools",description:"Modify the tools and capabilities of Agent"})]})},autoSkipIfNoTarget:!0,colorway:!1};function lt(e){var t=e.icon,n=e.title,r=e.description;return(0,m.jsxs)(O.View,{row:!0,gap:6,grow:!0,shrink:!0,children:[(0,m.jsx)(V.Surface,{p:2,className:s3.default.iconSurface,elevated:!0,align:"center",justify:"center",style:{flexShrink:0},children:t}),(0,m.jsxs)(O.View,{style:{minWidth:0,flex:1},children:[(0,m.jsx)(a0.Text,{style:{wordBreak:"break-word"},children:n}),r?(0,m.jsx)(a0.Text,{variant:"small",color:"dimmer",style:{wordBreak:"break-word",overflowWrap:"anywhere"},children:r}):null]})]})}var ln={id:"NewTab",title:"Open tools & files",icon:function(){return(0,m.jsx)(s2.default,{size:16})},content:function(){return(0,m.jsxs)(O.View,{css:s5.tooltipContainer,children:[(0,m.jsx)(a0.Text,{css:s5.textContent,children:"You can find tools, and search for code by opening a new tab. Not sure what to check out first? Try these:"}),(0,m.jsx)(lt,{icon:(0,m.jsx)(sT.default,{}),title:"Database",description:"Manage or create your app's built-in database"}),(0,m.jsx)(lt,{icon:(0,m.jsx)(s8.default,{}),title:"Auth",description:"Add support for signing up and logging in to your app"}),(0,m.jsx)(lt,{icon:(0,m.jsx)(s0.default,{}),title:"Integrations",description:"Connect external services to your app"}),(0,m.jsx)(lt,{icon:(0,m.jsx)(sX.default,{}),title:"Developer Tools",description:"Advanced access to networking, dependencies, and resources"}),(0,m.jsx)(lt,{icon:(0,m.jsx)(sI.default,{}),title:"Open a new tab to discover more"})]})},colorway:!1},lr={id:"Deploy",title:"Publish your project",icon:function(){return(0,m.jsx)(sJ.default,{size:16})},content:function(){return(0,m.jsx)(O.View,{css:s5.tooltipContainer,children:(0,m.jsxs)(a0.Text,{css:s5.textContent,children:["Once your app is ready, ",(0,m.jsx)("strong",{children:"publish"})," it to the internet with a URL you can share with anyone. You can also publish on the go using the"," ",(0,m.jsx)("a",{href:"https://replit.com/mobile",target:"_blank",children:"Replit mobile app"}),"."]})})},colorway:!1},li={id:"Filetree",title:"Quick access to files",icon:function(){return(0,m.jsx)(s4.default,{clsx:s3.default.flippedIcon,size:16})},content:function(){return(0,m.jsx)(O.View,{css:s5.tooltipContainer,children:(0,m.jsxs)(a0.Text,{css:s5.textContent,children:["Click the ",(0,m.jsx)("strong",{children:"Files"})," button to browse and manage your project files. You can create, rename, delete, and organize files and folders here."]})})},colorway:!1},la="workspace-desktop-tour-2025",lo=e.i(761732),ls=e.i(31290),ll=e.i(886513),lu=e.i(224373),lc=(0,A.cvarsFrom)("ResizeHandle.module.css",["--width"]),ld=(0,B.memo)(function(){var e=(0,B.useRef)(null),t=aj(),n=(0,lo.default)(t.agentFiletreeOrder);return(0,m.jsx)(lp,{gutter:t.gutter,side:"filetree-agent"===n?"left":"right",onDoubleClick:function(){t.toggle("collapsed"===t.displayState.current)},onPointerDown:function(n){(0,ls.measureMouseMove)(n,{start:function(){e.current=document.activeElement,t.resizeSidebar({type:"start"})},move:function(e){var n=e.delta;t.resizeSidebar({type:"update",moveDelta:n})},end:function(){var n,r;t.resizeSidebar({type:"end"}),null==(r=e.current)||null==(n=r.focus)||n.call(r)}})}})});function lp(e){var t=e.gutter,n=e.side,r=(0,ll._)(e,["gutter","side"]),i=(0,B.useRef)(null);return(0,tK.useStyleSet)(i,t,function(e){return(0,P._)({},lc.width,e+"px")}),(0,m.jsx)(O.View,(0,rX._)((0,x._)({clsx:[lu.default.root,lu.default[n]],align:"center",justify:"center",innerRef:i},r),{children:(0,m.jsx)(O.View,{clsx:lu.default.grip})}))}function lf(){var e=ab(),t=aj(),n=(0,lo.default)(t.agentFiletreeOrder),r=(0,B.useRef)(null);return(0,m.jsx)(lp,{gutter:t.gutter,side:"agent-filetree"===n?"left":"right",onPointerDown:function(t){(0,ls.measureMouseMove)(t,{start:function(){(0,ol._)(document.activeElement,HTMLElement)&&(r.current=document.activeElement),e.resize.start()},move:function(t){var n=t.delta;e.resize.update(n.x)},end:function(){var t,n;e.resize.end(),null==(n=r.current)||null==(t=n.focus)||t.call(n),r.current=null}})},onDoubleClick:function(){e.toggle()}})}var lh=e.i(6560),lg=e.i(1736),lm=e.i(793579),lv=e.i(491694),lx=(0,A.cvarsFrom)("Search.module.css",["--input-height"]),ly={type:"context",icon:(0,m.jsx)(lm.default,{}),label:"",description:"Search"};function lw(e){var t=(0,a9.default)().fs,n=(0,ny.useGetRecentFiles)(),r=am(),i=(0,lg.useShouldHideFileInWorkspace)(),a=(0,B.useMemo)(function(){var e=(0,lh.createFindOrCreateFileCommand)({openFile:r,fs:t,shouldHideFile:i,getRecentFiles:n});return e.data=ly,delete e.match,e},[r,t,i,n]);return(0,m.jsx)(O.View,{onContextMenu:e.onContextMenu,clsx:lv.default.root,style:(0,P._)({},lx.inputHeight,"32px"),children:(0,m.jsx)(aN.CommandBar,{fullWidth:!0,command:a,openOnInput:!0,compact:!0})})}var lb=e.i(61524),lj=e.i(670413),l_=e.i(429225),lS=e.i(84396),lI=e.i(483570),lC=e.i(312421),lk=e.i(714312),lE=e.i(545082),lT=e.i(423111),lP=e.i(619319),lR=e.i(240913),lA=e.i(133294),lD=e.i(185511),lV=e.i(274526),lO=e.i(714603),lF=e.i(211397),lM=e.i(254806),lL=e.i(841691),lG=e.i(90102),lU=e.i(342574),lN=e.i(703505);function lB(e){var t=e.size,n=e.iconUrl,r=e.name;return(0,m.jsx)(lF.default,{src:n,width:t,height:t,alt:"Icon for file opener: ".concat(r)})}var lW=/[*]{2}\/[*]\.([a-z0-9.]+)/,lz=e.i(136540),lH=e.i(557862),lq=e.i(419735),lK=e.i(842435),l$=e.i(926415),lQ={id:"sidebar.toggle",name:"Toggle filetree",description:"Opens or closes the filetree",default:(0,aG.defaultKeyCombo)({cmdOrCtrl:!0,shift:!0,key:"b"})},lY=(0,A.cvarsFrom)("index.module.css",["--width","--height","--transform","--pointer-events","--opacity","--z-index"]),lX=(0,B.memo)(function(){var e,t,n,r,i,a,o,s,l,u,c,d,p,f,h,g,v,y,w,b,j,_,S,I,C,k,T,R,A,D,F,M,L,G,U,W,z,H,q,$,Q,Y,X,J,Z=(0,B.useRef)(null),ee=ab(),et=ee.view;(0,tK.useStyleSet)(Z,sB(et,ee.getTransitionEnabled),function(e){var t;return t={},(0,P._)(t,lY.width,e.width+"px"),(0,P._)(t,lY.height,e.height+"px"),(0,P._)(t,lY.transform,"translate(".concat(e.x,"px, ").concat(e.y,"px)")),(0,P._)(t,lY.pointerEvents,e.isOpen?"all":"none"),(0,P._)(t,lY.opacity,e.opacity.toString()),(0,P._)(t,lY.zIndex,ra.zIndexLevels.filetreeDragLayer.toString()),t});var ea=(e=(0,aJ.default)(),n=(t=(0,N._)((0,B.useState)(null),2))[0],r=t[1],i=am(),a=(0,lC.useTrackOpenFile)(),o=(0,lg.useShouldHideFileInWorkspace)(!0),s=(0,B.useCallback)(function(e){return!o(e.filename)},[o]),l=(0,a9.default)().fs,u=(0,lb.usePreferences)("multiselectModifierKey").preferences,c=rr(tk),d="cmdOrCtrlKey"===u.multiselectModifierKey?"cmdOrCtrlKey":"altKey",p=(0,ny.useGetRecentFiles)(),f=(0,B.useCallback)(function(e){return(0,lk.getFileExtensionSuggestions)(e,p)},[p]),h=(0,lS.useContextMenu)().onContextMenu,g=(0,aJ.default)(),v=(0,a9.default)().fs,y=am(),w=rr(nj),b=rt(tb),j=(0,a7.useExtensionCommands)(oC.ContributionType.FiletreeContextMenu),_=rt(rL),S=rr(rN),I=(0,E.useFlag)({controlName:"flag-folder-downloads"}),C=(0,E.useFlag)({controlName:"flag-direct-file-downloads"}),k=rr(rG),T=(0,B.useCallback)(function(e){var t=e.extensionId,n=e.fileExtension,r=e.fileHandlerId,i=_[n];i&&i.extensionId===t&&i.fileHandlerId===r||k(e)},[k,_]),R=(0,B.useCallback)(function(e,t){var n=e.path,r=[{data:{type:"group",key:"rename"},commands:function(){return[(0,lV.getRenameCommand)(function(){return t.rename(n)})]}}];(0,ih.isOTFile)(n)&&r.push({data:{type:"group",key:"saveFile"},commands:function(){return[(0,lV.getSaveCommand)(function(){return(0,er._)(function(){return(0,ei._)(this,function(e){switch(e.label){case 0:return[4,v.flush(new Set([n]),nG.FlushSource.MANUAL_SAVE)];case 1:return e.sent(),[2]}})})()})]}}),r.push({data:{type:"group",key:"open"},commands:function(){return function(e){var t=e.path,n=e.getSelectedNodes,r=e.openFile,i=[{type:nG.FileType.File,path:t}],a=!0,o=!1,s=void 0;try{for(var l,u=n()[Symbol.iterator]();!(a=(l=u.next()).done);a=!0){var c=(0,N._)(l.value,2),d=c[0],p=c[1];p!==nG.FileType.Directory&&d!==t&&i.push({path:d,type:p})}}catch(e){o=!0,s=e}finally{try{a||null==u.return||u.return()}finally{if(o)throw s}}var f=i.length,h=1===f?"Open":"Open ".concat(f," files");return[{label:h,icon:(0,m.jsx)(lL.default,{}),run:function(){var e=!0,t=!1,n=void 0;try{for(var a,o=i[Symbol.iterator]();!(e=(a=o.next()).done);e=!0){var s=a.value;r({path:s.path,newTab:!0})}}catch(e){t=!0,n=e}finally{try{e||null==o.return||o.return()}finally{if(t)throw n}}}},{label:h+" in split",icon:(0,m.jsx)(i5.default,{}),run:function(){var e=(0,eD._)(i),t=e[0],n=e.slice(1);r({path:t.path,newPane:!0});var a=!0,o=!1,s=void 0;try{for(var l,u=n[Symbol.iterator]();!(a=(l=u.next()).done);a=!0){var c=l.value;r({path:c.path,newTab:!0})}}catch(e){o=!0,s=e}finally{try{a||null==u.return||u.return()}finally{if(o)throw s}}}}].map(function(e){var t=e.label,n=e.icon,r=e.run;return{match:aS.matchLabel,data:{type:"action",label:t,icon:n,run:r}}})}({path:n,getSelectedNodes:t.getSelectedNodes,openFile:y})}});var i=function(e){var t=function(e){var t=r[e],i=(0,lP.globToRegExp)(t.glob);if(!i||!i.exec(n))return"continue";var s=lW.exec(t.glob),l=t.icon?t.icon:t.extension.manifest.icon,u=t.name?t.name:t.extension.manifest.name,d=l?(0,on.getAssetUrl)(t.extension.baseUrl,l):null;c.push({match:aS.matchLabel,data:{type:"action",icon:d?(0,m.jsx)(lB,{size:16,name:u,iconUrl:d}):(0,m.jsx)(lL.default,{}),label:"Open with "+u,run:function(){s&&o({extensionId:t.extension.extensionId,fileHandlerId:e,fileExtension:s[1]}),a({path:n,opener:{paneType:"extension",supports:function(){return!0},extensionFileHandler:t}})}}})},n=e.path,r=e.handlers,i=e.filetypeAssociations,a=e.openFile,o=e.requestAssociateFiletype,s=e.associateFiletype,l=(0,ig.getFileExtension)(n),u=l?i[l]:null,c=[];for(var d in r)t(d);return u&&l&&c.length&&c.push({match:aS.matchLabel,data:{icon:(0,m.jsx)(lN.default,{}),type:"action",label:"Use default opener",run:function(){s({fileExtension:l,newAssociation:null})}}}),c}({path:n,handlers:b,filetypeAssociations:_,requestAssociateFiletype:T,associateFiletype:S,openFile:y});return i.length&&r.push({data:{type:"group",key:"extensions"},commands:function(){return i}}),r.push({data:{type:"group",key:"copy"},commands:function(){return(0,lV.getCopyCommands)(n)}}),r.push((0,lV.getDuplicateCommand)(function(){return(0,er._)(function(){var e;return(0,ei._)(this,function(r){switch(r.label){case 0:e=null,r.label=1;case 1:return r.trys.push([1,3,,4]),[4,(0,lA.default)(n,v)];case 2:return e=r.sent(),[3,4];case 3:return r.sent(),[2,{type:"error",message:"Error duplicating file"}];case 4:return(0,lO.default)({replId:g,action:"duplicated",fileType:nG.FileType.File}),t.rename(e),[2]}})})()})),r.push((0,lD.createDownloadCommand)(n,v,C)),r.push({data:{type:"group",key:"deleteFile"},commands:function(){return[(0,lV.getDeleteCommand)(function(){return t.deleteNodes(e)})]}}),r.push({data:{type:"group",key:"extensions"},commands:function(){return(0,er._)(function(){var e;return(0,ei._)(this,function(t){switch(t.label){case 0:return e=[{data:{filePath:n,fileType:nG.FileType.File}}],[4,Promise.all(j.map(function(t){return(0,er._)(function(){var n;return(0,ei._)(this,function(r){switch(r.label){case 0:return[4,t.create({path:e})];case 1:if(!(n=r.sent()))return[2,null];return[2,(0,ot.wrapExtensionCommand)(n,{path:e})]}})})()}))];case 1:return[2,t.sent().filter(Boolean)]}})})()}}),r},[b,_,T,S,y,v,C,g,j]),A=(0,lT.useSetAreHiddenFilesVisible)(),D=(0,lT.useAreHiddenFilesVisible)(),F=(0,K.useSupportsAgent)(),L=(M=(0,lb.usePreferences)("agentPosition")).preferences.agentPosition,G=M.update,U=(0,B.useCallback)(function(e,t){var n=e.path,r=n===lR.ROOT_PATH,i=r?[]:[{data:{type:"group",key:"rename"},commands:function(){return[(0,lV.getRenameCommand)(function(){return t.rename(e.path)})]}}];if(i.push({data:{type:"group",key:"search"},commands:function(){var t;return[(t=e.path,{match:aS.matchLabel,data:{type:"action",icon:(0,m.jsx)(lm.default,{}),label:"Search this directory",run:function(){w({pane:{type:"searchReplace",data:{initialIncludeGlob:"".concat(t,"/**")}},edge:"right"})}}})]}}),i.push.apply(i,(0,en._)((0,lV.getCreateCommands)(function(n){return t.create(n,e.path)}))),i.push({data:{type:"group",key:"openShell"},commands:function(){return[{match:aS.matchLabel,data:{type:"action",label:"Open shell here",icon:(0,m.jsx)(lU.default,{}),run:function(){w({pane:{type:"shell",data:{initialPwd:n}},edge:"left"})}}}]}}),r||i.push({data:{type:"group",key:"copy"},commands:function(){return(0,lV.getCopyCommands)(n)}}),t.getExpandedDirs()&&i.push({match:aS.matchLabel,data:{icon:(0,m.jsx)(lM.default,{}),type:"action",label:"Collapse "+(r?"all":"child folders"),run:function(){var e=t.getExpandedDirs(n);e&&t.collapse((0,en._)(e))}}}),!r&&I&&i.push({data:{type:"group",key:"downloadFolder"},commands:function(){return[(0,lD.createDownloadFolderCommand)(n)]}}),r||i.push({data:{type:"group",key:"deleteFile"},commands:function(){return[(0,lV.getDeleteCommand)(function(){return t.deleteNodes(e)})]}}),r&&i.push({data:{type:"group",key:"hiddenFiles"},commands:function(){return[{match:aS.matchLabel,data:{type:"action",label:(D?"Hide":"Show")+" hidden files",icon:D?(0,m.jsx)(lG.default,{}):(0,m.jsx)(lL.default,{}),run:function(){A(!D)}}}]}}),i.push({data:{type:"group",key:"extensions"},commands:function(){return(0,er._)(function(){var e;return(0,ei._)(this,function(t){switch(t.label){case 0:return e=[{data:{dirPath:n,fileType:nG.FileType.Directory}}],[4,Promise.all(j.map(function(t){return(0,er._)(function(){var n;return(0,ei._)(this,function(r){switch(r.label){case 0:return[4,t.create({path:e})];case 1:if(!(n=r.sent()))return[2,null];return[2,(0,ot.wrapExtensionCommand)(n,{path:e})]}})})()}))];case 1:return[2,t.sent().filter(Boolean)]}})})()}}),r&&F){var a={type:"action",label:"Move filetree to the "+("leftSidebar"===L?"left":"right"),icon:"leftSidebar"===L?(0,m.jsx)(i5.default,{}):(0,m.jsx)(i9.default,{}),run:function(){G({agentPosition:"leftSidebar"===L?"rightSidebar":"leftSidebar"})}};i.push({data:{type:"group",key:"move"},commands:function(){return[{match:aS.matchLabel,data:a}]}})}return i},[D,A,j,w,I,F,G,L]),W=(0,B.useCallback)(function(e,t){return{data:{type:"context",label:"Search actions",icon:(0,m.jsx)(lm.default,{})},commands:function(){return e.type===nG.FileType.Directory?U(e,t):R(e,t)}}},[R,U]),z=(0,lT.useSetFileRenameInProgress)(),H=(0,sz.useFiletree)({fs:l,filter:s,fontSize:13,onFileDoubleClick:function(e,t){c(t)},onFileSelect:function(e){var t=e.path,n=e.type,r=e.event,o="click"===n&&"altKey"===d?(0,lj.getCmdOrCtrl)(r):r.altKey;i({path:t,newTab:o}),a(t,{newTab:o})},onCreate:function(e){e.type===nG.FileType.File&&i({opener:{paneType:(0,ti.getPaneTypeForFile)({path:e.path})},path:e.path})},multiselectModifierKey:d,onConflicts:function(e){return r({type:"conflicts",data:e})},onDeleteNodes:function(e){return r({type:"deleteNode",data:e})},onContextMenu:function(e,t){return h(e,{command:W(t,H)})},autocomplete:f,localCacheKey:e+":sidebar",onFileRenameStart:z,onFileRenameEnd:function(){return z(null)}}),q=(0,lI.useFileTreeGitStatus)(),(0,B.useEffect)(function(){return H.setFileStatus(q)},[H,q]),$=(0,ny.useObservableActiveFile)(),(0,B.useEffect)(function(){var e=function(e){return(0,er._)(function(){return(0,ei._)(this,function(t){switch(t.label){case 0:if(null===e)return H.select(null),[2];return[4,H.select({path:e,type:nG.FileType.File})];case 1:if(t.sent(),$.current!==e)return[2];return H.scrollToPath(e),[2]}})})()};return e($.current),$.subscribe(e)},[$,H]),Q=ab(),Y=(0,ny.useObservableRevealFile)(),X=(0,ny.useSetRevealFile)(),(0,B.useEffect)(function(){var e=function(e){return(0,er._)(function(){return(0,ei._)(this,function(t){switch(t.label){case 0:if(null===e)return[2];return Q.isOpen.current||Q.toggle(),[4,H.select({path:e,type:nG.FileType.File})];case 1:return t.sent(),H.scrollToPath(e),X(null),[2]}})})()};return e(Y.current),Y.subscribe(e)},[Y,X,H,Q]),J=(0,B.useCallback)(function(e){return h(e,{command:W({type:nG.FileType.Directory,path:"."},H)})},[H,W,h]),{filetree:H,activeModal:n,closeModal:function(){return r(null)},onRootContextMenu:J}),eo=ea.filetree,es=ea.activeModal,el=ea.closeModal,eu=ea.onRootContextMenu,ec=(0,sW.useSetTourStepTarget)(la,s6.Filetree),ed=(0,oa.useMergeRefs)([Z,Z,ec]);return(0,m.jsxs)(m.Fragment,{children:[(0,m.jsxs)(V.Surface,{clsx:l$.default.root,innerRef:ed,children:[(0,m.jsx)(lJ,{filetree:eo}),(0,m.jsxs)(O.View,{clsx:l$.default.content,grow:!0,shrink:!0,children:[(0,m.jsx)(lw,{onContextMenu:eu}),(0,m.jsx)(O.View,{grow:!0,shrink:!0,dataCy:"sidebar-filetree-section",children:(0,m.jsx)(sz.Filetree,{store:eo.store})})]}),(0,m.jsx)(lf,{})]}),(0,m.jsxs)(aU.Modal,{isOpen:!!es,onRequestClose:el,children:[(null==es?void 0:es.type)==="conflicts"?(0,m.jsx)(sH.default,{paths:es.data.conflicts.map(function(e){return e.path}),onCancel:el,onConfirm:function(){var e=es.data;"move"===e.type?eo.move({nodes:e.nodes,to:e.to,overwrite:!0}):eo.upload({files:e.files,parentPath:e.to,overwrite:!0}),el()}}):null,(null==es?void 0:es.type)==="deleteNode"?(0,m.jsx)(lH.default,(0,rX._)((0,x._)({},(0,sq.getDeleteText)(es.data.nodes)),{delete:function(){return es.data.confirm()},hideModal:el})):null]})]})});function lJ(e){var t=e.filetree,n=ab().toggle,r=(0,B.useCallback)(function(){return n(!1)},[n]);return(0,m.jsxs)(O.View,{clsx:l$.default.header,row:!0,gap:4,align:"center",pl:6,pr:4,children:[(0,m.jsx)(O.View,{grow:!0,shrink:!0,row:!0,gap:4,align:"center",children:(0,m.jsx)(a0.Text,{css:l$.default.title,children:"Files"})}),(0,m.jsxs)(O.View,{row:!0,gap:0,align:"center",children:[(0,m.jsx)(lz.IconButton,{dataCy:"filetree-add-file",alt:"New file",onClick:function(){t.create(nG.FileType.File)},children:(0,m.jsx)(lq.default,{})}),(0,m.jsx)(lz.IconButton,{alt:"New folder",onClick:function(){t.create(nG.FileType.Directory)},children:(0,m.jsx)(lK.default,{})}),(0,m.jsx)(sK.RootActions,{closeFiletree:r,filetree:t})]})]})}var lZ=e.i(316699),l0=e.i(142685),l1=e.i(610357);e.i(653863);var l2=e.i(973519),l4=e.i(744895),l8=e.i(702522),l3=e.i(41e4),l6=e.i(927158),l5=e.i(90376),l9=e.i(759097),l7=["","","","","",""];function ue(e){return new Promise(function(t){return setTimeout(t,e)})}var ut=e.i(989481),un=e.i(412160),ur=e.i(279042);function ui(){var e=(0,y._)(["\n  fragment ReplEnvironmentDesktopMyReplsSearchRepl on Repl {\n    id\n    title\n    timeUpdated\n    url\n    iconUrl\n    ...ReplLinkRepl\n    owner {\n      ... on User {\n        id\n        username\n        image\n      }\n      ... on Team {\n        id\n        username\n        image\n      }\n    }\n  }\n  ","\n"]);return ui=function(){return e},e}function ua(){var e=(0,y._)(["\n  query ReplEnvironmentDesktopMyReplsSearch($query: String, $count: Int) {\n    currentUser {\n      id\n      search {\n        repls(query: $query, count: $count) {\n          id\n          ...ReplEnvironmentDesktopMyReplsSearchRepl\n        }\n      }\n    }\n  }\n  ","\n"]);return ua=function(){return e},e}var uo=(0,w.gql)(ui(),ur.ReplLinkReplFragmentDoc),us=(0,w.gql)(ua(),uo),ul=e.i(314531),uu=e.i(46654),uc=e.i(228108),ud=e.i(290446),up=e.i(243074),uf=(0,ro.cssRecord)({root:[i8.rcss.viewStyle,i8.rcss.rowWithGap(8),i8.rcss.align.center,i8.rcss.px(8),{textDecoration:"none"}],meta:{fontSize:10}});function uh(e){var t=e.repl,n=e.height,r=e.isActive,i=e.searchQuery,a=t.title,o=(0,B.useMemo)(function(){return i?ul.default.match(i,a):null},[i,a]);return(0,m.jsxs)(un.default,{href:t.url,passHref:!0,style:{height:n},css:uf.root,children:[(0,m.jsx)(uc.default,{alt:t.title,size:32,iconUrl:t.iconUrl}),(0,m.jsxs)(O.View,{grow:!0,shrink:!0,gap:2,children:[(0,m.jsx)(ud.HighlightMatches,{text:t.title,highlight:null==o?void 0:o.ranges,dimmed:!r}),(0,m.jsxs)(a0.Text,{css:uf.meta,color:"dimmest",multiline:!1,children:[t.owner.username,"  edited ",(0,uu.ago)(t.timeUpdated)]})]})]})}function ug(){var e=am(),t=ah();return(0,B.useCallback)(function(n){return(0,ti.isFilePane)(n)&&n.data.path?e((0,rX._)((0,x._)({},n.data),{path:n.data.path})):t({pane:n})},[t,e])}var um=e.i(926118),uv=(0,ea.atom)(!1),ux=(0,ea.atom)(null,function(e,t){e(uv)?(0,eu.flushSync)(function(){t(uv,!1)}):t(uv,!0)});function uy(){return(0,eo.useSetAtom)(ux)}var uw=e.i(62534),ub=e.i(695337),uj={id:"toggleKeyboardShortcuts",name:"Keyboard shortcuts Help",description:"Opens the keyboard shortcuts modal",default:"Shift-/"};let u_=function(){var e=(0,eo.useAtomValue)(uv),t=uy();return(0,m.jsx)(aU.Modal,{isOpen:e,onRequestClose:t,maxWidth:1200,centered:!0,children:(0,m.jsx)(O.View,{gap:12,children:(0,m.jsx)(uI,{})})})};var uS=["toggleGlobalCommandBarCommand","agent.switchMode","agent.toggle","webviewpane.reload","toggleKeyboardShortcuts","sidebar.toggle","paneMenu.toggle","files.searchContents","files.searchFiles","repl.showShell"];function uI(){var e=(0,aD.useKeyBindings)(),t=ug(),n=uy(),r=(0,en._)(e.values()).filter(function(e){return e.shortcut}).filter(function(e){return void 0===e.scope}).sort(function(e,t){var n=uS.indexOf(e.id),r=uS.indexOf(t.id);return -1!==n&&-1!==r?n-r:e.description&&!t.description?-1:!e.description&&t.description?1:e.name.localeCompare(t.name)}),i=(0,B.useCallback)(function(){t({type:"preferences",data:{tab:1}}),n()},[t,n]);return(0,m.jsxs)(O.View,{p:0,gap:12,children:[(0,m.jsx)(a0.Header,{level:2,variant:"subheadBig",children:"Keyboard shortcuts"}),r.length>0?(0,m.jsx)(V.Surface,{className:ub.default.surface,children:r.map(function(e){return(0,m.jsxs)(O.View,{row:!0,align:"start",justify:"space-between",gap:8,"data-testid":e.id,children:[(0,m.jsxs)(O.View,{grow:0,shrink:!0,gap:2,children:[(0,m.jsx)(a0.Text,{multiline:!1,children:e.name}),e.description?(0,m.jsx)(a0.Text,{color:"dimmest",multiline:!1,children:e.description}):null]}),e.shortcut?(0,m.jsx)(um.KeyComboBlocks,{small:!0,keyCombo:e.shortcut}):null]},e.id)})}):(0,m.jsx)(O.View,{children:(0,m.jsx)(a0.Text,{color:"dimmest",children:"No keyboard shortcuts found."})}),(0,m.jsx)(O.View,{align:"start",children:(0,m.jsx)(aZ.Button,{variant:"outlined",onClick:i,iconLeft:(0,m.jsx)(uw.default,{}),text:"Customize keyboard shortcuts"})})]})}var uC=e.i(556088),uk=e.i(171362),uE=e.i(369948),uT=e.i(360877),uP=e.i(357399),uR=["fontSize","wrapping","minimapDisplay","indentDetection","indentFormatPastes","indentIsSpaces","keyboardHandler","showFileTreeGitStatus","codeIntelligence","shellBellAudio","accessibleTerminal","webviewAutoOpenOnPortOpened","forwardPortsAutomatically","multiselectModifierKey","codeSuggestion","chatEngine","ghostwriterModelSelection"],uA=e.i(982829),uD=e.i(211733),uV=e.i(133783),uO=e.i(959407),uF=e.i(578166),uM=e.i(77164);function uL(e){return(0,B.useMemo)(function(){var t=function(n){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],i=[];return Object.entries(n).forEach(function(n){var a,o=(0,N._)(n,2),s=o[0],l=o[1],u=(0,en._)(r).concat([s]);if(l.children){var c,d=t(l.children,u);i.push({match:aS.matchLabel,data:{type:"context",label:l.label,icon:null!=(c=l.icon)?c:(0,m.jsx)(m.Fragment,{})},commands:function(){return d}})}else l.component&&i.push({match:aS.matchLabel,data:{type:"action",label:l.label,icon:null!=(a=l.icon)?a:(0,m.jsx)(m.Fragment,{}),run:function(){return e(u)}}})}),i},n=t(uM.developerTabs);return{data:{type:"context",label:"Developer",icon:(0,m.jsx)(sX.default,{})},commands:function(e){return e.active||""!==e.searchQuery?n:[]}}},[e])}var uG=e.i(729122),uU=e.i(589721),uN=e.i(267103);function uB(){var e=(0,y._)(["\n  query ConfiguredTools($replId: String!) {\n    getRepl(id: $replId) {\n      ... on Repl {\n        id\n        hasAuthUsers\n        defaultBucket {\n          ... on Bucket {\n            id\n          }\n        }\n      }\n    }\n  }\n"]);return uB=function(){return e},e}var uW={},uz=(0,w.gql)(uB()),uH=e.i(424746),uq=e.i(630818),uK=e.i(882027);function u$(e){var t,n,r,i,a,o,s,l,u,c,d,p,f,h,g,v,y,w,j,_=e.openPane,S=e.currentPaneId,I=(0,a9.default)().fs,C=(0,aC.usePaneUIContext)(),k=(0,B.useCallback)(function(e){var t=e.path,n=(0,ti.getPaneTypeForFile)({path:t});(0,es.track)(el.events.TOOL_OPENED,{source:"New Tab",tool:n}),_({pane:{type:n,data:{path:t}}})},[_]),E=rr(i1),T=ri(t_),P=(0,B.useCallback)(function(e){if((0,es.track)(el.events.TOOL_OPENED,{source:"New Tab",tool:e.type}),S&&(0,ti.isSingleton)(e.type)){var t=T().find(function(t){var n=(0,N._)(t,2);return n[0],n[1].type===e.type});if(t)return E({from:t[0],to:S})}_({pane:e})},[_,T,S,E]),R=uL((0,B.useCallback)(function(e){P({type:"developer",data:{tab:e}})},[P])),A=(0,lg.useShouldHideFileInWorkspace)(),D=(0,ny.useGetRecentFiles)(),V=uX(S),O=(v=(t=(0,aJ.default)(),a=(i=(null==(r=(null==(n=(0,uU.useNewPanePrimaryOutputQuery)({variables:{replId:t}}).data)?void 0:n.getRepl.__typename)==="Repl"?n.getRepl:null)?void 0:r.config)||{}).isServer,o=i.isAgentStack,s=i.isExpertMode,(0,B.useMemo)(function(){return o?[{type:"automations"}]:s?(0,en._)(a?[{type:"webview"}]:[]).concat([{type:"runnerOutput"}]):[{type:"webview"}]},[a,o,s])),y=(p=(null==(d=(u={variables:{replId:(0,aJ.default)()}},c=(0,x._)({},uW,u),b.useQuery(uz,c)).data)?void 0:d.getRepl.__typename)==="Repl"?d.getRepl:null,f=void 0!==(0,uH.useNeonDevelopmentDatabase)().database,h=!!(null==p?void 0:p.hasAuthUsers),g=(null==p||null==(l=p.defaultBucket)?void 0:l.__typename)==="Bucket",(0,B.useMemo)(function(){var e=[];return h&&e.push({type:"replitAuth"}),f&&e.push({type:"neon"}),g&&e.push({type:"objectStorage"}),e},[f,h,g])),w=(0,aR.useToolPanes)(),j=rt(t_),(0,B.useMemo)(function(){var e=new Map,t=new Set,n=[],r=function(r,i){if((0,ti.isExtensionPane)(i))return void n.push(i);if(!t.has(i.type)){t.add(i.type);var a=e.get(r);a?a.push(i):e.set(r,[i])}},i=!0,a=!1,o=void 0;try{for(var s,l=v[Symbol.iterator]();!(i=(s=l.next()).done);i=!0){var u=s.value;r("output",u)}}catch(e){a=!0,o=e}finally{try{i||null==l.return||l.return()}finally{if(a)throw o}}var c=!0,d=!1,p=void 0;try{for(var f,h=y[Symbol.iterator]();!(c=(f=h.next()).done);c=!0){var g=f.value;r("configured",g)}}catch(e){d=!0,p=e}finally{try{c||null==h.return||h.return()}finally{if(d)throw p}}var m=!0,x=!1,b=void 0;try{for(var _,S=uQ[Symbol.iterator]();!(m=(_=S.next()).done);m=!0){var I=_.value;r("suggested",I)}}catch(e){x=!0,b=e}finally{try{m||null==S.return||S.return()}finally{if(x)throw b}}var C=!0,k=!1,E=void 0;try{for(var T,P=w[Symbol.iterator]();!(C=(T=P.next()).done);C=!0){var R=T.value;r("rest",R)}}catch(e){k=!0,E=e}finally{try{C||null==P.return||P.return()}finally{if(k)throw E}}var A=[],D=!0,V=!1,O=void 0;try{for(var F,M=e.values()[Symbol.iterator]();!(D=(F=M.next()).done);D=!0){var L=F.value,G=!0,U=!1,B=void 0;try{for(var W,z=L[Symbol.iterator]();!(G=(W=z.next()).done);G=!0)!function(){var e=W.value,t=!(0,ti.isSingleton)(e.type)&&!(0,ti.isFilePane)(e)&&j.find(function(t){var n=(0,N._)(t,2);return(n[0],n[1]).type===e.type});t&&A.push(t)}()}catch(e){U=!0,B=e}finally{try{G||null==z.return||z.return()}finally{if(U)throw B}}}}catch(e){V=!0,O=e}finally{try{D||null==M.return||M.return()}finally{if(V)throw O}}return{groupedPanes:e,existingNonSingletonTools:A,extensions:n}},[v,y,w,j])),F=O.groupedPanes,M=O.existingNonSingletonTools,L=O.extensions;return(0,B.useMemo)(function(){var e,t,n,r=(0,lh.createFindOrCreateFileCommand)({openFile:k,fs:I,shouldHideFile:A,getRecentFiles:D}),i=(t=(e={fs:I,openFile:k}).openFile,n=e.fs,{match:aS.fzfMatchLabel,data:{type:"context",label:"New file",description:"Create a new file",icon:(0,m.jsx)(sI.default,{})},commands:function(e){var r=e.searchQuery,i=e.active;return r&&i?[{match:aS.matchLabel,data:{type:"action",description:"Create a new file",label:r,icon:(0,m.jsx)(uq.default,{path:r}),run:function(){return(0,er._)(function(){return(0,ei._)(this,function(e){switch(e.label){case 0:return[4,n.stat(r)];case 1:if(e.sent().exists)return[2,{type:"error",message:'"'.concat(r,'" already exists')}];return[4,n.writeFile(r,sd.default.from(""))];case 2:if(e.sent().error)return[2,{type:"error",message:'Could not create "'+r+'"'}];return t({path:r}),[2]}})})()}}}]:[]}}),a=[];V&&a.push(V);var o=function(e,t){if(t.panes&&0!==t.panes.length){var n=[],r=!0,i=!1,o=void 0;try{for(var s,l=t.panes[Symbol.iterator]();!(r=(s=l.next()).done);r=!0)!function(){var e=s.value;M.some(function(t){var n=(0,N._)(t,2);return(n[0],n[1]).type===e.type})||n.push(uY(e,P,C,t.large))}()}catch(e){i=!0,o=e}finally{try{r||null==l.return||l.return()}finally{if(i)throw o}}a.push({data:"context"===e.type?(0,rX._)((0,x._)({},e),{icon:(0,m.jsx)(m.Fragment,{})}):e,commands:function(){return n}})}};return o({type:"context",label:"Your App"},{panes:F.get("output"),large:!0}),o({type:"group",key:"configured"},{panes:F.get("configured")}),M.length>0&&S&&a.push({data:{label:"Jump to existing tab",type:"context",icon:(0,m.jsx)(m.Fragment,{})},commands:function(){return M.map(function(e){var t=(0,N._)(e,2),n=t[0];return uY(t[1],function(){E({from:n,to:S})},C)})}}),o({type:"context",label:"Suggested"},{panes:F.get("suggested")}),o({type:"group",key:"Other tools"},{panes:F.get("rest")}),a.push({data:{type:"context",label:"Extensions",icon:(0,m.jsx)(m.Fragment,{})},commands:function(){return L.map(function(e){return uY(e,P,C)})}}),M.length>0&&a.push({data:{key:"existing-non-singleton-tools",type:"group"},commands:function(){return M.map(function(e){var t=(0,N._)(e,2);return uY((t[0],t[1]),P,C)})}}),a.push(R),a.push({data:{type:"context",label:"Files",icon:(0,m.jsx)(m.Fragment,{})},commands:function(){return[r,i]}}),{data:{type:"group",key:"root",description:"Search for tools & files"},commands:function(){return a}}},[I,D,A,k,R,F,L,M,S,E,P,C,V])}var uQ=[{type:"deployments"},{type:"integrations"},{type:"neon"},{type:"objectStorage"},{type:"replitAuth"},{type:"securityScan"},{type:"envEditor"}];function uY(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=r?24:void 0,a=n.getTitle(e),o=n.Icon({pane:e,size:i});return{match:(0,aT.matchToolPane)({pane:e,aliases:aP.paneAliases.get(e.type),iconSize:i}),data:{key:"extension"===e.type?"extension-".concat(e.data.installationId,"-").concat(e.data.path):void 0,type:"action",label:a,icon:o,run:function(){return t(e)}}}}function uX(e){var t=rr(np),n=aj(),r=(0,uN.useObservable)(n.isCollapsed),i=n.toggle;return(0,B.useMemo)(function(){return r?{match:aS.matchLabel,data:{type:"action",label:"Open Agent",icon:(0,m.jsx)(uK.default,{}),run:function(){e&&t(e),i(!0)}}}:null},[r,i,t,e])}var uJ=e.i(169252),uZ={nextTab:{id:"tabs.next",name:"Switch to next tab",default:(0,P._)({},uJ.KeybindingsEnvironmentEnum.DesktopApp,(0,aG.defaultKeyCombo)({cmdOrCtrl:!0,shift:!0,key:"]"}))},previousTab:{id:"tabs.previous",name:"Switch to previous tab",default:(0,P._)({},uJ.KeybindingsEnvironmentEnum.DesktopApp,(0,aG.defaultKeyCombo)({cmdOrCtrl:!0,shift:!0,key:"["}))},newTab:{id:"tabs.new",name:"New tab",description:"Opens a tab in the current active group",default:(0,P._)({},uJ.KeybindingsEnvironmentEnum.DesktopApp,(0,aG.defaultKeyCombo)({cmdOrCtrl:!0,key:"t"}))},closeTab:{id:"tabs.close",name:"Close tab",description:"Close the current active tab",default:(0,P._)({},uJ.KeybindingsEnvironmentEnum.DesktopApp,(0,aG.defaultKeyCombo)({cmdOrCtrl:!0,key:"w"}))},reopenClosedTab:{id:"tabs.reopenClosed",name:"Reopen closed tab",default:(0,P._)({},uJ.KeybindingsEnvironmentEnum.DesktopApp,(0,aG.defaultKeyCombo)({cmdOrCtrl:!0,shift:!0,key:"t"}))},findFile:{id:"files.find",name:"Find file",default:(0,aG.defaultKeyCombo)({cmdOrCtrl:!0,key:"p"})},searchFileContents:{id:"files.searchContents",name:"Search file contents",default:uF.keyboardShortcut},run:{id:"repl.run",name:"Run Repl",default:(0,aG.defaultKeyCombo)({cmdOrCtrl:!0,key:"Enter"})},toggleInviteDialog:{id:"repl.multiplayers",name:"See multiplayers",default:(0,aG.defaultKeyCombo)({cmdOrCtrl:!0,key:"m"})},showShell:{id:"repl.showShell",name:"Show shell",default:(0,aG.defaultKeyCombo)({ctrl:!0,key:"`"}),description:"Opens or reveals a Shell in a tab"},showConsole:{id:"repl.showConsole",name:"Show console",description:"Opens or reveals the Console in a tab",default:void 0},showReplitAi:{id:"repl.showGhostwriter",name:"Show Replit AI",description:"Opens or reveals Replit AI in a tab",default:void 0},showSettings:{id:"repl.showSettings",name:"Show settings",description:"Opens or reveals the Settings tab",default:(0,P._)({},uJ.KeybindingsEnvironmentEnum.DesktopApp,(0,aG.defaultKeyCombo)({cmdOrCtrl:!0,key:","}))},saveAllFiles:{id:"repl.saveAllFiles",name:"Save all files",description:"Forces all changes to be flushed to disk",default:void 0},showGit:{id:"repl.showGit",name:"Show git",description:"Opens or reveals the Git tool in a tab",default:void 0},toggleFloatPaneGroup:{id:"paneGroup.toggleFloat",name:"Toggle float group",description:"Floats or un-floats the current active group",default:void 0},toggleMaximizePaneGroup:{id:"paneGroup.toggleMaximize",name:"Toggle maximize group",description:"Maximizes or restores the current active group",default:void 0},removePaneGroup:{id:"paneGroup.close",name:"Close group",description:"Closes all tabs in the current active group",default:void 0},removeOthersInPaneGroup:{id:"paneGroup.closeOthers",name:"Close other tabs in group",description:"Closes all tabs except the visible one in the current active group",default:void 0},insertPaneGroupUp:{id:"paneGroup.insertUp",name:"Insert group above",description:"Adds a new group above the current active group",default:void 0},insertPaneGroupRight:{id:"paneGroup.insertRight",name:"Insert group right",description:"Adds a new group to the right of the current active group",default:void 0},insertPaneGroupLeft:{id:"paneGroup.insertLeft",name:"Insert group left",description:"Adds a new group to the left of the current active group",default:void 0},insertPaneGroupDown:{id:"paneGroup.insertDown",name:"Insert group below",description:"Adds a new group below the current active group",default:void 0},moveTabUpGroup:{id:"tabs.move.groupUp",name:"Move tab into group above",description:"Moves the current active tab into the group above",default:void 0},moveTabRightGroup:{id:"tabs.move.groupRight",name:"Move tab into group right",description:"Moves the current active tab into the group to the right",default:void 0},moveTabLeftGroup:{id:"tabs.move.groupLeft",name:"Move tab into group left",description:"Moves the current active tab into the group to the left",default:void 0},moveTabDownGroup:{id:"tabs.move.groupDown",name:"Move tab into group below",description:"Moves the current active tab into the group below",default:void 0},moveFocusUp:{id:"paneGroup.focusUp",name:"Move focus to group above",description:"Move focus to the group above the current active group",default:void 0},moveFocusRight:{id:"paneGroup.focusRight",name:"Move focus to group right",description:"Move focus to the group to the right of the current active group",default:void 0},moveFocusLeft:{id:"paneGroup.focusLeft",name:"Move focus to group left",description:"Move focus to the group to the left of the current active group",default:void 0},moveFocusDown:{id:"paneGroup.focusDown",name:"Move focus to group below",description:"Move focus to the group below the current active group",default:void 0},webviewRefresh:{id:"webviewpane.reload",name:"Refresh preview",description:"Reload the preview pane",default:(0,aG.defaultKeyCombo)({alt:!0,key:"r"})},keepTab:{id:"tab.keep",name:"Keep tab",description:"Converts a preview tab to a persisted tab",default:void 0}},u0=e.i(464092),u1=e.i(51606),u2=e.i(243914),u4=e.i(115357),u8=e.i(428070),u3=e.i(559073),u6=e.i(121817),u5=e.i(592877),u9=e.i(566818),u7=e.i(170314),ce=Object.values(uZ);let ct=(0,B.memo)(function(e){var t,n,r,i,a,o,s,l,u,c,d,p,f,h,g,v,x,y,w,b,j=e.isAdmin,_=e.isSubscribed,S=aL(),I=(0,ny.useGetRecentFiles)(),C=(0,a9.default)(),k=C.fs,E=C.container,T=(0,u0.useForkContext)(),R=T.fork,A=T.isForking,D=(0,uG.useRunInfo)(),V=D.isOffline,O=D.isWorkflowsLoading,F=D.isRunning,M=(0,uG.useOnToggleRun)(),L=(0,lg.useShouldHideFileInWorkspace)(),G=am(),U=rr(nJ),W=rr(nZ),z=rr(nK),H=rr((t=(0,ny.usePopClosedPane)(),(0,X.default)(function(){return(0,ea.atom)(null,function(e,n){var r=t();if(r){n(nX,[r.pane]);var i=e(ta);i&&n(ts,i)}})},[t]))),q=rr(iM),K=rr(n0),$=rr(ts),Q=rt(ta),ee=rt((0,X.default)(function(){return(0,ea.atom)(function(e){var t=e(ta);if(!t)return null;var n=eF(e(tm),t);return n?n.paneGroup.id:null})},[])),et=rr(iB),eo=av().toggleMaximizePane,eu=rr(ng),ec=rr(nf),ed=rr(iF),ep=rr(nm),ef=(0,ak.usePaneBindings)(Q),eh=(0,Z.useQueryParam)("replUrl","string"),eg=(0,aJ.default)(),em=(0,Y.default)(),ev=ri(tS),ex=ah(),ey=(0,a3.default)(),ew=(0,uV.default)(),eb=(0,a5.default)(E).url,ej=(0,a4.default)().showNotice,e_=j||!1,eS=(0,Z.useQueryParam)("debug","boolean"),eI=(0,uO.default)("vscode"),eC=eI.openEditor,ek=eI.onConfirmConfig,eE=eI.isConfigModalOpen,eT=eI.closeConfigModal,eP=(0,lZ.default)(function(e){return(0,es.track)(el.events.PROJECT_RAN,{replId:eg,placement:e})},500);(0,aD.useCommandBinding)(function(){return[uZ.saveAllFiles.id,function(){k.flush(void 0,nG.FlushSource.MANUAL_SAVE)}]},[k]),(0,aD.useCommandBinding)(function(){return[uZ.newTab.id,function(){return U()}]},[U]),(0,aD.useCommandBinding)(function(){return[uZ.nextTab.id,function(){return K("next")}]},[K]),(0,aD.useCommandBinding)(function(){return[uZ.previousTab.id,function(){return K("previous")}]},[K]),(0,aD.useCommandBinding)(function(){return[uZ.closeTab.id,function(){var e=W();return e||ev()>0}]},[W,ev]),(0,aD.useCommandBinding)(function(){return[uZ.reopenClosedTab.id,function(){return H()}]},[H]),(0,aD.useCommandBinding)(function(){return[uZ.moveTabUpGroup.id,function(){return z("above")}]},[z]),(0,aD.useCommandBinding)(function(){return[uZ.moveTabRightGroup.id,function(){return z("rightOf")}]},[z]),(0,aD.useCommandBinding)(function(){return[uZ.moveTabLeftGroup.id,function(){return z("leftOf")}]},[z]),(0,aD.useCommandBinding)(function(){return[uZ.moveTabDownGroup.id,function(){return z("below")}]},[z]),(0,aD.useCommandBinding)(function(){return Q?[uZ.keepTab.id,function(){return $(Q)}]:void 0},[Q,$]),(0,aD.useCommandBinding)(function(){return Q?[uZ.insertPaneGroupUp.id,function(){return ep({paneId:Q,placement:"above",autoFocus:!0})}]:void 0},[Q]),(0,aD.useCommandBinding)(function(){return Q?[uZ.insertPaneGroupRight.id,function(){return ep({paneId:Q,placement:"rightOf",autoFocus:!0})}]:void 0},[Q]),(0,aD.useCommandBinding)(function(){return Q?[uZ.insertPaneGroupLeft.id,function(){return ep({paneId:Q,placement:"leftOf",autoFocus:!0})}]:void 0},[Q]),(0,aD.useCommandBinding)(function(){return Q?[uZ.insertPaneGroupDown.id,function(){return ep({paneId:Q,placement:"below",autoFocus:!0})}]:void 0},[Q]),(0,aD.useCommandBinding)(function(){return[aB.id,function(){return S()}]},[S]);var eR=uy(),eA=(0,J.useIsInMobileWorkspace)();(0,aD.useCommandBinding)(function(){return[uj.id,function(){if(function(){var e=document.activeElement;if(!e)return!1;var t=e.tagName.toLowerCase();return"textarea"===t||("input"===t?["text","password","email","search","tel","url","number","date","datetime-local","month","time","week"].includes(e.type.toLowerCase()):!!e.isContentEditable||"true"===e.getAttribute("contenteditable"))}()||eA)return!1;eR()}]},[eR]);var eD=(0,aD.useKeyCombo)(uZ.findFile.id);(0,aD.useCommandBinding)(function(){return[uZ.findFile.id,function(){return S(lh.createFindOrCreateFileCommand({openFile:G,fs:k,shouldHideFile:L,getRecentFiles:I,keyboardShortcut:eD}))}]},[S]);var eV=aE({type:"files"});aW(lh.createFindOrCreateFileCommand({openFile:G,fs:k,shouldHideFile:L,getRecentFiles:I,getCurrentlyOpenFilePanesCommands:eV,keyboardShortcut:eD}));var eO=(0,aD.useKeyCombo)(uZ.searchFileContents.id),eM=ah(),eL=(0,B.useCallback)(function(e){(0,ti.isFilePane)(e.pane)||(0,es.track)(el.events.TOOL_OPENED,{source:"Command Bar",tool:e.pane.type}),eM(e)},[eM]);(0,aD.useCommandBinding)(function(){return[uZ.searchFileContents.id,function(){(0,es.track)(el.events.SEARCH_PANE_USED,{action:"opened_via_shortcut"});var e,t=void 0;(null==ef?void 0:ef.type)==="codeEditor"&&(t=null==(e=ef.getCurrentSelectionText)?void 0:e.call(ef)),eL({pane:{type:"searchReplace",data:{initialQuery:t}}})}]},[ef,eL]),(0,aD.useCommandBinding)(function(){return Q?[uZ.toggleFloatPaneGroup.id,function(){return et(Q)}]:void 0},[Q]),(0,aD.useCommandBinding)(function(){return Q?[uZ.toggleMaximizePaneGroup.id,function(){return eo(Q)}]:void 0},[Q]),(0,aD.useCommandBinding)(function(){return ee?[uZ.removePaneGroup.id,function(){eu({paneGroupId:ee}),ed()}]:void 0},[ee]),(0,aD.useCommandBinding)(function(){return Q?[uZ.removeOthersInPaneGroup.id,function(){ec(Q)}]:void 0},[Q]),(0,aD.useCommandBinding)(function(){return[uZ.moveFocusUp.id,function(){return q("above")}]},[]),(0,aD.useCommandBinding)(function(){return[uZ.moveFocusDown.id,function(){return q("below")}]},[]),(0,aD.useCommandBinding)(function(){return[uZ.moveFocusRight.id,function(){return q("rightOf")}]},[]),(0,aD.useCommandBinding)(function(){return[uZ.moveFocusLeft.id,function(){return q("leftOf")}]},[]),aW((n=(0,aC.usePaneUIContext)(),(0,X.default)(function(){return{data:{type:"context",label:"Open with Code Search",icon:(0,m.jsx)(lm.default,{}),key:"codeSearch"},commands:function(e){var t=e.searchQuery;if(!t)return[];var r={type:"searchReplace",data:{initialQuery:t}};return[{match:(0,aS.createFzfMatchLabel)({defaultScore:ut.commandDefaultScores.codeSearch,matchScoreMultiplier:ut.commandMatchScoreMultipliers.codeSearch,filterLowMatchScores:!1}),data:{type:"action",label:n.getTitle(r),icon:n.Icon({pane:r}),run:function(){ex({pane:r})}}}]}}},[n,ex]))),aW(uX()),aW(uF.createSearchFileContentsCommand({container:E,activeOnly:!0,keyboardShortcut:eO,openFile:G})),(0,aD.useCommandBinding)(function(){if(!V&&!O)return[uZ.run.id,function(){M(uA.RunReason.KEYBOARD_SHORTCUT),eP("shortcut_cmd_enter")}]},[M]);var eG=(0,aD.useKeyCombo)(uZ.run.id);aW({match:aS.fzfMatchLabel,data:{type:"action",icon:(0,m.jsx)(u8.default,{}),label:"New window",keyboardShortcut:"Cmd-Shift-n",description:"Open a new window",run:function(){l0.desktopAppApi.openNewWindow()}}},{enabled:em}),aW({match:aS.fzfMatchLabel,data:{type:"action",icon:(0,m.jsx)(u3.default,{}),label:"Run",description:"Run Repl",run:function(){M(uA.RunReason.KEYBOARD_SHORTCUT)},keyboardShortcut:eG}},{enabled:!F}),aW({match:aS.fzfMatchLabel,data:{type:"action",icon:(0,m.jsx)(u9.default,{}),label:"Stop",description:"Stop Repl",run:function(){M(uA.RunReason.KEYBOARD_SHORTCUT)}}},{enabled:F}),aW({match:aS.fzfMatchLabel,data:{type:"action",icon:(0,m.jsx)(u6.default,{}),label:"Kill 1",description:"Kill the Repl pid1 process if it's in a bad state (admin only)",run:function(){E.exec("kill","1")}}},{enabled:e_}),aW({match:aS.fzfMatchLabel,data:{type:"action",icon:(0,m.jsx)(u2.default,{}),label:"Open development URL",run:function(){if(!eb)throw Error("Expected dotdevUrl");window.open(eb,"_blank","noopener")}}}),aW({match:aS.fzfMatchLabel,data:{type:"action",icon:(0,m.jsx)(u4.default,{}),label:"Open in desktop app",description:"Open this Repl in the desktop app",run:function(){if(!eh)throw Error("Expected Repl URL query param");var e="".concat(window.location.origin,"/desktopApp/open?replUrl=").concat(eh);window.open(e,"_blank")}}},{enabled:!em}),aW({match:aS.fzfMatchLabel,data:{type:"action",icon:(0,m.jsx)(u7.default,{}),label:"Open in VS Code",description:"Connect to this Repl in VS Code via SSH",run:function(){(0,es.track)(el.events.WORKSPACE,{action:"open_in_vscode_clicked",source:"command_bar",editor:"vscode"}),eC()}}},{enabled:!!ey&&_}),aW({match:aS.fzfMatchLabel,data:{type:"action",icon:(0,m.jsx)(u1.default,{}),label:"Copy SSH Command",description:"Copy a shell command to connect to this Repl via SSH",run:function(){if(!ey)throw Error("Expected sshConfig");var e=ey.sshPort,t=ey.sshUser,n=ey.sshHostname,r="ssh -i ".concat(ew,"/.ssh/replit -p ").concat(e," ").concat(t,"@").concat(n);(0,es.track)(el.events.WORKSPACE,{action:"ssh_key_copied",source:"command_bar"}),(0,l1.default)(r),ej("Copied SSH command")}}},{enabled:!!ey&&_}),aW((i=(r={description:"Jump to another Repl",onRun:function(e){window.location.href=e.url}}).description,a=r.onRun,o=(0,i2.default)(a),(0,X.default)(function(){return{match:(0,aS.createFzfMatchLabel)({defaultScore:ut.commandDefaultScores.myRepls}),data:{type:"context",label:"My Apps",icon:(0,m.jsx)(up.default,{}),description:i},commands:function(e){return(0,er._)(function(e){var t;return(0,ei._)(this,function(n){switch(n.label){case 0:var r;if(t=e.searchQuery,!e.active)return[2,[]];return[4,(r={query:t,count:50},(0,er._)(function(){var e;return(0,ei._)(this,function(t){switch(t.label){case 0:if(!tY.apolloClient)throw Error("Expected apolloClient");return[4,tY.apolloClient.query({query:us,variables:r})];case 1:return[2,(null==(e=t.sent().data.currentUser)?void 0:e.search.repls.filter(function(e){return!!e.owner}))||[]]}})})())];case 1:return[2,n.sent().map(function(e){var n,r,i,a;return r=(n={repl:e,searchQuery:t,run:function(){return o.current(e)}}).repl,i=n.searchQuery,a=n.run,{match:function(){return{score:1,render:{height:44,content:(0,m.jsx)(uh,{repl:r,height:44,searchQuery:i})}}},data:{type:"action",label:r.title,icon:(0,m.jsx)(uc.default,{alt:r.title,size:16,iconUrl:r.iconUrl}),run:function(){return a(r)}}}})]}})}).apply(this,arguments)}}},[i,o]))),aW({match:(0,aS.createFzfMatchLabel)({defaultScore:ut.commandDefaultScores.fork}),data:{type:"action",label:"Remix",icon:(0,m.jsx)(u5.default,{}),description:"Remix App",run:function(){A||R()}}}),l=(s=lb.usePreferences.apply(void 0,(0,en._)(uR))).preferences,u=s.update,c=function(e){Object.keys(e).forEach(function(t){var n=e[t];(0,es.track)(el.events.SETTINGS_TOGGLED,{settingChanged:t,updatedValue:n,isCommandBar:!0})}),u(e)},p=(d=(0,sy.useTheme)()).setActiveTheme,f=d.theme,aW({match:(0,aS.createFzfMatchLabel)({defaultScore:ut.commandDefaultScores.settings,matchScoreMultiplier:ut.commandMatchScoreMultipliers.settings}),data:{type:"context",label:"Settings",description:"Change Replit Settings",icon:(0,m.jsx)(uP.default,{})},commands:function(e){var t=e.active,n=e.searchQuery;if(!t&&!n)return[];var r={match:(0,aS.createFzfMatchLabel)({defaultScore:ut.commandDefaultScores.settings,matchScoreMultiplier:ut.commandMatchScoreMultipliers.settings}),data:{type:"context",label:"Theme",icon:(0,m.jsx)(uT.default,{}),description:"Change Replit Theme"},commands:function(){return uk.officialThemes.map(function(e){return{match:(0,aS.createFzfMatchLabel)({defaultScore:ut.commandDefaultScores.settings,matchScoreMultiplier:ut.commandMatchScoreMultipliers.settings}),data:{type:"action",label:e.title,icon:f.id===e.id?(0,m.jsx)(uE.default,{}):(0,m.jsx)(uP.default,{opacity:0}),description:"Use "+e.title+" theme "+(f.id===e.id?" (current)":""),run:function(){p(e.id)}}}})}},i=Object.values(uC.userPreferences).filter(function(e){return -1!==uR.indexOf(e.editorPreferencesKey)}).map(function(e){return{match:(0,aS.createFzfMatchLabel)({defaultScore:ut.commandDefaultScores.settings,matchScoreMultiplier:ut.commandMatchScoreMultipliers.settings}),data:{type:"context",label:e.name,icon:(0,m.jsx)(uP.default,{}),description:e.description},commands:function(){return e.options.map(function(t){var n=l[e.editorPreferencesKey],r=!!e.editorPreferencesKey&&t.editorPreferencesValue===n;return{match:(0,aS.createFzfMatchLabel)({defaultScore:ut.commandDefaultScores.settings,matchScoreMultiplier:ut.commandMatchScoreMultipliers.settings}),data:{type:"action",label:t.title,icon:r?(0,m.jsx)(uE.default,{}):(0,m.jsx)(uP.default,{opacity:0}),description:t.description,run:function(){return(0,er._)(function(){return(0,ei._)(this,function(n){switch(n.label){case 0:if(!e.editorPreferencesKey)throw Error("editorPreferencesKey is not defined");return[4,c((0,P._)({},e.editorPreferencesKey,t.editorPreferencesValue))];case 1:return n.sent(),[2]}})})()}}}})}}});return(0,en._)(i).concat([r])}},{enabled:!0}),aW(uL((0,B.useCallback)(function(e){eL({pane:{type:"developer",data:{tab:e}}})},[eL])));var eU=(h=(0,aJ.default)(),g=(0,l2.useGlobalModal)().show,(0,B.useMemo)(function(){var e=[];return e.push({match:aS.matchLabel,data:{type:"action",label:"[Admin] Show Slack Agent Stack Connector Modal [DEPRECATED]",icon:(0,m.jsx)(l8.default,{}),run:function(){g("SlackConnectorSetupModalDeprecated",{replId:h})}}}),{match:aS.matchLabel,data:{icon:(0,m.jsx)(l4.default,{}),label:"Admin",type:"context",description:"Manage internal only settings"},commands:function(){return e},numCommands:e.length}},[g,h]));aW(eU,{enabled:e_&&eU.numCommands>0});var eN=(v=(0,l3.useUploadPid2)(),x=(0,N._)((0,l3.usePid2UploadState)(),1)[0],y=(0,a4.default)().showNotice,w=(0,l6.usePid2Callback)(function(e){return function(){return(0,er._)(function(){var t;return(0,ei._)(this,function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,e.healthCheck.ping.rpc({})];case 1:if((t=n.sent()).ok)return[2,{ok:!0,payload:t.payload}];return[2,{ok:!1}];case 2:return n.sent(),[2,{ok:!1}];case 3:return[2]}})})()}}),b=(0,l6.usePid2Callback)(function(e){return function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:5,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e3;return(0,er._)(function(){var r,i,a;return(0,ei._)(this,function(o){switch(o.label){case 0:r=0,o.label=1;case 1:if(!(r<t))return[3,8];i=l7[r%l7.length],y("".concat(i," Pinging PID2... (attempt ").concat(r+1,"/").concat(t,")")),o.label=2;case 2:return o.trys.push([2,4,,5]),[4,e.healthCheck.ping.rpc({})];case 3:if((a=o.sent()).ok)return y(" PID2 is ready! ".concat(JSON.stringify(a.payload))),[2,!0];return[3,5];case 4:return o.sent(),[3,5];case 5:if(!(r<t-1))return[3,7];return[4,ue(n)];case 6:o.sent(),o.label=7;case 7:return r++,[3,1];case 8:return y(" PID2 not responding after ".concat(t," attempts")),[2,!1]}})})()}}),(0,B.useMemo)(function(){var e=[];return e.push({match:aS.matchLabel,data:{type:"action",icon:(0,m.jsx)(l5.default,{}),label:"Ping PID2",description:"Check if PID2 is healthy and responding",run:function(){return(0,er._)(function(){var e;return(0,ei._)(this,function(t){switch(t.label){case 0:if(!w)return y("PID2 client not available"),[2];return[4,w()];case 1:return(null==(e=t.sent())?void 0:e.ok)?y(" PID2 is healthy: ".concat(JSON.stringify(e.payload))):y(" PID2 ping failed"),[2]}})})()}}}),e.push({match:aS.matchLabel,data:{type:"action",icon:(0,m.jsx)(l9.default,{}),label:x===l3.Pid2UploadState.IDLE?"Upload PID2 bundle":"Upload PID2 bundle (".concat(x.toLowerCase(),")"),description:x===l3.Pid2UploadState.IDLE?"Upload and install the latest PID2 bundle to the container":"Current status: ".concat(x.toLowerCase()),run:function(){return(0,er._)(function(){return(0,ei._)(this,function(e){switch(e.label){case 0:if(x!==l3.Pid2UploadState.IDLE&&x!==l3.Pid2UploadState.ERROR)return[3,5];return[4,v()];case 1:return e.sent(),[4,ue(2e3)];case 2:if(e.sent(),!b)return[3,4];return[4,b(5,1e3)];case 3:e.sent(),e.label=4;case 4:return[3,6];case 5:y("PID2 upload already in progress: ".concat(x)),e.label=6;case 6:return[2]}})})()}}}),{match:aS.matchLabel,data:{icon:(0,m.jsx)(l4.default,{}),label:"PID2",type:"context",description:"PID2 debug commands"},commands:function(){return e},numCommands:e.length}},[v,x,y,w,b]));return aW(eN,{enabled:(e_||eS)&&eN.numCommands>0}),(0,m.jsx)(m.Fragment,{children:(0,m.jsx)(aU.Modal,{isOpen:eE,onRequestClose:eT,centered:!0,children:(0,m.jsx)(uD.default,{onConfirm:ek})})})});var cn=e.i(921211),cr=e.i(672963),ci=e.i(337761),ca=e.i(967629),co=e.i(496019),cs=e.i(352767),cl=e.i(608263),cu=(0,ca.keyframes)({"0%":{transform:"translate(0, 0)"},"8.33%, 25%":{transform:"translate(-50%, 0)"},"33.33%, 50%":{transform:"translate(-50%, -50%)"},"58.33%, 75%":{transform:"translate(0, -50%)"},"83.33%, 100%":{transform:"translate(0, 0)"}}),cc=(0,ro.cssRecord)({root:[i8.rcss.color.foregroundDimmest,i8.rcss.position.relative,i8.rcss.width("100%"),i8.rcss.height("100%"),{overflow:"hidden"}],arrows:[i8.rcss.position.absolute,i8.rcss.top(0),i8.rcss.left(0),i8.rcss.flex.row,i8.rcss.flex.wrap,i8.rcss.width("200%"),i8.rcss.height("200%"),{animationName:cu,animationDirection:"normal",animationTimingFunction:"ease-out",animationIterationCount:"infinite"}],arrow:[i8.rcss.width("50%"),i8.rcss.height("50%"),i8.rcss.center]});function cd(e){var t=e.delay,n=e.duration;return(0,m.jsx)(O.View,{css:cc.root,children:(0,m.jsxs)(O.View,{css:cc.arrows,style:{animationDelay:t?t+"ms":void 0,animationDuration:n?n+"ms":"8000ms"},children:[(0,m.jsx)(O.View,{css:cc.arrow,children:(0,m.jsx)(co.default,{size:12})}),(0,m.jsx)(O.View,{css:cc.arrow,children:(0,m.jsx)(cs.default,{size:12})}),(0,m.jsx)(O.View,{css:cc.arrow,children:(0,m.jsx)(uE.default,{size:12})}),(0,m.jsx)(O.View,{css:cc.arrow,children:(0,m.jsx)(cl.default,{size:12})})]})})}var cp=e.i(283110),cf=(0,ro.cssRecord)({root:[i8.rcss.position.relative],circle:[i8.rcss.top(-6),i8.rcss.right(-6),i8.rcss.minWidth(12),i8.rcss.borderRadius(8),i8.rcss.position.absolute,i8.rcss.backgroundColor.backgroundHighest,i8.rcss.shadow(3),{textAlign:"center",fontSize:10,border:"1px solid",borderColor:A.tokens.outlineDefault}],count:[{textAlign:"center",fontSize:10}]});function ch(e){var t=e.count,n=(0,ll._)(e,["count"]);return(0,m.jsxs)(O.View,{css:cf.root,children:[(0,m.jsx)(cp.default,(0,x._)({},n)),(0,m.jsx)(O.View,{css:[cf.circle,cf.count],children:t})]})}function cg(){return(0,m.jsxs)(O.View,{css:cf.root,children:[(0,m.jsx)(cp.default,{}),(0,m.jsx)(O.View,{css:cf.circle,children:(0,m.jsx)(uE.default,{size:6})})]})}function cm(e){var t,n=e.paneId,r=e.paneGroupId,i=(0,aC.usePaneUIContext)(),a=ad(n),o=rr(np),s=rr(nh),l=rr(nf),u=rt((0,X.default)(function(){return(0,ea.atom)(function(e){var t=eF(e(tm),n);return t?t.paneGroup.panes.findIndex(function(e){return e===n}):null})},[n])),c=rt((t=({paneGroupId:({paneGroupId:r}).paneGroupId}).paneGroupId,(0,X.default)(function(){return(0,ea.atom)(function(e){var n=eL(e(tm),t);return n?n.panes.length:null})},[t])));return(0,X.default)(function(){var e=i.getTitle(a),t=[{match:aS.matchLabel,data:{type:"action",label:"Close "+e,icon:(0,m.jsx)(cp.default,{}),run:function(){o(n)}}}];return c&&c>1&&(null!==u&&u<c-1&&t.push({match:aS.matchLabel,data:{type:"action",label:"Close to the right",icon:(0,m.jsx)(cg,{}),run:function(){s(n)}}}),t.push({match:aS.matchLabel,data:{type:"action",label:"Close all other tabs",icon:(0,m.jsx)(ch,{count:c-1}),run:function(){l(n)}}})),t},[i,a,c,u,o,n,s,l])}function cv(){var e=ap(),t=rr(ts);return(0,B.useCallback)(function(n){var r=e(n),i=r.isCommitted,a=r.pane;return!i&&(0,ti.isFilePane)(a)?{match:aS.matchLabel,data:{type:"action",label:"Keep open",icon:(0,m.jsx)(sP.default,{}),run:function(){return t(n)}}}:null},[e,t])}var cx=e.i(659666),cy=new Map([["left",{label:"Move Left",icon:(0,m.jsx)(cs.default,{})}],["right",{label:"Move Right",icon:(0,m.jsx)(uE.default,{})}],["up",{label:"Move Up",icon:(0,m.jsx)(cl.default,{})}],["down",{label:"Move Down",icon:(0,m.jsx)(co.default,{})}]]),cw=e.i(491404),cb=new Map([["leftOf",{label:"Move Left",icon:(0,m.jsx)(cs.default,{})}],["rightOf",{label:"Move Right",icon:(0,m.jsx)(uE.default,{})}],["above",{label:"Move Up",icon:(0,m.jsx)(cl.default,{})}],["below",{label:"Move Down",icon:(0,m.jsx)(co.default,{})}]]),cj=e.i(769767),c_=new Map([["leftOf",{commandId:uZ.insertPaneGroupUp.id,label:"Insert Left",icon:(0,m.jsx)(i5.default,{})}],["rightOf",{commandId:uZ.insertPaneGroupRight.id,label:"Insert Right",icon:(0,m.jsx)(i9.default,{})}],["above",{commandId:uZ.insertPaneGroupLeft.id,label:"Insert Up",icon:(0,m.jsx)(i7.default,{})}],["below",{commandId:uZ.insertPaneGroupDown.id,label:"Insert Down",icon:(0,m.jsx)(i6.default,{})}]]),cS=e.i(417095),cI=e.i(792774),cC=e.i(308212);function ck(e){var t,n,r,i,a,o,s,l,u,c,d,p,f,h,g,v,y,w,b,j,_,S,I,C,k,E,T,R,A,D,V,O,F,M,L,G,U=e.paneGroupId,B=e.paneId,W=function(e){var t,n,r=e.paneId,i=aw(e.paneGroupId),a=(0,lo.default)(i.isMaximized),o=(0,lo.default)(i.isFloating),s=!a&&!o,l=(t=(0,aD.useKeyBindings)(),n=rr(nm),(0,X.default)(function(){return(0,en._)(c_.entries()).map(function(e){var i,a,o=(0,N._)(e,2),s=o[0],l=o[1],u=l.commandId,c=l.label,d=l.icon;return{match:aS.matchLabel,data:{label:c,icon:d,type:"action",keyboardShortcut:null!=(a=null==(i=t.get(u))?void 0:i.shortcut)?a:void 0,run:function(){n({placement:s,paneId:r,autoFocus:!0}),(0,es.track)(el.events.WORKSPACE,{action:"split_used",placement:s})}}}})},[t,n,r]));return(0,X.default)(function(){return s?[{match:aS.matchLabel,data:{type:"context",label:"Add pane",icon:(0,m.jsx)(cj.default,{})},commands:function(e){var t=e.active,n=e.searchQuery;return t||n?l:[]}}]:[]},[s,l])}({paneId:B,paneGroupId:U}),z=(t=ay(B),n=rt(ne),r=(0,lo.default)(t.isFloating),i=!n&&!r,a=rr(nK),(0,X.default)(function(){var e=(0,en._)(cb.entries()).map(function(e){var t=(0,N._)(e,2),n=t[0],r=t[1],i=r.label,o=r.icon;return{match:aS.matchLabel,data:{label:i,icon:o,type:"action",run:function(){a(n)}}}});return i?[{match:aS.matchLabel,data:{type:"context",label:"Move tab",icon:(0,m.jsx)(cw.default,{})},commands:function(t){var n=t.active,r=t.searchQuery;return n||r?e:[]}}]:[]},[i,a])),H=(o=aw(U),s=(0,lo.default)(o.isMaximized),l=(0,lo.default)(o.isFloating),u=!s&&!l,c=rr(iL),(0,X.default)(function(){var e=(0,en._)(cy.entries()).map(function(e){var t=(0,N._)(e,2),n=t[0],r=t[1],i=r.label,a=r.icon;return{match:aS.matchLabel,data:{label:i,icon:a,type:"action",run:function(){c({direction:n})}}}});return u?[{match:aS.matchLabel,data:{type:"context",label:"Move group",icon:(0,m.jsx)(cx.default,{})},commands:function(t){var n=t.active,r=t.searchQuery;return n||r?e:[]}}]:[]},[u,c])),q=(p=(d=av()).maximizePaneGroup,f=d.restoreMaximizedPaneGroup,h=aw(U),g=(0,lo.default)(h.isMaximized),v=rt(t0),y=(0,aD.useKeyCombo)(uZ.toggleMaximizePaneGroup.id),(0,X.default)(function(){return g?v?[]:[{match:aS.matchLabel,data:{type:"action",label:"Restore",icon:(0,m.jsx)(cI.default,{}),run:function(){return f()},keyboardShortcut:y}}]:[{match:aS.matchLabel,data:{type:"action",label:"Maximize",icon:(0,m.jsx)(cS.default,{}),run:function(){return p({paneGroupId:U})},keyboardShortcut:y}}]},[g,y,v,f,p,U])),K=(w=rr(ng),b=rr(iF),j=rt(t0),_=(0,aD.useKeyCombo)(uZ.removePaneGroup.id),(0,X.default)(function(){return j?[]:[{match:aS.matchLabel,data:{type:"action",label:"Close",icon:(0,m.jsx)(cp.default,{}),run:function(){b(),w({paneGroupId:U})},keyboardShortcut:_}}]},[b,w,j,_,U])),$=(I=(S={paneId:B,paneGroupId:U}).paneId,C=S.paneGroupId,k=rr(iB),E=aw(C),T=(0,lo.default)(E.isMaximized),R=(0,lo.default)(E.isFloating),A=(0,aD.useKeyCombo)(uZ.toggleFloatPaneGroup.id),(0,X.default)(function(){return T?[]:[{match:aS.matchLabel,data:{type:"action",label:R?"Unfloat":"Float",icon:R?(0,m.jsx)(i3.default,{}):(0,m.jsx)(u8.default,{}),keyboardShortcut:A,run:function(){k(I)}}}]},[I,k,A,R,T])),Q=(V=aw((D={paneId:B,paneGroupId:U}).paneGroupId),O=ay(D.paneId),F=ax(D.paneGroupId),M=ri(t_),L=rr(tZ),G=(0,lo.default)(V.isMaximized),(0,X.default)(function(){return G?[]:[{match:aS.matchLabel,data:{type:"action",label:"New window",icon:(0,m.jsx)(cC.default,{}),run:function(){var e=(0,tQ.v4)(),t=M().filter(function(e){var t=(0,N._)(e,1)[0];return F.panes.current.includes(t)});L({popupId:e,state:{type:"saved",layout:{floating:[],tiling:{id:(0,tQ.v4)(),type:"paneGroup",percent:100,activeIndex:F.activeIndex.current,panes:F.panes.current}},data:t.reduce(function(e,t){var n=(0,N._)(t,2),r=n[0],i=n[1];return(0,rX._)((0,x._)({},e),(0,P._)({},r,i))},{})}}),window.open("".concat(window.location.origin+window.location.pathname,"?popupId=").concat(e),"_blank","popup=1,height=".concat(O.size.current.height,"px,width=").concat(O.size.current.width,"px")),(0,es.track)(el.events.WORKSPACE,{action:"workspace_popout_opened",ai:t.some(function(e){var t=(0,N._)(e,2);return"ghostwriterChat"===(t[0],t[1]).type}),console:t.some(function(e){var t=(0,N._)(e,2);return"runnerOutput"===(t[0],t[1]).type}),editor:t.some(function(e){var t=(0,N._)(e,2);return"codeEditor"===(t[0],t[1]).type}),shell:t.some(function(e){var t=(0,N._)(e,2);return"shell"===(t[0],t[1]).type}),paneData:t})}}}]},[G,F.activeIndex,F.panes,M,L,O.size]));return(0,X.default)(function(){return[{data:{type:"group",key:"pane-group"},commands:function(){return(0,en._)(W).concat((0,en._)(z),(0,en._)(H),(0,en._)(q),(0,en._)($),(0,en._)(Q),(0,en._)(K))}}]},[W,z,H,q,$,Q,K])}var cE=e.i(546284),cT=e.i(993134),cP=e.i(707468);function cR(e){var t,n,r,i,a,o,s,l,u=e.paneId,c=(t=(0,aC.usePaneUIContext)(),n=(0,aR.useGetToolPanes)(),r=rr(n1),(0,B.useCallback)(function(){return{data:{type:"context",label:aV.toolsCommandLabel,icon:(0,m.jsx)(aF.default,{})},commands:function(){return n().map(function(e){return{match:aS.matchLabel,data:{type:"action",label:t.getTitle(e),icon:t.Icon({pane:e}),run:function(){(0,es.track)(el.events.TOOL_OPENED,{source:"Tab Menu",tool:e.type}),r({paneId:u,pane:e})}}}})}}},[n,t,r,u])),d=(i=(0,ny.useGetRecentFiles)(),a=(0,ny.useGetOpenFiles)(),o=rr(n1),(0,B.useCallback)(function(){var e=a(),t=i().filter(function(t){return!e.includes(t)});return{data:{type:"context",label:"Recent",icon:(0,m.jsx)(cT.default,{})},commands:function(e){var n=e.searchQuery;return(0,lh.createFileCommands)({paths:t,searchQuery:n,run:function(e){o({paneId:u,pane:{type:(0,ti.getPaneTypeForFile)({path:e}),data:{path:e}}})}})}}},[i,o,u,a])),p=(s=(0,a9.default)().fs,l=rr(n1),(0,X.default)(function(){return{match:aS.matchLabel,data:{type:"context",label:"Files",icon:(0,m.jsx)(sP.default,{})},commands:function(e){return(0,er._)(function(e){var t,n,r;return(0,ei._)(this,function(i){switch(i.label){case 0:if(t=e.searchQuery,n=e.active,!t&&!n)return[2,[]];return[4,s.listFiles()];case 1:if((r=i.sent()).error)return[2,[]];if(!r.files)throw Error("Expected files");return[2,(0,lh.createFileCommands)({paths:r.files,searchQuery:t,run:function(e){l({paneId:u,pane:{type:(0,ti.getPaneTypeForFile)({path:e}),data:{path:e}}})}})]}})}).apply(this,arguments)}}},[s,l,u]));return(0,X.default)(function(){return{match:aS.matchLabel,data:{type:"context",label:"Change tab",icon:(0,m.jsx)(cP.default,{})},commands:function(e){var t=e.searchQuery,n=e.active;return t||n?[d(),p,c()]:[]}}},[d,c,p])}var cA=(0,ca.css)(i8.rcss.center,{fontSize:A.tokens.fontSizeSmall,border:"1px solid",borderColor:A.tokens.outlineDefault,width:20,height:20,marginTop:-2,marginLeft:-2},i8.rcss.borderRadius(8));function cD(e){return(0,m.jsx)(O.View,{css:cA,children:(0,m.jsx)(O.View,{css:{lineHeight:1},children:e.count})})}var cV=(0,ea.atom)([]);function cO(e,t){var n=t.run,r=t.enabled,i=void 0===r||r,a=(0,eo.useSetAtom)(cV);(0,B.useEffect)(function(){if(i){var t=(Array.isArray(e)?e:[e]).map(function(e){return{shortcut:e,run:n}});return a(function(e){return(0,en._)(e).concat((0,en._)(t))}),function(){a(function(e){return e.filter(function(e){return!t.includes(e)})})}}},[e,n,a,i])}function cF(){var e=(0,eo.useAtomValue)(cV);return(0,B.useEffect)(function(){var t=function(t){var n=!0,r=!1,i=void 0;try{for(var a,o=e[Symbol.iterator]();!(n=(a=o.next()).done);n=!0){var s,l=a.value,u=l.shortcut,c=l.run;!!u.cmdOrCtrlKey==!!(0,lj.getCmdOrCtrl)(t)&&!!u.altKey==!!t.altKey&&!!u.shiftKey==!!t.shiftKey&&(null==(s=u.key)?void 0:s.toLowerCase())===t.key.toLowerCase()&&(t.preventDefault(),c(u))}}catch(e){r=!0,i=e}finally{try{n||null==o.return||o.return()}finally{if(r)throw i}}};return document.addEventListener("keydown",t),function(){document.removeEventListener("keydown",t)}},[e]),null}var cM=e.i(877249),cL=(0,ro.cssRecord)({overlay:[i8.rcss.position.absolute,i8.rcss.overflow("hidden"),i8.rcss.zIndex(ra.zIndexLevels.overlay)],surface:[i8.rcss.position.relative,i8.rcss.borderRadius(8),i8.rcss.flex.shrink(1),{maxHeight:"100%",maxWidth:"100%",border:"1px solid",borderColor:A.tokens.outlineDefault,opacity:0},i8.rcss.shadow(3)],innerSurface:[i8.rcss.borderRadius(8)]}),cG=(0,ro.cssRecord)({root:[{borderTop:"1px solid",borderColor:A.tokens.outlineDimmer}],row:[i8.rcss.rowWithGap(2),i8.rcss.align.center,i8.rcss.justify.spaceBetween]});function cU(){var e=(0,aG.useCmdOrCtrl)();return(0,m.jsxs)(O.View,{css:cG.root,p:8,gap:8,children:[(0,m.jsxs)(O.View,{css:cG.row,children:[(0,m.jsx)(a0.Text,{color:"dimmest",variant:"small",multiline:!1,children:"Move focus"}),(0,m.jsxs)(O.View,{row:!0,gap:4,children:[(0,m.jsx)(um.KeyComboBlocks,{keyCombo:"".concat(e),small:!0}),(0,m.jsx)(um.KeyBlock,{text:(0,m.jsx)(cd,{duration:6e3,delay:6e3})})]})]}),(0,m.jsxs)(O.View,{css:cG.row,children:[(0,m.jsx)(a0.Text,{color:"dimmest",variant:"small",multiline:!1,children:"Move pane"}),(0,m.jsxs)(O.View,{row:!0,gap:4,children:[(0,m.jsx)(um.KeyComboBlocks,{keyCombo:"".concat(e,"Shift-"),small:!0}),(0,m.jsx)(um.KeyBlock,{text:(0,m.jsx)(cd,{duration:6e3,delay:1500})})]})]})]})}var cN=(0,B.memo)(function(){var e=function(){var e=rt(ne),t=rt(iR);if(t){var n={width:t.width,height:t.height,transform:"translate(".concat(t.x,"px, ").concat(t.y,"px)")},r=n.width,i=n.height,a=n.transform,o={border:"1px solid",borderColor:A.tokens.accentPrimaryStronger,borderRadius:A.tokens.borderRadius6,boxShadow:A.tokens.shadow3,transitionProperty:"transform, height, width",transitionDuration:cM.TRANSITIONS.duration,transitionTimingFunction:cM.TRANSITIONS.timingFunction};return(0,x._)({width:r,height:i,transform:a},e?void 0:o)}}(),t=rr(iF),n=(0,cr.default)(t,[]);return(0,B.useEffect)(function(){var e=setTimeout(function(){(0,ci.styleSet)(n,"opacity","1")});return function(){clearTimeout(e)}},[n]),(0,m.jsx)(cn.FocusScope,{restoreFocus:!0,autoFocus:!0,contain:!0,children:(0,m.jsx)(O.View,{style:e,css:cL.overlay,p:16,align:"end",children:(0,m.jsx)(V.Surface,{innerRef:n,elevated:!0,css:cL.surface,children:(0,m.jsx)(V.Surface,{css:cL.innerSurface,grow:!0,shrink:!0,elevated:!0,children:(0,m.jsx)(cH,{})})})})})}),cB={ArrowUp:"above",ArrowDown:"below",ArrowRight:"rightOf",ArrowLeft:"leftOf"},cW={ArrowUp:"up",ArrowDown:"down",ArrowRight:"right",ArrowLeft:"left"},cz=Object.keys(cB),cH=(0,B.memo)(function(){var e=rr(iM),t=rr(iL),n=rr(iD),r=rt(ne);cO({key:"Escape"},{run:function(){n()}}),cO(cz.map(function(e){return{key:e,cmdOrCtrlKey:!0}}),{run:function(t){e(cB[t.key])},enabled:!r}),cO(cz.map(function(e){return{key:e,cmdOrCtrlKey:!0,shiftKey:!0}}),{run:function(e){t({direction:cW[e.key]})},enabled:!r});var i=rt(iP);return i&&"sidebar"!==i.target?(0,m.jsx)(cq,{paneGroupId:i.paneGroupId,paneId:i.paneId}):null});function cq(e){var t,n,r,i,a,o,s,l,u,c,d,p,f,h,g,v,x,y,w,b,j,_=rt(ne),S=rr(iF),I=rr(iD),C=(t=e.paneGroupId,i=(r={paneId:n=e.paneId,paneGroupId:t}).paneId,a=r.paneGroupId,o=(0,aC.usePaneUIContext)(),s=ad(i),l=(0,ak.usePaneBindings)(i),u=cv(),c=cm({paneId:i,paneGroupId:a}),d=(0,X.default)(function(){var e=o.getTitle(s),t=function(e){return!!e&&(void 0===e?"undefined":(0,eV._)(e))==="object"&&"data"in e},n=[{data:{type:"group",key:"pane-actions"},commands:function(){var e,n;return(null!=(n=null==l||null==(e=l.commands)?void 0:e.flatMap(function(e){return e.commands}))?n:[]).filter(t)}},{data:{type:"group",key:"pane-close"},commands:function(){return[u(i)].concat((0,en._)(c)).filter(t)}}];return{match:aS.matchLabel,data:{type:"context",label:e,icon:(0,m.jsx)(o.Icon,{pane:s})},commands:function(e){var t=e.active,r=e.searchQuery;return t||r?n:[]}}},[s,l,o,i,c,u]),f=(p={paneId:n,paneGroupId:t}).paneGroupId,h=p.paneId,g=rt((0,X.default)(function(){return(0,ea.atom)(function(e){var t=e(e7),n=[],r=[],i=!0,a=!1,o=void 0;try{for(var s,l=t[Symbol.iterator]();!(i=(s=l.next()).done);i=!0){var u=s.value,c=u.panes.map(function(t){return[t,e(e(e3(t)).dataAtom)]}),d="floating"===u.path[0];(d?n:r).push({activeIndex:u.activeIndex,paneGroupId:u.id,isFloating:d,panes:c})}}catch(e){a=!0,o=e}finally{try{i||null==l.return||l.return()}finally{if(a)throw o}}return{floating:n,tiling:r}})},[])),v=(0,aC.usePaneUIContext)(),x=rr(nS),y=rr(nM),w=cR({paneId:h}),b=(0,X.default)(function(){var e=g.tiling,t=g.floating,n=e.reduce(function(e,t){return e+t.panes.length},0)+t.reduce(function(e,t){return e+t.panes.length},0),r={match:aS.matchLabel,data:{type:"action",label:"New tab",icon:(0,m.jsx)(sI.default,{}),run:function(){y({paneGroupId:f,activate:!0,panes:[{type:"commands",data:{autoFocus:!0}}]})}}};return n?[w,{match:aS.matchLabel,data:{type:"context",label:(0,cE.default)("Tab",n),icon:(0,m.jsx)(cD,{count:n})},commands:function(n){var i=n.active,a=n.searchQuery;if(!(i||a))return[];var o=(0,en._)(e).concat((0,en._)(t)).map(function(e,t){return{data:{type:"group",key:"paneGroups"+t},commands:function(){return e.panes.map(function(e){var t=(0,N._)(e,2),n=t[0],r=t[1];return{match:aS.matchLabel,data:{type:"action",label:v.getTitle(r),icon:(0,m.jsx)(v.Icon,{pane:r}),run:function(){x({paneId:n,activate:!0})}}}})}}});return o.unshift(r),o}}]:[w,r]},[g,v,x,y,f,w]),j=ck({paneGroupId:t,paneId:n}),(0,X.default)(function(){return{data:{type:"group",key:"root",description:"Search"},commands:function(){return[d].concat((0,en._)(b),(0,en._)(j))}}},[d,b,j]));return(0,m.jsx)(aN.CommandBar,{iconBreadcrumbs:!0,command:C,onAction:function(){return S()},onKeyDown:function(e,t){var n=t.inputValue,r=t.hasHighlightedItem;if("Enter"===e.key&&!n&&!r){e.preventDefault(),I();return}(0,lj.getCmdOrCtrl)(e)&&e.preventDefault()},footer:_?null:(0,m.jsx)(cU,{}),compact:!0})}var cK={id:"paneMenu.toggle",name:"Toggle pane context menu",default:(0,aG.defaultKeyCombo)({cmdOrCtrl:!0,key:"j"})};function c$(){var e=rr(iV),t=rt(iO);return((0,aD.useCommandBinding)(function(){return[cK.id,function(){return e()}]},[e]),t)?(0,m.jsx)(cN,{}):null}var cQ=e.i(971465),cY=e.i(933101),cX=e.i(159667),cJ=e.i(759025),cZ=e.i(782370),c0=e.i(128068),c1=e.i(188507),c2=e.i(924908),c4=e.i(279606),c8=new Set(["planProgressData","agentPlanStepBegin","acknowledgeUserMessage","workflowsGetOutputToolData","presentResultsToolData","deployConfigData"]),c3=new Set(["generate_plan","modify_step","verification","scroll_file","open_file"]);function c6(){var e=(0,c2.useChatter)(),t=(0,uN.useObservable)(e.sessions.agent.current),n=null==t?void 0:t.agent.state,r=(0,B.useMemo)(function(){var e;return null!=(e=null==t?void 0:t.reduce(c5,100))?e:null},[t]);return(0,B.useMemo)(function(){return n&&r?c4.Observable.combine(n,r).map(function(e){var t=(0,N._)(e,2),n=t[0],r=t[1];return((null==n?void 0:n.state)===c1.AgentRunState.AGENT_STATE_PAUSED||(null==n?void 0:n.state)===c1.AgentRunState.AGENT_STATE_UNKNOWN)&&r}):null},[n,r])}var c5={direction:"reverse",state:{value:!1},map:function(e){return e.value},reducer:function(e,t){if(e.sender.type===c1.UserType.USER||e.sender.type!==c1.UserType.AI)return t.value=!1,!1;var n=e.contents.contents;switch(null==n?void 0:n.$kind){case"rapidBuildConcluded":return;case"agentPlanEventContents":t.value=n.agentPlanEventContents.requiresApproval;break;case"agentAskUserForActionRequest":t.value=!0;break;case"agentTimelineEventContents":var r=n.agentTimelineEventContents.toolData;if(r&&c8.has(r.$kind))return;var i=n.agentTimelineEventContents.toolName;if(c3.has(i))return;break;default:t.value=!1}return!1}},c9=e.i(200119),c7=e.i(602213);function de(e){var t=e.isInLayout,n=(0,ll._)(e,["isInLayout"]),r=(0,uN.useObservable)((0,c9.useAgentIsWorking)()),i=(0,uN.useObservable)(c6()),a=(0,N._)((0,B.useState)(!1),2),o=a[0],s=a[1];(0,B.useEffect)(function(){if(!i||r||t)return void s(!1);var e=setTimeout(function(){return s(!o)},o?1e3:5e3);return function(){clearTimeout(e)}},[o,i,r,t]);var l=!t&&r||o;return(0,m.jsx)(c7.AgentAvatar,(0,x._)({loading:l},n))}var dt=e.i(918218),dn={id:"agent.toggle",name:"Toggle Agent",description:"Opens or closes the Agent",default:(0,aG.defaultKeyCombo)({cmdOrCtrl:!0,shift:!0,key:"i"})};function dr(){var e,t=aj(),n=(0,uN.useObservable)(t.displayState),r=(0,uN.useObservable)(t.agentFiletreeOrder),i=(0,c0.useObservableRef)(t.isCollapsed),a=(0,aD.useKeyCombo)(dn.id),o=t.toggle;return(0,aD.useCommandBinding)(function(){return[dn.id,function(){return o(!!i.current)}]},[o,i]),(0,m.jsx)(O.View,{clsx:[dt.default.root,(e={},(0,P._)(e,dt.default.show,"collapsed"===n),(0,P._)(e,dt.default.right,"filetree-agent"===r),e)],children:(0,m.jsx)(lz.IconButton,{tooltipContents:a?(0,m.jsx)(um.KeyComboBlocks,{fontSize:10,keyCombo:a}):null,alt:"Expand Agent",onClick:function(){t.toggle(!0)},children:(0,m.jsx)(de,{size:16,isInLayout:!1})})})}var di=[dn,cQ.switchAgentModeCommand,lQ,aB,cK,uj].concat((0,en._)(ce),(0,en._)(sG.editorCommands),(0,en._)(cX.gitCommands),[cZ.clearOutputsHistoryCommand,cY.generateOrModifyWithAICommand,cJ.generateWithAIInShellCommand]),da=e.i(202266);function ds(e){var t=(0,da.useSaveKeybindings)();return(0,m.jsx)(aA.KeybindingsProvider,{commands:di,onChange:t,keybindings:e.keybindings,children:e.children})}var dl=e.i(574831),du=e.i(135211);function dc(e){var t=e.children,n=(0,X.default)(function(){return new sM.StateCache(tX.default.get("stateCache","object"))},[]);return(0,m.jsx)(sM.StateCacheContext.Provider,{value:n,children:t})}function dd(e){var t,n=e.ui,r=e.repl,i=e.services,a=e.userKeybindings,o=e.children;return(0,m.jsx)(ds,{keybindings:a,children:(0,m.jsx)(aC.PaneUIContextProvider,{value:n,children:(0,m.jsx)(dc,{children:(0,m.jsx)(dl.default.Provider,{value:i,children:(0,m.jsx)(sL.DeploymentProvider,{replId:r.id,orgId:null==(t=r.org)?void 0:t.id,container:i.container,fs:i.fs,dotReplit:i.dotReplit,ports:i.ports,secrets:i.secrets,children:(0,m.jsx)(u0.ForkContextProvider,{repl:r,forkParams:{trackingData:{forkSource:"replEnvironmentDesktop"}},children:(0,m.jsx)(sx.ExtensionStoreProvider,{children:(0,m.jsx)(du.default,{children:o})})})})})})})})}var dp=e.i(736318);function df(){var e,t,n,r,i,a;return e=(0,a9.default)().fs,t=rt(tl),n=am(),r=(0,B.useCallback)(function(e){var t;(0,ih.isMarkdownFile)(e.path.toLowerCase())?t={paneType:"markdown"}:(0,ih.isCsvFile)(e.path.toLowerCase())&&(t={paneType:"csvPreview"}),n((0,rX._)((0,x._)({},e),{opener:t}))},[n]),i=rt(tE),a=(0,B.useRef)(!1),(0,B.useEffect)(function(){if(!a.current){if(!t){if(!window.location.hash)return;var e=new URL(window.location.href);history.pushState((0,rX._)((0,x._)({},history.state),{as:e.pathname}),document.title,window.location.origin+window.location.pathname+window.location.search);return}var n=(0,dp.deeplinkToHash)({path:t}),r=window.location.hash;if(!(r.slice(1)===t||r.startsWith(n+":"))){var i=new URL(window.location.href);i.hash=n,window.history.pushState((0,rX._)((0,x._)({},history.state),{as:i.pathname+i.hash}),"",i)}}},[t]),(0,B.useEffect)(function(){if(i){var t=function(){return(0,er._)(function(){var t;return(0,ei._)(this,function(n){switch(n.label){case 0:return a.current=!0,[4,(0,er._)(function(){var t,n,r,i;return(0,ei._)(this,function(a){switch(a.label){case 0:if(!(0,dp.hasHash)())return[2,null];return[4,(0,dp.parseHash)(e)];case 1:if(n=(t=a.sent()).path,r=t.line,i=t.col,!n)return[2,null];return[2,{path:n,line:r,col:i}]}})})()];case 1:return(t=n.sent())&&r(t),a.current=!1,[2]}})})()};return window.addEventListener("hashchange",t),function(){window.removeEventListener("hashchange",t)}}},[i,e,r]),null}var dh=e.i(375310);function dg(){var e=(0,dh.usePendingDeleteFile)(),t=(0,dh.useSetPendingDeleteFile)(),n=(0,a9.default)().fs,r=function(){t(null)};return(0,m.jsx)(aU.Modal,{isOpen:!!e,onRequestClose:r,children:e?(0,m.jsx)(lH.default,{name:e,description:e,entityType:"file",hideModal:r,delete:function(){e&&(n.deleteFile(e),t(null))}}):null})}var dm=e.i(569910),dv=e.i(134628),dx=e.i(479407),dy=e.i(203594),dw=e.i(16499);function db(){var e,t,n=(0,v.useRouter)(),r=(0,J.doesBonsaiWebviewSupportFeature)(n,"mobileBridge"),i=ab(),a=(0,dy.default)(),o=a.isSaving,s=a.isOffline,l=(0,B.useRef)(null),u=(0,dw.useSetAppKeyboardState)(),c=ah(),d=aL(),p=(e=(0,uG.useWorkflowsRunner)(),t=(0,uG.useOnToggleRun)(),{runState:(0,B.useMemo)(function(){return e?e.step:uA.RunState.OFFLINE},[e]),toggleRunState:(0,B.useCallback)(function(){t()},[t])}),f=p.runState,h=p.toggleRunState,g=(0,B.useCallback)(function(e){var t=function(e){switch(e){case dv.BridgeWorkspaceAction.OPEN_FILETREE:i.toggle();break;case dv.BridgeWorkspaceAction.TOGGLE_RUN_STATE:h();break;case dv.BridgeWorkspaceAction.TOGGLE_ALLPANES:d();break;case dv.BridgeWorkspaceAction.OPEN_NEW_PANE:case dv.BridgeWorkspaceAction.TOGGLE_DRAWER:break;default:(0,dm.default)(e)}},n=function(e){u(e)},r=function(e){var t=e.type,n=e.messageId;try{c({pane:{type:t}})}catch(e){(0,dx.sendErrorMessage)(n)}};(0,dx.workspaceBridgeMessageHandler)(e,function(e){var i=e.type;switch(i){case dv.BridgeMessageType.SET_KEYBOARD_STATE:n(e.keyboardState);break;case dv.BridgeMessageType.WORKSPACE_REQUEST_ACTION:t(e.action);break;case dv.BridgeMessageType.WORKSPACE_REQUEST_OPEN_PANE:r({messageId:e.id,type:e.paneType});break;default:(0,dm.default)(i)}})},[h,u,c,d,i]);return(0,B.useEffect)(function(){if(r){var e={messageType:dv.BridgeMessageType.WORKSPACE_STATE,isDrawerOpen:!1,isShowingAllPanes:!0,isSaving:o,isOffline:s,runState:f,activePaneType:null,activePaneFilePath:null,isInAgentMode:!1,insets:{top:0,bottom:0}},t=l.current;return(null==t||JSON.stringify(e)!==JSON.stringify(t))&&((0,dx.sendMessage)(e,(0,tQ.v4)()),l.current=e),window.addEventListener("message",g),function(){window.removeEventListener("message",g)}}},[r,g,f,o,s,l]),null}var dj=e.i(545150),d_=e.i(394212),dS=e.i(906368),dI=e.i(718398),dC=e.i(852155),dk=e.i(299798),dE=e.i(112942),dT=e.i(45442),dP=e.i(399144),dR=e.i(28432),dA=e.i(940745),dD=e.i(576779);function dV(e){var t=e.text,n=Math.floor(100*e.progress);return(0,m.jsxs)(m.Fragment,{children:[(0,m.jsxs)(O.View,{row:!0,align:"center",justify:"center",gap:8,style:{cursor:"not-allowed"},children:[(0,m.jsx)(dA.default,{}),(0,m.jsx)(a0.Text,{children:t})]}),(0,m.jsx)(O.View,{clsx:dD.default.progressBarContainer,children:(0,m.jsx)(O.View,{clsx:dD.default.progressBarTrack,children:(0,m.jsx)(O.View,{clsx:dD.default.progressBarFill,style:{width:"".concat(n,"%")}})})}),(0,m.jsx)(O.View,{justify:"center",align:"center",children:(0,m.jsxs)(a0.Text,{variant:"small",color:"dimmer",children:[n,"%"]})})]})}function dO(e){var t=e.errorMessage;return(0,m.jsxs)(O.View,{align:"center",gap:8,children:[(0,m.jsx)(a0.Text,{children:t}),(0,m.jsx)(a0.Text,{children:"Please try again or contact support"}),(0,m.jsx)(un.default,{href:"/~",children:(0,m.jsx)(a0.Text,{children:"Return to Home"})})]})}function dF(e){var t=e.onClick;return(0,m.jsxs)(O.View,{align:"center",gap:16,children:[(0,m.jsx)(a0.Text,{children:"You must login again to continue importing"}),(0,m.jsx)(aZ.Button,{text:"Reconnect to Figma",onClick:t,colorway:"primary",iconRight:(0,m.jsx)(uE.default,{})})]})}function dM(){var e,t,n,r,i,a,o,s,l,u,c,d,p,f,h,g,x,y,w,b,j,_,S=(0,v.useRouter)(),I=(e=(0,aJ.default)(),t=(0,N._)((0,dI.useUpdateReplForFigmaImportMutation)(),1)[0],n=(0,N._)((0,dI.useGetFigmaIntermediateTokenMutation)(),1)[0],i=(r=(0,N._)((0,B.useState)({status:"not_started"}),2))[0],a=r[1],s=(o=(0,N._)((0,B.useState)(0),2))[0],l=o[1],c=(u=(0,dI.useFigmaImportFlowQuery)({variables:{replId:e}})).data,p=null!=(d=!u.loading&&c&&"Repl"===c.getRepl.__typename&&c.getRepl.config.figmaImportStatus===uJ.FigmaImportStatus.Started?c.getRepl.config.figmaUrl:null)?d:null,f=ug(),h=(0,c2.useChatter)(),g=(0,B.useRef)(!1),x=(0,dT.useAgentSettings)().settings,y=(0,Z.useQueryParam)("initialQueuedPromptKey","string"),w=(0,i2.default)(p),b=(0,B.useCallback)(function(){return(0,er._)(function(){var e,t,n,r,i,a;return(0,ei._)(this,function(o){switch(o.label){case 0:if(g.current)return[2];return g.current=!0,[4,h.sessions.create({sessionType:c1.SessionType.AGENT_SESSION})];case 1:if(!(e=o.sent()).ok)throw Error("Failed to create Agent session");return f({type:"agentChat",data:{sessionId:e.payload.id}}),[4,(t=e.payload).appendEvent({kind:"setupImportedProject",importSource:c1.ProjectImportSource.PROJECT_IMPORT_SOURCE_FIGMA,agentConfig:(0,dE.convertAgentSettingsFromGQLToAiChat)(x)})];case 2:if(o.sent(),n="initial_queued_prompt_".concat(y),!(r=tX.default.get(n,"string")))return[2];return tX.default.remove(n),i=r,(a=w.current)&&(i=i.replaceAll(a,"")+"\n\n(Figma URL: ".concat(a," has already been imported.)")),[4,t.appendEvent({kind:"message",intent:c1.MessageAction.AGENT,message:i})];case 3:return o.sent(),[2]}})})()},[h,f,y,w,x]),j=(0,B.useCallback)(function(n){var r=n.errorMessage;return(0,er._)(function(){return(0,ei._)(this,function(n){switch(n.label){case 0:return a({status:"error",errorMessage:r}),[4,t({variables:{input:{id:e,figmaImportStatus:uJ.FigmaImportStatus.Failed}}})];case 1:return n.sent(),[2]}})})()},[e,t]),((0,dk.usePid2)(function(r,i){var o=i.signal;return(0,er._)(function(){var i,s,u,c,p,f,h,g,m,v,x,y,w,_,S,I;return(0,ei._)(this,function(C){switch(C.label){case 0:if(!d)return[2];return[4,n({variables:{input:{figmaUrl:d}}})];case 1:if((null==(i=C.sent().data)?void 0:i.getFigmaIntermediateToken.__typename)==="NoOAuthFoundError")return a({status:"needs_auth",retryAuth:function(){return l(function(e){return e+1})}}),[2];if((null==i?void 0:i.getFigmaIntermediateToken.__typename)==="InvalidFigmaUrlError"||(null==i?void 0:i.getFigmaIntermediateToken.__typename)==="FigmaRateLimitError")return dS.captureException(i.getFigmaIntermediateToken,{extra:{replId:e,figmaUrl:d}}),sm.logger.error("Failed to get Figma intermediate token",{repl:e,figmaUrl:d,payload:i.getFigmaIntermediateToken}),j({errorMessage:i.getFigmaIntermediateToken.message}),[2];if(!(s=null==i?void 0:i.getFigmaIntermediateToken)||"FigmaImportIntermediateToken"!==s.__typename)return sm.logger.error("Failed to get Figma intermediate token",{repl:e,figmaUrl:d,payload:i}),j({errorMessage:"Something went wrong while authenticating. Please try again."}),[2];return u=s.token,a(function(e){return"in_progress"===e.status?e:{status:"in_progress",progress:0,text:"Preparing Figma import..."}}),[4,r.figmaImport.startImport.rpc({intermediateToken:u},{signal:o})];case 2:if(!(c=C.sent()).ok)switch(p=c.payload.code){case"INVALID_REQUEST":case"UNCAUGHT_ERROR":return j({errorMessage:c.payload.message||"Something went wrong while importing. Please try again."}),[2];case"UNEXPECTED_DISCONNECT":case"CANCEL":return[2];default:(0,dm.default)(p)}f=r.figmaImport.status.subscribe({},{signal:o}).resReadable,h=void 0,g=!1,m=!1,C.label=3;case 3:C.trys.push([3,8,9,14]),x=function(){var t=w.value;if(!t.ok){var n=t.payload.code;switch(n){case"FIGMA_TOKEN_EXPIRED":case"FIGMA_INVALID_TOKEN":return a({status:"needs_auth",retryAuth:function(){return l(function(e){return e+1})}}),{v:void 0};case"FIGMA_NODE_NOT_FOUND":return j({errorMessage:"The selected Figma component could not be found, please ensure you have selected a frame and copied the link to the frame."}),{v:void 0};case"FIGMA_FILE_NOT_FOUND":return j({errorMessage:"The Figma file could not be accessed, please ensure the linked account has permissions to access the frame."}),{v:void 0};case"FIGMA_SELECTION_TOO_LARGE":return j({errorMessage:"Your Figma selection is too large to process, please make sure you have selected a single frame."}),{v:void 0};case"FIGMA_RATE_LIMIT_EXCEEDED":return j({errorMessage:"Too many requests. Please wait a moment and try again."}),{v:void 0};case"NO_CODE_GENERATED":return j({errorMessage:"No code could be generated from your frame. Please try a different link."}),{v:void 0};case"TIMEOUT":return j({errorMessage:"The import took too long. Please try again, or try a smaller component."}),{v:void 0};case"FIGMA_NODE_NOT_SUPPORTED":return j({errorMessage:"The selected Figma component is not supported. Please make sure you have selected a frame and copied the link to the frame."}),{v:void 0};case"FIGMA_PAGE_WITH_MULTIPLE_CHILDREN":return j({errorMessage:"The selected Figma page has multiple children. Please make sure you have selected a single frame."}),{v:void 0};case"FIGMA_PAGE_WITH_NO_VALID_CHILDREN":return j({errorMessage:"The selected Figma page doesn't have any content we can convert to code. Please make sure you've selected a page with visible designs then try again."}),{v:void 0};case"INVALID_REQUEST":case"UNKNOWN":case"UNCAUGHT_ERROR":return j({errorMessage:t.payload.message||"Something went wrong while importing. Please try again."}),{v:void 0};case"NOT_STARTED":return sm.logger.error("Figma Import: Failed to import from Figma",{repl:e,figmaUrl:d,payload:t.payload}),dS.captureException(Error("Figma import: not started"),{extra:{replId:e,figmaUrl:d,payload:t.payload}}),j({errorMessage:t.payload.message||"Something went wrong while importing. Please try again."}),{v:void 0};case"READABLE_BROKEN":case"CANCEL":case"UNEXPECTED_DISCONNECT":return{v:void 0};default:(0,dm.default)(n)}}var r=t.payload;"progress"===r.kind?a(function(e){return"in_progress"===e.status&&e.progress>=r.number?e:{status:"in_progress",progress:r.number,text:r.statusText}}):"success"===r.kind&&(h=function(e){var t=e.file,n=e.frame,r="".concat(t," (").concat(n,")");if(r.length<=dC.maxTitleLength)return r;var i=dC.maxTitleLength-3;if(t.length<=i-1){var a=i-t.length,o=n.length>a?n.substring(0,a-1)+"":n;return"".concat(t," (").concat(o,")")}var s=i-Math.min(n.length,10),l=t,u=n;t.length>s&&(l=t.substring(0,s-1)+"");var c=i-l.length;return n.length>c&&(u=n.substring(0,c-1)+""),"".concat(l," (").concat(u,")")}({file:r.figmaFileName,frame:r.figmaSelectedFrameName}))},y=(0,d_._)(f),C.label=4;case 4:return[4,y.next()];case 5:if(!(g=!(w=C.sent()).done))return[3,7];if(_=x(),"object"===(0,eV._)(_))return[2,_.v];C.label=6;case 6:return g=!1,[3,4];case 7:return[3,14];case 8:return S=C.sent(),m=!0,v=S,[3,14];case 9:if(C.trys.push([9,,12,13]),!(g&&null!=y.return))return[3,11];return[4,y.return()];case 10:C.sent(),C.label=11;case 11:return[3,13];case 12:if(m)throw v;return[7];case 13:return[7];case 14:return a({status:"in_progress",progress:1,text:"Creating checkpoint"}),[4,r.git.init.rpc({initialCommit:!0,includeAllInitialFiles:!0},{signal:o})];case 15:if(!(I=C.sent()).ok)switch(I.payload.code){case"CANCEL":case"UNEXPECTED_DISCONNECT":return[2];default:dS.withScope(function(e){e.setExtra("gitInitError",I.payload),dS.captureException(Error("figma import: git init failed"))})}return a({status:"in_progress",progress:1,text:"Handing off to Agent"}),[4,b()];case 16:return C.sent(),[4,t({variables:{input:{id:e,title:h,makeTitleUnique:!0,figmaImportStatus:uJ.FigmaImportStatus.Completed}}})];case 17:return C.sent(),(0,es.track)(el.events.FIGMA_IMPORT_USED,{action:"completed"}),a({status:"success"}),[2]}})})()},[d,e,t,b,s,n,j]),c&&"Repl"===c.getRepl.__typename&&c.getRepl.config.figmaImportStatus===uJ.FigmaImportStatus.Failed&&"not_started"===i.status)?{status:"error",errorMessage:"Something went wrong"}:i);return"not_started"===I.status||"success"===I.status?null:("in_progress"===I.status?_=(0,m.jsx)(dV,{text:I.text,progress:I.progress}):"error"===I.status?_=(0,m.jsx)(dO,{errorMessage:I.errorMessage}):"needs_auth"===I.status&&(_=(0,m.jsx)(dF,{onClick:function(){S.push("/integrations")}})),(0,m.jsx)(dP.Portal,{children:(0,m.jsx)(O.View,{clsx:dD.default.overlay,style:{cursor:"in_progress"===I.status?"wait":"default"},children:(0,m.jsx)(dj.default,{children:(0,m.jsxs)(O.View,{clsx:dD.default.animationWrapper,tabIndex:-1,children:[(0,m.jsxs)(O.View,{align:"center",gap:16,children:[(0,m.jsx)(dR.Figma2ReplitIcons,{}),(0,m.jsx)(a0.Text,{multiline:!1,variant:"subheadBig",dataCy:"figma-lock-screen",children:"Importing from Figma..."})]}),(0,m.jsx)(O.View,{pt:16,px:16,gap:4,children:_})]})})})}))}var dL=e.i(850270),dG=e.i(278505),dU=e.i(119322);function dN(){var e=(0,a9.default)().replspaceApi,t=(0,N._)((0,B.useState)(!1),2),n=t[0],r=t[1],i=(0,N._)((0,B.useState)({status:"not_started"}),2),a=i[0],o=i[1],s=ug(),l=(0,dG.useSetGitHubImportMode)();if((0,dL.useDoGitHubImportFlow)({setConfigScreenLockIsOpen:r,openPane:s,onStatusChange:o}),(0,B.useEffect)(function(){if(!n)return void l(!1);l(!0);var t=e.onConfirmSendToken(function(e){e&&e(!0,!1)});return function(){t(),l(!1)}},[n,e,l]),!n)return null;var u="Importing";return"in_progress"===a.status?u=a.text:"error"===a.status&&(u="Import failed: ".concat(a.errorMessage)),(0,m.jsx)(dU.default,{reason:u})}var dB=e.i(284058),dW=e.i(649960),dz=e.i(332441),dH=e.i(418725),dq=e.i(938298);function dK(){var e=(0,y._)(["\n  query isWebDesignMockup($replId: String!) {\n    getRepl(id: $replId) {\n      ... on Repl {\n        id\n        config {\n          isWebDesignMockup\n        }\n      }\n    }\n  }\n"]);return dK=function(){return e},e}var d$={},dQ=(0,w.gql)(dK()),dY=e.i(12558),dX=e.i(659790),dJ=e.i(908410),dZ=e.i(740616),d0=e.i(629756),d1=e.i(6338),d2=(0,ro.cssRecord)({container:[i8.rcss.position.relative],loadingGeneratedIcon:[d1.loadingStyle.foregroundPulse(A.tokens.blurpleDimmest,A.tokens.blurpleDefault),i8.rcss.borderRadius()]});function d4(e){var t=e.replId,n=e.replIconUrl,r=e.size,i=(0,d0.usePollForGeneratedReplIcon)({replId:t,replIconUrl:n}),a=i.loading,o=i.generatedIconUrl;return(0,m.jsx)(O.View,{css:d2.container,children:(0,m.jsx)(O.View,{css:a&&d2.loadingGeneratedIcon,children:(0,m.jsx)(uc.default,{iconUrl:o||n,size:void 0===r?20:r,alt:""})})})}var d8=e.i(341727),d3=e.i(751273),d6=e.i(196353),d5=e.i(497627),d9=(0,ro.cssRecord)({metadata:[],iconWrapper:[i8.rcss.position.relative],dimIcon:[{opacity:.2}],diconnectedIcon:[i8.rcss.position.absolute,{left:0,right:0,top:0,bottom:0,margin:"auto"}],title:[i8.rcss.flex.shrink(1),i8.rcss.truncate],placeholderTitle:[i8.rcss.width(100),i8.rcss.borderRadius("default"),{alignSelf:"stretch"},d1.loadingStyle.foregroundPulse(A.tokens.backgroundDefault,A.tokens.backgroundHigher)]});function d7(e){var t,n=e.repl,r=e.hideTitle,i=(0,d8.default)().didDisconnect;return(0,m.jsxs)(O.View,{grow:!0,shrink:!0,row:!0,gap:6,align:"center",children:[(0,m.jsxs)(O.View,{css:d9.iconWrapper,children:[(null==(t=n.project)?void 0:t.id)?(0,m.jsx)(m.Fragment,{children:r?(0,m.jsx)(d6.default,{}):null}):(0,m.jsx)(O.View,{css:i&&d9.dimIcon,children:(0,m.jsx)(d4,{replId:n.id,replIconUrl:n.iconUrl,size:16})}),i?(0,m.jsx)(d3.Tooltip,{tooltip:"Reconnecting",children:(0,m.jsx)(d5.default,{size:16,css:d9.diconnectedIcon})}):null]}),r?null:(0,m.jsx)(a0.Text,{multiline:!1,css:d9.title,"data-cy":"header-repl-title",color:i?"dimmer":"default",children:n.title})]})}var pe=e.i(754873),pt=e.i(604963),pn=(0,ro.cssRecord)({popover:[i8.rcss.maxWidth(460),i8.rcss.width("100%")],button:[pe.interactive.nofill,i8.rcss.height(28),i8.rcss.flex.growAndShrink(1),i8.rcss.align.center,i8.rcss.rowWithGap(4),i8.rcss.px(6),i8.rcss.borderRadius(),i8.rcss.color.foregroundDefault,{'&[aria-expanded="true"]':{backgroundColor:A.tokens.interactiveBackgroundActive}}]});function pr(e){var t=e.repl,n=e.getDesktopLayoutState,r=e.hideTitle,i=(0,N._)((0,B.useState)(!1),2),a=i[0],o=i[1],s=function(){var e=(0,J.useDoesBonsaiSupportFeature)("simplifiedTabletUI"),t=(0,B.useCallback)(function(){e&&(0,dx.sendMessage)({messageType:dv.BridgeMessageType.SHOW_REPL_INFO},(0,dJ.nanoid)())},[e]);if(e)return t}();return(0,J.useIsInBonsaiWebview)()?(0,m.jsx)(O.View,{css:pn.button,onClick:s,children:(0,m.jsx)(d7,{repl:t,hideTitle:r})}):(0,m.jsxs)(pt.PopoverTrigger,{isOpen:a,onOpenChange:function(e){o(e),e&&(0,es.track)(el.events.MODAL_VIEWED,{modal_name:"repl_metadata_popover"})},placement:"bottom start",label:"Repl info",css:pn.popover,children:[(0,m.jsx)(O.SpecializedView.button,{dataCy:"ws-repl-info-container",css:pn.button,onClick:function(){(0,es.track)(el.events.WORKSPACE,{action:"repl_metadata_opened"})},"aria-expanded":a,children:(0,m.jsx)(d7,{repl:t,hideTitle:r})}),(0,m.jsx)(dZ.default,{getDesktopLayoutState:n,setIsEditing:o})]})}var pi=e.i(248011),pa=e.i(663762),po=e.i(596139),ps=e.i(552488),pl=e.i(500736),pu=e.i(27820);function pc(e){var t=e.title,n=e.current,r=e.max,i=e.unit,a=e.isUbbV2,o=function(e){return i?"".concat(i).concat(e):e.toString()},s=r>0?n/r:0;return(0,m.jsxs)(O.View,{gap:6,children:[(0,m.jsxs)(O.View,{css:pd.usageMeterAndTitle,children:[(0,m.jsx)(O.View,{row:!0,align:"center",gap:4,children:(0,m.jsx)(a0.Text,{height:"singleLine",children:t})}),(0,m.jsx)(a0.Text,{height:"singleLine",color:"dimmer",children:void 0!==a&&a?"".concat(Math.floor(100*s),"%"):"".concat(o(n),"/").concat(o(r))})]}),(0,m.jsx)("div",{children:(0,m.jsx)(pu.MeasureBar,{css:pd.measureBar,total:r,current:n,color:A.tokens.accentPrimaryDimmer,tooltipHidden:!0})})]})}var pd=(0,ro.cssRecord)({measureBar:[i8.rcss.height(8),{pointerEvents:"none"}],usageMeterAndTitle:[i8.rcss.display.flex,i8.rcss.flex.row,i8.rcss.justify.spaceBetween,i8.rcss.align.center]});function pp(e){var t=e.limit,n=e.usage,r=e.title,i=(0,pl.useReplUrl)();if(!t||void 0===n)return(0,m.jsx)(dA.default,{});var a=100*Math.min(1,n/t),o="";return a>ps.FREEMIUM_POPUP_REACHED_ALERT_THRESHOLD?o="You've exceeded the ".concat(po.freePlanName," plan usage limit."):a===ps.FREEMIUM_POPUP_REACHED_ALERT_THRESHOLD?o="You've reached the ".concat(po.freePlanName," plan usage limit."):a>=ps.FREEMIUM_POPUP_NEAR_LIMIT_ALERT_THRESHOLD?o="You're nearing the ".concat(po.freePlanName," plan usage limit."):a>=ps.FREEMIUM_POPUP_WARNING_ALERT_THRESHOLD&&(o="You're approaching the ".concat(po.freePlanName," plan usage limit.")),(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)(O.View,{gap:4,children:(0,m.jsx)(pc,{title:null!=r?r:"Usage",current:n,max:t,unit:"$",isUbbV2:!0})}),o&&(0,m.jsx)(a0.Text,{children:o}),(0,m.jsx)(dH.default,{text:"Upgrade for more",colorway:"primary",variant:"default",context:"agent_freemium_quota_v2",redirectPath:i})]})}var pf=e.i(573605),ph=(0,ro.cssRecord)({root:[i8.rcss.px(8),pe.interactive.nofill,i8.rcss.height(32),i8.rcss.align.center,i8.rcss.rowWithGap(4),i8.rcss.px(6),i8.rcss.borderRadius(),i8.rcss.color.foregroundDefault],measureBar:[i8.rcss.width(50),i8.rcss.height(8),{pointerEvents:"none"}],popoverWrapper:[i8.rcss.width(280)],header:[i8.rcss.fontWeight.bold]});function pg(){var e,t,n=(0,N._)((0,B.useState)(!1),2),r=n[0],i=n[1],a=(0,pf.useGetAgentFreeUsage)().agentUsage;return(0,ps.useOnHitFreemiumAlertThreshold)({usage:null==a?void 0:a.usage,limit:null==a?void 0:a.limit,percentThreshold:ps.FREEMIUM_POPUP_WARNING_ALERT_THRESHOLD,onHitThreshold:function(){i(!0)}}),(0,ps.useOnHitFreemiumAlertThreshold)({usage:null==a?void 0:a.usage,limit:null==a?void 0:a.limit,percentThreshold:ps.FREEMIUM_POPUP_NEAR_LIMIT_ALERT_THRESHOLD,onHitThreshold:function(){i(!0)}}),(0,ps.useOnHitFreemiumAlertThreshold)({usage:null==a?void 0:a.usage,limit:null==a?void 0:a.limit,percentThreshold:ps.FREEMIUM_POPUP_REACHED_ALERT_THRESHOLD,onHitThreshold:function(){i(!0),(0,es.track)(el.events.AGENT_USED,{action:"hit_freemium_quota"})}}),(0,m.jsxs)(pt.PopoverTrigger,{isOpen:r,onOpenChange:function(e){i(e)},label:"Agent Usage",placement:"bottom start",children:[(0,m.jsx)(aZ.BaseButton,{css:ph.root,children:(0,m.jsx)(O.View,{row:!0,align:"center",gap:8,children:(0,m.jsx)(pu.MeasureBar,{css:ph.measureBar,total:null!=(e=null==a?void 0:a.limit)?e:0,current:null!=(t=null==a?void 0:a.usage)?t:0,color:A.tokens.accentPrimaryDimmer,tooltipHidden:!0})})}),(0,m.jsx)(O.View,{css:ph.popoverWrapper,p:8,children:(0,m.jsxs)(O.View,{gap:12,children:[(0,m.jsxs)(a0.Text,{css:ph.header,children:[s$.AGENT_NAME," usage"]}),(0,m.jsx)(pp,{limit:null==a?void 0:a.limit,usage:null==a?void 0:a.usage})]})})]})}function pm(){var e=aL(),t=(0,aD.useKeyCombo)(aB.id),n=t?"".concat(aM," (").concat(t,")"):aM;return(0,m.jsx)(lz.IconButton,{alt:n,onClick:function(){return e()},size:28,dataCy:"command-bar-btn",children:(0,m.jsx)(lm.default,{})})}var pv=e.i(368964),px=e.i(344677),py=e.i(399344),pw=e.i(914279),pb=e.i(68893),pj=e.i(241703),p_=e.i(187505),pS=e.i(522821),pI=e.i(492267),pC=e.i(293265),pk=e.i(785719),pE=(0,ro.cssRecord)({self:[i8.rcss.position.relative,i8.rcss.borderRadius(4,0,0,4)],dotWrapper:[i8.rcss.position.absolute,i8.rcss.top("-3px"),i8.rcss.right("-3px"),i8.rcss.width("10px"),i8.rcss.height("10px"),i8.rcss.borderRadius("full"),i8.rcss.border({color:A.tokens.backgroundDefault,width:2})],dot:[i8.rcss.width("100%"),i8.rcss.height("100%"),i8.rcss.borderRadius("full")]});function pT(e){var t=e.color;return(0,m.jsxs)(O.View,{css:pE.self,children:[(0,m.jsx)(sJ.default,{}),(0,m.jsx)(O.View,{tag:"span",css:pE.dotWrapper,children:(0,m.jsx)(O.View,{tag:"span",css:pE.dot,style:{backgroundColor:t,boxShadow:"0 0 6px ".concat(t)}})})]})}var pP=(0,ca.css)([i8.rcss.flex.growAndShrink(1),i8.rcss.borderRadius(4,0,0,4),(f={},(0,P._)(f,i8.media.max("tabletMin"),{"div span":[i8.rcss.display.none],"div svg":[i8.rcss.mr(0)]}),(0,P._)(f,'&[data-icon-only="true"]',{svg:[i8.rcss.mr(0)],span:[i8.rcss.display.none]}),f)]),pR=(0,ca.css)([pP,i8.rcss.borderRadius()]),pA={base:{self:pP,loading:(0,ca.css)([pP,d1.loadingStyle.backgroundPulse()])},rounded:{self:pR,loading:(0,ca.css)([pR,d1.loadingStyle.backgroundPulse()])}};function pD(e){var t=e.text,n=e.icon,r=e.disabled,i=e.rounded,a=e.onClick,o=e.tooltip,s=e.loading,l=e.iconOnly,u=e.tourStepRef,c=e.colorway,d=(0,m.jsx)(aZ.Button,{ref:u,loading:s,size:"small",text:t,iconLeft:n,colorway:c,css:pA[i?"rounded":"base"][s?"loading":"self"],disabled:r,onClick:a,"data-icon-only":l});return o?(0,m.jsx)(d3.Tooltip,{tooltip:o,children:d}):d}function pV(e){var t,n,r,i,a,o=e.iconOnly,s=(0,pw.useDeploymentMode)(),l=(0,px.usePauseProvisionStage)(),u=(0,pI.useIsAgentStackRepl)().isAgentStackRepl,c=(0,pC.useAgentStackPlatformType)().agentStackPlatformType,d=function(e,t,n){switch(e){case pb.DeploymentMode.Ready:case pb.DeploymentMode.Suspended:case pb.DeploymentMode.ProcessingLifecycleCommand:case pb.DeploymentMode.Loading:switch(t){case pv.AgentStackPlatformType.Slack:return"Publish to Slack";case pv.AgentStackPlatformType.Telegram:return"Publish to Telegram";case pv.AgentStackPlatformType.TimeBased:return"Publish Automation";default:return"Publish"}case pb.DeploymentMode.Preparing:return"Preparing";case pb.DeploymentMode.PreparingDatabase:switch(n){case!0:return"Approve";case!1:return"Preparing"}break;case pb.DeploymentMode.Deploying:switch(t){case pv.AgentStackPlatformType.Slack:return"Publishing to Slack";case pv.AgentStackPlatformType.Telegram:return"Publishing to Telegram";case pv.AgentStackPlatformType.TimeBased:return"Publishing Automation";default:return"Publishing"}default:(0,dm.default)(e)}}(s,u&&c||null,!!l),p=!1,f=!1;switch(s){case pb.DeploymentMode.Ready:case pb.DeploymentMode.Suspended:case pb.DeploymentMode.ProcessingLifecycleCommand:a=(0,m.jsx)(sJ.default,{});break;case pb.DeploymentMode.Loading:a=(0,m.jsx)(sJ.default,{}),p=!0;break;case pb.DeploymentMode.Preparing:a=(0,m.jsx)(sJ.default,{}),p=!0,f=!0;break;case pb.DeploymentMode.PreparingDatabase:l?(a=(0,m.jsx)(pk.default,{color:A.tokens.orangeStronger}),f=!0,p=!1):(a=(0,m.jsx)(dA.default,{}),f=!0,p=!0);break;case pb.DeploymentMode.Deploying:a=(0,m.jsx)(dA.default,{}),f=!0;break;default:(0,dm.default)(s)}var h=ah(),g=(0,py.useSetDeploymentTriggerSource)(),v=!!(0,pS.useActiveAgentSessionId)(),x=(t=(0,a9.default)().dotReplit,r=(n=(0,N._)((0,B.useState)(null),2))[0],i=n[1],(0,B.useEffect)(function(){return t.watch(function(e){var t;if(e.error)return i(null);i((null==(t=e.config.deployment)?void 0:t.target)||null)})},[t]),r),y=(0,sW.useSetTourStepTarget)(la,s6.Deploy);return(0,m.jsx)(pD,{text:d,icon:a,onClick:function(){s===pb.DeploymentMode.Ready&&(0,es.track)(el.events.DEPLOY_PROJECT_SELECTED,{source:"deploy_button",has_agent_session:v}),g("workspace_header_publish_button"),h({pane:{type:"deployments",flow:{skipIntro:null!==x&&v,isAgentDeployment:null!==x&&v}}})},disabled:p,loading:f,rounded:!0,iconOnly:void 0!==o&&o,tourStepRef:y,colorway:s===pb.DeploymentMode.Ready?"primary":void 0})}var pO={self:i8.rcss.rowWithGap(1),open:(0,ca.css)([i8.rcss.borderRadius(0,4,4,0),i8.rcss.px(4)])};function pF(){var e,t,n=(0,p_.useTrackClick)().trackClick,r=(0,pw.useDeploymentMode)(),i=(0,py.useDeploymentError)(),a=(0,py.useActiveBuildAction)(),o=(0,py.useSetDeploymentTriggerSource)(),s=ah(),l=(0,py.useDeployBuild)({openDeploymentsPane:function(){s({pane:{type:"deployments"}})}}).redeployWithNoNewOptions,u=(0,a4.default)().showError,c=(0,px.usePauseProvisionStage)(),d=(0,pC.useAgentStackPlatformType)().agentStackPlatformType,p=(0,K.useSupportsAgent)(),f=(0,N._)((0,B.useState)(void 0),2),h=f[0],g=f[1];(0,B.useEffect)(function(){if(a&&"HostingBuildDeployStatusAction"===a.__typename)switch(a.status){case pv.HostingBuildStatus.Success:case pv.HostingBuildStatus.Failed:g(a.status)}},[a]),(0,B.useEffect)(function(){r===pb.DeploymentMode.Deploying&&g(void 0)},[r]);var v=function(){switch(d){case pv.AgentStackPlatformType.Slack:return"Republish to Slack";case pv.AgentStackPlatformType.Telegram:return"Republish to Telegram";case pv.AgentStackPlatformType.TimeBased:return"Republish Automation";default:return"Republish"}}(),x=function(){switch(d){case pv.AgentStackPlatformType.Slack:return"Publishing to Slack";case pv.AgentStackPlatformType.Telegram:return"Publishing to Telegram";case pv.AgentStackPlatformType.TimeBased:return"Publishing Automation";default:return"Publishing"}}(),y=void 0,w=!1,b=!1;switch(r){case pb.DeploymentMode.Ready:e="Republish",t=(0,m.jsx)(sJ.default,{}),h&&(h===pv.HostingBuildStatus.Success?(t=(0,m.jsx)(pT,{color:A.tokens.accentPositiveDefault}),y="Success"):(t=(0,m.jsx)(pT,{color:A.tokens.accentNegativeDefault}),y="An error occurred"));break;case pb.DeploymentMode.Suspended:e=v,t=(0,m.jsx)(pT,{color:A.tokens.greyDefault}),y="Published app suspended";break;case pb.DeploymentMode.Loading:e=v,t=(0,m.jsx)(sJ.default,{}),w=!0,b=!0;break;case pb.DeploymentMode.ProcessingLifecycleCommand:e=v,t=(0,m.jsx)(pT,{color:A.tokens.orangeStronger}),b=!0,y="Updating published app";break;case pb.DeploymentMode.Preparing:e="Preparing",t=(0,m.jsx)(dA.default,{}),b=!0,w=!0;break;case pb.DeploymentMode.PreparingDatabase:c?(e="Approve",t=(0,m.jsx)(pk.default,{color:A.tokens.orangeStronger}),b=!0,w=!1):(e="Preparing",t=(0,m.jsx)(dA.default,{}),b=!0,w=!0);break;case pb.DeploymentMode.Deploying:e=x,t=(0,m.jsx)(dA.default,{}),b=!0;break;default:(0,dm.default)(r)}return i&&(e="Error",t=(0,m.jsx)(pT,{color:A.tokens.accentNegativeDefault}),y=i),(0,m.jsxs)(O.View,{css:pO.self,children:[(0,m.jsx)(pD,{text:e,icon:t,tooltip:y,onClick:function(){n({productArea:"publishing",target:"redeploy_button"}),(0,er._)(function(){return(0,ei._)(this,function(e){switch(e.label){case 0:if(r===pb.DeploymentMode.Deploying||r===pb.DeploymentMode.Suspended||r===pb.DeploymentMode.ProcessingLifecycleCommand||r===pb.DeploymentMode.Preparing||r===pb.DeploymentMode.PreparingDatabase)return s({pane:{type:"deployments"}}),[2];if(h&&(g(void 0),h===pv.HostingBuildStatus.Failed)||i)return s({pane:{type:"deployments",data:{view:pj.Views.Deployment}}}),[2];e.label=1;case 1:return e.trys.push([1,3,,4]),o("workspace_header_republish_button"),[4,l({hasAgentSession:p})];case 2:return e.sent(),[3,4];case 3:return u(e.sent().message),[3,4];case 4:return[2]}})})()},disabled:w,loading:b}),(0,m.jsx)(d3.Tooltip,{tooltip:"Open Publishing pane",children:(0,m.jsx)(aZ.Button,{size:"small",text:"",iconLeft:(0,m.jsx)(u8.default,{}),onClick:function(){s({pane:{type:"deployments"}})},css:pO.open})})]})}var pM=function(){var e=ah();return(0,m.jsx)(aZ.Button,{size:"small",text:"Republish",iconLeft:(0,m.jsx)(sJ.default,{}),onClick:function(){e({pane:{type:"deployments"}})}})};function pL(e){var t=e.iconOnly,n=(0,py.useDeploymentId)(),r=(0,py.useDeploymentCurrentBuild)(),i=(0,py.useDeploymentDeployability)().deployability;return n&&r?i.redeploy.isAuthorized?(0,m.jsx)(pF,{}):(0,m.jsx)(pM,{}):(0,m.jsx)(pV,{iconOnly:t})}var pG=e.i(239612);function pU(){var e=(0,y._)(["\n  fragment ProjectHeaderMenuOrg on Org {\n    id\n    slug\n  }\n"]);return pU=function(){return e},e}function pN(){var e=(0,y._)(["\n  query ProjectHeaderMenu($id: String!, $input: ProjectReplsInput!) {\n    getRepl(id: $id) {\n      ... on Repl {\n        id\n        title\n        ...CreateProjectForkRepl\n        project {\n          id\n          mainRepl {\n            id\n            title\n            ...CreateProjectForkRepl\n          }\n          repls(input: $input) {\n            items {\n              id\n              title\n              ...ReplLinkRepl\n            }\n            pageInfo {\n              hasNextPage\n              nextCursor\n            }\n          }\n        }\n      }\n    }\n  }\n  ","\n  ","\n"]);return pN=function(){return e},e}var pB={};(0,w.gql)(pU());var pW=(0,w.gql)(pN(),pG.CreateProjectForkReplFragmentDoc,ur.ReplLinkReplFragmentDoc),pz=e.i(691056),pH=e.i(611361),pq=e.i(341126),pK=e.i(700582),p$=e.i(537548),pQ=e.i(91720),pY=e.i(988676),pX=e.i(85742),pJ=e.i(458496),pJ=pJ,pZ=e.i(601059),p0=e.i(698043),p1=e.i(498540),p2=e.i(690821),p4=e.i(185591),p8=e.i(616278),p3=e.i(606867),p6=(0,ro.cssRecord)({self:[i8.rcss.display.grid,i8.rcss.p(4),{gap:4,alignItems:"stretch"}],list:[i8.rcss.maxHeight(640)],listItem:[pJ.default.item,i8.rcss.px(8),i8.rcss.height(28),{span:i8.rcss.color.foregroundDefault}],listItemLabel:{flex:1},listButtonLink:[i8.rcss.height(28),i8.rcss.px(6),i8.rcss.transition.none],currentReplIcon:[i8.rcss.color.foregroundDimmer],tourWrapper:[i8.rcss.p(8)]});function p5(e){var t=e.label,n=e.icon,r=(0,ll._)(e,["label","icon"]);return(0,m.jsxs)(pX.BaseListBoxItem,(0,rX._)((0,x._)({css:p6.listItem},r),{textValue:t,children:[(0,m.jsx)(pX.ListBoxItemLabel,{css:p6.listItemLabel,children:t}),(0,m.jsx)(p3.IconProvider,{size:16,children:n})]}))}var p9=(0,B.forwardRef)(function(e,t){var n,r,i,a,o,s,l,u,c,d,p,f,h=(0,aJ.default)(),g=(0,N._)((0,B.useState)(""),2),v=g[0],y=g[1],w=(0,sW.useTourStep)(p$.projectsTour.id,p$.StepIds.Forks),j=(n={variables:{id:h,input:{}},notifyOnNetworkStatusChange:!0},r=(0,x._)({},pB,n),b.useQuery(pW,r)),_=j.refetch,S=(0,a4.default)(),I=S.showConfirm,C=S.showError,k=(0,N._)((0,pK.useCreateProjectFork)({onFork:function(){I("App forked, redirecting...")},onError:function(){C("Error creating fork - please try again")}}),2),E=k[0],T=k[1].loading;(0,pz.default)(function(){_({input:{filters:{title:{search:v}}},id:h})},[v],300);var P=(null==(i=j.data)?void 0:i.getRepl.__typename)==="Repl"?j.data.getRepl.project:null,R=(null==(a=j.previousData)?void 0:a.getRepl.__typename)==="Repl"?null==(o=j.previousData.getRepl.project)?void 0:o.repls.items:null,A=null!=(d=null==P?void 0:P.mainRepl)?d:(null==(s=j.previousData)?void 0:s.getRepl.__typename)==="Repl"&&null!=(c=null==(l=j.previousData.getRepl.project)?void 0:l.mainRepl)?c:null,D=(null==(u=j.data)?void 0:u.getRepl.__typename)==="Repl"?j.data.getRepl:null,V=(0,pH.useProjectPresenceUsersByRepl)({orgId:e.org.id,projectId:e.projectId}),F=(0,sW.useActiveTourStep)();return(0,m.jsxs)("div",{css:p6.self,ref:t,children:[(0,m.jsxs)(p0.SearchableListBox,{children:[(0,m.jsx)(p1.SearchField,{"aria-label":"Search Apps in Project",placeholder:"Search by App title...",onChange:y,isLoading:j.loading,autoFocus:!0}),(0,m.jsx)(pX.ListBox,{isLoading:j.loading,items:null!=(f=null!=(p=null==P?void 0:P.repls.items)?p:R)?f:[],css:p6.list,children:function(e){var t;return(0,m.jsx)(p5,(0,rX._)((0,x._)({icon:e.id===h?(0,m.jsx)(d3.Tooltip,{tooltip:"You are here",placement:"right",children:(0,m.jsx)(p8.default,{css:p6.currentReplIcon})}):void 0,isDisabled:e.id===h,id:e.id,label:e.title},(0,p4.replLinkProps)(e)),{sessions:null!=(t=V[e.id])?t:[]}),e.id)}})]}),(0,m.jsx)(pY.DividerH,{}),(0,m.jsxs)(O.View,{children:[(0,m.jsx)(pQ.ButtonLink,(0,rX._)((0,x._)({alignment:"start"},(0,pq.orgProjectLink)({org:e.org,projectId:e.projectId})),{target:"_blank",iconLeft:(0,m.jsx)(u2.default,{}),text:"Project dashboard",variant:"nofill",css:p6.listButtonLink})),(0,m.jsxs)(pZ.PopupMenu,{elevated:!1,placement:"right top",trigger:(0,m.jsx)(aZ.Button,{alignment:"start",variant:"nofill",text:"New fork",iconLeft:T?(0,m.jsx)(dA.default,{}):(0,m.jsx)(sI.default,{}),loading:T,css:p6.listButtonLink}),children:[D?(0,m.jsx)(pZ.MenuItem,{label:"From here (".concat(D.title,")"),isDisabled:T,onAction:function(){E({forkSource:"projectHeaderMenu",orgId:e.org.id,repl:D})}}):null,D&&A&&D.id!==A.id?(0,m.jsx)(pZ.MenuItem,{label:"From main App (".concat(A.title,")"),isDisabled:!A||T,onAction:function(){A&&E({orgId:e.org.id,repl:A,forkSource:"projectHeaderMenu"})}}):null]}),w.isActive&&F?(0,m.jsx)("div",{css:p6.tourWrapper,children:(0,m.jsx)(p2.Tour,{content:F.content,title:F.title,onDismiss:w.next,onCurrentStepChange:w.goto,currentStepIndex:p$.projectsTour.steps.findIndex(function(e){return e.id===p$.StepIds.Forks}),totalSteps:p$.projectsTour.steps.length})}):null]})]})}),p7=e.i(782096),fe=(0,ro.cssRecord)({projectLinkTooltip:[i8.rcss.maxWidth(400),i8.rcss.flex.shrink(2)],projectLink:[i8.rcss.px(6),i8.rcss.noDragRegion,i8.rcss.flex.growAndShrink(1)],inheritanceChevron:[i8.rcss.color.outlineStrongest,{marginInline:-1}]});function ft(e){var t=e.repl,n=e.hideTitle,r=(0,N._)((0,B.useState)(!1),2),i=r[0],a=r[1];return t.project&&t.org?(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)(d3.Tooltip,{tooltip:"Project forks",css:fe.projectLinkTooltip,isOpen:!i&&void 0,children:(0,m.jsxs)(pt.PopoverTrigger,{label:"Project Menu",isOpen:i,onOpenChange:a,placement:"bottom start",children:[(0,m.jsx)(aZ.Button,{iconLeft:(0,m.jsx)(d4,{replId:t.id,replIconUrl:t.iconUrl}),text:n?"":t.project.title,variant:"nofill",css:fe.projectLink}),(0,m.jsx)(p9,{org:t.org,projectId:t.project.id})]})}),(0,m.jsx)(p7.default,{size:12,css:fe.inheritanceChevron})]}):null}var fn=e.i(782672),fr=e.i(550801),fi=e.i(42458);function fa(e){var t=e.nixError,n=(0,N._)((0,B.useState)(!1),2),r=n[0],i=n[1],a=ug(),o=(0,B.useCallback)(function(e){a({type:"codeEditor",data:{path:e}})},[a]);return(0,m.jsxs)(m.Fragment,{children:[(0,m.jsxs)(lz.IconButton,{alt:"App is in recovery mode",onClick:function(){i(!0)},children:["error"===t.status?(0,m.jsx)(fi.default,{color:A.tokens.orangeStronger}):null,"rebuilding-after-error"===t.status?(0,m.jsx)(dA.default,{}):null]}),(0,m.jsx)(fr.NixIsBrokenModal,{isOpen:r,setIsOpen:i,nixError:t,openFile:o})]})}function fo(){var e=(0,y._)(["\n  query WorkspaceRunButton($id: String!) {\n    getRepl(id: $id) {\n      ... on Repl {\n        id\n        title\n        rootOriginReplUrl\n        source {\n          release {\n            id\n            repl {\n              id\n              title\n              owner {\n                ... on User {\n                  id\n                  username\n                }\n                ... on Team {\n                  id\n                  username\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n    currentUser {\n      id\n    }\n  }\n"]);return fo=function(){return e},e}var fs={},fl=(0,w.gql)(fo()),fu=e.i(353583),fc=(h={},(0,P._)(h,uA.RunState.IDLE,"Run"),(0,P._)(h,uA.RunState.RUNNING,"Stop"),(0,P._)(h,uA.RunState.STOPPING,"Stopping"),(0,P._)(h,uA.RunState.OFFLINE,"Working"),(0,P._)(h,uA.RunState.BEFORE_RUN,"Working"),h),fd=e.i(796817);function fp(e){var t=e.stop,n=e.cancel;return(0,m.jsxs)(O.View,{children:[(0,m.jsx)(a0.Text,{children:"Stopping your project while the agent is working can lead to unexpected interruptions that incur additional costs. Are you sure you want to stop?"}),(0,m.jsxs)(O.View,{pt:12,row:!0,gap:12,justify:"end",children:[(0,m.jsx)(aZ.Button,{text:"Cancel",onClick:n}),(0,m.jsx)(aZ.Button,{iconLeft:(0,m.jsx)(fd.default,{}),text:"Stop",onClick:function(){t(),n()},colorway:"negative"})]})]})}var ff=e.i(978669),fh=e.i(60166);function fg(e){var t,n={running:e.isAgentRunningWorkflow?(0,m.jsx)(u9.default,{color:A.tokens.blurpleDefault}):(0,m.jsx)(fd.default,{color:A.tokens.foregroundDimmest}),stopped:(0,m.jsx)(ff.default,{color:e.disabled?A.tokens.foregroundDimmest:A.tokens.accentPositiveStronger}),loading:(0,m.jsx)(dA.default,{color:A.tokens.foregroundDimmest})}[e.status];return(0,m.jsxs)(V.Surface,{elevated:e.elevated,clsx:[fh.default.root,(t={},(0,P._)(t,fh.default.running,"running"===e.status),(0,P._)(t,fh.default.agent,e.isAgentRunningWorkflow),t)],children:[(0,m.jsx)(lz.IconButton,{disabled:e.disabled,dataCy:"ws-run-btn",alt:"Run or stop the app",tooltipContents:e.tooltip,onClick:e.onClick,size:28,children:n}),e.isAgentRunningWorkflow?(0,m.jsx)(O.View,{clsx:fh.default.agentStatusIcon,align:"center",justify:"center",children:(0,m.jsx)(fd.default,{size:12,color:A.tokens.foregroundDimmest})}):null]})}function fm(){var e,t,n,r,i,a,o,s,l,u,c,d,p,f,h,g,v,y,w,j,_,S,I,C=(o=(null==(a=(r={variables:{id:(0,aJ.default)()}},i=(0,x._)({},fs,r),b.useQuery(fl,i)).data)?void 0:a.getRepl.__typename)==="Repl"?a.getRepl:null,s=(t=null==(e=(0,sW.useTourStep)("workspace-desktop-tour-2024",s6.Run))?void 0:e.isActive,{tourRefs:e.tourRef,isAnyTourStepActive:t}).tourRefs,l=(0,aD.useKeyCombo)(uZ.run.id),c=(u=(0,N._)((0,B.useState)(!1),2))[0],d=u[1],f=null!=(n=null==(p=(0,uG.useWorkflowsRunner)())?void 0:p.workflowId)?n:uA.PID1_RUNNER_NAME,g=(h=(0,uG.useRunInfo)()).isRunning,v=h.isAgentRunningWorkflow,y=h.isOffline,w=h.isWorkflowsLoading,j=h.isDisabled,_=(0,B.useMemo)(function(){return y||w},[y,w]),S=(0,fu.useIsAgentRunButtonNotConfigured)(),I=(0,uG.useOnToggleRun)(),(0,B.useEffect)(function(){v&&c&&d(!1)},[v,c]),{tourRefs:s,isAgentRunningWorkflow:v,isOffline:y,isOfflineOrLoading:_,isWorkflowsLoading:w,runButtonName:f,runShortcut:l,isRunning:g,isDisabled:j,handleRunButtonClick:(0,B.useCallback)(function(){if(o){var e,t,n,r,i,a,s;(0,es.track)(el.events.PROJECT_RAN,{placement:"primary_btn",replId:o.id,replTitle:o.title,rootOriginReplUrl:o.rootOriginReplUrl,templateTitle:null==(n=o.source)||null==(t=n.release)||null==(e=t.repl)?void 0:e.title,templateOwner:null==(s=o.source)||null==(a=s.release)||null==(i=a.repl)||null==(r=i.owner)?void 0:r.username})}(0,es.track)(el.events.WORKSPACE,{action:"run_button_used",usage:"clicked",source:"header",runner:"workflows"}),I()},[o,I]),dropdownEnabled:!_&&!S,isAgentRunButtonNotConfigured:S}),k=C.isOfflineOrLoading,E=C.isRunning,T=C.handleRunButtonClick,P=C.isAgentRunningWorkflow,R=C.isDisabled,A=C.runButtonName,D=C.runShortcut,V=C.isAgentRunButtonNotConfigured,F=(0,fn.useNixError)(),M=(0,N._)((0,B.useState)(!1),2),L=M[0],G=M[1],U=E?"running":"stopped";k&&(U="loading");var W=P?function(){return G(!0)}:T;return F?(0,m.jsx)(fa,{nixError:F}):(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)(fg,{disabled:R||V,status:U,isAgentRunningWorkflow:P,onClick:W,tooltip:function(e){var t=e.isOffline,n=e.isAgentRunningWorkflow,r=e.isDisabled,i=e.isRunning,a=e.runButtonName,o=e.shortcut,s=e.isAgentRunButtonNotConfigured,l=e.isStatusButton;if(t)return"Connecting to the workspace";if(n)return l?"Stop App (Agent is running it)":"Agent is running your App";if(s)return"Agent hasn't configured the run button yet";if(r)return"Run button is not configured";var u=(0,uA.removeRunPrefix)(a);return(0,m.jsxs)(O.View,{px:4,gap:4,justify:"center",align:"center",children:[a?(0,m.jsx)(a0.Text,{color:"dimmer",variant:"small",children:i?fc[uA.RunState.RUNNING]+" all workflows":fc[uA.RunState.IDLE]+" ".concat(u)}):null,o?(0,m.jsx)(um.KeyComboBlocks,{keyCombo:o,fontSize:12}):null]})}({isRunning:E,isAgentRunningWorkflow:P,isDisabled:R,isOffline:k,runButtonName:A,shortcut:D,isAgentRunButtonNotConfigured:V,isStatusButton:!0})}),(0,m.jsx)(aU.Modal,{isOpen:L,onRequestClose:function(){return G(!1)},children:(0,m.jsx)(fp,{stop:T,cancel:function(){return G(!1)}})})]})}var fv=e.i(758386),fx=e.i(864558),fy=e.i(202120),fw=e.i(736451);e.i(713984);var fb=e.i(883021),fj=e.i(813377);function f_(e){var t=e?1560:1400;return(0,ro.cssRecord)({desktopButton:(0,P._)({},i8.media.max(t),[i8.rcss.display.none]),mobileButton:(0,P._)({},i8.media.min(t),[i8.rcss.display.none])})}let fS=function(t){var n=t.lesson,r=(0,a4.default)().showError,i=(0,fb.useConfetti)().fireCircularBurstFrom,a=(0,B.useRef)(null),o=(0,fw.usePrefersReducedMotion)(),s=(0,N._)((0,B.useState)(!1),2),l=s[0],u=s[1],c=(0,fv.useUpsellContext)().showPrivateUpsell,d=(0,N._)((0,fy.useMarkLessonAsCompleteMutation)({onError:function(){return r("Something went wrong")},onCompleted:function(e){var t,s;(null==(t=e.completeUserCourseLesson)?void 0:t.__typename)!=="UpdatedUserCourseLesson"?r((null==(s=e.completeUserCourseLesson)?void 0:s.message)||"Something went wrong"):e.completeUserCourseLesson.userCourseLesson.id===n.id?(a.current&&!o&&i({element:a.current}),u(!0)):r("Something went wrong")}}),2),p=d[0],f=d[1].loading,h="Lesson completed ",g="Mark lesson completed",v=function(){(0,fj.trackLessonEvent)({action:"completed",lessonSlug:n.lessonSlug,courseSlug:n.course.courseSlug}),p({variables:{input:{userLessonId:n.id}}})},x=(0,fx.default)(function(){return e.A(662663)},{loadableGenerated:{modules:[205350]},ssr:!1});return(0,m.jsxs)(m.Fragment,{children:[null!==n.timeCompleted?(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)(aZ.Button,{size:"small",ref:a,disabled:!0,text:h,colorway:"primary",css:f_(c).desktopButton}),(0,m.jsx)(d3.Tooltip,{tooltip:h,css:f_(c).mobileButton,children:(0,m.jsx)(aZ.Button,{ref:a,disabled:!0,text:"",colorway:"primary"})})]}):(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)(aZ.Button,{size:"small",onClick:v,text:f?"Verifying":g,colorway:"primary",loading:f,css:f_(c).desktopButton}),(0,m.jsx)(d3.Tooltip,{tooltip:g,css:f_(c).mobileButton,children:(0,m.jsx)(aZ.Button,{iconLeft:(0,m.jsx)(p8.default,{}),onClick:v,text:"",colorway:"primary",loading:f})})]}),(0,m.jsx)(aU.Modal,{isOpen:l,onRequestClose:function(){return u(!1)},children:(0,m.jsx)(x,{lessonSlug:n.lessonSlug,courseSlug:n.course.courseSlug})})]})};var fI=e.i(442060);function fC(e){var t,n=e.lesson,r=(t="tutorial",rt((0,X.default)(function(){return(0,ea.atom)(function(e){return e(e6).find(function(n){return!n.isHidden&&e(n.dataAtom).type===t})})},[t]))),i=rr(iQ),a=(0,fv.useUpsellContext)().showPrivateUpsell,o="Show tutorial",s=(0,m.jsx)(fI.default,{}),l=function(){return i()};return r?(0,m.jsx)(fS,{lesson:n}):(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)(aZ.Button,{size:"small",colorway:"primary",iconLeft:s,text:o,css:f_(a).desktopButton,onClick:l}),(0,m.jsx)(d3.Tooltip,{tooltip:o,css:f_(a).mobileButton,children:(0,m.jsx)(aZ.Button,{colorway:"primary",iconLeft:s,text:"",onClick:l})})]})}var fk=e.i(537754),fE=e.i(700283);function fT(e){var t=e.flipped,n=ab(),r=(0,lo.default)(n.isOpen),i=(0,aD.useKeyCombo)(lQ.id),a=n.toggle;(0,aD.useCommandBinding)(function(){return[lQ.id,function(){return a()}]},[a]);var o=(0,sW.useIsTouring)(),s=(0,B.useRef)(!1);(0,B.useEffect)(function(){o?(s.current=!0,a(!0)):s.current&&a(!1)},[o,a]);var l=r?s4.default:fk.default;return(0,m.jsx)(lz.IconButton,{onClick:function(){return a()},alt:"Toggle files",dataCy:"toggle-files-sidebar",tooltipContents:(0,m.jsx)(fP,{isOpen:r,shortcut:i}),size:28,children:(0,m.jsx)(l,{clsx:(0,P._)({},fE.default.flipped,t)})})}function fP(e){var t=e.shortcut,n=e.isOpen;return(0,m.jsxs)(O.View,{row:!0,gap:8,align:"center",children:[(0,m.jsx)(a0.Text,{multiline:!1,variant:"small",children:(n?"Close":"Open")+" files"}),t?(0,m.jsx)(um.KeyComboBlocks,{fontSize:10,keyCombo:t}):null]})}var fR=e.i(923893),fA=e.i(433788),fD=e.i(915598),fV=e.i(732947);function fO(){var e=(0,y._)(["\n  fragment ReplMultiplayerOrg on Org {\n    ...OrgMetadata\n    membersCount\n  }\n  ","\n"]);return fO=function(){return e},e}function fF(){var e=(0,y._)(["\n  fragment ReplMultiplayerOrgGroup on OrgGroup {\n    ...OrgGroupsOrgGroup\n  }\n  ","\n"]);return fF=function(){return e},e}function fM(){var e=(0,y._)(["\n  fragment ReplMultiplayerGroup on ReplMultiplayerGroupScope {\n    group {\n      __typename\n      ...ReplMultiplayerOrgGroup\n    }\n    options {\n      __typename\n      role\n      status\n    }\n  }\n  ","\n"]);return fM=function(){return e},e}function fL(){var e=(0,y._)(["\n  fragment ReplMultiplayerIndividual on ReplMultiplayerIndividualScope {\n    group {\n      __typename\n      ...ReplMultiplayerOrgGroup\n    }\n    user {\n      __typename\n      id\n      displayName\n      image\n      username\n    }\n    options {\n      __typename\n      role\n      status\n    }\n  }\n  ","\n"]);return fL=function(){return e},e}function fG(){var e=(0,y._)(["\n  fragment ReplMultiplayerStatus on Repl {\n    id\n    title\n    isPrivate\n    url\n    org {\n      ...ReplMultiplayerOrg\n    }\n    multiplayerStatus {\n      __typename\n      groups {\n        __typename\n        ...ReplMultiplayerGroup\n      }\n      individuals {\n        __typename\n        ...ReplMultiplayerIndividual\n      }\n    }\n    authorizations {\n      editPermissions {\n        isAuthorized\n        message\n      }\n      editVisibility {\n        isAuthorized\n        message\n      }\n      removeSelf {\n        isAuthorized\n        message\n      }\n      viewPermissions {\n        isAuthorized\n        message\n      }\n    }\n  }\n  ","\n  ","\n  ","\n"]);return fG=function(){return e},e}function fU(){var e=(0,y._)(["\n  query ReplMultiplayerStatus($replId: String!) {\n    getRepl(id: $replId) {\n      __typename\n      ... on Repl {\n        __typename\n        ...ReplMultiplayerStatus\n      }\n    }\n  }\n  ","\n"]);return fU=function(){return e},e}function fN(){var e=(0,y._)(["\n  mutation UpdateOrgReplVisibility($input: UpdateReplInput!) {\n    updateRepl(input: $input) {\n      repl {\n        id\n        ...ReplMultiplayerStatus\n      }\n    }\n  }\n  ","\n"]);return fN=function(){return e},e}var fB={},fW=(0,w.gql)(fO(),fV.OrgMetadataFragmentDoc),fz=(0,w.gql)(fF(),fD.OrgGroupsOrgGroupFragmentDoc),fH=(0,w.gql)(fM(),fz),fq=(0,w.gql)(fL(),fz),fK=(0,w.gql)(fG(),fW,fH,fq),f$=(0,w.gql)(fU(),fK),fQ=(0,w.gql)(fN(),fK),fY=e.i(766774),fX=e.i(813479),fJ=e.i(306694),fZ=e.i(967667),f0=e.i(479420),f1=e.i(714165),f2=e.i(396776),f4=e.i(576073),f8=e.i(987154),f3=e.i(626729),f6=(0,ro.cssRecord)({section:[i8.rcss.colWithGap(12),i8.rcss.px(12)],sectionWithBorders:[i8.rcss.colWithGap(12),i8.rcss.p(12),i8.rcss.border({direction:"top"}),i8.rcss.border({direction:"bottom"}),{"&:last-of-type":{borderBottom:0,paddingBottom:0}}],sectionTitle:[i8.rcss.fontWeight.medium],subtitle:[i8.rcss.fontWeight.medium],item:[i8.rcss.rowWithGap(16),i8.rcss.align.center,i8.rcss.justify.spaceBetween],groupName:[i8.rcss.colWithGap(6),i8.rcss.justify.center],visibilitySelector:[i8.rcss.position.relative,i8.rcss.justify.start,i8.rcss.align.center]}),f5=function(e){var t,n,r,i,a,o,s,l,u,c,d,p=e.replId,f=(0,aX.useCurrentUserId)(),h=(0,Y.default)(),g=(t={variables:{replId:p}},n=(0,x._)({},fB,t),b.useQuery(f$,n)),v=g.data,y=g.loading,w=g.error,j=g.refetch,_=(null==v||null==(r=v.getRepl)?void 0:r.__typename)==="Repl"?v.getRepl:void 0,S=(null!=(u=null==_||null==(i=_.multiplayerStatus)?void 0:i.groups)?u:[]).filter(function(e){return"custom"!==e.group.type}),I=(null!=(c=null==_||null==(a=_.multiplayerStatus)?void 0:a.groups)?c:[]).filter(function(e){return"custom"===e.group.type}),C=null!=(d=null==_||null==(o=_.multiplayerStatus)?void 0:o.individuals)?d:[],k=S.map(function(e){return e.group}).concat(I.map(function(e){return e.group})).concat(C.map(function(e){return e.group})),E=function(){return(0,er._)(function(){return(0,ei._)(this,function(e){switch(e.label){case 0:return[4,j()];case 1:return e.sent(),[2]}})})()};return(null==w?void 0:w.message)?(0,m.jsx)(O.View,{gap:12,children:(0,m.jsx)(f2.StatusBanner,{colorway:"negative",text:w.message})}):y||!_?(0,m.jsx)(O.View,{px:12,align:"center",justify:"center",children:(0,m.jsx)(dA.default,{})}):(0,m.jsxs)(O.View,{gap:12,children:[(0,m.jsxs)(O.View,{tag:"header",px:12,gap:2,children:[(0,m.jsx)(a0.Text,{variant:"subheadDefault",children:"Share App"}),(0,m.jsxs)(O.View,{css:f6.subtitle,row:!0,gap:4,children:[_.org?(0,m.jsxs)(a0.Text,{variant:"small",color:"dimmer",children:[_.org.name," /"]}):null,(0,m.jsx)(a0.Text,{variant:"small",children:_.title})]})]}),(null==(s=_.org)?void 0:s.id)&&_.authorizations.editPermissions.isAuthorized?(0,m.jsx)(O.View,{css:f6.sectionWithBorders,children:(0,m.jsx)(he,{orgId:_.org.id,selectedGroups:k,repl:_,onScopeChange:E})}):null,(0,m.jsxs)(O.View,{css:f6.section,children:[(0,m.jsx)(a0.Text,{variant:"small",css:f6.sectionTitle,children:"Roles with access"}),(0,m.jsx)(O.View,{gap:12,children:S.map(function(e){var t=e.group,n=e.options;return(0,m.jsx)(f7,{repl:_,group:t,options:n,onScopeChange:E},t.id)})}),I.length>0?(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)(a0.Text,{variant:"small",css:f6.sectionTitle,children:"Groups with access"}),(0,m.jsx)(O.View,{gap:12,children:I.map(function(e){var t=e.group,n=e.options;return(0,m.jsx)(f7,{repl:_,group:t,options:n,onScopeChange:E},t.id)})})]}):null]}),C.length>0?(0,m.jsxs)(O.View,{css:f6.section,children:[(0,m.jsx)(a0.Text,{variant:"small",css:f6.sectionTitle,children:"People with access"}),C.map(function(e){var t=e.group,n=e.user,r=e.options;return(0,m.jsx)(f9,{currentUserId:f,repl:_,group:t,user:n,options:r,onScopeChange:E},n.id)})]}):null,(0,m.jsx)(O.View,{css:f6.section,children:(0,m.jsx)(fZ.OrgPermissionsInfoBanner,{type:"repl"})}),(null==(l=_.org)?void 0:l.id)?(0,m.jsx)(O.View,{css:f6.sectionWithBorders,children:(0,m.jsxs)(O.View,{row:!0,justify:"space-between",children:[(0,m.jsx)(ht,{repl:_,org:_.org}),h?null:(0,m.jsx)(pQ.ButtonLink,(0,rX._)((0,x._)({prefetch:!1},(0,p4.replViewLinkProps)(_)),{iconRight:(0,m.jsx)(u2.default,{}),variant:"outlined",text:"Cover page",target:"_blank",style:{pointerEvents:"auto"}}))]})}):null]})},f9=function(e){var t=e.user,n=e.currentUserId,r=e.repl,i=e.group,a=e.options,o=e.onScopeChange,s=n===t.id;return(0,m.jsxs)(O.View,{css:f6.item,children:[(0,m.jsxs)(O.View,{row:!0,gap:8,children:[(0,m.jsx)(f1.Avatar,{src:t.image,username:t.username,fullName:t.displayName,size:24}),(0,m.jsxs)(O.View,{css:f6.groupName,children:[(0,m.jsxs)(O.View,{row:!0,gap:8,children:[(0,m.jsx)(a0.Text,{height:"singleLine",children:t.username}),s?(0,m.jsx)(a0.Text,{height:"singleLine",color:"dimmest",children:"(You)"}):null]}),t.username!==t.displayName?(0,m.jsx)(a0.Text,{variant:"small",color:"dimmest",height:"singleLine",children:t.displayName}):null]})]}),(0,m.jsx)(O.View,{children:(0,m.jsx)(f0.default,{repl:r,group:i,options:a,onScopeChange:o})})]})},f7=function(e){var t=e.repl,n=e.group,r=e.options,i=e.onScopeChange;return(0,m.jsxs)(O.View,{css:f6.item,children:[(0,m.jsxs)(O.View,{row:!0,gap:8,children:[(0,m.jsx)(fX.default,{group:n}),(0,m.jsxs)(O.View,{css:f6.groupName,children:[(0,m.jsx)(a0.Text,{height:"singleLine",children:n.name}),(0,m.jsxs)(O.View,{row:!0,gap:8,children:[n.isMember?(0,m.jsx)(a0.Text,{variant:"small",color:"dimmest",height:"singleLine",children:"(you)"}):null,null!=n.memberCount?(0,m.jsx)(a0.Text,{variant:"small",color:"dimmest",height:"singleLine",children:(0,cE.default)("member",n.memberCount,!0)}):null]})]})]}),(0,m.jsx)(O.View,{children:(0,m.jsx)(f0.default,{repl:t,group:n,options:r,onScopeChange:i})})]})},he=function(e){var t,n,r,i,a,o,s,l=e.orgId,u=e.selectedGroups,c=e.repl,d=e.onScopeChange,p="group-search-".concat((0,B.useId)()),f=(0,N._)((0,B.useState)(),2),h=f[0],g=f[1],v=(0,N._)((0,B.useState)(""),2),x=v[0],y=v[1],w=(0,N._)((0,fY.useOrgGroupReplScopeOptionsLazyQuery)(),2),b=w[0],j=w[1],_=j.data,S=j.error,I=j.loading,C=_&&(null==(n=_.currentUser)||null==(t=n.org)?void 0:t.__typename)==="Org"&&"OrgGroup"===_.currentUser.org.group.__typename&&(null==(r=_.currentUser.org.group.replScopeOptions)?void 0:r.__typename)==="OrgGroupReplScopeOptions"?_.currentUser.org.group.replScopeOptions.items[0].options:void 0,k=(null==_?void 0:_.currentUser)&&"Org"!==_.currentUser.org.__typename?_.currentUser.org.message:void 0,E=(null==_?void 0:_.currentUser)&&"Org"===_.currentUser.org.__typename&&"OrgGroup"!==_.currentUser.org.group.__typename?_.currentUser.org.group.message:void 0,T=(null==_?void 0:_.currentUser)&&"Org"===_.currentUser.org.__typename&&"OrgGroup"===_.currentUser.org.group.__typename&&(null==(i=_.currentUser.org.group.replScopeOptions)?void 0:i.__typename)!=="OrgGroupReplScopeOptions"?null==(a=_.currentUser.org.group.replScopeOptions)?void 0:a.message:void 0,P=null!=(s=null!=(o=null!=k?k:E)?o:T)?s:null==S?void 0:S.message;return(0,m.jsxs)(m.Fragment,{children:[(0,m.jsxs)(O.View,{row:!0,gap:8,children:[(0,m.jsx)(O.View,{grow:!0,shrink:!0,children:(0,m.jsx)(fJ.default,{inputId:p,orgId:l,types:[pv.OrgGroupType.Custom,pv.OrgGroupType.SystemIndividual],selectedGroups:u,value:x,setValue:y,onSelect:function(e){g(e),y(e.name),b({variables:{orgId:l,groupId:e.id,input:{replIds:[c.id]}}})},onClear:function(){return g(void 0)},placeholder:"Share with groups or other members"})}),h&&C||I?(0,m.jsxs)(O.View,{pl:24,row:!0,align:"center",children:[h&&C&&!I?(0,m.jsx)(f0.default,{group:h,repl:c,options:C,onScopeChange:function(){return(0,er._)(function(){return(0,ei._)(this,function(e){switch(e.label){case 0:return[4,d()];case 1:return e.sent(),y(""),g(void 0),[2]}})})()}}):null,I?(0,m.jsx)(dA.default,{size:24}):null]}):null]}),P?(0,m.jsx)(f2.StatusBanner,{colorway:"negative",text:P}):null]})},ht=function(e){var t,n,r,i=e.repl,a=e.org,o=(0,N._)((0,B.useState)(),2),s=o[0],l=o[1],u=(0,N._)((0,B.useState)(),2),c=u[0],d=u[1],p=(0,N._)((t={variables:{input:{id:i.id}},onError:function(e){d(e.message)}},n=(0,x._)({},fB,t),W.useMutation(fQ,n)),2),f=p[0],h=p[1].loading,g="repl-visibility-".concat((0,B.useId)()),v=i.authorizations.editVisibility.isAuthorized,y=i.authorizations.editVisibility.message,w=[{id:"private",icon:(0,m.jsx)(f3.default,{}),name:"Internal to ".concat(a.name),selected:i.isPrivate,description:"Only selected organization members can view or edit."},{id:"public",icon:(0,m.jsx)(f8.default,{}),name:"Public on Replit",selected:!i.isPrivate,description:"Anyone on Replit can see or fork. You choose who can edit."}],b=w.find(function(e){return e.selected}),j=b?(0,m.jsxs)(O.View,{row:!0,gap:8,align:"center",children:[b.icon," ",b.name]}):void 0;return r=c?(0,m.jsx)(d3.Tooltip,{tooltip:c,children:(0,m.jsx)(fi.default,{size:24,color:A.tokens.accentNegativeDefault})}):h?(0,m.jsx)(dA.default,{size:24}):s?(0,m.jsx)(p8.default,{size:24,color:A.tokens.accentPositiveDefault}):null,(0,m.jsxs)(O.View,{css:f6.visibilitySelector,grow:!0,shrink:!0,row:!0,gap:4,children:[(0,m.jsx)(d3.Tooltip,{tooltip:y,isDisabled:v,children:(0,m.jsx)(pZ.PopupMenu,{id:g,trigger:(0,m.jsx)(aZ.Button,{iconRight:(0,m.jsx)(f4.default,{}),text:null!=j?j:"Control Repl visibility",disabled:!v}),"aria-label":"Control ".concat(i.title," visibility"),onAction:function(e){var t="private"===e;t!==i.isPrivate&&(d(void 0),f({variables:{input:{id:i.id,isPrivate:t}},optimisticResponse:{__typename:"RootMutationType",updateRepl:{__typename:"UpdateReplPayload",repl:(0,rX._)((0,x._)({},i),{isPrivate:t})}},onCompleted:function(e){"UpdateReplPayload"===e.updateRepl.__typename&&(l(!0),setTimeout(function(){return l(!1)},2e3))}}))},items:w,disallowEmptySelection:!0,isDisabled:!v,children:function(e){return(0,m.jsx)(pZ.MenuItem,{id:e.id,label:e.name,description:e.description,icon:e.icon},e.id)}})}),r?(0,m.jsx)(O.View,{children:r}):null]})},hn=e.i(294784),hr=e.i(635925);function hi(){var e=(0,y._)(["\n  query TeamMultiplayerManagerMultiplayers($replId: String!) {\n    currentUser {\n      id\n    }\n    getRepl(id: $replId) {\n      ... on Repl {\n        id\n        isOwner\n        collaborators {\n          type\n          permission\n          user {\n            ...MultiplayerUser\n          }\n        }\n        authorizations {\n          editPermissions {\n            isAuthorized\n          }\n          inviteGuests {\n            isAuthorized\n          }\n        }\n        multiplayerInvites {\n          email\n          type\n        }\n        owner {\n          ... on User {\n            id\n          }\n          ... on Team {\n            id\n            username\n            displayName\n            capabilities {\n              isBusinessPlan\n              hasValidSubscription\n              availableSeats\n            }\n            members {\n              id\n              permissions\n              user {\n                id\n                ...MultiplayerUser\n              }\n            }\n          }\n        }\n      }\n    }\n  }\n  ","\n"]);return hi=function(){return e},e}var ha={},ho=(0,w.gql)(hi(),hr.MultiplayerUserFragmentDoc),hs=e.i(204070),hl=(0,ro.cssRecord)({root:[i8.rcss.color.foregroundDefault,i8.rcss.p(24),i8.rcss.display.grid,{gap:A.tokens.space24}],controls:[i8.rcss.display.grid,{gap:A.tokens.space8,gridAutoFlow:"column"}],message:[i8.rcss.pb(16)],textContainer:[i8.rcss.textAlign.center]});function hu(e){var t=e.email,n=e.onInvite,r=e.onCancel;return(0,m.jsxs)("div",{css:hl.root,children:[(0,m.jsx)(a0.Header,{level:3,textAlign:"center",variant:"subheadBig",children:"Are you sure?"}),(0,m.jsx)("div",{css:hl.textContainer,children:(0,m.jsxs)(a0.Text,{variant:"text",children:[(0,m.jsx)("p",{css:hl.message,children:"Adding an external user as a guest to this repl will give the user read and write access. Please confirm the below email address before inviting the user as a guest."}),(0,m.jsx)("p",{children:t})]})}),(0,m.jsxs)("div",{css:hl.controls,children:[(0,m.jsx)(aZ.Button,{onClick:r,text:"Cancel"}),(0,m.jsx)(aZ.Button,{colorway:"primary",onClick:n,text:"Invite"})]})]})}var hc=e.i(802482),hd=e.i(613349),hp=e.i(552144),hf=e.i(652219);function hh(e){var t,n,r,i,a,o,s,l,u,c,d,p,f=e.replId,h=(0,v.useRouter)(),g=(0,J.isInBonsaiWebview)(h),y=(0,pa.useActiveUsers)(),w=(0,N._)((0,B.useState)(null),2),j=w[0],_=w[1],S=(t={variables:{replId:f}},n=(0,x._)({},ha,t),b.useQuery(ho,n)),I=S.data,C=S.loading,k=(null==I||null==(r=I.currentUser)?void 0:r.id)||null,E=(null==I?void 0:I.getRepl.__typename)==="Repl"?I.getRepl:null,T=(0,hs.default)({isMobileApp:g,isTeam:!0,replId:f}),P=T.addOrInviteReplMultiplayer,R=T.loadingAddMutation;if(E&&!E.owner)throw Error("Cannot manage members on anon repls");if((null==E?void 0:E.owner)&&(null==E?void 0:E.owner.__typename)!=="Team")throw Error("Expect repl owned by a team");var D=(null==E||null==(i=E.owner)?void 0:i.__typename)==="Team"?E.owner:null,F=!(null==D||null==(a=D.capabilities)?void 0:a.hasValidSubscription)&&!(null==D||null==(o=D.capabilities)?void 0:o.isBusinessPlan),M=(null!=(s=null==E?void 0:E.collaborators)?s:[]).reduce(function(e,t){var n=t.user.username;return -1===e.indexOf(n)&&e.push(),e},[]),L=null==E?void 0:E.multiplayerInvites,G=(null!=(l=null==E?void 0:E.collaborators)?l:[]).filter(function(e){return"guest"===e.type}).map(function(e){return e.user}),U=G.length,W=(null!=(u=null==E?void 0:E.collaborators)?u:[]).filter(function(e){return"member"===e.type}).map(function(e){return e.user}),z=(null!=(c=null==E?void 0:E.collaborators)?c:[]).filter(function(e){return"admin"===e.type}).map(function(e){return e.user}),H=z.some(function(e){return e.id===k}),q=W.filter(function(e){return y.some(function(t){return t.id===e.id})}),K=W.filter(function(e){return!y.some(function(t){return t.id===e.id})}),$=null!=(d=null==E?void 0:E.authorizations.editPermissions.isAuthorized)&&d,Q=null!=(p=null==E?void 0:E.authorizations.inviteGuests.isAuthorized)&&p;return C?(0,m.jsx)(V.Surface,{css:[fA.MultiplayerControlCSS.root],background:"default",children:(0,m.jsxs)(O.View,{css:fA.MultiplayerControlCSS.loading,children:[(0,m.jsx)(dA.default,{color:A.tokens.foregroundDimmer}),(0,m.jsx)(a0.Text,{color:"dimmer",multiline:!1,children:"Loading..."})]})}):(0,m.jsxs)(V.Surface,{css:fA.MultiplayerControlCSS.root,background:"default",children:[(0,m.jsx)(O.View,{css:[fA.MultiplayerControlCSS.header,g&&fA.MultiplayerControlCSS.header_mobile],children:(0,m.jsx)(O.View,{css:fA.MultiplayerControlCSS.titleContainer,children:(0,m.jsx)(a0.Text,{variant:"subheadDefault",multiline:!1,children:"Team Multiplayers"})})}),Q?(0,m.jsx)(O.View,{css:fA.MultiplayerControlCSS.searchContainer,children:(0,m.jsx)(hd.default,{existingUsernames:M,onSubmit:function(e){if(!R){if((0,hn.default)(e))return void _(e);P({variables:{input:{replId:f,target:{method:pv.MultiplayerInviteMethod.Username,value:e},level:pv.ReplPermissionLevel.Rw}}})}},isDisabled:C})}):null,!Q&&F?(0,m.jsx)(O.View,{px:16,children:(0,m.jsx)(hp.StatusBannerButton,{iconLeft:(0,m.jsx)(hf.default,{}),text:'You can add people to this App by inviting them to the "'.concat(null==D?void 0:D.displayName,'" Friends Team.'),href:"/teams/".concat(null==D?void 0:D.username),target:"_blank"})}):null,(0,m.jsx)(aU.Modal,{isOpen:!!j,onRequestClose:function(){return _(null)},children:j?(0,m.jsx)(hu,{email:j,onInvite:function(){P({variables:{input:{replId:f,target:{method:pv.MultiplayerInviteMethod.Email,value:j},level:pv.ReplPermissionLevel.Rw}}}),_(null)},onCancel:function(){return _(null)}}):null}),(0,m.jsxs)(V.Surface,{css:fA.MultiplayerControlCSS.userList,children:[(null==L?void 0:L.length)?(0,m.jsxs)(O.View,{css:fA.MultiplayerControlCSS.userGroup.root,children:[(0,m.jsx)(fA.UserGroupTitle,{title:"Pending Invitations",color:A.tokens.outlineStrongest,count:U}),null==L?void 0:L.map(function(e){return(0,m.jsx)(hc.default,{canEditMultiplayers:H||!1,email:e.email,isPendingInvitation:!0,replId:f},e.email)})]}):null,G.length?(0,m.jsxs)(O.View,{css:fA.MultiplayerControlCSS.userGroup.root,children:[(0,m.jsx)(fA.UserGroupTitle,{title:"External Guests",color:A.tokens.outlineStrongest,count:null==G?void 0:G.length,tooltip:"External Guests are not members of your team and were invited via a Join Link or by username."}),G.map(function(e){return(0,m.jsx)(hc.default,{canEditMultiplayers:H||!1,isPendingInvitation:!1,replId:f,user:e},e.id)})]}):null,q.length?(0,m.jsxs)(O.View,{css:fA.MultiplayerControlCSS.userGroup.root,children:[(0,m.jsx)(fA.UserGroupTitle,{title:"Online Members",color:A.tokens.greenStrongest,count:null==q?void 0:q.length}),q.map(function(e){return(0,m.jsx)(hc.default,{isPendingInvitation:!1,canEditMultiplayers:!!H,replId:f,user:e},e.id)})]}):null,K.length?(0,m.jsxs)(O.View,{css:fA.MultiplayerControlCSS.userGroup.root,children:[(0,m.jsx)(fA.UserGroupTitle,{title:"Offline Members",color:A.tokens.outlineStrongest,count:null==K?void 0:K.length}),K.map(function(e){return(0,m.jsx)(hc.default,{isPendingInvitation:!1,canEditMultiplayers:!!H,replId:f,user:e},e.id)})]}):null,z.length?(0,m.jsxs)(O.View,{css:fA.MultiplayerControlCSS.userGroup.root,children:[(0,m.jsx)(fA.UserGroupTitle,{title:"Admins",color:A.tokens.accentPrimaryStronger,count:z.length}),z.map(function(e){return(0,m.jsx)(hc.default,{canEditMultiplayers:!1,isPendingInvitation:!1,user:e,replId:f},e.id)})]}):null,$||C?null:(0,m.jsx)(a0.Text,{color:"dimmer",variant:"small",multiline:!1,children:"Only admins can add and remove members to multiplayer"})]})]})}var hg=function(){var e=(0,fv.useUpsellContext)(),t=e.showPrivateUpsell,n=e.refetch,r=(0,l2.useGlobalModal)().show;return t?(0,m.jsx)(O.View,{px:12,children:(0,m.jsx)(O.View,{tag:"button",css:hm.bannerWrapper,onClick:function(){return(0,er._)(function(){return(0,ei._)(this,function(e){switch(e.label){case 0:return[4,r("MembershipPurchaseModal",{headingText:"Upgrade for private Apps",subHeadingText:"Keep your code secure and private",analyticsContext:{upgrade:{context:"workspace_multiplayer_header"}},onPurchaseComplete:function(){return n()}})];case 1:return e.sent(),[2]}})})()},children:(0,m.jsx)(f2.StatusBanner,{icon:(0,m.jsx)(lL.default,{}),colorway:"yellow",text:"This App is publicly visible. Upgrade for unlimited private Apps, better AI, more storage, speed, and more."})})}):null},hm=(0,ro.cssRecord)({bannerWrapper:[i8.rcss.cursor.pointer,i8.rcss.borderRadius(),i8.rcss.textAlign.left]}),hv=(0,ro.cssRecord)({self:[i8.rcss.borderRadius(8),i8.rcss.align.stretch,i8.rcss.flex.growAndShrink(1),i8.rcss.maxHeight("calc(100vh - ".concat(F.HEADER_HEIGHT+12,"px)")),i8.rcss.backgroundColor.backgroundDefault]});let hx=function(e){var t,n=e.replId,r=e.handleUpgradeTriggered,i=e.isTeamRepl,a=e.org;return t=a?(0,m.jsx)(f5,{replId:n}):i?(0,m.jsx)(hh,{replId:n}):(0,m.jsx)(fA.default,{replId:n,handleUpgradeTriggered:r}),(0,m.jsxs)(O.View,{css:hv.self,py:12,gap:12,children:[t,a&&"personal"!==a.type?null:(0,m.jsx)(hg,{}),a?null:(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)(pY.DividerH,{}),(0,m.jsx)(fR.default,{replId:n})]})]})};var hy=e.i(781478),hw=e.i(317941);function hb(e){var t,n,r,i=e.users,a=void 0===i?[]:i,o=e.onAvatarClick,s=e.repl,l=(null==(t=s.owner)?void 0:t.__typename)==="Team",u=(0,N._)((0,B.useState)(!1),2),c=u[0],d=u[1];return(0,m.jsxs)(O.View,{row:!0,align:"center",gap:4,children:[a.length?(0,m.jsx)(hj,{users:a,onAvatarClick:o}):null,(0,m.jsxs)(pt.PopoverTrigger,{isOpen:c,onOpenChange:d,label:"Home",placement:"bottom start",children:[(null==(n=s.org)?void 0:n.type)==="team"?(0,m.jsx)(aZ.Button,{size:"small",iconLeft:(0,m.jsx)(hy.default,{}),text:"Access"}):(0,m.jsx)(lz.IconButton,{alt:"Invite collaborator",size:28,children:(0,m.jsx)(hy.default,{})}),(0,m.jsx)(O.View,{clsx:hw.default.inviteDialog,children:(0,m.jsx)(hx,{replId:s.id,isTeamRepl:l,org:null!=(r=s.org)?r:void 0,handleUpgradeTriggered:function(){}})})]})]})}function hj(e){var t=e.users,n=e.onAvatarClick,r=t.slice(0,2),i=t.length-2,a=(0,N._)((0,B.useState)(!1),2),o=a[0],s=a[1];return(0,m.jsxs)(O.View,{row:!0,gap:4,children:[r.map(function(e,t){return(0,m.jsx)(h_,{onClick:function(){return n(e)},user:e,stacked:t>0},e.username)}),i>0?(0,m.jsxs)(pt.PopoverTrigger,{isOpen:o,onOpenChange:s,label:"Home",placement:"bottom start",children:[(0,m.jsx)(aZ.Button,{size:"small",text:"+".concat(i),clsx:[hw.default.stacked,hw.default.remainingCountButton]}),(0,m.jsxs)(pZ.Menu,{children:[(0,m.jsx)(pZ.MenuHeader,{text:"Observe..."}),t.slice(2).map(function(e){return(0,m.jsx)(pZ.MenuItem,{onAction:function(){return n(e)},icon:(0,m.jsx)(f1.Avatar,{size:24,src:e.image||null,username:e.username,ringColor:e.color}),label:e.username},e.username)})]})]}):null]})}function h_(e){var t=e.user,n=e.stacked,r=e.onClick;return(0,m.jsx)(lz.IconButton,{alt:"Observe ".concat(t.username),onClick:r,clsx:[hw.default.avatar,(0,P._)({},hw.default.stacked,n)],children:(0,m.jsx)(f1.Avatar,{size:24,src:t.image||null,username:t.username,ringColor:t.color})})}var hS=e.i(625251),hI=e.i(183462),hC=e.i(987143),hk=e.i(825516);function hE(){var e=(0,y._)(["\n  fragment WorkspaceHeaderNavMenuRepl on Repl {\n    id\n    org {\n      id\n      slug\n    }\n    ...ReplEnvironmentHeaderInviteButtonRepl\n  }\n  ","\n"]);return hE=function(){return e},e}function hT(){var e=(0,y._)(["\n  fragment WorkspaceHeaderNavMenuCurrentUser on CurrentUser {\n    id\n    isMemberOfAnyOrg\n    image\n    username\n    ...UserLinkCurrentUser\n    ...OrgSwitcherCurrentUser\n  }\n  ","\n  ","\n"]);return hT=function(){return e},e}function hP(){var e=(0,y._)(["\n  query WorkspaceHeaderNavMenu($replId: String!) {\n    getRepl(id: $replId) {\n      ... on Repl {\n        ...WorkspaceHeaderNavMenuRepl\n      }\n    }\n    currentUser {\n      ...WorkspaceHeaderNavMenuCurrentUser\n    }\n  }\n  ","\n  ","\n"]);return hP=function(){return e},e}var hR={},hA=(0,w.gql)(hE(),hk.ReplEnvironmentHeaderInviteButtonReplFragmentDoc),hD=(0,w.gql)(hT(),hC.UserLinkCurrentUserFragmentDoc,hI.OrgSwitcherCurrentUserFragmentDoc),hV=(0,w.gql)(hP(),hA,hD),hO=e.i(641555),hF=e.i(548733),hM=e.i(927196),hL=e.i(845411),hG=e.i(410721),hU=e.i(805518),hN=e.i(935267),hB=e.i(429878),hW=e.i(266899),hz=e.i(273929),hH=e.i(495764),hq=e.i(531603),hK=e.i(371816),h$=e.i(995045),hQ=e.i(344718),hY=e.i(841412),hX=e.i(705555),hJ=e.i(988072),hZ=e.i(346606),h0=e.i(144459),h1=e.i(384132);function h2(e){var t,n,r,i=(0,N._)((0,B.useState)(null),2),a=i[0],o=i[1],s=(0,hN.default)().count,l=(0,hG.useReplitStatus)().replitStatus,u=(0,J.useIsInBonsaiWebview)(),c=(0,J.useDoesBonsaiSupportFeature)("simplifiedTabletUI"),d=u&&c,p=(t={variables:{replId:e.replId},skip:d},n=(0,x._)({},hR,t),b.useQuery(hV,n)).data,f=(null==p?void 0:p.getRepl.__typename)==="Repl"?p.getRepl:null,h=null==p?void 0:p.currentUser,g=function(e){var t,n,r,i,a,o,s,l={ssr:!1,fetchPolicy:"cache-and-network",nextFetchPolicy:"cache-first"},u=hH.RECENT_REPLS_SIDEBAR_MENU_COUNT,c=(0,hW.useSidebarRecentReplsQuery)((0,x._)({variables:{count:u},skip:null===e||!!(null==(t=e.org)?void 0:t.id)},l)),d=(0,hW.useSidebarRecentOrgReplsQuery)((0,x._)({variables:{count:u,orgId:null==e||null==(n=e.org)?void 0:n.id},skip:null==e||!(null==e||null==(r=e.org)?void 0:r.id)},l));if(!e)return null;var p=[];return((null==(o=d.data)||null==(a=o.currentUser)||null==(i=a.org)?void 0:i.__typename)==="Org"?p=d.data.currentUser.org.recentRepls.items:(null==(s=c.data)?void 0:s.allRecentRepls)&&(p=c.data.allRecentRepls),(p=p.filter(function(t){return t.id!==e.id}).slice(0,hz.RECENT_REPLS_DISPLAY_COUNT)).length)?p:null}(f);if(d)return(0,m.jsx)(O.View,{clsx:h1.default.emptySpacer});var v=null==f||null==(r=f.org)?void 0:r.slug,y=v?(0,pq.orgLinks)({slug:v}).home:{href:"/home",as:"/~"};return(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)(hM.AgentStatusProvider,{children:(0,m.jsx)(M.NavMenu,{children:h&&f?(0,m.jsxs)(m.Fragment,{children:[(0,m.jsxs)(pZ.Menu,{"aria-label":"Navigation menu",clsx:h1.default.menu,children:[(0,m.jsx)(pZ.MenuItem,{icon:(0,m.jsx)(f3.default,{}),label:"Home",href:y.href,as:y.as}),g?(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)(h3,{repls:g}),(0,m.jsx)(pZ.Separator,{})]}):null,h?(0,m.jsx)(hK.AccountItems,{setActiveModal:function(e){return o({type:e})},currentUser:h,notificationCount:s}):null,(null==h?void 0:h.isMemberOfAnyOrg)?(0,m.jsx)(hJ.TeamsItem,{currentUser:h}):null,(0,m.jsx)(hZ.ThemeItem,{}),(0,m.jsx)(hQ.HelpItem,{setActiveModal:function(e){return o({type:e})},replitStatus:l,children:(0,m.jsx)(h5,{setActiveModal:o})}),"error"===l?(0,m.jsx)(hX.StatusItem,{replitStatus:l}):null,h?(0,m.jsx)(h$.DevCopyUsernameItem,{currentUser:h}):null,(0,m.jsx)(pZ.Separator,{}),(0,m.jsx)(hY.LogoutItem,{})]}),e.showUpsell?(0,m.jsx)(h8,{}):null]}):(0,m.jsx)(dA.default,{})})}),(0,m.jsxs)(aU.Modal,{isOpen:null!==a,onRequestClose:function(){return o(null)},children:[(null==a?void 0:a.type)==="support"?(0,m.jsx)(hq.default,{onRequestClose:function(){return o(null)}}):null,(null==a?void 0:a.type)==="notifications"?(0,m.jsx)(h4,{}):null,(null==a?void 0:a.type)==="referral"?(0,m.jsx)(hF.ReferralLinkModalContent,{trackingContext:"workspace-nav-menu"}):null,(null==a?void 0:a.type)==="feedback"?(0,m.jsx)(hB.AIFeedback,{session:a.session,onClose:function(){return o(null)}}):null]})]})}function h4(){return(0,m.jsxs)(O.View,{gap:12,children:[(0,m.jsx)(a0.Text,{variant:"subheadDefault",children:"Notifications"}),(0,m.jsx)(hU.default,{count:10,loadMore:!0,markAsSeen:!0})]})}function h8(){var e=(0,pi.useIsFreemiumStarterPlanUsersOwnRepl)().isFreemiumStarterPlanUsersOwnRepl,t=(0,pf.useGetAgentFreeUsage)().agentUsage;return e?(0,m.jsx)(O.View,{gap:8,px:8,pt:8,clsx:h1.default.usage,children:(0,m.jsx)(pp,{title:"".concat(s$.AGENT_NAME," usage"),limit:null==t?void 0:t.limit,usage:null==t?void 0:t.usage})}):null}function h3(e){var t=e.repls;return(0,m.jsxs)(hS.MenuSection,{children:[(0,m.jsx)(pZ.MenuHeader,{text:"Recent"}),t.map(function(e){return(0,m.jsx)(h6,{repl:e},e.id)})]})}function h6(e){var t=e.repl,n=(0,uN.useObservable)((0,hL.useReplAgentStatus)(t));return(0,m.jsxs)(pZ.BaseMenuItem,(0,rX._)((0,x._)({textValue:t.title,clsx:h1.default.repl},(0,p4.replLinkProps)(t)),{children:[(0,m.jsxs)(O.View,{align:"center",row:!0,gap:6,grow:!0,shrink:!0,pl:0,children:[(0,m.jsx)(uc.default,{size:20,alt:t.title,iconUrl:t.iconUrl}),(0,m.jsx)(a0.Text,{children:t.title})]}),n&&"Paused"!==n.label?(0,m.jsx)(a0.Text,{variant:"small",color:"dimmer",children:n.label}):null]}),t.id)}function h5(e){var t=(0,pi.useIsFreemiumStarterPlanUsersOwnRepl)().isFreemiumStarterPlanUsersOwnRepl,n=(0,K.useSupportsAgent)(),r=(0,c2.useChatter)(),i=(0,hO.useObservableMemo)(function(){return n?r.sessions.agent.current:r.sessions.chat.open.latest},[r,n]);return!i||t?null:(0,m.jsx)(pZ.MenuItem,{icon:(0,m.jsx)(h0.default,{}),label:"Submit feedback",onAction:function(){return e.setActiveModal({type:"feedback",session:i})}})}function h9(e){var t,n=(t=rn(ia),(0,B.useMemo)(function(){return new em.Multicast(function(e){return e.next(t.current),t.subscribe(function(t){return e.next(t)})})},[t])),r=(0,ev.useCreateObservableAtom)(ir,re()),i=(0,ev.useCreateObservableAtom)(rS,re());return(0,B.useMemo)(function(){var t,a,o;return t={headerWidth:c4.Observable.from(r).select(function(t){return t[e]}),tabHeaderWidth:n.select(function(t){return t[e]}),sidebarWidth:c4.Observable.from(i).select(function(t){return t[e]})},a=null,o=null,new em.Multicast(function(e){return c4.Observable.combine(t.headerWidth,t.tabHeaderWidth,t.sidebarWidth).subscribe(function(t){var n=(0,N._)(t,3),r=n[0],i=n[1],s=n[2];if(null!==r){var l=null===o?null:o-r+10;if(null!==o&&s>o){"large"!==a&&(a="large",e.next("large"));return}if(i<=200&&"small"!==a){a="small",o=r,e.next("small");return}i>200&&"large"!==a&&(null===l||i>200+l)&&(a="large",e.next("large"))}})})},[n,r,i,e])}var h7=e.i(782514),ge=e.i(342571),gt=(0,A.cvarsFrom)("index.module.css",["--z-index","--height"]);function gn(e){var t=rr(ii),n=(0,Y.default)();return(0,dW.default)(function(r){n||t(e,r.width)})}function gr(){var e;return e={},(0,P._)(e,gt.zIndex,ra.zIndexLevels.tiledPane.toString()),(0,P._)(e,gt.height,F.APP_HEADER_HEIGHT+"px"),e}function gi(e){var t=e.repl,n=rt(tG),r=(0,Y.default)();return(0,m.jsxs)(h7.TrackingHierarchyProvider,{hierarchy:{surface:"workspace_header"},children:[r?(0,m.jsx)(O.View,{clsx:ge.default.desktopDragRegion}):null,(0,m.jsx)(ga,{repl:t}),(0,m.jsx)(gs,{repl:t}),n?(0,m.jsx)(gl,{repl:t}):null]})}function ga(e){var t,n,r,i,a,o,s,l,u,c=e.repl,d=aj(),p=(0,lo.default)(d.agentFiletreeOrder),f=gr(),h=ri(t8),g=gn("left"),v=(0,uN.useObservable)(h9("left")),y=(0,dB.useDesignStackVariant)(),w=(s=(i={variables:{replId:(0,aJ.default)()}},a=(0,x._)({},d$,i),o=b.useQuery(dQ,a)).data,l=o.loading,u=o.refetch,{isWebDesignMockup:(null==s||null==(t=s.getRepl)?void 0:t.__typename)==="Repl"&&null!=(r=null==(n=s.getRepl.config)?void 0:n.isWebDesignMockup)&&r,loading:l,refetch:u}).isWebDesignMockup,j=(0,l2.useGlobalModal)().show,_=(0,c2.useChatter)(),S=(0,uN.useObservable)(_.sessions.agent.current),I=(0,dq.useConvertMockupToApp)(null!=S?S:null);return(0,m.jsx)(O.View,{row:!0,align:"center",innerRef:g,style:f,clsx:ge.default.left,children:(0,m.jsxs)(O.View,{px:6,row:!0,align:"center",children:[(0,m.jsx)(R.default,{}),"agent-filetree"!==p?(0,m.jsx)(fT,{}):(0,m.jsx)(dr,{}),(0,m.jsx)(h2,{replId:c.id,showUpsell:"small"===v}),(0,m.jsx)(ft,{hideTitle:"small"===v,repl:c}),(0,m.jsx)(pr,{repl:c,getDesktopLayoutState:h,hideTitle:"small"===v}),y&&w?(0,m.jsx)(aZ.Button,{colorway:"primary",variant:"nofill",text:"Design",onClick:function(){j("MockupToAppModal",{onConvertMockupToApp:I})}}):null,(0,m.jsx)(fm,{}),"small"===v?null:(0,m.jsx)(go,{replUrl:c.url})]})})}function go(e){var t=e.replUrl;return(0,pi.useIsFreemiumStarterPlanUsersOwnRepl)().isFreemiumStarterPlanUsersOwnRepl?(0,m.jsxs)(O.View,{row:!0,gap:4,children:[(0,m.jsx)(pg,{}),(0,m.jsx)(dH.default,{text:"Upgrade",context:"agent_freemium_quota_v2",colorway:"primary",variant:"default",size:"small",redirectPath:t})]}):null}function gs(e){var t,n,r,i,a,o,s=e.repl,l=gn("right"),u=gr(),c=aj(),d=(0,lo.default)(c.agentFiletreeOrder),p=(0,uN.useObservable)(h9("right")),f=s.authorizations.viewPermissions.isAuthorized,h=(null==(o=s.authorizations)||null==(a=o.viewDeploymentConfig)?void 0:a.isAuthorized)&&!s.lesson,g=(0,pa.useActiveUsers)(),v=(t=am(),n=(0,a9.default)().presence,r=(0,ny.useGetActiveFile)(),i=(0,i2.default)(t),(0,B.useCallback)(function(e){var t=e.username,a=e.id,o=n.getFollowedUser();if((null==o?void 0:o.username)===t)return void n.unfollowUser();n.followUser(t);var s=n.getActiveFileForUser(a),l=r();s&&s!==l&&i.current({path:s})},[i,r,n])),x=(0,Y.default)(),y=(0,dz.useIsWindows)();return(0,m.jsx)(O.View,{row:!0,align:"center",style:u,clsx:ge.default.right,innerRef:l,children:(0,m.jsxs)(O.View,{px:6,row:!0,gap:4,align:"center",clsx:(0,P._)({},ge.default.desktopAppWindowsOs,y&&x),children:[(0,m.jsx)(pm,{}),f?(0,m.jsx)(hb,{repl:s,users:g,onAvatarClick:v}):null,h?(0,m.jsx)(pL,{iconOnly:"small"===p}):null,(null==s?void 0:s.lesson)?(0,m.jsx)(fC,{lesson:s.lesson}):null,"agent-filetree"===d?(0,m.jsx)(fT,{flipped:!0}):(0,m.jsx)(dr,{})]})})}function gl(e){var t=e.repl,n=gr();rr(iJ);var r=(0,E.useFlag)({controlName:"flag-agent-debug-info-button"});return(0,m.jsxs)(V.Surface,{row:!0,clsx:ge.default.planningHeader,justify:"space-between",align:"center",px:6,style:n,children:[(0,m.jsxs)(O.View,{row:!0,align:"center",clsx:ge.default.planningHeaderLeft,children:[(0,m.jsx)(R.default,{}),(0,m.jsx)(h2,{showUpsell:!1,replId:t.id}),(0,m.jsx)(a0.Text,{children:t.title})]}),(0,m.jsx)(O.View,{align:"center",justify:"center",clsx:ge.default.planningTimeline,children:(0,m.jsx)(dY.PlanningTimeline,{onBuildClick:void 0})}),r?(0,m.jsx)(gu,{}):null]})}function gu(){var e=(0,c2.useChatter)(),t=(0,uN.useObservable)(e.sessions.agent.current);return t?(0,m.jsx)(dX.AiSessionDebugInfoButton,{sessionId:t.id,sessionType:c1.SessionType.AGENT_SESSION}):null}var gc=e.i(848415),gd=e.i(802088),gp=e.i(516351),gf=e.i(375032),gh=(0,A.cvarsFrom)("Border.module.css",["--header-height","--border-color","--box-shadow","--y-offset"]);let gg=(0,B.memo)(function(e){var t,n=e.paneId,r=(0,ll._)(e,["paneId"]),i=ay(n),a=(0,lo.default)(i.paneType),o=(0,lo.default)(i.border),s=(0,lo.default)(i.isMaximized),l=(0,gp.default)(),u=A.tokens.outlineDefault,c="none",d=0,p=0;switch(o){case"dragging":case"floating":u=A.tokens.outlineDefault,c=A.tokens.shadow2,d=r.headerHeight,p=6}var f=rt((0,X.default)(function(){return(0,ea.atom)(function(e){return e(ta)===n})},[n]));l&&f&&(u=l.color,c="0 0 0 3px ".concat(l.color));var h=(0,N._)((0,B.useState)(!1),2),g=h[0],v=h[1];return((0,gd.useObserver)((0,c9.useAgentIsWorking)(),{next:"webview"===a?v:void 0}),s)?null:(0,m.jsx)(O.View,{style:(t={},(0,P._)(t,gh.headerHeight,"".concat(d,"px")),(0,P._)(t,gh.borderColor,u),(0,P._)(t,gh.boxShadow,c),(0,P._)(t,gh.yOffset,p+"px"),t),clsx:[gf.default.root,(0,P._)({},gf.default.pulse,g)]})});var gm=O.SpecializedView.div,gv=(0,ca.css)([i8.rcss.width("100%"),i8.rcss.position.absolute,i8.rcss.left(0),{cursor:"ns-resize",zIndex:1,":hover":{transform:"scaleY(4)"}}]),gx=(0,ca.css)([i8.rcss.height("100%"),i8.rcss.position.absolute,i8.rcss.top(0),{cursor:"ew-resize",zIndex:1,":hover":{transform:"scaleX(4)"}}]),gy=(0,ca.css)([i8.rcss.position.absolute,{zIndex:2,transform:"scale(2)",":hover":{transform:"scale(4)"}}]);function gw(e){return{transformOrigin:"".concat("topLeft"===e||"bottomLeft"===e?"right":"left"," ").concat("topLeft"===e||"topRight"===e?"bottom":"top")}}var gb={topLeft:(0,ca.css)([i8.rcss.top(0),i8.rcss.left(0),gw("topLeft")]),topRight:(0,ca.css)([i8.rcss.top(0),i8.rcss.right(0),gw("topRight")]),bottomLeft:(0,ca.css)([i8.rcss.bottom(0),i8.rcss.left(0),gw("bottomLeft")]),bottomRight:(0,ca.css)([i8.rcss.bottom(0),i8.rcss.right(0),gw("bottomRight")])};function gj(e){var t=e.edge,n=e.size,r=e.onPointerDown;if("top"===t||"bottom"===t)return(0,m.jsx)(gm,{onPointerDown:r,style:(0,P._)({height:n},t,-n),css:gv});if("right"===t||"left"===t)return(0,m.jsx)(gm,{onPointerDown:r,style:(0,P._)({width:n},t,-n),css:gx});var i="topLeft"===t||"bottomRight"===t?"nwse-resize":"nesw-resize";return(0,m.jsx)(gm,{onPointerDown:r,style:{height:n,width:n,cursor:i},css:[gy,gb[t]]})}var g_=["bottom","right","left","bottomRight","bottomLeft"],gS=(0,B.memo)(function(e){var t=rr(iN);return(0,m.jsx)(m.Fragment,{children:g_.map(function(n){return(0,m.jsx)(gj,{size:8,edge:n,onPointerDown:function(r){(0,ls.measureMouseMove)(r,{start:function(){t({type:"start",paneId:e.paneId,edge:n})},move:function(e){t({type:"update",moveDelta:e.delta})},end:function(){t({type:"end"})}})}},n)})})}),gI=["top","right","left","topRight","topLeft"],gC=(0,B.memo)(function(e){var t=rr(iN);return(0,m.jsx)(m.Fragment,{children:gI.map(function(n){return(0,m.jsx)(gj,{size:8,edge:n,onPointerDown:function(r){(0,ls.measureMouseMove)(r,{start:function(){t({type:"start",paneId:e.paneId,edge:n})},move:function(e){t({type:"update",moveDelta:e.delta})},end:function(){t({type:"end"})}})}},n)})})}),gk={isConnecting:!0,channel:null,context:null};function gE(e){var t=e.container,n=e.service,r=e.name,i=e.skip,a=void 0!==i&&i,o=(0,N._)((0,B.useState)(gk),2),s=o[0],l=o[1];return(0,B.useEffect)(function(){l(gk);var e=!1,i=t.openChannel({service:n,name:r,skip:function(){return a}},function(t){if(!e)return l({context:t.context,channel:t.channel,isConnecting:!1}),function(t){e||l({isConnecting:t.willReconnect,channel:null,context:null})}});return function(){e=!0,i()}},[t,n,r,a]),s}var gT=e.i(259475),gP=e.i(57613),gR=e.i(231927),gA=(0,A.cvarsFrom)("index.module.css",["--transform-x","--transform-y","--scale","--transform-origin-x","--width","--height","--opacity","--interaction-blanket-display","--pointer-events","--user-select","--border-top-left-radius","--border-top-right-radius","--border-gap","--iframe-pointer-events"]),gD=(0,B.memo)(function(e){var t,n,r,i,a,o,s=e.paneId,l=(0,aC.usePaneUIContext)().Content,u=ay(s),c=(0,lo.default)(u.isHidden),d=(0,lo.default)(u.data),p=(0,lo.default)(u.isActive),f=(0,lo.default)(u.isCommitted);(0,ny.usePaneSession)(s,d);var h=(t=a8(),n=rr(rW),r=rr(nU),i=rr(ts),a=rr(np),(0,X.default)(function(){return function(e){switch(e.operation){case"commit":i(s);return;case"open":if(e.floating)return void n(e.pane,{commit:!0,location:"center"});t({pane:e.pane,activate:!0,placement:{type:"after",paneId:s}});return;case"replace":r({paneId:s,pane:e.pane});return;case"remove":a(e.pane.id);return;case"openPip":return;default:(0,dm.default)(e)}}},[i,s,r,a,t,n])),g=(o=gE({container:(0,a9.default)().container,service:"panetracker"}).channel,(0,B.useCallback)(function(e,t){o&&o.send({paneMetricsTracker:{pane:e,flow:t}})},[o]));return(0,m.jsx)(l,{pane:d,options:{paneId:s,isHidden:c,performPaneOperation:h,isActive:p,isCommitted:f,emitPaneMetrics:g}})});let gV=(0,B.memo)(function(e){var t=e.paneId,n=af(),r=function(e){var t,n=e.paneId,r=(0,N._)((0,gc.useDrop)({accept:[nG.FileType.File,gT.DragItems.Pane,gT.DragItems.NewPane],collect:function(e){return{isOver:e.isOver()}},hover:function(e,t){var r=t.getClientOffset();r&&o.drag({pageX:r.x,pageY:r.y,over:n})},drop:function(e,t){var r=t.getClientOffset();if(r){if(e.type===gT.DragItems.Pane)return void o.drop({type:"pane",paneId:e.paneId,pageX:r.x,pageY:r.y,over:n});if("nodes"===e.type){var i=(0,ti.fsNodeToPanes)(e.nodes);i.length>0&&o.drop({type:"newPaneGroup",panes:i,pageX:r.x,pageY:r.y,over:n})}if(e.type===gT.DragItems.NewPane){var a=e.pane;o.drop({type:"newPaneGroup",panes:[a],pageX:r.x,pageY:r.y,over:n})}}}}),2),i=r[0].isOver,a=r[1],o=(t=rr(rl),(0,B.useEffect)(function(){i||t(null)},[i,t]),{drag:rr(iw),drop:rr(ib)});return a}({paneId:t}),i=ay(t),a=(0,lo.default)(i.isActive),o=(0,lo.default)(i.isFloating),s=(0,lo.default)(i.isModal),l=(0,lo.default)(i.paneType),u=(0,Y.default)(),c=(0,dz.useIsMac)(),d=(0,dz.useIsWindows)(),p=(c||d)&&u?F.HEADER_HEIGHT:0,f=(0,B.useRef)(null);(0,tK.useStyleSet)(f,sB(i.properties,i.getTransitionEnabled),function(e){var t,n=e.width,r=e.height,i=e.x,a=e.y,o=e.scale,s=e.opacity;return t={},(0,P._)(t,gA.width,n+"px"),(0,P._)(t,gA.height,r+"px"),(0,P._)(t,gA.transformX,i+"px"),(0,P._)(t,gA.transformY,a+"px"),(0,P._)(t,gA.scale,o.toString()),(0,P._)(t,gA.opacity,s.toString()),t}),(0,tK.useStyleSet)(f,i.transformOriginXAtom,function(e){return(0,P._)({},gA.transformOriginX,e)}),(0,tK.useStyleSet)(f,i.viewportInset,function(e){return{"--fixed-position-offset-x":-e.x+"px","--fixed-position-offset-y":-e.y-p+"px"}}),(0,tK.useStyleSet)(f,i.isHidden,function(e){return(0,P._)({},gA.pointerEvents,e?"none":"auto")}),(0,tK.useStyleSet)(f,i.zIndex,function(e){return{"z-index":e.toString()}}),(0,tK.useStyleSet)(f,i.disableInteractions,function(e){var t;return t={},(0,P._)(t,gA.interactionBlanketDisplay,e?"block":"none"),(0,P._)(t,gA.userSelect,e?"none":"auto"),(0,P._)(t,gA.iframePointerEvents,e?"none":"auto"),t});var h=a?void 0:function(){n(t,{commit:"codeEditor"!==l})},g=(0,ak.useSetPaneElement)(),v=(0,P._)({},gA.borderGap,"".concat(4,"px"));o||(v[gA.borderTopLeftRadius]="".concat(8,"px"),v[gA.borderTopRightRadius]="".concat(8,"px"));var x=(0,oa.useMergeRefs)([f,o?void 0:r],{breadcrumb:"client/replEnvironmentDesktop/Pane/index.tsx:324"}),y=rr(ac),w=(0,lo.default)(i.headerHeight);return(0,m.jsx)(h7.TrackingHierarchyProvider,{hierarchy:{surface:"".concat(l,"_pane")},children:(0,m.jsx)(ak.PaneIdProvider,{value:t,children:(0,m.jsx)(V.Surface,{role:"tabpanel",id:t,"aria-labelledby":"tab-".concat(t),innerRef:x,clsx:gR.default.root,style:v,onMouseEnter:function(){return y(t)},onMouseLeave:function(){return y(null)},children:(0,m.jsxs)(gP.default,{origin:"ErrorBoundary: PaneContainer",bsod:!0,tags:(0,X.default)(function(){return{paneType:l}},[l]),children:[(0,m.jsxs)(O.View,{clsx:gR.default.container,onMouseDown:h,onContextMenu:h,innerRef:function(e){return g(t,e)},style:"agentChat"===l?{overflowX:"hidden"}:void 0,children:[(0,m.jsx)(O.View,{tabIndex:-1}),(0,m.jsx)(gD,{paneId:t})]}),(0,m.jsx)(gg,{headerHeight:w,paneId:t}),o&&!s?(0,m.jsx)(gS,{paneId:t}):null,(0,m.jsx)(O.View,{clsx:gR.default.interactionBlanket})]},t)})})})});var gO=e.i(822243);(0,ro.cssRecord)({handle:[i8.rcss.minWidth(16),i8.rcss.height("100%")]});var gF=e.i(112077),gM=e.i(33171),gL=(0,A.cvarsFrom)("Tab.module.css",["--width","--x","--color","--bg","--font-style"]);function gG(e){var t;return t={},(0,P._)(t,gL.width,e.width+"px"),(0,P._)(t,gL.x,e.x+"px"),(0,P._)(t,gL.bg,e.active?A.tokens.surfaceBackground:""),(0,P._)(t,gL.color,e.active?A.tokens.foregroundDefault:""),t}function gU(e){var t=e.layout,n=e.paneId,r=e.paneGroupId,i=ad(n),a=(0,B.useMemo)(function(){return t.tab(n)},[t,n]),o=(0,B.useRef)(null),s=ay(e.paneId),l=(0,uN.useObservable)(s.isCommitted),u=(0,ny.useUniquePath)((0,ti.isFilePane)(i)?i.data.path:null),c=(A=(R={paneId:n,paneGroupId:r}).paneId,D=R.paneGroupId,F=(0,ak.useGetPaneBindings)(),M=ap(),L=cR({paneId:A}),G=cm({paneId:A,paneGroupId:D}),U=cv(),W=(0,aC.usePaneUIContext)(),(0,B.useCallback)(function(){var e=M(A).pane,t=F(A),n=function(e){return!!e&&(void 0===e?"undefined":(0,eV._)(e))==="object"&&"data"in e};return{data:{type:"context",label:"Search actions",icon:(0,m.jsx)(W.Icon,{pane:e})},commands:function(){return[{data:{type:"group",key:"pane-actions"},commands:function(){var e,r;return(null!=(r=null==t||null==(e=t.commands)?void 0:e.flatMap(function(e){return e.commands}))?r:[]).filter(n)}},{data:{type:"group",key:"secondary"},commands:function(){return[U(A),L].concat((0,en._)(G)).filter(n)}}]}}},[F,W,M,A,L,G,U])),d=(0,lS.useContextMenu)().onContextMenu;(0,tK.useStyleSet)(o,sB(a,function(){return!0}),gG);var p=rr(np),f=rr(nW),h=(0,aC.usePaneUIContext)(),g=h.getTitle(i),v=h.Icon({pane:i,size:16}),y=function(){var e=(0,B.useRef)(null),t=(0,B.useRef)(!1),n=(0,gF.useCreateObservable)(!1);function r(){var r=e.current;if(r){var i=r.scrollWidth>r.clientWidth;n.set(i),t.current=!1}}var i=(0,dW.default)(function(){t.current||(t.current=!0,requestAnimationFrame(r))});return{state:n,ref:(0,oa.useMergeRefs)([e,i])}}(),w=(0,uN.useObservable)(y.state),b=void 0;(0,ti.isFilePane)(i)&&i.data.path?b=i.data.path:w&&(b=g);var j=!l&&"commands"!==i.type,_=rr(ts),S=(0,c0.useObservableRef)(s.isActive),I=function(){S.current&&!l?_(n):f(n)},C=(z=e.paneId,H=e.layout,K=(q=(0,N._)((0,gO.useDrag)({type:gT.DragItems.Pane,item:function(){return{type:gT.DragItems.Pane,paneId:z,width:80}},end:function(){H.dragState.set(null)},collect:function(e){var t=e.getItem();return{isActive:(null==t?void 0:t.paneId)===z,isDragging:e.isDragging()}}}),2))[0],$=q[1],Q=rr(n$),Y=K.isDragging,X=K.isActive,(0,B.useEffect)(function(){Q(Y)},[Q,Y]),(0,B.useEffect)(function(){H.dragState.set(X?{id:z}:null)},[H,X,z]),{dragRef:$}).dragRef,k=(0,oa.useMergeRefs)([o,e.isOnlyTab?void 0:C]),E=(0,c0.useObservableRef)(t.state),T=(0,B.useRef)(null);if(null===T.current){var R,A,D,F,M,L,G,U,W,z,H,q,K,$,Q,Y,X,J,Z=null==(J=E.current)?void 0:J.tabs.get(n);Z&&(T.current=gG((0,rX._)((0,x._)({},Z),{active:!0})))}return(0,m.jsxs)(V.Surface,{style:(0,x._)((0,P._)({},gL.fontStyle,j?"italic":"inherit"),T.current),onMouseUp:function(e){1===e.button&&(e.preventDefault(),e.stopPropagation(),p(n))},elevated:!0,innerRef:k,align:"center",justify:"center",row:!0,clsx:gM.default.tab,onContextMenu:function(e){return d(e,{command:c()})},children:[(0,m.jsx)(d3.Tooltip,{tooltip:b,delay:"long",placement:"bottom",isDisabled:!b,children:function(e,t){return(0,m.jsxs)(O.View,(0,rX._)((0,x._)({},e),{innerRef:t,pl:6,tag:"button",clsx:gM.default.tabButton,row:!0,grow:!0,shrink:!0,align:"center",gap:6,onClick:I,children:[v,(0,m.jsx)(a0.Text,{ref:u?void 0:y.ref,multiline:!1,clsx:gM.default.title,children:g}),u?(0,m.jsx)(a0.Text,{variant:"small",clsx:gM.default.title,color:"dimmest",multiline:!1,children:u}):null]}))}}),(0,m.jsx)(lz.IconButton,{alt:"Close tab",clsx:gM.default.closeButton,size:28,onClick:function(){return p(n)},children:(0,m.jsx)(cp.default,{size:12})})]})}var gN=e.i(904851),gB=e.i(90659),gW=e.i(790164),gz={newTabButtonWidth:28,defaultTabWidth:160,gap:4},gH=function(){function e(t){var n=this;(0,gN._)(this,e),(0,P._)(this,"containerWidth",new gW.ObservableState(0)),(0,P._)(this,"isHovered",new gW.ObservableState(!1)),(0,P._)(this,"dragState",new gW.ObservableState(null)),(0,P._)(this,"dropState",new gW.ObservableState(null)),(0,P._)(this,"activeId",void 0),(0,P._)(this,"paneIds",void 0),(0,P._)(this,"state",new em.Multicast(function(e){var t=null;return c4.Observable.combine(n.paneIds,n.containerWidth,n.isHovered,n.dragState,n.dropState).subscribe(function(n){var r=(0,N._)(n,5),i=r[0],a=r[1],o=r[2],s=r[3],l=r[4];if(l){var u,c,d=l.item.type===gT.DragItems.Pane?l.item:null,p=d?null==t||null==(c=t.tabs)?void 0:c.get(d.paneId):null;u={xOffset:l.pointer.x,width:p?p.width:gz.defaultTabWidth,id:d?d.paneId:void 0}}var f=function(e){var t,n,r=e.ids,i=e.gap,a=e.containerWidth,o=e.defaultTabWidth,s=e.newTabButtonWidth,l=e.matchWidths,u=e.dropArea,c=e.dragState,d=new Map;if(0===r.length||0===a)return{tabs:d};c?j="own-tab":(null==u?void 0:u.id)&&(j="external");var p=a-s-i,f=r.length;"external"===j&&(f+=1);var h=f-1,g=f*o+h*i<=p?o:(p-h*i)/f,m=l&&r.length<l.size,v=0,x=!0,y=!1,w=void 0;try{for(var b,j,_,S=r[Symbol.iterator]();!(x=(_=S.next()).done);x=!0){var I,C,k=_.value,E=m&&null!=(C=null==l||null==(I=l.get(k))?void 0:I.width)?C:g,T=v+E+i/2;u&&u.xOffset>=v&&u.xOffset<T&&(b={preview:{x:v,width:E},index:d.size},v+=E+i);var P=(null==c?void 0:c.id)===k;d.set(k,{x:v,width:P?0:E}),P||(v+=E+i)}}catch(e){y=!0,w=e}finally{try{x||null==S.return||S.return()}finally{if(y)throw w}}return u&&!b&&(b={preview:{x:v,width:m&&null!=(n=null==l||null==(t=l.get(r[r.length-1]))?void 0:t.width)?n:g},index:d.size}),{tabs:d,dropData:b}}((0,rX._)((0,x._)({containerWidth:a,ids:i,matchWidths:o&&t?t.tabs:void 0},gz),{dropArea:u,dragState:s||void 0}));(0,tu.default)(t,f)||(t=f,e.next(f))})})),(0,P._)(this,"dropIndex",new em.Multicast(function(e){var t=null;return n.state.subscribe(function(n){var r,i,a=null!=(i=null==(r=n.dropData)?void 0:r.index)?i:null;a!==t&&(t=a,e.next(a))})})),(0,P._)(this,"setContainerWidth",function(e){n.containerWidth.set(e)}),(0,P._)(this,"tabs",new em.Multicast(function(e){return n.state.select(function(e){return e?Array.from(e.tabs.keys()):[]}).subscribe(e)})),(0,P._)(this,"newTab",new em.Multicast(function(e){var t=null;return n.state.subscribe(function(n){var r,i=Array.from(n.tabs.keys()).pop(),a=i?n.tabs.get(i):null;if(a){var o={x:a.x+a.width+4,width:28,visible:!n.dropData};n.dropData&&(null==(r=n.dropData)?void 0:r.index)>=n.tabs.size&&(o.x+=n.dropData.preview.width+4),(0,tu.default)(t,o)||(t=o,e.next(o))}})})),(0,P._)(this,"dropPreview",new em.Multicast(function(e){var t=null;return n.state.subscribe(function(n){var r,i,a=null!=(i=null==(r=n.dropData)?void 0:r.preview)?i:null;(0,tu.default)(t,a)||(t=a,e.next(a))})})),(0,P._)(this,"width",new em.Multicast(function(e){return n.containerWidth.subscribe(e)})),this.paneIds=t.paneIds,this.activeId=t.activeId}return(0,gB._)(e,[{key:"tab",value:function(e){var t=this;return new em.Multicast(function(n){var r=null;return c4.Observable.combine(t.state,t.activeId,t.dropState).subscribe(function(t){var i,a,o=(0,N._)(t,3),s=o[0],l=o[1],u=o[2],c=s.tabs.get(e);if(c){var d=(0,rX._)((0,x._)({},c),{active:l===e,isBeingDragged:(null==u||null==(i=u.item)?void 0:i.type)===gT.DragItems.Pane&&(null==u||null==(a=u.item)?void 0:a.paneId)===e});(0,tu.default)(r,d)||(r=d,n.next(d))}})})}}]),e}(),gq=e.i(13891),gK=(0,A.cvarsFrom)("index.module.css",["--new-tab-width","--new-tab-x","--drop-preview-width","--drop-preview-x","--drop-preview-opacity"]),g$=(0,B.memo)(function(e){var t,n,r,i,a,o,s,l,u,c,d,p,f,h,g,v,x,y,w,b,j,_=ax(e.headerId),S=(0,B.useMemo)(function(){return new gH({paneIds:c4.Observable.from(_.panes),activeId:c4.Observable.from(_.activeTabPaneId)})},[_.panes,_.activeTabPaneId]),I=(0,uN.useObservable)(S.tabs),C=(0,dW.default)(function(e){return S.setContainerWidth(e.width)},{type:"debounce",wait:100}),k=rr(nM),E=(null==I?void 0:I.length)===1,T=(0,lo.default)(_.activeTabPaneId),A=(n=(t={paneGroupId:e.headerId,activeTabPaneId:T}).paneGroupId,r=t.activeTabPaneId,a=(i=function(e){var t=e.paneGroupId,n=rr(r4),r=rr(r8),i=rr(r5),a=(0,X.default)(function(){return{start:function(e){n({paneGroupId:t,mouse:e.mouse})},update:function(e){r(e)},end:function(e){i(e)}}},[t,n,r,i]);return{isDragging:rt((0,X.default)(function(){return(0,ea.atom)(function(e){var n;return t===(null==(n=e(r0))?void 0:n.paneGroupId)})},[t])),dnd:a}}({paneGroupId:n})).isDragging,o=i.dnd,s=av().toggleMaximizedPaneGroup,l=aw(n),u=(0,lo.default)(l.isMaximized),c=af(),{dnd:o,cursor:a?"grabbing":"grab",onPointerDown:function(e){c(r),!u&&"button"in e&&0===e.button&&(0,ls.measureMouseMove)(e,{start:o.start,move:o.update,end:o.end})},toggleMaximizedPaneGroup:s,isMaximized:u}),D=A.cursor,V=A.onPointerDown,F=A.toggleMaximizedPaneGroup,M=A.isMaximized,L=(0,B.useRef)(null),G=(d=e.headerId,p=(0,B.useRef)(null),f=(0,c0.useObservableRef)(S.dropIndex),h=rr(nM),g=rr(nq),v=ax(d),x=(0,lo.default)(v.panes),y=(0,B.useCallback)(function(e,t){var n=(null==t?void 0:t.index)!==null?null==t?void 0:t.index:x.length;if("nodes"===e.type){var r=(0,ti.fsNodeToPanes)(e.nodes);r.length>0&&h({activate:!0,commit:!0,paneGroupId:d,index:n,panes:r});return}if(e.type===gT.DragItems.NewPane)return void h({activate:!0,paneGroupId:d,index:n,panes:[e.pane]});if("paneId"in e){var i=x.includes(e.paneId)?x.length-1:x.length;g({paneId:e.paneId,index:void 0!==n&&n<i?n:i,toPaneGroupId:d})}},[h,g,d,x]),b=(w=(0,N._)((0,gc.useDrop)({accept:[nG.FileType.File,gT.DragItems.Pane,gT.DragItems.NewPane],hover:function(e,t){var n=t.getClientOffset(),r=n&&p.current?{x:n.x-p.current.x,y:n.y-p.current.y}:{x:0,y:0};S.dropState.set({item:e,pointer:r})},collect:function(e){var t,n;return p.current=null!=(n=null==(t=L.current)?void 0:t.getBoundingClientRect())?n:null,{isOver:e.isOver()}},drop:function(e,t){var n,r=null!=(n=f.current)?n:null;S.dropState.set(null),t.didDrop()||y(e,null!==r?{index:r}:null)}}),2))[0].isOver,j=w[1],(0,B.useEffect)(function(){b||S.dropState.set(null)},[b,S]),{dropRef:j}).dropRef,U=(0,oa.useMergeRefs)([C,L,G]),W=(0,Y.default)(),z=(0,dz.useIsWindows)();return(0,m.jsxs)(O.View,{row:!0,grow:!0,shrink:!0,align:"start",clsx:gq.default.tabBar,children:[M?(0,m.jsx)(R.default,{}):null,(0,m.jsxs)(O.View,{grow:!0,shrink:!0,row:!0,clsx:gq.default.tabs,innerRef:U,onMouseEnter:function(){return S.isHovered.set(!0)},onMouseLeave:function(){return S.isHovered.set(!1)},onPointerDown:E&&!M?V:void 0,children:[(0,m.jsx)(gQ,{paneGroupId:e.headerId,activeTabPaneId:T,isMaximized:M,toggleMaximizedPaneGroup:F,cursor:D,onPointerDown:E?void 0:V}),(0,m.jsx)(gX,{layout:S}),null==I?void 0:I.map(function(t){return(0,m.jsx)(gU,{paneGroupId:e.headerId,paneId:t,layout:S,isOnlyTab:E},t)}),(0,m.jsx)(gY,{layout:S,onClick:function(){return k({paneGroupId:e.headerId,activate:!0,panes:[{type:"commands",data:{autoFocus:!0}}]})}})]}),M?(0,m.jsx)(lz.IconButton,{clsx:(0,P._)({},gq.default.desktopAppWindowsOs,z&&W),size:28,alt:"Minimize",onClick:function(){return F({paneGroupId:e.headerId})},children:(0,m.jsx)(cI.default,{})}):null]})});function gQ(e){var t=e.paneGroupId,n=e.activeTabPaneId,r=e.toggleMaximizedPaneGroup,i=e.isMaximized,a=e.cursor,o=e.onPointerDown,s=ck({paneId:n,paneGroupId:t}),l=(0,lS.useContextMenu)().onContextMenu;return(0,m.jsx)(O.View,{onContextMenu:function(e){return l(e,{command:s})},onDoubleClick:function(){r({paneGroupId:t})},title:i?"Double click to restore.":"Double click to maximize. Drag to move.",clsx:gq.default.dragArea,style:{cursor:i?void 0:a},onPointerDown:o})}function gY(e){var t,n=e.layout,r=(0,B.useRef)(null),i=rt(a_),a=(0,sW.useSetTourStepTarget)(la,s6.NewTab);(0,tK.useStyleSet)(r,n.newTab,function(e){var t;return t={},(0,P._)(t,gK.newTabWidth,e.width+"px"),(0,P._)(t,gK.newTabX,e.x+"px"),(0,P._)(t,"opacity",e.visible?"1":"0"),t});var o={isDragging:(t=(0,N._)((0,gO.useDrag)({type:gT.DragItems.NewPane,item:function(){return{type:gT.DragItems.NewPane,pane:{type:"commands",data:{autoFocus:!0}},width:80}},collect:function(e){return{isDragging:e.isDragging()}}}),2))[0].isDragging,dragRef:t[1]},s=o.dragRef,l=o.isDragging,u=(0,oa.useMergeRefs)([r,a,s]),c=(0,hO.useObservableMemo)(function(){return n.width.select(function(e){return e>320})},[n]),d="Tools & files";return(0,m.jsx)(O.View,{innerRef:u,clsx:gq.default.newTab,children:l?null:(0,m.jsx)(m.Fragment,{children:i&&c?(0,m.jsx)(aZ.Button,{clsx:gq.default.newTabTextButton,onClick:e.onClick,variant:"nofill",iconLeft:(0,m.jsx)(sI.default,{}),text:d,style:{width:160}}):(0,m.jsx)(lz.IconButton,{clsx:gq.default.newTabIconButton,size:28,alt:d,onClick:e.onClick,children:(0,m.jsx)(sI.default,{})})})})}function gX(e){var t=e.layout,n=(0,B.useRef)(null);return(0,tK.useStyleSet)(n,t.dropPreview,function(e){var t;return t={},(0,P._)(t,gK.dropPreviewWidth,(e?e.width:80)+"px"),(0,P._)(t,gK.dropPreviewX,(e?e.x:"50%")+"px"),(0,P._)(t,gK.dropPreviewOpacity,e?"1":"0"),t}),(0,m.jsx)(O.View,{innerRef:n,clsx:gq.default.dropPreview})}var gJ=e.i(248611),gZ=(0,A.cvarsFrom)("index.module.css",["--left","--top","--scale","--transform-origin-x","--width","--height","--z-index","--transform-x","--transform-y","--border-radius","--controls-opacity","--opacity","--padding-left","--padding-top"]);let g0=(0,B.memo)(function(e){var t,n=e.headerId,r=ax(n),i=(0,lo.default)(r.activeTabPaneId),a=aw(n),o=(0,lo.default)(a.isFloating),s=(0,lo.default)(a.isBeingDragged),l=(0,lo.default)(a.isModal),u=(0,lo.default)(a.isMaximized),c=(0,B.useRef)(null);(0,tK.useStyleSet)(c,sB(a.properties,a.getTransitionEnabled),function(e){var t,n,r,i=e.width,a=e.height,o=e.x,s=e.y,l=e.scale,u=e.opacity,c=e.positioning;return(0,x._)((t={},(0,P._)(t,gZ.width,i+"px"),(0,P._)(t,gZ.height,a+"px"),(0,P._)(t,gZ.scale,l.toString()),(0,P._)(t,gZ.opacity,u.toString()),t),"transform"===c?(n={},(0,P._)(n,gZ.transformX,Math.round(o)+"px"),(0,P._)(n,gZ.transformY,Math.round(s)+"px"),(0,P._)(n,gZ.top,"0px"),(0,P._)(n,gZ.left,"0px"),n):(r={},(0,P._)(r,gZ.transformX,"0px"),(0,P._)(r,gZ.transformY,"0px"),(0,P._)(r,gZ.top,Math.round(s)+"px"),(0,P._)(r,gZ.left,Math.round(o)+"px"),r))}),(0,tK.useStyleSet)(c,a.transformOriginX,function(e){return(0,P._)({},gZ.transformOriginX,e)}),(0,tK.useStyleSet)(c,a.zIndex,function(e){return{"z-index":e.toString()}});var d=rr(ac);return(0,tK.useStyleSet)(c,rn((0,B.useMemo)(function(){return(0,ea.atom)(function(e){return e(ac)===i})},[i])),function(e){return(0,P._)({},gZ.controlsOpacity,e?"1":"0")}),(0,m.jsxs)(V.Surface,{innerRef:c,clsx:gJ.default.surface,row:!0,align:"center",style:(t={},(0,P._)(t,gZ.borderRadius,"8px"),(0,P._)(t,gZ.paddingTop,(!u&&o?6:0)+"px"),(0,P._)(t,gZ.paddingLeft,(u||s||o?6:0)+"px"),t),onMouseEnter:function(){return d(i)},onMouseLeave:function(){return d(null)},children:[(0,m.jsx)(g$,{headerId:n}),o&&!l?(0,m.jsx)(gC,{paneId:i}):null]})});function g1(){var e=ah(),t=(0,B.useCallback)(function(t){return e({pane:t})},[e]),n=ri(t_),r=rr(np);return(0,B.useCallback)(function(e){var i=ti.STACK_TO_OUTPUT_PANE_MAP[e];i&&(t({type:i}),n().forEach(function(e){var t=(0,N._)(e,2),n=t[0],a=t[1];"agentChat"!==a.type&&a.type!==i&&r(n)}))},[t,n,r])}var g2=e.i(391119),g4=e.i(700966),g8=e.i(716636),g3=e.i(398014),g6={Content:function(e){var t,n=(0,N._)((0,B.useState)(null),2),r=n[0],i=n[1];(0,ak.useSetFocusTarget)(function(){return r},[r]),(0,ak.useSetPaneBindings)(function(){return{type:"agentChat",focusInput:function(){return null==r?void 0:r.focus()}}},[r]);var a=e.options.performPaneOperation,o=(0,B.useCallback)(function(e){return a({operation:"open",pane:e,secondary:"ghostwriterChat"!==e.type})},[a]),s=g1(),l=(0,B.useCallback)(function(e){a({operation:"openPip",data:e})},[a]),u=(0,g2.useCurrentSession)(null==(t=e.pane.data)?void 0:t.sessionId),c=u.session,d=u.setSession,p=(0,B.useCallback)(function(e){a({operation:"replace",pane:{type:"agentChat",data:{sessionId:e.id}}}),d(e)},[a,d]),f=rt(tG),h=rr(iJ),g=rt(iZ),v=(0,a9.default)(),x=v.secrets,y=v.fs;return(0,m.jsx)(g4.AgentMain,{secrets:x,readFile:y.readFile,session:c,setSession:p,inputRef:i,openPane:o,onPlanApproval:function(e){e&&s(e),h("sidebar")},isDesktopOrTabletAgentPresentationCentered:f,isDesktopLayoutAgentPresentationTransitionInProgress:g,openPip:l})},Icon:function(e){var t=e.size;return(0,m.jsx)(c7.AgentAvatar,{size:t})},getTitle:function(){return"Agent"},description:s$.AGENT_DESCRIPTION,category:g8.PaneCategory.WorkspaceFeatures,decode:function(e){return sn.Value.Decode(g3.AgentChatPaneSchema,e)}},g5=e.i(795564),g9={Content:function(e){var t=e.options,n=t.performPaneOperation,r=t.paneId,i=e.pane.data.autoFocus,a=rr(ts),o=(0,B.useRef)(null);(0,ak.useSetFocusTarget)(function(){return{focus:function(){var e;return null==(e=o.current)?void 0:e.call(o)}}},[]);var s=(0,B.useCallback)(function(e){n({operation:"replace",pane:e.pane}),a(r),(0,es.track)(el.events.TOOL_OPENED,{source:"New Tab",tool:e.pane.type})},[n,r,a]),l=u$({currentPaneId:r,openPane:s});return(0,m.jsx)(O.View,{pt:16,grow:!0,shrink:!0,children:(0,m.jsx)(aN.CommandBar,{autoFocus:i,command:l,focusRef:o,showToolDescriptions:!0})})},Icon:function(){return null},getTitle:function(){return"New tab"},category:g8.PaneCategory.Other,decode:g5.decode},g7=e.i(827836),me=e.i(818283),mt=e.i(999519),mn={Content:function(e){var t=e.options,n=t.paneId,r=t.performPaneOperation,i=e.pane.flow,a=ab(),o=a.isOpen,s=a.toggle,l=(0,B.useCallback)(function(){o.current||s()},[o,s]);return(0,m.jsx)(me.default,{flow:i,closeConfigPane:function(){return r({operation:"remove",pane:{id:n}})},useReadFile:g7.default,openSidebar:l,onNewPaneSelected:function(e){return r({operation:"open",pane:e})},openConsole:function(){return r({operation:"open",pane:{type:"runnerOutput"}})}})},Icon:function(){return(0,m.jsx)(uP.default,{})},getTitle:function(){return"Configure Repl"},category:g8.PaneCategory.WorkspaceFeatures,decode:mt.decode},mr=e.i(746382),mi=(0,ca.css)([i8.rcss.backgroundColor.backgroundDefault,i8.rcss.height("100%"),i8.rcss.borderRadius(4),{overflow:"hidden"}]),ma=(0,ca.css)([i8.rcss.width("100%"),i8.rcss.height("100%"),i8.rcss.justify.center,i8.rcss.align.center,i8.rcss.display.flex]);function mo(e){var t=e.paneId,n=e.extensionPaneData,r=e.environmentAPIs,i=(0,a7.useExtensionByInstallationId)(n.installationId),a=(0,a7.useExtensionStateAtom)(n.installationId),o=sw({extension:i,environmentAPIs:r,sandboxTitle:n.name,sandboxUrl:(0,on.getAssetUrl)(n.baseUrl,n.path),paneId:t,filePath:n.filePath||null}),s=o.didConnectOnce,l=o.isValidExtensionPaneUrl,u=o.getIframeProps,c=o.reloadSandbox;return(0,ak.useSetPaneBindings)(function(){return{type:"extension",commands:[{name:"Actions",commands:[{match:aS.matchLabel,data:{icon:(0,m.jsx)(u6.default,{}),label:"Refresh",type:"action",description:"Refresh extension",key:"refresh",run:function(){c()}}}]}]}},[c]),(0,m.jsx)(O.View,{className:"extension-pane",css:mi,children:a&&s?(0,m.jsx)(m.Fragment,{children:l()?(0,m.jsx)("iframe",(0,x._)({},u({css:{width:"100%",height:"100%",border:"none"}}))):(0,m.jsx)(O.View,{p:12,children:(0,m.jsxs)(a0.Text,{children:["Invalid url:"," ",(0,m.jsx)(mr.InlineCode,{children:n.baseUrl+n.path}),". Please contact the extension author, or Replit support."]})})}):(0,m.jsx)(O.View,{css:ma,children:(0,m.jsx)(dA.default,{})})})}var ms=ex.Type.Object({extensionId:ex.Type.Unsafe(ex.Type.String()),installationId:ex.Type.Unsafe(ex.Type.String()),baseUrl:ex.Type.String(),path:ex.Type.String(),name:ex.Type.String(),filePath:ex.Type.Optional(ex.Type.Union([ex.Type.String(),ex.Type.Null(),ex.Type.Undefined()])),icon:ex.Type.Optional(ex.Type.Union([ex.Type.String(),ex.Type.Null(),ex.Type.Undefined()]))}),ml=ex.Type.Object({type:ex.Type.Literal("extension"),data:ms}),mu={Content:function(e){var t=e.pane,n=e.options,r=a6();return(0,m.jsx)(mo,{extensionPaneData:t.data,paneId:n.paneId,environmentAPIs:r})},Icon:function(e){var t=e.pane,n=e.size;return t.data.icon?(0,m.jsx)(O.View,{style:{width:n,height:n,position:"relative"},children:(0,m.jsx)(lF.default,{src:(0,on.getAssetUrl)(t.data.baseUrl,t.data.icon),layout:"fill",alt:""})}):(0,m.jsx)(sC.default,{size:n})},getTitle:function(e){return e.data.filePath?e.data.filePath+"  "+e.data.name:e.data.name},category:g8.PaneCategory.WorkspaceExtensions,decode:function(e){return sn.Value.Decode(ml,e)}},mc=e.i(144494),md=e.i(915793),mp=e.i(328751),mf=e.i(198769),mh=e.i(904678);function mg(){var e=(0,y._)(["\n  query ExtensionOwnerDetails($extensionId: String!) {\n    extension(id: $extensionId) {\n      ... on Extension {\n        id\n        isListed\n        user {\n          id\n          username\n        }\n      }\n      ... on NotFoundError {\n        message\n      }\n    }\n  }\n"]);return mg=function(){return e},e}function mm(){var e=(0,y._)(["\n  query currentExtensionStatus($id: String!) {\n    extension(id: $id) {\n      ... on Extension {\n        id\n        isListed\n        user {\n          id\n        }\n      }\n    }\n  }\n"]);return mm=function(){return e},e}var mv={};(0,w.gql)(mg());var mx=(0,w.gql)(mm()),my=e.i(888136),mw=e.i(428596),mb=e.i(607278),mj=e.i(363201),m_=(0,ro.cssRecord)({codeBlock:[i8.rcss.borderRadius(8),i8.rcss.position.relative],codeBlockCopyButton:[i8.rcss.position.absolute,i8.rcss.top(4),i8.rcss.right(4)],selectionContainer:[i8.rcss.maxHeight(400),i8.rcss.overflowY("scroll")],fsNode:[i8.rcss.flex.row,i8.rcss.rowWithGap(8),i8.rcss.align.center,i8.rcss.px(4),i8.rcss.py(2),i8.rcss.borderRadius(8),i8.rcss.cursor.pointer],fsNodeActive:[i8.rcss.backgroundColor.backgroundHigher]});function mS(e){var t=e.content,n=(0,a4.default)().showConfirm;return(0,m.jsxs)(V.Surface,{tag:"code",elevated:!0,css:m_.codeBlock,p:8,children:[t,(0,m.jsx)(lz.IconButton,{alt:"Copy",tooltipBehavior:"hidden",css:m_.codeBlockCopyButton,onClick:function(){return navigator.clipboard.writeText(t).then(function(){return n("Copied")})},children:(0,m.jsx)(u1.default,{})})]})}function mI(e){var t,n=e.glob,r=e.openFile,i=e.children,a=(0,N._)((0,B.useState)([]),2),o=a[0],s=a[1],l=(0,N._)((0,B.useState)(""),2),u=l[0],c=l[1],d=(0,mw.useIdSeed)(),p=(0,a9.default)().fs,f=(0,sj.useStaticDirectoryPath)(),h=(0,B.useMemo)(function(){return(0,lP.globToRegExp)(n)},[n]);return((0,B.useEffect)(function(){h&&p.listFiles().then(function(e){e.files&&s(e.files.filter(function(e){return e.match(h)}).map(function(e){var t=e.split("/");return{path:e,dir:t.slice(0,t.length-1).join("/"),filename:t[t.length-1]||""}}))})},[h,f]),h)?(0,m.jsxs)(O.View,{css:m_.selectionContainer,gap:16,children:[(0,m.jsx)(a0.Text,{variant:"subheadDefault",children:(0,m.jsxs)(O.View,{gap:12,children:[(0,m.jsx)(a0.Text,{variant:"subheadDefault",children:"Choose an image"}),f?(0,m.jsx)(f2.StatusBanner,{icon:(0,m.jsx)(mj.default,{}),colorway:"primary",text:(0,m.jsxs)(O.View,{gap:2,children:[(0,m.jsxs)(a0.Text,{children:["Images must be served from"," ",(0,m.jsx)("span",{css:[i8.rcss.font.code,i8.rcss.backgroundColor.accentPrimaryDimmer,i8.rcss.borderRadius(4),i8.rcss.px(4),i8.rcss.py(2),i8.rcss.mr(2),i8.rcss.border({color:A.tokens.accentPrimaryDefault})],children:f.path}),"."]}),(0,m.jsx)(a0.Text,{css:[i8.rcss.fontWeight.normal],children:"You can change your extension's static directory in the .replit file."})]})}):null,(0,m.jsxs)(a0.Text,{css:[i8.rcss.fontWeight.normal],color:"dimmer",children:["Supported file types:"," ",(0,m.jsx)("span",{css:[i8.rcss.font.code,i8.rcss.fontSize("small"),i8.rcss.backgroundColor.backgroundHigher,i8.rcss.borderRadius(4),i8.rcss.px(4),i8.rcss.py(2),i8.rcss.mr(2),i8.rcss.border({color:A.tokens.outlineDefault})],children:null==(t=n.match(/\{(.*)\}/))?void 0:t[1].split(",").map(function(e){return e.replace(".","")}).join(", ")})]})]})}),i,(0,m.jsx)(my.default,{onChange:function(e){return r(e.path)},initialHighlightedIndex:0,defaultHighlightedIndex:0,itemToString:function(e){return(null==e?void 0:e.path)||""},children:function(e){var t=e.getInputProps,r=e.getItemProps,i=e.highlightedIndex,a=e.getRootProps,s=e.getMenuProps;return(0,m.jsxs)(O.View,(0,rX._)((0,x._)({},a({refKey:"innerRef"})),{gap:16,children:[(0,m.jsx)(O.View,{css:[i8.rcss.position.relative],children:(0,m.jsx)(mb.Input,(0,x._)({id:d("file-search")},t({ref:null,value:u,onChange:function(e){return c(e.currentTarget.value)},placeholder:"Find a file",autoComplete:"off",autoFocus:!0})))}),(0,m.jsx)(O.View,{children:o&&o.length?(0,m.jsx)(O.View,(0,rX._)((0,x._)({elevated:!0,tag:"ul",css:(i8.rcss.pt(8),i8.rcss.colWithGap(8))},s({refKey:"innerRef"})),{children:o.filter(function(e){return e.path.includes(u)}).filter(function(e){return!f||e.path.startsWith(f.relativePath)||e.path.startsWith("public")}).map(function(e,t){return(0,m.jsxs)(O.View,(0,rX._)((0,x._)({tag:"li",css:[m_.fsNode,t===i&&m_.fsNodeActive]},r({item:e,index:t,disabled:!!f&&!e.path.startsWith(f.relativePath)})),{children:[(0,m.jsx)(uq.default,{path:e.path,size:16}),(0,m.jsx)(a0.Text,{children:e.filename}),(0,m.jsx)(a0.Text,{variant:"small",color:"dimmest",children:e.dir})]}),t)})})):(0,m.jsx)(O.View,{pt:8,children:(0,m.jsx)(a0.Text,{color:"dimmer",children:(0,m.jsxs)("em",{children:["No files found matching ",(0,m.jsx)("code",{children:n})]})})})})]}))}})]}):(0,m.jsxs)(O.View,{css:[i8.rcss.flex.column,i8.rcss.colWithGap(16)],children:[(0,m.jsx)(a0.Text,{variant:"subheadDefault",children:"Invalid Glob Pattern"}),(0,m.jsxs)(a0.Text,{children:["The glob pattern ",(0,m.jsx)("code",{children:n})," could not be parsed."]}),(0,m.jsx)(O.View,{css:i8.rcss.border({direction:"bottom",color:A.tokens.backgroundHigher})}),(0,m.jsxs)(O.View,{gap:8,children:[(0,m.jsx)(a0.Text,{children:(0,m.jsx)("strong",{children:"Match all Javascript Files"})}),(0,m.jsx)(mS,{content:"**/*.js"})]}),(0,m.jsxs)(O.View,{gap:8,children:[(0,m.jsx)(a0.Text,{children:(0,m.jsx)("strong",{children:"Match JSON files at root level"})}),(0,m.jsx)(mS,{content:"*.json"})]}),(0,m.jsxs)(O.View,{gap:8,children:[(0,m.jsx)(a0.Text,{children:(0,m.jsx)("strong",{children:"Match specified file extensions"})}),(0,m.jsx)(mS,{content:"**/*.{js,ts,jsx,tsx}"})]})]})}var mC=e.i(549762),mk=e.i(658975),mE=((a=mE||{}).Installing="Installing",a.Loading="Loading",a.Failed="Failed",a.Success="Success",a),mT={Installing:"Installing Extension...",Loading:"Loading Asset...",Failed:"Failed to load asset from Extension URL",Success:"Asset loaded successfully"};function mP(e){var t=e.isOpen,n=e.close,r=e.onSubmit,i=(0,oe.useInstallCurrentReplAsExtension)(),a=(0,oe.useCurrentReplExtension)(),o=(0,N._)((0,B.useState)(null),2),s=o[0],l=o[1],u=(0,N._)((0,B.useState)(!0),2),c=u[0],d=u[1],p=(0,N._)((0,B.useState)(null),2),f=p[0],h=p[1],g=(0,N._)((0,B.useState)(null),2),v=g[0],x=g[1],y=(0,B.useRef)(null),w=(0,N._)((0,B.useState)(null),2),b=w[0],j=w[1],_=(0,N._)((0,B.useState)(null),2),S=_[0],I=_[1],C=(v||S||"").startsWith("/")?v||S:"/"+(v||S),k=(0,N._)((0,B.useState)(null),2),E=k[0],T=k[1],P=function(){I(null),l(null),x(null),j(null),T(null),h(null)},R=function(){d(!0),l(null)};(0,B.useEffect)(function(){x(S)},[S]);var A=(0,B.useCallback)(function(e){return(0,er._)(function(){var t,n,r,o;return(0,ei._)(this,function(u){switch(u.label){case 0:if(!C||!c||"Success"===s||"Failed"===s)return[2];if(t=function(e,t){return(0,er._)(function(){var n;return(0,ei._)(this,function(r){switch(r.label){case 0:return l("Loading"),h(n=(0,on.getAssetUrl)(e.baseUrl,t)),[4,fetch(n)];case 1:if(r.sent().ok)return T(t),l("Success"),d(!1),[2,!0];return[2,!1]}})})()},n=e||a)return[3,8];l("Installing"),u.label=1;case 1:return u.trys.push([1,5,,8]),[4,i()];case 2:if(!(r=u.sent()))return[3,4];return[4,A(r)];case 3:case 6:return u.sent(),[2];case 4:case 7:return[3,8];case 5:if(u.sent(),!a)return[3,7];return[4,A(a)];case 8:if(!n)return[3,11];return o=C.replace(/^(\/public|\/static)/,""),[4,t(n,o.slice(1))];case 9:if(u.sent())return[3,11];return[4,t(n,C)];case 10:u.sent(),u.label=11;case 11:return[2]}})})()},[a,C,i,s,c]);(0,B.useEffect)(function(){if(b){var e=b.split("/"),t=e.pop(),n=e.findIndex(function(e){return["public","static"].includes(e)});I((-1!==n?"/".concat(b):"/".concat(e.slice(n+1).join("/"),"/").concat(t))||b),d(!0),A()}},[A,b]);var D=b?b.split("/"):[],V=D[D.length-1];return(0,m.jsx)(aU.Modal,{isOpen:t,onRequestClose:n,children:b?(0,m.jsxs)(O.View,{css:[i8.rcss.flex.column,i8.rcss.colWithGap(16)],children:[(0,m.jsxs)(O.View,{row:!0,gap:8,align:"center",children:[(0,m.jsx)(aZ.Button,{text:"Back",size:"small",iconLeft:(0,m.jsx)(mC.default,{}),onClick:function(){j(null),P()}}),(0,m.jsxs)(O.View,{row:!0,gap:4,align:"center",children:[(0,m.jsx)(mk.default,{}),(0,m.jsx)(a0.Text,{color:"dimmer",children:V||""})]})]}),(0,m.jsx)(a0.Text,{multiline:!0,children:"Extension assets should be stored in the public asset directory. Move the image or modify the file path, or try again."}),(0,m.jsxs)(O.View,{gap:4,children:[(0,m.jsx)(mb.Input,{defaultValue:v||"",ref:y,placeholder:"/icon.png",onChange:function(e){return x(e.target.value)},autoFocus:!0,disabled:"Loading"===s||"Installing"===s||"Success"===s}),f&&("Loading"===s||"Success"===s||"Failed"===s)?(0,m.jsx)("a",{href:f,target:"_blank",children:(0,m.jsxs)(a0.Text,{color:"dimmer",variant:"small",css:[i8.rcss.rowWithGap(4),i8.rcss.display.flex,{fontStyle:"italic"}],children:[(0,m.jsxs)("span",{css:[i8.rcss.truncate],children:["Loading"===s?"Checking ":null,"Success"===s?"Found at ":null,"Failed"===s?"Failed to load ":null,f]}),(0,m.jsx)(O.View,{css:[i8.rcss.display.inlineBlock],children:(0,m.jsx)(u2.default,{})})]})}):null]}),(0,m.jsxs)(O.View,{row:!0,justify:"space-between",align:"center",children:[(0,m.jsx)(O.View,{row:!0,gap:4,align:"center",children:s?(0,m.jsx)(m.Fragment,{children:"Loading"===s?(0,m.jsx)(dA.default,{}):(0,m.jsx)(f2.StatusBanner,{text:mT[s],colorway:"Failed"===s?"negative":"positive",icon:"Failed"===s?(0,m.jsx)(fi.default,{}):(0,m.jsx)(p8.default,{})})}):null}),"Failed"===s?(0,m.jsxs)(O.View,{row:!0,gap:8,children:[(0,m.jsx)(aZ.Button,{text:"Add Anyways",onClick:function(){var e=S||b;null!==e&&r(e),P(),n()},size:"small"}),(0,m.jsx)(aZ.Button,{text:"Try Again",onClick:function(){R()},size:"small"})]}):null,E&&"Success"===s?(0,m.jsx)(aZ.Button,{text:"Continue",iconLeft:(0,m.jsx)(p8.default,{}),colorway:"primary",onClick:function(){r(E),P(),n()}}):null]})]}):(0,m.jsx)(mI,{openFile:j,glob:"**/*.{png,jpg,jpeg,webp,svg,gif}"})})}var mR=e.i(283023),mA=e.i(883002),mD=(0,ro.cssRecord)({centerRowGap8:[i8.rcss.rowWithGap(8),i8.rcss.align.center],featureContainer:[i8.rcss.flex.column,i8.rcss.borderRadius(8),{overflow:"hidden"}],noFeaturesPlaceholder:[i8.rcss.border({style:"dashed"}),i8.rcss.borderRadius(8),i8.rcss.p(16),i8.rcss.colWithGap(8),i8.rcss.center],featureDetails:[i8.rcss.flex.column,i8.rcss.colWithGap(4),i8.rcss.flex.growAndShrink(1)],newFeatureFieldWrapper:[i8.rcss.border({direction:"bottom",color:A.tokens.backgroundHighest})],inputCounterFlex:[i8.rcss.flex.row,i8.rcss.justify.spaceBetween,i8.rcss.align.center]});function mV(e){var t=e.features,n=e.onCreate,r=e.onUpdate,i=e.onDelete,a=(0,N._)((0,B.useState)([]),2),o=a[0],s=a[1],l=(0,N._)((0,B.useState)(!1),2),u=l[0],c=l[1];return(0,m.jsxs)(O.View,{children:[(0,m.jsxs)(O.View,{pb:12,children:[(0,m.jsxs)(O.View,{css:mD.centerRowGap8,children:[(0,m.jsxs)(O.View,{css:mD.centerRowGap8,children:[(0,m.jsx)(mA.default,{}),(0,m.jsx)(a0.Text,{variant:"subheadDefault",children:"Feature Descriptions"})]}),(0,m.jsx)(lz.IconButton,{onClick:function(){c(!u)},alt:"Add a new Feature",tooltipBehavior:u?"hidden":"default",disabled:u,children:(0,m.jsx)(sI.default,{})})]}),(0,m.jsx)(a0.Text,{color:"dimmer",variant:"small",multiline:!0,children:"Describe what your extension can do. Descriptions will appear on the store listing page."})]}),(0,m.jsxs)(O.View,{gap:8,children:[u?(0,m.jsx)(mF,{onSubmit:function(e){n(e),c(!1)},onCancel:function(){return c(!1)}}):null,(0,m.jsx)(O.View,{css:mD.featureContainer,children:t.length>0?t.map(function(e,n){return o.includes(n)?(0,m.jsx)(mF,{feature:e,isLast:n===t.length-1,onSubmit:function(e){r(e,n),s(function(e){return e.filter(function(e){return e!==n})})},onCancel:function(){return s(function(e){return e.filter(function(e){return e!==n})})}},n):(0,m.jsx)(mO,{isLast:n===t.length-1,feature:e,onEdit:function(){return s(function(e){return(0,en._)(e).concat([n])})},onDelete:function(){i(n)}},n)}):(0,m.jsx)(m.Fragment,{children:u?null:(0,m.jsxs)(O.View,{css:mD.noFeaturesPlaceholder,children:[(0,m.jsx)(a0.Text,{color:"dimmest",multiline:!0,children:"You haven't added any features yet"}),(0,m.jsx)(aZ.Button,{variant:"outlined",text:"New Feature",iconLeft:(0,m.jsx)(sI.default,{}),onClick:function(){return c(!0)}})]})})})]})]})}function mO(e){var t=e.feature,n=e.onEdit,r=e.onDelete,i=e.isLast;return(0,m.jsxs)(V.Surface,{elevated:!0,css:[i8.rcss.flex.row,i8.rcss.rowWithGap(8),i8.rcss.align.center,i8.rcss.p(8),i?null:i8.rcss.border({direction:"bottom",color:A.tokens.backgroundHighest})],children:[(0,m.jsx)(mM,{size:64,icon:t.image}),(0,m.jsxs)(O.View,{css:mD.featureDetails,children:[(0,m.jsxs)(O.View,{row:!0,gap:8,align:"center",justify:"space-between",children:[(0,m.jsx)(a0.Text,{children:t.title}),(0,m.jsxs)(O.View,{row:!0,gap:8,children:[(0,m.jsx)(lz.IconButton,{alt:"Delete",tooltipBehavior:"hidden",onClick:r,children:(0,m.jsx)(lN.default,{color:A.tokens.accentNegativeStronger})}),(0,m.jsx)(lz.IconButton,{alt:"Edit",tooltipBehavior:"hidden",onClick:n,children:(0,m.jsx)(mR.default,{})})]})]}),(0,m.jsx)(a0.Text,{color:"dimmest",multiline:!0,maxLines:1,children:t.body})]})]})}function mF(e){var t=e.onSubmit,n=e.onCancel,r=e.feature,i=e.isLast,a=(0,N._)((0,B.useState)((null==r?void 0:r.title)||""),2),o=a[0],s=a[1],l=(0,N._)((0,B.useState)((null==r?void 0:r.body)||""),2),u=l[0],c=l[1],d=(0,N._)((0,B.useState)((null==r?void 0:r.image)||null),2),p=d[0],f=d[1],h=o.length>=3&&u.length>=16;return(0,m.jsxs)(V.Surface,{css:[i8.rcss.flex.column,i||r?null:i8.rcss.borderRadius(8),r?i8.rcss.border({color:A.tokens.outlineDefault}):[i?null:i8.rcss.border({direction:"bottom",color:A.tokens.backgroundHighest})]],elevated:!0,children:[(0,m.jsxs)(O.View,{css:mD.newFeatureFieldWrapper,p:8,row:!0,gap:8,align:"center",justify:"space-between",children:[(0,m.jsx)(a0.Text,{children:o||"New Feature"}),(0,m.jsxs)(O.View,{row:!0,gap:8,children:[(0,m.jsx)(aZ.Button,{text:"Cancel",onClick:n}),(0,m.jsx)(aZ.Button,{text:r?"Save":"Create",colorway:"primary",onClick:function(){return t({title:o,body:u,image:p})},disabled:!h})]})]}),(0,m.jsxs)(O.View,{p:8,gap:8,children:[(0,m.jsxs)(O.View,{gap:4,children:[(0,m.jsxs)(O.View,{css:mD.inputCounterFlex,children:[(0,m.jsx)(a0.Text,{color:"dimmer",children:"Title"}),(0,m.jsx)(mL,{value:o.length,min:3})]}),(0,m.jsx)(mb.Input,{value:o,onChange:function(e){return s(e.target.value)},placeholder:"Seamless Editing",maxLength:60})]}),(0,m.jsxs)(O.View,{gap:4,children:[(0,m.jsxs)(O.View,{css:mD.inputCounterFlex,children:[(0,m.jsx)(a0.Text,{color:"dimmer",children:"Body"}),(0,m.jsx)(mL,{value:u.length,min:16})]}),(0,m.jsx)(mb.MultiLineInput,{value:u,onChange:function(e){return c(e.target.value)},placeholder:"Describe what this feature does and how to use it (Markdown supported)",autoSize:!0,maxLength:2e3})]}),(0,m.jsxs)(O.View,{row:!0,gap:8,children:[(0,m.jsxs)(O.View,{gap:4,grow:!0,shrink:!0,children:[(0,m.jsx)(a0.Text,{color:"dimmer",children:"Image (Recommended)"}),(0,m.jsx)(a0.Text,{color:"dimmest",multiline:!0,children:"Choose a statically-served image from your App. The Recommended aspect ratio for a cover image is 800x600."})]}),(0,m.jsx)(mM,{size:100,icon:p,editable:!0,onSubmit:function(e){f(e)}})]})]})]})}function mM(e){var t=e.size,n=e.icon,r=e.editable,i=void 0!==r&&r,a=e.onSubmit,o=(0,a9.default)().container,s=(0,a5.default)(o).url,l=s&&n?(0,on.getAssetUrl)(s,n):null,u=(0,N._)((0,B.useState)(!1),2),c=u[0],d=u[1];return(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)(V.Surface,{background:"default",css:[i?pe.interactive.filledAndOutlined:null,i8.rcss.flex.row,i8.rcss.center,i8.rcss.width(t),i8.rcss.height(.75*t),i8.rcss.maxWidth(t),i8.rcss.maxHeight(.75*t),i8.rcss.borderRadius(4),i8.rcss.border({color:A.tokens.backgroundHighest}),i8.rcss.flex.grow(1),{background:l?"".concat(A.tokens.backgroundDefault," url(").concat(l,") no-repeat center center / cover"):A.tokens.backgroundDefault}],onClick:function(){return d(!0)},children:l?null:(0,m.jsx)(mk.default,{color:A.tokens.foregroundDimmest,size:24})}),i?(0,m.jsx)(mP,{isOpen:c,close:function(){return d(!1)},onSubmit:function(e){null==a||a(e)}}):null]})}function mL(e){var t=e.value,n=e.min;return(0,m.jsxs)(a0.Text,{css:{color:t>=n?A.tokens.accentPositiveStronger:A.tokens.foregroundDimmest},children:[t,"/",n]})}var mG=e.i(316953),mU="Failed to read manifest file, please try again",mN="No extension.json found",mB=function(){var e=(0,N._)((0,B.useState)(null),2),t=e[0],n=e[1],r=(0,B.useCallback)(function(e){n(function(t){if(!t)throw Error("State should be defined");return(0,rX._)((0,x._)({},t),{manifestStr:e})})},[]);return{state:t,setState:n,updateString:r}},mW=function(){var e=(0,a9.default)(),t=e.fs,n=e.dotReplit,r=mB(),i=r.state,a=r.setState,o=r.updateString,s=(0,N._)((0,B.useState)(0),2),l=s[0],u=s[1],c=(0,N._)((0,B.useState)(!1),2),d=c[0],p=c[1],f=(0,B.useCallback)(function(){return(0,er._)(function(){return(0,ei._)(this,function(e){switch(e.label){case 0:return[4,(0,er._)(function(){return(0,ei._)(this,function(e){switch(e.label){case 0:return[4,t.writeFile("extension.json",JSON.stringify({name:"My Extension",description:"My Extension Description",version:"0"},null,2))];case 1:return e.sent(),[2]}})})()];case 1:return e.sent(),[2]}})})()},[t]);(0,B.useEffect)(function(){a(null);var e=!1,r=function(){};return(0,er._)(function(){var i,s,l,u,c,d,p;return(0,ei._)(this,function(f){switch(f.label){case 0:return[4,Promise.all([t.listFiles(),n.getConfig()])];case 1:var h,g,m,v;if(l=(s=N._.apply(void 0,[f.sent(),2]))[0],u=s[1],e)return[2];if(!l.files||u.error)return a({fileReadError:mU}),[2];if(d=(0,sp.asDir)((g="/"===(h=null!=(c=null==(i=u.config.extension)?void 0:i.outputDirectory)?c:"dist").charAt(0),m="/"===h.slice(-1),(v=(function(e,t){for(var n=0,r=e.length-1;r>=0;r--){var i=e[r];"."===i?e.splice(r,1):".."===i?(e.splice(r,1),n++):n&&(e.splice(r,1),n--)}if(t)for(;n--;)e.unshift("..");return e})(h.split("/").filter(function(e){return!!e}),!g).join("/"))||g||(v="."),v&&m&&(v+="/"),(g?"/":"")+v)),!(p=function(e){var t,n=e.filePaths,r=e.outputDir,i=[],a=!0,o=!1,s=void 0;try{for(var l,u=n[Symbol.iterator]();!(a=(l=u.next()).done);a=!0){var c=l.value;if("extension.json"===c)return c;c.endsWith("/extension.json")&&i.push(c)}}catch(e){o=!0,s=e}finally{try{a||null==u.return||u.return()}finally{if(o)throw s}}var d=!0,p=!1,f=void 0;try{for(var h,g=i[Symbol.iterator]();!(d=(h=g.next()).done);d=!0){var m=h.value;if(!m.startsWith(r))return m}}catch(e){p=!0,f=e}finally{try{d||null==g.return||g.return()}finally{if(p)throw f}}return null!=(t=i[0])?t:null}({filePaths:l.files,outputDir:d})))return a({fileReadError:mN}),[2];return r=t.watchTextFile(p,{onReady:function(e){a({fileReadError:null,writeChange:e.writeChange,manifestStr:e.initialContent,manifestPath:p})},onChange:function(e){o(e.latestContent)},onMoveOrDelete:function(){a({fileReadError:"extension.json was moved or deleted, please re-create it in your static directory"})},onError:function(){a({fileReadError:mU})}}),[2]}})})(),function(){r(),e=!0}},[t,o,n,l,a]);var h=(0,B.useMemo)(function(){if(!i||null!==i.fileReadError)return null;try{var e=md.evaluate(i.manifestStr);return(0,mG.parseManifestOrError)(e)}catch(e){return{error:e,manifest:null}}},[i]),g=(0,B.useCallback)(function(e){if(!i||(null==h?void 0:h.error)||null!==i.fileReadError)throw Error("Failed to parse manifest file");var t=md.patch(i.manifestStr,e);i.writeChange((0,mp.changeSetFromDiff)(i.manifestStr,t)),o(t)},[i,h,o]),m={retry:function(){u(function(e){return e+1})},creatingExtensionJson:d,setCreatingExtensionJson:p,createExtensionJson:f,updateString:o,updateManifest:g};return i?"string"==typeof i.fileReadError?(0,rX._)((0,x._)({},m),{__status:"fileReadError",state:{fileReadError:i.fileReadError},parsed:null}):h?h.manifest?(0,rX._)((0,x._)({},m),{__status:"success",state:{fileReadError:null,writeChange:i.writeChange,manifestStr:i.manifestStr,manifestPath:i.manifestPath},parsed:h}):(0,rX._)((0,x._)({},m),{__status:"fileParseError",state:i,parsed:{manifest:null,error:h.error}}):(0,rX._)((0,x._)({},m),{__status:"fileReadError",state:{fileReadError:mN},parsed:null}):(0,rX._)((0,x._)({},m),{__status:"loading",state:null,parsed:null})},mz=((o={}).loading="loading",o.fileReadError="fileReadError",o.fileParseError="fileParseError",o.success="success",o),mH=function(){return(0,m.jsx)(O.View,{css:[i8.rcss.display.flex,i8.rcss.width("100%"),i8.rcss.height("100%")],justify:"center",align:"center",children:(0,m.jsx)(dA.default,{})})},mq=e.i(837399);function mK(e){var t=e.children;return(0,m.jsx)(O.View,{gap:12,p:16,children:(0,m.jsx)(V.Surface,{elevated:!0,css:[i8.rcss.borderRadius(8),i8.rcss.colWithGap(8)],p:16,children:t})})}var m$=e.i(959406),mQ=function(e){var t=e.error,n=e.performPaneOperation,r=e.manifestPath;return(0,m.jsx)(mK,{children:(0,m.jsxs)(O.View,{gap:16,p:8,children:[(0,m.jsxs)(O.View,{row:!0,gap:8,css:[i8.rcss.display.flex,i8.rcss.align.center],children:[(0,m.jsx)(fi.default,{}),(0,m.jsx)(a0.Text,{variant:"headerDefault",children:"Error parsing extension.json"})]}),(0,m.jsx)(a0.Text,{variant:"subheadDefault",children:"Details:"}),(0,m.jsx)(O.View,{gap:8,children:(0,ol._)(t,mq.TypeboxError)?t.issues.map(function(e,t){var n=e.path,r=e.message;return(0,m.jsxs)(O.View,{css:[i8.rcss.display.flex,i8.rcss.flex.row,i8.rcss.rowWithGap(4)],children:[(0,m.jsx)(a0.Text,{css:[i8.rcss.font.code,i8.rcss.color.orangeStrongest,i8.rcss.backgroundColor.orangeDimmest],children:n}),(0,m.jsx)(a0.Text,{children:r})]},t)}):(0,m.jsx)(O.View,{tag:"pre",children:t.message})}),(0,m.jsxs)(O.View,{row:!0,gap:8,children:[(0,m.jsx)(aZ.Button,{colorway:"primary",text:"Open extension.json",onClick:function(){n({operation:"open",secondary:!0,pane:(0,m$.getPaneForFile)(r)})}}),(0,m.jsx)(aZ.Button,{iconLeft:(0,m.jsx)(fI.default,{}),text:"Read extension.json docs",onClick:function(){window.open("https://docs.replit.com/extensions/api/manifest","_blank")}})]})]})})},mY=function(e){var t=e.message,n=mW(),r=n.createExtensionJson,i=n.creatingExtensionJson,a=n.retry,o=n.setCreatingExtensionJson;return(0,m.jsxs)(mK,{children:[(0,m.jsxs)(O.View,{row:!0,gap:8,css:[i8.rcss.display.flex,i8.rcss.align.center],children:[(0,m.jsx)(fi.default,{}),(0,m.jsx)(a0.Text,{variant:"subheadDefault",children:t})]}),(0,m.jsxs)(O.View,{row:!0,gap:8,children:[(0,m.jsx)(aZ.Button,{colorway:"primary",text:"Create extension.json",loading:i,iconLeft:i?(0,m.jsx)(dA.default,{}):(0,m.jsx)(sI.default,{}),onClick:function(){return(0,er._)(function(){return(0,ei._)(this,function(e){switch(e.label){case 0:return o(!0),[4,r()];case 1:return e.sent(),a(),o(!1),[2]}})})()}}),(0,m.jsx)(aZ.Button,{text:"Retry",iconLeft:(0,m.jsx)(u6.default,{}),onClick:function(){a()}})]})]})},mX=e.i(734882),mJ=e.i(818660),mZ=e.i(964269),m0=e.i(757390),m1=e.i(641536),m2=e.i(783437),m4=e.i(545124),m8=(0,ro.cssRecord)({iconContainer:[i8.rcss.position.relative,i8.rcss.width(64),i8.rcss.height(64),{"&:hover .edit-overlay":{opacity:1}}],iconWrapper:[i8.rcss.flex.column,i8.rcss.position.absolute,i8.rcss.top(0),i8.rcss.left(0)],iconOverlay:[i8.rcss.flex.column,i8.rcss.colWithGap(4),i8.rcss.center,i8.rcss.position.absolute,i8.rcss.top(0),i8.rcss.left(0),i8.rcss.width("100%"),i8.rcss.height("100%"),i8.rcss.backgroundColor.backgroundOverlay,i8.rcss.borderRadius(12),{transition:"0.25s",opacity:0,cursor:"pointer"}]});function m3(e){var t=e.performPaneOperation,n=e.setSelectedTab,r=(0,oe.useCurrentReplExtension)(),i=(0,oe.useInstallCurrentReplAsExtension)(),a=(0,oe.useReloadExtension)(),o=(0,oe.useUnloadExtension)(),s=(0,sj.useReplExtensionId)(),l=(0,N._)((0,B.useState)(!1),2),u=l[0],c=l[1],d=(0,N._)((0,B.useState)(!1),2),p=d[0],f=d[1];return(0,m.jsx)(O.View,{css:[i8.rcss.flex.wrap,{rowGap:8}],row:!0,gap:8,children:(0,m.jsxs)(O.View,{row:!0,gap:8,children:[r||p?(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)(aZ.Button,{size:"small",text:"Reload",iconLeft:p?(0,m.jsx)(dA.default,{}):(0,m.jsx)(u6.default,{}),disabled:p,onClick:function(){return(0,er._)(function(){return(0,ei._)(this,function(e){switch(e.label){case 0:if(!r)return[2];return f(!0),[4,a(r.installationId)];case 1:return e.sent(),f(!1),[2]}})})()}}),(0,m.jsx)(aZ.Button,{size:"small",text:"Unload",iconLeft:(0,m.jsx)(m2.default,{}),disabled:!r,onClick:function(){r&&o(r.installationId)}})]}):(0,m.jsx)(aZ.Button,{size:"small",text:"Load locally",colorway:"primary",iconLeft:u?(0,m.jsx)(dA.default,{}):(0,m.jsx)(m0.default,{}),loading:u,onClick:function(){return(0,er._)(function(){return(0,ei._)(this,function(e){switch(e.label){case 0:return c(!0),[4,i()];case 1:return e.sent(),c(!1),[2]}})})()}}),s?(0,m.jsx)(aZ.Button,{size:"small",text:"View on Store",iconLeft:(0,m.jsx)(m4.default,{}),onClick:function(){return t({operation:"open",pane:{type:"extensionStore",data:{page:"cover",coverPageExtensionId:s}}})}}):null,(0,m.jsx)(aZ.Button,{size:"small",text:"Edit Store Listing",onClick:function(){n("releases")},iconLeft:(0,m.jsx)(mR.default,{})})]})})}function m6(e){var t=e.performPaneOperation,n=e.setSelectedTab,r=(0,a9.default)().container,i=(0,a5.default)(r).url,a=mW(),o=a.parsed,s=a.state,l=a.__status;if(l===mz.loading)return(0,m.jsx)(mH,{});if(l===mz.fileReadError)return(0,m.jsx)(mY,{message:s.fileReadError});var u=o.manifest,c=o.error;return c?(0,m.jsx)(mQ,{performPaneOperation:t,manifestPath:s.manifestPath,error:c}):(0,m.jsx)(O.View,{gap:16,css:[i8.rcss.width("100%")],children:(0,m.jsxs)(V.Surface,{elevated:!0,css:[i8.rcss.borderRadius(8),i8.rcss.colWithGap(8)],p:12,children:[(0,m.jsxs)(O.View,{row:!0,gap:16,align:"center",children:[(0,m.jsx)(O.View,{css:[i8.rcss.display.flex,i8.rcss.flex.row],grow:0,children:(0,m.jsx)(mJ.ExtensionIcon,{size:64,baseUrl:null!=i?i:null,icon:u.icon})}),(0,m.jsxs)(O.View,{grow:!0,shrink:!0,children:[(0,m.jsx)(mZ.HStack,{align:"center",justify:"space-between",children:(0,m.jsx)(a0.Text,{variant:"subheadDefault",children:u.name})}),(0,m.jsx)(a0.Text,{variant:"text",color:"dimmest",children:u.description})]})]}),(0,m.jsx)(m3,{setSelectedTab:n,performPaneOperation:t})]})})}function m5(e){var t,n,r,i,a,o,s,l,u,c,d=e.manifest,p=e.onSubmit,f=e.updateManifest,h=(0,sj.useReplExtensionId)(),g=(0,aX.useCurrentUserId)(),v=(0,mw.useIdSeed)(),y=(0,N._)((0,B.useState)(null!=(s=d.name)?s:""),2),w=y[0],j=y[1],_=(0,N._)((0,B.useState)(null!=(l=d.description)?l:""),2),S=_[0],I=_[1],C=(0,N._)((0,B.useState)(null!=(u=d.longDescription)?u:void 0),2),k=C[0],E=C[1],T=(0,N._)((0,B.useState)(!1),2),P=T[0],R=T[1],A=(0,a9.default)().container,D=(0,a5.default)(A).url,V=(t={variables:{id:h||""},skip:!h},n=(0,x._)({},mv,t),b.useQuery(mx,n)),F=V.data,M=V.loading,L=V.refetch,G=(0,N._)((0,mh.useSetExtensionListedMutation)(),2),U=G[0],W=G[1].loading,z=(null==F||null==(r=F.extension)?void 0:r.__typename)==="Extension"&&(null==F||null==(i=F.extension)?void 0:i.user.id)===g,H=(null==F||null==(a=F.extension)?void 0:a.__typename)==="Extension"&&(null==F||null==(o=F.extension)?void 0:o.isListed);return(0,m.jsxs)(O.View,{tag:"form",gap:16,onSubmit:function(e){e.preventDefault(),p({name:w,description:S,longDescription:k})},children:[(0,m.jsxs)(O.View,{grow:!0,shrink:!0,gap:4,children:[(0,m.jsx)(a0.Text,{css:[i8.rcss.fontWeight.medium],children:"Do you want to publish your extension on the store?"}),M||W?(0,m.jsx)(dA.default,{}):(0,m.jsxs)(mX.RadioGroup,{css:i8.rcss.colWithGap(8),name:"extensionListingStatus",value:H?"listed":"unlisted",disabled:!z,onChange:function(e){U({variables:{extensionId:h||"",isListed:"listed"===e.target.value}}).then(function(){return L()})},children:[z?null:(0,m.jsx)(O.View,{css:[i8.rcss.width("fit-content")],children:(0,m.jsx)(f2.StatusBanner,{text:"You need to release this extension before listing it.",icon:(0,m.jsx)(mj.default,{}),colorway:"yellow"})}),(0,m.jsxs)(O.View,{row:!0,gap:8,children:[(0,m.jsx)(mX.Radio,{id:v("listed"),value:"listed"}),(0,m.jsx)("label",{htmlFor:v("listed"),children:"Yes, list my extension publicly on the Store"})]},"listed"),(0,m.jsxs)(O.View,{row:!0,gap:8,children:[(0,m.jsx)(mX.Radio,{id:v("unlisted"),value:"unlisted"}),(0,m.jsx)("label",{htmlFor:v("unlisted"),children:"No, I want to keep my listing page private"})]},"unlisted")]})]}),(0,m.jsx)(pY.DividerH,{}),(0,m.jsxs)(O.View,{grow:!0,shrink:!0,gap:4,tag:"label",htmlFor:v("name"),children:[(0,m.jsx)(a0.Text,{children:"Extension Name"}),(0,m.jsx)(mb.Input,{id:v("name"),placeholder:"Give your extension a name",value:w,onChange:function(e){j(e.currentTarget.value)},required:!0})]}),(0,m.jsxs)(O.View,{grow:!0,shrink:!0,gap:4,children:[(0,m.jsx)(a0.Text,{children:"Extension Icon"}),(0,m.jsxs)(O.View,{row:!0,gap:12,align:"center",children:[(0,m.jsxs)(O.View,{css:m8.iconContainer,children:[(0,m.jsx)(O.View,{css:m8.iconWrapper,children:(0,m.jsx)(mJ.ExtensionIcon,{size:64,baseUrl:null!=D?D:null,icon:d.icon})}),(0,m.jsxs)(O.View,{css:m8.iconOverlay,className:"edit-overlay",tag:"label",onClick:function(){return R(!0)},children:[(0,m.jsx)(mR.default,{}),(0,m.jsx)(a0.Text,{variant:"small",children:"Edit"})]})]}),(0,m.jsx)(aZ.Button,{text:"Choose from file system",iconLeft:(0,m.jsx)(m1.default,{}),onClick:function(){return R(!0)}})]})]}),(0,m.jsxs)(O.View,{grow:!0,shrink:!0,gap:4,tag:"label",htmlFor:v("tagline"),children:[(0,m.jsxs)(O.View,{gap:0,children:[(0,m.jsx)(a0.Text,{children:"Tagline"}),(0,m.jsx)(a0.Text,{color:"dimmer",variant:"small",multiline:!0,children:"Provide a short description of what your Extension is for."})]}),(0,m.jsx)(mb.Input,{id:v("tagline"),placeholder:"Give your extension a short tagline",value:S,onChange:function(e){I(e.currentTarget.value)},required:!0})]}),(0,m.jsxs)(O.View,{grow:!0,shrink:!0,gap:4,tag:"label",htmlFor:v("longDescription"),children:[(0,m.jsxs)(O.View,{gap:0,children:[(0,m.jsx)(a0.Text,{children:"Description"}),(0,m.jsx)(a0.Text,{color:"dimmer",variant:"small",multiline:!0,children:"Add more detail about the usage of your extension."})]}),(0,m.jsx)(mb.MultiLineInput,{id:v("longDescription"),placeholder:"Give your extension a long description, markdown formatting is supported",value:null!=k?k:"",onChange:function(e){E(e.currentTarget.value||void 0)},css:{resize:"vertical"},autoSize:!0})]}),(0,m.jsx)(pY.DividerH,{}),(0,m.jsx)(mV,{features:null!=(c=d.features)?c:[],onDelete:function(e){if((null==(t=d.features)?void 0:t.length)===1&&0===e){var t,n,r=(0,x._)({},d);delete r.features,f(r)}else f((0,rX._)((0,x._)({},d),{features:null==(n=d.features)?void 0:n.filter(function(t,n){return n!==e})}))},onUpdate:function(e,t){var n,r,i,a;f((0,rX._)((0,x._)({},d),{features:(0,en._)(null!=(i=null==(n=d.features)?void 0:n.slice(0,t))?i:[]).concat([e],(0,en._)(null!=(a=null==(r=d.features)?void 0:r.slice(t+1))?a:[]))}))},onCreate:function(e){var t;f((0,rX._)((0,x._)({},d),{features:(0,en._)(null!=(t=d.features)?t:[]).concat([e])}))}}),(0,m.jsx)(O.View,{row:!0,gap:12,css:[{alignSelf:"end"},i8.rcss.pt(8)],children:(0,m.jsx)(aZ.Button,{text:"Continue",iconRight:(0,m.jsx)(uE.default,{}),colorway:"primary",type:"submit",disabled:!w||!S||!k})}),(0,m.jsx)(mP,{isOpen:P,close:function(){return R(!1)},onSubmit:function(e){f((0,rX._)((0,x._)({},d),{icon:e}))}})]})}function m9(e){var t=e.fileHandlers,n=e.onCreate,r=e.onUpdate,i=e.onOpen,a=e.onDelete,o=(0,N._)((0,B.useState)([]),2),s=o[0],l=o[1],u=(0,N._)((0,B.useState)(!1),2),c=u[0],d=u[1];return(0,m.jsxs)(O.View,{children:[(0,m.jsxs)(O.View,{pb:12,children:[(0,m.jsxs)(O.View,{row:!0,gap:8,align:"center",children:[(0,m.jsxs)(O.View,{row:!0,gap:8,align:"center",children:[(0,m.jsx)(sP.default,{}),(0,m.jsx)(a0.Text,{variant:"subheadDefault",multiline:!1,children:"File Handlers"})]}),(0,m.jsx)(lz.IconButton,{onClick:function(){return d(!c)},alt:"Add a new File Handler",tooltipBehavior:c?"hidden":"default",disabled:c,children:(0,m.jsx)(sI.default,{})})]}),(0,m.jsx)(a0.Text,{color:"dimmer",variant:"small",multiline:!1,children:"Custom file viewers and editors"})]}),(0,m.jsxs)(O.View,{gap:8,children:[c?(0,m.jsx)(m7,{onSubmit:function(e){n(e),d(!1)},onCancel:function(){d(!1)}}):null,t.length?t.map(function(e,t){var n;return s.includes(t)?(0,m.jsx)(m7,{initialFileHandler:e,onSubmit:function(e){r(e,t),l(function(e){return e.filter(function(e){return e!==t})})},onCancel:function(){l(function(e){return e.filter(function(e){return e!==t})})}},t):(0,m.jsxs)(V.Surface,{css:[i8.rcss.borderRadius(8),i8.rcss.flex.wrap,{rowGap:8}],p:8,row:!0,justify:"space-between",align:"center",elevated:!0,children:[(0,m.jsx)(a0.Text,{multiline:!1,children:null!=(n=e.name)?n:"Unnamed"}),(0,m.jsxs)(O.View,{row:!0,gap:12,align:"center",children:[(0,m.jsx)(lz.IconButton,{alt:"Remove ".concat(e.name||"this file handler"),colorway:"red",onClick:function(){a(t)},children:(0,m.jsx)(lN.default,{})}),(0,m.jsx)(lz.IconButton,{alt:"Edit ".concat(e.name||"this file handler"),onClick:function(){l(function(e){return(0,en._)(e).concat([t])})},children:(0,m.jsx)(mR.default,{})}),(0,m.jsx)(aZ.Button,{iconLeft:(0,m.jsx)(m1.default,{}),variant:"outlined",text:"Preview",onClick:function(){i(e)}})]})]},t)}):(0,m.jsx)(m.Fragment,{children:c?null:(0,m.jsxs)(O.View,{css:[i8.rcss.border({style:"dashed"}),i8.rcss.borderRadius(8),i8.rcss.p(16),i8.rcss.colWithGap(8),i8.rcss.center],children:[(0,m.jsx)(a0.Text,{color:"dimmest",children:"You haven't added a file handler yet"}),(0,m.jsx)(aZ.Button,{variant:"outlined",text:"New File Handler",iconLeft:(0,m.jsx)(sI.default,{}),onClick:function(){return d(!0)}})]})})]})]})}function m7(e){var t,n,r,i,a=e.onSubmit,o=e.onCancel,s=e.initialFileHandler,l=(0,N._)((0,B.useState)(null!=(t=null==s?void 0:s.name)?t:""),2),u=l[0],c=l[1],d=(0,N._)((0,B.useState)(null!=(n=null==s?void 0:s.icon)?n:""),2),p=d[0],f=d[1],h=(0,N._)((0,B.useState)(null!=(r=null==s?void 0:s.handler)?r:""),2),g=h[0],v=h[1],x=(0,N._)((0,B.useState)(null!=(i=null==s?void 0:s.glob)?i:""),2),y=x[0],w=x[1],b=(0,mw.useIdSeed)();return(0,m.jsxs)(V.Surface,{css:[i8.rcss.borderRadius(8),i8.rcss.border({color:A.tokens.outlineDimmest}),i8.rcss.p(8),i8.rcss.colWithGap(8)],tag:"form",onSubmit:function(e){e.preventDefault(),a({name:u,icon:p,handler:g,glob:y})},elevated:!0,children:[(0,m.jsxs)(O.View,{css:[i8.rcss.border({color:A.tokens.outlineDimmest,direction:"bottom"}),i8.rcss.align.center,i8.rcss.flex.wrap,{rowGap:8}],row:!0,gap:2,justify:"space-between",children:[(0,m.jsx)(a0.Text,{multiline:!1,children:u||"New File Viewer"}),(0,m.jsxs)(O.View,{row:!0,gap:8,children:[(0,m.jsx)(aZ.Button,{text:"Cancel",onClick:function(){o()}}),(0,m.jsx)(aZ.Button,{colorway:"primary",iconLeft:(0,m.jsx)(p8.default,{}),text:"Save Changes",type:"submit"})]})]}),(0,m.jsxs)(O.View,{gap:8,children:[(0,m.jsxs)(O.View,{grow:!0,shrink:!0,gap:2,tag:"label",htmlFor:b("name"),children:[(0,m.jsx)(a0.Text,{color:"dimmer",multiline:!1,children:"Name"}),(0,m.jsx)(mb.Input,{id:b("name"),placeholder:"SVG Editor",value:u,onChange:function(e){c(e.currentTarget.value)},required:!0})]}),(0,m.jsxs)(O.View,{grow:!0,shrink:!0,gap:2,tag:"label",htmlFor:b("handler"),children:[(0,m.jsx)(a0.Text,{color:"dimmer",multiline:!1,children:"URL Path"}),(0,m.jsx)(mb.Input,{id:b("handler"),placeholder:"/svg-editor",value:g,onChange:function(e){v(e.currentTarget.value)},required:!0})]}),(0,m.jsxs)(O.View,{grow:!0,shrink:!0,gap:2,tag:"label",htmlFor:b("glob"),children:[(0,m.jsx)(a0.Text,{color:"dimmer",multiline:!1,children:"Glob Pattern"}),(0,m.jsx)(mb.Input,{id:b("glob"),placeholder:"*.svg",value:y,onChange:function(e){w(e.currentTarget.value)},required:!0})]}),(0,m.jsxs)(O.View,{grow:!0,shrink:!0,gap:2,tag:"label",htmlFor:b("icon"),children:[(0,m.jsx)(a0.Text,{color:"dimmer",multiline:!1,children:"Icon (path)"}),(0,m.jsx)(mb.Input,{id:b("icon"),placeholder:"/svg-editor-logo.png",value:p,onChange:function(e){f(e.currentTarget.value)},required:!0})]})]})]})}function ve(e){var t=e.tools,n=e.onCreate,r=e.onUpdate,i=e.onOpen,a=e.onDelete,o=(0,N._)((0,B.useState)([]),2),s=o[0],l=o[1],u=(0,N._)((0,B.useState)(!1),2),c=u[0],d=u[1];return(0,m.jsxs)(O.View,{children:[(0,m.jsxs)(O.View,{pb:12,children:[(0,m.jsxs)(O.View,{row:!0,gap:8,align:"center",children:[(0,m.jsxs)(O.View,{row:!0,gap:8,align:"center",children:[(0,m.jsx)(aF.default,{}),(0,m.jsx)(a0.Text,{variant:"subheadDefault",multiline:!1,children:"Tools"})]}),(0,m.jsx)(lz.IconButton,{onClick:function(){return d(!c)},alt:"Add a new tool",disabled:c,tooltipBehavior:c?"hidden":"default",children:(0,m.jsx)(sI.default,{})})]}),(0,m.jsx)(a0.Text,{color:"dimmer",variant:"small",multiline:!1,children:"Custom user interfaces as a Pane"})]}),(0,m.jsxs)(O.View,{gap:8,children:[c?(0,m.jsx)(vt,{onSubmit:function(e){n(e),d(!1)},onCancel:function(){d(!1)}}):null,t.length?t.map(function(e,t){var n;return s.includes(t)?(0,m.jsx)(vt,{initialTool:e,onSubmit:function(e){r(e,t),l(function(e){return e.filter(function(e){return e!==t})})},onCancel:function(){l(function(e){return e.filter(function(e){return e!==t})})}},t):(0,m.jsxs)(V.Surface,{css:[i8.rcss.borderRadius(8),i8.rcss.flex.wrap,{rowGap:8}],p:8,row:!0,justify:"space-between",align:"center",elevated:!0,children:[(0,m.jsx)(a0.Text,{multiline:!1,children:null!=(n=e.name)?n:"Unnamed"}),(0,m.jsxs)(O.View,{row:!0,gap:12,align:"center",children:[(0,m.jsx)(lz.IconButton,{alt:"Remove ".concat(e.name||"this tool"),colorway:"red",onClick:function(){a(t)},children:(0,m.jsx)(lN.default,{})}),(0,m.jsx)(lz.IconButton,{alt:"Remove ".concat(e.name||"this tool"),onClick:function(){l(function(e){return(0,en._)(e).concat([t])})},children:(0,m.jsx)(mR.default,{})}),(0,m.jsx)(aZ.Button,{iconLeft:(0,m.jsx)(cw.default,{}),variant:"outlined",text:"Preview",onClick:function(){i(e)}})]})]},t)}):(0,m.jsx)(m.Fragment,{children:c?null:(0,m.jsxs)(O.View,{css:[i8.rcss.border({style:"dashed"}),i8.rcss.borderRadius(8),i8.rcss.p(16),i8.rcss.colWithGap(8),i8.rcss.center],children:[(0,m.jsx)(a0.Text,{color:"dimmest",children:"You haven't added any tools"}),(0,m.jsx)(aZ.Button,{variant:"outlined",text:"New Tool",iconLeft:(0,m.jsx)(sI.default,{}),onClick:function(){return d(!0)}})]})})]})]})}function vt(e){var t,n,r,i=e.onSubmit,a=e.onCancel,o=e.initialTool,s=(0,N._)((0,B.useState)(null!=(t=null==o?void 0:o.name)?t:""),2),l=s[0],u=s[1],c=(0,N._)((0,B.useState)(null!=(n=null==o?void 0:o.icon)?n:null),2),d=c[0],p=c[1],f=(0,N._)((0,B.useState)(null!=(r=null==o?void 0:o.handler)?r:""),2),h=f[0],g=f[1],v=(0,mw.useIdSeed)();return(0,m.jsxs)(V.Surface,{tag:"form",css:[i8.rcss.borderRadius(8),i8.rcss.border({color:A.tokens.outlineDimmest}),i8.rcss.p(8)],elevated:!0,onSubmit:function(e){e.preventDefault(),i({name:l,icon:d,handler:h})},children:[(0,m.jsxs)(O.View,{css:[i8.rcss.border({color:A.tokens.outlineDimmest,direction:"bottom"}),i8.rcss.align.center,i8.rcss.flex.wrap,{rowGap:8}],row:!0,gap:2,justify:"space-between",children:[(0,m.jsx)(a0.Text,{multiline:!1,children:l||"New Tool"}),(0,m.jsxs)(O.View,{row:!0,gap:8,children:[(0,m.jsx)(aZ.Button,{text:"Cancel",onClick:function(){a()}}),(0,m.jsx)(aZ.Button,{colorway:"primary",iconLeft:(0,m.jsx)(p8.default,{}),text:"Save Changes",type:"submit"})]})]}),(0,m.jsxs)(O.View,{gap:8,children:[(0,m.jsxs)(O.View,{grow:!0,shrink:!0,gap:2,tag:"label",htmlFor:v("name"),children:[(0,m.jsx)(a0.Text,{color:"dimmer",multiline:!1,children:"Name"}),(0,m.jsx)(mb.Input,{id:v("name"),placeholder:"SQL Viewer",value:l,onChange:function(e){u(e.currentTarget.value)},required:!0})]}),(0,m.jsxs)(O.View,{grow:!0,shrink:!0,gap:2,tag:"label",htmlFor:v("handler"),children:[(0,m.jsx)(a0.Text,{color:"dimmer",multiline:!1,children:"URL Path"}),(0,m.jsx)(mb.Input,{id:v("handler"),placeholder:"/sql",value:h,onChange:function(e){g(e.currentTarget.value)},required:!0})]}),(0,m.jsxs)(O.View,{grow:!0,shrink:!0,gap:2,tag:"label",htmlFor:v("icon"),children:[(0,m.jsx)(a0.Text,{color:"dimmer",multiline:!1,children:"Icon (path)"}),(0,m.jsx)(mb.Input,{id:v("icon"),placeholder:"/sql-logo.png",value:null!=d?d:"",onChange:function(e){p(e.currentTarget.value||null)},required:!0})]})]})]})}function vn(e){var t,n,r=e.manifest,i=e.performPaneOperation,a=e.update,o=(0,oe.useCurrentReplExtension)(),s=(0,oe.useInstallCurrentReplAsExtension)(),l=(0,N._)((0,B.useState)(null),2),u=l[0],c=l[1];return(0,m.jsxs)(O.View,{gap:24,css:[i8.rcss.width("100%")],children:[(0,m.jsx)(m9,{onOpen:function(e){return(0,er._)(function(){return(0,ei._)(this,function(t){return c(e),[2]})})()},onDelete:function(e){var t;a((0,rX._)((0,x._)({},r),{fileHandlers:null==(t=r.fileHandlers)?void 0:t.filter(function(t,n){return n!==e})}))},onUpdate:function(e,t){var n,i,o,s;a((0,rX._)((0,x._)({},r),{fileHandlers:(0,en._)(null!=(o=null==(n=r.fileHandlers)?void 0:n.slice(0,t))?o:[]).concat([e],(0,en._)(null!=(s=null==(i=r.fileHandlers)?void 0:i.slice(t+1))?s:[]))}))},onCreate:function(e){var t;a((0,rX._)((0,x._)({},r),{fileHandlers:(0,en._)(null!=(t=r.fileHandlers)?t:[]).concat([e])}))},fileHandlers:null!=(t=r.fileHandlers)?t:[]}),(0,m.jsx)(ve,{onOpen:function(e){return(0,er._)(function(){var t,n;return(0,ei._)(this,function(r){switch(r.label){case 0:if(t=o)return[3,2];return[4,s()];case 1:t=r.sent(),r.label=2;case 2:if(!t)throw Error("Expected current repl to be installed as an extension");return i({operation:"open",pane:{type:"extension",data:{extensionId:t.extensionId,installationId:t.installationId,name:null!=(n=e.name)?n:t.manifest.name,baseUrl:t.baseUrl,icon:e.icon,path:e.handler}}}),[2]}})})()},onDelete:function(e){var t;a((0,rX._)((0,x._)({},r),{tools:null==(t=r.tools)?void 0:t.filter(function(t,n){return n!==e})}))},onUpdate:function(e,t){var n,i,o,s;a((0,rX._)((0,x._)({},r),{tools:(0,en._)(null!=(o=null==(n=r.tools)?void 0:n.slice(0,t))?o:[]).concat([e],(0,en._)(null!=(s=null==(i=r.tools)?void 0:i.slice(t+1))?s:[]))}))},onCreate:function(e){var t;a((0,rX._)((0,x._)({},r),{tools:(0,en._)(null!=(t=r.tools)?t:[]).concat([e])}))},tools:null!=(n=r.tools)?n:[]}),(0,m.jsx)(aU.Modal,{isOpen:!!u,onRequestClose:function(){return c(null)},children:u?(0,m.jsx)(mI,{glob:u.glob,openFile:function(e){return(0,er._)(function(){var t,n;return(0,ei._)(this,function(r){switch(r.label){case 0:if(!u)throw Error("Expected pending file handler");if(t=o)return[3,2];return[4,s()];case 1:t=r.sent(),r.label=2;case 2:if(!t)throw Error("Expected current repl to be installed as an extension");return i({operation:"open",pane:{type:"extension",data:{extensionId:t.extensionId,installationId:t.installationId,name:null!=(n=u.name)?n:t.manifest.name,baseUrl:t.baseUrl,path:(0,on.getAssetUrl)(t.baseUrl,u.handler),filePath:e}}}),c(null),[2]}})})()}}):null})]})}var vr=e.i(952521),vi=e.i(903283),va=e.i(452814),vo=(0,ca.css)(pe.interactive.filled,i8.rcss.position.relative,i8.rcss.p(4),i8.rcss.border({color:A.tokens.outlineDimmer}),i8.rcss.backgroundColor.backgroundHigher,{"&[data-complete]":[i8.rcss.backgroundColor.backgroundDefault,{pointerEvents:"none"}],button:{overflow:"hidden",margin:-1,borderWidth:0,padding:0,width:1,height:1,background:"none",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",cursor:"pointer","&::after":{content:'""',position:"absolute",top:0,right:0,bottom:0,left:0,display:"block",cursor:"pointer",zIndex:1}}}),vs=function(e){var t=e.complete,n=e.onClick,r=e.description,i=e.title,a=e.icon;return(0,m.jsx)(O.View,{tag:"li",css:vo,"data-complete":t,children:(0,m.jsxs)(O.View,{p:4,children:[(0,m.jsxs)(O.View,{row:!0,gap:6,align:"center",children:[t?(0,m.jsx)(p8.default,{color:A.tokens.accentPositiveStrongest,size:16,css:[i8.rcss.mr(4)]}):null!=a?a:null,(0,m.jsx)(a0.Text,{variant:"small",color:t?"dimmer":"default",css:[i8.rcss.fontWeight.medium],children:i})]}),r?(0,m.jsx)(a0.Text,{color:"dimmer",variant:"small",children:r}):null,(0,m.jsx)(O.View,{children:(0,m.jsx)("button",{onClick:function(){n&&"function"==typeof n&&n()},type:"button",children:"Start"})})]})})};let vl=function(e){var t=e.setSelectedTab,n=(0,vr.useDismissibleElement)("extensions-onboarding-checklist"),r=n.isDone,i=n.setAsDone,a=(0,vr.useDismissibleElement)("extensions-onboarding-checklist-create"),o=a.isDone,s=a.setAsDone,l=(0,vr.useDismissibleElement)("extensions-onboarding-checklist-concepts"),u=l.isDone,c=l.setAsDone,d=(0,vr.useDismissibleElement)("extensions-onboarding-checklist-api"),p=d.isDone,f=d.setAsDone,h=(0,vr.useDismissibleElement)("extensions-onboarding-checklist-publish").isDone;if((0,B.useEffect)(function(){s()},[]),void 0===r||!0===r)return null;var g=[o,u,p,h].filter(Boolean).length,v=[{name:"create",title:"Create an Extension",complete:!!o,icon:(0,m.jsx)(sC.default,{})},{name:"concepts",title:"Learn key concepts",complete:!!u,onClick:function(){window.open(aQ.LINKS_DOCS.EXTENSIONS,"_blank","noopener"),(0,es.track)(el.events.EXTENSION_USED,{action:"developer_onboarding_completed",step:"concepts"}),c()},icon:(0,m.jsx)(vi.default,{})},{name:"learn",title:"Use the API",complete:!!p,onClick:function(){window.open(aQ.LINKS_DOCS.EXTENSIONS,"_blank","noopener"),(0,es.track)(el.events.EXTENSION_USED,{action:"developer_onboarding_completed",step:"learn"}),f()},icon:(0,m.jsx)(sX.default,{})},{name:"publish",title:"Publish your Extension",complete:!!h,onClick:function(){t("releases")},icon:(0,m.jsx)(va.default,{})}];return(0,m.jsx)("section",{css:[i8.rcss.width("100%")],children:(0,m.jsxs)(O.View,{gap:12,children:[(0,m.jsx)(O.View,{gap:2,children:(0,m.jsxs)(O.View,{row:!0,gap:12,css:[i8.rcss.flex.wrap],align:"center",children:[(0,m.jsx)(a0.Text,{variant:"subheadDefault",children:"Get started with Extensions"}),(0,m.jsxs)(O.View,{row:!0,gap:12,align:"center",children:[(0,m.jsx)(O.View,{row:!0,gap:2,align:"center",justify:"center",children:Array.from({length:v.length}).map(function(e,t){return(0,m.jsx)(O.View,{css:[i8.rcss.borderRadius(8),i8.rcss.width(12),i8.rcss.height(4),t<g?i8.rcss.backgroundColor.accentPositiveDefault:i8.rcss.backgroundColor.backgroundHighest]},t)})}),(0,m.jsx)(a0.Text,{multiline:!1,variant:"small",color:"dimmer",children:"".concat(g,"/").concat(v.length)}),(0,m.jsx)(lz.IconButton,{alt:"Hide section",onClick:i,children:(0,m.jsx)(cp.default,{})})]})]})}),(0,m.jsx)(O.View,{tag:"ul",css:[i8.rcss.flex.wrap,{listStyleType:"none",gap:A.tokens.space8}],row:!0,children:v.map(function(e,t){return(0,m.jsx)(vs,(0,x._)({},e),t)})})]})})};var vu=e.i(530310);function vc(e){var t=e.performPaneOperation,n=e.setSelectedTab,r=mW(),i=r.__status,a=r.parsed,o=r.state,s=r.updateString;if("loading"===i)return(0,m.jsx)(mH,{});if("fileReadError"===i)return(0,m.jsx)(mY,{message:(null==o?void 0:o.fileReadError)||"Unknown error"});if("fileParseError"===i){var l=a.error;return(0,m.jsx)(mQ,{performPaneOperation:t,manifestPath:o.manifestPath,error:l})}var u=a.manifest;return"success"===i&&u?(0,m.jsxs)(O.View,{css:[i8.rcss.width("100%")],pt:12,gap:24,align:"center",children:[(0,m.jsx)(m6,{performPaneOperation:t,setSelectedTab:n}),(0,m.jsx)(vl,{setSelectedTab:n}),(0,m.jsx)(O.View,{css:[i8.rcss.border({direction:"bottom",width:4,color:A.tokens.outlineDimmest}),i8.rcss.width("100%")]}),(0,m.jsxs)(O.View,{gap:8,css:[i8.rcss.width("100%")],children:[(0,m.jsxs)(O.View,{gap:2,children:[(0,m.jsxs)(O.View,{row:!0,gap:8,align:"center",children:[(0,m.jsx)(vu.default,{}),(0,m.jsx)(a0.Text,{variant:"subheadDefault",multiline:!1,children:"Permission Scopes"})]}),(0,m.jsxs)(a0.Text,{variant:"small",color:"dimmer",children:["Let users know what your Extension can do with their data. For more information,"," ",(0,m.jsx)("a",{href:aQ.LINKS_DOCS.EXTENSIONS+"/api/manifest#scopetype",target:"_blank",rel:"noopener",children:"read the docs"}),"."]})]}),(0,m.jsx)(O.View,{css:[i8.rcss.borderRadius(4),i8.rcss.border({color:A.tokens.outlineDimmest,width:1}),i8.rcss.flex.row,i8.rcss.align.center,i8.rcss.p(8),i8.rcss.flex.wrap,{gap:12},i8.rcss.width("fit-content")],children:mf.scopes.map(function(e){var t;return(0,m.jsxs)(O.View,{row:!0,gap:6,align:"center",children:[(0,m.jsx)(sE.Checkbox,{id:e.key,checked:null==(t=u.scopes)?void 0:t.some(function(t){return t.name===e.key}),onChange:function(t){var n,r,i,a=(null==(n=u.scopes)?void 0:n.some(function(t){return t.name===e.key}))&&!t?md.patch(o.manifestStr,(0,rX._)((0,x._)({},u),{scopes:null==(r=u.scopes)?void 0:r.filter(function(t){return t.name!==e.key})})):md.patch(o.manifestStr,(0,rX._)((0,x._)({},u),{scopes:(0,en._)(null!=(i=u.scopes)?i:[]).concat([{name:e.key,reason:e.description}])}));o.writeChange((0,mp.changeSetFromDiff)(o.manifestStr,a)),s(a)}}),(0,m.jsx)("label",{htmlFor:e.key,css:[i8.rcss.fontSize(12),i8.rcss.cursor.pointer],children:(0,m.jsx)("abbr",{title:e.description,css:[{textDecorationColor:A.tokens.foregroundDimmest}],children:e.friendlyName})})]},e.key)})})]}),(0,m.jsx)(vn,{performPaneOperation:t,manifest:u,update:function(e){var t=md.patch(o.manifestStr,e);o.writeChange((0,mp.changeSetFromDiff)(o.manifestStr,t)),s(t)}})]}):(0,m.jsx)("div",{children:"unknown state"})}var vd=e.i(221250),vp=e.i(542101),vf=e.i(109853),vh=e.i(410793),vg=e.i(598160),vm=(0,ro.cssRecord)({logViewerTopLevel:[i8.rcss.height("100%")],logsContainer:[i8.rcss.scrollbar.thin,i8.rcss.backgroundColor.backgroundDefault,i8.rcss.overflowY("scroll"),i8.rcss.flex.growAndShrink(1)],logViewerHeader:[i8.rcss.border({direction:"bottom",width:A.tokens.borderWidthDefault}),i8.rcss.display.flex,i8.rcss.flex.row,i8.rcss.rowWithGap(8),i8.rcss.align.center],logViewerHeaderControl:[i8.rcss.flex.row,i8.rcss.rowWithGap(4),i8.rcss.align.center],logLine:[i8.rcss.font.code,pe.interactive.listItem,i8.rcss.rowWithGap(2),i8.rcss.align.center],logLineIcon:[{alignSelf:"flex-start"}],logMessage:{flex:"1 1 0"}});function vv(e){var t=e.log,n=e.prevLevel,r=e.isLast,i=e.isFirst,a=(0,N._)((0,B.useState)(!1),2),o=a[0],s=a[1],l=(0,vp.default)().ref;return(0,m.jsxs)(O.View,{css:[i8.rcss.flex.column,function(e){if(e===vh.LogLevel.warn)return{color:A.tokens.yellowStronger,background:"rgba(150, 125, 0, 0.2)",borderTop:i?void 0:"1px solid rgba(150, 125, 0, 0.5)",borderBottom:r?"1px solid rgba(150, 125, 0, 0.5)":void 0,"& .cm-gutter":{backgroundColor:"rgba(150, 125, 0, 0.2)"}};if(e===vh.LogLevel.error)return{color:A.tokens.accentNegativeStronger,backgroundColor:"rgba(229, 34, 34, 0.2)",borderTop:i?void 0:"1px solid rgba(229, 34, 34, 0.5)",borderBottom:r?"1px solid rgba(229, 34, 34, 0.5)":void 0,"& .cm-gutter":{backgroundColor:"rgba(229, 34, 34, 0.2)"}};var t=A.tokens.backgroundHigher;return n===vh.LogLevel.warn?t="rgba(150, 125, 0, 0.5)":n===vh.LogLevel.error&&(t="rgba(229, 34, 34, 0.5)"),{color:A.tokens.foregroundDefault,borderTop:i?void 0:"1px solid ".concat(t),borderBottom:r?"1px solid ".concat(t):void 0}}(t.logLevel)],children:[(0,m.jsxs)(O.View,{css:vm.logLine,p:2,onClick:function(){return s(function(e){return!e})},children:[(0,m.jsx)(O.View,{css:vm.logLineIcon,p:4,children:(0,m.jsx)(function(){return t.logLevel===vh.LogLevel.warn?(0,m.jsx)(fi.default,{size:16}):t.logLevel===vh.LogLevel.error?(0,m.jsx)(vg.default,{size:16}):(0,m.jsx)(mj.default,{size:16,css:{opacity:0}})},{})}),(0,m.jsx)(a0.Text,{maxLines:10,css:vm.logMessage,variant:"small",children:t.message}),o?(0,m.jsx)(f4.default,{size:16}):(0,m.jsx)(p7.default,{size:16})]}),o?(0,m.jsx)(O.View,{children:(0,m.jsx)(vd.default,{ref:l,css:vf.CodeMirrorEditorStyleEditorContainer,noHistory:!0,readOnly:!0,lineWrapping:!0,language:"json",fontSize:12,initialDoc:JSON.stringify(t,null,2)})}):null]})}let vx=function(){var e=(0,sx.useExtAtomValue)(a7.filteredLogsAtom),t=(0,sx.useSetExtAtom)(a7.clearLogsAtom),n=(0,N._)((0,sx.useExtAtom)(a7.logFilterQueryAtom),2),r=n[0],i=n[1],a=(0,B.useRef)(null);return(0,B.useEffect)(function(){var e,t=a.current;t&&(null==(e=t.children[t.children.length-1])||e.scrollIntoView({behavior:"smooth"}))},[e]),(0,m.jsxs)(O.View,{css:vm.logViewerTopLevel,children:[(0,m.jsxs)(O.View,{className:"log-viewer-header",css:vm.logViewerHeader,p:8,children:[(0,m.jsx)(O.View,{css:vm.logViewerHeaderControl,style:{flexGrow:1},children:(0,m.jsx)(mb.Input,{type:"search",placeholder:"Filter logs",value:null!=r?r:"",onChange:function(e){return i(e.target.value)}})}),(0,m.jsxs)(O.View,{css:vm.logViewerHeaderControl,children:[(0,m.jsx)(lz.IconButton,{alt:"Clear logs",onClick:function(){return t()},children:(0,m.jsx)(cp.default,{id:"clear-logs"})}),(0,m.jsx)("label",{htmlFor:"clear-logs",children:"Clear logs"})]})]}),(0,m.jsx)(O.View,{css:vm.logsContainer,innerRef:a,children:e.map(function(t,n){var r;return(0,m.jsx)(vv,{log:t,prevLevel:null==(r=e[n-1])?void 0:r.logLevel,isFirst:0===n,isLast:n===e.length-1},t.index)})})]})};var vy=e.i(613141);function vw(){var e=(0,y._)(["\n  subscription ExtensionBuildLogs($extensionId: String!) {\n    extensionBuildDeployActionUpdates(input: { extensionId: $extensionId }) {\n      ... on ExtensionBuildDeployLogAction {\n        log\n      }\n      ... on ExtensionBuildDeployStatusAction {\n        status\n        message\n        build {\n          id\n        }\n      }\n    }\n  }\n"]);return vw=function(){return e},e}function vb(){var e=(0,y._)(["\n  mutation DeployExtension2(\n    $extensionId: String!\n    $replId: String!\n    $outputDirectory: String!\n    $buildCommand: String!\n  ) {\n    deployExtension2(\n      extensionId: $extensionId\n      replId: $replId\n      outputDirectory: $outputDirectory\n      buildCommand: $buildCommand\n    ) {\n      ... on Extension {\n        ...TopLevelExtension\n      }\n      ... on TooManyRequestsError {\n        message\n      }\n      ... on UserError {\n        message\n      }\n    }\n  }\n  ","\n"]);return vb=function(){return e},e}function vj(){var e=(0,y._)(["\n  query Publish2Extension($extensionId: String!) {\n    extension(id: $extensionId) {\n      ... on Extension {\n        id\n        user {\n          id\n          username\n        }\n        name\n        description\n        canDeployExtension\n      }\n      ... on NotFoundError {\n        message\n      }\n    }\n  }\n"]);return vj=function(){return e},e}function v_(){var e=(0,y._)(["\n  mutation CreateExtension($name: String!, $description: String!) {\n    createExtension(name: $name, description: $description) {\n      ... on Extension {\n        id\n        url\n      }\n      ... on UserError {\n        message\n      }\n      ... on TooManyRequestsError {\n        message\n      }\n      ... on UnauthorizedError {\n        message\n      }\n    }\n  }\n"]);return v_=function(){return e},e}function vS(){var e=(0,y._)(["\n  mutation UpdateExtension(\n    $extensionId: String!\n    $name: String\n    $description: String\n  ) {\n    updateExtension(\n      extensionId: $extensionId\n      name: $name\n      description: $description\n    ) {\n      ... on Extension {\n        id\n        name\n        description\n      }\n      ... on UserError {\n        message\n      }\n    }\n  }\n"]);return vS=function(){return e},e}var vI={},vC=(0,w.gql)(vw()),vk=(0,w.gql)(vb(),aq.TopLevelExtensionFragmentDoc),vE=(0,w.gql)(vj()),vT=(0,w.gql)(v_()),vP=(0,w.gql)(vS()),vR=e.i(322823),vA=e.i(966036),vD=O.SpecializedView.button,vV=((s={}).Pending="pending",s.Active="active",s.Complete="complete",s.Error="error",s),vO=function(){return(0,m.jsx)(O.View,{css:[i8.rcss.border({color:A.tokens.outlineDimmest,direction:"top"})],grow:!0,row:!0})},vF=function(e){var t=e.text,n=e.size,r=void 0===n?"default":n,i=e.state,a=e.onClick,o=e.disabled,s=e.hideLoadingIcon,l=(0,aZ.getTextVariant)(r),u=(0,aZ.getIconSize)(r);return(0,m.jsx)(vD,{type:"button",css:[i8.rcss.reset.button,i8.rcss.position.relative,a&&pe.interactive.nofill,i8.rcss.px(8),i8.rcss.py(2),i8.rcss.borderRadius(4),i8.rcss.rowWithGap(4),i8.rcss.align.center,{borderRadius:A.tokens.borderRadiusRound}].concat((0,en._)("error"===i?[i8.rcss.color.accentNegativeStronger]:"active"===i?[i8.rcss.backgroundColor.accentPrimaryDimmer,i8.rcss.color.accentPrimaryStrongest]:"complete"===i?[i8.rcss.color.accentPositiveStronger]:[i8.rcss.color.foregroundDimmest])),onClick:a,disabled:o,children:(0,m.jsx)(aZ.ButtonContent,{text:t,iconSize:u,textVariant:l,iconRight:function(){if("error"===i)return(0,m.jsx)(fi.default,{});if("active"===i){if(s)return;return(0,m.jsx)(dA.default,{})}return"complete"===i?(0,m.jsx)(p8.default,{}):(0,m.jsx)(vu.default,{})}()})})},vM=e.i(210481),vL=e.i(818976),vG=e.i(972882),vU=e.i(525212),vN=((l=vN||{}).Details="Details",l.Init="Init",l.CreatingExtension="CreatingExtension",l.CreatingExtensionError="CreatingExtensionError",l.Queued="Queued",l.Deploying="Deploying",l.DeployError="DeployError",l.Success="Success",l),vB=["CreatingExtension","Deploying"],vW=((u=vW||{}).Details="Details",u.Init="Configure",u.Create="Create",u.Deploy="Deploy",u),vz=["Details","Configure","Deploy"];function vH(e){var t,n,r,i,a,o=e.performPaneOperation,s=(0,a9.default)(),l=s.container,u=s.fs,c=s.dotReplit,d=(0,N._)((t=(0,x._)({},vI,void 0),j.useLazyQuery(vE,t)),1)[0],p=(0,vr.useDismissibleElement)("extensions-onboarding-checklist-".concat("publish")).setAsDone,f=(0,N._)((0,B.useState)(null),2),h=f[0],g=f[1],v=(0,N._)((0,B.useState)("Details"),2),y=v[0],w=v[1],b=(0,N._)((0,B.useState)(null),2),_=b[0],S=b[1],I=mW(),C=I.__status,k=I.parsed,E=I.state,T=I.updateManifest,P=(0,vR.useFormField)("",function(e){return e?e.startsWith("/")?{message:'Folder must be relative to the root of your project (e.g. "extension" or "./extension")',severity:"error"}:null:{message:"Output folder is required",severity:"error"}}),R=P.value,D=P.setValue,F=P.error,M=P.validate,L=(0,N._)((0,B.useState)([]),2),G=L[0],U=L[1],z=(0,B.useCallback)(function(e){return o({operation:"open",secondary:!0,pane:{type:(0,ti.getPaneTypeForFile)(e),data:e}})},[o]),H=(0,N._)((0,vM.default)({openFile:z,listFiles:u.listFiles}),2),q=H[0],K=H[1],$=(0,vL.useTerminalTheme)();n=(0,x._)({},vI,{variables:{extensionId:null!=h?h:""},onData:function(e){var t=e.data;if(t.data&&!t.error){var n=t.data.extensionBuildDeployActionUpdates;"ExtensionBuildDeployLogAction"===n.__typename&&U(function(e){return(0,en._)(e).concat((0,en._)(n.log))}),"ExtensionBuildDeployStatusAction"===n.__typename&&(n.status===pv.HostingBuildStatus.Success?w("Success"):n.status===pv.HostingBuildStatus.Failed&&w("DeployError"))}},skip:"Deploying"!==y||!h}),vy.useSubscription(vC,n),(0,B.useEffect)(function(){q&&(q.clear(),G.forEach(function(e){q.write(e.replaceAll("\n","\r\n"))}))},[G,q]);var Q=(0,B.useCallback)(function(e){if(null==e?void 0:e.config){var t=e.config.extension;if(!t||!1===t.isExtension){g(null),S(null),D(null);return}t.buildCommand&&S(t.buildCommand),t.outputDirectory&&D(t.outputDirectory),t.extensionID&&g(t.extensionID)}},[D]);(0,B.useEffect)(function(){var e=!1;return(0,er._)(function(){var t;return(0,ei._)(this,function(n){switch(n.label){case 0:return[4,c.getConfig()];case 1:if(t=n.sent(),e)return[2];return Q(t),[2]}})})(),function(){e=!0}},[c,Q]);var Y=(0,B.useCallback)(function(e){return(0,er._)(function(){return(0,ei._)(this,function(t){switch(t.label){case 0:return g(e),[4,c.updateDotReplit([{op:"add",path:"extension/extensionID",value:JSON.stringify(e)},{op:"add",path:"extension/isExtension",value:JSON.stringify(!0)}])];case 1:return t.sent(),[2]}})})()},[c]),X=(0,B.useCallback)(function(e){return(0,er._)(function(){return(0,ei._)(this,function(t){switch(t.label){case 0:return S(e),[4,c.updateDotReplit([{op:"add",path:"extension/buildCommand",value:JSON.stringify(e)},{op:"add",path:"extension/isExtension",value:JSON.stringify(!0)}])];case 1:return t.sent(),[2]}})})()},[c]),J=(0,N._)((0,B.useState)(null),2),Z=J[0],ee=J[1],et=(0,N._)((0,B.useState)(null),2),ea=et[0],eo=et[1],eu=(0,N._)((0,B.useState)(null),2),ec=eu[0],ed=eu[1],ep=(0,N._)((0,B.useState)(null),2),ef=ep[0],eh=ep[1],eg=(0,N._)((0,B.useState)(null),2),em=eg[0],ev=eg[1],ex=(0,N._)((r=(0,x._)({},vI,void 0),W.useMutation(vk,r)),1)[0],ey=(0,aJ.default)(),ew=(0,N._)((i=(0,x._)({},vI,void 0),W.useMutation(vT,i)),1)[0],eb=(0,N._)((0,B.useState)(null),2),ej=eb[0],e_=eb[1],eS=(0,B.useCallback)(function(e){var t=e.name,n=e.description;return(0,er._)(function(){var e,r,i;return(0,ei._)(this,function(a){switch(a.label){case 0:return[4,ew({variables:{name:t,description:n}})];case 1:if((r=a.sent()).errors)return[2,{error:r.errors.map(function(e){return e.message}).join(", "),result:null}];if(!(i=null==(e=r.data)?void 0:e.createExtension))return[2,{error:"Failed to create extension",result:null}];if("TooManyRequestsError"===i.__typename||"UserError"===i.__typename||"UnauthorizedError"===i.__typename)return[2,{error:"Failed to create extension: "+i.message,result:null}];if("Extension"===i.__typename)return[2,{error:null,result:i}];throw Error("Unexpected response from createExtension mutation")}})})()},[ew]),eI=(0,N._)((a=(0,x._)({},vI,void 0),W.useMutation(vP,a)),1)[0],eC=(0,B.useCallback)(function(){return(0,er._)(function(){var e,t,n,r,i,a,o,s,c,f,g,m,v,x,y,b,j,S;return(0,ei._)(this,function(I){switch(I.label){case 0:return e=h,[4,M()];case 1:if(null==(t=I.sent())?void 0:t.message)return ed(null==t?void 0:t.message),[2];if(!R)throw Error("expected output folder");return n=(0,sp.normalizePath)(R),(r=function(){w("Init"),U([]),ev(null),ed(null),eo(null),ee(null)})(),[4,u.flush()];case 2:if(I.sent(),!e)return[3,11];return[4,d({variables:{extensionId:e}})];case 3:if((i=I.sent()).error||!i.data)throw Error("Encountered an unknown error. Please contact support.");if((null==(a=i.data.extension)?void 0:a.__typename)!=="NotFoundError")return[3,5];return[4,new Promise(function(t){e_({message:"The extension referenced in .replit (".concat(e,") does not exist. Would you like to create a new extension?"),callback:function(e){e_(null),t(e)}})})];case 4:case 6:if(!I.sent())return r(),[2];return e=null,[3,11];case 5:if(!((null==a?void 0:a.__typename)==="Extension"&&!a.canDeployExtension))return[3,7];return[4,new Promise(function(t){e_({message:"You do not have the permissions to deploy the extension referenced in .replit (".concat(e,"). Would you like to create a new extension?"),callback:function(e){e_(null),t(e)}})})];case 7:if(!((null==a?void 0:a.__typename)==="Extension"&&a.canDeployExtension))return[3,10];if(c=null==k||null==(o=k.manifest)?void 0:o.name,f=null==k||null==(s=k.manifest)?void 0:s.description,!(c&&c!==a.name||f&&f!==a.description))return[3,9];return[4,eI({variables:{extensionId:e,description:null!=f?f:void 0,name:null!=c?c:void 0}})];case 8:I.sent(),I.label=9;case 9:return[3,11];case 10:throw Error("Encountered an unknown error. Please contact support.");case 11:if(e)return[3,13];return w("CreatingExtension"),[4,eS({name:null!=(v=null==k||null==(g=k.manifest)?void 0:g.name)?v:"My extension",description:null!=(x=null==k||null==(m=k.manifest)?void 0:m.description)?x:"My extension's description"})];case 12:if(null!==(y=I.sent()).error)return w("CreatingExtensionError"),eh(y.error),[2];Y(e=y.result.id),I.label=13;case 13:var C;if(!e)throw Error("expected extension id to be set");return[4,(C=n,new Promise(function(e){var t=l.openChannel({service:"gcsfiles"},function(n){return n.channel.request({persistMirror:{path:C}}).then(function(n){n.ok,t(),e()}),function(e){e.willReconnect&&t()}})}))];case 14:I.sent(),w("Queued"),I.label=15;case 15:return I.trys.push([15,17,,18]),[4,ex({variables:{extensionId:e,replId:ey,outputDirectory:n,buildCommand:null!=_?_:""}})];case 16:return b=I.sent(),[3,18];case 17:if(j=I.sent(),w("DeployError"),j.message.includes("received message larger than max"))return ev("Your extension's size is too large. Please compress assets or remove files, and try again."),[2];return ev(j.message),[2];case 18:if(b.errors)return w("DeployError"),ev("Internal error. Please contact support: "+b.errors.map(function(e){return e.message}).join(", ")),[2];if(!b.data)return w("DeployError"),ev("Encountered an unknown error. Please contact support."),[2];if("Extension"===(S=b.data.deployExtension2).__typename)return w("Deploying"),p(),(0,es.track)(el.events.EXTENSION_USED,{action:"developer_onboarding_completed",step:"publish"}),ee(S),[2];if("message"in S)return w("DeployError"),ev(S.message),[2];return w("DeployError"),ev("Encountered an unknown error. Please contact support."),[2]}})})()},[_,l,R,M,ey,u,w,ex,d,eI,h,eS,Y,p,k]),ek=function(e){switch(e){case"Details":default:return"Details";case"Init":return"Configure";case"CreatingExtension":case"CreatingExtensionError":return"Create";case"Queued":case"Deploying":case"DeployError":return"Deploy"}}(y),eE=vz.indexOf(ek);function eT(){return ea?"Build error: ".concat(ea):ec?"Validation error: ".concat(ec):ec?"Create extension error: ".concat(ef):em?"Deploy error: ".concat(em):void 0}var eP=(0,a7.useExtensions)().find(function(e){return e.extensionId===h}),eR=(0,N._)((0,B.useState)(!1),2),eA=eR[0],eD=eR[1],eV=(0,oe.useInstallExtension)(),eO=(0,B.useMemo)(function(){return eA?(0,m.jsx)(dA.default,{}):eP?(0,m.jsx)(p8.default,{}):(0,m.jsx)(m0.default,{})},[eA,eP]),eF=(0,sy.useTheme)().values.global,eM=(0,fb.useConfetti)().fireBurst,eL=(0,N._)((0,B.useState)(!1),2),eG=eL[0],eU=eL[1],eN=(0,B.useRef)(null);if((0,B.useEffect)(function(){eN.current&&!eG&&"Success"===y&&(eM({x:eN.current.getBoundingClientRect().left,y:eN.current.getBoundingClientRect().top,heading:-45,numParticles:160,lifetime:1,spread:80,velocity:function(){return(0,vA.randNum)(300,5e3)},size:function(){return{width:(0,vA.randNum)(8,16),height:(0,vA.randNum)(8,16)}},color:[eF.tealStronger,eF.blurpleStronger,eF.yellowStronger]}),eM({x:eN.current.getBoundingClientRect().right,y:eN.current.getBoundingClientRect().top,heading:225,numParticles:160,lifetime:1,velocity:function(){return(0,vA.randNum)(300,5e3)},size:function(){return{width:(0,vA.randNum)(8,16),height:(0,vA.randNum)(8,16)}},color:[eF.blueStronger,eF.greenStronger,eF.pinkStronger]}),eU(!0))},[y,eF,eM,eG]),C===mz.loading)return(0,m.jsx)(mH,{});if(C===mz.fileReadError)return(0,m.jsx)(mY,{message:E.fileReadError});var eB=k.manifest,eW=k.error;return eW?(0,m.jsx)(mQ,{performPaneOperation:o,manifestPath:E.manifestPath,error:eW}):(0,m.jsxs)(O.View,{css:[i8.rcss.flex.column,i8.rcss.display.flex,i8.rcss.height("100%"),i8.rcss.justify.center,i8.rcss.align.center,i8.rcss.position.relative],children:[(0,m.jsx)(O.View,{css:[i8.rcss.position.absolute,i8.rcss.top(0),i8.rcss.left(0),i8.rcss.right(0)],className:"Confetti",innerRef:eN}),(0,m.jsxs)(O.View,{css:[i8.rcss.width("100%"),i8.rcss.maxWidth(mc.PANE_CONTENT_MAX_WIDTH)],grow:!0,shrink:!0,p:12,pt:16,gap:24,children:["Success"!==y?(0,m.jsxs)(m.Fragment,{children:[(0,m.jsxs)(O.View,{gap:16,children:[(0,m.jsx)(a0.Text,{variant:"subheadBig",multiline:!0,children:"Create a new release"}),(0,m.jsx)(O.View,{row:!0,gap:4,align:"center",children:vz.map(function(e,t){var n;return(0,m.jsxs)(B.Fragment,{children:[0!==t&&(0,m.jsx)(vO,{}),(0,m.jsx)(vF,{state:(n=t)<eE?vV.Complete:n!==eE?vV.Pending:["CreatingExtensionError","DeployError"].includes(y)?vV.Error:vV.Active,text:e,hideLoadingIcon:"Configure"===e||"Details"===e})]},e)})})]}),"Details"===y?(0,m.jsx)(O.View,{css:[i8.rcss.flex.column,i8.rcss.colWithGap(8),i8.rcss.width("100%")],children:(0,m.jsx)(m5,{manifest:eB,updateManifest:T,onSubmit:function(e){T((0,x._)({},eB,e)),w("Init")}})}):null,"Details"!==y?(0,m.jsxs)(m.Fragment,{children:[(0,m.jsxs)(O.View,{gap:16,children:[(0,m.jsxs)(O.View,{row:!0,gap:8,align:"center",children:[(0,m.jsx)(s1.default,{}),(0,m.jsx)(a0.Text,{variant:"subheadDefault",children:"Build settings"}),(0,m.jsx)(O.View,{css:[i8.rcss.border({color:A.tokens.backgroundHighest,direction:"y"})],grow:!0})]}),(0,m.jsxs)(O.View,{gap:4,children:[(0,m.jsxs)("label",{htmlFor:"buildCommand",css:[i8.rcss.display.flex,i8.rcss.rowWithGap(4),i8.rcss.align.center],children:[(0,m.jsx)(a0.Text,{color:"dimmer",variant:"small",children:"Build command (optional)"}),(0,m.jsx)(d3.Tooltip,{tooltip:"This is the command that compiles your app at build time. Leave it blank if you don't need to build your app.",children:(0,m.jsx)(mj.default,{size:12})})]}),(0,m.jsx)(mb.Input,{value:null!=_?_:"",onChange:function(e){return X(e.target.value)},placeholder:"Example: npm run build",disabled:"Init"!==y&&vB.includes(y)})]}),(0,m.jsxs)(O.View,{gap:4,children:[(0,m.jsxs)("label",{htmlFor:"outputFolder",css:[i8.rcss.display.flex,i8.rcss.rowWithGap(4),i8.rcss.align.center],children:[(0,m.jsx)(a0.Text,{color:"dimmer",variant:"small",children:"Output folder"}),(0,m.jsx)(d3.Tooltip,{tooltip:"This is where your build will live. There must be an extension.json file in this folder.",children:(0,m.jsx)(mj.default,{size:12})})]}),(0,m.jsx)(mb.Input,{id:"outputFolder",value:null!=R?R:"",disabled:"Init"!==y&&vB.includes(y),onChange:function(e){D(e.currentTarget.value),c.updateDotReplit([{op:"add",path:"extension/outputDirectory",value:JSON.stringify(e.currentTarget.value)},{op:"add",path:"extension/isExtension",value:JSON.stringify(!0)}])},placeholder:"./extension"}),F?(0,m.jsx)(a0.Text,{css:[i8.rcss.color.accentNegativeStronger],children:F.message}):null]}),(0,m.jsx)(aZ.Button,{text:"Init"===y||y.endsWith("Error")?"Deploy and Release":"Deploying",iconLeft:"Init"===y||y.endsWith("Error")?(0,m.jsx)(sJ.default,{}):(0,m.jsx)(dA.default,{}),onClick:eC,disabled:"Init"!==y&&vB.includes(y),colorway:"primary"}),(0,m.jsxs)(a0.Text,{multiline:!0,variant:"small",color:"dimmer",children:["By releasing an Extension, you agree to the"," ",(0,m.jsx)("a",{href:aQ.LINKS_LEGAL.EXTENSIONS_DEVELOPER_TERMS,children:"Developer Terms"})]})]}),G.length>0?(0,m.jsxs)(O.View,{gap:8,children:[(0,m.jsxs)(O.View,{row:!0,gap:8,align:"center",children:[(0,m.jsx)(vU.default,{}),(0,m.jsx)(a0.Text,{variant:"subheadDefault",children:"Build logs"}),(0,m.jsx)(O.View,{css:[i8.rcss.border({color:A.tokens.backgroundHighest,direction:"y"})],grow:!0})]}),eT()?(0,m.jsx)(f2.StatusBanner,{text:eT(),colorway:"red",icon:(0,m.jsx)(vg.default,{})}):null,(0,m.jsx)(O.View,{css:[i8.rcss.display.flex,i8.rcss.py(12),i8.rcss.pl(16),i8.rcss.borderRadius(8),i8.rcss.overflow("hidden"),{border:"1px solid ".concat(A.tokens.outlineDimmest),backgroundColor:null==$?void 0:$.background}],children:(0,m.jsx)(O.SpecializedView.div,{css:[i8.rcss.width("100%"),i8.rcss.maxWidth("100%")],ref:K})})]}):null,ej?(0,m.jsxs)(V.Surface,{elevated:!0,css:[i8.rcss.borderRadius(8)],p:8,gap:8,children:[(0,m.jsx)(a0.Text,{variant:"text",multiline:!0,maxLines:3,children:ej.message}),(0,m.jsxs)(O.View,{row:!0,gap:4,align:"center",children:[(0,m.jsx)(aZ.Button,{text:"No",css:[i8.rcss.flex.grow(1)],onClick:function(){return ej.callback(!1)}}),(0,m.jsx)(aZ.Button,{text:"Yes",colorway:"primary",css:[i8.rcss.flex.grow(1)],onClick:function(){return ej.callback(!0)}})]})]}):null]}):null]}):null,Z&&"Success"===y?(0,m.jsxs)(O.View,{gap:16,children:[(0,m.jsxs)(O.View,{gap:4,children:[(0,m.jsx)(a0.Text,{variant:"subheadBig",multiline:!1,children:"Congratulations!"}),(0,m.jsx)(a0.Text,{color:"dimmer",multiline:!1,children:"You just published a new release to the Extensions Store."})]}),(0,m.jsx)(O.View,{py:8,children:(0,m.jsx)(vG.ExtensionCard,{showMetadata:!1,extension:Z,onClick:function(){o({operation:"open",pane:{type:"extensionStore",data:{page:"cover",coverPageExtensionId:(0,aY.asExtensionId)(Z.id)}}})}})}),(0,m.jsxs)(O.View,{row:!0,gap:8,align:"center",children:[(0,m.jsx)(vi.default,{}),(0,m.jsx)(a0.Text,{variant:"subheadDefault",multiline:!1,children:"Next steps"}),(0,m.jsx)(O.View,{css:[i8.rcss.border({color:A.tokens.backgroundHighest,direction:"y"})],grow:!0})]}),(0,m.jsxs)(O.View,{css:[i8.rcss.border({color:A.tokens.outlineDimmest}),i8.rcss.borderRadius(8)],p:12,gap:8,children:[(0,m.jsx)(a0.Text,{variant:"subheadDefault",children:"Install your Extension"}),(0,m.jsx)(a0.Text,{color:"dimmer",children:"Once installed, you can use the extension in any of your Apps."}),(0,m.jsx)(aZ.Button,{text:eP?"Already installed":"Install Extension",colorway:eP?"green":"primary",disabled:eA||!!eP,iconLeft:eO,loading:eA,onClick:function(){return(0,er._)(function(){return(0,ei._)(this,function(e){switch(e.label){case 0:return eD(!0),[4,eV({extensionId:(0,aY.asExtensionId)(Z.id),replId:null})];case 1:return e.sent(),eD(!1),[2]}})})()}})]})]}):null]})]})}var vq=e.i(545969),vK=e.i(618497);function v$(e){var t=e.performPaneOperation,n=(0,N._)((0,B.useState)("home"),2),r=n[0],i=n[1];return(0,m.jsx)(O.View,{css:[i8.rcss.flex.column,i8.rcss.height("100%"),i8.rcss.position.relative],children:(0,m.jsx)("div",{css:[i8.rcss.flex.grow(1),i8.rcss.flex.column,i8.rcss.align.center,i8.rcss.display.flex,i8.rcss.overflow("hidden")],children:(0,m.jsxs)(vq.Tabs,{selectedKey:r,onSelectionChange:function(e){return i(e)},children:[(0,m.jsx)(V.Surface,{css:[i8.rcss.top(0),i8.rcss.width("100%"),i8.rcss.zIndex(1)],align:"center",children:(0,m.jsxs)(vq.TabList,{css:[i8.rcss.align.center,i8.rcss.width("100%"),i8.rcss.pb(0),i8.rcss.maxWidth(mc.PANE_CONTENT_MAX_WIDTH)],children:[(0,m.jsx)(vq.Tab,{id:"home",css:[i8.rcss.p(12),i8.rcss.height("100%"),i8.rcss.borderRadius(0)],iconLeft:(0,m.jsx)(f3.default,{}),children:"Home"}),(0,m.jsx)(vq.Tab,{id:"releases",css:[i8.rcss.p(12),i8.rcss.height("100%"),i8.rcss.borderRadius(0)],iconLeft:(0,m.jsx)(vK.default,{}),children:"Releases"}),(0,m.jsx)(vq.Tab,{id:"logs",css:[i8.rcss.p(12),i8.rcss.height("100%"),i8.rcss.borderRadius(0)],iconLeft:(0,m.jsx)(vg.default,{}),children:"Logs"}),(0,m.jsx)(O.View,{grow:!0}),(0,m.jsx)(V.Surface,{css:[{boxShadow:"inset 0 -1px 0 ".concat(A.tokens.outlineDimmest)}],p:8,children:(0,m.jsx)(pQ.ButtonLink,{text:"Docs",href:aQ.LINKS_DOCS.EXTENSIONS,target:"_blank",rel:"noopener",variant:"outlined",size:"small",iconLeft:(0,m.jsx)(fI.default,{}),css:[i8.rcss.display.inlineFlex]})})]})}),(0,m.jsx)("div",{css:[i8.rcss.flex.grow(1),i8.rcss.align.center,i8.rcss.justify.center,i8.rcss.width("100%"),i8.rcss.display.flex,i8.rcss.overflow("hidden")],children:(0,m.jsxs)(vq.TabPanels,{children:[(0,m.jsx)(vq.TabPanel,{id:"home",css:[i8.rcss.height("100%"),i8.rcss.p(12),i8.rcss.maxWidth(mc.PANE_CONTENT_MAX_WIDTH),i8.rcss.display.flex,i8.rcss.width("100%"),i8.rcss.justify.center,i8.rcss.overflowY("scroll")],children:(0,m.jsx)(vc,{performPaneOperation:t,setSelectedTab:i})}),(0,m.jsx)(vq.TabPanel,{id:"releases",css:[i8.rcss.height("100%"),i8.rcss.width("100%"),i8.rcss.overflowY("scroll")],children:(0,m.jsx)(vH,{performPaneOperation:t})}),(0,m.jsx)(vq.TabPanel,{id:"logs",css:[i8.rcss.height("100%"),i8.rcss.width("100%")],children:(0,m.jsx)(vx,{})})]})})]})})})}var vQ=ex.Type.Object({type:ex.Type.Literal("extensionDevtools")}),vY={Content:function(e){var t=e.options.performPaneOperation;return(0,m.jsx)(v$,{performPaneOperation:t})},Icon:function(e){var t=e.size;return(0,m.jsx)(sC.default,{size:t})},getTitle:function(){return"Extensions Devtools"},description:"Manage and debug workspace extensions",category:g8.PaneCategory.WorkspaceExtensions,decode:function(e){return sn.Value.Decode(vQ,e)}},vX=e.i(678486),vJ=e.i(495954);function vZ(e){var t=rr(nU),n=(0,oe.useInstallExtension)(),r=(0,oe.useUninstallExtension)(),i=(0,a7.useExtensions)(),a=(0,B.useCallback)(function(n,r){if("cover"===n){if(null===r)return void a("store",null);t({paneId:e.paneId,pane:{type:"extensionStore",data:{coverPageExtensionId:null!=r?r:null,page:"cover"}}})}else t({paneId:e.paneId,pane:{type:"extensionStore",data:{page:n}}})},[t,e.paneId]);if("cover"===e.page){var o,s,l=null!=(s=null==(o=i.find(function(t){return t.extensionId===e.coverPageExtensionId}))?void 0:o.installationId)?s:null;return(0,m.jsx)(vX.ExtensionCoverPage,{existingInstallationId:l,extensionId:e.coverPageExtensionId,goBackToStore:function(){return a("store",null)},installExtension:function(){return(0,er._)(function(){var t;return(0,ei._)(this,function(r){switch(r.label){case 0:return[4,n({extensionId:e.coverPageExtensionId,replId:null})];case 1:if(!(t=r.sent()))throw Error("Failed to install extension");return[2,(0,aY.asInstallationId)(t.id)]}})})()},uninstallExtension:function(e){return(0,er._)(function(){return(0,ei._)(this,function(t){switch(t.label){case 0:return[4,r({installationId:e,replId:null})];case 1:return t.sent(),[2]}})})()}})}return(0,m.jsx)(vJ.default,{storeMode:"pane",openExtensionCover:function(e){return a("cover",e)},setPage:function(e){return a(e,null)},page:e.page})}var v0=ex.Type.Union([ex.Type.Object({page:ex.Type.Union([ex.Type.Literal("store"),ex.Type.Literal("manage")])}),ex.Type.Object({page:ex.Type.Literal("cover"),coverPageExtensionId:ex.Type.Unsafe(ex.Type.String())})]),v1=ex.Type.Object({type:ex.Type.Literal("extensionStore"),data:v0}),v2={Content:function(e){return(0,m.jsx)(vZ,(0,rX._)((0,x._)({},e.pane.data),{paneId:e.options.paneId}))},Icon:function(e){var t=e.size;return(0,m.jsx)(p3.IconContext.Provider,{value:{color:A.tokens.yellowStronger,size:t},children:(0,m.jsx)(sC.default,{})})},getTitle:function(){return"Extension Store"},description:"Find and install workspace extensions",category:g8.PaneCategory.WorkspaceExtensions,decode:function(e){return sn.Value.Decode(v1,e)}},v4=e.i(257042),v8=ex.Type.Object({type:ex.Type.Literal("replAuth")}),v3=e.i(353384),v6={Content:v4.default,Icon:function(e){var t=e.size;return(0,m.jsx)(p3.IconContext.Provider,{value:{color:A.tokens.orangeStrongest,size:t},children:(0,m.jsx)(v3.default,{})})},getTitle:function(){return"Authentication"},description:"Let users log in to your App using a prebuilt login page or customize your own button",category:g8.PaneCategory.CloudServices,decode:function(e){return sn.Value.Decode(v8,e)}},v5=function(e){var t;null==(t=e.focus)||t.call(e)};function v9(e){var t=e.isValid,n=e.move,r=e.focus,i=void 0===r?v5:r,a=e.wrap,o=void 0!==a&&a,s=e.selector,l=e.boundary,u=(0,B.useRef)(null);return(0,B.useEffect)(function(){if(u.current){var e=u.current,r=function(r){if(!t(r))return;if(s)p=(0,en._)(e.querySelectorAll(s));else{var a;a=e.querySelectorAll('a[href],button,input,textarea,select,details,[tabindex]:not([tabindex="-1"])'),p=(0,en._)(a)}if(0!==p.length){var u=document.activeElement;if(e.contains(u)){if(s)if(l){var c=null==u?void 0:u.closest(l),d=null==u?void 0:u.closest(s);u=d||(null==c?void 0:c.querySelector(s))}else u=null==u?void 0:u.closest(s);if(s&&(!u||!e.contains(document.activeElement))){r.preventDefault(),r.stopPropagation();var p,f,h=null==(f=document.activeElement)?void 0:f.querySelector(s);h?i(h):i(p[0]);return}if(!u){r.preventDefault(),r.stopPropagation(),i(p[0]);return}var g=p.findIndex(function(e){return e===u});if(-1===g){r.preventDefault(),r.stopPropagation(),i(p[0]);return}var m=n({event:r,children:p,activeIndex:g,activeElement:u});!o&&(m<0||m>p.length-1)||(i(m<0?p[p.length-1]:m>p.length-1?p[0]:p[m]),r.stopPropagation(),r.preventDefault())}}};return e.addEventListener("keydown",r),function(){e.removeEventListener("keydown",r)}}},[l,t,n,i,u,s,o]),u}var v7=e.i(712516),xe=e.i(624782),xt=e.i(752723),xn=(0,ro.cssRecord)({queryPill:[i8.rcss.display.inline,i8.rcss.fontSize(A.tokens.fontSizeDefault)],popover:[{"& > .popover-control-container":i8.rcss.mr(0)}]});function xr(e){var t=e.text;return(0,m.jsx)(xe.Pill,{css:xn.queryPill,text:0===t.length?"":t})}function xi(e){var t=e.query,n=e.replacement,r=e.numMatches,i=e.onCancel,a=e.onConfirm;return(0,m.jsxs)(O.View,{gap:8,p:12,children:[(0,m.jsxs)(O.View,{children:[(0,m.jsxs)(a0.Text,{children:["Replace ",(0,m.jsx)(xr,{text:t})," with"," ",(0,m.jsx)(xr,{text:n})," in"," ",(0,cE.default)("match",r,!0),"?"]}),(0,m.jsx)(a0.Text,{children:"This operation cannot be undone!"})]}),(0,m.jsxs)(O.View,{row:!0,gap:12,justify:"end",children:[(0,m.jsx)(aZ.Button,{onClick:function(){return i()},text:"Cancel"}),(0,m.jsx)(aZ.Button,{colorway:"negative",onClick:function(){return a()},text:"Yes, replace ".concat((0,cE.default)("match",r,!0)),iconLeft:(0,m.jsx)(xt.default,{})})]})]})}function xa(e){var t=e.disabled,n=e.loading,r=e.query,i=e.replacement,a=e.results,o=e.replace,s=e.onReplace,l=e.buttonProps,u=(0,N._)((0,B.useState)(!1),2),c=u[0],d=u[1],p=(0,B.useMemo)(function(){return a.reduce(function(e,t){return e+t.lines.reduce(function(e,t){return e+t.matches.length},0)},0)},[a]);return(0,m.jsx)(O.View,{css:xn.popover,children:(0,m.jsxs)(pt.PopoverTrigger,{onOpenChange:d,label:"Confirm replace all",isOpen:c,children:[(0,m.jsx)(aZ.Button,(0,rX._)((0,x._)({},l),{text:"Replace all",disabled:t||n,onClick:function(){d(function(e){return!e})}})),(0,m.jsx)(xi,{query:r,replacement:i,numMatches:p,onCancel:function(){return d(!1)},onConfirm:function(){return(0,er._)(function(){return(0,ei._)(this,function(e){switch(e.label){case 0:return d(!1),(0,es.track)(el.events.SEARCH_PANE_USED,{action:"replace"}),[4,o()];case 1:return e.sent().success&&s(),[2]}})})()}})]})})}var xo=e.i(551959),xs=(0,ro.cssRecord)({self:[i8.rcss.position.relative,i8.rcss.flex.shrink(1),i8.rcss.width("100%")],iconWrapper:[i8.rcss.position.absolute,i8.rcss.top(0),i8.rcss.right(0),i8.rcss.height("100%"),i8.rcss.p(4)]}),xl=(0,B.forwardRef)(function(e,t){var n,r=e.onClear,i=(0,ll._)(e,["onClear"]);return(0,m.jsxs)(O.View,{css:xs.self,children:[(0,m.jsx)(xo.MultiLineInputWithHistory,(0,x._)({ref:t},i)),((null==(n=i.value)?void 0:n.length)||0)>0?(0,m.jsx)(O.View,{css:xs.iconWrapper,children:(0,m.jsx)(lz.IconButton,{alt:"Clear search query",tooltipBehavior:"hidden",onClick:r,css:{"&:hover":{backgroundColor:"".concat(A.tokens.backgroundHighest," !important")}},children:(0,m.jsx)(cp.default,{})})}):null]})});xl.displayName="SearchInput";var xu=e.i(294751),xc=e.i(163793),xd=e.i(790486),xp=(0,ro.cssRecord)({self:[i8.rcss.width("fit-content"),i8.rcss.display.inlineBlock,i8.rcss.color.accentNegativeDefault,i8.rcss.fontWeight.bold]});function xf(e){var t=e.content;return(0,m.jsx)(m.Fragment,{children:t.split("\n").reduce(function(e,t,n){return null===e?[t]:(0,en._)(e).concat([(0,m.jsx)(O.SpecializedView.span,{css:xp.self,children:"\\n"},"".concat(t,"-").concat(n)),t])},null)})}var xh=e.i(352701),xg=O.SpecializedView.span,xm="SearchMatch",xv=((c=xv||{}).HIGHLIGHT="highlight",c.REMOVE="remove",c.ADD="add",c.TEXT="text",c);function xx(e){return{outlineColor:e,outlineWidth:"1px",outlineStyle:"solid"}}var xy=(0,ro.cssRecord)((g={self:[i8.rcss.width("fit-content"),i8.rcss.display.inline,i8.rcss.cursor.pointer,{"&:focus-visible":[i8.rcss.focusRing]},i8.rcss.mx(1),i8.rcss.px(2),i8.rcss.borderRadius(4)]},(0,P._)(g,"highlight",[i8.rcss.backgroundColor.accentPrimaryDimmest,xx(A.tokens.accentPrimaryDimmer)]),(0,P._)(g,"remove",[i8.rcss.backgroundColor.accentNegativeDimmest,xx(A.tokens.accentNegativeDimmer),{textDecoration:"line-through"}]),(0,P._)(g,"add",[i8.rcss.backgroundColor.accentPositiveDimmest,xx(A.tokens.accentPositiveDimmer)]),(0,P._)(g,"hiddenTextWrapper",[i8.rcss.display.inlineBlock,i8.rcss.mx(2),{"& > div":[i8.rcss.display.inlineBlock],transform:"translateY(12.5%)"}]),(0,P._)(g,"firstHiddenTextWrapper",[i8.rcss.ml(0)]),(0,P._)(g,"lastHiddenTextWrapper",[i8.rcss.mr(0)]),g));function xw(e){var t=e.content,n=e.matches,r=e.dedentBy,i=e.replacement,a=e.isRegex,o=e.query,s=e.onOpenAtPosition;return(0,m.jsx)(m.Fragment,{children:(function(e){for(var t=e.content,n=e.matches,r=e.dedentBy,i=e.replacement,a=[],o=r,s=0;s<n.length;s++){var l=n[s],u=l.start+l.length;a.push({start:o,end:l.start,type:"text"});var c=t.substring(l.start,u);i.length>0&&i!==c?(a.push({start:l.start,end:u,type:"remove"}),a.push({start:-1,end:u,type:"add"})):a.push({start:l.start,end:u,type:"highlight",matchIndex:s}),o=u}return a.push({start:o,end:t.length,type:"text"}),a})({content:t,matches:n,dedentBy:r,replacement:i}).map(function(e,n,r){var l=e.start,u=e.end,c=e.type,d="".concat(l,"-").concat(u),p=u-l;if("text"===c){var f=r[n+1];if(0===n&&p>50)return(0,m.jsxs)(B.Fragment,{children:[(0,m.jsx)(xg,{css:[xy.hiddenTextWrapper,xy.firstHiddenTextWrapper],children:(0,m.jsx)(lz.IconButton,{size:18,alt:"Jump to hidden text",onClick:function(){s(u-50)},children:(0,m.jsx)(xh.default,{})})},d),(0,m.jsx)("span",{children:t.substring(u-50,u)})]},d);if(n===r.length-1&&p>50)return(0,m.jsxs)(B.Fragment,{children:[(0,m.jsx)("span",{children:t.substring(l,l+50)}),(0,m.jsx)(xg,{css:[xy.hiddenTextWrapper,xy.lastHiddenTextWrapper],children:(0,m.jsx)(lz.IconButton,{size:18,alt:"Jump to hidden text",onClick:function(){s(l+50)},children:(0,m.jsx)(xh.default,{})})},d)]},d);if(f&&p>100)return(0,m.jsxs)(B.Fragment,{children:[(0,m.jsx)("span",{children:t.substring(l,l+50)}),(0,m.jsx)(xg,{css:xy.hiddenTextWrapper,children:(0,m.jsx)(lz.IconButton,{size:18,alt:"Jump to hidden text",onClick:function(){s(l+50)},children:(0,m.jsx)(xh.default,{})})},d),(0,m.jsx)("span",{children:t.substring(u-50,u)})]},d)}var h=-1===l?i:t.substring(l,u);if("text"===c)return(0,m.jsx)(B.Fragment,{children:h},d);var g=null,v=r[n-1];return"add"===c&&(null==v?void 0:v.type)==="remove"&&(g=t.substring(v.start,v.end)),(0,m.jsx)(xb,{content:h,type:c,isRegex:a,query:o,replacement:i,removedText:g,onClick:function(e){e.stopPropagation(),s(u)}},d)})})}function xb(e){var t=e.content,n=e.type,r=e.isRegex,i=e.replacement,a=e.query,o=e.removedText,s=(0,ll._)(e,["content","type","isRegex","replacement","query","removedText"]),l=t,u=void 0;switch(n){case"highlight":u="Matched text ".concat(l);break;case"remove":u="Removed text ".concat(l);break;case"add":if(u="Added text ".concat(l),r&&null!==o)try{l=o.replace(new RegExp(a),i.replaceAll(/\$[&`']/g,"$$$&"))}catch(e){}}return(0,m.jsx)(O.SpecializedView.span,(0,rX._)((0,x._)({css:[xy.self,xy[n]],tabIndex:0,"aria-label":u,role:"button","data-nav":xm},s),{children:"add"===n?(0,m.jsx)(xf,{content:l}):l}))}var xj=(0,ro.cssRecord)({self:[i8.rcss.width("100%"),i8.rcss.flex.wrap],text:[i8.rcss.display.block,i8.rcss.textAlign.center,{overflow:"visible",whiteSpace:"normal"}]});function x_(e){var t=e.error;return(0,m.jsxs)(O.View,{css:xj.self,pt:8,pb:8,row:!0,gap:4,align:"center",justify:"center",children:[(0,m.jsx)(fi.default,{}),(0,m.jsx)(a0.Text,{css:xj.text,multiline:!1,children:t})]})}var xS=e.i(8412),xI=e.i(717639),xC="SearchLine",xk="--search-line-number-width",xE=(0,ro.cssRecord)({self:[i8.rcss.overflow("hidden"),i8.rcss.cursor.pointer,i8.rcss.borderRadius(4),{"&:focus-visible":[i8.rcss.focusRing],"&:hover, &:focus-visible":[i8.rcss.backgroundColor.backgroundHighest]}],content:[i8.rcss.font.code,i8.rcss.maxWidth("100%"),i8.rcss.width("fit-content"),{whiteSpace:"pre-wrap",overflowWrap:"break-word"}],lineNumberWrapper:[i8.rcss.display.inlineBlock,i8.rcss.color.foregroundDimmest,i8.rcss.mr(8),i8.rcss.pl(8)],lineNumber:[i8.rcss.display.inlineBlock,i8.rcss.textAlign.right,{width:"var(".concat(xk,")")}]});function xT(e){var t=e.lineNumber,n=e.content,r=e.matches,i=e.path,a=e.dedentBy,o=e.onFileLineClicked,s=(0,ll._)(e,["lineNumber","content","matches","path","dedentBy","onFileLineClicked"]),l=(0,X.default)(function(){return function(e){(0,es.track)(el.events.SEARCH_PANE_USED,(0,x._)({action:"result_clicked"},s)),o({path:i,lineNumber:t,columnNumber:e})}},[t,s,i,o]),u=(0,X.default)(function(){return function(){var e=r.length>0?r[0]:null;l(e?e.start+e.length:0)}},[r,l]);return(0,m.jsxs)(O.View,{tabIndex:0,css:xE.self,row:!0,gap:8,align:"stretch","data-nav":xC,onKeyDown:function(e){"Enter"===e.key&&(e.preventDefault(),e.stopPropagation(),u())},onClick:u,children:[(0,m.jsx)(O.View,{css:xE.lineNumberWrapper,children:(0,m.jsx)(O.View,{tag:"span",css:xE.lineNumber,"aria-label":"Line ".concat(t),children:t})}),(0,m.jsx)("pre",{css:xE.content,children:(0,m.jsx)(xw,{isRegex:s.isRegex,content:n,matches:r,dedentBy:a,query:s.query,replacement:s.replacement,onOpenAtPosition:l})})]})}var xP=e.i(965153),xR="SearchFileNav",xA="SearchFileHeaderNav",xD="SearchQueryNav",xV="SearchQueryTogglesNav",xO=parseInt(A.values.space24,10)+10,xF=(0,ro.cssRecord)({header:[i8.rcss.rowWithGap(4),i8.rcss.align.center,i8.rcss.rowWithGap(6),i8.rcss.flex.growAndShrink(1),i8.rcss.overflow("hidden")],headerParentPathText:[i8.rcss.flex.shrink(1e7)],headerFileNameText:[i8.rcss.flex.shrink(1)],headerMatchesCountPill:[i8.rcss.height(20),i8.rcss.flex.shrink(0)],accordionWrapper:[i8.rcss.mx(4),i8.rcss.border({direction:"top",color:A.tokens.outlineDimmest})],accordionChildren:[i8.rcss.p(4)],linesWrapper:[i8.rcss.overflow("hidden"),i8.rcss.borderRadius(4),i8.rcss.font.code]});function xM(e){var t=e.path,n=e.lines,r=e.dedentBy,i=e.isFirst,a=e.expanded,o=e.onClick,s=e.scrollOffset,l=e.onFileLineClicked,u=e.searchResultBackgroundColor,c=(0,ll._)(e,["path","lines","dedentBy","isFirst","expanded","onClick","scrollOffset","onFileLineClicked","searchResultBackgroundColor"]),d=(0,lb.usePreferences)("fontSize").preferences.fontSize,p=(0,B.useRef)(null),f=(0,X.default)(function(){return n.reduce(function(e,t){return e+t.matches.length},0)},[n]),h=(0,X.default)(function(){var e=n[n.length-1];if(!e)return{};var t=(0,xI.getDigits)(e.lineNumber),r=(0,xS.lineHeightFromFontSize)(d);return(0,P._)({fontSize:d,lineHeight:r},xk,"".concat(t,"ch"))},[n,d]);return(0,m.jsx)(V.Surface,{css:xF.accordionWrapper,style:h,"data-nav":xR,innerRef:p,children:(0,m.jsx)(xP.AccordionItem,{expanded:void 0===a||a,onClick:function(){o(p.current)},headerProps:{"data-nav":"".concat(xA," ").concat(xC," ").concat(i?"".concat(xD," ").concat(xV):""),style:{position:"sticky",zIndex:1,insetBlockStart:"-".concat(void 0===s?0:s,"px"),borderRadius:0,backgroundColor:u}},headerContent:(0,m.jsxs)(O.View,{css:xF.header,children:[(0,m.jsx)(uq.default,{path:t,size:16}),(0,m.jsx)(a0.Text,{css:xF.headerFileNameText,multiline:!1,children:(0,ih.getFileName)(t)}),(0,m.jsx)(a0.Text,{color:"dimmest",css:xF.headerParentPathText,multiline:!1,children:(0,ih.getParentPath)(t).replace(/^\.\//,"")}),(0,m.jsx)(xe.Pill,{variant:"muted",text:"".concat(f," ").concat((0,cE.default)("match",f)),css:xF.headerMatchesCountPill})]}),children:(0,m.jsx)(O.View,{css:xF.accordionChildren,children:(0,m.jsx)(O.View,{css:xF.linesWrapper,children:n.map(function(e){return(0,m.jsx)(xT,(0,rX._)((0,x._)({},e,c),{path:t,dedentBy:r,onFileLineClicked:l}),e.lineNumber)})})})})})}var xL=e.i(15260),xG=(0,ro.cssRecord)({container:[i8.rcss.border({direction:"bottom",color:A.tokens.outlineDimmest})],actions:[i8.rcss.display.flex,i8.rcss.rowWithGap(4)]});function xU(e){var t="collapse"===e.collapseExpandAllState;return(0,m.jsxs)(O.View,{css:xG.container,p:4,row:!0,align:"center",justify:"space-between",children:[(0,m.jsxs)(a0.Text,{color:"dimmer",children:[e.totalCount," results in ",(0,cE.default)("file",e.fileCount,!0)]}),(0,m.jsxs)(O.View,{css:xG.actions,children:[(0,m.jsx)(lz.IconButton,{alt:"Open New Search",onClick:e.onStartNewSearch,children:(0,m.jsx)(lq.default,{})}),(0,m.jsx)(lz.IconButton,{alt:t?"Collapse All":"Expand All",onClick:e.onToggleCollapseExpandAll,children:t?(0,m.jsx)(lM.default,{}):(0,m.jsx)(xL.default,{})})]})]})}var xN=e.i(189920),xB=(0,ca.keyframes)({from:{opacity:0},to:{opacity:1}}),xW=(0,ro.cssRecord)({listWrapper:[i8.rcss.overflowY("auto"),i8.rcss.flex.grow(1),{contain:"strict"}],list:[i8.rcss.width("100%"),i8.rcss.position.relative],listItem:[i8.rcss.position.absolute,i8.rcss.top(0),i8.rcss.left(0),i8.rcss.width("100%")],resultRow:[{animation:"".concat(xB," 120ms linear forwards")}]});function xz(e){var t,n,r,i,a,o,s,l,u,c,d=e.results,p=e.error,f=e.paneRef,h=e.onFileLineClicked,g=e.onOpenSearchPane,v=e.searchResultBackgroundColor,y=(0,ll._)(e,["results","error","paneRef","onFileLineClicked","onOpenSearchPane","searchResultBackgroundColor"]),w=(0,X.default)(function(){return d.filter(function(e){return e.lines.length>0})},[d]),b=(0,X.default)(function(){return w.reduce(function(e,t){return e+t.lines.reduce(function(e,t){return e+t.matches.length},0)},0)},[w]),j=(0,N._)((0,B.useState)({}),2),_=j[0],S=j[1],I=(0,B.useRef)(null),C=(0,xd.useVirtualizer)({count:w.length,getScrollElement:function(){return I.current},estimateSize:function(e){var t;return function(e,t){var n=e.length;if(t)for(var r=t-24,i=0;i<e.length;i++){var a=e[i],o=9*(0,xI.getDigits)(i)+9*a.content.length+4*a.matches.length;o>r&&(n+=Math.floor(r/o)+1)}return xO+20+24.39*n+2*n}(w[e].lines,null==f||null==(t=f.current)?void 0:t.offsetWidth)},overscan:3}),k=C.getVirtualItems(),E=(0,B.useRef)(null),T=(0,B.useCallback)(function(e){var t=I.current;if(t&&E.current!==e){if(e.matches('[data-nav*="'.concat(xA,'"]')))return void e.focus();var n=e.closest('[data-nav="'.concat(xR,'"]')),r=null==n?void 0:n.querySelector('[data-nav*="'.concat(xA,'"]'));if(!r)return void e.focus();var i=r.getBoundingClientRect();if(r.offsetTop+i.height>e.offsetTop){var a=e.offsetTop-i.height;E.current=e;var o=function(){t.scrollTop===a&&(t.removeEventListener("scroll",o),E.current===e&&(e.focus(),E.current=null))};t.addEventListener("scroll",o),t.scrollTo({top:a})}else e.focus()}},[]),R=(t={selector:'[data-nav*="'.concat(xA,'"]'),boundary:'[data-nav*="'.concat(xR,'"]')},n=(0,B.useCallback)(function(e){return"Tab"===e.key},[]),r=(0,B.useCallback)(function(e){var t=e.event,n=e.activeIndex;return t.shiftKey?n-1:n+1},[]),v9((0,rX._)((0,x._)({},t),{isValid:n,move:r}))),A=(i={selector:'[data-nav*="'.concat(xC,'"]'),focus:T},a=(0,B.useCallback)(function(e){return"ArrowUp"===e.key||"ArrowDown"===e.key},[]),o=(0,B.useCallback)(function(e){var t=e.event,n=e.activeIndex;return"ArrowUp"===t.key?n-1:n+1},[]),v9((0,rX._)((0,x._)({},i),{isValid:a,move:o}))),D=(s={selector:'[data-nav*="'.concat(xm,'"]'),focus:T},l=(0,B.useCallback)(function(e){return"ArrowLeft"===e.key||"ArrowRight"===e.key},[]),u=(0,B.useCallback)(function(e){var t=e.event,n=e.activeIndex;return"ArrowLeft"===t.key?n-1:n+1},[]),v9((0,rX._)((0,x._)({},s),{isValid:l,move:u}))),V=(0,xc.mergeRefs)(R,A,D),F=(0,X.default)(function(){return w.length===Object.keys(_).length&&Object.values(_).every(Boolean)},[_,w.length]),M=null;return w.length>0?M=(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)(xU,{fileCount:w.length,totalCount:b,collapseExpandAllState:F?"expand":"collapse",onToggleCollapseExpandAll:function(){F?S({}):S(w.reduce(function(e,t){return(0,rX._)((0,x._)({},e),(0,P._)({},t.path,!0))},{}))},onStartNewSearch:g}),(0,m.jsx)(O.SpecializedView.div,{ref:I,css:xW.listWrapper,children:(0,m.jsx)(O.View,{css:xW.list,style:{height:C.getTotalSize()},children:(0,m.jsx)(O.View,{css:xW.listItem,style:{transform:"translateY(".concat(null==(c=k[0])?void 0:c.start,"px)")},innerRef:V,children:k.map(function(e){var t,n=w[e.index],r=n.path;return(0,m.jsx)(O.SpecializedView.div,{"data-index":e.index,ref:C.measureElement,css:xW.resultRow,children:(0,m.jsx)(xM,(0,rX._)((0,x._)({},n,y),{scrollOffset:null==(t=k[0])?void 0:t.start,onFileLineClicked:h,isFirst:0===e.index,expanded:!0!==_[r],searchResultBackgroundColor:v,onClick:function(e){if(S(function(e){return(0,rX._)((0,x._)({},e),(0,P._)({},r,!(r in e)||!e[r]))}),I.current&&e){var t,n,i=Math.floor(null!=(n=null==(t=k[0])?void 0:t.start)?n:0),a=Math.floor(I.current.scrollTop),o=e.offsetTop+i;o>a||I.current.scrollTo({top:o-1})}}}))},e.key.toString())})})})})]}):p===xN.SearchError.EMPTY_RESULTS&&(M=(0,m.jsx)(v7.default,{pane:{type:"searchReplace"},headerText:p})),(0,m.jsxs)(m.Fragment,{children:[p&&p!==xN.SearchError.EMPTY_RESULTS?(0,m.jsx)(x_,{error:p}):null,M]})}var xH=e.i(316346);function xq(e){return(0,B.useMemo)(function(){return(0,en._)((0,xH.splitGlobAware)(e,",")).map(function(e){return e.trim()}).filter(function(e){return e.length>0})},[e])}var xK=((d={}).QUERY_EMPTY="The query is empty",d.QUERY_SAME="The query is the same as replacement",d.NO_MATCHES="No matches were found to replace",d.RG_EMPTY="Ripgrep didn't return a response",d.NOT_MOUNTED="Component wasn't mounted",d),x$=e.i(431544);e.i(694906);var xQ=e.i(55449),xY=e.i(406393),xX=e.i(606296),xJ=e.i(542932),xZ=e.i(597512),x0=e.i(874721),x1="SearchQueryControlsNav",x2="SearchQueryExcludeNav",x4="SearchQueryControlsColumnNav",x8=(0,ca.keyframes)({from:{transform:"scaleX(0)"},to:{transform:"scaleX(0.9)"}}),x3=i8.container.min(360),x6=(0,ro.cssRecord)({self:[i8.rcss.height("100%"),i8.rcss.width("100%"),i8.rcss.overflow("hidden"),i8.rcss.px(4),i8.rcss.container()],filesIncludeExcludeWrapper:[i8.rcss.mt(6),i8.rcss.border({direction:"top",color:A.tokens.outlineDimmest}),(0,P._)({},x3,[i8.rcss.rowWithGap(6),i8.rcss.align.start,i8.rcss.mt(0),{border:"none"}])],inputWithLabel:[i8.rcss.flex.growAndShrink(1),i8.rcss.colWithGap(1)],inputLabelText:[{userSelect:"none"},i8.rcss.color.foregroundDimmest,i8.rcss.truncate,{fontSize:A.tokens.fontSizeSmall}],inputLabel:[i8.rcss.flex.shrink(1),i8.rcss.m(0),{lineHeight:1}],input:[i8.rcss.viewStyle,i8.rcss.border(),{blockSize:A.tokens.space32,"::placeholder":{color:A.tokens.foregroundDimmest},"&:hover::placeholder":{color:A.tokens.foregroundDimmer},"&:focus::placeholder, &:hover:focus::placeholder":{color:A.tokens.foregroundDimmest},":not([disabled])":{cursor:"text",":focus":{boxShadow:"none"}}}],optionsWrapper:[i8.rcss.rowWithGap(2),i8.rcss.align.center,(0,P._)({order:2},x3,[{order:1," > *":i8.rcss.height("100%")}])],closeWrapper:[(0,P._)({order:1},x3,{order:2," > *":i8.rcss.height("100%")})],results:[i8.rcss.position.relative,{flex:"1 1 auto"}],searchWrapper:[{flex:"0 1 auto"}],expandCollapseButton:[i8.rcss.height(32)],searchInputAndOptionsWrapper:(0,P._)({flex:1,display:"grid",gap:4,gridTemplateColumns:"1fr max-content"},x3,{gridTemplateColumns:"1fr max-content max-content"}),replacementWrapper:[i8.rcss.ml(24),i8.rcss.pl(4),i8.rcss.pb(6)],replaceInputWrapper:[i8.rcss.border({direction:"top",color:A.tokens.outlineDimmest}),(0,P._)({},x3,[i8.rcss.rowWithGap(4),i8.rcss.pt(0),i8.rcss.align.center,{border:"none"}])],loadingBar:[i8.rcss.position.absolute,i8.rcss.mt(2),i8.rcss.height(1),i8.rcss.borderRadius(2),i8.rcss.width("100%"),i8.rcss.backgroundColor.accentPrimaryDimmer,{animation:"".concat(x8," 20s 1s ease forwards"),transformOrigin:"center left",transform:"scaleX(0)"}]});function x5(e){var t=e.updateData,n=e.query,r=e.setQuery,i=e.isRegex,a=e.setIsRegex,o=e.isCaseSensitive,s=e.setIsCaseSensitive,l=e.isMatchingWholeWords,u=e.setIsMatchingWholeWords,c=e.isCollapsed,d=e.setIsCollapsed,p=e.executeSearch,f=e.searchInputRef,h=e.onCloseRequested;return(0,m.jsxs)(O.View,{css:x6.searchWrapper,pb:4,row:!0,gap:4,children:[(0,m.jsx)(lz.IconButton,{onClick:function(){return d(function(e){return!e})},alt:c?"Show replacement options":"Hide replacement options",css:x6.expandCollapseButton,children:c?(0,m.jsx)(p7.default,{}):(0,m.jsx)(f4.default,{})}),(0,m.jsxs)(O.View,{css:x6.searchInputAndOptionsWrapper,children:[(0,m.jsx)(xl,{"data-nav":"".concat(xD," ").concat(x1),ref:f,autoSize:!0,placeholder:"Search",value:n,css:x6.input,onChange:function(e){r(e),t({initialQuery:e})},onClear:function(){r(""),t({initialQuery:""})},onKeyDown:function(e){"Enter"!==e.key||(0,lj.getCmdOrCtrl)(e)||e.shiftKey||(e.preventDefault(),e.stopPropagation(),p())}}),(0,m.jsxs)(O.View,{css:x6.optionsWrapper,children:[(0,m.jsx)(xu.default,{alt:"case sensitive","data-nav":"".concat(x1," ").concat(x4),icon:(0,m.jsx)(xJ.default,{}),checked:o,onClick:function(){return s(function(e){return!e})}}),(0,m.jsx)(xu.default,{alt:"regular expressions","data-nav":"".concat(x1," ").concat(x4),icon:(0,m.jsx)(xZ.default,{}),checked:i,onClick:function(){return a(function(e){return!e})}}),(0,m.jsx)(xu.default,{alt:"whole words","data-nav":"".concat(x1," ").concat(x4),icon:(0,m.jsx)(x0.default,{}),checked:l,onClick:function(){return u(function(e){return!e})}})]}),(0,m.jsx)(O.View,{css:x6.closeWrapper,row:!0,gap:2,align:"center",children:h?(0,m.jsx)(lz.IconButton,{onClick:h,alt:"Close",children:(0,m.jsx)(cp.default,{})}):null})]})]})}function x9(e){var t=e.updateData,n=e.replacement,r=e.setReplacement,i=e.query,a=e.replaceLoading,o=e.search,s=e.includeGlob,l=e.setIncludeGlob,u=e.excludeGlob,c=e.setExcludeGlob,d=e.replace,p=e.results;return(0,m.jsxs)(O.View,{css:x6.replacementWrapper,children:[(0,m.jsxs)(O.View,{css:x6.replaceInputWrapper,pt:8,gap:6,children:[(0,m.jsx)(xl,{"data-nav":"".concat(xD," ").concat(x1," ").concat(x2),autoSize:!0,placeholder:"Replacement",value:n,css:x6.input,onChange:function(e){r(e),t({initialReplacement:e})},onClear:function(){r(""),t({initialReplacement:""})}}),(0,m.jsx)(O.View,{css:x6.optionsWrapper,children:(0,m.jsx)(xa,{query:i,replacement:n,results:p,disabled:0===i.length,loading:a,replace:d,onReplace:o,buttonProps:{"data-nav":"".concat(x1," ").concat(xV," ").concat(x4)}})})]}),(0,m.jsxs)(O.View,{css:x6.filesIncludeExcludeWrapper,pt:8,gap:8,children:[(0,m.jsxs)(O.View,{css:x6.inputWithLabel,id:"filesToInclude",children:[(0,m.jsx)("label",{htmlFor:"filesToIncludeInput",css:x6.inputLabel,children:(0,m.jsx)(a0.Text,{css:x6.inputLabelText,color:"dimmer",multiline:!1,children:"Files to include"})}),(0,m.jsx)(xl,{id:"filesToIncludeInput","data-nav":"".concat(xD," ").concat(x1),autoSize:!0,value:s,css:x6.input,placeholder:"e.g. **.js, src/**, app/",onChange:function(e){l(e),t({initialIncludeGlob:e})},onClear:function(){l(""),t({initialIncludeGlob:""})}})]}),(0,m.jsxs)(O.View,{css:x6.inputWithLabel,id:"filesToExclude",children:[(0,m.jsx)("label",{htmlFor:"filesToExcludeInput",css:x6.inputLabel,children:(0,m.jsx)(a0.Text,{css:x6.inputLabelText,color:"dimmer",multiline:!1,children:"Files to exclude"})}),(0,m.jsx)(xl,{id:"filesToExcludeInput","data-nav":"".concat(x1," ").concat(x2),autoSize:!0,value:u,css:x6.input,onChange:function(e){c(e),t({initialExcludeGlob:e})},onClear:function(){c(""),t({initialExcludeGlob:""})}})]})]})]})}function x7(e){var t,n,r,i,a,o,s,l,u,c,d,p,f,h,g,v,y,w,b,j,_,S,I,C,k,T,P,R,A,D,V,F,M,L,G,U,W,z,H,q,K,$=e.isActive,Q=e.initialQuery,Y=void 0===Q?"":Q,J=e.initialReplacement,Z=void 0===J?"":J,ee=e.initialIncludeGlob,et=void 0===ee?"":ee,ea=e.initialExcludeGlob,eo=void 0===ea?"":ea,eu=e.searchInputRef,ec=e.onDataChanged,ed=e.onFileLineClicked,ep=e.onOpenSearchPane,ef=e.onCloseRequested,eh=e.searchResultBackgroundColor,eg=(0,N._)((0,B.useState)(Y),2),em=eg[0],ev=eg[1],ex=(0,N._)((0,B.useState)(Z),2),ey=ex[0],ew=ex[1],eb=(0,N._)((0,B.useState)(!1),2),ej=eb[0],e_=eb[1],eS=(0,N._)((0,B.useState)(!1),2),eI=eS[0],eC=eS[1],ek=(0,N._)((0,B.useState)(!1),2),eE=ek[0],eT=ek[1],eP=(0,N._)((0,B.useState)(!0),2),eR=eP[0],eA=eP[1],eD=(0,N._)((0,B.useState)(eo),2),eV=eD[0],eO=eD[1],eF=(0,N._)((0,B.useState)(et),2),eM=eF[0],eL=eF[1],eG=xq(eV),eU=xq(eM),eN=(0,B.useRef)(null),eB=(n=(t={query:em,isRegex:ej,isCaseSensitive:eI,isMatchingWholeWords:eE,excludeGlobs:eG,includeGlobs:eU}).query,r=t.isRegex,i=t.isCaseSensitive,a=t.isMatchingWholeWords,s=void 0===(o=t.includeGlobs)?[]:o,u=void 0===(l=t.excludeGlobs)?[]:l,d=(c=(0,a9.default)()).container,p=c.dotReplit,f=(0,xY.useHiddenFilesGlobPatterns)(p),h=(0,E.useFlag)({controlName:"flag-code-search-latency-metrics",logFlagToAnalytics:!1}),v=(g=(0,N._)((0,B.useState)([]),2))[0],y=g[1],b=(w=(0,N._)((0,B.useState)(null),2))[0],j=w[1],S=(_=(0,N._)((0,B.useState)(n.length>0),2))[0],I=_[1],C=(0,X.default)(function(){return(0,en._)(u).concat((0,en._)(f||[]),(0,en._)(xQ.ignoredDirs))},[u,f]),k=d.getConnectionState(),T=(0,B.useMemo)(function(){return(0,xX.default)({container:d,onError:function(e){return j(e)},onUpdate:function(e){return y(e)},onLoadingStateChange:function(e){return I(e)},isStreaming:!0,trackLatency:h})},[]),(0,B.useEffect)(function(){k===or.ConnectionState.CONNECTED&&T({query:n,isRegex:r,isCaseSensitive:i,isMatchingWholeWords:a,includeGlobs:s,excludeGlobs:C})},[k,T,n,r,i,a,s,C,f]),{loading:S,error:b,data:v,search:function(){return T({query:n,isRegex:r,isCaseSensitive:i,isMatchingWholeWords:a,includeGlobs:s,excludeGlobs:C})}}),eW=eB.loading,ez=eB.error,eH=eB.data,eq=eB.search;(0,pz.default)(function(){""!==em&&(0,es.track)(el.events.SEARCH_PANE_USED,{action:"search",isRegex:ej,isCaseSensitive:eI,hasIncludes:eU.length>0,hasExcludes:eG.length>0})},[em,eU,eG,ej,eI],1e3);var eK=(R=(P={replacement:ey,query:em,isRegex:ej,isCaseSensitive:eI,isMatchingWholeWords:eE,excludeGlobs:eG,includeGlobs:eU,fileList:ez?void 0:eH}).query,A=P.replacement,D=P.fileList,V=(0,ll._)(P,["query","replacement","fileList"]),F=(0,a9.default)().container,L=(M=(0,N._)((0,B.useState)(!1),2))[0],G=M[1],W=(U=(0,N._)((0,B.useState)(null),2))[0],z=U[1],q=(H=(0,N._)((0,B.useState)(!1),2))[0],K=H[1],{replace:(0,B.useCallback)(function(){return(0,er._)(function(){var e;return(0,ei._)(this,function(t){switch(t.label){case 0:var n;return K(!0),z(null),[4,(n=(0,x._)({container:F,query:R,replacement:A,fileList:null==D?void 0:D.map(function(e){return e.path})},V),(0,er._)(function(){var e,t,r,i,a,o,s,l,u;return(0,ei._)(this,function(c){switch(c.label){case 0:if(t=n.container,r=n.fileList,0===(i=(0,ll._)(n,["container","fileList"])).query.length)return[2,{success:!1,errorOn:"exit",errorMessage:xK.QUERY_EMPTY}];if(i.query===i.replacement)return[2,{success:!1,errorOn:"exit",errorMessage:xK.QUERY_SAME}];if(!(r&&r.length>0))return[3,1];return a=r,[3,3];case 1:return[4,(o=t).exec.apply(o,(0,en._)((0,x$.createSearchCommand)((0,rX._)((0,x._)({},i),{context:1,mode:"files"}))))];case 2:if((l=c.sent()).error)return[2,{success:!1,errorOn:"rg",errorMessage:"exit status 1"===l.error?xK.NO_MATCHES:l.error}];a=(null==(s=l.output)?void 0:s.split("\n").filter(function(e){return e.trim().length>0}))||[],c.label=3;case 3:var d,p,f,h,g,m,v,y;if(0===a.length)return[2,{success:!1,errorOn:"rg",errorMessage:xK.NO_MATCHES}];return[4,(e=t).exec.apply(e,(0,en._)((p=(d=i).replacement,f=d.query,h=d.isRegex,g=d.isCaseSensitive,m=d.isMatchingWholeWords,v=["sd"],y=[f.indexOf("\n")>=0?"m":"e",g?"c":"i"],m&&y.push("w"),v.push("--flags",y.join("")),!h&&v.push("--string-mode"),f.startsWith("-")&&(f="\\"+f),v.push(f,p),v)).concat((0,en._)(a)))];case 4:if((u=c.sent()).error)return[2,{success:!1,errorOn:"sd",errorMessage:u.error}];return[2,{success:!0}]}})})())];case 1:return(e=t.sent()).success||z(e.errorMessage),K(!1),G(e.success),[2,e]}})})()},[F,R,A,D,V]),loading:q,error:W,data:L}),e$=eK.loading,eQ=eK.replace,eY=(0,B.useCallback)(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};null==ec||ec({initialQuery:em,initialReplacement:ey,initialIncludeGlob:eM,initialExcludeGlob:eV},e)},[ec,em,ey,eV,eM]);(0,B.useLayoutEffect)(function(){ev(Y),ew(Z),eL(et),eO(eo)},[Y,Z,et,eo]);var eX=v9({selector:'[data-nav*="'.concat(xD,'"]'),isValid:function(e){var t="ArrowUp"===e.key||"ArrowDown"===e.key,n=e.target.matches('[data-nav*="'.concat(xD,'"]')),r=e.target.matches("[data-nav*=".concat(xA,"]"));return t&&n&&(e.altKey||r)},move:function(e){var t=e.event,n=e.activeIndex;return t.preventDefault(),t.stopPropagation(),"ArrowUp"===t.key?n-1:n+1}}),eJ=v9({selector:'[data-nav*="'.concat(xV,'"]'),isValid:function(e){var t="ArrowUp"===e.key||"ArrowDown"===e.key,n=e.target.matches('[data-nav*="'.concat(xV,'"]')),r=e.target.matches("[data-nav*=".concat(xA,"]"));return t&&n&&!r},move:function(e){var t=e.event,n=e.activeIndex;return t.preventDefault(),t.stopPropagation(),"ArrowUp"===t.key?n-1:n+1}}),eZ=v9({selector:'[data-nav*="'.concat(x4,'"]'),isValid:function(e){var t="ArrowUp"===e.key||"ArrowDown"===e.key;if(e.target.matches('[data-nav*="'.concat(xV,'"]'))&&"ArrowDown"===e.key)return!1;var n=e.target.matches('[data-nav*="'.concat(x4,'"]'));return t&&n},move:function(e){var t=e.event,n=e.activeIndex,r=e.children,i=t.target.matches('[data-nav*="'.concat(xV,'"]'));return(t.preventDefault(),t.stopPropagation(),i)?0:0===n&&"ArrowUp"===t.key?-1:r.length-1}}),e0=v9({selector:'[data-nav*="'.concat(x2,'"]'),isValid:function(e){var t="ArrowUp"===e.key||"ArrowDown"===e.key,n=e.target.matches('[data-nav*="'.concat(x2,'"]')),r=e.target.matches("[data-nav*=".concat(xD,"]"));return t&&e.altKey&&n&&!r},move:function(e){var t=e.event,n=e.activeIndex;return t.preventDefault(),t.stopPropagation(),"ArrowUp"===t.key?n-1:n+1}}),e1=v9({selector:'[data-nav*="'.concat(x1,'"]'),isValid:function(e){var t="ArrowLeft"===e.key||"ArrowRight"===e.key,n=e.target.matches('[data-nav*="'.concat(x4,'"]'));return t&&(e.altKey||n)},move:function(e){var t=e.event,n=e.activeIndex;return t.preventDefault(),t.stopPropagation(),"ArrowLeft"===t.key?n-1:n+1}}),e2=(0,oa.useMergeRefs)([eX,eJ,eZ,e0,e1],{breadcrumb:"client/workspace/components/SearchReplace/index.tsx:661"}),e4=(0,B.useCallback)(function(e){"Escape"===e.key&&(null==ef||ef())},[ef]);return(0,m.jsxs)(O.View,{css:x6.self,innerRef:e2,onKeyDown:e4,children:[(0,m.jsx)(x5,{isActive:$,query:em,setQuery:ev,updateData:eY,isRegex:ej,isCaseSensitive:eI,isMatchingWholeWords:eE,setIsRegex:e_,setIsCaseSensitive:eC,setIsMatchingWholeWords:eT,isCollapsed:eR,setIsCollapsed:eA,executeSearch:eq,searchInputRef:eu,onCloseRequested:ef}),eR?null:(0,m.jsx)(x9,{replacement:ey,setReplacement:ew,updateData:eY,query:em,replaceLoading:e$,search:eq,includeGlob:eM,setIncludeGlob:eL,excludeGlob:eV,setExcludeGlob:eO,replace:eQ,results:eH}),(0,m.jsxs)(O.View,{css:x6.results,children:[eW?(0,m.jsx)(O.View,{css:x6.loadingBar},em):null,0===em.length&&0===eH.length?(0,m.jsx)(v7.default,{pane:{type:"searchReplace"},bodyText:"Enter a search query above to see results."}):(0,m.jsx)(xz,{isRegex:ej,query:em,replacement:ey,include:eM,exclude:eV,results:eH,error:ez,paneRef:eN,onOpenSearchPane:ep,onFileLineClicked:ed,searchResultBackgroundColor:eh})]})]})}var ye=ex.Type.Object({type:ex.Type.Literal("searchReplace"),data:ex.Type.Optional(ex.Type.Object({initialQuery:ex.Type.Optional(ex.Type.String()),initialReplacement:ex.Type.Optional(ex.Type.String()),initialIncludeGlob:ex.Type.Optional(ex.Type.String()),initialExcludeGlob:ex.Type.Optional(ex.Type.String())}))}),yt={Content:function(e){var t=e.pane,n=e.options;return(0,m.jsx)(yr,{paneData:(null==t?void 0:t.data)||{},isActive:n.isActive,performPaneOperation:n.performPaneOperation})},Icon:function(e){var t=e.size;return(0,m.jsx)(lm.default,{size:t})},getTitle:function(e){var t,n=null==e||null==(t=e.data)?void 0:t.initialQuery;return n&&n.length>0?"Code Search: ".concat(n):"Code Search"},description:"Search through the text contents of your App",category:g8.PaneCategory.WorkspaceFeatures,decode:function(e){return sn.Value.Decode(ye,e)}},yn=(0,ro.cssRecord)({wrapper:[i8.rcss.height("100%"),i8.rcss.width("100%")]});function yr(e){var t=e.paneData,n=e.isActive,r=e.performPaneOperation,i=(0,B.useRef)(null),a=(0,B.useCallback)(function(){var e,t;null==(e=i.current)||e.select(),null==(t=i.current)||t.focus()},[]);(0,ak.useSetPaneBindings)(function(){return{type:"searchReplace",focusSearchInput:a}},[a]),(0,ak.useSetFocusTarget)(function(){return{focus:a}},[a]);var o=(0,B.useCallback)(function(e){r({operation:"open",pane:{type:"codeEditor",data:{path:e.path,line:e.lineNumber,col:e.columnNumber}},secondary:!0})},[r]),s=(0,B.useCallback)(function(){r({operation:"commit"}),r({operation:"open",pane:{type:"searchReplace"}})},[r]),l=(0,B.useCallback)(function(e,t){r({operation:"replace",pane:{type:"searchReplace",data:(0,x._)({},e,t)}})},[r]);return(0,m.jsx)(O.View,{css:yn.wrapper,pt:6,children:(0,m.jsx)(x7,(0,rX._)((0,x._)({},t),{isActive:n,searchInputRef:i,onFileLineClicked:o,onOpenSearchPane:s,onDataChanged:l,searchResultBackgroundColor:A.tokens.backgroundDefault}))})}var yi=e.i(446692),ya=e.i(180703),yo=e.i(917375),ys=e.i(411928),yl=e.i(952685),yu=e.i(49416),yc=e.i(91442),yd=e.i(948372),yp=((p=yp||{}).Ready="READY",p.Loading="LOADING",p.Error="ERROR",p),yf=function(e){var t=e.progress;return(0,m.jsx)(d3.Tooltip,{tooltip:"Progress: ".concat(Math.round(100*t*10)/10,"%"),children:(0,m.jsx)(O.View,{css:[i8.rcss.width("100%"),i8.rcss.height(4),i8.rcss.backgroundColor.backgroundHigher],children:(0,m.jsx)(O.View,{css:[i8.rcss.width("".concat(100*t,"%")),i8.rcss.height("100%"),i8.rcss.backgroundColor.purpleDefault]})})})},yh=ex.Type.Object({type:ex.Type.Literal("tutorial")}),yg={Content:function(){var e,t,n,r,i=(0,a9.default)().fs,a=(e=rt(iW),t=rt(iH),n=rr(iK),t||!e?null:n),o=(0,sW.useSetTourStepTarget)(yo.newUserTour.id,yo.TourStepIds.Sidepane),s=(0,N._)((0,B.useState)([]),2),l=s[0],u=s[1],c=(0,N._)((0,B.useState)("LOADING"),2),d=c[0],p=c[1],f=(0,aJ.default)(),h=(0,N._)((0,ya.default)("tutorialProgress--".concat(f),0),2),g=h[0],v=h[1],x=(0,N._)((0,B.useState)(!1),2),y=x[0],w=x[1],b=(0,B.useRef)(null),j=(0,aX.useCurrentUserId)(),_=j?j.toString():"",S=(0,yc.useGetCursorState)(),I=(0,yc.useCursorFilepath)(),C=(0,yl.default)(I),k=(0,X.default)(function(){return C?function(e){var t,n;return C({code:e,insertAt:null!=(n=null==(t=S())?void 0:t.position.offset)?n:"end"})}:void 0},[C,S]),E=(0,yd.getChallengeFromLocalStorage)(_,f),T=E?(0,m.jsx)(yd.SetChallengeDoneButton,{challenge:E}):null,P=(0,B.useCallback)(function(){b.current&&(b.current.scrollTop=0)},[b]);return((0,B.useEffect)(function(){var e=!1;return(0,er._)(function(){var t,n,r,a,o,s,l,c,d,f,h,g,m,v;return(0,ei._)(this,function(x){switch(x.label){case 0:return p("LOADING"),[4,i.readDir(yu.TUTORIAL_DIR)];case 1:if(t=x.sent(),e)return[2];if(t.error)return p("ERROR"),[2];return n=[],[4,Promise.all(t.children.filter(function(e){var t;return e.type===nG.FileType.File&&(null==(t=yi.FileTypeRepository.from(e.filename))?void 0:t.id)==="markdown"}).map(function(e){var t="".concat(yu.TUTORIAL_DIR,"/").concat(e.filename);return Promise.all([t,i.readFile(t)])}))];case 2:if(r=x.sent(),e)return[2];a=!0,o=!1,s=void 0;try{for(l=r[Symbol.iterator]();!(a=(c=l.next()).done);a=!0)f=(d=(0,N._)(c.value,2))[0],(h=d[1]).error?p("ERROR"):(m=h.content.toString(),v=RegExp("^#\\s(?<title>.*)").exec(m),n.push({title:null==v||null==(g=v.groups)?void 0:g.title,content:m,path:f}))}catch(e){o=!0,s=e}finally{try{a||null==l.return||l.return()}finally{if(o)throw s}}return u(n),p("READY"),[2]}})})(),function(){e=!0}},[i]),(0,B.useEffect)(function(){l[g]||v(0)},[g,v,l]),"LOADING"===d)?(0,m.jsx)(O.View,{css:[i8.rcss.center],grow:!0,shrink:!0,children:(0,m.jsx)(dA.default,{})}):"ERROR"===d?(0,m.jsx)(O.View,{css:[i8.rcss.center],grow:!0,shrink:!0,children:(0,m.jsxs)(O.View,{css:[i8.rcss.center,i8.rcss.colWithGap(4)],children:[(0,m.jsx)(cp.default,{color:A.tokens.accentNegativeDefault}),(0,m.jsx)(a0.Text,{color:"dimmer",multiline:!1,children:"Failed to load tutorial"})]})}):0===l.length?(0,m.jsx)(O.View,{css:[i8.rcss.center],grow:!0,shrink:!0,children:(0,m.jsxs)(O.View,{css:[i8.rcss.center,i8.rcss.colWithGap(4)],children:[(0,m.jsx)(cp.default,{color:A.tokens.accentNegativeDefault}),(0,m.jsx)(a0.Text,{color:"dimmer",multiline:!1,children:"No tutorials found!"})]})}):y?(0,m.jsxs)(O.View,{css:[i8.rcss.overflowY("scroll"),i8.rcss.flex.growAndShrink(1),i8.rcss.p(8),i8.rcss.colWithGap(16)],children:[(0,m.jsx)(a0.Text,{variant:"headerDefault",multiline:!1,children:"Table of Contents"}),(0,m.jsx)(O.View,{grow:!0,shrink:!0,gap:8,children:l.map(function(e,t){return(0,m.jsxs)(O.View,{css:[g===t?i8.rcss.backgroundColor.backgroundHighest:i8.rcss.backgroundColor.backgroundHigher,i8.rcss.borderRadius(4),i8.rcss.rowWithGap(8),i8.rcss.align.center,i8.rcss.cursor.pointer,g===t?{outline:"solid 2px ".concat(A.tokens.outlineDimmest)}:{},{":hover":{outline:"solid 2px ".concat(A.tokens.outlineDimmest)}}],p:8,onClick:function(){v(t),w(!1)},children:[(0,m.jsx)(O.View,{css:[i8.rcss.backgroundColor.backgroundHighest,i8.rcss.width(20),i8.rcss.height(20),i8.rcss.borderRadius("full"),i8.rcss.center,{outline:"solid 1px ".concat(A.tokens.outlineDimmest)}],children:(0,m.jsx)(a0.Text,{variant:"small",color:"dimmest",multiline:!1,children:t+1})}),(0,m.jsx)(a0.Text,{css:[i8.rcss.maxWidth("80%")],multiline:!1,children:e.title})]},e.title)})})]}):(0,m.jsx)(O.View,{innerRef:o,css:[i8.rcss.height("100%")],children:(0,m.jsxs)(O.View,{dataCy:"tutorial-viewer-content",innerRef:b,css:[i8.rcss.overflowY("scroll"),i8.rcss.flex.growAndShrink(1),i8.rcss.p(16),i8.rcss.pb(48),i8.rcss.colWithGap(16)],children:[a?(0,m.jsx)(aZ.Button,{text:"Show tutorial video",iconLeft:(0,m.jsx)(u3.default,{}),onClick:function(){return a()}}):null,T,l.length>1&&(0,m.jsx)(aZ.Button,{text:"Table of Contents",iconLeft:(0,m.jsx)(vU.default,{}),onClick:function(){return w(!0)}}),(0,m.jsx)(ys.default,{fs:i,path:l[g].path,source:l[g].content,sourcePos:!1,onCodeInsert:k}),l.length>1&&(0,m.jsxs)(O.View,{css:[i8.rcss.position.absolute,i8.rcss.width("100%"),i8.rcss.left(0),i8.rcss.bottom(0),i8.rcss.overflow("hidden")],children:[(0,m.jsx)(yf,{progress:(g+1)/l.length}),(0,m.jsxs)(O.View,{css:[i8.rcss.width("100%"),i8.rcss.height(40),i8.rcss.align.center,i8.rcss.flex.row],children:[(0,m.jsx)(O.View,{tag:"button",css:[i8.rcss.backgroundColor.backgroundHigher,i8.rcss.cursor.pointer,i8.rcss.width(40),i8.rcss.height("100%")],p:8,justify:"center",onClick:function(){g>0&&(v(function(e){return e-1}),P())},children:g>0&&(0,m.jsx)(mC.default,{size:24})}),(0,m.jsx)(O.View,{tag:"button",css:[i8.rcss.height("100%"),i8.rcss.justify.spaceBetween,i8.rcss.backgroundColor.backgroundHighest,i8.rcss.align.center,i8.rcss.p(8),i8.rcss.cursor.pointer,{userSelect:"none"}],grow:!0,shrink:!0,row:!0,gap:8,onClick:function(){g<l.length-1&&(v(function(e){return e+1}),P())},children:g<l.length-1&&(0,m.jsxs)(m.Fragment,{children:[(0,m.jsxs)(a0.Text,{multiline:!1,css:[i8.rcss.flex.growAndShrink(1),i8.rcss.textAlign.left,i8.rcss.fontSize(A.tokens.fontSizeSubheadDefault)],children:[(0,m.jsxs)("span",{css:[i8.rcss.color.foregroundDimmer],children:["Next",l[g+1].title?": ":" page"]}),(0,m.jsx)("b",{children:null!=(r=l[g+1].title)?r:""})]}),(0,m.jsx)(p7.default,{size:24})]})})]})]})]})})},Icon:function(e){var t=e.size;return(0,m.jsx)(fI.default,{size:t})},getTitle:function(){return"Tutorial"},category:g8.PaneCategory.Other,decode:function(e){return sn.Value.Decode(yh,e)}},ym=e.i(909478),yv=e.i(137218),yx=e.i(134405),yy=e.i(378042),yw=e.i(401135),yb=e.i(813453),yj=e.i(942314),y_=e.i(548364),yS=e.i(236906),yI=e.i(759967),yC={Content:function(e){var t,n,r=e.pane.data,i=e.options,a=i.performPaneOperation,o=i.paneId,s=(0,B.useRef)(null),l=(0,K.useSupportsAgent)(),u=(0,yI.useIsExpertMode)(),c=(0,pI.useIsAgentStackRepl)().isAgentStackRepl,d=(0,a9.default)(),p=d.ports,f=d.container,h=(0,ym.useOpenedAndForwardedPorts)(p),g=(0,B.useMemo)(function(){var e;return null!=(e=(0,yy.getInitialPort)(r,h))?e:80},[r,h]),v=(0,yw.useShowEmptyState)(g),y=(0,d8.default)(),w=y.didConnectOnce,b=y.didDisconnect,j=(0,B.useCallback)(function(e){a({operation:"open",secondary:!1,pane:e})},[a]),_=(0,B.useCallback)(function(){return j({type:"developer",data:{tab:["networking"]}})},[j]),S=(0,B.useCallback)(function(){return j({type:"deployments"})},[j]),I=null==r?void 0:r.previewScreenSize,C=(0,B.useCallback)(function(e){a({operation:"replace",pane:{type:"webview",data:{previewScreenSize:e}}})},[a]),k=(0,y_.useDeploymentCommands)({openDeploymentsPane:S,includeSharing:!0}).getCommandGroups;return((0,ak.useSetPaneBindings)(function(){var e={type:"webview",refresh:function(){var e;null==(e=s.current)||e.refresh()},navigate:function(e,t){var n;null==(n=s.current)||n.navigateTo(e,t)}},t=k();return t.length>0?(0,rX._)((0,x._)({},e),{commands:t}):e},[k]),c)?(0,m.jsx)(yb.WebviewDisabledForAgentStack,{openPane:j}):!l||u||c?v?(0,m.jsx)(yj.default,{openNetworkingTool:_,didConnectOnce:w,didDisconnect:b}):(0,m.jsx)(yy.WebviewBrowser,{ref:s,initialPort:g,initialPath:null==r||null==(t=r.ports)?void 0:t.path,openPane:j,ports:p,container:f,previewScreenSize:I,setPreviewScreenSize:C,paneId:o}):(0,m.jsx)(yk,{ref:s,initialPort:g,initialPath:null==r||null==(n=r.ports)?void 0:n.path,openPane:j,previewScreenSize:I,setPreviewScreenSize:C,paneId:o})},Icon:function(e){var t=e.size;return(0,m.jsx)(p3.IconContext.Provider,{value:{size:t},children:(0,m.jsx)(u4.default,{})})},getTitle:function(){return"Preview"},description:"Preview your App",category:g8.PaneCategory.WorkspaceFeatures,decode:yS.decode},yk=(0,B.forwardRef)(function(e,t){var n=e.initialPort,r=e.initialPath,i=e.openPane,a=e.previewScreenSize,o=e.setPreviewScreenSize,s=e.paneId,l=(0,yx.useAgentAwareWebviewState)(),u=(0,a9.default)(),c=u.ports,d=u.container;if(l.state!==yx.WebviewState.READY&&l.state!==yx.WebviewState.LAST_RESORT_READY)return(0,m.jsx)(yv.AgentAwareWebviewNonReadyStates,{webviewState:l,openPane:i});var p=l.state===yx.WebviewState.READY?l.presentPort:l.externalPort,f=l.state===yx.WebviewState.READY?l.presentRoute:r;return(0,m.jsx)(m.Fragment,{children:(0,m.jsx)(yy.WebviewBrowser,{ref:t,initialPort:null!=p?p:n,initialPath:null!=f?f:r,ports:c,container:d,openPane:i,previewScreenSize:a,setPreviewScreenSize:o,paneId:s})})}),yE=e.i(835109),yT=e.i(676702),yP=e.i(544880),yR=e.i(637972),yA=e.i(643041);function yD(){var e=(0,y._)(["\n  query NotificationModalCheckMultiplayers($replId: String!) {\n    getRepl(id: $replId) {\n      ... on Repl {\n        id\n        multiplayers {\n          id\n        }\n      }\n    }\n  }\n"]);return yD=function(){return e},e}var yV={},yO=(0,w.gql)(yD());function yF(){var e=(0,y._)(["\n  query BrowserNotifications($username: String!) {\n    user: userByUsername(username: $username) {\n      id\n      image\n    }\n  }\n"]);return yF=function(){return e},e}var yM=(0,w.gql)(yF()),yL=!1;function yG(){return"Notification"in window?"true"===tX.default.get(yU,"string")?"dismissed":window.Notification.permission:"denied"}var yU="notifications/dismissedModal";function yN(e){tX.default.set(yU,String(e))}var yB={};function yW(e){return(0,er._)(function(e){var t,n,r,i,a,o,s,l,u,c,d;return(0,ei._)(this,function(p){switch(p.label){case 0:if(t=e.title,n=e.body,r=e.badge,i=e.icon,a=e.iconByUsername,o=e.tag,s=e.onClick,u=void 0===(l=e.cacheDuration)?0:l,!document.hidden&&document.hasFocus()||"granted"!==yG()||(c=Date.now(),o in yB&&yB[o]+u>c))return[2];if(!a)return[3,2];return[4,(0,er._)(function(){var e,t;return(0,ei._)(this,function(n){switch(n.label){case 0:if(null===tY.apolloClient)return[2];return[4,tY.apolloClient.query({query:yM,variables:{username:a}})];case 1:return[2,null==(t=n.sent().data)||null==(e=t.user)?void 0:e.image]}})})()];case 1:i=p.sent(),p.label=2;case 2:return d=new window.Notification(t,{body:n,badge:r||"/public/images/logo-grayscale.png",icon:i||"/public/images/icon-square.png",tag:o}),setTimeout(function(){d.close()},1e4),d.addEventListener("click",function(){window.focus(),d.close()}),s&&d.addEventListener("click",s),yB[o]=c,[2]}})}).apply(this,arguments)}function yz(e){try{new Audio(e).play().catch(function(){})}catch(e){}}function yH(e){var t,n,r,i=e.replId,a=(0,N._)((0,B.useState)(!1),2),o=a[0],s=a[1],l=(0,sW.useIsTouring)(),u=(t={variables:{replId:i}},n=(0,x._)({},yV,t),b.useQuery(yO,n)).data,c=(null==u||null==(r=u.getRepl)?void 0:r.__typename)==="Repl"&&u.getRepl.multiplayers.length>0;(0,B.useEffect)(function(){l||!c||"default"===yG()&&s(!0)},[c,l]);var d=(0,B.useCallback)(function(){yN(!0),s(!1)},[]),p=(0,B.useCallback)(function(){return(0,er._)(function(){return(0,ei._)(this,function(e){switch(e.label){case 0:return[4,(0,er._)(function(){return(0,ei._)(this,function(e){switch(e.label){case 0:return[4,(0,er._)(function(){return(0,ei._)(this,function(e){try{window.Notification.requestPermission().then()}catch(e){return[2,new Promise(function(e){window.Notification.requestPermission(function(t){e(t)})})]}return[2,window.Notification.requestPermission()]})})()];case 1:return e.sent(),yN(!1),[2]}})})()];case 1:return e.sent(),s(!1),[2]}})})()},[]);return o?(0,m.jsx)(aU.Modal,{preventClose:!0,isOpen:!0,onRequestClose:d,children:(0,m.jsxs)(O.View,{gap:24,children:[(0,m.jsx)(a0.Header,{variant:"headerDefault",level:2,children:"Replit needs your permission to enable notifications."}),(0,m.jsx)(a0.Text,{children:"Never miss messages from your collaborators if you're in another tab or window."}),(0,m.jsxs)(O.View,{row:!0,gap:12,justify:"end",children:[(0,m.jsx)(aZ.Button,{onClick:d,text:"Deny",iconLeft:(0,m.jsx)(cp.default,{})}),(0,m.jsx)(aZ.Button,{text:"Allow notifications",colorway:"positive",iconLeft:(0,m.jsx)(p8.default,{}),onClick:p})]})]})}):null}var yq=e.i(644826),yK=e.i(357210),y$=(0,A.cvarsFrom)("ResizeHandle.module.css",["--width","--height","--transform-x","--transform-y","--rotation","--z-index","--cursor"]),yQ=(0,B.memo)(function(e){var t,n=function(e){var t,n,r,i,a,o,s,l,u,c=rK(e),d=r$(e),p=tA(d),f=tD(d),h=rQ(e),g=(t=rK(e),(0,X.default)(function(){return(0,eh.selectAtom)(t,function(e){return!!e.snapped})},[t])),m=rY(e),v=(n=tA(r$(e)),r=rY(e),(0,X.default)(function(){return(0,ea.atom)(function(e){var t=e(n),i=t.width,a=t.height;return e(r)?i:a})},[n,r])),x=(i=rK(e),(0,X.default)(function(){return(0,ea.atom)(function(e){var t=e(i),n=t.snapped,r=t.stacked;return"right"===n?r?180:90:"left"===n?270*!r:0})},[i])),y=(a=rY(e),o=rQ(e),s=tA(r$(e)),(0,X.default)(function(){return(0,ea.atom)(function(e){var t=e(s),n=t.width,r=t.height,i=e(o),l=e(a),u=e(tg);return l?{width:i?n:24,height:u?6:2}:{height:i?r:24,width:u?6:2}})},[s,a,o])),w=(l=tA(r$(e)),u=rY(e),(0,X.default)(function(){return(0,ea.atom)(function(e){var t=e(l),n=t.width,r=t.height;return(e(u)?n:r)<24})},[l,u]));return{handle:rn(c),size:rn(p),position:rn(f),isActive:rn(h),isSnapped:rn(g),isStacked:rn(m),length:rn(v),rotation:rn(x),gripSize:rn(y),gripIsHidden:rn(w)}}(e.handleId),r=(t=(0,B.useRef)(null),(0,tK.useStyleSet)(t,n.size,function(e){var t,n=e.width,r=e.height;return t={},(0,P._)(t,y$.width,n+"px"),(0,P._)(t,y$.height,r+"px"),t}),(0,tK.useStyleSet)(t,n.position,function(e){var t,n=e.x,r=e.y;return t={},(0,P._)(t,y$.transformX,Math.round(n)+"px"),(0,P._)(t,y$.transformY,Math.round(r)+"px"),t}),(0,tK.useStyleSet)(t,n.isStacked,function(e){return(0,P._)({},y$.cursor,e?"row-resize":"col-resize")}),(0,tK.useStyleSet)(t,n.isActive,function(e){return(0,P._)({},y$.zIndex,(e?ra.zIndexLevels.gutterActive:ra.zIndexLevels.gutter).toString())}),t),i=rr(rq),a=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=(0,B.useRef)(e),n=rr(nx),r=ri(tm);return(0,B.useCallback)(function(i){i.snapped?n({leftPath:i.leftPath,percent:t.current}):Promise.resolve(r()).then(function(r){var a=eO(r,i.leftPath);if(!a||!eA(a))throw Error("Expected split or paneGroup");t.current=a.percent,n({leftPath:i.leftPath,percent:e})})},[e,n,r])}(),o=(0,B.useRef)(null),s=(0,lo.default)(n.isSnapped),l=(0,lo.default)(n.isStacked);return(0,m.jsx)(O.View,{align:"center",justify:"center",innerRef:r,clsx:[yK.default.root,(0,P._)({},yK.default.stacked,l)],onDoubleClick:function(){a(n.handle.current)},onPointerDown:function(e){(0,ls.measureMouseMove)(e,{start:function(){var e=n.handle.current;o.current=document.activeElement,i({type:"start",leftPath:e.leftPath,stacked:e.stacked})},move:function(e){i({type:"update",moveDelta:e.delta})},end:function(){var e,t;i({type:"end"}),null==(t=o.current)||null==(e=t.focus)||e.call(t)}})},onContextMenu:function(e){e.preventDefault(),e.stopPropagation()},children:s?(0,m.jsx)(yq.default,{className:"icon"}):(0,m.jsx)(O.View,{clsx:yK.default.grip})})}),yY=e.i(387948),yX=e.i(123111),yJ=e.i(94366),yZ=e.i(924748),y0=e.i(825606),y1=e.i(241939),y2=e.i(145864),y4=e.i(231346),y8=e.i(623474),y3="video.json",y6=(0,y8.join)(yu.TUTORIAL_DIR,y3);e.i(792e3);var y5=e.i(8808);function y9(){var e=(0,y._)(["\n  mutation HandlePortOpenedUpdateReplConfig($input: UpdateReplInput!) {\n    updateRepl(input: $input) {\n      repl {\n        id\n        config {\n          isVnc\n          isServer\n        }\n      }\n    }\n  }\n"]);return y9=function(){return e},e}var y7={},we=(0,w.gql)(y9()),wt=e.i(801127),wn=e.i(37292),wr=e.i(374106),wi=e.i(986194),wa=e.i(19379),wo=e.i(584647),ws=e.i(943565),wl="/public/sounds/mixkit-achievement-bell-600.wav",wu={direction:"reverse",state:{isExecutingPlan:!1},reducer:function(e,t){if(e.sender.type!==c1.UserType.AI)return!1;var n=e.contents.contents;switch(null==n?void 0:n.$kind){case"agentPlanEventContents":var r=n.agentPlanEventContents;if(!r)break;if(!0===r.requiresApproval)return t.notification={id:r.planId,text:"Plan is waiting for approval"},t.isExecutingPlan=!0,!1;if(t.isExecutingPlan&&r.step.subSteps.every(function(e){return e.status===c1.AgentPlanStepStatus.STEP_COMPLETE}))return t.notification={id:r.planId,text:"Plan has been completed!"},t.isExecutingPlan=!1,!1;break;case"agentAskUserForActionRequest":var i=n.agentAskUserForActionRequest.request;if((null==i?void 0:i.$kind)==="userSecretsRequest")return t.notification={id:e.id,text:"Agent needs secrets to proceed"},!1;return t.notification={id:e.id,text:"Agent has an update for you"},!1;case"agentTimelineEventContents":var a,o=n.agentTimelineEventContents,s=o.toolData,l=o.toolName;if((null==s?void 0:s.$kind)==="messageData"){switch(null==(a=s.messageData.agentAction.optionType)?void 0:a.$kind){case"messageButtonAction":return t.notification={id:e.id,text:"Agent has a question for you"},!1;case"secretRequestAction":return t.notification={id:e.id,text:"Agent needs secrets to proceed"},!1;case"deployRequestAction":return t.notification={id:e.id,text:"Agent needs your permission to publish the application"},!1}if("user_response"===l)return t.notification={id:e.id,text:"Agent has a question for you"},!1}}t.notification=void 0}};function wc(){var e=(0,y._)(["\n  query ReplEnvironmentNotifyUserJoin($id: String!) {\n    getRepl(id: $id) {\n      ... on Repl {\n        id\n        title\n      }\n    }\n  }\n"]);return wc=function(){return e},e}var wd=(0,w.gql)(wc()),wp=e.i(389320),wf=e.i(803542);function wh(){var e=(0,y._)(["\n  query TrackMultiplayer($replId: String!) {\n    getRepl(id: $replId) {\n      ... on Repl {\n        id\n        multiplayers {\n          id\n        }\n        owner {\n          ... on Team {\n            id\n          }\n          ... on User {\n            id\n          }\n        }\n      }\n    }\n  }\n"]);return wh=function(){return e},e}var wg={},wm=(0,w.gql)(wh());function wv(){var e=ah(),t=(0,sj.useIsExtensionRepl)(),n=ri(t_),r=rr(nS);return(0,B.useCallback)(function(i){var a=!!i&&i.reveal;if(t)return void e({pane:{type:"runnerOutput"},activate:!1,commit:!0});var o=n().find(function(e){var t=(0,N._)(e,2);return"runnerOutput"===(t[0],t[1]).type});o||e({pane:{type:"runnerOutput"},activate:!1,reveal:!1}),a&&o&&r({paneId:o[0],activate:!0})},[t,n,e,r])}function wx(e,t,n){var r=rt(tE),i=rr(nL),a=rr(nS),o=ri(t_);(0,aD.useCommandBinding)(function(){if(r)return[e,function(){var e=o().find(function(e){return(0,N._)(e,2)[1].type===t.type});e?a({paneId:e[0],activate:!0}):i((0,rX._)((0,x._)({},n),{pane:t,activate:!0,placement:{type:"secondary"}}))}]},[r,i,a])}var wy=e.i(391542),ww=e.i(984826),wb=e.i(563209),wj=e.i(708648),w_=e.i(596378),wS=e.i(143480),wI=e.i(905890),wC=e.i(681850),wk=e.i(349467),wE=e.i(402434),wT=e.i(326333),wP=e.i(8812),wR=e.i(239296),wA=e.i(829960),wD=e.i(387524),wV=e.i(104375);function wO(){var e=(0,y._)(["\n  query WorkspaceShowHiddenFiles($replId: String!) {\n    getRepl(id: $replId) {\n      ... on Repl {\n        id\n        templateInfo {\n          label\n        }\n      }\n    }\n  }\n"]);return wO=function(){return e},e}var wF={},wM=(0,w.gql)(wO()),wL=e.i(646325),wG=e.i(416406),wU=e.i(440560),wN=e.i(752310),wB=e.i(741740),wW=e.i(927938),wz=e.i(551544),wH=e.i(136780),wq=e.i(604026),wK=e.i(154488);function w$(e){var t,n,r,i,a,o,s,l,u,c,d,p,f,h,g,v,y,w,j,_,S,I,C,k,P,R,D,V,O,F,M,L,G,U,z,H,q,$,Q,Y,Z,ee,et,en,ea,eo,eu,ec,ed,ep,ef,eh,em,ev,ex,ey,ew,eb,ej,e_,eS,eI,eC,ek,eE,eT,eP,eR,eA,eD,eO,eF,eM,eL,eG,eU,eN,eB,eW,ez,eH,eq,eK,e$,eQ,eY,eX,eJ,eZ,e0,e1,e2,e4,e8,e3,e6,e5,e9,e7,te,tt,tn,tr,ti,to,ts,tu,tc,td,tp,tf,tv,tx,ty,tb,tj,t_,tS,tI,tk,tT,tP,tR,tA,tD,tV,tO,tF,tM,tL,tU,tN,tB,tW,tz,tH,tq,tK,t$,tQ,tX,tJ,tZ,t0,t1,t2=e.repl,t4=e.currentUser,t8=(0,a9.default)(),t3=t8.replspaceApi,t6=t8.dotReplit,t5=t8.container,t7=t8.ports;t=(0,a9.default)().lspnix,n=(0,lb.usePreferences)("codeIntelligence").preferences.codeIntelligence,r=(0,ny.useOpenFiles)().length>0,(0,B.useEffect)(function(){r&&n?t.enable():t.disable()},[t,n,r]),i=(0,N._)((0,wn.useBsod)(),1)[0],a=rr(t9),o=(0,X.default)(function(){return(0,eg.default)(a,1e3)},[a]),s=(0,sW.useIsTouring)(),l=(0,aJ.default)(),u=s||i,(0,B.useEffect)(function(){var e=function(){o({replId:l,force:!1}),o.flush()};if(!u)return window.addEventListener("beforeunload",e),function(){window.removeEventListener("beforeunload",e)}},[o,l,u]),(0,B.useEffect)(function(){var e=function(){"hidden"===document.visibilityState&&o({replId:l,force:!1})};if(!u)return document.addEventListener("visibilitychange",e),function(){document.removeEventListener("visibilitychange",e)}},[o,l,u]),(0,B.useEffect)(function(){if(!u){var e=null;return function t(){e=setTimeout(function(){o({replId:l,force:!1}),t()},6e4)}(),function(){e&&clearTimeout(e)}}},[o,l,u]),(0,B.useEffect)(function(){if(!u)return function(){o({replId:l,force:!1}),o.flush()}},[o,l,u]),(0,yJ.default)(),(0,wB.default)(),(0,wz.default)({workspaceType:"desktop"}),(0,B.useEffect)(function(){var e=function(e){"s"===e.key&&(0,lj.getCmdOrCtrl)(e)&&e.preventDefault()};return window.addEventListener("keydown",e),function(){window.removeEventListener("keydown",e)}},[]),(0,wN.default)(),d=(c=(0,a9.default)()).container,p=c.presence,(0,B.useEffect)(function(){var e=p.onUserJoin(function(t){var n,r=null==(n=d.getContext())?void 0:n.repl;if(r){var i,a=t.username;return(i=r.id,(0,er._)(function(){var e;return(0,ei._)(this,function(t){switch(t.label){case 0:if(!tY.apolloClient)throw Error("Expected Apollo client");return[4,tY.apolloClient.query({query:wd,variables:{id:i}})];case 1:return[2,(null==(e=t.sent().data)?void 0:e.getRepl.__typename)==="Repl"?e.getRepl.title:null]}})})()).then(function(e){e&&yW({title:"",body:"".concat(a," joined ").concat(e),tag:"".concat(r.id,"-").concat(a,"-joined"),iconByUsername:a,cacheDuration:9e5})}),function(){e()}}})},[p,d]),g=(0,lb.usePreferences)("agentAudioNotification").preferences.agentAudioNotification,v=(0,wa.usePageVisibility)(),j="control"!==(w=null!=(f=null==(y=(0,ws.useGetExperiment)("sound-on_v2")())?void 0:y.get("treatmentName"))?f:"control"),_="soundAndNoti"===w,S=(0,aJ.default)(),I=(0,J.useIsInMobileWorkspace)(),C=(0,lb.usePreferences)("agentAudioNotification").preferences.agentAudioNotification,(0,B.useEffect)(function(){var e,t;I||(e=["click","keydown","touchstart"],t=function(){if(!yL)try{new Audio("data:audio/mpeg;base64,SUQzBAAAAAABEVRYWFgAAAAtAAADY29tbWVudABCaWdTb3VuZEJhbmsuY29tIC8gTGFTb25vdGhlcXVlLm9yZwBURU5DAAAAHQAAA1N3aXRjaCBQbHVzIMKpIE5DSCBTb2Z0d2FyZQBUSVQyAAAABgAAAzIyMzUAVFNTRQAAAA8AAANMYXZmNTcuODMuMTAwAAAAAAAAAAAAAAD/80DEAAAAA0gAAAAATEFNRTMuMTAwVVVVVVVVVVVVVUxBTUUzLjEwMFVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVf/zQsRbAAADSAAAAABVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVf/zQMSkAAADSAAAAABVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVV").play().catch(function(){}),yL=!0}catch(e){}e.forEach(function(e){document.removeEventListener(e,t)})},e.forEach(function(e){document.addEventListener(e,t,{once:!0,passive:!0})}))},[I]),k=(0,B.useCallback)(function(e,t){C&&document.hidden&&!I&&yz(wl),_&&yW({title:"Replit",body:t,tag:"".concat(S,"-").concat(e),icon:"/public/icons/icon-maskable-512x512.png",cacheDuration:3e5})},[C,S,I,_]),P=(0,J.useIsInMobileWorkspace)(),R=(0,c2.useChatter)(),D=(0,uN.useObservable)(R.sessions.agent.current),V=(0,B.useMemo)(function(){return null==D?void 0:D.reduce(wu,1)},[D]),O=null==D?void 0:D.agent.state,F=(0,B.useMemo)(function(){return O&&V?c4.Observable.combine(O,V):null},[O,V]),M=(0,B.useRef)(null),L=(0,B.useRef)(0),(0,gd.useObserver)(O,{next:function(e){if(e){var t=e.state,n=M.current;if(j&&g&&!v&&n===c1.AgentRunState.AGENT_STATE_RUNNING&&t===c1.AgentRunState.AGENT_STATE_PAUSED&&!P){var r=Date.now();r-L.current>=15e3&&(yz(wl),k("agent-paused-".concat(r),"Replit Agent finished working. Come back to check your results."),L.current=r)}M.current=t}}}),(0,gd.useObserver)(F,{next:function(e){var t=(0,N._)(e,2),n=t[0],r=t[1].notification;r&&(null==n?void 0:n.state)===c1.AgentRunState.AGENT_STATE_PAUSED&&k(r.id,r.text)}}),G=(0,wo.useCurrentAgentTestingTakeover)({sessionId:null!=(h=null==D?void 0:D.id)?h:null}),(0,B.useEffect)(function(){(null==G?void 0:G.request.status)==="pending"&&k(G.request.sessionId,"Agent needs your help with testing")},[G,k]),(0,c2.useChatHook)("received-completed-event",function(e){var t=e.event;if(j&&g&&!v&&(0,wr.isEventContentsKind)(t,"agentPlanEventContents")&&!P){var n=t.contents.contents,r=(0,wi.unkind)(n);if(t.sender.type===c1.UserType.AI&&r.requiresApproval){var i=Date.now();i-L.current>=5e3&&(yz(wl),k("agent-plan-ready-".concat(i),"Your Replit Agent needs your approval to continue."),L.current=i)}}}),(0,wR.default)(),(0,wT.useLiveViewReplConnection)(),U=(0,a9.default)().presence,(0,B.useEffect)(function(){return U.onFollowingUsersChanged(function(e){var t=e.followingUsers,n=e.type,r=t.length;"follow"===n?(0,es.track)(el.events.REMOTE_USER_CURSOR_FOLLOWED,{numFollowers:r}):(0,es.track)(el.events.REMOTE_USER_CURSOR_UNFOLLOWED,{numFollowers:r})})},[U]),(0,wH.default)(),z=(0,a9.default)().presence,H=rt(tl),(0,B.useEffect)(function(){z.updateOpenFile(H)},[z,H]),$=(q=(0,a4.default)()).showConfirm,Q=q.showNotice,Y=q.hideMessage,Z=q.showError,ee=(0,a9.default)().container,et=(0,B.useRef)(!1),(0,B.useEffect)(function(){var e=ee.onToast(function(e){e.startsWith("PANIC")||Q(e,Math.max(1e4,e.length/.025+1e3))}),t=null,n=!1,r=ee.onConnectionStateChanged(function(e){if(t&&(Y(t),t=null),e===y5.ConnectionState.CONNECTED){n&&et.current&&(t=$("Connected",1500),et.current=!1),n=!0;return}if(n){if(e===y5.ConnectionState.CONNECTING){t=Q("Reconnecting");return}if(e===y5.ConnectionState.DISCONNECTED){t=Z("Disconnected"),et.current=!0;return}}});return function(){t&&Y(t),e(),r()}},[ee,$,Q,Z,Y]),en=(0,a4.default)().showConfirm,ea=(0,a9.default)().fs,(0,B.useEffect)(function(){var e=ea.registerOnFlushSuccess(function(e,t){if(t===nG.FlushSource.MANUAL_SAVE){var n="Saved ".concat(e);en(n,Math.max(1e4,n.length/.025+1e3))}});return function(){e()}},[ea,en]),eu=(eo=(0,a4.default)()).showNotice,ec=eo.showError,(0,dk.usePid2)(function(e,t){var n=t.signal;return(0,er._)(function(){var t,r;return(0,ei._)(this,function(i){switch(i.label){case 0:return[4,e.pythonMigration.detectLegacyPython.rpc({},{signal:n})];case 1:if(!(t=i.sent()).ok||!t.payload.oldVenvDetected)return[2];return[4,e.pythonMigration.migratePython.rpc({},{signal:n})];case 2:if(!(r=i.sent()).ok)return"NOP"!==r.payload.code&&ec((0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)("div",{children:"Failed to migrate legacy Python configuration."}),(0,m.jsx)("div",{children:"You may need to reinstall your Python packages, or contact support."})]}),1e4),[2];return eu((0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)("div",{children:"This Repl contained legacy Python configuration"}),(0,m.jsx)("div",{children:"and has been automatically migrated."})]}),1e4),[2]}})})()},[ec,eu]),ed=rt(tE),ep=wv(),ef=(0,sW.useTourStep)(yo.newUserTour.id,yo.TourStepIds.Output),(0,B.useEffect)(function(){if(ed&&(null==ef?void 0:ef.isActive)){var e=setInterval(function(){ep()},200);return function(){clearInterval(e)}}},[null==ef?void 0:ef.isActive,ep,ed]),wx(uZ.showShell.id,{type:"shell"}),wx(uZ.showGit.id,{type:"git"}),wx(uZ.showSettings.id,{type:"preferences"}),wx(uZ.showConsole.id,{type:"runnerOutput"}),wx(uZ.showReplitAi.id,{type:"ghostwriterChat"},{commit:!0}),(0,ww.default)(),eh=(0,a9.default)().presence,em=am(),(0,B.useEffect)(function(){return eh.onUserOpenedFile(function(e){var t=e.user,n=e.file,r=eh.getFollowedUser();!r||r.id!==t.id||n&&em({path:n})})},[eh,em]),ex=(ev=(0,N._)((0,B.useState)(null),2))[0],ey=ev[1],(0,B.useEffect)(function(){return eh.onFollowedUserChanged(ey)},[eh]),(0,B.useEffect)(function(){if(ex){var e=setTimeout(function(){document.addEventListener("click",t)},0);return function(){clearTimeout(e),document.removeEventListener("click",t)}}function t(){eh.unfollowUser()}},[ex]),ew=(0,lT.useSetAreHiddenFilesVisible)(),eS=(null==(e_=(eb={variables:{replId:(0,aJ.default)()}},ej=(0,x._)({},wF,eb),b.useQuery(wM,ej)).data)?void 0:e_.getRepl.__typename)==="Repl"?e_.getRepl:null,(0,B.useEffect)(function(){var e;!eS||(null==(e=eS.templateInfo)?void 0:e.label.includes("Blank Repl"))&&ew(!0)},[ew,eS]),eI=rr(iq),eC=(0,a9.default)().fs,ek=(0,yu.default)().isTutorial,eE=(0,i2.default)(eI),(0,B.useEffect)(function(){if(ek){var e=!1,t=eC.watchDir(yu.TUTORIAL_DIR,{onChange:function(t){(0,er._)(function(){var e;return(0,ei._)(this,function(n){switch(n.label){case 0:if(!t.find(function(e){return e.type===nG.FileType.File&&e.filename===y3}))return[2,null];return[4,eC.readFile(y6)];case 1:if((e=n.sent()).error)return[2,null];return[2,e.content.toString()]}})})().then(function(t){if(!e){if(!t)return void eE.current(null);var n=null;try{n=md.evaluate(t)}catch(e){}var r=(void 0===n?"undefined":(0,eV._)(n))==="object"&&"string"==typeof n.embedUrl?n.embedUrl:null;eE.current(r?{embedUrl:r}:null)}})},onMoveOrDelete:function(){eE.current(null)},onError:function(){eE.current(null)}});return function(){e=!0,t()}}},[eC,ek,eE]),eT=(0,yu.default)().isTutorial,eP=rr(iQ),(0,B.useEffect)(function(){eT&&eP()},[eP,eT]),eR=(0,wp.default)(),eA=(0,wf.useSetPaneIndicator)(),(0,B.useEffect)(function(){eA({paneType:"envEditor",indicatorType:eR?A.tokens.redStronger:void 0})},[eR,eA]),(0,wP.useMissingSecretToast)({onOpenEnvEditor:function(){ne({pane:{type:"envEditor"},activate:!0,placement:{type:"secondary"}})}}),eD=rt(ta),eO=(0,ny.useActivatePane)(),eF=(0,ny.useClearActivePane)(),(0,B.useEffect)(function(){eD?eO(eD):eF()},[eO,eF,eD]),eM=(0,ak.useFocusPane)(),eL=rn(i4),eG=ri(ta),eU=(0,i2.default)(eM),(0,B.useEffect)(function(){var e=function(e){e&&(null!==t&&clearTimeout(t),t=setTimeout(function(){var e=eG();e&&eU.current(e)}))},t=null;e(eL.current);var n=eL.subscribe(e);return function(){null!==t&&clearTimeout(t),n()}},[eL,eU,eG]),eN=rt(n$),eB=rr(ag),(0,B.useEffect)(function(){var e=function(){eB()};if(eN)return document.addEventListener("dragend",e),function(){document.removeEventListener("dragend",e)}},[eN,eB]),(0,wE.default)(),eW=rt(tE),ez=(0,ak.useGetPaneBindings)(),eH=ri(tw),(0,aD.useCommandBinding)(function(){if(eW)return[uZ.webviewRefresh.id,function(){var e=eH().filter(function(e){return"webview"===(0,N._)(e,2)[1].type}),t=!0,n=!1,r=void 0;try{for(var i,a=e[Symbol.iterator]();!(t=(i=a.next()).done);t=!0){var o=(0,N._)(i.value,1)[0],s=ez(o);s&&"webview"===s.type&&s.refresh()}}catch(e){n=!0,r=e}finally{try{t||null==a.return||a.return()}finally{if(n)throw r}}}]},[eW,ez,eH]),(0,wA.default)(),(0,y0.useOrgReplPresenceSession)(!(null==(tZ=t2.org)?void 0:tZ.id));var ne=a8(),nt=(0,K.useSupportsAgent)();(0,B.useEffect)(function(){return dS.setTag("replId",t2.id),function(){dS.setTag("replId",void 0)}},[t2.id]),(0,B.useEffect)(function(){return dS.setTag("agent",nt),(0,sm.addAgentTag)(nt),function(){dS.setTag("agent",void 0),(0,sm.removeAgentTag)()}},[nt]),(0,wy.default)({repl:t2,currentUser:t4,container:t5}),eq=(0,aJ.default)(),e$=(eK=(0,a9.default)()).container,eQ=eK.ports,eX=(0,N._)((eY=(0,x._)({},y7,void 0),W.useMutation(we,eY)),1)[0],eJ=(0,lb.usePreferences)("webviewAutoOpenOnPortOpened").preferences.webviewAutoOpenOnPortOpened,eZ=(0,sj.useIsExtensionRepl)(),e0=(0,K.useSupportsAgent)(),e1=ah(),e2=(0,B.useCallback)(function(e){e.isForwarded&&!e0&&(eZ||e1({pane:{type:"vnc"}}),eX({variables:{input:{id:eq,isVnc:!0}}}))},[e0,eZ,eX,eq,e1]),e4=(0,B.useCallback)(function(e){var t=e.isForwarded,n=e.isOpen,r=e.data;t&&(void 0===n||n)&&!e0&&(eJ&&!eZ&&e1({pane:{type:"webview",data:r}}),eX({variables:{input:{id:eq,isServer:!0}}}))},[eZ,e0,eq,eX,eJ,e1]),(0,B.useEffect)(function(){return eQ.portsState.subscribe((0,eg.default)(function(e){if(e){var t=!0,n=!1,r=void 0;try{for(var i,a=e[Symbol.iterator]();!(t=(i=a.next()).done);t=!0){var o=i.value,s=o.configuration,l=o.isOpen;if(s.isVnc)return void e2({isForwarded:l});var u=s.type===wt.PortConfigurationType.FORWARDED;e4({isForwarded:u,isOpen:l,data:{ports:function(e){var t=e.configuration;if(t.localPort)return{type:"local",path:"/",port:t.localPort};var n=(0,wt.getExternalPort)(t);if(n)return{type:"external",path:"/",port:n}}(o)}})}}catch(e){n=!0,r=e}finally{try{t||null==a.return||a.return()}finally{if(n)throw r}}}},500,{leading:!0}))},[e$,eQ.portsState,e4,e2]),(0,wW.default)(),(0,wL.default)(),e8=(0,E.useFlag)({controlName:"flag-open-telemetry-tracing"}),to=(e6=(e3=(0,N._)((0,B.useState)(!1),2))[0],e5=e3[1],e7=(e9=(0,N._)((0,B.useState)(Date.now()),2))[0],te=e9[1],tn=(tt=(0,N._)((0,B.useState)(Date.now()),2))[0],tr=tt[1],(0,B.useEffect)(function(){var e=function(){e5(!document.hidden),document.hidden?tr(Date.now()):te(Date.now())};return document.addEventListener("visibilitychange",e),e(),function(){document.removeEventListener("visibilitychange",e)}},[]),ti={visibility:e6,visibleTime:e7,hiddenTime:tn}).visibility,ts=ti.visibleTime,tu=ti.hiddenTime,(0,B.useEffect)(function(){e8&&to&&(ts-tu)/1e3>60&&(0,T.pruneSpans)(wV.tracerName)},[e8,to,tu,ts]),tc=(0,a9.default)().ports,td=(0,lb.usePreferences)("forwardPortsAutomatically").preferences,(0,B.useEffect)(function(){tc.setForwardPortsAutomatically(td.forwardPortsAutomatically)},[td.forwardPortsAutomatically,tc]),(0,yZ.default)(t2);var nn=rr(th),nr=(0,fw.usePrefersReducedMotion)();(0,B.useEffect)(function(){nn(!nr)},[nr,nn]);var ni=rr(tg),na=(0,yX.default)();(0,B.useEffect)(function(){ni(na)},[na,ni]),tf=(0,a9.default)().presence,tv=(0,aJ.default)(),tx=(0,B.useRef)(!1),t_=(ty={variables:{replId:tv}},tb=(0,x._)({},wg,ty),tj=b.useQuery(wm,tb)).data,tS=tj.loading,tI=0,(null==t_?void 0:t_.getRepl.__typename)==="Repl"&&(tI=t_.getRepl.multiplayers.length,(null==(tp=t_.getRepl.owner)?void 0:tp.__typename)==="User"&&(tI+=1)),(0,B.useEffect)(function(){if(!tS&&!tx.current){var e=tf.onActiveUsersChange(function(){tx.current=!0,e(),(0,es.track)(el.events.MULTIPLAYER_REPL_OPENED,{replId:tv,participantsCount:tI,usersOnlineCount:tf.getActiveUsers().length})});return e}},[tv,tS,tI,tf]);var no=(0,ny.useWaitForFileClose)();(0,B.useEffect)(function(){t3.setWaitForFileClose(no)},[t3,no]);var ns=(0,wn.useThrowBsod)(),nl=rt(tC);(0,B.useEffect)(function(){nl&&ns(nl)},[ns,nl]),tT=(tk=(0,a9.default)()).packager,tP=tk.toolchain,(0,B.useEffect)(function(){var e=setTimeout(function(){(0,er._)(function(){var e,t,n,r,i,a,o,s,l,u;return(0,ei._)(this,function(c){switch(c.label){case 0:if(!tP.configs.current||!tT)return[2];e=tP.configs.current.packagers,t=!0,n=!1,r=void 0,c.label=1;case 1:c.trys.push([1,7,8,9]),i=e[Symbol.iterator](),c.label=2;case 2:if(t=(a=i.next()).done)return[3,6];return o=a.value,[4,tT.listSpecfile(o.id)];case 3:var d;return(s=c.sent()).packages&&s.packages.length>0&&(l=s.packages.map(function(e){return e.name||""})||[],sm.logger.info("packager installed packages",{packagerId:o.id,language:o.language,packages:l}),(0,es.track)(el.events.PACKAGER_PACKAGES_INSTALLED,{packages:l})),[4,(d=(5+5*Math.random())*1e3,(0,er._)(function(){return(0,ei._)(this,function(e){switch(e.label){case 0:return[4,new Promise(function(e){return setTimeout(function(){return e()},d)})];case 1:return e.sent(),[2]}})})())];case 4:c.sent(),c.label=5;case 5:return t=!0,[3,2];case 6:return[3,9];case 7:return u=c.sent(),n=!0,r=u,[3,9];case 8:try{t||null==i.return||i.return()}finally{if(n)throw r}return[7];case 9:return[2]}})})()},(10+5*Math.random())*1e3);return function(){clearTimeout(e)}},[tT,tP.configs.current]),tR=(0,ny.useGetActivePaneId)(),tA=(0,ak.useFocusPane)(),(0,B.useEffect)(function(){var e=function(){var e=tR();e&&tA(e)},t=function(){"visible"===document.visibilityState&&document.activeElement===document.body&&e()};return window.addEventListener("focus",e),document.addEventListener("visibilitychange",t),function(){window.removeEventListener("focus",e),document.removeEventListener("visibilitychange",t)}},[tA,tR]),(0,w_.default)();var nu=rr(ix),nc=rr(iy),nd=(0,a9.default)().fs;(0,wD.default)({fs:nd,openMultipleFiles:nu,openMultipleURLs:nc,waitForFileClose:no,isMobileWorkspace:!1}),(0,aR.useSetToolPanes)(),(0,uG.useInitWorkflows)({dotReplit:t6}),(0,wK.useInitResouceMonitoring)();var np=ah();(0,sW.useTourStep)(p$.projectsTour.id,p$.StepIds.ProjectPane,{onEnter:function(){return np({pane:{type:"project"},commit:!0,activate:!0})}}),(0,wq.default)(t7),tD=wv(),tV=(0,B.useCallback)(function(){tD({reveal:!1})},[tD]),(0,uG.useOnLocalRun)(tV,[tV]),(0,wj.useAgentTracking)(),(0,wG.useSyncAgentFreemiumUsage)(),(0,wI.useChatterSentryBreadcrumbs)(),(0,wC.useDebugPreviewStateTracking)(),(0,wb.useQueueAutoPlay)(),(0,wS.useAutoSetExpertMode)({isAgentReplInConfig:!!(null==(t0=t2.config)?void 0:t0.isAgentRepl),isExpertModeInConfig:!!(null==(t1=t2.config)?void 0:t1.isExpertMode)});var nf=ah(),nh=(0,B.useCallback)(function(e){nf({pane:{type:e},activate:!1,reveal:!1,commit:!0})},[nf]);return(0,yY.default)({handleOpenPane:nh}),(0,wk.default)(),tO=aj().setAgentPosition,tF=(0,lb.usePreferences)("agentPosition").preferences.agentPosition,tM=(0,B.useRef)(tF),(0,B.useEffect)(function(){tF!==tM.current&&(tM.current=tF,tO(tF))},[tO,tF]),(0,wo.useTrackAgentTestingTakeoverRequests)(),tL=ri(tm),tU=ah(),tN=function(e){var t,n=tL();(null==(t=n.tiling)?void 0:t.type)==="paneGroup"&&1===n.tiling.panes.length&&tU({pane:e,activate:!1})},(0,c2.useChatHook)("received-completed-event",function(e){var t=e.event.contents.contents;if((0,wi.isKind)(t,"agentTimelineEventContents")){var n=t.agentTimelineEventContents.toolData;(null==n?void 0:n.$kind)==="createPostgresqlDatabaseData"&&tN({type:"neon"})}}),tW=(0,aJ.default)(),tz=rt(tG),tH=rr(iJ),tq=(0,y2.useAgentPlanApprovalState)(),tK=(0,y4.useIsCurrentSessionInitialAgentSession)(),t$=(0,B.useRef)(!1),tQ=(0,N._)((0,y1.useUpdateReplConfigMutation)(),1)[0],tX=t2.config,tJ=!!(null==(tB=t2.origin)?void 0:tB.id),(0,B.useEffect)(function(){if(tJ){(null==tX?void 0:tX.isInPlanningPhase)!==!1&&tQ({variables:{input:{id:tW,isInPlanningPhase:!1}}});return}(null==tX?void 0:tX.isAgentRepl)&&tK&&null!=tq&&!t$.current&&("approved"===tq?(tz&&tH("sidebar"),(null==tX?void 0:tX.isInPlanningPhase)!==!1&&tQ({variables:{input:{id:tW,isInPlanningPhase:!1}}})):(tz||tH("centered"),(null==tX?void 0:tX.isInPlanningPhase)!==!0&&tQ({variables:{input:{id:tW,isInPlanningPhase:!0}}})),t$.current=!0)},[tz,tW,tH,tQ,tq,tK,tX,tJ]),(0,wU.useSyncAgentInitialPlanningState)(),null}var wQ=e.i(425188);function wY(e){var t=e.children,n=e.tour,r=e.userId;if(!n)return(0,m.jsx)(m.Fragment,{children:t});var i="workspace-desktop-new-user-tour"===n.id||"workspace-desktop-tour-2024"===n.id;function a(e){i&&n&&(0,es.identify)({id:r.toString(),workspaceTourId:n.id,workspaceTourStatus:e===n.steps[n.steps.length-1].id?"completed":e.toLowerCase()})}return(0,m.jsx)(wQ.TourRoot,{tour:n,onStep:function(e){n&&((0,es.track)(el.events.WORKSPACE_TOUR_STEP_VIEWED,{tour:n.id,stepId:e.toLowerCase()}),a(e))},onDone:function(e){(0,es.track)(el.events.WORKSPACE_TOUR_DISMISSED,{tour:n.id,stepId:e.toLowerCase(),didComplete:e===n.steps[n.steps.length-1].id}),a(e)},children:t})}var wX=e.i(508545),wJ=e.i(911489),wZ=e.i(263649),w0=e.i(943618),w1=e.i(384444);function w2(){var e=(0,uN.useObservable)((0,c9.useAgentIsWorking)()),t=(0,uN.useObservable)(c6()),n=(0,N._)((0,B.useState)(!0),2),r=n[0],i=n[1],a=(0,ws.useGetExperiment)("sound-on_v2")(),o="control"!==(null==a?void 0:a.get("treatmentName","control")),s=(0,B.useRef)(!1),l=(0,N._)((0,B.useState)(!1),2),u=l[0],c=l[1],d=(0,B.useRef)(null);(0,B.useEffect)(function(){var e=function(){var e=!document.hidden;i(e),e&&(c(!1),d.current&&(document.title=d.current))};return e(),document.addEventListener("visibilitychange",e),function(){document.removeEventListener("visibilitychange",e)}},[]),(0,B.useEffect)(function(){if(o){var n=e||t;n?s.current=!0:s.current&&!n&&(r||c(!0),s.current=!1)}},[e,t,r,o]),(0,B.useEffect)(function(){return u?(null===d.current&&(d.current=document.title),document.title.startsWith("(1) ")||(document.title="(1) ".concat(document.title))):d.current&&(document.title=d.current,d.current=null),function(){d.current&&(document.title=d.current,d.current=null)}},[u]);var p=w1.favicons.prompt;return e?p=w1.favicons.agentWorking:t?p=w1.favicons.agentWaiting:o&&u&&!r&&(p=w1.favicons.agentWaiting),p?(0,m.jsx)(w0.default,{children:(0,m.jsx)("link",{rel:"shortcut icon",href:p,sizes:"192x192",type:"image/png"})}):null}var w4=e.i(169566),w8=e.i(468448),w3=e.i(748965),w6=e.i(764586),w5=e.i(968263);function w9(){var e=(0,y._)(["\n  query PublishedAs($id: String!) {\n    getRepl(id: $id) {\n      ... on Repl {\n        id\n        publishedAs\n      }\n    }\n  }\n"]);return w9=function(){return e},e}var w7={},be=(0,w.gql)(w9()),bt=e.i(626430),bn=".replit-dynamic-template",br=e.i(169932),bi=e.i(420309),ba=e.i(833387);function bo(){var e,t,n,r,i,a,o,s,l,u,c,d,p,f,h,g,v,y,w,j=(0,N._)((0,B.useState)(!1),2),_=j[0],S=j[1],I=(0,B.useCallback)(function(e){switch(e){case"starting":return void S(!0);case"none":return void S(!1);case"running":if(!_)throw Error("expected repl not to need dynamic template initialization")}},[S,_]),C=(0,N._)((0,B.useState)([]),2),k=C[0],T=C[1],P=(0,mw.useIdSeed)();t=(e={handleRPC:(0,B.useCallback)(function(e){switch(e.type){case"progress":case"failed":return T(function(t){return(0,en._)(t).concat([(0,x._)({key:P(t.length)},e)])}),null;case"query":case"prompt":case"confirm":var t=(0,w5.default)();return T(function(n){return(0,en._)(n).concat([(0,x._)({respond:t,key:P(n.length)},e)])}),t.promise;default:throw Error("unhandled request type: "+JSON.stringify(e))}},[P]),onConnStateChange:I}).handleRPC,n=e.onConnStateChange,r=(0,E.useFlag)({controlName:"octopus-smokescreen"}),s=(i={variables:{id:(0,aJ.default)()}},a=(0,x._)({},w7,i),o=b.useQuery(be,a)).loading,l=o.data,u=(0,X.default)(function(){if(s)return!1;var e=null==l?void 0:l.getRepl;return(null==e?void 0:e.__typename)==="Repl"&&e.publishedAs===pv.PublishedReplKind.Template},[s,l]),d=(c=(0,a9.default)()).container,p=c.fs,h=(f=(0,N._)((0,B.useState)(!1),2))[0],g=f[1],y=(v=gE({container:d,service:"exec",skip:!h})).channel,w=v.isConnecting,(0,B.useEffect)(function(){!r||u||s||(0,er._)(function(){return(0,ei._)(this,function(e){switch(e.label){case 0:return[4,p.stat(bn)];case 1:return g(e.sent().exists),[2]}})})()},[p,r,u,s,g]),(0,B.useEffect)(function(){if(!w){if(!y)throw Error("exec channel is not open");var e=(0,w5.default)();e.promise.then(function(){return(0,er._)(function(){var e;return(0,ei._)(this,function(t){switch(t.label){case 0:return[4,y.request({input:JSON.stringify({type:"start"})+"\n"})];case 1:if(!(e=t.sent()).ok)throw Error(": "+e.error);return[2]}})})()});var r=y.onCommand(function(r){switch(r.body){case"state":r.state===bt.api.State.Running?(n("starting"),e.resolve()):n("none");return;case"output":var i,a,o=r.output;if(!o)return;try{a=JSON.parse(o)}catch(e){throw Error("failed to parse dynamic template output: ".concat(e))}null==(i=t(a))||i.then(function(e){return y.send({input:JSON.stringify(e)+"\n"})});return;case"stderr":console.warn("got dynamic template generator stderr:",r.stderr);return;case"error":console.error("got dynamic template generator error:",r.error);return;case"ok":return;default:throw Error("unhandled exec channel body: ".concat(r.body))}});return y.send({exec:{args:["sh",bn],lifecycle:bt.api.Exec.Lifecycle.STDIN}}),function(){r()}}},[y,t,w,n,h]);var R=k.map(function(e){switch(e.type){case"progress":return(0,m.jsx)(bs,(0,x._)({},e));case"failed":return(0,m.jsx)(bl,(0,x._)({},e));case"query":return(0,m.jsx)(bu,(0,x._)({},e));case"prompt":return(0,m.jsx)(bc,(0,x._)({},e));case"confirm":return(0,m.jsx)(bd,(0,x._)({},e))}});return(0,m.jsx)(aU.Modal,{isOpen:_,onRequestClose:function(){return S(!1)},children:(0,m.jsx)(O.View,{gap:8,children:R})})}function bs(e){var t=e.progress,n=(0,ll._)(e,["progress"]);return(0,m.jsxs)(O.View,(0,rX._)((0,x._)({},n),{children:["progress: ",t]}))}function bl(e){var t=e.error,n=(0,ll._)(e,["error"]);return(0,m.jsxs)(O.View,(0,rX._)((0,x._)({},n),{children:["error: ",t]}))}function bu(e){var t=e.query,n=e.options,r=e.respond,i=(0,ll._)(e,["query","options","respond"]),a=(0,N._)((0,B.useState)(null),2),o=a[0],s=a[1],l=(0,N._)((0,B.useState)(!1),2),u=l[0],c=l[1],d=(0,mw.useIdSeed)(),p=(0,B.useCallback)(function(){null!==o&&(c(!0),r.resolve({type:"answer",answer:n[o]}))},[o,n,r]);return(0,m.jsxs)(O.View,(0,rX._)((0,x._)({},i),{children:["query: ",t,n.map(function(e,n){return(0,m.jsxs)("label",{children:[(0,m.jsx)("input",{type:"radio",name:t,value:n,checked:o===n,onChange:function(){u||s(n)}}),e]},d(n))}),(0,m.jsx)(aZ.Button,{text:"submit",onClick:p})]}))}function bc(e){var t=e.prompt,n=e.respond,r=(0,ll._)(e,["prompt","respond"]),i=(0,N._)((0,B.useState)(""),2),a=i[0],o=i[1],s=(0,N._)((0,B.useState)(!1),2),l=s[0],u=s[1],c=(0,B.useCallback)(function(){u(!0),n.resolve({type:"answer",answer:a})},[a,n]);return(0,m.jsxs)(O.View,(0,rX._)((0,x._)({},r),{children:["prompt: ",t,(0,m.jsx)(mb.Input,{disabled:l,inputMode:"text",title:t,onChange:function(e){return o(e.currentTarget.value)}}),(0,m.jsx)(aZ.Button,{text:"submit",onClick:c})]}))}function bd(e){var t=e.confirm,n=e.dataConfirmation,r=e.respond,i=(0,ll._)(e,["confirm","dataConfirmation","respond"]),a=Object.keys(n),o=Object.values(n);return(0,m.jsxs)(O.View,(0,rX._)((0,x._)({},i),{children:["confirm: ",t,(0,m.jsxs)(br.default,{"aria-label":"the data to be used to generate your App",children:[(0,m.jsx)(ba.TableHeader,{children:a.map(function(e){return(0,m.jsx)(w6.Column,{isRowHeader:!0,children:e},e)})}),(0,m.jsx)(bi.default,{children:(0,m.jsx)(w6.Row,{children:o.map(function(e,t){return(0,m.jsx)(w6.Cell,{children:e},a[t])})})})]}),(0,m.jsx)(aZ.Button,{text:"yes",onClick:function(){return r.resolve({type:"answer",answer:"yes"})}}),(0,m.jsx)(aZ.Button,{text:"no",onClick:function(){return r.resolve({type:"answer",answer:"no"})}})]}))}var bp=e.i(982243),bf=e.i(376847),bh=e.i(678814),bg=e.i(268999),bm=e.i(660081),bv=e.i(551837),bx=e.i(861781),by=(0,A.cvarsFrom)("index.module.css",["--x","--y","--width","--height","--z-index"]);function bw(){}function bb(){var e=rt(tG),t=rr(iJ),n=rt(iZ),r=(0,a9.default)(),i=r.secrets,a=r.fs,o=ah(),s=(0,B.useCallback)(function(e){(0,es.track)(el.events.TOOL_OPENED,{source:"Agent Sidebar",tool:e.type}),o({pane:e})},[o]),l=g1(),u=(0,g2.useCurrentSession)(),c=u.session,d=u.setSession,p=u.setSessionId,f=aj(),h=(0,B.useRef)(null);(0,tK.useStyleSet)(h,sB(f.rect,f.getTransitionEnabled),function(e){var t;return t={},(0,P._)(t,by.x,e.x+"px"),(0,P._)(t,by.y,e.y+"px"),(0,P._)(t,by.width,e.width+"px"),(0,P._)(t,by.height,e.height+"px"),t});var g=(0,N._)((0,B.useState)(null),2),v=g[0],x=g[1],y=f.setChatRef;(0,B.useEffect)(function(){return v?(y({setSessionId:p,focusInput:function(){return v.focus()}}),function(){y(null)}):void y({setSessionId:p,focusInput:function(){}})},[v,y,p]);var w=(0,sW.useSetTourStepTarget)(la,s6.Agent),b=(0,B.useCallback)(function(e){e&&l(e),t("sidebar")},[l,t]);return(0,m.jsxs)(V.Surface,{innerRef:h,clsx:bx.default.root,style:(0,P._)({},by.zIndex,ra.zIndexLevels.tiledPane.toString()),children:[(0,m.jsx)(g4.AgentMain,{secrets:i,readFile:a.readFile,session:c,setSession:d,openPane:s,onPlanApproval:b,isDesktopOrTabletAgentPresentationCentered:e,isDesktopLayoutAgentPresentationTransitionInProgress:n,openPip:bw,inputRef:x,workspaceTourStepRef:w}),(0,m.jsx)(ld,{})]})}var bj=(0,ro.cssRecord)({root:[i8.rcss.position.absolute,i8.rcss.borderRadius(8),i8.rcss.pt(16),i8.rcss.align.center,{border:"1px solid",borderColor:A.tokens.outlineDimmest}],content:[i8.rcss.width("100%"),i8.rcss.flex.growAndShrink(1)]});function b_(){var e=rt(rk),t=rt(t0),n=rr(nj),r=function(){var e,t=(0,N._)((0,gc.useDrop)({accept:[nG.FileType.File,gT.DragItems.NewPane],collect:function(e){return{isOver:e.isOver()}},hover:function(e){i.drag()},drop:function(e){if("nodes"===e.type){var t=(0,ti.fsNodeToPanes)(e.nodes);t.length>0&&i.drop({panes:t})}}}),2),n=t[0].isOver,r=t[1],i=(e=rr(rl),(0,B.useEffect)(function(){n||e(null)},[n,e]),{drag:rr(rI),drop:rr(rC)});return r}(),i=u$({openPane:(0,B.useCallback)(function(e){(0,es.track)(el.events.TOOL_OPENED,{source:"Empty Layout",tool:e.pane.type}),n({pane:e.pane,edge:"left"})},[n])});return(0,m.jsx)(O.View,{style:{width:e.width,height:e.height,transform:"translate(".concat(e.x,"px, ").concat(e.y,"px)"),zIndex:t?100:void 0},css:bj.root,innerRef:r,children:(0,m.jsx)(O.View,{css:bj.content,children:(0,m.jsx)(aN.CommandBar,{autoFocus:!0,command:i,showToolDescriptions:!0})})})}var bS=ex.Type.Object({width:ex.Type.Number({minimum:0})}),bI=ex.Type.Object({width:ex.Type.Number({minimum:0})}),bC=ex.Type.Object({layout:ek,data:ex.Type.Record(ex.Type.String(),ex.Type.Object({type:ex.Type.String()})),agent:ex.Type.Optional(bI),filetree:ex.Type.Optional(bS)});function bk(e,t){var n=null;try{n=sn.Value.Decode(bC,e)}catch(e){}if(null===n)return null;var r={layout:n.layout,data:{},type:"saved",agent:n.agent,filetree:n.filetree},i=new Set,a=function(e){var t=new Set,n=!0,r=!1,i=void 0;try{for(var a,o=e.floating[Symbol.iterator]();!(n=(a=o.next()).done);n=!0){var s=a.value,l=!0,u=!1,c=void 0;try{for(var d,p=s.panes[Symbol.iterator]();!(l=(d=p.next()).done);l=!0){var f=d.value;t.add(f)}}catch(e){u=!0,c=e}finally{try{l||null==p.return||p.return()}finally{if(u)throw c}}}}catch(e){r=!0,i=e}finally{try{n||null==o.return||o.return()}finally{if(r)throw i}}return e.tiling&&function e(n){if("paneGroup"!==n.type)return n.children.forEach(e);var r=!0,i=!1,a=void 0;try{for(var o,s=n.panes[Symbol.iterator]();!(r=(o=s.next()).done);r=!0){var l=o.value;t.add(l)}}catch(e){i=!0,a=e}finally{try{r||null==s.return||s.return()}finally{if(i)throw a}}}(e.tiling),t}(r.layout),o=!0,s=!1,l=void 0;try{for(var u,c=Object.entries(n.data)[Symbol.iterator]();!(o=(u=c.next()).done);o=!0){var d=(0,N._)(u.value,2),p=d[0],f=d[1];if(a.has(p)){var h=t(f.type,f);if(!h){i.add(p);continue}r.data[p]=h}}}catch(e){s=!0,l=e}finally{try{o||null==c.return||c.return()}finally{if(s)throw l}}return(0,eZ.produce)(r,function(e){var t=function(t){if(a.has(t))return void e$(e.layout,t)},n=!0,r=!1,o=void 0;try{for(var s,l=i[Symbol.iterator]();!(n=(s=l.next()).done);n=!0){var u=s.value;t(u)}}catch(e){r=!0,o=e}finally{try{n||null==l.return||l.return()}finally{if(r)throw o}}var c=!0,d=!1,p=void 0;try{for(var f,h=Object.entries(e.data)[Symbol.iterator]();!(c=(f=h.next()).done);c=!0){var g=(0,N._)(f.value,2),m=g[0],v=g[1];"commands"!==v.type&&("codeEditor"!==v.type||v.data.path)&&"agentProgress"!==v.type&&"agentChat"!==v.type||(delete e.data[m],t(m))}}catch(e){d=!0,p=e}finally{try{c||null==h.return||h.return()}finally{if(d)throw p}}})}var bE=e.i(732964),bT=e.i(718632),bP=e.i(755181);function bR(e){var t,n,r,i,a,o,s,l,u,c=e.repl,d=e.currentUser,p=(0,v.useRouter)(),f=(0,Z.useQueryParam)("enterInAgentMode","boolean"),h=(0,Z.useQueryParam)("enterInExpertMode","boolean"),g=(0,Z.useQueryParam)("popupId","string"),y=(0,J.isInBonsaiWebview)(p),w=(0,J.doesBonsaiWebviewSupportFeature)(p,"workspace2"),b=(0,n3.useFilePaneFlag)(),j=(0,N._)((0,B.useState)(function(){var e;return(0,aC.createPaneUI)({config:(e=(0,yE.createPaneUIConfig)(),(0,rX._)((0,x._)({},e),{webview:yC,commands:g9,tutorial:yg,extension:mu,extensionStore:v2,replAuth:v6,searchReplace:yt,deployments:yP.deploymentsUI,config:mn,integrations:yR.integrationsUI,extensionDevtools:vY,csvPreview:yT.csvPreviewUI,agentChat:g6,agentProgress:yA.unsupportedUI,multiplayer:yA.unsupportedUI})),filePaneFlag:b})}),1)[0],_=null;g?_=bk(!(a=tX.default.get(t4(g)))||"string"==typeof a&&parseInt(a,10)<Date.now()?null:tX.default.get(t2(g)),j.decode):c.layoutState&&(_=bk(c.layoutState,j.decode));var S=!!c.config.isAgentStack;_||(u=h?"split-with-console":S?"split-with-automations":"split-with-webview");var I=(n=(t={repl:c,currentUser:d,enteredWithAgentPrompt:f}).repl,r=t.currentUser,i=t.enteredWithAgentPrompt,!n||!r||null!=n.lesson||n.config.isInPlanningPhase||void 0!==i&&i||r.hasSeenWorkspaceTour2025?null:{id:la,steps:({hasSeenWorkspaceTour2024:r.hasSeenWorkspaceTour2024}).hasSeenWorkspaceTour2024?[s7,li,le,ln,lr]:[s9,le,ln,li,lr],options:{disableAnimation:!0}}),C=(o=(0,Z.useQueryParam)("deploymentPane","boolean"),s=(0,Z.useQueryParam)("projectPane","boolean"),(0,X.default)(function(){return o?{type:"deployments"}:s?{type:"project"}:void 0},[o,s])),k=(!!(null==(l=c.origin)?void 0:l.id)||h)&&!c.config.isInPlanningPhase,E=(f||!!c.config.isInPlanningPhase)&&!c.config.figmaUrl&&!k;return(0,m.jsx)(h7.TrackingHierarchyProvider,{hierarchy:{page:"workspace"},children:(0,m.jsxs)(ee.Pid2Provider,{currentUsername:d.username,replId:c.id,children:[(0,m.jsx)(lE.SessionProvider,{children:(0,m.jsx)(n7,{initialPane:C,savedLayoutState:_,popupId:g,agentCenteredLayout:E,agentLayoutVariation:u,agentPosition:d.workspacePreferences.agentPosition,isTouring:!!I,children:(0,m.jsx)(wY,{tour:I,userId:d.id,children:(0,m.jsx)(bA,{ui:j,repl:c,currentUser:d,isBonsaiWebview:y,doesBonsaiSupportWorkspace2:w,isTouring:!!I},c.id)})})}),(0,m.jsx)(et.default,{})]})})}function bA(e){var t,n,r,i,a,o,s,l,u,c,d,p,f,h,g,v,x,y,w=e.repl,b=e.currentUser,j=e.isBonsaiWebview,_=e.doesBonsaiSupportWorkspace2,S=e.ui,I=e.isTouring,C=(t=am(),n=rr(ix),r=rr(iy),i=(0,wn.useThrowBsod)(),a=(0,E.useFlag)({controlName:"flag-null-diagnostics",logFlagToAnalytics:!1}),s=(o=(0,N._)((0,B.useState)(!1),2))[0],l=o[1],c=(u=(0,N._)((0,B.useState)(!1),2))[0],d=u[1],p=(0,pa.useUpdatePresence)(),f=(0,pa.useGetColorForUser)(),h=(0,E.useFlag)({controlName:"flag-open-telemetry-tracing"}),g=(0,E.useFlag)({controlName:"flag-multi-lsp-connections"}),v=(0,X.default)(function(){return{onPresenceCommand:p,getColorForUser:f,onUnrecoverableError:(0,wZ.default)({origin:"replEnvironmentDesktop: services/unrecoverableError",tags:{environment:"desktop"},onNonBsodUnrecoverableError:function(e){e===Q.NonBsodErrorType.NotAllowed?l(!0):e===Q.NonBsodErrorType.RequiresRefresh&&d(!0)},throwBsod:i}),openFile:t,openMultipleFiles:n,openMultipleURLs:r,enableUserEvents:a,enableMultipleLSPClientsPerFile:g,openTelemetryTracing:h,enableReplspaceSshTokenPassthrough:!0}},[a,t,n,r,i,p,f,h,g]),x=(0,wX.useCreateServices)(v),(0,X.default)(function(){return{services:x,isPleaseRefresh:c,isNotAllowed:s}},[x,c,s])),k=C.services,T=C.isPleaseRefresh,P=C.isNotAllowed,R=(0,E.useFlag)({controlName:"flag-build-score-survey"});(0,bv.useSetInitialIconOnlySelectionControls)(!!w.layoutState);var A=(0,X.default)(function(){return(0,da.initKeybindings)(null==b?void 0:b.keybindings.keybindings)},[b]);if(!k)return(0,m.jsx)(U,{});var D=w.authorizations.useAdvancedChat.isAuthorized;return(0,m.jsx)($.AiProvider,{replId:w.id,currentUser:b,hasAccessToAdvancedModel:D,orgId:null==(y=w.org)?void 0:y.id,renderEmptyState:function(){return(0,m.jsx)(U,{})},children:(0,m.jsx)(w4.ContextMenuProvider,{children:(0,m.jsxs)(dd,{services:k,ui:S,repl:w,userKeybindings:A,children:[(0,m.jsxs)(gP.default,{origin:"ErrorBoundary: ReplEnvironmentDesktop Top level",bsod:!0,children:[(0,m.jsx)(cF,{}),(0,m.jsx)(ct,{isAdmin:b.isAdmin,isSubscribed:b.isSubscribed}),(0,m.jsx)(bh.default,{repl:w}),j&&!_?(0,m.jsx)(db,{}):null,(0,m.jsx)(aH,{}),(0,m.jsx)(df,{}),(0,m.jsx)(w$,{repl:w,currentUser:b}),(0,m.jsx)(dN,{}),(0,m.jsx)(dM,{}),(0,m.jsx)(bV,{repl:w}),(0,m.jsx)(sF,{}),(0,m.jsx)(sR,{}),(0,m.jsx)(w8.default,{}),(0,m.jsx)(bo,{}),I?null:(0,m.jsx)(yH,{replId:w.id}),(0,m.jsx)(bp.default,{isOpen:P}),(0,m.jsx)(bf.default,{isOpen:T}),(0,m.jsx)(bT.GitInShellConfirmModal,{}),(0,m.jsx)(bE.DefaultBucketAccessConfirmModal,{}),(0,m.jsx)(sk,{}),(0,m.jsx)(dg,{}),(0,m.jsx)(w3.DisconnectedModal,{}),(0,m.jsx)(u_,{}),(0,m.jsx)(bg.ConvertedToProjectModal,{repl:w}),R?(0,m.jsx)(bm.BuildScoreSurveyTopLevelHook,{}):null]}),(0,m.jsx)(bD,{replId:w.id})]})})})}function bD(e){var t,n=e.replId,r=(0,N._)((0,wn.useBsod)(),1)[0],i=(0,N._)((t=(0,x._)({},H,void 0),W.useMutation(q,t)),1)[0],a=(0,B.useCallback)(function(){i({variables:{input:{replId:n,state:{}}}})},[i,n]);return(0,B.useEffect)(function(){r&&a()},[r,a]),(0,m.jsx)(wJ.default,{})}var bV=(0,B.memo)(function(e){var t,n,r,i,a,o,s,l,u=e.repl,c=(t=rr(tz),n=ri(tr),r=(0,Y.default)(),i=(0,dz.useIsMac)(),a=(0,dz.useIsWindows)(),o=(i||a)&&r?F.HEADER_HEIGHT:0,s=(0,B.useRef)(null),l=(0,dW.default)(function(e){var r=e.width,i=e.height;if(r&&i&&s.current){var a=s.current.getBoundingClientRect(),l=a.top,u={width:r,height:i,x:a.left,y:l-o};(0,tu.default)(u,n())||t(u)}}),(0,B.useCallback)(function(e){s.current=e,l(e)},[l])),d=rt(tI),p=rt(e0),f=rt(e1),h=rt(e2),g=(0,B.useRef)(null),v=(0,B.useCallback)(function(e){c(e),g.current=e},[c]),x=(0,Y.default)();return(0,m.jsxs)(m.Fragment,{children:[(0,m.jsxs)(V.Surface,{innerRef:v,clsx:[bP.default.contentContainer,(0,P._)({},bP.default.desktopApp,x)],children:[d?(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)(gi,{repl:u}),(0,m.jsx)(lX,{}),(0,m.jsxs)("main",{id:"main-content",children:[f.map(function(e){return(0,m.jsx)(yQ,{handleId:e},e)}),h.map(function(e){return(0,m.jsx)(g0,{headerId:e},e)}),p.map(function(e){return(0,m.jsx)(gV,{paneId:e},e)}),0===p.length?(0,m.jsx)(b_,{}):null]}),(0,m.jsx)(rb,{}),(0,m.jsx)(au,{}),(0,m.jsx)(c$,{}),(0,m.jsx)(l_.ContextMenu,{}),(0,m.jsx)(bb,{})]}):null,(0,m.jsx)(w2,{})]}),d?null:(0,m.jsx)(U,{})]})}),bO=e.i(745844),bF=e.i(734419),bM=e.i(80366),bL=e.i(722313),bG=e.i(507187),bU=e.i(932495),bN=e.i(714260),bB=e.i(788124),bW=e.i(578134),bz=e.i(838720);e.s(["default",0,function(){var e,t,n,r=null,i=(0,v.useRouter)().query;if(!i.replUrl)throw Error("Expected replUrl to be set");if(!i.replId)throw Error("Expected replId to be set");var a=i.replId.toString(),o=(e={variables:{replId:a,environment:(0,bG.useEnvironment)(),platform:(0,bU.usePlatform)()},ssr:!!i.ssr},t=(0,x._)({},I,e),b.useQuery(C,t)),s=o.data,l=o.loading,u=o.error,c=(0,E.useFlag)({controlName:"flag-token-email-verification"}),d=(null==s?void 0:s.currentUser)||void 0,p=(null==s?void 0:s.getRepl)&&("Repl"===s.getRepl.__typename||"ReplRedirect"===s.getRepl.__typename||"ReplSubscriptionExpired"===s.getRepl.__typename)?s.getRepl:null,f=(null==s?void 0:s.getRepl)&&"Repl"!==s.getRepl.__typename&&"ReplRedirect"!==s.getRepl.__typename&&"ReplSubscriptionExpired"!==s.getRepl.__typename?s.getRepl.message:null,h=(null==p?void 0:p.__typename)==="Repl"?p:null,g=null!=(n=null==h?void 0:h.description)?n:void 0,y=null!=f?f:null==u?void 0:u.message,w=c&&d&&!d.isVerified;return r=w?(0,m.jsx)(O.View,{clsx:bz.default.emailVerificationWrapper,grow:!0,shrink:!0,children:(0,m.jsx)(k.default,{})}):y?(0,m.jsx)(O.View,{align:"center",justify:"center",grow:!0,shrink:!0,children:(0,m.jsx)(a0.Text,{multiline:!1,children:"Something went wrong loading the Repl. Please reload the page and try again."})}):l?(0,m.jsx)(U,{animation:!0}):h&&d?(0,m.jsx)(bN.default.Provider,{value:h.id,children:(0,m.jsx)(bR,{repl:h,currentUser:d},h.id)}):(0,m.jsx)(U,{animation:!0}),(0,m.jsx)(bB.default,{children:(0,m.jsxs)(bW.default,{dataCy:"workspace-page",title:"".concat((null==h?void 0:h.title)||"Loading..."),description:g,noHeader:!w,noMain:!w,noSidebar:!w,noFooter:!0,hideEmailVerify:!0,children:[h?(0,m.jsx)(bL.OEmbedHead,{replPath:h.url}):null,(0,m.jsx)(T.OpenTelemetryTracer,{}),(0,m.jsxs)(V.Surface,{clsx:bz.default.surface,children:[(0,m.jsx)(bO.HideBodyOverflow,{}),(0,m.jsx)(bF.PreventBodyOverscrollX,{}),r]}),(0,m.jsx)(bM.default,{replId:a})]})})}],453926)},545749,(e,t,n)=>{var r="/replEnvironmentDesktop";(window.__NEXT_P=window.__NEXT_P||[]).push([r,function(){return e.r(453926)}]),t.hot&&t.hot.dispose(function(){window.__NEXT_P.push([r])})}]);

//# debugId=70e6788d-73c8-1bb6-57af-04821dd969e6
//# sourceMappingURL=b05149ea14eace18.js.map