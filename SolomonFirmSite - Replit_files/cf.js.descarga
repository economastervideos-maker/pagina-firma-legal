
        window.CFQ = window.CFQ || [];
        window.CFQ.push({
          projectData: {
            scriptVersion: 'modern',
            segmentationHeaders: {"x-viewer-country":"MX","x-viewer-region":"BCN","x-viewer-city":"Tijuana","x-is-mobile-viewer":"false","x-is-bot":"false"},
            project: {"org_id":"68c9ad3d4cddb58cf3a1f938","holdout_info":{"holdout_experiment_id":"68c9ad4d4cddb58cf3a1f93a","holdout_variant_id":"68c9ad4d4cddb58cf3a1f93b","treatment_variant_id":"68c9ad4d4cddb58cf3a1f93c","seed":190941316,"variant_bins":{"68c9ad4d4cddb58cf3a1f93b":[[0,4999]],"68c9ad4d4cddb58cf3a1f93c":[[5000,99999]]}},"frames":[],"audiences":{"68f6f06ec2be5433c8e1fd25":{"selector":{}}},"metrics":[{"id":"68c9b1553c70c3231c438931","selector":{"and":[{"url":"https://replit.com/"},{"or":[{"universal":{"t":"button","fingerprint":"32870f90","n":{"i":1,"t":1},"ariaLabel":"Start building your app idea","p":{"t":"div","n":{"i":1,"t":1},"p":{"t":"div","n":{"i":3,"t":3},"p":{"t":"div","n":{"i":2,"t":2},"p":{"t":"div","n":{"i":1,"t":1},"p":{"t":"div","n":{"i":1,"t":1},"p":{"t":"section","n":{"i":4,"t":6},"p":{"t":"div","n":{"i":1,"t":9},"p":{"t":"div","n":{"i":1,"t":1},"p":{"t":"div","n":{"i":1,"t":1},"p":{"t":"main","n":{"i":1,"t":1},"p":{"t":"div","n":{"i":1,"t":1},"p":{"t":"div","id":"__next","n":{"i":1,"t":2},"p":{"t":"body","n":{"i":1,"t":1},"p":{"t":"html"}}}}}}}}}}}}}},"descendants":[{"depth":1,"sel":{"t":"span","text":"Start building with AI","n":{"i":1,"t":1}}}]}},{"universal":{"t":"a","fingerprint":"121c68b1","n":{"i":2,"t":2},"href":"/signup","p":{"t":"nav","n":{"i":1,"t":1},"p":{"t":"div","n":{"i":4,"t":4},"p":{"t":"div","n":{"i":1,"t":1},"p":{"t":"div","n":{"i":1,"t":1},"p":{"t":"div","n":{"i":1,"t":3},"p":{"t":"header","n":{"i":1,"t":1},"p":{"t":"div","n":{"i":1,"t":1},"p":{"t":"div","id":"__next","n":{"i":1,"t":2},"p":{"t":"body","n":{"i":1,"t":1},"p":{"t":"html"}}}}}}}}}},"descendants":[{"depth":1,"sel":{"t":"span","text":"Sign up","n":{"i":1,"t":1}}}]}}]}]}},{"id":"68cde1927c0bfc7f9cc1ebb7","selector":{"and":[{"url":"https://staging.replit.com/"},{"or":[{"universal":{"t":"button","fingerprint":"32870f90","n":{"i":1,"t":1},"ariaLabel":"Start building your app idea","p":{"t":"div","n":{"i":1,"t":1},"p":{"t":"div","n":{"i":3,"t":3},"p":{"t":"div","n":{"i":2,"t":2},"p":{"t":"div","n":{"i":1,"t":1},"p":{"t":"div","n":{"i":1,"t":1},"p":{"t":"section","n":{"i":4,"t":6},"p":{"t":"div","n":{"i":1,"t":9},"p":{"t":"div","n":{"i":1,"t":1},"p":{"t":"div","n":{"i":1,"t":1},"p":{"t":"main","n":{"i":1,"t":1},"p":{"t":"div","n":{"i":1,"t":1},"p":{"t":"div","id":"__next","n":{"i":1,"t":2},"p":{"t":"body","n":{"i":1,"t":1},"p":{"t":"html"}}}}}}}}}}}}}},"descendants":[{"depth":1,"sel":{"t":"span","text":"Start building with AI","n":{"i":1,"t":1}}}]}},{"universal":{"t":"a","fingerprint":"121c68b1","n":{"i":2,"t":2},"href":"/signup","p":{"t":"nav","n":{"i":1,"t":1},"p":{"t":"div","n":{"i":4,"t":4},"p":{"t":"div","n":{"i":1,"t":1},"p":{"t":"div","n":{"i":1,"t":1},"p":{"t":"div","n":{"i":1,"t":3},"p":{"t":"header","n":{"i":1,"t":1},"p":{"t":"div","n":{"i":1,"t":1},"p":{"t":"div","id":"__next","n":{"i":1,"t":2},"p":{"t":"body","n":{"i":1,"t":1},"p":{"t":"html"}}}}}}}}}},"descendants":[{"depth":1,"sel":{"t":"span","text":"Sign up","n":{"i":1,"t":1}}}]}}]}]}},{"id":"68d1cdc1ca209329fe9a53f8","selector":{}},{"id":"68d1cdeb7c0bfc7f9cc1ebe0","selector":{}},{"id":"68daf9aa1e6391afbbf4eaaf","selector":{"and":[{"url":"https://replit.com/enterprise"},{"or":[{"universal":{"t":"button","fingerprint":"1d4dad54","n":{"i":1,"t":1},"p":{"t":"div","n":{"i":6,"t":6},"p":{"t":"form","n":{"i":1,"t":1},"p":{"t":"section","id":"inlineForm","n":{"i":1,"t":1},"p":{"t":"div","n":{"i":1,"t":1},"p":{"t":"dialog","ariaLabel":"Contact Sales","n":{"i":1,"t":1},"p":{"t":"div","n":{"i":3,"t":3},"p":{"t":"body","n":{"i":1,"t":1},"p":{"t":"html"}}}}}}}},"descendants":[{"depth":1,"sel":{"t":"span","text":"Contact Sales","n":{"i":1,"t":1}}}]}},{"universal":{"t":"button","fingerprint":"6293423b","n":{"i":1,"t":1},"text":"Request demo","p":{"t":"form","id":"cf-demo-form","n":{"i":1,"t":1},"p":{"t":"div","n":{"i":1,"t":1},"p":{"t":"div","n":{"i":2,"t":2},"p":{"t":"div","n":{"i":1,"t":1},"p":{"t":"section","n":{"i":2,"t":5},"p":{"t":"div","n":{"i":1,"t":10},"p":{"t":"div","n":{"i":1,"t":1},"p":{"t":"main","n":{"i":1,"t":1},"p":{"t":"div","n":{"i":1,"t":1},"p":{"t":"div","id":"__next","n":{"i":1,"t":1},"p":{"t":"body","n":{"i":1,"t":1},"p":{"t":"html"}}}}}}}}}}}}}}]}]}},{"id":"6901949bacea5b0dc096d6d8","selector":{"and":[{"url":"https://replit.com/enterprise"},{"universal":{"t":"button","fingerprint":"3b65f6d","n":{"i":1,"t":1},"p":{"t":"div","n":{"i":2,"t":2},"p":{"t":"form","n":{"i":1,"t":1},"p":{"t":"div","n":{"i":1,"t":1},"p":{"t":"div","n":{"i":2,"t":2},"p":{"t":"div","n":{"i":1,"t":1},"p":{"t":"div","n":{"i":1,"t":1},"p":{"t":"section","n":{"i":2,"t":5},"p":{"t":"div","n":{"i":1,"t":11},"p":{"t":"div","n":{"i":1,"t":1},"p":{"t":"main","n":{"i":1,"t":1},"p":{"t":"div","id":"__next","n":{"i":1,"t":2},"p":{"t":"body","n":{"i":1,"t":1},"p":{"t":"html"}}}}}}}}}}}}},"descendants":[{"depth":1,"sel":{"t":"span","text":"Contact Sales","n":{"i":1,"t":1}}}]}}]}},{"id":"690d9ef0c5783f175aa5b0ce","selector":{},"js_binder":"function (args) {\n  const TARGET_TEXT = 'Thank you for your interest in Replit Teams!'\n  const REPORTED = new WeakSet()\n\n  const startObserver = () => {\n    console.log('[Coframe] Replit Enterprise watcher loaded')\n\n    const observer = new MutationObserver((mutations) => {\n      if (!window.location.pathname.includes('enterprise')) return\n\n      for (const mutation of mutations) {\n        // only detect added nodes\n        mutation.addedNodes.forEach((node) => {\n          if (!(node instanceof HTMLElement)) return\n\n          const text = node.textContent?.trim() ?? ''\n          if (text.includes(TARGET_TEXT) && !REPORTED.has(node)) {\n            console.log('[Coframe] Replit Enterprise form successful submission event sent')\n\n            window.CFQ = window.CFQ || []\n            window.CFQ.push({\n              emit: 'conversion',\n              payload: { metricId: args.metricId },\n            })\n\n            REPORTED.add(node)\n          }\n        })\n      }\n    })\n\n    observer.observe(document.body, { childList: true, subtree: true })\n  }\n\n  if (document.body) startObserver()\n  else document.addEventListener('DOMContentLoaded', startObserver)\n}\n"}],"settings":{"mutation_observer_active":true,"track_only_activated_frames":false,"analytics_integrations":null},"tags":[]}
          },
        });
        var Coframejs=function(e){"use strict";function t(){return window.location.href}function n(){var e,t;return Array.from(null!==(e=null===navigator||void 0===navigator?void 0:navigator.languages)&&void 0!==e?e:[null!==(t=null===navigator||void 0===navigator?void 0:navigator.language)&&void 0!==t?t:[]])}function o(){var e,t,n;return null!==(n=null!==(e=null===navigator||void 0===navigator?void 0:navigator.platform)&&void 0!==e?e:null===(t=null===navigator||void 0===navigator?void 0:navigator.userAgentData)||void 0===t?void 0:t.platform)&&void 0!==n?n:""}function r(){try{return document.cookie}catch(e){return""}}function i(){const e=[],t=[],n=[];try{const t=r();if(t){const n=t.split(";").map(e=>e.trim());for(const t of n){const[n]=t.split("=");if(n){if(n.startsWith("coframe."))continue;e.push(n)}}}}catch(e){}try{if("undefined"!=typeof window&&window.localStorage){const e=Object.keys(window.localStorage);for(const n of e)t.push(n)}}catch(e){}try{if("undefined"!=typeof window&&window.sessionStorage){const e=Object.keys(window.sessionStorage);for(const t of e)n.push(t)}}catch(e){}return{cookie_keys:e,local_storage_keys:t,session_storage_keys:n}}function s(e,t){return new Function(`return (${e})`)()(t)}const a="coframe.user.token",l="coframe.lastVisitTime",c="coframe.cvc",d=()=>window.crypto&&crypto.randomUUID?crypto.randomUUID():"10000000-1000-4000-8000-100000000000".replace(/[018]/g,e=>(e^crypto.getRandomValues(new Uint8Array(1))[0]&15>>e/4).toString(16)),u=e=>{const t=r(),n=new RegExp(`(?:^| )${e}=([^;]*)`,"g");let o=null,i="";for(;o=n.exec(t),null!==o;)i=o[1];return i};let f=!1;const m=e=>{f=e},p=(e,t,n)=>{if(!f)return void n.error("Cookies are not enabled","setting_cookie_when_disabled");const o=new Date;o.setTime(o.getTime()+3456e7);const r=o.toUTCString(),i=n=>{!function(e){document.cookie=e}(n?`${e}=${t};path=/;domain=${n};expires=${r};secure`:`${e}=${t};path=/;expires=${r};secure`)},s=window.location.hostname;if("localhost"===s)i();else{const e=s.split(".");for(let t=e.length-2;t>=0;t--){let n=`${e.slice(t).join(".")}`;0!==t&&(n=`.${n}`),i(n)}}u(e)!==t&&n.error(`Failed to set cookie ${e} for domain: ${s}`,"failed_to_set_cookie",{name:e,hostname:s})},h=new WeakMap,v=(e,t)=>{const n={withDescendants:!0,cache:!0,...t};if(!1===n.cache)return _(e,t);const o=JSON.stringify(n);h.has(e)||h.set(e,new Map);const r=h.get(e);if(null==r?void 0:r.has(o)){const e=r.get(o);if(e)return e}const i=_(e,t);return r&&r.set(o,i),i},_=(e,t)=>{const n={withDescendants:!0,...t};function o(e){const t=e.childNodes;for(let e=0;e<t.length;e++){const n=t[e];if(n.nodeType===Node.TEXT_NODE&&n.nodeValue)return n.nodeValue.trim()}return null}const r=e=>e.parentElement||function(e){if(e===document.documentElement||e===document.body)return null;const t=e.getRootNode();return t instanceof ShadowRoot?t.host:null}(e),i=(e,t)=>{var n;const s={t:e.tagName.toLowerCase(),id:e.getAttribute("id")||void 0,text:o(e)||void 0,href:e.getAttribute("href")||void 0,dataTestId:e.getAttribute("data-test-id")||void 0,ariaLabel:e.getAttribute("aria-label")||void 0};for(const e of Object.keys(s))void 0===s[e]&&delete s[e];e.shadowRoot&&(s.isShadowRoot=!0);let a=0,l=0,c=null===(n=e.parentElement)||void 0===n?void 0:n.firstElementChild;for(;c;)c.tagName.toLowerCase()===s.t&&(l++,c===e&&(a=l)),c=c.nextElementSibling;a>0&&l>0&&(s.n={i:a,t:l});const d=r(e);if(d&&t){const e=i(d,t);e&&(s.p=e)}return s},s=i(e,!0),a=n.withDescendants?function(e,t){const n=[];return function e(o,r){if(!(r>t))for(let t=0;t<o.childNodes.length;t++){const i=o.childNodes[t];i.nodeType===Node.ELEMENT_NODE&&(n.push({element:i,depth:r}),e(i,r+1))}}(e,1),n}(e,3):[];for(const e of a){const t=i(e.element,!1);(t.id||t.dataTestId||t.ariaLabel||t.href||t.text)&&(s.descendants=s.descendants||[],s.descendants.push({depth:e.depth,sel:t}))}return s.fingerprint=(e=>{let t=0;if(0===e.length)return t.toString();for(let n=0;n<e.length;n++){t=(t<<5)-t+e.charCodeAt(n),t&=t}return Math.abs(t).toString(16)})(JSON.stringify(s)),s},g=(e,t)=>e.universal?w((null==t?void 0:t.context)||document,e.universal,(null==t?void 0:t.debug)||!1).element:e.css?((null==t?void 0:t.context)||document).querySelector(e.css):null,w=(e,t,n)=>{var o,r,i;const s=[],a=(e,t,o)=>{n&&s.push({xpath:t,message:e,element:o})},l=t=>{const n=t[0].xpath;let o=(t=>{if(!t)return null;let n;try{n=e.evaluate(t,e,null,XPathResult.ORDERED_NODE_SNAPSHOT_TYPE,null)}catch(e){return console.error("[Coframe] Error evaluating xpath",t,e),null}if(1===n.snapshotLength){const e=n.snapshotItem(0);return"/html"!==t&&a("Found unique",t,e),e}return n.snapshotLength>1?(a("Found more than one element for xpath:",t),null):(a("No element found for xpath:",t),null)})(n);if(!o)return null;let r=o.shadowRoot||o,i=n;for(let n=1;n<t.length;n++){const s=t[n];if(s.isInsideShadowRoot){const e=r.querySelectorAll(s.css);if(0===e.length)return null;if(e.length>1)return a(`Found more than one element for css: ${s.css}`,i),null;const t=e[0];if(!t)return null;o=t,r=o.shadowRoot||o,i=`${i}/${s.xpath}`,a(`Found ${n} shadow element`,i,o)}else{let t;try{t=e.evaluate(s.xpath,o,null,XPathResult.FIRST_ORDERED_NODE_TYPE,null)}catch(e){return console.error("[Coframe] Error evaluating xpath",s.xpath,e),null}const l=t.singleNodeValue;if(!l)return null;i=`${i}/${s.xpath}`,a(`Found ${n} element`,i,l),o=l,r=o.shadowRoot||o}}return o},c=b(t);let d=l(c[0]);if(d&&!n)return{element:d};const[u,f]=y(t,10);for(const e of u)if(d=l(e),d&&!n)return{element:d};if(t.text){const e=x(t.text,t.t);for(const t of e)if(d=l(t),d&&!n)return{element:d}}if(t.descendants)for(const e of t.descendants){const r={xpath:`/ancestor::*[${e.depth}][self::${t.t}]`,css:`:nth-ancestor(${e.depth}):is(${t.t})`},i=null===(o=y(e.sel,1)[0])||void 0===o?void 0:o[0];if(i&&i.length>0){if(d=l($(i,r)),d&&!n)return{element:d}}if(e.sel.text){const t=x(e.sel.text,e.sel.t);for(const e of t)if(e&&e.length>0){if(d=l($(e,r)),d&&!n)return{element:d}}}}for(const e of c.slice(1))if(d=l(e),d&&!n)return{element:d};for(const e of f)if(d=l(e),d&&!n)return{element:d};if(n){const e=c.length>0?c[c.length-1]:null,t=e&&e.length>0?e[e.length-1]:null,n=(null===(r=null==t?void 0:t.xpath)||void 0===r?void 0:r.replace(/^\//,""))||"";return{element:(null===(i=s.filter(e=>e.element).filter(e=>e.xpath.endsWith(n)).sort((e,t)=>{const n=t.xpath.length-e.xpath.length;return 0!==n?n:0})[0])||void 0===i?void 0:i.element)||null,debugList:s}}return{element:null}},b=e=>{var t,n;const o=[];let r=[{xpath:"",css:"",isInsideShadowRoot:!1}],i=e;for(;i;){const e=i.t;if(!e)break;let s=`/${e}`,a=e.toLowerCase();(null===(t=i.n)||void 0===t?void 0:t.i)&&(null===(n=i.n)||void 0===n?void 0:n.t)&&(s+=`[count(../${e})=${i.n.t}][${i.n.i}]`,a=`${a}:nth-of-type(${i.n.i})`);!0===i.isShadowRoot&&r.push({xpath:"",css:"",isInsideShadowRoot:!0});const l=r[r.length-1],c=r.slice(0,-1),d={xpath:`${s}${l.xpath}`,css:`${a} ${l.css}`.trim(),isInsideShadowRoot:I(i)};r=[...c,d],i=i.p;const u=(i?"/":"")+d.xpath,f=[{...d,xpath:u},...c.reverse()].filter(e=>!E(e));o.unshift(f)}return o},x=(e,t)=>{const n=[];for(const o of[t,"*"]){const t=e.split("'"),r=1===t.length?`'${e}'`:`concat(${t.map(e=>`'${e}'`).join(', "\'", ')})`;n.push([{isInsideShadowRoot:!1,xpath:`//${o}[not(self::script or self::style) and contains(text(), ${r})]`,css:`*:contains("${e}")`}])}return n},y=(e,t)=>{var n,o,r;const i=[],s=[];let a=[{xpath:"",css:""}],l=e;for(;l;){const e=l.t,c=[],d=[],u=[];l.id?c.push({xpath:`[@id="${l.id}"]`,css:`#${l.id}`}):l.dataTestId&&c.push({xpath:`[@data-test-id="${l.dataTestId}"]`,css:`${e}[data-test-id="${l.dataTestId}"]`}),l.ariaLabel&&d.push({xpath:`[@aria-label="${l.ariaLabel}"]`,css:`${e}[aria-label="${l.ariaLabel}"]`}),l.href&&d.push({xpath:`[@href="${l.href}"]`,css:`${e}[href="${l.href}"]`});const f={xpath:(null===(n=l.n)||void 0===n?void 0:n.i)&&(null===(o=l.n)||void 0===o?void 0:o.t)?`[count(../${e})=${l.n.t}][${l.n.i}]`:"",css:(null===(r=l.n)||void 0===r?void 0:r.i)?`${e}:nth-of-type(${l.n.i})`:e};for(const n of c)for(const o of a){if(i.push([{xpath:`//${e}${n.xpath}${o.xpath}`,css:n.css+(o.css?` ${o.css}`:""),isInsideShadowRoot:!1}]),i.length>=t)return[i,s]}for(const t of d)for(const n of a){const o=`/${e}${t.xpath}${n.xpath}`,r=t.css+(n.css?` > ${n.css}`:"");u.push({xpath:o,css:r});s.unshift([{xpath:`/${o}`,css:r,isInsideShadowRoot:!1}])}for(const t of a){u.push({xpath:`/${e}${f.xpath}${t.xpath}`,css:f.css+(t.css?` > ${t.css}`:"")})}a=u,l=l.p}return[i,s]},I=e=>!!e&&(!0===e.isShadowRoot||!(!e.p||!I(e.p))),$=(e,t)=>{if(0===e.length)return e;const n=[...e],o=n.pop();return[...n,{...o,xpath:`${o.xpath}${t.xpath}`,css:`${o.css} ${t.css}`}]},E=e=>""===e.xpath;function k(){return!!L||(j?(console.warn("[Coframe] Preview variant by default does not send events. Use &coframe_should_send_events=true to force sending events"),!1):!(S&&!f)&&!(T&&!C))}let j=!1;let S=!1;let C=!1;const A=e=>{C=e};let T=!1;const F=e=>{T=e};let L=!1;const D=[],R=[],O=[];function N(e,t){R.push(t),R.length>=e.batchSize&&M(e.projectId)}function U(e,t,n=!1){D.push(t),(n||D.length>=e.batchSize)&&M(e.projectId)}function M(e){if(k()&&(D.length>0&&(q(e,D,"batched_events"),D.length=0),R.length>0&&(q(e,R,"batched_monitoring"),R.length=0),O.length>0)){for(const e of O)z(e);O.length=0}}function P(e,{projectId:n,sessionId:o,eventType:r,orgId:i,userToken:s}){U(e,{type:r,project_id:n,session_id:o,time:new Date,url:t(),org_id:i,user_token:s})}function q(e,t,n="events"){const o=`https://ingest.app.coframe.com/ingest/v2/${n}/${e}/`;if(navigator.sendBeacon){const e=JSON.stringify(t),n=new Blob([e],{type:"text/plain"});navigator.sendBeacon(o,n)||console.warn("[Coframe] failed to send event beacon")}else console.warn("[Coframe] cannot send event beacon, feature unavailable")}function z(e){if(navigator.sendBeacon){const t=JSON.stringify(e),n=new Blob([t],{type:"text/plain"});navigator.sendBeacon("https://ingest.app.coframe.com/ingest/v2/session_result/",n)||console.warn("[Coframe] failed to send event beacon")}else console.warn("[Coframe] cannot send event beacon, feature unavailable")}function B({err:e,orgId:t,projectId:n,sessionId:o}){let r="Unknown error",i="";"string"==typeof e?r=e:e&&"object"==typeof e&&("message"in e&&"string"==typeof e.message&&(r=e.message),"stack"in e&&"string"==typeof e.stack&&(i=e.stack)),i||(i=(new Error).stack||"");try{q(n,{org_id:t,project_id:n,event_id:d(),variant_id:"",experiment_id:"",session_id:o,url:window.location.href,monitoring_type:"sdk_error",local_time:(new Date).toISOString(),metadata:{error_message:r,stack:i,user_agent:navigator.userAgent}},"monitoring")}catch(e){console.warn("[Coframe] Error in reportException:",e)}}const H="largest-contentful-paint";function Q(e,t){var n;const o=function(){window.CFQ=window.CFQ||[];const e=window.CFQ;if(e.__cfqHooked)return e;e.__cfqHooked=!0,e.__cfqListeners=[];const t=e.push.bind(e);return e.push=(...n)=>{const o=t(...n),r=e.__cfqListeners;for(let e=0;e<n.length;e++){const t=n[e];for(let e=0;e<r.length;e++){const n=r[e];n.predicate(t)&&n.callback(t)}}return o},e}(),r={predicate:e,callback:t};null===(n=null==o?void 0:o.__cfqListeners)||void 0===n||n.push(r);let i=!0;return()=>{if(!i)return;i=!1;const e=o.__cfqListeners,t=e.indexOf(r);-1!==t&&e.splice(t,1)}}function J(e){const t=window.CFQ||[];for(let n=t.length-1;n>=0;n--)if(e(t[n]))return t[n]}function V(e,t=36e5){return new Promise(n=>{const o=J(e);if(o)return void n(o);const r=Q(e,e=>{r(),clearTimeout(i),n(e)}),i=setTimeout(()=>{r();const o=new Error(`Timeout waiting for command after ${t}ms for:\n${e.toString()}`),i=window.Coframe;(null==i?void 0:i.projectId)&&(null==i?void 0:i.sessionId)&&B({err:o,orgId:i.orgId||"",projectId:i.projectId,sessionId:i.sessionId}),n(void 0)},t)})}const W="global_holdout",X="experiment_holdout";function Y(e,t){return(65535&e)*t+(((e>>>16)*t&65535)<<16)}function G(e,t){return e<<t|e>>>32-t}function K(e,t){const n=(e=e||"").length%4,o=e.length-n;let r=t=t||0,i=0;const s=3432918353,a=461845907;let l=0;for(l=0;l<o;l+=4)i=255&e.charCodeAt(l)|(255&e.charCodeAt(l+1))<<8|(255&e.charCodeAt(l+2))<<16|(255&e.charCodeAt(l+3))<<24,i=Y(i,s),i=G(i,15),i=Y(i,a),r^=i,r=G(r,13),r=Y(r,5)+3864292196;switch(i=0,n){case 3:i^=(255&e.charCodeAt(l+2))<<16;case 2:i^=(255&e.charCodeAt(l+1))<<8;case 1:i^=255&e.charCodeAt(l),i=Y(i,s),i=G(i,15),i=Y(i,a),r^=i}var c;return r^=e.length,c=r,c=Y(c^=c>>>16,2246822507),r=(c=Y(c^=c>>>13,3266489909))^c>>>16,r>>>0}const Z=(e,t,n)=>{const o=K(t,e);return Math.floor(o/4294967295*(n-1))},ee=(e,t,n,o)=>{const r=o,i=Z(n,e,1e5);let s="";e:for(const e in t)for(let n=0;n<t[e].length;n++){const[o,r]=t[e][n];if(i>=o&&i<=r){s=e;break e}}return""===s&&(s=r),s};async function te(e,t,n,o,r,i,a,l){var d,f,m;const p=[],h=[],v="true"===e["x-is-bot"],_=({variantsAndElements:e,experimentsInfo:t,hasActivatedFrames:n=!1})=>({variantsAndElements:e||[],experimentsInfo:(v?[]:t)||[],hasActivatedFrames:n}),g=null!==(d=null==n?void 0:n.split(",").map(e=>e.trim()).filter(Boolean))&&void 0!==d?d:[];if(g.length>0){const e=t.frames.flatMap(e=>e.experiments.flatMap(t=>t.variants.map(t=>({variant:t,elements:e.elements})))).filter(e=>g.includes(e.variant.id)),o=g.some(e=>e===t.holdout_info.holdout_variant_id||"global_holdout"===e);return e.length>0?_({variantsAndElements:e,hasActivatedFrames:!0}):(o||window.alert(`[Coframe] Variant preview unavailable: ${n}.`),_({}))}const w=Number.parseInt(u(c)||"0"),b=t.frames.filter(t=>{if(!t.experiments)return!1;return!!re(t.activation_condition,e,r,i,a,o,w,s,l)});if(0===b.length)return _({});const x=ee(o,t.holdout_info.variant_bins,t.holdout_info.seed,t.holdout_info.holdout_variant_id);if(x===t.holdout_info.holdout_variant_id)return p.push({variant_id:t.holdout_info.holdout_variant_id,experiment_id:t.holdout_info.holdout_experiment_id,iteration_id:"",final_state:!0,level:W}),_({variantsAndElements:h,experimentsInfo:p,hasActivatedFrames:!0});p.push({variant_id:x,experiment_id:t.holdout_info.holdout_experiment_id,iteration_id:"",final_state:!1,level:W});let y=!1;for(const n of b){if((null===(f=n.settings)||void 0===f?void 0:f.bot_cloaking_enabled)&&v)continue;let c=!1;for(const d of n.experiments){if(c)break;const u=d.metadata,f=d.variants,v=n.elements,_=null===(m=u.activation_condition.audience_ids)||void 0===m?void 0:m[0];if(_){if(!re(t.audiences[_].selector,e,r,i,a,o,w,s,l))continue}c=!0,y=!0;const g=u.holdout_info;if(ee(o,g.variant_bins,g.seed,g.holdout_variant_id)===g.holdout_variant_id){p.push({variant_id:g.holdout_variant_id,experiment_id:g.holdout_experiment_id,iteration_id:"",level:X,final_state:!0,holdout_experiment_id:g.holdout_experiment_id});continue}p.push({variant_id:g.treatment_variant_id,experiment_id:g.holdout_experiment_id,iteration_id:"",level:X,final_state:!1,holdout_experiment_id:g.holdout_experiment_id});const b=ee(o,u.allocation,u.seed,""),x=f.find(e=>e.id===b);if(!x){l.error(`Variant not found for experiment ${u.experiment_id}`,"variant_not_found",{experiment_id:u.experiment_id});break}p.push({variant_id:x.id,experiment_id:u.experiment_id,iteration_id:u.iteration_id,level:"experiment",final_state:!0,holdout_experiment_id:g.holdout_experiment_id}),h.push({variant:x,elements:v})}}return _({variantsAndElements:h,experimentsInfo:p,hasActivatedFrames:y})}function ne(e){const t=e.getBoundingClientRect();return t.top>=0&&t.bottom<=window.innerHeight}const oe="n/a";function re(e,t,n,o,r,i,s,a,l){if(e.and){const c=e.and.map(e=>re(e,t,n,o,r,i,s,a,l)),d=c.some(e=>e===oe);if(d){const e=c.some(e=>!1===e);if(d&&e)return!1;if(d&&!e)return oe}return c.every(e=>!0===e)}if(e.or){const c=e.or.map(e=>re(e,t,n,o,r,i,s,a,l));if(c.some(e=>!0===e))return!0;return!!c.some(e=>e===oe)&&oe}if(e.url&&"*"!==e.url&&!se(e.url,n))return!1;if(e.base_url_matches&&!se(e.base_url_matches,n,!0))return!1;if(e.url_regex)try{return new RegExp(e.url_regex).test(n)}catch(t){return l.error("Error parsing URL regex","url_regex_error",{error:t instanceof Error?t.message:String(t),url_regex:e.url_regex,currentUrl:n}),!1}if(e.search&&!function(e,t){const n=new URL(t).search;return e.some(e=>{const t=decodeURIComponent(n).toLowerCase(),o=e.operand.toLowerCase();return"equals"===e.operator?t===o:"contains"===e.operator?t.includes(o):"not_contains"===e.operator&&!t.includes(o)})}(e.search,n))return!1;if(e.language){if(o===oe)return oe;for(const t of e.language)if(o.some(e=>e.includes(t)))return!0;return!1}if(e.time){const t=new Date;if(e.time.before&&t>=e.time.before)return!1;if(e.time.after&&t<=e.time.after)return!1}if(e.platform)return r===oe?oe:function(e,t){const n=Array.isArray(e.platform)?e.platform:[e.platform];return n.some(e=>e&&t.toLowerCase().includes(e.toLowerCase()))}(e,r);if(e.country&&!function(e,t){return!!t&&e.includes(t["x-viewer-country"])}(e.country,t))return!1;if(e.first_time_vs_returning){if(s===oe)return!0;if(2!==e.first_time_vs_returning.length){if(e.first_time_vs_returning.includes("first_time")&&s>1)return!1;if(e.first_time_vs_returning.includes("returning")&&s<=1)return!1}}if(e.device){const n="true"===t["x-is-mobile-viewer"];if(e.device.includes("mobile")&&!n)return!1;if(e.device.includes("desktop")&&n)return!1}if(e.allocation){if(i===oe)return oe;return((e,t,n,o)=>{const r=Z(n,o,t);for(let t=0;t<e.length;t++){const[n,o]=e[t];if(r>=n&&r<=o)return!0}return!1})(e.allocation.allocation_bins,e.allocation.allocation_scale,e.allocation.seed,i)}if(e.js_function){if(void 0===a)return oe;try{const t=a(`(${e.js_function})`,{});return Boolean(t)}catch(t){return l.error("Error evaluating JS function","js_eval_error",{error:t instanceof Error?t.message:String(t),js_function:e.js_function}),!1}}return!0}const ie=(e,t)=>{const n=new URL(e),o=n.hostname.replace(/^www\./,""),r=n.pathname.endsWith("/")?n.pathname.slice(0,-1):n.pathname;return t?`${o}${r}`:`${o}${r}${n.search}${n.hash}`};function se(e,t,n){if(t.includes("localhost")||t.includes("0.0.0.0")){const o=new URL(e),r=new URL(t),i=e=>e.endsWith("/")?e.slice(0,-1):e;return n?i(r.pathname)===i(o.pathname):i(r.pathname)===i(o.pathname)&&r.search===o.search}return ie(e,n)===ie(t,n)}function ae(e,t){let n=null;return function(...o){n&&clearTimeout(n),n=setTimeout(()=>{e.apply(this,o)},t)}}function le(e){if("undefined"!=typeof URLSearchParams){const t=new URLSearchParams(e);return{get:e=>t.get(e)}}const t=function(e){const t={},n=e.startsWith("?")?e.slice(1):e;if(!n)return t;for(const e of n.split("&")){if(!e)continue;const[n,o=""]=e.split("=").map(decodeURIComponent);n in t||(t[n]=o)}return t}(e);return{get:e=>{var n;return null!==(n=t[e])&&void 0!==n?n:null}}}const ce=["submit","button","reset"];const de=(e,t,n)=>{const{innerHTML:o,textContent:r,src:i,styles:s,onClick:a,...l}=t.attributes;if(o?e.innerHTML=o:r&&"string"==typeof r&&(!function(e){if("input"!==e.tagName.toLowerCase())return!1;const t=e.type;return!!t&&ce.includes(t.toLowerCase())}(e)?e.textContent=r:e.value=r),i&&e.setAttribute("src",i),s){const t=(e=>{const t={};if(e)for(const n in e)t[n.replace(/_/g,"-")]=e[n];return t})(s);for(const[n,o]of Object.entries(t)){if(!o)continue;e.style.getPropertyValue(n)!==o&&e.style.setProperty(n,o,"important")}}return l&&Object.keys(l).length>0&&((null==n?void 0:n.warn)?n.warn("Unknown attributes","unknown_attributes",{otherAttributes:l}):console.warn("[Coframe] Unknown attributes",l)),!0},ue=(e,t,n)=>{const o=t.js;try{if(!o)return(null==n?void 0:n.warn)?n.warn("No JavaScript to execute"):console.warn("[Coframe] No JavaScript to execute"),!1;if((e=>e===document.body||e===document||e===document.documentElement)(e)){const e=document.createElement("script");e.id=`coframe-variant-script-${Math.random().toString(36).substring(2,15)}`,e.textContent=`\n        (function() {\n          ${o}\n        })();\n      `,document.head.appendChild(e),document.head.removeChild(e)}else{new Function("el",o)(e)}return!0}catch(t){return(null==n?void 0:n.error)?n.error("Error executing JavaScript:","error_execute_js",{error:t,javascript:o,element:e}):console.error("[Coframe] Error executing JavaScript:",t,o,e),!1}};function fe(e){const t=me(e);return null!==t&&0===t.length?null:t}function me({selector:e,currentUrl:t,isQueryingAll:n=!1}){if(e.url_starts_with)return t.startsWith(e.url_starts_with)?[]:null;if(e.url){const n=new URL(t),o=new URL(e.url);return n.hostname===o.hostname&&n.pathname===o.pathname?[]:null}if(e.universal||e.css){const t=g(e);return t?[t]:null}if(e.navigate_to_url_starts_with){const n=((e,t)=>{const n=[],o=document.querySelectorAll(`a[href^="${t}"]`);n.push(...Array.from(o));const r=new URL(e),i=new URL(t);if(r.hostname===i.hostname){let e=i.pathname.replace(r.pathname,"");if(e){e.startsWith("/")||(e=`/${e}`);const t=document.querySelectorAll(`a[href^="${e}"]`);n.push(...Array.from(t))}}return n})(t,e.navigate_to_url_starts_with);return n.length>0?n:null}return e.and?function(e,t,n){if(0===e.length)return null;const o=[];for(const r of e){const e=me({selector:r,currentUrl:t,isQueryingAll:n});if(null===e)return null;o.push(e)}for(let e=o.length-1;e>=0;e--){const t=o[e];if(t&&t.length>0)return t}return[]}(e.and,t,n):e.or?function(e,t,n){let o=null,r=!1;for(const i of e){const e=me({selector:i,currentUrl:t,isQueryingAll:n});if(null!==e)if(r=!0,n)e.length>0&&(null===o&&(o=[]),o.push(...e));else if(e.length>0)return e}return n&&r?null!==o?o:[]:null}(e.or,t,n):null}let pe=!1;function he(){window.CFQ=window.CFQ||[],window.CFQ.push({emit:"variantRendered"})}const ve=(e,t,n)=>{var o;const{variant:r,elements:i}=e;if(pe=!0,!r.modifications||0===Object.keys(r.modifications).length)return he(),!0;for(const[e,s]of Object.entries(i)){if(!r.modifications[e])continue;let i=null;for(const e of s)if(i=null===(o=fe({selector:e,currentUrl:t}))||void 0===o?void 0:o[0],i)break;if(!i){n.error(`element not found: elementId ${e}`,"element_not_found",{elementId:e,element:s,variant_id:r.id,experiment_id:r.experiment_id});continue}_e(i,r.modifications,e,n)&&i instanceof HTMLElement?i.setAttribute("coframe-exp-id",r.id):n.error("element not edited","element_not_edited",{selectedElement:i,variant_id:null==r?void 0:r.id,element:s})}return!0},_e=(e,t,n,o)=>{if(!t[n])return o.warn("no modifications for element","no_modifications_for_element",{elementId:n,modifications:t}),!1;for(const r of t[n])switch(r.type){case"execute_js":ue(e,r,o);break;case"update":de(e,r,o),he();break;case"delete":ge(e),he();break;default:return o.warn("unknown modification type","unknown_modification_type",{modificationType:r.type,elementId:n}),he(),!1}return!0},ge=e=>{var t;return null===(t=e.parentNode)||void 0===t||t.removeChild(e),!0};let we=null;const be=new Set;function xe(e,n,o){var r;if(!o||0===o.length)return void n.warn("No metrics defined in the project config");we||(we=function(e,t){const n=window.CFQ||[];for(let o=0;o<n.length;o++){const r=n[o];e(r)&&t(r)}return Q(e,t)}(e=>"conversion"===e.emit,o=>{const r=o.payload;if(!r||!r.metricId)return void n.error("Conversion event payload is missing or lacks metricId","conversion_event_payload_error",{payload:r});const i=r.metricId;U(e,{type:"conversion",project_id:e.projectId,session_id:e.sessionId,time:new Date,url:t(),user_token:e.userToken,content:{metric_ids:[i],metadata:r.metadata}},!0)}));const i=document.querySelectorAll("[coframe-metric-ids]");for(const e of i)e.removeAttribute("coframe-metric-ids");for(const e of o)if(e.js_binder){if(be.has(e.js_binder))continue;be.add(e.js_binder);try{s(e.js_binder,{metricId:e.id})}catch(t){n.error(`Failed to execute js_binder for metric ${e.id}`,"js_binder_execution_error",{error:t,metricId:e.id})}}else if(e.selector){const n=null!==(r=fe({selector:e.selector,currentUrl:t(),isQueryingAll:!0}))&&void 0!==r?r:[];for(const t of n){const n=t.getAttribute("coframe-metric-ids");if(n){const o=n.split(",");o.push(e.id),t.setAttribute("coframe-metric-ids",[...new Set(o)].join(","))}else t.setAttribute("coframe-metric-ids",e.id)}}}let ye=null;const Ie=1e4;let $e,Ee=null,ke=null,je=!1,Se=[],Ce=null,Ae="",Te="",Fe=d();const Le=new Set;function De(){const e=(new Date).getTime()-($e?$e.getTime():0);!je&&e>=Ie?(je=!0,P(Me,{projectId:Me.projectId,sessionId:Fe,eventType:"session_start",orgId:Ae,userToken:Te})):setTimeout(De,Ie-e)}function Re(e){return function(){for(const t of e){const e=t.variant;if(!Le.has(e.id)){const t=document.querySelectorAll(`[coframe-exp-id="${e.id}"]`);for(const n of Array.from(t))ne(n)&&(n.setAttribute("coframe-experienced","true"),Le.add(e.id),U(Me,{type:"view",project_id:Me.projectId,session_id:Fe,experiment_id:e.experiment_id,variant_id:e.id,time:new Date,orgId:Ae}))}}}}function Oe(){document.dispatchEvent(new CustomEvent("coframe:show",{}))}async function Ne(e,n){const o=[];try{for(const r of e){ve(r,t(),n)||o.push({message:"Original element not found",metadata:{description:"Original element not found",experiment_id:r.variant.experiment_id,variant_id:r.variant.id,org_id:Ae}})}}catch(e){const t=e instanceof Error?e.stack||e.message:String(e);o.push({metadata:{description:e.toString(),org_id:Ae},message:t})}for(const e of o)n.error(e.message,"failed_replacement",e.metadata)}const Ue=(e,r)=>{!function(e,t,n,o,r,i,s,a,l,c,d,u,f,m,p){O.push({org_id:t,project_id:n,session_id:o,experiments:i,method:"script",sdk_version:"2.1.0",metadata:{local_time:s,languages:c,platform:l,referrer:a,user_token:r,user_agent:d,session_metadata:JSON.stringify({url:u,storage_info:f}),ga_session_id:null==m?void 0:m.ga_session_id,ga_session_number:null==m?void 0:m.ga_session_number,coframe_user_id:p,url:u}}),O.length>=e.batchSize&&M(e.projectId)}(...[Me,Ae,e,Fe,Te,Se,$e,document.referrer,o(),n(),navigator&&navigator.userAgent||"",t(),i()]),P(Me,{projectId:Me.projectId,sessionId:Fe,eventType:"page_view",orgId:Ae,userToken:Te}),setTimeout(()=>De(),Ie)},Me={status:{initialized:!1},projectId:"",orgId:"",variantsAndElements:[],userToken:Te,sessionId:Fe,batchSize:32,treatmentsData:null,logger:{warn:()=>{},error:()=>{}}};function Pe(){document.documentElement.style.setProperty("--cf-show","1")}Me.logger=function(e){let n=0;function o(e,o,r,i,s){var a,l,c,u,f;if(n>=15)return void console.warn("[Coframe] Max log count reached, auto-mute");n++;const m="[Coframe]",p=o(),h=(null!=r?r:"").trim(),{org_id:v="",variant_id:_="",experiment_id:g="",...w}=s,b=Date.now(),x=new Date(b).toISOString(),y={org_id:v,variant_id:_,experiment_id:g,variant_ids:(null!==(a=p.variantsAndElements)&&void 0!==a?a:[]).map(e=>e.variant.id).filter(Boolean),project_id:null!==(l=p.projectId)&&void 0!==l?l:"",event_id:d(),session_id:null!==(c=p.sessionId)&&void 0!==c?c:"",url:t(),monitoring_type:`log_${i}`,local_time:x,metadata:{...w,message:h}};"warn"===e?console.warn(`${m} ${h}`,{...w}):console.error(`${m} ${h}`,{...w}),null===(f=null===(u=p.debug)||void 0===u?void 0:u.logs)||void 0===f||f.push({logger:e,timestamp:b,message:h,type:i,metadata:{...w}}),N(p,y),p.status&&(p.status.events||(p.status.events=[]),p.status.events.push({...y,timestamp:b}))}return{warn:(t,n="coframe_warn",r={})=>o("warn",e,t,n,r),error:(t,n="coframe_error",r={})=>o("error",e,t,n,r)}}(()=>Me);const qe=(e,n)=>{document.addEventListener("visibilitychange",De),setTimeout(De,Ie),document.addEventListener("coframe:dom-renderer:complete",Re(e)),document.addEventListener("scroll",Re(e)),document.dispatchEvent(new CustomEvent("coframe:dom-renderer:complete",{})),document.addEventListener("click",e=>function(e,n,o,{isEngaged:r,projectId:i,sessionId:s,orgId:a,duration:l=0,userToken:c}){var d;const u=performance.now();r||"click"!==n||(r=!0,P(e,{projectId:i,sessionId:s,eventType:"session_start",orgId:a,userToken:c||""}));const f=o.clientX+window.scrollX,m=o.clientY+window.scrollY,p=window.innerWidth,h=window.innerHeight,_=o.composedPath()[0],g=(null==_?void 0:_.closest("[coframe-metric-ids], a, button, input, [onclick], [href]"))||_,w=null===(d=g.getAttribute("coframe-metric-ids"))||void 0===d?void 0:d.split(","),b={type:n,project_id:i,session_id:s,time:new Date,url:t(),user_token:c,content:{universal_selector:v(g,{withDescendants:!1}),metric_ids:w,position:{x:Math.round(f),y:Math.round(m)},screen_size:{width:p,height:h},"duration-ms":Math.round(l)}};U(e,b,Boolean(null==w?void 0:w.length));const x=performance.now()-u;e.status&&(e.status.events||(e.status.events=[]),e.status.events.push({...b,processing_duration_ms:Math.round(x),timestamp:Date.now()}))}(Me,"click",e,{projectId:n,isEngaged:je,sessionId:Fe,orgId:Ae,userToken:Te}),!0);const o=ae(e=>{P(Me,{projectId:Me.projectId,sessionId:Fe,eventType:e,orgId:Ae,userToken:Te}),M(Me.projectId)},1);window.addEventListener("beforeunload",()=>o("before_unload")),window.addEventListener("pagehide",()=>o("page_hide")),window.addEventListener("visibilitychange",()=>{const e=document.hidden;o(e?"tab_hide":"tab_show")})};async function ze(){var e,r,i;const s=Me.logger,f=await V(e=>!!e.config);if(!f)return void s.error("Failed to wait for config cmd","wait_for_cmd_timeout");const h=f.config,v=(null==h?void 0:h.timeoutMs)?Math.min(h.timeoutMs,5e3):5e3;if(h.waitForFeatureFlag){const e=e=>{console.warn(`[Coframe] ${e}`),Oe(),Pe()},t=await V(e=>"object"==typeof e.emit&&null!==e.emit&&"featureFlagSet"in e.emit&&"boolean"==typeof e.emit.featureFlagSet,v);if(!t)return e("Feature flag was not set after timeout, graceful exit");if(!1===t.emit.featureFlagSet)return e("Feature flag is set to false, graceful exit")}Me.batchSize=h.batchSize||32,Ee=(null==h?void 0:h.startTime)?new Date(h.startTime):null,$e=new Date;const _=null==h?void 0:h.projectId;if(V(e=>"variantRendered"===e.emit,v).then(e=>{e||pe&&s.warn("Failed to wait for variant rendered command","missing_variant_rendered")}).finally(()=>{Pe()}),!_)return s.error("No project ID","no_project_id",{description:"No Coframe Page ID"}),void he();Me.projectId=_;const g=function(){const e=t(),n=e.indexOf("?");if(-1===n)return le("");const o=e.indexOf("#",n);return le(-1!==o?e.substring(n,o):e.substring(n))}(),w=g.get("coframe_variant_id"),b=g.get("coframe_should_send_events");L="true"===b,(e=>{j=e})(!!w),(e=>{S=e})(!!h.waitForCookiesEnabled);const x=null===(e=J(e=>!!e.projectData))||void 0===e?void 0:e.projectData;let y=(null==x?void 0:x.segmentationHeaders)||null,I=null==x?void 0:x.project;if(!I)return s.error("No Coframe Project Config","no_project_config",{previewVariantId:w}),void he();const $=!!(null===(r=null==I?void 0:I.settings)||void 0===r?void 0:r.track_only_activated_frames);if(F($),m(!(null==h?void 0:h.waitForCookiesEnabled)),(null==h?void 0:h.waitForCookiesEnabled)&&(he(),V(e=>!("cookiesEnabled"!==e.emit)).then(e=>{e?m(!0):s.warn("Failed to wait for cookies enabled command","wait_for_cmd_timeout")})),Te=(()=>{let e=u(a);return e||(e=d()),e})(),Me.userToken=Te,h.waitForHydration){if(!await V(e=>!("pageHydrated"!==e.emit)))return void s.warn("Failed to wait for page hydrated command","wait_for_cmd_timeout")}I.tags&&(((e,t)=>{for(const n of e)n.js&&ue(document.body,{js:n.js},t)})(I.tags,s),Me.status.tags=I.tags);const{variantsAndElements:E,experimentsInfo:C,hasActivatedFrames:T}=await te(y,I,w,Te,t(),n(),o(),s);let D,R;A(T),Se=C,Ce=I,Ae=I.org_id||"",Me.orgId=Ae,Me.variantsAndElements=E,Me.treatmentsData=null;let O=!1;const U=()=>{if((D||R)&&Me.treatmentsData&&!O){for(const e of Me.treatmentsData)null==D||D(e);null==R||R(Me.treatmentsData),O=!0}},P=()=>{if(k()){const e=[];for(const t of Se)if(t.final_state){const n={impressionId:Fe,userToken:Te,experimentId:t.experiment_id,variantId:t.variant_id,inGlobalHoldout:t.level===W,isBaseline:t.level===X,...t.holdout_experiment_id?{holdoutExperimentId:t.holdout_experiment_id}:{}};e.push(n)}if(w){const t=w.split(",");for(const n of t)e.push({impressionId:Fe,userToken:Te,experimentId:`preview_id_${n}`,holdoutExperimentId:`preview_holdout_id_${n}`,variantId:n,inGlobalHoldout:!1,isBaseline:!1})}Me.treatmentsData=e,U()}};if(!await((e=1e4)=>new Promise((t,n)=>{if(document.body)return void t(document.body);let o;const r=new MutationObserver(()=>{document.body&&(o&&clearTimeout(o),r.disconnect(),t(document.body))});o=setTimeout(()=>{r.disconnect(),n(new Error("Timeout waiting for document.body"))},e),r.observe(document.documentElement||document,{childList:!0,subtree:!0})}))(v).catch(()=>!1))return s.error("Timeout waiting for document.body, exiting gracefully","body_timeout"),void he();xe(Me,s,null==I?void 0:I.metrics);E.length>0?Ne(E,s).then(()=>{Oe()}):(Oe(),he());const q=()=>{((e,t)=>{p(a,e,t)})(Te,s),(e=>{const t=u(c),n=Number.parseInt(u(l),10),o=Date.now();if(!n||o-n>72e5){const n=t?Number.parseInt(t,10)+1:1;p(c,n.toString(),e),p(l,o.toString(),e)}})(s)};if(null==h?void 0:h.waitForCookiesEnabled){V(e=>"cookiesEnabled"===e.emit).then(e=>{e?(m(!0),q(),M(Me.projectId),P()):s.warn("Failed to wait for cookies enabled command","wait_for_cmd_timeout")})}else q();Ue(_),V(e=>!("treatmentApplied"!==e.subscribe)).then(e=>{if(e){if(!e.callback&&!e.bulkCallback)return void s.warn("treatmentApplied callback is not set, skipping","treatment_applied_callback_not_set");D=e.callback,R=e.bulkCallback,U()}}),P(),qe(E,_),function({coframe:e,projectId:n,orgId:o,sessionId:r}){var i;if("undefined"==typeof PerformanceObserver||!(null===(i=PerformanceObserver.supportedEntryTypes)||void 0===i?void 0:i.includes(H)))return;let s,a=!1;const l=new PerformanceObserver(e=>{const t=e.getEntries();t.length>0&&(s=t[t.length-1])});try{l.observe({type:H,buffered:!0})}catch(e){return void console.warn("[Coframe] Failed to observe LCP:",e)}document.addEventListener("visibilitychange",()=>{var i,c,u,f;if("hidden"===document.visibilityState&&!a){const m=l.takeRecords();if(m.length>0&&(s=m[m.length-1]),s)try{const l=s;N(e,{event_id:d(),monitoring_type:"web_performance_lcp",local_time:(new Date).toISOString(),project_id:n,session_id:r,url:t(),org_id:o,metadata:{lcp:l.startTime,size:null!==(i=l.size)&&void 0!==i?i:0,element:null!==(u=null===(c=l.element)||void 0===c?void 0:c.tagName)&&void 0!==u?u:"",url:null!==(f=l.url)&&void 0!==f?f:""}}),a=!0}catch(e){console.warn("[Coframe] Error reporting LCP:",e)}l.disconnect()}})}({coframe:Me,projectId:_,orgId:Ae,sessionId:Fe});const z=new Date,B=Ee?z.getTime()-Ee.getTime():0,Q=z.getTime()-$e.getTime();Me.status={initialized:!0,elapsedFromInstallation:B,elapsedFromExecution:Q,trackOnlyActivatedFrames:$},N(Me,{event_id:d(),monitoring_type:"init",local_time:(new Date).toISOString(),project_id:_,session_id:Fe,url:t(),org_id:Ae,metadata:{elapsedFromInstallation:B,elapsedFromExecution:Q}});let Y=0;if(null===(i=null==Ce?void 0:Ce.settings)||void 0===i?void 0:i.mutation_observer_active){const e=ae(()=>{xe(Me,s,null==Ce?void 0:Ce.metrics)},100),r=new MutationObserver(t=>{if(Y++,Y>=5e3)return s.error("Mutation callback infinite loop protection triggered, disconnecting mutation observer","mutation_observer_loop_protection",t),void r.disconnect();for(const n of t)"childList"===n.type&&e()});r.observe(document.body,{childList:!0,subtree:!0}),function(e,n){const o=()=>{const o=t(),r=ye;r&&!se(o,r,e)&&(ye=o,n(o,r))};ye=t(),o(),window.addEventListener("popstate",o),window.addEventListener("hashchange",o);const r=e=>{const t=history[e];history[e]=function(...e){const n=t.apply(this,e);return setTimeout(o,0),n}};r("pushState"),r("replaceState")}(!0,async(e,t)=>{await new Promise(e=>requestAnimationFrame(e)),Y=0,Fe=d(),Me.sessionId=Fe;const{variantsAndElements:r,experimentsInfo:i,hasActivatedFrames:a}=await te(y,Ce,w,Te,e,n(),o(),s);Se=i,Me.variantsAndElements=r,A(a),Ne(r,s),Ue(_),O=!1,P()})}M(Me.projectId),null!==ke&&clearInterval(ke),ke=setInterval(()=>M(Me.projectId),3e3)}return Me.debug={getSelector:v,getElement:g,getElementUniversal:w,waitForCmd:V,flushQueuedEvents:()=>{M(Me.projectId)},queuedEvents:D,shouldSendEvents:k,querySelector:fe,logs:[]},window.Coframe=Me,Me.init=ze,Me.init().catch(e=>{var t,n,o;console.error("[Coframe] Error initializing SDK",e),null===(n=null===(t=Me.debug)||void 0===t?void 0:t.logs)||void 0===n||n.push({logger:"error",timestamp:(new Date).getTime(),message:"Error initializing SDK",metadata:{error:e instanceof Error?e.message:String(e)}}),B({err:e,projectId:null!==(o=Me.projectId)&&void 0!==o?o:"",orgId:null!=Ae?Ae:"",sessionId:null!=Fe?Fe:""})}),e.init=ze,e}({});

      