;!function(){try { var e="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof global?global:"undefined"!=typeof window?window:"undefined"!=typeof self?self:{},n=(new e.Error).stack;n&&((e._debugIds|| (e._debugIds={}))[n]="ec021086-3bf4-a8f1-b257-cb6bf7fd6930")}catch(e){}}();
(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,701085,e=>{"use strict";var t,n,r,i=e.i(297083),o=e.i(817556),a=e.i(960933),s=e.i(862927),l=e.i(282453),u=e.i(858248),c=e.i(709485),d="reachability",f="reachability_targets",p=((t=p||{})[t.Unknown=-1]="Unknown",t[t.Reachable=1]="Reachable",t[t.Unreachable=0]="Unreachable",t),v=((n=v||{}).ReplitDotCom="https://replit.com/data/__reachability",n.ReplitDotApp="https://reachability.replit.app/",n.ReplitDevJaneway="https://dotdevproxy.janeway.replit.dev/__reachability",n.ReplitDevKirk="https://dotdevproxy.kirk.replit.dev/__reachability",n.ReplitDevPicard="https://dotdevproxy.picard.replit.dev/__reachability",n.ReplitDevPike="https://dotdevproxy.pike.replit.dev/__reachability",n.ReplitDevRiker="https://dotdevproxy.riker.replit.dev/__reachability",n.ReplitDevSisko="https://dotdevproxy.sisko.replit.dev/__reachability",n.ReplitDevSpock="https://dotdevproxy.spock.replit.dev/__reachability",n.ReplitDevWesley="https://dotdevproxy.wesley.replit.dev/__reachability",n.ReplitDevWorf="https://dotdevproxy.worf.replit.dev/__reachability",n.ReplCoJaneway="https://dotdevproxy.janeway.repl.co/__reachability",n.ReplCoKirk="https://dotdevproxy.kirk.repl.co/__reachability",n.ReplCoPicard="https://dotdevproxy.picard.repl.co/__reachability",n.ReplCoPike="https://dotdevproxy.pike.repl.co/__reachability",n.ReplCoRiker="https://dotdevproxy.riker.repl.co/__reachability",n.ReplCoSisko="https://dotdevproxy.sisko.repl.co/__reachability",n.ReplCoSpock="https://dotdevproxy.spock.repl.co/__reachability",n.ReplCoWesley="https://dotdevproxy.wesley.repl.co/__reachability",n.ReplCoWorf="https://dotdevproxy.worf.repl.co/__reachability",n),x=((r=x||{})["replit.com"]="https://replit.com/data/__reachability",r["replit.app"]="https://reachability.replit.app/",r["janeway.replit.dev"]="https://dotdevproxy.janeway.replit.dev/__reachability",r["kirk.replit.dev"]="https://dotdevproxy.kirk.replit.dev/__reachability",r["picard.replit.dev"]="https://dotdevproxy.picard.replit.dev/__reachability",r["pike.replit.dev"]="https://dotdevproxy.pike.replit.dev/__reachability",r["riker.replit.dev"]="https://dotdevproxy.riker.replit.dev/__reachability",r["sisko.replit.dev"]="https://dotdevproxy.sisko.replit.dev/__reachability",r["spock.replit.dev"]="https://dotdevproxy.spock.replit.dev/__reachability",r["wesley.replit.dev"]="https://dotdevproxy.wesley.replit.dev/__reachability",r["worf.replit.dev"]="https://dotdevproxy.worf.replit.dev/__reachability",r["janeway.repl.co"]="https://dotdevproxy.janeway.repl.co/__reachability",r["kirk.repl.co"]="https://dotdevproxy.kirk.repl.co/__reachability",r["picard.repl.co"]="https://dotdevproxy.picard.repl.co/__reachability",r["pike.repl.co"]="https://dotdevproxy.pike.repl.co/__reachability",r["riker.repl.co"]="https://dotdevproxy.riker.repl.co/__reachability",r["sisko.repl.co"]="https://dotdevproxy.sisko.repl.co/__reachability",r["spock.repl.co"]="https://dotdevproxy.spock.repl.co/__reachability",r["wesley.repl.co"]="https://dotdevproxy.wesley.repl.co/__reachability",r["worf.repl.co"]="https://dotdevproxy.worf.repl.co/__reachability",r),h=a.Type.Record(a.Type.Enum(v),a.Type.Enum(p,{default:-1}));function y(){return(0,i._)(function(){var e,t,n,r,a,p,x,y,_,m;return(0,o._)(this,function(g){switch(g.label){case 0:if(!l.default.available()||"https://replit.com"!==window.location.origin)return[2];return[4,new Promise(function(e){return setTimeout(e,3e4)})];case 1:if(g.sent(),e=l.default.get(f,"object"),t=l.default.get(d,"number"),e&&t&&new Date().getTime()-t<864e5)return[2];return[4,(0,i._)(function(){return(0,o._)(this,function(e){switch(e.label){case 0:if(window.navigator.onLine)return[2];return[4,new Promise(function(e){window.addEventListener("online",function(){e(void 0)},{once:!0})})];case 1:return e.sent(),[2]}})})()];case 2:g.sent(),n=s.Value.Create(h),r=!0,a=!1,p=void 0,g.label=3;case 3:g.trys.push([3,8,9,10]),x=Object.values(v)[Symbol.iterator](),g.label=4;case 4:if(r=(y=x.next()).done)return[3,7];return[4,function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return(0,i._)(function(){var r,a,s,l,d;return(0,o._)(this,function(f){switch(f.label){case 0:r=function(r){return(0,i._)(function(){return(0,o._)(this,function(i){switch(i.label){case 0:if(!(n<3))return[3,2];return[4,new Promise(function(e){return setTimeout(e,n*Math.random()*3e4)})];case 1:return i.sent(),[2,e(t,n+1)];case 2:return(0,u.track)(c.events.REACHABILITY_CHECKED,{success:!1,destination:t,error:r}),[2,0]}})})()},f.label=1;case 1:return f.trys.push([1,3,,4]),[4,fetch(t,{credentials:"omit",redirect:"error",referrerPolicy:"no-referrer",cache:"no-store"})];case 2:return a=f.sent(),[3,4];case 3:return s=f.sent(),[2,r(s.message)];case 4:if(200!==a.status)return[2,r("unexpected status: ".concat(a.status))];f.label=5;case 5:return f.trys.push([5,7,,8]),[4,a.text()];case 6:return l=f.sent(),[3,8];case 7:return d=f.sent(),[2,r("failed to read body: ".concat(d.message))];case 8:if("reachable"!==l.trim())return[2,r("unexpected body: ".concat(l))];return(0,u.track)(c.events.REACHABILITY_CHECKED,{success:!0,destination:t}),[2,1]}})})()}(_=y.value)];case 5:n[_]=g.sent(),g.label=6;case 6:return r=!0,[3,4];case 7:return[3,10];case 8:return m=g.sent(),a=!0,p=m,[3,10];case 9:try{r||null==x.return||x.return()}finally{if(a)throw p}return[7];case 10:return l.default.set(f,n),l.default.set(d,new Date().getTime()),[2]}})})()}function _(){if(!l.default.available())return s.Value.Create(h);var e=l.default.get(f,"object");return s.Value.Cast(h,e)}function m(e){var t=-1;if(e){var n,r=e?new URL(e).hostname:void 0,i=r&&(null==r?void 0:r.split(".").length)>=3?(n=r.split(".")).length>=6&&"teams"===n[n.length-3]?"".concat(n[n.length-5],".").concat(n.slice(-2).join(".")):n.slice(-3).join("."):r,o=i?x[i]:void 0;t=o?_()[o]:-1}else t=_()["https://dotdevproxy.kirk.replit.dev/__reachability"];return 1===t||-1===t}e.s(["default",()=>y,"isDotDevReachable",()=>m])},761732,e=>{"use strict";var t=e.i(530658),n=e.i(389959);e.s(["default",0,function(e){var r=(0,t._)((0,n.useState)(function(){return e?e.current:null}),2),i=r[0],o=r[1];return(0,n.useEffect)(function(){if(o(function(){return e?e.current:null}),e)return e.subscribe(function(e){return o(function(){return e})})},[e]),i}])},716636,66718,827456,e=>{"use strict";var t,n=((t={}).CloudServices="Cloud Services",t.Collaboration="Collaboration",t.WorkspaceFeatures="Workspace Features",t.WorkspaceExtensions="Workspace Extensions",t.Other="Other",t);e.s(["PaneCategory",()=>n],716636);var r=e.i(721281),i=e.i(188507),o=e.i(205104),a=e.i(903381);function s(e){var t=e.path;return t?(0,o.isBinary)(t)?"binary":(0,o.isMedia)(t)?"media":(0,o.isDrawFile)(t)?"draw":"codeEditor":"codeEditor"}function l(e){return"codeEditor"===e||"binary"===e||"media"===e||"draw"===e||"history"===e}function u(e){var t=[],n=!0,r=!1,i=void 0;try{for(var o,l=e[Symbol.iterator]();!(n=(o=l.next()).done);n=!0){var u=o.value;u.type===a.FileType.File&&t.push({type:s({path:u.path}),data:{path:u.path}})}}catch(e){r=!0,i=e}finally{try{n||null==l.return||l.return()}finally{if(r)throw i}}return t}function c(e){return l(e.type)}function d(e){return c(e)?e.data.path:null}function f(e){return!c(e)&&"markdown"!==e.type}function p(e){return"extension"===e.type}var v=new Set(["extensionStore","vnc","automations","runnerOutput","git","envEditor","tutorial","database","neon","replAuth","preferences","deployments","ghostwriterChat","extensionDevtools","objectStorage","workflows","project","config","agentProgress","agentChat","replitAuth","securityScan","developer"]);function x(e){return v.has(e)}var h=(0,r._)({},i.StackBlueprint.STACK_BLUEPRINT_AGENT,"automations");e.s(["STACK_TO_OUTPUT_PANE_MAP",()=>h,"fsNodeToPanes",()=>u,"getFilePathForPane",()=>d,"getPaneTypeForFile",()=>s,"isExtensionPane",()=>p,"isFilePane",()=>c,"isFilePaneType",()=>l,"isSingleton",()=>x,"isToolPane",()=>f],66718);var y=e.i(878420),_=e.i(276385),m=e.i(389959),g={type:"commands",data:{autoFocus:!1}};function b(e){var t=e.config,n=e.filePaneFlag,r=void 0!==n&&n;function i(e){return r&&c(e)?"codeEditor"===e.type||"history"===e.type?{type:"file",data:(0,y._)({type:"codeEditor"},e.data)}:{type:"file",data:(0,y._)({type:e.type},e.data)}:e}return{Icon:function(e){var n=e.pane,r=e.size,o=e.color,a=i(n),s=t[a.type]?a:g,l=t[s.type].Icon;return(0,_.jsx)(l,{pane:s,size:void 0===r?16:r,color:o})},Content:function(e){var n=e.pane,r=e.options,o=i(n),a=t[o.type]?o:g,s=t[a.type].Content;return(0,_.jsx)(s,{pane:a,options:r})},getTitle:function(e){var n=i(e),r=t[n.type]?n:g;return t[r.type].getTitle(r)},getTitlePill:function(e){var n,r=i(e),o=t[r.type]?r:g,a=t[o.type];return null==(n=a.getTitlePill)?void 0:n.call(a,o)},getDescription:function(e,n){var r=i(e),o=t[r.type]?r:g,a=t[o.type].description;return(null==n?void 0:n.short)&&a?a.split(/[a-zA-Z0-9]\. /)[0].trim():a},getCategory:function(e){var n=i(e),r=t[n.type]?n:g;return t[r.type].category},decode:function(e,n){var r,i=null;try{i=null==(r=t[e])?void 0:r.decode(n)}catch(e){}return i}}}var E=(0,m.createContext)(null);function I(){var e=(0,m.useContext)(E);if(!e)throw Error("Expected PaneUI in context");return e}var w=E.Provider;e.s(["PaneUIContextProvider",()=>w,"createPaneUI",()=>b,"usePaneUIContext",()=>I],827456)},545880,(e,t,n)=>{var r=e.r(279732),i=e.r(937657),o=e.r(595146),a=e.r(763377),s=e.r(713331);t.exports=function(e,t,n,l){if(!a(e))return e;t=i(t,e);for(var u=-1,c=t.length,d=c-1,f=e;null!=f&&++u<c;){var p=s(t[u]),v=n;if("__proto__"===p||"constructor"===p||"prototype"===p)break;if(u!=d){var x=f[p];void 0===(v=l?l(x,p,f):void 0)&&(v=a(x)?x:o(t[u+1])?[]:{})}r(f,p,v),f=f[p]}return e}},643607,(e,t,n)=>{var r=e.r(493103),i=e.r(545880),o=e.r(937657);t.exports=function(e,t,n){for(var a=-1,s=t.length,l={};++a<s;){var u=t[a],c=r(e,u);n(c,u)&&i(l,o(u,e),c)}return l}},739721,(e,t,n)=>{var r=e.r(643607),i=e.r(718645);t.exports=function(e,t){return r(e,t,function(t,n){return i(e,n)})}},294061,(e,t,n)=>{var r=e.r(848616),i=e.r(253536),o=e.r(724975);t.exports=function(e){return o(i(e,void 0,r),e+"")}},810547,(e,t,n)=>{var r=e.r(739721);t.exports=e.r(294061)(function(e,t){return null==e?{}:r(e,t)})},8808,e=>{"use strict";e.i(963146);var t=e.i(530448);e.s(["ConnectionState",()=>t.ConnectionState])},475032,873379,e=>{"use strict";var t=e.i(530658),n=e.i(389959),r=e.i(993796),i=e.i(701085);e.i(792e3);var o=e.i(8808);function a(e){var r=(0,t._)((0,n.useState)(e.getConnectionState()),2),i=r[0],o=r[1];return(0,n.useEffect)(function(){return e.onConnectionStateChanged(o)},[e]),i}function s(e){var s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{fallbackToReplCo:!0},l=a(e),u=(0,t._)((0,n.useState)(null),2),c=u[0],d=u[1],f=(0,t._)((0,n.useState)(!0),2),p=f[0],v=f[1],x=(0,t._)((0,n.useState)(!0),2),h=x[0],y=x[1],_=(0,r.useFlag)({controlName:"flag-webview-fallback-url"});return(0,n.useEffect)(function(){if(e.getConnectionState()===o.ConnectionState.CONNECTED){var t=e.getDotdevUrl();if(t){var n=(0,i.isDotDevReachable)(t),r=(0,i.isDotDevReachable)(null==t?void 0:t.replace(/.replit.dev$/,".repl.co"));if(v(n),y(r),!_||!s.fallbackToReplCo||n)return void d(t);d(t.replace(/.replit.dev$/,".repl.co"))}}},[e,l,_,s]),{url:c,reachability:{dotdev:p,replCo:h}}}e.s(["default",()=>a],873379),e.s(["default",()=>s],475032)},574831,e=>{"use strict";var t=(0,e.i(389959).createContext)(null);e.s(["default",0,t])},529810,e=>{"use strict";var t=e.i(389959),n=e.i(574831);function r(){var e=(0,t.useContext)(n.default);if(!e)throw Error("Expected services in context");return e}e.s(["default",()=>r])},619593,(e,t,n)=>{var r,i=e.r(365738),o="__lodash_hash_undefined__",a=1/0,s=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,l=/^\w*$/,u=/^\./,c=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,d=/\\(\\)?/g,f=/^\[object .+?Constructor\]$/,p="object"==i._(e.g)&&e.g&&e.g.Object===Object&&e.g,v=("undefined"==typeof self?"undefined":i._(self))=="object"&&self&&self.Object===Object&&self,x=p||v||Function("return this")(),h=Array.prototype,y=Function.prototype,_=Object.prototype,m=x["__core-js_shared__"],g=(r=/[^.]+$/.exec(m&&m.keys&&m.keys.IE_PROTO||""))?"Symbol(src)_1."+r:"",b=y.toString,E=_.hasOwnProperty,I=_.toString,w=RegExp("^"+b.call(E).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),A=x.Symbol,C=h.splice,S=M(x,"Map"),k=M(Object,"create"),L=A?A.prototype:void 0,R=L?L.toString:void 0;function P(e){var t=-1,n=e?e.length:0;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function T(e){var t=-1,n=e?e.length:0;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function U(e){var t=-1,n=e?e.length:0;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function j(e,t){for(var n,r,i=e.length;i--;){if(n=e[i][0],n===(r=t)||n!=n&&r!=r)return i}return -1}function D(e,t){var n,r,o=e.__data__;return("string"==(r=void 0===(n=t)?"undefined":i._(n))||"number"==r||"symbol"==r||"boolean"==r?"__proto__"!==n:null===n)?o["string"==typeof t?"string":"hash"]:o.map}function M(e,t){var n,r,i,o=null==e?void 0:e[t];return!(!V(o)||(n=o,g&&g in n))&&("[object Function]"==(i=V(r=o)?I.call(r):"")||"[object GeneratorFunction]"==i||function(e){var t=!1;if(null!=e&&"function"!=typeof e.toString)try{t=!!(e+"")}catch(e){}return t}(o)?w:f).test(function(e){if(null!=e){try{return b.call(e)}catch(e){}try{return e+""}catch(e){}}return""}(o))?o:void 0}P.prototype.clear=function(){this.__data__=k?k(null):{}},P.prototype.delete=function(e){return this.has(e)&&delete this.__data__[e]},P.prototype.get=function(e){var t=this.__data__;if(k){var n=t[e];return n===o?void 0:n}return E.call(t,e)?t[e]:void 0},P.prototype.has=function(e){var t=this.__data__;return k?void 0!==t[e]:E.call(t,e)},P.prototype.set=function(e,t){return this.__data__[e]=k&&void 0===t?o:t,this},T.prototype.clear=function(){this.__data__=[]},T.prototype.delete=function(e){var t=this.__data__,n=j(t,e);return!(n<0)&&(n==t.length-1?t.pop():C.call(t,n,1),!0)},T.prototype.get=function(e){var t=this.__data__,n=j(t,e);return n<0?void 0:t[n][1]},T.prototype.has=function(e){return j(this.__data__,e)>-1},T.prototype.set=function(e,t){var n=this.__data__,r=j(n,e);return r<0?n.push([e,t]):n[r][1]=t,this},U.prototype.clear=function(){this.__data__={hash:new P,map:new(S||T),string:new P}},U.prototype.delete=function(e){return D(this,e).delete(e)},U.prototype.get=function(e){return D(this,e).get(e)},U.prototype.has=function(e){return D(this,e).has(e)},U.prototype.set=function(e,t){return D(this,e).set(e,t),this};var F=O(function(e){e=null==(t=e)?"":function(e){if("string"==typeof e)return e;if(B(e))return R?R.call(e):"";var t=e+"";return"0"==t&&1/e==-a?"-0":t}(t);var t,n=[];return u.test(e)&&n.push(""),e.replace(c,function(e,t,r,i){n.push(r?i.replace(d,"$1"):t||e)}),n});function O(e,t){if("function"!=typeof e||t&&"function"!=typeof t)throw TypeError("Expected a function");var n=function(){var r=arguments,i=t?t.apply(this,r):r[0],o=n.cache;if(o.has(i))return o.get(i);var a=e.apply(this,r);return n.cache=o.set(i,a),a};return n.cache=new(O.Cache||U),n}O.Cache=U;var N=Array.isArray;function V(e){var t=void 0===e?"undefined":i._(e);return!!e&&("object"==t||"function"==t)}function B(e){return(void 0===e?"undefined":i._(e))=="symbol"||!!e&&(void 0===e?"undefined":i._(e))=="object"&&"[object Symbol]"==I.call(e)}t.exports=function(e,t,n){var r=null==e?void 0:function(e,t){var n;t=!function(e,t){if(N(e))return!1;var n=void 0===e?"undefined":i._(e);return!!("number"==n||"symbol"==n||"boolean"==n||null==e||B(e))||l.test(e)||!s.test(e)||null!=t&&e in Object(t)}(t,e)?N(n=t)?n:F(n):[t];for(var r=0,o=t.length;null!=e&&r<o;)e=e[function(e){if("string"==typeof e||B(e))return e;var t=e+"";return"0"==t&&1/e==-a?"-0":t}(t[r++])];return r&&r==o?e:void 0}(e,t);return void 0===r?n:r}},412284,e=>{"use strict";var t=e.i(530658),n=e.i(276385),r=e.i(389959),i=e.i(541793),o=e.i(161322),a=(0,r.createContext)(null);function s(){return function(){var e=(0,r.useContext)(a);if(!e)throw Error("Expected extensions context");return e}().store}var l=function(e){var t=s();return(0,o.useAtom)(e,{store:t})};function u(e){var t=s();return(0,o.useAtomValue)(e,{store:t})}var c=function(e){var t=s();return(0,o.useSetAtom)(e,{store:t})};function d(e){var o=e.children,s=(0,t._)((0,r.useState)(function(){return(0,i.createStore)()}),1)[0];return(0,n.jsx)(a.Provider,{value:{store:s},children:o})}e.s(["ExtensionStoreProvider",()=>d,"useExtAtom",()=>l,"useExtAtomValue",()=>u,"useExtensionsStore",()=>s,"useSetExtAtom",()=>c])},486289,(e,t,n)=>{var r=e.r(493103),i=e.r(290308);t.exports=function(e,t){return t.length<2?e:r(e,i(t,0,-1))}},440022,(e,t,n)=>{var r=e.r(937657),i=e.r(776327),o=e.r(486289),a=e.r(713331);t.exports=function(e,t){return t=r(t,e),null==(e=o(e,t))||delete e[a(i(t))]}},822216,(e,t,n)=>{var r=e.r(100515);t.exports=function(e){return r(e)?void 0:e}},223664,(e,t,n)=>{var r=e.r(70234),i=e.r(838915),o=e.r(440022),a=e.r(937657),s=e.r(436849),l=e.r(822216),u=e.r(294061),c=e.r(977042);t.exports=u(function(e,t){var n={};if(null==e)return n;var u=!1;t=r(t,function(t){return t=a(t,e),u||(u=t.length>1),t}),s(e,c(e),n),u&&(n=i(n,7,l));for(var d=t.length;d--;)o(n,t[d]);return n})},282890,410793,667279,196380,244719,466497,e=>{"use strict";e.i(716636);var t,n=e.i(66718),r=e.i(827456),i=e.i(297083),o=e.i(167626),a=e.i(878420),s=e.i(64386),l=e.i(530658),u=e.i(817556),c=e.i(389959),d=e.i(541793),f=e.i(810547),p=e.i(15053),v=e.i(9293),x=e.i(316953),h=e.i(253344),y=e.i(837399),_=e.i(858248),m=e.i(709485),g=e.i(475032),b=e.i(529810),E=e.i(567807),I=e.i(346715),w=e.i(131141),A=e.i(619593),C=e.i(125674),S=e.i(412284),k=e.i(721281),L=e.i(223664),R=e.i(664152),P=((t={}).debug="debug",t.info="info",t.warn="warn",t.error="error",t);function T(e,t){var n=function(n){var r,i,o,s,l=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{logLevel:"debug"},u=null!=(r=(i={},(0,k._)(i,"debug",R.logger.debug),(0,k._)(i,"warn",R.logger.warn),(0,k._)(i,"info",R.logger.info),(0,k._)(i,"error",R.logger.error),i)[l.logLevel])?r:R.logger.debug;(null!=(o=(s={},(0,k._)(s,"debug",console.debug),(0,k._)(s,"warn",console.warn),(0,k._)(s,"info",console.info),(0,k._)(s,"error",console.error),s)[l.logLevel])?o:console.debug)(n,l),u(n,(0,L.default)((0,a._)({},l,e),["replId","logLevel"])),t.onLog((0,a._)({message:n},l,e))};return{context:e,info:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return n(e,(0,s._)((0,a._)({},t),{logLevel:"info"}))},warn:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return n(e,(0,s._)((0,a._)({},t),{logLevel:"warn"}))},error:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return n(e,(0,s._)((0,a._)({},t),{logLevel:"error"}))},createLogger:function(n){return T((0,a._)({},e,n),t)}}}e.s(["LogLevel",()=>P,"createExtensionLogger",()=>T],410793);var U=(0,d.atom)(!1),j=(0,d.atom)([]),D=(0,d.atom)([]),M=(0,d.atom)(null),F=(0,d.atom)(T({extension:!0,isInitialized:!1},{onLog:function(){throw Error("Logged before extension system was initialized.")}})),O=(0,d.atom)([]),N=(0,d.atom)(null,function(e,t,n){var r=e(O);t(O,(0,w.produce)(r,function(e){e.push((0,w.produce)(n,function(t){t.index=e.length})),e.length>1e3&&e.splice(0,e.length-1e3)}))}),V=(0,d.atom)(null,function(e,t){t(O,[])}),B=(0,d.atom)("local:true"),$=(0,d.atom)(function(e){var t=e(O),n=e(B);if(!n)return t;var r=n.split(" ").map(function(e){var t=(0,l._)(e.split(":"),2),n=t[0],r=t[1];return n&&void 0===r?function(e){return e.message.toLowerCase().includes(n.toLowerCase())}:n&&""===r?function(e){return void 0!==(0,A.default)(e,n)}:n&&r?function(e){try{return String((0,A.default)(e,n))===r}catch(e){return!1}}:null}).filter(function(e){return null!==e});return t.filter(function(e){return r.every(function(t){return t(e)})})}),z=(0,d.atom)(null,function(e,t,n){return(0,i._)(function(){return(0,u._)(this,function(r){if(e(j).find(function(e){return e.extensionId===n.extensionId}))throw Error("Extension already loaded");return t(j,function(e){return(0,w.produce)(e,function(e){var t,r,i,o,a,s,l,u,c=(r=n.baseUrl,i=n.extensionId,o=n.installationId,a=n.manifest,s=n.enableExperimentalApi,l=n.enableInternalApi,u=n.logger,{baseUrl:r,extensionId:i,installationId:o,manifest:a,isLocal:n.isLocal,stateAtom:(0,d.atom)({error:null,panes:[],scopes:new Set(null==(t=a.scopes)?void 0:t.map(function(e){return e.name})),enableExperimentalApi:s,enableInternalApi:l,commands:new Map}),logger:u});e.push(c)})}),[2]})})()}),K=(0,d.atom)(null,function(e,t,n){return(0,i._)(function(){return(0,u._)(this,function(r){if(e(D).find(function(e){return e.extensionId===n.extensionId||e.installationId===n.installationId||e.baseUrl===n.baseUrl}))throw Error("Extension already loaded");return t(D,function(e){return(0,w.produce)(e,function(e){e.push(n)})}),[2]})})()}),W=(0,d.atom)(null,function(e,t,n){var r=e(D).find(function(e){return e.baseUrl===n});if(r)return r;var i={baseUrl:n,extensionId:(0,h.asExtensionId)((0,p.v4)()),installationId:(0,h.asInstallationId)((0,p.v4)())};return t(D,function(e){return(0,w.produce)(e,function(e){e.push(i)})}),i}),H=(0,d.atom)(null,function(e,t,n){return(0,i._)(function(){return(0,u._)(this,function(e){return t(j,function(e){return(0,w.produce)(e,function(e){var t=e.findIndex(function(e){return"extensionId"in n?e.extensionId===n.extensionId:e.installationId===n.installationId});-1!==t&&e.splice(t,1)})}),[2]})})()}),G=(0,d.atom)(null,function(e,t,n){var r=e(j).find(function(e){return e.extensionId===n.extensionId});if(!r)throw Error("Extension not found");t(r.stateAtom,function(e){return(0,w.produce)(e,function(e){e.error=n.extensionError})})}),J=(0,d.atom)(null,function(e,t,n){var r=n.createCommand.id;if(!n.createCommand.id)throw Error("Expected createCommand to have id");if(!n.createCommand.contributions)throw Error("Expected createCommand to have contributions");t(n.extensionStateAtom,function(e){return(0,w.produce)(e,function(e){e.commands.set(r,n.createCommand)})})}),X=(0,d.atom)(function(e){return e(j).flatMap(function(t){return(0,I._)(e(t.stateAtom).commands.values())})}),Y=(0,d.atom)(function(e){return e(j).map(function(e){var t;return null==(t=e.manifest.fileHandlers)?void 0:t.map(function(t){return(0,s._)((0,a._)({},t),{extension:e})})}).flat().filter(function(e){return!!e})}),Q=(0,d.atom)(function(e){return e(j).map(function(e){var t;return null==(t=e.manifest.tools)?void 0:t.map(function(t){return(0,s._)((0,a._)({},t),{extension:e})})}).flat().filter(function(e){return!!e})});function Z(){return(0,S.useExtAtomValue)(j)}function q(e){return Z().find(function(t){return t.installationId===e})}function ee(e){var t=q(e);return t&&e?t.stateAtom:null}function et(){return(0,S.useExtAtomValue)(Y)}function en(){return(0,S.useExtAtomValue)(Q)}function er(e){var t=(0,S.useExtAtomValue)(X);return(0,C.default)(function(){return t.filter(function(t){return t.contributions.includes(e)})},[t,e])}function ei(){return(0,S.useExtAtomValue)(D)}function eo(){var e=(0,S.useSetExtAtom)(H);return(0,c.useCallback)(function(t){return(0,i._)(function(){return(0,u._)(this,function(n){return e({installationId:t}),[2]})})()},[e])}function ea(){var e=eh(),t=e.throwSystemError,n=e.throwExtensionError,r=(0,S.useSetExtAtom)(z),l=(0,S.useExtAtomValue)(F),d=(0,S.useExtensionsStore)();return(0,c.useCallback)(function(e){var c=e.installationId,p=e.forceRefetch,_=void 0===p||p;return(0,i._)(function(){var e,i,p,m,g,b,I,w,A,C,S,k,L,R,P,T,U;return(0,u._)(this,function(u){switch(u.label){case 0:return[4,(0,E.getExtensionUserContext)()];case 1:if(!(e=u.sent())||e.error)return t({friendlyMessage:"Failed to load user context",error:e.error}),[2];if(i=e.result.userHasInternalApiEnabled,!(p=d.get(D).find(function(e){return e.installationId===c})))return[3,3];return[4,(0,E.getExtensionManifest)(p.baseUrl)];case 2:if(m=u.sent(),g=l.createLogger({extensionId:p.extensionId,installationId:p.installationId,local:!0}),m.error)return b=(0,s._)((0,a._)({},p),{manifest:(0,x.createDefaultManifest)(),enableExperimentalApi:!1,enableInternalApi:!1,logger:g.createLogger({extensionName:"Unnamed Extension"}),isLocal:!0}),l.info("Adding extension: ".concat(b.manifest.name),{extensionArgs:(0,f.default)(b,["extensionId","installationId","baseUrl","manifest","enableExperimentalApi","enableInternalApi","isLocal"]),local:b.isLocal,error:!0}),r(b),I="Failed to load extension manifest",(0,o._)(m.error,y.TypeboxError)&&(I=m.error.message),n({extensionId:p.extensionId,installationId:p.installationId,extensionError:{error:m.error,friendlyMessage:I}}),[2];return w=(0,x.hasScope)(m.result,"experimental-api"),A=(0,s._)((0,a._)({},p),{manifest:m.result,enableExperimentalApi:w,enableInternalApi:i,logger:g.createLogger({extensionName:m.result.name}),isLocal:!0}),l.info("Adding extension: ".concat(A.manifest.name),{extensionArgs:(0,f.default)(A,["extensionId","installationId","baseUrl","manifest","enableExperimentalApi","enableInternalApi","isLocal"]),local:!0}),r(A),[3,5];case 3:return[4,(0,E.getExtensionInstallation)(c,_)];case 4:if((C=u.sent()).error)return t({friendlyMessage:"Something went wrong while downloading an extension",error:C.error}),[2];if(!(S=C.result))return t({friendlyMessage:"Extension failed to install",error:Error("Expected installation to be defined")}),[2];if(!(k=S.extension))return t({friendlyMessage:"Extension failed to install",error:Error("Expected extension to be defined")}),[2];if(!k.manifest)return n({extensionId:(0,h.asExtensionId)(k.id),installationId:(0,h.asInstallationId)(S.id),extensionError:{friendlyMessage:"Extension failed to install",error:Error("Expected extension manifest to be defined")}}),[2];if("ExtensionManifestError"===k.manifest.__typename)return n({extensionId:(0,h.asExtensionId)(k.id),installationId:(0,h.asInstallationId)(S.id),extensionError:{friendlyMessage:"An error occurred while loading the extension manifest: ".concat(k.manifest.message),error:Error(k.manifest.message)}}),[2];if(!k.manifest||"ExtensionManifest"!==k.manifest.__typename)return n({extensionId:(0,h.asExtensionId)(k.id),installationId:(0,h.asInstallationId)(S.id),extensionError:{friendlyMessage:"An error occurred while loading the extension manifest",error:Error("Expected extension manifest to be defined")}}),[2];return L=(0,x.asManifest)(k.manifest),R=(0,x.hasScope)(L,"experimental-api"),P=(0,h.asExtensionId)(k.id),T=k.enableInternalApi,U={extensionId:P,installationId:c,manifest:L,baseUrl:(0,v.getValidBaseUrlOrThrow)(k.url),enableExperimentalApi:R,enableInternalApi:i||T,logger:l.createLogger({extensionId:P,installationId:c,extensionName:L.name,local:!1}),isLocal:!1},l.info("Adding extension: ".concat(U.manifest.name),{extensionArgs:(0,f.default)(U,["extensionId","installationId","baseUrl","manifest","enableExperimentalApi","enableInternalApi","isLocal"]),local:!1}),r(U),[2,S];case 5:return[2]}})})()},[r,n,t,d,l])}function es(){var e=ea(),t=eh().throwSystemError;return(0,c.useCallback)(function(n){var r=n.extensionId,o=n.replId;return(0,i._)(function(){var n,i,a;return(0,u._)(this,function(s){switch(s.label){case 0:return[4,(0,E.installExtensionMutation)({extensionId:r,replId:o})];case 1:if((a=s.sent()).error)return t({error:a.error,friendlyMessage:"Something went wrong while installing an extension"}),[2];return(0,_.track)(m.events.EXTENSION_USED,{action:"installed",name:null==(i=a.result)||null==(n=i.extension)?void 0:n.name,extensionId:r}),[4,e({installationId:(0,h.asInstallationId)(a.result.id)})];case 2:return s.sent(),[2,a.result]}})})()},[e,t])}function el(){var e=eo(),t=(0,S.useExtensionsStore)(),n=eh().throwSystemError;return(0,c.useCallback)(function(r){var o=r.installationId,a=r.replId;return(0,i._)(function(){var r;return(0,u._)(this,function(i){switch(i.label){case 0:if(!(r=t.get(j).find(function(e){return e.installationId===o})))return n({friendlyMessage:"Extension appears to be already uninstalled",error:Error("Expected extension to be defined")}),[2];if(!r.installationId||!r.extensionId)return n({friendlyMessage:"Failed to uninstall extension",error:Error("Expected installationId to be defined")}),[2];return(0,_.track)(m.events.EXTENSION_USED,{action:"uninstalled",name:r.manifest.name,extensionId:r.extensionId}),[4,(0,E.uninstallExtensionMutation)({installationId:r.installationId,replId:a})];case 1:return i.sent(),[4,e(r.installationId)];case 2:return i.sent(),[2]}})})()},[e,t,n])}function eu(){var e=eo(),t=ea();return(0,c.useCallback)(function(n){return(0,i._)(function(){return(0,u._)(this,function(r){switch(r.label){case 0:return[4,e(n)];case 1:return r.sent(),[4,t({installationId:n,forceRefetch:!0})];case 2:return r.sent(),[2]}})})()},[e,t])}function ec(){var e,t,n,r=(e=ea(),t=(0,S.useExtAtomValue)(F),n=eh().throwSystemError,(0,c.useCallback)(function(r){return(0,i._)(function(){var i,o,a,s,l,c,d,f,p,v;return(0,u._)(this,function(u){switch(u.label){case 0:return[4,(0,E.getExtensionInstallationsInRepl)(r)];case 1:if((i=u.sent()).error)return n({friendlyMessage:"Failed to load installed extensions",error:i.error}),[2];o=!0,a=!1,s=void 0,u.label=2;case 2:u.trys.push([2,9,10,11]),l=i.result[Symbol.iterator](),u.label=3;case 3:if(o=(c=l.next()).done)return[3,8];if(null==(f=(d=c.value).extension)?void 0:f.isDisabled)return t.info("Skipping disabled extension: ".concat(d.extension.name),{extension:!0,extensionId:d.extension.id,installationId:d.id}),[3,7];u.label=4;case 4:return u.trys.push([4,6,,7]),[4,e({installationId:(0,h.asInstallationId)(d.id),forceRefetch:!0})];case 5:return u.sent(),[3,7];case 6:return p=u.sent(),t.error("Extension Loading error: ".concat(p.message),{extension:!0,errors:p.message}),[3,7];case 7:return o=!0,[3,3];case 8:return[3,11];case 9:return v=u.sent(),a=!0,s=v,[3,11];case 10:try{o||null==l.return||l.return()}finally{if(a)throw s}return[7];case 11:return[2]}})})()},[e,n,t])),o=(0,S.useSetExtAtom)(F),a=(0,S.useSetExtAtom)(N),s=(0,l._)((0,S.useExtAtom)(U),2),d=s[0],f=s[1],p=(0,l._)((0,c.useState)(null),2),v=p[0],x=p[1],y=(0,l._)((0,c.useState)(null),2),_=y[0],m=y[1];return(0,c.useEffect)(function(){if(v&&_&&!d){var e=v.replId;f(!0),r(e)}},[v,_,r,d,f]),(0,c.useCallback)(function(e){var t=e.replId,n=e.userId;if(!d){x({replId:t,userId:n});var r=T({extension:!0,isInitialized:!0,replId:t,userId:n},{onLog:function(e){a(e)}});m(r),o(r)}},[o,a,d])}function ed(){var e=ea(),t=ei(),n=Z(),r=(0,S.useSetExtAtom)(K);return(0,c.useCallback)(function(o){return(0,i._)(function(){var i,a;return(0,u._)(this,function(s){return i=(0,v.getValidBaseUrlOrThrow)(o),(a=t.find(function(e){return e.baseUrl===i}))||r(a={extensionId:(0,h.asExtensionId)((0,p.v4)()),installationId:(0,h.asInstallationId)((0,p.v4)()),baseUrl:i}),n.find(function(e){return e.extensionId===(null==a?void 0:a.extensionId)})||e({installationId:a.installationId}),[2]})})()},[t,n,r,e])}function ef(){var e=(0,b.default)().container,t=(0,g.default)(e).url,n=(0,S.useSetExtAtom)(W),r=(0,S.useExtensionsStore)(),o=ea();return(0,c.useCallback)(function(){return(0,i._)(function(){var e;return(0,u._)(this,function(i){switch(i.label){case 0:if(!t)return[2];return[4,o({installationId:(e=n(t)).installationId,forceRefetch:!0})];case 1:return i.sent(),[2,r.get(j).find(function(t){return t.installationId===e.installationId})]}})})()},[t,n,o,r])}function ep(){var e=(0,b.default)().container,t=(0,g.default)(e).url,n=(0,S.useSetExtAtom)(W),r=Z();return(0,c.useMemo)(function(){if(t){var e=n(t);return r.find(function(t){return e.installationId===t.installationId})}},[t,r,n])}e.s(["addExtensionAtom",()=>z,"addLocalExtensionAtom",()=>K,"addLogAtom",()=>N,"addOrGetLocalExtensionFromBaseUrlAtom",()=>W,"clearLogsAtom",()=>V,"extensionsAtom",()=>j,"filteredLogsAtom",()=>$,"isExtensionSystemInitializedAtom",()=>U,"localExtensionsAtom",()=>D,"logFilterQueryAtom",()=>B,"registerExtensionCreateCommandAtom",()=>J,"removeExtensionAtom",()=>H,"rootExtensionSystemLoggerAtom",()=>F,"setExtensionErrorAtom",()=>G,"systemErrorAtom",()=>M,"useExtensionByInstallationId",()=>q,"useExtensionCommands",()=>er,"useExtensionStateAtom",()=>ee,"useExtensionTools",()=>en,"useExtensions",()=>Z,"useFileHandlers",()=>et,"useLocallyInstalledExtensions",()=>ei],667279);var ev=(0,d.atom)(null,function(e,t,n){var r=e(F);t(M,n),r.error("Extension System Error: ".concat(n.error.message),{extensionSystem:!0,originalError:n.error.message,friendlyMessage:n.friendlyMessage})}),ex=(0,d.atom)(null,function(e,t,n){var r=e(j),i=e(F),o=r.find(function(e){return e.extensionId===n.extensionId});if(i.error("Extension Error: ".concat(n.extensionError.friendlyMessage),{extension:!0,extensionId:n.extensionId,originalError:n.extensionError.error.message,friendlyMessage:n.extensionError.friendlyMessage}),!o){t(z,{extensionId:n.extensionId,installationId:n.installationId,manifest:(0,x.createDefaultManifest)({name:n.extensionId}),baseUrl:"",enableExperimentalApi:!1,enableInternalApi:!1,logger:i.createLogger({extensionId:n.extensionId,extensionName:n.extensionId,installationId:n.installationId,local:void 0}),isLocal:null}),t(G,{extensionId:n.extensionId,extensionError:n.extensionError});return}t(G,{extensionId:n.extensionId,extensionError:n.extensionError})});function eh(){return{throwSystemError:(0,S.useSetExtAtom)(ev),throwExtensionError:(0,S.useSetExtAtom)(ex)}}function ey(e,t){var i=(0,r.usePaneUIContext)().getDescription(e,t),o=q((0,n.isExtensionPane)(e)?e.data.installationId:void 0);return null!=i?i:null==o?void 0:o.manifest.description}e.s(["useCurrentReplExtension",()=>ep,"useInitializeExtensionSystem",()=>ec,"useInstallCurrentReplAsExtension",()=>ef,"useInstallExtension",()=>es,"useInstallExtensionLocallyByURL",()=>ed,"useLoadExtension",()=>ea,"useReloadExtension",()=>eu,"useUninstallExtension",()=>el,"useUnloadExtension",()=>eo],196380),e.s([],244719),e.s(["usePaneDescription",()=>ey],466497),e.s([],282890)}]);

//# debugId=ec021086-3bf4-a8f1-b257-cb6bf7fd6930
//# sourceMappingURL=2a190ce6bfa6f73e.js.map